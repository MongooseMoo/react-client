var G3=Object.defineProperty;var nI=e=>{throw TypeError(e)};var W3=(e,t,n)=>t in e?G3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var M=(e,t,n)=>W3(e,typeof t!="symbol"?t+"":t,n),og=(e,t,n)=>t.has(e)||nI("Cannot "+n);var F=(e,t,n)=>(og(e,t,"read from private field"),n?n.call(e):t.get(e)),ct=(e,t,n)=>t.has(e)?nI("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Oe=(e,t,n,r)=>(og(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Ee=(e,t,n)=>(og(e,t,"access private method"),n);var Of=(e,t,n,r)=>({set _(i){Oe(e,t,i,n)},get _(){return F(e,t,r)}});function Ik(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function j3(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var bk={exports:{}},hp={},Ak={exports:{}},qe={},gf=Symbol.for("react.element"),z3=Symbol.for("react.portal"),H3=Symbol.for("react.fragment"),Z3=Symbol.for("react.strict_mode"),$3=Symbol.for("react.profiler"),X3=Symbol.for("react.provider"),K3=Symbol.for("react.context"),J3=Symbol.for("react.forward_ref"),Y3=Symbol.for("react.suspense"),q3=Symbol.for("react.memo"),Q3=Symbol.for("react.lazy"),rI=Symbol.iterator;function eN(e){return e===null||typeof e!="object"?null:(e=rI&&e[rI]||e["@@iterator"],typeof e=="function"?e:null)}var wk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sk=Object.assign,kk={};function nu(e,t,n){this.props=e,this.context=t,this.refs=kk,this.updater=n||wk}nu.prototype.isReactComponent={};nu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};nu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ek(){}Ek.prototype=nu.prototype;function Sy(e,t,n){this.props=e,this.context=t,this.refs=kk,this.updater=n||wk}var ky=Sy.prototype=new Ek;ky.constructor=Sy;Sk(ky,nu.prototype);ky.isPureReactComponent=!0;var iI=Array.isArray,Tk=Object.prototype.hasOwnProperty,Ey={current:null},Rk={key:!0,ref:!0,__self:!0,__source:!0};function _k(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)Tk.call(t,r)&&!Rk.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:gf,type:e,key:o,ref:s,props:i,_owner:Ey.current}}function tN(e,t){return{$$typeof:gf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ty(e){return typeof e=="object"&&e!==null&&e.$$typeof===gf}function nN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var oI=/\/+/g;function sg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nN(""+e.key):t.toString(36)}function mh(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case gf:case z3:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+sg(s,0):r,iI(i)?(n="",e!=null&&(n=e.replace(oI,"$&/")+"/"),mh(i,t,n,"",function(c){return c})):i!=null&&(Ty(i)&&(i=tN(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(oI,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",iI(e))for(var a=0;a<e.length;a++){o=e[a];var l=r+sg(o,a);s+=mh(o,t,n,l,i)}else if(l=eN(e),typeof l=="function")for(e=l.call(e),a=0;!(o=e.next()).done;)o=o.value,l=r+sg(o,a++),s+=mh(o,t,n,l,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Ff(e,t,n){if(e==null)return e;var r=[],i=0;return mh(e,r,"","",function(o){return t.call(n,o,i++)}),r}function rN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var gr={current:null},vh={transition:null},iN={ReactCurrentDispatcher:gr,ReactCurrentBatchConfig:vh,ReactCurrentOwner:Ey};function Dk(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:Ff,forEach:function(e,t,n){Ff(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ff(e,function(){t++}),t},toArray:function(e){return Ff(e,function(t){return t})||[]},only:function(e){if(!Ty(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=nu;qe.Fragment=H3;qe.Profiler=$3;qe.PureComponent=Sy;qe.StrictMode=Z3;qe.Suspense=Y3;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iN;qe.act=Dk;qe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Sk({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=Ey.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)Tk.call(t,l)&&!Rk.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:gf,type:e.type,key:i,ref:o,props:r,_owner:s}};qe.createContext=function(e){return e={$$typeof:K3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:X3,_context:e},e.Consumer=e};qe.createElement=_k;qe.createFactory=function(e){var t=_k.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:J3,render:e}};qe.isValidElement=Ty;qe.lazy=function(e){return{$$typeof:Q3,_payload:{_status:-1,_result:e},_init:rN}};qe.memo=function(e,t){return{$$typeof:q3,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=vh.transition;vh.transition={};try{e()}finally{vh.transition=t}};qe.unstable_act=Dk;qe.useCallback=function(e,t){return gr.current.useCallback(e,t)};qe.useContext=function(e){return gr.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return gr.current.useDeferredValue(e)};qe.useEffect=function(e,t){return gr.current.useEffect(e,t)};qe.useId=function(){return gr.current.useId()};qe.useImperativeHandle=function(e,t,n){return gr.current.useImperativeHandle(e,t,n)};qe.useInsertionEffect=function(e,t){return gr.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return gr.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return gr.current.useMemo(e,t)};qe.useReducer=function(e,t,n){return gr.current.useReducer(e,t,n)};qe.useRef=function(e){return gr.current.useRef(e)};qe.useState=function(e){return gr.current.useState(e)};qe.useSyncExternalStore=function(e,t,n){return gr.current.useSyncExternalStore(e,t,n)};qe.useTransition=function(){return gr.current.useTransition()};qe.version="18.3.1";Ak.exports=qe;var S=Ak.exports;const Le=tu(S),oN=Ik({__proto__:null,default:Le},[S]);var sN=S,aN=Symbol.for("react.element"),lN=Symbol.for("react.fragment"),cN=Object.prototype.hasOwnProperty,uN=sN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dN={key:!0,ref:!0,__self:!0,__source:!0};function Pk(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)cN.call(t,r)&&!dN.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:aN,type:e,key:o,ref:s,props:i,_owner:uN.current}}hp.Fragment=lN;hp.jsx=Pk;hp.jsxs=Pk;bk.exports=hp;var G=bk.exports,ov={},Nk={exports:{}},ri={},Bk={exports:{}},Ok={};(function(e){function t($,q){var te=$.length;$.push(q);e:for(;0<te;){var O=te-1>>>1,j=$[O];if(0<i(j,q))$[O]=q,$[te]=j,te=O;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var q=$[0],te=$.pop();if(te!==q){$[0]=te;e:for(var O=0,j=$.length,J=j>>>1;O<J;){var ee=2*(O+1)-1,se=$[ee],me=ee+1,Be=$[me];if(0>i(se,te))me<j&&0>i(Be,se)?($[O]=Be,$[me]=te,O=me):($[O]=se,$[ee]=te,O=ee);else if(me<j&&0>i(Be,te))$[O]=Be,$[me]=te,O=me;else break e}}return q}function i($,q){var te=$.sortIndex-q.sortIndex;return te!==0?te:$.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,f=3,h=!1,p=!1,g=!1,C=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y($){for(var q=n(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=$)r(c),q.sortIndex=q.expirationTime,t(l,q);else break;q=n(c)}}function x($){if(g=!1,y($),!p)if(n(l)!==null)p=!0,Q(b);else{var q=n(c);q!==null&&ie(x,q.startTime-$)}}function b($,q){p=!1,g&&(g=!1,v(E),E=-1),h=!0;var te=f;try{for(y(q),d=n(l);d!==null&&(!(d.expirationTime>q)||$&&!R());){var O=d.callback;if(typeof O=="function"){d.callback=null,f=d.priorityLevel;var j=O(d.expirationTime<=q);q=e.unstable_now(),typeof j=="function"?d.callback=j:d===n(l)&&r(l),y(q)}else r(l);d=n(l)}if(d!==null)var J=!0;else{var ee=n(c);ee!==null&&ie(x,ee.startTime-q),J=!1}return J}finally{d=null,f=te,h=!1}}var k=!1,A=null,E=-1,D=5,T=-1;function R(){return!(e.unstable_now()-T<D)}function P(){if(A!==null){var $=e.unstable_now();T=$;var q=!0;try{q=A(!0,$)}finally{q?L():(k=!1,A=null)}}else k=!1}var L;if(typeof m=="function")L=function(){m(P)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,Z=z.port2;z.port1.onmessage=P,L=function(){Z.postMessage(null)}}else L=function(){C(P,0)};function Q($){A=$,k||(k=!0,L())}function ie($,q){E=C(function(){$(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,Q(b))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function($){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var te=f;f=q;try{return $()}finally{f=te}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,q){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var te=f;f=$;try{return q()}finally{f=te}},e.unstable_scheduleCallback=function($,q,te){var O=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?O+te:O):te=O,$){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=te+j,$={id:u++,callback:q,priorityLevel:$,startTime:te,expirationTime:j,sortIndex:-1},te>O?($.sortIndex=te,t(c,$),n(l)===null&&$===n(c)&&(g?(v(E),E=-1):g=!0,ie(x,te-O))):($.sortIndex=j,t(l,$),p||h||(p=!0,Q(b))),$},e.unstable_shouldYield=R,e.unstable_wrapCallback=function($){var q=f;return function(){var te=f;f=q;try{return $.apply(this,arguments)}finally{f=te}}}})(Ok);Bk.exports=Ok;var fN=Bk.exports,hN=S,ti=fN;function fe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fk=new Set,Ed={};function Fl(e,t){Lc(e,t),Lc(e+"Capture",t)}function Lc(e,t){for(Ed[e]=t,e=0;e<t.length;e++)Fk.add(t[e])}var Bs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sv=Object.prototype.hasOwnProperty,pN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sI={},aI={};function gN(e){return sv.call(aI,e)?!0:sv.call(sI,e)?!1:pN.test(e)?aI[e]=!0:(sI[e]=!0,!1)}function mN(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vN(e,t,n,r){if(t===null||typeof t>"u"||mN(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function mr(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ln[e]=new mr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ln[t]=new mr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ln[e]=new mr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ln[e]=new mr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ln[e]=new mr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ln[e]=new mr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ln[e]=new mr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ln[e]=new mr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ln[e]=new mr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ry=/[\-:]([a-z])/g;function _y(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ry,_y);Ln[t]=new mr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ry,_y);Ln[t]=new mr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ry,_y);Ln[t]=new mr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ln[e]=new mr(e,1,!1,e.toLowerCase(),null,!1,!1)});Ln.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ln[e]=new mr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Dy(e,t,n,r){var i=Ln.hasOwnProperty(t)?Ln[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vN(t,n,i,r)&&(n=null),r||i===null?gN(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Ws=hN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Mf=Symbol.for("react.element"),rc=Symbol.for("react.portal"),ic=Symbol.for("react.fragment"),Py=Symbol.for("react.strict_mode"),av=Symbol.for("react.profiler"),Mk=Symbol.for("react.provider"),Lk=Symbol.for("react.context"),Ny=Symbol.for("react.forward_ref"),lv=Symbol.for("react.suspense"),cv=Symbol.for("react.suspense_list"),By=Symbol.for("react.memo"),la=Symbol.for("react.lazy"),Uk=Symbol.for("react.offscreen"),lI=Symbol.iterator;function Au(e){return e===null||typeof e!="object"?null:(e=lI&&e[lI]||e["@@iterator"],typeof e=="function"?e:null)}var Jt=Object.assign,ag;function Xu(e){if(ag===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ag=t&&t[1]||""}return`
`+ag+e}var lg=!1;function cg(e,t){if(!e||lg)return"";lg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=a);break}}}finally{lg=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Xu(e):""}function CN(e){switch(e.tag){case 5:return Xu(e.type);case 16:return Xu("Lazy");case 13:return Xu("Suspense");case 19:return Xu("SuspenseList");case 0:case 2:case 15:return e=cg(e.type,!1),e;case 11:return e=cg(e.type.render,!1),e;case 1:return e=cg(e.type,!0),e;default:return""}}function uv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ic:return"Fragment";case rc:return"Portal";case av:return"Profiler";case Py:return"StrictMode";case lv:return"Suspense";case cv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lk:return(e.displayName||"Context")+".Consumer";case Mk:return(e._context.displayName||"Context")+".Provider";case Ny:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case By:return t=e.displayName||null,t!==null?t:uv(e.type)||"Memo";case la:t=e._payload,e=e._init;try{return uv(e(t))}catch{}}return null}function yN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return uv(t);case 8:return t===Py?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Oa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Vk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xN(e){var t=Vk(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lf(e){e._valueTracker||(e._valueTracker=xN(e))}function Gk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Vk(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function n0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function dv(e,t){var n=t.checked;return Jt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function cI(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Oa(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Wk(e,t){t=t.checked,t!=null&&Dy(e,"checked",t,!1)}function fv(e,t){Wk(e,t);var n=Oa(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hv(e,t.type,n):t.hasOwnProperty("defaultValue")&&hv(e,t.type,Oa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function uI(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function hv(e,t,n){(t!=="number"||n0(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ku=Array.isArray;function Cc(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Oa(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function pv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(fe(91));return Jt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function dI(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(fe(92));if(Ku(n)){if(1<n.length)throw Error(fe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Oa(n)}}function jk(e,t){var n=Oa(t.value),r=Oa(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function fI(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function zk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?zk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Uf,Hk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Uf=Uf||document.createElement("div"),Uf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Uf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Td(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var cd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IN=["Webkit","ms","Moz","O"];Object.keys(cd).forEach(function(e){IN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),cd[t]=cd[e]})});function Zk(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||cd.hasOwnProperty(e)&&cd[e]?(""+t).trim():t+"px"}function $k(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Zk(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var bN=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mv(e,t){if(t){if(bN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(fe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(fe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(fe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(fe(62))}}function vv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cv=null;function Oy(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yv=null,yc=null,xc=null;function hI(e){if(e=Cf(e)){if(typeof yv!="function")throw Error(fe(280));var t=e.stateNode;t&&(t=Cp(t),yv(e.stateNode,e.type,t))}}function Xk(e){yc?xc?xc.push(e):xc=[e]:yc=e}function Kk(){if(yc){var e=yc,t=xc;if(xc=yc=null,hI(e),t)for(e=0;e<t.length;e++)hI(t[e])}}function Jk(e,t){return e(t)}function Yk(){}var ug=!1;function qk(e,t,n){if(ug)return e(t,n);ug=!0;try{return Jk(e,t,n)}finally{ug=!1,(yc!==null||xc!==null)&&(Yk(),Kk())}}function Rd(e,t){var n=e.stateNode;if(n===null)return null;var r=Cp(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(fe(231,t,typeof n));return n}var xv=!1;if(Bs)try{var wu={};Object.defineProperty(wu,"passive",{get:function(){xv=!0}}),window.addEventListener("test",wu,wu),window.removeEventListener("test",wu,wu)}catch{xv=!1}function AN(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var ud=!1,r0=null,i0=!1,Iv=null,wN={onError:function(e){ud=!0,r0=e}};function SN(e,t,n,r,i,o,s,a,l){ud=!1,r0=null,AN.apply(wN,arguments)}function kN(e,t,n,r,i,o,s,a,l){if(SN.apply(this,arguments),ud){if(ud){var c=r0;ud=!1,r0=null}else throw Error(fe(198));i0||(i0=!0,Iv=c)}}function Ml(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Qk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pI(e){if(Ml(e)!==e)throw Error(fe(188))}function EN(e){var t=e.alternate;if(!t){if(t=Ml(e),t===null)throw Error(fe(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return pI(i),e;if(o===r)return pI(i),t;o=o.sibling}throw Error(fe(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(fe(189))}}if(n.alternate!==r)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?e:t}function eE(e){return e=EN(e),e!==null?tE(e):null}function tE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=tE(e);if(t!==null)return t;e=e.sibling}return null}var nE=ti.unstable_scheduleCallback,gI=ti.unstable_cancelCallback,TN=ti.unstable_shouldYield,RN=ti.unstable_requestPaint,on=ti.unstable_now,_N=ti.unstable_getCurrentPriorityLevel,Fy=ti.unstable_ImmediatePriority,rE=ti.unstable_UserBlockingPriority,o0=ti.unstable_NormalPriority,DN=ti.unstable_LowPriority,iE=ti.unstable_IdlePriority,pp=null,Bo=null;function PN(e){if(Bo&&typeof Bo.onCommitFiberRoot=="function")try{Bo.onCommitFiberRoot(pp,e,void 0,(e.current.flags&128)===128)}catch{}}var $i=Math.clz32?Math.clz32:ON,NN=Math.log,BN=Math.LN2;function ON(e){return e>>>=0,e===0?32:31-(NN(e)/BN|0)|0}var Vf=64,Gf=4194304;function Ju(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function s0(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Ju(a):(o&=s,o!==0&&(r=Ju(o)))}else s=n&~i,s!==0?r=Ju(s):o!==0&&(r=Ju(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-$i(t),i=1<<n,r|=e[n],t&=~i;return r}function FN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MN(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-$i(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=FN(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}function bv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function oE(){var e=Vf;return Vf<<=1,!(Vf&4194240)&&(Vf=64),e}function dg(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mf(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-$i(t),e[t]=n}function LN(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-$i(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function My(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-$i(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var xt=0;function sE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var aE,Ly,lE,cE,uE,Av=!1,Wf=[],Sa=null,ka=null,Ea=null,_d=new Map,Dd=new Map,da=[],UN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mI(e,t){switch(e){case"focusin":case"focusout":Sa=null;break;case"dragenter":case"dragleave":ka=null;break;case"mouseover":case"mouseout":Ea=null;break;case"pointerover":case"pointerout":_d.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dd.delete(t.pointerId)}}function Su(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=Cf(t),t!==null&&Ly(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function VN(e,t,n,r,i){switch(t){case"focusin":return Sa=Su(Sa,e,t,n,r,i),!0;case"dragenter":return ka=Su(ka,e,t,n,r,i),!0;case"mouseover":return Ea=Su(Ea,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return _d.set(o,Su(_d.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Dd.set(o,Su(Dd.get(o)||null,e,t,n,r,i)),!0}return!1}function dE(e){var t=ol(e.target);if(t!==null){var n=Ml(t);if(n!==null){if(t=n.tag,t===13){if(t=Qk(n),t!==null){e.blockedOn=t,uE(e.priority,function(){lE(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ch(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=wv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Cv=r,n.target.dispatchEvent(r),Cv=null}else return t=Cf(n),t!==null&&Ly(t),e.blockedOn=n,!1;t.shift()}return!0}function vI(e,t,n){Ch(e)&&n.delete(t)}function GN(){Av=!1,Sa!==null&&Ch(Sa)&&(Sa=null),ka!==null&&Ch(ka)&&(ka=null),Ea!==null&&Ch(Ea)&&(Ea=null),_d.forEach(vI),Dd.forEach(vI)}function ku(e,t){e.blockedOn===t&&(e.blockedOn=null,Av||(Av=!0,ti.unstable_scheduleCallback(ti.unstable_NormalPriority,GN)))}function Pd(e){function t(i){return ku(i,e)}if(0<Wf.length){ku(Wf[0],e);for(var n=1;n<Wf.length;n++){var r=Wf[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Sa!==null&&ku(Sa,e),ka!==null&&ku(ka,e),Ea!==null&&ku(Ea,e),_d.forEach(t),Dd.forEach(t),n=0;n<da.length;n++)r=da[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<da.length&&(n=da[0],n.blockedOn===null);)dE(n),n.blockedOn===null&&da.shift()}var Ic=Ws.ReactCurrentBatchConfig,a0=!0;function WN(e,t,n,r){var i=xt,o=Ic.transition;Ic.transition=null;try{xt=1,Uy(e,t,n,r)}finally{xt=i,Ic.transition=o}}function jN(e,t,n,r){var i=xt,o=Ic.transition;Ic.transition=null;try{xt=4,Uy(e,t,n,r)}finally{xt=i,Ic.transition=o}}function Uy(e,t,n,r){if(a0){var i=wv(e,t,n,r);if(i===null)Ig(e,t,r,l0,n),mI(e,r);else if(VN(i,e,t,n,r))r.stopPropagation();else if(mI(e,r),t&4&&-1<UN.indexOf(e)){for(;i!==null;){var o=Cf(i);if(o!==null&&aE(o),o=wv(e,t,n,r),o===null&&Ig(e,t,r,l0,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Ig(e,t,r,null,n)}}var l0=null;function wv(e,t,n,r){if(l0=null,e=Oy(r),e=ol(e),e!==null)if(t=Ml(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Qk(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return l0=e,null}function fE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_N()){case Fy:return 1;case rE:return 4;case o0:case DN:return 16;case iE:return 536870912;default:return 16}default:return 16}}var pa=null,Vy=null,yh=null;function hE(){if(yh)return yh;var e,t=Vy,n=t.length,r,i="value"in pa?pa.value:pa.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return yh=i.slice(e,1<r?1-r:void 0)}function xh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jf(){return!0}function CI(){return!1}function ii(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?jf:CI,this.isPropagationStopped=CI,this}return Jt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jf)},persist:function(){},isPersistent:jf}),t}var ru={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gy=ii(ru),vf=Jt({},ru,{view:0,detail:0}),zN=ii(vf),fg,hg,Eu,gp=Jt({},vf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wy,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Eu&&(Eu&&e.type==="mousemove"?(fg=e.screenX-Eu.screenX,hg=e.screenY-Eu.screenY):hg=fg=0,Eu=e),fg)},movementY:function(e){return"movementY"in e?e.movementY:hg}}),yI=ii(gp),HN=Jt({},gp,{dataTransfer:0}),ZN=ii(HN),$N=Jt({},vf,{relatedTarget:0}),pg=ii($N),XN=Jt({},ru,{animationName:0,elapsedTime:0,pseudoElement:0}),KN=ii(XN),JN=Jt({},ru,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),YN=ii(JN),qN=Jt({},ru,{data:0}),xI=ii(qN),QN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nB(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=tB[e])?!!t[e]:!1}function Wy(){return nB}var rB=Jt({},vf,{key:function(e){if(e.key){var t=QN[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?eB[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wy,charCode:function(e){return e.type==="keypress"?xh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iB=ii(rB),oB=Jt({},gp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),II=ii(oB),sB=Jt({},vf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wy}),aB=ii(sB),lB=Jt({},ru,{propertyName:0,elapsedTime:0,pseudoElement:0}),cB=ii(lB),uB=Jt({},gp,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),dB=ii(uB),fB=[9,13,27,32],jy=Bs&&"CompositionEvent"in window,dd=null;Bs&&"documentMode"in document&&(dd=document.documentMode);var hB=Bs&&"TextEvent"in window&&!dd,pE=Bs&&(!jy||dd&&8<dd&&11>=dd),bI=" ",AI=!1;function gE(e,t){switch(e){case"keyup":return fB.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var oc=!1;function pB(e,t){switch(e){case"compositionend":return mE(t);case"keypress":return t.which!==32?null:(AI=!0,bI);case"textInput":return e=t.data,e===bI&&AI?null:e;default:return null}}function gB(e,t){if(oc)return e==="compositionend"||!jy&&gE(e,t)?(e=hE(),yh=Vy=pa=null,oc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pE&&t.locale!=="ko"?null:t.data;default:return null}}var mB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wI(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!mB[e.type]:t==="textarea"}function vE(e,t,n,r){Xk(r),t=c0(t,"onChange"),0<t.length&&(n=new Gy("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var fd=null,Nd=null;function vB(e){TE(e,0)}function mp(e){var t=lc(e);if(Gk(t))return e}function CB(e,t){if(e==="change")return t}var CE=!1;if(Bs){var gg;if(Bs){var mg="oninput"in document;if(!mg){var SI=document.createElement("div");SI.setAttribute("oninput","return;"),mg=typeof SI.oninput=="function"}gg=mg}else gg=!1;CE=gg&&(!document.documentMode||9<document.documentMode)}function kI(){fd&&(fd.detachEvent("onpropertychange",yE),Nd=fd=null)}function yE(e){if(e.propertyName==="value"&&mp(Nd)){var t=[];vE(t,Nd,e,Oy(e)),qk(vB,t)}}function yB(e,t,n){e==="focusin"?(kI(),fd=t,Nd=n,fd.attachEvent("onpropertychange",yE)):e==="focusout"&&kI()}function xB(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return mp(Nd)}function IB(e,t){if(e==="click")return mp(t)}function bB(e,t){if(e==="input"||e==="change")return mp(t)}function AB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ji=typeof Object.is=="function"?Object.is:AB;function Bd(e,t){if(Ji(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!sv.call(t,i)||!Ji(e[i],t[i]))return!1}return!0}function EI(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function TI(e,t){var n=EI(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=EI(n)}}function xE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?xE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function IE(){for(var e=window,t=n0();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=n0(e.document)}return t}function zy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function wB(e){var t=IE(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&xE(n.ownerDocument.documentElement,n)){if(r!==null&&zy(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=TI(n,o);var s=TI(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var SB=Bs&&"documentMode"in document&&11>=document.documentMode,sc=null,Sv=null,hd=null,kv=!1;function RI(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;kv||sc==null||sc!==n0(r)||(r=sc,"selectionStart"in r&&zy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hd&&Bd(hd,r)||(hd=r,r=c0(Sv,"onSelect"),0<r.length&&(t=new Gy("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=sc)))}function zf(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ac={animationend:zf("Animation","AnimationEnd"),animationiteration:zf("Animation","AnimationIteration"),animationstart:zf("Animation","AnimationStart"),transitionend:zf("Transition","TransitionEnd")},vg={},bE={};Bs&&(bE=document.createElement("div").style,"AnimationEvent"in window||(delete ac.animationend.animation,delete ac.animationiteration.animation,delete ac.animationstart.animation),"TransitionEvent"in window||delete ac.transitionend.transition);function vp(e){if(vg[e])return vg[e];if(!ac[e])return e;var t=ac[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in bE)return vg[e]=t[n];return e}var AE=vp("animationend"),wE=vp("animationiteration"),SE=vp("animationstart"),kE=vp("transitionend"),EE=new Map,_I="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Va(e,t){EE.set(e,t),Fl(t,[e])}for(var Cg=0;Cg<_I.length;Cg++){var yg=_I[Cg],kB=yg.toLowerCase(),EB=yg[0].toUpperCase()+yg.slice(1);Va(kB,"on"+EB)}Va(AE,"onAnimationEnd");Va(wE,"onAnimationIteration");Va(SE,"onAnimationStart");Va("dblclick","onDoubleClick");Va("focusin","onFocus");Va("focusout","onBlur");Va(kE,"onTransitionEnd");Lc("onMouseEnter",["mouseout","mouseover"]);Lc("onMouseLeave",["mouseout","mouseover"]);Lc("onPointerEnter",["pointerout","pointerover"]);Lc("onPointerLeave",["pointerout","pointerover"]);Fl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TB=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yu));function DI(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,kN(r,t,void 0,e),e.currentTarget=null}function TE(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;DI(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;DI(i,a,c),o=l}}}if(i0)throw e=Iv,i0=!1,Iv=null,e}function Nt(e,t){var n=t[Dv];n===void 0&&(n=t[Dv]=new Set);var r=e+"__bubble";n.has(r)||(RE(t,e,2,!1),n.add(r))}function xg(e,t,n){var r=0;t&&(r|=4),RE(n,e,r,t)}var Hf="_reactListening"+Math.random().toString(36).slice(2);function Od(e){if(!e[Hf]){e[Hf]=!0,Fk.forEach(function(n){n!=="selectionchange"&&(TB.has(n)||xg(n,!1,e),xg(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Hf]||(t[Hf]=!0,xg("selectionchange",!1,t))}}function RE(e,t,n,r){switch(fE(t)){case 1:var i=WN;break;case 4:i=jN;break;default:i=Uy}n=i.bind(null,t,n,e),i=void 0,!xv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Ig(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=ol(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}qk(function(){var c=o,u=Oy(n),d=[];e:{var f=EE.get(e);if(f!==void 0){var h=Gy,p=e;switch(e){case"keypress":if(xh(n)===0)break e;case"keydown":case"keyup":h=iB;break;case"focusin":p="focus",h=pg;break;case"focusout":p="blur",h=pg;break;case"beforeblur":case"afterblur":h=pg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=yI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=ZN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=aB;break;case AE:case wE:case SE:h=KN;break;case kE:h=cB;break;case"scroll":h=zN;break;case"wheel":h=dB;break;case"copy":case"cut":case"paste":h=YN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=II}var g=(t&4)!==0,C=!g&&e==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var m=c,y;m!==null;){y=m;var x=y.stateNode;if(y.tag===5&&x!==null&&(y=x,v!==null&&(x=Rd(m,v),x!=null&&g.push(Fd(m,x,y)))),C)break;m=m.return}0<g.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==Cv&&(p=n.relatedTarget||n.fromElement)&&(ol(p)||p[Os]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=c,p=p?ol(p):null,p!==null&&(C=Ml(p),p!==C||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(g=yI,x="onMouseLeave",v="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(g=II,x="onPointerLeave",v="onPointerEnter",m="pointer"),C=h==null?f:lc(h),y=p==null?f:lc(p),f=new g(x,m+"leave",h,n,u),f.target=C,f.relatedTarget=y,x=null,ol(u)===c&&(g=new g(v,m+"enter",p,n,u),g.target=y,g.relatedTarget=C,x=g),C=x,h&&p)t:{for(g=h,v=p,m=0,y=g;y;y=Kl(y))m++;for(y=0,x=v;x;x=Kl(x))y++;for(;0<m-y;)g=Kl(g),m--;for(;0<y-m;)v=Kl(v),y--;for(;m--;){if(g===v||v!==null&&g===v.alternate)break t;g=Kl(g),v=Kl(v)}g=null}else g=null;h!==null&&PI(d,f,h,g,!1),p!==null&&C!==null&&PI(d,C,p,g,!0)}}e:{if(f=c?lc(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=CB;else if(wI(f))if(CE)b=bB;else{b=xB;var k=yB}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=IB);if(b&&(b=b(e,c))){vE(d,b,n,u);break e}k&&k(e,f,c),e==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&hv(f,"number",f.value)}switch(k=c?lc(c):window,e){case"focusin":(wI(k)||k.contentEditable==="true")&&(sc=k,Sv=c,hd=null);break;case"focusout":hd=Sv=sc=null;break;case"mousedown":kv=!0;break;case"contextmenu":case"mouseup":case"dragend":kv=!1,RI(d,n,u);break;case"selectionchange":if(SB)break;case"keydown":case"keyup":RI(d,n,u)}var A;if(jy)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else oc?gE(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(pE&&n.locale!=="ko"&&(oc||E!=="onCompositionStart"?E==="onCompositionEnd"&&oc&&(A=hE()):(pa=u,Vy="value"in pa?pa.value:pa.textContent,oc=!0)),k=c0(c,E),0<k.length&&(E=new xI(E,e,null,n,u),d.push({event:E,listeners:k}),A?E.data=A:(A=mE(n),A!==null&&(E.data=A)))),(A=hB?pB(e,n):gB(e,n))&&(c=c0(c,"onBeforeInput"),0<c.length&&(u=new xI("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=A))}TE(d,t)})}function Fd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function c0(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Rd(e,n),o!=null&&r.unshift(Fd(e,o,i)),o=Rd(e,t),o!=null&&r.push(Fd(e,o,i))),e=e.return}return r}function Kl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function PI(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Rd(n,o),l!=null&&s.unshift(Fd(n,l,a))):i||(l=Rd(n,o),l!=null&&s.push(Fd(n,l,a)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var RB=/\r\n?/g,_B=/\u0000|\uFFFD/g;function NI(e){return(typeof e=="string"?e:""+e).replace(RB,`
`).replace(_B,"")}function Zf(e,t,n){if(t=NI(t),NI(e)!==t&&n)throw Error(fe(425))}function u0(){}var Ev=null,Tv=null;function Rv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _v=typeof setTimeout=="function"?setTimeout:void 0,DB=typeof clearTimeout=="function"?clearTimeout:void 0,BI=typeof Promise=="function"?Promise:void 0,PB=typeof queueMicrotask=="function"?queueMicrotask:typeof BI<"u"?function(e){return BI.resolve(null).then(e).catch(NB)}:_v;function NB(e){setTimeout(function(){throw e})}function bg(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Pd(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Pd(t)}function Ta(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function OI(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var iu=Math.random().toString(36).slice(2),go="__reactFiber$"+iu,Md="__reactProps$"+iu,Os="__reactContainer$"+iu,Dv="__reactEvents$"+iu,BB="__reactListeners$"+iu,OB="__reactHandles$"+iu;function ol(e){var t=e[go];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Os]||n[go]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=OI(e);e!==null;){if(n=e[go])return n;e=OI(e)}return t}e=n,n=e.parentNode}return null}function Cf(e){return e=e[go]||e[Os],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function lc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(fe(33))}function Cp(e){return e[Md]||null}var Pv=[],cc=-1;function Ga(e){return{current:e}}function Lt(e){0>cc||(e.current=Pv[cc],Pv[cc]=null,cc--)}function Rt(e,t){cc++,Pv[cc]=e.current,e.current=t}var Fa={},Yn=Ga(Fa),Rr=Ga(!1),Il=Fa;function Uc(e,t){var n=e.type.contextTypes;if(!n)return Fa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function _r(e){return e=e.childContextTypes,e!=null}function d0(){Lt(Rr),Lt(Yn)}function FI(e,t,n){if(Yn.current!==Fa)throw Error(fe(168));Rt(Yn,t),Rt(Rr,n)}function _E(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(fe(108,yN(e)||"Unknown",i));return Jt({},n,r)}function f0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fa,Il=Yn.current,Rt(Yn,e),Rt(Rr,Rr.current),!0}function MI(e,t,n){var r=e.stateNode;if(!r)throw Error(fe(169));n?(e=_E(e,t,Il),r.__reactInternalMemoizedMergedChildContext=e,Lt(Rr),Lt(Yn),Rt(Yn,e)):Lt(Rr),Rt(Rr,n)}var Yo=null,yp=!1,Ag=!1;function DE(e){Yo===null?Yo=[e]:Yo.push(e)}function FB(e){yp=!0,DE(e)}function Wa(){if(!Ag&&Yo!==null){Ag=!0;var e=0,t=xt;try{var n=Yo;for(xt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Yo=null,yp=!1}catch(i){throw Yo!==null&&(Yo=Yo.slice(e+1)),nE(Fy,Wa),i}finally{xt=t,Ag=!1}}return null}var uc=[],dc=0,h0=null,p0=0,ui=[],di=0,bl=null,ns=1,rs="";function Ya(e,t){uc[dc++]=p0,uc[dc++]=h0,h0=e,p0=t}function PE(e,t,n){ui[di++]=ns,ui[di++]=rs,ui[di++]=bl,bl=e;var r=ns;e=rs;var i=32-$i(r)-1;r&=~(1<<i),n+=1;var o=32-$i(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ns=1<<32-$i(t)+i|n<<i|r,rs=o+e}else ns=1<<o|n<<i|r,rs=e}function Hy(e){e.return!==null&&(Ya(e,1),PE(e,1,0))}function Zy(e){for(;e===h0;)h0=uc[--dc],uc[dc]=null,p0=uc[--dc],uc[dc]=null;for(;e===bl;)bl=ui[--di],ui[di]=null,rs=ui[--di],ui[di]=null,ns=ui[--di],ui[di]=null}var Qr=null,Jr=null,$t=!1,Ui=null;function NE(e,t){var n=hi(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function LI(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Qr=e,Jr=Ta(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Qr=e,Jr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=bl!==null?{id:ns,overflow:rs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hi(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Qr=e,Jr=null,!0):!1;default:return!1}}function Nv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Bv(e){if($t){var t=Jr;if(t){var n=t;if(!LI(e,t)){if(Nv(e))throw Error(fe(418));t=Ta(n.nextSibling);var r=Qr;t&&LI(e,t)?NE(r,n):(e.flags=e.flags&-4097|2,$t=!1,Qr=e)}}else{if(Nv(e))throw Error(fe(418));e.flags=e.flags&-4097|2,$t=!1,Qr=e}}}function UI(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qr=e}function $f(e){if(e!==Qr)return!1;if(!$t)return UI(e),$t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Rv(e.type,e.memoizedProps)),t&&(t=Jr)){if(Nv(e))throw BE(),Error(fe(418));for(;t;)NE(e,t),t=Ta(t.nextSibling)}if(UI(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(fe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Jr=Ta(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Jr=null}}else Jr=Qr?Ta(e.stateNode.nextSibling):null;return!0}function BE(){for(var e=Jr;e;)e=Ta(e.nextSibling)}function Vc(){Jr=Qr=null,$t=!1}function $y(e){Ui===null?Ui=[e]:Ui.push(e)}var MB=Ws.ReactCurrentBatchConfig;function Tu(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var r=n.stateNode}if(!r)throw Error(fe(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,e))}return e}function Xf(e,t){throw e=Object.prototype.toString.call(t),Error(fe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function VI(e){var t=e._init;return t(e._payload)}function OE(e){function t(v,m){if(e){var y=v.deletions;y===null?(v.deletions=[m],v.flags|=16):y.push(m)}}function n(v,m){if(!e)return null;for(;m!==null;)t(v,m),m=m.sibling;return null}function r(v,m){for(v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function i(v,m){return v=Pa(v,m),v.index=0,v.sibling=null,v}function o(v,m,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<m?(v.flags|=2,m):y):(v.flags|=2,m)):(v.flags|=1048576,m)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function a(v,m,y,x){return m===null||m.tag!==6?(m=_g(y,v.mode,x),m.return=v,m):(m=i(m,y),m.return=v,m)}function l(v,m,y,x){var b=y.type;return b===ic?u(v,m,y.props.children,x,y.key):m!==null&&(m.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===la&&VI(b)===m.type)?(x=i(m,y.props),x.ref=Tu(v,m,y),x.return=v,x):(x=Eh(y.type,y.key,y.props,null,v.mode,x),x.ref=Tu(v,m,y),x.return=v,x)}function c(v,m,y,x){return m===null||m.tag!==4||m.stateNode.containerInfo!==y.containerInfo||m.stateNode.implementation!==y.implementation?(m=Dg(y,v.mode,x),m.return=v,m):(m=i(m,y.children||[]),m.return=v,m)}function u(v,m,y,x,b){return m===null||m.tag!==7?(m=pl(y,v.mode,x,b),m.return=v,m):(m=i(m,y),m.return=v,m)}function d(v,m,y){if(typeof m=="string"&&m!==""||typeof m=="number")return m=_g(""+m,v.mode,y),m.return=v,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Mf:return y=Eh(m.type,m.key,m.props,null,v.mode,y),y.ref=Tu(v,null,m),y.return=v,y;case rc:return m=Dg(m,v.mode,y),m.return=v,m;case la:var x=m._init;return d(v,x(m._payload),y)}if(Ku(m)||Au(m))return m=pl(m,v.mode,y,null),m.return=v,m;Xf(v,m)}return null}function f(v,m,y,x){var b=m!==null?m.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:a(v,m,""+y,x);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Mf:return y.key===b?l(v,m,y,x):null;case rc:return y.key===b?c(v,m,y,x):null;case la:return b=y._init,f(v,m,b(y._payload),x)}if(Ku(y)||Au(y))return b!==null?null:u(v,m,y,x,null);Xf(v,y)}return null}function h(v,m,y,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return v=v.get(y)||null,a(m,v,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Mf:return v=v.get(x.key===null?y:x.key)||null,l(m,v,x,b);case rc:return v=v.get(x.key===null?y:x.key)||null,c(m,v,x,b);case la:var k=x._init;return h(v,m,y,k(x._payload),b)}if(Ku(x)||Au(x))return v=v.get(y)||null,u(m,v,x,b,null);Xf(m,x)}return null}function p(v,m,y,x){for(var b=null,k=null,A=m,E=m=0,D=null;A!==null&&E<y.length;E++){A.index>E?(D=A,A=null):D=A.sibling;var T=f(v,A,y[E],x);if(T===null){A===null&&(A=D);break}e&&A&&T.alternate===null&&t(v,A),m=o(T,m,E),k===null?b=T:k.sibling=T,k=T,A=D}if(E===y.length)return n(v,A),$t&&Ya(v,E),b;if(A===null){for(;E<y.length;E++)A=d(v,y[E],x),A!==null&&(m=o(A,m,E),k===null?b=A:k.sibling=A,k=A);return $t&&Ya(v,E),b}for(A=r(v,A);E<y.length;E++)D=h(A,v,E,y[E],x),D!==null&&(e&&D.alternate!==null&&A.delete(D.key===null?E:D.key),m=o(D,m,E),k===null?b=D:k.sibling=D,k=D);return e&&A.forEach(function(R){return t(v,R)}),$t&&Ya(v,E),b}function g(v,m,y,x){var b=Au(y);if(typeof b!="function")throw Error(fe(150));if(y=b.call(y),y==null)throw Error(fe(151));for(var k=b=null,A=m,E=m=0,D=null,T=y.next();A!==null&&!T.done;E++,T=y.next()){A.index>E?(D=A,A=null):D=A.sibling;var R=f(v,A,T.value,x);if(R===null){A===null&&(A=D);break}e&&A&&R.alternate===null&&t(v,A),m=o(R,m,E),k===null?b=R:k.sibling=R,k=R,A=D}if(T.done)return n(v,A),$t&&Ya(v,E),b;if(A===null){for(;!T.done;E++,T=y.next())T=d(v,T.value,x),T!==null&&(m=o(T,m,E),k===null?b=T:k.sibling=T,k=T);return $t&&Ya(v,E),b}for(A=r(v,A);!T.done;E++,T=y.next())T=h(A,v,E,T.value,x),T!==null&&(e&&T.alternate!==null&&A.delete(T.key===null?E:T.key),m=o(T,m,E),k===null?b=T:k.sibling=T,k=T);return e&&A.forEach(function(P){return t(v,P)}),$t&&Ya(v,E),b}function C(v,m,y,x){if(typeof y=="object"&&y!==null&&y.type===ic&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Mf:e:{for(var b=y.key,k=m;k!==null;){if(k.key===b){if(b=y.type,b===ic){if(k.tag===7){n(v,k.sibling),m=i(k,y.props.children),m.return=v,v=m;break e}}else if(k.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===la&&VI(b)===k.type){n(v,k.sibling),m=i(k,y.props),m.ref=Tu(v,k,y),m.return=v,v=m;break e}n(v,k);break}else t(v,k);k=k.sibling}y.type===ic?(m=pl(y.props.children,v.mode,x,y.key),m.return=v,v=m):(x=Eh(y.type,y.key,y.props,null,v.mode,x),x.ref=Tu(v,m,y),x.return=v,v=x)}return s(v);case rc:e:{for(k=y.key;m!==null;){if(m.key===k)if(m.tag===4&&m.stateNode.containerInfo===y.containerInfo&&m.stateNode.implementation===y.implementation){n(v,m.sibling),m=i(m,y.children||[]),m.return=v,v=m;break e}else{n(v,m);break}else t(v,m);m=m.sibling}m=Dg(y,v.mode,x),m.return=v,v=m}return s(v);case la:return k=y._init,C(v,m,k(y._payload),x)}if(Ku(y))return p(v,m,y,x);if(Au(y))return g(v,m,y,x);Xf(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,m!==null&&m.tag===6?(n(v,m.sibling),m=i(m,y),m.return=v,v=m):(n(v,m),m=_g(y,v.mode,x),m.return=v,v=m),s(v)):n(v,m)}return C}var Gc=OE(!0),FE=OE(!1),g0=Ga(null),m0=null,fc=null,Xy=null;function Ky(){Xy=fc=m0=null}function Jy(e){var t=g0.current;Lt(g0),e._currentValue=t}function Ov(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function bc(e,t){m0=e,Xy=fc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Er=!0),e.firstContext=null)}function vi(e){var t=e._currentValue;if(Xy!==e)if(e={context:e,memoizedValue:t,next:null},fc===null){if(m0===null)throw Error(fe(308));fc=e,m0.dependencies={lanes:0,firstContext:e}}else fc=fc.next=e;return t}var sl=null;function Yy(e){sl===null?sl=[e]:sl.push(e)}function ME(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Yy(t)):(n.next=i.next,i.next=n),t.interleaved=n,Fs(e,r)}function Fs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ca=!1;function qy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _s(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ra(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,dt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Fs(e,n)}return i=r.interleaved,i===null?(t.next=t,Yy(r)):(t.next=i.next,i.next=t),r.interleaved=t,Fs(e,n)}function Ih(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,My(e,n)}}function GI(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function v0(e,t,n,r){var i=e.updateQueue;ca=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(f=t,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Jt({},d,f);break e;case 2:ca=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);wl|=s,e.lanes=s,e.memoizedState=d}}function WI(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(fe(191,i));i.call(r)}}}var yf={},Oo=Ga(yf),Ld=Ga(yf),Ud=Ga(yf);function al(e){if(e===yf)throw Error(fe(174));return e}function Qy(e,t){switch(Rt(Ud,t),Rt(Ld,e),Rt(Oo,yf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gv(t,e)}Lt(Oo),Rt(Oo,t)}function Wc(){Lt(Oo),Lt(Ld),Lt(Ud)}function UE(e){al(Ud.current);var t=al(Oo.current),n=gv(t,e.type);t!==n&&(Rt(Ld,e),Rt(Oo,n))}function e1(e){Ld.current===e&&(Lt(Oo),Lt(Ld))}var Xt=Ga(0);function C0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wg=[];function t1(){for(var e=0;e<wg.length;e++)wg[e]._workInProgressVersionPrimary=null;wg.length=0}var bh=Ws.ReactCurrentDispatcher,Sg=Ws.ReactCurrentBatchConfig,Al=0,Kt=null,Cn=null,kn=null,y0=!1,pd=!1,Vd=0,LB=0;function zn(){throw Error(fe(321))}function n1(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ji(e[n],t[n]))return!1;return!0}function r1(e,t,n,r,i,o){if(Al=o,Kt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bh.current=e===null||e.memoizedState===null?WB:jB,e=n(r,i),pd){o=0;do{if(pd=!1,Vd=0,25<=o)throw Error(fe(301));o+=1,kn=Cn=null,t.updateQueue=null,bh.current=zB,e=n(r,i)}while(pd)}if(bh.current=x0,t=Cn!==null&&Cn.next!==null,Al=0,kn=Cn=Kt=null,y0=!1,t)throw Error(fe(300));return e}function i1(){var e=Vd!==0;return Vd=0,e}function ho(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?Kt.memoizedState=kn=e:kn=kn.next=e,kn}function Ci(){if(Cn===null){var e=Kt.alternate;e=e!==null?e.memoizedState:null}else e=Cn.next;var t=kn===null?Kt.memoizedState:kn.next;if(t!==null)kn=t,Cn=e;else{if(e===null)throw Error(fe(310));Cn=e,e={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},kn===null?Kt.memoizedState=kn=e:kn=kn.next=e}return kn}function Gd(e,t){return typeof t=="function"?t(e):t}function kg(e){var t=Ci(),n=t.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=e;var r=Cn,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((Al&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Kt.lanes|=u,wl|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,Ji(r,t.memoizedState)||(Er=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,Kt.lanes|=o,wl|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Eg(e){var t=Ci(),n=t.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Ji(o,t.memoizedState)||(Er=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function VE(){}function GE(e,t){var n=Kt,r=Ci(),i=t(),o=!Ji(r.memoizedState,i);if(o&&(r.memoizedState=i,Er=!0),r=r.queue,o1(zE.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||kn!==null&&kn.memoizedState.tag&1){if(n.flags|=2048,Wd(9,jE.bind(null,n,r,i,t),void 0,null),Tn===null)throw Error(fe(349));Al&30||WE(n,t,i)}return i}function WE(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Kt.updateQueue,t===null?(t={lastEffect:null,stores:null},Kt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function jE(e,t,n,r){t.value=n,t.getSnapshot=r,HE(t)&&ZE(e)}function zE(e,t,n){return n(function(){HE(t)&&ZE(e)})}function HE(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ji(e,n)}catch{return!0}}function ZE(e){var t=Fs(e,1);t!==null&&Xi(t,e,1,-1)}function jI(e){var t=ho();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gd,lastRenderedState:e},t.queue=e,e=e.dispatch=GB.bind(null,Kt,e),[t.memoizedState,e]}function Wd(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Kt.updateQueue,t===null?(t={lastEffect:null,stores:null},Kt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function $E(){return Ci().memoizedState}function Ah(e,t,n,r){var i=ho();Kt.flags|=e,i.memoizedState=Wd(1|t,n,void 0,r===void 0?null:r)}function xp(e,t,n,r){var i=Ci();r=r===void 0?null:r;var o=void 0;if(Cn!==null){var s=Cn.memoizedState;if(o=s.destroy,r!==null&&n1(r,s.deps)){i.memoizedState=Wd(t,n,o,r);return}}Kt.flags|=e,i.memoizedState=Wd(1|t,n,o,r)}function zI(e,t){return Ah(8390656,8,e,t)}function o1(e,t){return xp(2048,8,e,t)}function XE(e,t){return xp(4,2,e,t)}function KE(e,t){return xp(4,4,e,t)}function JE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function YE(e,t,n){return n=n!=null?n.concat([e]):null,xp(4,4,JE.bind(null,t,e),n)}function s1(){}function qE(e,t){var n=Ci();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&n1(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function QE(e,t){var n=Ci();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&n1(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function eT(e,t,n){return Al&21?(Ji(n,t)||(n=oE(),Kt.lanes|=n,wl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Er=!0),e.memoizedState=n)}function UB(e,t){var n=xt;xt=n!==0&&4>n?n:4,e(!0);var r=Sg.transition;Sg.transition={};try{e(!1),t()}finally{xt=n,Sg.transition=r}}function tT(){return Ci().memoizedState}function VB(e,t,n){var r=Da(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nT(e))rT(t,n);else if(n=ME(e,t,n,r),n!==null){var i=fr();Xi(n,e,r,i),iT(n,t,r)}}function GB(e,t,n){var r=Da(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nT(e))rT(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Ji(a,s)){var l=t.interleaved;l===null?(i.next=i,Yy(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=ME(e,t,i,r),n!==null&&(i=fr(),Xi(n,e,r,i),iT(n,t,r))}}function nT(e){var t=e.alternate;return e===Kt||t!==null&&t===Kt}function rT(e,t){pd=y0=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function iT(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,My(e,n)}}var x0={readContext:vi,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},WB={readContext:vi,useCallback:function(e,t){return ho().memoizedState=[e,t===void 0?null:t],e},useContext:vi,useEffect:zI,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ah(4194308,4,JE.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ah(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ah(4,2,e,t)},useMemo:function(e,t){var n=ho();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ho();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=VB.bind(null,Kt,e),[r.memoizedState,e]},useRef:function(e){var t=ho();return e={current:e},t.memoizedState=e},useState:jI,useDebugValue:s1,useDeferredValue:function(e){return ho().memoizedState=e},useTransition:function(){var e=jI(!1),t=e[0];return e=UB.bind(null,e[1]),ho().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Kt,i=ho();if($t){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=t(),Tn===null)throw Error(fe(349));Al&30||WE(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,zI(zE.bind(null,r,o,e),[e]),r.flags|=2048,Wd(9,jE.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=ho(),t=Tn.identifierPrefix;if($t){var n=rs,r=ns;n=(r&~(1<<32-$i(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Vd++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=LB++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jB={readContext:vi,useCallback:qE,useContext:vi,useEffect:o1,useImperativeHandle:YE,useInsertionEffect:XE,useLayoutEffect:KE,useMemo:QE,useReducer:kg,useRef:$E,useState:function(){return kg(Gd)},useDebugValue:s1,useDeferredValue:function(e){var t=Ci();return eT(t,Cn.memoizedState,e)},useTransition:function(){var e=kg(Gd)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:VE,useSyncExternalStore:GE,useId:tT,unstable_isNewReconciler:!1},zB={readContext:vi,useCallback:qE,useContext:vi,useEffect:o1,useImperativeHandle:YE,useInsertionEffect:XE,useLayoutEffect:KE,useMemo:QE,useReducer:Eg,useRef:$E,useState:function(){return Eg(Gd)},useDebugValue:s1,useDeferredValue:function(e){var t=Ci();return Cn===null?t.memoizedState=e:eT(t,Cn.memoizedState,e)},useTransition:function(){var e=Eg(Gd)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:VE,useSyncExternalStore:GE,useId:tT,unstable_isNewReconciler:!1};function Ei(e,t){if(e&&e.defaultProps){t=Jt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Fv(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Jt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ip={isMounted:function(e){return(e=e._reactInternals)?Ml(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=fr(),i=Da(e),o=_s(r,i);o.payload=t,n!=null&&(o.callback=n),t=Ra(e,o,i),t!==null&&(Xi(t,e,i,r),Ih(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=fr(),i=Da(e),o=_s(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Ra(e,o,i),t!==null&&(Xi(t,e,i,r),Ih(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=fr(),r=Da(e),i=_s(n,r);i.tag=2,t!=null&&(i.callback=t),t=Ra(e,i,r),t!==null&&(Xi(t,e,r,n),Ih(t,e,r))}};function HI(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!Bd(n,r)||!Bd(i,o):!0}function oT(e,t,n){var r=!1,i=Fa,o=t.contextType;return typeof o=="object"&&o!==null?o=vi(o):(i=_r(t)?Il:Yn.current,r=t.contextTypes,o=(r=r!=null)?Uc(e,i):Fa),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ip,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ZI(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ip.enqueueReplaceState(t,t.state,null)}function Mv(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},qy(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=vi(o):(o=_r(t)?Il:Yn.current,i.context=Uc(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Fv(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Ip.enqueueReplaceState(i,i.state,null),v0(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function jc(e,t){try{var n="",r=t;do n+=CN(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function Tg(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Lv(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var HB=typeof WeakMap=="function"?WeakMap:Map;function sT(e,t,n){n=_s(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){b0||(b0=!0,Xv=r),Lv(e,t)},n}function aT(e,t,n){n=_s(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Lv(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Lv(e,t),typeof r!="function"&&(_a===null?_a=new Set([this]):_a.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function $I(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new HB;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=o5.bind(null,e,t,n),t.then(e,e))}function XI(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function KI(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=_s(-1,1),t.tag=2,Ra(n,t,1))),n.lanes|=1),e)}var ZB=Ws.ReactCurrentOwner,Er=!1;function ir(e,t,n,r){t.child=e===null?FE(t,null,n,r):Gc(t,e.child,n,r)}function JI(e,t,n,r,i){n=n.render;var o=t.ref;return bc(t,i),r=r1(e,t,n,r,o,i),n=i1(),e!==null&&!Er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ms(e,t,i)):($t&&n&&Hy(t),t.flags|=1,ir(e,t,r,i),t.child)}function YI(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!p1(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,lT(e,t,o,r,i)):(e=Eh(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Bd,n(s,r)&&e.ref===t.ref)return Ms(e,t,i)}return t.flags|=1,e=Pa(o,r),e.ref=t.ref,e.return=t,t.child=e}function lT(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Bd(o,r)&&e.ref===t.ref)if(Er=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(Er=!0);else return t.lanes=e.lanes,Ms(e,t,i)}return Uv(e,t,n,r,i)}function cT(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rt(pc,Wr),Wr|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Rt(pc,Wr),Wr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Rt(pc,Wr),Wr|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Rt(pc,Wr),Wr|=r;return ir(e,t,i,n),t.child}function uT(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Uv(e,t,n,r,i){var o=_r(n)?Il:Yn.current;return o=Uc(t,o),bc(t,i),n=r1(e,t,n,r,o,i),r=i1(),e!==null&&!Er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ms(e,t,i)):($t&&r&&Hy(t),t.flags|=1,ir(e,t,n,i),t.child)}function qI(e,t,n,r,i){if(_r(n)){var o=!0;f0(t)}else o=!1;if(bc(t,i),t.stateNode===null)wh(e,t),oT(t,n,r),Mv(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=vi(c):(c=_r(n)?Il:Yn.current,c=Uc(t,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&ZI(t,s,r,c),ca=!1;var f=t.memoizedState;s.state=f,v0(t,r,s,i),l=t.memoizedState,a!==r||f!==l||Rr.current||ca?(typeof u=="function"&&(Fv(t,n,u,r),l=t.memoizedState),(a=ca||HI(t,n,a,r,f,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,LE(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Ei(t.type,a),s.props=c,d=t.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=vi(l):(l=_r(n)?Il:Yn.current,l=Uc(t,l));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||f!==l)&&ZI(t,s,r,l),ca=!1,f=t.memoizedState,s.state=f,v0(t,r,s,i);var p=t.memoizedState;a!==d||f!==p||Rr.current||ca?(typeof h=="function"&&(Fv(t,n,h,r),p=t.memoizedState),(c=ca||HI(t,n,c,r,f,p,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Vv(e,t,n,r,o,i)}function Vv(e,t,n,r,i,o){uT(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&MI(t,n,!1),Ms(e,t,o);r=t.stateNode,ZB.current=t;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=Gc(t,e.child,null,o),t.child=Gc(t,null,a,o)):ir(e,t,a,o),t.memoizedState=r.state,i&&MI(t,n,!0),t.child}function dT(e){var t=e.stateNode;t.pendingContext?FI(e,t.pendingContext,t.pendingContext!==t.context):t.context&&FI(e,t.context,!1),Qy(e,t.containerInfo)}function QI(e,t,n,r,i){return Vc(),$y(i),t.flags|=256,ir(e,t,n,r),t.child}var Gv={dehydrated:null,treeContext:null,retryLane:0};function Wv(e){return{baseLanes:e,cachePool:null,transitions:null}}function fT(e,t,n){var r=t.pendingProps,i=Xt.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Rt(Xt,i&1),e===null)return Bv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=wp(s,r,0,null),e=pl(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Wv(n),t.memoizedState=Gv,e):a1(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return $B(e,t,s,r,a,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Pa(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Pa(a,o):(o=pl(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?Wv(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=Gv,r}return o=e.child,e=o.sibling,r=Pa(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function a1(e,t){return t=wp({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Kf(e,t,n,r){return r!==null&&$y(r),Gc(t,e.child,null,n),e=a1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $B(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=Tg(Error(fe(422))),Kf(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=wp({mode:"visible",children:r.children},i,0,null),o=pl(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Gc(t,e.child,null,s),t.child.memoizedState=Wv(s),t.memoizedState=Gv,o);if(!(t.mode&1))return Kf(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(fe(419)),r=Tg(o,r,void 0),Kf(e,t,s,r)}if(a=(s&e.childLanes)!==0,Er||a){if(r=Tn,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Fs(e,i),Xi(r,e,i,-1))}return h1(),r=Tg(Error(fe(421))),Kf(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=s5.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Jr=Ta(i.nextSibling),Qr=t,$t=!0,Ui=null,e!==null&&(ui[di++]=ns,ui[di++]=rs,ui[di++]=bl,ns=e.id,rs=e.overflow,bl=t),t=a1(t,r.children),t.flags|=4096,t)}function eb(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ov(e.return,t,n)}function Rg(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function hT(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(ir(e,t,r.children,n),r=Xt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&eb(e,n,t);else if(e.tag===19)eb(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Rt(Xt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&C0(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Rg(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&C0(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Rg(t,!0,n,null,o);break;case"together":Rg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ms(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),wl|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(fe(153));if(t.child!==null){for(e=t.child,n=Pa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Pa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function XB(e,t,n){switch(t.tag){case 3:dT(t),Vc();break;case 5:UE(t);break;case 1:_r(t.type)&&f0(t);break;case 4:Qy(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Rt(g0,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Rt(Xt,Xt.current&1),t.flags|=128,null):n&t.child.childLanes?fT(e,t,n):(Rt(Xt,Xt.current&1),e=Ms(e,t,n),e!==null?e.sibling:null);Rt(Xt,Xt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return hT(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Rt(Xt,Xt.current),r)break;return null;case 22:case 23:return t.lanes=0,cT(e,t,n)}return Ms(e,t,n)}var pT,jv,gT,mT;pT=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jv=function(){};gT=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,al(Oo.current);var o=null;switch(n){case"input":i=dv(e,i),r=dv(e,r),o=[];break;case"select":i=Jt({},i,{value:void 0}),r=Jt({},r,{value:void 0}),o=[];break;case"textarea":i=pv(e,i),r=pv(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=u0)}mv(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ed.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ed.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Nt("scroll",e),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};mT=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ru(e,t){if(!$t)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Hn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function KB(e,t,n){var r=t.pendingProps;switch(Zy(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(t),null;case 1:return _r(t.type)&&d0(),Hn(t),null;case 3:return r=t.stateNode,Wc(),Lt(Rr),Lt(Yn),t1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&($f(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ui!==null&&(Yv(Ui),Ui=null))),jv(e,t),Hn(t),null;case 5:e1(t);var i=al(Ud.current);if(n=t.type,e!==null&&t.stateNode!=null)gT(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(fe(166));return Hn(t),null}if(e=al(Oo.current),$f(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[go]=t,r[Md]=o,e=(t.mode&1)!==0,n){case"dialog":Nt("cancel",r),Nt("close",r);break;case"iframe":case"object":case"embed":Nt("load",r);break;case"video":case"audio":for(i=0;i<Yu.length;i++)Nt(Yu[i],r);break;case"source":Nt("error",r);break;case"img":case"image":case"link":Nt("error",r),Nt("load",r);break;case"details":Nt("toggle",r);break;case"input":cI(r,o),Nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Nt("invalid",r);break;case"textarea":dI(r,o),Nt("invalid",r)}mv(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Zf(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Zf(r.textContent,a,e),i=["children",""+a]):Ed.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Nt("scroll",r)}switch(n){case"input":Lf(r),uI(r,o,!0);break;case"textarea":Lf(r),fI(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=u0)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=zk(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[go]=t,e[Md]=r,pT(e,t,!1,!1),t.stateNode=e;e:{switch(s=vv(n,r),n){case"dialog":Nt("cancel",e),Nt("close",e),i=r;break;case"iframe":case"object":case"embed":Nt("load",e),i=r;break;case"video":case"audio":for(i=0;i<Yu.length;i++)Nt(Yu[i],e);i=r;break;case"source":Nt("error",e),i=r;break;case"img":case"image":case"link":Nt("error",e),Nt("load",e),i=r;break;case"details":Nt("toggle",e),i=r;break;case"input":cI(e,r),i=dv(e,r),Nt("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Jt({},r,{value:void 0}),Nt("invalid",e);break;case"textarea":dI(e,r),i=pv(e,r),Nt("invalid",e);break;default:i=r}mv(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?$k(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Hk(e,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Td(e,l):typeof l=="number"&&Td(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ed.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Nt("scroll",e):l!=null&&Dy(e,o,l,s))}switch(n){case"input":Lf(e),uI(e,r,!1);break;case"textarea":Lf(e),fI(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Oa(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Cc(e,!!r.multiple,o,!1):r.defaultValue!=null&&Cc(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=u0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Hn(t),null;case 6:if(e&&t.stateNode!=null)mT(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(fe(166));if(n=al(Ud.current),al(Oo.current),$f(t)){if(r=t.stateNode,n=t.memoizedProps,r[go]=t,(o=r.nodeValue!==n)&&(e=Qr,e!==null))switch(e.tag){case 3:Zf(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Zf(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[go]=t,t.stateNode=r}return Hn(t),null;case 13:if(Lt(Xt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($t&&Jr!==null&&t.mode&1&&!(t.flags&128))BE(),Vc(),t.flags|=98560,o=!1;else if(o=$f(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(fe(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(fe(317));o[go]=t}else Vc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Hn(t),o=!1}else Ui!==null&&(Yv(Ui),Ui=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Xt.current&1?yn===0&&(yn=3):h1())),t.updateQueue!==null&&(t.flags|=4),Hn(t),null);case 4:return Wc(),jv(e,t),e===null&&Od(t.stateNode.containerInfo),Hn(t),null;case 10:return Jy(t.type._context),Hn(t),null;case 17:return _r(t.type)&&d0(),Hn(t),null;case 19:if(Lt(Xt),o=t.memoizedState,o===null)return Hn(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)Ru(o,!1);else{if(yn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=C0(e),s!==null){for(t.flags|=128,Ru(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Rt(Xt,Xt.current&1|2),t.child}e=e.sibling}o.tail!==null&&on()>zc&&(t.flags|=128,r=!0,Ru(o,!1),t.lanes=4194304)}else{if(!r)if(e=C0(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ru(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!$t)return Hn(t),null}else 2*on()-o.renderingStartTime>zc&&n!==1073741824&&(t.flags|=128,r=!0,Ru(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=on(),t.sibling=null,n=Xt.current,Rt(Xt,r?n&1|2:n&1),t):(Hn(t),null);case 22:case 23:return f1(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Wr&1073741824&&(Hn(t),t.subtreeFlags&6&&(t.flags|=8192)):Hn(t),null;case 24:return null;case 25:return null}throw Error(fe(156,t.tag))}function JB(e,t){switch(Zy(t),t.tag){case 1:return _r(t.type)&&d0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Wc(),Lt(Rr),Lt(Yn),t1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return e1(t),null;case 13:if(Lt(Xt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(fe(340));Vc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Lt(Xt),null;case 4:return Wc(),null;case 10:return Jy(t.type._context),null;case 22:case 23:return f1(),null;case 24:return null;default:return null}}var Jf=!1,$n=!1,YB=typeof WeakSet=="function"?WeakSet:Set,we=null;function hc(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qt(e,t,r)}else n.current=null}function zv(e,t,n){try{n()}catch(r){Qt(e,t,r)}}var tb=!1;function qB(e,t){if(Ev=a0,e=IE(),zy(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=e,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++c===i&&(a=s),f===o&&++u===r&&(l=s),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Tv={focusedElem:e,selectionRange:n},a0=!1,we=t;we!==null;)if(t=we,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,we=e;else for(;we!==null;){t=we;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,C=p.memoizedState,v=t.stateNode,m=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ei(t.type,g),C);v.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(x){Qt(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,we=e;break}we=t.return}return p=tb,tb=!1,p}function gd(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&zv(t,n,o)}i=i.next}while(i!==r)}}function bp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Hv(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function vT(e){var t=e.alternate;t!==null&&(e.alternate=null,vT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[go],delete t[Md],delete t[Dv],delete t[BB],delete t[OB])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function CT(e){return e.tag===5||e.tag===3||e.tag===4}function nb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||CT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Zv(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=u0));else if(r!==4&&(e=e.child,e!==null))for(Zv(e,t,n),e=e.sibling;e!==null;)Zv(e,t,n),e=e.sibling}function $v(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for($v(e,t,n),e=e.sibling;e!==null;)$v(e,t,n),e=e.sibling}var Dn=null,Fi=!1;function Ys(e,t,n){for(n=n.child;n!==null;)yT(e,t,n),n=n.sibling}function yT(e,t,n){if(Bo&&typeof Bo.onCommitFiberUnmount=="function")try{Bo.onCommitFiberUnmount(pp,n)}catch{}switch(n.tag){case 5:$n||hc(n,t);case 6:var r=Dn,i=Fi;Dn=null,Ys(e,t,n),Dn=r,Fi=i,Dn!==null&&(Fi?(e=Dn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Dn.removeChild(n.stateNode));break;case 18:Dn!==null&&(Fi?(e=Dn,n=n.stateNode,e.nodeType===8?bg(e.parentNode,n):e.nodeType===1&&bg(e,n),Pd(e)):bg(Dn,n.stateNode));break;case 4:r=Dn,i=Fi,Dn=n.stateNode.containerInfo,Fi=!0,Ys(e,t,n),Dn=r,Fi=i;break;case 0:case 11:case 14:case 15:if(!$n&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&zv(n,t,s),i=i.next}while(i!==r)}Ys(e,t,n);break;case 1:if(!$n&&(hc(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Qt(n,t,a)}Ys(e,t,n);break;case 21:Ys(e,t,n);break;case 22:n.mode&1?($n=(r=$n)||n.memoizedState!==null,Ys(e,t,n),$n=r):Ys(e,t,n);break;default:Ys(e,t,n)}}function rb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new YB),t.forEach(function(r){var i=a5.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function bi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Dn=a.stateNode,Fi=!1;break e;case 3:Dn=a.stateNode.containerInfo,Fi=!0;break e;case 4:Dn=a.stateNode.containerInfo,Fi=!0;break e}a=a.return}if(Dn===null)throw Error(fe(160));yT(o,s,i),Dn=null,Fi=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Qt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xT(t,e),t=t.sibling}function xT(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bi(t,e),oo(e),r&4){try{gd(3,e,e.return),bp(3,e)}catch(g){Qt(e,e.return,g)}try{gd(5,e,e.return)}catch(g){Qt(e,e.return,g)}}break;case 1:bi(t,e),oo(e),r&512&&n!==null&&hc(n,n.return);break;case 5:if(bi(t,e),oo(e),r&512&&n!==null&&hc(n,n.return),e.flags&32){var i=e.stateNode;try{Td(i,"")}catch(g){Qt(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Wk(i,o),vv(a,s);var c=vv(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?$k(i,d):u==="dangerouslySetInnerHTML"?Hk(i,d):u==="children"?Td(i,d):Dy(i,u,d,c)}switch(a){case"input":fv(i,o);break;case"textarea":jk(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Cc(i,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?Cc(i,!!o.multiple,o.defaultValue,!0):Cc(i,!!o.multiple,o.multiple?[]:"",!1))}i[Md]=o}catch(g){Qt(e,e.return,g)}}break;case 6:if(bi(t,e),oo(e),r&4){if(e.stateNode===null)throw Error(fe(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Qt(e,e.return,g)}}break;case 3:if(bi(t,e),oo(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Pd(t.containerInfo)}catch(g){Qt(e,e.return,g)}break;case 4:bi(t,e),oo(e);break;case 13:bi(t,e),oo(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(u1=on())),r&4&&rb(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?($n=(c=$n)||u,bi(t,e),$n=c):bi(t,e),oo(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(we=e,u=e.child;u!==null;){for(d=we=u;we!==null;){switch(f=we,h=f.child,f.tag){case 0:case 11:case 14:case 15:gd(4,f,f.return);break;case 1:hc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Qt(r,n,g)}}break;case 5:hc(f,f.return);break;case 22:if(f.memoizedState!==null){ob(d);continue}}h!==null?(h.return=f,we=h):ob(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Zk("display",s))}catch(g){Qt(e,e.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Qt(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:bi(t,e),oo(e),r&4&&rb(e);break;case 21:break;default:bi(t,e),oo(e)}}function oo(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(CT(n)){var r=n;break e}n=n.return}throw Error(fe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Td(i,""),r.flags&=-33);var o=nb(e);$v(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=nb(e);Zv(e,a,s);break;default:throw Error(fe(161))}}catch(l){Qt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function QB(e,t,n){we=e,IT(e)}function IT(e,t,n){for(var r=(e.mode&1)!==0;we!==null;){var i=we,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Jf;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||$n;a=Jf;var c=$n;if(Jf=s,($n=l)&&!c)for(we=i;we!==null;)s=we,l=s.child,s.tag===22&&s.memoizedState!==null?sb(i):l!==null?(l.return=s,we=l):sb(i);for(;o!==null;)we=o,IT(o),o=o.sibling;we=i,Jf=a,$n=c}ib(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,we=o):ib(e)}}function ib(e){for(;we!==null;){var t=we;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:$n||bp(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!$n)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Ei(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&WI(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}WI(t,s,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Pd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}$n||t.flags&512&&Hv(t)}catch(f){Qt(t,t.return,f)}}if(t===e){we=null;break}if(n=t.sibling,n!==null){n.return=t.return,we=n;break}we=t.return}}function ob(e){for(;we!==null;){var t=we;if(t===e){we=null;break}var n=t.sibling;if(n!==null){n.return=t.return,we=n;break}we=t.return}}function sb(e){for(;we!==null;){var t=we;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{bp(4,t)}catch(l){Qt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){Qt(t,i,l)}}var o=t.return;try{Hv(t)}catch(l){Qt(t,o,l)}break;case 5:var s=t.return;try{Hv(t)}catch(l){Qt(t,s,l)}}}catch(l){Qt(t,t.return,l)}if(t===e){we=null;break}var a=t.sibling;if(a!==null){a.return=t.return,we=a;break}we=t.return}}var e5=Math.ceil,I0=Ws.ReactCurrentDispatcher,l1=Ws.ReactCurrentOwner,mi=Ws.ReactCurrentBatchConfig,dt=0,Tn=null,dn=null,Fn=0,Wr=0,pc=Ga(0),yn=0,jd=null,wl=0,Ap=0,c1=0,md=null,Sr=null,u1=0,zc=1/0,Ko=null,b0=!1,Xv=null,_a=null,Yf=!1,ga=null,A0=0,vd=0,Kv=null,Sh=-1,kh=0;function fr(){return dt&6?on():Sh!==-1?Sh:Sh=on()}function Da(e){return e.mode&1?dt&2&&Fn!==0?Fn&-Fn:MB.transition!==null?(kh===0&&(kh=oE()),kh):(e=xt,e!==0||(e=window.event,e=e===void 0?16:fE(e.type)),e):1}function Xi(e,t,n,r){if(50<vd)throw vd=0,Kv=null,Error(fe(185));mf(e,n,r),(!(dt&2)||e!==Tn)&&(e===Tn&&(!(dt&2)&&(Ap|=n),yn===4&&fa(e,Fn)),Dr(e,r),n===1&&dt===0&&!(t.mode&1)&&(zc=on()+500,yp&&Wa()))}function Dr(e,t){var n=e.callbackNode;MN(e,t);var r=s0(e,e===Tn?Fn:0);if(r===0)n!==null&&gI(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&gI(n),t===1)e.tag===0?FB(ab.bind(null,e)):DE(ab.bind(null,e)),PB(function(){!(dt&6)&&Wa()}),n=null;else{switch(sE(r)){case 1:n=Fy;break;case 4:n=rE;break;case 16:n=o0;break;case 536870912:n=iE;break;default:n=o0}n=RT(n,bT.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function bT(e,t){if(Sh=-1,kh=0,dt&6)throw Error(fe(327));var n=e.callbackNode;if(Ac()&&e.callbackNode!==n)return null;var r=s0(e,e===Tn?Fn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=w0(e,r);else{t=r;var i=dt;dt|=2;var o=wT();(Tn!==e||Fn!==t)&&(Ko=null,zc=on()+500,hl(e,t));do try{r5();break}catch(a){AT(e,a)}while(!0);Ky(),I0.current=o,dt=i,dn!==null?t=0:(Tn=null,Fn=0,t=yn)}if(t!==0){if(t===2&&(i=bv(e),i!==0&&(r=i,t=Jv(e,i))),t===1)throw n=jd,hl(e,0),fa(e,r),Dr(e,on()),n;if(t===6)fa(e,r);else{if(i=e.current.alternate,!(r&30)&&!t5(i)&&(t=w0(e,r),t===2&&(o=bv(e),o!==0&&(r=o,t=Jv(e,o))),t===1))throw n=jd,hl(e,0),fa(e,r),Dr(e,on()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(fe(345));case 2:qa(e,Sr,Ko);break;case 3:if(fa(e,r),(r&130023424)===r&&(t=u1+500-on(),10<t)){if(s0(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){fr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=_v(qa.bind(null,e,Sr,Ko),t);break}qa(e,Sr,Ko);break;case 4:if(fa(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-$i(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=on()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*e5(r/1960))-r,10<r){e.timeoutHandle=_v(qa.bind(null,e,Sr,Ko),r);break}qa(e,Sr,Ko);break;case 5:qa(e,Sr,Ko);break;default:throw Error(fe(329))}}}return Dr(e,on()),e.callbackNode===n?bT.bind(null,e):null}function Jv(e,t){var n=md;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),e=w0(e,t),e!==2&&(t=Sr,Sr=n,t!==null&&Yv(t)),e}function Yv(e){Sr===null?Sr=e:Sr.push.apply(Sr,e)}function t5(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ji(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function fa(e,t){for(t&=~c1,t&=~Ap,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-$i(t),r=1<<n;e[n]=-1,t&=~r}}function ab(e){if(dt&6)throw Error(fe(327));Ac();var t=s0(e,0);if(!(t&1))return Dr(e,on()),null;var n=w0(e,t);if(e.tag!==0&&n===2){var r=bv(e);r!==0&&(t=r,n=Jv(e,r))}if(n===1)throw n=jd,hl(e,0),fa(e,t),Dr(e,on()),n;if(n===6)throw Error(fe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,qa(e,Sr,Ko),Dr(e,on()),null}function d1(e,t){var n=dt;dt|=1;try{return e(t)}finally{dt=n,dt===0&&(zc=on()+500,yp&&Wa())}}function Sl(e){ga!==null&&ga.tag===0&&!(dt&6)&&Ac();var t=dt;dt|=1;var n=mi.transition,r=xt;try{if(mi.transition=null,xt=1,e)return e()}finally{xt=r,mi.transition=n,dt=t,!(dt&6)&&Wa()}}function f1(){Wr=pc.current,Lt(pc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,DB(n)),dn!==null)for(n=dn.return;n!==null;){var r=n;switch(Zy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&d0();break;case 3:Wc(),Lt(Rr),Lt(Yn),t1();break;case 5:e1(r);break;case 4:Wc();break;case 13:Lt(Xt);break;case 19:Lt(Xt);break;case 10:Jy(r.type._context);break;case 22:case 23:f1()}n=n.return}if(Tn=e,dn=e=Pa(e.current,null),Fn=Wr=t,yn=0,jd=null,c1=Ap=wl=0,Sr=md=null,sl!==null){for(t=0;t<sl.length;t++)if(n=sl[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}sl=null}return e}function AT(e,t){do{var n=dn;try{if(Ky(),bh.current=x0,y0){for(var r=Kt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}y0=!1}if(Al=0,kn=Cn=Kt=null,pd=!1,Vd=0,l1.current=null,n===null||n.return===null){yn=1,jd=t,dn=null;break}e:{var o=e,s=n.return,a=n,l=t;if(t=Fn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=XI(s);if(h!==null){h.flags&=-257,KI(h,s,a,o,t),h.mode&1&&$I(o,c,t),t=h,l=c;var p=t.updateQueue;if(p===null){var g=new Set;g.add(l),t.updateQueue=g}else p.add(l);break e}else{if(!(t&1)){$I(o,c,t),h1();break e}l=Error(fe(426))}}else if($t&&a.mode&1){var C=XI(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),KI(C,s,a,o,t),$y(jc(l,a));break e}}o=l=jc(l,a),yn!==4&&(yn=2),md===null?md=[o]:md.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=sT(o,l,t);GI(o,v);break e;case 1:a=l;var m=o.type,y=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(_a===null||!_a.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t;var x=aT(o,a,t);GI(o,x);break e}}o=o.return}while(o!==null)}kT(n)}catch(b){t=b,dn===n&&n!==null&&(dn=n=n.return);continue}break}while(!0)}function wT(){var e=I0.current;return I0.current=x0,e===null?x0:e}function h1(){(yn===0||yn===3||yn===2)&&(yn=4),Tn===null||!(wl&268435455)&&!(Ap&268435455)||fa(Tn,Fn)}function w0(e,t){var n=dt;dt|=2;var r=wT();(Tn!==e||Fn!==t)&&(Ko=null,hl(e,t));do try{n5();break}catch(i){AT(e,i)}while(!0);if(Ky(),dt=n,I0.current=r,dn!==null)throw Error(fe(261));return Tn=null,Fn=0,yn}function n5(){for(;dn!==null;)ST(dn)}function r5(){for(;dn!==null&&!TN();)ST(dn)}function ST(e){var t=TT(e.alternate,e,Wr);e.memoizedProps=e.pendingProps,t===null?kT(e):dn=t,l1.current=null}function kT(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=JB(n,t),n!==null){n.flags&=32767,dn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{yn=6,dn=null;return}}else if(n=KB(n,t,Wr),n!==null){dn=n;return}if(t=t.sibling,t!==null){dn=t;return}dn=t=e}while(t!==null);yn===0&&(yn=5)}function qa(e,t,n){var r=xt,i=mi.transition;try{mi.transition=null,xt=1,i5(e,t,n,r)}finally{mi.transition=i,xt=r}return null}function i5(e,t,n,r){do Ac();while(ga!==null);if(dt&6)throw Error(fe(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(fe(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(LN(e,o),e===Tn&&(dn=Tn=null,Fn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yf||(Yf=!0,RT(o0,function(){return Ac(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=mi.transition,mi.transition=null;var s=xt;xt=1;var a=dt;dt|=4,l1.current=null,qB(e,n),xT(n,e),wB(Tv),a0=!!Ev,Tv=Ev=null,e.current=n,QB(n),RN(),dt=a,xt=s,mi.transition=o}else e.current=n;if(Yf&&(Yf=!1,ga=e,A0=i),o=e.pendingLanes,o===0&&(_a=null),PN(n.stateNode),Dr(e,on()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(b0)throw b0=!1,e=Xv,Xv=null,e;return A0&1&&e.tag!==0&&Ac(),o=e.pendingLanes,o&1?e===Kv?vd++:(vd=0,Kv=e):vd=0,Wa(),null}function Ac(){if(ga!==null){var e=sE(A0),t=mi.transition,n=xt;try{if(mi.transition=null,xt=16>e?16:e,ga===null)var r=!1;else{if(e=ga,ga=null,A0=0,dt&6)throw Error(fe(331));var i=dt;for(dt|=4,we=e.current;we!==null;){var o=we,s=o.child;if(we.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(we=c;we!==null;){var u=we;switch(u.tag){case 0:case 11:case 15:gd(8,u,o)}var d=u.child;if(d!==null)d.return=u,we=d;else for(;we!==null;){u=we;var f=u.sibling,h=u.return;if(vT(u),u===c){we=null;break}if(f!==null){f.return=h,we=f;break}we=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var C=g.sibling;g.sibling=null,g=C}while(g!==null)}}we=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,we=s;else e:for(;we!==null;){if(o=we,o.flags&2048)switch(o.tag){case 0:case 11:case 15:gd(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,we=v;break e}we=o.return}}var m=e.current;for(we=m;we!==null;){s=we;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,we=y;else e:for(s=m;we!==null;){if(a=we,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bp(9,a)}}catch(b){Qt(a,a.return,b)}if(a===s){we=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,we=x;break e}we=a.return}}if(dt=i,Wa(),Bo&&typeof Bo.onPostCommitFiberRoot=="function")try{Bo.onPostCommitFiberRoot(pp,e)}catch{}r=!0}return r}finally{xt=n,mi.transition=t}}return!1}function lb(e,t,n){t=jc(n,t),t=sT(e,t,1),e=Ra(e,t,1),t=fr(),e!==null&&(mf(e,1,t),Dr(e,t))}function Qt(e,t,n){if(e.tag===3)lb(e,e,n);else for(;t!==null;){if(t.tag===3){lb(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_a===null||!_a.has(r))){e=jc(n,e),e=aT(t,e,1),t=Ra(t,e,1),e=fr(),t!==null&&(mf(t,1,e),Dr(t,e));break}}t=t.return}}function o5(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=fr(),e.pingedLanes|=e.suspendedLanes&n,Tn===e&&(Fn&n)===n&&(yn===4||yn===3&&(Fn&130023424)===Fn&&500>on()-u1?hl(e,0):c1|=n),Dr(e,t)}function ET(e,t){t===0&&(e.mode&1?(t=Gf,Gf<<=1,!(Gf&130023424)&&(Gf=4194304)):t=1);var n=fr();e=Fs(e,t),e!==null&&(mf(e,t,n),Dr(e,n))}function s5(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),ET(e,n)}function a5(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(fe(314))}r!==null&&r.delete(t),ET(e,n)}var TT;TT=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Rr.current)Er=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Er=!1,XB(e,t,n);Er=!!(e.flags&131072)}else Er=!1,$t&&t.flags&1048576&&PE(t,p0,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;wh(e,t),e=t.pendingProps;var i=Uc(t,Yn.current);bc(t,n),i=r1(null,t,r,e,i,n);var o=i1();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_r(r)?(o=!0,f0(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,qy(t),i.updater=Ip,t.stateNode=i,i._reactInternals=t,Mv(t,r,e,n),t=Vv(null,t,r,!0,o,n)):(t.tag=0,$t&&o&&Hy(t),ir(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(wh(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=c5(r),e=Ei(r,e),i){case 0:t=Uv(null,t,r,e,n);break e;case 1:t=qI(null,t,r,e,n);break e;case 11:t=JI(null,t,r,e,n);break e;case 14:t=YI(null,t,r,Ei(r.type,e),n);break e}throw Error(fe(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ei(r,i),Uv(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ei(r,i),qI(e,t,r,i,n);case 3:e:{if(dT(t),e===null)throw Error(fe(387));r=t.pendingProps,o=t.memoizedState,i=o.element,LE(e,t),v0(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=jc(Error(fe(423)),t),t=QI(e,t,r,n,i);break e}else if(r!==i){i=jc(Error(fe(424)),t),t=QI(e,t,r,n,i);break e}else for(Jr=Ta(t.stateNode.containerInfo.firstChild),Qr=t,$t=!0,Ui=null,n=FE(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Vc(),r===i){t=Ms(e,t,n);break e}ir(e,t,r,n)}t=t.child}return t;case 5:return UE(t),e===null&&Bv(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,Rv(r,i)?s=null:o!==null&&Rv(r,o)&&(t.flags|=32),uT(e,t),ir(e,t,s,n),t.child;case 6:return e===null&&Bv(t),null;case 13:return fT(e,t,n);case 4:return Qy(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Gc(t,null,r,n):ir(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ei(r,i),JI(e,t,r,i,n);case 7:return ir(e,t,t.pendingProps,n),t.child;case 8:return ir(e,t,t.pendingProps.children,n),t.child;case 12:return ir(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Rt(g0,r._currentValue),r._currentValue=s,o!==null)if(Ji(o.value,s)){if(o.children===i.children&&!Rr.current){t=Ms(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=_s(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ov(o.return,n,t),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(fe(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Ov(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}ir(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,bc(t,n),i=vi(i),r=r(i),t.flags|=1,ir(e,t,r,n),t.child;case 14:return r=t.type,i=Ei(r,t.pendingProps),i=Ei(r.type,i),YI(e,t,r,i,n);case 15:return lT(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ei(r,i),wh(e,t),t.tag=1,_r(r)?(e=!0,f0(t)):e=!1,bc(t,n),oT(t,r,i),Mv(t,r,i,n),Vv(null,t,r,!0,e,n);case 19:return hT(e,t,n);case 22:return cT(e,t,n)}throw Error(fe(156,t.tag))};function RT(e,t){return nE(e,t)}function l5(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(e,t,n,r){return new l5(e,t,n,r)}function p1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function c5(e){if(typeof e=="function")return p1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ny)return 11;if(e===By)return 14}return 2}function Pa(e,t){var n=e.alternate;return n===null?(n=hi(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Eh(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")p1(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case ic:return pl(n.children,i,o,t);case Py:s=8,i|=8;break;case av:return e=hi(12,n,t,i|2),e.elementType=av,e.lanes=o,e;case lv:return e=hi(13,n,t,i),e.elementType=lv,e.lanes=o,e;case cv:return e=hi(19,n,t,i),e.elementType=cv,e.lanes=o,e;case Uk:return wp(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Mk:s=10;break e;case Lk:s=9;break e;case Ny:s=11;break e;case By:s=14;break e;case la:s=16,r=null;break e}throw Error(fe(130,e==null?e:typeof e,""))}return t=hi(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function pl(e,t,n,r){return e=hi(7,e,r,t),e.lanes=n,e}function wp(e,t,n,r){return e=hi(22,e,r,t),e.elementType=Uk,e.lanes=n,e.stateNode={isHidden:!1},e}function _g(e,t,n){return e=hi(6,e,null,t),e.lanes=n,e}function Dg(e,t,n){return t=hi(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function u5(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dg(0),this.expirationTimes=dg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function g1(e,t,n,r,i,o,s,a,l){return e=new u5(e,t,n,a,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=hi(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qy(o),e}function d5(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rc,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function _T(e){if(!e)return Fa;e=e._reactInternals;e:{if(Ml(e)!==e||e.tag!==1)throw Error(fe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_r(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(fe(171))}if(e.tag===1){var n=e.type;if(_r(n))return _E(e,n,t)}return t}function DT(e,t,n,r,i,o,s,a,l){return e=g1(n,r,!0,e,i,o,s,a,l),e.context=_T(null),n=e.current,r=fr(),i=Da(n),o=_s(r,i),o.callback=t??null,Ra(n,o,i),e.current.lanes=i,mf(e,i,r),Dr(e,r),e}function Sp(e,t,n,r){var i=t.current,o=fr(),s=Da(i);return n=_T(n),t.context===null?t.context=n:t.pendingContext=n,t=_s(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ra(i,t,s),e!==null&&(Xi(e,i,s,o),Ih(e,i,s)),s}function S0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function cb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function m1(e,t){cb(e,t),(e=e.alternate)&&cb(e,t)}function f5(){return null}var PT=typeof reportError=="function"?reportError:function(e){console.error(e)};function v1(e){this._internalRoot=e}kp.prototype.render=v1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(fe(409));Sp(e,t,null,null)};kp.prototype.unmount=v1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Sl(function(){Sp(null,e,null,null)}),t[Os]=null}};function kp(e){this._internalRoot=e}kp.prototype.unstable_scheduleHydration=function(e){if(e){var t=cE();e={blockedOn:null,target:e,priority:t};for(var n=0;n<da.length&&t!==0&&t<da[n].priority;n++);da.splice(n,0,e),n===0&&dE(e)}};function C1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ep(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ub(){}function h5(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=S0(s);o.call(c)}}var s=DT(t,r,e,0,null,!1,!1,"",ub);return e._reactRootContainer=s,e[Os]=s.current,Od(e.nodeType===8?e.parentNode:e),Sl(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=S0(l);a.call(c)}}var l=g1(e,0,!1,null,null,!1,!1,"",ub);return e._reactRootContainer=l,e[Os]=l.current,Od(e.nodeType===8?e.parentNode:e),Sl(function(){Sp(t,l,n,r)}),l}function Tp(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=S0(s);a.call(l)}}Sp(t,s,e,i)}else s=h5(n,t,e,i,r);return S0(s)}aE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ju(t.pendingLanes);n!==0&&(My(t,n|1),Dr(t,on()),!(dt&6)&&(zc=on()+500,Wa()))}break;case 13:Sl(function(){var r=Fs(e,1);if(r!==null){var i=fr();Xi(r,e,1,i)}}),m1(e,1)}};Ly=function(e){if(e.tag===13){var t=Fs(e,134217728);if(t!==null){var n=fr();Xi(t,e,134217728,n)}m1(e,134217728)}};lE=function(e){if(e.tag===13){var t=Da(e),n=Fs(e,t);if(n!==null){var r=fr();Xi(n,e,t,r)}m1(e,t)}};cE=function(){return xt};uE=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}};yv=function(e,t,n){switch(t){case"input":if(fv(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Cp(r);if(!i)throw Error(fe(90));Gk(r),fv(r,i)}}}break;case"textarea":jk(e,n);break;case"select":t=n.value,t!=null&&Cc(e,!!n.multiple,t,!1)}};Jk=d1;Yk=Sl;var p5={usingClientEntryPoint:!1,Events:[Cf,lc,Cp,Xk,Kk,d1]},_u={findFiberByHostInstance:ol,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},g5={bundleType:_u.bundleType,version:_u.version,rendererPackageName:_u.rendererPackageName,rendererConfig:_u.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=eE(e),e===null?null:e.stateNode},findFiberByHostInstance:_u.findFiberByHostInstance||f5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qf.isDisabled&&qf.supportsFiber)try{pp=qf.inject(g5),Bo=qf}catch{}}ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p5;ri.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C1(t))throw Error(fe(200));return d5(e,t,null,n)};ri.createRoot=function(e,t){if(!C1(e))throw Error(fe(299));var n=!1,r="",i=PT;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=g1(e,1,!1,null,null,n,!1,r,i),e[Os]=t.current,Od(e.nodeType===8?e.parentNode:e),new v1(t)};ri.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(fe(188)):(e=Object.keys(e).join(","),Error(fe(268,e)));return e=eE(t),e=e===null?null:e.stateNode,e};ri.flushSync=function(e){return Sl(e)};ri.hydrate=function(e,t,n){if(!Ep(t))throw Error(fe(200));return Tp(null,e,t,!0,n)};ri.hydrateRoot=function(e,t,n){if(!C1(e))throw Error(fe(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=PT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=DT(t,null,e,1,n??null,i,!1,o,s),e[Os]=t.current,Od(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new kp(t)};ri.render=function(e,t,n){if(!Ep(t))throw Error(fe(200));return Tp(null,e,t,!1,n)};ri.unmountComponentAtNode=function(e){if(!Ep(e))throw Error(fe(40));return e._reactRootContainer?(Sl(function(){Tp(null,null,e,!1,function(){e._reactRootContainer=null,e[Os]=null})}),!0):!1};ri.unstable_batchedUpdates=d1;ri.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ep(n))throw Error(fe(200));if(e==null||e._reactInternals===void 0)throw Error(fe(38));return Tp(e,t,n,!1,r)};ri.version="18.3.1-next-f1338f8080-20240426";function NT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(NT)}catch(e){console.error(e)}}NT(),Nk.exports=ri;var y1=Nk.exports;const m5=tu(y1),v5=Ik({__proto__:null,default:m5},[y1]);var db=y1;ov.createRoot=db.createRoot,ov.hydrateRoot=db.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ht(){return Ht=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ht.apply(this,arguments)}var un;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(un||(un={}));const fb="popstate";function C5(e){e===void 0&&(e={});function t(r,i){let{pathname:o,search:s,hash:a}=r.location;return zd("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:xf(i)}return x5(t,n,null,e)}function ut(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Hc(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function y5(){return Math.random().toString(36).substr(2,8)}function hb(e,t){return{usr:e.state,key:e.key,idx:t}}function zd(e,t,n,r){return n===void 0&&(n=null),Ht({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ja(t):t,{state:n,key:t&&t.key||r||y5()})}function xf(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ja(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function x5(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=un.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(Ht({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=un.Pop;let C=u(),v=C==null?null:C-c;c=C,l&&l({action:a,location:g.location,delta:v})}function f(C,v){a=un.Push;let m=zd(g.location,C,v);c=u()+1;let y=hb(m,c),x=g.createHref(m);try{s.pushState(y,"",x)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(x)}o&&l&&l({action:a,location:g.location,delta:1})}function h(C,v){a=un.Replace;let m=zd(g.location,C,v);c=u();let y=hb(m,c),x=g.createHref(m);s.replaceState(y,"",x),o&&l&&l({action:a,location:g.location,delta:0})}function p(C){let v=i.location.origin!=="null"?i.location.origin:i.location.href,m=typeof C=="string"?C:xf(C);return m=m.replace(/ $/,"%20"),ut(v,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,v)}let g={get action(){return a},get location(){return e(i,s)},listen(C){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(fb,d),l=C,()=>{i.removeEventListener(fb,d),l=null}},createHref(C){return t(i,C)},createURL:p,encodeLocation(C){let v=p(C);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(C){return s.go(C)}};return g}var vt;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(vt||(vt={}));const I5=new Set(["lazy","caseSensitive","path","id","index","children"]);function b5(e){return e.index===!0}function k0(e,t,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),e.map((i,o)=>{let s=[...n,String(o)],a=typeof i.id=="string"?i.id:s.join("-");if(ut(i.index!==!0||!i.children,"Cannot specify children on an index route"),ut(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),b5(i)){let l=Ht({},i,t(i),{id:a});return r[a]=l,l}else{let l=Ht({},i,t(i),{id:a,children:void 0});return r[a]=l,i.children&&(l.children=k0(i.children,t,s,r)),l}})}function Qa(e,t,n){return n===void 0&&(n="/"),Th(e,t,n,!1)}function Th(e,t,n,r){let i=typeof t=="string"?ja(t):t,o=If(i.pathname||"/",n);if(o==null)return null;let s=BT(e);w5(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let c=O5(o);a=N5(s[l],c,r)}return a}function A5(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}function BT(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};l.relativePath.startsWith("/")&&(ut(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=gl([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(ut(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),BT(o.children,t,u,c)),!(o.path==null&&!o.index)&&t.push({path:c,score:D5(c,o.index),routesMeta:u})};return e.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let l of OT(o.path))i(o,s,l)}),t}function OT(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=OT(r.join("/")),a=[];return a.push(...s.map(l=>l===""?o:[o,l].join("/"))),i&&a.push(...s),a.map(l=>e.startsWith("/")&&l===""?"/":l)}function w5(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:P5(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const S5=/^:[\w-]+$/,k5=3,E5=2,T5=1,R5=10,_5=-2,pb=e=>e==="*";function D5(e,t){let n=e.split("/"),r=n.length;return n.some(pb)&&(r+=_5),t&&(r+=E5),n.filter(i=>!pb(i)).reduce((i,o)=>i+(S5.test(o)?k5:o===""?T5:R5),r)}function P5(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function N5(e,t,n){n===void 0&&(n=!1);let{routesMeta:r}=e,i={},o="/",s=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=gb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=gb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:gl([o,d.pathname]),pathnameBase:V5(gl([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=gl([o,d.pathnameBase]))}return s}function gb(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=B5(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let g=a[d]||"";s=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:s,pattern:e}}function B5(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Hc(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function O5(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Hc(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function If(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function F5(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?ja(e):e;return{pathname:n?n.startsWith("/")?n:M5(n,t):t,search:G5(r),hash:W5(i)}}function M5(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Pg(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function FT(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function L5(e,t){let n=FT(e);return t?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function U5(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=ja(e):(i=Ht({},e),ut(!i.pathname||!i.pathname.includes("?"),Pg("?","pathname","search",i)),ut(!i.pathname||!i.pathname.includes("#"),Pg("#","pathname","hash",i)),ut(!i.search||!i.search.includes("#"),Pg("#","search","hash",i)));let o=e===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=t.length-1;if(!r&&s.startsWith("..")){let f=s.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?t[d]:"/"}let l=F5(i,a),c=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const gl=e=>e.join("/").replace(/\/\/+/g,"/"),V5=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),G5=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,W5=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class E0{constructor(t,n,r,i){i===void 0&&(i=!1),this.status=t,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Hd(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const MT=["post","put","patch","delete"],j5=new Set(MT),z5=["get",...MT],H5=new Set(z5),Z5=new Set([301,302,303,307,308]),$5=new Set([307,308]),Ng={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},X5={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Du={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},x1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,K5=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),LT="remix-router-transitions";function J5(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",r=!n;ut(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(e.mapRouteProperties)i=e.mapRouteProperties;else if(e.detectErrorBoundary){let V=e.detectErrorBoundary;i=H=>({hasErrorBoundary:V(H)})}else i=K5;let o={},s=k0(e.routes,i,void 0,o),a,l=e.basename||"/",c=e.dataStrategy||e4,u=e.patchRoutesOnNavigation,d=Ht({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),f=null,h=new Set,p=null,g=null,C=null,v=e.hydrationData!=null,m=Qa(s,e.history.location,l),y=!1,x=null;if(m==null&&!u){let V=Ir(404,{pathname:e.history.location.pathname}),{matches:H,route:K}=kb(s);m=H,x={[K.id]:V}}m&&!e.hydrationData&&Xs(m,s,e.history.location.pathname).active&&(m=null);let b;if(m)if(m.some(V=>V.route.lazy))b=!1;else if(!m.some(V=>V.route.loader))b=!0;else if(d.v7_partialHydration){let V=e.hydrationData?e.hydrationData.loaderData:null,H=e.hydrationData?e.hydrationData.errors:null;if(H){let K=m.findIndex(le=>H[le.route.id]!==void 0);b=m.slice(0,K+1).every(le=>!Qv(le.route,V,H))}else b=m.every(K=>!Qv(K.route,V,H))}else b=e.hydrationData!=null;else if(b=!1,m=[],d.v7_partialHydration){let V=Xs(null,s,e.history.location.pathname);V.active&&V.matches&&(y=!0,m=V.matches)}let k,A={historyAction:e.history.action,location:e.history.location,matches:m,initialized:b,navigation:Ng,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||x,fetchers:new Map,blockers:new Map},E=un.Pop,D=!1,T,R=!1,P=new Map,L=null,z=!1,Z=!1,Q=[],ie=new Set,$=new Map,q=0,te=-1,O=new Map,j=new Set,J=new Map,ee=new Map,se=new Set,me=new Map,Be=new Map,ae;function Dt(){if(f=e.history.listen(V=>{let{action:H,location:K,delta:le}=V;if(ae){ae(),ae=void 0;return}Hc(Be.size===0||le!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ge=io({currentLocation:A.location,nextLocation:K,historyAction:H});if(ge&&le!=null){let De=new Promise(Fe=>{ae=Fe});e.history.go(le*-1),Ii(ge,{state:"blocked",location:K,proceed(){Ii(ge,{state:"proceeding",proceed:void 0,reset:void 0,location:K}),De.then(()=>e.history.go(le))},reset(){let Fe=new Map(A.blockers);Fe.set(ge,Du),ze({blockers:Fe})}});return}return Ce(H,K)}),n){p4(t,P);let V=()=>g4(t,P);t.addEventListener("pagehide",V),L=()=>t.removeEventListener("pagehide",V)}return A.initialized||Ce(un.Pop,A.location,{initialHydration:!0}),k}function Gt(){f&&f(),L&&L(),h.clear(),T&&T.abort(),A.fetchers.forEach((V,H)=>W(H)),A.blockers.forEach((V,H)=>nt(H))}function fn(V){return h.add(V),()=>h.delete(V)}function ze(V,H){H===void 0&&(H={}),A=Ht({},A,V);let K=[],le=[];d.v7_fetcherPersist&&A.fetchers.forEach((ge,De)=>{ge.state==="idle"&&(se.has(De)?le.push(De):K.push(De))}),se.forEach(ge=>{!A.fetchers.has(ge)&&!$.has(ge)&&le.push(ge)}),[...h].forEach(ge=>ge(A,{deletedFetchers:le,viewTransitionOpts:H.viewTransitionOpts,flushSync:H.flushSync===!0})),d.v7_fetcherPersist?(K.forEach(ge=>A.fetchers.delete(ge)),le.forEach(ge=>W(ge))):le.forEach(ge=>se.delete(ge))}function ot(V,H,K){var le,ge;let{flushSync:De}=K===void 0?{}:K,Fe=A.actionData!=null&&A.navigation.formMethod!=null&&Mi(A.navigation.formMethod)&&A.navigation.state==="loading"&&((le=V.state)==null?void 0:le._isRedirect)!==!0,ke;H.actionData?Object.keys(H.actionData).length>0?ke=H.actionData:ke=null:Fe?ke=A.actionData:ke=null;let Ie=H.loaderData?wb(A.loaderData,H.loaderData,H.matches||[],H.errors):A.loaderData,be=A.blockers;be.size>0&&(be=new Map(be),be.forEach((Je,hn)=>be.set(hn,Du)));let Re=D===!0||A.navigation.formMethod!=null&&Mi(A.navigation.formMethod)&&((ge=V.state)==null?void 0:ge._isRedirect)!==!0;a&&(s=a,a=void 0),z||E===un.Pop||(E===un.Push?e.history.push(V,V.state):E===un.Replace&&e.history.replace(V,V.state));let Ge;if(E===un.Pop){let Je=P.get(A.location.pathname);Je&&Je.has(V.pathname)?Ge={currentLocation:A.location,nextLocation:V}:P.has(V.pathname)&&(Ge={currentLocation:V,nextLocation:A.location})}else if(R){let Je=P.get(A.location.pathname);Je?Je.add(V.pathname):(Je=new Set([V.pathname]),P.set(A.location.pathname,Je)),Ge={currentLocation:A.location,nextLocation:V}}ze(Ht({},H,{actionData:ke,loaderData:Ie,historyAction:E,location:V,initialized:!0,navigation:Ng,revalidation:"idle",restoreScrollPosition:si(V,H.matches||A.matches),preventScrollReset:Re,blockers:be}),{viewTransitionOpts:Ge,flushSync:De===!0}),E=un.Pop,D=!1,R=!1,z=!1,Z=!1,Q=[]}async function st(V,H){if(typeof V=="number"){e.history.go(V);return}let K=qv(A.location,A.matches,l,d.v7_prependBasename,V,d.v7_relativeSplatPath,H==null?void 0:H.fromRouteId,H==null?void 0:H.relative),{path:le,submission:ge,error:De}=mb(d.v7_normalizeFormMethod,!1,K,H),Fe=A.location,ke=zd(A.location,le,H&&H.state);ke=Ht({},ke,e.history.encodeLocation(ke));let Ie=H&&H.replace!=null?H.replace:void 0,be=un.Push;Ie===!0?be=un.Replace:Ie===!1||ge!=null&&Mi(ge.formMethod)&&ge.formAction===A.location.pathname+A.location.search&&(be=un.Replace);let Re=H&&"preventScrollReset"in H?H.preventScrollReset===!0:void 0,Ge=(H&&H.flushSync)===!0,Je=io({currentLocation:Fe,nextLocation:ke,historyAction:be});if(Je){Ii(Je,{state:"blocked",location:ke,proceed(){Ii(Je,{state:"proceeding",proceed:void 0,reset:void 0,location:ke}),st(V,H)},reset(){let hn=new Map(A.blockers);hn.set(Je,Du),ze({blockers:hn})}});return}return await Ce(be,ke,{submission:ge,pendingError:De,preventScrollReset:Re,replace:H&&H.replace,enableViewTransition:H&&H.viewTransition,flushSync:Ge})}function he(){if(_(),ze({revalidation:"loading"}),A.navigation.state!=="submitting"){if(A.navigation.state==="idle"){Ce(A.historyAction,A.location,{startUninterruptedRevalidation:!0});return}Ce(E||A.historyAction,A.navigation.location,{overrideNavigation:A.navigation,enableViewTransition:R===!0})}}async function Ce(V,H,K){T&&T.abort(),T=null,E=V,z=(K&&K.startUninterruptedRevalidation)===!0,Yt(A.location,A.matches),D=(K&&K.preventScrollReset)===!0,R=(K&&K.enableViewTransition)===!0;let le=a||s,ge=K&&K.overrideNavigation,De=K!=null&&K.initialHydration&&A.matches&&A.matches.length>0&&!y?A.matches:Qa(le,H,l),Fe=(K&&K.flushSync)===!0;if(De&&A.initialized&&!Z&&s4(A.location,H)&&!(K&&K.submission&&Mi(K.submission.formMethod))){ot(H,{matches:De},{flushSync:Fe});return}let ke=Xs(De,le,H.pathname);if(ke.active&&ke.matches&&(De=ke.matches),!De){let{error:pe,notFoundMatches:U,route:oe}=Ka(H.pathname);ot(H,{matches:U,loaderData:{},errors:{[oe.id]:pe}},{flushSync:Fe});return}T=new AbortController;let Ie=Jl(e.history,H,T.signal,K&&K.submission),be;if(K&&K.pendingError)be=[el(De).route.id,{type:vt.error,error:K.pendingError}];else if(K&&K.submission&&Mi(K.submission.formMethod)){let pe=await Ve(Ie,H,K.submission,De,ke.active,{replace:K.replace,flushSync:Fe});if(pe.shortCircuited)return;if(pe.pendingActionResult){let[U,oe]=pe.pendingActionResult;if($r(oe)&&Hd(oe.error)&&oe.error.status===404){T=null,ot(H,{matches:pe.matches,loaderData:{},errors:{[U]:oe.error}});return}}De=pe.matches||De,be=pe.pendingActionResult,ge=Bg(H,K.submission),Fe=!1,ke.active=!1,Ie=Jl(e.history,Ie.url,Ie.signal)}let{shortCircuited:Re,matches:Ge,loaderData:Je,errors:hn}=await Ue(Ie,H,De,ke.active,ge,K&&K.submission,K&&K.fetcherSubmission,K&&K.replace,K&&K.initialHydration===!0,Fe,be);Re||(T=null,ot(H,Ht({matches:Ge||De},Sb(be),{loaderData:Je,errors:hn})))}async function Ve(V,H,K,le,ge,De){De===void 0&&(De={}),_();let Fe=f4(H,K);if(ze({navigation:Fe},{flushSync:De.flushSync===!0}),ge){let be=await Zo(le,H.pathname,V.signal);if(be.type==="aborted")return{shortCircuited:!0};if(be.type==="error"){let Re=el(be.partialMatches).route.id;return{matches:be.partialMatches,pendingActionResult:[Re,{type:vt.error,error:be.error}]}}else if(be.matches)le=be.matches;else{let{notFoundMatches:Re,error:Ge,route:Je}=Ka(H.pathname);return{matches:Re,pendingActionResult:[Je.id,{type:vt.error,error:Ge}]}}}let ke,Ie=qu(le,H);if(!Ie.route.action&&!Ie.route.lazy)ke={type:vt.error,error:Ir(405,{method:V.method,pathname:H.pathname,routeId:Ie.route.id})};else if(ke=(await wt("action",A,V,[Ie],le,null))[Ie.route.id],V.signal.aborted)return{shortCircuited:!0};if(ll(ke)){let be;return De&&De.replace!=null?be=De.replace:be=Ib(ke.response.headers.get("Location"),new URL(V.url),l)===A.location.pathname+A.location.search,await jt(V,ke,!0,{submission:K,replace:be}),{shortCircuited:!0}}if(ma(ke))throw Ir(400,{type:"defer-action"});if($r(ke)){let be=el(le,Ie.route.id);return(De&&De.replace)!==!0&&(E=un.Push),{matches:le,pendingActionResult:[be.route.id,ke]}}return{matches:le,pendingActionResult:[Ie.route.id,ke]}}async function Ue(V,H,K,le,ge,De,Fe,ke,Ie,be,Re){let Ge=ge||Bg(H,De),Je=De||Fe||Tb(Ge),hn=!z&&(!d.v7_partialHydration||!Ie);if(le){if(hn){let Pt=Pe(Re);ze(Ht({navigation:Ge},Pt!==void 0?{actionData:Pt}:{}),{flushSync:be})}let rt=await Zo(K,H.pathname,V.signal);if(rt.type==="aborted")return{shortCircuited:!0};if(rt.type==="error"){let Pt=el(rt.partialMatches).route.id;return{matches:rt.partialMatches,loaderData:{},errors:{[Pt]:rt.error}}}else if(rt.matches)K=rt.matches;else{let{error:Pt,notFoundMatches:$l,route:bu}=Ka(H.pathname);return{matches:$l,loaderData:{},errors:{[bu.id]:Pt}}}}let pe=a||s,[U,oe]=Cb(e.history,A,K,Je,H,d.v7_partialHydration&&Ie===!0,d.v7_skipActionErrorRevalidation,Z,Q,ie,se,J,j,pe,l,Re);if(oi(rt=>!(K&&K.some(Pt=>Pt.route.id===rt))||U&&U.some(Pt=>Pt.route.id===rt)),te=++q,U.length===0&&oe.length===0){let rt=tt();return ot(H,Ht({matches:K,loaderData:{},errors:Re&&$r(Re[1])?{[Re[0]]:Re[1].error}:null},Sb(Re),rt?{fetchers:new Map(A.fetchers)}:{}),{flushSync:be}),{shortCircuited:!0}}if(hn){let rt={};if(!le){rt.navigation=Ge;let Pt=Pe(Re);Pt!==void 0&&(rt.actionData=Pt)}oe.length>0&&(rt.fetchers=$e(oe)),ze(rt,{flushSync:be})}oe.forEach(rt=>{ne(rt.key),rt.controller&&$.set(rt.key,rt.controller)});let Ae=()=>oe.forEach(rt=>ne(rt.key));T&&T.signal.addEventListener("abort",Ae);let{loaderResults:pt,fetcherResults:St}=await an(A,K,U,oe,V);if(V.signal.aborted)return{shortCircuited:!0};T&&T.signal.removeEventListener("abort",Ae),oe.forEach(rt=>$.delete(rt.key));let gt=Qf(pt);if(gt)return await jt(V,gt.result,!0,{replace:ke}),{shortCircuited:!0};if(gt=Qf(St),gt)return j.add(gt.key),await jt(V,gt.result,!0,{replace:ke}),{shortCircuited:!0};let{loaderData:An,errors:er}=Ab(A,K,pt,Re,oe,St,me);me.forEach((rt,Pt)=>{rt.subscribe($l=>{($l||rt.done)&&me.delete(Pt)})}),d.v7_partialHydration&&Ie&&A.errors&&(er=Ht({},A.errors,er));let Or=tt(),Js=lt(te),tn=Or||Js||oe.length>0;return Ht({matches:K,loaderData:An,errors:er},tn?{fetchers:new Map(A.fetchers)}:{})}function Pe(V){if(V&&!$r(V[1]))return{[V[0]]:V[1].data};if(A.actionData)return Object.keys(A.actionData).length===0?null:A.actionData}function $e(V){return V.forEach(H=>{let K=A.fetchers.get(H.key),le=Pu(void 0,K?K.data:void 0);A.fetchers.set(H.key,le)}),new Map(A.fetchers)}function at(V,H,K,le){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ne(V);let ge=(le&&le.flushSync)===!0,De=a||s,Fe=qv(A.location,A.matches,l,d.v7_prependBasename,K,d.v7_relativeSplatPath,H,le==null?void 0:le.relative),ke=Qa(De,Fe,l),Ie=Xs(ke,De,Fe);if(Ie.active&&Ie.matches&&(ke=Ie.matches),!ke){w(V,H,Ir(404,{pathname:Fe}),{flushSync:ge});return}let{path:be,submission:Re,error:Ge}=mb(d.v7_normalizeFormMethod,!0,Fe,le);if(Ge){w(V,H,Ge,{flushSync:ge});return}let Je=qu(ke,be),hn=(le&&le.preventScrollReset)===!0;if(Re&&Mi(Re.formMethod)){Qe(V,H,be,Je,ke,Ie.active,ge,hn,Re);return}J.set(V,{routeId:H,path:be}),Wt(V,H,be,Je,ke,Ie.active,ge,hn,Re)}async function Qe(V,H,K,le,ge,De,Fe,ke,Ie){_(),J.delete(V);function be(ln){if(!ln.route.action&&!ln.route.lazy){let Xl=Ir(405,{method:Ie.formMethod,pathname:K,routeId:H});return w(V,H,Xl,{flushSync:Fe}),!0}return!1}if(!De&&be(le))return;let Re=A.fetchers.get(V);I(V,h4(Ie,Re),{flushSync:Fe});let Ge=new AbortController,Je=Jl(e.history,K,Ge.signal,Ie);if(De){let ln=await Zo(ge,new URL(Je.url).pathname,Je.signal,V);if(ln.type==="aborted")return;if(ln.type==="error"){w(V,H,ln.error,{flushSync:Fe});return}else if(ln.matches){if(ge=ln.matches,le=qu(ge,K),be(le))return}else{w(V,H,Ir(404,{pathname:K}),{flushSync:Fe});return}}$.set(V,Ge);let hn=q,U=(await wt("action",A,Je,[le],ge,V))[le.route.id];if(Je.signal.aborted){$.get(V)===Ge&&$.delete(V);return}if(d.v7_fetcherPersist&&se.has(V)){if(ll(U)||$r(U)){I(V,ta(void 0));return}}else{if(ll(U))if($.delete(V),te>hn){I(V,ta(void 0));return}else return j.add(V),I(V,Pu(Ie)),jt(Je,U,!1,{fetcherSubmission:Ie,preventScrollReset:ke});if($r(U)){w(V,H,U.error);return}}if(ma(U))throw Ir(400,{type:"defer-action"});let oe=A.navigation.location||A.location,Ae=Jl(e.history,oe,Ge.signal),pt=a||s,St=A.navigation.state!=="idle"?Qa(pt,A.navigation.location,l):A.matches;ut(St,"Didn't find any matches after fetcher action");let gt=++q;O.set(V,gt);let An=Pu(Ie,U.data);A.fetchers.set(V,An);let[er,Or]=Cb(e.history,A,St,Ie,oe,!1,d.v7_skipActionErrorRevalidation,Z,Q,ie,se,J,j,pt,l,[le.route.id,U]);Or.filter(ln=>ln.key!==V).forEach(ln=>{let Xl=ln.key,tI=A.fetchers.get(Xl),V3=Pu(void 0,tI?tI.data:void 0);A.fetchers.set(Xl,V3),ne(Xl),ln.controller&&$.set(Xl,ln.controller)}),ze({fetchers:new Map(A.fetchers)});let Js=()=>Or.forEach(ln=>ne(ln.key));Ge.signal.addEventListener("abort",Js);let{loaderResults:tn,fetcherResults:rt}=await an(A,St,er,Or,Ae);if(Ge.signal.aborted)return;Ge.signal.removeEventListener("abort",Js),O.delete(V),$.delete(V),Or.forEach(ln=>$.delete(ln.key));let Pt=Qf(tn);if(Pt)return jt(Ae,Pt.result,!1,{preventScrollReset:ke});if(Pt=Qf(rt),Pt)return j.add(Pt.key),jt(Ae,Pt.result,!1,{preventScrollReset:ke});let{loaderData:$l,errors:bu}=Ab(A,St,tn,void 0,Or,rt,me);if(A.fetchers.has(V)){let ln=ta(U.data);A.fetchers.set(V,ln)}lt(gt),A.navigation.state==="loading"&&gt>te?(ut(E,"Expected pending action"),T&&T.abort(),ot(A.navigation.location,{matches:St,loaderData:$l,errors:bu,fetchers:new Map(A.fetchers)})):(ze({errors:bu,loaderData:wb(A.loaderData,$l,St,bu),fetchers:new Map(A.fetchers)}),Z=!1)}async function Wt(V,H,K,le,ge,De,Fe,ke,Ie){let be=A.fetchers.get(V);I(V,Pu(Ie,be?be.data:void 0),{flushSync:Fe});let Re=new AbortController,Ge=Jl(e.history,K,Re.signal);if(De){let U=await Zo(ge,new URL(Ge.url).pathname,Ge.signal,V);if(U.type==="aborted")return;if(U.type==="error"){w(V,H,U.error,{flushSync:Fe});return}else if(U.matches)ge=U.matches,le=qu(ge,K);else{w(V,H,Ir(404,{pathname:K}),{flushSync:Fe});return}}$.set(V,Re);let Je=q,pe=(await wt("loader",A,Ge,[le],ge,V))[le.route.id];if(ma(pe)&&(pe=await I1(pe,Ge.signal,!0)||pe),$.get(V)===Re&&$.delete(V),!Ge.signal.aborted){if(se.has(V)){I(V,ta(void 0));return}if(ll(pe))if(te>Je){I(V,ta(void 0));return}else{j.add(V),await jt(Ge,pe,!1,{preventScrollReset:ke});return}if($r(pe)){w(V,H,pe.error);return}ut(!ma(pe),"Unhandled fetcher deferred data"),I(V,ta(pe.data))}}async function jt(V,H,K,le){let{submission:ge,fetcherSubmission:De,preventScrollReset:Fe,replace:ke}=le===void 0?{}:le;H.response.headers.has("X-Remix-Revalidate")&&(Z=!0);let Ie=H.response.headers.get("Location");ut(Ie,"Expected a Location header on the redirect Response"),Ie=Ib(Ie,new URL(V.url),l);let be=zd(A.location,Ie,{_isRedirect:!0});if(n){let U=!1;if(H.response.headers.has("X-Remix-Reload-Document"))U=!0;else if(x1.test(Ie)){const oe=e.history.createURL(Ie);U=oe.origin!==t.location.origin||If(oe.pathname,l)==null}if(U){ke?t.location.replace(Ie):t.location.assign(Ie);return}}T=null;let Re=ke===!0||H.response.headers.has("X-Remix-Replace")?un.Replace:un.Push,{formMethod:Ge,formAction:Je,formEncType:hn}=A.navigation;!ge&&!De&&Ge&&Je&&hn&&(ge=Tb(A.navigation));let pe=ge||De;if($5.has(H.response.status)&&pe&&Mi(pe.formMethod))await Ce(Re,be,{submission:Ht({},pe,{formAction:Ie}),preventScrollReset:Fe||D,enableViewTransition:K?R:void 0});else{let U=Bg(be,ge);await Ce(Re,be,{overrideNavigation:U,fetcherSubmission:De,preventScrollReset:Fe||D,enableViewTransition:K?R:void 0})}}async function wt(V,H,K,le,ge,De){let Fe,ke={};try{Fe=await t4(c,V,H,K,le,ge,De,o,i)}catch(Ie){return le.forEach(be=>{ke[be.route.id]={type:vt.error,error:Ie}}),ke}for(let[Ie,be]of Object.entries(Fe))if(a4(be)){let Re=be.result;ke[Ie]={type:vt.redirect,response:i4(Re,K,Ie,ge,l,d.v7_relativeSplatPath)}}else ke[Ie]=await r4(be);return ke}async function an(V,H,K,le,ge){let De=V.matches,Fe=wt("loader",V,ge,K,H,null),ke=Promise.all(le.map(async Re=>{if(Re.matches&&Re.match&&Re.controller){let Je=(await wt("loader",V,Jl(e.history,Re.path,Re.controller.signal),[Re.match],Re.matches,Re.key))[Re.match.route.id];return{[Re.key]:Je}}else return Promise.resolve({[Re.key]:{type:vt.error,error:Ir(404,{pathname:Re.path})}})})),Ie=await Fe,be=(await ke).reduce((Re,Ge)=>Object.assign(Re,Ge),{});return await Promise.all([u4(H,Ie,ge.signal,De,V.loaderData),d4(H,be,le)]),{loaderResults:Ie,fetcherResults:be}}function _(){Z=!0,Q.push(...oi()),J.forEach((V,H)=>{$.has(H)&&ie.add(H),ne(H)})}function I(V,H,K){K===void 0&&(K={}),A.fetchers.set(V,H),ze({fetchers:new Map(A.fetchers)},{flushSync:(K&&K.flushSync)===!0})}function w(V,H,K,le){le===void 0&&(le={});let ge=el(A.matches,H);W(V),ze({errors:{[ge.route.id]:K},fetchers:new Map(A.fetchers)},{flushSync:(le&&le.flushSync)===!0})}function B(V){return ee.set(V,(ee.get(V)||0)+1),se.has(V)&&se.delete(V),A.fetchers.get(V)||X5}function W(V){let H=A.fetchers.get(V);$.has(V)&&!(H&&H.state==="loading"&&O.has(V))&&ne(V),J.delete(V),O.delete(V),j.delete(V),d.v7_fetcherPersist&&se.delete(V),ie.delete(V),A.fetchers.delete(V)}function Y(V){let H=(ee.get(V)||0)-1;H<=0?(ee.delete(V),se.add(V),d.v7_fetcherPersist||W(V)):ee.set(V,H),ze({fetchers:new Map(A.fetchers)})}function ne(V){let H=$.get(V);H&&(H.abort(),$.delete(V))}function Ne(V){for(let H of V){let K=B(H),le=ta(K.data);A.fetchers.set(H,le)}}function tt(){let V=[],H=!1;for(let K of j){let le=A.fetchers.get(K);ut(le,"Expected fetcher: "+K),le.state==="loading"&&(j.delete(K),V.push(K),H=!0)}return Ne(V),H}function lt(V){let H=[];for(let[K,le]of O)if(le<V){let ge=A.fetchers.get(K);ut(ge,"Expected fetcher: "+K),ge.state==="loading"&&(ne(K),O.delete(K),H.push(K))}return Ne(H),H.length>0}function ht(V,H){let K=A.blockers.get(V)||Du;return Be.get(V)!==H&&Be.set(V,H),K}function nt(V){A.blockers.delete(V),Be.delete(V)}function Ii(V,H){let K=A.blockers.get(V)||Du;ut(K.state==="unblocked"&&H.state==="blocked"||K.state==="blocked"&&H.state==="blocked"||K.state==="blocked"&&H.state==="proceeding"||K.state==="blocked"&&H.state==="unblocked"||K.state==="proceeding"&&H.state==="unblocked","Invalid blocker state transition: "+K.state+" -> "+H.state);let le=new Map(A.blockers);le.set(V,H),ze({blockers:le})}function io(V){let{currentLocation:H,nextLocation:K,historyAction:le}=V;if(Be.size===0)return;Be.size>1&&Hc(!1,"A router only supports one blocker at a time");let ge=Array.from(Be.entries()),[De,Fe]=ge[ge.length-1],ke=A.blockers.get(De);if(!(ke&&ke.state==="proceeding")&&Fe({currentLocation:H,nextLocation:K,historyAction:le}))return De}function Ka(V){let H=Ir(404,{pathname:V}),K=a||s,{matches:le,route:ge}=kb(K);return oi(),{notFoundMatches:le,route:ge,error:H}}function oi(V){let H=[];return me.forEach((K,le)=>{(!V||V(le))&&(K.cancel(),H.push(le),me.delete(le))}),H}function Iu(V,H,K){if(p=V,C=H,g=K||null,!v&&A.navigation===Ng){v=!0;let le=si(A.location,A.matches);le!=null&&ze({restoreScrollPosition:le})}return()=>{p=null,C=null,g=null}}function Hl(V,H){return g&&g(V,H.map(le=>A5(le,A.loaderData)))||V.key}function Yt(V,H){if(p&&C){let K=Hl(V,H);p[K]=C()}}function si(V,H){if(p){let K=Hl(V,H),le=p[K];if(typeof le=="number")return le}return null}function Xs(V,H,K){if(u)if(V){if(Object.keys(V[0].params).length>0)return{active:!0,matches:Th(H,K,l,!0)}}else return{active:!0,matches:Th(H,K,l,!0)||[]};return{active:!1,matches:null}}async function Zo(V,H,K,le){if(!u)return{type:"success",matches:V};let ge=V;for(;;){let De=a==null,Fe=a||s,ke=o;try{await u({signal:K,path:H,matches:ge,fetcherKey:le,patch:(Re,Ge)=>{K.aborted||xb(Re,Ge,Fe,ke,i)}})}catch(Re){return{type:"error",error:Re,partialMatches:ge}}finally{De&&!K.aborted&&(s=[...s])}if(K.aborted)return{type:"aborted"};let Ie=Qa(Fe,H,l);if(Ie)return{type:"success",matches:Ie};let be=Th(Fe,H,l,!0);if(!be||ge.length===be.length&&ge.every((Re,Ge)=>Re.route.id===be[Ge].route.id))return{type:"success",matches:null};ge=be}}function Ks(V){o={},a=k0(V,i,void 0,o)}function Zl(V,H){let K=a==null;xb(V,H,a||s,o,i),K&&(s=[...s],ze({}))}return k={get basename(){return l},get future(){return d},get state(){return A},get routes(){return s},get window(){return t},initialize:Dt,subscribe:fn,enableScrollRestoration:Iu,navigate:st,fetch:at,revalidate:he,createHref:V=>e.history.createHref(V),encodeLocation:V=>e.history.encodeLocation(V),getFetcher:B,deleteFetcher:Y,dispose:Gt,getBlocker:ht,deleteBlocker:nt,patchRoutes:Zl,_internalFetchControllers:$,_internalActiveDeferreds:me,_internalSetRoutes:Ks},k}function Y5(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function qv(e,t,n,r,i,o,s,a){let l,c;if(s){l=[];for(let d of t)if(l.push(d),d.route.id===s){c=d;break}}else l=t,c=t[t.length-1];let u=U5(i||".",L5(l,o),If(e.pathname,n)||e.pathname,a==="path");if(i==null&&(u.search=e.search,u.hash=e.hash),(i==null||i===""||i===".")&&c){let d=b1(u.search);if(c.route.index&&!d)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&d){let f=new URLSearchParams(u.search),h=f.getAll("index");f.delete("index"),h.filter(g=>g).forEach(g=>f.append("index",g));let p=f.toString();u.search=p?"?"+p:""}}return r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:gl([n,u.pathname])),xf(u)}function mb(e,t,n,r){if(!r||!Y5(r))return{path:n};if(r.formMethod&&!c4(r.formMethod))return{path:n,error:Ir(405,{method:r.formMethod})};let i=()=>({path:n,error:Ir(400,{type:"invalid-body"})}),o=r.formMethod||"get",s=e?o.toUpperCase():o.toLowerCase(),a=GT(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Mi(s))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[g,C]=p;return""+h+g+"="+C+`
`},""):String(r.body);return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Mi(s))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}ut(typeof FormData=="function","FormData is not available in this environment");let l,c;if(r.formData)l=eC(r.formData),c=r.formData;else if(r.body instanceof FormData)l=eC(r.body),c=r.body;else if(r.body instanceof URLSearchParams)l=r.body,c=bb(l);else if(r.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(r.body),c=bb(l)}catch{return i()}let u={formMethod:s,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Mi(u.formMethod))return{path:n,submission:u};let d=ja(n);return t&&d.search&&b1(d.search)&&l.append("index",""),d.search="?"+l,{path:xf(d),submission:u}}function vb(e,t,n){n===void 0&&(n=!1);let r=e.findIndex(i=>i.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function Cb(e,t,n,r,i,o,s,a,l,c,u,d,f,h,p,g){let C=g?$r(g[1])?g[1].error:g[1].data:void 0,v=e.createURL(t.location),m=e.createURL(i),y=n;o&&t.errors?y=vb(n,Object.keys(t.errors)[0],!0):g&&$r(g[1])&&(y=vb(n,g[0]));let x=g?g[1].statusCode:void 0,b=s&&x&&x>=400,k=y.filter((E,D)=>{let{route:T}=E;if(T.lazy)return!0;if(T.loader==null)return!1;if(o)return Qv(T,t.loaderData,t.errors);if(q5(t.loaderData,t.matches[D],E)||l.some(L=>L===E.route.id))return!0;let R=t.matches[D],P=E;return yb(E,Ht({currentUrl:v,currentParams:R.params,nextUrl:m,nextParams:P.params},r,{actionResult:C,actionStatus:x,defaultShouldRevalidate:b?!1:a||v.pathname+v.search===m.pathname+m.search||v.search!==m.search||UT(R,P)}))}),A=[];return d.forEach((E,D)=>{if(o||!n.some(z=>z.route.id===E.routeId)||u.has(D))return;let T=Qa(h,E.path,p);if(!T){A.push({key:D,routeId:E.routeId,path:E.path,matches:null,match:null,controller:null});return}let R=t.fetchers.get(D),P=qu(T,E.path),L=!1;f.has(D)?L=!1:c.has(D)?(c.delete(D),L=!0):R&&R.state!=="idle"&&R.data===void 0?L=a:L=yb(P,Ht({currentUrl:v,currentParams:t.matches[t.matches.length-1].params,nextUrl:m,nextParams:n[n.length-1].params},r,{actionResult:C,actionStatus:x,defaultShouldRevalidate:b?!1:a})),L&&A.push({key:D,routeId:E.routeId,path:E.path,matches:T,match:P,controller:new AbortController})}),[k,A]}function Qv(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,i=n!=null&&n[e.id]!==void 0;return!r&&i?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!i}function q5(e,t,n){let r=!t||n.route.id!==t.route.id,i=e[n.route.id]===void 0;return r||i}function UT(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function yb(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function xb(e,t,n,r,i){var o;let s;if(e){let c=r[e];ut(c,"No route found to patch children into: routeId = "+e),c.children||(c.children=[]),s=c.children}else s=n;let a=t.filter(c=>!s.some(u=>VT(c,u))),l=k0(a,i,[e||"_","patch",String(((o=s)==null?void 0:o.length)||"0")],r);s.push(...l)}function VT(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var i;return(i=t.children)==null?void 0:i.some(o=>VT(n,o))}):!1}async function Q5(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let i=n[e.id];ut(i,"No route found in manifest");let o={};for(let s in r){let l=i[s]!==void 0&&s!=="hasErrorBoundary";Hc(!l,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!l&&!I5.has(s)&&(o[s]=r[s])}Object.assign(i,o),Object.assign(i,Ht({},t(i),{lazy:void 0}))}async function e4(e){let{matches:t}=e,n=t.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,o,s)=>Object.assign(i,{[n[s].route.id]:o}),{})}async function t4(e,t,n,r,i,o,s,a,l,c){let u=o.map(h=>h.route.lazy?Q5(h.route,l,a):void 0),d=o.map((h,p)=>{let g=u[p],C=i.some(m=>m.route.id===h.route.id);return Ht({},h,{shouldLoad:C,resolve:async m=>(m&&r.method==="GET"&&(h.route.lazy||h.route.loader)&&(C=!0),C?n4(t,r,h,g,m,c):Promise.resolve({type:vt.data,result:void 0}))})}),f=await e({matches:d,request:r,params:o[0].params,fetcherKey:s,context:c});try{await Promise.all(u)}catch{}return f}async function n4(e,t,n,r,i,o){let s,a,l=c=>{let u,d=new Promise((p,g)=>u=g);a=()=>u(),t.signal.addEventListener("abort",a);let f=p=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+n.route.id+"]"))):c({request:t,params:n.params,context:o},...p!==void 0?[p]:[]),h=(async()=>{try{return{type:"data",result:await(i?i(g=>f(g)):f())}}catch(p){return{type:"error",result:p}}})();return Promise.race([h,d])};try{let c=n.route[e];if(r)if(c){let u,[d]=await Promise.all([l(c).catch(f=>{u=f}),r]);if(u!==void 0)throw u;s=d}else if(await r,c=n.route[e],c)s=await l(c);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw Ir(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:vt.data,result:void 0};else if(c)s=await l(c);else{let u=new URL(t.url),d=u.pathname+u.search;throw Ir(404,{pathname:d})}ut(s.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:vt.error,result:c}}finally{a&&t.signal.removeEventListener("abort",a)}return s}async function r4(e){let{result:t,type:n}=e;if(WT(t)){let d;try{let f=t.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?t.body==null?d=null:d=await t.json():d=await t.text()}catch(f){return{type:vt.error,error:f}}return n===vt.error?{type:vt.error,error:new E0(t.status,t.statusText,d),statusCode:t.status,headers:t.headers}:{type:vt.data,data:d,statusCode:t.status,headers:t.headers}}if(n===vt.error){if(Eb(t)){var r,i;if(t.data instanceof Error){var o,s;return{type:vt.error,error:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(s=t.init)!=null&&s.headers?new Headers(t.init.headers):void 0}}return{type:vt.error,error:new E0(((r=t.init)==null?void 0:r.status)||500,void 0,t.data),statusCode:Hd(t)?t.status:void 0,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}}return{type:vt.error,error:t,statusCode:Hd(t)?t.status:void 0}}if(l4(t)){var a,l;return{type:vt.deferred,deferredData:t,statusCode:(a=t.init)==null?void 0:a.status,headers:((l=t.init)==null?void 0:l.headers)&&new Headers(t.init.headers)}}if(Eb(t)){var c,u;return{type:vt.data,data:t.data,statusCode:(c=t.init)==null?void 0:c.status,headers:(u=t.init)!=null&&u.headers?new Headers(t.init.headers):void 0}}return{type:vt.data,data:t}}function i4(e,t,n,r,i,o){let s=e.headers.get("Location");if(ut(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!x1.test(s)){let a=r.slice(0,r.findIndex(l=>l.route.id===n)+1);s=qv(new URL(t.url),a,i,!0,s,o),e.headers.set("Location",s)}return e}function Ib(e,t,n){if(x1.test(e)){let r=e,i=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=If(i.pathname,n)!=null;if(i.origin===t.origin&&o)return i.pathname+i.search+i.hash}return e}function Jl(e,t,n,r){let i=e.createURL(GT(t)).toString(),o={signal:n};if(r&&Mi(r.formMethod)){let{formMethod:s,formEncType:a}=r;o.method=s.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=eC(r.formData):o.body=r.formData}return new Request(i,o)}function eC(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function bb(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function o4(e,t,n,r,i){let o={},s=null,a,l=!1,c={},u=n&&$r(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let f=d.route.id,h=t[f];if(ut(!ll(h),"Cannot handle redirect results in processLoaderData"),$r(h)){let p=h.error;u!==void 0&&(p=u,u=void 0),s=s||{};{let g=el(e,f);s[g.route.id]==null&&(s[g.route.id]=p)}o[f]=void 0,l||(l=!0,a=Hd(h.error)?h.error.status:500),h.headers&&(c[f]=h.headers)}else ma(h)?(r.set(f,h.deferredData),o[f]=h.deferredData.data,h.statusCode!=null&&h.statusCode!==200&&!l&&(a=h.statusCode),h.headers&&(c[f]=h.headers)):(o[f]=h.data,h.statusCode&&h.statusCode!==200&&!l&&(a=h.statusCode),h.headers&&(c[f]=h.headers))}),u!==void 0&&n&&(s={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:s,statusCode:a||200,loaderHeaders:c}}function Ab(e,t,n,r,i,o,s){let{loaderData:a,errors:l}=o4(t,n,r,s);return i.forEach(c=>{let{key:u,match:d,controller:f}=c,h=o[u];if(ut(h,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if($r(h)){let p=el(e.matches,d==null?void 0:d.route.id);l&&l[p.route.id]||(l=Ht({},l,{[p.route.id]:h.error})),e.fetchers.delete(u)}else if(ll(h))ut(!1,"Unhandled fetcher revalidation redirect");else if(ma(h))ut(!1,"Unhandled fetcher deferred data");else{let p=ta(h.data);e.fetchers.set(u,p)}}),{loaderData:a,errors:l}}function wb(e,t,n,r){let i=Ht({},t);for(let o of n){let s=o.route.id;if(t.hasOwnProperty(s)?t[s]!==void 0&&(i[s]=t[s]):e[s]!==void 0&&o.route.loader&&(i[s]=e[s]),r&&r.hasOwnProperty(s))break}return i}function Sb(e){return e?$r(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function el(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function kb(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Ir(e,t){let{pathname:n,routeId:r,method:i,type:o,message:s}=t===void 0?{}:t,a="Unknown Server Error",l="Unknown @remix-run/router error";return e===400?(a="Bad Request",i&&n&&r?l="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?l="defer() is not supported in actions":o==="invalid-body"&&(l="Unable to encode submission body")):e===403?(a="Forbidden",l='Route "'+r+'" does not match URL "'+n+'"'):e===404?(a="Not Found",l='No route matches URL "'+n+'"'):e===405&&(a="Method Not Allowed",i&&n&&r?l="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new E0(e||500,a,new Error(l),!0)}function Qf(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,i]=t[n];if(ll(i))return{key:r,result:i}}}function GT(e){let t=typeof e=="string"?ja(e):e;return xf(Ht({},t,{hash:""}))}function s4(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function a4(e){return WT(e.result)&&Z5.has(e.result.status)}function ma(e){return e.type===vt.deferred}function $r(e){return e.type===vt.error}function ll(e){return(e&&e.type)===vt.redirect}function Eb(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function l4(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function WT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function c4(e){return H5.has(e.toLowerCase())}function Mi(e){return j5.has(e.toLowerCase())}async function u4(e,t,n,r,i){let o=Object.entries(t);for(let s=0;s<o.length;s++){let[a,l]=o[s],c=e.find(f=>(f==null?void 0:f.route.id)===a);if(!c)continue;let u=r.find(f=>f.route.id===c.route.id),d=u!=null&&!UT(u,c)&&(i&&i[c.route.id])!==void 0;ma(l)&&d&&await I1(l,n,!1).then(f=>{f&&(t[a]=f)})}}async function d4(e,t,n){for(let r=0;r<n.length;r++){let{key:i,routeId:o,controller:s}=n[r],a=t[i];e.find(c=>(c==null?void 0:c.route.id)===o)&&ma(a)&&(ut(s,"Expected an AbortController for revalidating fetcher deferred result"),await I1(a,s.signal,!0).then(c=>{c&&(t[i]=c)}))}}async function I1(e,t,n){if(n===void 0&&(n=!1),!await e.deferredData.resolveData(t)){if(n)try{return{type:vt.data,data:e.deferredData.unwrappedData}}catch(i){return{type:vt.error,error:i}}return{type:vt.data,data:e.deferredData.data}}}function b1(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function qu(e,t){let n=typeof t=="string"?ja(t).search:t.search;if(e[e.length-1].route.index&&b1(n||""))return e[e.length-1];let r=FT(e);return r[r.length-1]}function Tb(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:o,json:s}=e;if(!(!t||!n||!r)){if(i!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(s!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}}}function Bg(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function f4(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Pu(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function h4(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ta(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function p4(e,t){try{let n=e.sessionStorage.getItem(LT);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(i,new Set(o||[]))}}catch{}}function g4(e,t){if(t.size>0){let n={};for(let[r,i]of t)n[r]=[...i];try{e.sessionStorage.setItem(LT,JSON.stringify(n))}catch(r){Hc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tC(){return tC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tC.apply(this,arguments)}const jT=S.createContext(null),zT=S.createContext(null),HT=S.createContext(null),A1=S.createContext(null),Rp=S.createContext({outlet:null,matches:[],isDataRoute:!1}),ZT=S.createContext(null);function w1(){return S.useContext(A1)!=null}function $T(){return w1()||ut(!1),S.useContext(A1).location}function m4(e,t,n,r){w1()||ut(!1);let{navigator:i,static:o}=S.useContext(HT),{matches:s}=S.useContext(Rp),a=s[s.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=$T(),d;d=u;let f=d.pathname||"/",h=f;if(c!=="/"){let C=c.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(C.length).join("/")}let p=!o&&n&&n.matches&&n.matches.length>0?n.matches:Qa(e,{pathname:h});return I4(p&&p.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:gl([c,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:gl([c,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),s,n,r)}function v4(){let e=S4(),t=Hd(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),n?S.createElement("pre",{style:i},n):null,null)}const C4=S.createElement(v4,null);class y4 extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?S.createElement(Rp.Provider,{value:this.props.routeContext},S.createElement(ZT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function x4(e){let{routeContext:t,match:n,children:r}=e,i=S.useContext(jT);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(Rp.Provider,{value:t},r)}function I4(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let s=e,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||ut(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,d,f)=>{let h,p=!1,g=null,C=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||C4,l&&(c<0&&f===0?(k4("route-fallback"),p=!0,C=null):c===f&&(p=!0,C=d.route.hydrateFallbackElement||null)));let v=t.concat(s.slice(0,f+1)),m=()=>{let y;return h?y=g:p?y=C:d.route.Component?y=S.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=u,S.createElement(x4,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:n!=null},children:y})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?S.createElement(y4,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:m(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):m()},null)}var XT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(XT||{});function b4(e){let t=S.useContext(zT);return t||ut(!1),t}function A4(e){let t=S.useContext(Rp);return t||ut(!1),t}function w4(e){let t=A4(),n=t.matches[t.matches.length-1];return n.route.id||ut(!1),n.route.id}function S4(){var e;let t=S.useContext(ZT),n=b4(XT.UseRouteError),r=w4();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}const Rb={};function k4(e,t,n){Rb[e]||(Rb[e]=!0)}function E4(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function T4(e){let{basename:t="/",children:n=null,location:r,navigationType:i=un.Pop,navigator:o,static:s=!1,future:a}=e;w1()&&ut(!1);let l=t.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:l,navigator:o,static:s,future:tC({v7_relativeSplatPath:!1},a)}),[l,a,o,s]);typeof r=="string"&&(r=ja(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,g=S.useMemo(()=>{let C=If(u,l);return C==null?null:{location:{pathname:C,search:d,hash:f,state:h,key:p},navigationType:i}},[l,u,d,f,h,p,i]);return g==null?null:S.createElement(HT.Provider,{value:c},S.createElement(A1.Provider,{children:n,value:g}))}new Promise(()=>{});function R4(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:S.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:S.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:S.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T0.apply(this,arguments)}const _4="6";try{window.__reactRouterVersion=_4}catch{}function D4(e,t){return J5({basename:void 0,future:T0({},void 0,{v7_prependBasename:!0}),history:C5({window:void 0}),hydrationData:P4(),routes:e,mapRouteProperties:R4,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function P4(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=T0({},t,{errors:N4(t.errors)})),t}function N4(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,i]of t)if(i&&i.__type==="RouteErrorResponse")n[r]=new E0(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let s=new o(i.message);s.stack="",n[r]=s}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const B4=S.createContext({isTransitioning:!1}),O4=S.createContext(new Map),F4="startTransition",_b=oN[F4],M4="flushSync",Db=v5[M4];function L4(e){_b?_b(e):e()}function Nu(e){Db?Db(e):e()}class U4{constructor(){this.status="pending",this.promise=new Promise((t,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",t(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function V4(e){let{fallbackElement:t,router:n,future:r}=e,[i,o]=S.useState(n.state),[s,a]=S.useState(),[l,c]=S.useState({isTransitioning:!1}),[u,d]=S.useState(),[f,h]=S.useState(),[p,g]=S.useState(),C=S.useRef(new Map),{v7_startTransition:v}=r||{},m=S.useCallback(E=>{v?L4(E):E()},[v]),y=S.useCallback((E,D)=>{let{deletedFetchers:T,flushSync:R,viewTransitionOpts:P}=D;E.fetchers.forEach((z,Z)=>{z.data!==void 0&&C.current.set(Z,z.data)}),T.forEach(z=>C.current.delete(z));let L=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!P||L){R?Nu(()=>o(E)):m(()=>o(E));return}if(R){Nu(()=>{f&&(u&&u.resolve(),f.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let z=n.window.document.startViewTransition(()=>{Nu(()=>o(E))});z.finished.finally(()=>{Nu(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})})}),Nu(()=>h(z));return}f?(u&&u.resolve(),f.skipTransition(),g({state:E,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(a(E),c({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[n.window,f,u,C,m]);S.useLayoutEffect(()=>n.subscribe(y),[n,y]),S.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new U4)},[l]),S.useEffect(()=>{if(u&&s&&n.window){let E=s,D=u.promise,T=n.window.document.startViewTransition(async()=>{m(()=>o(E)),await D});T.finished.finally(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})}),h(T)}},[m,s,u,n.window]),S.useEffect(()=>{u&&s&&i.location.key===s.location.key&&u.resolve()},[u,f,i.location,s]),S.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),c({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),g(void 0))},[l.isTransitioning,p]),S.useEffect(()=>{},[]);let x=S.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:E=>n.navigate(E),push:(E,D,T)=>n.navigate(E,{state:D,preventScrollReset:T==null?void 0:T.preventScrollReset}),replace:(E,D,T)=>n.navigate(E,{replace:!0,state:D,preventScrollReset:T==null?void 0:T.preventScrollReset})}),[n]),b=n.basename||"/",k=S.useMemo(()=>({router:n,navigator:x,static:!1,basename:b}),[n,x,b]),A=S.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return S.useEffect(()=>E4(r,n.future),[r,n.future]),S.createElement(S.Fragment,null,S.createElement(jT.Provider,{value:k},S.createElement(zT.Provider,{value:i},S.createElement(O4.Provider,{value:C.current},S.createElement(B4.Provider,{value:l},S.createElement(T4,{basename:b,location:i.location,navigationType:i.historyAction,navigator:x,future:A},i.initialized||n.future.v7_partialHydration?S.createElement(G4,{routes:n.routes,future:n.future,state:i}):t))))),null)}const G4=S.memo(W4);function W4(e){let{routes:t,future:n,state:r}=e;return m4(t,void 0,r,n)}var Pb;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pb||(Pb={}));var Nb;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Nb||(Nb={}));const KT=e=>{const t=typeof e=="function",n=S.useRef(e);S.useEffect(()=>{n.current=e}),S.useEffect(()=>{if(t){const r=i=>{const o=n.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[t])};var JT={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function o(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||l,f),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,h,p){var g=n?n+c:c;if(!this._events[g])return!1;var C=this._events[g],v=arguments.length,m,y;if(C.fn){switch(C.once&&this.removeListener(c,C.fn,void 0,!0),v){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,u),!0;case 3:return C.fn.call(C.context,u,d),!0;case 4:return C.fn.call(C.context,u,d,f),!0;case 5:return C.fn.call(C.context,u,d,f,h),!0;case 6:return C.fn.call(C.context,u,d,f,h,p),!0}for(y=1,m=new Array(v-1);y<v;y++)m[y-1]=arguments[y];C.fn.apply(C.context,m)}else{var x=C.length,b;for(y=0;y<x;y++)switch(C[y].once&&this.removeListener(c,C[y].fn,void 0,!0),v){case 1:C[y].fn.call(C[y].context);break;case 2:C[y].fn.call(C[y].context,u);break;case 3:C[y].fn.call(C[y].context,u,d);break;case 4:C[y].fn.call(C[y].context,u,d,f);break;default:if(!m)for(b=1,m=new Array(v-1);b<v;b++)m[b-1]=arguments[b];C[y].fn.apply(C[y].context,m)}}return!0},a.prototype.on=function(c,u,d){return o(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return o(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var h=n?n+c:c;if(!this._events[h])return this;if(!u)return s(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&s(this,h);else{for(var g=0,C=[],v=p.length;g<v;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&C.push(p[g]);C.length?this._events[h]=C.length===1?C[0]:C:s(this,h)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(JT);var j4=JT.exports;const _p=tu(j4);var _n={},Dp={};Dp.byteLength=Z4;Dp.toByteArray=X4;Dp.fromByteArray=Y4;var mo=[],li=[],z4=typeof Uint8Array<"u"?Uint8Array:Array,Og="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Yl=0,H4=Og.length;Yl<H4;++Yl)mo[Yl]=Og[Yl],li[Og.charCodeAt(Yl)]=Yl;li[45]=62;li[95]=63;function YT(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function Z4(e){var t=YT(e),n=t[0],r=t[1];return(n+r)*3/4-r}function $4(e,t,n){return(t+n)*3/4-n}function X4(e){var t,n=YT(e),r=n[0],i=n[1],o=new z4($4(e,r,i)),s=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)t=li[e.charCodeAt(l)]<<18|li[e.charCodeAt(l+1)]<<12|li[e.charCodeAt(l+2)]<<6|li[e.charCodeAt(l+3)],o[s++]=t>>16&255,o[s++]=t>>8&255,o[s++]=t&255;return i===2&&(t=li[e.charCodeAt(l)]<<2|li[e.charCodeAt(l+1)]>>4,o[s++]=t&255),i===1&&(t=li[e.charCodeAt(l)]<<10|li[e.charCodeAt(l+1)]<<4|li[e.charCodeAt(l+2)]>>2,o[s++]=t>>8&255,o[s++]=t&255),o}function K4(e){return mo[e>>18&63]+mo[e>>12&63]+mo[e>>6&63]+mo[e&63]}function J4(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),i.push(K4(r));return i.join("")}function Y4(e){for(var t,n=e.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(J4(e,s,s+o>a?a:s+o));return r===1?(t=e[n-1],i.push(mo[t>>2]+mo[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],i.push(mo[t>>10]+mo[t>>4&63]+mo[t<<2&63]+"=")),i.join("")}var S1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */S1.read=function(e,t,n,r,i){var o,s,a=i*8-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=e[t+d];for(d+=f,o=h&(1<<-u)-1,h>>=-u,u+=a;u>0;o=o*256+e[t+d],d+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+e[t+d],d+=f,u-=8);if(o===0)o=1-c;else{if(o===l)return s?NaN:(h?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-c}return(h?-1:1)*s*Math.pow(2,o-r)};S1.write=function(e,t,n,r,i,o){var s,a,l,c=o*8-i-1,u=(1<<c)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,g=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?t+=f/l:t+=f*Math.pow(2,1-d),t*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*l-1)*Math.pow(2,i),s=s+d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+h]=a&255,h+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+h]=s&255,h+=p,s/=256,c-=8);e[n+h-p]|=g*128};(function(e){const t=Dp,n=S1,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=m,e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const _=new Uint8Array(1),I={foo:function(){return 42}};return Object.setPrototypeOf(I,Uint8Array.prototype),Object.setPrototypeOf(_,I),_.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(_){if(_>i)throw new RangeError('The value "'+_+'" is invalid for option "size"');const I=new Uint8Array(_);return Object.setPrototypeOf(I,a.prototype),I}function a(_,I,w){if(typeof _=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(_)}return l(_,I,w)}a.poolSize=8192;function l(_,I,w){if(typeof _=="string")return f(_,I);if(ArrayBuffer.isView(_))return p(_);if(_==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(Qe(_,ArrayBuffer)||_&&Qe(_.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Qe(_,SharedArrayBuffer)||_&&Qe(_.buffer,SharedArrayBuffer)))return g(_,I,w);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const B=_.valueOf&&_.valueOf();if(B!=null&&B!==_)return a.from(B,I,w);const W=C(_);if(W)return W;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return a.from(_[Symbol.toPrimitive]("string"),I,w);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}a.from=function(_,I,w){return l(_,I,w)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(_<0)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function u(_,I,w){return c(_),_<=0?s(_):I!==void 0?typeof w=="string"?s(_).fill(I,w):s(_).fill(I):s(_)}a.alloc=function(_,I,w){return u(_,I,w)};function d(_){return c(_),s(_<0?0:v(_)|0)}a.allocUnsafe=function(_){return d(_)},a.allocUnsafeSlow=function(_){return d(_)};function f(_,I){if((typeof I!="string"||I==="")&&(I="utf8"),!a.isEncoding(I))throw new TypeError("Unknown encoding: "+I);const w=y(_,I)|0;let B=s(w);const W=B.write(_,I);return W!==w&&(B=B.slice(0,W)),B}function h(_){const I=_.length<0?0:v(_.length)|0,w=s(I);for(let B=0;B<I;B+=1)w[B]=_[B]&255;return w}function p(_){if(Qe(_,Uint8Array)){const I=new Uint8Array(_);return g(I.buffer,I.byteOffset,I.byteLength)}return h(_)}function g(_,I,w){if(I<0||_.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<I+(w||0))throw new RangeError('"length" is outside of buffer bounds');let B;return I===void 0&&w===void 0?B=new Uint8Array(_):w===void 0?B=new Uint8Array(_,I):B=new Uint8Array(_,I,w),Object.setPrototypeOf(B,a.prototype),B}function C(_){if(a.isBuffer(_)){const I=v(_.length)|0,w=s(I);return w.length===0||_.copy(w,0,0,I),w}if(_.length!==void 0)return typeof _.length!="number"||Wt(_.length)?s(0):h(_);if(_.type==="Buffer"&&Array.isArray(_.data))return h(_.data)}function v(_){if(_>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return _|0}function m(_){return+_!=_&&(_=0),a.alloc(+_)}a.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==a.prototype},a.compare=function(I,w){if(Qe(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),Qe(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),!a.isBuffer(I)||!a.isBuffer(w))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===w)return 0;let B=I.length,W=w.length;for(let Y=0,ne=Math.min(B,W);Y<ne;++Y)if(I[Y]!==w[Y]){B=I[Y],W=w[Y];break}return B<W?-1:W<B?1:0},a.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(I,w){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return a.alloc(0);let B;if(w===void 0)for(w=0,B=0;B<I.length;++B)w+=I[B].length;const W=a.allocUnsafe(w);let Y=0;for(B=0;B<I.length;++B){let ne=I[B];if(Qe(ne,Uint8Array))Y+ne.length>W.length?(a.isBuffer(ne)||(ne=a.from(ne)),ne.copy(W,Y)):Uint8Array.prototype.set.call(W,ne,Y);else if(a.isBuffer(ne))ne.copy(W,Y);else throw new TypeError('"list" argument must be an Array of Buffers');Y+=ne.length}return W};function y(_,I){if(a.isBuffer(_))return _.length;if(ArrayBuffer.isView(_)||Qe(_,ArrayBuffer))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);const w=_.length,B=arguments.length>2&&arguments[2]===!0;if(!B&&w===0)return 0;let W=!1;for(;;)switch(I){case"ascii":case"latin1":case"binary":return w;case"utf8":case"utf-8":return Ve(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w*2;case"hex":return w>>>1;case"base64":return $e(_).length;default:if(W)return B?-1:Ve(_).length;I=(""+I).toLowerCase(),W=!0}}a.byteLength=y;function x(_,I,w){let B=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((w===void 0||w>this.length)&&(w=this.length),w<=0)||(w>>>=0,I>>>=0,w<=I))return"";for(_||(_="utf8");;)switch(_){case"hex":return q(this,I,w);case"utf8":case"utf-8":return z(this,I,w);case"ascii":return ie(this,I,w);case"latin1":case"binary":return $(this,I,w);case"base64":return L(this,I,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,I,w);default:if(B)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),B=!0}}a.prototype._isBuffer=!0;function b(_,I,w){const B=_[I];_[I]=_[w],_[w]=B}a.prototype.swap16=function(){const I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let w=0;w<I;w+=2)b(this,w,w+1);return this},a.prototype.swap32=function(){const I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let w=0;w<I;w+=4)b(this,w,w+3),b(this,w+1,w+2);return this},a.prototype.swap64=function(){const I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let w=0;w<I;w+=8)b(this,w,w+7),b(this,w+1,w+6),b(this,w+2,w+5),b(this,w+3,w+4);return this},a.prototype.toString=function(){const I=this.length;return I===0?"":arguments.length===0?z(this,0,I):x.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(I){if(!a.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:a.compare(this,I)===0},a.prototype.inspect=function(){let I="";const w=e.INSPECT_MAX_BYTES;return I=this.toString("hex",0,w).replace(/(.{2})/g,"$1 ").trim(),this.length>w&&(I+=" ... "),"<Buffer "+I+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(I,w,B,W,Y){if(Qe(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(w===void 0&&(w=0),B===void 0&&(B=I?I.length:0),W===void 0&&(W=0),Y===void 0&&(Y=this.length),w<0||B>I.length||W<0||Y>this.length)throw new RangeError("out of range index");if(W>=Y&&w>=B)return 0;if(W>=Y)return-1;if(w>=B)return 1;if(w>>>=0,B>>>=0,W>>>=0,Y>>>=0,this===I)return 0;let ne=Y-W,Ne=B-w;const tt=Math.min(ne,Ne),lt=this.slice(W,Y),ht=I.slice(w,B);for(let nt=0;nt<tt;++nt)if(lt[nt]!==ht[nt]){ne=lt[nt],Ne=ht[nt];break}return ne<Ne?-1:Ne<ne?1:0};function k(_,I,w,B,W){if(_.length===0)return-1;if(typeof w=="string"?(B=w,w=0):w>2147483647?w=2147483647:w<-2147483648&&(w=-2147483648),w=+w,Wt(w)&&(w=W?0:_.length-1),w<0&&(w=_.length+w),w>=_.length){if(W)return-1;w=_.length-1}else if(w<0)if(W)w=0;else return-1;if(typeof I=="string"&&(I=a.from(I,B)),a.isBuffer(I))return I.length===0?-1:A(_,I,w,B,W);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?W?Uint8Array.prototype.indexOf.call(_,I,w):Uint8Array.prototype.lastIndexOf.call(_,I,w):A(_,[I],w,B,W);throw new TypeError("val must be string, number or Buffer")}function A(_,I,w,B,W){let Y=1,ne=_.length,Ne=I.length;if(B!==void 0&&(B=String(B).toLowerCase(),B==="ucs2"||B==="ucs-2"||B==="utf16le"||B==="utf-16le")){if(_.length<2||I.length<2)return-1;Y=2,ne/=2,Ne/=2,w/=2}function tt(ht,nt){return Y===1?ht[nt]:ht.readUInt16BE(nt*Y)}let lt;if(W){let ht=-1;for(lt=w;lt<ne;lt++)if(tt(_,lt)===tt(I,ht===-1?0:lt-ht)){if(ht===-1&&(ht=lt),lt-ht+1===Ne)return ht*Y}else ht!==-1&&(lt-=lt-ht),ht=-1}else for(w+Ne>ne&&(w=ne-Ne),lt=w;lt>=0;lt--){let ht=!0;for(let nt=0;nt<Ne;nt++)if(tt(_,lt+nt)!==tt(I,nt)){ht=!1;break}if(ht)return lt}return-1}a.prototype.includes=function(I,w,B){return this.indexOf(I,w,B)!==-1},a.prototype.indexOf=function(I,w,B){return k(this,I,w,B,!0)},a.prototype.lastIndexOf=function(I,w,B){return k(this,I,w,B,!1)};function E(_,I,w,B){w=Number(w)||0;const W=_.length-w;B?(B=Number(B),B>W&&(B=W)):B=W;const Y=I.length;B>Y/2&&(B=Y/2);let ne;for(ne=0;ne<B;++ne){const Ne=parseInt(I.substr(ne*2,2),16);if(Wt(Ne))return ne;_[w+ne]=Ne}return ne}function D(_,I,w,B){return at(Ve(I,_.length-w),_,w,B)}function T(_,I,w,B){return at(Ue(I),_,w,B)}function R(_,I,w,B){return at($e(I),_,w,B)}function P(_,I,w,B){return at(Pe(I,_.length-w),_,w,B)}a.prototype.write=function(I,w,B,W){if(w===void 0)W="utf8",B=this.length,w=0;else if(B===void 0&&typeof w=="string")W=w,B=this.length,w=0;else if(isFinite(w))w=w>>>0,isFinite(B)?(B=B>>>0,W===void 0&&(W="utf8")):(W=B,B=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Y=this.length-w;if((B===void 0||B>Y)&&(B=Y),I.length>0&&(B<0||w<0)||w>this.length)throw new RangeError("Attempt to write outside buffer bounds");W||(W="utf8");let ne=!1;for(;;)switch(W){case"hex":return E(this,I,w,B);case"utf8":case"utf-8":return D(this,I,w,B);case"ascii":case"latin1":case"binary":return T(this,I,w,B);case"base64":return R(this,I,w,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,I,w,B);default:if(ne)throw new TypeError("Unknown encoding: "+W);W=(""+W).toLowerCase(),ne=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(_,I,w){return I===0&&w===_.length?t.fromByteArray(_):t.fromByteArray(_.slice(I,w))}function z(_,I,w){w=Math.min(_.length,w);const B=[];let W=I;for(;W<w;){const Y=_[W];let ne=null,Ne=Y>239?4:Y>223?3:Y>191?2:1;if(W+Ne<=w){let tt,lt,ht,nt;switch(Ne){case 1:Y<128&&(ne=Y);break;case 2:tt=_[W+1],(tt&192)===128&&(nt=(Y&31)<<6|tt&63,nt>127&&(ne=nt));break;case 3:tt=_[W+1],lt=_[W+2],(tt&192)===128&&(lt&192)===128&&(nt=(Y&15)<<12|(tt&63)<<6|lt&63,nt>2047&&(nt<55296||nt>57343)&&(ne=nt));break;case 4:tt=_[W+1],lt=_[W+2],ht=_[W+3],(tt&192)===128&&(lt&192)===128&&(ht&192)===128&&(nt=(Y&15)<<18|(tt&63)<<12|(lt&63)<<6|ht&63,nt>65535&&nt<1114112&&(ne=nt))}}ne===null?(ne=65533,Ne=1):ne>65535&&(ne-=65536,B.push(ne>>>10&1023|55296),ne=56320|ne&1023),B.push(ne),W+=Ne}return Q(B)}const Z=4096;function Q(_){const I=_.length;if(I<=Z)return String.fromCharCode.apply(String,_);let w="",B=0;for(;B<I;)w+=String.fromCharCode.apply(String,_.slice(B,B+=Z));return w}function ie(_,I,w){let B="";w=Math.min(_.length,w);for(let W=I;W<w;++W)B+=String.fromCharCode(_[W]&127);return B}function $(_,I,w){let B="";w=Math.min(_.length,w);for(let W=I;W<w;++W)B+=String.fromCharCode(_[W]);return B}function q(_,I,w){const B=_.length;(!I||I<0)&&(I=0),(!w||w<0||w>B)&&(w=B);let W="";for(let Y=I;Y<w;++Y)W+=jt[_[Y]];return W}function te(_,I,w){const B=_.slice(I,w);let W="";for(let Y=0;Y<B.length-1;Y+=2)W+=String.fromCharCode(B[Y]+B[Y+1]*256);return W}a.prototype.slice=function(I,w){const B=this.length;I=~~I,w=w===void 0?B:~~w,I<0?(I+=B,I<0&&(I=0)):I>B&&(I=B),w<0?(w+=B,w<0&&(w=0)):w>B&&(w=B),w<I&&(w=I);const W=this.subarray(I,w);return Object.setPrototypeOf(W,a.prototype),W};function O(_,I,w){if(_%1!==0||_<0)throw new RangeError("offset is not uint");if(_+I>w)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=this[I],Y=1,ne=0;for(;++ne<w&&(Y*=256);)W+=this[I+ne]*Y;return W},a.prototype.readUintBE=a.prototype.readUIntBE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=this[I+--w],Y=1;for(;w>0&&(Y*=256);)W+=this[I+--w]*Y;return W},a.prototype.readUint8=a.prototype.readUInt8=function(I,w){return I=I>>>0,w||O(I,1,this.length),this[I]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(I,w){return I=I>>>0,w||O(I,2,this.length),this[I]|this[I+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(I,w){return I=I>>>0,w||O(I,2,this.length),this[I]<<8|this[I+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(I,w){return I=I>>>0,w||O(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(I,w){return I=I>>>0,w||O(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},a.prototype.readBigUInt64LE=wt(function(I){I=I>>>0,ot(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&st(I,this.length-8);const W=w+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24,Y=this[++I]+this[++I]*2**8+this[++I]*2**16+B*2**24;return BigInt(W)+(BigInt(Y)<<BigInt(32))}),a.prototype.readBigUInt64BE=wt(function(I){I=I>>>0,ot(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&st(I,this.length-8);const W=w*2**24+this[++I]*2**16+this[++I]*2**8+this[++I],Y=this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+B;return(BigInt(W)<<BigInt(32))+BigInt(Y)}),a.prototype.readIntLE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=this[I],Y=1,ne=0;for(;++ne<w&&(Y*=256);)W+=this[I+ne]*Y;return Y*=128,W>=Y&&(W-=Math.pow(2,8*w)),W},a.prototype.readIntBE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=w,Y=1,ne=this[I+--W];for(;W>0&&(Y*=256);)ne+=this[I+--W]*Y;return Y*=128,ne>=Y&&(ne-=Math.pow(2,8*w)),ne},a.prototype.readInt8=function(I,w){return I=I>>>0,w||O(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},a.prototype.readInt16LE=function(I,w){I=I>>>0,w||O(I,2,this.length);const B=this[I]|this[I+1]<<8;return B&32768?B|4294901760:B},a.prototype.readInt16BE=function(I,w){I=I>>>0,w||O(I,2,this.length);const B=this[I+1]|this[I]<<8;return B&32768?B|4294901760:B},a.prototype.readInt32LE=function(I,w){return I=I>>>0,w||O(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},a.prototype.readInt32BE=function(I,w){return I=I>>>0,w||O(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},a.prototype.readBigInt64LE=wt(function(I){I=I>>>0,ot(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&st(I,this.length-8);const W=this[I+4]+this[I+5]*2**8+this[I+6]*2**16+(B<<24);return(BigInt(W)<<BigInt(32))+BigInt(w+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24)}),a.prototype.readBigInt64BE=wt(function(I){I=I>>>0,ot(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&st(I,this.length-8);const W=(w<<24)+this[++I]*2**16+this[++I]*2**8+this[++I];return(BigInt(W)<<BigInt(32))+BigInt(this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+B)}),a.prototype.readFloatLE=function(I,w){return I=I>>>0,w||O(I,4,this.length),n.read(this,I,!0,23,4)},a.prototype.readFloatBE=function(I,w){return I=I>>>0,w||O(I,4,this.length),n.read(this,I,!1,23,4)},a.prototype.readDoubleLE=function(I,w){return I=I>>>0,w||O(I,8,this.length),n.read(this,I,!0,52,8)},a.prototype.readDoubleBE=function(I,w){return I=I>>>0,w||O(I,8,this.length),n.read(this,I,!1,52,8)};function j(_,I,w,B,W,Y){if(!a.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>W||I<Y)throw new RangeError('"value" argument is out of bounds');if(w+B>_.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(I,w,B,W){if(I=+I,w=w>>>0,B=B>>>0,!W){const Ne=Math.pow(2,8*B)-1;j(this,I,w,B,Ne,0)}let Y=1,ne=0;for(this[w]=I&255;++ne<B&&(Y*=256);)this[w+ne]=I/Y&255;return w+B},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(I,w,B,W){if(I=+I,w=w>>>0,B=B>>>0,!W){const Ne=Math.pow(2,8*B)-1;j(this,I,w,B,Ne,0)}let Y=B-1,ne=1;for(this[w+Y]=I&255;--Y>=0&&(ne*=256);)this[w+Y]=I/ne&255;return w+B},a.prototype.writeUint8=a.prototype.writeUInt8=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,1,255,0),this[w]=I&255,w+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,65535,0),this[w]=I&255,this[w+1]=I>>>8,w+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,65535,0),this[w]=I>>>8,this[w+1]=I&255,w+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,4294967295,0),this[w+3]=I>>>24,this[w+2]=I>>>16,this[w+1]=I>>>8,this[w]=I&255,w+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,4294967295,0),this[w]=I>>>24,this[w+1]=I>>>16,this[w+2]=I>>>8,this[w+3]=I&255,w+4};function J(_,I,w,B,W){ze(I,B,W,_,w,7);let Y=Number(I&BigInt(4294967295));_[w++]=Y,Y=Y>>8,_[w++]=Y,Y=Y>>8,_[w++]=Y,Y=Y>>8,_[w++]=Y;let ne=Number(I>>BigInt(32)&BigInt(4294967295));return _[w++]=ne,ne=ne>>8,_[w++]=ne,ne=ne>>8,_[w++]=ne,ne=ne>>8,_[w++]=ne,w}function ee(_,I,w,B,W){ze(I,B,W,_,w,7);let Y=Number(I&BigInt(4294967295));_[w+7]=Y,Y=Y>>8,_[w+6]=Y,Y=Y>>8,_[w+5]=Y,Y=Y>>8,_[w+4]=Y;let ne=Number(I>>BigInt(32)&BigInt(4294967295));return _[w+3]=ne,ne=ne>>8,_[w+2]=ne,ne=ne>>8,_[w+1]=ne,ne=ne>>8,_[w]=ne,w+8}a.prototype.writeBigUInt64LE=wt(function(I,w=0){return J(this,I,w,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=wt(function(I,w=0){return ee(this,I,w,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(I,w,B,W){if(I=+I,w=w>>>0,!W){const tt=Math.pow(2,8*B-1);j(this,I,w,B,tt-1,-tt)}let Y=0,ne=1,Ne=0;for(this[w]=I&255;++Y<B&&(ne*=256);)I<0&&Ne===0&&this[w+Y-1]!==0&&(Ne=1),this[w+Y]=(I/ne>>0)-Ne&255;return w+B},a.prototype.writeIntBE=function(I,w,B,W){if(I=+I,w=w>>>0,!W){const tt=Math.pow(2,8*B-1);j(this,I,w,B,tt-1,-tt)}let Y=B-1,ne=1,Ne=0;for(this[w+Y]=I&255;--Y>=0&&(ne*=256);)I<0&&Ne===0&&this[w+Y+1]!==0&&(Ne=1),this[w+Y]=(I/ne>>0)-Ne&255;return w+B},a.prototype.writeInt8=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,1,127,-128),I<0&&(I=255+I+1),this[w]=I&255,w+1},a.prototype.writeInt16LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,32767,-32768),this[w]=I&255,this[w+1]=I>>>8,w+2},a.prototype.writeInt16BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,32767,-32768),this[w]=I>>>8,this[w+1]=I&255,w+2},a.prototype.writeInt32LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,2147483647,-2147483648),this[w]=I&255,this[w+1]=I>>>8,this[w+2]=I>>>16,this[w+3]=I>>>24,w+4},a.prototype.writeInt32BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[w]=I>>>24,this[w+1]=I>>>16,this[w+2]=I>>>8,this[w+3]=I&255,w+4},a.prototype.writeBigInt64LE=wt(function(I,w=0){return J(this,I,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=wt(function(I,w=0){return ee(this,I,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function se(_,I,w,B,W,Y){if(w+B>_.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("Index out of range")}function me(_,I,w,B,W){return I=+I,w=w>>>0,W||se(_,I,w,4),n.write(_,I,w,B,23,4),w+4}a.prototype.writeFloatLE=function(I,w,B){return me(this,I,w,!0,B)},a.prototype.writeFloatBE=function(I,w,B){return me(this,I,w,!1,B)};function Be(_,I,w,B,W){return I=+I,w=w>>>0,W||se(_,I,w,8),n.write(_,I,w,B,52,8),w+8}a.prototype.writeDoubleLE=function(I,w,B){return Be(this,I,w,!0,B)},a.prototype.writeDoubleBE=function(I,w,B){return Be(this,I,w,!1,B)},a.prototype.copy=function(I,w,B,W){if(!a.isBuffer(I))throw new TypeError("argument should be a Buffer");if(B||(B=0),!W&&W!==0&&(W=this.length),w>=I.length&&(w=I.length),w||(w=0),W>0&&W<B&&(W=B),W===B||I.length===0||this.length===0)return 0;if(w<0)throw new RangeError("targetStart out of bounds");if(B<0||B>=this.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("sourceEnd out of bounds");W>this.length&&(W=this.length),I.length-w<W-B&&(W=I.length-w+B);const Y=W-B;return this===I&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(w,B,W):Uint8Array.prototype.set.call(I,this.subarray(B,W),w),Y},a.prototype.fill=function(I,w,B,W){if(typeof I=="string"){if(typeof w=="string"?(W=w,w=0,B=this.length):typeof B=="string"&&(W=B,B=this.length),W!==void 0&&typeof W!="string")throw new TypeError("encoding must be a string");if(typeof W=="string"&&!a.isEncoding(W))throw new TypeError("Unknown encoding: "+W);if(I.length===1){const ne=I.charCodeAt(0);(W==="utf8"&&ne<128||W==="latin1")&&(I=ne)}}else typeof I=="number"?I=I&255:typeof I=="boolean"&&(I=Number(I));if(w<0||this.length<w||this.length<B)throw new RangeError("Out of range index");if(B<=w)return this;w=w>>>0,B=B===void 0?this.length:B>>>0,I||(I=0);let Y;if(typeof I=="number")for(Y=w;Y<B;++Y)this[Y]=I;else{const ne=a.isBuffer(I)?I:a.from(I,W),Ne=ne.length;if(Ne===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(Y=0;Y<B-w;++Y)this[Y+w]=ne[Y%Ne]}return this};const ae={};function Dt(_,I,w){ae[_]=class extends w{constructor(){super(),Object.defineProperty(this,"message",{value:I.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_}]`,this.stack,delete this.name}get code(){return _}set code(W){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:W,writable:!0})}toString(){return`${this.name} [${_}]: ${this.message}`}}}Dt("ERR_BUFFER_OUT_OF_BOUNDS",function(_){return _?`${_} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Dt("ERR_INVALID_ARG_TYPE",function(_,I){return`The "${_}" argument must be of type number. Received type ${typeof I}`},TypeError),Dt("ERR_OUT_OF_RANGE",function(_,I,w){let B=`The value of "${_}" is out of range.`,W=w;return Number.isInteger(w)&&Math.abs(w)>2**32?W=Gt(String(w)):typeof w=="bigint"&&(W=String(w),(w>BigInt(2)**BigInt(32)||w<-(BigInt(2)**BigInt(32)))&&(W=Gt(W)),W+="n"),B+=` It must be ${I}. Received ${W}`,B},RangeError);function Gt(_){let I="",w=_.length;const B=_[0]==="-"?1:0;for(;w>=B+4;w-=3)I=`_${_.slice(w-3,w)}${I}`;return`${_.slice(0,w)}${I}`}function fn(_,I,w){ot(I,"offset"),(_[I]===void 0||_[I+w]===void 0)&&st(I,_.length-(w+1))}function ze(_,I,w,B,W,Y){if(_>w||_<I){const ne=typeof I=="bigint"?"n":"";let Ne;throw I===0||I===BigInt(0)?Ne=`>= 0${ne} and < 2${ne} ** ${(Y+1)*8}${ne}`:Ne=`>= -(2${ne} ** ${(Y+1)*8-1}${ne}) and < 2 ** ${(Y+1)*8-1}${ne}`,new ae.ERR_OUT_OF_RANGE("value",Ne,_)}fn(B,W,Y)}function ot(_,I){if(typeof _!="number")throw new ae.ERR_INVALID_ARG_TYPE(I,"number",_)}function st(_,I,w){throw Math.floor(_)!==_?(ot(_,w),new ae.ERR_OUT_OF_RANGE("offset","an integer",_)):I<0?new ae.ERR_BUFFER_OUT_OF_BOUNDS:new ae.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${I}`,_)}const he=/[^+/0-9A-Za-z-_]/g;function Ce(_){if(_=_.split("=")[0],_=_.trim().replace(he,""),_.length<2)return"";for(;_.length%4!==0;)_=_+"=";return _}function Ve(_,I){I=I||1/0;let w;const B=_.length;let W=null;const Y=[];for(let ne=0;ne<B;++ne){if(w=_.charCodeAt(ne),w>55295&&w<57344){if(!W){if(w>56319){(I-=3)>-1&&Y.push(239,191,189);continue}else if(ne+1===B){(I-=3)>-1&&Y.push(239,191,189);continue}W=w;continue}if(w<56320){(I-=3)>-1&&Y.push(239,191,189),W=w;continue}w=(W-55296<<10|w-56320)+65536}else W&&(I-=3)>-1&&Y.push(239,191,189);if(W=null,w<128){if((I-=1)<0)break;Y.push(w)}else if(w<2048){if((I-=2)<0)break;Y.push(w>>6|192,w&63|128)}else if(w<65536){if((I-=3)<0)break;Y.push(w>>12|224,w>>6&63|128,w&63|128)}else if(w<1114112){if((I-=4)<0)break;Y.push(w>>18|240,w>>12&63|128,w>>6&63|128,w&63|128)}else throw new Error("Invalid code point")}return Y}function Ue(_){const I=[];for(let w=0;w<_.length;++w)I.push(_.charCodeAt(w)&255);return I}function Pe(_,I){let w,B,W;const Y=[];for(let ne=0;ne<_.length&&!((I-=2)<0);++ne)w=_.charCodeAt(ne),B=w>>8,W=w%256,Y.push(W),Y.push(B);return Y}function $e(_){return t.toByteArray(Ce(_))}function at(_,I,w,B){let W;for(W=0;W<B&&!(W+w>=I.length||W>=_.length);++W)I[W+w]=_[W];return W}function Qe(_,I){return _ instanceof I||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===I.name}function Wt(_){return _!==_}const jt=function(){const _="0123456789abcdef",I=new Array(256);for(let w=0;w<16;++w){const B=w*16;for(let W=0;W<16;++W)I[B+W]=_[w]+_[W]}return I}();function wt(_){return typeof BigInt>"u"?an:_}function an(){throw new Error("BigInt not supported")}})(_n);var Qu=(e=>(e[e.BINARY=0]="BINARY",e[e.ECHO=1]="ECHO",e[e.RCP=2]="RCP",e[e.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",e[e.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",e[e.STATUS=5]="STATUS",e[e.TIMING_MARK=6]="TIMING_MARK",e[e.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",e[e.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",e[e.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",e[e.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",e[e.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",e[e.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",e[e.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",e[e.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",e[e.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",e[e.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",e[e.EXTENDED_ASCII=17]="EXTENDED_ASCII",e[e.LOGOUT=18]="LOGOUT",e[e.BYTE_MACRO=19]="BYTE_MACRO",e[e.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",e[e.SUPDUP=21]="SUPDUP",e[e.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",e[e.SEND_LOCATION=23]="SEND_LOCATION",e[e.TERMINAL_TYPE=24]="TERMINAL_TYPE",e[e.END_OF_RECORD=25]="END_OF_RECORD",e[e.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",e[e.OUTPUT_MARKING=27]="OUTPUT_MARKING",e[e.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",e[e.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",e[e.X_3_PAD=30]="X_3_PAD",e[e.NAWS=31]="NAWS",e[e.TERMINAL_SPEED=32]="TERMINAL_SPEED",e[e.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",e[e.LINEMODE=34]="LINEMODE",e[e.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",e[e.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",e[e.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",e[e.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",e[e.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",e[e.TN3270E=40]="TN3270E",e[e.XAUTH=41]="XAUTH",e[e.CHARSET=42]="CHARSET",e[e.RSP=43]="RSP",e[e.COM_PORT_OPTION=44]="COM_PORT_OPTION",e[e.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",e[e.START_TLS=46]="START_TLS",e[e.KERMIT=47]="KERMIT",e[e.SEND_URL=48]="SEND_URL",e[e.FORWARD_X=49]="FORWARD_X",e[e.PRAGMA_LOGON=138]="PRAGMA_LOGON",e[e.GMCP=201]="GMCP",e))(Qu||{}),ed=(e=>(e[e.SE=240]="SE",e[e.NOP=241]="NOP",e[e.DM=242]="DM",e[e.BRK=243]="BRK",e[e.IP=244]="IP",e[e.AO=245]="AO",e[e.AYT=246]="AYT",e[e.EC=247]="EC",e[e.EL=248]="EL",e[e.GA=249]="GA",e[e.SB=250]="SB",e[e.WILL=251]="WILL",e[e.WONT=252]="WONT",e[e.DO=253]="DO",e[e.DONT=254]="DONT",e[e.IAC=255]="IAC",e))(ed||{});class q4{constructor(t){M(this,"ws");this.ws=t}on(t,n){if(t==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+t;this[r]=n}write(t){this.ws.send(t)}}class Q4 extends _p{constructor(n){super();M(this,"state");M(this,"buffer");M(this,"subBuffer");M(this,"iacSEBuffer",_n.Buffer.from([255,240]));M(this,"negotiationByte",0);M(this,"stream");this.state=0,this.buffer=_n.Buffer.alloc(0),this.subBuffer=_n.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=_n.Buffer.concat([this.buffer,_n.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=_n.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=_n.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(n,r){this.stream.write(_n.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,o=_n.Buffer.from(i),s=_n.Buffer.concat([_n.Buffer.from([255,250]),_n.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(s)}sendTerminalType(n){const r=_n.Buffer.from(n),i=_n.Buffer.concat([_n.Buffer.from([255,250]),_n.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function eO({onlyFirst:e=!1}={}){const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(n,e?void 0:"g")}const tO=eO();function nO(e){if(typeof e!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);return e.replace(tO,"")}class rO{constructor(t){M(this,"editors");M(this,"channel");this.client=t,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(t){console.log("Opening editor window for session:",t);const n=t.reference,r=this.editors.get(n);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(n),o=window.open(`/editor?reference=${i}`,"_blank"),s={...t,window:o,state:0};this.editors.set(n,s),o&&o.focus()}}saveEditorWindow(t){const n={reference:t.reference,type:t.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",n,t.contents)}setupChannelListeners(){this.channel.onmessage=t=>{console.log("Editor window message:",t);const{type:n,id:r,session:i}=t.data;switch(n){case"ready":console.log("Editor window ready, id:",r);const o=this.editors.get(r);if(o){o.state=1;const{window:a,...l}=o;this.channel.postMessage({type:"load",session:l})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const s=this.editors.get(r);s&&(s.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((t,n)=>{try{t.state===1&&t.window&&(console.log(`Closing editor window for ${n}`),t.window.close(),this.channel.postMessage({type:"shutdown",id:n}))}catch(r){console.error(`Error closing editor window ${n}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class Vt{constructor(t){M(this,"packageName");M(this,"packageVersion",1);M(this,"client");this.client=t}sendData(t,n){this.client.sendGmcp(this.packageName+"."+t,JSON.stringify(n))}shutdown(){}}class iO extends Vt{constructor(){super(...arguments);M(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class qT extends Vt{constructor(){super(...arguments);M(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}handleVitals(n){console.log("Received Char.Vitals:",n),this.client.emit("vitals",n)}handleStatusVars(n){console.log("Received Char.StatusVars:",n),this.client.emit("statusVars",n)}handleStatus(n){console.log("Received Char.Status:",n),this.client.emit("statusUpdate",n)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class oO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Offer")}handleOffer(n){console.log("Received Char.Offer:",n),this.client.emit("offer",n)}sendOfferRequest(){this.sendData("Offer",{})}}class sO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Prompt")}handlePrompt(n){console.log("Received Char.Prompt:",n),this.client.emit("prompt",n)}sendPromptRequest(){this.sendData("Prompt",{})}}class aO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status")}handleStatus(n){console.log("Received Char.Status:",n),this.client.emit("status",n)}sendStatusRequest(){this.sendData("Status",{})}}class lO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status.AffectedBy")}handleAffectedBy(n){console.log("Received Char.Status.AffectedBy:",n),this.client.emit("statusAffectedBy",n)}sendAffectedByRequest(){this.sendData("AffectedBy",{})}}class cO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status.Conditions")}handleConditions(n){console.log("Received Char.Status.Conditions:",n),this.client.emit("statusConditions",n)}sendConditionsRequest(){this.sendData("Conditions",{})}}class uO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status.Timers")}handleTimers(n){console.log("Received Char.Status.Timers:",n),this.client.emit("statusTimers",n)}sendTimersRequest(){this.sendData("Timers",{})}}class QT extends Vt{constructor(){super(...arguments);M(this,"packageName","Client.FileTransfer")}sendCandidate(n,r){this.sendData("Candidate",{recipient:n,candidate:JSON.stringify(r)})}handleCandidate(n){const r=JSON.parse(n.candidate);this.client.webRTCService.handleIceCandidate(r)}handleOffer(n){console.log("[GMCPClientFileTransfer] Received offer:",n),this.client.fileTransferManager.pendingOffers.set(`${n.hash}`,n),this.client.onFileTransferOffer(n.sender,n.hash,n.filename,n.filesize,n.offerSdp)}handleAccept(n){this.client.onFileTransferAccept(n.sender,n.hash,n.filename,n.answerSdp)}handleReject(n){this.client.onFileTransferReject(n.sender,n.hash)}handleCancel(n){this.client.onFileTransferCancel(n.sender,n.hash)}sendOffer(n,r,i,o,s){this.sendData("Offer",{recipient:n,filename:r,filesize:i,offerSdp:o,hash:s})}sendAccept(n,r,i,o){this.sendData("Accept",{sender:n,hash:r,filename:i,answerSdp:o})}sendReject(n,r){this.sendData("Reject",{sender:n,hash:r})}sendCancel(n,r){this.sendData("Cancel",{recipient:n,hash:r})}sendRequestResend(n,r){this.sendData("RequestResend",{sender:n,hash:r})}}function k1(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ll=k1();function e2(e){Ll=e}var Cd={exec:()=>null};function mt(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(i,o)=>{let s=typeof o=="string"?o:o.source;return s=s.replace(lr.caret,"$1"),n=n.replace(i,s),r},getRegex:()=>new RegExp(n,t)};return r}var lr={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},dO=/^(?:[ \t]*(?:\n|$))+/,fO=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,hO=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,bf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,pO=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,E1=/(?:[*+-]|\d{1,9}[.)])/,t2=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,n2=mt(t2).replace(/bull/g,E1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),gO=mt(t2).replace(/bull/g,E1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),T1=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,mO=/^[^\n]+/,R1=/(?!\s*\])(?:\\.|[^\[\]\\])+/,vO=mt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",R1).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),CO=mt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,E1).getRegex(),Pp="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_1=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,yO=mt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",_1).replace("tag",Pp).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),r2=mt(T1).replace("hr",bf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex(),xO=mt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",r2).getRegex(),D1={blockquote:xO,code:fO,def:vO,fences:hO,heading:pO,hr:bf,html:yO,lheading:n2,list:CO,newline:dO,paragraph:r2,table:Cd,text:mO},Bb=mt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",bf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex(),IO={...D1,lheading:gO,table:Bb,paragraph:mt(T1).replace("hr",bf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Bb).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex()},bO={...D1,html:mt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_1).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Cd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:mt(T1).replace("hr",bf).replace("heading",` *#{1,6} *[^
]`).replace("lheading",n2).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},AO=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,wO=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,i2=/^( {2,}|\\)\n(?!\s*$)/,SO=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Np=/[\p{P}\p{S}]/u,P1=/[\s\p{P}\p{S}]/u,o2=/[^\s\p{P}\p{S}]/u,kO=mt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,P1).getRegex(),s2=/(?!~)[\p{P}\p{S}]/u,EO=/(?!~)[\s\p{P}\p{S}]/u,TO=/(?:[^\s\p{P}\p{S}]|~)/u,RO=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,a2=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,_O=mt(a2,"u").replace(/punct/g,Np).getRegex(),DO=mt(a2,"u").replace(/punct/g,s2).getRegex(),l2="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",PO=mt(l2,"gu").replace(/notPunctSpace/g,o2).replace(/punctSpace/g,P1).replace(/punct/g,Np).getRegex(),NO=mt(l2,"gu").replace(/notPunctSpace/g,TO).replace(/punctSpace/g,EO).replace(/punct/g,s2).getRegex(),BO=mt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,o2).replace(/punctSpace/g,P1).replace(/punct/g,Np).getRegex(),OO=mt(/\\(punct)/,"gu").replace(/punct/g,Np).getRegex(),FO=mt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),MO=mt(_1).replace("(?:-->|$)","-->").getRegex(),LO=mt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",MO).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),R0=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,UO=mt(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",R0).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),c2=mt(/^!?\[(label)\]\[(ref)\]/).replace("label",R0).replace("ref",R1).getRegex(),u2=mt(/^!?\[(ref)\](?:\[\])?/).replace("ref",R1).getRegex(),VO=mt("reflink|nolink(?!\\()","g").replace("reflink",c2).replace("nolink",u2).getRegex(),N1={_backpedal:Cd,anyPunctuation:OO,autolink:FO,blockSkip:RO,br:i2,code:wO,del:Cd,emStrongLDelim:_O,emStrongRDelimAst:PO,emStrongRDelimUnd:BO,escape:AO,link:UO,nolink:u2,punctuation:kO,reflink:c2,reflinkSearch:VO,tag:LO,text:SO,url:Cd},GO={...N1,link:mt(/^!?\[(label)\]\((.*?)\)/).replace("label",R0).getRegex(),reflink:mt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",R0).getRegex()},nC={...N1,emStrongRDelimAst:NO,emStrongLDelim:DO,url:mt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},WO={...nC,br:mt(i2).replace("{2,}","*").getRegex(),text:mt(nC.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},eh={normal:D1,gfm:IO,pedantic:bO},Bu={normal:N1,gfm:nC,breaks:WO,pedantic:GO},jO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ob=e=>jO[e];function lo(e,t){if(t){if(lr.escapeTest.test(e))return e.replace(lr.escapeReplace,Ob)}else if(lr.escapeTestNoEncode.test(e))return e.replace(lr.escapeReplaceNoEncode,Ob);return e}function Fb(e){try{e=encodeURI(e).replace(lr.percentDecode,"%")}catch{return null}return e}function Mb(e,t){var o;const n=e.replace(lr.findPipe,(s,a,l)=>{let c=!1,u=a;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(lr.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(lr.slashPipe,"|");return r}function Ou(e,t,n){const r=e.length;if(r===0)return"";let i=0;for(;i<r&&e.charAt(r-i-1)===t;)i++;return e.slice(0,r-i)}function zO(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function Lb(e,t,n,r,i){const o=t.href,s=t.title||null,a=e[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:o,title:s,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,l}function HO(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const i=r[1];return t.split(`
`).map(o=>{const s=o.match(n.other.beginningSpace);if(s===null)return o;const[a]=s;return a.length>=i.length?o.slice(i.length):o}).join(`
`)}var _0=class{constructor(e){M(this,"options");M(this,"rules");M(this,"lexer");this.options=e||Ll}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Ou(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=HO(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=Ou(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Ou(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=Ou(t[0],`
`).split(`
`),r="",i="";const o=[];for(;n.length>0;){let s=!1;const a=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))a.push(n[l]),s=!0;else if(!s)a.push(n[l]);else break;n=n.slice(l);const c=a.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,i=i?`${i}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,o,!0),this.lexer.state.top=d,n.length===0)break;const f=o.at(-1);if((f==null?void 0:f.type)==="code")break;if((f==null?void 0:f.type)==="blockquote"){const h=f,p=h.raw+`
`+n.join(`
`),g=this.blockquote(p);o[o.length-1]=g,r=r.substring(0,r.length-h.raw.length)+g.raw,i=i.substring(0,i.length-h.text.length)+g.text;break}else if((f==null?void 0:f.type)==="list"){const h=f,p=h.raw+`
`+n.join(`
`),g=this.list(p);o[o.length-1]=g,r=r.substring(0,r.length-f.raw.length)+g.raw,i=i.substring(0,i.length-h.raw.length)+g.raw,n=p.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,i={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const o=this.rules.other.listItemRegex(n);let s=!1;for(;e;){let l=!1,c="",u="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,v=>" ".repeat(3*v.length)),f=e.split(`
`,1)[0],h=!d.trim(),p=0;if(this.options.pedantic?(p=2,u=d.trimStart()):h?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,u=d.slice(p),p+=t[1].length),h&&this.rules.other.blankLine.test(f)&&(c+=f+`
`,e=e.substring(f.length+1),l=!0),!l){const v=this.rules.other.nextBulletRegex(p),m=this.rules.other.hrRegex(p),y=this.rules.other.fencesBeginRegex(p),x=this.rules.other.headingBeginRegex(p),b=this.rules.other.htmlBeginRegex(p);for(;e;){const k=e.split(`
`,1)[0];let A;if(f=k,this.options.pedantic?(f=f.replace(this.rules.other.listReplaceNesting,"  "),A=f):A=f.replace(this.rules.other.tabCharGlobal,"    "),y.test(f)||x.test(f)||b.test(f)||v.test(f)||m.test(f))break;if(A.search(this.rules.other.nonSpaceChar)>=p||!f.trim())u+=`
`+A.slice(p);else{if(h||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||y.test(d)||x.test(d)||m.test(d))break;u+=`
`+f}!h&&!f.trim()&&(h=!0),c+=k+`
`,e=e.substring(k.length+1),d=A.slice(p)}}i.loose||(s?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(s=!0));let g=null,C;this.options.gfm&&(g=this.rules.other.listIsTask.exec(u),g&&(C=g[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!g,checked:C,loose:!1,text:u,tokens:[]}),i.raw+=c}const a=i.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let l=0;l<i.items.length;l++)if(this.lexer.state.top=!1,i.items[l].tokens=this.lexer.blockTokens(i.items[l].text,[]),!i.loose){const c=i.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));i.loose=u}if(i.loose)for(let l=0;l<i.items.length;l++)i.items[l].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:i}}}table(e){var s;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=Mb(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(s=t[3])!=null&&s.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const a of r)this.rules.other.tableAlignRight.test(a)?o.align.push("right"):this.rules.other.tableAlignCenter.test(a)?o.align.push("center"):this.rules.other.tableAlignLeft.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<n.length;a++)o.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:o.align[a]});for(const a of i)o.rows.push(Mb(a,o.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[c]})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const o=Ou(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{const o=zO(t[2],"()");if(o===-2)return;if(o>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let r=t[2],i="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],i=o[3])}else i=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Lb(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[r.toLowerCase()];if(!i){const o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return Lb(n,i,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const o=[...r[0]].length-1;let s,a,l=o,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+o);(r=u.exec(t))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(a=[...s].length,r[3]||r[4]){l+=a;continue}else if((r[5]||r[6])&&o%3&&!((o+a)%3)){c+=a;continue}if(l-=a,l>0)continue;a=Math.min(a,a+l+c);const d=[...r[0]][0].length,f=e.slice(0,o+r.index+d+a);if(Math.min(o,a)%2){const p=f.slice(1,-1);return{type:"em",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}const h=f.slice(2,-2);return{type:"strong",raw:f,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),i=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&i&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,i;if(t[2]==="@")r=t[0],i="mailto:"+r;else{let o;do o=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(o!==t[0]);r=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},is=class rC{constructor(t){M(this,"tokens");M(this,"options");M(this,"state");M(this,"tokenizer");M(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Ll,this.options.tokenizer=this.options.tokenizer||new _0,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:lr,block:eh.normal,inline:Bu.normal};this.options.pedantic?(n.block=eh.pedantic,n.inline=Bu.pedantic):this.options.gfm&&(n.block=eh.gfm,this.options.breaks?n.inline=Bu.breaks:n.inline=Bu.gfm),this.tokenizer.rules=n}static get rules(){return{block:eh,inline:Bu}}static lex(t,n){return new rC(n).lex(t)}static lexInline(t,n){return new rC(n).inlineTokens(t)}lex(t){t=t.replace(lr.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var i,o,s;for(this.options.pedantic&&(t=t.replace(lr.tabCharGlobal,"    ").replace(lr.spaceLine,""));t;){let a;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(c=>(a=c.call({lexer:this},t,n))?(t=t.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(t)){t=t.substring(a.raw.length);const c=n.at(-1);a.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(t)){t=t.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(a=this.tokenizer.fences(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(t)){t=t.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(t)){t=t.substring(a.raw.length),n.push(a);continue}let l=t;if((s=this.options.extensions)!=null&&s.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(a=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a),r=l.length!==t.length,t=t.substring(a.raw.length);continue}if(a=this.tokenizer.text(t)){t=t.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var a,l,c;let r=t,i=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,s="";for(;t;){o||(s=""),o=!1;let u;if((l=(a=this.options.extensions)==null?void 0:a.inline)!=null&&l.some(f=>(u=f.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const f=n.at(-1);u.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,s)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let f=1/0;const h=t.slice(1);let p;this.options.extensions.startInline.forEach(g=>{p=g.call({lexer:this},h),typeof p=="number"&&p>=0&&(f=Math.min(f,p))}),f<1/0&&f>=0&&(d=t.substring(0,f+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(s=u.raw.slice(-1)),o=!0;const f=n.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):n.push(u);continue}if(t){const f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}},D0=class{constructor(e){M(this,"options");M(this,"parser");this.options=e||Ll}space(e){return""}code({text:e,lang:t,escaped:n}){var o;const r=(o=(t||"").match(lr.notSpaceStart))==null?void 0:o[0],i=e.replace(lr.endingNewline,"")+`
`;return r?'<pre><code class="language-'+lo(r)+'">'+(n?i:lo(i,!0))+`</code></pre>
`:"<pre><code>"+(n?i:lo(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let s=0;s<e.items.length;s++){const a=e.items[s];r+=this.listitem(a)}const i=t?"ol":"ul",o=t&&n!==1?' start="'+n+'"':"";return"<"+i+o+`>
`+r+"</"+i+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+lo(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let i=0;i<e.header.length;i++)n+=this.tablecell(e.header[i]);t+=this.tablerow({text:n});let r="";for(let i=0;i<e.rows.length;i++){const o=e.rows[i];n="";for(let s=0;s<o.length;s++)n+=this.tablecell(o[s]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${lo(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),i=Fb(e);if(i===null)return r;e=i;let o='<a href="'+e+'"';return t&&(o+=' title="'+lo(t)+'"'),o+=">"+r+"</a>",o}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const i=Fb(e);if(i===null)return lo(n);e=i;let o=`<img src="${e}" alt="${n}"`;return t&&(o+=` title="${lo(t)}"`),o+=">",o}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:lo(e.text)}},B1=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},os=class iC{constructor(t){M(this,"options");M(this,"renderer");M(this,"textRenderer");this.options=t||Ll,this.options.renderer=this.options.renderer||new D0,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new B1}static parse(t,n){return new iC(n).parse(t)}static parseInline(t,n){return new iC(n).parseInline(t)}parse(t,n=!0){var i,o;let r="";for(let s=0;s<t.length;s++){const a=t[s];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[a.type]){const c=a,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=a;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;s+1<t.length&&t[s+1].type==="text";)c=t[++s],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var i,o;let r="";for(let s=0;s<t.length;s++){const a=t[s];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[a.type]){const c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=c||"";continue}}const l=a;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},iv,Rh=(iv=class{constructor(e){M(this,"options");M(this,"block");this.options=e||Ll}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?is.lex:is.lexInline}provideParser(){return this.block?os.parse:os.parseInline}},M(iv,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),iv),ZO=class{constructor(...e){M(this,"defaults",k1());M(this,"options",this.setOptions);M(this,"parse",this.parseMarkdown(!0));M(this,"parseInline",this.parseMarkdown(!1));M(this,"Parser",os);M(this,"Renderer",D0);M(this,"TextRenderer",B1);M(this,"Lexer",is);M(this,"Tokenizer",_0);M(this,"Hooks",Rh);this.use(...e)}walkTokens(e,t){var r,i;let n=[];for(const o of e)switch(n=n.concat(t.call(this,o)),o.type){case"table":{const s=o;for(const a of s.header)n=n.concat(this.walkTokens(a.tokens,t));for(const a of s.rows)for(const l of a)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const s=o;n=n.concat(this.walkTokens(s.items,t));break}default:{const s=o;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[s.type]?this.defaults.extensions.childTokens[s.type].forEach(a=>{const l=s[a].flat(1/0);n=n.concat(this.walkTokens(l,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const o=t.renderers[i.name];o?t.renderers[i.name]=function(...s){let a=i.renderer.apply(this,s);return a===!1&&(a=o.apply(this,s)),a}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[i.level];o?o.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),r.extensions=t),n.renderer){const i=this.defaults.renderer||new D0(this.defaults);for(const o in n.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const s=o,a=n.renderer[s],l=i[s];i[s]=(...c)=>{let u=a.apply(i,c);return u===!1&&(u=l.apply(i,c)),u||""}}r.renderer=i}if(n.tokenizer){const i=this.defaults.tokenizer||new _0(this.defaults);for(const o in n.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const s=o,a=n.tokenizer[s],l=i[s];i[s]=(...c)=>{let u=a.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.tokenizer=i}if(n.hooks){const i=this.defaults.hooks||new Rh;for(const o in n.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const s=o,a=n.hooks[s],l=i[s];Rh.passThroughHooks.has(o)?i[s]=c=>{if(this.defaults.async)return Promise.resolve(a.call(i,c)).then(d=>l.call(i,d));const u=a.call(i,c);return l.call(i,u)}:i[s]=(...c)=>{let u=a.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.hooks=i}if(n.walkTokens){const i=this.defaults.walkTokens,o=n.walkTokens;r.walkTokens=function(s){let a=[];return a.push(o.call(this,s)),i&&(a=a.concat(i.call(this,s))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return is.lex(e,t??this.defaults)}parser(e,t){return os.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const i={...r},o={...this.defaults,...i},s=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&i.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=e);const a=o.hooks?o.hooks.provideLexer():e?is.lex:is.lexInline,l=o.hooks?o.hooks.provideParser():e?os.parse:os.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(n):n).then(c=>a(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>l(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(s);try{o.hooks&&(n=o.hooks.preprocess(n));let c=a(n,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let u=l(c,o);return o.hooks&&(u=o.hooks.postprocess(u)),u}catch(c){return s(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+lo(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},kl=new ZO;function yt(e,t){return kl.parse(e,t)}yt.options=yt.setOptions=function(e){return kl.setOptions(e),yt.defaults=kl.defaults,e2(yt.defaults),yt};yt.getDefaults=k1;yt.defaults=Ll;yt.use=function(...e){return kl.use(...e),yt.defaults=kl.defaults,e2(yt.defaults),yt};yt.walkTokens=function(e,t){return kl.walkTokens(e,t)};yt.parseInline=kl.parseInline;yt.Parser=os;yt.parser=os.parse;yt.Renderer=D0;yt.TextRenderer=B1;yt.Lexer=is;yt.lexer=is.lex;yt.Tokenizer=_0;yt.Hooks=Rh;yt.parse=yt;yt.options;yt.setOptions;yt.use;yt.walkTokens;yt.parseInline;os.parse;is.lex;class $O extends Vt{constructor(n){super(n);M(this,"packageName","Client.Html")}handleAdd_html(n){this.client.emit("html",n.data.join(`
`))}handleAdd_markdown(n){const r=n.data.join(`
`),i=yt(r);this.client.emit("html",i)}}class XO{constructor(){M(this,"state",{text:""});M(this,"listeners",new Set);M(this,"dispatch",t=>{const n=this.state;this.state=this.reducer(this.state,t),this.state!==n&&this.listeners.forEach(r=>r())})}reducer(t,n){switch(n.type){case"SET_INPUT":return t.text!==n.data?{...t,text:n.data}:t;case"CLEAR_INPUT":return t.text!==""?{...t,text:""}:t;default:return t}}getState(){return this.state}subscribe(t){return this.listeners.add(t),()=>{this.listeners.delete(t)}}}const wc=new XO,yd=e=>{wc.dispatch({type:"SET_INPUT",data:e})},KO=()=>{wc.dispatch({type:"CLEAR_INPUT"})};class JO extends Vt{constructor(n){super(n);M(this,"packageName","Client.Keystrokes");M(this,"bindings",[]);M(this,"boundKeyDownHandler");this.boundKeyDownHandler=this.handleKeydown.bind(this),document.addEventListener("keydown",this.boundKeyDownHandler)}handleKeydown(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=wc.getState().text,o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",this.boundKeyDownHandler)}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"alt",n.ctrlKey&&"control",n.shiftKey&&"shift",n.metaKey&&"meta"].filter(Boolean)),o=new Set((r.modifiers||[]).map(s=>s.toLowerCase()));return i.size!==o.size?!1:Array.from(o).every(s=>i.has(s))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(o,s)=>{if(s==="*")return r;const a=parseInt(s,10)-1;return a>=0&&a<i.length?i[a]:o})}placeInInputField(n){yd(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){const r=new Set((n.modifiers||[]).map(i=>i.toLowerCase()));this.bindings=this.bindings.filter(i=>{const o=new Set((i.modifiers||[]).map(a=>a.toLowerCase()));return i.key.toLowerCase()!==n.key.toLowerCase()||o.size!==r.size?!0:!Array.from(r).every(a=>o.has(a))})}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}handleUnbindAll(n){console.log("Received Client.Keystrokes.UnbindAll, clearing all bindings."),this.unbindAll()}handleListBindings(n){console.log("Received Client.Keystrokes.ListBindings request, sending current bindings.");const r=this.listBindings();this.sendData("BindingsList",r)}listBindings(){return[...this.bindings]}}const Ub=(e,t,n)=>({endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}),Vb=(e,t,n)=>({endTime:t,insertTime:n,type:"linearRampToValue",value:e}),oC=(e,t)=>({startTime:t,type:"setValue",value:e}),d2=(e,t,n)=>({duration:n,startTime:t,type:"setValueCurve",values:e}),f2=(e,t,{startTime:n,target:r,timeConstant:i})=>r+(t-r)*Math.exp((n-e)/i),gc=e=>e.type==="exponentialRampToValue",P0=e=>e.type==="linearRampToValue",ua=e=>gc(e)||P0(e),O1=e=>e.type==="setValue",Jo=e=>e.type==="setValueCurve",N0=(e,t,n,r)=>{const i=e[t];return i===void 0?r:ua(i)||O1(i)?i.value:Jo(i)?i.values[i.values.length-1]:f2(n,N0(e,t-1,i.startTime,r),i)},Gb=(e,t,n,r,i)=>n===void 0?[r.insertTime,i]:ua(n)?[n.endTime,n.value]:O1(n)?[n.startTime,n.value]:Jo(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,N0(e,t-1,n.startTime,i)],sC=e=>e.type==="cancelAndHold",aC=e=>e.type==="cancelScheduledValues",qs=e=>sC(e)||aC(e)?e.cancelTime:gc(e)||P0(e)?e.endTime:e.startTime,Wb=(e,t,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((e-t)/(r-t)):0,jb=(e,t,n,{endTime:r,value:i})=>n+(e-t)/(r-t)*(i-n),YO=(e,t)=>{const n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]},qO=(e,{duration:t,startTime:n,values:r})=>{const i=(e-n)/t*(r.length-1);return YO(r,i)},th=e=>e.type==="setTarget";class QO{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const n=qs(t);if(sC(t)||aC(t)){const r=this._automationEvents.findIndex(o=>aC(t)&&Jo(o)?o.startTime+o.duration>=n:qs(o)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),sC(t)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&ua(i)){if(o!==void 0&&th(o))throw new Error("The internal list is malformed.");const s=o===void 0?i.insertTime:Jo(o)?o.startTime+o.duration:qs(o),a=o===void 0?this._defaultValue:Jo(o)?o.values[o.values.length-1]:o.value,l=gc(i)?Wb(n,s,a,i):jb(n,s,a,i),c=gc(i)?Ub(l,n,this._currenTime):Vb(l,n,this._currenTime);this._automationEvents.push(c)}if(o!==void 0&&th(o)&&this._automationEvents.push(oC(this.getValue(n),n)),o!==void 0&&Jo(o)&&o.startTime+o.duration>n){const s=n-o.startTime,a=(o.values.length-1)/o.duration,l=Math.max(2,1+Math.ceil(s*a)),c=s/(l-1)*a,u=o.values.slice(0,l);if(c<1)for(let d=1;d<l;d+=1){const f=c*d%1;u[d]=o.values[d-1]*(1-f)+o.values[d]*f}this._automationEvents[this._automationEvents.length-1]=d2(u,o.startTime,s)}}}else{const r=this._automationEvents.findIndex(s=>qs(s)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Jo(i)&&qs(i)+i.duration>n)return!1;const o=gc(t)?Ub(t.value,t.endTime,this._currenTime):P0(t)?Vb(t.value,n,this._currenTime):t;if(r===-1)this._automationEvents.push(o);else{if(Jo(t)&&n+t.duration>qs(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(t){const n=this._automationEvents.findIndex(r=>qs(r)>t);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];th(i)&&r.unshift(oC(N0(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(s=>qs(s)>t),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(o!==void 0&&th(o)&&(r===void 0||!ua(r)||r.insertTime>t))return f2(t,N0(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&O1(o)&&(r===void 0||!ua(r)))return o.value;if(o!==void 0&&Jo(o)&&(r===void 0||!ua(r)||o.startTime+o.duration>t))return t<o.startTime+o.duration?qO(t,o):o.values[o.values.length-1];if(o!==void 0&&ua(o)&&(r===void 0||!ua(r)))return o.value;if(r!==void 0&&gc(r)){const[s,a]=Gb(this._automationEvents,i,o,r,this._defaultValue);return Wb(t,s,a,r)}if(r!==void 0&&P0(r)){const[s,a]=Gb(this._automationEvents,i,o,r,this._defaultValue);return jb(t,s,a,r)}return this._defaultValue}}const eF=e=>({cancelTime:e,type:"cancelAndHold"}),tF=e=>({cancelTime:e,type:"cancelScheduledValues"}),nF=(e,t)=>({endTime:t,type:"exponentialRampToValue",value:e}),rF=(e,t)=>({endTime:t,type:"linearRampToValue",value:e}),iF=(e,t,n)=>({startTime:t,target:e,timeConstant:n,type:"setTarget"}),oF=()=>new DOMException("","AbortError"),sF=e=>(t,n,[r,i,o],s)=>{e(t[i],[n,r,o],a=>a[0]===n&&a[1]===r,s)},aF=e=>(t,n,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);e.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},lF=e=>(t,n)=>{e.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Zc=new WeakSet,h2=new WeakMap,p2=new WeakMap,g2=new WeakMap,m2=new WeakMap,v2=new WeakMap,C2=new WeakMap,lC=new WeakMap,cC=new WeakMap,uC=new WeakMap,y2={construct(){return y2}},cF=e=>{try{const t=new Proxy(e,y2);new t}catch{return!1}return!0},zb=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Hb=(e,t)=>{const n=[];let r=e.replace(/^[\s]+/,""),i=r.match(zb);for(;i!==null;){const o=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,t).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(zb)}return[n.join(";"),r]},Zb=e=>{if(e!==void 0&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},$b=e=>{if(!cF(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(e.prototype===null||typeof e.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},uF=(e,t,n,r,i,o,s,a,l,c,u,d,f)=>{let h=0;return(p,g,C={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(g))return Promise.resolve();const m=c.get(p);if(m!==void 0){const b=m.get(g);if(b!==void 0)return b}const y=o(p),x=y.audioWorklet===void 0?i(g).then(([b,k])=>{const[A,E]=Hb(b,k),D=`${A};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${E}
})})(window,'_AWGS')`;return n(D)}).then(()=>{const b=f._AWGS.pop();if(b===void 0)throw new SyntaxError;r(y.currentTime,y.sampleRate,()=>b(class{},void 0,(k,A)=>{if(k.trim()==="")throw t();const E=cC.get(y);if(E!==void 0){if(E.has(k))throw t();$b(A),Zb(A.parameterDescriptors),E.set(k,A)}else $b(A),Zb(A.parameterDescriptors),cC.set(y,new Map([[k,A]]))},y.sampleRate,void 0,void 0))}):Promise.all([i(g),Promise.resolve(e(d,d))]).then(([[b,k],A])=>{const E=h+1;h=E;const[D,T]=Hb(b,k),z=`${D};((AudioWorkletProcessor,registerProcessor)=>{${T}
})(${A?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${A?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${A?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${E}',class extends AudioWorkletProcessor{process(){return !1}})`,Z=new Blob([z],{type:"application/javascript; charset=utf-8"}),Q=URL.createObjectURL(Z);return y.audioWorklet.addModule(Q,C).then(()=>{if(a(y))return y;const ie=s(y);return ie.audioWorklet.addModule(Q,C).then(()=>ie)}).then(ie=>{if(l===null)throw new SyntaxError;try{new l(ie,`__sac${E}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(Q))});return m===void 0?c.set(p,new Map([[g,x]])):m.set(g,x),x.then(()=>{const b=u.get(p);b===void 0?u.set(p,new Set([g])):b.add(g)}).finally(()=>{const b=c.get(p);b!==void 0&&b.delete(g)}),x}},Yi=(e,t)=>{const n=e.get(t);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},Bp=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return e.delete(r),r},x2=(e,t,n,r)=>{const i=Yi(e,t),o=Bp(i,s=>s[0]===n&&s[1]===r);return i.size===0&&e.delete(t),o},Af=e=>Yi(C2,e),$c=e=>{if(Zc.has(e))throw new Error("The AudioNode is already stored.");Zc.add(e),Af(e).forEach(t=>t(!0))},I2=e=>"port"in e,wf=e=>{if(!Zc.has(e))throw new Error("The AudioNode is not stored.");Zc.delete(e),Af(e).forEach(t=>t(!1))},dC=(e,t)=>{!I2(e)&&t.every(n=>n.size===0)&&wf(e)},dF=(e,t,n,r,i,o,s,a,l,c,u,d,f)=>{const h=new WeakMap;return(p,g,C,v,m)=>{const{activeInputs:y,passiveInputs:x}=o(g),{outputs:b}=o(p),k=a(p),A=E=>{const D=l(g),T=l(p);if(E){const R=x2(x,p,C,v);e(y,p,R,!1),!m&&!d(p)&&n(T,D,C,v),f(g)&&$c(g)}else{const R=r(y,p,C,v);t(x,v,R,!1),!m&&!d(p)&&i(T,D,C,v);const P=s(g);if(P===0)u(g)&&dC(g,y);else{const L=h.get(g);L!==void 0&&clearTimeout(L),h.set(g,setTimeout(()=>{u(g)&&dC(g,y)},P*1e3))}}};return c(b,[g,C,v],E=>E[0]===g&&E[1]===C&&E[2]===v,!0)?(k.add(A),u(p)?e(y,p,[C,v,A],!0):t(x,v,[p,C,A],!0),!0):!1}},fF=e=>(t,n,[r,i,o],s)=>{const a=t.get(r);a===void 0?t.set(r,new Set([[i,n,o]])):e(a,[i,n,o],l=>l[0]===i&&l[1]===n,s)},hF=e=>(t,n)=>{const r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(t.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},pF=e=>(t,n)=>{e(t).add(n)},gF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},mF=(e,t,n,r,i,o)=>class extends e{constructor(a,l){const c=i(a),u={...gF,...l},d=r(c,u),f=o(c)?t():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},qn=(e,t)=>e.context===t,vF=(e,t,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=t(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=e(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},fC=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Go=()=>new DOMException("","IndexSizeError"),b2=e=>{e.getChannelData=(t=>n=>{try{return t.call(e,n)}catch(r){throw r.code===12?Go():r}})(e.getChannelData)},CF={numberOfChannels:1},yF=(e,t,n,r,i,o,s,a)=>{let l=null;return class A2{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...CF,...u};l===null&&(l=new i(1,1,44100));const p=r!==null&&t(o,o)?new r({length:d,numberOfChannels:f,sampleRate:h}):l.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(s(p),b2(p)):t(fC,()=>fC(p))||a(p),e.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===A2.prototype||e.has(u)}}},Kr=-34028234663852886e22,or=34028234663852886e22,Ds=e=>Zc.has(e),xF={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},IF=(e,t,n,r,i,o,s,a)=>class extends e{constructor(c,u){const d=o(c),f={...xF,...u},h=i(d,f),p=s(d),g=p?t():null;super(c,!1,h,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,or,Kr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?c:d}get playbackRate(){return this._playbackRate}start(c=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(c,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[c,u]:[c,u,d]),this.context.state!=="closed"){$c(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Ds(this)&&wf(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},bF=(e,t,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=qn(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=t(u,h),s!==null&&d.start(...s),a!==null&&d.stop(a)}return o.set(u,d),f?await e(u,c.playbackRate,d.playbackRate):await r(u,c.playbackRate,d.playbackRate),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},AF=e=>"playbackRate"in e,wF=e=>"frequency"in e&&"gain"in e,SF=e=>"offset"in e,kF=e=>!("frequency"in e)&&"gain"in e,EF=e=>"detune"in e&&"frequency"in e&&!("gain"in e),TF=e=>"pan"in e,cr=e=>Yi(h2,e),Sf=e=>Yi(g2,e),hC=(e,t)=>{const{activeInputs:n}=cr(e);n.forEach(i=>i.forEach(([o])=>{t.includes(e)||hC(o,[...t,e])}));const r=AF(e)?[e.playbackRate]:I2(e)?Array.from(e.parameters.values()):wF(e)?[e.Q,e.detune,e.frequency,e.gain]:SF(e)?[e.offset]:kF(e)?[e.gain]:EF(e)?[e.detune,e.frequency]:TF(e)?[e.pan]:[];for(const i of r){const o=Sf(i);o!==void 0&&o.activeInputs.forEach(([s])=>hC(s,t))}Ds(e)&&wf(e)},RF=e=>{hC(e.destination,[])},_F=e=>e===void 0||typeof e=="number"||typeof e=="string"&&(e==="balanced"||e==="interactive"||e==="playback"),DF=(e,t,n,r,i,o,s,a,l)=>class extends e{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new l(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!_F(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,l.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),RF(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?t():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?t():u})}},PF=(e,t,n,r,i,o,s,a)=>class extends e{constructor(c,u){const d=o(c),f=s(d),h=i(d,u,f),p=f?t(a):null;super(c,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},NF=e=>{const t=new WeakMap,n=async(r,i)=>{const o=i.destination;return t.set(i,o),await e(r,i,o),o};return{render(r,i){const o=t.get(i);return o!==void 0?Promise.resolve(o):n(r,i)}}},BF=(e,t,n,r,i,o,s,a)=>(l,c)=>{const u=c.listener,d=()=>{const b=new Float32Array(1),k=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),A=s(c);let E=!1,D=[0,0,-1,0,1,0],T=[0,0,0];const R=()=>{if(E)return;E=!0;const Z=r(c,256,9,0);Z.onaudioprocess=({inputBuffer:Q})=>{const ie=[o(Q,b,0),o(Q,b,1),o(Q,b,2),o(Q,b,3),o(Q,b,4),o(Q,b,5)];ie.some((q,te)=>q!==D[te])&&(u.setOrientation(...ie),D=ie);const $=[o(Q,b,6),o(Q,b,7),o(Q,b,8)];$.some((q,te)=>q!==T[te])&&(u.setPosition(...$),T=$)},k.connect(Z)},P=Z=>Q=>{Q!==D[Z]&&(D[Z]=Q,u.setOrientation(...D))},L=Z=>Q=>{Q!==T[Z]&&(T[Z]=Q,u.setPosition(...T))},z=(Z,Q,ie)=>{const $=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Q});$.connect(k,0,Z),$.start(),Object.defineProperty($.offset,"defaultValue",{get(){return Q}});const q=e({context:l},A,$.offset,or,Kr);return a(q,"value",te=>()=>te.call(q),te=>O=>{try{te.call(q,O)}catch(j){if(j.code!==9)throw j}R(),A&&ie(O)}),q.cancelAndHoldAtTime=(te=>A?()=>{throw i()}:(...O)=>{const j=te.apply(q,O);return R(),j})(q.cancelAndHoldAtTime),q.cancelScheduledValues=(te=>A?()=>{throw i()}:(...O)=>{const j=te.apply(q,O);return R(),j})(q.cancelScheduledValues),q.exponentialRampToValueAtTime=(te=>A?()=>{throw i()}:(...O)=>{const j=te.apply(q,O);return R(),j})(q.exponentialRampToValueAtTime),q.linearRampToValueAtTime=(te=>A?()=>{throw i()}:(...O)=>{const j=te.apply(q,O);return R(),j})(q.linearRampToValueAtTime),q.setTargetAtTime=(te=>A?()=>{throw i()}:(...O)=>{const j=te.apply(q,O);return R(),j})(q.setTargetAtTime),q.setValueAtTime=(te=>A?()=>{throw i()}:(...O)=>{const j=te.apply(q,O);return R(),j})(q.setValueAtTime),q.setValueCurveAtTime=(te=>A?()=>{throw i()}:(...O)=>{const j=te.apply(q,O);return R(),j})(q.setValueCurveAtTime),q};return{forwardX:z(0,0,P(0)),forwardY:z(1,0,P(1)),forwardZ:z(2,-1,P(2)),positionX:z(6,0,L(0)),positionY:z(7,0,L(1)),positionZ:z(8,0,L(2)),upX:z(3,0,P(3)),upY:z(4,1,P(4)),upZ:z(5,0,P(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:g,positionY:C,positionZ:v,upX:m,upY:y,upZ:x}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return g},get positionY(){return C},get positionZ(){return v},get upX(){return m},get upY(){return y},get upZ(){return x}}},B0=e=>"context"in e,kf=e=>B0(e[0]),Ul=(e,t,n,r)=>{for(const i of e)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},Xb=(e,t,[n,r],i)=>{Ul(e,[t,n,r],o=>o[0]===t&&o[1]===n,i)},Kb=(e,[t,n,r],i)=>{const o=e.get(t);o===void 0?e.set(t,new Set([[n,r]])):Ul(o,[n,r],s=>s[0]===n,i)},ou=e=>"inputs"in e,O0=(e,t,n,r)=>{if(ou(t)){const i=t.inputs[r];return e.connect(i,n,0),[i,n,0]}return e.connect(t,n,r),[t,n,r]},w2=(e,t,n)=>{for(const r of e)if(r[0]===t&&r[1]===n)return e.delete(r),r;return null},OF=(e,t,n)=>Bp(e,r=>r[0]===t&&r[1]===n),S2=(e,t)=>{if(!Af(e).delete(t))throw new Error("Missing the expected event listener.")},k2=(e,t,n)=>{const r=Yi(e,t),i=Bp(r,o=>o[0]===n);return r.size===0&&e.delete(t),i},F0=(e,t,n,r)=>{ou(t)?e.disconnect(t.inputs[r],n,0):e.disconnect(t,n,r)},Ut=e=>Yi(p2,e),Zd=e=>Yi(m2,e),El=e=>lC.has(e),_h=e=>!Zc.has(e),Jb=(e,t)=>new Promise(n=>{if(t!==null)n(!0);else{const r=e.createScriptProcessor(256,1,1),i=e.createGain(),o=e.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;const a=e.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(e.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(e.destination)},a.start()}}),Fg=(e,t)=>{const n=new Map;for(const r of e)for(const i of r){const o=n.get(i);n.set(i,o===void 0?1:o+1)}n.forEach((r,i)=>t(i,r))},M0=e=>"context"in e,FF=e=>{const t=new Map;e.connect=(n=>(r,i=0,o=0)=>{const s=M0(r)?n(r,i,o):n(r,i),a=t.get(r);return a===void 0?t.set(r,[{input:o,output:i}]):a.every(l=>l.input!==o||l.output!==i)&&a.push({input:o,output:i}),s})(e.connect.bind(e)),e.disconnect=(n=>(r,i,o)=>{if(n.apply(e),r===void 0)t.clear();else if(typeof r=="number")for(const[s,a]of t){const l=a.filter(c=>c.output!==r);l.length===0?t.delete(s):t.set(s,l)}else if(t.has(r))if(i===void 0)t.delete(r);else{const s=t.get(r);if(s!==void 0){const a=s.filter(l=>l.output!==i&&(l.input!==o||o===void 0));a.length===0?t.delete(r):t.set(r,a)}}for(const[s,a]of t)a.forEach(l=>{M0(s)?e.connect(s,l.output,l.input):e.connect(s,l.output)})})(e.disconnect)},MF=(e,t,n,r)=>{const{activeInputs:i,passiveInputs:o}=Sf(t),{outputs:s}=cr(e),a=Af(e),l=c=>{const u=Ut(e),d=Zd(t);if(c){const f=k2(o,e,n);Xb(i,e,f,!1),!r&&!El(e)&&u.connect(d,n)}else{const f=OF(i,e,n);Kb(o,f,!1),!r&&!El(e)&&u.disconnect(d,n)}};return Ul(s,[t,n],c=>c[0]===t&&c[1]===n,!0)?(a.add(l),Ds(e)?Xb(i,e,[n,l],!0):Kb(o,[e,n,l],!0),!0):!1},LF=(e,t,n,r)=>{const{activeInputs:i,passiveInputs:o}=cr(t),s=w2(i[r],e,n);return s===null?[x2(o,e,n,r)[2],!1]:[s[2],!0]},UF=(e,t,n)=>{const{activeInputs:r,passiveInputs:i}=Sf(t),o=w2(r,e,n);return o===null?[k2(i,e,n)[1],!1]:[o[2],!0]},F1=(e,t,n,r,i)=>{const[o,s]=LF(e,n,r,i);if(o!==null&&(S2(e,o),s&&!t&&!El(e)&&F0(Ut(e),Ut(n),r,i)),Ds(n)){const{activeInputs:a}=cr(n);dC(n,a)}},M1=(e,t,n,r)=>{const[i,o]=UF(e,n,r);i!==null&&(S2(e,i),o&&!t&&!El(e)&&Ut(e).disconnect(Zd(n),r))},VF=(e,t)=>{const n=cr(e),r=[];for(const i of n.outputs)kf(i)?F1(e,t,...i):M1(e,t,...i),r.push(i[0]);return n.outputs.clear(),r},GF=(e,t,n)=>{const r=cr(e),i=[];for(const o of r.outputs)o[1]===n&&(kf(o)?F1(e,t,...o):M1(e,t,...o),i.push(o[0]),r.outputs.delete(o));return i},WF=(e,t,n,r,i)=>{const o=cr(e);return Array.from(o.outputs).filter(s=>s[0]===n&&(r===void 0||s[1]===r)&&(i===void 0||s[2]===i)).map(s=>(kf(s)?F1(e,t,...s):M1(e,t,...s),o.outputs.delete(s),s[0]))},jF=(e,t,n,r,i,o,s,a,l,c,u,d,f,h,p,g)=>class extends c{constructor(v,m,y,x){super(y),this._context=v,this._nativeAudioNode=y;const b=u(v);d(b)&&n(Jb,()=>Jb(b,g))!==!0&&FF(y),p2.set(this,y),C2.set(this,new Set),v.state!=="closed"&&m&&$c(this),e(this,x,y)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,m=0,y=0){if(m<0||m>=this._nativeAudioNode.numberOfOutputs)throw i();const x=u(this._context),b=p(x);if(f(v)||h(v))throw o();if(B0(v)){const E=Ut(v);try{const T=O0(this._nativeAudioNode,E,m,y),R=_h(this);(b||R)&&this._nativeAudioNode.disconnect(...T),this.context.state!=="closed"&&!R&&_h(v)&&$c(v)}catch(T){throw T.code===12?o():T}if(t(this,v,m,y,b)){const T=l([this],v);Fg(T,r(b))}return v}const k=Zd(v);if(k.name==="playbackRate"&&k.maxValue===1024)throw s();try{this._nativeAudioNode.connect(k,m),(b||_h(this))&&this._nativeAudioNode.disconnect(k,m)}catch(E){throw E.code===12?o():E}if(MF(this,v,m,b)){const E=l([this],v);Fg(E,r(b))}}disconnect(v,m,y){let x;const b=u(this._context),k=p(b);if(v===void 0)x=VF(this,k);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw i();x=GF(this,k,v)}else{if(m!==void 0&&(m<0||m>=this.numberOfOutputs)||B0(v)&&y!==void 0&&(y<0||y>=v.numberOfInputs))throw i();if(x=WF(this,k,v,m,y),x.length===0)throw o()}for(const A of x){const E=l([this],A);Fg(E,a)}}},zF=(e,t,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,g,C=null,v=null)=>{const m=g.value,y=new QO(m),x=p?r(y):null,b={get defaultValue(){return m},get maxValue(){return C===null?g.maxValue:C},get minValue(){return v===null?g.minValue:v},get value(){return g.value},set value(k){g.value=k,b.setValueAtTime(k,h.context.currentTime)},cancelAndHoldAtTime(k){if(typeof g.cancelAndHoldAtTime=="function")x===null&&y.flush(h.context.currentTime),y.add(i(k)),g.cancelAndHoldAtTime(k);else{const A=Array.from(y).pop();x===null&&y.flush(h.context.currentTime),y.add(i(k));const E=Array.from(y).pop();g.cancelScheduledValues(k),A!==E&&E!==void 0&&(E.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(E.value,E.endTime):E.type==="linearRampToValue"?g.linearRampToValueAtTime(E.value,E.endTime):E.type==="setValue"?g.setValueAtTime(E.value,E.startTime):E.type==="setValueCurve"&&g.setValueCurveAtTime(E.values,E.startTime,E.duration))}return b},cancelScheduledValues(k){return x===null&&y.flush(h.context.currentTime),y.add(o(k)),g.cancelScheduledValues(k),b},exponentialRampToValueAtTime(k,A){if(k===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;const E=h.context.currentTime;return x===null&&y.flush(E),Array.from(y).length===0&&(y.add(c(m,E)),g.setValueAtTime(m,E)),y.add(s(k,A)),g.exponentialRampToValueAtTime(k,A),b},linearRampToValueAtTime(k,A){const E=h.context.currentTime;return x===null&&y.flush(E),Array.from(y).length===0&&(y.add(c(m,E)),g.setValueAtTime(m,E)),y.add(a(k,A)),g.linearRampToValueAtTime(k,A),b},setTargetAtTime(k,A,E){return x===null&&y.flush(h.context.currentTime),y.add(l(k,A,E)),g.setTargetAtTime(k,A,E),b},setValueAtTime(k,A){return x===null&&y.flush(h.context.currentTime),y.add(c(k,A)),g.setValueAtTime(k,A),b},setValueCurveAtTime(k,A,E){const D=k instanceof Float32Array?k:new Float32Array(k);if(d!==null&&d.name==="webkitAudioContext"){const T=A+E,R=h.context.sampleRate,P=Math.ceil(A*R),L=Math.floor(T*R),z=L-P,Z=new Float32Array(z);for(let ie=0;ie<z;ie+=1){const $=(D.length-1)/E*((P+ie)/R-A),q=Math.floor($),te=Math.ceil($);Z[ie]=q===te?D[q]:(1-($-q))*D[q]+(1-(te-$))*D[te]}x===null&&y.flush(h.context.currentTime),y.add(u(Z,A,E)),g.setValueCurveAtTime(Z,A,E);const Q=L/R;Q<T&&f(b,Z[Z.length-1],Q),f(b,D[D.length-1],T)}else x===null&&y.flush(h.context.currentTime),y.add(u(D,A,E)),g.setValueCurveAtTime(D,A,E);return b}};return n.set(b,g),t.set(b,h),e(b,x),b},HF=e=>({replay(t){for(const n of e)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;t.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;t.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=n;t.setTargetAtTime(i,r,o)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;t.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=n;t.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class E2{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,n=null){return this._map.forEach((r,i)=>t.call(n,r,i,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const ZF={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},$F=(e,t,n,r,i,o,s,a,l,c,u,d,f,h)=>class extends t{constructor(g,C,v){var m;const y=a(g),x=l(y),b=u({...ZF,...v});f(b);const k=cC.get(y),A=k==null?void 0:k.get(C),E=x||y.state!=="closed"?y:(m=s(y))!==null&&m!==void 0?m:y,D=i(E,x?null:g.baseLatency,c,C,A,b),T=x?r(C,b,A):null;super(g,!0,D,T);const R=[];D.parameters.forEach((L,z)=>{const Z=n(this,x,L);R.push([z,Z])}),this._nativeAudioWorkletNode=D,this._onprocessorerror=null,this._parameters=new E2(R),x&&e(y,this);const{activeInputs:P}=o(this);d(D,P)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const C=typeof g=="function"?h(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=C;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===C?g:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function L0(e,t,n,r,i){if(typeof e.copyFromChannel=="function")t[n].byteLength===0&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,i);else{const o=e.getChannelData(r);if(t[n].byteLength===0)t[n]=o.slice(i,i+128);else{const s=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(s)}}}const T2=(e,t,n,r,i)=>{typeof e.copyToChannel=="function"?t[n].byteLength!==0&&e.copyToChannel(t[n],r,i):t[n].byteLength!==0&&e.getChannelData(r).set(t[n],i)},U0=(e,t)=>{const n=[];for(let r=0;r<e;r+=1){const i=[],o=typeof t=="number"?t:t[r];for(let s=0;s<o;s+=1)i.push(new Float32Array(128));n.push(i)}return n},XF=(e,t)=>{const n=Yi(uC,e),r=Ut(t);return Yi(n,r)},KF=async(e,t,n,r,i,o,s)=>{const a=t===null?Math.ceil(e.context.length/128)*128:t.length,l=r.channelCount*r.numberOfInputs,c=i.reduce((C,v)=>C+v,0),u=c===0?null:n.createBuffer(c,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=cr(e),f=await XF(n,e),h=U0(r.numberOfInputs,r.channelCount),p=U0(r.numberOfOutputs,i),g=Array.from(e.parameters.keys()).reduce((C,v)=>({...C,[v]:new Float32Array(128)}),{});for(let C=0;C<a;C+=128){if(r.numberOfInputs>0&&t!==null)for(let v=0;v<r.numberOfInputs;v+=1)for(let m=0;m<r.channelCount;m+=1)L0(t,h[v],m,m,C);o.parameterDescriptors!==void 0&&t!==null&&o.parameterDescriptors.forEach(({name:v},m)=>{L0(t,g,v,l+m,C)});for(let v=0;v<r.numberOfInputs;v+=1)for(let m=0;m<i[v];m+=1)p[v][m].byteLength===0&&(p[v][m]=new Float32Array(128));try{const v=h.map((y,x)=>d.activeInputs[x].size===0?[]:y),m=s(C/n.sampleRate,n.sampleRate,()=>f.process(v,p,g));if(u!==null)for(let y=0,x=0;y<r.numberOfOutputs;y+=1){for(let b=0;b<i[y];b+=1)T2(u,p[y],b,x+b,C);x+=i[y]}if(!m)break}catch(v){e.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},JF=(e,t,n,r,i,o,s,a,l,c,u,d,f,h,p,g)=>(C,v,m)=>{const y=new WeakMap;let x=null;const b=async(k,A)=>{let E=u(k),D=null;const T=qn(E,A),R=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(d===null){const P=R.reduce((Q,ie)=>Q+ie,0),L=i(A,{channelCount:Math.max(1,P),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,P)}),z=[];for(let Q=0;Q<k.numberOfOutputs;Q+=1)z.push(r(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:R[Q]}));const Z=s(A,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});Z.connect=t.bind(null,z),Z.disconnect=l.bind(null,z),D=[L,z,Z]}else T||(E=new d(A,C));if(y.set(A,D===null?E:D[2]),D!==null){if(x===null){if(m===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const ie=k.channelCount*k.numberOfInputs,$=m.parameterDescriptors===void 0?0:m.parameterDescriptors.length,q=ie+$;x=KF(k,q===0?null:await(async()=>{const O=new f(q,Math.ceil(k.context.length/128)*128,A.sampleRate),j=[],J=[];for(let me=0;me<v.numberOfInputs;me+=1)j.push(s(O,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),J.push(i(O,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const ee=await Promise.all(Array.from(k.parameters.values()).map(async me=>{const Be=o(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:me.value});return await h(O,me,Be.offset),Be})),se=r(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,ie+$)});for(let me=0;me<v.numberOfInputs;me+=1){j[me].connect(J[me]);for(let Be=0;Be<v.channelCount;Be+=1)J[me].connect(se,Be,me*v.channelCount+Be)}for(const[me,Be]of ee.entries())Be.connect(se,0,ie+me),Be.start(0);return se.connect(O.destination),await Promise.all(j.map(me=>p(k,O,me))),g(O)})(),A,v,R,m,c)}const P=await x,L=n(A,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[z,Z,Q]=D;P!==null&&(L.buffer=P,L.start(0)),L.connect(z);for(let ie=0,$=0;ie<k.numberOfOutputs;ie+=1){const q=Z[ie];for(let te=0;te<R[ie];te+=1)z.connect(q,$+te,te);$+=R[ie]}return Q}if(T)for(const[P,L]of k.parameters.entries())await e(A,L,E.parameters.get(P));else for(const[P,L]of k.parameters.entries())await h(A,L,E.parameters.get(P));return await p(k,A,E),E};return{render(k,A){a(A,k);const E=y.get(A);return E!==void 0?Promise.resolve(E):b(k,A)}}},YF=(e,t,n,r,i,o,s,a,l,c,u,d,f,h,p,g,C,v,m,y)=>class extends p{constructor(b,k){super(b,k),this._nativeContext=b,this._audioWorklet=e===void 0?void 0:{addModule:(A,E)=>e(this,A,E)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new i(this)}createBuffer(b,k,A){return new n({length:k,numberOfChannels:b,sampleRate:A})}createBufferSource(){return new r(this)}createChannelMerger(b=6){return new o(this,{numberOfInputs:b})}createChannelSplitter(b=6){return new s(this,{numberOfOutputs:b})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(b=1){return new u(this,{maxDelayTime:b})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(b,k){return new h(this,{feedback:k,feedforward:b})}createOscillator(){return new g(this)}createPanner(){return new C(this)}createPeriodicWave(b,k,A={disableNormalization:!1}){return new v(this,{...A,imag:k,real:b})}createStereoPanner(){return new m(this)}createWaveShaper(){return new y(this)}decodeAudioData(b,k,A){return c(this._nativeContext,b).then(E=>(typeof k=="function"&&k(E),E),E=>{throw typeof A=="function"&&A(E),E})}},qF={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},QF=(e,t,n,r,i,o,s,a)=>class extends e{constructor(c,u){const d=o(c),f={...qF,...u},h=i(d,f),p=s(d),g=p?n():null;super(c,!1,h,g),this._Q=t(this,p,h.Q,or,Kr),this._detune=t(this,p,h.detune,1200*Math.log2(or),-1200*Math.log2(or)),this._frequency=t(this,p,h.frequency,c.sampleRate/2,0),this._gain=t(this,p,h.gain,40*Math.log10(or),Kr),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,d)}catch(f){throw f.code===11?r():f}if(c.length!==u.length||u.length!==d.length)throw r()}},eM=(e,t,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=t(l,d)}return o.set(l,c),u?(await e(l,a.Q,c.Q),await e(l,a.detune,c.detune),await e(l,a.frequency,c.frequency),await e(l,a.gain,c.gain)):(await r(l,a.Q,c.Q),await r(l,a.detune,c.detune),await r(l,a.frequency,c.frequency),await r(l,a.gain,c.gain)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},tM=(e,t)=>(n,r)=>{const i=t.get(n);if(i!==void 0)return i;const o=e.get(n);if(o!==void 0)return o;try{const s=r();return s instanceof Promise?(e.set(n,s),s.catch(()=>!1).then(a=>(e.delete(n),t.set(n,a),a))):(t.set(n,s),s)}catch{return t.set(n,!1),!1}},nM={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},rM=(e,t,n,r,i)=>class extends e{constructor(s,a){const l=r(s),c={...nM,...a},u=n(l,c),d=i(l)?t():null;super(s,!1,u,d)}},iM=(e,t,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=t(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=e(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},oM={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},sM=(e,t,n,r,i,o)=>class extends e{constructor(a,l){const c=r(a),u=o({...oM,...l}),d=n(c,u),f=i(c)?t():null;super(a,!1,d,f)}},aM=(e,t,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=t(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=e(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},lM=e=>(t,n,r)=>e(n,t,r),cM=e=>(t,n,r=0,i=0)=>{const o=t[r];if(o===void 0)throw e();return M0(n)?o.connect(n,0,i):o.connect(n,0)},uM=e=>(t,n)=>{const r=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},dM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},fM=(e,t,n,r,i,o,s)=>class extends e{constructor(l,c){const u=i(l),d={...dM,...c},f=r(u,d),h=o(u),p=h?n():null;super(l,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=t(this,h,f.offset,or,Kr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){$c(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),Ds(this)&&wf(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},hM=(e,t,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=qn(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=t(u,h),s!==null&&d.start(s),a!==null&&d.stop(a)}return o.set(u,d),f?await e(u,c.offset,d.offset):await r(u,c.offset,d.offset),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},pM=e=>t=>(e[0]=t,e[0]),gM={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},mM=(e,t,n,r,i,o)=>class extends e{constructor(a,l){const c=r(a),u={...gM,...l},d=n(c,u),h=i(c)?t():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},vM=(e,t,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=t(o);if(!qn(a,s)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=e(s,c)}return r.set(s,a),ou(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},CM=()=>new DOMException("","DataCloneError"),Yb=e=>{const{port1:t,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,t.close(),n.close(),r()};n.onmessage=()=>i();try{t.postMessage(e,[e])}catch{}finally{i()}})},yM=(e,t,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=s(d)?d:o(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return t(l,()=>l(h))?h.decodeAudioData(f).then(p=>(Yb(f).catch(()=>{}),t(a,()=>a(p))||u(p),e.add(p),p)):new Promise((p,g)=>{const C=async()=>{try{await Yb(f)}catch{}},v=m=>{g(m),C()};try{h.decodeAudioData(f,m=>{typeof m.copyFromChannel!="function"&&(c(m),b2(m)),e.add(m),C().then(()=>p(m))},m=>{v(m===null?r():m)})}catch(m){v(m)}})},xM=(e,t,n,r,i,o,s,a)=>(l,c)=>{const u=t.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(l.context),f=a(d);if(u===c){if(t.delete(l),!f&&s(l)){const h=r(l),{outputs:p}=n(l);for(const g of p)if(kf(g)){const C=r(g[0]);e(h,C,g[1],g[2])}else{const C=i(g[0]);h.connect(C,g[1])}}}else t.set(l,u-c)},IM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},bM=(e,t,n,r,i,o,s)=>class extends e{constructor(l,c){const u=i(l),d={...IM,...c},f=r(u,d),h=o(u),p=h?n(d.maxDelayTime):null;super(l,!1,f,p),this._delayTime=t(this,h,f.delayTime),s(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},AM=(e,t,n,r,i)=>o=>{const s=new WeakMap,a=async(l,c)=>{let u=n(l);const d=qn(u,c);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=t(c,f)}return s.set(c,u),d?await e(c,l.delayTime,u.delayTime):await r(c,l.delayTime,u.delayTime),await i(l,c,u),u};return{render(l,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):a(l,c)}}},wM=e=>(t,n,r,i)=>e(t[i],o=>o[0]===n&&o[1]===r),SM=e=>(t,n)=>{e(t).delete(n)},kM=e=>"delayTime"in e,EM=(e,t,n)=>function r(i,o){const s=B0(o)?o:n(e,o);if(kM(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=t(s);return Array.from(a).map(l=>r([...i,s],l[0])).reduce((l,c)=>l.concat(c),[])},nh=(e,t,n)=>{const r=t[n];if(r===void 0)throw e();return r},TM=e=>(t,n=void 0,r=void 0,i=0)=>n===void 0?t.forEach(o=>o.disconnect()):typeof n=="number"?nh(e,t,n).disconnect():M0(n)?r===void 0?t.forEach(o=>o.disconnect(n)):i===void 0?nh(e,t,r).disconnect(n,0):nh(e,t,r).disconnect(n,0,i):r===void 0?t.forEach(o=>o.disconnect(n)):nh(e,t,r).disconnect(n,0),RM={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},_M=(e,t,n,r,i,o,s,a)=>class extends e{constructor(c,u){const d=o(c),f={...RM,...u},h=r(d,f),p=s(d),g=p?n():null;super(c,!1,h,g),this._attack=t(this,p,h.attack),this._knee=t(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=t(this,p,h.ratio),this._release=t(this,p,h.release),this._threshold=t(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},DM=(e,t,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=t(l,d)}return o.set(l,c),u?(await e(l,a.attack,c.attack),await e(l,a.knee,c.knee),await e(l,a.ratio,c.ratio),await e(l,a.release,c.release),await e(l,a.threshold,c.threshold)):(await r(l,a.attack,c.attack),await r(l,a.knee,c.knee),await r(l,a.ratio,c.ratio),await r(l,a.release,c.release),await r(l,a.threshold,c.threshold)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},PM=()=>new DOMException("","EncodingError"),NM=e=>t=>new Promise((n,r)=>{if(e===null){r(new SyntaxError);return}const i=e.document.head;if(i===null)r(new SyntaxError);else{const o=e.document.createElement("script"),s=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(s),l=e.onerror,c=()=>{e.onerror=l,URL.revokeObjectURL(a)};e.onerror=(u,d,f,h,p)=>{if(d===a||d===e.location.href&&f===1&&h===1)return c(),r(p),!1;if(l!==null)return l(u,d,f,h,p)},o.onerror=()=>{c(),r(new SyntaxError)},o.onload=()=>{c(),n()},o.src=a,o.type="module",i.appendChild(o)}}),BM=e=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=e(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,i)}},OM=e=>(t,n,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get(){return Math.round(t*n)}},currentTime:{configurable:!0,get(){return t}}});try{return r()}finally{e!==null&&(delete e.currentFrame,delete e.currentTime)}},FM=e=>async t=>{try{const n=await fetch(t);if(n.ok)return[await n.text(),n.url]}catch{}throw e()},MM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},LM=(e,t,n,r,i,o)=>class extends e{constructor(a,l){const c=i(a),u={...MM,...l},d=r(c,u),f=o(c),h=f?n():null;super(a,!1,d,h),this._gain=t(this,f,d.gain,or,Kr)}get gain(){return this._gain}},UM=(e,t,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=t(l,d)}return o.set(l,c),u?await e(l,a.gain,c.gain):await r(l,a.gain,c.gain),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},VM=(e,t)=>n=>t(e,n),GM=e=>t=>{const n=e(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},WM=e=>t=>{var n;return(n=e.get(t))!==null&&n!==void 0?n:0},jM=e=>t=>{const n=e(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},zM=e=>t=>e.get(t),Mn=()=>new DOMException("","InvalidStateError"),HM=e=>t=>{const n=e.get(t);if(n===void 0)throw Mn();return n},ZM=(e,t)=>n=>{let r=e.get(n);if(r!==void 0)return r;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,44100),e.set(n,r),r},$M=e=>t=>{const n=e.get(t);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},Op=()=>new DOMException("","InvalidAccessError"),XM=e=>{e.getFrequencyResponse=(t=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw Op();return t.call(e,n,r,i)})(e.getFrequencyResponse)},KM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},JM=(e,t,n,r,i,o)=>class extends e{constructor(a,l){const c=r(a),u=i(c),d={...KM,...l},f=t(c,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),XM(f),this._nativeIIRFilterNode=f,o(this,1)}getFrequencyResponse(a,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,c)}},R2=(e,t,n,r,i,o,s,a,l,c,u)=>{const d=c.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*c[h];for(let g=1;g<i;g+=1){const C=f-g&l-1;p+=n[g]*o[C],p-=e[g]*s[C]}for(let g=i;g<r;g+=1)p+=n[g]*o[f-g&l-1];for(let g=i;g<t;g+=1)p-=e[g]*s[f-g&l-1];o[f]=c[h],s[f]=p,f=f+1&l-1,u[h]=p}return f},YM=(e,t,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,l=Math.min(s,a);if(i[0]!==1){for(let p=0;p<s;p+=1)o[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const c=32,u=new Float32Array(c),d=new Float32Array(c),f=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),h=e.numberOfChannels;for(let p=0;p<h;p+=1){const g=e.getChannelData(p),C=f.getChannelData(p);u.fill(0),d.fill(0),R2(i,s,o,a,l,u,d,0,c,g,C)}return f},qM=(e,t,n,r,i)=>(o,s)=>{const a=new WeakMap;let l=null;const c=async(u,d)=>{let f=null,h=t(u);const p=qn(h,d);if(d.createIIRFilter===void 0?f=e(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(s,o)),a.set(d,f===null?h:f),f!==null){if(l===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);l=(async()=>{await r(u,C,C.destination);const v=await i(C);return YM(v,d,o,s)})()}const g=await l;return f.buffer=g,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},QM=(e,t,n,r,i,o)=>s=>(a,l)=>{const c=e.get(a);if(c===void 0){if(!s&&o(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(kf(f)){const h=r(f[0]);t(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}e.set(a,l)}else e.set(a,c+l)},eL=e=>t=>e!==null&&t instanceof e,tL=e=>t=>e!==null&&typeof e.AudioNode=="function"&&t instanceof e.AudioNode,nL=e=>t=>e!==null&&typeof e.AudioParam=="function"&&t instanceof e.AudioParam,rL=(e,t)=>n=>e(n)||t(n),iL=e=>t=>e!==null&&t instanceof e,oL=e=>e!==null&&e.isSecureContext,sL=(e,t,n,r)=>class extends e{constructor(o,s){const a=n(o),l=t(a,s);if(r(a))throw TypeError();super(o,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},aL={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},lL=(e,t,n,r)=>class extends e{constructor(o,s){const a=n(o);if(r(a))throw new TypeError;const l={...aL,...s},c=t(a,l);super(o,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},cL=(e,t,n,r)=>class extends e{constructor(o,s){const a=n(o),l=t(a,s);if(r(a))throw new TypeError;super(o,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},uL=(e,t,n)=>class extends e{constructor(i,o){const s=n(i),a=t(s,o);super(i,!0,a,null)}},dL=(e,t,n,r,i,o)=>class extends n{constructor(a,l){super(a),this._nativeContext=a,v2.set(this,a),r(a)&&i.set(a,new Set),this._destination=new e(this,l),this._listener=t(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},pC=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},fL=(e,t)=>(n,r,i)=>{const o=new Set;return n.connect=(s=>(a,l=0,c=0)=>{const u=o.size===0;if(t(a))return s.call(n,a,l,c),e(o,[a,l,c],d=>d[0]===a&&d[1]===l&&d[2]===c,!0),u&&r(),a;s.call(n,a,l),e(o,[a,l],d=>d[0]===a&&d[1]===l,!0),u&&r()})(n.connect),n.disconnect=(s=>(a,l,c)=>{const u=o.size>0;if(a===void 0)s.apply(n),o.clear();else if(typeof a=="number"){s.call(n,a);for(const f of o)f[1]===a&&o.delete(f)}else{t(a)?s.call(n,a,l,c):s.call(n,a,l);for(const f of o)f[0]===a&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&o.delete(f)}const d=o.size===0;u&&d&&i()})(n.disconnect),n},Zt=(e,t,n)=>{const r=t[n];r!==void 0&&r!==e[n]&&(e[n]=r)},bn=(e,t)=>{Zt(e,t,"channelCount"),Zt(e,t,"channelCountMode"),Zt(e,t,"channelInterpretation")},qb=e=>typeof e.getFloatTimeDomainData=="function",hL=e=>{e.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);e.getByteTimeDomainData(n);const r=Math.max(n.length,e.fftSize);for(let i=0;i<r;i+=1)t[i]=(n[i]-128)*.0078125;return t}},pL=(e,t)=>(n,r)=>{const i=n.createAnalyser();if(bn(i,r),!(r.maxDecibels>r.minDecibels))throw t();return Zt(i,r,"fftSize"),Zt(i,r,"maxDecibels"),Zt(i,r,"minDecibels"),Zt(i,r,"smoothingTimeConstant"),e(qb,()=>qb(i))||hL(i),i},gL=e=>e===null?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null,en=(e,t,n)=>{const r=t[n];r!==void 0&&r!==e[n].value&&(e[n].value=r)},mL=e=>{e.start=(t=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw Mn();t.call(e,r,i,o),n=!0}})(e.start)},L1=e=>{e.start=(t=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,i)})(e.start)},U1=e=>{e.stop=(t=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})(e.stop)},vL=(e,t,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=d.createBufferSource();return bn(h,f),en(h,f,"playbackRate"),Zt(h,f,"buffer"),Zt(h,f,"loop"),Zt(h,f,"loopEnd"),Zt(h,f,"loopStart"),t(n,()=>n(d))||mL(h),t(r,()=>r(d))||l(h),t(i,()=>i(d))||c(h,d),t(o,()=>o(d))||L1(h),t(s,()=>s(d))||u(h,d),t(a,()=>a(d))||U1(h),e(d,h),h},CL=e=>e===null?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null,yL=(e,t)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=e(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return t(s,"channelCount",a=>()=>a.call(s),a=>l=>{a.call(s,l);try{o.channelCount=l}catch(c){if(l>o.maxChannelCount)throw c}}),t(s,"channelCountMode",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelCountMode=l}),t(s,"channelInterpretation",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelInterpretation=l}),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s},xL=e=>e===null?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null,IL=e=>{const{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}},bL=(e,t,n,r,i)=>(o,s,a,l,c,u)=>{if(a!==null)try{const d=new a(o,l,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const C=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(C!==null){const v=f.get(g[1]);v!==void 0?g[1]=v:(g[1]=m=>{m.type==="error"?(Object.defineProperties(m,{type:{value:"processorerror"}}),C(m)):C(new ErrorEvent(g[0],{...m}))},f.set(C,g[1]))}}return p.call(d,"error",g[1],g[2]),p.call(d,...g)})(d.addEventListener),d.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const C=f.get(g[1]);C!==void 0&&(f.delete(g[1]),g[1]=C)}return p.call(d,"error",g[1],g[2]),p.call(d,g[0],g[1],g[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(o.destination),i(d,()=>p.disconnect(),()=>p.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(c===void 0)throw r();return IL(u),t(o,s,c,u)},_2=(e,t)=>e===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),AL=e=>new Promise((t,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),t(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),n(o)},i.postMessage(e)}),wL=async(e,t)=>{const n=await AL(t);return new e(n)},SL=(e,t,n,r)=>{let i=uC.get(e);i===void 0&&(i=new WeakMap,uC.set(e,i));const o=wL(n,r);return i.set(t,o),o},kL=(e,t,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,g,C)=>{if(C.numberOfInputs===0&&C.numberOfOutputs===0)throw l();const v=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(v.some(he=>he<1))throw l();if(v.length!==C.numberOfOutputs)throw t();if(C.channelCountMode!=="explicit")throw l();const m=C.channelCount*C.numberOfInputs,y=v.reduce((he,Ce)=>he+Ce,0),x=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(m+x>6||y>6)throw l();const b=new MessageChannel,k=[],A=[];for(let he=0;he<C.numberOfInputs;he+=1)k.push(s(h,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),A.push(i(h,{channelCount:C.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:C.channelCount}));const E=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:he,maxValue:Ce,minValue:Ve,name:Ue}of g.parameterDescriptors){const Pe=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C.parameterData[Ue]!==void 0?C.parameterData[Ue]:he===void 0?0:he});Object.defineProperties(Pe.offset,{defaultValue:{get:()=>he===void 0?0:he},maxValue:{get:()=>Ce===void 0?or:Ce},minValue:{get:()=>Ve===void 0?Kr:Ve}}),E.push(Pe)}const D=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,m+x)}),T=_2(p,h.sampleRate),R=a(h,T,m+x,Math.max(1,y)),P=i(h,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),L=[];for(let he=0;he<C.numberOfOutputs;he+=1)L.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[he]}));for(let he=0;he<C.numberOfInputs;he+=1){k[he].connect(A[he]);for(let Ce=0;Ce<C.channelCount;Ce+=1)A[he].connect(D,Ce,he*C.channelCount+Ce)}const z=new E2(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:he},Ce)=>{const Ve=E[Ce];return Ve.connect(D,0,m+Ce),Ve.start(0),[he,Ve.offset]}));D.connect(R);let Z=C.channelInterpretation,Q=null;const ie=C.numberOfOutputs===0?[R]:L,$={get bufferSize(){return T},get channelCount(){return C.channelCount},set channelCount(he){throw n()},get channelCountMode(){return C.channelCountMode},set channelCountMode(he){throw n()},get channelInterpretation(){return Z},set channelInterpretation(he){for(const Ce of k)Ce.channelInterpretation=he;Z=he},get context(){return R.context},get inputs(){return k},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get onprocessorerror(){return Q},set onprocessorerror(he){typeof Q=="function"&&$.removeEventListener("processorerror",Q),Q=typeof he=="function"?he:null,typeof Q=="function"&&$.addEventListener("processorerror",Q)},get parameters(){return z},get port(){return b.port2},addEventListener(...he){return R.addEventListener(he[0],he[1],he[2])},connect:e.bind(null,ie),disconnect:c.bind(null,ie),dispatchEvent(...he){return R.dispatchEvent(he[0])},removeEventListener(...he){return R.removeEventListener(he[0],he[1],he[2])}},q=new Map;b.port1.addEventListener=(he=>(...Ce)=>{if(Ce[0]==="message"){const Ve=typeof Ce[1]=="function"?Ce[1]:typeof Ce[1]=="object"&&Ce[1]!==null&&typeof Ce[1].handleEvent=="function"?Ce[1].handleEvent:null;if(Ve!==null){const Ue=q.get(Ce[1]);Ue!==void 0?Ce[1]=Ue:(Ce[1]=Pe=>{u(h.currentTime,h.sampleRate,()=>Ve(Pe))},q.set(Ve,Ce[1]))}}return he.call(b.port1,Ce[0],Ce[1],Ce[2])})(b.port1.addEventListener),b.port1.removeEventListener=(he=>(...Ce)=>{if(Ce[0]==="message"){const Ve=q.get(Ce[1]);Ve!==void 0&&(q.delete(Ce[1]),Ce[1]=Ve)}return he.call(b.port1,Ce[0],Ce[1],Ce[2])})(b.port1.removeEventListener);let te=null;Object.defineProperty(b.port1,"onmessage",{get:()=>te,set:he=>{typeof te=="function"&&b.port1.removeEventListener("message",te),te=typeof he=="function"?he:null,typeof te=="function"&&(b.port1.addEventListener("message",te),b.port1.start())}}),g.prototype.port=b.port1;let O=null;SL(h,$,g,C).then(he=>O=he);const J=U0(C.numberOfInputs,C.channelCount),ee=U0(C.numberOfOutputs,v),se=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((he,{name:Ce})=>({...he,[Ce]:new Float32Array(128)}),{});let me=!0;const Be=()=>{C.numberOfOutputs>0&&R.disconnect(P);for(let he=0,Ce=0;he<C.numberOfOutputs;he+=1){const Ve=L[he];for(let Ue=0;Ue<v[he];Ue+=1)P.disconnect(Ve,Ce+Ue,Ue);Ce+=v[he]}},ae=new Map;R.onaudioprocess=({inputBuffer:he,outputBuffer:Ce})=>{if(O!==null){const Ve=d($);for(let Ue=0;Ue<T;Ue+=128){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<C.channelCount;$e+=1)L0(he,J[Pe],$e,$e,Ue);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:Pe},$e)=>{L0(he,se,Pe,m+$e,Ue)});for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<v[Pe];$e+=1)ee[Pe][$e].byteLength===0&&(ee[Pe][$e]=new Float32Array(128));try{const Pe=J.map((at,Qe)=>{if(Ve[Qe].size>0)return ae.set(Qe,T/128),at;const jt=ae.get(Qe);return jt===void 0?[]:(at.every(wt=>wt.every(an=>an===0))&&(jt===1?ae.delete(Qe):ae.set(Qe,jt-1)),at)});me=u(h.currentTime+Ue/h.sampleRate,h.sampleRate,()=>O.process(Pe,ee,se));for(let at=0,Qe=0;at<C.numberOfOutputs;at+=1){for(let Wt=0;Wt<v[at];Wt+=1)T2(Ce,ee[at],Wt,Qe+Wt,Ue);Qe+=v[at]}}catch(Pe){me=!1,$.dispatchEvent(new ErrorEvent("processorerror",{colno:Pe.colno,filename:Pe.filename,lineno:Pe.lineno,message:Pe.message}))}if(!me){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1){k[Pe].disconnect(A[Pe]);for(let $e=0;$e<C.channelCount;$e+=1)A[Ue].disconnect(D,$e,Pe*C.channelCount+$e)}if(g.parameterDescriptors!==void 0){const Pe=g.parameterDescriptors.length;for(let $e=0;$e<Pe;$e+=1){const at=E[$e];at.disconnect(D,0,m+$e),at.stop()}}D.disconnect(R),R.onaudioprocess=null,Dt?Be():ze();break}}}};let Dt=!1;const Gt=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),fn=()=>R.connect(Gt).connect(h.destination),ze=()=>{R.disconnect(Gt),Gt.disconnect()},ot=()=>{if(me){ze(),C.numberOfOutputs>0&&R.connect(P);for(let he=0,Ce=0;he<C.numberOfOutputs;he+=1){const Ve=L[he];for(let Ue=0;Ue<v[he];Ue+=1)P.connect(Ve,Ce+Ue,Ue);Ce+=v[he]}}Dt=!0},st=()=>{me&&(fn(),Be()),Dt=!1};return fn(),f($,ot,st)},D2=(e,t)=>{const n=e.createBiquadFilter();return bn(n,t),en(n,t,"Q"),en(n,t,"detune"),en(n,t,"frequency"),en(n,t,"gain"),Zt(n,t,"type"),n},EL=(e,t)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return e!==null&&e.name==="webkitAudioContext"&&t(n,i),bn(i,r),i},TL=e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:n=>{if(n!==t)throw Mn()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Mn()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Mn()}})},Ef=(e,t)=>{const n=e.createChannelSplitter(t.numberOfOutputs);return bn(n,t),TL(n),n},RL=(e,t,n,r,i)=>(o,s)=>{if(o.createConstantSource===void 0)return n(o,s);const a=o.createConstantSource();return bn(a,s),en(a,s,"offset"),t(r,()=>r(o))||L1(a),t(i,()=>i(o))||U1(a),e(o,a),a},su=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),_L=(e,t,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),l=t(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,l.buffer=a,l.loop=!0;const d={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},f=()=>l.connect(c),h=()=>l.disconnect(c);return e(i,l),r(su(d,c),f,h)},DL=(e,t)=>(n,r)=>{const i=n.createConvolver();if(bn(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Zt(i,r,"buffer"),r.channelCount>2||(t(i,"channelCount",o=>()=>o.call(i),o=>s=>{if(s>2)throw e();return o.call(i,s)}),r.channelCountMode==="max"))throw e();return t(i,"channelCountMode",o=>()=>o.call(i),o=>s=>{if(s==="max")throw e();return o.call(i,s)}),i},P2=(e,t)=>{const n=e.createDelay(t.maxDelayTime);return bn(n,t),en(n,t,"delayTime"),n},PL=e=>(t,n)=>{const r=t.createDynamicsCompressor();if(bn(r,n),n.channelCount>2||n.channelCountMode==="max")throw e();return en(r,n,"attack"),en(r,n,"knee"),en(r,n,"ratio"),en(r,n,"release"),en(r,n,"threshold"),r},Nr=(e,t)=>{const n=e.createGain();return bn(n,t),en(n,t,"gain"),n},NL=e=>(t,n,r)=>{if(t.createIIRFilter===void 0)return e(t,n,r);const i=t.createIIRFilter(r.feedforward,r.feedback);return bn(i,r),i};function BL(e,t){const n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function OL(e,t){return[e[0]*t[0]-e[1]*t[1],e[0]*t[1]+e[1]*t[0]]}function Qb(e,t){let n=[0,0];for(let r=e.length-1;r>=0;r-=1)n=OL(n,t),n[0]+=e[r];return n}const FL=(e,t,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:u})=>{const d=_2(o,i.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,g=h.length,C=Math.min(p,g);if(p===0||p>20)throw r();if(f[0]===0)throw t();if(g===0||g>20)throw r();if(h[0]===0)throw t();if(f[0]!==1){for(let E=0;E<g;E+=1)h[E]/=f[0];for(let E=1;E<p;E+=1)f[E]/=f[0]}const v=n(i,d,s,s);v.channelCount=s,v.channelCountMode=a,v.channelInterpretation=l;const m=32,y=[],x=[],b=[];for(let E=0;E<s;E+=1){y.push(0);const D=new Float32Array(m),T=new Float32Array(m);D.fill(0),T.fill(0),x.push(D),b.push(T)}v.onaudioprocess=E=>{const D=E.inputBuffer,T=E.outputBuffer,R=D.numberOfChannels;for(let P=0;P<R;P+=1){const L=D.getChannelData(P),z=T.getChannelData(P);y[P]=R2(f,p,h,g,C,x[P],b[P],y[P],m,L,z)}};const k=i.sampleRate/2;return su({get bufferSize(){return d},get channelCount(){return v.channelCount},set channelCount(E){v.channelCount=E},get channelCountMode(){return v.channelCountMode},set channelCountMode(E){v.channelCountMode=E},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(E){v.channelInterpretation=E},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...E){return v.addEventListener(E[0],E[1],E[2])},dispatchEvent(...E){return v.dispatchEvent(E[0])},getFrequencyResponse(E,D,T){if(E.length!==D.length||D.length!==T.length)throw e();const R=E.length;for(let P=0;P<R;P+=1){const L=-Math.PI*(E[P]/k),z=[Math.cos(L),Math.sin(L)],Z=Qb(h,z),Q=Qb(f,z),ie=BL(Z,Q);D[P]=Math.sqrt(ie[0]*ie[0]+ie[1]*ie[1]),T[P]=Math.atan2(ie[1],ie[0])}},removeEventListener(...E){return v.removeEventListener(E[0],E[1],E[2])}},v)},ML=(e,t)=>e.createMediaElementSource(t.mediaElement),LL=(e,t)=>{const n=e.createMediaStreamDestination();return bn(n,t),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},UL=(e,{mediaStream:t})=>{const n=t.getAudioTracks();n.sort((o,s)=>o.id<s.id?-1:o.id>s.id?1:0);const r=n.slice(0,1),i=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:t}),i},VL=(e,t)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if(r.kind!=="audio")throw e();if(t(n))throw new TypeError;return o},GL=e=>e===null?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null,WL=(e,t,n,r,i,o)=>(s,a)=>{const l=s.createOscillator();return bn(l,a),en(l,a,"detune"),en(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):Zt(l,a,"type"),t(n,()=>n(s))||L1(l),t(r,()=>r(s))||o(l,s),t(i,()=>i(s))||U1(l),e(s,l),l},jL=e=>(t,n)=>{const r=t.createPanner();return r.orientationX===void 0?e(t,n):(bn(r,n),en(r,n,"orientationX"),en(r,n,"orientationY"),en(r,n,"orientationZ"),en(r,n,"positionX"),en(r,n,"positionY"),en(r,n,"positionZ"),Zt(r,n,"coneInnerAngle"),Zt(r,n,"coneOuterAngle"),Zt(r,n,"coneOuterGain"),Zt(r,n,"distanceModel"),Zt(r,n,"maxDistance"),Zt(r,n,"panningModel"),Zt(r,n,"refDistance"),Zt(r,n,"rolloffFactor"),r)},zL=(e,t,n,r,i,o,s,a,l,c)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:g,orientationX:C,orientationY:v,orientationZ:m,panningModel:y,positionX:x,positionY:b,positionZ:k,refDistance:A,rolloffFactor:E,...D})=>{const T=u.createPanner();if(D.channelCount>2||D.channelCountMode==="max")throw s();bn(T,D);const R={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},P=n(u,{...R,channelInterpretation:"speakers",numberOfInputs:6}),L=r(u,{...D,gain:1}),z=r(u,{...R,gain:1}),Z=r(u,{...R,gain:0}),Q=r(u,{...R,gain:0}),ie=r(u,{...R,gain:0}),$=r(u,{...R,gain:0}),q=r(u,{...R,gain:0}),te=i(u,256,6,1),O=o(u,{...R,curve:new Float32Array([1,1]),oversample:"none"});let j=[C,v,m],J=[x,b,k];const ee=new Float32Array(1);te.onaudioprocess=({inputBuffer:ae})=>{const Dt=[l(ae,ee,0),l(ae,ee,1),l(ae,ee,2)];Dt.some((fn,ze)=>fn!==j[ze])&&(T.setOrientation(...Dt),j=Dt);const Gt=[l(ae,ee,3),l(ae,ee,4),l(ae,ee,5)];Gt.some((fn,ze)=>fn!==J[ze])&&(T.setPosition(...Gt),J=Gt)},Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ie.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0});const se={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(ae){if(ae>2)throw s();L.channelCount=ae,T.channelCount=ae},get channelCountMode(){return T.channelCountMode},set channelCountMode(ae){if(ae==="max")throw s();L.channelCountMode=ae,T.channelCountMode=ae},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(ae){L.channelInterpretation=ae,T.channelInterpretation=ae},get coneInnerAngle(){return T.coneInnerAngle},set coneInnerAngle(ae){T.coneInnerAngle=ae},get coneOuterAngle(){return T.coneOuterAngle},set coneOuterAngle(ae){T.coneOuterAngle=ae},get coneOuterGain(){return T.coneOuterGain},set coneOuterGain(ae){if(ae<0||ae>1)throw t();T.coneOuterGain=ae},get context(){return T.context},get distanceModel(){return T.distanceModel},set distanceModel(ae){T.distanceModel=ae},get inputs(){return[L]},get maxDistance(){return T.maxDistance},set maxDistance(ae){if(ae<0)throw new RangeError;T.maxDistance=ae},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get orientationX(){return z.gain},get orientationY(){return Z.gain},get orientationZ(){return Q.gain},get panningModel(){return T.panningModel},set panningModel(ae){T.panningModel=ae},get positionX(){return ie.gain},get positionY(){return $.gain},get positionZ(){return q.gain},get refDistance(){return T.refDistance},set refDistance(ae){if(ae<0)throw new RangeError;T.refDistance=ae},get rolloffFactor(){return T.rolloffFactor},set rolloffFactor(ae){if(ae<0)throw new RangeError;T.rolloffFactor=ae},addEventListener(...ae){return L.addEventListener(ae[0],ae[1],ae[2])},dispatchEvent(...ae){return L.dispatchEvent(ae[0])},removeEventListener(...ae){return L.removeEventListener(ae[0],ae[1],ae[2])}};d!==se.coneInnerAngle&&(se.coneInnerAngle=d),f!==se.coneOuterAngle&&(se.coneOuterAngle=f),h!==se.coneOuterGain&&(se.coneOuterGain=h),p!==se.distanceModel&&(se.distanceModel=p),g!==se.maxDistance&&(se.maxDistance=g),C!==se.orientationX.value&&(se.orientationX.value=C),v!==se.orientationY.value&&(se.orientationY.value=v),m!==se.orientationZ.value&&(se.orientationZ.value=m),y!==se.panningModel&&(se.panningModel=y),x!==se.positionX.value&&(se.positionX.value=x),b!==se.positionY.value&&(se.positionY.value=b),k!==se.positionZ.value&&(se.positionZ.value=k),A!==se.refDistance&&(se.refDistance=A),E!==se.rolloffFactor&&(se.rolloffFactor=E),(j[0]!==1||j[1]!==0||j[2]!==0)&&T.setOrientation(...j),(J[0]!==0||J[1]!==0||J[2]!==0)&&T.setPosition(...J);const me=()=>{L.connect(T),e(L,O,0,0),O.connect(z).connect(P,0,0),O.connect(Z).connect(P,0,1),O.connect(Q).connect(P,0,2),O.connect(ie).connect(P,0,3),O.connect($).connect(P,0,4),O.connect(q).connect(P,0,5),P.connect(te).connect(u.destination)},Be=()=>{L.disconnect(T),a(L,O,0,0),O.disconnect(z),z.disconnect(P),O.disconnect(Z),Z.disconnect(P),O.disconnect(Q),Q.disconnect(P),O.disconnect(ie),ie.disconnect(P),O.disconnect($),$.disconnect(P),O.disconnect(q),q.disconnect(P),P.disconnect(te),te.disconnect(u.destination)};return c(su(se,T),me,Be)},HL=e=>(t,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=t.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw e();return a},Tf=(e,t,n,r)=>e.createScriptProcessor(t,n,r),ZL=(e,t)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw t();if(n.createStereoPanner===void 0)return e(n,r);const o=n.createStereoPanner();return bn(o,r),en(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:s=>{if(s!==i)throw t()}}),o},$L=(e,t,n,r,i,o)=>{const a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},d=(p,g,C,v)=>{const m=new Float32Array(16385),y=new Float32Array(16385);for(let D=0;D<16385;D+=1){const T=D/16384*l;m[D]=Math.cos(T),y[D]=Math.sin(T)}const x=n(p,{...c,gain:0}),b=r(p,{...u,curve:m}),k=r(p,{...u,curve:a}),A=n(p,{...c,gain:0}),E=r(p,{...u,curve:y});return{connectGraph(){g.connect(x),g.connect(k.inputs===void 0?k:k.inputs[0]),g.connect(A),k.connect(C),C.connect(b.inputs===void 0?b:b.inputs[0]),C.connect(E.inputs===void 0?E:E.inputs[0]),b.connect(x.gain),E.connect(A.gain),x.connect(v,0,0),A.connect(v,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(k.inputs===void 0?k:k.inputs[0]),g.disconnect(A),k.disconnect(C),C.disconnect(b.inputs===void 0?b:b.inputs[0]),C.disconnect(E.inputs===void 0?E:E.inputs[0]),b.disconnect(x.gain),E.disconnect(A.gain),x.disconnect(v,0,0),A.disconnect(v,0,1)}}},f=(p,g,C,v)=>{const m=new Float32Array(16385),y=new Float32Array(16385),x=new Float32Array(16385),b=new Float32Array(16385),k=Math.floor(16385/2);for(let ie=0;ie<16385;ie+=1)if(ie>k){const $=(ie-k)/(16384-k)*l;m[ie]=Math.cos($),y[ie]=Math.sin($),x[ie]=0,b[ie]=1}else{const $=ie/(16384-k)*l;m[ie]=1,y[ie]=0,x[ie]=Math.cos($),b[ie]=Math.sin($)}const A=t(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),E=n(p,{...c,gain:0}),D=r(p,{...u,curve:m}),T=n(p,{...c,gain:0}),R=r(p,{...u,curve:y}),P=r(p,{...u,curve:a}),L=n(p,{...c,gain:0}),z=r(p,{...u,curve:x}),Z=n(p,{...c,gain:0}),Q=r(p,{...u,curve:b});return{connectGraph(){g.connect(A),g.connect(P.inputs===void 0?P:P.inputs[0]),A.connect(E,0),A.connect(T,0),A.connect(L,1),A.connect(Z,1),P.connect(C),C.connect(D.inputs===void 0?D:D.inputs[0]),C.connect(R.inputs===void 0?R:R.inputs[0]),C.connect(z.inputs===void 0?z:z.inputs[0]),C.connect(Q.inputs===void 0?Q:Q.inputs[0]),D.connect(E.gain),R.connect(T.gain),z.connect(L.gain),Q.connect(Z.gain),E.connect(v,0,0),L.connect(v,0,0),T.connect(v,0,1),Z.connect(v,0,1)},disconnectGraph(){g.disconnect(A),g.disconnect(P.inputs===void 0?P:P.inputs[0]),A.disconnect(E,0),A.disconnect(T,0),A.disconnect(L,1),A.disconnect(Z,1),P.disconnect(C),C.disconnect(D.inputs===void 0?D:D.inputs[0]),C.disconnect(R.inputs===void 0?R:R.inputs[0]),C.disconnect(z.inputs===void 0?z:z.inputs[0]),C.disconnect(Q.inputs===void 0?Q:Q.inputs[0]),D.disconnect(E.gain),R.disconnect(T.gain),z.disconnect(L.gain),Q.disconnect(Z.gain),E.disconnect(v,0,0),L.disconnect(v,0,0),T.disconnect(v,0,1),Z.disconnect(v,0,1)}}},h=(p,g,C,v,m)=>{if(g===1)return d(p,C,v,m);if(g===2)return f(p,C,v,m);throw i()};return(p,{channelCount:g,channelCountMode:C,pan:v,...m})=>{if(C==="max")throw i();const y=e(p,{...m,channelCount:1,channelCountMode:C,numberOfInputs:2}),x=n(p,{...m,channelCount:g,channelCountMode:C,gain:1}),b=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:k,disconnectGraph:A}=h(p,g,x,b,y);Object.defineProperty(b.gain,"defaultValue",{get:()=>0}),Object.defineProperty(b.gain,"maxValue",{get:()=>1}),Object.defineProperty(b.gain,"minValue",{get:()=>-1});const E={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount(P){x.channelCount!==P&&(D&&A(),{connectGraph:k,disconnectGraph:A}=h(p,P,x,b,y),D&&k()),x.channelCount=P},get channelCountMode(){return x.channelCountMode},set channelCountMode(P){if(P==="clamped-max"||P==="max")throw i();x.channelCountMode=P},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation(P){x.channelInterpretation=P},get context(){return x.context},get inputs(){return[x]},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get pan(){return b.gain},addEventListener(...P){return x.addEventListener(P[0],P[1],P[2])},dispatchEvent(...P){return x.dispatchEvent(P[0])},removeEventListener(...P){return x.removeEventListener(P[0],P[1],P[2])}};let D=!1;const T=()=>{k(),D=!0},R=()=>{A(),D=!1};return o(su(E,y),T,R)}},XL=(e,t,n,r,i,o,s)=>(a,l)=>{const c=a.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,l);bn(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw t();Zt(c,{curve:u},"curve"),Zt(c,l,"oversample");let d=null,f=!1;return s(c,"curve",g=>()=>g.call(c),g=>C=>(g.call(c,C),f&&(r(C)&&d===null?d=e(a,c):!r(C)&&d!==null&&(d(),d=null)),C)),i(c,()=>{f=!0,r(c.curve)&&(d=e(a,c))},()=>{f=!1,d!==null&&(d(),d=null)})},KL=(e,t,n,r,i)=>(o,{curve:s,oversample:a,...l})=>{const c=o.createWaveShaper(),u=o.createWaveShaper();bn(c,l),bn(u,l);const d=n(o,{...l,gain:1}),f=n(o,{...l,gain:-1}),h=n(o,{...l,gain:1}),p=n(o,{...l,gain:-1});let g=null,C=!1,v=null;const m={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(b){d.channelCount=b,f.channelCount=b,c.channelCount=b,h.channelCount=b,u.channelCount=b,p.channelCount=b},get channelCountMode(){return c.channelCountMode},set channelCountMode(b){d.channelCountMode=b,f.channelCountMode=b,c.channelCountMode=b,h.channelCountMode=b,u.channelCountMode=b,p.channelCountMode=b},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(b){d.channelInterpretation=b,f.channelInterpretation=b,c.channelInterpretation=b,h.channelInterpretation=b,u.channelInterpretation=b,p.channelInterpretation=b},get context(){return c.context},get curve(){return v},set curve(b){if(b!==null&&b.length<2)throw t();if(b===null)c.curve=b,u.curve=b;else{const k=b.length,A=new Float32Array(k+2-k%2),E=new Float32Array(k+2-k%2);A[0]=b[0],E[0]=-b[k-1];const D=Math.ceil((k+1)/2),T=(k+1)/2-1;for(let R=1;R<D;R+=1){const P=R/D*T,L=Math.floor(P),z=Math.ceil(P);A[R]=L===z?b[L]:(1-(P-L))*b[L]+(1-(z-P))*b[z],E[R]=L===z?-b[k-1-L]:-((1-(P-L))*b[k-1-L])-(1-(z-P))*b[k-1-z]}A[D]=k%2===1?b[D-1]:(b[D-2]+b[D-1])/2,c.curve=A,u.curve=E}v=b,C&&(r(v)&&g===null?g=e(o,d):g!==null&&(g(),g=null))},get inputs(){return[d]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(b){c.oversample=b,u.oversample=b},addEventListener(...b){return d.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return d.dispatchEvent(b[0])},removeEventListener(...b){return d.removeEventListener(b[0],b[1],b[2])}};s!==null&&(m.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==m.oversample&&(m.oversample=a);const y=()=>{d.connect(c).connect(h),d.connect(f).connect(u).connect(p).connect(h),C=!0,r(v)&&(g=e(o,d))},x=()=>{d.disconnect(c),c.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),C=!1,g!==null&&(g(),g=null)};return i(su(m,h),y,x)},Br=()=>new DOMException("","NotSupportedError"),JL={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},YL=(e,t,n,r,i,o,s)=>class extends e{constructor(l,c){const u=i(l),d={...JL,...c},f=n(u,d),h=o(u),p=h?r():null,g=l.sampleRate/2;super(l,!1,f,p),this._detune=t(this,h,f.detune,153600,-153600),this._frequency=t(this,h,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){$c(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),Ds(this)&&wf(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},qL=(e,t,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,l=null;const c=async(u,d)=>{let f=n(u);const h=qn(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:s===null?void 0:s,type:f.type};f=t(d,p),a!==null&&f.start(a),l!==null&&f.stop(l)}return o.set(d,f),h?(await e(d,u.detune,f.detune),await e(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){l=u},render(u,d){const f=o.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},QL={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},e8=(e,t,n,r,i,o,s)=>class extends e{constructor(l,c){const u=i(l),d={...QL,...c},f=n(u,d),h=o(u),p=h?r():null;super(l,!1,f,p),this._nativePannerNode=f,this._orientationX=t(this,h,f.orientationX,or,Kr),this._orientationY=t(this,h,f.orientationY,or,Kr),this._orientationZ=t(this,h,f.orientationZ,or,Kr),this._positionX=t(this,h,f.positionX,or,Kr),this._positionY=t(this,h,f.positionY,or,Kr),this._positionZ=t(this,h,f.positionZ,or,Kr),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},t8=(e,t,n,r,i,o,s,a,l,c)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let g=null,C=o(h);const v={channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation},m={...v,coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,panningModel:C.panningModel,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor},y=qn(C,p);if("bufferSize"in C)g=r(p,{...v,gain:1});else if(!y){const x={...m,orientationX:C.orientationX.value,orientationY:C.orientationY.value,orientationZ:C.orientationZ.value,positionX:C.positionX.value,positionY:C.positionY.value,positionZ:C.positionZ.value};C=i(p,x)}if(u.set(p,g===null?C:g),g!==null){if(d===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const R=new s(6,h.context.length,p.sampleRate),P=t(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});P.connect(R.destination),d=(async()=>{const L=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(z,Z)=>{const Q=n(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Z===0?1:0});return await a(R,z,Q.offset),Q}));for(let z=0;z<6;z+=1)L[z].connect(P,0,z),L[z].start(0);return c(R)})()}const x=await d,b=r(p,{...v,gain:1});await l(h,p,b);const k=[];for(let R=0;R<x.numberOfChannels;R+=1)k.push(x.getChannelData(R));let A=[k[0][0],k[1][0],k[2][0]],E=[k[3][0],k[4][0],k[5][0]],D=r(p,{...v,gain:1}),T=i(p,{...m,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:E[0],positionY:E[1],positionZ:E[2]});b.connect(D).connect(T.inputs[0]),T.connect(g);for(let R=128;R<x.length;R+=128){const P=[k[0][R],k[1][R],k[2][R]],L=[k[3][R],k[4][R],k[5][R]];if(P.some((z,Z)=>z!==A[Z])||L.some((z,Z)=>z!==E[Z])){A=P,E=L;const z=R/p.sampleRate;D.gain.setValueAtTime(0,z),D=r(p,{...v,gain:0}),T=i(p,{...m,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:E[0],positionY:E[1],positionZ:E[2]}),D.gain.setValueAtTime(1,z),b.connect(D).connect(T.inputs[0]),T.connect(g)}}return g}return y?(await e(p,h.orientationX,C.orientationX),await e(p,h.orientationY,C.orientationY),await e(p,h.orientationZ,C.orientationZ),await e(p,h.positionX,C.positionX),await e(p,h.positionY,C.positionY),await e(p,h.positionZ,C.positionZ)):(await a(p,h.orientationX,C.orientationX),await a(p,h.orientationY,C.orientationY),await a(p,h.orientationZ,C.orientationZ),await a(p,h.positionX,C.positionX),await a(p,h.positionY,C.positionY),await a(p,h.positionZ,C.positionZ)),ou(C)?await l(h,p,C.inputs[0]):await l(h,p,C),C};return{render(h,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):f(h,p)}}},n8={disableNormalization:!1},r8=(e,t,n,r)=>class N2{constructor(o,s){const a=t(o),l=r({...n8,...s}),c=e(a,l);return n.add(c),c}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===N2.prototype||n.has(o)}},i8=(e,t)=>(n,r,i)=>(e(r).replay(i),t(r,n,i)),o8=(e,t,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(s.activeInputs.map((a,l)=>Array.from(a).map(async([c,u])=>{const f=await t(c).render(c,i),h=r.context.destination;!n(c)&&(r!==h||!n(r))&&f.connect(o,u,l)})).reduce((a,l)=>[...a,...l],[]))},s8=(e,t,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(Array.from(s.activeInputs).map(async([a,l])=>{const u=await e(a).render(a,i);n(a)||u.connect(o,l)}))},a8=(e,t,n,r)=>i=>e(pC,()=>pC(i))?Promise.resolve(e(r,r)).then(o=>{if(!o){const s=n(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const s=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{s.disconnect(),o(a.renderedBuffer)},s.connect(i.destination),i.startRendering()}),l8=e=>(t,n)=>{e.set(t,n)},c8=e=>(t,n)=>e.set(t,n),u8={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},d8=(e,t,n,r,i,o)=>class extends e{constructor(a,l){const c=i(a),u={...u8,...l},d=n(c,u),f=o(c),h=f?r():null;super(a,!1,d,h),this._pan=t(this,f,d.pan)}get pan(){return this._pan}},f8=(e,t,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=t(l,d)}return o.set(l,c),u?await e(l,a.pan,c.pan):await r(l,a.pan,c.pan),ou(c)?await i(a,l,c.inputs[0]):await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},h8=e=>()=>{if(e===null)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0},p8=(e,t)=>async()=>{if(e===null)return!0;if(t===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const a=new e(r,"a",{numberOfOutputs:0}),l=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>s=!0,l.connect(a),l.start(0),await r.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s},g8=(e,t)=>()=>{if(t===null)return Promise.resolve(!1);const n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},m8=()=>new DOMException("","UnknownError"),v8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},C8=(e,t,n,r,i,o,s)=>class extends e{constructor(l,c){const u=i(l),d={...v8,...c},f=n(u,d),p=o(u)?r():null;super(l,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},y8=(e,t,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=t(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=e(s,c)}return r.set(s,a),ou(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},x8=()=>typeof window>"u"?null:window,I8=(e,t)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=e(o),a=e(i);if(a>=n.numberOfChannels)throw t();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)r[d]=c[d+s]},n.copyToChannel=(r,i,o=0)=>{const s=e(o),a=e(i);if(a>=n.numberOfChannels)throw t();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)c[d+s]=r[d]}},b8=e=>t=>{t.copyFromChannel=(n=>(r,i,o=0)=>{const s=e(o),a=e(i);if(s<t.length)return n.call(t,r,a,s)})(t.copyFromChannel),t.copyToChannel=(n=>(r,i,o=0)=>{const s=e(o),a=e(i);if(s<t.length)return n.call(t,r,a,s)})(t.copyToChannel)},A8=e=>(t,n)=>{const r=n.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=r),e(t,"buffer",i=>()=>{const o=i.call(t);return o===r?null:o},i=>o=>i.call(t,o===null?r:o))},w8=(e,t)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const i=n.createBufferSource();t(r,()=>{const a=r.numberOfInputs;for(let l=0;l<a;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},B2=(e,t,n)=>e.copyFromChannel===void 0?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0]),O2=e=>{if(e===null)return!1;const t=e.length;return t%2!==0?e[Math.floor(t/2)]!==0:e[t/2-1]+e[t/2]!==0},Rf=(e,t,n,r)=>{let i=e;for(;!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,{get:n(o),set:r(s)})},S8=e=>({...e,outputChannelCount:e.outputChannelCount!==void 0?e.outputChannelCount:e.numberOfInputs===1&&e.numberOfOutputs===1?[e.channelCount]:Array.from({length:e.numberOfOutputs},()=>1)}),k8=e=>({...e,channelCount:e.numberOfOutputs}),E8=e=>{const{imag:t,real:n}=e;return t===void 0?n===void 0?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(n,()=>0),real:n}:n===void 0?{...e,imag:t,real:Array.from(t,()=>0)}:{...e,imag:t,real:n}},F2=(e,t,n)=>{try{e.setValueAtTime(t,n)}catch(r){if(r.code!==9)throw r;F2(e,t,n+1e-7)}},T8=e=>{const t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},R8=e=>{const t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0},_8=e=>{const t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},V1=e=>{const t=e.createOscillator();try{t.start(-1)}catch(n){return n instanceof RangeError}return!1},M2=e=>{const t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},G1=e=>{const t=e.createOscillator();try{t.stop(-1)}catch(n){return n instanceof RangeError}return!1},D8=e=>{const{port1:t,port2:n}=new MessageChannel;try{t.postMessage(e)}finally{t.close(),n.close()}},P8=e=>{e.start=(t=>(n=0,r=0,i)=>{const o=e.buffer,s=o===null?r:Math.min(o.duration,r);o!==null&&s>o.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,s,i)})(e.start)},L2=(e,t)=>{const n=t.createGain();e.connect(n);const r=(i=>()=>{i.call(e,n),e.removeEventListener("ended",r)})(e.disconnect);e.addEventListener("ended",r),su(e,n),e.stop=(i=>{let o=!1;return(s=0)=>{if(o)try{i.call(e,s)}catch{n.gain.setValueAtTime(0,s)}else i.call(e,s),o=!0}})(e.stop)},au=(e,t)=>n=>{const r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof t=="function"?t.call(e,n):t.handleEvent.call(e,n)},N8=sF(Ul),B8=fF(Ul),O8=wM(Bp),U2=new WeakMap,F8=WM(U2),js=tM(new Map,new WeakMap),Mo=x8(),V2=pL(js,Go),G2=GM(cr),jn=o8(cr,G2,El),M8=vF(V2,Ut,jn),_t=HM(v2),za=GL(Mo),At=iL(za),W2=new WeakMap,j2=BM(au),_f=CL(Mo),z2=eL(_f),H2=tL(Mo),L8=nL(Mo),$d=xL(Mo),sn=jF(aF(h2),dF(N8,B8,O0,O8,F0,cr,F8,Af,Ut,Ul,Ds,El,_h),js,QM(lC,F0,cr,Ut,Zd,Ds),Go,Op,Br,xM(O0,lC,cr,Ut,Zd,_t,Ds,At),EM(W2,cr,Yi),j2,_t,z2,H2,L8,At,$d),U8=mF(sn,M8,Go,V2,_t,At),Z2=new WeakSet,eA=gL(Mo),$2=pM(new Uint32Array(1)),X2=I8($2,Go),K2=b8($2),V8=yF(Z2,js,Br,eA,za,h8(eA),X2,K2),Fp=hF(Nr),J2=s8(G2,Sf,El),Wo=lM(J2),lu=vL(Fp,js,T8,R8,_8,V1,M2,G1,P8,A8(Rf),L2),jo=i8(jM(Sf),J2),G8=bF(Wo,lu,Ut,jo,jn),to=zF(lF(g2),W2,m2,HF,eF,tF,nF,rF,iF,oC,d2,_f,F2),W8=IF(sn,G8,to,Mn,lu,_t,At,au),j8=PF(sn,NF,Go,Mn,yL(Nr,Rf),_t,At,jn),z8=eM(Wo,D2,Ut,jo,jn),Vl=c8(U2),H8=QF(sn,to,z8,Op,D2,_t,At,Vl),Ha=fL(Ul,H2),Z8=w8(Mn,Ha),Za=EL(_f,Z8),$8=iM(Za,Ut,jn),X8=rM(sn,$8,Za,_t,At),K8=aM(Ef,Ut,jn),J8=sM(sn,K8,Ef,_t,At,k8),Y8=_L(Fp,lu,Nr,Ha),cu=RL(Fp,js,Y8,V1,G1),q8=hM(Wo,cu,Ut,jo,jn),Q8=fM(sn,to,q8,cu,_t,At,au),Y2=DL(Br,Rf),e6=vM(Y2,Ut,jn),t6=mM(sn,e6,Y2,_t,At,Vl),n6=AM(Wo,P2,Ut,jo,jn),r6=bM(sn,to,n6,P2,_t,At,Vl),q2=PL(Br),i6=DM(Wo,q2,Ut,jo,jn),o6=_M(sn,to,i6,q2,Br,_t,At,Vl),s6=UM(Wo,Nr,Ut,jo,jn),a6=LM(sn,to,s6,Nr,_t,At),l6=FL(Op,Mn,Tf,Br),W1=a8(js,Nr,Tf,g8(Nr,za)),c6=qM(lu,Ut,za,jn,W1),u6=NL(l6),d6=JM(sn,u6,c6,_t,At,Vl),f6=BF(to,Za,cu,Tf,Br,B2,At,Rf),Q2=new WeakMap,h6=dL(j8,f6,j2,At,Q2,au),eR=WL(Fp,js,V1,M2,G1,L2),p6=qL(Wo,eR,Ut,jo,jn),g6=YL(sn,to,eR,p6,_t,At,au),tR=uM(lu),m6=KL(tR,Mn,Nr,O2,Ha),Mp=XL(tR,Mn,m6,O2,Ha,_f,Rf),v6=zL(O0,Mn,Za,Nr,Tf,Mp,Br,F0,B2,Ha),nR=jL(v6),C6=t8(Wo,Za,cu,Nr,nR,Ut,za,jo,jn,W1),y6=e8(sn,to,nR,C6,_t,At,Vl),x6=HL(Go),I6=r8(x6,_t,new WeakSet,E8),b6=$L(Za,Ef,Nr,Mp,Br,Ha),rR=ZL(b6,Br),A6=f8(Wo,rR,Ut,jo,jn),w6=d8(sn,to,rR,A6,_t,At),S6=y8(Mp,Ut,jn),k6=C8(sn,Mn,Mp,S6,_t,At,Vl),iR=oL(Mo),j1=OM(Mo),oR=new WeakMap,E6=ZM(oR,za),T6=iR?uF(js,Br,NM(Mo),j1,FM(oF),_t,E6,At,$d,new WeakMap,new WeakMap,p8($d,za),Mo):void 0,R6=rL(z2,At),_6=yM(Z2,js,CM,PM,new WeakSet,_t,R6,fC,pC,X2,K2),D6=YF(T6,U8,V8,W8,H8,X8,J8,Q8,t6,_6,r6,o6,a6,d6,h6,g6,y6,I6,w6,k6),P6=sL(sn,ML,_t,At),N6=lL(sn,LL,_t,At),B6=cL(sn,UL,_t,At),O6=VL(Mn,At),F6=uL(sn,O6,_t),M6=DF(D6,Mn,Br,m8,P6,N6,B6,F6,_f),sR=$M(Q2),L6=pF(sR),aR=cM(Go),U6=SM(sR),lR=TM(Go),cR=new WeakMap,V6=VM(cR,Yi),G6=kL(aR,Go,Mn,Za,Ef,cu,Nr,Tf,Br,lR,j1,V6,Ha),W6=bL(Mn,G6,Nr,Br,Ha),j6=JF(Wo,aR,lu,Za,Ef,cu,Nr,U6,lR,j1,Ut,$d,za,jo,jn,W1),z6=zM(oR),H6=l8(cR),tA=iR?$F(L6,sn,to,j6,W6,cr,z6,_t,At,$d,S8,H6,D8,au):void 0,Z6="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";let nA=class{constructor(t){M(this,"maxSize");M(this,"cache");this.maxSize=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const n=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,n),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;r!==void 0&&this.cache.delete(r)}this.cache.set(t,n)}has(t){return this.cache.has(t)}};const rA=100;var zt;let $6=(zt=class{static setCacheExpirationTime(t){this.cacheExpirationTime=t}static async openCache(){try{return await caches.open("audio-cache")}catch(t){throw console.error("Failed to open cache:",t),t}}static async getOrCreatePendingRequest(t,n){let r=this.pendingRequests.get(t);if(!r){const i=(async()=>{try{const o=await n();if(o===void 0)throw new Error("Failed to create audio buffer.");return o}finally{this.pendingRequests.delete(t)}})();return this.pendingRequests.set(t,i),i}return r}static async updateMetadata(t,n,r){const i={url:n,timestamp:Date.now(),...r};await t.put(`${n}:meta`,new Response(JSON.stringify(i),{headers:{"Content-Type":"application/json"}}))}static async getBufferFromCache(t,n){try{const r=await n.match(t);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(t,n,r,i){const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const s=await fetch(t,{headers:o});if(s.status===304){const a=await n.match(t);if(a){const l=Date.now();return await this.updateMetadata(n,t,{timestamp:l,etag:r,lastModified:i}),await a.arrayBuffer()}}if(s.status===200){const a=s.clone(),l=s.headers.get("ETag"),c=s.headers.get("Last-Modified");try{await Promise.all([n.put(t,a),this.updateMetadata(n,t,{timestamp:Date.now(),etag:l||void 0,lastModified:c||void 0})])}catch(u){throw await n.delete(t),await n.delete(`${t}:meta`),u}}return await s.arrayBuffer()}static async decodeAudioData(t,n){try{return await t.decodeAudioData(n)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(t,n){try{const r=await n.match(t+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}async getAudioBuffer(t,n){if(zt.decodedBuffers.has(n))return zt.decodedBuffers.get(n);if(n.startsWith("data:")){const s=n.split(",")[1],a=Uint8Array.from(atob(s),c=>c.charCodeAt(0)).buffer,l=await zt.decodeAudioData(t,a);return zt.decodedBuffers.set(n,l),l}const r=await zt.openCache(),i=await zt.getMetadataFromCache(n,r),o=!i||!i.etag&&!i.lastModified||Date.now()-i.timestamp>zt.cacheExpirationTime;return zt.getOrCreatePendingRequest(n,async()=>{if(o){const s=await zt.fetchAndCacheBuffer(n,r,i==null?void 0:i.etag,i==null?void 0:i.lastModified),a=await zt.decodeAudioData(t,s);return zt.decodedBuffers.set(n,a),a}else{const s=await zt.getBufferFromCache(n,r);if(s){const a=await zt.decodeAudioData(t,s);return zt.decodedBuffers.set(n,a),a}}})}clearMemoryCache(){zt.decodedBuffers=new nA(rA),zt.pendingRequests.clear()}},M(zt,"pendingRequests",new Map),M(zt,"decodedBuffers",new nA(rA)),M(zt,"cacheExpirationTime",24*60*60*1e3),zt),iA=class{constructor(t=[]){M(this,"_position",[0,0,0]);M(this,"loopCount",0);M(this,"playIndex",0);this.sounds=t}preplayRandom(){if(this.sounds.length===0)return;const t=this.randomSound().preplay();return t.length>0?t[0]:void 0}playRandom(){const t=this.preplayRandom();return t&&t.play(),t}preplayOrdered(t=!0){if(this.sounds.length===0)return;const n=this.sounds[this.playIndex].preplay();if(n.length!==0)return this.playIndex=(this.playIndex+1)%this.sounds.length,!t&&this.playIndex===0&&(this.playIndex=this.sounds.length),n[0]}playOrdered(t=!0){const n=this.preplayOrdered(t);return n&&n.play(),n}get duration(){return this.sounds.map(t=>t.duration).reduce((t,n)=>Math.max(t,n),0)}seek(t){this.sounds.forEach(n=>n.seek&&n.seek(t))}addSound(t){this.sounds.push(t)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const t=Math.floor(Math.random()*this.sounds.length);return this.sounds[t]}preplay(){return this.sounds.map(t=>t.preplay()).flat()}play(){const t=[];return this.preplay().forEach(n=>{n.play(),t.push(n)}),t}get isPlaying(){return this.sounds.some(t=>t.isPlaying)}stop(){this.sounds.forEach(t=>t.stop())}pause(){this.sounds.forEach(t=>t.pause())}loop(t){return t===void 0?this.loopCount:(this.loopCount=t,this.sounds.forEach(n=>n.loop(t)),this.loopCount)}addFilter(t){this.sounds.forEach(n=>n.addFilter(t))}removeFilter(t){this.sounds.forEach(n=>n.removeFilter(t))}set position(t){this._position=t,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(t=>t.volume).reduce((t,n)=>t+n,0)/this.sounds.length}set volume(t){this.sounds.forEach(n=>n.volume=t)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(t){this.sounds.forEach(n=>n.playbackRate=t)}};class uu{constructor(){M(this,"_filters",[])}addFilter(t){this._filters.push(t)}removeFilter(t){this._filters=this._filters.filter(n=>n.frequency.value!==t.frequency.value&&n.type!==t.type&&n.Q.value!==t.Q.value&&n.gain.value!==t.gain.value)}applyFilters(t){return this._filters.reduce((n,r)=>(n.connect(r),r),t),this._filters.length>0?this._filters[this._filters.length-1]:t}get filters(){return this._filters}addFilters(t){t.forEach(n=>this.addFilter(n))}removeFilters(t){t.forEach(n=>this.removeFilter(n))}}let X6=class extends uu{constructor(n,r,i,o=0){super();M(this,"context");M(this,"source");M(this,"gainNode");M(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}},K6=class extends uu{constructor(n){super();M(this,"context");M(this,"_position",[0,0,0]);M(this,"loopCount",0);M(this,"prevVolume",1);M(this,"microphoneGainNode");M(this,"streamPlayback");M(this,"stream");M(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new X6(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}};function uR(e){class t extends e{constructor(){super(...arguments);M(this,"playbacks",[]);M(this,"_position",[0,0,0]);M(this,"_stereoPan",0);M(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});M(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return t}function dR(e){class t extends e{constructor(){super(...arguments);M(this,"panner");M(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=oA(i,-1,1),this.panner.pan.setValueAtTime(oA(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,s,a]=i,l=this.panner;l.positionX.value=o,l.positionY.value=s,l.positionZ.value=a}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return t}function oA(e,t,n){return Math.min(Math.max(e,t),n)}function fR(e){class t extends e{constructor(){super(...arguments);M(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return t}let hR=class extends dR(fR(uu)){constructor(){super(...arguments);M(this,"source");M(this,"_playing",!1);M(this,"origin")}get isPlaying(){return this.source?this._playing:!1}},J6=class pR extends hR{constructor(n,r,i){super();M(this,"context");M(this,"loopCount",0);M(this,"currentLoop",0);M(this,"buffer");M(this,"_offset",0);M(this,"_startTime",0);M(this,"_state",0);M(this,"_playbackRate",1);M(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():this.play()))});this.origin=n,this.context=n.context,this.loopCount=n.loopCount,this.setPanType(n.panType,n.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(n){if("mediaElement"in n&&n.mediaElement)n.mediaElement.onended=this.loopEnded;else if("onended"in n)n.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(n){if(n<=0)throw new Error("Playback rate must be greater than 0");if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=n,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const n=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=n,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(n){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(n)||n<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=n,"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.currentTime=n),r&&this.play()}get currentTime(){if(this._state===1){const n=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+n}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&(!("mediaElement"in this.source)&&"onended"in this.source&&(this.source.onended=null),this.source.disconnect()),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=[]}loop(n){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(n!==void 0&&(this.loopCount=n==="infinite"?"infinite":Math.max(0,n),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(n){const r=this.context.createBiquadFilter();r.type=n.type,r.frequency.value=n.frequency.value,r.Q.value=n.Q.value,r.gain.value=n.gain.value,this._filters.push(r),this.refreshFilters()}removeFilter(n){const r=this._filters.indexOf(n);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}clone(n={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=n.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=new pR(this.origin,o,i);return a.loopCount=s,a.currentLoop=this.currentLoop,a.setPanType(r,this.context),a.volume=this.volume,a.playbackRate=this._playbackRate,a._offset=this._offset,a._state=this._state,this._filters.forEach(l=>{const c=this.context.createBiquadFilter();c.type=l.type,c.frequency.value=l.frequency.value,c.Q.value=l.Q.value,c.gain.value=l.gain.value,a.addFilter(c)}),this._state===1&&a.play(),a}},rh=class gR extends uR(uu){constructor(n,r,i,o,s=Xd.Buffer,a="HRTF"){super();M(this,"buffer");M(this,"context");M(this,"loopCount",0);M(this,"_playbackRate",1);this.url=n,this.globalGainNode=o,this.soundType=s,this.panType=a,this.buffer=r,this.context=i}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan,o=n.threeDOptions||this.threeDOptions,s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=n.playbackRate||this.playbackRate,l=n.volume!==void 0?n.volume:this.volume,c=n.position!==void 0?n.position:this.position,u=n.filters&&n.filters.length?n.filters:this._filters,d=new gR(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return d.loop(s),d.playbackRate=a,d.volume=l,r==="HRTF"?(d.threeDOptions=o,d.position=c):d.stereoPan=i,d.addFilters(u),d}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",n=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new J6(this,n,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return this.playbacks.length>0?this.playbacks[0].duration:((n=this.buffer)==null?void 0:n.duration)||NaN}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.loop(n)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}};function Y6(e){class t extends hR{constructor(){super(...arguments);M(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return t}let q6=class extends Y6(dR(fR(uu))){constructor(n,r,i){super();M(this,"context");this.origin=n,this.source=r,this.context=n.context,this.setPanType(n.panType,n.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}},Q6=class mR extends uR(uu){constructor(n,r,i=Xd.Oscillator,o="HRTF",s={}){super();M(this,"_oscillatorOptions");M(this,"playbacks",[]);this.context=n,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=n,this._oscillatorOptions=s}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan??0,o=n.threeDOptions||this.threeDOptions,s=n.volume!==void 0?n.volume:this.volume,a=n.position&&n.position.length?n.position:this.position,l=n.filters&&n.filters.length?n.filters:this._filters,c=n.oscillatorOptions||this._oscillatorOptions,u=new mR(this.context,this.globalGainNode,this.soundType,r,c);return u._volume=s,u._position=a,u._stereoPan=i,u._threeDOptions=o,u.addFilters(l),u}preplay(){const n=this.context.createOscillator();this.oscillatorOptions.detune&&(n.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(n.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(n.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new q6(this,n,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(n){this._oscillatorOptions=n,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(n){this._oscillatorOptions.frequency=n,this.playbacks.forEach(r=>r.frequency=n)}get detune(){return this.oscillatorOptions.detune}set detune(n){this._oscillatorOptions.detune=n,this.playbacks.forEach(r=>r.detune=n)}get type(){return this.oscillatorOptions.type||"sine"}set type(n){this._oscillatorOptions.type=n,this.playbacks.forEach(r=>r.type=n)}};var Xd=(e=>(e.HTML="HTML",e.Streaming="Streaming",e.Buffer="Buffer",e.Oscillator="oscillator",e))(Xd||{});let e9=class{constructor(t,n){M(this,"context");M(this,"globalGainNode");M(this,"listener");M(this,"prevVolume",1);M(this,"finalizationRegistry");M(this,"cache");M(this,"createBiquadFilter",({type:t,frequency:n,gain:r,Q:i})=>{n===void 0&&(n=350);const o=this.context.createBiquadFilter();return o.type=t||"lowpass",o.frequency.value=n,o.gain.value=r||0,o.Q.value=i||1,o});this.context=t||new M6,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.cache=n||new $6,this.finalizationRegistry=new FinalizationRegistry(r=>{r.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",Z6):console.warn("AudioWorklet not supported")}async createWorkletNode(t,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new tA(this.context,t)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new tA(this.context,t)}}clearMemoryCache(){this.cache.clearMemoryCache()}createOscillator(t,n="HRTF"){return new Q6(this.context,this.globalGainNode,"oscillator",n,t)}async createSound(t,n="Buffer",r="HRTF"){if(typeof t=="object")return Promise.resolve(new rh("",t,this.context,this.globalGainNode,"Buffer",r));const i=t;if(n==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new rh(i,void 0,this.context,this.globalGainNode,"HTML",r)}return this.cache.getAudioBuffer(this.context,i).then(o=>new rh(i,o,this.context,this.globalGainNode,n,r))}async createGroup(t){const n=new iA;return t.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(t,n="Buffer",r="HRTF"){const i=new iA;return(await Promise.all(t.map(o=>this.createSound(o,n,r)))).forEach(o=>i.addSound(o)),i}async createStream(t){return new rh(t,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:t,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:s,channelCountMode:a,channelInterpretation:l,panningModel:c,refDistance:u,rolloffFactor:d,positionX:f,positionY:h,positionZ:p,orientationX:g,orientationY:C,orientationZ:v}){const m=this.context.createPanner();return m.coneInnerAngle=t||360,m.coneOuterAngle=n||360,m.coneOuterGain=r||0,m.distanceModel=i||"inverse",m.maxDistance=o||1e4,m.channelCount=s||2,m.channelCountMode=a||"clamped-max",m.channelInterpretation=l||"speakers",m.panningModel=c||"HRTF",m.refDistance=u||1,m.rolloffFactor=d||1,m.positionX.value=f||0,m.positionY.value=h||0,m.positionZ.value=p||0,m.orientationX.value=g||0,m.orientationY.value=C||0,m.orientationZ.value=v||0,m}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(t){this.globalGainNode.gain.value=t}get volume(){return this.globalGainNode.gain.value}set volume(t){if(this.muted){this.prevVolume=t;return}this.setGlobalVolume(t)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(t){t!==this.muted&&(t?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((t,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new K6(this.context);i.play(),t(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(t){const{forward:n,up:r}=t,[i,o,s]=n,[a,l,c]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=s,this.listener.upX.value=a,this.listener.upY.value=l,this.listener.upZ.value=c}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(t){const[n,r,i]=t;this.listener.upX.value=n,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(t){const[n,r,i]=t;this.listener.forwardX.value=n,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(t){const[n,r,i]=t,o=this.context.currentTime;this.listener.positionX.setValueAtTime(n,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}};const t9="https://mongoose.world:9080/?url=";class n9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Client.Media");M(this,"sounds",{});M(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let s=await this.client.cacophony.createSound(r);s.key=i,this.sounds[i]=s}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=t9+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];const o=n.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,Xd.HTML,o):i=await this.client.cacophony.createSound(r,Xd.Buffer,o)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0){const s=n.loops===-1?1/0:n.loops-1;i.loop(s)}if(n.start&&i.seek(n.start/1e3),n.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const a=this.sounds[s];a.priority&&a.priority<n.priority&&a.stop()}i.priority=n.priority}i.isPlaying||(i.play()[0],n.fadein,n.fadeout),i.key=n.key,this.sounds[i.key]=i}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>this.stopSound(r)),n.type&&this.soundsByType(n.type).forEach(r=>this.stopSound(r)),n.tag&&this.soundsByTag(n.tag).forEach(r=>this.stopSound(r)),n.key&&this.soundsByKey(n.key).forEach(r=>this.stopSound(r)),!n.name&&!n.type&&!n.tag&&!n.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(n){delete this.sounds[n.key],n.stop()}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class r9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class i9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Comm.Channel");M(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){console.log(`Received Comm.Channel.Text on ${n.channel} from ${n.talker}: ${n.text}`),this.client.emit("channelText",n),n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}handlePlayers(n){console.log("Received Comm.Channel.Players:",n),this.client.emit("channelPlayers",n)}sendPlayersRequest(){this.sendData("Players","")}sendEnable(n){this.sendData("Enable",n)}handleStart(n){console.log(`Received Comm.Channel.Start for ${n}`),this.client.emit("channelStart",n)}handleEnd(n){console.log(`Received Comm.Channel.End for ${n}`),this.client.emit("channelEnd",n)}}class o9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class s9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}sendKeepAlive(){this.sendData("KeepAlive")}sendPing(n){this.sendData("Ping",n)}handlePing(){console.log("Received Core.Ping response from server."),this.client.emit("corePing")}handleGoodbye(n){console.log(`Server sent Core.Goodbye: ${n}`),this.client.emit("coreGoodbye",n)}}class a9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).filter(r=>r.packageName&&r.packageVersion).map(r=>`${r.packageName} ${r.packageVersion.toString()}`);this.sendData("Set",n)}sendAdd(n){const r=n.map(i=>`${i.name} ${i.version}`);this.sendData("Add",r)}sendRemove(n){this.sendData("Remove",n)}}class l9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Afflictions")}handleList(n){console.log("Received Char.Afflictions.List:",n),this.client.emit("afflictionsList",n)}handleAdd(n){console.log("Received Char.Afflictions.Add:",n),this.client.emit("afflictionAdd",n)}handleRemove(n){console.log("Received Char.Afflictions.Remove:",n),this.client.emit("afflictionRemove",n)}}class c9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Defences")}handleList(n){console.log("Received Char.Defences.List:",n),this.client.emit("defencesList",n)}handleAdd(n){console.log("Received Char.Defences.Add:",n),this.client.emit("defenceAdd",n)}handleRemove(n){console.log("Received Char.Defences.Remove:",n),this.client.emit("defenceRemove",n)}}class u9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Items")}handleList(n){console.log(`Received Char.Items.List for ${n.location}:`,n.items);const r=n.items.map(i=>({...i,location:n.location}));this.client.emit("itemsList",{...n,items:r})}handleAdd(n){console.log(`Received Char.Items.Add for ${n.location}:`,n.item);const r={...n.item,location:n.location};this.client.emit("itemAdd",{...n,item:r})}handleRemove(n){console.log(`Received Char.Items.Remove for ${n.location}:`,n.item);const r={...n.item,location:n.location};this.client.emit("itemRemove",{...n,item:r})}handleUpdate(n){console.log(`Received Char.Items.Update for ${n.location}:`,n.item);const r={...n.item,location:n.location};this.client.emit("itemUpdate",{...n,item:r})}sendContentsRequest(n){this.sendData("Contents",n)}sendInventoryRequest(){this.sendData("Inv","")}sendRoomRequest(){this.sendData("Room","")}}class d9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Skills")}handleGroups(n){console.log("Received Char.Skills.Groups:",n),this.client.emit("skillGroups",n)}handleList(n){console.log(`Received Char.Skills.List for ${n.group}:`,n),this.client.emit("skillList",n)}handleInfo(n){console.log(`Received Char.Skills.Info for ${n.group}.${n.skill}:`,n.info),this.client.emit("skillInfo",n)}sendGetRequest(n,r){const i={};n&&(i.group=n),r&&(i.name=r),this.sendData("Get",i)}}class f9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Group")}handleInfo(n){console.log("Received Group.Info:",n),this.client.emit("groupInfo",n)}sendInfoRequest(){this.sendData("Info",{})}}class h9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Logging")}handleError(n){console.error("Received Logging.Error from server:",n),this.client.emit("gmcpError",n)}}class p9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Redirect")}handleWindow(n){const r=n||"main";console.log(`Received Redirect.Window: ${r}`),this.client.emit("redirectWindow",r)}}class g9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Room");M(this,"name","");M(this,"id","");M(this,"exits",[]);M(this,"people",[])}handleInfo(n){this.name=n.name,this.name=n.name,this.id=n.num.toString(),this.client.worldData.roomId=this.id,this.client.currentRoomInfo=n,console.log("Received Room.Info:",n),this.client.emit("roomInfo",n)}handleWrongDir(n){console.log(`Received Room.WrongDir: ${n}`),this.client.emit("roomWrongDir",n)}handlePlayers(n){console.log("Received Room.Players:",n),this.client.emit("roomPlayers",n)}handleAddPlayer(n){console.log("Received Room.AddPlayer:",n),this.client.emit("roomAddPlayer",n)}handleRemovePlayer(n){console.log("Received Room.RemovePlayer:",n),this.client.emit("roomRemovePlayer",n)}}const ql=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,vR=new Set,gC=typeof process=="object"&&process?process:{},CR=(e,t,n,r)=>{typeof gC.emitWarning=="function"?gC.emitWarning(e,t,n,r):console.error(`[${n}] ${t}: ${e}`)};let V0=globalThis.AbortController,sA=globalThis.AbortSignal;var Ck;if(typeof V0>"u"){sA=class{constructor(){M(this,"onabort");M(this,"_onabort",[]);M(this,"reason");M(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},V0=class{constructor(){M(this,"signal",new sA);t()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const s of this.signal._onabort)s(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let e=((Ck=gC.env)==null?void 0:Ck.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const t=()=>{e&&(e=!1,CR("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}const m9=e=>!vR.has(e),na=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),yR=e=>na(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Dh:null:null;class Dh extends Array{constructor(t){super(t),this.fill(0)}}var Bc;const il=class il{constructor(t,n){M(this,"heap");M(this,"length");if(!F(il,Bc))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(t),this.length=0}static create(t){const n=yR(t);if(!n)return[];Oe(il,Bc,!0);const r=new il(t,n);return Oe(il,Bc,!1),r}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}};Bc=new WeakMap,ct(il,Bc,!1);let mC=il;var yk,xk,Ti,Lr,Ri,_i,Oc,Fc,pn,Di,cn,Ot,We,nr,Ur,Zn,wn,Pi,Sn,Ni,Bi,Vr,Oi,ha,rr,ve,CC,dl,es,hf,Gr,xR,fl,Mc,pf,ra,ia,yC,Ph,Nh,Bt,xC,td,oa,IC;const eI=class eI{constructor(t){ct(this,ve);ct(this,Ti);ct(this,Lr);ct(this,Ri);ct(this,_i);ct(this,Oc);ct(this,Fc);M(this,"ttl");M(this,"ttlResolution");M(this,"ttlAutopurge");M(this,"updateAgeOnGet");M(this,"updateAgeOnHas");M(this,"allowStale");M(this,"noDisposeOnSet");M(this,"noUpdateTTL");M(this,"maxEntrySize");M(this,"sizeCalculation");M(this,"noDeleteOnFetchRejection");M(this,"noDeleteOnStaleGet");M(this,"allowStaleOnFetchAbort");M(this,"allowStaleOnFetchRejection");M(this,"ignoreFetchAbort");ct(this,pn);ct(this,Di);ct(this,cn);ct(this,Ot);ct(this,We);ct(this,nr);ct(this,Ur);ct(this,Zn);ct(this,wn);ct(this,Pi);ct(this,Sn);ct(this,Ni);ct(this,Bi);ct(this,Vr);ct(this,Oi);ct(this,ha);ct(this,rr);ct(this,dl,()=>{});ct(this,es,()=>{});ct(this,hf,()=>{});ct(this,Gr,()=>!1);ct(this,fl,t=>{});ct(this,Mc,(t,n,r)=>{});ct(this,pf,(t,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});M(this,yk,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:l,dispose:c,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:g,fetchMethod:C,memoMethod:v,noDeleteOnFetchRejection:m,noDeleteOnStaleGet:y,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:b,ignoreFetchAbort:k}=t;if(n!==0&&!na(n))throw new TypeError("max option must be a nonnegative integer");const A=n?yR(n):Array;if(!A)throw new Error("invalid max value: "+n);if(Oe(this,Ti,n),Oe(this,Lr,h),this.maxEntrySize=p||F(this,Lr),this.sizeCalculation=g,this.sizeCalculation){if(!F(this,Lr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("memoMethod must be a function if defined");if(Oe(this,Fc,v),C!==void 0&&typeof C!="function")throw new TypeError("fetchMethod must be a function if specified");if(Oe(this,Oc,C),Oe(this,ha,!!C),Oe(this,cn,new Map),Oe(this,Ot,new Array(n).fill(void 0)),Oe(this,We,new Array(n).fill(void 0)),Oe(this,nr,new A(n)),Oe(this,Ur,new A(n)),Oe(this,Zn,0),Oe(this,wn,0),Oe(this,Pi,mC.create(n)),Oe(this,pn,0),Oe(this,Di,0),typeof c=="function"&&Oe(this,Ri,c),typeof u=="function"?(Oe(this,_i,u),Oe(this,Sn,[])):(Oe(this,_i,void 0),Oe(this,Sn,void 0)),Oe(this,Oi,!!F(this,Ri)),Oe(this,rr,!!F(this,_i)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!m,this.allowStaleOnFetchRejection=!!x,this.allowStaleOnFetchAbort=!!b,this.ignoreFetchAbort=!!k,this.maxEntrySize!==0){if(F(this,Lr)!==0&&!na(F(this,Lr)))throw new TypeError("maxSize must be a positive integer if specified");if(!na(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ee(this,ve,xR).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!y,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=na(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!na(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ee(this,ve,CC).call(this)}if(F(this,Ti)===0&&this.ttl===0&&F(this,Lr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!F(this,Ti)&&!F(this,Lr)){const E="LRU_CACHE_UNBOUNDED";m9(E)&&(vR.add(E),CR("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",E,eI))}}static unsafeExposeInternals(t){return{starts:F(t,Bi),ttls:F(t,Vr),sizes:F(t,Ni),keyMap:F(t,cn),keyList:F(t,Ot),valList:F(t,We),next:F(t,nr),prev:F(t,Ur),get head(){return F(t,Zn)},get tail(){return F(t,wn)},free:F(t,Pi),isBackgroundFetch:n=>{var r;return Ee(r=t,ve,Bt).call(r,n)},backgroundFetch:(n,r,i,o)=>{var s;return Ee(s=t,ve,Nh).call(s,n,r,i,o)},moveToTail:n=>{var r;return Ee(r=t,ve,td).call(r,n)},indexes:n=>{var r;return Ee(r=t,ve,ra).call(r,n)},rindexes:n=>{var r;return Ee(r=t,ve,ia).call(r,n)},isStale:n=>{var r;return F(r=t,Gr).call(r,n)}}}get max(){return F(this,Ti)}get maxSize(){return F(this,Lr)}get calculatedSize(){return F(this,Di)}get size(){return F(this,pn)}get fetchMethod(){return F(this,Oc)}get memoMethod(){return F(this,Fc)}get dispose(){return F(this,Ri)}get disposeAfter(){return F(this,_i)}getRemainingTTL(t){return F(this,cn).has(t)?1/0:0}*entries(){for(const t of Ee(this,ve,ra).call(this))F(this,We)[t]!==void 0&&F(this,Ot)[t]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,We)[t])&&(yield[F(this,Ot)[t],F(this,We)[t]])}*rentries(){for(const t of Ee(this,ve,ia).call(this))F(this,We)[t]!==void 0&&F(this,Ot)[t]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,We)[t])&&(yield[F(this,Ot)[t],F(this,We)[t]])}*keys(){for(const t of Ee(this,ve,ra).call(this)){const n=F(this,Ot)[t];n!==void 0&&!Ee(this,ve,Bt).call(this,F(this,We)[t])&&(yield n)}}*rkeys(){for(const t of Ee(this,ve,ia).call(this)){const n=F(this,Ot)[t];n!==void 0&&!Ee(this,ve,Bt).call(this,F(this,We)[t])&&(yield n)}}*values(){for(const t of Ee(this,ve,ra).call(this))F(this,We)[t]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,We)[t])&&(yield F(this,We)[t])}*rvalues(){for(const t of Ee(this,ve,ia).call(this))F(this,We)[t]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,We)[t])&&(yield F(this,We)[t])}[(xk=Symbol.iterator,yk=Symbol.toStringTag,xk)](){return this.entries()}find(t,n={}){for(const r of Ee(this,ve,ra).call(this)){const i=F(this,We)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&t(o,F(this,Ot)[r],this))return this.get(F(this,Ot)[r],n)}}forEach(t,n=this){for(const r of Ee(this,ve,ra).call(this)){const i=F(this,We)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&t.call(n,o,F(this,Ot)[r],this)}}rforEach(t,n=this){for(const r of Ee(this,ve,ia).call(this)){const i=F(this,We)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&t.call(n,o,F(this,Ot)[r],this)}}purgeStale(){let t=!1;for(const n of Ee(this,ve,ia).call(this,{allowStale:!0}))F(this,Gr).call(this,n)&&(Ee(this,ve,oa).call(this,F(this,Ot)[n],"expire"),t=!0);return t}info(t){const n=F(this,cn).get(t);if(n===void 0)return;const r=F(this,We)[n],i=Ee(this,ve,Bt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(F(this,Vr)&&F(this,Bi)){const s=F(this,Vr)[n],a=F(this,Bi)[n];if(s&&a){const l=s-(ql.now()-a);o.ttl=l,o.start=Date.now()}}return F(this,Ni)&&(o.size=F(this,Ni)[n]),o}dump(){const t=[];for(const n of Ee(this,ve,ra).call(this,{allowStale:!0})){const r=F(this,Ot)[n],i=F(this,We)[n],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const s={value:o};if(F(this,Vr)&&F(this,Bi)){s.ttl=F(this,Vr)[n];const a=ql.now()-F(this,Bi)[n];s.start=Math.floor(Date.now()-a)}F(this,Ni)&&(s.size=F(this,Ni)[n]),t.unshift([r,s])}return t}load(t){this.clear();for(const[n,r]of t){if(r.start){const i=Date.now()-r.start;r.start=ql.now()-i}this.set(n,r.value,r)}}set(t,n,r={}){var f,h,p,g,C;if(n===void 0)return this.delete(t),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:l}=r;let{noUpdateTTL:c=this.noUpdateTTL}=r;const u=F(this,pf).call(this,t,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),Ee(this,ve,oa).call(this,t,"set"),this;let d=F(this,pn)===0?void 0:F(this,cn).get(t);if(d===void 0)d=F(this,pn)===0?F(this,wn):F(this,Pi).length!==0?F(this,Pi).pop():F(this,pn)===F(this,Ti)?Ee(this,ve,Ph).call(this,!1):F(this,pn),F(this,Ot)[d]=t,F(this,We)[d]=n,F(this,cn).set(t,d),F(this,nr)[F(this,wn)]=d,F(this,Ur)[d]=F(this,wn),Oe(this,wn,d),Of(this,pn)._++,F(this,Mc).call(this,d,u,l),l&&(l.set="add"),c=!1;else{Ee(this,ve,td).call(this,d);const v=F(this,We)[d];if(n!==v){if(F(this,ha)&&Ee(this,ve,Bt).call(this,v)){v.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:m}=v;m!==void 0&&!s&&(F(this,Oi)&&((f=F(this,Ri))==null||f.call(this,m,t,"set")),F(this,rr)&&((h=F(this,Sn))==null||h.push([m,t,"set"])))}else s||(F(this,Oi)&&((p=F(this,Ri))==null||p.call(this,v,t,"set")),F(this,rr)&&((g=F(this,Sn))==null||g.push([v,t,"set"])));if(F(this,fl).call(this,d),F(this,Mc).call(this,d,u,l),F(this,We)[d]=n,l){l.set="replace";const m=v&&Ee(this,ve,Bt).call(this,v)?v.__staleWhileFetching:v;m!==void 0&&(l.oldValue=m)}}else l&&(l.set="update")}if(i!==0&&!F(this,Vr)&&Ee(this,ve,CC).call(this),F(this,Vr)&&(c||F(this,hf).call(this,d,i,o),l&&F(this,es).call(this,l,d)),!s&&F(this,rr)&&F(this,Sn)){const v=F(this,Sn);let m;for(;m=v==null?void 0:v.shift();)(C=F(this,_i))==null||C.call(this,...m)}return this}pop(){var t;try{for(;F(this,pn);){const n=F(this,We)[F(this,Zn)];if(Ee(this,ve,Ph).call(this,!0),Ee(this,ve,Bt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(F(this,rr)&&F(this,Sn)){const n=F(this,Sn);let r;for(;r=n==null?void 0:n.shift();)(t=F(this,_i))==null||t.call(this,...r)}}}has(t,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,o=F(this,cn).get(t);if(o!==void 0){const s=F(this,We)[o];if(Ee(this,ve,Bt).call(this,s)&&s.__staleWhileFetching===void 0)return!1;if(F(this,Gr).call(this,o))i&&(i.has="stale",F(this,es).call(this,i,o));else return r&&F(this,dl).call(this,o),i&&(i.has="hit",F(this,es).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(t,n={}){const{allowStale:r=this.allowStale}=n,i=F(this,cn).get(t);if(i===void 0||!r&&F(this,Gr).call(this,i))return;const o=F(this,We)[i];return Ee(this,ve,Bt).call(this,o)?o.__staleWhileFetching:o}async fetch(t,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:l=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:g,forceRefresh:C=!1,status:v,signal:m}=n;if(!F(this,ha))return v&&(v.fetch="get"),this.get(t,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:v});const y={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:l,sizeCalculation:c,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:v,signal:m};let x=F(this,cn).get(t);if(x===void 0){v&&(v.fetch="miss");const b=Ee(this,ve,Nh).call(this,t,x,y,g);return b.__returned=b}else{const b=F(this,We)[x];if(Ee(this,ve,Bt).call(this,b)){const T=r&&b.__staleWhileFetching!==void 0;return v&&(v.fetch="inflight",T&&(v.returnedStale=!0)),T?b.__staleWhileFetching:b.__returned=b}const k=F(this,Gr).call(this,x);if(!C&&!k)return v&&(v.fetch="hit"),Ee(this,ve,td).call(this,x),i&&F(this,dl).call(this,x),v&&F(this,es).call(this,v,x),b;const A=Ee(this,ve,Nh).call(this,t,x,y,g),D=A.__staleWhileFetching!==void 0&&r;return v&&(v.fetch=k?"stale":"refresh",D&&k&&(v.returnedStale=!0)),D?A.__staleWhileFetching:A.__returned=A}}async forceFetch(t,n={}){const r=await this.fetch(t,n);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(t,n={}){const r=F(this,Fc);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...s}=n,a=this.get(t,s);if(!o&&a!==void 0)return a;const l=r(t,a,{options:s,context:i});return this.set(t,l,s),l}get(t,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=n,a=F(this,cn).get(t);if(a!==void 0){const l=F(this,We)[a],c=Ee(this,ve,Bt).call(this,l);return s&&F(this,es).call(this,s,a),F(this,Gr).call(this,a)?(s&&(s.get="stale"),c?(s&&r&&l.__staleWhileFetching!==void 0&&(s.returnedStale=!0),r?l.__staleWhileFetching:void 0):(o||Ee(this,ve,oa).call(this,t,"expire"),s&&r&&(s.returnedStale=!0),r?l:void 0)):(s&&(s.get="hit"),c?l.__staleWhileFetching:(Ee(this,ve,td).call(this,a),i&&F(this,dl).call(this,a),l))}else s&&(s.get="miss")}delete(t){return Ee(this,ve,oa).call(this,t,"delete")}clear(){return Ee(this,ve,IC).call(this,"delete")}};Ti=new WeakMap,Lr=new WeakMap,Ri=new WeakMap,_i=new WeakMap,Oc=new WeakMap,Fc=new WeakMap,pn=new WeakMap,Di=new WeakMap,cn=new WeakMap,Ot=new WeakMap,We=new WeakMap,nr=new WeakMap,Ur=new WeakMap,Zn=new WeakMap,wn=new WeakMap,Pi=new WeakMap,Sn=new WeakMap,Ni=new WeakMap,Bi=new WeakMap,Vr=new WeakMap,Oi=new WeakMap,ha=new WeakMap,rr=new WeakMap,ve=new WeakSet,CC=function(){const t=new Dh(F(this,Ti)),n=new Dh(F(this,Ti));Oe(this,Vr,t),Oe(this,Bi,n),Oe(this,hf,(o,s,a=ql.now())=>{if(n[o]=s!==0?a:0,t[o]=s,s!==0&&this.ttlAutopurge){const l=setTimeout(()=>{F(this,Gr).call(this,o)&&Ee(this,ve,oa).call(this,F(this,Ot)[o],"expire")},s+1);l.unref&&l.unref()}}),Oe(this,dl,o=>{n[o]=t[o]!==0?ql.now():0}),Oe(this,es,(o,s)=>{if(t[s]){const a=t[s],l=n[s];if(!a||!l)return;o.ttl=a,o.start=l,o.now=r||i();const c=o.now-l;o.remainingTTL=a-c}});let r=0;const i=()=>{const o=ql.now();if(this.ttlResolution>0){r=o;const s=setTimeout(()=>r=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{const s=F(this,cn).get(o);if(s===void 0)return 0;const a=t[s],l=n[s];if(!a||!l)return 1/0;const c=(r||i())-l;return a-c},Oe(this,Gr,o=>{const s=n[o],a=t[o];return!!a&&!!s&&(r||i())-s>a})},dl=new WeakMap,es=new WeakMap,hf=new WeakMap,Gr=new WeakMap,xR=function(){const t=new Dh(F(this,Ti));Oe(this,Di,0),Oe(this,Ni,t),Oe(this,fl,n=>{Oe(this,Di,F(this,Di)-t[n]),t[n]=0}),Oe(this,pf,(n,r,i,o)=>{if(Ee(this,ve,Bt).call(this,r))return 0;if(!na(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,n),!na(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Oe(this,Mc,(n,r,i)=>{if(t[n]=r,F(this,Lr)){const o=F(this,Lr)-t[n];for(;F(this,Di)>o;)Ee(this,ve,Ph).call(this,!0)}Oe(this,Di,F(this,Di)+t[n]),i&&(i.entrySize=r,i.totalCalculatedSize=F(this,Di))})},fl=new WeakMap,Mc=new WeakMap,pf=new WeakMap,ra=function*({allowStale:t=this.allowStale}={}){if(F(this,pn))for(let n=F(this,wn);!(!Ee(this,ve,yC).call(this,n)||((t||!F(this,Gr).call(this,n))&&(yield n),n===F(this,Zn)));)n=F(this,Ur)[n]},ia=function*({allowStale:t=this.allowStale}={}){if(F(this,pn))for(let n=F(this,Zn);!(!Ee(this,ve,yC).call(this,n)||((t||!F(this,Gr).call(this,n))&&(yield n),n===F(this,wn)));)n=F(this,nr)[n]},yC=function(t){return t!==void 0&&F(this,cn).get(F(this,Ot)[t])===t},Ph=function(t){var o,s;const n=F(this,Zn),r=F(this,Ot)[n],i=F(this,We)[n];return F(this,ha)&&Ee(this,ve,Bt).call(this,i)?i.__abortController.abort(new Error("evicted")):(F(this,Oi)||F(this,rr))&&(F(this,Oi)&&((o=F(this,Ri))==null||o.call(this,i,r,"evict")),F(this,rr)&&((s=F(this,Sn))==null||s.push([i,r,"evict"]))),F(this,fl).call(this,n),t&&(F(this,Ot)[n]=void 0,F(this,We)[n]=void 0,F(this,Pi).push(n)),F(this,pn)===1?(Oe(this,Zn,Oe(this,wn,0)),F(this,Pi).length=0):Oe(this,Zn,F(this,nr)[n]),F(this,cn).delete(r),Of(this,pn)._--,n},Nh=function(t,n,r,i){const o=n===void 0?void 0:F(this,We)[n];if(Ee(this,ve,Bt).call(this,o))return o;const s=new V0,{signal:a}=r;a==null||a.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});const l={signal:s.signal,options:r,context:i},c=(g,C=!1)=>{const{aborted:v}=s.signal,m=r.ignoreFetchAbort&&g!==void 0;if(r.status&&(v&&!C?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,m&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),v&&!m&&!C)return d(s.signal.reason);const y=h;return F(this,We)[n]===h&&(g===void 0?y.__staleWhileFetching?F(this,We)[n]=y.__staleWhileFetching:Ee(this,ve,oa).call(this,t,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(t,g,l.options))),g},u=g=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=g),d(g)),d=g=>{const{aborted:C}=s.signal,v=C&&r.allowStaleOnFetchAbort,m=v||r.allowStaleOnFetchRejection,y=m||r.noDeleteOnFetchRejection,x=h;if(F(this,We)[n]===h&&(!y||x.__staleWhileFetching===void 0?Ee(this,ve,oa).call(this,t,"fetch"):v||(F(this,We)[n]=x.__staleWhileFetching)),m)return r.status&&x.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),x.__staleWhileFetching;if(x.__returned===x)throw g},f=(g,C)=>{var m;const v=(m=F(this,Oc))==null?void 0:m.call(this,t,o,l);v&&v instanceof Promise&&v.then(y=>g(y===void 0?void 0:y),C),s.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(g(void 0),r.allowStaleOnFetchAbort&&(g=y=>c(y,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(c,u),p=Object.assign(h,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return n===void 0?(this.set(t,p,{...l.options,status:void 0}),n=F(this,cn).get(t)):F(this,We)[n]=p,p},Bt=function(t){if(!F(this,ha))return!1;const n=t;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof V0},xC=function(t,n){F(this,Ur)[n]=t,F(this,nr)[t]=n},td=function(t){t!==F(this,wn)&&(t===F(this,Zn)?Oe(this,Zn,F(this,nr)[t]):Ee(this,ve,xC).call(this,F(this,Ur)[t],F(this,nr)[t]),Ee(this,ve,xC).call(this,F(this,wn),t),Oe(this,wn,t))},oa=function(t,n){var i,o,s,a;let r=!1;if(F(this,pn)!==0){const l=F(this,cn).get(t);if(l!==void 0)if(r=!0,F(this,pn)===1)Ee(this,ve,IC).call(this,n);else{F(this,fl).call(this,l);const c=F(this,We)[l];if(Ee(this,ve,Bt).call(this,c)?c.__abortController.abort(new Error("deleted")):(F(this,Oi)||F(this,rr))&&(F(this,Oi)&&((i=F(this,Ri))==null||i.call(this,c,t,n)),F(this,rr)&&((o=F(this,Sn))==null||o.push([c,t,n]))),F(this,cn).delete(t),F(this,Ot)[l]=void 0,F(this,We)[l]=void 0,l===F(this,wn))Oe(this,wn,F(this,Ur)[l]);else if(l===F(this,Zn))Oe(this,Zn,F(this,nr)[l]);else{const u=F(this,Ur)[l];F(this,nr)[u]=F(this,nr)[l];const d=F(this,nr)[l];F(this,Ur)[d]=F(this,Ur)[l]}Of(this,pn)._--,F(this,Pi).push(l)}}if(F(this,rr)&&((s=F(this,Sn))!=null&&s.length)){const l=F(this,Sn);let c;for(;c=l==null?void 0:l.shift();)(a=F(this,_i))==null||a.call(this,...c)}return r},IC=function(t){var n,r,i;for(const o of Ee(this,ve,ia).call(this,{allowStale:!0})){const s=F(this,We)[o];if(Ee(this,ve,Bt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const a=F(this,Ot)[o];F(this,Oi)&&((n=F(this,Ri))==null||n.call(this,s,a,t)),F(this,rr)&&((r=F(this,Sn))==null||r.push([s,a,t]))}}if(F(this,cn).clear(),F(this,We).fill(void 0),F(this,Ot).fill(void 0),F(this,Vr)&&F(this,Bi)&&(F(this,Vr).fill(0),F(this,Bi).fill(0)),F(this,Ni)&&F(this,Ni).fill(0),Oe(this,Zn,0),Oe(this,wn,0),F(this,Pi).length=0,Oe(this,Di,0),Oe(this,pn,0),F(this,rr)&&F(this,Sn)){const o=F(this,Sn);let s;for(;s=o==null?void 0:o.shift();)(i=F(this,_i))==null||i.call(this,...s)}};let vC=eI;function v9(e){const t=e.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!t)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+e+"`"),null;const n=t[1],r=t[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(t[3]);){const a=s[1]||s[3],l=s[2]||s[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=l}return{name:n,authKey:r,keyvals:i}}function aA(e){const t=e.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!t)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+e+"`"),null;const n=t[1]||t[4],r=void 0,i=t[2],o=t[3],s={};return s[i]=o,{name:n,authKey:r,keyvals:s}}function lA(){return(Math.random()+1).toString(36).substring(3,9)}class du{constructor(t){M(this,"packageName");M(this,"minVersion",1);M(this,"maxVersion",1);M(this,"packageVersion",0);M(this,"client");this.client=t}handle(t){throw new Error("Method not implemented.")}handleMultiline(t){throw new Error("Method not implemented.")}closeMultiline(t){throw new Error("Method not implemented.")}shutdown(){}send(t,n){t.startsWith(this.packageName)||(t=this.packageName+"-"+t),this.client.sendMcp(t,n)}}class C9 extends du{constructor(){super(...arguments);M(this,"packageName","mcp-negotiate");M(this,"minVersion",2);M(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(n=i.minVersion)==null?void 0:n.toFixed(1),s=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":s})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class y9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class x9 extends du{constructor(n){super(n);M(this,"packageName","dns-org-mud-moo-simpleedit");M(this,"currentSession",null)}handle(n){n.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){this.currentSession&&"content"in n.keyvals?this.currentSession.contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class I9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-awns-getset");M(this,"id",1);M(this,"cache",new vC({max:10}));M(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class b9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-vmoo-userlist");M(this,"maxVersion",1.1);M(this,"player");M(this,"fields",["Object","Name","Icon"]);M(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);M(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=Ai(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=Ai(n.keyvals.icons.trim())),"d"in n.keyvals){const o=n.keyvals.d[0];switch(o){case"=":var r=Ai(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(Ai(n.keyvals.d.slice(1))));break;case"-":var i=Ai(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const s=this.playerFromArray(Ai(n.keyvals.d.slice(1)));this.updatePlayer(s);break;case"<":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!0,this.players[l]=a)});break;case">":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!1,this.players[l]=a)});break;case"[":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!0,this.players[l]=a)});break;case"]":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!1,this.players[l]=a)});break;default:console.log(`Unknown userlist mode ${o} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function Ai(e){e=e.slice(1,-1);let t=[],n="",r=0;for(let o=0;o<e.length;o++){const s=e[o];if(s==="{")r++;else if(s==="}")r--;else if(s===","&&r===0){i(),n="";continue}n+=s}return n.length>0&&i(),t;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?t.push(Ai(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?t.push(n.slice(1,-1)):t.push(n):t.push(Number(n))}}class A9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-awns-ping");M(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}var bC=(e=>(e.Off="off",e.Unfocused="unfocused",e.All="all",e))(bC||{}),Lo=(e=>(e.SetGeneral="SET_GENERAL",e.SetSpeech="SET_SPEECH",e.SetChannels="SET_CHANNELS",e.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",e.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",e))(Lo||{});class w9{constructor(){M(this,"state");M(this,"listeners",new Set);M(this,"dispatch",t=>{this.state=this.reducer(this.state,t),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const t=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=t?this.mergePreferences(n,JSON.parse(t)):n}getInitialPreferences(){return{general:{localEcho:!1,volume:1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(t,n){return{...t,general:{...t.general,...n.general},speech:{...t.speech,...n.speech},channels:n.channels?{...t.channels,...n.channels}:t.channels,editor:{...t.editor,...n.editor}}}reducer(t,n){switch(n.type){case"SET_GENERAL":return{...t,general:n.data};case"SET_SPEECH":return{...t,speech:n.data};case"SET_CHANNELS":return{...t,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...t,editor:{...t.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...t,editor:{...t.editor,accessibilityMode:n.data}};default:return t}}getState(){return this.state}subscribe(t){return this.listeners.add(t),()=>{this.listeners.delete(t)}}}const Yr=new w9;class S9 extends _p{constructor(n){super();M(this,"peerConnection",null);M(this,"dataChannel",null);M(this,"client");M(this,"connectionTimeout",3e5);M(this,"connectionTimeoutId");M(this,"recipient","");M(this,"pendingCandidates",[]);M(this,"remoteOfferReceived",!1);this.client=n}isDataChannelOpen(){return this.dataChannel!==null&&this.dataChannel.readyState==="open"}async createPeerConnection(){try{const n={iceServers:[{urls:["turn:mongoose.world:3478","stun:mongoose.world:3478"],username:"p2p",credential:"p2p"},{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(n),this.peerConnection.onconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.connectionState;switch(console.log("[WebRTCService] Connection state changed to:",r),this.emit("webRTCStateChange",`Connection: ${r}`),r){case"connected":console.log("[WebRTCService] Peer connection established successfully"),this.emit("webRTCConnected");break;case"disconnected":console.log("[WebRTCService] Connection temporarily disconnected"),this.emit("webRTCDisconnected"),setTimeout(()=>{var o;((o=this.peerConnection)==null?void 0:o.connectionState)==="disconnected"&&this.attemptRecovery()},5e3);break;case"failed":console.log("[WebRTCService] Connection failed - attempting immediate recovery"),this.attemptRecovery();break}},this.peerConnection.oniceconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceConnectionState;console.log("[WebRTCService] ICE connection state changed to:",r),this.emit("webRTCStateChange",`ICE: ${r}`),r==="failed"&&(console.log("[WebRTCService] ICE connection failed"),this.attemptRecovery())},this.peerConnection.onsignalingstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.signalingState;console.log("[WebRTCService] Signaling state changed to:",r),this.emit("webRTCStateChange",`Signaling: ${r}`),r==="stable"&&console.log("[WebRTCService] Signaling completed successfully")},this.peerConnection.onicegatheringstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceGatheringState;console.log("[WebRTCService] ICE gathering state changed to:",r),this.emit("webRTCStateChange",`ICE Gathering: ${r}`),r==="complete"&&(console.log("[WebRTCService] ICE gathering completed"),this.emit("iceGatheringComplete"))},this.peerConnection.onicecandidate=r=>{r.candidate?(console.debug("[WebRTCService] New ICE candidate:",{type:r.candidate.type,protocol:r.candidate.protocol,address:r.candidate.address,port:r.candidate.port}),this.recipient&&this.client.gmcp_fileTransfer.sendCandidate(this.recipient,r.candidate)):console.log("[WebRTCService] ICE gathering complete")},this.peerConnection.ondatachannel=r=>{console.log("[WebRTCService] Received data channel"),this.dataChannel=r.channel,this.setupDataChannel()},this.dataChannel||(console.log("[WebRTCService] Creating data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(n){throw console.error("Error creating peer connection:",n),n}}setupDataChannel(){this.dataChannel&&(this.dataChannel.onopen=()=>{var n;console.log("[WebRTCService] Data channel opened with state:",(n=this.dataChannel)==null?void 0:n.readyState),this.emit("dataChannelOpen")},this.dataChannel.onclose=()=>{console.log("[WebRTCService] Data channel closed"),this.emit("dataChannelClose")},this.dataChannel.onerror=n=>{console.error("[WebRTCService] Data channel error:",n),this.emit("dataChannelError",n)},this.dataChannel.onmessage=n=>{n.data instanceof ArrayBuffer&&this.emit("dataChannelMessage",n.data)})}async attemptRecovery(){try{console.log("[WebRTCService] Attempting connection recovery"),this.close(),await new Promise(n=>setTimeout(n,1e3)),await this.createPeerConnection(),console.log("[WebRTCService] Recovery attempt completed")}catch(n){console.error("[WebRTCService] Recovery attempt failed:",n)}}async attemptChannelRecovery(){var n;try{this.dataChannel=((n=this.peerConnection)==null?void 0:n.createDataChannel("fileTransfer"))??null,this.setupDataChannel()}catch(r){console.error("Failed to recover data channel:",r),this.emit("dataChannelRecoveryFailed",r)}}async sendData(n){if(!this.dataChannel)throw new Error("Data channel not initialized");if(this.dataChannel.readyState!=="open")throw new Error("Data channel is not open");try{for(;this.dataChannel.bufferedAmount>1048576;)await new Promise(i=>{var s;const o=()=>{var a;(a=this.dataChannel)==null||a.removeEventListener("bufferedamountlow",o),i()};(s=this.dataChannel)==null||s.addEventListener("bufferedamountlow",o),this.dataChannel.bufferedAmountLowThreshold=1048576/2});this.dataChannel.send(n)}catch(r){throw console.error("[WebRTCService] Error sending data:",r),r}}async createOffer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const n=await this.peerConnection.createOffer();return await this.peerConnection.setLocalDescription(n),n}catch(n){throw console.error("Error creating offer:",n),n}}async createAnswer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const n=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(n),n}catch(n){throw console.error("Error creating answer:",n),n}}async handleAnswer(n){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{console.log("[WebRTCService] Received WebRTC answer:",n),console.log("[WebRTCService] Current connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Current signaling state:",this.peerConnection.signalingState),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),console.log("[WebRTCService] Remote description set successfully"),console.log("[WebRTCService] Updated connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Updated signaling state:",this.peerConnection.signalingState),this.pendingCandidates.length>0?(console.log(`[WebRTCService] Adding ${this.pendingCandidates.length} pending ICE candidates`),await Promise.all(this.pendingCandidates.map(async(r,i)=>{console.log(`[WebRTCService] Adding ICE candidate ${i+1}/${this.pendingCandidates.length}`),await this.peerConnection.addIceCandidate(new RTCIceCandidate(r))})),console.log("[WebRTCService] All pending ICE candidates added successfully"),this.pendingCandidates=[]):console.log("[WebRTCService] No pending ICE candidates to add")}catch(r){throw console.error("Error handling answer:",r),r}}async handleIceCandidate(n){if(!this.peerConnection||!this.peerConnection.remoteDescription){console.log("[WebRTCService] Storing ICE candidate until peer connection is ready"),this.pendingCandidates.push(n);return}try{console.log("[WebRTCService] Adding ICE candidate immediately"),await this.peerConnection.addIceCandidate(new RTCIceCandidate(n))}catch(r){throw console.error("Error handling ICE candidate:",r),r}}async reconnect(){this.close(),await this.createPeerConnection(),this.emit("webRTCReconnecting")}cleanup(){this.connectionTimeoutId&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0),this.close()}close(){this.pendingCandidates=[],this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.emit("webRTCClosed")}async waitForConnection(){return new Promise((n,r)=>{if(this.connectionTimeoutId=window.setTimeout(()=>{s(),r(new Error("Connection timeout"))},this.connectionTimeout),this.isDataChannelOpen())return clearTimeout(this.connectionTimeoutId),n();const i=()=>{clearTimeout(this.connectionTimeoutId),s(),n()},o=()=>{var l;((l=this.peerConnection)==null?void 0:l.connectionState)==="failed"&&(clearTimeout(this.connectionTimeoutId),s(),r(new Error("Connection failed")))},s=()=>{this.dataChannel&&this.dataChannel.removeEventListener("open",i),this.peerConnection&&this.peerConnection.removeEventListener("connectionstatechange",o),this.off("dataChannelOpen",i),this.off("webRTCFailed",a)},a=()=>{clearTimeout(this.connectionTimeoutId),s(),r(new Error("Connection failed"))};this.dataChannel&&this.dataChannel.addEventListener("open",i),this.peerConnection&&this.peerConnection.addEventListener("connectionstatechange",o),this.on("dataChannelOpen",i),this.on("webRTCFailed",a)})}isPeerConnectionInitialized(){var n;return console.log("[WebRTCService] Peer connection state:",(n=this.peerConnection)==null?void 0:n.connectionState),this.peerConnection!==null&&this.peerConnection.connectionState!=="closed"}hasRemoteOffer(){return this.remoteOfferReceived}async waitForRemoteOffer(n=3e4){return console.log("[WebRTCService] Waiting for remote offer..."),new Promise((r,i)=>{const o=setTimeout(()=>{a(),console.log("[WebRTCService] Timeout waiting for remote offer"),i(new Error("Timeout waiting for remote offer"))},n),s=()=>{console.log("[WebRTCService] Remote offer received"),clearTimeout(o),a(),r()},a=()=>{this.client.off("remoteOfferReceived",s)};if(this.remoteOfferReceived){console.log("[WebRTCService] Remote offer already received"),clearTimeout(o),r();return}this.client.on("remoteOfferReceived",s)})}async handleOffer(n){console.log("[WebRTCService] Handling WebRTC offer:",n),this.peerConnection||(console.log("[WebRTCService] Creating new peer connection for offer"),await this.createPeerConnection());try{if(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),this.remoteOfferReceived=!0,this.client.emit("remoteOfferReceived"),console.log("[WebRTCService] Remote offer set successfully"),this.pendingCandidates.length>0){console.log(`[WebRTCService] Processing ${this.pendingCandidates.length} pending ICE candidates`);const r=[...this.pendingCandidates];this.pendingCandidates=[];for(const i of r)try{await this.peerConnection.addIceCandidate(new RTCIceCandidate(i)),console.log("[WebRTCService] Successfully added pending ICE candidate")}catch(o){console.warn("[WebRTCService] Failed to add pending ICE candidate:",o)}}}catch(r){throw console.error("[WebRTCService] Error handling offer:",r),r}}}var IR={exports:{}};function k9(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Mg={exports:{}};const E9={},T9=Object.freeze(Object.defineProperty({__proto__:null,default:E9},Symbol.toStringTag,{value:"Module"})),R9=j3(T9);var cA;function it(){return cA||(cA=1,function(e,t){(function(n,r){e.exports=r()})(Ze,function(){var n=n||function(r,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Ze<"u"&&Ze.crypto&&(o=Ze.crypto),!o&&typeof k9=="function")try{o=R9}catch{}var s=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function m(){}return function(y){var x;return m.prototype=y,x=new m,m.prototype=null,x}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(m){var y=a(this);return m&&y.mixIn(m),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var m=this.extend();return m.init.apply(m,arguments),m},init:function(){},mixIn:function(m){for(var y in m)m.hasOwnProperty(y)&&(this[y]=m[y]);m.hasOwnProperty("toString")&&(this.toString=m.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=c.WordArray=u.extend({init:function(m,y){m=this.words=m||[],y!=i?this.sigBytes=y:this.sigBytes=m.length*4},toString:function(m){return(m||h).stringify(this)},concat:function(m){var y=this.words,x=m.words,b=this.sigBytes,k=m.sigBytes;if(this.clamp(),b%4)for(var A=0;A<k;A++){var E=x[A>>>2]>>>24-A%4*8&255;y[b+A>>>2]|=E<<24-(b+A)%4*8}else for(var D=0;D<k;D+=4)y[b+D>>>2]=x[D>>>2];return this.sigBytes+=k,this},clamp:function(){var m=this.words,y=this.sigBytes;m[y>>>2]&=4294967295<<32-y%4*8,m.length=r.ceil(y/4)},clone:function(){var m=u.clone.call(this);return m.words=this.words.slice(0),m},random:function(m){for(var y=[],x=0;x<m;x+=4)y.push(s());return new d.init(y,m)}}),f=l.enc={},h=f.Hex={stringify:function(m){for(var y=m.words,x=m.sigBytes,b=[],k=0;k<x;k++){var A=y[k>>>2]>>>24-k%4*8&255;b.push((A>>>4).toString(16)),b.push((A&15).toString(16))}return b.join("")},parse:function(m){for(var y=m.length,x=[],b=0;b<y;b+=2)x[b>>>3]|=parseInt(m.substr(b,2),16)<<24-b%8*4;return new d.init(x,y/2)}},p=f.Latin1={stringify:function(m){for(var y=m.words,x=m.sigBytes,b=[],k=0;k<x;k++){var A=y[k>>>2]>>>24-k%4*8&255;b.push(String.fromCharCode(A))}return b.join("")},parse:function(m){for(var y=m.length,x=[],b=0;b<y;b++)x[b>>>2]|=(m.charCodeAt(b)&255)<<24-b%4*8;return new d.init(x,y)}},g=f.Utf8={stringify:function(m){try{return decodeURIComponent(escape(p.stringify(m)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(m){return p.parse(unescape(encodeURIComponent(m)))}},C=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(m){typeof m=="string"&&(m=g.parse(m)),this._data.concat(m),this._nDataBytes+=m.sigBytes},_process:function(m){var y,x=this._data,b=x.words,k=x.sigBytes,A=this.blockSize,E=A*4,D=k/E;m?D=r.ceil(D):D=r.max((D|0)-this._minBufferSize,0);var T=D*A,R=r.min(T*4,k);if(T){for(var P=0;P<T;P+=A)this._doProcessBlock(b,P);y=b.splice(0,T),x.sigBytes-=R}return new d.init(y,R)},clone:function(){var m=u.clone.call(this);return m._data=this._data.clone(),m},_minBufferSize:0});c.Hasher=C.extend({cfg:u.extend(),init:function(m){this.cfg=this.cfg.extend(m),this.reset()},reset:function(){C.reset.call(this),this._doReset()},update:function(m){return this._append(m),this._process(),this},finalize:function(m){m&&this._append(m);var y=this._doFinalize();return y},blockSize:16,_createHelper:function(m){return function(y,x){return new m.init(x).finalize(y)}},_createHmacHelper:function(m){return function(y,x){return new v.HMAC.init(m,x).finalize(y)}}});var v=l.algo={};return l}(Math);return n})}(Mg)),Mg.exports}var Lg={exports:{}},uA;function Lp(){return uA||(uA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.Base,a=o.WordArray,l=i.x64={};l.Word=s.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=s.extend({init:function(c,u){c=this.words=c||[],u!=r?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,d=[],f=0;f<u;f++){var h=c[f];d.push(h.high),d.push(h.low)}return a.create(d,this.sigBytes)},clone:function(){for(var c=s.clone.call(this),u=c.words=this.words.slice(0),d=u.length,f=0;f<d;f++)u[f]=u[f].clone();return c}})}(),n})}(Lg)),Lg.exports}var Ug={exports:{}},dA;function _9(){return dA||(dA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(){if(typeof ArrayBuffer=="function"){var r=n,i=r.lib,o=i.WordArray,s=o.init,a=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],d=0;d<c;d++)u[d>>>2]|=l[d]<<24-d%4*8;s.call(this,u,c)}else s.apply(this,arguments)};a.prototype=o}}(),n.lib.WordArray})}(Ug)),Ug.exports}var Vg={exports:{}},fA;function D9(){return fA||(fA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Utf16=s.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],f=0;f<u;f+=2){var h=c[f>>>2]>>>16-f%4*8&65535;d.push(String.fromCharCode(h))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=l.charCodeAt(d)<<16-d%2*16;return o.create(u,c*2)}},s.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],f=0;f<u;f+=2){var h=a(c[f>>>2]>>>16-f%4*8&65535);d.push(String.fromCharCode(h))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=a(l.charCodeAt(d)<<16-d%2*16);return o.create(u,c*2)}};function a(l){return l<<8&4278255360|l>>>8&16711935}}(),n.enc.Utf16})}(Vg)),Vg.exports}var Gg={exports:{}},hA;function Gl(){return hA||(hA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,d=this._map;l.clamp();for(var f=[],h=0;h<u;h+=3)for(var p=c[h>>>2]>>>24-h%4*8&255,g=c[h+1>>>2]>>>24-(h+1)%4*8&255,C=c[h+2>>>2]>>>24-(h+2)%4*8&255,v=p<<16|g<<8|C,m=0;m<4&&h+m*.75<u;m++)f.push(d.charAt(v>>>6*(3-m)&63));var y=d.charAt(64);if(y)for(;f.length%4;)f.push(y);return f.join("")},parse:function(l){var c=l.length,u=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var f=0;f<u.length;f++)d[u.charCodeAt(f)]=f}var h=u.charAt(64);if(h){var p=l.indexOf(h);p!==-1&&(c=p)}return a(l,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(l,c,u){for(var d=[],f=0,h=0;h<c;h++)if(h%4){var p=u[l.charCodeAt(h-1)]<<h%4*2,g=u[l.charCodeAt(h)]>>>6-h%4*2,C=p|g;d[f>>>2]|=C<<24-f%4*8,f++}return o.create(d,f)}}(),n.enc.Base64})}(Gg)),Gg.exports}var Wg={exports:{}},pA;function P9(){return pA||(pA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,d=l.sigBytes,f=c?this._safe_map:this._map;l.clamp();for(var h=[],p=0;p<d;p+=3)for(var g=u[p>>>2]>>>24-p%4*8&255,C=u[p+1>>>2]>>>24-(p+1)%4*8&255,v=u[p+2>>>2]>>>24-(p+2)%4*8&255,m=g<<16|C<<8|v,y=0;y<4&&p+y*.75<d;y++)h.push(f.charAt(m>>>6*(3-y)&63));var x=f.charAt(64);if(x)for(;h.length%4;)h.push(x);return h.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,d=c?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<d.length;h++)f[d.charCodeAt(h)]=h}var p=d.charAt(64);if(p){var g=l.indexOf(p);g!==-1&&(u=g)}return a(l,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(l,c,u){for(var d=[],f=0,h=0;h<c;h++)if(h%4){var p=u[l.charCodeAt(h-1)]<<h%4*2,g=u[l.charCodeAt(h)]>>>6-h%4*2,C=p|g;d[f>>>2]|=C<<24-f%4*8,f++}return o.create(d,f)}}(),n.enc.Base64url})}(Wg)),Wg.exports}var jg={exports:{}},gA;function Wl(){return gA||(gA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=[];(function(){for(var g=0;g<64;g++)c[g]=r.abs(r.sin(g+1))*4294967296|0})();var u=l.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,C){for(var v=0;v<16;v++){var m=C+v,y=g[m];g[m]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var x=this._hash.words,b=g[C+0],k=g[C+1],A=g[C+2],E=g[C+3],D=g[C+4],T=g[C+5],R=g[C+6],P=g[C+7],L=g[C+8],z=g[C+9],Z=g[C+10],Q=g[C+11],ie=g[C+12],$=g[C+13],q=g[C+14],te=g[C+15],O=x[0],j=x[1],J=x[2],ee=x[3];O=d(O,j,J,ee,b,7,c[0]),ee=d(ee,O,j,J,k,12,c[1]),J=d(J,ee,O,j,A,17,c[2]),j=d(j,J,ee,O,E,22,c[3]),O=d(O,j,J,ee,D,7,c[4]),ee=d(ee,O,j,J,T,12,c[5]),J=d(J,ee,O,j,R,17,c[6]),j=d(j,J,ee,O,P,22,c[7]),O=d(O,j,J,ee,L,7,c[8]),ee=d(ee,O,j,J,z,12,c[9]),J=d(J,ee,O,j,Z,17,c[10]),j=d(j,J,ee,O,Q,22,c[11]),O=d(O,j,J,ee,ie,7,c[12]),ee=d(ee,O,j,J,$,12,c[13]),J=d(J,ee,O,j,q,17,c[14]),j=d(j,J,ee,O,te,22,c[15]),O=f(O,j,J,ee,k,5,c[16]),ee=f(ee,O,j,J,R,9,c[17]),J=f(J,ee,O,j,Q,14,c[18]),j=f(j,J,ee,O,b,20,c[19]),O=f(O,j,J,ee,T,5,c[20]),ee=f(ee,O,j,J,Z,9,c[21]),J=f(J,ee,O,j,te,14,c[22]),j=f(j,J,ee,O,D,20,c[23]),O=f(O,j,J,ee,z,5,c[24]),ee=f(ee,O,j,J,q,9,c[25]),J=f(J,ee,O,j,E,14,c[26]),j=f(j,J,ee,O,L,20,c[27]),O=f(O,j,J,ee,$,5,c[28]),ee=f(ee,O,j,J,A,9,c[29]),J=f(J,ee,O,j,P,14,c[30]),j=f(j,J,ee,O,ie,20,c[31]),O=h(O,j,J,ee,T,4,c[32]),ee=h(ee,O,j,J,L,11,c[33]),J=h(J,ee,O,j,Q,16,c[34]),j=h(j,J,ee,O,q,23,c[35]),O=h(O,j,J,ee,k,4,c[36]),ee=h(ee,O,j,J,D,11,c[37]),J=h(J,ee,O,j,P,16,c[38]),j=h(j,J,ee,O,Z,23,c[39]),O=h(O,j,J,ee,$,4,c[40]),ee=h(ee,O,j,J,b,11,c[41]),J=h(J,ee,O,j,E,16,c[42]),j=h(j,J,ee,O,R,23,c[43]),O=h(O,j,J,ee,z,4,c[44]),ee=h(ee,O,j,J,ie,11,c[45]),J=h(J,ee,O,j,te,16,c[46]),j=h(j,J,ee,O,A,23,c[47]),O=p(O,j,J,ee,b,6,c[48]),ee=p(ee,O,j,J,P,10,c[49]),J=p(J,ee,O,j,q,15,c[50]),j=p(j,J,ee,O,T,21,c[51]),O=p(O,j,J,ee,ie,6,c[52]),ee=p(ee,O,j,J,E,10,c[53]),J=p(J,ee,O,j,Z,15,c[54]),j=p(j,J,ee,O,k,21,c[55]),O=p(O,j,J,ee,L,6,c[56]),ee=p(ee,O,j,J,te,10,c[57]),J=p(J,ee,O,j,R,15,c[58]),j=p(j,J,ee,O,$,21,c[59]),O=p(O,j,J,ee,D,6,c[60]),ee=p(ee,O,j,J,Q,10,c[61]),J=p(J,ee,O,j,A,15,c[62]),j=p(j,J,ee,O,z,21,c[63]),x[0]=x[0]+O|0,x[1]=x[1]+j|0,x[2]=x[2]+J|0,x[3]=x[3]+ee|0},_doFinalize:function(){var g=this._data,C=g.words,v=this._nDataBytes*8,m=g.sigBytes*8;C[m>>>5]|=128<<24-m%32;var y=r.floor(v/4294967296),x=v;C[(m+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,C[(m+64>>>9<<4)+14]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,g.sigBytes=(C.length+1)*4,this._process();for(var b=this._hash,k=b.words,A=0;A<4;A++){var E=k[A];k[A]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}return b},clone:function(){var g=a.clone.call(this);return g._hash=this._hash.clone(),g}});function d(g,C,v,m,y,x,b){var k=g+(C&v|~C&m)+y+b;return(k<<x|k>>>32-x)+C}function f(g,C,v,m,y,x,b){var k=g+(C&m|v&~m)+y+b;return(k<<x|k>>>32-x)+C}function h(g,C,v,m,y,x,b){var k=g+(C^v^m)+y+b;return(k<<x|k>>>32-x)+C}function p(g,C,v,m,y,x,b){var k=g+(v^(C|~m))+y+b;return(k<<x|k>>>32-x)+C}i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),n.MD5})}(jg)),jg.exports}var zg={exports:{}},mA;function bR(){return mA||(mA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=i.Hasher,a=r.algo,l=[],c=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,d){for(var f=this._hash.words,h=f[0],p=f[1],g=f[2],C=f[3],v=f[4],m=0;m<80;m++){if(m<16)l[m]=u[d+m]|0;else{var y=l[m-3]^l[m-8]^l[m-14]^l[m-16];l[m]=y<<1|y>>>31}var x=(h<<5|h>>>27)+v+l[m];m<20?x+=(p&g|~p&C)+1518500249:m<40?x+=(p^g^C)+1859775393:m<60?x+=(p&g|p&C|g&C)-1894007588:x+=(p^g^C)-899497514,v=C,C=g,g=p<<30|p>>>2,p=h,h=x}f[0]=f[0]+h|0,f[1]=f[1]+p|0,f[2]=f[2]+g|0,f[3]=f[3]+C|0,f[4]=f[4]+v|0},_doFinalize:function(){var u=this._data,d=u.words,f=this._nDataBytes*8,h=u.sigBytes*8;return d[h>>>5]|=128<<24-h%32,d[(h+64>>>9<<4)+14]=Math.floor(f/4294967296),d[(h+64>>>9<<4)+15]=f,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=s.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=s._createHelper(c),r.HmacSHA1=s._createHmacHelper(c)}(),n.SHA1})}(zg)),zg.exports}var Hg={exports:{}},vA;function z1(){return vA||(vA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=[],u=[];(function(){function h(v){for(var m=r.sqrt(v),y=2;y<=m;y++)if(!(v%y))return!1;return!0}function p(v){return(v-(v|0))*4294967296|0}for(var g=2,C=0;C<64;)h(g)&&(C<8&&(c[C]=p(r.pow(g,1/2))),u[C]=p(r.pow(g,1/3)),C++),g++})();var d=[],f=l.SHA256=a.extend({_doReset:function(){this._hash=new s.init(c.slice(0))},_doProcessBlock:function(h,p){for(var g=this._hash.words,C=g[0],v=g[1],m=g[2],y=g[3],x=g[4],b=g[5],k=g[6],A=g[7],E=0;E<64;E++){if(E<16)d[E]=h[p+E]|0;else{var D=d[E-15],T=(D<<25|D>>>7)^(D<<14|D>>>18)^D>>>3,R=d[E-2],P=(R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10;d[E]=T+d[E-7]+P+d[E-16]}var L=x&b^~x&k,z=C&v^C&m^v&m,Z=(C<<30|C>>>2)^(C<<19|C>>>13)^(C<<10|C>>>22),Q=(x<<26|x>>>6)^(x<<21|x>>>11)^(x<<7|x>>>25),ie=A+Q+L+u[E]+d[E],$=Z+z;A=k,k=b,b=x,x=y+ie|0,y=m,m=v,v=C,C=ie+$|0}g[0]=g[0]+C|0,g[1]=g[1]+v|0,g[2]=g[2]+m|0,g[3]=g[3]+y|0,g[4]=g[4]+x|0,g[5]=g[5]+b|0,g[6]=g[6]+k|0,g[7]=g[7]+A|0},_doFinalize:function(){var h=this._data,p=h.words,g=this._nDataBytes*8,C=h.sigBytes*8;return p[C>>>5]|=128<<24-C%32,p[(C+64>>>9<<4)+14]=r.floor(g/4294967296),p[(C+64>>>9<<4)+15]=g,h.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var h=a.clone.call(this);return h._hash=this._hash.clone(),h}});i.SHA256=a._createHelper(f),i.HmacSHA256=a._createHmacHelper(f)}(Math),n.SHA256})}(Hg)),Hg.exports}var Zg={exports:{}},CA;function N9(){return CA||(CA=1,function(e,t){(function(n,r,i){e.exports=r(it(),z1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.algo,a=s.SHA256,l=s.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=a._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=a._createHelper(l),r.HmacSHA224=a._createHmacHelper(l)}(),n.SHA224})}(Zg)),Zg.exports}var $g={exports:{}},yA;function AR(){return yA||(yA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Lp())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Hasher,s=r.x64,a=s.Word,l=s.WordArray,c=r.algo;function u(){return a.create.apply(a,arguments)}var d=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],f=[];(function(){for(var p=0;p<80;p++)f[p]=u()})();var h=c.SHA512=o.extend({_doReset:function(){this._hash=new l.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(p,g){for(var C=this._hash.words,v=C[0],m=C[1],y=C[2],x=C[3],b=C[4],k=C[5],A=C[6],E=C[7],D=v.high,T=v.low,R=m.high,P=m.low,L=y.high,z=y.low,Z=x.high,Q=x.low,ie=b.high,$=b.low,q=k.high,te=k.low,O=A.high,j=A.low,J=E.high,ee=E.low,se=D,me=T,Be=R,ae=P,Dt=L,Gt=z,fn=Z,ze=Q,ot=ie,st=$,he=q,Ce=te,Ve=O,Ue=j,Pe=J,$e=ee,at=0;at<80;at++){var Qe,Wt,jt=f[at];if(at<16)Wt=jt.high=p[g+at*2]|0,Qe=jt.low=p[g+at*2+1]|0;else{var wt=f[at-15],an=wt.high,_=wt.low,I=(an>>>1|_<<31)^(an>>>8|_<<24)^an>>>7,w=(_>>>1|an<<31)^(_>>>8|an<<24)^(_>>>7|an<<25),B=f[at-2],W=B.high,Y=B.low,ne=(W>>>19|Y<<13)^(W<<3|Y>>>29)^W>>>6,Ne=(Y>>>19|W<<13)^(Y<<3|W>>>29)^(Y>>>6|W<<26),tt=f[at-7],lt=tt.high,ht=tt.low,nt=f[at-16],Ii=nt.high,io=nt.low;Qe=w+ht,Wt=I+lt+(Qe>>>0<w>>>0?1:0),Qe=Qe+Ne,Wt=Wt+ne+(Qe>>>0<Ne>>>0?1:0),Qe=Qe+io,Wt=Wt+Ii+(Qe>>>0<io>>>0?1:0),jt.high=Wt,jt.low=Qe}var Ka=ot&he^~ot&Ve,oi=st&Ce^~st&Ue,Iu=se&Be^se&Dt^Be&Dt,Hl=me&ae^me&Gt^ae&Gt,Yt=(se>>>28|me<<4)^(se<<30|me>>>2)^(se<<25|me>>>7),si=(me>>>28|se<<4)^(me<<30|se>>>2)^(me<<25|se>>>7),Xs=(ot>>>14|st<<18)^(ot>>>18|st<<14)^(ot<<23|st>>>9),Zo=(st>>>14|ot<<18)^(st>>>18|ot<<14)^(st<<23|ot>>>9),Ks=d[at],Zl=Ks.high,V=Ks.low,H=$e+Zo,K=Pe+Xs+(H>>>0<$e>>>0?1:0),H=H+oi,K=K+Ka+(H>>>0<oi>>>0?1:0),H=H+V,K=K+Zl+(H>>>0<V>>>0?1:0),H=H+Qe,K=K+Wt+(H>>>0<Qe>>>0?1:0),le=si+Hl,ge=Yt+Iu+(le>>>0<si>>>0?1:0);Pe=Ve,$e=Ue,Ve=he,Ue=Ce,he=ot,Ce=st,st=ze+H|0,ot=fn+K+(st>>>0<ze>>>0?1:0)|0,fn=Dt,ze=Gt,Dt=Be,Gt=ae,Be=se,ae=me,me=H+le|0,se=K+ge+(me>>>0<H>>>0?1:0)|0}T=v.low=T+me,v.high=D+se+(T>>>0<me>>>0?1:0),P=m.low=P+ae,m.high=R+Be+(P>>>0<ae>>>0?1:0),z=y.low=z+Gt,y.high=L+Dt+(z>>>0<Gt>>>0?1:0),Q=x.low=Q+ze,x.high=Z+fn+(Q>>>0<ze>>>0?1:0),$=b.low=$+st,b.high=ie+ot+($>>>0<st>>>0?1:0),te=k.low=te+Ce,k.high=q+he+(te>>>0<Ce>>>0?1:0),j=A.low=j+Ue,A.high=O+Ve+(j>>>0<Ue>>>0?1:0),ee=E.low=ee+$e,E.high=J+Pe+(ee>>>0<$e>>>0?1:0)},_doFinalize:function(){var p=this._data,g=p.words,C=this._nDataBytes*8,v=p.sigBytes*8;g[v>>>5]|=128<<24-v%32,g[(v+128>>>10<<5)+30]=Math.floor(C/4294967296),g[(v+128>>>10<<5)+31]=C,p.sigBytes=g.length*4,this._process();var m=this._hash.toX32();return m},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});r.SHA512=o._createHelper(h),r.HmacSHA512=o._createHmacHelper(h)}(),n.SHA512})}($g)),$g.exports}var Xg={exports:{}},xA;function B9(){return xA||(xA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Lp(),AR())})(Ze,function(n){return function(){var r=n,i=r.x64,o=i.Word,s=i.WordArray,a=r.algo,l=a.SHA512,c=a.SHA384=l.extend({_doReset:function(){this._hash=new s.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=l._createHelper(c),r.HmacSHA384=l._createHmacHelper(c)}(),n.SHA384})}(Xg)),Xg.exports}var Kg={exports:{}},IA;function O9(){return IA||(IA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Lp())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.x64,c=l.Word,u=i.algo,d=[],f=[],h=[];(function(){for(var C=1,v=0,m=0;m<24;m++){d[C+5*v]=(m+1)*(m+2)/2%64;var y=v%5,x=(2*C+3*v)%5;C=y,v=x}for(var C=0;C<5;C++)for(var v=0;v<5;v++)f[C+5*v]=v+(2*C+3*v)%5*5;for(var b=1,k=0;k<24;k++){for(var A=0,E=0,D=0;D<7;D++){if(b&1){var T=(1<<D)-1;T<32?E^=1<<T:A^=1<<T-32}b&128?b=b<<1^113:b<<=1}h[k]=c.create(A,E)}})();var p=[];(function(){for(var C=0;C<25;C++)p[C]=c.create()})();var g=u.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var C=this._state=[],v=0;v<25;v++)C[v]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(C,v){for(var m=this._state,y=this.blockSize/2,x=0;x<y;x++){var b=C[v+2*x],k=C[v+2*x+1];b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360;var A=m[x];A.high^=k,A.low^=b}for(var E=0;E<24;E++){for(var D=0;D<5;D++){for(var T=0,R=0,P=0;P<5;P++){var A=m[D+5*P];T^=A.high,R^=A.low}var L=p[D];L.high=T,L.low=R}for(var D=0;D<5;D++)for(var z=p[(D+4)%5],Z=p[(D+1)%5],Q=Z.high,ie=Z.low,T=z.high^(Q<<1|ie>>>31),R=z.low^(ie<<1|Q>>>31),P=0;P<5;P++){var A=m[D+5*P];A.high^=T,A.low^=R}for(var $=1;$<25;$++){var T,R,A=m[$],q=A.high,te=A.low,O=d[$];O<32?(T=q<<O|te>>>32-O,R=te<<O|q>>>32-O):(T=te<<O-32|q>>>64-O,R=q<<O-32|te>>>64-O);var j=p[f[$]];j.high=T,j.low=R}var J=p[0],ee=m[0];J.high=ee.high,J.low=ee.low;for(var D=0;D<5;D++)for(var P=0;P<5;P++){var $=D+5*P,A=m[$],se=p[$],me=p[(D+1)%5+5*P],Be=p[(D+2)%5+5*P];A.high=se.high^~me.high&Be.high,A.low=se.low^~me.low&Be.low}var A=m[0],ae=h[E];A.high^=ae.high,A.low^=ae.low}},_doFinalize:function(){var C=this._data,v=C.words;this._nDataBytes*8;var m=C.sigBytes*8,y=this.blockSize*32;v[m>>>5]|=1<<24-m%32,v[(r.ceil((m+1)/y)*y>>>5)-1]|=128,C.sigBytes=v.length*4,this._process();for(var x=this._state,b=this.cfg.outputLength/8,k=b/8,A=[],E=0;E<k;E++){var D=x[E],T=D.high,R=D.low;T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,A.push(R),A.push(T)}return new s.init(A,b)},clone:function(){for(var C=a.clone.call(this),v=C._state=this._state.slice(0),m=0;m<25;m++)v[m]=v[m].clone();return C}});i.SHA3=a._createHelper(g),i.HmacSHA3=a._createHmacHelper(g)}(Math),n.SHA3})}(Kg)),Kg.exports}var Jg={exports:{}},bA;function F9(){return bA||(bA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=s.create([0,1518500249,1859775393,2400959708,2840853838]),p=s.create([1352829926,1548603684,1836072691,2053994217,0]),g=l.RIPEMD160=a.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(k,A){for(var E=0;E<16;E++){var D=A+E,T=k[D];k[D]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var R=this._hash.words,P=h.words,L=p.words,z=c.words,Z=u.words,Q=d.words,ie=f.words,$,q,te,O,j,J,ee,se,me,Be;J=$=R[0],ee=q=R[1],se=te=R[2],me=O=R[3],Be=j=R[4];for(var ae,E=0;E<80;E+=1)ae=$+k[A+z[E]]|0,E<16?ae+=C(q,te,O)+P[0]:E<32?ae+=v(q,te,O)+P[1]:E<48?ae+=m(q,te,O)+P[2]:E<64?ae+=y(q,te,O)+P[3]:ae+=x(q,te,O)+P[4],ae=ae|0,ae=b(ae,Q[E]),ae=ae+j|0,$=j,j=O,O=b(te,10),te=q,q=ae,ae=J+k[A+Z[E]]|0,E<16?ae+=x(ee,se,me)+L[0]:E<32?ae+=y(ee,se,me)+L[1]:E<48?ae+=m(ee,se,me)+L[2]:E<64?ae+=v(ee,se,me)+L[3]:ae+=C(ee,se,me)+L[4],ae=ae|0,ae=b(ae,ie[E]),ae=ae+Be|0,J=Be,Be=me,me=b(se,10),se=ee,ee=ae;ae=R[1]+te+me|0,R[1]=R[2]+O+Be|0,R[2]=R[3]+j+J|0,R[3]=R[4]+$+ee|0,R[4]=R[0]+q+se|0,R[0]=ae},_doFinalize:function(){var k=this._data,A=k.words,E=this._nDataBytes*8,D=k.sigBytes*8;A[D>>>5]|=128<<24-D%32,A[(D+64>>>9<<4)+14]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,k.sigBytes=(A.length+1)*4,this._process();for(var T=this._hash,R=T.words,P=0;P<5;P++){var L=R[P];R[P]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}return T},clone:function(){var k=a.clone.call(this);return k._hash=this._hash.clone(),k}});function C(k,A,E){return k^A^E}function v(k,A,E){return k&A|~k&E}function m(k,A,E){return(k|~A)^E}function y(k,A,E){return k&E|A&~E}function x(k,A,E){return k^(A|~E)}function b(k,A){return k<<A|k>>>32-A}i.RIPEMD160=a._createHelper(g),i.HmacRIPEMD160=a._createHmacHelper(g)}(),n.RIPEMD160})}(Jg)),Jg.exports}var Yg={exports:{}},AA;function H1(){return AA||(AA=1,function(e,t){(function(n,r){e.exports=r(it())})(Ze,function(n){(function(){var r=n,i=r.lib,o=i.Base,s=r.enc,a=s.Utf8,l=r.algo;l.HMAC=o.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=a.parse(u));var d=c.blockSize,f=d*4;u.sigBytes>f&&(u=c.finalize(u)),u.clamp();for(var h=this._oKey=u.clone(),p=this._iKey=u.clone(),g=h.words,C=p.words,v=0;v<d;v++)g[v]^=1549556828,C[v]^=909522486;h.sigBytes=p.sigBytes=f,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,d=u.finalize(c);u.reset();var f=u.finalize(this._oKey.clone().concat(d));return f}})})()})}(Yg)),Yg.exports}var qg={exports:{}},wA;function M9(){return wA||(wA=1,function(e,t){(function(n,r,i){e.exports=r(it(),z1(),H1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Base,s=i.WordArray,a=r.algo,l=a.SHA256,c=a.HMAC,u=a.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,f){for(var h=this.cfg,p=c.create(h.hasher,d),g=s.create(),C=s.create([1]),v=g.words,m=C.words,y=h.keySize,x=h.iterations;v.length<y;){var b=p.update(f).finalize(C);p.reset();for(var k=b.words,A=k.length,E=b,D=1;D<x;D++){E=p.finalize(E),p.reset();for(var T=E.words,R=0;R<A;R++)k[R]^=T[R]}g.concat(b),m[0]++}return g.sigBytes=y*4,g}});r.PBKDF2=function(d,f,h){return u.create(h).compute(d,f)}}(),n.PBKDF2})}(qg)),qg.exports}var Qg={exports:{}},SA;function $a(){return SA||(SA=1,function(e,t){(function(n,r,i){e.exports=r(it(),bR(),H1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Base,s=i.WordArray,a=r.algo,l=a.MD5,c=a.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,d){for(var f,h=this.cfg,p=h.hasher.create(),g=s.create(),C=g.words,v=h.keySize,m=h.iterations;C.length<v;){f&&p.update(f),f=p.update(u).finalize(d),p.reset();for(var y=1;y<m;y++)f=p.finalize(f),p.reset();g.concat(f)}return g.sigBytes=v*4,g}});r.EvpKDF=function(u,d,f){return c.create(f).compute(u,d)}}(),n.EvpKDF})}(Qg)),Qg.exports}var em={exports:{}},kA;function Rn(){return kA||(kA=1,function(e,t){(function(n,r,i){e.exports=r(it(),$a())})(Ze,function(n){n.lib.Cipher||function(r){var i=n,o=i.lib,s=o.Base,a=o.WordArray,l=o.BufferedBlockAlgorithm,c=i.enc;c.Utf8;var u=c.Base64,d=i.algo,f=d.EvpKDF,h=o.Cipher=l.extend({cfg:s.extend(),createEncryptor:function(T,R){return this.create(this._ENC_XFORM_MODE,T,R)},createDecryptor:function(T,R){return this.create(this._DEC_XFORM_MODE,T,R)},init:function(T,R,P){this.cfg=this.cfg.extend(P),this._xformMode=T,this._key=R,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(T){return this._append(T),this._process()},finalize:function(T){T&&this._append(T);var R=this._doFinalize();return R},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function T(R){return typeof R=="string"?D:k}return function(R){return{encrypt:function(P,L,z){return T(L).encrypt(R,P,L,z)},decrypt:function(P,L,z){return T(L).decrypt(R,P,L,z)}}}}()});o.StreamCipher=h.extend({_doFinalize:function(){var T=this._process(!0);return T},blockSize:1});var p=i.mode={},g=o.BlockCipherMode=s.extend({createEncryptor:function(T,R){return this.Encryptor.create(T,R)},createDecryptor:function(T,R){return this.Decryptor.create(T,R)},init:function(T,R){this._cipher=T,this._iv=R}}),C=p.CBC=function(){var T=g.extend();T.Encryptor=T.extend({processBlock:function(P,L){var z=this._cipher,Z=z.blockSize;R.call(this,P,L,Z),z.encryptBlock(P,L),this._prevBlock=P.slice(L,L+Z)}}),T.Decryptor=T.extend({processBlock:function(P,L){var z=this._cipher,Z=z.blockSize,Q=P.slice(L,L+Z);z.decryptBlock(P,L),R.call(this,P,L,Z),this._prevBlock=Q}});function R(P,L,z){var Z,Q=this._iv;Q?(Z=Q,this._iv=r):Z=this._prevBlock;for(var ie=0;ie<z;ie++)P[L+ie]^=Z[ie]}return T}(),v=i.pad={},m=v.Pkcs7={pad:function(T,R){for(var P=R*4,L=P-T.sigBytes%P,z=L<<24|L<<16|L<<8|L,Z=[],Q=0;Q<L;Q+=4)Z.push(z);var ie=a.create(Z,L);T.concat(ie)},unpad:function(T){var R=T.words[T.sigBytes-1>>>2]&255;T.sigBytes-=R}};o.BlockCipher=h.extend({cfg:h.cfg.extend({mode:C,padding:m}),reset:function(){var T;h.reset.call(this);var R=this.cfg,P=R.iv,L=R.mode;this._xformMode==this._ENC_XFORM_MODE?T=L.createEncryptor:(T=L.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==T?this._mode.init(this,P&&P.words):(this._mode=T.call(L,this,P&&P.words),this._mode.__creator=T)},_doProcessBlock:function(T,R){this._mode.processBlock(T,R)},_doFinalize:function(){var T,R=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(R.pad(this._data,this.blockSize),T=this._process(!0)):(T=this._process(!0),R.unpad(T)),T},blockSize:128/32});var y=o.CipherParams=s.extend({init:function(T){this.mixIn(T)},toString:function(T){return(T||this.formatter).stringify(this)}}),x=i.format={},b=x.OpenSSL={stringify:function(T){var R,P=T.ciphertext,L=T.salt;return L?R=a.create([1398893684,1701076831]).concat(L).concat(P):R=P,R.toString(u)},parse:function(T){var R,P=u.parse(T),L=P.words;return L[0]==1398893684&&L[1]==1701076831&&(R=a.create(L.slice(2,4)),L.splice(0,4),P.sigBytes-=16),y.create({ciphertext:P,salt:R})}},k=o.SerializableCipher=s.extend({cfg:s.extend({format:b}),encrypt:function(T,R,P,L){L=this.cfg.extend(L);var z=T.createEncryptor(P,L),Z=z.finalize(R),Q=z.cfg;return y.create({ciphertext:Z,key:P,iv:Q.iv,algorithm:T,mode:Q.mode,padding:Q.padding,blockSize:T.blockSize,formatter:L.format})},decrypt:function(T,R,P,L){L=this.cfg.extend(L),R=this._parse(R,L.format);var z=T.createDecryptor(P,L).finalize(R.ciphertext);return z},_parse:function(T,R){return typeof T=="string"?R.parse(T,this):T}}),A=i.kdf={},E=A.OpenSSL={execute:function(T,R,P,L,z){if(L||(L=a.random(64/8)),z)var Z=f.create({keySize:R+P,hasher:z}).compute(T,L);else var Z=f.create({keySize:R+P}).compute(T,L);var Q=a.create(Z.words.slice(R),P*4);return Z.sigBytes=R*4,y.create({key:Z,iv:Q,salt:L})}},D=o.PasswordBasedCipher=k.extend({cfg:k.cfg.extend({kdf:E}),encrypt:function(T,R,P,L){L=this.cfg.extend(L);var z=L.kdf.execute(P,T.keySize,T.ivSize,L.salt,L.hasher);L.iv=z.iv;var Z=k.encrypt.call(this,T,R,z.key,L);return Z.mixIn(z),Z},decrypt:function(T,R,P,L){L=this.cfg.extend(L),R=this._parse(R,L.format);var z=L.kdf.execute(P,T.keySize,T.ivSize,R.salt,L.hasher);L.iv=z.iv;var Z=k.decrypt.call(this,T,R,z.key,L);return Z}})}()})}(em)),em.exports}var tm={exports:{}},EA;function L9(){return EA||(EA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.mode.CFB=function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize;i.call(this,o,s,l,a),this._prevBlock=o.slice(s,s+l)}}),r.Decryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=o.slice(s,s+l);i.call(this,o,s,l,a),this._prevBlock=c}});function i(o,s,a,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var d=0;d<a;d++)o[s+d]^=c[d]}return r}(),n.mode.CFB})}(tm)),tm.exports}var nm={exports:{}},TA;function U9(){return TA||(TA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.mode.CTR=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var d=u.slice(0);a.encryptBlock(d,0),u[l-1]=u[l-1]+1|0;for(var f=0;f<l;f++)o[s+f]^=d[f]}});return r.Decryptor=i,r}(),n.mode.CTR})}(nm)),nm.exports}var rm={exports:{}},RA;function V9(){return RA||(RA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var r=n.lib.BlockCipherMode.extend();function i(a){if((a>>24&255)===255){var l=a>>16&255,c=a>>8&255,u=a&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,a=0,a+=l<<16,a+=c<<8,a+=u}else a+=1<<24;return a}function o(a){return(a[0]=i(a[0]))===0&&(a[1]=i(a[1])),a}var s=r.Encryptor=r.extend({processBlock:function(a,l){var c=this._cipher,u=c.blockSize,d=this._iv,f=this._counter;d&&(f=this._counter=d.slice(0),this._iv=void 0),o(f);var h=f.slice(0);c.encryptBlock(h,0);for(var p=0;p<u;p++)a[l+p]^=h[p]}});return r.Decryptor=s,r}(),n.mode.CTRGladman})}(rm)),rm.exports}var im={exports:{}},_A;function G9(){return _A||(_A=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.mode.OFB=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),a.encryptBlock(u,0);for(var d=0;d<l;d++)o[s+d]^=u[d]}});return r.Decryptor=i,r}(),n.mode.OFB})}(im)),im.exports}var om={exports:{}},DA;function W9(){return DA||(DA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.mode.ECB=function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),r.Decryptor=r.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),r}(),n.mode.ECB})}(om)),om.exports}var sm={exports:{}},PA;function j9(){return PA||(PA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.pad.AnsiX923={pad:function(r,i){var o=r.sigBytes,s=i*4,a=s-o%s,l=o+a-1;r.clamp(),r.words[l>>>2]|=a<<24-l%4*8,r.sigBytes+=a},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Ansix923})}(sm)),sm.exports}var am={exports:{}},NA;function z9(){return NA||(NA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.pad.Iso10126={pad:function(r,i){var o=i*4,s=o-r.sigBytes%o;r.concat(n.lib.WordArray.random(s-1)).concat(n.lib.WordArray.create([s<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Iso10126})}(am)),am.exports}var lm={exports:{}},BA;function H9(){return BA||(BA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.pad.Iso97971={pad:function(r,i){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,i)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})}(lm)),lm.exports}var cm={exports:{}},OA;function Z9(){return OA||(OA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.pad.ZeroPadding={pad:function(r,i){var o=i*4;r.clamp(),r.sigBytes+=o-(r.sigBytes%o||o)},unpad:function(r){for(var i=r.words,o=r.sigBytes-1,o=r.sigBytes-1;o>=0;o--)if(i[o>>>2]>>>24-o%4*8&255){r.sigBytes=o+1;break}}},n.pad.ZeroPadding})}(cm)),cm.exports}var um={exports:{}},FA;function $9(){return FA||(FA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(um)),um.exports}var dm={exports:{}},MA;function X9(){return MA||(MA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Rn())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.CipherParams,a=i.enc,l=a.Hex,c=i.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var d=l.parse(u);return s.create({ciphertext:d})}}}(),n.format.Hex})}(dm)),dm.exports}var fm={exports:{}},LA;function K9(){return LA||(LA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Gl(),Wl(),$a(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.BlockCipher,s=r.algo,a=[],l=[],c=[],u=[],d=[],f=[],h=[],p=[],g=[],C=[];(function(){for(var y=[],x=0;x<256;x++)x<128?y[x]=x<<1:y[x]=x<<1^283;for(var b=0,k=0,x=0;x<256;x++){var A=k^k<<1^k<<2^k<<3^k<<4;A=A>>>8^A&255^99,a[b]=A,l[A]=b;var E=y[b],D=y[E],T=y[D],R=y[A]*257^A*16843008;c[b]=R<<24|R>>>8,u[b]=R<<16|R>>>16,d[b]=R<<8|R>>>24,f[b]=R;var R=T*16843009^D*65537^E*257^b*16843008;h[A]=R<<24|R>>>8,p[A]=R<<16|R>>>16,g[A]=R<<8|R>>>24,C[A]=R,b?(b=E^y[y[y[T^E]]],k^=y[y[k]]):b=k=1}})();var v=[0,1,2,4,8,16,32,64,128,27,54],m=s.AES=o.extend({_doReset:function(){var y;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var x=this._keyPriorReset=this._key,b=x.words,k=x.sigBytes/4,A=this._nRounds=k+6,E=(A+1)*4,D=this._keySchedule=[],T=0;T<E;T++)T<k?D[T]=b[T]:(y=D[T-1],T%k?k>6&&T%k==4&&(y=a[y>>>24]<<24|a[y>>>16&255]<<16|a[y>>>8&255]<<8|a[y&255]):(y=y<<8|y>>>24,y=a[y>>>24]<<24|a[y>>>16&255]<<16|a[y>>>8&255]<<8|a[y&255],y^=v[T/k|0]<<24),D[T]=D[T-k]^y);for(var R=this._invKeySchedule=[],P=0;P<E;P++){var T=E-P;if(P%4)var y=D[T];else var y=D[T-4];P<4||T<=4?R[P]=y:R[P]=h[a[y>>>24]]^p[a[y>>>16&255]]^g[a[y>>>8&255]]^C[a[y&255]]}}},encryptBlock:function(y,x){this._doCryptBlock(y,x,this._keySchedule,c,u,d,f,a)},decryptBlock:function(y,x){var b=y[x+1];y[x+1]=y[x+3],y[x+3]=b,this._doCryptBlock(y,x,this._invKeySchedule,h,p,g,C,l);var b=y[x+1];y[x+1]=y[x+3],y[x+3]=b},_doCryptBlock:function(y,x,b,k,A,E,D,T){for(var R=this._nRounds,P=y[x]^b[0],L=y[x+1]^b[1],z=y[x+2]^b[2],Z=y[x+3]^b[3],Q=4,ie=1;ie<R;ie++){var $=k[P>>>24]^A[L>>>16&255]^E[z>>>8&255]^D[Z&255]^b[Q++],q=k[L>>>24]^A[z>>>16&255]^E[Z>>>8&255]^D[P&255]^b[Q++],te=k[z>>>24]^A[Z>>>16&255]^E[P>>>8&255]^D[L&255]^b[Q++],O=k[Z>>>24]^A[P>>>16&255]^E[L>>>8&255]^D[z&255]^b[Q++];P=$,L=q,z=te,Z=O}var $=(T[P>>>24]<<24|T[L>>>16&255]<<16|T[z>>>8&255]<<8|T[Z&255])^b[Q++],q=(T[L>>>24]<<24|T[z>>>16&255]<<16|T[Z>>>8&255]<<8|T[P&255])^b[Q++],te=(T[z>>>24]<<24|T[Z>>>16&255]<<16|T[P>>>8&255]<<8|T[L&255])^b[Q++],O=(T[Z>>>24]<<24|T[P>>>16&255]<<16|T[L>>>8&255]<<8|T[z&255])^b[Q++];y[x]=$,y[x+1]=q,y[x+2]=te,y[x+3]=O},keySize:256/32});r.AES=o._createHelper(m)}(),n.AES})}(fm)),fm.exports}var hm={exports:{}},UA;function J9(){return UA||(UA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Gl(),Wl(),$a(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=i.BlockCipher,a=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=a.DES=s.extend({_doReset:function(){for(var v=this._key,m=v.words,y=[],x=0;x<56;x++){var b=l[x]-1;y[x]=m[b>>>5]>>>31-b%32&1}for(var k=this._subKeys=[],A=0;A<16;A++){for(var E=k[A]=[],D=u[A],x=0;x<24;x++)E[x/6|0]|=y[(c[x]-1+D)%28]<<31-x%6,E[4+(x/6|0)]|=y[28+(c[x+24]-1+D)%28]<<31-x%6;E[0]=E[0]<<1|E[0]>>>31;for(var x=1;x<7;x++)E[x]=E[x]>>>(x-1)*4+3;E[7]=E[7]<<5|E[7]>>>27}for(var T=this._invSubKeys=[],x=0;x<16;x++)T[x]=k[15-x]},encryptBlock:function(v,m){this._doCryptBlock(v,m,this._subKeys)},decryptBlock:function(v,m){this._doCryptBlock(v,m,this._invSubKeys)},_doCryptBlock:function(v,m,y){this._lBlock=v[m],this._rBlock=v[m+1],p.call(this,4,252645135),p.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),p.call(this,1,1431655765);for(var x=0;x<16;x++){for(var b=y[x],k=this._lBlock,A=this._rBlock,E=0,D=0;D<8;D++)E|=d[D][((A^b[D])&f[D])>>>0];this._lBlock=A,this._rBlock=k^E}var T=this._lBlock;this._lBlock=this._rBlock,this._rBlock=T,p.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),v[m]=this._lBlock,v[m+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(v,m){var y=(this._lBlock>>>v^this._rBlock)&m;this._rBlock^=y,this._lBlock^=y<<v}function g(v,m){var y=(this._rBlock>>>v^this._lBlock)&m;this._lBlock^=y,this._rBlock^=y<<v}r.DES=s._createHelper(h);var C=a.TripleDES=s.extend({_doReset:function(){var v=this._key,m=v.words;if(m.length!==2&&m.length!==4&&m.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var y=m.slice(0,2),x=m.length<4?m.slice(0,2):m.slice(2,4),b=m.length<6?m.slice(0,2):m.slice(4,6);this._des1=h.createEncryptor(o.create(y)),this._des2=h.createEncryptor(o.create(x)),this._des3=h.createEncryptor(o.create(b))},encryptBlock:function(v,m){this._des1.encryptBlock(v,m),this._des2.decryptBlock(v,m),this._des3.encryptBlock(v,m)},decryptBlock:function(v,m){this._des3.decryptBlock(v,m),this._des2.encryptBlock(v,m),this._des1.decryptBlock(v,m)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=s._createHelper(C)}(),n.TripleDES})}(hm)),hm.exports}var pm={exports:{}},VA;function Y9(){return VA||(VA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Gl(),Wl(),$a(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=s.RC4=o.extend({_doReset:function(){for(var u=this._key,d=u.words,f=u.sigBytes,h=this._S=[],p=0;p<256;p++)h[p]=p;for(var p=0,g=0;p<256;p++){var C=p%f,v=d[C>>>2]>>>24-C%4*8&255;g=(g+h[p]+v)%256;var m=h[p];h[p]=h[g],h[g]=m}this._i=this._j=0},_doProcessBlock:function(u,d){u[d]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,d=this._i,f=this._j,h=0,p=0;p<4;p++){d=(d+1)%256,f=(f+u[d])%256;var g=u[d];u[d]=u[f],u[f]=g,h|=u[(u[d]+u[f])%256]<<24-p*8}return this._i=d,this._j=f,h}r.RC4=o._createHelper(a);var c=s.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});r.RC4Drop=o._createHelper(c)}(),n.RC4})}(pm)),pm.exports}var gm={exports:{}},GA;function q9(){return GA||(GA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Gl(),Wl(),$a(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=[],l=[],c=[],u=s.Rabbit=o.extend({_doReset:function(){for(var f=this._key.words,h=this.cfg.iv,p=0;p<4;p++)f[p]=(f[p]<<8|f[p]>>>24)&16711935|(f[p]<<24|f[p]>>>8)&4278255360;var g=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],C=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var p=0;p<4;p++)d.call(this);for(var p=0;p<8;p++)C[p]^=g[p+4&7];if(h){var v=h.words,m=v[0],y=v[1],x=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,k=x>>>16|b&4294901760,A=b<<16|x&65535;C[0]^=x,C[1]^=k,C[2]^=b,C[3]^=A,C[4]^=x,C[5]^=k,C[6]^=b,C[7]^=A;for(var p=0;p<4;p++)d.call(this)}},_doProcessBlock:function(f,h){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,f[h+g]^=a[g]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var g=f[p]+h[p],C=g&65535,v=g>>>16,m=((C*C>>>17)+C*v>>>15)+v*v,y=((g&4294901760)*g|0)+((g&65535)*g|0);c[p]=m^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=o._createHelper(u)}(),n.Rabbit})}(gm)),gm.exports}var mm={exports:{}},WA;function Q9(){return WA||(WA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Gl(),Wl(),$a(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=[],l=[],c=[],u=s.RabbitLegacy=o.extend({_doReset:function(){var f=this._key.words,h=this.cfg.iv,p=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],g=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var C=0;C<4;C++)d.call(this);for(var C=0;C<8;C++)g[C]^=p[C+4&7];if(h){var v=h.words,m=v[0],y=v[1],x=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,k=x>>>16|b&4294901760,A=b<<16|x&65535;g[0]^=x,g[1]^=k,g[2]^=b,g[3]^=A,g[4]^=x,g[5]^=k,g[6]^=b,g[7]^=A;for(var C=0;C<4;C++)d.call(this)}},_doProcessBlock:function(f,h){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,f[h+g]^=a[g]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var g=f[p]+h[p],C=g&65535,v=g>>>16,m=((C*C>>>17)+C*v>>>15)+v*v,y=((g&4294901760)*g|0)+((g&65535)*g|0);c[p]=m^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=o._createHelper(u)}(),n.RabbitLegacy})}(mm)),mm.exports}var vm={exports:{}},jA;function e7(){return jA||(jA=1,function(e,t){(function(n,r,i){e.exports=r(it(),Gl(),Wl(),$a(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.BlockCipher,s=r.algo;const a=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function d(C,v){let m=v>>24&255,y=v>>16&255,x=v>>8&255,b=v&255,k=C.sbox[0][m]+C.sbox[1][y];return k=k^C.sbox[2][x],k=k+C.sbox[3][b],k}function f(C,v,m){let y=v,x=m,b;for(let k=0;k<a;++k)y=y^C.pbox[k],x=d(C,y)^x,b=y,y=x,x=b;return b=y,y=x,x=b,x=x^C.pbox[a],y=y^C.pbox[a+1],{left:y,right:x}}function h(C,v,m){let y=v,x=m,b;for(let k=a+1;k>1;--k)y=y^C.pbox[k],x=d(C,y)^x,b=y,y=x,x=b;return b=y,y=x,x=b,x=x^C.pbox[1],y=y^C.pbox[0],{left:y,right:x}}function p(C,v,m){for(let A=0;A<4;A++){C.sbox[A]=[];for(let E=0;E<256;E++)C.sbox[A][E]=c[A][E]}let y=0;for(let A=0;A<a+2;A++)C.pbox[A]=l[A]^v[y],y++,y>=m&&(y=0);let x=0,b=0,k=0;for(let A=0;A<a+2;A+=2)k=f(C,x,b),x=k.left,b=k.right,C.pbox[A]=x,C.pbox[A+1]=b;for(let A=0;A<4;A++)for(let E=0;E<256;E+=2)k=f(C,x,b),x=k.left,b=k.right,C.sbox[A][E]=x,C.sbox[A][E+1]=b;return!0}var g=s.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var C=this._keyPriorReset=this._key,v=C.words,m=C.sigBytes/4;p(u,v,m)}},encryptBlock:function(C,v){var m=f(u,C[v],C[v+1]);C[v]=m.left,C[v+1]=m.right},decryptBlock:function(C,v){var m=h(u,C[v],C[v+1]);C[v]=m.left,C[v+1]=m.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=o._createHelper(g)}(),n.Blowfish})}(vm)),vm.exports}(function(e,t){(function(n,r,i){e.exports=r(it(),Lp(),_9(),D9(),Gl(),P9(),Wl(),bR(),z1(),N9(),AR(),B9(),O9(),F9(),H1(),M9(),$a(),Rn(),L9(),U9(),V9(),G9(),W9(),j9(),z9(),H9(),Z9(),$9(),X9(),K9(),J9(),Y9(),q9(),Q9(),e7())})(Ze,function(n){return n})})(IR);var t7=IR.exports;const zA=tu(t7);class ai extends Error{constructor(t,n){super(n),this.code=t,this.name="FileTransferError"}}const so={CONNECTION_FAILED:"CONNECTION_FAILED",TRANSFER_TIMEOUT:"TRANSFER_TIMEOUT",INVALID_FILE:"INVALID_FILE",DATA_CHANNEL_ERROR:"DATA_CHANNEL_ERROR"};class n7 extends _p{constructor(n,r){super();M(this,"webRTCService");M(this,"client");M(this,"gmcpFileTransfer");M(this,"chunkSize",16384);M(this,"transferTimeoutInterval");M(this,"incomingTransfers",new Map);M(this,"outgoingTransfers",new Map);M(this,"maxFileSize",100*1024*1024);M(this,"transferTimeout",3e4);M(this,"pendingOffers",new Map);this.client=n,this.gmcpFileTransfer=r,this.webRTCService=n.webRTCService,this.setupListeners()}isDataChannelReady(){return this.webRTCService.isDataChannelOpen()}setupListeners(){this.webRTCService.on("dataChannelMessage",this.handleIncomingChunk.bind(this)),this.client.on("fileTransferAccepted",this.handleAcceptedTransfer.bind(this)),this.transferTimeoutInterval=window.setInterval(()=>this.checkTransferTimeouts(),5e3)}async initializeWebRTC(){this.webRTCService.isDataChannelOpen()||await this.webRTCService.createPeerConnection()}async sendFile(n,r){if(n.size>this.maxFileSize)throw new ai(so.INVALID_FILE,`File size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);const i=await this.computeFileHash(n);console.log(`[FileTransferManager] Computed hash for ${n.name}: ${i}`),console.log(`[FileTransferManager] Registering outgoing transfer for file: ${n.name}`),this.outgoingTransfers.set(i,{file:n,filename:n.name,hash:i,lastActivityTimestamp:Date.now()});try{await this.initializeWebRTC(),this.webRTCService.recipient=r;const o=await this.webRTCService.createOffer();console.log(`[FileTransferManager] Sending offer for file: ${n.name}`),await this.gmcpFileTransfer.sendOffer(r,n.name,n.size,JSON.stringify(o),i),await this.webRTCService.waitForConnection()}catch(o){console.error(`[FileTransferManager] Failed to send file ${n.name}:`,o),this.handleTransferError(i,n.name,"send",o instanceof ai?o:new ai(so.CONNECTION_FAILED,"Failed to establish connection")),this.cleanupTransfer(i)}}async computeFileHash(n){return new Promise((r,i)=>{const o=new FileReader;o.onload=()=>{if(o.result instanceof ArrayBuffer){const s=zA.lib.WordArray.create(o.result),a=zA.SHA256(s).toString();r(a)}else i(new Error("Failed to read file for hashing"))},o.onerror=()=>i(o.error),o.readAsArrayBuffer(n)})}async startFileTransfer(n,r){let i=0;const o=new FileReader;for(;i<n.size;){const s=n.slice(i,i+this.chunkSize),a=await new Promise((c,u)=>{o.onload=()=>{o.result instanceof ArrayBuffer?c(o.result):u(new ai(so.INVALID_FILE,"Failed to read file chunk"))},o.onerror=()=>u(new ai(so.INVALID_FILE,"Error reading file")),o.readAsArrayBuffer(s)});await this.sendChunk(n.name,r,a,i,n.size),i+=a.byteLength;const l={hash:r,filename:n.name,sentBytes:i,totalBytes:n.size};this.emit("fileSendProgress",l)}}async sendChunk(n,r,i,o,s){try{const a={hash:r,filename:n,chunkIndex:Math.floor(o/this.chunkSize),totalChunks:Math.ceil(s/this.chunkSize),chunkSize:i.byteLength,totalSize:s},l=JSON.stringify(a),c=new TextEncoder().encode(l),u=new ArrayBuffer(4);new DataView(u).setUint32(0,c.byteLength,!0);const d=new Uint8Array(4+c.byteLength+i.byteLength);d.set(new Uint8Array(u),0),d.set(c,4),d.set(new Uint8Array(i),4+c.byteLength),await this.webRTCService.sendData(d.buffer)}catch{throw new ai(so.DATA_CHANNEL_ERROR,"Failed to send chunk")}}async handleAcceptedTransfer(n){console.log("[FileTransferManager] Handling accepted transfer for file transfer request ",n);const{sender:r,hash:i,filename:o,answerSdp:s}=n,a=this.outgoingTransfers.get(i);if(!a){const l=`No outgoing transfer found for hash: ${i} (${o}). Active transfers: ${Array.from(this.outgoingTransfers.keys()).join(", ")}`;console.error(`[FileTransferManager] ${l}`),this.client.onFileTransferError(i,o,"send",l);return}try{console.log(`[FileTransferManager] Processing WebRTC answer for file: ${o}`);const l=JSON.parse(s);console.log(`[FileTransferManager] Answer object for file: ${o}`,l),await this.webRTCService.handleAnswer(l),console.log(`[FileTransferManager] Waiting for data channel to open for file: ${o}`),await this.waitForDataChannel(i),console.log(`[FileTransferManager] Data channel ready for outgoing transfer of: ${o}`),await this.startFileTransfer(a.file,a.hash),console.log(`[FileTransferManager] File transfer completed successfully: ${o}`),this.client.onFileSendComplete(i,o)}catch(l){console.error(`[FileTransferManager] Error in accepted transfer for ${o}:`,l),this.handleTransferError(i,o,"send",l)}finally{console.log(`[FileTransferManager] Cleaning up successful transfer: ${o} (${i})`),this.outgoingTransfers.delete(i)}}async waitForDataChannel(n){return new Promise((r,i)=>{if(this.isDataChannelReady()){r();return}let o=0;const s=50,a=setInterval(()=>{o++,this.isDataChannelReady()?(clearInterval(a),r()):o>=s&&(clearInterval(a),i(new ai(so.CONNECTION_FAILED,`Data channel failed to open for transfer ${n} after ${o} attempts`)))},100)})}async handleIncomingChunk(n){try{if(n.byteLength<4)throw new Error("Received data is too short to contain header size");const r=new Uint8Array(n.slice(0,4)),i=new DataView(r.buffer).getUint32(0,!0);if(n.byteLength<4+i)throw new Error("Received data is too short to contain header");const o=new TextDecoder().decode(n.slice(4,4+i)),s=JSON.parse(o);if(n.byteLength<4+i+s.chunkSize)throw new Error("Received data is too short to contain chunk data");const a=this.pendingOffers.get(s.hash),l=(a==null?void 0:a.sender)||"unknown";if(typeof s.chunkIndex!="number"||s.chunkIndex<0||s.chunkIndex>=s.totalChunks)throw new Error("Invalid chunk index in header");if(typeof s.totalChunks!="number"||s.totalChunks<=0)throw new Error("Invalid total chunks in header");const c=n.slice(4+i,4+i+s.chunkSize);let u=this.incomingTransfers.get(s.hash);if(!u){if(s.totalSize>this.maxFileSize){this.client.onFileTransferError(s.hash,s.filename,"receive",`Incoming file size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);return}u={hash:s.hash,filename:s.filename,totalSize:s.totalSize,receivedSize:0,chunks:new Array(s.totalChunks),lastActivityTimestamp:Date.now(),sender:l},this.incomingTransfers.set(s.hash,u)}u.chunks[s.chunkIndex]=c,u.receivedSize+=c.byteLength,u.lastActivityTimestamp=Date.now();const d={hash:s.hash,filename:s.filename,receivedBytes:u.receivedSize,totalBytes:u.totalSize};if(this.emit("fileReceiveProgress",d),u.receivedSize===u.totalSize)if(u.chunks.every(f=>f)){const f=new Blob(u.chunks),h=new File([f],u.filename,{type:f.type});if(await this.computeFileHash(h)!==u.hash){this.client.onFileTransferError(u.hash,s.filename,"receive","File integrity check failed - hash mismatch"),this.incomingTransfers.delete(u.hash);return}const g=window.URL.createObjectURL(f),C=document.createElement("a");C.href=g,C.download=s.filename,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(g);const v={hash:u.hash,filename:s.filename,file:f};this.emit("fileReceiveComplete",v),this.incomingTransfers.delete(u.hash)}else this.client.onFileTransferError(u.hash,s.filename,"receive","Missing chunks in received file")}catch(r){this.handleTransferError("unknown","unknown_file","receive",new ai("UNKNOWN_ERROR",r instanceof Error?r.message:"Unknown error"))}}handleTransferError(n,r,i,o){console.error(`Error ${i}ing file ${r} (${n}):`,o);const s=o instanceof Error?o.message:"Unknown error";this.client.onFileTransferError(n,r,i,s),this.cleanupTransfer(n),this.attemptRecovery(n,r,i)}cleanupTransfer(n){console.log(`[FileTransferManager] Starting cleanup for hash: ${n}`);const r=this.outgoingTransfers.get(n);r&&(console.log(`[FileTransferManager] Cleaning up outgoing transfer for: ${r.filename} (${n})`),this.outgoingTransfers.delete(n));const i=this.incomingTransfers.get(n);if(i&&(console.log(`[FileTransferManager] Cleaning up incoming transfer for: ${i.filename} (${n})`),this.incomingTransfers.delete(n)),this.pendingOffers.has(n)){const o=this.pendingOffers.get(n);console.log(`[FileTransferManager] Removing pending offer for: ${o==null?void 0:o.filename} (${n})`),this.pendingOffers.delete(n)}console.log(`[FileTransferManager] Cleanup complete for hash: ${n}`)}async attemptRecovery(n,r,i){try{if(await this.webRTCService.createPeerConnection(),this.client.onConnectionRecovered({hash:n,filename:r,direction:i}),i==="send"){const o=this.outgoingTransfers.get(n);o&&await this.startFileTransfer(o.file,o.hash)}else if(i==="receive"){const o=this.incomingTransfers.get(n);o&&this.gmcpFileTransfer.sendRequestResend(o.sender,n)}}catch(o){console.error("Failed to recover connection:",o),this.client.onRecoveryFailed({filename:r,direction:i,error:o instanceof Error?o.message:"Unknown error"})}}checkTransferTimeouts(){const n=Date.now();this.incomingTransfers.forEach((r,i)=>{n-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"receive",new ai(so.TRANSFER_TIMEOUT,"Transfer timeout - no data received"))}),this.outgoingTransfers.forEach((r,i)=>{n-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"send",new ai(so.TRANSFER_TIMEOUT,"Transfer timeout - no activity"))})}cleanup(){this.transferTimeoutInterval&&(clearInterval(this.transferTimeoutInterval),this.transferTimeoutInterval=void 0),[...this.outgoingTransfers.keys()].forEach(n=>this.cancelTransfer(n)),[...this.incomingTransfers.keys()].forEach(n=>this.cancelTransfer(n)),this.incomingTransfers.clear(),this.outgoingTransfers.clear(),this.pendingOffers.clear(),this.webRTCService.cleanup()}cancelTransfer(n){const r=this.outgoingTransfers.get(n)||this.incomingTransfers.get(n);r?(console.log(`[FileTransferManager] Cancelling transfer for hash: ${n} (${r.filename})`),this.cleanupTransfer(n),this.client.onFileTransferCancel(this.client.worldData.playerId,n),this.gmcpFileTransfer.sendCancel(this.client.worldData.playerId,n)):console.log(`[FileTransferManager] No active transfer found for hash: ${n}`)}async acceptTransfer(n,r){if(console.log("[FileTransferManager] Accepting transfer",n,r),this.incomingTransfers.has(r))throw new Error("Already receiving this file");const i=this.pendingOffers.get(r);if(console.log("[FileTransferManager] Checking pending offers:",Array.from(this.pendingOffers.entries())),!i)throw new ai(so.INVALID_FILE,`No pending offer found for transfer with hash: ${r}`);console.log("[FileTransferManager] Found pending offer for transfer:",{sender:n,hash:r,filename:i.filename,filesize:i.filesize});try{await this.initializeWebRTC(),this.webRTCService.recipient=n,console.log("[FileTransferManager] Setting remote description with offer"),await this.webRTCService.handleOffer(JSON.parse(i.offerSdp)),console.log("[FileTransferManager] Creating WebRTC answer");const o=await this.webRTCService.createAnswer();if(console.log("[FileTransferManager] WebRTC answer created successfully"),this.pendingOffers.has(r))await this.gmcpFileTransfer.sendAccept(n,r,i.filename,JSON.stringify(o)),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready for incoming transfer"),this.pendingOffers.delete(r);else throw new Error("Transfer was cancelled during setup")}catch(o){throw console.error("Failed to accept transfer:",o),this.cleanupTransfer(r),new ai(so.CONNECTION_FAILED,`Failed to accept transfer: ${o instanceof Error?o.message:"Unknown error"}`)}}}class r7 extends _p{constructor(n,r){super();M(this,"ws");M(this,"decoder",new TextDecoder("utf8"));M(this,"telnet");M(this,"_connected",!1);M(this,"intentionalDisconnect",!1);M(this,"host");M(this,"port");M(this,"telnetNegotiation",!1);M(this,"telnetBuffer","");M(this,"gmcpHandlers",{});M(this,"mcpHandlers",{});M(this,"mcpMultilines",{});M(this,"mcpAuthKey",null);M(this,"mcp_negotiate");M(this,"mcp_getset");M(this,"gmcp_char");M(this,"gmcp_fileTransfer");M(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});M(this,"cacophony");M(this,"editors");M(this,"webRTCService");M(this,"fileTransferManager");M(this,"currentRoomInfo",null);M(this,"_autosay",!1);this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(C9),this.mcp_getset=this.registerMcpPackage(I9),this.gmcp_char=this.registerGMCPPackage(qT),this.gmcp_fileTransfer=this.registerGMCPPackage(QT),this.cacophony=new e9,this.cacophony.setGlobalVolume(Yr.getState().general.volume),this.editors=new rO(this),this.webRTCService=new S9(this),this.fileTransferManager=new n7(this,this.gmcp_fileTransfer)}get connected(){return this._connected}get autosay(){return this._autosay}set autosay(n){this._autosay=n,this.emit("autosayChanged",n)}async sendFile(n,r){await this.fileTransferManager.sendFile(n,r)}cancelTransfer(n){this.fileTransferManager.cancelTransfer(n)}acceptTransfer(n,r){this.fileTransferManager.acceptTransfer(n,r)}rejectTransfer(n,r){this.gmcp_fileTransfer.sendReject(n,r)}onFileTransferOffer(n,r,i,o,s){console.log("[MudClient] Emitting fileTransferOffer event:",{sender:n,hash:r,filename:i,filesize:o,offerSdp:s}),this.emit("fileTransferOffer",{sender:n,hash:r,filename:i,filesize:o,offerSdp:s})}onFileTransferAccept(n,r,i,o){console.log("[MudClient] Emitting fileTransferAccepted event:",{sender:n,hash:r,filename:i,answerSdp:o}),this.emit("fileTransferAccepted",{sender:n,hash:r,filename:i,answerSdp:o})}onFileTransferReject(n,r){this.emit("fileTransferRejected",{sender:n,hash:r})}onFileTransferCancel(n,r){this.emit("fileTransferCancelled",{sender:n,hash:r})}onFileSendComplete(n,r){this.emit("fileSendComplete",{hash:n,filename:r})}onFileTransferError(n,r,i,o){this.emit("fileTransferError",{hash:n,filename:r,direction:i,error:o})}onConnectionRecovered(n){this.emit("connectionRecovered",n)}onRecoveryFailed(n){this.emit("recoveryFailed",n)}sendFileTransferOffer(n,r,i,o,s){this.gmcp_fileTransfer.sendOffer(n,r,o,s,i)}sendFileTransferAccept(n,r,i,o){this.gmcp_fileTransfer.sendAccept(n,i,r,o)}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.intentionalDisconnect=!1,this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new Q4(new q4(this.ws)),this.ws.onopen=()=>{this._connected=!0,this.emit("connect"),this.emit("connectionChange",!0)},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===ed.WILL&&r===Qu.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(ed.DO,Qu.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===ed.DO&&r===Qu.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(ed.WILL,Qu.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r);try{this.handleGmcpData(n,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.cleanupConnection(),this.intentionalDisconnect||setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}cleanupConnection(){this._connected=!1,this.mcpAuthKey=null,this.telnetBuffer="",this.telnetNegotiation=!1,this.currentRoomInfo=null,this.webRTCService.cleanup(),this.fileTransferManager.cleanup(),this.emit("disconnect"),this.emit("connectionChange",!1)}close(){this.intentionalDisconnect=!0,this.ws&&this.ws.close(),this.cleanupConnection()}sendCommand(n){Yr.getState().general.localEcho&&this.emit("command",n),this.autosay&&!n.startsWith("-")&&!n.startsWith("'")&&(n="say "+n),this.send(n+`\r
`),console.log("> "+n)}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=aA(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=aA(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=v9(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=lA(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),o=n.substring(0,i),s=n.substring(i+1);console.log("GMCP Message:",o,s,r);const a=this.gmcpHandlers[o];if(!a){console.log("No handler for GMCP package:",o);return}const l=a["handle"+s];if(l){console.log("Calling handler for:",s,l);let c;typeof r=="string"&&r.trim()!==""?c=r:(console.warn(`GMCP message data for ${o}.${s} is missing or empty. Defaulting to {}. Original data:`,r),c="{}");try{const u=JSON.parse(c);l.call(a,u)}catch(u){console.error(`Error parsing GMCP JSON for ${o}.${s}:`,u),console.error("Attempted to parse:",c)}}else console.log("No handler on package:",o,s)}emitMessage(n){const r=Yr.getState().speech.autoreadMode;r===bC.All&&this.speak(n),r===bC.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let o="";for(const[s,a]of Object.entries(r))o+=` ${s}: ${a||'""'}`;r=o}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}sendMCPMultiline(n,r,i){const o=lA();r["_data-tag"]=o,this.sendMcp(n,r);for(const s of i)this.sendMcpMLLine(o,"content",s);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()}),this.editors.shutdown(),this.webRTCService.cleanup(),this.fileTransferManager.cleanup()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(nO(n));r.lang="en-US";const{rate:i,pitch:o,voice:s,volume:a}=Yr.getState().speech;r.rate=i,r.pitch=o,r.volume=a;const c=speechSynthesis.getVoices().find(u=>u.name===s);c&&(r.voice=c),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}}class i7{constructor(){M(this,"history",[]);M(this,"currentIndex",-1);M(this,"unsentInput","")}addCommand(t){t.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==t)&&this.history.push(t.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(t){return this.currentIndex===-1&&(this.unsentInput=t),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(t){return this.currentIndex===-1&&(this.unsentInput=t),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}getHistory(){return[...this.history]}}const o7=()=>{const[,e]=S.useReducer(t=>t+1,0);return S.useEffect(()=>wc.subscribe(e),[]),[wc.getState(),wc.dispatch]},HA="command_history",s7=1e3,a7=({onSend:e,inputRef:t})=>{const n=S.useRef(new i7),[r,i]=o7();S.useEffect(()=>{const l=localStorage.getItem(HA);l&&JSON.parse(l).forEach(u=>{n.current.addCommand(u)})},[]);const o=()=>{try{const c=n.current.getHistory().slice(-s7);localStorage.setItem(HA,JSON.stringify(c))}catch(l){console.warn("Failed to save command history:",l)}},s=S.useCallback(l=>{const c=n.current,u=r.text;if(l.key==="Enter"&&!l.shiftKey)l.preventDefault(),a();else if(l.key==="ArrowUp"){l.preventDefault();const d=c.navigateUp(u);yd(d)}else if(l.key==="ArrowDown"){l.preventDefault();const d=c.navigateDown(u);yd(d)}},[r.text]),a=S.useCallback(()=>{var c;const l=r.text;l.trim()&&(e(l),n.current.addCommand(l),o(),KO(),(c=t.current)==null||c.focus())},[r.text,e,t]);return G.jsxs("div",{className:"command-input-container",children:[G.jsx("textarea",{value:r.text,onChange:l=>yd(l.target.value),onKeyDown:s,id:"command-input",ref:t,autoFocus:!0}),G.jsx("button",{onClick:a,className:"send-button",children:"Send"})]})},wR=7e3;let ao=null;function ZA(e,t="assertive",n=wR){ao?ao.announce(e,t,n):(ao=new l7,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?ao.announce(e,t,n):setTimeout(()=>{ao!=null&&ao.isAttached()&&(ao==null||ao.announce(e,t,n))},100))}class l7{isAttached(){var t;return(t=this.node)===null||t===void 0?void 0:t.isConnected}createLog(t){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",t),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(t,n="assertive",r=wR){var i,o;if(!this.node)return;let s=document.createElement("div");typeof t=="object"?(s.setAttribute("role","img"),s.setAttribute("aria-labelledby",t["aria-labelledby"])):s.textContent=t,n==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(s):(o=this.politeLog)===null||o===void 0||o.appendChild(s),t!==""&&setTimeout(()=>{s.remove()},r)}clear(t){this.node&&((!t||t==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!t||t==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var $A=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function c7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Qs=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],u7=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,d7=function(){$A(e,null,[{key:"escapeForHtml",value:function(n){return new e().escapeForHtml(n)}},{key:"linkify",value:function(n){return new e().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new e().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new e().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new e().ansiToText(n)}}]);function e(){c7(this,e),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return $A(e,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(Qs[n][r].color);for(var i=[0,95,135,175,215,255],o=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},s=0;s<6;++s)for(var a=0;a<6;++a)for(var l=0;l<6;++l)this.PALETTE_COLORS.push(o(s,a,l));for(var c=8,u=0;u<24;++u,c+=10)this.PALETTE_COLORS.push(o(c,c,c))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(u7,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var o=this,s=this,a=n.split(/\033\[/),l=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var c=a.map(function(d){return o.processChunk(d,r,i)});if(r&&r.json){var u=s.processChunkJson("");return u.content=l,u.clearLine=r.clearLine,c.unshift(u),r.remove_empty&&(c=c.filter(function(d){return!d.isEmpty()})),c}else c.unshift(l);return c.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var o=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,s=r.key=o?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},l=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!l)return a;a.content=l[4];var c=l[2].split(";");if(l[1]!==""||l[3]!=="m"||!i)return a;for(var u=this;c.length>0;){var d=c.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=Qs[0][f%10][s];else if(f>=90&&f<98)u.fg=Qs[1][f%10][s];else if(f>=40&&f<48)u.bg=Qs[0][f%10][s];else if(f>=100&&f<108)u.bg=Qs[1][f%10][s];else if(f===38||f===48){var h=f===38;if(c.length>=1){var p=c.shift();if(p==="5"&&c.length>=1){var g=parseInt(c.shift());if(g>=0&&g<=255)if(!o)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[g]:u.bg=this.PALETTE_COLORS[g];else{var C=g>=16?"ansi-palette-"+g:Qs[g>7?1:0][g%8].class;h?u.fg=C:u.bg=C}}else if(p==="2"&&c.length>=3){var v=parseInt(c.shift()),m=parseInt(c.shift()),y=parseInt(c.shift());if(v>=0&&v<=255&&m>=0&&m<=255&&y>=0&&y<=255){var x=v+", "+m+", "+y;o?h?(u.fg="ansi-truecolor",u.fg_truecolor=x):(u.bg="ansi-truecolor",u.bg_truecolor=x):h?u.fg=x:u.bg=x}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var o=this;r=r||{};var s=this.processChunkJson(n,r,i),a=r.use_classes;if(s.decorations=s.decorations.filter(function(h){if(h==="reverse"){s.fg||(s.fg=Qs[0][7][a?"class":"color"]),s.bg||(s.bg=Qs[0][0][a?"class":"color"]);var p=s.fg;s.fg=s.bg,s.bg=p;var g=s.fg_truecolor;return s.fg_truecolor=s.bg_truecolor,s.bg_truecolor=g,s.isInverted=!0,!1}return!0}),r.json)return s;if(s.isEmpty())return"";if(!s.was_processed)return s.content;var l=[],c=[],u=[],d={},f=function(p){var g=[],C=void 0;for(C in p)p.hasOwnProperty(C)&&g.push("data-"+C+'="'+o.escapeForHtml(p[C])+'"');return g.length>0?" "+g.join(" "):""};return s.isInverted&&(d["ansi-is-inverted"]="true"),s.fg&&(a?(l.push(s.fg+"-fg"),s.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=s.fg_truecolor,s.fg_truecolor=null)):l.push("color:rgb("+s.fg+")")),s.bg&&(a?(l.push(s.bg+"-bg"),s.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=s.bg_truecolor,s.bg_truecolor=null)):l.push("background-color:rgb("+s.bg+")")),s.decorations.forEach(function(h){if(a){c.push("ansi-"+h);return}h==="bold"?c.push("font-weight:bold"):h==="dim"?c.push("opacity:0.5"):h==="italic"?c.push("font-style:italic"):h==="hidden"?c.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&c.push("text-decoration:"+u.join(" ")),a?'<span class="'+l.concat(c).join(" ")+'"'+f(d)+">"+s.content+"</span>":'<span style="'+l.concat(c).join(";")+'"'+f(d)+">"+s.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),e}(),f7=d7;const h7=tu(f7);function p7(e,t){let n=[];for(const r of e.split(`\r
`)){const i=h7.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const s of i){const a=C7(s,t);o=[...o,...a]}n=[...n,G.jsx("span",{children:o},n.length)]}return n}const g7=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,m7=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,v7=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function C7(e,t){const n=y7(e),r=[];let i=0,o=0;function s(u,d){let f;for(;(f=u.exec(e.content))!==null;){const h=f.index;h>i&&r.push(e.content.substring(i,h)),r.push(d(f)),i=u.lastIndex}}function a(u){const[,d,f]=u,h=f;return G.jsxs(G.Fragment,{children:[d,G.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:f})]})}function l(u){const d=u.groups.name,f=`mailto:${d}`;return G.jsxs(G.Fragment,{children:[u.groups.slorp1,G.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function c(u){const[,d,f]=u;return G.jsx("a",{onClick:()=>t(d),className:"exit",children:f})}return s(g7,a),s(m7,l),s(v7,c),i<e.content.length&&r.push(e.content.substring(i)),r.map(u=>G.jsx("span",{style:n,children:u},o++))}function y7(e){const t={};switch(e.bg&&(t.backgroundColor=`rgb(${e.bg})`),e.fg&&(t.color=`rgb(${e.fg})`),e.decoration){case"bold":t.fontWeight="bold";break;case"dim":t.opacity="0.5";break;case"italic":t.fontStyle="italic";break;case"hidden":t.visibility="hidden";break;case"strikethrough":t.textDecoration="line-through";break;case"underline":t.textDecoration="underline";break;case"blink":t.textDecoration="blink";break}return t}var Ma={},fu={},SR=S;function je(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var br=Object.prototype.hasOwnProperty,x7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XA={},KA={};function kR(e){return br.call(KA,e)?!0:br.call(XA,e)?!1:x7.test(e)?KA[e]=!0:(XA[e]=!0,!1)}function vr(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Un[e]=new vr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Un[t]=new vr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Un[e]=new vr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Un[e]=new vr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Un[e]=new vr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Un[e]=new vr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Un[e]=new vr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Un[e]=new vr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Un[e]=new vr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Z1=/[\-:]([a-z])/g;function $1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Z1,$1);Un[t]=new vr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Z1,$1);Un[t]=new vr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Z1,$1);Un[t]=new vr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Un[e]=new vr(e,1,!1,e.toLowerCase(),null,!1,!1)});Un.xlinkHref=new vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Un[e]=new vr(e,1,!1,e.toLowerCase(),null,!0,!0)});var Bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},I7=["Webkit","ms","Moz","O"];Object.keys(Bh).forEach(function(e){I7.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Bh[t]=Bh[e]})});var b7=/["'&<>]/;function ar(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=b7.exec(e);if(t){var n="",r,i=0;for(r=t.index;r<e.length;r++){switch(e.charCodeAt(r)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==r&&(n+=e.substring(i,r)),i=r+1,n+=t}e=i!==r?n+e.substring(i,r):n}return e}var A7=/([A-Z])/g,w7=/^ms-/,AC=Array.isArray;function $o(e,t){return{insertionMode:e,selectedValue:t}}function S7(e,t,n){switch(t){case"select":return $o(1,n.value!=null?n.value:n.defaultValue);case"svg":return $o(2,null);case"math":return $o(3,null);case"foreignObject":return $o(1,null);case"table":return $o(4,null);case"thead":case"tbody":case"tfoot":return $o(5,null);case"colgroup":return $o(7,null);case"tr":return $o(6,null)}return 4<=e.insertionMode||e.insertionMode===0?$o(1,null):e}var JA=new Map;function ER(e,t,n){if(typeof n!="object")throw Error(je(62));t=!0;for(var r in n)if(br.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=ar(r);i=ar((""+i).trim())}else{o=r;var s=JA.get(o);s!==void 0||(s=ar(o.replace(A7,"-$1").toLowerCase().replace(w7,"-ms-")),JA.set(o,s)),o=s,i=typeof i=="number"?i===0||br.call(Bh,r)?""+i:i+"px":ar((""+i).trim())}t?(t=!1,e.push(' style="',o,":",i)):e.push(";",o,":",i)}}t||e.push('"')}function Fr(e,t,n,r){switch(n){case"style":ER(e,t,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(t=Un.hasOwnProperty(n)?Un[n]:null,t!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=t.attributeName,t.type){case 3:r&&e.push(" ",n,'=""');break;case 4:r===!0?e.push(" ",n,'=""'):r!==!1&&e.push(" ",n,'="',ar(r),'"');break;case 5:isNaN(r)||e.push(" ",n,'="',ar(r),'"');break;case 6:!isNaN(r)&&1<=r&&e.push(" ",n,'="',ar(r),'"');break;default:t.sanitizeURL&&(r=""+r),e.push(" ",n,'="',ar(r),'"')}}else if(kR(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(t=n.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(" ",n,'="',ar(r),'"')}}}function Oh(e,t,n){if(t!=null){if(n!=null)throw Error(je(60));if(typeof t!="object"||!("__html"in t))throw Error(je(61));t=t.__html,t!=null&&e.push(""+t)}}function k7(e){var t="";return SR.Children.forEach(e,function(n){n!=null&&(t+=n)}),t}function Cm(e,t,n,r){e.push(co(n));var i=n=null,o;for(o in t)if(br.call(t,o)){var s=t[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Fr(e,r,o,s)}}return e.push(">"),Oh(e,i,n),typeof n=="string"?(e.push(ar(n)),null):n}var E7=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,YA=new Map;function co(e){var t=YA.get(e);if(t===void 0){if(!E7.test(e))throw Error(je(65,e));t="<"+e,YA.set(e,t)}return t}function T7(e,t,n,r,i){switch(t){case"select":e.push(co("select"));var o=null,s=null;for(u in n)if(br.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Fr(e,r,u,a)}}return e.push(">"),Oh(e,s,o),o;case"option":s=i.selectedValue,e.push(co("option"));var l=a=null,c=null,u=null;for(o in n)if(br.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Fr(e,r,o,d)}}if(s!=null)if(n=l!==null?""+l:k7(a),AC(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){e.push(' selected=""');break}}else""+s===n&&e.push(' selected=""');else c&&e.push(' selected=""');return e.push(">"),Oh(e,u,a),a;case"textarea":e.push(co("textarea")),u=s=o=null;for(a in n)if(br.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(je(91));default:Fr(e,r,a,l)}if(o===null&&s!==null&&(o=s),e.push(">"),u!=null){if(o!=null)throw Error(je(92));if(AC(u)&&1<u.length)throw Error(je(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&e.push(`
`),o!==null&&e.push(ar(""+o)),null;case"input":e.push(co("input")),l=u=a=o=null;for(s in n)if(br.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Fr(e,r,s,c)}return u!==null?Fr(e,r,"checked",u):l!==null&&Fr(e,r,"checked",l),o!==null?Fr(e,r,"value",o):a!==null&&Fr(e,r,"value",a),e.push("/>"),null;case"menuitem":e.push(co("menuitem"));for(var f in n)if(br.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(je(400));default:Fr(e,r,f,o)}return e.push(">"),null;case"title":e.push(co("title")),o=null;for(d in n)if(br.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(je(434));default:Fr(e,r,d,s)}return e.push(">"),o;case"listing":case"pre":e.push(co(t)),s=o=null;for(l in n)if(br.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Fr(e,r,l,a)}if(e.push(">"),s!=null){if(o!=null)throw Error(je(60));if(typeof s!="object"||!("__html"in s))throw Error(je(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?e.push(`
`,n):e.push(""+n))}return typeof o=="string"&&o[0]===`
`&&e.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(co(t));for(var h in n)if(br.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,t));default:Fr(e,r,h,o)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Cm(e,n,t,r);case"html":return i.insertionMode===0&&e.push("<!DOCTYPE html>"),Cm(e,n,t,r);default:if(t.indexOf("-")===-1&&typeof n.is!="string")return Cm(e,n,t,r);e.push(co(t)),s=o=null;for(c in n)if(br.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":ER(e,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:kR(c)&&typeof a!="function"&&typeof a!="symbol"&&e.push(" ",c,'="',ar(a),'"')}return e.push(">"),Oh(e,s,o),o}}function qA(e,t,n){if(e.push('<!--$?--><template id="'),n===null)throw Error(je(395));return e.push(n),e.push('"></template>')}function R7(e,t,n,r){switch(n.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');default:throw Error(je(397))}}function _7(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(je(397))}}var D7=/[<\u2028\u2029]/g;function ym(e){return JSON.stringify(e).replace(D7,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function P7(e,t){return t=t===void 0?"":t,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:t+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}function QA(e,t,n,r){return n.generateStaticMarkup?(e.push(ar(t)),!1):(t===""?e=r:(r&&e.push("<!-- -->"),e.push(ar(t)),e=!0),e)}var xd=Object.assign,N7=Symbol.for("react.element"),TR=Symbol.for("react.portal"),RR=Symbol.for("react.fragment"),_R=Symbol.for("react.strict_mode"),DR=Symbol.for("react.profiler"),PR=Symbol.for("react.provider"),NR=Symbol.for("react.context"),BR=Symbol.for("react.forward_ref"),OR=Symbol.for("react.suspense"),FR=Symbol.for("react.suspense_list"),MR=Symbol.for("react.memo"),X1=Symbol.for("react.lazy"),B7=Symbol.for("react.scope"),O7=Symbol.for("react.debug_trace_mode"),F7=Symbol.for("react.legacy_hidden"),M7=Symbol.for("react.default_value"),ew=Symbol.iterator;function wC(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case RR:return"Fragment";case TR:return"Portal";case DR:return"Profiler";case _R:return"StrictMode";case OR:return"Suspense";case FR:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case NR:return(e.displayName||"Context")+".Consumer";case PR:return(e._context.displayName||"Context")+".Provider";case BR:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case MR:return t=e.displayName||null,t!==null?t:wC(e.type)||"Memo";case X1:t=e._payload,e=e._init;try{return wC(e(t))}catch{}}return null}var LR={};function tw(e,t){if(e=e.contextTypes,!e)return LR;var n={},r;for(r in e)n[r]=t[r];return n}var cl=null;function Up(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var n=t.parent;if(e===null){if(n!==null)throw Error(je(401))}else{if(n===null)throw Error(je(401));Up(e,n)}t.context._currentValue2=t.value}}function UR(e){e.context._currentValue2=e.parentValue,e=e.parent,e!==null&&UR(e)}function VR(e){var t=e.parent;t!==null&&VR(t),e.context._currentValue2=e.value}function GR(e,t){if(e.context._currentValue2=e.parentValue,e=e.parent,e===null)throw Error(je(402));e.depth===t.depth?Up(e,t):GR(e,t)}function WR(e,t){var n=t.parent;if(n===null)throw Error(je(402));e.depth===n.depth?Up(e,n):WR(e,n),t.context._currentValue2=t.value}function G0(e){var t=cl;t!==e&&(t===null?VR(e):e===null?UR(t):t.depth===e.depth?Up(t,e):t.depth>e.depth?GR(t,e):WR(t,e),cl=e)}var nw={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function rw(e,t,n,r){var i=e.state!==void 0?e.state:null;e.updater=nw,e.props=n,e.state=i;var o={queue:[],replace:!1};e._reactInternals=o;var s=t.contextType;if(e.context=typeof s=="object"&&s!==null?s._currentValue2:r,s=t.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:xd({},i,s),e.state=i),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&nw.enqueueReplaceState(e,e.state,null),o.queue!==null&&0<o.queue.length)if(t=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&t.length===1)e.state=t[0];else{for(o=s?t[0]:e.state,i=!0,s=s?1:0;s<t.length;s++){var a=t[s];a=typeof a=="function"?a.call(e,o,n,r):a,a!=null&&(i?(i=!1,o=xd({},o,a)):xd(o,a))}e.state=o}else o.queue=null}var L7={id:1,overflow:""};function SC(e,t,n){var r=e.id;e=e.overflow;var i=32-Fh(r)-1;r&=~(1<<i),n+=1;var o=32-Fh(t)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-Fh(t)+i|n<<i|r,overflow:o+e}}return{id:1<<o|n<<i|r,overflow:e}}var Fh=Math.clz32?Math.clz32:G7,U7=Math.log,V7=Math.LN2;function G7(e){return e>>>=0,e===0?32:31-(U7(e)/V7|0)|0}function W7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var j7=typeof Object.is=="function"?Object.is:W7,Ls=null,K1=null,Mh=null,kt=null,nd=!1,W0=!1,Kd=0,va=null,Vp=0;function tl(){if(Ls===null)throw Error(je(321));return Ls}function iw(){if(0<Vp)throw Error(je(312));return{memoizedState:null,queue:null,next:null}}function J1(){return kt===null?Mh===null?(nd=!1,Mh=kt=iw()):(nd=!0,kt=Mh):kt.next===null?(nd=!1,kt=kt.next=iw()):(nd=!0,kt=kt.next),kt}function Y1(){K1=Ls=null,W0=!1,Mh=null,Vp=0,kt=va=null}function jR(e,t){return typeof t=="function"?t(e):t}function ow(e,t,n){if(Ls=tl(),kt=J1(),nd){var r=kt.queue;if(t=r.dispatch,va!==null&&(n=va.get(r),n!==void 0)){va.delete(r),r=kt.memoizedState;do r=e(r,n.action),n=n.next;while(n!==null);return kt.memoizedState=r,[r,t]}return[kt.memoizedState,t]}return e=e===jR?typeof t=="function"?t():t:n!==void 0?n(t):t,kt.memoizedState=e,e=kt.queue={last:null,dispatch:null},e=e.dispatch=z7.bind(null,Ls,e),[kt.memoizedState,e]}function sw(e,t){if(Ls=tl(),kt=J1(),t=t===void 0?null:t,kt!==null){var n=kt.memoizedState;if(n!==null&&t!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!j7(t[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return e=e(),kt.memoizedState=[e,t],e}function z7(e,t,n){if(25<=Vp)throw Error(je(301));if(e===Ls)if(W0=!0,e={action:n,next:null},va===null&&(va=new Map),n=va.get(t),n===void 0)va.set(t,e);else{for(t=n;t.next!==null;)t=t.next;t.next=e}}function H7(){throw Error(je(394))}function ih(){}var aw={readContext:function(e){return e._currentValue2},useContext:function(e){return tl(),e._currentValue2},useMemo:sw,useReducer:ow,useRef:function(e){Ls=tl(),kt=J1();var t=kt.memoizedState;return t===null?(e={current:e},kt.memoizedState=e):t},useState:function(e){return ow(jR,e)},useInsertionEffect:ih,useLayoutEffect:function(){},useCallback:function(e,t){return sw(function(){return e},t)},useImperativeHandle:ih,useEffect:ih,useDebugValue:ih,useDeferredValue:function(e){return tl(),e},useTransition:function(){return tl(),[!1,H7]},useId:function(){var e=K1.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Fh(e)-1)).toString(32)+t;var n=Lh;if(n===null)throw Error(je(404));return t=Kd++,e=":"+n.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return tl(),t(e._source)},useSyncExternalStore:function(e,t,n){if(n===void 0)throw Error(je(407));return n()}},Lh=null,xm=SR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Z7(e){return console.error(e),null}function rd(){}function $7(e,t,n,r,i,o,s,a,l){var c=[],u=new Set;return t={destination:null,responseState:t,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?Z7:i,onAllReady:rd,onShellReady:s===void 0?rd:s,onShellError:rd,onFatalError:rd},n=j0(t,0,null,n,!1,!1),n.parentFlushed=!0,e=q1(t,e,null,n,u,LR,null,L7),c.push(e),t}function q1(e,t,n,r,i,o,s,a){e.allPendingTasks++,n===null?e.pendingRootTasks++:n.pendingTasks++;var l={node:t,ping:function(){var c=e.pingedTasks;c.push(l),c.length===1&&ZR(e)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function j0(e,t,n,r,i,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Jd(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function z0(e,t){var n=e.onShellError;n(t),n=e.onFatalError,n(t),e.destination!==null?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function lw(e,t,n,r,i){for(Ls={},K1=t,Kd=0,e=n(r,i);W0;)W0=!1,Kd=0,Vp+=1,kt=null,e=n(r,i);return Y1(),e}function cw(e,t,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=t.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(je(108,wC(r)||"Unknown",a));r=xd({},s,n)}t.legacyContext=r,jr(e,t,i),t.legacyContext=s}else jr(e,t,i)}function uw(e,t){if(e&&e.defaultProps){t=xd({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function kC(e,t,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=tw(n,t.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue2:i),rw(o,n,r,i),cw(e,t,o,n)}else{o=tw(n,t.legacyContext),i=lw(e,t,n,r,o);var s=Kd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)rw(i,n,r,o),cw(e,t,i,n);else if(s){r=t.treeContext,t.treeContext=SC(r,1,0);try{jr(e,t,i)}finally{t.treeContext=r}}else jr(e,t,i)}else if(typeof n=="string"){switch(i=t.blockedSegment,o=T7(i.chunks,n,r,e.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=S7(s,n,r),EC(e,t,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case F7:case O7:case _R:case DR:case RR:jr(e,t,r.children);return;case FR:jr(e,t,r.children);return;case B7:throw Error(je(343));case OR:e:{n=t.blockedBoundary,i=t.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=j0(e,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=j0(e,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=c;try{if(EC(e,t,r),e.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),c.status=1,H0(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=Jd(e,u)}finally{t.blockedBoundary=n,t.blockedSegment=i}t=q1(e,o,n,l,s,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case BR:if(r=lw(e,t,n.render,r,i),Kd!==0){n=t.treeContext,t.treeContext=SC(n,1,0);try{jr(e,t,r)}finally{t.treeContext=n}}else jr(e,t,r);return;case MR:n=n.type,r=uw(n,r),kC(e,t,n,r,i);return;case PR:if(i=r.children,n=n._context,r=r.value,o=n._currentValue2,n._currentValue2=r,s=cl,cl=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},t.context=r,jr(e,t,i),e=cl,e===null)throw Error(je(403));r=e.parentValue,e.context._currentValue2=r===M7?e.context._defaultValue:r,e=cl=e.parent,t.context=e;return;case NR:r=r.children,r=r(n._currentValue2),jr(e,t,r);return;case X1:i=n._init,n=i(n._payload),r=uw(n,r),kC(e,t,n,r,void 0);return}throw Error(je(130,n==null?n:typeof n,""))}}function jr(e,t,n){if(t.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case N7:kC(e,t,n.type,n.props,n.ref);return;case TR:throw Error(je(257));case X1:var r=n._init;n=r(n._payload),jr(e,t,n);return}if(AC(n)){dw(e,t,n);return}if(n===null||typeof n!="object"?r=null:(r=ew&&n[ew]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);dw(e,t,i)}return}throw e=Object.prototype.toString.call(n),Error(je(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}typeof n=="string"?(r=t.blockedSegment,r.lastPushedText=QA(t.blockedSegment.chunks,n,e.responseState,r.lastPushedText)):typeof n=="number"&&(r=t.blockedSegment,r.lastPushedText=QA(t.blockedSegment.chunks,""+n,e.responseState,r.lastPushedText))}function dw(e,t,n){for(var r=n.length,i=0;i<r;i++){var o=t.treeContext;t.treeContext=SC(o,r,i);try{EC(e,t,n[i])}finally{t.treeContext=o}}}function EC(e,t,n){var r=t.blockedSegment.formatContext,i=t.legacyContext,o=t.context;try{return jr(e,t,n)}catch(l){if(Y1(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=t.blockedSegment,a=j0(e,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,e=q1(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,G0(o)}else throw t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,G0(o),l}}function X7(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,HR(this,t,e)}function zR(e,t,n){var r=e.blockedBoundary;e.blockedSegment.status=3,r===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=n===void 0?Error(je(432)):n,r.errorDigest=t.onError(e),r.parentFlushed&&t.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return zR(i,t,n)}),r.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(r=t.onAllReady,r()))}function H0(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,n.status===1&&H0(e,n)}else e.completedSegments.push(t)}function HR(e,t,n){if(t===null){if(n.parentFlushed){if(e.completedRootSegment!==null)throw Error(je(389));e.completedRootSegment=n}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=rd,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(n.parentFlushed&&n.status===1&&H0(t,n),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(X7,e),t.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(H0(t,n),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function ZR(e){if(e.status!==2){var t=cl,n=xm.current;xm.current=aw;var r=Lh;Lh=e.responseState;try{var i=e.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=e,l=s.blockedSegment;if(l.status===0){G0(s.context);try{jr(a,s,s.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),s.abortSet.delete(s),l.status=1,HR(a,s.blockedBoundary,l)}catch(p){if(Y1(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=Jd(a,d);if(u===null?z0(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),e.destination!==null&&Q1(e,e.destination)}catch(p){Jd(e,p),z0(e,p)}finally{Lh=r,xm.current=n,n===aw&&G0(t)}}}function oh(e,t,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=e.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=r.toString(16),t.push(e),t.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)t.push(r[o]);i=Gp(e,t,i)}for(;o<r.length-1;o++)t.push(r[o]);return o<r.length&&(i=t.push(r[o])),i;default:throw Error(je(390))}}function Gp(e,t,n){var r=n.boundary;if(r===null)return oh(e,t,n);if(r.parentFlushed=!0,r.forceClientRender)return e.responseState.generateStaticMarkup||(r=r.errorDigest,t.push("<!--$!-->"),t.push("<template"),r&&(t.push(' data-dgst="'),r=ar(r),t.push(r),t.push('"')),t.push("></template>")),oh(e,t,n),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e;if(0<r.pendingTasks){r.rootSegmentID=e.nextSegmentId++,0<r.completedSegments.length&&e.partialBoundaries.push(r);var i=e.responseState,o=i.nextSuspenseID++;return i=i.boundaryPrefix+o.toString(16),r=r.id=i,qA(t,e.responseState,r),oh(e,t,n),t.push("<!--/$-->")}if(r.byteSize>e.progressiveChunkSize)return r.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(r),qA(t,e.responseState,r.id),oh(e,t,n),t.push("<!--/$-->");if(e.responseState.generateStaticMarkup||t.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(je(391));return Gp(e,t,n[0]),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e}function fw(e,t,n){return R7(t,e.responseState,n.formatContext,n.id),Gp(e,t,n),_7(t,n.formatContext)}function hw(e,t,n){for(var r=n.completedSegments,i=0;i<r.length;i++)$R(e,t,n,r[i]);if(r.length=0,e=e.responseState,r=n.id,n=n.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(je(395));return n=n.toString(16),t.push(r),t.push('","'),t.push(e.segmentPrefix),t.push(n),t.push('")<\/script>')}function $R(e,t,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(je(392));return fw(e,t,r)}return fw(e,t,r),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),i=i.toString(16),t.push(i),t.push('","'),t.push(e.placeholderPrefix),t.push(i),t.push('")<\/script>')}function Q1(e,t){try{var n=e.completedRootSegment;if(n!==null&&e.pendingRootTasks===0){Gp(e,t,n),e.completedRootSegment=null;var r=e.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)t.push(r[n]);n<r.length&&t.push(r[n])}var i=e.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=t;var a=e.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(je(395));if(r.push(l),r.push('"'),c||u||d){r.push(",");var f=ym(c||"");r.push(f)}if(u||d){r.push(",");var h=ym(u||"");r.push(h)}if(d){r.push(",");var p=ym(d);r.push(p)}if(!r.push(")<\/script>")){e.destination=null,o++,i.splice(0,o);return}}i.splice(0,o);var g=e.completedBoundaries;for(o=0;o<g.length;o++)if(!hw(e,t,g[o])){e.destination=null,o++,g.splice(0,o);return}g.splice(0,o);var C=e.partialBoundaries;for(o=0;o<C.length;o++){var v=C[o];e:{i=e,s=t;var m=v.completedSegments;for(a=0;a<m.length;a++)if(!$R(i,s,v,m[a])){a++,m.splice(0,a);var y=!1;break e}m.splice(0,a),y=!0}if(!y){e.destination=null,o++,C.splice(0,o);return}}C.splice(0,o);var x=e.completedBoundaries;for(o=0;o<x.length;o++)if(!hw(e,t,x[o])){e.destination=null,o++,x.splice(0,o);return}x.splice(0,o)}finally{e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.push(null)}}function K7(e,t){try{var n=e.abortableTasks;n.forEach(function(r){return zR(r,e,t)}),n.clear(),e.destination!==null&&Q1(e,e.destination)}catch(r){Jd(e,r),z0(e,r)}}function J7(){}function XR(e,t,n,r){var i=!1,o=null,s="",a={push:function(c){return c!==null&&(s+=c),!0},destroy:function(c){i=!0,o=c}},l=!1;if(e=$7(e,P7(n,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,J7,void 0,function(){l=!0}),ZR(e),K7(e,r),e.status===1)e.status=2,a.destroy(e.fatalError);else if(e.status!==2&&e.destination===null){e.destination=a;try{Q1(e,a)}catch(c){Jd(e,c),z0(e,c)}}if(i)throw o;if(!l)throw Error(je(426));return s}fu.renderToNodeStream=function(){throw Error(je(207))};fu.renderToStaticMarkup=function(e,t){return XR(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};fu.renderToStaticNodeStream=function(){throw Error(je(208))};fu.renderToString=function(e,t){return XR(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};fu.version="18.3.1";var ex={},KR=S;function Xe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zr=null,Hr=0;function _e(e,t){if(t.length!==0)if(512<t.length)0<Hr&&(e.enqueue(new Uint8Array(zr.buffer,0,Hr)),zr=new Uint8Array(512),Hr=0),e.enqueue(t);else{var n=zr.length-Hr;n<t.length&&(n===0?e.enqueue(zr):(zr.set(t.subarray(0,n),Hr),e.enqueue(zr),t=t.subarray(n)),zr=new Uint8Array(512),Hr=0),zr.set(t,Hr),Hr+=t.length}}function Mt(e,t){return _e(e,t),!0}function pw(e){zr&&0<Hr&&(e.enqueue(new Uint8Array(zr.buffer,0,Hr)),zr=null,Hr=0)}var JR=new TextEncoder;function Ke(e){return JR.encode(e)}function ye(e){return JR.encode(e)}function YR(e,t){typeof e.error=="function"?e.error(t):e.close()}var Ar=Object.prototype.hasOwnProperty,Y7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gw={},mw={};function qR(e){return Ar.call(mw,e)?!0:Ar.call(gw,e)?!1:Y7.test(e)?mw[e]=!0:(gw[e]=!0,!1)}function Cr(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Vn[e]=new Cr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Vn[t]=new Cr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Vn[e]=new Cr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Vn[e]=new Cr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Vn[e]=new Cr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Vn[e]=new Cr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Vn[e]=new Cr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Vn[e]=new Cr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Vn[e]=new Cr(e,5,!1,e.toLowerCase(),null,!1,!1)});var tx=/[\-:]([a-z])/g;function nx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(tx,nx);Vn[t]=new Cr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(tx,nx);Vn[t]=new Cr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(tx,nx);Vn[t]=new Cr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Vn[e]=new Cr(e,1,!1,e.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new Cr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Vn[e]=new Cr(e,1,!1,e.toLowerCase(),null,!0,!0)});var Uh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},q7=["Webkit","ms","Moz","O"];Object.keys(Uh).forEach(function(e){q7.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Uh[t]=Uh[e]})});var Q7=/["'&<>]/;function Bn(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=Q7.exec(e);if(t){var n="",r,i=0;for(r=t.index;r<e.length;r++){switch(e.charCodeAt(r)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==r&&(n+=e.substring(i,r)),i=r+1,n+=t}e=i!==r?n+e.substring(i,r):n}return e}var eU=/([A-Z])/g,tU=/^ms-/,TC=Array.isArray,nU=ye("<script>"),rU=ye("<\/script>"),iU=ye('<script src="'),oU=ye('<script type="module" src="'),vw=ye('" async=""><\/script>'),sU=/(<\/|<)(s)(cript)/gi;function aU(e,t,n,r){return""+t+(n==="s"?"\\u0073":"\\u0053")+r}function lU(e,t,n,r,i){e=e===void 0?"":e,t=t===void 0?nU:ye('<script nonce="'+Bn(t)+'">');var o=[];if(n!==void 0&&o.push(t,Ke((""+n).replace(sU,aU)),rU),r!==void 0)for(n=0;n<r.length;n++)o.push(iU,Ke(Bn(r[n])),vw);if(i!==void 0)for(r=0;r<i.length;r++)o.push(oU,Ke(Bn(i[r])),vw);return{bootstrapChunks:o,startInlineScript:t,placeholderPrefix:ye(e+"P:"),segmentPrefix:ye(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function uo(e,t){return{insertionMode:e,selectedValue:t}}function cU(e){return uo(e==="http://www.w3.org/2000/svg"?2:e==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function uU(e,t,n){switch(t){case"select":return uo(1,n.value!=null?n.value:n.defaultValue);case"svg":return uo(2,null);case"math":return uo(3,null);case"foreignObject":return uo(1,null);case"table":return uo(4,null);case"thead":case"tbody":case"tfoot":return uo(5,null);case"colgroup":return uo(7,null);case"tr":return uo(6,null)}return 4<=e.insertionMode||e.insertionMode===0?uo(1,null):e}var rx=ye("<!-- -->");function Cw(e,t,n,r){return t===""?r:(r&&e.push(rx),e.push(Ke(Bn(t))),!0)}var yw=new Map,dU=ye(' style="'),xw=ye(":"),fU=ye(";");function QR(e,t,n){if(typeof n!="object")throw Error(Xe(62));t=!0;for(var r in n)if(Ar.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Ke(Bn(r));i=Ke(Bn((""+i).trim()))}else{o=r;var s=yw.get(o);s!==void 0||(s=ye(Bn(o.replace(eU,"-$1").toLowerCase().replace(tU,"-ms-"))),yw.set(o,s)),o=s,i=typeof i=="number"?i===0||Ar.call(Uh,r)?Ke(""+i):Ke(i+"px"):Ke(Bn((""+i).trim()))}t?(t=!1,e.push(dU,o,xw,i)):e.push(fU,o,xw,i)}}t||e.push(nl)}var sa=ye(" "),tc=ye('="'),nl=ye('"'),Iw=ye('=""');function Mr(e,t,n,r){switch(n){case"style":QR(e,t,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(t=Vn.hasOwnProperty(n)?Vn[n]:null,t!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=Ke(t.attributeName),t.type){case 3:r&&e.push(sa,n,Iw);break;case 4:r===!0?e.push(sa,n,Iw):r!==!1&&e.push(sa,n,tc,Ke(Bn(r)),nl);break;case 5:isNaN(r)||e.push(sa,n,tc,Ke(Bn(r)),nl);break;case 6:!isNaN(r)&&1<=r&&e.push(sa,n,tc,Ke(Bn(r)),nl);break;default:t.sanitizeURL&&(r=""+r),e.push(sa,n,tc,Ke(Bn(r)),nl)}}else if(qR(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(t=n.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(sa,Ke(n),tc,Ke(Bn(r)),nl)}}}var aa=ye(">"),bw=ye("/>");function Vh(e,t,n){if(t!=null){if(n!=null)throw Error(Xe(60));if(typeof t!="object"||!("__html"in t))throw Error(Xe(61));t=t.__html,t!=null&&e.push(Ke(""+t))}}function hU(e){var t="";return KR.Children.forEach(e,function(n){n!=null&&(t+=n)}),t}var Im=ye(' selected=""');function bm(e,t,n,r){e.push(fo(n));var i=n=null,o;for(o in t)if(Ar.call(t,o)){var s=t[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Mr(e,r,o,s)}}return e.push(aa),Vh(e,i,n),typeof n=="string"?(e.push(Ke(Bn(n))),null):n}var Am=ye(`
`),pU=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Aw=new Map;function fo(e){var t=Aw.get(e);if(t===void 0){if(!pU.test(e))throw Error(Xe(65,e));t=ye("<"+e),Aw.set(e,t)}return t}var gU=ye("<!DOCTYPE html>");function mU(e,t,n,r,i){switch(t){case"select":e.push(fo("select"));var o=null,s=null;for(u in n)if(Ar.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Mr(e,r,u,a)}}return e.push(aa),Vh(e,s,o),o;case"option":s=i.selectedValue,e.push(fo("option"));var l=a=null,c=null,u=null;for(o in n)if(Ar.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Mr(e,r,o,d)}}if(s!=null)if(n=l!==null?""+l:hU(a),TC(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){e.push(Im);break}}else""+s===n&&e.push(Im);else c&&e.push(Im);return e.push(aa),Vh(e,u,a),a;case"textarea":e.push(fo("textarea")),u=s=o=null;for(a in n)if(Ar.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(Xe(91));default:Mr(e,r,a,l)}if(o===null&&s!==null&&(o=s),e.push(aa),u!=null){if(o!=null)throw Error(Xe(92));if(TC(u)&&1<u.length)throw Error(Xe(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&e.push(Am),o!==null&&e.push(Ke(Bn(""+o))),null;case"input":e.push(fo("input")),l=u=a=o=null;for(s in n)if(Ar.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Mr(e,r,s,c)}return u!==null?Mr(e,r,"checked",u):l!==null&&Mr(e,r,"checked",l),o!==null?Mr(e,r,"value",o):a!==null&&Mr(e,r,"value",a),e.push(bw),null;case"menuitem":e.push(fo("menuitem"));for(var f in n)if(Ar.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(400));default:Mr(e,r,f,o)}return e.push(aa),null;case"title":e.push(fo("title")),o=null;for(d in n)if(Ar.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(Xe(434));default:Mr(e,r,d,s)}return e.push(aa),o;case"listing":case"pre":e.push(fo(t)),s=o=null;for(l in n)if(Ar.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Mr(e,r,l,a)}if(e.push(aa),s!=null){if(o!=null)throw Error(Xe(60));if(typeof s!="object"||!("__html"in s))throw Error(Xe(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?e.push(Am,Ke(n)):e.push(Ke(""+n)))}return typeof o=="string"&&o[0]===`
`&&e.push(Am),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(fo(t));for(var h in n)if(Ar.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(399,t));default:Mr(e,r,h,o)}return e.push(bw),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return bm(e,n,t,r);case"html":return i.insertionMode===0&&e.push(gU),bm(e,n,t,r);default:if(t.indexOf("-")===-1&&typeof n.is!="string")return bm(e,n,t,r);e.push(fo(t)),s=o=null;for(c in n)if(Ar.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":QR(e,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:qR(c)&&typeof a!="function"&&typeof a!="symbol"&&e.push(sa,Ke(c),tc,Ke(Bn(a)),nl)}return e.push(aa),Vh(e,s,o),o}}var vU=ye("</"),CU=ye(">"),yU=ye('<template id="'),xU=ye('"></template>'),IU=ye("<!--$-->"),bU=ye('<!--$?--><template id="'),AU=ye('"></template>'),wU=ye("<!--$!-->"),SU=ye("<!--/$-->"),kU=ye("<template"),EU=ye('"'),TU=ye(' data-dgst="');ye(' data-msg="');ye(' data-stck="');var RU=ye("></template>");function ww(e,t,n){if(_e(e,bU),n===null)throw Error(Xe(395));return _e(e,n),Mt(e,AU)}var _U=ye('<div hidden id="'),DU=ye('">'),PU=ye("</div>"),NU=ye('<svg aria-hidden="true" style="display:none" id="'),BU=ye('">'),OU=ye("</svg>"),FU=ye('<math aria-hidden="true" style="display:none" id="'),MU=ye('">'),LU=ye("</math>"),UU=ye('<table hidden id="'),VU=ye('">'),GU=ye("</table>"),WU=ye('<table hidden><tbody id="'),jU=ye('">'),zU=ye("</tbody></table>"),HU=ye('<table hidden><tr id="'),ZU=ye('">'),$U=ye("</tr></table>"),XU=ye('<table hidden><colgroup id="'),KU=ye('">'),JU=ye("</colgroup></table>");function YU(e,t,n,r){switch(n.insertionMode){case 0:case 1:return _e(e,_U),_e(e,t.segmentPrefix),_e(e,Ke(r.toString(16))),Mt(e,DU);case 2:return _e(e,NU),_e(e,t.segmentPrefix),_e(e,Ke(r.toString(16))),Mt(e,BU);case 3:return _e(e,FU),_e(e,t.segmentPrefix),_e(e,Ke(r.toString(16))),Mt(e,MU);case 4:return _e(e,UU),_e(e,t.segmentPrefix),_e(e,Ke(r.toString(16))),Mt(e,VU);case 5:return _e(e,WU),_e(e,t.segmentPrefix),_e(e,Ke(r.toString(16))),Mt(e,jU);case 6:return _e(e,HU),_e(e,t.segmentPrefix),_e(e,Ke(r.toString(16))),Mt(e,ZU);case 7:return _e(e,XU),_e(e,t.segmentPrefix),_e(e,Ke(r.toString(16))),Mt(e,KU);default:throw Error(Xe(397))}}function qU(e,t){switch(t.insertionMode){case 0:case 1:return Mt(e,PU);case 2:return Mt(e,OU);case 3:return Mt(e,LU);case 4:return Mt(e,GU);case 5:return Mt(e,zU);case 6:return Mt(e,$U);case 7:return Mt(e,JU);default:throw Error(Xe(397))}}var QU=ye('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),eV=ye('$RS("'),tV=ye('","'),nV=ye('")<\/script>'),rV=ye('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),iV=ye('$RC("'),oV=ye('","'),sV=ye('")<\/script>'),aV=ye('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),lV=ye('$RX("'),cV=ye('"'),uV=ye(")<\/script>"),wm=ye(","),dV=/[<\u2028\u2029]/g;function Sm(e){return JSON.stringify(e).replace(dV,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Id=Object.assign,fV=Symbol.for("react.element"),e_=Symbol.for("react.portal"),t_=Symbol.for("react.fragment"),n_=Symbol.for("react.strict_mode"),r_=Symbol.for("react.profiler"),i_=Symbol.for("react.provider"),o_=Symbol.for("react.context"),s_=Symbol.for("react.forward_ref"),a_=Symbol.for("react.suspense"),l_=Symbol.for("react.suspense_list"),c_=Symbol.for("react.memo"),ix=Symbol.for("react.lazy"),hV=Symbol.for("react.scope"),pV=Symbol.for("react.debug_trace_mode"),gV=Symbol.for("react.legacy_hidden"),mV=Symbol.for("react.default_value"),Sw=Symbol.iterator;function RC(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case t_:return"Fragment";case e_:return"Portal";case r_:return"Profiler";case n_:return"StrictMode";case a_:return"Suspense";case l_:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case o_:return(e.displayName||"Context")+".Consumer";case i_:return(e._context.displayName||"Context")+".Provider";case s_:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case c_:return t=e.displayName||null,t!==null?t:RC(e.type)||"Memo";case ix:t=e._payload,e=e._init;try{return RC(e(t))}catch{}}return null}var u_={};function kw(e,t){if(e=e.contextTypes,!e)return u_;var n={},r;for(r in e)n[r]=t[r];return n}var ul=null;function Wp(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var n=t.parent;if(e===null){if(n!==null)throw Error(Xe(401))}else{if(n===null)throw Error(Xe(401));Wp(e,n)}t.context._currentValue=t.value}}function d_(e){e.context._currentValue=e.parentValue,e=e.parent,e!==null&&d_(e)}function f_(e){var t=e.parent;t!==null&&f_(t),e.context._currentValue=e.value}function h_(e,t){if(e.context._currentValue=e.parentValue,e=e.parent,e===null)throw Error(Xe(402));e.depth===t.depth?Wp(e,t):h_(e,t)}function p_(e,t){var n=t.parent;if(n===null)throw Error(Xe(402));e.depth===n.depth?Wp(e,n):p_(e,n),t.context._currentValue=t.value}function Z0(e){var t=ul;t!==e&&(t===null?f_(e):e===null?d_(t):t.depth===e.depth?Wp(t,e):t.depth>e.depth?h_(t,e):p_(t,e),ul=e)}var Ew={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function Tw(e,t,n,r){var i=e.state!==void 0?e.state:null;e.updater=Ew,e.props=n,e.state=i;var o={queue:[],replace:!1};e._reactInternals=o;var s=t.contextType;if(e.context=typeof s=="object"&&s!==null?s._currentValue:r,s=t.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:Id({},i,s),e.state=i),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&Ew.enqueueReplaceState(e,e.state,null),o.queue!==null&&0<o.queue.length)if(t=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&t.length===1)e.state=t[0];else{for(o=s?t[0]:e.state,i=!0,s=s?1:0;s<t.length;s++){var a=t[s];a=typeof a=="function"?a.call(e,o,n,r):a,a!=null&&(i?(i=!1,o=Id({},o,a)):Id(o,a))}e.state=o}else o.queue=null}var vV={id:1,overflow:""};function _C(e,t,n){var r=e.id;e=e.overflow;var i=32-Gh(r)-1;r&=~(1<<i),n+=1;var o=32-Gh(t)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-Gh(t)+i|n<<i|r,overflow:o+e}}return{id:1<<o|n<<i|r,overflow:e}}var Gh=Math.clz32?Math.clz32:xV,CV=Math.log,yV=Math.LN2;function xV(e){return e>>>=0,e===0?32:31-(CV(e)/yV|0)|0}function IV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var bV=typeof Object.is=="function"?Object.is:IV,Us=null,ox=null,Wh=null,Et=null,id=!1,$0=!1,Yd=0,Ca=null,jp=0;function rl(){if(Us===null)throw Error(Xe(321));return Us}function Rw(){if(0<jp)throw Error(Xe(312));return{memoizedState:null,queue:null,next:null}}function sx(){return Et===null?Wh===null?(id=!1,Wh=Et=Rw()):(id=!0,Et=Wh):Et.next===null?(id=!1,Et=Et.next=Rw()):(id=!0,Et=Et.next),Et}function ax(){ox=Us=null,$0=!1,Wh=null,jp=0,Et=Ca=null}function g_(e,t){return typeof t=="function"?t(e):t}function _w(e,t,n){if(Us=rl(),Et=sx(),id){var r=Et.queue;if(t=r.dispatch,Ca!==null&&(n=Ca.get(r),n!==void 0)){Ca.delete(r),r=Et.memoizedState;do r=e(r,n.action),n=n.next;while(n!==null);return Et.memoizedState=r,[r,t]}return[Et.memoizedState,t]}return e=e===g_?typeof t=="function"?t():t:n!==void 0?n(t):t,Et.memoizedState=e,e=Et.queue={last:null,dispatch:null},e=e.dispatch=AV.bind(null,Us,e),[Et.memoizedState,e]}function Dw(e,t){if(Us=rl(),Et=sx(),t=t===void 0?null:t,Et!==null){var n=Et.memoizedState;if(n!==null&&t!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!bV(t[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return e=e(),Et.memoizedState=[e,t],e}function AV(e,t,n){if(25<=jp)throw Error(Xe(301));if(e===Us)if($0=!0,e={action:n,next:null},Ca===null&&(Ca=new Map),n=Ca.get(t),n===void 0)Ca.set(t,e);else{for(t=n;t.next!==null;)t=t.next;t.next=e}}function wV(){throw Error(Xe(394))}function sh(){}var Pw={readContext:function(e){return e._currentValue},useContext:function(e){return rl(),e._currentValue},useMemo:Dw,useReducer:_w,useRef:function(e){Us=rl(),Et=sx();var t=Et.memoizedState;return t===null?(e={current:e},Et.memoizedState=e):t},useState:function(e){return _w(g_,e)},useInsertionEffect:sh,useLayoutEffect:function(){},useCallback:function(e,t){return Dw(function(){return e},t)},useImperativeHandle:sh,useEffect:sh,useDebugValue:sh,useDeferredValue:function(e){return rl(),e},useTransition:function(){return rl(),[!1,wV]},useId:function(){var e=ox.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Gh(e)-1)).toString(32)+t;var n=jh;if(n===null)throw Error(Xe(404));return t=Yd++,e=":"+n.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return rl(),t(e._source)},useSyncExternalStore:function(e,t,n){if(n===void 0)throw Error(Xe(407));return n()}},jh=null,km=KR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function SV(e){return console.error(e),null}function od(){}function kV(e,t,n,r,i,o,s,a,l){var c=[],u=new Set;return t={destination:null,responseState:t,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?SV:i,onAllReady:o===void 0?od:o,onShellReady:s===void 0?od:s,onShellError:a===void 0?od:a,onFatalError:l===void 0?od:l},n=X0(t,0,null,n,!1,!1),n.parentFlushed=!0,e=lx(t,e,null,n,u,u_,null,vV),c.push(e),t}function lx(e,t,n,r,i,o,s,a){e.allPendingTasks++,n===null?e.pendingRootTasks++:n.pendingTasks++;var l={node:t,ping:function(){var c=e.pingedTasks;c.push(l),c.length===1&&C_(e)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function X0(e,t,n,r,i,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function qd(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function K0(e,t){var n=e.onShellError;n(t),n=e.onFatalError,n(t),e.destination!==null?(e.status=2,YR(e.destination,t)):(e.status=1,e.fatalError=t)}function Nw(e,t,n,r,i){for(Us={},ox=t,Yd=0,e=n(r,i);$0;)$0=!1,Yd=0,jp+=1,Et=null,e=n(r,i);return ax(),e}function Bw(e,t,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=t.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(Xe(108,RC(r)||"Unknown",a));r=Id({},s,n)}t.legacyContext=r,Zr(e,t,i),t.legacyContext=s}else Zr(e,t,i)}function Ow(e,t){if(e&&e.defaultProps){t=Id({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function DC(e,t,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=kw(n,t.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue:i),Tw(o,n,r,i),Bw(e,t,o,n)}else{o=kw(n,t.legacyContext),i=Nw(e,t,n,r,o);var s=Yd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)Tw(i,n,r,o),Bw(e,t,i,n);else if(s){r=t.treeContext,t.treeContext=_C(r,1,0);try{Zr(e,t,i)}finally{t.treeContext=r}}else Zr(e,t,i)}else if(typeof n=="string"){switch(i=t.blockedSegment,o=mU(i.chunks,n,r,e.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=uU(s,n,r),PC(e,t,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(vU,Ke(n),CU)}i.lastPushedText=!1}else{switch(n){case gV:case pV:case n_:case r_:case t_:Zr(e,t,r.children);return;case l_:Zr(e,t,r.children);return;case hV:throw Error(Xe(343));case a_:e:{n=t.blockedBoundary,i=t.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=X0(e,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=X0(e,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=c;try{if(PC(e,t,r),c.lastPushedText&&c.textEmbedded&&c.chunks.push(rx),c.status=1,J0(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=qd(e,u)}finally{t.blockedBoundary=n,t.blockedSegment=i}t=lx(e,o,n,l,s,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case s_:if(r=Nw(e,t,n.render,r,i),Yd!==0){n=t.treeContext,t.treeContext=_C(n,1,0);try{Zr(e,t,r)}finally{t.treeContext=n}}else Zr(e,t,r);return;case c_:n=n.type,r=Ow(n,r),DC(e,t,n,r,i);return;case i_:if(i=r.children,n=n._context,r=r.value,o=n._currentValue,n._currentValue=r,s=ul,ul=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},t.context=r,Zr(e,t,i),e=ul,e===null)throw Error(Xe(403));r=e.parentValue,e.context._currentValue=r===mV?e.context._defaultValue:r,e=ul=e.parent,t.context=e;return;case o_:r=r.children,r=r(n._currentValue),Zr(e,t,r);return;case ix:i=n._init,n=i(n._payload),r=Ow(n,r),DC(e,t,n,r,void 0);return}throw Error(Xe(130,n==null?n:typeof n,""))}}function Zr(e,t,n){if(t.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case fV:DC(e,t,n.type,n.props,n.ref);return;case e_:throw Error(Xe(257));case ix:var r=n._init;n=r(n._payload),Zr(e,t,n);return}if(TC(n)){Fw(e,t,n);return}if(n===null||typeof n!="object"?r=null:(r=Sw&&n[Sw]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);Fw(e,t,i)}return}throw e=Object.prototype.toString.call(n),Error(Xe(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}typeof n=="string"?(r=t.blockedSegment,r.lastPushedText=Cw(t.blockedSegment.chunks,n,e.responseState,r.lastPushedText)):typeof n=="number"&&(r=t.blockedSegment,r.lastPushedText=Cw(t.blockedSegment.chunks,""+n,e.responseState,r.lastPushedText))}function Fw(e,t,n){for(var r=n.length,i=0;i<r;i++){var o=t.treeContext;t.treeContext=_C(o,r,i);try{PC(e,t,n[i])}finally{t.treeContext=o}}}function PC(e,t,n){var r=t.blockedSegment.formatContext,i=t.legacyContext,o=t.context;try{return Zr(e,t,n)}catch(l){if(ax(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=t.blockedSegment,a=X0(e,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,e=lx(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,Z0(o)}else throw t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,Z0(o),l}}function EV(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,v_(this,t,e)}function m_(e,t,n){var r=e.blockedBoundary;e.blockedSegment.status=3,r===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=n===void 0?Error(Xe(432)):n,r.errorDigest=t.onError(e),r.parentFlushed&&t.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return m_(i,t,n)}),r.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(r=t.onAllReady,r()))}function J0(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,n.status===1&&J0(e,n)}else e.completedSegments.push(t)}function v_(e,t,n){if(t===null){if(n.parentFlushed){if(e.completedRootSegment!==null)throw Error(Xe(389));e.completedRootSegment=n}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=od,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(n.parentFlushed&&n.status===1&&J0(t,n),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(EV,e),t.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(J0(t,n),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function C_(e){if(e.status!==2){var t=ul,n=km.current;km.current=Pw;var r=jh;jh=e.responseState;try{var i=e.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=e,l=s.blockedSegment;if(l.status===0){Z0(s.context);try{Zr(a,s,s.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(rx),s.abortSet.delete(s),l.status=1,v_(a,s.blockedBoundary,l)}catch(p){if(ax(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=qd(a,d);if(u===null?K0(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),e.destination!==null&&cx(e,e.destination)}catch(p){qd(e,p),K0(e,p)}finally{jh=r,km.current=n,n===Pw&&Z0(t)}}}function ah(e,t,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=e.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,e=e.responseState,_e(t,yU),_e(t,e.placeholderPrefix),e=Ke(r.toString(16)),_e(t,e),Mt(t,xU);case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)_e(t,r[o]);i=zp(e,t,i)}for(;o<r.length-1;o++)_e(t,r[o]);return o<r.length&&(i=Mt(t,r[o])),i;default:throw Error(Xe(390))}}function zp(e,t,n){var r=n.boundary;if(r===null)return ah(e,t,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,Mt(t,wU),_e(t,kU),r&&(_e(t,TU),_e(t,Ke(Bn(r))),_e(t,EU)),Mt(t,RU),ah(e,t,n);else if(0<r.pendingTasks){r.rootSegmentID=e.nextSegmentId++,0<r.completedSegments.length&&e.partialBoundaries.push(r);var i=e.responseState,o=i.nextSuspenseID++;i=ye(i.boundaryPrefix+o.toString(16)),r=r.id=i,ww(t,e.responseState,r),ah(e,t,n)}else if(r.byteSize>e.progressiveChunkSize)r.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(r),ww(t,e.responseState,r.id),ah(e,t,n);else{if(Mt(t,IU),n=r.completedSegments,n.length!==1)throw Error(Xe(391));zp(e,t,n[0])}return Mt(t,SU)}function Mw(e,t,n){return YU(t,e.responseState,n.formatContext,n.id),zp(e,t,n),qU(t,n.formatContext)}function Lw(e,t,n){for(var r=n.completedSegments,i=0;i<r.length;i++)y_(e,t,n,r[i]);if(r.length=0,e=e.responseState,r=n.id,n=n.rootSegmentID,_e(t,e.startInlineScript),e.sentCompleteBoundaryFunction?_e(t,iV):(e.sentCompleteBoundaryFunction=!0,_e(t,rV)),r===null)throw Error(Xe(395));return n=Ke(n.toString(16)),_e(t,r),_e(t,oV),_e(t,e.segmentPrefix),_e(t,n),Mt(t,sV)}function y_(e,t,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Xe(392));return Mw(e,t,r)}return Mw(e,t,r),e=e.responseState,_e(t,e.startInlineScript),e.sentCompleteSegmentFunction?_e(t,eV):(e.sentCompleteSegmentFunction=!0,_e(t,QU)),_e(t,e.segmentPrefix),i=Ke(i.toString(16)),_e(t,i),_e(t,tV),_e(t,e.placeholderPrefix),_e(t,i),Mt(t,nV)}function cx(e,t){zr=new Uint8Array(512),Hr=0;try{var n=e.completedRootSegment;if(n!==null&&e.pendingRootTasks===0){zp(e,t,n),e.completedRootSegment=null;var r=e.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)_e(t,r[n]);n<r.length&&Mt(t,r[n])}var i=e.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=t;var a=e.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(_e(r,a.startInlineScript),a.sentClientRenderFunction?_e(r,lV):(a.sentClientRenderFunction=!0,_e(r,aV)),l===null)throw Error(Xe(395));_e(r,l),_e(r,cV),(c||u||d)&&(_e(r,wm),_e(r,Ke(Sm(c||"")))),(u||d)&&(_e(r,wm),_e(r,Ke(Sm(u||"")))),d&&(_e(r,wm),_e(r,Ke(Sm(d)))),Mt(r,uV)}i.splice(0,o);var f=e.completedBoundaries;for(o=0;o<f.length;o++)Lw(e,t,f[o]);f.splice(0,o),pw(t),zr=new Uint8Array(512),Hr=0;var h=e.partialBoundaries;for(o=0;o<h.length;o++){var p=h[o];e:{i=e,s=t;var g=p.completedSegments;for(a=0;a<g.length;a++)if(!y_(i,s,p,g[a])){a++,g.splice(0,a);var C=!1;break e}g.splice(0,a),C=!0}if(!C){e.destination=null,o++,h.splice(0,o);return}}h.splice(0,o);var v=e.completedBoundaries;for(o=0;o<v.length;o++)Lw(e,t,v[o]);v.splice(0,o)}finally{pw(t),e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.close()}}function Uw(e,t){try{var n=e.abortableTasks;n.forEach(function(r){return m_(r,e,t)}),n.clear(),e.destination!==null&&cx(e,e.destination)}catch(r){qd(e,r),K0(e,r)}}ex.renderToReadableStream=function(e,t){return new Promise(function(n,r){var i,o,s=new Promise(function(u,d){o=u,i=d}),a=kV(e,lU(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),cU(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,o,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,YR(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{cx(a,d)}catch(f){qd(a,f),K0(a,f)}}},cancel:function(){Uw(a)}},{highWaterMark:0});u.allReady=s,n(u)},function(u){s.catch(function(){}),r(u)},i);if(t&&t.signal){var l=t.signal,c=function(){Uw(a,l.reason),l.removeEventListener("abort",c)};l.addEventListener("abort",c)}C_(a)})};ex.version="18.3.1";var hu,x_;hu=fu,x_=ex;Ma.version=hu.version;Ma.renderToString=hu.renderToString;Ma.renderToStaticMarkup=hu.renderToStaticMarkup;Ma.renderToNodeStream=hu.renderToNodeStream;Ma.renderToStaticNodeStream=hu.renderToStaticNodeStream;Ma.renderToReadableStream=x_.renderToReadableStream;/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:I_,setPrototypeOf:Vw,isFrozen:TV,getPrototypeOf:RV,getOwnPropertyDescriptor:_V}=Object;let{freeze:hr,seal:yi,create:b_}=Object,{apply:NC,construct:BC}=typeof Reflect<"u"&&Reflect;hr||(hr=function(t){return t});yi||(yi=function(t){return t});NC||(NC=function(t,n,r){return t.apply(n,r)});BC||(BC=function(t,n){return new t(...n)});const lh=pr(Array.prototype.forEach),DV=pr(Array.prototype.lastIndexOf),Gw=pr(Array.prototype.pop),Fu=pr(Array.prototype.push),PV=pr(Array.prototype.splice),zh=pr(String.prototype.toLowerCase),Em=pr(String.prototype.toString),Ww=pr(String.prototype.match),Mu=pr(String.prototype.replace),NV=pr(String.prototype.indexOf),BV=pr(String.prototype.trim),wi=pr(Object.prototype.hasOwnProperty),tr=pr(RegExp.prototype.test),Lu=OV(TypeError);function pr(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return NC(e,t,r)}}function OV(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return BC(e,n)}}function Ye(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zh;Vw&&Vw(e,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i=="string"){const o=n(i);o!==i&&(TV(t)||(t[r]=o),i=o)}e[i]=!0}return e}function FV(e){for(let t=0;t<e.length;t++)wi(e,t)||(e[t]=null);return e}function Xo(e){const t=b_(null);for(const[n,r]of I_(e))wi(e,n)&&(Array.isArray(r)?t[n]=FV(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=Xo(r):t[n]=r);return t}function Uu(e,t){for(;e!==null;){const r=_V(e,t);if(r){if(r.get)return pr(r.get);if(typeof r.value=="function")return pr(r.value)}e=RV(e)}function n(){return null}return n}const jw=hr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Tm=hr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Rm=hr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),MV=hr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_m=hr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),LV=hr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),zw=hr(["#text"]),Hw=hr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Dm=hr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Zw=hr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ch=hr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),UV=yi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),VV=yi(/<%[\w\W]*|[\w\W]*%>/gm),GV=yi(/\$\{[\w\W]*/gm),WV=yi(/^data-[\-\w.\u00B7-\uFFFF]+$/),jV=yi(/^aria-[\-\w]+$/),A_=yi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),zV=yi(/^(?:\w+script|data):/i),HV=yi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),w_=yi(/^html$/i),ZV=yi(/^[a-z][.\w]*(-[.\w]+)+$/i);var $w=Object.freeze({__proto__:null,ARIA_ATTR:jV,ATTR_WHITESPACE:HV,CUSTOM_ELEMENT:ZV,DATA_ATTR:WV,DOCTYPE_NAME:w_,ERB_EXPR:VV,IS_ALLOWED_URI:A_,IS_SCRIPT_OR_DATA:zV,MUSTACHE_EXPR:UV,TMPLIT_EXPR:GV});const Vu={element:1,text:3,progressingInstruction:7,comment:8,document:9},$V=function(){return typeof window>"u"?null:window},XV=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Xw=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function S_(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$V();const t=pe=>S_(pe);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==Vu.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:h}=e,p=l.prototype,g=Uu(p,"cloneNode"),C=Uu(p,"remove"),v=Uu(p,"nextSibling"),m=Uu(p,"childNodes"),y=Uu(p,"parentNode");if(typeof s=="function"){const pe=n.createElement("template");pe.content&&pe.content.ownerDocument&&(n=pe.content.ownerDocument)}let x,b="";const{implementation:k,createNodeIterator:A,createDocumentFragment:E,getElementsByTagName:D}=n,{importNode:T}=r;let R=Xw();t.isSupported=typeof I_=="function"&&typeof y=="function"&&k&&k.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:P,ERB_EXPR:L,TMPLIT_EXPR:z,DATA_ATTR:Z,ARIA_ATTR:Q,IS_SCRIPT_OR_DATA:ie,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:q}=$w;let{IS_ALLOWED_URI:te}=$w,O=null;const j=Ye({},[...jw,...Tm,...Rm,..._m,...zw]);let J=null;const ee=Ye({},[...Hw,...Dm,...Zw,...ch]);let se=Object.seal(b_(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),me=null,Be=null,ae=!0,Dt=!0,Gt=!1,fn=!0,ze=!1,ot=!0,st=!1,he=!1,Ce=!1,Ve=!1,Ue=!1,Pe=!1,$e=!0,at=!1;const Qe="user-content-";let Wt=!0,jt=!1,wt={},an=null;const _=Ye({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let I=null;const w=Ye({},["audio","video","img","source","image","track"]);let B=null;const W=Ye({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Y="http://www.w3.org/1998/Math/MathML",ne="http://www.w3.org/2000/svg",Ne="http://www.w3.org/1999/xhtml";let tt=Ne,lt=!1,ht=null;const nt=Ye({},[Y,ne,Ne],Em);let Ii=Ye({},["mi","mo","mn","ms","mtext"]),io=Ye({},["annotation-xml"]);const Ka=Ye({},["title","style","font","a","script"]);let oi=null;const Iu=["application/xhtml+xml","text/html"],Hl="text/html";let Yt=null,si=null;const Xs=n.createElement("form"),Zo=function(U){return U instanceof RegExp||U instanceof Function},Ks=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(si&&si===U)){if((!U||typeof U!="object")&&(U={}),U=Xo(U),oi=Iu.indexOf(U.PARSER_MEDIA_TYPE)===-1?Hl:U.PARSER_MEDIA_TYPE,Yt=oi==="application/xhtml+xml"?Em:zh,O=wi(U,"ALLOWED_TAGS")?Ye({},U.ALLOWED_TAGS,Yt):j,J=wi(U,"ALLOWED_ATTR")?Ye({},U.ALLOWED_ATTR,Yt):ee,ht=wi(U,"ALLOWED_NAMESPACES")?Ye({},U.ALLOWED_NAMESPACES,Em):nt,B=wi(U,"ADD_URI_SAFE_ATTR")?Ye(Xo(W),U.ADD_URI_SAFE_ATTR,Yt):W,I=wi(U,"ADD_DATA_URI_TAGS")?Ye(Xo(w),U.ADD_DATA_URI_TAGS,Yt):w,an=wi(U,"FORBID_CONTENTS")?Ye({},U.FORBID_CONTENTS,Yt):_,me=wi(U,"FORBID_TAGS")?Ye({},U.FORBID_TAGS,Yt):Xo({}),Be=wi(U,"FORBID_ATTR")?Ye({},U.FORBID_ATTR,Yt):Xo({}),wt=wi(U,"USE_PROFILES")?U.USE_PROFILES:!1,ae=U.ALLOW_ARIA_ATTR!==!1,Dt=U.ALLOW_DATA_ATTR!==!1,Gt=U.ALLOW_UNKNOWN_PROTOCOLS||!1,fn=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ze=U.SAFE_FOR_TEMPLATES||!1,ot=U.SAFE_FOR_XML!==!1,st=U.WHOLE_DOCUMENT||!1,Ve=U.RETURN_DOM||!1,Ue=U.RETURN_DOM_FRAGMENT||!1,Pe=U.RETURN_TRUSTED_TYPE||!1,Ce=U.FORCE_BODY||!1,$e=U.SANITIZE_DOM!==!1,at=U.SANITIZE_NAMED_PROPS||!1,Wt=U.KEEP_CONTENT!==!1,jt=U.IN_PLACE||!1,te=U.ALLOWED_URI_REGEXP||A_,tt=U.NAMESPACE||Ne,Ii=U.MATHML_TEXT_INTEGRATION_POINTS||Ii,io=U.HTML_INTEGRATION_POINTS||io,se=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&Zo(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&Zo(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ze&&(Dt=!1),Ue&&(Ve=!0),wt&&(O=Ye({},zw),J=[],wt.html===!0&&(Ye(O,jw),Ye(J,Hw)),wt.svg===!0&&(Ye(O,Tm),Ye(J,Dm),Ye(J,ch)),wt.svgFilters===!0&&(Ye(O,Rm),Ye(J,Dm),Ye(J,ch)),wt.mathMl===!0&&(Ye(O,_m),Ye(J,Zw),Ye(J,ch))),U.ADD_TAGS&&(O===j&&(O=Xo(O)),Ye(O,U.ADD_TAGS,Yt)),U.ADD_ATTR&&(J===ee&&(J=Xo(J)),Ye(J,U.ADD_ATTR,Yt)),U.ADD_URI_SAFE_ATTR&&Ye(B,U.ADD_URI_SAFE_ATTR,Yt),U.FORBID_CONTENTS&&(an===_&&(an=Xo(an)),Ye(an,U.FORBID_CONTENTS,Yt)),Wt&&(O["#text"]=!0),st&&Ye(O,["html","head","body"]),O.table&&(Ye(O,["tbody"]),delete me.tbody),U.TRUSTED_TYPES_POLICY){if(typeof U.TRUSTED_TYPES_POLICY.createHTML!="function")throw Lu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof U.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Lu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=U.TRUSTED_TYPES_POLICY,b=x.createHTML("")}else x===void 0&&(x=XV(h,i)),x!==null&&typeof b=="string"&&(b=x.createHTML(""));hr&&hr(U),si=U}},Zl=Ye({},[...Tm,...Rm,...MV]),V=Ye({},[..._m,...LV]),H=function(U){let oe=y(U);(!oe||!oe.tagName)&&(oe={namespaceURI:tt,tagName:"template"});const Ae=zh(U.tagName),pt=zh(oe.tagName);return ht[U.namespaceURI]?U.namespaceURI===ne?oe.namespaceURI===Ne?Ae==="svg":oe.namespaceURI===Y?Ae==="svg"&&(pt==="annotation-xml"||Ii[pt]):!!Zl[Ae]:U.namespaceURI===Y?oe.namespaceURI===Ne?Ae==="math":oe.namespaceURI===ne?Ae==="math"&&io[pt]:!!V[Ae]:U.namespaceURI===Ne?oe.namespaceURI===ne&&!io[pt]||oe.namespaceURI===Y&&!Ii[pt]?!1:!V[Ae]&&(Ka[Ae]||!Zl[Ae]):!!(oi==="application/xhtml+xml"&&ht[U.namespaceURI]):!1},K=function(U){Fu(t.removed,{element:U});try{y(U).removeChild(U)}catch{C(U)}},le=function(U,oe){try{Fu(t.removed,{attribute:oe.getAttributeNode(U),from:oe})}catch{Fu(t.removed,{attribute:null,from:oe})}if(oe.removeAttribute(U),U==="is")if(Ve||Ue)try{K(oe)}catch{}else try{oe.setAttribute(U,"")}catch{}},ge=function(U){let oe=null,Ae=null;if(Ce)U="<remove></remove>"+U;else{const gt=Ww(U,/^[\r\n\t ]+/);Ae=gt&&gt[0]}oi==="application/xhtml+xml"&&tt===Ne&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");const pt=x?x.createHTML(U):U;if(tt===Ne)try{oe=new f().parseFromString(pt,oi)}catch{}if(!oe||!oe.documentElement){oe=k.createDocument(tt,"template",null);try{oe.documentElement.innerHTML=lt?b:pt}catch{}}const St=oe.body||oe.documentElement;return U&&Ae&&St.insertBefore(n.createTextNode(Ae),St.childNodes[0]||null),tt===Ne?D.call(oe,st?"html":"body")[0]:st?oe.documentElement:St},De=function(U){return A.call(U.ownerDocument||U,U,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Fe=function(U){return U instanceof d&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof u)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},ke=function(U){return typeof a=="function"&&U instanceof a};function Ie(pe,U,oe){lh(pe,Ae=>{Ae.call(t,U,oe,si)})}const be=function(U){let oe=null;if(Ie(R.beforeSanitizeElements,U,null),Fe(U))return K(U),!0;const Ae=Yt(U.nodeName);if(Ie(R.uponSanitizeElement,U,{tagName:Ae,allowedTags:O}),ot&&U.hasChildNodes()&&!ke(U.firstElementChild)&&tr(/<[/\w!]/g,U.innerHTML)&&tr(/<[/\w!]/g,U.textContent)||U.nodeType===Vu.progressingInstruction||ot&&U.nodeType===Vu.comment&&tr(/<[/\w]/g,U.data))return K(U),!0;if(!O[Ae]||me[Ae]){if(!me[Ae]&&Ge(Ae)&&(se.tagNameCheck instanceof RegExp&&tr(se.tagNameCheck,Ae)||se.tagNameCheck instanceof Function&&se.tagNameCheck(Ae)))return!1;if(Wt&&!an[Ae]){const pt=y(U)||U.parentNode,St=m(U)||U.childNodes;if(St&&pt){const gt=St.length;for(let An=gt-1;An>=0;--An){const er=g(St[An],!0);er.__removalCount=(U.__removalCount||0)+1,pt.insertBefore(er,v(U))}}}return K(U),!0}return U instanceof l&&!H(U)||(Ae==="noscript"||Ae==="noembed"||Ae==="noframes")&&tr(/<\/no(script|embed|frames)/i,U.innerHTML)?(K(U),!0):(ze&&U.nodeType===Vu.text&&(oe=U.textContent,lh([P,L,z],pt=>{oe=Mu(oe,pt," ")}),U.textContent!==oe&&(Fu(t.removed,{element:U.cloneNode()}),U.textContent=oe)),Ie(R.afterSanitizeElements,U,null),!1)},Re=function(U,oe,Ae){if($e&&(oe==="id"||oe==="name")&&(Ae in n||Ae in Xs))return!1;if(!(Dt&&!Be[oe]&&tr(Z,oe))){if(!(ae&&tr(Q,oe))){if(!J[oe]||Be[oe]){if(!(Ge(U)&&(se.tagNameCheck instanceof RegExp&&tr(se.tagNameCheck,U)||se.tagNameCheck instanceof Function&&se.tagNameCheck(U))&&(se.attributeNameCheck instanceof RegExp&&tr(se.attributeNameCheck,oe)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(oe))||oe==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&tr(se.tagNameCheck,Ae)||se.tagNameCheck instanceof Function&&se.tagNameCheck(Ae))))return!1}else if(!B[oe]){if(!tr(te,Mu(Ae,$,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&U!=="script"&&NV(Ae,"data:")===0&&I[U])){if(!(Gt&&!tr(ie,Mu(Ae,$,"")))){if(Ae)return!1}}}}}}return!0},Ge=function(U){return U!=="annotation-xml"&&Ww(U,q)},Je=function(U){Ie(R.beforeSanitizeAttributes,U,null);const{attributes:oe}=U;if(!oe||Fe(U))return;const Ae={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:J,forceKeepAttr:void 0};let pt=oe.length;for(;pt--;){const St=oe[pt],{name:gt,namespaceURI:An,value:er}=St,Or=Yt(gt),Js=er;let tn=gt==="value"?Js:BV(Js);if(Ae.attrName=Or,Ae.attrValue=tn,Ae.keepAttr=!0,Ae.forceKeepAttr=void 0,Ie(R.uponSanitizeAttribute,U,Ae),tn=Ae.attrValue,at&&(Or==="id"||Or==="name")&&(le(gt,U),tn=Qe+tn),ot&&tr(/((--!?|])>)|<\/(style|title)/i,tn)){le(gt,U);continue}if(Ae.forceKeepAttr)continue;if(!Ae.keepAttr){le(gt,U);continue}if(!fn&&tr(/\/>/i,tn)){le(gt,U);continue}ze&&lh([P,L,z],Pt=>{tn=Mu(tn,Pt," ")});const rt=Yt(U.nodeName);if(!Re(rt,Or,tn)){le(gt,U);continue}if(x&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!An)switch(h.getAttributeType(rt,Or)){case"TrustedHTML":{tn=x.createHTML(tn);break}case"TrustedScriptURL":{tn=x.createScriptURL(tn);break}}if(tn!==Js)try{An?U.setAttributeNS(An,gt,tn):U.setAttribute(gt,tn),Fe(U)?K(U):Gw(t.removed)}catch{le(gt,U)}}Ie(R.afterSanitizeAttributes,U,null)},hn=function pe(U){let oe=null;const Ae=De(U);for(Ie(R.beforeSanitizeShadowDOM,U,null);oe=Ae.nextNode();)Ie(R.uponSanitizeShadowNode,oe,null),be(oe),Je(oe),oe.content instanceof o&&pe(oe.content);Ie(R.afterSanitizeShadowDOM,U,null)};return t.sanitize=function(pe){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe=null,Ae=null,pt=null,St=null;if(lt=!pe,lt&&(pe="<!-->"),typeof pe!="string"&&!ke(pe))if(typeof pe.toString=="function"){if(pe=pe.toString(),typeof pe!="string")throw Lu("dirty is not a string, aborting")}else throw Lu("toString is not a function");if(!t.isSupported)return pe;if(he||Ks(U),t.removed=[],typeof pe=="string"&&(jt=!1),jt){if(pe.nodeName){const er=Yt(pe.nodeName);if(!O[er]||me[er])throw Lu("root node is forbidden and cannot be sanitized in-place")}}else if(pe instanceof a)oe=ge("<!---->"),Ae=oe.ownerDocument.importNode(pe,!0),Ae.nodeType===Vu.element&&Ae.nodeName==="BODY"||Ae.nodeName==="HTML"?oe=Ae:oe.appendChild(Ae);else{if(!Ve&&!ze&&!st&&pe.indexOf("<")===-1)return x&&Pe?x.createHTML(pe):pe;if(oe=ge(pe),!oe)return Ve?null:Pe?b:""}oe&&Ce&&K(oe.firstChild);const gt=De(jt?pe:oe);for(;pt=gt.nextNode();)be(pt),Je(pt),pt.content instanceof o&&hn(pt.content);if(jt)return pe;if(Ve){if(Ue)for(St=E.call(oe.ownerDocument);oe.firstChild;)St.appendChild(oe.firstChild);else St=oe;return(J.shadowroot||J.shadowrootmode)&&(St=T.call(r,St,!0)),St}let An=st?oe.outerHTML:oe.innerHTML;return st&&O["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&tr(w_,oe.ownerDocument.doctype.name)&&(An="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+An),ze&&lh([P,L,z],er=>{An=Mu(An,er," ")}),x&&Pe?x.createHTML(An):An},t.setConfig=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ks(pe),he=!0},t.clearConfig=function(){si=null,he=!1},t.isValidAttribute=function(pe,U,oe){si||Ks({});const Ae=Yt(pe),pt=Yt(U);return Re(Ae,pt,oe)},t.addHook=function(pe,U){typeof U=="function"&&Fu(R[pe],U)},t.removeHook=function(pe,U){if(U!==void 0){const oe=DV(R[pe],U);return oe===-1?void 0:PV(R[pe],oe,1)[0]}return Gw(R[pe])},t.removeHooks=function(pe){R[pe]=[]},t.removeAllHooks=function(){R=Xw()},t}var KV=S_();function JV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e}function OC(e,t){return Array(t+1).join(e)}function YV(e){return e.replace(/^\n*/,"")}function qV(e){for(var t=e.length;t>0&&e[t-1]===`
`;)t--;return e.substring(0,t)}var QV=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function ux(e){return dx(e,QV)}var k_=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function E_(e){return dx(e,k_)}function eG(e){return R_(e,k_)}var T_=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function tG(e){return dx(e,T_)}function nG(e){return R_(e,T_)}function dx(e,t){return t.indexOf(e.nodeName)>=0}function R_(e,t){return e.getElementsByTagName&&t.some(function(n){return e.getElementsByTagName(n).length})}var Qn={};Qn.paragraph={filter:"p",replacement:function(e){return`

`+e+`

`}};Qn.lineBreak={filter:"br",replacement:function(e,t,n){return n.br+`
`}};Qn.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,n){var r=Number(t.nodeName.charAt(1));if(n.headingStyle==="setext"&&r<3){var i=OC(r===1?"=":"-",e.length);return`

`+e+`
`+i+`

`}else return`

`+OC("#",r)+" "+e+`

`}};Qn.blockquote={filter:"blockquote",replacement:function(e){return e=e.replace(/^\n+|\n+$/g,""),e=e.replace(/^/gm,"> "),`

`+e+`

`}};Qn.list={filter:["ul","ol"],replacement:function(e,t){var n=t.parentNode;return n.nodeName==="LI"&&n.lastElementChild===t?`
`+e:`

`+e+`

`}};Qn.listItem={filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=n.bulletListMarker+"   ",i=t.parentNode;if(i.nodeName==="OL"){var o=i.getAttribute("start"),s=Array.prototype.indexOf.call(i.children,t);r=(o?Number(o)+s:s+1)+".  "}return r+e+(t.nextSibling&&!/\n$/.test(e)?`
`:"")}};Qn.indentedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="indented"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,n){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Qn.fencedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="fenced"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,n){for(var r=t.firstChild.getAttribute("class")||"",i=(r.match(/language-(\S+)/)||[null,""])[1],o=t.firstChild.textContent,s=n.fence.charAt(0),a=3,l=new RegExp("^"+s+"{3,}","gm"),c;c=l.exec(o);)c[0].length>=a&&(a=c[0].length+1);var u=OC(s,a);return`

`+u+i+`
`+o.replace(/\n$/,"")+`
`+u+`

`}};Qn.horizontalRule={filter:"hr",replacement:function(e,t,n){return`

`+n.hr+`

`}};Qn.inlineLink={filter:function(e,t){return t.linkStyle==="inlined"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t){var n=t.getAttribute("href");n&&(n=n.replace(/([()])/g,"\\$1"));var r=Y0(t.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+e+"]("+n+r+")"}};Qn.referenceLink={filter:function(e,t){return t.linkStyle==="referenced"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t,n){var r=t.getAttribute("href"),i=Y0(t.getAttribute("title"));i&&(i=' "'+i+'"');var o,s;switch(n.linkReferenceStyle){case"collapsed":o="["+e+"][]",s="["+e+"]: "+r+i;break;case"shortcut":o="["+e+"]",s="["+e+"]: "+r+i;break;default:var a=this.references.length+1;o="["+e+"]["+a+"]",s="["+a+"]: "+r+i}return this.references.push(s),o},references:[],append:function(e){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};Qn.emphasis={filter:["em","i"],replacement:function(e,t,n){return e.trim()?n.emDelimiter+e+n.emDelimiter:""}};Qn.strong={filter:["strong","b"],replacement:function(e,t,n){return e.trim()?n.strongDelimiter+e+n.strongDelimiter:""}};Qn.code={filter:function(e){var t=e.previousSibling||e.nextSibling,n=e.parentNode.nodeName==="PRE"&&!t;return e.nodeName==="CODE"&&!n},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",n="`",r=e.match(/`+/gm)||[];r.indexOf(n)!==-1;)n=n+"`";return n+t+e+t+n}};Qn.image={filter:"img",replacement:function(e,t){var n=Y0(t.getAttribute("alt")),r=t.getAttribute("src")||"",i=Y0(t.getAttribute("title")),o=i?' "'+i+'"':"";return r?"!["+n+"]("+r+o+")":""}};function Y0(e){return e?e.replace(/(\n+\s*)+/g,`
`):""}function __(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(var t in e.rules)this.array.push(e.rules[t])}__.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;var t;return(t=Pm(this.array,e,this.options))||(t=Pm(this._keep,e,this.options))||(t=Pm(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};function Pm(e,t,n){for(var r=0;r<e.length;r++){var i=e[r];if(rG(i,t,n))return i}}function rG(e,t,n){var r=e.filter;if(typeof r=="string"){if(r===t.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(e,t,n))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function iG(e){var t=e.element,n=e.isBlock,r=e.isVoid,i=e.isPre||function(d){return d.nodeName==="PRE"};if(!(!t.firstChild||i(t))){for(var o=null,s=!1,a=null,l=Kw(a,t,i);l!==t;){if(l.nodeType===3||l.nodeType===4){var c=l.data.replace(/[ \r\n\t]+/g," ");if((!o||/ $/.test(o.data))&&!s&&c[0]===" "&&(c=c.substr(1)),!c){l=Nm(l);continue}l.data=c,o=l}else if(l.nodeType===1)n(l)||l.nodeName==="BR"?(o&&(o.data=o.data.replace(/ $/,"")),o=null,s=!1):r(l)||i(l)?(o=null,s=!0):o&&(s=!1);else{l=Nm(l);continue}var u=Kw(a,l,i);a=l,l=u}o&&(o.data=o.data.replace(/ $/,""),o.data||Nm(o))}}function Nm(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function Kw(e,t,n){return e&&e.parentNode===t||n(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var fx=typeof window<"u"?window:{};function oG(){var e=fx.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0)}catch{}return t}function sG(){var e=function(){};return aG()?e.prototype.parseFromString=function(t){var n=new window.ActiveXObject("htmlfile");return n.designMode="on",n.open(),n.write(t),n.close(),n}:e.prototype.parseFromString=function(t){var n=document.implementation.createHTMLDocument("");return n.open(),n.write(t),n.close(),n},e}function aG(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch{fx.ActiveXObject&&(e=!0)}return e}var lG=oG()?fx.DOMParser:sG();function cG(e,t){var n;if(typeof e=="string"){var r=uG().parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html");n=r.getElementById("turndown-root")}else n=e.cloneNode(!0);return iG({element:n,isBlock:ux,isVoid:E_,isPre:t.preformattedCode?dG:null}),n}var Bm;function uG(){return Bm=Bm||new lG,Bm}function dG(e){return e.nodeName==="PRE"||e.nodeName==="CODE"}function fG(e,t){return e.isBlock=ux(e),e.isCode=e.nodeName==="CODE"||e.parentNode.isCode,e.isBlank=hG(e),e.flankingWhitespace=pG(e,t),e}function hG(e){return!E_(e)&&!tG(e)&&/^\s*$/i.test(e.textContent)&&!eG(e)&&!nG(e)}function pG(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var n=gG(e.textContent);return n.leadingAscii&&Jw("left",e,t)&&(n.leading=n.leadingNonAscii),n.trailingAscii&&Jw("right",e,t)&&(n.trailing=n.trailingNonAscii),{leading:n.leading,trailing:n.trailing}}function gG(e){var t=e.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function Jw(e,t,n){var r,i,o;return e==="left"?(r=t.previousSibling,i=/ $/):(r=t.nextSibling,i=/^ /),r&&(r.nodeType===3?o=i.test(r.nodeValue):n.preformattedCode&&r.nodeName==="CODE"?o=!1:r.nodeType===1&&!ux(r)&&(o=i.test(r.textContent))),o}var mG=Array.prototype.reduce,vG=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function q0(e){if(!(this instanceof q0))return new q0(e);var t={rules:Qn,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(n,r){return r.isBlock?`

`:""},keepReplacement:function(n,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(n,r){return r.isBlock?`

`+n+`

`:n}};this.options=JV({},t,e),this.rules=new __(this.options)}q0.prototype={turndown:function(e){if(!xG(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(e==="")return"";var t=D_.call(this,new cG(e,this.options));return CG.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else if(typeof e=="function")e(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return vG.reduce(function(t,n){return t.replace(n[0],n[1])},e)}};function D_(e){var t=this;return mG.call(e.childNodes,function(n,r){r=new fG(r,t.options);var i="";return r.nodeType===3?i=r.isCode?r.nodeValue:t.escape(r.nodeValue):r.nodeType===1&&(i=yG.call(t,r)),P_(n,i)},"")}function CG(e){var t=this;return this.rules.forEach(function(n){typeof n.append=="function"&&(e=P_(e,n.append(t.options)))}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function yG(e){var t=this.rules.forNode(e),n=D_.call(this,e),r=e.flankingWhitespace;return(r.leading||r.trailing)&&(n=n.trim()),r.leading+t.replacement(n,e,this.options)+r.trailing}function P_(e,t){var n=qV(e),r=YV(t),i=Math.max(e.length-n.length,t.length-r.length),o=`

`.substring(0,i);return n+o+r}function xG(e){return e!=null&&(typeof e=="string"||e.nodeType&&(e.nodeType===1||e.nodeType===9||e.nodeType===11))}const Yw=1,IG=2,ki=class ki extends Le.Component{constructor(n){super(n);M(this,"outputRef",Le.createRef());M(this,"messageKey",0);M(this,"unsubscribePrefs");M(this,"turndownService",new q0({headingStyle:"atx",emDelimiter:"*"}));M(this,"handlePreferencesChange",()=>{this.setState({localEchoActive:Yr.getState().general.localEcho})});M(this,"saveOutput",()=>{const n=this.state.output.map(i=>{let o="";const s=i.content.props;if(s.dangerouslySetInnerHTML&&s.dangerouslySetInnerHTML.__html)o=s.dangerouslySetInnerHTML.__html;else if(s.children){const a=s.children;Le.isValidElement(a)&&a.props.dangerouslySetInnerHTML&&a.props.dangerouslySetInnerHTML.__html?o=a.props.dangerouslySetInnerHTML.__html:Le.isValidElement(a)||Array.isArray(a)&&a.every(l=>Le.isValidElement(l)||typeof l=="string")?o=Ma.renderToStaticMarkup(a):typeof a=="string"?o=a:(console.warn("Unexpected children structure in OutputLine for saving:",a),o="")}return{type:i.type,htmlContent:o}}).filter(i=>i.htmlContent!==""),r={version:Yw,lines:n};localStorage.setItem(ki.LOCAL_STORAGE_KEY,JSON.stringify(r))});M(this,"loadOutput",()=>{const n=localStorage.getItem(ki.LOCAL_STORAGE_KEY);if(n)try{const r=JSON.parse(n);if(r&&typeof r=="object"&&"version"in r&&"lines"in r){const i=r;return i.version===Yw?i.lines.map(o=>{const s=this.messageKey++;return{id:s,type:o.type,content:Le.createElement("div",{key:s,className:`output-line output-line-${o.type}`,dangerouslySetInnerHTML:{__html:o.htmlContent}})}}):(console.warn(`Unsupported log version: ${i.version}. Discarding.`),localStorage.removeItem(ki.LOCAL_STORAGE_KEY),[])}else return Array.isArray(r)?(console.log("Loading old format output log."),r.map(o=>{const s=this.messageKey++;return{id:s,type:"serverMessage",content:Le.createElement("div",{key:s,className:"output-line output-line-serverMessage",dangerouslySetInnerHTML:{__html:o}})}})):(console.error("Saved output log is in an unrecognized format:",r),localStorage.removeItem(ki.LOCAL_STORAGE_KEY),[])}catch(r){return console.error("Failed to parse saved output log:",r),localStorage.removeItem(ki.LOCAL_STORAGE_KEY),[]}return[]});M(this,"addCommand",n=>{this.addToOutput([G.jsx("span",{className:"command","aria-live":"off",children:n})],"command",!1)});M(this,"addError",n=>this.addToOutput([G.jsxs("h2",{children:[" Error: ",n.message]})],"errorMessage"));M(this,"handleConnected",()=>this.addToOutput([G.jsx("h2",{children:" Connected"})],"systemInfo"));M(this,"handleDisconnected",()=>{this.addToOutput([G.jsx("h2",{children:" Disconnected"})],"systemInfo"),this.setState({sidebarVisible:!1})});M(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));M(this,"addCopyButtons",()=>{const n=this.outputRef.current;if(!n)return;n.querySelectorAll("blockquote:not(:has(.blockquote-copy-button))").forEach(i=>{const o=document.createElement("button");o.classList.add("blockquote-copy-button"),o.textContent="Copy",o.setAttribute("type","button"),window.getComputedStyle(i).position==="static"&&(i.style.position="relative"),i.appendChild(o)})});M(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});M(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;if(!n)return!1;const r=Math.ceil(n.scrollHeight-n.scrollTop),i=Math.ceil(n.clientHeight);return r<=i+IG});M(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});M(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&requestAnimationFrame(()=>{n.scrollTop=n.scrollHeight})});M(this,"handleMessage",n=>{if(!n)return;const r=p7(n,this.handleExitClick);this.addToOutput(r,"serverMessage")});M(this,"handleHtml",n=>{const r=KV.sanitize(n),i=G.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i],"serverMessage")});M(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});M(this,"handleDataTextClick",n=>{var s,a;const r=n.target,i=r.closest(".blockquote-copy-button");if(i instanceof HTMLButtonElement){n.preventDefault(),n.stopPropagation();const l=i.closest("blockquote");if(l){const c=l.cloneNode(!0),u=c.querySelector(".blockquote-copy-button");u&&u.remove();let d;if(l.dataset.contentType==="text/markdown"){const h=c.innerHTML;d=this.turndownService.turndown(h)}else d=c.textContent||"";navigator.clipboard.writeText(d.trim()).then(()=>{i.textContent="Copied!",i.classList.add("copied"),setTimeout(()=>{i.textContent="Copy",i.classList.remove("copied")},1500)}).catch(h=>{console.error("Failed to copy text: ",h),i.textContent="Error",setTimeout(()=>{i.textContent="Copy"},1500)})}return}const o=r.closest("a.command[data-text]");if(o instanceof HTMLAnchorElement){n.preventDefault();const l=o.dataset.text;l!=null&&(yd(l),(a=(s=this.props).focusInput)==null||a.call(s))}});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0,localEchoActive:Yr.getState().general.localEcho}}getSnapshotBeforeUpdate(n,r){return this.outputRef.current?(this.outputRef.current,this.isScrolledToBottom()):null}componentDidUpdate(n,r,i){i&&this.scrollToBottom();const o=this.state.output.slice(r.output.length);if(o.length>0){const s=o.filter(a=>this.state.localEchoActive||a.type!=="command").length;s>0&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState(a=>({newLinesCount:a.newLinesCount+s})))}this.saveOutput(),this.addCopyButtons()}componentDidMount(){const{client:n}=this.props;n.on("message",this.handleMessage),n.on("html",this.handleHtml),n.on("connect",this.handleConnected),n.on("disconnect",this.handleDisconnected),n.on("error",this.addError),n.on("command",this.addCommand),n.on("userlist",this.handleUserList),this.unsubscribePrefs=Yr.subscribe(this.handlePreferencesChange)}componentWillUnmount(){const{client:n}=this.props;this.unsubscribePrefs&&this.unsubscribePrefs(),n.removeListener("message",this.handleMessage),n.removeListener("html",this.handleHtml),n.removeListener("connect",this.handleConnected),n.removeListener("disconnect",this.handleDisconnected),n.removeListener("error",this.addError),n.removeListener("command",this.addCommand),n.removeListener("userlist",this.handleUserList)}sanitizeHtml(n){return new DOMParser().parseFromString(n,"text/html").body.textContent||""}addToOutput(n,r,i=!0){i&&n.forEach(o=>{if(Le.isValidElement(o)){const s=Ma.renderToString(o),a=this.sanitizeHtml(s);ZA(a)}else typeof o=="string"&&ZA(o)}),this.setState(o=>{const s=n.map(c=>{const u=this.messageKey++;return{id:u,type:r,content:G.jsx("div",{className:`output-line output-line-${r}`,children:c},u)}});return{output:[...o.output,...s].slice(-ki.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a"),a=new Date,l=a.toLocaleDateString(),c=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${l}-${c}.html`;s.download=d,s.href=o,s.click(),URL.revokeObjectURL(o),s.remove()}}clearLog(){this.setState({output:[]}),localStorage.removeItem(ki.LOCAL_STORAGE_KEY)}copyLog(){const n=this.outputRef.current;if(n){const r=n.innerText;navigator.clipboard.writeText(r).then(()=>{console.log("Log copied to clipboard.")}).catch(i=>{console.error("Failed to copy log: ",i),alert("Failed to copy log to clipboard. See console for details.")})}}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return G.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,onClick:this.handleDataTextClick,children:[this.state.output.filter(i=>this.state.localEchoActive||i.type!=="command").map(i=>i.content),this.state.newLinesCount>0&&G.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};M(ki,"MAX_OUTPUT_LENGTH",7500),M(ki,"LOCAL_STORAGE_KEY","outputLog");let FC=ki;const bG="58553c257cdb457e4257683428c7244686114719",zs=()=>{const[,e]=S.useReducer(t=>t+1,0);return S.useEffect(()=>Yr.subscribe(e),[]),[Yr.getState(),Yr.dispatch]},AG=()=>{const[e,t]=S.useState([]);return S.useEffect(()=>{const n=()=>{t(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),e},N_=({tabs:e})=>{const[t,n]=S.useState(0),r=S.useRef([]),i=S.useRef(!1);return S.useEffect(()=>{r.current=r.current.slice(0,e.length)},[e]),S.useEffect(()=>{const o=a=>{switch(a.key){case"ArrowLeft":i.current=!0,n(l=>l>0?l-1:e.length-1);break;case"ArrowRight":i.current=!0,n(l=>l<e.length-1?l+1:0);break;case"Home":i.current=!0,n(0);break;case"End":i.current=!0,n(e.length-1);break}},s=r.current[t];return s==null||s.addEventListener("keydown",o),()=>{s==null||s.removeEventListener("keydown",o)}},[e.length,t]),S.useEffect(()=>{var o;i.current&&((o=r.current[t])==null||o.focus())},[t]),G.jsxs("div",{className:"tabs-container",children:[G.jsx("div",{role:"tablist",children:e.map((o,s)=>G.jsx("button",{ref:a=>r.current[s]=a,role:"tab","aria-selected":t===s,id:o.id,"aria-controls":`${o.id}-panel`,onClick:()=>{console.log(`Tab onClick triggered for: ${o.label} (Index: ${s})`),i.current=!0,n(s),console.log(`Tab state updated to index: ${s}`)},tabIndex:t===s?void 0:-1,children:o.label},s))}),e.map((o,s)=>G.jsx("div",{role:"tabpanel",id:`${o.id}-panel`,"aria-labelledby":o.id,hidden:t!==s,children:G.jsx("div",{className:"sidebar-tab-content",children:o.content})},o.id))]})},wG=()=>{const[e,t]=zs();return G.jsxs("label",{children:[G.jsx("input",{type:"checkbox",checked:e.general.localEcho,onChange:n=>t({type:Lo.SetGeneral,data:{...e.general,localEcho:n.target.checked}})}),"Local Echo"]})},SG=()=>{const[e,t]=zs();return G.jsxs("label",{children:["Auto Read:",G.jsxs("select",{value:e.speech.autoreadMode,onChange:n=>t({type:Lo.SetSpeech,data:{...e.speech,autoreadMode:n.target.value}}),children:[G.jsx("option",{value:"off",children:"Off"}),G.jsx("option",{value:"unfocused",children:"Unfocused"}),G.jsx("option",{value:"all",children:"Always"})]})]})},kG=()=>{const[e,t]=zs(),n=AG();return G.jsxs("label",{children:["Voice:",G.jsx("select",{value:e.speech.voice,onChange:r=>t({type:Lo.SetSpeech,data:{...e.speech,voice:r.target.value}}),children:n.map(r=>G.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},EG=()=>{const[e,t]=zs();return G.jsxs("label",{children:["Rate (0.1 - 10.0):",G.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:e.speech.rate,onChange:n=>t({type:Lo.SetSpeech,data:{...e.speech,rate:parseFloat(n.target.value)}})})]})},TG=()=>{const[e,t]=zs();return G.jsxs("label",{children:["Pitch (0 - 2):",G.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:e.speech.pitch,onChange:n=>t({type:Lo.SetSpeech,data:{...e.speech,pitch:parseFloat(n.target.value)}})})]})},RG=()=>{const[e,t]=zs();return G.jsxs("label",{children:["Volume (0 - 1):",G.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:e.speech.volume,onChange:n=>t({type:Lo.SetSpeech,data:{...e.speech,volume:parseFloat(n.target.value)}})})]})},_G=()=>{const[e]=zs(),[t,n]=S.useState(!1),r=Le.useRef(!0);Le.useEffect(()=>()=>{r.current=!1,speechSynthesis.cancel()},[]);const i=()=>{if(t)return;n(!0),console.log("Preview button clicked");const o=()=>{if(!r.current)return;const s=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),a=speechSynthesis.getVoices();console.log("Available voices:",a.map(c=>c.name));const l=a.find(c=>c.name===e.speech.voice);console.log("Selected voice:",l?l.name:"Not found"),s.voice=l||null,s.rate=e.speech.rate,s.pitch=e.speech.pitch,s.volume=e.speech.volume,console.log("Utterance settings:",{voice:s.voice?s.voice.name:"Default",rate:s.rate,pitch:s.pitch,volume:s.volume}),s.onend=()=>{r.current&&(console.log("Speech ended"),n(!1))},s.onerror=c=>{r.current&&(console.error("Speech synthesis error:",c),n(!1))},speechSynthesis.cancel(),speechSynthesis.speak(s),console.log("Speech started")};if(speechSynthesis.getVoices().length>0)o();else{let s=()=>{s&&(speechSynthesis.onvoiceschanged=null,s=null,r.current&&o())};speechSynthesis.onvoiceschanged=s;const a=()=>{s&&(speechSynthesis.onvoiceschanged=null,s=null)};Le.useEffect(()=>a,[])}};return G.jsx("button",{onClick:i,disabled:t,children:t?"Playing...":"Preview Voice"})},DG=()=>G.jsxs("div",{children:[G.jsx(SG,{}),G.jsx("br",{}),G.jsx(kG,{}),G.jsx("br",{}),G.jsx(EG,{}),G.jsx("br",{}),G.jsx(TG,{}),G.jsx("br",{}),G.jsx(RG,{}),G.jsx("br",{}),G.jsx(_G,{})]}),PG=()=>{const[e,t]=zs(),n=e.editor,r=o=>{t({type:Lo.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{t({type:Lo.SetEditorAccessibilityMode,data:o.target.checked})};return G.jsxs("div",{children:[G.jsxs("label",{children:[G.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),G.jsx("br",{}),G.jsxs("label",{children:[G.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),G.jsx("br",{})]})},NG=()=>{const e=[{label:"General",content:G.jsx(wG,{})},{label:"Speech",content:G.jsx(DG,{})},{label:"Editor",content:G.jsx(PG,{})}];return G.jsx(N_,{tabs:e})};function BG(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function Qd(){return Qd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qd.apply(null,arguments)}var MC="data-focus-lock",B_="data-focus-lock-disabled",OG="data-no-focus-lock",FG="data-autofocus-inside",MG="data-no-autofocus";function Om(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function LG(e,t){var n=S.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}var UG=typeof window<"u"?S.useLayoutEffect:S.useEffect,qw=new WeakMap;function VG(e,t){var n=LG(null,function(r){return e.forEach(function(i){return Om(i,r)})});return UG(function(){var r=qw.get(n);if(r){var i=new Set(r),o=new Set(e),s=n.current;i.forEach(function(a){o.has(a)||Om(a,null)}),o.forEach(function(a){i.has(a)||Om(a,s)})}qw.set(n,e)},[e]),n}var Fm={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},LC=function(e,t){return LC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},LC(e,t)};function pu(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");LC(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var UC=function(){return UC=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},UC.apply(this,arguments)};function GG(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(e,t||[])).next())})}function O_(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(u){c=[6,u],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Xc(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function VC(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,o=[],s;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function GC(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function Sc(e){return this instanceof Sc?(this.v=e,this):new Sc(e)}function WG(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){r[h]&&(i[h]=function(g){return new Promise(function(C,v){o.push([h,g,C,v])>1||l(h,g)})},p&&(i[h]=p(i[h])))}function l(h,p){try{c(r[h](p))}catch(g){f(o[0][3],g)}}function c(h){h.value instanceof Sc?Promise.resolve(h.value.v).then(u,d):f(o[0][2],h)}function u(h){l("next",h)}function d(h){l("throw",h)}function f(h,p){h(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function jG(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Xc=="function"?Xc(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(s){return new Promise(function(a,l){s=e[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}function F_(e){return e}function M_(e,t){t===void 0&&(t=F_);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var s=t(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function hx(e,t){return t===void 0&&(t=F_),M_(e,t)}function zG(e){e===void 0&&(e={});var t=M_(null);return t.options=UC({async:!0,ssr:!1},e),t}var L_=hx({},function(e){var t=e.target,n=e.currentTarget;return{target:t,currentTarget:n}}),U_=hx(),HG=hx(),ZG=zG({async:!0,ssr:typeof document<"u"}),$G=S.createContext(void 0),XG=[],px=S.forwardRef(function(t,n){var r,i=S.useState(),o=i[0],s=i[1],a=S.useRef(),l=S.useRef(!1),c=S.useRef(null),u=S.useState({}),d=u[1],f=t.children,h=t.disabled,p=h===void 0?!1:h,g=t.noFocusGuards,C=g===void 0?!1:g,v=t.persistentFocus,m=v===void 0?!1:v,y=t.crossFrame,x=y===void 0?!0:y,b=t.autoFocus,k=b===void 0?!0:b;t.allowTextSelection;var A=t.group,E=t.className,D=t.whiteList,T=t.hasPositiveIndices,R=t.shards,P=R===void 0?XG:R,L=t.as,z=L===void 0?"div":L,Z=t.lockProps,Q=Z===void 0?{}:Z,ie=t.sideCar,$=t.returnFocus,q=$===void 0?!1:$,te=t.focusOptions,O=t.onActivation,j=t.onDeactivation,J=S.useState({}),ee=J[0],se=S.useCallback(function(Ce){var Ve=Ce.captureFocusRestore;if(!c.current){var Ue,Pe=(Ue=document)==null?void 0:Ue.activeElement;c.current=Pe,Pe!==document.body&&(c.current=Ve(Pe))}a.current&&O&&O(a.current),l.current=!0,d()},[O]),me=S.useCallback(function(){l.current=!1,j&&j(a.current),d()},[j]),Be=S.useCallback(function(Ce){var Ve=c.current;if(Ve){var Ue=(typeof Ve=="function"?Ve():Ve)||document.body,Pe=typeof q=="function"?q(Ue):q;if(Pe){var $e=typeof Pe=="object"?Pe:void 0;c.current=null,Ce?Promise.resolve().then(function(){return Ue.focus($e)}):Ue.focus($e)}}},[q]),ae=S.useCallback(function(Ce){l.current&&L_.useMedium(Ce)},[]),Dt=U_.useMedium,Gt=S.useCallback(function(Ce){a.current!==Ce&&(a.current=Ce,s(Ce))},[]),fn=Qd((r={},r[B_]=p&&"disabled",r[MC]=A,r),Q),ze=C!==!0,ot=ze&&C!=="tail",st=VG([n,Gt]),he=S.useMemo(function(){return{observed:a,shards:P,enabled:!p,active:l.current}},[p,l.current,P,o]);return Le.createElement(S.Fragment,null,ze&&[Le.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:p?-1:0,style:Fm}),T?Le.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:p?-1:1,style:Fm}):null],!p&&Le.createElement(ie,{id:ee,sideCar:ZG,observed:o,disabled:p,persistentFocus:m,crossFrame:x,autoFocus:k,whiteList:D,shards:P,onActivation:se,onDeactivation:me,returnFocus:Be,focusOptions:te,noFocusGuards:C}),Le.createElement(z,Qd({ref:st},fn,{className:E,onBlur:Dt,onFocus:ae}),Le.createElement($G.Provider,{value:he},f)),ot&&Le.createElement("div",{"data-focus-guard":!0,tabIndex:p?-1:0,style:Fm}))});px.propTypes={};function WC(e,t){return WC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},WC(e,t)}function KG(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,WC(e,t)}function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function JG(e,t){if(ef(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ef(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YG(e){var t=JG(e,"string");return ef(t)=="symbol"?t:t+""}function qG(e,t,n){return(t=YG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QG(e,t){function n(r){return r.displayName||r.name||"Component"}return function(i){var o=[],s;function a(){s=e(o.map(function(c){return c.props})),t(s)}var l=function(c){KG(u,c);function u(){return c.apply(this,arguments)||this}u.peek=function(){return s};var d=u.prototype;return d.componentDidMount=function(){o.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=o.indexOf(this);o.splice(h,1),a()},d.render=function(){return Le.createElement(i,this.props)},u}(S.PureComponent);return qG(l,"displayName","SideEffect("+n(i)+")"),l}}var zo=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},Tl=function(e){return Array.isArray(e)?e:[e]},V_=function(e){return Array.isArray(e)?e[0]:e},eW=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var t=window.getComputedStyle(e,null);return!t||!t.getPropertyValue?!1:t.getPropertyValue("display")==="none"||t.getPropertyValue("visibility")==="hidden"},G_=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},W_=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},tW=function(e){return e.hasAttribute("inert")},nW=function(e,t){return!e||W_(e)||!eW(e)&&!tW(e)&&t(G_(e))},j_=function(e,t){var n=e.get(t);if(n!==void 0)return n;var r=nW(t,j_.bind(void 0,e));return e.set(t,r),r},rW=function(e,t){return e&&!W_(e)?sW(e)?t(G_(e)):!1:!0},z_=function(e,t){var n=e.get(t);if(n!==void 0)return n;var r=rW(t,z_.bind(void 0,e));return e.set(t,r),r},H_=function(e){return e.dataset},iW=function(e){return e.tagName==="BUTTON"},Z_=function(e){return e.tagName==="INPUT"},$_=function(e){return Z_(e)&&e.type==="radio"},oW=function(e){return!((Z_(e)||iW(e))&&(e.type==="hidden"||e.disabled))},sW=function(e){var t=e.getAttribute(MG);return![!0,"true",""].includes(t)},gx=function(e){var t;return!!(e&&(!((t=H_(e))===null||t===void 0)&&t.focusGuard))},jC=function(e){return!gx(e)},aW=function(e){return!!e},lW=function(e,t){var n=Math.max(0,e.tabIndex),r=Math.max(0,t.tabIndex),i=n-r,o=e.index-t.index;if(i){if(!n)return 1;if(!r)return-1}return i||o},cW=function(e){return e.tabIndex<0&&!e.hasAttribute("tabindex")?0:e.tabIndex},mx=function(e,t,n){return zo(e).map(function(r,i){var o=cW(r);return{node:r,index:i,tabIndex:n&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!t||r.tabIndex>=0}).sort(lW)},uW=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],vx=uW.join(","),dW="".concat(vx,", [data-focus-guard]"),X_=function(e,t){return zo((e.shadowRoot||e).children).reduce(function(n,r){return n.concat(r.matches(t?dW:vx)?[r]:[],X_(r))},[])},fW=function(e,t){var n;return e instanceof HTMLIFrameElement&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?Kc([e.contentDocument.body],t):[e]},Kc=function(e,t){return e.reduce(function(n,r){var i,o=X_(r,t),s=(i=[]).concat.apply(i,o.map(function(a){return fW(a,t)}));return n.concat(s,r.parentNode?zo(r.parentNode.querySelectorAll(vx)).filter(function(a){return a===r}):[])},[])},hW=function(e){var t=e.querySelectorAll("[".concat(FG,"]"));return zo(t).map(function(n){return Kc([n])}).reduce(function(n,r){return n.concat(r)},[])},Cx=function(e,t){return zo(e).filter(function(n){return j_(t,n)}).filter(function(n){return oW(n)})},Qw=function(e,t){return t===void 0&&(t=new Map),zo(e).filter(function(n){return z_(t,n)})},yx=function(e,t,n){return mx(Cx(Kc(e,n),t),!0,n)},tf=function(e,t){return mx(Cx(Kc(e),t),!1)},pW=function(e,t){return Cx(hW(e),t)},ml=function(e,t){return e.shadowRoot?ml(e.shadowRoot,t):Object.getPrototypeOf(e).contains!==void 0&&Object.getPrototypeOf(e).contains.call(e,t)?!0:zo(e.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?ml(i,t):!1}return ml(n,t)})},gW=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=e[r].compareDocumentPosition(e[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(s,a){return!t.has(a)})},K_=function(e){return e.parentNode?K_(e.parentNode):e},xx=function(e){var t=Tl(e);return t.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(MC);return n.push.apply(n,i?gW(zo(K_(r).querySelectorAll("[".concat(MC,'="').concat(i,'"]:not([').concat(B_,'="disabled"])')))):[r]),n},[])},mW=function(e){try{return e()}catch{return}},nf=function(e){if(e===void 0&&(e=document),!(!e||!e.activeElement)){var t=e.activeElement;return t.shadowRoot?nf(t.shadowRoot):t instanceof HTMLIFrameElement&&mW(function(){return t.contentWindow.document})?nf(t.contentWindow.document):t}},vW=function(e,t){return e===t},CW=function(e,t){return!!zo(e.querySelectorAll("iframe")).some(function(n){return vW(n,t)})},J_=function(e,t){return t===void 0&&(t=nf(V_(e).ownerDocument)),!t||t.dataset&&t.dataset.focusGuard?!1:xx(e).some(function(n){return ml(n,t)||CW(n,t)})},yW=function(e){e===void 0&&(e=document);var t=nf(e);return t?zo(e.querySelectorAll("[".concat(OG,"]"))).some(function(n){return ml(n,t)}):!1},xW=function(e,t){return t.filter($_).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},Ix=function(e,t){return $_(e)&&e.name?xW(e,t):e},IW=function(e){var t=new Set;return e.forEach(function(n){return t.add(Ix(n,e))}),e.filter(function(n){return t.has(n)})},eS=function(e){return e[0]&&e.length>1?Ix(e[0],e):e[0]},tS=function(e,t){return e.indexOf(Ix(t,e))},zC="NEW_FOCUS",bW=function(e,t,n,r,i){var o=e.length,s=e[0],a=e[o-1],l=gx(r);if(!(r&&e.indexOf(r)>=0)){var c=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):c,d=i?e.indexOf(i):-1;if(c===-1)return d!==-1?d:zC;if(d===-1)return zC;var f=c-u,h=n.indexOf(s),p=n.indexOf(a),g=IW(n),C=r!==void 0?g.indexOf(r):-1,v=i?g.indexOf(i):C,m=g.filter(function(E){return E.tabIndex>=0}),y=r!==void 0?m.indexOf(r):-1,x=i?m.indexOf(i):y,b=y>=0&&x>=0?x-y:v-C;if(!f&&d>=0||t.length===0)return d;var k=tS(e,t[0]),A=tS(e,t[t.length-1]);if(c<=h&&l&&Math.abs(f)>1)return A;if(c>=p&&l&&Math.abs(f)>1)return k;if(f&&Math.abs(b)>1)return d;if(c<=h)return A;if(c>p)return k;if(f)return Math.abs(f)>1?d:(o+d+f)%o}},AW=function(e){return function(t){var n,r=(n=H_(t))===null||n===void 0?void 0:n.autofocus;return t.autofocus||r!==void 0&&r!=="false"||e.indexOf(t)>=0}},nS=function(e,t,n){var r=e.map(function(o){var s=o.node;return s}),i=Qw(r.filter(AW(n)));return i&&i.length?eS(i):eS(Qw(t))},HC=function(e,t){return t===void 0&&(t=[]),t.push(e),e.parentNode&&HC(e.parentNode.host||e.parentNode,t),t},Mm=function(e,t){for(var n=HC(e),r=HC(t),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},Y_=function(e,t,n){var r=Tl(e),i=Tl(t),o=r[0],s=!1;return i.filter(Boolean).forEach(function(a){s=Mm(s||a,a)||s,n.filter(Boolean).forEach(function(l){var c=Mm(o,l);c&&(!s||ml(c,s)?s=c:s=Mm(c,s))})}),s},rS=function(e,t){return e.reduce(function(n,r){return n.concat(pW(r,t))},[])},wW=function(e,t){var n=new Map;return t.forEach(function(r){return n.set(r.node,r)}),e.map(function(r){return n.get(r)}).filter(aW)},SW=function(e,t){var n=nf(Tl(e).length>0?document:V_(e).ownerDocument),r=xx(e).filter(jC),i=Y_(n||e,e,r),o=new Map,s=tf(r,o),a=s.filter(function(p){var g=p.node;return jC(g)});if(a[0]){var l=tf([i],o).map(function(p){var g=p.node;return g}),c=wW(l,a),u=c.map(function(p){var g=p.node;return g}),d=c.filter(function(p){var g=p.tabIndex;return g>=0}).map(function(p){var g=p.node;return g}),f=bW(u,d,l,n,t);if(f===zC){var h=nS(s,d,rS(r,o))||nS(s,u,rS(r,o));if(h)return{node:h};console.warn("focus-lock: cannot find any node to move focus into");return}return f===void 0?f:c[f]}},kW=function(e){var t=xx(e).filter(jC),n=Y_(e,e,t),r=mx(Kc([n],!0),!0,!0),i=Kc(t,!1);return r.map(function(o){var s=o.node,a=o.index;return{node:s,index:a,lockItem:i.indexOf(s)>=0,guard:gx(s)}})},bx=function(e,t){e&&("focus"in e&&e.focus(t),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus())},Lm=0,Um=!1,q_=function(e,t,n){n===void 0&&(n={});var r=SW(e,t);if(!Um&&r){if(Lm>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Um=!0,setTimeout(function(){Um=!1},1);return}Lm++,bx(r.node,n.focusOptions),Lm--}};function Gu(e){if(!e)return null;if(typeof WeakRef>"u")return function(){return e||null};var t=e?new WeakRef(e):null;return function(){return(t==null?void 0:t.deref())||null}}var EW=function(e){if(!e)return null;for(var t=[],n=e;n&&n!==document.body;)t.push({current:Gu(n),parent:Gu(n.parentElement),left:Gu(n.previousElementSibling),right:Gu(n.nextElementSibling)}),n=n.parentElement;return{element:Gu(e),stack:t,ownerDocument:e.ownerDocument}},TW=function(e){var t,n,r,i,o;if(e)for(var s=e.stack,a=e.ownerDocument,l=new Map,c=0,u=s;c<u.length;c++){var d=u[c],f=(t=d.parent)===null||t===void 0?void 0:t.call(d);if(f&&a.contains(f)){for(var h=(n=d.left)===null||n===void 0?void 0:n.call(d),p=d.current(),g=f.contains(p)?p:void 0,C=(r=d.right)===null||r===void 0?void 0:r.call(d),v=yx([f],l),m=(o=(i=g??(h==null?void 0:h.nextElementSibling))!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:h;m;){for(var y=0,x=v;y<x.length;y++){var b=x[y];if(m!=null&&m.contains(b.node))return b.node}m=m.nextElementSibling}if(v.length)return v[0].node}}},Q_=function(e){var t=EW(e);return function(){return TW(t)}},RW=function(e,t,n){if(!e||!t)return console.error("no element or scope given"),{};var r=Tl(t);if(r.every(function(s){return!ml(s,e)}))return console.error("Active element is not contained in the scope"),{};var i=n?yx(r,new Map):tf(r,new Map),o=i.findIndex(function(s){var a=s.node;return a===e});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},_W=function(e,t){var n=t?yx(Tl(e),new Map):tf(Tl(e),new Map);return{first:n[0],last:n[n.length-1]}},DW=function(e){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},e)},eD=function(e,t,n){t===void 0&&(t={});var r=DW(t),i=RW(e,r.scope,r.onlyTabbable);if(i){var o=n(i,r.cycle);o&&bx(o.node,r.focusOptions)}},PW=function(e,t){t===void 0&&(t={}),eD(e,t,function(n,r){var i=n.next,o=n.first;return i||r&&o})},NW=function(e,t){t===void 0&&(t={}),eD(e,t,function(n,r){var i=n.prev,o=n.last;return i||r&&o})},tD=function(e,t,n){var r,i=_W(e,(r=t.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[n];o&&bx(o.node,t.focusOptions)},BW=function(e,t){t===void 0&&(t={}),tD(e,t,"first")},OW=function(e,t){t===void 0&&(t={}),tD(e,t,"last")};function Ax(e){setTimeout(e,1)}var FW=function(t){return t&&"current"in t?t.current:t},nD=function(){return document&&document.activeElement===document.body},MW=function(){return nD()||yW()},kc=null,xr=null,iS=function(){return null},Ec=null,rf=!1,wx=!1,LW=function(){return!0},UW=function(t){return(kc.whiteList||LW)(t)},VW=function(t,n){Ec={observerNode:t,portaledElement:n}},GW=function(t){return Ec&&Ec.portaledElement===t};function oS(e,t,n,r){var i=null,o=e;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else if(s.lockItem){if(o!==e)return;i=null}else break}while((o+=n)!==t);i&&(i.node.tabIndex=0)}var WW=function(t){return t?!!rf:rf==="meanwhile"},jW=function e(t,n,r){return n&&(n.host===t&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&e(t,n.parentNode,r))},zW=function(t,n){return n.some(function(r){return jW(t,r,r)})},rD=function(t){return tf(t,new Map)},HW=function(t){return!rD([t.parentNode]).some(function(n){return n.node===t})},Q0=function(){var t=!1;if(kc){var n=kc,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,l=n.focusOptions,c=n.noFocusGuards,u=r||Ec&&Ec.portaledElement;if(nD()&&xr&&xr!==document.body&&(!document.body.contains(xr)||HW(xr))){var d=iS();d&&d.focus()}var f=document&&document.activeElement;if(u){var h=[u].concat(s.map(FW).filter(Boolean)),p=function(){if(!WW(a)||!c||!xr||wx)return!1;var y=rD(h),x=y.findIndex(function(b){var k=b.node;return k===xr});return x===0||x===y.length-1};if((!f||UW(f))&&(i||p()||!MW()||!xr&&o)&&(u&&!(J_(h)||f&&zW(f,h)||GW(f))&&(document&&!xr&&f&&!o?(f.blur&&f.blur(),document.body.focus()):(t=q_(h,xr,{focusOptions:l}),Ec={})),xr=document&&document.activeElement,xr!==document.body&&(iS=Q_(xr)),rf=!1),document&&f!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var g=document&&document.activeElement,C=kW(h),v=C.map(function(m){var y=m.node;return y}).indexOf(g);v>-1&&(C.filter(function(m){var y=m.guard,x=m.node;return y&&x.dataset.focusAutoGuard}).forEach(function(m){var y=m.node;return y.removeAttribute("tabIndex")}),oS(v,C.length,1,C),oS(v,-1,-1,C))}}}return t},iD=function(t){Q0()&&t&&(t.stopPropagation(),t.preventDefault())},Sx=function(){return Ax(Q0)},ZW=function(t){var n=t.target,r=t.currentTarget;r.contains(n)||VW(r,n)},$W=function(){return null},oD=function(){wx=!0},sD=function(){wx=!1,rf="just",Ax(function(){rf="meanwhile"})},XW=function(){document.addEventListener("focusin",iD),document.addEventListener("focusout",Sx),window.addEventListener("focus",oD),window.addEventListener("blur",sD)},KW=function(){document.removeEventListener("focusin",iD),document.removeEventListener("focusout",Sx),window.removeEventListener("focus",oD),window.removeEventListener("blur",sD)};function JW(e){return e.filter(function(t){var n=t.disabled;return!n})}var aD={moveFocusInside:q_,focusInside:J_,focusNextElement:PW,focusPrevElement:NW,focusFirstElement:BW,focusLastElement:OW,captureFocusRestore:Q_};function YW(e){var t=e.slice(-1)[0];t&&!kc&&XW();var n=kc,r=n&&t&&t.id===n.id;kc=t,n&&!r&&(n.onDeactivation(),e.filter(function(i){var o=i.id;return o===n.id}).length||n.returnFocus(!t)),t?(xr=null,(!r||n.observed!==t.observed)&&t.onActivation(aD),Q0(),Ax(Q0)):(KW(),xr=null)}L_.assignSyncMedium(ZW);U_.assignMedium(Sx);HG.assignMedium(function(e){return e(aD)});const qW=QG(JW,YW)($W);var lD=S.forwardRef(function(t,n){return Le.createElement(px,Qd({sideCar:qW,ref:n},t))}),cD=px.propTypes||{};cD.sideCar;BG(cD,["sideCar"]);lD.propTypes={};const QW=Le.forwardRef((e,t)=>{const[n,r]=S.useState(!1),i=S.useRef(null);return Le.useImperativeHandle(t,()=>({open(){r(!0)},close(){r(!1)}})),S.useEffect(()=>{var o;n&&((o=i.current)==null||o.focus())},[n]),S.useEffect(()=>{const o=s=>{s.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),G.jsx(lD,{disabled:!n,children:G.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[G.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&G.jsx(NG,{}),G.jsx("button",{onClick:()=>r(!1),children:"Close"}),G.jsx("br",{}),G.jsxs("span",{id:"commit-hash",children:["Version: ",bG]})]})})}),ej=({onFileChange:e,onRecipientChange:t,onSendFile:n,selectedFile:r,recipient:i})=>{const o=a=>{a.target.files&&a.target.files.length>0&&e(a.target.files[0])},s=a=>{t(a.target.value)};return G.jsxs("div",{className:"file-transfer-controls",children:[G.jsx("input",{type:"file",onChange:o}),G.jsx("input",{type:"text",placeholder:"Recipient",value:i,onChange:s}),G.jsx("button",{onClick:n,disabled:!r||!i,children:"Send File"})]})},tj=({progress:e})=>G.jsxs("div",{className:"progress-bar",children:[G.jsx("progress",{value:e,max:"100"}),G.jsxs("span",{children:[e.toFixed(2),"%"]})]}),nj=({offer:e,onAccept:t,onReject:n})=>G.jsxs("div",{className:"incoming-transfer",children:[G.jsxs("p",{children:["Incoming file: ",e.filename," from ",e.sender]}),G.jsx("button",{onClick:()=>t(e.sender,e.hash),children:"Accept"}),G.jsx("button",{onClick:()=>n(e.sender,e.hash),children:"Reject"})]}),rj=({history:e})=>G.jsxs("div",{className:"transfer-history","aria-live":"polite",children:[G.jsx("h4",{children:"Transfer History"}),G.jsx("ul",{children:e.map((t,n)=>G.jsx("li",{children:t},n))})]}),ij=({client:e,expanded:t})=>{const[n,r]=S.useState(null),[i,o]=S.useState(""),[s,a]=S.useState(0),[l,c]=S.useState(0),[u,d]=S.useState([]),[f,h]=S.useState([]),p=S.useCallback(R=>{h(P=>[...P,R].slice(-10))},[]),g=S.useCallback(R=>{const P=R.sentBytes/R.totalBytes*100;a(P)},[]),C=S.useCallback(R=>{const P=R.receivedBytes/R.totalBytes*100;c(P)},[]),v=S.useCallback(R=>{p(`File sent successfully: ${R.filename}`),a(0)},[p]),m=S.useCallback(R=>{p(`File received successfully: ${R.filename}`),c(0)},[p]),y=S.useCallback(R=>{p(`Error ${R.direction}ing file ${R.filename}: ${R.error}`),R.direction==="send"?a(0):c(0)},[p]),x=S.useCallback(R=>{p(`File transfer cancelled: ${R.filename} (${R.direction})`),R.direction==="send"?a(0):c(0)},[p]),b=S.useCallback(R=>{p(`File transfer rejected: ${R.filename} from ${R.sender}`)},[p]),k=S.useCallback(R=>{p(`File transfer accepted: ${R.filename} by ${R.sender}`)},[p]),A=S.useCallback(R=>{d(P=>[...P,R]),p(`Incoming file offer: ${R.filename} from ${R.sender}`)},[p]);S.useEffect(()=>(e.on("fileTransferOffer",A),e.on("fileTransferAccepted",k),e.fileTransferManager.on("fileSendProgress",g),e.fileTransferManager.on("fileReceiveProgress",C),e.on("fileTransferError",y),e.on("fileTransferCancelled",x),e.on("fileTransferRejected",b),e.on("fileSendComplete",v),e.fileTransferManager.on("fileReceiveComplete",m),()=>{e.off("fileTransferOffer",A),e.off("fileTransferAccepted",k),e.fileTransferManager.off("fileSendProgress",g),e.fileTransferManager.off("fileReceiveProgress",C),e.off("fileTransferError",y),e.off("fileTransferCancelled",x),e.off("fileTransferRejected",b),e.off("fileSendComplete",v),e.fileTransferManager.off("fileReceiveComplete",m)}),[e,A,k,g,C,y,x,b,v,m]);const E=()=>{n&&i&&e.sendFile(n,i).then(()=>{p(`Sending ${n.name} to ${i}`)}).catch(R=>{p(`Error sending file: ${R.message}`)})},D=(R,P)=>{e.acceptTransfer(R,P);const L=u.find(z=>z.hash===P);L&&p(`Accepting file transfer: ${L.filename} from ${R}`),d(z=>z.filter(Z=>Z.hash!==P))},T=(R,P)=>{e.rejectTransfer(R,P);const L=u.find(z=>z.hash===P);L&&p(`Rejected file transfer: ${L.filename} from ${R}`),d(z=>z.filter(Z=>Z.hash!==P))};return G.jsxs("div",{className:`file-transfer-ui ${t?"expanded":"collapsed"}`,children:[G.jsx("h3",{children:"File Transfer"}),G.jsx(ej,{onFileChange:r,onRecipientChange:o,onSendFile:E,selectedFile:n,recipient:i}),(s>0||l>0)&&G.jsx(tj,{progress:s>0?s:l}),u.map(R=>G.jsx(nj,{offer:R,onAccept:D,onReject:T},`${R.sender}-${R.filename}`)),G.jsx(rj,{history:f})]})};var sS={};function oj(e,t){return t.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in e)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(e)}var sj=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aj(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var uD={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.log=n()})(sj,function(){var t=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(g,C){var v=g[C];if(typeof v.bind=="function")return v.bind(g);try{return Function.prototype.bind.call(v,g)}catch{return function(){return Function.prototype.apply.apply(v,[g,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?s:console[g]!==void 0?o(console,g):console.log!==void 0?o(console,"log"):t}function l(g,C){for(var v=0;v<i.length;v++){var m=i[v];this[m]=v<g?t:this.methodFactory(m,g,C)}this.log=this.debug}function c(g,C,v){return function(){typeof console!==n&&(l.call(this,C,v),this[g].apply(this,arguments))}}function u(g,C,v){return a(g)||c.apply(this,arguments)}function d(g,C,v){var m=this,y;C=C??"WARN";var x="loglevel";typeof g=="string"?x+=":"+g:typeof g=="symbol"&&(x=void 0);function b(D){var T=(i[D]||"silent").toUpperCase();if(!(typeof window===n||!x)){try{window.localStorage[x]=T;return}catch{}try{window.document.cookie=encodeURIComponent(x)+"="+T+";"}catch{}}}function k(){var D;if(!(typeof window===n||!x)){try{D=window.localStorage[x]}catch{}if(typeof D===n)try{var T=window.document.cookie,R=T.indexOf(encodeURIComponent(x)+"=");R!==-1&&(D=/^([^;]+)/.exec(T.slice(R))[1])}catch{}return m.levels[D]===void 0&&(D=void 0),D}}function A(){if(!(typeof window===n||!x)){try{window.localStorage.removeItem(x);return}catch{}try{window.document.cookie=encodeURIComponent(x)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}m.name=g,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=v||u,m.getLevel=function(){return y},m.setLevel=function(D,T){if(typeof D=="string"&&m.levels[D.toUpperCase()]!==void 0&&(D=m.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=m.levels.SILENT){if(y=D,T!==!1&&b(D),l.call(m,D,g),typeof console===n&&D<m.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+D},m.setDefaultLevel=function(D){C=D,k()||m.setLevel(D,!1)},m.resetLevel=function(){m.setLevel(C,!1),A()},m.enableAll=function(D){m.setLevel(m.levels.TRACE,D)},m.disableAll=function(D){m.setLevel(m.levels.SILENT,D)};var E=k();E==null&&(E=C),m.setLevel(E,!1)}var f=new d,h={};f.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var v=h[C];return v||(v=h[C]=new d(C,f.getLevel(),f.methodFactory)),v};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(uD);var kx=uD.exports,ZC;(function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"})(ZC||(ZC={}));var Uo;(function(e){e.Default="livekit",e.Room="livekit-room",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"})(Uo||(Uo={}));let et=kx.getLogger("livekit");et.setDefaultLevel(ZC.info);function Vs(e){const t=kx.getLogger(e);return t.setDefaultLevel(et.getLevel()),t}kx.getLogger("lk-e2ee");function kr(e,t){if(!e)throw new Error(t)}const lj=34028234663852886e22,cj=-34028234663852886e22,uj=4294967295,dj=2147483647,fj=-2147483648;function Hh(e){if(typeof e!="number")throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>dj||e<fj)throw new Error("invalid int 32: "+e)}function $C(e){if(typeof e!="number")throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>uj||e<0)throw new Error("invalid uint 32: "+e)}function dD(e){if(typeof e!="number")throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>lj||e<cj))throw new Error("invalid float 32: "+e)}const fD=Symbol("@bufbuild/protobuf/enum-type");function hj(e){const t=e[fD];return kr(t,"missing enum type on enum object"),t}function hD(e,t,n,r){e[fD]=pD(t,n.map(i=>({no:i.no,name:i.name,localName:e[i.no]})))}function pD(e,t,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of t){const a=gD(s);o.push(a),r[s.name]=a,i[s.no]=a}return{typeName:e,values:o,findName(s){return r[s]},findNumber(s){return i[s]}}}function pj(e,t,n){const r={};for(const i of t){const o=gD(i);r[o.localName]=o.no,r[o.no]=o.localName}return hD(r,e,t),r}function gD(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class Se{equals(t){return this.getType().runtime.util.equals(this.getType(),this,t)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(t,n){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(n);return i.readMessage(this,o.readerFactory(t),t.byteLength,o),this}fromJson(t,n){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(n);return i.readMessage(r,t,o,this),this}fromJsonString(t,n){let r;try{r=JSON.parse(t)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(t){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(t),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(t){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(t);return r.writeMessage(this,i)}toJsonString(t){var n;const r=this.toJson(t);return JSON.stringify(r,null,(n=t==null?void 0:t.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function gj(e,t,n,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:t.substring(t.lastIndexOf(".")+1),s={[o]:function(a){e.util.initFields(this),e.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new Se),Object.assign(s,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary(a,l){return new s().fromBinary(a,l)},fromJson(a,l){return new s().fromJson(a,l)},fromJsonString(a,l){return new s().fromJsonString(a,l)},equals(a,l){return e.util.equals(s,a,l)}}),s}function mj(e,t,n,r){return{syntax:e,json:t,bin:n,util:r,makeMessageType(i,o,s){return gj(this,i,o,s)},makeEnum:pj,makeEnumType:pD,getEnumType:hj}}var ce;(function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"})(ce||(ce={}));var Rl;(function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"})(Rl||(Rl={}));function vj(){let e=0,t=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,!(n&128))return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Vm(e,t,n){for(let o=0;o<28;o=o+7){const s=e>>>o,a=!(!(s>>>7)&&t==0),l=(a?s|128:s)&255;if(n.push(l),!a)return}const r=e>>>28&15|(t&7)<<4,i=!!(t>>3);if(n.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const s=t>>>o,a=!!(s>>>7),l=(a?s|128:s)&255;if(n.push(l),!a)return}n.push(t>>>31&1)}}const Zh=4294967296;function aS(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let r=0,i=0;function o(s,a){const l=Number(e.slice(s,a));i*=n,r=r*n+l,r>=Zh&&(i=i+(r/Zh|0),r=r%Zh)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?vD(r,i):Ex(r,i)}function Cj(e,t){let n=Ex(e,t);const r=n.hi&2147483648;r&&(n=vD(n.lo,n.hi));const i=mD(n.lo,n.hi);return r?"-"+i:i}function mD(e,t){if({lo:e,hi:t}=yj(e,t),t<=2097151)return String(Zh*t+e);const n=e&16777215,r=(e>>>24|t<<8)&16777215,i=t>>16&65535;let o=n+r*6777216+i*6710656,s=r+i*8147497,a=i*2;const l=1e7;return o>=l&&(s+=Math.floor(o/l),o%=l),s>=l&&(a+=Math.floor(s/l),s%=l),a.toString()+lS(s)+lS(o)}function yj(e,t){return{lo:e>>>0,hi:t>>>0}}function Ex(e,t){return{lo:e|0,hi:t|0}}function vD(e,t){return t=~t,e?e=~e+1:t+=1,Ex(e,t)}const lS=e=>{const t=String(e);return"0000000".slice(t.length)+t};function cS(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function xj(){let e=this.buf[this.pos++],t=e&127;if(!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,!(e&128))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;e&128&&n<10;n++)e=this.buf[this.pos++];if(e&128)throw new Error("invalid varint");return this.assertBounds(),t>>>0}function Ij(){const e=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(typeof process!="object"||typeof sS!="object"||sS.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>o||c<i)throw new Error("int64 invalid: ".concat(l));return c},uParse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>a||c<s)throw new Error("uint64 invalid: ".concat(l));return c},enc(l){return e.setBigInt64(0,this.parse(l),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(l){return e.setBigInt64(0,this.uParse(l),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(l,c){return e.setInt32(0,l,!0),e.setInt32(4,c,!0),e.getBigInt64(0,!0)},uDec(l,c){return e.setInt32(0,l,!0),e.setInt32(4,c,!0),e.getBigUint64(0,!0)}}}const n=i=>kr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>kr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),aS(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),aS(i)},dec(i,o){return Cj(i,o)},uDec(i,o){return mD(i,o)}}}const He=Ij();var nn;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(nn||(nn={}));class bj{constructor(t){this.stack=[],this.textEncoder=t??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let t=0;for(let i=0;i<this.chunks.length;i++)t+=this.chunks[i].length;let n=new Uint8Array(t),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for($C(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return Hh(t),cS(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.textEncoder.encode(t);return this.uint32(n.byteLength),this.raw(n)}float(t){dD(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){$C(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){Hh(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return Hh(t),t=(t<<1^t>>31)>>>0,cS(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),i=He.enc(t);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),i=He.uEnc(t);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(t){let n=He.enc(t);return Vm(n.lo,n.hi,this.buf),this}sint64(t){let n=He.enc(t),r=n.hi>>31,i=n.lo<<1^r,o=(n.hi<<1|n.lo>>>31)^r;return Vm(i,o,this.buf),this}uint64(t){let n=He.uEnc(t);return Vm(n.lo,n.hi,this.buf),this}}class Aj{constructor(t,n){this.varint64=vj,this.uint32=xj,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=n??new TextDecoder}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t){let n=this.pos;switch(t){case nn.Varint:for(;this.buf[this.pos++]&128;);break;case nn.Bit64:this.pos+=4;case nn.Bit32:this.pos+=4;break;case nn.LengthDelimited:let r=this.uint32();this.pos+=r;break;case nn.StartGroup:let i;for(;(i=this.tag()[1])!==nn.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return He.dec(...this.varint64())}uint64(){return He.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,He.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return He.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return He.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.textDecoder.decode(this.bytes())}}function XC(e,t){return t instanceof Se||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}ce.DOUBLE,ce.FLOAT,ce.INT64,ce.UINT64,ce.INT32,ce.UINT32,ce.BOOL,ce.STRING,ce.BYTES;function ea(e,t,n){if(t===n)return!0;if(e==ce.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array)||t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}switch(e){case ce.UINT64:case ce.FIXED64:case ce.INT64:case ce.SFIXED64:case ce.SINT64:return t==n}return!1}function KC(e,t){switch(e){case ce.BOOL:return!1;case ce.UINT64:case ce.FIXED64:case ce.INT64:case ce.SFIXED64:case ce.SINT64:return t==0?He.zero:"0";case ce.DOUBLE:case ce.FLOAT:return 0;case ce.BYTES:return new Uint8Array(0);case ce.STRING:return"";default:return 0}}function CD(e,t){const n=t===void 0;let r=nn.Varint,i=t===0;switch(e){case ce.STRING:i=n||!t.length,r=nn.LengthDelimited;break;case ce.BOOL:i=t===!1;break;case ce.DOUBLE:r=nn.Bit64;break;case ce.FLOAT:r=nn.Bit32;break;case ce.INT64:i=n||t==0;break;case ce.UINT64:i=n||t==0;break;case ce.FIXED64:i=n||t==0,r=nn.Bit64;break;case ce.BYTES:i=n||!t.byteLength,r=nn.LengthDelimited;break;case ce.FIXED32:r=nn.Bit32;break;case ce.SFIXED32:r=nn.Bit32;break;case ce.SFIXED64:i=n||t==0,r=nn.Bit64;break;case ce.SINT64:i=n||t==0;break}const o=ce[e].toLowerCase();return[r,o,n||i]}const Ql=Symbol("@bufbuild/protobuf/unknown-fields"),uS={readUnknownFields:!0,readerFactory:e=>new Aj(e)},dS={writeUnknownFields:!0,writerFactory:()=>new bj};function wj(e){return e?Object.assign(Object.assign({},uS),e):uS}function Sj(e){return e?Object.assign(Object.assign({},dS),e):dS}function kj(){return{makeReadOptions:wj,makeWriteOptions:Sj,listUnknownFields(e){var t;return(t=e[Ql])!==null&&t!==void 0?t:[]},discardUnknownFields(e){delete e[Ql]},writeUnknownFields(e,t){const r=e[Ql];if(r)for(const i of r)t.tag(i.no,i.wireType).raw(i.data)},onUnknownField(e,t,n,r){const i=e;Array.isArray(i[Ql])||(i[Ql]=[]),i[Ql].push({no:t,wireType:n,data:r})},readMessage(e,t,n,r){const i=e.getType(),o=n===void 0?t.len:t.pos+n;for(;t.pos<o;){const[s,a]=t.tag(),l=i.fields.find(s);if(!l){const f=t.skip(a);r.readUnknownFields&&this.onUnknownField(e,s,a,f);continue}let c=e,u=l.repeated,d=l.localName;switch(l.oneof&&(c=c[l.oneof.localName],c.case!=d&&delete c.value,c.case=d,d="value"),l.kind){case"scalar":case"enum":const f=l.kind=="enum"?ce.INT32:l.T;let h=ep;if(l.kind=="scalar"&&l.L>0&&(h=Tj),u){let v=c[d];if(a==nn.LengthDelimited&&f!=ce.STRING&&f!=ce.BYTES){let m=t.uint32()+t.pos;for(;t.pos<m;)v.push(h(t,f))}else v.push(h(t,f))}else c[d]=h(t,f);break;case"message":const p=l.T;u?c[d].push($h(t,new p,r)):c[d]instanceof Se?$h(t,c[d],r):(c[d]=$h(t,new p,r),p.fieldWrapper&&!l.oneof&&!l.repeated&&(c[d]=p.fieldWrapper.unwrapField(c[d])));break;case"map":let[g,C]=Ej(l,t,r);c[d][g]=C;break}}}}}function $h(e,t,n){return t.getType().runtime.bin.readMessage(t,e,e.uint32(),n),t}function Ej(e,t,n){const r=t.uint32(),i=t.pos+r;let o,s;for(;t.pos<i;){let[a]=t.tag();switch(a){case 1:o=ep(t,e.K);break;case 2:switch(e.V.kind){case"scalar":s=ep(t,e.V.T);break;case"enum":s=t.int32();break;case"message":s=$h(t,new e.V.T,n);break}break}}if(o===void 0){let a=KC(e.K,Rl.BIGINT);o=e.K==ce.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(e.V.kind){case"scalar":s=KC(e.V.T,Rl.BIGINT);break;case"enum":s=0;break;case"message":s=new e.V.T;break}return[o,s]}function Tj(e,t){const n=ep(e,t);return typeof n=="bigint"?n.toString():n}function ep(e,t){switch(t){case ce.STRING:return e.string();case ce.BOOL:return e.bool();case ce.DOUBLE:return e.double();case ce.FLOAT:return e.float();case ce.INT32:return e.int32();case ce.INT64:return e.int64();case ce.UINT64:return e.uint64();case ce.FIXED64:return e.fixed64();case ce.BYTES:return e.bytes();case ce.FIXED32:return e.fixed32();case ce.SFIXED32:return e.sfixed32();case ce.SFIXED64:return e.sfixed64();case ce.SINT64:return e.sint64();case ce.UINT32:return e.uint32();case ce.SINT32:return e.sint32()}}function Rj(e,t,n,r,i){e.tag(n.no,nn.LengthDelimited),e.fork();let o=r;switch(n.K){case ce.INT32:case ce.FIXED32:case ce.UINT32:case ce.SFIXED32:case ce.SINT32:o=Number.parseInt(r);break;case ce.BOOL:kr(r=="true"||r=="false"),o=r=="true";break}switch(bd(e,n.K,1,o,!0),n.V.kind){case"scalar":bd(e,n.V.T,2,i,!0);break;case"enum":bd(e,ce.INT32,2,i,!0);break;case"message":JC(e,t,n.V.T,2,i);break}e.join()}function JC(e,t,n,r,i){if(i!==void 0){const o=XC(n,i);e.tag(r,nn.LengthDelimited).bytes(o.toBinary(t))}}function bd(e,t,n,r,i){let[o,s,a]=CD(t,r);(!a||i)&&e.tag(n,o)[s](r)}function _j(e,t,n,r){if(!r.length)return;e.tag(n,nn.LengthDelimited).fork();let[,i]=CD(t);for(let o=0;o<r.length;o++)e[i](r[o]);e.join()}function Dj(){return Object.assign(Object.assign({},kj()),{writeMessage(e,t,n){const r=e.getType();for(const i of r.fields.byNumber()){let o,s=i.repeated,a=i.localName;if(i.oneof){const l=e[i.oneof.localName];if(l.case!==a)continue;o=l.value}else o=e[a];switch(i.kind){case"scalar":case"enum":let l=i.kind=="enum"?ce.INT32:i.T;if(s)if(i.packed)_j(t,l,i.no,o);else for(const c of o)bd(t,l,i.no,c,!0);else o!==void 0&&bd(t,l,i.no,o,!!i.oneof||i.opt);break;case"message":if(s)for(const c of o)JC(t,n,i.T,i.no,c);else JC(t,n,i.T,i.no,o);break;case"map":for(const[c,u]of Object.entries(o))Rj(t,n,i,c,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}})}let ts="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Hp=[];for(let e=0;e<ts.length;e++)Hp[ts[e].charCodeAt(0)]=e;Hp[45]=ts.indexOf("+");Hp[95]=ts.indexOf("/");const yD={dec(e){let t=e.length*3/4;e[e.length-2]=="="?t-=2:e[e.length-1]=="="&&(t-=1);let n=new Uint8Array(t),r=0,i=0,o,s=0;for(let a=0;a<e.length;a++){if(o=Hp[e.charCodeAt(a)],o===void 0)switch(e[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:n[r++]=s<<2|(o&48)>>4,s=o,i=2;break;case 2:n[r++]=(s&15)<<4|(o&60)>>2,s=o,i=3;break;case 3:n[r++]=(s&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(e){let t="",n=0,r,i=0;for(let o=0;o<e.length;o++)switch(r=e[o],n){case 0:t+=ts[r>>2],i=(r&3)<<4,n=1;break;case 1:t+=ts[i|r>>4],i=(r&15)<<2,n=2;break;case 2:t+=ts[i|r>>6],t+=ts[r&63],n=0;break}return n&&(t+=ts[i],t+="=",n==1&&(t+="=")),t}},fS={ignoreUnknownFields:!1},hS={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function Pj(e){return e?Object.assign(Object.assign({},fS),e):fS}function Nj(e){return e?Object.assign(Object.assign({},hS),e):hS}function Bj(e){const t=e(Oj,pS);return{makeReadOptions:Pj,makeWriteOptions:Nj,readMessage(n,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));o=o??new n;const s={};for(const[a,l]of Object.entries(r)){const c=n.fields.findJsonName(a);if(!c){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=c.localName,d=o;if(c.oneof){if(l===null&&c.kind=="scalar")continue;const f=s[c.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));s[c.oneof.localName]=a,d=d[c.oneof.localName]={case:u},u="value"}if(c.repeated){if(l===null)continue;if(!Array.isArray(l))throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const h of l){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h)));let p;switch(c.kind){case"message":p=c.T.fromJson(h,i);break;case"enum":if(p=Gm(c.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=Wu(c.T,h,c.L)}catch(g){let C="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h));throw g instanceof Error&&g.message.length>0&&(C+=": ".concat(g.message)),new Error(C)}break}f.push(p)}}else if(c.kind=="map"){if(l===null)continue;if(Array.isArray(l)||typeof l!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const[h,p]of Object.entries(l)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: map value null"));let g;switch(c.V.kind){case"message":g=c.V.T.fromJson(p,i);break;case"enum":if(g=Gm(c.V.T,p,i.ignoreUnknownFields),g===void 0)continue;break;case"scalar":try{g=Wu(c.V.T,p,Rl.BIGINT)}catch(C){let v="cannot decode map value for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(v+=": ".concat(C.message)),new Error(v)}break}try{f[Wu(c.K,c.K==ce.BOOL?h=="true"?!0:h=="false"?!1:h:h,Rl.BIGINT).toString()]=g}catch(C){let v="cannot decode map key for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(v+=": ".concat(C.message)),new Error(v)}}}else switch(c.kind){case"message":const f=c.T;if(l===null&&f.typeName!="google.protobuf.Value"){if(c.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof Se?d[u].fromJson(l,i):(d[u]=f.fromJson(l,i),f.fieldWrapper&&!c.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=Gm(c.T,l,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=Wu(c.T,l,c.L)}catch(p){let g="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw p instanceof Error&&p.message.length>0&&(g+=": ".concat(p.message)),new Error(g)}break}}return o},writeMessage(n,r){const i=n.getType(),o={};let s;try{for(const a of i.fields.byMember()){let l;if(a.kind=="oneof"){const c=n[a.localName];if(c.value===void 0)continue;if(s=a.findField(c.case),!s)throw"oneof case not found: "+c.case;l=t(s,c.value,r)}else s=a,l=t(s,n[s.localName],r);l!==void 0&&(o[r.useProtoFieldName?s.name:s.jsonName]=l)}}catch(a){const l=s?"cannot encode field ".concat(i.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),c=a instanceof Error?a.message:String(a);throw new Error(l+(c.length>0?": ".concat(c):""))}return o},readScalar:Wu,writeScalar:pS,debug:xD}}function xD(e){if(e===null)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function Wu(e,t,n){switch(e){case ce.DOUBLE:case ce.FLOAT:if(t===null)return 0;if(t==="NaN")return Number.NaN;if(t==="Infinity")return Number.POSITIVE_INFINITY;if(t==="-Infinity")return Number.NEGATIVE_INFINITY;if(t===""||typeof t=="string"&&t.trim().length!==t.length||typeof t!="string"&&typeof t!="number")break;const r=Number(t);if(Number.isNaN(r)||!Number.isFinite(r))break;return e==ce.FLOAT&&dD(r),r;case ce.INT32:case ce.FIXED32:case ce.SFIXED32:case ce.SINT32:case ce.UINT32:if(t===null)return 0;let i;if(typeof t=="number"?i=t:typeof t=="string"&&t.length>0&&t.trim().length===t.length&&(i=Number(t)),i===void 0)break;return e==ce.UINT32?$C(i):Hh(i),i;case ce.INT64:case ce.SFIXED64:case ce.SINT64:if(t===null)return He.zero;if(typeof t!="number"&&typeof t!="string")break;const o=He.parse(t);return n?o.toString():o;case ce.FIXED64:case ce.UINT64:if(t===null)return He.zero;if(typeof t!="number"&&typeof t!="string")break;const s=He.uParse(t);return n?s.toString():s;case ce.BOOL:if(t===null)return!1;if(typeof t!="boolean")break;return t;case ce.STRING:if(t===null)return"";if(typeof t!="string")break;try{encodeURIComponent(t)}catch{throw new Error("invalid UTF8")}return t;case ce.BYTES:if(t===null||t==="")return new Uint8Array(0);if(typeof t!="string")break;return yD.dec(t)}throw new Error}function Gm(e,t,n){if(t===null)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const r=e.findName(t);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(xD(t)))}function Oj(e,t,n,r){var i;if(t===void 0)return t;if(t===0&&!n)return;if(r)return t;if(e.typeName=="google.protobuf.NullValue")return null;const o=e.findNumber(t);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:t}function pS(e,t,n){if(t!==void 0)switch(e){case ce.INT32:case ce.SFIXED32:case ce.SINT32:case ce.FIXED32:case ce.UINT32:return kr(typeof t=="number"),t!=0||n?t:void 0;case ce.FLOAT:case ce.DOUBLE:return kr(typeof t=="number"),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t!==0||n?t:void 0;case ce.STRING:return kr(typeof t=="string"),t.length>0||n?t:void 0;case ce.BOOL:return kr(typeof t=="boolean"),t||n?t:void 0;case ce.UINT64:case ce.FIXED64:case ce.INT64:case ce.SFIXED64:case ce.SINT64:return kr(typeof t=="bigint"||typeof t=="string"||typeof t=="number"),n||t!=0?t.toString(10):void 0;case ce.BYTES:return kr(t instanceof Uint8Array),n||t.byteLength>0?yD.enc(t):void 0}}function Fj(){return Bj((e,t)=>function(r,i,o){if(r.kind=="map"){const s={};switch(r.V.kind){case"scalar":for(const[l,c]of Object.entries(i)){const u=t(r.V.T,c,!0);kr(u!==void 0),s[l.toString()]=u}break;case"message":for(const[l,c]of Object.entries(i))s[l.toString()]=c.toJson(o);break;case"enum":const a=r.V.T;for(const[l,c]of Object.entries(i)){kr(c===void 0||typeof c=="number");const u=e(a,c,!0,o.enumAsInteger);kr(u!==void 0),s[l.toString()]=u}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(r.repeated){const s=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)s.push(t(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)s.push(e(r.T,i[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)s.push(XC(r.T,i[a]).toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else switch(r.kind){case"scalar":return t(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?XC(r.T,i).toJson(o):void 0}})}function Mj(){return{setEnumType:hD,initPartial(e,t){if(e===void 0)return;const n=t.getType();for(const r of n.fields.byMember()){const i=r.localName,o=t,s=e;if(s[i]!==void 0)switch(r.kind){case"oneof":const a=s[i].case;if(a===void 0)continue;const l=r.findField(a);let c=s[i].value;l&&l.kind=="message"&&!(c instanceof l.T)?c=new l.T(c):l&&l.kind==="scalar"&&l.T===ce.BYTES&&(c=ju(c)),o[i]={case:a,value:c};break;case"scalar":case"enum":let u=s[i];r.T===ce.BYTES&&(u=r.repeated?u.map(ju):ju(u)),o[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===ce.BYTES)for(const[h,p]of Object.entries(s[i]))o[i][h]=ju(p);else Object.assign(o[i],s[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(s[i])){let p=s[i][h];f.fieldWrapper||(p=new f(p)),o[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)o[i]=s[i].map(f=>f instanceof d?f:new d(f));else if(s[i]!==void 0){const f=s[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?o[i]=ju(f):o[i]=f:o[i]=f instanceof d?f:new d(f)}break}}},equals(e,t,n){return t===n?!0:!t||!n?!1:e.fields.byMember().every(r=>{const i=t[r.localName],o=n[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((s,a)=>r.T.equals(s,o[a]));case"scalar":return i.every((s,a)=>ea(r.T,s,o[a]));case"enum":return i.every((s,a)=>ea(ce.INT32,s,o[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return ea(ce.INT32,i,o);case"scalar":return ea(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const s=r.findField(i.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(i.value,o.value);case"enum":return ea(ce.INT32,i.value,o.value);case"scalar":return ea(s.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const a=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const l=r.V.T;return a.every(u=>l.equals(i[u],o[u]));case"enum":return a.every(u=>ea(ce.INT32,i[u],o[u]));case"scalar":const c=r.V.T;return a.every(u=>ea(c,i[u],o[u]))}break}})},clone(e){const t=e.getType(),n=new t,r=n;for(const i of t.fields.byMember()){const o=e[i.localName];let s;if(i.repeated)s=o.map(uh);else if(i.kind=="map"){s=r[i.localName];for(const[a,l]of Object.entries(o))s[a]=uh(l)}else i.kind=="oneof"?s=i.findField(o.case)?{case:o.case,value:uh(o.value)}:{case:void 0}:s=uh(o);r[i.localName]=s}return n}}}function uh(e){if(e===void 0)return e;if(e instanceof Se)return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function ju(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class Lj{constructor(t,n){this._fields=t,this._normalizer=n}findJsonName(t){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[t]}find(t){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[t]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((t,n)=>t.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const t=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,t.push(n)):t.push(r)}return this.members}}function ID(e,t){const n=bD(e);return t?n:zj(jj(n))}function Uj(e){return ID(e,!1)}const Vj=bD;function bD(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let i=e.charAt(r);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const Gj=new Set(["constructor","toString","toJSON","valueOf"]),Wj=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),AD=e=>"".concat(e,"$"),jj=e=>Wj.has(e)?AD(e):e,zj=e=>Gj.has(e)?AD(e):e;class Hj{constructor(t){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=t,this.localName=Uj(t)}addField(t){kr(t.oneof===this,"field ".concat(t.name," not one of ").concat(this.name)),this.fields.push(t)}findField(t){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[t]}}const N=mj("proto3",Fj(),Dj(),Object.assign(Object.assign({},Mj()),{newFieldList(e){return new Lj(e,Zj)},initFields(e){for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,r=e;if(t.repeated){r[n]=[];continue}switch(t.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=KC(t.T,t.L);break}}}}));function Zj(e){var t,n,r,i;const o=[];let s;for(const a of typeof e=="function"?e():e){const l=a;if(l.localName=ID(a.name,a.oneof!==void 0),l.jsonName=(t=a.jsonName)!==null&&t!==void 0?t:Vj(a.name),l.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(l.L=(r=a.L)!==null&&r!==void 0?r:Rl.BIGINT),l.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=ce.BYTES&&a.T!=ce.STRING,a.oneof!==void 0){const c=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=c)&&(s=new Hj(c)),l.oneof=s,s.addField(l)}o.push(l)}return o}class En extends Se{constructor(t){super(),this.seconds=He.zero,this.nanos=0,N.util.initPartial(t,this)}fromJson(t,n){if(typeof t!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(N.json.debug(t)));const r=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=He.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(t){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return En.fromDate(new Date)}static fromDate(t){const n=t.getTime();return new En({seconds:He.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(t,n){return new En().fromBinary(t,n)}static fromJson(t,n){return new En().fromJson(t,n)}static fromJsonString(t,n){return new En().fromJsonString(t,n)}static equals(t,n){return N.util.equals(En,t,n)}}En.runtime=N;En.typeName="google.protobuf.Timestamp";En.fields=N.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var YC;(function(e){e[e.DEFAULT_AC=0]="DEFAULT_AC",e[e.OPUS=1]="OPUS",e[e.AAC=2]="AAC"})(YC||(YC={}));N.util.setEnumType(YC,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var qC;(function(e){e[e.DEFAULT_VC=0]="DEFAULT_VC",e[e.H264_BASELINE=1]="H264_BASELINE",e[e.H264_MAIN=2]="H264_MAIN",e[e.H264_HIGH=3]="H264_HIGH",e[e.VP8=4]="VP8"})(qC||(qC={}));N.util.setEnumType(qC,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var QC;(function(e){e[e.IC_DEFAULT=0]="IC_DEFAULT",e[e.IC_JPEG=1]="IC_JPEG"})(QC||(QC={}));N.util.setEnumType(QC,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Xn;(function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA"})(Xn||(Xn={}));N.util.setEnumType(Xn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var rn;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(rn||(rn={}));N.util.setEnumType(rn,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var xn;(function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF"})(xn||(xn={}));N.util.setEnumType(xn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var ss;(function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.LOST=3]="LOST"})(ss||(ss={}));N.util.setEnumType(ss,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var qi;(function(e){e[e.UNSET=0]="UNSET",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"})(qi||(qi={}));N.util.setEnumType(qi,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var Ps;(function(e){e[e.UNKNOWN_REASON=0]="UNKNOWN_REASON",e[e.CLIENT_INITIATED=1]="CLIENT_INITIATED",e[e.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",e[e.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",e[e.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",e[e.ROOM_DELETED=5]="ROOM_DELETED",e[e.STATE_MISMATCH=6]="STATE_MISMATCH",e[e.JOIN_FAILURE=7]="JOIN_FAILURE"})(Ps||(Ps={}));N.util.setEnumType(Ps,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var qo;(function(e){e[e.RR_UNKNOWN=0]="RR_UNKNOWN",e[e.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",e[e.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",e[e.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",e[e.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(qo||(qo={}));N.util.setEnumType(qo,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var of;(function(e){e[e.SE_UNKNOWN=0]="SE_UNKNOWN",e[e.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",e[e.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(of||(of={}));N.util.setEnumType(of,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let gu=class sd extends Se{constructor(t){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=He.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,N.util.initPartial(t,this)}static fromBinary(t,n){return new sd().fromBinary(t,n)}static fromJson(t,n){return new sd().fromJson(t,n)}static fromJsonString(t,n){return new sd().fromJsonString(t,n)}static equals(t,n){return N.util.equals(sd,t,n)}};gu.runtime=N;gu.typeName="livekit.Room";gu.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Vi,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class Vi extends Se{constructor(t){super(),this.mime="",this.fmtpLine="",N.util.initPartial(t,this)}static fromBinary(t,n){return new Vi().fromBinary(t,n)}static fromJson(t,n){return new Vi().fromJson(t,n)}static fromJsonString(t,n){return new Vi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Vi,t,n)}}Vi.runtime=N;Vi.typeName="livekit.Codec";Vi.fields=N.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class ya extends Se{constructor(t){super(),this.enabled=!1,this.min=0,this.max=0,N.util.initPartial(t,this)}static fromBinary(t,n){return new ya().fromBinary(t,n)}static fromJson(t,n){return new ya().fromJson(t,n)}static fromJsonString(t,n){return new ya().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ya,t,n)}}ya.runtime=N;ya.typeName="livekit.PlayoutDelay";ya.fields=N.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class as extends Se{constructor(t){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,N.util.initPartial(t,this)}static fromBinary(t,n){return new as().fromBinary(t,n)}static fromJson(t,n){return new as().fromJson(t,n)}static fromJsonString(t,n){return new as().fromJsonString(t,n)}static equals(t,n){return N.util.equals(as,t,n)}}as.runtime=N;as.typeName="livekit.ParticipantPermission";as.fields=N.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:N.getEnumType(rn),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class qr extends Se{constructor(t){super(),this.sid="",this.identity="",this.state=_l.JOINING,this.tracks=[],this.metadata="",this.joinedAt=He.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,N.util.initPartial(t,this)}static fromBinary(t,n){return new qr().fromBinary(t,n)}static fromJson(t,n){return new qr().fromJson(t,n)}static fromJsonString(t,n){return new qr().fromJsonString(t,n)}static equals(t,n){return N.util.equals(qr,t,n)}}qr.runtime=N;qr.typeName="livekit.ParticipantInfo";qr.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:N.getEnumType(_l)},{no:4,name:"tracks",kind:"message",T:Tr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:as},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var _l;(function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED"})(_l||(_l={}));N.util.setEnumType(_l,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class xa extends Se{constructor(t){super(),N.util.initPartial(t,this)}static fromBinary(t,n){return new xa().fromBinary(t,n)}static fromJson(t,n){return new xa().fromJson(t,n)}static fromJsonString(t,n){return new xa().fromJsonString(t,n)}static equals(t,n){return N.util.equals(xa,t,n)}}xa.runtime=N;xa.typeName="livekit.Encryption";xa.fields=N.util.newFieldList(()=>[]);var Nn;(function(e){e[e.NONE=0]="NONE",e[e.GCM=1]="GCM",e[e.CUSTOM=2]="CUSTOM"})(Nn||(Nn={}));N.util.setEnumType(Nn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class ls extends Se{constructor(t){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new ls().fromBinary(t,n)}static fromJson(t,n){return new ls().fromJson(t,n)}static fromJsonString(t,n){return new ls().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ls,t,n)}}ls.runtime=N;ls.typeName="livekit.SimulcastCodecInfo";ls.fields=N.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ur,repeated:!0}]);class Tr extends Se{constructor(t){super(),this.sid="",this.type=Xn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=rn.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Nn.NONE,this.stream="",N.util.initPartial(t,this)}static fromBinary(t,n){return new Tr().fromBinary(t,n)}static fromJson(t,n){return new Tr().fromJson(t,n)}static fromJsonString(t,n){return new Tr().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Tr,t,n)}}Tr.runtime=N;Tr.typeName="livekit.TrackInfo";Tr.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:N.getEnumType(Xn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:N.getEnumType(rn)},{no:10,name:"layers",kind:"message",T:ur,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:ls,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:N.getEnumType(Nn)},{no:17,name:"stream",kind:"scalar",T:9}]);class ur extends Se{constructor(t){super(),this.quality=xn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,N.util.initPartial(t,this)}static fromBinary(t,n){return new ur().fromBinary(t,n)}static fromJson(t,n){return new ur().fromJson(t,n)}static fromJsonString(t,n){return new ur().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ur,t,n)}}ur.runtime=N;ur.typeName="livekit.VideoLayer";ur.fields=N.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:N.getEnumType(xn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class vo extends Se{constructor(t){super(),this.kind=mn.RELIABLE,this.value={case:void 0},N.util.initPartial(t,this)}static fromBinary(t,n){return new vo().fromBinary(t,n)}static fromJson(t,n){return new vo().fromJson(t,n)}static fromJsonString(t,n){return new vo().fromJsonString(t,n)}static equals(t,n){return N.util.equals(vo,t,n)}}vo.runtime=N;vo.typeName="livekit.DataPacket";vo.fields=N.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:N.getEnumType(mn)},{no:2,name:"user",kind:"message",T:yo,oneof:"value"},{no:3,name:"speaker",kind:"message",T:cs,oneof:"value"}]);var mn;(function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY"})(mn||(mn={}));N.util.setEnumType(mn,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class cs extends Se{constructor(t){super(),this.speakers=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new cs().fromBinary(t,n)}static fromJson(t,n){return new cs().fromJson(t,n)}static fromJsonString(t,n){return new cs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(cs,t,n)}}cs.runtime=N;cs.typeName="livekit.ActiveSpeakerUpdate";cs.fields=N.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Co,repeated:!0}]);class Co extends Se{constructor(t){super(),this.sid="",this.level=0,this.active=!1,N.util.initPartial(t,this)}static fromBinary(t,n){return new Co().fromBinary(t,n)}static fromJson(t,n){return new Co().fromJson(t,n)}static fromJsonString(t,n){return new Co().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Co,t,n)}}Co.runtime=N;Co.typeName="livekit.SpeakerInfo";Co.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class yo extends Se{constructor(t){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new yo().fromBinary(t,n)}static fromJson(t,n){return new yo().fromJson(t,n)}static fromJsonString(t,n){return new yo().fromJsonString(t,n)}static equals(t,n){return N.util.equals(yo,t,n)}}yo.runtime=N;yo.typeName="livekit.UserPacket";yo.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class xo extends Se{constructor(t){super(),this.participantSid="",this.trackSids=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new xo().fromBinary(t,n)}static fromJson(t,n){return new xo().fromJson(t,n)}static fromJsonString(t,n){return new xo().fromJsonString(t,n)}static equals(t,n){return N.util.equals(xo,t,n)}}xo.runtime=N;xo.typeName="livekit.ParticipantTracks";xo.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class us extends Se{constructor(t){super(),this.edition=Jc.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",N.util.initPartial(t,this)}static fromBinary(t,n){return new us().fromBinary(t,n)}static fromJson(t,n){return new us().fromJson(t,n)}static fromJsonString(t,n){return new us().fromJsonString(t,n)}static equals(t,n){return N.util.equals(us,t,n)}}us.runtime=N;us.typeName="livekit.ServerInfo";us.fields=N.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:N.getEnumType(Jc)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Jc;(function(e){e[e.Standard=0]="Standard",e[e.Cloud=1]="Cloud"})(Jc||(Jc={}));N.util.setEnumType(Jc,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class ds extends Se{constructor(t){super(),this.sdk=Yc.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",N.util.initPartial(t,this)}static fromBinary(t,n){return new ds().fromBinary(t,n)}static fromJson(t,n){return new ds().fromJson(t,n)}static fromJsonString(t,n){return new ds().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ds,t,n)}}ds.runtime=N;ds.typeName="livekit.ClientInfo";ds.fields=N.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:N.getEnumType(Yc)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Yc;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.REACT_NATIVE=7]="REACT_NATIVE",e[e.RUST=8]="RUST",e[e.PYTHON=9]="PYTHON",e[e.CPP=10]="CPP"})(Yc||(Yc={}));N.util.setEnumType(Yc,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class Io extends Se{constructor(t){super(),this.resumeConnection=qi.UNSET,this.forceRelay=qi.UNSET,N.util.initPartial(t,this)}static fromBinary(t,n){return new Io().fromBinary(t,n)}static fromJson(t,n){return new Io().fromJson(t,n)}static fromJsonString(t,n){return new Io().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Io,t,n)}}Io.runtime=N;Io.typeName="livekit.ClientConfiguration";Io.fields=N.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:bo},{no:2,name:"screen",kind:"message",T:bo},{no:3,name:"resume_connection",kind:"enum",T:N.getEnumType(qi)},{no:4,name:"disabled_codecs",kind:"message",T:fs},{no:5,name:"force_relay",kind:"enum",T:N.getEnumType(qi)}]);class bo extends Se{constructor(t){super(),this.hardwareEncoder=qi.UNSET,N.util.initPartial(t,this)}static fromBinary(t,n){return new bo().fromBinary(t,n)}static fromJson(t,n){return new bo().fromJson(t,n)}static fromJsonString(t,n){return new bo().fromJsonString(t,n)}static equals(t,n){return N.util.equals(bo,t,n)}}bo.runtime=N;bo.typeName="livekit.VideoConfiguration";bo.fields=N.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:N.getEnumType(qi)}]);class fs extends Se{constructor(t){super(),this.codecs=[],this.publish=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new fs().fromBinary(t,n)}static fromJson(t,n){return new fs().fromJson(t,n)}static fromJsonString(t,n){return new fs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(fs,t,n)}}fs.runtime=N;fs.typeName="livekit.DisabledCodecs";fs.fields=N.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Vi,repeated:!0},{no:2,name:"publish",kind:"message",T:Vi,repeated:!0}]);class Ao extends Se{constructor(t){super(),this.duration=0,this.startTimestamp=He.zero,this.endTimestamp=He.zero,this.rtpClockTicks=He.zero,this.driftSamples=He.zero,this.driftMs=0,this.clockRate=0,N.util.initPartial(t,this)}static fromBinary(t,n){return new Ao().fromBinary(t,n)}static fromJson(t,n){return new Ao().fromJson(t,n)}static fromJsonString(t,n){return new Ao().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Ao,t,n)}}Ao.runtime=N;Ao.typeName="livekit.RTPDrift";Ao.fields=N.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:En},{no:2,name:"end_time",kind:"message",T:En},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Ia extends Se{constructor(t){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=He.zero,this.headerBytes=He.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=He.zero,this.headerBytesDuplicate=He.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=He.zero,this.headerBytesPadding=He.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,N.util.initPartial(t,this)}static fromBinary(t,n){return new Ia().fromBinary(t,n)}static fromJson(t,n){return new Ia().fromJson(t,n)}static fromJsonString(t,n){return new Ia().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Ia,t,n)}}Ia.runtime=N;Ia.typeName="livekit.RTPStats";Ia.fields=N.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:En},{no:2,name:"end_time",kind:"message",T:En},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:En},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:En},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:En},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:En},{no:44,name:"packet_drift",kind:"message",T:Ao},{no:45,name:"report_drift",kind:"message",T:Ao}]);class ba extends Se{constructor(t){super(),this.unixMicro=He.zero,this.ticks=0,N.util.initPartial(t,this)}static fromBinary(t,n){return new ba().fromBinary(t,n)}static fromJson(t,n){return new ba().fromJson(t,n)}static fromJsonString(t,n){return new ba().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ba,t,n)}}ba.runtime=N;ba.typeName="livekit.TimedVersion";ba.fields=N.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const zu=7e3,$j=[0,300,2*2*300,3*3*300,4*4*300,zu,zu,zu,zu,zu];class Xj{constructor(t){this._retryDelays=t!==void 0?[...t]:$j}nextRetryDelayInMs(t){if(t.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[t.retryCount];return t.retryCount<=1?n:n+Math.random()*1e3}}function X(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(e,[])).next())})}function gS(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function nc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof gS=="function"?gS(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(s){return new Promise(function(a,l){s=e[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var Tx={exports:{}},Tc=typeof Reflect=="object"?Reflect:null,mS=Tc&&typeof Tc.apply=="function"?Tc.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},Xh;Tc&&typeof Tc.ownKeys=="function"?Xh=Tc.ownKeys:Object.getOwnPropertySymbols?Xh=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Xh=function(t){return Object.getOwnPropertyNames(t)};function Kj(e){console&&console.warn&&console.warn(e)}var wD=Number.isNaN||function(t){return t!==t};function bt(){bt.init.call(this)}Tx.exports=bt;Tx.exports.once=Qj;bt.EventEmitter=bt;bt.prototype._events=void 0;bt.prototype._eventsCount=0;bt.prototype._maxListeners=void 0;var vS=10;function Zp(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(bt,"defaultMaxListeners",{enumerable:!0,get:function(){return vS},set:function(e){if(typeof e!="number"||e<0||wD(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");vS=e}});bt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};bt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||wD(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function SD(e){return e._maxListeners===void 0?bt.defaultMaxListeners:e._maxListeners}bt.prototype.getMaxListeners=function(){return SD(this)};bt.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[t];if(l===void 0)return!1;if(typeof l=="function")mS(l,this,n);else for(var c=l.length,u=_D(l,c),r=0;r<c;++r)mS(u[r],this,n);return!0};function kD(e,t,n,r){var i,o,s;if(Zp(n),o=e._events,o===void 0?(o=e._events=Object.create(null),e._eventsCount=0):(o.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),s===void 0)s=o[t]=n,++e._eventsCount;else if(typeof s=="function"?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=SD(e),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,Kj(a)}return e}bt.prototype.addListener=function(t,n){return kD(this,t,n,!1)};bt.prototype.on=bt.prototype.addListener;bt.prototype.prependListener=function(t,n){return kD(this,t,n,!0)};function Jj(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ED(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=Jj.bind(r);return i.listener=n,r.wrapFn=i,i}bt.prototype.once=function(t,n){return Zp(n),this.on(t,ED(this,t,n)),this};bt.prototype.prependOnceListener=function(t,n){return Zp(n),this.prependListener(t,ED(this,t,n)),this};bt.prototype.removeListener=function(t,n){var r,i,o,s,a;if(Zp(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():Yj(r,o),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||n)}return this};bt.prototype.off=bt.prototype.removeListener;bt.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function TD(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?qj(i):_D(i,i.length)}bt.prototype.listeners=function(t){return TD(this,t,!0)};bt.prototype.rawListeners=function(t){return TD(this,t,!1)};bt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):RD.call(e,t)};bt.prototype.listenerCount=RD;function RD(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}bt.prototype.eventNames=function(){return this._eventsCount>0?Xh(this._events):[]};function _D(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Yj(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function qj(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Qj(e,t){return new Promise(function(n,r){function i(s){e.removeListener(t,o),r(s)}function o(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}DD(e,t,o,{once:!0}),t!=="error"&&ez(e,i,{once:!0})})}function ez(e,t,n){typeof e.on=="function"&&DD(e,"error",t,n)}function DD(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Ho=Tx.exports;let PD=!0,ND=!0;function Kh(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function jl(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,a){if(s!==t)return i.apply(this,arguments);const l=c=>{const u=n(c);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(a,l),i.apply(this,[s,l])};const o=r.removeEventListener;r.removeEventListener=function(s,a){if(s!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(a))return o.apply(this,arguments);const l=this._eventMap[t].get(a);return this._eventMap[t].delete(a),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,l])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(s){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),s&&this.addEventListener(t,this["_on"+t]=s)},enumerable:!0,configurable:!0})}function tz(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(PD=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function nz(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(ND=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function BD(){if(typeof window=="object"){if(PD)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Rx(e,t){ND&&console.warn(e+" is deprecated, please use "+t+" instead.")}function rz(e){const t={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Kh(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Kh(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))t.browser="safari",t.version=Kh(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return t.browser="Not a supported browser.",t;return t}function CS(e){return Object.prototype.toString.call(e)==="[object Object]"}function OD(e){return CS(e)?Object.keys(e).reduce(function(t,n){const r=CS(e[n]),i=r?OD(e[n]):e[n],o=r&&!Object.keys(i).length;return i===void 0||o?t:Object.assign(t,{[n]:i})},{}):e}function ey(e,t,n){!t||n.has(t.id)||(n.set(t.id,t),Object.keys(t).forEach(r=>{r.endsWith("Id")?ey(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(i=>{ey(e,e.get(i),n)})}))}function yS(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(t===null)return i;const o=[];return e.forEach(s=>{s.type==="track"&&s.trackIdentifier===t.id&&o.push(s)}),o.forEach(s=>{e.forEach(a=>{a.type===r&&a.trackId===s.id&&ey(e,a,i)})}),i}const xS=BD;function FD(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const l={};return Object.keys(a).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const u=typeof a[c]=="object"?a[c]:{ideal:a[c]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){l.optional=l.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",c)]=u.ideal,l.optional.push(f),f={},f[d("max",c)]=u.ideal,l.optional.push(f)):(f[d("",c)]=u.ideal,l.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[d("",c)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[d(f,c)]=u[f])})}),a.advanced&&(l.optional=(l.optional||[]).concat(a.advanced)),l},i=function(a,l){if(t.version>=61)return l(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const c=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),c(a.audio,"autoGainControl","googAutoGainControl"),c(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let c=a.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const u=t.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(c.exact==="environment"||c.ideal==="environment"?d=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(g=>p.label.toLowerCase().includes(g)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=c.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),xS("chrome: "+JSON.stringify(a)),l(a)})}a.video=r(a.video)}return xS("chrome: "+JSON.stringify(a)),l(a)},o=function(a){return t.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(a,l,c){i(a,u=>{n.webkitGetUserMedia(u,l,d=>{c&&c(o(d))})})};if(n.getUserMedia=s.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(l){return i(l,c=>a(c).then(u=>{if(c.audio&&!u.getAudioTracks().length||c.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(o(u))))}}}function iz(e,t){if(!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&e.navigator.mediaDevices){if(typeof t!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(i=>{const o=r.video&&r.video.width,s=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(r.video.mandatory.maxWidth=o),s&&(r.video.mandatory.maxHeight=s),e.navigator.mediaDevices.getUserMedia(r)})}}}function MD(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function LD(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;e.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):o={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let o;e.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.id):o={track:i};const s=new Event("track");s.track=i,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else jl(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function UD(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(a,l){let c=i.apply(this,arguments);return c||(c=t(this,a),this._senders.push(c)),c};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(a){o.apply(this,arguments);const l=this._senders.indexOf(a);l!==-1&&this._senders.splice(l,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(t(this,s))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const a=this._senders.find(l=>l.track===s);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function VD(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);const s=function(l){const c={};return l.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),c[f.id]=f}),c},a=function(l){return new Map(Object.keys(l).map(c=>[c,l[c]]))};if(arguments.length>=2){const l=function(c){i(a(s(c)))};return t.apply(this,[l,r])}return new Promise((l,c)=>{t.apply(this,[function(u){l(a(s(u)))},c])}).then(i,o)}}function GD(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),e.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>yS(s,o.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),jl(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>yS(o,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const r=arguments[0];let i,o,s;return this.getSenders().forEach(a=>{a.track===r&&(i?s=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(o?s=!0:o=a),a.track===r)),s||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function WD(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(s,a){if(!a)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=t.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(l)===-1&&this._shimmedLocalStreams[a.id].push(l):this._shimmedLocalStreams[a.id]=[a,l],l};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(c=>{if(this.getSenders().find(d=>d.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const l=this.getSenders().filter(c=>a.indexOf(c)===-1);this._shimmedLocalStreams[s.id]=[s].concat(l)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const l=this._shimmedLocalStreams[a].indexOf(s);l!==-1&&this._shimmedLocalStreams[a].splice(l,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function jD(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return WD(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new e.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},e.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new e.MediaStream([u]);this._streams[d.id]=g,this._reverseStreams[g.id]=d,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function o(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function s(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(c){const u=e.RTCPeerConnection.prototype[c],d={[c](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=o(this,p);f[0].apply(null,[g])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>o(this,p))}};e.RTCPeerConnection.prototype[c]=d[c]});const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=s(this,arguments[0]),a.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const c=l.get.apply(this);return c.type===""?c:o(this,c)}}),e.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(g=>u.track===g)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function ty(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=e.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=i[n]})}function zD(e,t){jl(e,"negotiationneeded",n=>{const r=n.target;if(!((t.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var IS=Object.freeze({__proto__:null,fixNegotiationNeeded:zD,shimAddTrackRemoveTrack:jD,shimAddTrackRemoveTrackWithNative:WD,shimGetDisplayMedia:iz,shimGetSendersWithDtmf:UD,shimGetStats:VD,shimGetUserMedia:FD,shimMediaStream:MD,shimOnTrack:LD,shimPeerConnection:ty,shimSenderReceiverGetStats:GD});function HD(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(i,o,s){Rx("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(o,s)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(s,a,l){a in s&&!(l in s)&&(s[l]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function oz(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function ZD(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ny(e,t){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=e.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};e.RTCPeerConnection.prototype[i]=s[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[o,s,a]=arguments;return r.apply(this,[o||null]).then(l=>{if(t.version<53&&!s)try{l.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((u,d)=>{l.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return l}).then(s,a)}}function $D(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function XD(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(i=>i._pc=this),r}),jl(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function KD(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){Rx("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function JD(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function YD(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=t.apply(this,arguments);if(i){const{sender:s}=o,a=s.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function qD(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function QD(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function eP(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var bS=Object.freeze({__proto__:null,shimAddTransceiver:YD,shimCreateAnswer:eP,shimCreateOffer:QD,shimGetDisplayMedia:oz,shimGetParameters:qD,shimGetUserMedia:HD,shimOnTrack:ZD,shimPeerConnection:ny,shimRTCDataChannel:JD,shimReceiverGetStats:XD,shimRemoveStream:KD,shimSenderGetStats:$D});function tP(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>t.call(this,i,r)),r.getVideoTracks().forEach(i=>t.call(this,i,r))},e.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return o&&o.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function nP(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,r.dispatchEvent(s)})}),t.apply(r,arguments)}}}function rP(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f},t.createAnswer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f};let a=function(l,c,u){const d=i.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d};t.setLocalDescription=a,a=function(l,c,u){const d=o.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},t.setRemoteDescription=a,a=function(l,c,u){const d=s.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},t.addIceCandidate=a}function iP(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=i=>r(oP(i))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,i,o){t.mediaDevices.getUserMedia(r).then(i,o)}).bind(t))}function oP(e){return e&&e.video!==void 0?Object.assign({},e,{video:OD(e.video)}):e}function sP(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let s=0;s<r.iceServers.length;s++){let a=r.iceServers[s];a.urls===void 0&&a.url?(Rx("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(r.iceServers[s])}r.iceServers=o}return new t(r,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return t.generateCertificate}})}function aP(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function lP(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function cP(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var AS=Object.freeze({__proto__:null,shimAudioContext:cP,shimCallbacksAPI:rP,shimConstraints:oP,shimCreateOfferLegacy:lP,shimGetUserMedia:iP,shimLocalStreamsAPI:tP,shimRTCIceServerUrls:sP,shimRemoteStreamsAPI:nP,shimTrackEventTransceiver:aP}),uP={exports:{}};(function(e){const t={};t.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},t.localCName=t.generateIdentifier(),t.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},t.splitSections=function(n){return n.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},t.getDescription=function(n){const r=t.splitSections(n);return r&&r[0]},t.getMediaSections=function(n){const r=t.splitSections(n);return r.shift(),r},t.matchPrefix=function(n,r){return t.splitLines(n).filter(i=>i.indexOf(r)===0)},t.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},t.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},t.parseIceOptions=function(n){return n.substring(14).split(" ")},t.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},t.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},t.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},t.parseFmtp=function(n){const r={};let i;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),r[i[0].trim()]=i[1];return r},t.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{n.parameters[s]!==void 0?o.push(s+"="+n.parameters[s]):o.push(s)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},t.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},t.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},t.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(i.attribute=n.substring(r+1,o),i.value=n.substring(o+1)):i.attribute=n.substring(r+1),i},t.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},t.getMid=function(n){const r=t.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},t.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},t.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:t.matchPrefix(n+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},t.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},t.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?t.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},t.getCryptoParameters=function(n,r){return t.matchPrefix(n+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(n,r){const i=t.matchPrefix(n+r,"a=ice-ufrag:")[0],o=t.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},t.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},t.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=t.splitLines(n)[0].split(" ");r.profile=o[2];for(let a=3;a<o.length;a++){const l=o[a],c=t.matchPrefix(n,"a=rtpmap:"+l+" ")[0];if(c){const u=t.parseRtpMap(c),d=t.matchPrefix(n,"a=fmtp:"+l+" ");switch(u.parameters=d.length?t.parseFmtp(d[0]):{},u.rtcpFeedback=t.matchPrefix(n,"a=rtcp-fb:"+l+" ").map(t.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}t.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(t.parseExtmap(a))});const s=t.matchPrefix(n,"a=rtcp-fb:* ").map(t.parseRtcpFb);return r.codecs.forEach(a=>{s.forEach(l=>{a.rtcpFeedback.find(u=>u.type===l.type&&u.parameter===l.parameter)||a.rtcpFeedback.push(l)})}),r},t.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=t.writeRtpMap(s),i+=t.writeFmtp(s),i+=t.writeRtcpFb(s)});let o=0;return r.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=t.writeExtmap(s)}),i},t.parseRtpEncodingParameters=function(n){const r=[],i=t.parseRtpParameters(n),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=t.matchPrefix(n,"a=ssrc:").map(f=>t.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),l=a.length>0&&a[0].ssrc;let c;const u=t.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===l&&(c=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:l,codecPayloadType:parseInt(f.parameters.apt,10)};l&&c&&(h.rtx={ssrc:c}),r.push(h),o&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:l,mechanism:s?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&l&&r.push({ssrc:l});let d=t.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},t.parseRtcpParameters=function(n){const r={},i=t.matchPrefix(n,"a=ssrc:").map(a=>t.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=t.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const s=t.matchPrefix(n,"a=rtcp-mux");return r.mux=s.length>0,r},t.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},t.parseMsid=function(n){let r;const i=t.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=t.matchPrefix(n,"a=ssrc:").map(s=>t.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},t.parseSctpDescription=function(n){const r=t.parseMLine(n),i=t.matchPrefix(n,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const s=t.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const a=t.matchPrefix(n,"a=sctpmap:");if(a.length>0){const l=a[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:o}}},t.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(n,r,i){let o;const s=r!==void 0?r:2;return n?o=n:o=t.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(n,r){const i=t.splitLines(n);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(n){return t.splitLines(n)[0].split(" ")[0].substring(2)},t.isRejected=function(n){return n.split(" ",2)[1]==="0"},t.parseMLine=function(n){const i=t.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(n){const i=t.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=t.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},e.exports=t})(uP);var dP=uP.exports,Rc=aj(dP),sz=oj({__proto__:null,default:Rc},[dP]);function Jh(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new t(r),o=Rc.parseCandidate(r.candidate);for(const s in o)s in i||Object.defineProperty(i,s,{value:o[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(r)},e.RTCIceCandidate.prototype=t.prototype,jl(e,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new e.RTCIceCandidate(n.candidate),writable:"false"}),n))}function ry(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||jl(e,"icecandidate",t=>{if(t.candidate){const n=Rc.parseCandidate(t.candidate.candidate);n.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return t})}function Yh(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const l=Rc.splitSections(a.sdp);return l.shift(),l.some(c=>{const u=Rc.parseMLine(c);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const l=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const c=parseInt(l[1],10);return c!==c?-1:c},i=function(a){let l=65536;return t.browser==="firefox"&&(t.version<57?a===-1?l=16384:l=2147483637:t.version<60?l=t.version===57?65535:65536:l=2147483637),l},o=function(a,l){let c=65536;t.browser==="firefox"&&t.version===57&&(c=65535);const u=Rc.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?c=parseInt(u[0].substring(19),10):t.browser==="firefox"&&l!==-1&&(c=2147483637),c},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const l=r(arguments[0]),c=i(l),u=o(arguments[0],l);let d;c===0&&u===0?d=Number.POSITIVE_INFINITY:c===0||u===0?d=Math.max(c,u):d=Math.min(c,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return s.apply(this,arguments)}}function qh(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(r,i){const o=r.send;r.send=function(){const a=arguments[0],l=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return t(i,this),i},jl(e,"datachannel",r=>(t(r.channel,r.target),r))}function iy(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=t[n];t[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function oy(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function Qh(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function e0(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(e.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>n.apply(this,[s]))})}var az=Object.freeze({__proto__:null,removeExtmapAllowMixed:oy,shimAddIceCandidateNullOrEmpty:Qh,shimConnectionState:iy,shimMaxMessageSize:Yh,shimParameterlessSetLocalDescription:e0,shimRTCIceCandidate:Jh,shimRTCIceCandidateRelayProtocol:ry,shimSendThrowTypeError:qh});function lz(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=BD,r=rz(e),i={browserDetails:r,commonShim:az,extractVersion:Kh,disableLog:tz,disableWarnings:nz,sdp:sz};switch(r.browser){case"chrome":if(!IS||!ty||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=IS,Qh(e,r),e0(e),FD(e,r),MD(e),ty(e,r),LD(e),jD(e,r),UD(e),VD(e),GD(e),zD(e,r),Jh(e),ry(e),iy(e),Yh(e,r),qh(e),oy(e,r);break;case"firefox":if(!bS||!ny||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=bS,Qh(e,r),e0(e),HD(e,r),ny(e,r),ZD(e),KD(e),$D(e),XD(e),JD(e),YD(e),qD(e),QD(e),eP(e),Jh(e),iy(e),Yh(e,r),qh(e);break;case"safari":if(!AS||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=AS,Qh(e,r),e0(e),sP(e),lP(e),rP(e),tP(e),nP(e),aP(e),iP(e),cP(e),Jh(e),ry(e),Yh(e,r),qh(e),oy(e,r);break;default:n("Unsupported browser!");break}return i}lz({window:typeof window>"u"?void 0:window});const cz=10,dh="lk_e2ee",uz="LKFrameEncryptionKey",dz={sharedKey:!1,ratchetSalt:uz,ratchetWindowSize:8,failureTolerance:cz};var Na;(function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"})(Na||(Na={}));var wS;(function(e){e.KeyRatcheted="keyRatcheted"})(wS||(wS={}));var Aa;(function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"})(Aa||(Aa={}));var SS;(function(e){e.Error="cryptorError"})(SS||(SS={}));function fz(){return hz()||sy()}function sy(){return typeof window.RTCRtpScriptTransform<"u"}function hz(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class JY extends Ho.EventEmitter{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{et.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},dz),t),this.on(Na.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(t,n,r){const i={key:t,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(Na.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(t,n){this.emit(Na.RatchetRequest,t,n)}}class mu extends Error{constructor(t,n){super(n||"an error has occured"),this.code=t}}class Tt extends mu{constructor(t,n,r){super(1,t),this.status=r,this.reason=n}}class _x extends mu{constructor(t){super(21,t??"device is unsupported")}}class po extends mu{constructor(t){super(20,t??"track is invalid")}}class pz extends mu{constructor(t){super(10,t??"unsupported server")}}class gn extends mu{constructor(t){super(12,t??"unexpected connection state")}}class ay extends mu{constructor(t){super(13,t??"unable to negotiate")}}var sf;(function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"})(sf||(sf={}));(function(e){function t(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?e.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?e.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?e.DeviceInUse:e.Other}e.getFailure=t})(sf||(sf={}));var ue;(function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.StateChanged="connectionStateChanged",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged"})(ue||(ue={}));var de;(function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded"})(de||(de={}));var Te;(function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished"})(Te||(Te={}));var xe;(function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed"})(xe||(xe={}));function Dx(e,t,n){var r,i,o;t===void 0&&(t=50),n===void 0&&(n={});var s=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,l=n.maxWait,c=Date.now(),u=[];function d(){if(l!==void 0){var h=Date.now()-c;if(h+t>=l)return l-h}return t}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(g,C){var v=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,c=Date.now(),!s){var y=e.apply(p,h);a&&a(y),u.forEach(function(x){return(0,x.resolve)(y)}),u=[]}},d()),v){var m=e.apply(p,h);return a&&a(m),g(m)}u.push({resolve:g,reject:C})})};return f.cancel=function(h){o!==void 0&&clearTimeout(o),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const gz=/version\/(\d+(\.?_?\d+)+)/i;let Wm;function Gs(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Wm===void 0||t){const r=mz.find(i=>{let{test:o}=i;return o.test(n)});Wm=r==null?void 0:r.describe(n)}return Wm}const mz=[{test:/firefox|iceweasel|fxios/i,describe(e){return{name:"Firefox",version:jm(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(e){return{name:"Chrome",version:jm(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(e){return{name:"Safari",version:jm(gz,e),os:e.includes("mobile/")?"iOS":"macOS"}}}];function jm(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=t.match(e);return r&&r.length>=n&&r[n]||""}var vz="1.15.13";const Cz=vz,yz=11;class On{}On.setTimeout=function(){return setTimeout(...arguments)};On.setInterval=function(){return setInterval(...arguments)};On.clearTimeout=function(){return clearTimeout(...arguments)};On.clearInterval=function(){return clearInterval(...arguments)};class It{constructor(t,n,r,i,o){this.width=t,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const xz=["vp8","h264"],fP=["vp8","h264","vp9","av1"];function Iz(e){return!!xz.find(t=>t===e)}var tp;(function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3},e.musicStereo={maxBitrate:48e3},e.musicHighQuality={maxBitrate:64e3},e.musicHighQualityStereo={maxBitrate:96e3}})(tp||(tp={}));const af={h90:new It(160,90,9e4,20),h180:new It(320,180,16e4,20),h216:new It(384,216,18e4,20),h360:new It(640,360,45e4,20),h540:new It(960,540,8e5,25),h720:new It(1280,720,17e5,30),h1080:new It(1920,1080,3e6,30),h1440:new It(2560,1440,5e6,30),h2160:new It(3840,2160,8e6,30)},ly={h120:new It(160,120,7e4,20),h180:new It(240,180,125e3,20),h240:new It(320,240,14e4,20),h360:new It(480,360,33e4,20),h480:new It(640,480,5e5,20),h540:new It(720,540,6e5,25),h720:new It(960,720,13e5,30),h1080:new It(1440,1080,23e5,30),h1440:new It(1920,1440,38e5,30)},Px={h360fps3:new It(640,360,2e5,3,"medium"),h360fps15:new It(640,360,4e5,15,"medium"),h720fps5:new It(1280,720,8e5,5,"medium"),h720fps15:new It(1280,720,15e5,15,"medium"),h720fps30:new It(1280,720,2e6,30,"medium"),h1080fps15:new It(1920,1080,25e5,15,"medium"),h1080fps30:new It(1920,1080,5e6,30,"medium"),original:new It(0,0,7e6,30,"medium")};var Kn;(function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER"})(Kn||(Kn={}));N.util.setEnumType(Kn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var Dl;(function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED"})(Dl||(Dl={}));N.util.setEnumType(Dl,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var np;(function(e){e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.TLS=2]="TLS"})(np||(np={}));N.util.setEnumType(np,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class hs extends Se{constructor(t){super(),this.message={case:void 0},N.util.initPartial(t,this)}static fromBinary(t,n){return new hs().fromBinary(t,n)}static fromJson(t,n){return new hs().fromJson(t,n)}static fromJsonString(t,n){return new hs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(hs,t,n)}}hs.runtime=N;hs.typeName="livekit.SignalRequest";hs.fields=N.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:dr,oneof:"message"},{no:2,name:"answer",kind:"message",T:dr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:ji,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Wi,oneof:"message"},{no:5,name:"mute",kind:"message",T:zi,oneof:"message"},{no:6,name:"subscription",kind:"message",T:pi,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:So,oneof:"message"},{no:8,name:"leave",kind:"message",T:gi,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:ko,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:_o,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Do,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Pn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Eo,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:No,oneof:"message"}]);class wo extends Se{constructor(t){super(),this.message={case:void 0},N.util.initPartial(t,this)}static fromBinary(t,n){return new wo().fromBinary(t,n)}static fromJson(t,n){return new wo().fromJson(t,n)}static fromJsonString(t,n){return new wo().fromJsonString(t,n)}static equals(t,n){return N.util.equals(wo,t,n)}}wo.runtime=N;wo.typeName="livekit.SignalResponse";wo.fields=N.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:ps,oneof:"message"},{no:2,name:"answer",kind:"message",T:dr,oneof:"message"},{no:3,name:"offer",kind:"message",T:dr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:ji,oneof:"message"},{no:5,name:"update",kind:"message",T:vs,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Hi,oneof:"message"},{no:8,name:"leave",kind:"message",T:gi,oneof:"message"},{no:9,name:"mute",kind:"message",T:zi,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Cs,oneof:"message"},{no:11,name:"room_update",kind:"message",T:ys,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Is,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:As,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Ss,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:ks,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:ms,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:gs,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Es,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Rs,oneof:"message"}]);class Gi extends Se{constructor(t){super(),this.codec="",this.cid="",N.util.initPartial(t,this)}static fromBinary(t,n){return new Gi().fromBinary(t,n)}static fromJson(t,n){return new Gi().fromJson(t,n)}static fromJsonString(t,n){return new Gi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Gi,t,n)}}Gi.runtime=N;Gi.typeName="livekit.SimulcastCodec";Gi.fields=N.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Wi extends Se{constructor(t){super(),this.cid="",this.name="",this.type=Xn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=rn.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Nn.NONE,this.stream="",N.util.initPartial(t,this)}static fromBinary(t,n){return new Wi().fromBinary(t,n)}static fromJson(t,n){return new Wi().fromJson(t,n)}static fromJsonString(t,n){return new Wi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Wi,t,n)}}Wi.runtime=N;Wi.typeName="livekit.AddTrackRequest";Wi.fields=N.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:N.getEnumType(Xn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:N.getEnumType(rn)},{no:9,name:"layers",kind:"message",T:ur,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Gi,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:N.getEnumType(Nn)},{no:15,name:"stream",kind:"scalar",T:9}]);class ji extends Se{constructor(t){super(),this.candidateInit="",this.target=Kn.PUBLISHER,N.util.initPartial(t,this)}static fromBinary(t,n){return new ji().fromBinary(t,n)}static fromJson(t,n){return new ji().fromJson(t,n)}static fromJsonString(t,n){return new ji().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ji,t,n)}}ji.runtime=N;ji.typeName="livekit.TrickleRequest";ji.fields=N.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:N.getEnumType(Kn)}]);class zi extends Se{constructor(t){super(),this.sid="",this.muted=!1,N.util.initPartial(t,this)}static fromBinary(t,n){return new zi().fromBinary(t,n)}static fromJson(t,n){return new zi().fromJson(t,n)}static fromJsonString(t,n){return new zi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(zi,t,n)}}zi.runtime=N;zi.typeName="livekit.MuteTrackRequest";zi.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class ps extends Se{constructor(t){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),N.util.initPartial(t,this)}static fromBinary(t,n){return new ps().fromBinary(t,n)}static fromJson(t,n){return new ps().fromJson(t,n)}static fromJsonString(t,n){return new ps().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ps,t,n)}}ps.runtime=N;ps.typeName="livekit.JoinResponse";ps.fields=N.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:gu},{no:2,name:"participant",kind:"message",T:qr},{no:3,name:"other_participants",kind:"message",T:qr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:To,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Io},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:us},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class gs extends Se{constructor(t){super(),this.iceServers=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new gs().fromBinary(t,n)}static fromJson(t,n){return new gs().fromJson(t,n)}static fromJsonString(t,n){return new gs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(gs,t,n)}}gs.runtime=N;gs.typeName="livekit.ReconnectResponse";gs.fields=N.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:To,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Io}]);class Hi extends Se{constructor(t){super(),this.cid="",N.util.initPartial(t,this)}static fromBinary(t,n){return new Hi().fromBinary(t,n)}static fromJson(t,n){return new Hi().fromJson(t,n)}static fromJsonString(t,n){return new Hi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Hi,t,n)}}Hi.runtime=N;Hi.typeName="livekit.TrackPublishedResponse";Hi.fields=N.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Tr}]);class ms extends Se{constructor(t){super(),this.trackSid="",N.util.initPartial(t,this)}static fromBinary(t,n){return new ms().fromBinary(t,n)}static fromJson(t,n){return new ms().fromJson(t,n)}static fromJsonString(t,n){return new ms().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ms,t,n)}}ms.runtime=N;ms.typeName="livekit.TrackUnpublishedResponse";ms.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class dr extends Se{constructor(t){super(),this.type="",this.sdp="",N.util.initPartial(t,this)}static fromBinary(t,n){return new dr().fromBinary(t,n)}static fromJson(t,n){return new dr().fromJson(t,n)}static fromJsonString(t,n){return new dr().fromJsonString(t,n)}static equals(t,n){return N.util.equals(dr,t,n)}}dr.runtime=N;dr.typeName="livekit.SessionDescription";dr.fields=N.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class vs extends Se{constructor(t){super(),this.participants=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new vs().fromBinary(t,n)}static fromJson(t,n){return new vs().fromJson(t,n)}static fromJsonString(t,n){return new vs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(vs,t,n)}}vs.runtime=N;vs.typeName="livekit.ParticipantUpdate";vs.fields=N.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:qr,repeated:!0}]);class pi extends Se{constructor(t){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new pi().fromBinary(t,n)}static fromJson(t,n){return new pi().fromJson(t,n)}static fromJsonString(t,n){return new pi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(pi,t,n)}}pi.runtime=N;pi.typeName="livekit.UpdateSubscription";pi.fields=N.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:xo,repeated:!0}]);class So extends Se{constructor(t){super(),this.trackSids=[],this.disabled=!1,this.quality=xn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,N.util.initPartial(t,this)}static fromBinary(t,n){return new So().fromBinary(t,n)}static fromJson(t,n){return new So().fromJson(t,n)}static fromJsonString(t,n){return new So().fromJsonString(t,n)}static equals(t,n){return N.util.equals(So,t,n)}}So.runtime=N;So.typeName="livekit.UpdateTrackSettings";So.fields=N.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:N.getEnumType(xn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class gi extends Se{constructor(t){super(),this.canReconnect=!1,this.reason=Ps.UNKNOWN_REASON,N.util.initPartial(t,this)}static fromBinary(t,n){return new gi().fromBinary(t,n)}static fromJson(t,n){return new gi().fromJson(t,n)}static fromJsonString(t,n){return new gi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(gi,t,n)}}gi.runtime=N;gi.typeName="livekit.LeaveRequest";gi.fields=N.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:N.getEnumType(Ps)}]);class ko extends Se{constructor(t){super(),this.trackSid="",this.layers=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new ko().fromBinary(t,n)}static fromJson(t,n){return new ko().fromJson(t,n)}static fromJsonString(t,n){return new ko().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ko,t,n)}}ko.runtime=N;ko.typeName="livekit.UpdateVideoLayers";ko.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ur,repeated:!0}]);class Eo extends Se{constructor(t){super(),this.metadata="",this.name="",N.util.initPartial(t,this)}static fromBinary(t,n){return new Eo().fromBinary(t,n)}static fromJson(t,n){return new Eo().fromJson(t,n)}static fromJsonString(t,n){return new Eo().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Eo,t,n)}}Eo.runtime=N;Eo.typeName="livekit.UpdateParticipantMetadata";Eo.fields=N.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class To extends Se{constructor(t){super(),this.urls=[],this.username="",this.credential="",N.util.initPartial(t,this)}static fromBinary(t,n){return new To().fromBinary(t,n)}static fromJson(t,n){return new To().fromJson(t,n)}static fromJsonString(t,n){return new To().fromJsonString(t,n)}static equals(t,n){return N.util.equals(To,t,n)}}To.runtime=N;To.typeName="livekit.ICEServer";To.fields=N.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Cs extends Se{constructor(t){super(),this.speakers=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new Cs().fromBinary(t,n)}static fromJson(t,n){return new Cs().fromJson(t,n)}static fromJsonString(t,n){return new Cs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Cs,t,n)}}Cs.runtime=N;Cs.typeName="livekit.SpeakersChanged";Cs.fields=N.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Co,repeated:!0}]);class ys extends Se{constructor(t){super(),N.util.initPartial(t,this)}static fromBinary(t,n){return new ys().fromBinary(t,n)}static fromJson(t,n){return new ys().fromJson(t,n)}static fromJsonString(t,n){return new ys().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ys,t,n)}}ys.runtime=N;ys.typeName="livekit.RoomUpdate";ys.fields=N.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:gu}]);class xs extends Se{constructor(t){super(),this.participantSid="",this.quality=ss.POOR,this.score=0,N.util.initPartial(t,this)}static fromBinary(t,n){return new xs().fromBinary(t,n)}static fromJson(t,n){return new xs().fromJson(t,n)}static fromJsonString(t,n){return new xs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(xs,t,n)}}xs.runtime=N;xs.typeName="livekit.ConnectionQualityInfo";xs.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:N.getEnumType(ss)},{no:3,name:"score",kind:"scalar",T:2}]);class Is extends Se{constructor(t){super(),this.updates=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new Is().fromBinary(t,n)}static fromJson(t,n){return new Is().fromJson(t,n)}static fromJsonString(t,n){return new Is().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Is,t,n)}}Is.runtime=N;Is.typeName="livekit.ConnectionQualityUpdate";Is.fields=N.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:xs,repeated:!0}]);class bs extends Se{constructor(t){super(),this.participantSid="",this.trackSid="",this.state=Dl.ACTIVE,N.util.initPartial(t,this)}static fromBinary(t,n){return new bs().fromBinary(t,n)}static fromJson(t,n){return new bs().fromJson(t,n)}static fromJsonString(t,n){return new bs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(bs,t,n)}}bs.runtime=N;bs.typeName="livekit.StreamStateInfo";bs.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:N.getEnumType(Dl)}]);class As extends Se{constructor(t){super(),this.streamStates=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new As().fromBinary(t,n)}static fromJson(t,n){return new As().fromJson(t,n)}static fromJsonString(t,n){return new As().fromJsonString(t,n)}static equals(t,n){return N.util.equals(As,t,n)}}As.runtime=N;As.typeName="livekit.StreamStateUpdate";As.fields=N.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:bs,repeated:!0}]);class Zi extends Se{constructor(t){super(),this.quality=xn.LOW,this.enabled=!1,N.util.initPartial(t,this)}static fromBinary(t,n){return new Zi().fromBinary(t,n)}static fromJson(t,n){return new Zi().fromJson(t,n)}static fromJsonString(t,n){return new Zi().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Zi,t,n)}}Zi.runtime=N;Zi.typeName="livekit.SubscribedQuality";Zi.fields=N.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:N.getEnumType(xn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class ws extends Se{constructor(t){super(),this.codec="",this.qualities=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new ws().fromBinary(t,n)}static fromJson(t,n){return new ws().fromJson(t,n)}static fromJsonString(t,n){return new ws().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ws,t,n)}}ws.runtime=N;ws.typeName="livekit.SubscribedCodec";ws.fields=N.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Zi,repeated:!0}]);class Ss extends Se{constructor(t){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new Ss().fromBinary(t,n)}static fromJson(t,n){return new Ss().fromJson(t,n)}static fromJsonString(t,n){return new Ss().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Ss,t,n)}}Ss.runtime=N;Ss.typeName="livekit.SubscribedQualityUpdate";Ss.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Zi,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:ws,repeated:!0}]);class Ro extends Se{constructor(t){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",N.util.initPartial(t,this)}static fromBinary(t,n){return new Ro().fromBinary(t,n)}static fromJson(t,n){return new Ro().fromJson(t,n)}static fromJsonString(t,n){return new Ro().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Ro,t,n)}}Ro.runtime=N;Ro.typeName="livekit.TrackPermission";Ro.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class _o extends Se{constructor(t){super(),this.allParticipants=!1,this.trackPermissions=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new _o().fromBinary(t,n)}static fromJson(t,n){return new _o().fromJson(t,n)}static fromJsonString(t,n){return new _o().fromJsonString(t,n)}static equals(t,n){return N.util.equals(_o,t,n)}}_o.runtime=N;_o.typeName="livekit.SubscriptionPermission";_o.fields=N.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Ro,repeated:!0}]);class ks extends Se{constructor(t){super(),this.participantSid="",this.trackSid="",this.allowed=!1,N.util.initPartial(t,this)}static fromBinary(t,n){return new ks().fromBinary(t,n)}static fromJson(t,n){return new ks().fromJson(t,n)}static fromJsonString(t,n){return new ks().fromJsonString(t,n)}static equals(t,n){return N.util.equals(ks,t,n)}}ks.runtime=N;ks.typeName="livekit.SubscriptionPermissionUpdate";ks.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class Do extends Se{constructor(t){super(),this.publishTracks=[],this.dataChannels=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new Do().fromBinary(t,n)}static fromJson(t,n){return new Do().fromJson(t,n)}static fromJsonString(t,n){return new Do().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Do,t,n)}}Do.runtime=N;Do.typeName="livekit.SyncState";Do.fields=N.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:dr},{no:2,name:"subscription",kind:"message",T:pi},{no:3,name:"publish_tracks",kind:"message",T:Hi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Po,repeated:!0},{no:5,name:"offer",kind:"message",T:dr}]);class Po extends Se{constructor(t){super(),this.label="",this.id=0,this.target=Kn.PUBLISHER,N.util.initPartial(t,this)}static fromBinary(t,n){return new Po().fromBinary(t,n)}static fromJson(t,n){return new Po().fromJson(t,n)}static fromJsonString(t,n){return new Po().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Po,t,n)}}Po.runtime=N;Po.typeName="livekit.DataChannelInfo";Po.fields=N.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:N.getEnumType(Kn)}]);class Pn extends Se{constructor(t){super(),this.scenario={case:void 0},N.util.initPartial(t,this)}static fromBinary(t,n){return new Pn().fromBinary(t,n)}static fromJson(t,n){return new Pn().fromJson(t,n)}static fromJsonString(t,n){return new Pn().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Pn,t,n)}}Pn.runtime=N;Pn.typeName="livekit.SimulateScenario";Pn.fields=N.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:N.getEnumType(np),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class No extends Se{constructor(t){super(),this.timestamp=He.zero,this.rtt=He.zero,N.util.initPartial(t,this)}static fromBinary(t,n){return new No().fromBinary(t,n)}static fromJson(t,n){return new No().fromJson(t,n)}static fromJsonString(t,n){return new No().fromJsonString(t,n)}static equals(t,n){return N.util.equals(No,t,n)}}No.runtime=N;No.typeName="livekit.Ping";No.fields=N.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class Es extends Se{constructor(t){super(),this.lastPingTimestamp=He.zero,this.timestamp=He.zero,N.util.initPartial(t,this)}static fromBinary(t,n){return new Es().fromBinary(t,n)}static fromJson(t,n){return new Es().fromJson(t,n)}static fromJsonString(t,n){return new Es().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Es,t,n)}}Es.runtime=N;Es.typeName="livekit.Pong";Es.fields=N.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class wa extends Se{constructor(t){super(),this.regions=[],N.util.initPartial(t,this)}static fromBinary(t,n){return new wa().fromBinary(t,n)}static fromJson(t,n){return new wa().fromJson(t,n)}static fromJsonString(t,n){return new wa().fromJsonString(t,n)}static equals(t,n){return N.util.equals(wa,t,n)}}wa.runtime=N;wa.typeName="livekit.RegionSettings";wa.fields=N.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Ts,repeated:!0}]);class Ts extends Se{constructor(t){super(),this.region="",this.url="",this.distance=He.zero,N.util.initPartial(t,this)}static fromBinary(t,n){return new Ts().fromBinary(t,n)}static fromJson(t,n){return new Ts().fromJson(t,n)}static fromJsonString(t,n){return new Ts().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Ts,t,n)}}Ts.runtime=N;Ts.typeName="livekit.RegionInfo";Ts.fields=N.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class Rs extends Se{constructor(t){super(),this.trackSid="",this.err=of.SE_UNKNOWN,N.util.initPartial(t,this)}static fromBinary(t,n){return new Rs().fromBinary(t,n)}static fromJson(t,n){return new Rs().fromJson(t,n)}static fromJsonString(t,n){return new Rs().fromJsonString(t,n)}static equals(t,n){return N.util.equals(Rs,t,n)}}Rs.runtime=N;Rs.typeName="livekit.SubscriptionResponse";Rs.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:N.getEnumType(of)}]);function bz(e){if(!(typeof e>"u"))return typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}const Az=5e3,Hu=[];class re extends Ho.EventEmitter{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=re.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=et,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),Az):this.handleAppVisibilityChanged()},this.log=Vs((i=r.loggerName)!==null&&i!==void 0?i:Uo.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=t,this._mediaStreamID=t.id,this.source=re.Source.Unknown}get logContext(){var t;return Object.assign(Object.assign({},(t=this.loggerContextCb)===null||t===void 0?void 0:t.call(this)),Ft(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(t){let n="audio";this.kind===re.Kind.Video&&(n="video"),this.attachedElements.length===0&&re.Kind.Video&&this.addAppVisibilityListener(),t||(n==="audio"&&(Hu.forEach(o=>{o.parentElement===null&&!t&&(t=o)}),t&&Hu.splice(Hu.indexOf(t),1)),t||(t=document.createElement(n))),this.attachedElements.includes(t)||this.attachedElements.push(t),mc(this.mediaStreamTrack,t);const r=t.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return t.play().then(()=>{this.emit(i?xe.AudioPlaybackStarted:xe.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?xe.AudioPlaybackFailed:xe.VideoPlaybackFailed,o):o.name==="AbortError"?et.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):et.warn("could not playback ".concat(i?"audio":"video"),o),i&&t&&r.some(s=>s.kind==="video")&&o.name==="NotAllowedError"&&(t.muted=!0,t.play().catch(()=>{}))}),this.emit(xe.ElementAttached,t),t}detach(t){try{if(t){_c(this.mediaStreamTrack,t);const r=this.attachedElements.indexOf(t);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(t),this.emit(xe.ElementDetached,t)),t}const n=[];return this.attachedElements.forEach(r=>{_c(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(xe.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(t){t.loggerName&&(this.log=Vs(t.loggerName)),t.loggerContextCb&&(this.loggerContextCb=t.loggerContextCb)}recycleElement(t){if(t instanceof HTMLAudioElement){let n=!0;t.pause(),Hu.forEach(r=>{r.parentElement||(n=!1)}),n&&Hu.push(t)}}handleAppVisibilityChanged(){return X(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){Pr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Pr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function mc(e,t){let n;t.srcObject instanceof MediaStream?n=t.srcObject:n=new MediaStream;let r;e.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(e)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(e)),(!Pl()||!(t instanceof HTMLVideoElement))&&(t.autoplay=!0),t.muted=n.getAudioTracks().length===0,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(Pl()||qc())&&t instanceof HTMLVideoElement&&setTimeout(()=>{t.srcObject=n,t.play().catch(()=>{})},0))}function _c(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}(function(e){let t;(function(c){c.Audio="audio",c.Video="video",c.Unknown="unknown"})(t=e.Kind||(e.Kind={}));let n;(function(c){c.Camera="camera",c.Microphone="microphone",c.ScreenShare="screen_share",c.ScreenShareAudio="screen_share_audio",c.Unknown="unknown"})(n=e.Source||(e.Source={}));let r;(function(c){c.Active="active",c.Paused="paused",c.Unknown="unknown"})(r=e.StreamState||(e.StreamState={}));function i(c){switch(c){case t.Audio:return Xn.AUDIO;case t.Video:return Xn.VIDEO;default:return Xn.DATA}}e.kindToProto=i;function o(c){switch(c){case Xn.AUDIO:return t.Audio;case Xn.VIDEO:return t.Video;default:return t.Unknown}}e.kindFromProto=o;function s(c){switch(c){case n.Camera:return rn.CAMERA;case n.Microphone:return rn.MICROPHONE;case n.ScreenShare:return rn.SCREEN_SHARE;case n.ScreenShareAudio:return rn.SCREEN_SHARE_AUDIO;default:return rn.UNKNOWN}}e.sourceToProto=s;function a(c){switch(c){case rn.CAMERA:return n.Camera;case rn.MICROPHONE:return n.Microphone;case rn.SCREEN_SHARE:return n.ScreenShare;case rn.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}e.sourceFromProto=a;function l(c){switch(c){case Dl.ACTIVE:return r.Active;case Dl.PAUSED:return r.Paused;default:return r.Unknown}}e.streamStateFromProto=l})(re||(re={}));function hP(e,t,n){var r;const i=(r=bz(e))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&cy(i.audio,t),i.video&&cy(i.video,n),i}function cy(e,t){return Object.keys(t).forEach(n=>{e[n]===void 0&&(e[n]=t[n])}),e}function $p(e){const t={};if(e.video)if(typeof e.video=="object"){const n={},r=n,i=e.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":cy(r,i.resolution);break;default:r[o]=i[o]}}),t.video=n}else t.video=e.video;else t.video=!1;return e.audio?typeof e.audio=="object"?t.audio=e.audio:t.audio=!0:t.audio=!1,t}function wz(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return X(this,void 0,void 0,function*(){const n=Nx();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(r),yield Ns(t),r.getByteTimeDomainData(o);const a=o.some(l=>l!==128&&l!==0);return n.close(),!a}return!1})}function Nx(){const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e)return new e({latencyHint:"interactive"})}function Sz(e){return e===re.Source.Microphone?"audioinput":e===re.Source.Camera?"videoinput":void 0}function kz(e){var t,n;let r=(t=e.video)!==null&&t!==void 0?t:!0;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Pl()?r=Object.assign(Object.assign({},r),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:(n=e.audio)!==null&&n!==void 0?n:!1,video:r,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio}}function pP(e){const t=e.split("/")[1].toLowerCase();if(!fP.includes(t))throw Error("Video codec not supported: ".concat(t));return t}function Ez(e){const t=[];return e.forEach(n=>{n.track!==void 0&&t.push(new Hi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),t}function Ft(e){return e instanceof re?{trackSid:e.sid,trackSource:e.source,trackMuted:e.isMuted,trackEnabled:e.mediaStreamTrack.enabled,trackKind:e.kind}:{trackSid:e.trackSid,trackName:e.trackName,track:e.track?Ft(e.track):void 0,trackEnabled:e.isEnabled,trackEncrypted:e.isEncrypted,trackMimeType:e.mimeType}}const Tz="|",kS="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Rz(e){const t=e.split(Tz);return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}function Ns(e){return X(this,void 0,void 0,function*(){return new Promise(t=>On.setTimeout(t,e))})}function ES(){return"addTransceiver"in RTCPeerConnection.prototype}function TS(){return"addTrack"in RTCPeerConnection.prototype}function _z(){if(!("getCapabilities"in RTCRtpSender)||Pl())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e){for(const n of e.codecs)if(n.mimeType==="video/AV1"){t=!0;break}}return t}function Dz(){if(!("getCapabilities"in RTCRtpSender)||qc())return!1;if(Pl()){const n=Gs();if(n!=null&&n.version&&Bx(n.version,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e){for(const n of e.codecs)if(n.mimeType==="video/VP9"){t=!0;break}}return t}function Ad(e){return e==="av1"||e==="vp9"}function uy(e){return document?(e||(e=document.createElement("audio")),"setSinkId"in e):!1}const Pz={Chrome:"100",Safari:"15",Firefox:"100"};function Nz(e){if(!Pr()||!("setCodecPreferences"in e))return!1;const t=Gs();if(!(t!=null&&t.name)||!t.version)return!1;const n=Pz[t.name];return n?Bx(t.version,n)>=0:!1}function qc(){var e;return((e=Gs())===null||e===void 0?void 0:e.name)==="Firefox"}function Bz(){var e;return((e=Gs())===null||e===void 0?void 0:e.name)==="Chrome"}function Pl(){var e;return((e=Gs())===null||e===void 0?void 0:e.name)==="Safari"}function Oz(){const e=Gs();return(e==null?void 0:e.name)==="Safari"&&e.version.startsWith("17.")}function gP(){return Pr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function Pr(){return typeof document<"u"}function Nl(){return navigator.product=="ReactNative"}function dy(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function mP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function vP(){if(!Nl())return;let e=mP();if(e)return e.platform}function RS(){if(Pr())return window.devicePixelRatio;if(Nl()){let e=mP();if(e)return e.devicePixelRatio}return 1}function Bx(e,t){const n=e.split("."),r=t.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const s=parseInt(n[o],10),a=parseInt(r[o],10);if(s>a)return 1;if(s<a)return-1;if(o===i-1&&s===a)return 0}return e===""&&t!==""?-1:t===""?1:n.length==r.length?0:n.length<r.length?-1:1}function Fz(e){for(const t of e)t.target.handleResize(t)}function Mz(e){for(const t of e)t.target.handleVisibilityChanged(t)}let zm=null;const _S=()=>(zm||(zm=new ResizeObserver(Fz)),zm);let Hm=null;const DS=()=>(Hm||(Hm=new IntersectionObserver(Mz,{root:null,rootMargin:"0px"})),Hm);function Lz(){var e;const t=new ds({sdk:Yc.JS,protocol:yz,version:Cz});return Nl()&&(t.os=(e=vP())!==null&&e!==void 0?e:""),t}function PS(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=e,i.height=t;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(e/2,t/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Zu;function Zm(){if(!Zu){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const r=e.createMediaStreamDestination();if(t.connect(n),n.connect(r),t.start(),[Zu]=r.stream.getAudioTracks(),!Zu)throw Error("Could not get empty media stream audio track");Zu.enabled=!1}return Zu.clone()}class CP{constructor(t,n){this.onFinally=n,this.promise=new Promise((r,i)=>X(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,t&&(yield t(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function Uz(e,t){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},t),r=Nx();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?e.mediaStreamTrack.clone():e.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:s,cleanup:()=>X(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class Ki{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let t;const n=new Promise(i=>t=()=>{this._locks-=1,i()}),r=this._locking.then(()=>t);return this._locking=this._locking.then(()=>n),r}}function Vz(e){return fP.includes(e)}function vl(e){if(typeof e=="string")return e;if(Array.isArray(e))return e[0];if(e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function Gz(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}function NS(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}const BS="default";class sr{static getInstance(){return this.instance===void 0&&(this.instance=new sr),this.instance}getDevices(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return X(this,void 0,void 0,function*(){if(((r=sr.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){et.debug("awaiting getUserMedia promise");try{t?yield sr.userMediaPromiseMap.get(t):yield Promise.all(sr.userMediaPromiseMap.values())}catch{et.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(Pl()&&this.hasDeviceInUse(t))&&(i.length===0||i.some(s=>{const a=s.label==="",l=t?s.kind===t:!0;return a&&l}))){const s={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(s);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(l=>{l.stop()})}return t&&(i=i.filter(o=>o.kind===t)),i})}normalizeDeviceId(t,n,r){return X(this,void 0,void 0,function*(){if(n!==BS)return n;const o=(yield this.getDevices(t)).find(s=>s.groupId===r&&s.deviceId!==BS);return o==null?void 0:o.deviceId})}hasDeviceInUse(t){return t?sr.userMediaPromiseMap.has(t):sr.userMediaPromiseMap.size>0}}sr.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];sr.userMediaPromiseMap=new Map;const Wz=1e3;class Qc extends re{get constraints(){return this._constraints}constructor(t,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(t,n,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Dx(()=>X(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>X(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(xe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Ki,this.pauseUpstreamLock=new Ki,this.processorLock=new Ki,this.setMediaStreamTrack(t,!0),this._constraints=t.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==re.Kind.Video)return;const{width:t,height:n}=this._mediaStreamTrack.getSettings();if(t&&n)return{width:t,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var t,n;return(n=(t=this.processor)===null||t===void 0?void 0:t.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(t,n){return X(this,void 0,void 0,function*(){if(t===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{_c(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([t]),t&&(t.addEventListener("ended",this.handleEnded),t.addEventListener("mute",this.handleTrackMuteEvent),t.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=t.getConstraints());let r;if(this.processor&&t&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");mc(t,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:t,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??t)),!this.providedByUser&&this._mediaStreamTrack!==t&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=t,t&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{mc(r??t,i)}))})}waitForDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wz;var n;return X(this,void 0,void 0,function*(){if(this.kind===re.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=Gs())===null||n===void 0?void 0:n.os)==="iOS"&&(yield Ns(10));const r=Date.now();for(;Date.now()-r<t;){const i=this.dimensions;if(i)return i;yield Ns(50)}throw new po("unable to get track dimensions after timeout")})}getDeviceId(){return X(this,void 0,void 0,function*(){if(this.source===re.Source.ScreenShare)return;const{deviceId:t,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===re.Kind.Audio?"audioinput":"videoinput";return sr.getInstance().normalizeDeviceId(r,t,n)})}mute(){return X(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return X(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return X(this,void 0,void 0,function*(){if(!this.sender)throw new po("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(t),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(t){return X(this,void 0,void 0,function*(){t||(t=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:t}));const n={audio:!1,video:!1};this.kind===re.Kind.Video?n.video=t:n.audio=t,this.attachedElements.forEach(o=>{_c(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=t,this.emit(xe.Restarted,this),this})}setTrackMuted(t){this.log.debug("setting ".concat(this.kind," track ").concat(t?"muted":"unmuted"),this.logContext),!(this.isMuted===t&&this._mediaStreamTrack.enabled!==t)&&(this.isMuted=t,this._mediaStreamTrack.enabled=!t,this.emit(t?xe.Muted:xe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const t=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return X(this,void 0,void 0,function*(){yield t.handleAppVisibilityChanged.call(this),gP()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var t;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(t=this.processor)===null||t===void 0||t.destroy(),this.processor=void 0}pauseUpstream(){return X(this,void 0,void 0,function*(){const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(xe.UpstreamPaused,this);const n=Gs();if((n==null?void 0:n.name)==="Safari"&&Bx(n.version,"12.0")<0)throw new _x("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{t()}})}resumeUpstream(){return X(this,void 0,void 0,function*(){const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(xe.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{t()}})}getRTCStatsReport(){var t;return X(this,void 0,void 0,function*(){return!((t=this.sender)===null||t===void 0)&&t.getStats?yield this.sender.getStats():void 0})}setProcessor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return X(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),mc(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const s={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield t.init(s),this.processor=t,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(_c(this._mediaStreamTrack,a),mc(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var t,n;return X(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(t=this.processor.processedTrack)===null||t===void 0||t.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class jz extends Ho.EventEmitter{constructor(t){super(),this.onWorkerMessage=n=>{var r,i;const{kind:o,data:s}=n.data;switch(o){case"error":et.error(s.error.message),this.emit(Aa.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==s.enabled&&s.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Aa.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(s.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(Aa.ParticipantEncryptionStatusChanged,s.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(Na.KeyRatcheted,s.material,s.keyIndex);break}},this.onWorkerError=n=>{et.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Aa.EncryptionError,n.error)},this.keyProvider=t.keyProvider,this.worker=t.worker,this.encryptionEnabled=!1}setup(t){if(!fz())throw new _x("tried to setup end-to-end encryption on an unsupported browser");if(et.info("setting up e2ee"),t!==this.room){this.room=t,this.setupEventListeners(t,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(et.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(t,n){et.debug("set e2ee to ".concat(t," for participant ").concat(n)),this.postEnable(t,n)}setSifTrailer(t){!t||t.length===0?et.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(t)}setupEngine(t){t.on(Te.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(t,n){t.on(ue.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Nn.NONE,i.identity)),t.on(ue.ConnectionStateChanged,r=>{r===ft.Connected&&t.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Nn.NONE,i.identity)})})}).on(ue.TrackUnsubscribed,(r,i,o)=>{var s;const a={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(s=this.worker)===null||s===void 0||s.postMessage(a)}).on(ue.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ue.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),t.localParticipant.on(de.LocalTrackPublished,r=>X(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(Na.SetKey,r=>this.postKey(r)).on(Na.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(t,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:t,keyIndex:n}};this.worker.postMessage(r)}postKey(t){let{key:n,participantIdentity:r,keyIndex:i}=t;var o;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(s)}postEnable(t,n){if(this.worker){const r={kind:"enable",data:{enabled:t,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(t){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(t){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:t}};this.worker.postMessage(n)}setupE2EEReceiver(t,n,r){if(t.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(t.receiver,t.mediaStreamID,n,t.kind==="video"?pP(r.mimeType):void 0)}}setupE2EESender(t,n){if(!(t instanceof Qc)||!n){n||et.warn("early return because sender is not ready");return}this.handleSender(n,t.mediaStreamID,void 0)}handleReceiver(t,n,r,i){return X(this,void 0,void 0,function*(){if(this.worker){if(sy()){const o={kind:"decode",participantIdentity:r,trackId:n,codec:i};t.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(dh in t&&i){const l={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(l);return}let o=t.writableStream,s=t.readableStream;if(!o||!s){const l=t.createEncodedStreams();t.writableStream=l.writable,o=l.writable,t.readableStream=l.readable,s=l.readable}const a={kind:"decode",data:{readableStream:s,writableStream:o,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[s,o])}t[dh]=!0}})}handleSender(t,n,r){var i;if(!(dh in t||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(sy()){et.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};t.transform=new RTCRtpScriptTransform(this.worker,o)}else{et.info("initialize encoded streams");const o=t.createEncodedStreams(),s={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s,[o.readable,o.writable])}t[dh]=!0}}}var wd;(function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"})(wd||(wd={}));class zz{constructor(){this.pendingTasks=new Map,this.taskMutex=new Ki,this.nextTaskIndex=0}run(t){return X(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:wd.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=wd.RUNNING,yield t()}finally{n.status=wd.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return X(this,void 0,void 0,function*(){return this.run(()=>X(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const Hz=["syncState","trickle","offer","answer","simulate","leave"];function Zz(e){const t=Hz.indexOf(e.case)>=0;return et.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}var qt;(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"})(qt||(qt={}));class Ox{get currentState(){return this.state}get isDisconnected(){return this.state===qt.DISCONNECTING||this.state===qt.DISCONNECTED}get isEstablishingConnection(){return this.state===qt.CONNECTING||this.state===qt.RECONNECTING}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=qt.DISCONNECTED,this.log=et,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Vs((r=n.loggerName)!==null&&r!==void 0?r:Uo.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=t,this.requestQueue=new zz,this.queuedRequests=[],this.closingLock=new Ki,this.connectionLock=new Ki,this.state=qt.DISCONNECTED}get logContext(){var t,n;return(n=(t=this.loggerContextCb)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:{}}join(t,n,r,i){return X(this,void 0,void 0,function*(){return this.state=qt.CONNECTING,this.options=r,yield this.connect(t,n,r,i)})}reconnect(t,n,r,i){return X(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=qt.RECONNECTING,this.clearPingInterval(),yield this.connect(t,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(t,n,r,i){this.connectOptions=r,t=Gz(t),t=t.replace(/\/$/,""),t+="/rtc";const o=Lz(),s=$z(n,o,r);return new Promise((a,l)=>X(this,void 0,void 0,function*(){const c=yield this.connectionLock.lock();try{const u=()=>X(this,void 0,void 0,function*(){this.close(),clearTimeout(d),l(new Tt("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),l(new Tt("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(t+s),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(t+s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>X(this,void 0,void 0,function*(){if(this.state!==qt.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(t.substring(2),"/validate").concat(s));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();l(new Tt(p,0,h.status))}else l(new Tt("Internal error",2,h.status))}catch{l(new Tt("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>X(this,void 0,void 0,function*(){var h,p,g,C;let v;if(typeof f.data=="string"){const m=JSON.parse(f.data);v=wo.fromJson(m)}else if(f.data instanceof ArrayBuffer)v=wo.fromBinary(new Uint8Array(f.data));else{this.log.error("could not decode websocket message: ".concat(typeof f.data),this.logContext);return}if(this.state!==qt.CONNECTED){let m=!1;if(((h=v.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=qt.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=v.message.value.pingTimeout,this.pingIntervalDuration=v.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(v.message.value)):this.state===qt.RECONNECTING&&v.message.case!=="leave"?(this.state=qt.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=v.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((g=v.message)===null||g===void 0?void 0:g.value):(a(),m=!0)):this.isEstablishingConnection&&v.message.case==="leave"?l(new Tt("Received leave request while trying to (re)connect",4)):r.reconnect||l(new Tt("did not receive join response, got ".concat((C=v.message)===null||C===void 0?void 0:C.case," instead"))),!m)return}this.signalLatency&&(yield Ns(this.signalLatency)),this.handleSignalResponse(v)}),this.ws.onclose=f=>{this.isEstablishingConnection&&l(new Tt("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:f.reason,state:this.state})),this.handleOnClose(f.reason)}}finally{c()}}))}close(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return X(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(t&&(this.state=qt.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,Ns(250)])),this.ws=void 0}}finally{t&&(this.state=qt.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:t.sdp})),this.sendRequest({case:"offer",value:rp(t)})}sendAnswer(t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:t.sdp})),this.sendRequest({case:"answer",value:rp(t)})}sendIceCandidate(t,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:t})),this.sendRequest({case:"trickle",value:new ji({candidateInit:JSON.stringify(t),target:n})})}sendMuteTrack(t,n){return this.sendRequest({case:"mute",value:new zi({sid:t,muted:n})})}sendAddTrack(t){return this.sendRequest({case:"addTrack",value:t})}sendUpdateLocalMetadata(t,n){return this.sendRequest({case:"updateMetadata",value:new Eo({metadata:t,name:n})})}sendUpdateTrackSettings(t){this.sendRequest({case:"trackSetting",value:t})}sendUpdateSubscription(t){return this.sendRequest({case:"subscription",value:t})}sendSyncState(t){return this.sendRequest({case:"syncState",value:t})}sendUpdateVideoLayers(t,n){return this.sendRequest({case:"updateLayers",value:new ko({trackSid:t,layers:n})})}sendUpdateSubscriptionPermissions(t,n){return this.sendRequest({case:"subscriptionPermission",value:new _o({allParticipants:t,trackPermissions:n})})}sendSimulateScenario(t){return this.sendRequest({case:"simulate",value:t})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:He.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new No({timestamp:He.parse(Date.now()),rtt:He.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new gi({canReconnect:!1,reason:Ps.CLIENT_INITIATED})})}sendRequest(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return X(this,void 0,void 0,function*(){if(!n&&!Zz(t)&&this.state===qt.RECONNECTING){this.queuedRequests.push(()=>X(this,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield Ns(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),this.logContext);return}const i=new hs({message:t});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(t){var n,r;const i=t.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const s=OS(i.value);this.onAnswer&&this.onAnswer(s)}else if(i.case==="offer"){const s=OS(i.value);this.onOffer&&this.onOffer(s)}else if(i.case==="trickle"){const s=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(s,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const t=this.queuedRequests.shift();t&&this.requestQueue.run(t)}}handleOnClose(t){return X(this,void 0,void 0,function*(){if(this.state===qt.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(t),Object.assign(Object.assign({},this.logContext),{reason:t})),n&&n(t)})}handleWSError(t){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:t}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=On.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&On.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=On.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&On.clearInterval(this.pingInterval)}}function OS(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type;break}return t}function rp(e){return new dr({sdp:e.sdp,type:e.type})}function $z(e,t,n){var r;const i=new URLSearchParams;return i.set("access_token",e),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Nl()?"reactnative":"js"),i.set("version",t.version),i.set("protocol",t.protocol.toString()),t.deviceModel&&i.set("device_model",t.deviceModel),t.os&&i.set("os",t.os),t.osVersion&&i.set("os_version",t.osVersion),t.browser&&i.set("browser",t.browser),t.browserVersion&&i.set("browser_version",t.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var yP={},xP={exports:{}},FS=xP.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(FS).forEach(function(e){var t=FS[e];t.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var IP=xP.exports;(function(e){var t=function(a){return String(Number(a))===a?Number(a):a},n=function(a,l,c,u){if(u&&!c)l[u]=t(a[1]);else for(var d=0;d<c.length;d+=1)a[d+1]!=null&&(l[c[d]]=t(a[d+1]))},r=function(a,l,c){var u=a.name&&a.names;a.push&&!l[a.push]?l[a.push]=[]:u&&!l[a.name]&&(l[a.name]={});var d=a.push?{}:u?l[a.name]:l;n(c.match(a.reg),d,a.names,a.name),a.push&&l[a.push].push(d)},i=IP,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(a){var l={},c=[],u=l;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(c.push({rtp:[],fmtp:[]}),u=c[c.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var g=i[f][p];if(g.reg.test(h))return r(g,u,h)}}),l.media=c,l};var s=function(a,l){var c=l.split(/=(.+)/,2);return c.length===2?a[c[0]]=t(c[1]):c.length===1&&l.length>1&&(a[c[0]]=void 0),a};e.parseParams=function(a){return a.split(/;\s?/).reduce(s,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(a){return a.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(a){for(var l=[],c=a.split(" ").map(t),u=0;u<c.length;u+=3)l.push({component:c[u],ip:c[u+1],port:c[u+2]});return l},e.parseImageAttributes=function(a){return a.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(s,{})})},e.parseSimulcastStreamList=function(a){return a.split(";").map(function(l){return l.split(",").map(function(c){var u,d=!1;return c[0]!=="~"?u=t(c):(u=t(c.substring(1,c.length)),d=!0),{scid:u,paused:d}})})}})(yP);var $m=IP,Xz=/%[sdv%]/g,Kz=function(e){var t=1,n=arguments,r=n.length;return e.replace(Xz,function(i){if(t>=r)return i;var o=n[t];switch(t+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},$u=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,i=[e+"="+r];if(t.names)for(var o=0;o<t.names.length;o+=1){var s=t.names[o];t.name?i.push(n[t.name][s]):i.push(n[t.names[o]])}else i.push(n[t.name]);return Kz.apply(null,i)},Jz=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Yz=["i","c","b","a"],qz=function(e,t){t=t||{},e.version==null&&(e.version=0),e.name==null&&(e.name=" "),e.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var n=t.outerOrder||Jz,r=t.innerOrder||Yz,i=[];return n.forEach(function(o){$m[o].forEach(function(s){s.name in e&&e[s.name]!=null?i.push($u(o,s,e)):s.push in e&&e[s.push]!=null&&e[s.push].forEach(function(a){i.push($u(o,s,a))})})}),e.media.forEach(function(o){i.push($u("m",$m.m[0],o)),r.forEach(function(s){$m[s].forEach(function(a){a.name in o&&o[a.name]!=null?i.push($u(s,a,o)):a.push in o&&o[a.push]!=null&&o[a.push].forEach(function(l){i.push($u(s,a,l))})})})}),i.join(`\r
`)+`\r
`},Qz=yP,eH=qz,Xm=eH,ad=Qz.parse;const MS=.7,Dc={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class LS extends Ho.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=et,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Dx(o=>X(this,void 0,void 0,function*(){this.emit(Dc.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Vs((i=r.loggerName)!==null&&i!==void 0?i:Uo.PCTransport),this.loggerOptions=r,this.config=t,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const t=Bz()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return t.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},t.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},t.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,t.iceConnectionState)},t.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,t.signalingState)},t.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,t.connectionState)},t.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},t.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},t}get logContext(){var t,n;return Object.assign({},(n=(t=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(t))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(t){return X(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(t);this.pendingCandidates.push(t)})}setRemoteDescription(t){var n;return X(this,void 0,void 0,function*(){let r;if(t.type==="offer"){let{stereoMids:i,nackMids:o}=nH(t);this.remoteStereoMids=i,this.remoteNackMids=o}else if(t.type==="answer"){const i=ad((n=t.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||o.mid!=s.transceiver.mid)return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config=c.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(c.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),l=!0;break}return l||s.maxbr>0&&o.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),r=Xm(i)}yield this.setMungedSDP(t,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):t.type==="answer"&&(this.emit(Dc.NegotiationComplete),t.sdp&&ad(t.sdp).media.forEach(o=>{o.type==="video"&&this.emit(Dc.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(t){var n;return X(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(t!=null&&t.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(t!=null&&t.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(t),i=ad((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"?US(o,[],[]):o.type==="video"&&(tH(o),this.trackBitrates.some(s=>{if(!o.msid||!s.cid||!o.msid.includes(s.cid))return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config.includes("x-google-start-bitrate")||(c.config+=";x-google-start-bitrate=".concat(Math.round(s.maxbr*MS))),c.config.includes("x-google-max-bitrate")||(c.config+=";x-google-max-bitrate=".concat(s.maxbr)),l=!0;break}return l||o.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(s.maxbr*MS),";x-google-max-bitrate=").concat(s.maxbr)}),!0}))}),yield this.setMungedSDP(r,Xm(i)),this.onOffer(r)})}createAndSetAnswer(){var t;return X(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=ad((t=n.sdp)!==null&&t!==void 0?t:"");return r.media.forEach(i=>{i.type==="audio"&&US(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Xm(r)),n})}createDataChannel(t,n){return this.pc.createDataChannel(t,n)}addTransceiver(t,n){return this.pc.addTransceiver(t,n)}addTrack(t){if(!this._pc)throw new gn("PC closed, cannot add track");return this._pc.addTrack(t)}setTrackCodecBitrate(t){this.trackBitrates.push(t)}setConfiguration(t){var n;if(!this._pc)throw new gn("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(t)}canRemoveTrack(){var t;return!!(!((t=this._pc)===null||t===void 0)&&t.removeTrack)}removeTrack(t){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(t)}getConnectionState(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var t;return(t=this._pc)===null||t===void 0?void 0:t.localDescription}getRemoteDescription(){var t;return(t=this.pc)===null||t===void 0?void 0:t.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var t;return X(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const s=(t=r.get(n))===null||t===void 0?void 0:t.remoteCandidateId;if(s!==void 0)return i.get(s)})}setMungedSDP(t,n,r){return X(this,void 0,void 0,function*(){if(n){const i=t.sdp;t.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(t):yield this.pc.setLocalDescription(t);return}catch(o){this.log.warn("not able to set ".concat(t.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),t.sdp=i}}try{r?yield this.pc.setRemoteDescription(t):yield this.pc.setLocalDescription(t)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const s={error:o,sdp:t.sdp};throw!r&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(t.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new ay(o)}})}}function US(e,t,n){let r=0;e.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(e.mid)&&!e.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&e.rtcpFb.push({payload:r,type:"nack"}),t.includes(e.mid)&&e.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function tH(e){var t,n,r,i;const o=(n=(t=e.rtp[0])===null||t===void 0?void 0:t.codec)===null||n===void 0?void 0:n.toLowerCase();if(!Ad(o))return;let s=0;((r=e.ext)===null||r===void 0?void 0:r.some(l=>l.uri===kS?!0:(l.value>s&&(s=l.value),!1)))||(i=e.ext)===null||i===void 0||i.push({value:s+1,uri:kS})}function nH(e){var t;const n=[],r=[],i=ad((t=e.sdp)!==null&&t!==void 0?t:"");let o=0;return i.media.forEach(s=>{var a;s.type==="audio"&&(s.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),!((a=s.rtcpFb)===null||a===void 0)&&a.some(l=>l.payload===o&&l.type==="nack")&&r.push(s.mid),s.fmtp.some(l=>l.payload===o?(l.config.includes("sprop-stereo=1")&&n.push(s.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const fy="vp8",rH={audioBitrate:tp.music.maxBitrate,audioPreset:tp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Px.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:fy,backupCodec:!0},bP={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},AP={resolution:af.h720.resolution},iH={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new Xj,disconnectOnPageLeave:!0,expWebAudioMix:!1},Fx={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var vn;(function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"})(vn||(vn={}));class oH{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(t,n,r){var i;this.peerConnectionTimeout=Fx.peerConnectionTimeout,this.log=et,this.updateState=()=>{var s;const a=this.state,l=this.requiredTransports.map(c=>c.getConnectionState());l.every(c=>c==="connected")?this.state=vn.CONNECTED:l.some(c=>c==="failed")?this.state=vn.FAILED:l.some(c=>c==="connecting")?this.state=vn.CONNECTING:l.every(c=>c==="closed")?this.state=vn.CLOSED:l.some(c=>c==="closed")?this.state=vn.CLOSING:l.every(c=>c==="new")&&(this.state=vn.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(vn[a]," to ").concat(vn[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Vs((i=r.loggerName)!==null&&i!==void 0?i:Uo.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const o={optional:[{googDscp:!0}]};this.publisher=new LS(t,o,r),this.subscriber=new LS(t,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Kn.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Kn.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,s)},this.subscriber.onTrack=s=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,s)},this.publisher.onOffer=s=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,s)},this.state=vn.NEW,this.connectionLock=new Ki}get logContext(){var t,n;return Object.assign({},(n=(t=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(t))}requirePublisher(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=t,this.updateState()}requireSubscriber(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=t,this.updateState()}createAndSendPublisherOffer(t){return this.publisher.createAndSendOffer(t)}setPublisherAnswer(t){return this.publisher.setRemoteDescription(t)}removeTrack(t){return this.publisher.removeTrack(t)}close(){return X(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const t=this.publisher;for(const n of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return X(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(t,n){return X(this,void 0,void 0,function*(){n===Kn.PUBLISHER?yield this.publisher.addIceCandidate(t):yield this.subscriber.addIceCandidate(t)})}createSubscriberAnswerFromOffer(t){return X(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:t.type,sdp:t.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(t),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(t,n){this.publisher.setConfiguration(t),this.subscriber.setConfiguration(t),n&&this.triggerIceRestart()}ensurePCTransportConnection(t,n){var r;return X(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,t,n)))}finally{i()}})}negotiate(t){return X(this,void 0,void 0,function*(){return new Promise((n,r)=>X(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};t.signal.addEventListener("abort",o),this.publisher.once(Dc.NegotiationStarted,()=>{t.signal.aborted||this.publisher.once(Dc.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(s=>{clearTimeout(i),r(s)})}))})}addPublisherTransceiver(t,n){return this.publisher.addTransceiver(t,n)}addPublisherTrack(t){return this.publisher.addTrack(t)}createPublisherDataChannel(t,n){return this.publisher.createDataChannel(t,n)}getConnectedAddress(t){return t===Kn.PUBLISHER?this.publisher.getConnectedAddress():t===Kn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const t=[];return this.isPublisherConnectionRequired&&t.push(this.publisher),this.isSubscriberConnectionRequired&&t.push(this.subscriber),t}ensureTransportConnected(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return X(this,void 0,void 0,function*(){if(t.getConnectionState()!=="connected")return new Promise((o,s)=>X(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),On.clearTimeout(l),s(new Tt("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const l=On.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),s(new Tt("could not establish pc connection"))},r);for(;this.state!==vn.CONNECTED;)if(yield Ns(50),n!=null&&n.signal.aborted){s(new Tt("room connection has been cancelled",3));return}On.clearTimeout(l),n==null||n.signal.removeEventListener("abort",a),o()}))})}}const VS="_lossy",GS="_reliable",sH=2*1e3,WS="leave-reconnect";var Si;(function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"})(Si||(Si={}));class aH extends Ho.EventEmitter{get isClosed(){return this._isClosed}constructor(t){var n;super(),this.options=t,this.rtcConfig={},this.peerConnectionTimeout=Fx.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Si.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=et,this.handleDataChannel=r=>{let{channel:i}=r;return X(this,void 0,void 0,function*(){if(i){if(i.label===GS)this.reliableDCSub=i;else if(i.label===VS)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>X(this,void 0,void 0,function*(){var i,o;const s=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const l=vo.fromBinary(new Uint8Array(a));((i=l.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(Te.ActiveSpeakersUpdate,l.value.value.speakers):((o=l.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(Te.DataPacketReceived,l.value.value,l.kind)}finally{s()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?mn.LOSSY:mn.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(Te.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(a===null){o(s);return}r===WS&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=On.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===Si.Connected&&r();const o=()=>{this.off(Te.Disconnected,s),r()},s=()=>{this.off(Te.Restarted,o),i()};this.once(Te.Restarted,o),this.once(Te.Disconnected,s)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(Te.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===qt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(qo.RR_SIGNAL_DISCONNECTED))},this.log=Vs((n=t.loggerName)!==null&&n!==void 0?n:Uo.Engine),this.loggerOptions={loggerName:t.loggerName,loggerContextCb:()=>this.logContext},this.client=new Ox(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Ki,this.dataProcessLock=new Ki,this.dcBufferStatus=new Map([[mn.LOSSY,!0],[mn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Te.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Te.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Te.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Te.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Te.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Te.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Te.StreamStateChanged,r)}get logContext(){var t,n,r,i,o,s;return{room:(n=(t=this.latestJoinResponse)===null||t===void 0?void 0:t.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(s=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||s===void 0?void 0:s.identity}}join(t,n,r,i){return X(this,void 0,void 0,function*(){this.url=t,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(t,n,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof Tt&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(t,n,r,i);throw o}})}close(){return X(this,void 0,void 0,function*(){const t=yield this.closingLock.lock();if(this.isClosed){t();return}try{this._isClosed=!0,this.emit(Te.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{t()}})}cleanupPeerConnections(){var t;return X(this,void 0,void 0,function*(){yield(t=this.pcManager)===null||t===void 0?void 0:t.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return X(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(t){if(this.pendingTrackResolvers[t.cid])throw new po("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[t.cid],r(new Tt("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[t.cid]={resolve:o=>{clearTimeout(i),n(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(t)})}removeTrack(t){if(t.track&&this.pendingTrackResolvers[t.track.id]){const{reject:n}=this.pendingTrackResolvers[t.track.id];n&&n(),delete this.pendingTrackResolvers[t.track.id]}try{return this.pcManager.removeTrack(t),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(t,n){this.client.sendMuteTrack(t,n)}get dataSubscriberReadyState(){var t;return(t=this.reliableDCSub)===null||t===void 0?void 0:t.readyState}getConnectedServerAddress(){var t;return X(this,void 0,void 0,function*(){return(t=this.pcManager)===null||t===void 0?void 0:t.getConnectedAddress()})}setRegionUrlProvider(t){this.regionUrlProvider=t}configure(t){var n;return X(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==vn.NEW)return;this.participantSid=(n=t.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(t);this.pcManager=new oH(r,t.subscriberPrimary,this.loggerOptions),this.emit(Te.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,s)=>X(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===vn.CONNECTED){const a=this.pcState===Si.New;this.pcState=Si.Connected,a&&this.emit(Te.Connected,t)}else i===vn.FAILED&&this.pcState===Si.Connected&&(this.pcState=Si.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?qo.RR_SUBSCRIBER_FAILED:qo.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(Te.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=t=>X(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:t.type})),yield this.pcManager.setPublisherAnswer(t))}),this.client.onTrickle=(t,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:t,target:n})),this.pcManager.addIceCandidate(t,n))},this.client.onOffer=t=>X(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(t);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=t=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:t.cid,track:(n=t.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[t.cid]){this.log.error("missing track resolver for ".concat(t.cid),Object.assign(Object.assign({},this.logContext),{cid:t.cid}));return}const{resolve:r}=this.pendingTrackResolvers[t.cid];delete this.pendingTrackResolvers[t.cid],r(t.track)},this.client.onLocalTrackUnpublished=t=>{this.emit(Te.LocalTrackUnpublished,t)},this.client.onTokenRefresh=t=>{this.token=t},this.client.onRemoteMuteChanged=(t,n)=>{this.emit(Te.RemoteMute,t,n)},this.client.onSubscribedQualityUpdate=t=>{this.emit(Te.SubscribedQualityUpdate,t)},this.client.onClose=()=>{this.handleDisconnect("signal",qo.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=t=>{t!=null&&t.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(WS)):(this.emit(Te.Disconnected,t==null?void 0:t.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:t==null?void 0:t.reason}))}}makeRTCConfiguration(t){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),t.iceServers&&!r.iceServers){const i=[];t.iceServers.forEach(o=>{const s={urls:o.urls};o.username&&(s.username=o.username),o.credential&&(s.credential=o.credential),i.push(s)}),r.iceServers=i}return t.clientConfiguration&&t.clientConfiguration.forceRelay===qi.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(VS,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(GS,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(t,n,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(n);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],s=[],a=[];i.codecs.forEach(l=>{const c=l.mimeType.toLowerCase();if(c==="audio/opus"){o.push(l);return}if(!(c==="video/".concat(r))){a.push(l);return}if(r==="h264"){l.sdpFmtpLine&&l.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(l):s.push(l);return}o.push(l)}),Nz(t)&&t.setCodecPreferences(o.concat(s,a))}createSender(t,n,r){return X(this,void 0,void 0,function*(){if(ES())return yield this.createTransceiverRTCRtpSender(t,n,r);if(TS())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(t.mediaStreamTrack);throw new gn("Required webRTC APIs not supported on this device")})}createSimulcastSender(t,n,r,i){return X(this,void 0,void 0,function*(){if(ES())return this.createSimulcastTransceiverSender(t,n,r,i);if(TS())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(t.mediaStreamTrack);throw new gn("Cannot stream on this device")})}createTransceiverRTCRtpSender(t,n,r){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("publisher is closed");const i=[];t.mediaStream&&i.push(t.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const s=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,o);return t.kind===re.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(s,t.kind,n.videoCodec),t.codec=n.videoCodec),s.sender})}createSimulcastTransceiverSender(t,n,r,i){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(s,t.kind,r.videoCodec),t.setSimulcastTrackSender(r.videoCodec,s.sender),s.sender})}createRTCRtpSender(t){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("publisher is closed");return this.pcManager.addPublisherTrack(t)})}attemptReconnect(t){var n,r,i;return X(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){et.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===qi.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:vn.NEW)===vn.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(t),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let s=!0;o instanceof gn?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),s=!1):o instanceof ec||(this.fullReconnectOnNext=!0),s?this.handleDisconnect("reconnect",qo.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Te.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(t){try{return this.reconnectPolicy.nextRetryDelayInMs(t)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(t){var n,r,i;return X(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new gn("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Te.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new ec;o=yield this.join(t??this.url,this.token,this.signalOpts)}catch(s){throw s instanceof Tt&&s.reason===0?new gn("could not reconnect, token might be expired"):new ec}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Te.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==qt.CONNECTED)throw new ec("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(Te.Restarted)}catch(o){const s=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(s){yield this.restartConnection(s);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(t){var n;return X(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new gn("could not reconnect, url or token not saved");if(!this.pcManager)throw new gn("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Te.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,t);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof Tt&&r.reason===0?new gn("could not reconnect, token might be expired"):r instanceof Tt&&r.reason===4?r:new ec(i)}if(this.emit(Te.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==qt.CONNECTED)throw new ec("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Te.Resumed)})}waitForPCInitialConnection(t,n){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,t)})}waitForPCReconnected(){return X(this,void 0,void 0,function*(){this.pcState=Si.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Ns(sH),!this.pcManager)throw new gn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Si.Connected}catch(t){throw this.pcState=Si.Disconnected,new Tt("could not establish PC connection, ".concat(t.message))}})}sendDataPacket(t,n){return X(this,void 0,void 0,function*(){const r=t.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!i)throw new Tt("".concat(o," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const s=this.dataChannelForKind(t,n);if((s==null?void 0:s.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(t,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield Ns(50)}throw new Tt("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(t){return X(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(t,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==vn.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return X(this,void 0,void 0,function*(){return new Promise((t,n)=>X(this,void 0,void 0,function*(){if(!this.pcManager){n(new ay("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),t()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(Te.Closing,i),this.pcManager.publisher.once(Dc.RTPVideoPayloadTypes,o=>{const s=new Map;o.forEach(a=>{const l=a.codec.toLowerCase();Vz(l)&&s.set(a.payload,l)}),this.emit(Te.RTPVideoMapUpdate,s)});try{yield this.pcManager.negotiate(r),t()}catch(o){o instanceof ay&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",qo.RR_UNKNOWN),n(o)}finally{this.off(Te.Closing,i)}}))})}dataChannelForKind(t,n){if(n){if(t===mn.LOSSY)return this.lossyDCSub;if(t===mn.RELIABLE)return this.reliableDCSub}else{if(t===mn.LOSSY)return this.lossyDC;if(t===mn.RELIABLE)return this.reliableDC}}sendSyncState(t,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,l=new Array;t.forEach(c=>{c.isDesired!==a&&l.push(c.trackSid)}),this.client.sendSyncState(new Do({answer:o?rp({sdp:o.sdp,type:o.type}):void 0,offer:s?rp({sdp:s.sdp,type:s.type}):void 0,subscription:new pi({trackSids:l,subscribe:!a,participantTracks:[]}),publishTracks:Ez(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const t=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&t.push(new Po({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(mn.LOSSY),Kn.PUBLISHER),n(this.dataChannelForKind(mn.RELIABLE),Kn.PUBLISHER),n(this.dataChannelForKind(mn.LOSSY,!0),Kn.SUBSCRIBER),n(this.dataChannelForKind(mn.RELIABLE,!0),Kn.SUBSCRIBER),t}clearReconnectTimeout(){this.reconnectTimeout&&On.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Pr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Pr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class ec extends Error{}class jS{constructor(t,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(t),this.token=n}updateToken(t){this.token=t}isCloud(){return dy(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(t){return X(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(t));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),et.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(t){return X(this,void 0,void 0,function*(){const n=yield fetch("".concat(lH(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:t});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Tt("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function lH(e){return"".concat(e.protocol.replace("ws","http"),"//").concat(e.host,"/settings")}const Mx=2e3;function Xp(e,t){if(!t)return 0;let n,r;return"bytesReceived"in e?(n=e.bytesReceived,r=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,r=t.bytesSent),n===void 0||r===void 0||e.timestamp===void 0||t.timestamp===void 0?0:(n-r)*8*1e3/(e.timestamp-t.timestamp)}class wr extends Qc{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(t,re.Kind.Audio,n,r,o),this.stopOnMute=!1,this.monitorSender=()=>X(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}s&&this.prevStats&&(this._currentBitrate=Xp(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(t){return X(this,void 0,void 0,function*(){return this._constraints.deviceId===t?!0:(this._constraints.deviceId=t,this.isMuted||(yield this.restartTrack()),this.isMuted||vl(t)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const t=Object.create(null,{mute:{get:()=>super.mute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield t.mute.call(this),this}finally{n()}})}unmute(){const t=Object.create(null,{unmute:{get:()=>super.unmute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==vl(this._constraints.deviceId);return this.source===re.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield t.unmute.call(this),this}finally{n()}})}restartTrack(t){return X(this,void 0,void 0,function*(){let n;if(t){const r=$p({audio:t});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(t){const n=Object.create(null,{restart:{get:()=>super.restart}});return X(this,void 0,void 0,function*(){const r=yield n.restart.call(this,t);return this.checkForSilence(),r})}startMonitor(){Pr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Mx)))}setProcessor(t){var n;return X(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(t.name),this.logContext),yield t.init(i),this.processor=t,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(t){this.audioContext=t}getSenderStats(){var t;return X(this,void 0,void 0,function*(){if(!(!((t=this.sender)===null||t===void 0)&&t.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return X(this,void 0,void 0,function*(){const t=yield wz(this);return t&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(xe.AudioSilenceDetected)),t})}}function wP(e,t,n){switch(e.kind){case"audio":return new wr(e,t,!1,void 0,n);case"video":return new ci(e,t,!1,n);default:throw new po("unsupported track type: ".concat(e.kind))}}const cH=Object.values(af),uH=Object.values(ly),dH=Object.values(Px),fH=[af.h180,af.h360],hH=[ly.h180,ly.h360],pH=e=>[{scaleResolutionDownBy:2,fps:e.encoding.maxFramerate}].map(n=>{var r,i;return new It(Math.floor(e.width/n.scaleResolutionDownBy),Math.floor(e.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(e.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=e.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,e.encoding.priority)}),hy=["q","h","f"];function py(e,t,n,r){var i,o;let s=r==null?void 0:r.videoEncoding;e&&(s=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,l=r==null?void 0:r.scalabilityMode,c=r==null?void 0:r.videoCodec;if(!s&&!a&&!l||!t||!n)return[{}];s||(s=mH(e,t,n,c),et.debug("using video encoding",s));const u=new It(t,n,s.maxBitrate,s.maxFramerate,s.priority);if(l&&Ad(c)){et.debug("using svc with scalabilityMode ".concat(l));const h=new SP(l),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));for(let g=0;g<h.spatial;g+=1)p.push({rid:hy[2-g],maxBitrate:s.maxBitrate/Math.pow(3,g),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=l,et.debug("encodings",p),p}if(!a)return[s];let d=[];e?d=(i=HS(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:zS(e,u):d=(o=HS(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:zS(e,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(t,n);if(p>=960&&f)return Km(t,n,[h,f,u]);if(p>=480)return Km(t,n,[h,u])}return Km(t,n,[u])}function gH(e,t,n){var r,i,o,s;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&et.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const a=e.mediaStreamTrack.getSettings(),l=(r=a.width)!==null&&r!==void 0?r:(i=e.dimensions)===null||i===void 0?void 0:i.width,c=(o=a.height)!==null&&o!==void 0?o:(s=e.dimensions)===null||s===void 0?void 0:s.height;return py(e.source===re.Source.ScreenShare,l,c,n)}function mH(e,t,n,r){const i=vH(e,t,n);let{encoding:o}=i[0];const s=Math.max(t,n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o=l.encoding,l.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function vH(e,t,n){if(e)return dH;const r=t>n?t/n:n/t;return Math.abs(r-16/9)<Math.abs(r-4/3)?cH:uH}function zS(e,t){if(e)return pH(t);const{width:n,height:r}=t,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?fH:hH}function Km(e,t,n){const r=[];if(n.forEach((i,o)=>{if(o>=hy.length)return;const s=Math.min(e,t),l={rid:hy[o],scaleResolutionDownBy:Math.max(1,s/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(l.maxFramerate=i.encoding.maxFramerate);const c=qc()||o===0;i.encoding.priority&&c&&(l.priority=i.encoding.priority,l.networkPriority=i.encoding.priority),r.push(l)}),Nl()&&vP()==="ios"){let i;r.forEach(s=>{i?s.maxFramerate&&s.maxFramerate>i&&(i=s.maxFramerate):i=s.maxFramerate});let o=!0;r.forEach(s=>{var a;s.maxFramerate!=i&&(o&&(o=!1,et.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),et.info('Setting framerate of encoding "'.concat((a=s.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),s.maxFramerate=i)})}return r}function HS(e){if(e)return e.sort((t,n)=>{const{encoding:r}=t,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class SP{constructor(t){const n=t.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var t;return"L".concat(this.spatial,"T").concat(this.temporal).concat((t=this.suffix)!==null&&t!==void 0?t:"")}}const CH=5e3;class ci extends Qc{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(t,re.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>X(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const s=new Map(o.map(a=>[a.rid,a]));if(this.prevStats){let a=0;s.forEach((l,c)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(c);a+=Xp(l,d)}),this._currentBitrate=a}this.prevStats=s}),this.senderLock=new Ki}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(t){var n;if(this.signalClient=t,!Pr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Mx))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(t=>{t.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const t=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,o,s;return X(this,void 0,void 0,function*(){yield t.pauseUpstream.call(this);try{for(var a=!0,l=nc(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0)o=c.value,a=!1,yield(s=o.sender)===null||s===void 0?void 0:s.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}resumeUpstream(){const t=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,o,s;return X(this,void 0,void 0,function*(){yield t.resumeUpstream.call(this);try{for(var a=!0,l=nc(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;yield(s=u.sender)===null||s===void 0?void 0:s.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}mute(){const t=Object.create(null,{mute:{get:()=>super.mute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield t.mute.call(this),this}finally{n()}})}unmute(){const t=Object.create(null,{unmute:{get:()=>super.unmute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield t.unmute.call(this),this}finally{n()}})}setTrackMuted(t){super.setTrackMuted(t);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!t}getSenderStats(){var t;return X(this,void 0,void 0,function*(){if(!(!((t=this.sender)===null||t===void 0)&&t.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const s={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(s.jitter=a.jitter,s.packetsLost=a.packetsLost,s.roundTripTime=a.roundTripTime),n.push(s)}}),n})}setPublishingQuality(t){const n=[];for(let r=xn.LOW;r<=xn.HIGH;r+=1)n.push(new Zi({quality:r,enabled:r<=t}));this.log.debug("setting publishing quality. max quality ".concat(t),this.logContext),this.setPublishingLayers(n)}setDeviceId(t){return X(this,void 0,void 0,function*(){return this._constraints.deviceId===t&&this._mediaStreamTrack.getSettings().deviceId===vl(t)?!0:(this._constraints.deviceId=t,this.isMuted||(yield this.restartTrack()),this.isMuted||vl(t)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(t){var n,r,i,o;return X(this,void 0,void 0,function*(){let s;if(t){const u=$p({video:t});typeof u.video!="boolean"&&(s=u.video)}yield this.restart(s);try{for(var a=!0,l=nc(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}setProcessor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,s,a,l,c;return X(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,t,n),!((l=this.processor)===null||l===void 0)&&l.processedTrack)try{for(var u=!0,d=nc(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(c=a.sender)===null||c===void 0?void 0:c.replaceTrack(this.processor.processedTrack)}catch(h){o={error:h}}finally{try{!u&&!i&&(s=d.return)&&(yield s.call(d))}finally{if(o)throw o.error}}})}addSimulcastTrack(t,n){if(this.simulcastCodecs.has(t))throw new Error("".concat(t," already added"));const r={codec:t,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(t,r),r}setSimulcastTrackSender(t,n){const r=this.simulcastCodecs.get(t);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},CH))}setPublishingCodecs(t){var n,r,i,o,s,a,l;return X(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:t,currentCodec:this.codec})),!this.codec&&t.length>0)return yield this.setPublishingLayers(t[0].qualities),[];this.subscribedCodecs=t;const c=[];try{for(n=!0,r=nc(t);i=yield r.next(),o=i.done,!o;n=!0){l=i.value,n=!1;const u=l;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const f of u.qualities)if(f.enabled){c.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield ZS(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){s={error:u}}finally{try{!n&&!o&&(a=r.return)&&(yield a.call(r))}finally{if(s)throw s.error}}return c})}setPublishingLayers(t){return X(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),!(!this.sender||!this.encodings)&&(yield ZS(this.sender,this.encodings,t,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const t=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return X(this,void 0,void 0,function*(){yield t.handleAppVisibilityChanged.call(this),gP()&&this.isInBackground&&this.source===re.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function ZS(e,t,n,r,i,o){return X(this,void 0,void 0,function*(){const s=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:e,qualities:n,senderEncodings:t}));try{const a=e.getParameters(),{encodings:l}=a;if(!l)return;if(l.length!==t.length){i.warn("cannot set publishing layers, encodings mismatch");return}let c=!1;!1&&l[0].scalabilityMode||l.forEach((d,f)=>{var h;let p=(h=d.rid)!==null&&h!==void 0?h:"";p===""&&(p="q");const g=kP(p),C=n.find(v=>v.quality===g);C&&d.active!==C.enabled&&(c=!0,d.active=C.enabled,i.debug("setting layer ".concat(C.quality," to ").concat(d.active?"enabled":"disabled"),o),qc()&&(C.enabled?(d.scaleResolutionDownBy=t[f].scaleResolutionDownBy,d.maxBitrate=t[f].maxBitrate,d.maxFrameRate=t[f].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),c&&(a.encodings=l,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:a.encodings})),yield e.setParameters(a))}finally{s()}})}function kP(e){switch(e){case"f":return xn.HIGH;case"h":return xn.MEDIUM;case"q":return xn.LOW;default:return xn.HIGH}}function $S(e,t,n,r){if(!n)return[new ur({quality:xn.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,o=new SP(i),s=[];for(let a=0;a<o.spatial;a+=1)s.push(new ur({quality:xn.HIGH-a,width:Math.ceil(e/Math.pow(2,a)),height:Math.ceil(t/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return s}return n.map(i=>{var o,s,a;const l=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let c=kP((s=i.rid)!==null&&s!==void 0?s:"");return new ur({quality:c,width:Math.ceil(e/l),height:Math.ceil(t/l),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class EP extends re{constructor(t,n,r,i,o){super(t,r,o),this.sid=n,this.receiver=i}setMuted(t){this.isMuted!==t&&(this.isMuted=t,this._mediaStreamTrack.enabled=!t,this.emit(t?xe.Muted:xe.Unmuted,this))}setMediaStream(t){this.mediaStream=t;const n=r=>{r.track===this._mediaStreamTrack&&(t.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(xe.Ended,this))};t.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var t;return X(this,void 0,void 0,function*(){return!((t=this.receiver)===null||t===void 0)&&t.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Mx))}}class Cl extends EP{constructor(t,n,r,i,o,s){super(t,n,re.Kind.Audio,r,s),this.monitorReceiver=()=>X(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Xp(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(t){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(t,0,.1):r.volume=t;Nl()&&this._mediaStreamTrack._setVolume(t),this.elementVolume=t}getVolume(){if(this.elementVolume)return this.elementVolume;if(Nl())return 1;let t=0;return this.attachedElements.forEach(n=>{n.volume>t&&(t=n.volume)}),t}setSinkId(t){return X(this,void 0,void 0,function*(){this.sinkId=t,yield Promise.all(this.attachedElements.map(n=>{if(uy(n))return n.setSinkId(t)}))})}attach(t){const n=this.attachedElements.length===0;return t?super.attach(t):t=super.attach(),this.sinkId&&uy(t)&&t.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,t),t.volume=0,t.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),t}detach(t){let n;return t?(n=super.detach(t),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(t){this.audioContext=t,t&&this.attachedElements.length>0?this.connectWebAudio(t,this.attachedElements[0]):t||this.disconnectWebAudio()}setWebAudioPlugins(t){this.webAudioPluginNodes=t,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(t,n){this.disconnectWebAudio(),this.sourceNode=t.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=t.createGain(),r.connect(this.gainNode),this.gainNode.connect(t.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),t.state!=="running"&&t.resume().then(()=>{t.state!=="running"&&this.emit(xe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(xe.AudioPlaybackFailed,i)})}disconnectWebAudio(){var t,n;(t=this.gainNode)===null||t===void 0||t.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return X(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const t=yield this.receiver.getStats();let n;return t.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Jm=100;class Sd extends EP{constructor(t,n,r,i,o){super(t,n,re.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>X(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=Xp(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=Dx(()=>{this.updateDimensions()},Jm),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(t){super.setMuted(t),this.attachedElements.forEach(n=>{t?_c(this._mediaStreamTrack,n):mc(this._mediaStreamTrack,n)})}attach(t){if(t?super.attach(t):t=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===t)===void 0){const n=new yH(t);this.observeElementInfo(n)}return t}observeElementInfo(t){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===t)===void 0?(t.handleResize=()=>{this.debouncedHandleResize()},t.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(t),t.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(t){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===t);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==t),this.updateVisibility(),this.debouncedHandleResize()}detach(t){let n=[];if(t)return this.stopObservingElement(t),super.detach(t);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var t;return(t=this.prevStats)===null||t===void 0?void 0:t.decoderImplementation}getReceiverStats(){return X(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const t=yield this.receiver.getStats();let n,r="",i=new Map;return t.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,n={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(t){const n=this.elementInfos.filter(r=>r.element===t);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const t=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return X(this,void 0,void 0,function*(){yield t.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var t,n;const r=this.elementInfos.reduce((a,l)=>Math.max(a,l.visibilityChangedAt||0),0),i=!((n=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,o=this.elementInfos.some(a=>a.pictureInPicture),s=this.elementInfos.some(a=>a.visible)&&!i||o;if(this.lastVisible!==s){if(!s&&Date.now()-r<Jm){On.setTimeout(()=>{this.updateVisibility()},Jm);return}this.lastVisible=s,this.emit(xe.VisibilityChanged,s,this)}}updateDimensions(){var t,n;let r=0,i=0;const o=this.getPixelDensity();for(const s of this.elementInfos){const a=s.width()*o,l=s.height()*o;a+l>r+i&&(r=a,i=l)}((t=this.lastDimensions)===null||t===void 0?void 0:t.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(xe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var t;const n=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pixelDensity;return n==="screen"?RS():n||(RS()>2?2:1)}}class yH{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(t,n){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:s}=r;o===this.element&&(this.isIntersecting=s,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=t,this.isIntersecting=n??XS(t),this.isPiP=Pr()&&document.pictureInPictureElement===t,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=XS(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var t;(t=this.handleResize)===null||t===void 0||t.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,DS().observe(this.element),_S().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var t,n;(t=DS())===null||t===void 0||t.unobserve(this.element),(n=_S())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function XS(e){let t=e.offsetTop,n=e.offsetLeft;const r=e.offsetWidth,i=e.offsetHeight,{hidden:o}=e,{opacity:s,display:a}=getComputedStyle(e);for(;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(s!==""?parseFloat(s)>0:!0)&&a!=="none"}class Qo extends Ho.EventEmitter{constructor(t,n,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Nn.NONE,this.log=et,this.handleMuted=()=>{this.emit(xe.Muted)},this.handleUnmuted=()=>{this.emit(xe.Unmuted)},this.log=Vs((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:Uo.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=t,this.trackSid=n,this.trackName=r,this.source=re.Source.Unknown}setTrack(t){this.track&&(this.track.off(xe.Muted,this.handleMuted),this.track.off(xe.Unmuted,this.handleUnmuted)),this.track=t,t&&(t.on(xe.Muted,this.handleMuted),t.on(xe.Unmuted,this.handleUnmuted))}get logContext(){var t;return Object.assign(Object.assign({},(t=this.loggerContextCb)===null||t===void 0?void 0:t.call(this)),Ft(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Nn.NONE}get audioTrack(){if(this.track instanceof wr||this.track instanceof Cl)return this.track}get videoTrack(){if(this.track instanceof ci||this.track instanceof Sd)return this.track}updateInfo(t){this.trackSid=t.sid,this.trackName=t.name,this.source=re.sourceFromProto(t.source),this.mimeType=t.mimeType,this.kind===re.Kind.Video&&t.width>0&&(this.dimensions={width:t.width,height:t.height},this.simulcasted=t.simulcast),this.encryption=t.encryption,this.trackInfo=t,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:t}))}}(function(e){(function(t){t.Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed"})(e.SubscriptionStatus||(e.SubscriptionStatus={})),function(t){t.Allowed="allowed",t.NotAllowed="not_allowed"}(e.PermissionStatus||(e.PermissionStatus={}))})(Qo||(Qo={}));class lf extends Qo{get isUpstreamPaused(){var t;return(t=this.track)===null||t===void 0?void 0:t.isUpstreamPaused}constructor(t,n,r,i){super(t,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(xe.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(t){this.track&&this.track.off(xe.Ended,this.handleTrackEnded),super.setTrack(t),t&&t.on(xe.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var t;return X(this,void 0,void 0,function*(){return(t=this.track)===null||t===void 0?void 0:t.mute()})}unmute(){var t;return X(this,void 0,void 0,function*(){return(t=this.track)===null||t===void 0?void 0:t.unmute()})}pauseUpstream(){var t;return X(this,void 0,void 0,function*(){yield(t=this.track)===null||t===void 0?void 0:t.pauseUpstream()})}resumeUpstream(){var t;return X(this,void 0,void 0,function*(){yield(t=this.track)===null||t===void 0?void 0:t.resumeUpstream()})}}var fi;(function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"})(fi||(fi={}));function xH(e){switch(e){case ss.EXCELLENT:return fi.Excellent;case ss.GOOD:return fi.Good;case ss.POOR:return fi.Poor;case ss.LOST:return fi.Lost;default:return fi.Unknown}}class TP extends Ho.EventEmitter{get logContext(){var t,n;return Object.assign(Object.assign({},(n=(t=this.loggerOptions)===null||t===void 0?void 0:t.loggerContextCb)===null||n===void 0?void 0:n.call(t)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(t=>t.isEncrypted)}get isAgent(){var t,n;return(n=(t=this.permissions)===null||t===void 0?void 0:t.agent)!==null&&n!==void 0?n:!1}constructor(t,n,r,i,o){var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=fi.Unknown,this.log=et,this.log=Vs((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:Uo.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=t,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(t){for(const[,n]of this.tracks)if(n.source===t)return n}getTrackByName(t){for(const[,n]of this.tracks)if(n.trackName===t)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var t;const n=this.getTrack(re.Source.Camera);return!(!((t=n==null?void 0:n.isMuted)!==null&&t!==void 0)||t)}get isMicrophoneEnabled(){var t;const n=this.getTrack(re.Source.Microphone);return!(!((t=n==null?void 0:n.isMuted)!==null&&t!==void 0)||t)}get isScreenShareEnabled(){return!!this.getTrack(re.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(t){return this.participantInfo&&this.participantInfo.sid===t.sid&&this.participantInfo.version>t.version?!1:(this.identity=t.identity,this.sid=t.sid,this._setName(t.name),this._setMetadata(t.metadata),t.permission&&this.setPermissions(t.permission),this.participantInfo=t,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:t})),!0)}_setMetadata(t){const n=this.metadata!==t,r=this.metadata;this.metadata=t,n&&this.emit(de.ParticipantMetadataChanged,r)}_setName(t){const n=this.name!==t;this.name=t,n&&this.emit(de.ParticipantNameChanged,t)}setPermissions(t){var n,r,i,o,s;const a=this.permissions,l=t.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||t.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||t.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||t.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||t.recorder!==((s=this.permissions)===null||s===void 0?void 0:s.recorder)||t.canPublishSources.length!==this.permissions.canPublishSources.length||t.canPublishSources.some((c,u)=>{var d;return c!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=t,l&&this.emit(de.ParticipantPermissionsChanged,a),l}setIsSpeaking(t){t!==this.isSpeaking&&(this.isSpeaking=t,t&&(this.lastSpokeAt=new Date),this.emit(de.IsSpeakingChanged,t))}setConnectionQuality(t){const n=this._connectionQuality;this._connectionQuality=xH(t),n!==this._connectionQuality&&this.emit(de.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(t){this.audioContext=t,this.audioTracks.forEach(n=>(n.track instanceof Cl||n.track instanceof wr)&&n.track.setAudioContext(t))}addTrackPublication(t){t.on(xe.Muted,()=>{this.emit(de.TrackMuted,t)}),t.on(xe.Unmuted,()=>{this.emit(de.TrackUnmuted,t)});const n=t;switch(n.track&&(n.track.sid=t.trackSid),this.tracks.set(t.trackSid,t),t.kind){case re.Kind.Audio:this.audioTracks.set(t.trackSid,t);break;case re.Kind.Video:this.videoTracks.set(t.trackSid,t);break}}}function IH(e){var t,n,r;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Ro({participantIdentity:(t=e.participantIdentity)!==null&&t!==void 0?t:"",participantSid:(n=e.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=e.allowAll)!==null&&r!==void 0?r:!1,trackSids:e.allowedTrackSids||[]})}class Lx extends Qo{constructor(t,n,r,i){super(t,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=xn.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(xe.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(t){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=t,t&&(this.allowed=!0);const i=new pi({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new xo({participantSid:"",trackSids:[this.trackSid]})]});this.emit(xe.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?Qo.SubscriptionStatus.Unsubscribed:super.isSubscribed?Qo.SubscriptionStatus.Subscribed:Qo.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Qo.PermissionStatus.Allowed:Qo.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(t){!this.isManualOperationAllowed()||this.disabled===!t||(this.disabled=!t,this.emitTrackUpdate())}setVideoQuality(t){!this.isManualOperationAllowed()||this.currentVideoQuality===t||(this.currentVideoQuality=t,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(t){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===t.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===t.height||(this.track instanceof Sd&&(this.videoDimensions=t),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(t){this.isManualOperationAllowed()&&this.track instanceof Sd&&this.fps!==t&&(this.fps=t,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(t){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==t&&(i&&(i.off(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(xe.VisibilityChanged,this.handleVisibilityChange),i.off(xe.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(xe.Unsubscribed,i)),super.setTrack(t),t&&(t.sid=this.trackSid,t.on(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),t.on(xe.VisibilityChanged,this.handleVisibilityChange),t.on(xe.Ended,this.handleEnded),this.emit(xe.Subscribed,t)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(t){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=t,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(t){this.emit(xe.SubscriptionFailed,t)}updateInfo(t){super.updateInfo(t);const n=this.metadataMuted;this.metadataMuted=t.muted,this.track?this.track.setMuted(t.muted):n!==t.muted&&this.emit(t.muted?xe.Muted:xe.Unmuted)}emitSubscriptionUpdateIfChanged(t){const n=this.subscriptionStatus;t!==n&&this.emit(xe.SubscriptionStatusChanged,n,t)}emitPermissionUpdateIfChanged(t){this.permissionStatus!==t&&this.emit(xe.SubscriptionPermissionChanged,this.permissionStatus,t)}isManualOperationAllowed(){return this.kind===re.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof Sd&&this.track.isAdaptiveStream}emitTrackUpdate(){const t=new So({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(t.width=Math.ceil(this.videoDimensions.width),t.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?t.quality=this.currentVideoQuality:t.quality=xn.HIGH,this.emit(xe.UpdateSettings,t)}}class cf extends TP{static fromParticipantInfo(t,n){return new cf(t,n.sid,n.identity,n.name,n.metadata)}constructor(t,n,r,i,o,s){super(n,r||"",i,o,s),this.signalClient=t,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(t){super.addTrackPublication(t),t.on(xe.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Ft(t))),this.signalClient.sendUpdateTrackSettings(n)}),t.on(xe.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),t.on(xe.SubscriptionPermissionChanged,n=>{this.emit(de.TrackSubscriptionPermissionChanged,t,n)}),t.on(xe.SubscriptionStatusChanged,n=>{this.emit(de.TrackSubscriptionStatusChanged,t,n)}),t.on(xe.Subscribed,n=>{this.emit(de.TrackSubscribed,n,t)}),t.on(xe.Unsubscribed,n=>{this.emit(de.TrackUnsubscribed,n,t)}),t.on(xe.SubscriptionFailed,n=>{this.emit(de.TrackSubscriptionFailed,t.trackSid,n)})}getTrack(t){const n=super.getTrack(t);if(n)return n}getTrackByName(t){const n=super.getTrackByName(t);if(n)return n}setVolume(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re.Source.Microphone;this.volumeMap.set(n,t);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(t)}getVolume(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:re.Source.Microphone;const n=this.getTrack(t);return n&&n.track?n.track.getVolume():this.volumeMap.get(t)}addSubscribedMediaTrack(t,n,r,i,o,s){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&t.kind===u.kind.toString()&&(a=u)}),!a){if(s===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(de.TrackSubscriptionFailed,n);return}s===void 0&&(s=20),setTimeout(()=>{this.addSubscribedMediaTrack(t,n,r,i,o,s-1)},150);return}if(t.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Ft(a))),this.emit(de.TrackSubscriptionFailed,n);return}const l=t.kind==="video";let c;return l?c=new Sd(t,n,i,o):c=new Cl(t,n,i,this.audioContext,this.audioOutput),c.source=a.source,c.isMuted=a.isMuted,c.setMediaStream(r),c.start(),a.setTrack(c),this.volumeMap.has(a.source)&&c instanceof Cl&&c.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(t){return this.tracks.get(t)}updateInfo(t){if(!super.updateInfo(t))return!1;const n=new Map,r=new Map;return t.tracks.forEach(i=>{var o,s;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const l=re.kindFromProto(i.type);if(!l)return;a=new Lx(l,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(s=this.loggerOptions)===null||s===void 0?void 0:s.loggerName}),a.updateInfo(i),r.set(i.sid,a);const c=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));c&&a.source!==re.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Ft(c),newTrack:Ft(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Ft(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(de.TrackPublished,i)}),!0}unpublishTrack(t,n){const r=this.tracks.get(t);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(t),r.kind){case re.Kind.Audio:this.audioTracks.delete(t);break;case re.Kind.Video:this.videoTracks.delete(t);break}n&&this.emit(de.TrackUnpublished,r)}setAudioOutput(t){return X(this,void 0,void 0,function*(){this.audioOutput=t;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Cl&&n.push(r.track.setSinkId((i=t.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:t,args:r})),super.emit(t,...r)}}class gy extends TP{constructor(t,n,r,i){super(t,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Nn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new CP)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>IH(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Ft(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Ft(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Ft(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>X(this,void 0,void 0,function*(){var s,a,l,c,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(o.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!f.videoTrack)return;const C=yield f.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var h=!0,p=nc(C),g;g=yield p.next(),s=g.done,!s;h=!0){c=g.value,h=!1;const v=c;Iz(v)&&(this.log.debug("publish ".concat(v," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Ft(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,v,f.options))}}catch(v){a={error:v}}finally{try{!h&&!s&&(l=p.return)&&(yield l.call(p))}finally{if(a)throw a.error}}}else o.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.tracks.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>X(this,void 0,void 0,function*(){if(o.source===re.Source.ScreenShare||o.source===re.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Ft(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof wr||o instanceof ci)try{if(Pr())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===re.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),Ft(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Ft(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Ft(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Nn.NONE}getTrack(t){const n=super.getTrack(t);if(n)return n}getTrackByName(t){const n=super.getTrackByName(t);if(n)return n}setupEngine(t){this.engine=t,this.engine.on(Te.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(Te.Connected,this.handleReconnected).on(Te.SignalRestarted,this.handleReconnected).on(Te.SignalResumed,this.handleReconnected).on(Te.Restarting,this.handleReconnecting).on(Te.Resuming,this.handleReconnecting).on(Te.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Te.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Te.Disconnected,this.handleDisconnected)}setMetadata(t){var n;this.engine.client.sendUpdateLocalMetadata(t,(n=this.name)!==null&&n!==void 0?n:"")}setName(t){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",t)}setCameraEnabled(t,n,r){return this.setTrackEnabled(re.Source.Camera,t,n,r)}setMicrophoneEnabled(t,n,r){return this.setTrackEnabled(re.Source.Microphone,t,n,r)}setScreenShareEnabled(t,n,r){return this.setTrackEnabled(re.Source.ScreenShare,t,n,r)}setPermissions(t){const n=this.permissions,r=super.setPermissions(t);return r&&n&&this.emit(de.ParticipantPermissionsChanged,n),r}setE2EEEnabled(t){return X(this,void 0,void 0,function*(){this.encryptionType=t?Nn.GCM:Nn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(t,n,r,i){var o,s;return X(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:t,enabled:n}));let a=this.getTrack(t);if(n)if(a)yield a.unmute();else{let l;if(this.pendingPublishing.has(t)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:t}));return}this.pendingPublishing.add(t);try{switch(t){case re.Source.Camera:l=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case re.Source.Microphone:l=yield this.createTracks({audio:(s=r)!==null&&s!==void 0?s:!0});break;case re.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},r));break;default:throw new po(t)}const c=[];for(const d of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Ft(d))),c.push(this.publishTrack(d,i));[a]=yield Promise.all(c)}catch(c){throw l==null||l.forEach(u=>{u.stop()}),c instanceof Error&&!(c instanceof po)&&this.emit(de.MediaDevicesError,c),c}finally{this.pendingPublishing.delete(t)}}else if(a&&a.track)if(t===re.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const l=this.getTrack(re.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return X(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(re.Source.Camera)||this.pendingPublishing.has(re.Source.Microphone))){this.pendingPublishing.add(re.Source.Camera),this.pendingPublishing.add(re.Source.Microphone);try{const t=yield this.createTracks({audio:!0,video:!0});yield Promise.all(t.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(re.Source.Camera),this.pendingPublishing.delete(re.Source.Microphone)}}})}createTracks(t){var n,r;return X(this,void 0,void 0,function*(){const i=hP(t,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=$p(i);let s;try{s=yield navigator.mediaDevices.getUserMedia(o)}catch(a){throw a instanceof Error&&(o.audio&&(this.microphoneError=a),o.video&&(this.cameraError=a)),a}return o.audio&&(this.microphoneError=void 0,this.emit(de.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),s.getTracks().map(a=>{const l=a.kind==="audio";l?t.audio:t.video;let c;const u=l?o.audio:o.video;typeof u!="boolean"&&(c=u);const d=wP(a,c,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===re.Kind.Video?d.source=re.Source.Camera:d.kind===re.Kind.Audio&&(d.source=re.Source.Microphone),d.mediaStream=s,d})})}createScreenTracks(t){return X(this,void 0,void 0,function*(){if(t===void 0&&(t={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new _x("getDisplayMedia not supported");t.resolution===void 0&&!Oz()&&(t.resolution=Px.h1080fps30.resolution);const n=kz(t),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new po("no video track found");const o=new ci(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=re.Source.ScreenShare,t.contentHint&&(o.mediaStreamTrack.contentHint=t.contentHint);const s=[o];if(r.getAudioTracks().length>0){this.emit(de.AudioStreamAcquired);const a=new wr(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=re.Source.ScreenShareAudio,s.push(a)}return s})}publishTrack(t,n){var r,i,o,s;return X(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,t instanceof Qc&&this.pendingPublishPromises.has(t)&&(yield this.pendingPublishPromises.get(t));let a;if(t instanceof MediaStreamTrack)a=t.getConstraints();else{a=t.constraints;let h;switch(t.source){case re.Source.Microphone:h="audioinput";break;case re.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(t instanceof MediaStreamTrack)switch(t.kind){case"audio":t=new wr(t,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":t=new ci(t,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new po("unsupported MediaStreamTrack kind ".concat(t.kind))}else t.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});t instanceof wr&&t.setAudioContext(this.audioContext);let l;if(this.tracks.forEach(h=>{h.track&&h.track===t&&(l=h)}),l)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),Ft(l))),l;const c="channelCount"in t.mediaStreamTrack.getSettings()&&t.mediaStreamTrack.getSettings().channelCount===2||t.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:c;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),Ft(t))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=n.dtx)!==null&&o!==void 0||(n.dtx=!1),(s=n.red)!==null&&s!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);Pl()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(t.source=d.source);const f=this.publish(t,d,u);this.pendingPublishPromises.set(t,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(t)}})}publish(t,n,r){var i,o,s,a,l,c,u,d,f,h,p,g,C;return X(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(E=>t instanceof Qc&&E.source===t.source)&&t.source!==re.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(t.source),Object.assign(Object.assign({},this.logContext),Ft(t))),n.stopMicTrackOnMute&&t instanceof wr&&(t.stopOnMute=!0),t.source===re.Source.ScreenShare&&qc()&&(n.simulcast=!1),n.videoCodec==="av1"&&!_z()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!Dz()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=fy);const m=n.videoCodec;t.on(xe.Muted,this.onTrackMuted),t.on(xe.Unmuted,this.onTrackUnmuted),t.on(xe.Ended,this.handleTrackEnded),t.on(xe.UpstreamPaused,this.onTrackUpstreamPaused),t.on(xe.UpstreamResumed,this.onTrackUpstreamResumed);const y=new Wi({cid:t.mediaStreamTrack.id,name:n.name,type:re.kindToProto(t.kind),muted:t.isMuted,source:re.sourceToProto(t.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n==null?void 0:n.stream});let x;if(t.kind===re.Kind.Video){let E={width:0,height:0};try{E=yield t.waitForDimensions()}catch{const T=(a=(s=this.roomOptions.videoCaptureDefaults)===null||s===void 0?void 0:s.resolution)!==null&&a!==void 0?a:af.h720.resolution;E={width:T.width,height:T.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Ft(t)),{dims:E}))}y.width=E.width,y.height=E.height,t instanceof ci&&(Ad(m)&&(t.source===re.Source.ScreenShare&&m==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(l=n.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),y.simulcastCodecs=[new Gi({codec:m,cid:t.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:fy}),n.backupCodec&&m!==n.backupCodec.codec&&y.encryption===Nn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),y.simulcastCodecs.push(new Gi({codec:n.backupCodec.codec,cid:""})))),x=py(t.source===re.Source.ScreenShare,y.width,y.height,n),y.layers=$S(y.width,y.height,x,Ad(n.videoCodec))}else t.kind===re.Kind.Audio&&(x=[{maxBitrate:(u=(c=n.audioPreset)===null||c===void 0?void 0:c.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new gn("cannot publish track when not connected");const b=yield this.engine.addTrack(y);let k;if(b.codecs.forEach(E=>{k===void 0&&(k=E.mimeType)}),k&&t.kind===re.Kind.Video){const E=pP(k);E!==m&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Ft(t)),{codec:E})),n.videoCodec=E,x=py(t.source===re.Source.ScreenShare,y.width,y.height,n))}const A=new lf(t.kind,b,t,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(A.options=n,t.sid=b.sid,!this.engine.pcManager)throw new gn("pcManager is not ready");if(this.log.debug("publishing ".concat(t.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:x,trackInfo:b})),t.sender=yield this.engine.createSender(t,n,x),x)if(qc()&&t.kind===re.Kind.Audio){let E;for(const D of this.engine.pcManager.publisher.getTransceivers())if(D.sender===t.sender){E=D;break}E&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:E,codec:"opus",maxbr:!((g=x[0])===null||g===void 0)&&g.maxBitrate?x[0].maxBitrate/1e3:0})}else t.codec&&Ad(t.codec)&&(!((C=x[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:y.cid,codec:t.codec,maxbr:x[0].maxBitrate/1e3});return yield this.engine.negotiate(),t instanceof ci?t.startMonitor(this.engine.client):t instanceof wr&&t.startMonitor(),this.addTrackPublication(A),this.emit(de.LocalTrackPublished,A),A})}get isLocal(){return!0}publishAdditionalCodecForTrack(t,n,r){var i;return X(this,void 0,void 0,function*(){if(this.encryptionType!==Nn.NONE)return;let o;if(this.tracks.forEach(d=>{d.track&&d.track===t&&(o=d)}),!o)throw new po("track is not published");if(!(t instanceof ci))throw new po("track is not a video track");const s=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=gH(t,n,s);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Ft(t)));return}const l=t.addSimulcastTrack(n,a),c=new Wi({cid:l.mediaStreamTrack.id,type:re.kindToProto(t.kind),muted:t.isMuted,source:re.sourceToProto(t.source),sid:t.sid,simulcastCodecs:[{codec:s.videoCodec,cid:l.mediaStreamTrack.id}]});if(c.layers=$S(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new gn("cannot publish track when not connected");const u=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(t,l,s,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(t.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(t,n){var r,i;return X(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(t),s=o?Ft(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),s)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),s));return}t=o.track,t.off(xe.Muted,this.onTrackMuted),t.off(xe.Unmuted,this.onTrackUnmuted),t.off(xe.Ended,this.handleTrackEnded),t.off(xe.UpstreamPaused,this.onTrackUpstreamPaused),t.off(xe.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&t.stop();let a=!1;const l=t.sender;if(t.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<vn.FAILED&&l)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===l&&(c.direction="inactive",a=!0);if(this.engine.removeTrack(l)&&(a=!0),t instanceof ci){for(const[,c]of t.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(a=!0),c.sender=void 0);t.simulcastCodecs.clear()}}catch(c){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),s),{error:c}))}switch(this.tracks.delete(o.trackSid),o.kind){case re.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case re.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(de.LocalTrackUnpublished,o),o.setTrack(void 0),a&&(yield this.engine.negotiate()),o})}unpublishTracks(t){return X(this,void 0,void 0,function*(){return(yield Promise.all(t.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof lf)})}republishAllTracks(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return X(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(t&&(i.options=Object.assign(Object.assign({},i.options),t)),r.push(i))}),yield Promise.all(r.map(i=>X(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),n&&!o.isMuted&&o.source!==re.Source.ScreenShare&&o.source!==re.Source.ScreenShareAudio&&(o instanceof wr||o instanceof ci)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return X(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],s=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(l=>{l instanceof cf?o.push(l.sid):o.push(l)});const a=new vo({kind:n,value:{case:"user",value:new yo({participantSid:this.sid,payload:t,destinationSids:o,topic:s})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=t,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(t){return t.sid!==this.sid||!super.updateInfo(t)?!1:(t.tracks.forEach(n=>{var r,i;const o=this.tracks.get(n.sid);if(o){const s=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);s!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Ft(o)),{mutedOnServer:s})),this.engine.client.sendMuteTrack(n.sid,s))}}),!0)}getPublicationForTrack(t){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(t instanceof MediaStreamTrack?(i instanceof wr||i instanceof ci)&&i.mediaStreamTrack===t&&(n=r):t===i&&(n=r))}),n}}var ft;(function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting"})(ft||(ft={}));const bH=2*1e3;class ip extends Ho.EventEmitter{constructor(t){var n,r,i;super(),n=this,this.state=ft.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=et,this.bufferedEvents=[],this.connect=(o,s,a)=>X(this,void 0,void 0,function*(){var l;const c=yield this.disconnectLock.lock();if(this.state===ft.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(ft.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),dy(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new jS(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(f=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:f}))}));const u=(f,h,p)=>X(this,void 0,void 0,function*(){var g;this.abortController&&this.abortController.abort();const C=new AbortController;this.abortController=C,c==null||c();try{yield this.attemptConnection(p??o,s,a,C),this.abortController=void 0,f()}catch(v){if(this.regionUrlProvider&&v instanceof Tt&&v.reason!==3&&v.reason!==0){let m=null;try{m=yield this.regionUrlProvider.getNextBestRegionUrl((g=this.abortController)===null||g===void 0?void 0:g.signal)}catch(y){if(y instanceof Tt&&(y.status===401||y.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(y);return}}m?(this.log.info("Initial connection failed with ConnectionError: ".concat(v.message,". Retrying with another region: ").concat(m),this.logContext),yield u(f,h,m)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(v))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(v)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new CP((f,h)=>{u(f,h,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,a,l,c,u)=>X(this,void 0,void 0,function*(){var d,f,h;const p=yield a.join(o,s,{autoSubscribe:l.autoSubscribe,publishOnly:l.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},u.signal);let g=p.serverInfo;if(g||(g={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(g).map(C=>{let[v,m]=C;return"".concat(v,": ").concat(m)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(f=p.room)===null||f===void 0?void 0:f.sid,identity:(h=p.participant)===null||h===void 0?void 0:h.identity}),!p.serverVersion)throw new pz("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),c.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,s,a,l)=>X(this,void 0,void 0,function*(){var c,u;this.state===ft.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Fx),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(ue.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const f=new Tt("could not establish signal connection");throw d instanceof Error&&(f.message="".concat(f.message,": ").concat(d.message)),d instanceof Tt&&(f.reason=d.reason,f.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),f}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Tt("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}Pr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Pr()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return X(n,void 0,void 0,function*(){var s,a,l,c;const u=yield this.disconnectLock.lock();try{if(this.state===ft.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===ft.Connecting||this.state===ft.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(s=this.abortController)===null||s===void 0||s.abort(),(l=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||l===void 0||l.call(a,new Tt("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,Ps.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>X(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>X(this,void 0,void 0,function*(){const o=[],s=Gs();if(s&&s.os==="iOS"){const a="livekit-dummy-audio-el";let l=document.getElementById(a);if(!l){l=document.createElement("audio"),l.id=a,l.autoplay=!0,l.hidden=!0;const c=Zm();c.enabled=!0;const u=new MediaStream([c]);l.srcObject=u,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(ue.Disconnected,()=>{l==null||l.remove(),l=null})}o.push(l)}this.participants.forEach(a=>{a.audioTracks.forEach(l=>{l.track&&l.track.attachedElements.forEach(c=>{o.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>X(this,void 0,void 0,function*(){const o=[];for(const s of this.participants.values())s.videoTracks.forEach(a=>{var l;(l=a.track)===null||l===void 0||l.attachedElements.forEach(c=>{o.includes(c)||o.push(c)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(ft.Reconnecting)&&this.emit(ue.Reconnecting)},this.handleSignalRestarted=o=>X(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const a=this.identityToSid.get(s.identity);a&&a!==s.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let l=this.participants.get(s.sid);const c=!l;s.state===_l.DISCONNECTED?this.handleParticipantDisconnected(s.sid,l):(l=this.getOrCreateParticipant(s.sid,s),c||l.updateInfo(s))})},this.handleActiveSpeakersUpdate=o=>{const s=[],a={};o.forEach(l=>{if(a[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const c=this.participants.get(l.sid);c&&(c.audioLevel=l.level,c.setIsSpeaking(!0),s.push(c))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(l=>{a[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ue.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(l=>{s.set(l.sid,l)}),o.forEach(l=>{let c=this.participants.get(l.sid);l.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=l.level,c.setIsSpeaking(l.active),l.active?s.set(l.sid,c):s.delete(l.sid))});const a=Array.from(s.values());a.sort((l,c)=>c.audioLevel-l.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(ue.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const a=this.participants.get(s.participantSid);if(!a)return;const l=a.getTrackPublication(s.trackSid);!l||!l.track||(l.track.streamState=re.streamStateFromProto(s.state),a.emit(de.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(ue.TrackStreamStateChanged,l,l.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.participants.get(o.participantSid);if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.participants.values()).find(l=>l.tracks.has(o.trackSid));if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const a=this.participants.get(o.participantSid);this.emit(ue.DataReceived,o.payload,a,s,o.topic),a==null||a.emit(de.DataReceived,o.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ue.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ue.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ue.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ue.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>X(this,void 0,void 0,function*(){this.emit(ue.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(ue.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(ue.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const a=this.participants.get(s.participantSid);a&&a.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(ue.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(ue.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(ue.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(ue.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>X(this,void 0,void 0,function*(){var s;this.emit(ue.LocalTrackPublished,o,this.localParticipant),o.track instanceof wr&&(yield o.track.checkForSilence())&&this.emit(ue.LocalAudioSilenceDetected,o);const a=yield(s=o.track)===null||s===void 0?void 0:s.getDeviceId(),l=Sz(o.source);l&&a&&a!==this.localParticipant.activeDeviceMap.get(l)&&(this.localParticipant.activeDeviceMap.set(l,a),this.emit(ue.ActiveDeviceChanged,l,a))}),this.onLocalTrackUnpublished=o=>{this.emit(ue.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(ue.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(ue.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(ue.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},iH),t),this.log=Vs((r=this.options.loggerName)!==null&&r!==void 0?r:Uo.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},bP),t==null?void 0:t.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},AP),t==null?void 0:t.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},rH),t==null?void 0:t.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Ki,this.localParticipant=new gy("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",vl(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",vl(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",vl(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(t){return X(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(t)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(t,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var t;this.options.e2ee&&(this.e2eeManager=new jz(this.options.e2ee),this.e2eeManager.on(Aa.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof gy&&(this.isE2EEEnabled=n),this.emit(ue.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Aa.EncryptionError,n=>this.emit(ue.EncryptionError,n)),(t=this.e2eeManager)===null||t===void 0||t.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.sid)!==null&&n!==void 0?n:""}get name(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.name)!==null&&n!==void 0?n:""}get metadata(){var t;return(t=this.roomInfo)===null||t===void 0?void 0:t.metadata}get numParticipants(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new aH(this.options),this.engine.on(Te.ParticipantUpdate,this.handleParticipantUpdates).on(Te.RoomUpdate,this.handleRoomUpdate).on(Te.SpeakersChanged,this.handleSpeakersChanged).on(Te.StreamStateChanged,this.handleStreamStateUpdate).on(Te.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Te.SubscriptionError,this.handleSubscriptionError).on(Te.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Te.MediaTrackAdded,(t,n,r)=>{this.onTrackAdded(t,n,r)}).on(Te.Disconnected,t=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,t)}).on(Te.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Te.DataPacketReceived,this.handleDataPacket).on(Te.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(ft.Reconnecting)&&this.emit(ue.Reconnecting)}).on(Te.Resumed,()=>{this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(Te.SignalResumed,()=>{this.bufferedEvents=[],this.state===ft.Reconnecting&&this.sendSyncState()}).on(Te.Restarting,this.handleRestarting).on(Te.SignalRestarted,this.handleSignalRestarted).on(Te.DCBufferStatusChanged,(t,n)=>{this.emit(ue.DCBufferStatusChanged,t,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return sr.getInstance().getDevices(t,n)}prepareConnection(t,n){return X(this,void 0,void 0,function*(){if(this.state===ft.Disconnected){this.log.debug("prepareConnection to ".concat(t),this.logContext);try{if(dy(new URL(t))&&n){this.regionUrlProvider=new jS(t,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===ft.Disconnected&&(this.regionUrl=r,yield fetch(NS(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(NS(t),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(t){if(this.localParticipant.identity===t)return this.localParticipant;const n=this.identityToSid.get(t);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(t,n){return X(this,void 0,void 0,function*(){let r=()=>{},i;switch(t){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Pn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Pn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Pn({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Pn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>X(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Pn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>X(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Pn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Pn({scenario:{case:"switchCandidateProtocol",value:t==="force-tls"?2:1}}),r=()=>X(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new gi({reason:Ps.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Pn({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var t,n;return(n=(t=this.options.audioOutput)===null||t===void 0?void 0:t.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(t){return this.localParticipant.activeDeviceMap.get(t)}switchActiveDevice(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,s;return X(this,void 0,void 0,function*(){let a=!1,l=!0;const c=r?{exact:n}:n;if(t==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===re.Source.Microphone);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(t==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===re.Source.Camera);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(t==="audiooutput"){if(!uy()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(s=this.options).audioOutput)!==null&&i!==void 0||(s.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==c;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&l&&(this.localParticipant.activeDeviceMap.set(t,n),this.emit(ue.ActiveDeviceChanged,t,n)),l})}setupLocalParticipantEvents(){this.localParticipant.on(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(de.TrackMuted,this.onLocalTrackMuted).on(de.TrackUnmuted,this.onLocalTrackUnmuted).on(de.LocalTrackPublished,this.onLocalTrackPublished).on(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(de.MediaDevicesError,this.onMediaDevicesError).on(de.AudioStreamAcquired,this.startAudio).on(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var t;(t=this.engine)===null||t===void 0||t.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(t,n,r){if(this.state===ft.Connecting||this.state===ft.Reconnecting){const u=()=>{this.onTrackAdded(t,n,r),d()},d=()=>{this.off(ue.Reconnected,u),this.off(ue.Connected,u),this.off(ue.Disconnected,d)};this.once(ue.Reconnected,u),this.once(ue.Connected,u),this.once(ue.Disconnected,d);return}if(this.state===ft.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=Rz(n.id),o=i[0];let s=i[1],a=t.id;if(s&&s.startsWith("TR")&&(a=s),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=this.participants.get(o);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let c;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?c=this.options.adaptiveStream:c={}),l.addSubscribedMediaTrack(t,a,n,r,c)}handleDisconnect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==ft.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,s;i.track&&this.localParticipant.unpublishTrack(i.track,t),t&&((o=i.track)===null||o===void 0||o.detach(),(s=i.track)===null||s===void 0||s.stop())}),this.localParticipant.off(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(de.TrackMuted,this.onLocalTrackMuted).off(de.TrackUnmuted,this.onLocalTrackUnmuted).off(de.LocalTrackPublished,this.onLocalTrackPublished).off(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(de.MediaDevicesError,this.onMediaDevicesError).off(de.AudioStreamAcquired,this.startAudio).off(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Pr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ft.Disconnected),this.emit(ue.Disconnected,n)}}}handleParticipantDisconnected(t,n){this.participants.delete(t),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ue.ParticipantDisconnected,n))}acquireAudioContext(){var t,n;return X(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(t=Nx())!==null&&t!==void 0?t:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ue.AudioPlaybackStatusChanged,r))})}createParticipant(t,n){var r;let i;return n?i=cf.fromParticipantInfo(this.engine.client,n):i=new cf(this.engine.client,t,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(t,n){if(this.participants.has(t))return this.participants.get(t);const r=this.createParticipant(t,n);return this.participants.set(t,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ue.ParticipantConnected,r),r.on(de.TrackPublished,i=>{this.emitWhenConnected(ue.TrackPublished,i,r)}).on(de.TrackSubscribed,(i,o)=>{i.kind===re.Kind.Audio?(i.on(xe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(xe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===re.Kind.Video&&(i.on(xe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(xe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ue.TrackSubscribed,i,o,r)}).on(de.TrackUnpublished,i=>{this.emit(ue.TrackUnpublished,i,r)}).on(de.TrackUnsubscribed,(i,o)=>{this.emit(ue.TrackUnsubscribed,i,o,r)}).on(de.TrackSubscriptionFailed,i=>{this.emit(ue.TrackSubscriptionFailed,i,r)}).on(de.TrackMuted,i=>{this.emitWhenConnected(ue.TrackMuted,i,r)}).on(de.TrackUnmuted,i=>{this.emitWhenConnected(ue.TrackUnmuted,i,r)}).on(de.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ue.ParticipantMetadataChanged,i,r)}).on(de.ParticipantNameChanged,i=>{this.emitWhenConnected(ue.ParticipantNameChanged,i,r)}).on(de.ConnectionQualityChanged,i=>{this.emitWhenConnected(ue.ConnectionQualityChanged,i,r)}).on(de.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ue.ParticipantPermissionsChanged,i,r)}).on(de.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ue.TrackSubscriptionStatusChanged,i,o,r)}).on(de.TrackSubscriptionFailed,(i,o)=>{this.emit(ue.TrackSubscriptionFailed,i,r,o)}).on(de.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ue.TrackSubscriptionPermissionChanged,i,o,r)}),n&&r.updateInfo(n),r}sendSyncState(){const t=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(t,n)}updateSubscriptions(){for(const t of this.participants.values())for(const n of t.videoTracks.values())n.isSubscribed&&n instanceof Lx&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let t=0;this.connectionReconcileInterval=On.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(t++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:t,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),t>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ps.STATE_MISMATCH))):t=0},bH)}clearConnectionReconcile(){this.connectionReconcileInterval&&On.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(t){return t===this.state?!1:(this.state=t,this.emit(ue.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(t=>{let[n,r]=t;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===ft.Connected?this.emit(t,...r):(this.state===ft.Reconnecting&&this.bufferedEvents.push([t,r]),!1)}simulateParticipants(t){var n,r;return X(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},t.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},t.participants);if(this.handleDisconnect(),this.roomInfo=new gu({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:He.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new qr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ue.SignalConnected),this.emit(ue.Connected),this.setAndEmitConnectionState(ft.Connected),i.video){const s=new lf(re.Kind.Video,new Tr({source:rn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO,name:"video-dummy"}),new ci(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:PS(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(de.LocalTrackPublished,s)}if(i.audio){const s=new lf(re.Kind.Audio,new Tr({source:rn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO}),new wr(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Zm(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(de.LocalTrackPublished,s)}for(let s=0;s<o.count-1;s+=1){let a=new qr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(s),state:_l.ACTIVE,tracks:[],joinedAt:He.parse(Date.now())});const l=this.getOrCreateParticipant(a.identity,a);if(o.video){const c=PS(160*((r=o.aspectRatios[s%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new Tr({source:rn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}if(o.audio){const c=Zm(),u=new Tr({source:rn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}l.updateInfo(a)}})}emit(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(t!==ue.ActiveSpeakersChanged){const o=RP(r).filter(s=>s!==void 0);this.log.debug("room event ".concat(t),Object.assign(Object.assign({},this.logContext),{event:t,args:o}))}return super.emit(t,...r)}}function RP(e){return e.map(t=>{if(t)return Array.isArray(t)?RP(t):typeof t=="object"?"logContext"in t&&t.logContext:t})}var Li;(function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"})(Li||(Li={}));class vu extends Ho.EventEmitter{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Li.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=t,this.token=n,this.name=this.constructor.name,this.room=new ip(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(t){return X(this,void 0,void 0,function*(){if(this.status!==Li.IDLE)throw Error("check is running already");this.setStatus(Li.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Li.SKIPPED&&this.setStatus(this.isSuccess()?Li.SUCCESS:Li.FAILED),t&&t(),this.getInfo()})}isSuccess(){return!this.logs.some(t=>t.level==="error")}connect(){return X(this,void 0,void 0,function*(){return this.room.state===ft.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return X(this,void 0,void 0,function*(){this.room&&this.room.state!==ft.Disconnected&&(yield this.room.disconnect(),yield new Promise(t=>setTimeout(t,500)))})}skip(){this.setStatus(Li.SKIPPED)}appendMessage(t){this.logs.push({level:"info",message:t}),this.emit("update",this.getInfo())}appendWarning(t){this.logs.push({level:"warning",message:t}),this.emit("update",this.getInfo())}appendError(t){this.logs.push({level:"error",message:t}),this.emit("update",this.getInfo())}setStatus(t){this.status=t,this.emit("update",this.getInfo())}get engine(){var t;return(t=this.room)===null||t===void 0?void 0:t.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function _P(e){var t,n;return X(this,void 0,void 0,function*(){e??(e={}),(t=e.audio)!==null&&t!==void 0||(e.audio=!0),(n=e.video)!==null&&n!==void 0||(e.video=!0);const r=hP(e,bP,AP),i=$p(r),o=navigator.mediaDevices.getUserMedia(i);e.audio&&(sr.userMediaPromiseMap.set("audioinput",o),o.catch(()=>sr.userMediaPromiseMap.delete("audioinput"))),e.video&&(sr.userMediaPromiseMap.set("videoinput",o),o.catch(()=>sr.userMediaPromiseMap.delete("videoinput")));const s=yield o;return s.getTracks().map(a=>{const l=a.kind==="audio";l?e.audio:e.video;let c;const u=l?i.audio:i.video;typeof u!="boolean"&&(c=u),c?c.deviceId=a.getSettings().deviceId:c={deviceId:a.getSettings().deviceId};const d=wP(a,c);return d.kind===re.Kind.Video?d.source=re.Source.Camera:d.kind===re.Kind.Audio&&(d.source=re.Source.Microphone),d.mediaStream=s,d})})}function AH(e){return X(this,void 0,void 0,function*(){return(yield _P({audio:!1,video:e}))[0]})}function wH(e){return X(this,void 0,void 0,function*(){return(yield _P({audio:e,video:!1}))[0]})}class SH extends vu{get description(){return"Can publish audio"}perform(){var t;return X(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield wH();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(t=r.sender)===null||t===void 0?void 0:t.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="audio"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class kH extends vu{get description(){return"Can publish video"}perform(){var t;return X(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield AH();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(t=r.sender)===null||t===void 0?void 0:t.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="video"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class EH extends vu{get description(){return"Resuming connection after interruption"}perform(){var t;return X(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,o;const s=new Promise(l=>{setTimeout(l,5e3),o=l});n.on(ue.Reconnecting,()=>{r=!0}).on(ue.Reconnected,()=>{i=!0,o(!0)}),(t=n.engine.client.ws)===null||t===void 0||t.close();const a=n.engine.client.onClose;if(a&&a(""),yield s,r){if(!i||n.state!==ft.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class TH extends vu{get description(){return"Can connect via TURN"}perform(){var t,n;return X(this,void 0,void 0,function*(){const r=new Ox,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,s=!1,a=!1;for(let l of i.iceServers)for(let c of l.urls)c.startsWith("turn:")?(s=!0,a=!0):c.startsWith("turns:")&&(s=!0,a=!0,o=!0),c.startsWith("stun:")&&(a=!0);a?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(t=this.connectOptions)===null||t===void 0?void 0:t.rtcConfig)===null||n===void 0)&&n.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(l=>setTimeout(l,0)))})}}class RH extends vu{get description(){return"Establishing WebRTC connection"}perform(){return X(this,void 0,void 0,function*(){let t=!1,n=!1;this.room.on(ue.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const s=new RTCIceCandidate(i);let a="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&(_H(s.address)?a+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(t=!0,a+=" (passive)"):s.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),et.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}t||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function _H(e){const t=e.split(".");if(t.length===4){if(t[0]==="10")return!0;if(t[0]==="192"&&t[1]==="168")return!0;if(t[0]==="172"){const n=parseInt(t[1],10);if(n>=16&&n<=31)return!0}}return!1}class DH extends vu{get description(){return"Connecting to signal connection via WebSocket"}perform(){var t,n,r;return X(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new Ox;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((t=o.serverInfo)===null||t===void 0?void 0:t.edition)===Jc.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class YY extends Ho.EventEmitter{constructor(t,n){super(),this.checkResults=new Map,this.url=t,this.token=n}getNextCheckId(){const t=this.checkResults.size;return this.checkResults.set(t,{logs:[],status:Li.IDLE,name:"",description:""}),t}updateCheck(t,n){this.checkResults.set(t,n),this.emit("checkUpdate",t,n)}isSuccess(){return Array.from(this.checkResults.values()).every(t=>t.status!==Li.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(t){return X(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new t(this.url,this.token),i=s=>{this.updateCheck(n,s)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(DH)})}checkWebRTC(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(RH)})}checkTURN(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(TH)})}checkReconnect(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(EH)})}checkPublishAudio(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(SH)})}checkPublishVideo(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(kH)})}}function PH(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=e instanceof Qc?e.mediaStreamTrack:e,i=r.getSettings();let o={facingMode:(n=t.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const s=i.facingMode;et.debug("rawFacingMode",{rawFacingMode:s}),s&&typeof s=="string"&&OH(s)&&(o={facingMode:s,confidence:"high"})}if(["low","medium"].includes(o.confidence)){et.debug("Try to get facing mode from device label: (".concat(r.label,")"));const s=BH(r.label);s!==void 0&&(o=s)}return o}const KS=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),NH=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function BH(e){var t;const n=e.trim().toLowerCase();if(n!=="")return KS.has(n)?KS.get(n):(t=Array.from(NH.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||t===void 0?void 0:t[1]}function OH(e){return e===void 0||["user","environment","left","right"].includes(e)}const my=Math.min,Pc=Math.max,op=Math.round,Fo=e=>({x:e,y:e}),FH={left:"right",right:"left",bottom:"top",top:"bottom"},MH={start:"end",end:"start"};function JS(e,t,n){return Pc(e,my(t,n))}function Kp(e,t){return typeof e=="function"?e(t):e}function Bl(e){return e.split("-")[0]}function Jp(e){return e.split("-")[1]}function DP(e){return e==="x"?"y":"x"}function PP(e){return e==="y"?"height":"width"}function yl(e){return["top","bottom"].includes(Bl(e))?"y":"x"}function NP(e){return DP(yl(e))}function LH(e,t,n){n===void 0&&(n=!1);const r=Jp(e),i=NP(e),o=PP(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=sp(s)),[s,sp(s)]}function UH(e){const t=sp(e);return[vy(e),t,vy(t)]}function vy(e){return e.replace(/start|end/g,t=>MH[t])}function VH(e,t,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?o:s;default:return[]}}function GH(e,t,n,r){const i=Jp(e);let o=VH(Bl(e),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),t&&(o=o.concat(o.map(vy)))),o}function sp(e){return e.replace(/left|right|bottom|top/g,t=>FH[t])}function WH(e){return{top:0,right:0,bottom:0,left:0,...e}}function jH(e){return typeof e!="number"?WH(e):{top:e,right:e,bottom:e,left:e}}function ap(e){const{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function YS(e,t,n){let{reference:r,floating:i}=e;const o=yl(t),s=NP(t),a=PP(s),l=Bl(t),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Jp(t)){case"start":h[s]-=f*(n&&c?-1:1);break;case"end":h[s]+=f*(n&&c?-1:1);break}return h}const zH=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(t));let c=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=YS(c,r,l),f=r,h={},p=0;for(let g=0;g<a.length;g++){const{name:C,fn:v}=a[g],{x:m,y,data:x,reset:b}=await v({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:c,platform:s,elements:{reference:e,floating:t}});u=m??u,d=y??d,h={...h,[C]:{...h[C],...x}},b&&p<=50&&(p++,typeof b=="object"&&(b.placement&&(f=b.placement),b.rects&&(c=b.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):b.rects),{x:u,y:d}=YS(c,f,l)),g=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function BP(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Kp(t,e),p=jH(h),C=a[f?d==="floating"?"reference":"floating":d],v=ap(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),m=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,y=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),x=await(o.isElement==null?void 0:o.isElement(y))?await(o.getScale==null?void 0:o.getScale(y))||{x:1,y:1}:{x:1,y:1},b=ap(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:m,offsetParent:y,strategy:l}):m);return{top:(v.top-b.top+p.top)/x.y,bottom:(b.bottom-v.bottom+p.bottom)/x.y,left:(v.left-b.left+p.left)/x.x,right:(b.right-v.right+p.right)/x.x}}const HH=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...C}=Kp(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const v=Bl(i),m=yl(a),y=Bl(a)===a,x=await(l.isRTL==null?void 0:l.isRTL(c.floating)),b=f||(y||!g?[sp(a)]:UH(a)),k=p!=="none";!f&&k&&b.push(...GH(a,g,p,x));const A=[a,...b],E=await BP(t,C),D=[];let T=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&D.push(E[v]),d){const Z=LH(i,s,x);D.push(E[Z[0]],E[Z[1]])}if(T=[...T,{placement:i,overflows:D}],!D.every(Z=>Z<=0)){var R,P;const Z=(((R=o.flip)==null?void 0:R.index)||0)+1,Q=A[Z];if(Q){var L;const $=d==="alignment"?m!==yl(Q):!1,q=((L=T[0])==null?void 0:L.overflows[0])>0;if(!$||q)return{data:{index:Z,overflows:T},reset:{placement:Q}}}let ie=(P=T.filter($=>$.overflows[0]<=0).sort(($,q)=>$.overflows[1]-q.overflows[1])[0])==null?void 0:P.placement;if(!ie)switch(h){case"bestFit":{var z;const $=(z=T.filter(q=>{if(k){const te=yl(q.placement);return te===m||te==="y"}return!0}).map(q=>[q.placement,q.overflows.filter(te=>te>0).reduce((te,O)=>te+O,0)]).sort((q,te)=>q[1]-te[1])[0])==null?void 0:z[0];$&&(ie=$);break}case"initialPlacement":ie=a;break}if(i!==ie)return{reset:{placement:ie}}}return{}}}};async function ZH(e,t){const{placement:n,platform:r,elements:i}=e,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=Bl(n),a=Jp(n),l=yl(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=Kp(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:f*c}:{x:f*c,y:h*u}}const $H=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=t,l=await ZH(t,e);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},XH=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:C=>{let{x:v,y:m}=C;return{x:v,y:m}}},...l}=Kp(e,t),c={x:n,y:r},u=await BP(t,l),d=yl(Bl(i)),f=DP(d);let h=c[f],p=c[d];if(o){const C=f==="y"?"top":"left",v=f==="y"?"bottom":"right",m=h+u[C],y=h-u[v];h=JS(m,h,y)}if(s){const C=d==="y"?"top":"left",v=d==="y"?"bottom":"right",m=p+u[C],y=p-u[v];p=JS(m,p,y)}const g=a.fn({...t,[f]:h,[d]:p});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[f]:o,[d]:s}}}}}};function Yp(){return typeof window<"u"}function Cu(e){return OP(e)?(e.nodeName||"").toLowerCase():"#document"}function ei(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Hs(e){var t;return(t=(OP(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function OP(e){return Yp()?e instanceof Node||e instanceof ei(e).Node:!1}function Qi(e){return Yp()?e instanceof Element||e instanceof ei(e).Element:!1}function Vo(e){return Yp()?e instanceof HTMLElement||e instanceof ei(e).HTMLElement:!1}function qS(e){return!Yp()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ei(e).ShadowRoot}function Df(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=eo(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function KH(e){return["table","td","th"].includes(Cu(e))}function qp(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Ux(e){const t=Vx(),n=Qi(e)?eo(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function JH(e){let t=La(e);for(;Vo(t)&&!eu(t);){if(Ux(t))return t;if(qp(t))return null;t=La(t)}return null}function Vx(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function eu(e){return["html","body","#document"].includes(Cu(e))}function eo(e){return ei(e).getComputedStyle(e)}function Qp(e){return Qi(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function La(e){if(Cu(e)==="html")return e;const t=e.assignedSlot||e.parentNode||qS(e)&&e.host||Hs(e);return qS(t)?t.host:t}function FP(e){const t=La(e);return eu(t)?e.ownerDocument?e.ownerDocument.body:e.body:Vo(t)&&Df(t)?t:FP(t)}function MP(e,t,n){var r;t===void 0&&(t=[]);const i=FP(e),o=i===((r=e.ownerDocument)==null?void 0:r.body),s=ei(i);return o?(Cy(s),t.concat(s,s.visualViewport||[],Df(i)?i:[],[])):t.concat(i,MP(i,[]))}function Cy(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function LP(e){const t=eo(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=Vo(e),o=i?e.offsetWidth:n,s=i?e.offsetHeight:r,a=op(n)!==o||op(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function UP(e){return Qi(e)?e:e.contextElement}function Nc(e){const t=UP(e);if(!Vo(t))return Fo(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:o}=LP(t);let s=(o?op(n.width):n.width)/r,a=(o?op(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const YH=Fo(0);function VP(e){const t=ei(e);return!Vx()||!t.visualViewport?YH:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function qH(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ei(e)?!1:t}function uf(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),o=UP(e);let s=Fo(1);t&&(r?Qi(r)&&(s=Nc(r)):s=Nc(e));const a=qH(o,n,r)?VP(o):Fo(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const f=ei(o),h=r&&Qi(r)?ei(r):r;let p=f,g=Cy(p);for(;g&&r&&h!==p;){const C=Nc(g),v=g.getBoundingClientRect(),m=eo(g),y=v.left+(g.clientLeft+parseFloat(m.paddingLeft))*C.x,x=v.top+(g.clientTop+parseFloat(m.paddingTop))*C.y;l*=C.x,c*=C.y,u*=C.x,d*=C.y,l+=y,c+=x,p=ei(g),g=Cy(p)}}return ap({width:u,height:d,x:l,y:c})}function Gx(e,t){const n=Qp(e).scrollLeft;return t?t.left+n:uf(Hs(e)).left+n}function GP(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),i=r.left+t.scrollLeft-(n?0:Gx(e,r)),o=r.top+t.scrollTop;return{x:i,y:o}}function QH(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const o=i==="fixed",s=Hs(r),a=t?qp(t.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Fo(1);const u=Fo(0),d=Vo(r);if((d||!d&&!o)&&((Cu(r)!=="body"||Df(s))&&(l=Qp(r)),Vo(r))){const h=uf(r);c=Nc(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}const f=s&&!d&&!o?GP(s,l,!0):Fo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function eZ(e){return Array.from(e.getClientRects())}function tZ(e){const t=Hs(e),n=Qp(e),r=e.ownerDocument.body,i=Pc(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Pc(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Gx(e);const a=-n.scrollTop;return eo(r).direction==="rtl"&&(s+=Pc(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function nZ(e,t){const n=ei(e),r=Hs(e),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=Vx();(!c||c&&t==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function rZ(e,t){const n=uf(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=Vo(e)?Nc(e):Fo(1),s=e.clientWidth*o.x,a=e.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function QS(e,t,n){let r;if(t==="viewport")r=nZ(e,n);else if(t==="document")r=tZ(Hs(e));else if(Qi(t))r=rZ(t,n);else{const i=VP(e);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return ap(r)}function WP(e,t){const n=La(e);return n===t||!Qi(n)||eu(n)?!1:eo(n).position==="fixed"||WP(n,t)}function iZ(e,t){const n=t.get(e);if(n)return n;let r=MP(e,[]).filter(a=>Qi(a)&&Cu(a)!=="body"),i=null;const o=eo(e).position==="fixed";let s=o?La(e):e;for(;Qi(s)&&!eu(s);){const a=eo(s),l=Ux(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Df(s)&&!l&&WP(e,s))?r=r.filter(u=>u!==s):i=a,s=La(s)}return t.set(e,r),r}function oZ(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const s=[...n==="clippingAncestors"?qp(t)?[]:iZ(t,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=QS(t,u,i);return c.top=Pc(d.top,c.top),c.right=my(d.right,c.right),c.bottom=my(d.bottom,c.bottom),c.left=Pc(d.left,c.left),c},QS(t,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function sZ(e){const{width:t,height:n}=LP(e);return{width:t,height:n}}function aZ(e,t,n){const r=Vo(t),i=Hs(t),o=n==="fixed",s=uf(e,!0,o,t);let a={scrollLeft:0,scrollTop:0};const l=Fo(0);function c(){l.x=Gx(i)}if(r||!r&&!o)if((Cu(t)!=="body"||Df(i))&&(a=Qp(t)),r){const h=uf(t,!0,o,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else i&&c();o&&!r&&i&&c();const u=i&&!r&&!o?GP(i,a):Fo(0),d=s.left+a.scrollLeft-l.x-u.x,f=s.top+a.scrollTop-l.y-u.y;return{x:d,y:f,width:s.width,height:s.height}}function Ym(e){return eo(e).position==="static"}function ek(e,t){if(!Vo(e)||eo(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Hs(e)===n&&(n=n.ownerDocument.body),n}function jP(e,t){const n=ei(e);if(qp(e))return n;if(!Vo(e)){let i=La(e);for(;i&&!eu(i);){if(Qi(i)&&!Ym(i))return i;i=La(i)}return n}let r=ek(e,t);for(;r&&KH(r)&&Ym(r);)r=ek(r,t);return r&&eu(r)&&Ym(r)&&!Ux(r)?n:r||JH(e)||n}const lZ=async function(e){const t=this.getOffsetParent||jP,n=this.getDimensions,r=await n(e.floating);return{reference:aZ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function cZ(e){return eo(e).direction==="rtl"}const uZ={convertOffsetParentRelativeRectToViewportRelativeRect:QH,getDocumentElement:Hs,getClippingRect:oZ,getOffsetParent:jP,getElementRects:lZ,getClientRects:eZ,getDimensions:sZ,getScale:Nc,isElement:Qi,isRTL:cZ},dZ=$H,fZ=XH,hZ=HH,pZ=(e,t,n)=>{const r=new Map,i={platform:uZ,...n},o={...i.platform,_c:r};return zH(e,t,{...i,platform:o})};var zP={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.log=n()})(Ze,function(){var t=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},s=null;function a(g,C){var v=g[C];if(typeof v.bind=="function")return v.bind(g);try{return Function.prototype.bind.call(v,g)}catch{return function(){return Function.prototype.apply.apply(v,[g,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?l:console[g]!==void 0?a(console,g):console.log!==void 0?a(console,"log"):t}function u(){for(var g=this.getLevel(),C=0;C<i.length;C++){var v=i[C];this[v]=C<g?t:this.methodFactory(v,g,this.name)}if(this.log=this.debug,typeof console===n&&g<this.levels.SILENT)return"No console available for logging"}function d(g){return function(){typeof console!==n&&(u.call(this),this[g].apply(this,arguments))}}function f(g,C,v){return c(g)||d.apply(this,arguments)}function h(g,C){var v=this,m,y,x,b="loglevel";typeof g=="string"?b+=":"+g:typeof g=="symbol"&&(b=void 0);function k(R){var P=(i[R]||"silent").toUpperCase();if(!(typeof window===n||!b)){try{window.localStorage[b]=P;return}catch{}try{window.document.cookie=encodeURIComponent(b)+"="+P+";"}catch{}}}function A(){var R;if(!(typeof window===n||!b)){try{R=window.localStorage[b]}catch{}if(typeof R===n)try{var P=window.document.cookie,L=encodeURIComponent(b),z=P.indexOf(L+"=");z!==-1&&(R=/^([^;]+)/.exec(P.slice(z+L.length+1))[1])}catch{}return v.levels[R]===void 0&&(R=void 0),R}}function E(){if(!(typeof window===n||!b)){try{window.localStorage.removeItem(b)}catch{}try{window.document.cookie=encodeURIComponent(b)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function D(R){var P=R;if(typeof P=="string"&&v.levels[P.toUpperCase()]!==void 0&&(P=v.levels[P.toUpperCase()]),typeof P=="number"&&P>=0&&P<=v.levels.SILENT)return P;throw new TypeError("log.setLevel() called with invalid level: "+R)}v.name=g,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=C||f,v.getLevel=function(){return x??y??m},v.setLevel=function(R,P){return x=D(R),P!==!1&&k(x),u.call(v)},v.setDefaultLevel=function(R){y=D(R),A()||v.setLevel(R,!1)},v.resetLevel=function(){x=null,E(),u.call(v)},v.enableAll=function(R){v.setLevel(v.levels.TRACE,R)},v.disableAll=function(R){v.setLevel(v.levels.SILENT,R)},v.rebuild=function(){if(s!==v&&(m=D(s.getLevel())),u.call(v),s===v)for(var R in o)o[R].rebuild()},m=D(s?s.getLevel():"WARN");var T=A();T!=null&&(x=D(T)),u.call(v)}s=new h,s.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var v=o[C];return v||(v=o[C]=new h(C,s.methodFactory)),v};var p=typeof window!==n?window.log:void 0;return s.noConflict=function(){return typeof window!==n&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return o},s.default=s,s})})(zP);var gZ=zP.exports;const mZ=tu(gZ);function In(e){return typeof e=="function"}function HP(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var qm=HP(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function yy(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var eg=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=Xc(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(g){t={error:g}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}else s.remove(this);var u=this.initialTeardown;if(In(u))try{u()}catch(g){o=g instanceof qm?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Xc(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{tk(p)}catch(g){o=o??[],g instanceof qm?o=GC(GC([],VC(o)),VC(g.errors)):o.push(g)}}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(o)throw new qm(o)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)tk(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&yy(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&yy(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),ZP=eg.EMPTY;function $P(e){return e instanceof eg||e&&"closed"in e&&In(e.remove)&&In(e.add)&&In(e.unsubscribe)}function tk(e){In(e)?e():e.unsubscribe()}var vZ={Promise:void 0},CZ={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,GC([e,t],VC(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function XP(e){CZ.setTimeout(function(){throw e})}function xy(){}function t0(e){e()}var Wx=function(e){pu(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,$P(n)&&n.add(r)):r.destination=IZ,r}return t.create=function(n,r,i){return new Iy(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(eg),yZ=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){fh(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){fh(r)}else fh(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){fh(n)}},e}(),Iy=function(e){pu(t,e);function t(n,r,i){var o=e.call(this)||this,s;return In(n)||!n?s={next:n??void 0,error:r??void 0,complete:i??void 0}:s=n,o.destination=new yZ(s),o}return t}(Wx);function fh(e){XP(e)}function xZ(e){throw e}var IZ={closed:!0,next:xy,error:xZ,complete:xy},jx=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function KP(e){return e}function bZ(e){return e.length===0?KP:e.length===1?e[0]:function(n){return e.reduce(function(r,i){return i(r)},n)}}var Gn=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i=this,o=wZ(t)?t:new Iy(t,n,r);return t0(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=nk(n),new n(function(i,o){var s=new Iy({next:function(a){try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[jx]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return bZ(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=nk(t),new t(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},e.create=function(t){return new e(t)},e}();function nk(e){var t;return(t=e??vZ.Promise)!==null&&t!==void 0?t:Promise}function AZ(e){return e&&In(e.next)&&In(e.error)&&In(e.complete)}function wZ(e){return e&&e instanceof Wx||AZ(e)&&$P(e)}function SZ(e){return In(e==null?void 0:e.lift)}function Zs(e){return function(t){if(SZ(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ol(e,t,n,r,i){return new kZ(e,t,n,r,i)}var kZ=function(e){pu(t,e);function t(n,r,i,o,s,a){var l=e.call(this,n)||this;return l.onFinalize=s,l.shouldUnsubscribe=a,l._next=r?function(c){try{r(c)}catch(u){n.error(u)}}:e.prototype._next,l._error=o?function(c){try{o(c)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=i?function(){try{i()}catch(c){n.error(c)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(Wx),EZ=HP(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ua=function(e){pu(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new rk(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new EZ},t.prototype.next=function(n){var r=this;t0(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=Xc(r.currentObservers),a=s.next();!a.done;a=s.next()){var l=a.value;l.next(n)}}catch(c){i={error:c}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},t.prototype.error=function(n){var r=this;t0(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},t.prototype.complete=function(){var n=this;t0(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?ZP:(this.currentObservers=null,a.push(n),new eg(function(){r.currentObservers=null,yy(a,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},t.prototype.asObservable=function(){var n=new Gn;return n.source=this,n},t.create=function(n,r){return new rk(n,r)},t}(Gn),rk=function(e){pu(t,e);function t(n,r){var i=e.call(this)||this;return i.destination=n,i.source=r,i}return t.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},t.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:ZP},t}(Ua),JP=function(e){pu(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(Ua);function TZ(e){return e&&In(e.schedule)}function RZ(e){return e[e.length-1]}function YP(e){return TZ(RZ(e))?e.pop():void 0}var qP=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function QP(e){return In(e==null?void 0:e.then)}function e3(e){return In(e[jx])}function t3(e){return Symbol.asyncIterator&&In(e==null?void 0:e[Symbol.asyncIterator])}function n3(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function _Z(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var r3=_Z();function i3(e){return In(e==null?void 0:e[r3])}function o3(e){return WG(this,arguments,function(){var n,r,i,o;return O_(this,function(s){switch(s.label){case 0:n=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Sc(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,Sc(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Sc(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function s3(e){return In(e==null?void 0:e.getReader)}function yu(e){if(e instanceof Gn)return e;if(e!=null){if(e3(e))return DZ(e);if(qP(e))return PZ(e);if(QP(e))return NZ(e);if(t3(e))return a3(e);if(i3(e))return BZ(e);if(s3(e))return OZ(e)}throw n3(e)}function DZ(e){return new Gn(function(t){var n=e[jx]();if(In(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function PZ(e){return new Gn(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function NZ(e){return new Gn(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,XP)})}function BZ(e){return new Gn(function(t){var n,r;try{for(var i=Xc(e),o=i.next();!o.done;o=i.next()){var s=o.value;if(t.next(s),t.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()})}function a3(e){return new Gn(function(t){FZ(e,t).catch(function(n){return t.error(n)})})}function OZ(e){return a3(o3(e))}function FZ(e,t){var n,r,i,o;return GG(this,void 0,void 0,function(){var s,a;return O_(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=jG(e),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function xl(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(o),!i)return o}function l3(e,t){return t===void 0&&(t=0),Zs(function(n,r){n.subscribe(Ol(r,function(i){return xl(r,e,function(){return r.next(i)},t)},function(){return xl(r,e,function(){return r.complete()},t)},function(i){return xl(r,e,function(){return r.error(i)},t)}))})}function c3(e,t){return t===void 0&&(t=0),Zs(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function MZ(e,t){return yu(e).pipe(c3(t),l3(t))}function LZ(e,t){return yu(e).pipe(c3(t),l3(t))}function UZ(e,t){return new Gn(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function VZ(e,t){return new Gn(function(n){var r;return xl(n,t,function(){r=e[r3](),xl(n,t,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return In(r==null?void 0:r.return)&&r.return()}})}function u3(e,t){if(!e)throw new Error("Iterable cannot be null");return new Gn(function(n){xl(n,t,function(){var r=e[Symbol.asyncIterator]();xl(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function GZ(e,t){return u3(o3(e),t)}function WZ(e,t){if(e!=null){if(e3(e))return MZ(e,t);if(qP(e))return UZ(e,t);if(QP(e))return LZ(e,t);if(t3(e))return u3(e,t);if(i3(e))return VZ(e,t);if(s3(e))return GZ(e,t)}throw n3(e)}function jZ(e,t){return t?WZ(e,t):yu(e)}function yr(e,t){return Zs(function(n,r){var i=0;n.subscribe(Ol(r,function(o){r.next(e.call(t,o,i++))}))})}function zZ(e,t,n,r,i,o,s,a){var l=[],c=0,u=0,d=!1,f=function(){d&&!l.length&&!c&&t.complete()},h=function(g){return c<r?p(g):l.push(g)},p=function(g){c++;var C=!1;yu(n(g,u++)).subscribe(Ol(t,function(v){t.next(v)},function(){C=!0},void 0,function(){if(C)try{c--;for(var v=function(){var m=l.shift();s||p(m)};l.length&&c<r;)v();f()}catch(m){t.error(m)}}))};return e.subscribe(Ol(t,h,function(){d=!0,f()})),function(){}}function d3(e,t,n){return n===void 0&&(n=1/0),In(t)?d3(function(r,i){return yr(function(o,s){return t(r,o,i,s)})(yu(e(r,i)))},n):(typeof t=="number"&&(n=t),Zs(function(r,i){return zZ(r,i,e,n)}))}function HZ(e){return d3(KP,e)}function ZZ(){return HZ(1)}function by(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ZZ()(jZ(e,YP(e)))}function f3(e,t){return Zs(function(n,r){var i=0;n.subscribe(Ol(r,function(o){return e.call(t,o,i++)&&r.next(o)}))})}function $Z(e,t,n,r,i){return function(o,s){var a=n,l=t,c=0;o.subscribe(Ol(s,function(u){var d=c++;l=a?e(l,u,d):(a=!0,u),s.next(l)},i))}}function XZ(e){return Zs(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}function KZ(e,t){return Zs($Z(e,t,arguments.length>=2,!0))}function no(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=YP(e);return Zs(function(r,i){(n?by(e,r,n):by(e,r)).subscribe(i)})}function ik(e){return Zs(function(t,n){yu(e).subscribe(Ol(n,function(){return n.complete()},xy)),!n.closed&&t.subscribe(n)})}var JZ=Object.defineProperty,YZ=Object.defineProperties,qZ=Object.getOwnPropertyDescriptors,lp=Object.getOwnPropertySymbols,h3=Object.prototype.hasOwnProperty,p3=Object.prototype.propertyIsEnumerable,ok=(e,t,n)=>t in e?JZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ay=(e,t)=>{for(var n in t||(t={}))h3.call(t,n)&&ok(e,n,t[n]);if(lp)for(var n of lp(t))p3.call(t,n)&&ok(e,n,t[n]);return e},QZ=(e,t)=>YZ(e,qZ(t)),e$=(e,t)=>{var n={};for(var r in e)h3.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&lp)for(var r of lp(e))t.indexOf(r)<0&&p3.call(e,r)&&(n[r]=e[r]);return n},$s=(e,t,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(e,t)).next())}),g3="lk";function zx(e){return typeof e>"u"?!1:t$(e)||n$(e)}function t$(e){var t;return e?e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&typeof((t=e.publication)==null?void 0:t.track)<"u":!1}function n$(e){return e?e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&typeof e.publication<"u":!1}function r$(e){return e?e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&typeof e.publication>"u":!1}function m3(e){if(typeof e=="string"||typeof e=="number")return`${e}`;if(r$(e))return`${e.participant.identity}_${e.source}_placeholder`;if(zx(e))return`${e.participant.identity}_${e.publication.source}_${e.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${e}`)}function i$(e){return e instanceof gy}function o$(e,t){return $s(this,null,function*(){const{x:n,y:r}=yield pZ(e,t,{placement:"top",middleware:[dZ(6),hZ(),fZ({padding:5})]});return{x:n,y:r}})}function s$(e,t){return!e.contains(t.target)}var a$=[ue.ConnectionStateChanged,ue.RoomMetadataChanged,ue.ActiveSpeakersChanged,ue.ConnectionQualityChanged,ue.ParticipantConnected,ue.ParticipantDisconnected,ue.ParticipantPermissionsChanged,ue.ParticipantMetadataChanged,ue.TrackMuted,ue.TrackUnmuted,ue.TrackPublished,ue.TrackUnpublished,ue.TrackStreamStateChanged,ue.TrackSubscriptionFailed,ue.TrackSubscriptionPermissionChanged,ue.TrackSubscriptionStatusChanged],l$=[...a$,ue.LocalTrackPublished,ue.LocalTrackUnpublished],c$=[de.ConnectionQualityChanged,de.IsSpeakingChanged,de.ParticipantMetadataChanged,de.ParticipantPermissionsChanged,de.TrackMuted,de.TrackUnmuted,de.TrackPublished,de.TrackUnpublished,de.TrackStreamStateChanged,de.TrackSubscriptionFailed,de.TrackSubscriptionPermissionChanged,de.TrackSubscriptionStatusChanged];[...c$,de.LocalTrackPublished,de.LocalTrackUnpublished];var Ct=mZ.getLogger("lk-components-js");Ct.setDefaultLevel("WARN");function u$(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var d$=[],f$={showChat:!1,unreadMessages:0};function Hx(e,...t){return new Gn(r=>{const i=()=>{r.next(e)};return t.forEach(s=>{e.on(s,i)}),()=>{t.forEach(s=>{e.off(s,i)})}}).pipe(no(e))}function Zx(e,t){return new Gn(r=>{const i=(...s)=>{r.next(s)};return e.on(t,i),()=>{e.off(t,i)}})}function h$(e){return Zx(e,ue.ConnectionStateChanged).pipe(yr(([t])=>t),no(e.state))}function p$(e,t,n=!0){var r;const i=()=>$s(this,null,function*(){try{const a=yield ip.getLocalDevices(e,n);o.next(a)}catch(a){t==null||t(a)}}),o=new Ua,s=o.pipe(XZ(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return by(ip.getLocalDevices(e,n).catch(a=>t==null?void 0:t(a)),s)}function g$(e){return Zx(e,ue.DataReceived)}function m$(e){return Hx(e,ue.AudioPlaybackStatusChanged).pipe(yr(n=>({canPlayAudio:n.canPlaybackAudio})))}function v$(e){return Hx(e,ue.VideoPlaybackStatusChanged).pipe(yr(n=>({canPlayVideo:n.canPlaybackVideo})))}function C$(e,t){return Zx(e,ue.ActiveDeviceChanged).pipe(f3(([n])=>n===t),yr(([n,r])=>(Ct.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),no(e.getActiveDevice(t)))}function xi(e){return`${g3}-${e}`}function y$(e){const t=wy(e),n=Xx(e.participant).pipe(yr(()=>wy(e)),no(t));return{className:xi(e.source===re.Source.Camera||e.source===re.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function wy(e){if(zx(e))return e.publication;{const{source:t,name:n,participant:r}=e;if(t&&n)return r.getTracks().find(i=>i.source===t&&i.trackName===n);if(n)return r.getTrackByName(n);if(t)return r.getTrack(t);throw new Error("At least one of source and name needs to be defined")}}function $x(e,...t){return new Gn(r=>{const i=()=>{r.next(e)};return t.forEach(s=>{e.on(s,i)}),()=>{t.forEach(s=>{e.off(s,i)})}}).pipe(no(e))}function Xx(e){return $x(e,de.TrackMuted,de.TrackUnmuted,de.ParticipantPermissionsChanged,de.TrackPublished,de.TrackUnpublished,de.LocalTrackPublished,de.LocalTrackUnpublished,de.MediaDevicesError,de.TrackSubscriptionStatusChanged).pipe(yr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=n,s=n.getTrack(re.Source.Microphone),a=n.getTrack(re.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:a,microphoneTrack:s,participant:n}}))}function x$(e){return $x(e,de.ParticipantMetadataChanged).pipe(yr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),no({name:e.name,identity:e.identity,metadata:e.metadata}))}function I$(e){return Kx(e,de.ConnectionQualityChanged).pipe(yr(([n])=>n),no(e.connectionQuality))}function Kx(e,t){return new Gn(r=>{const i=(...s)=>{r.next(s)};return e.on(t,i),()=>{e.off(t,i)}})}function v3(e){var t,n,r,i;return $x(e.participant,de.TrackMuted,de.TrackUnmuted,de.TrackSubscribed,de.TrackUnsubscribed,de.LocalTrackPublished,de.LocalTrackUnpublished).pipe(yr(o=>{var s,a;const l=(s=e.publication)!=null?s:o.getTrack(e.source);return(a=l==null?void 0:l.isMuted)!=null?a:!0}),no((i=(r=(t=e.publication)==null?void 0:t.isMuted)!=null?r:(n=e.participant.getTrack(e.source))==null?void 0:n.isMuted)!=null?i:!0))}function b$(e){return Kx(e,de.IsSpeakingChanged).pipe(yr(([t])=>t))}function A$(e,t={}){var n;let r;const i=new Gn(l=>(r=l,()=>a.unsubscribe())).pipe(no(Array.from(e.participants.values()))),o=(n=t.additionalRoomEvents)!=null?n:l$,s=Array.from(new Set([ue.ParticipantConnected,ue.ParticipantDisconnected,ue.ConnectionStateChanged,...o])),a=Hx(e,...s).subscribe(l=>r==null?void 0:r.next(Array.from(l.participants.values())));return e.participants.size>0&&(r==null||r.next(Array.from(e.participants.values()))),i}function w$(e){return Kx(e,de.ParticipantPermissionsChanged).pipe(yr(()=>e.permissions),no(e.permissions))}function S$(e,t,n){const{localParticipant:r}=t,i=(c,u)=>{let d=!1;switch(c){case re.Source.Camera:d=u.isCameraEnabled;break;case re.Source.Microphone:d=u.isMicrophoneEnabled;break;case re.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},o=Xx(r).pipe(yr(c=>i(e,c.participant)),no(i(e,r))),s=new Ua,a=(c,u)=>$s(this,null,function*(){try{switch(u??(u=n),s.next(!0),e){case re.Source.Camera:yield r.setCameraEnabled(c??!r.isCameraEnabled,u);break;case re.Source.Microphone:yield r.setMicrophoneEnabled(c??!r.isMicrophoneEnabled,u);break;case re.Source.ScreenShare:yield r.setScreenShareEnabled(c??!r.isScreenShareEnabled,u);break;default:break}}finally{s.next(!1)}});return{className:xi("button"),toggle:a,enabledObserver:o,pendingObserver:s.asObservable()}}function k$(){let e=!1;const t=new Ua,n=new Ua,r=o=>{n.next(!0),e=o??!e,t.next(e),n.next(!1)};return{className:xi("button"),toggle:r,enabledObserver:t.asObservable(),pendingObserver:n.asObservable()}}function E$(e,t,n){const r=new JP(void 0),i=t?C$(t,e):r.asObservable(),o=(a,...l)=>$s(this,[a,...l],function*(c,u={}){var d,f,h;if(t){Ct.debug(`Switching active device of kind "${e}" with id ${c}.`),yield t.switchActiveDevice(e,c,u.exact);const p=(d=t.getActiveDevice(e))!=null?d:c;p!==c&&c!=="default"&&Ct.info(`We tried to select the device with id (${c}), but the browser decided to select the device with id (${p}) instead.`);let g;e==="audioinput"?g=(f=t.localParticipant.getTrack(re.Source.Microphone))==null?void 0:f.track:e==="videoinput"&&(g=(h=t.localParticipant.getTrack(re.Source.Camera))==null?void 0:h.track);const C=c==="default"&&!g||c==="default"&&(g==null?void 0:g.mediaStreamTrack.label.startsWith("Default"));r.next(C?c:p)}else if(n){yield n.setDeviceId(u.exact?{exact:c}:c);const p=yield n.getDeviceId();r.next(c==="default"&&n.mediaStreamTrack.label.startsWith("Default")?c:p)}else r.value!==c&&(Ct.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(c))});return{className:xi("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function T$(e){const t=r=>{e.disconnect(r)};return{className:xi("disconnect-button"),disconnect:t}}function R$(e){const t=xi("connection-quality"),n=I$(e);return{className:t,connectionQualityObserver:n}}function _$(e){let t="track-muted-indicator-camera";switch(e.source){case re.Source.Camera:t="track-muted-indicator-camera";break;case re.Source.Microphone:t="track-muted-indicator-microphone";break}const n=xi(t),r=v3(e);return{className:n,mediaMutedObserver:r}}function D$(e){return{className:"lk-participant-name",infoObserver:x$(e)}}function P$(){return{className:xi("participant-tile")}}var N$={CHAT:"lk-chat-topic"};function C3(e,t,n){return $s(this,arguments,function*(r,i,o,s={}){const{kind:a,destination:l}=s;yield r.publishData(i,a??mn.RELIABLE,{destination:l,topic:o})})}function B$(e,t,n){const r=g$(e).pipe(f3(([,,,a])=>t===void 0||a===t),yr(([a,l,,c])=>({payload:a,topic:c,from:l})));let i;const o=new Gn(a=>{i=a});return{messageObservable:r,isSendingObservable:o,send:(a,...l)=>$s(this,[a,...l],function*(c,u={}){i.next(!0);try{yield C3(e.localParticipant,c,t,u)}finally{i.next(!1)}})}}var O$=new TextEncoder,F$=new TextDecoder,hh=new Map,M$=e=>O$.encode(JSON.stringify({message:e.message,timestamp:e.timestamp})),L$=e=>JSON.parse(F$.decode(e));function U$(e,t){var n,r;const i=new Ua,{messageDecoder:o,messageEncoder:s,channelTopic:a}=t??{},l=a??N$.CHAT;let c=!1;hh.has(e)||(c=!0);const u=(n=hh.get(e))!=null?n:new Map,d=(r=u.get(l))!=null?r:new Ua;if(u.set(l,d),hh.set(e,u),c){const{messageObservable:m}=B$(e,l);m.pipe(ik(i)).subscribe(d)}const f=o??L$,h=d.pipe(yr(m=>{const y=f(m.payload);return QZ(Ay({},y),{from:m.from})}),KZ((m,y)=>[...m,y],[]),ik(i)),p=new JP(!1),g=s??M$,C=m=>$s(this,null,function*(){const y=Date.now(),x=g({message:m,timestamp:y});p.next(!0);try{yield C3(e.localParticipant,x,l,{kind:mn.RELIABLE}),d.next({payload:x,topic:l,from:e.localParticipant})}finally{p.next(!1)}});function v(){i.next(),i.complete(),hh.clear()}return e.once(ue.Disconnected,v),{messageObservable:h,isSendingObservable:p,send:C}}function V$(){const e=n=>$s(this,null,function*(){Ct.info("Start Audio for room: ",n),yield n.startAudio()});return{className:xi("start-audio-button"),roomAudioPlaybackAllowedObservable:m$,handleStartAudioPlayback:e}}function G$(){const e=n=>$s(this,null,function*(){Ct.info("Start Video for room: ",n),yield n.startVideo()});return{className:xi("start-audio-button"),roomVideoPlaybackAllowedObservable:v$,handleStartVideoPlayback:e}}function W$(){return{className:[xi("button"),xi("chat-toggle")].join(" ")}}function j$(){return{className:"lk-room-container"}}function z$(e,t){if(typeof localStorage>"u"){Ct.error("Local storage is not available.");return}try{localStorage.setItem(e,JSON.stringify(t))}catch(n){Ct.error(`Error setting item to local storage: ${n}`)}}function H$(e){if(typeof localStorage>"u"){Ct.error("Local storage is not available.");return}try{const t=localStorage.getItem(e);if(!t){Ct.warn(`Item with key ${e} does not exist in local storage.`);return}return JSON.parse(t)}catch(t){Ct.error(`Error getting item from local storage: ${t}`);return}}function Z$(e){return{load:()=>H$(e),save:t=>z$(e,t)}}var $$=`${g3}-user-choices`,Ja={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:X$,save:K$}=Z$($$);function J$(e,t=!1){if(t===!0)return;const n=e,{e2ee:r,sharedPassphrase:i}=n,o=e$(n,["e2ee","sharedPassphrase"]);K$(o)}function Y$(e,t=!1){var n,r,i,o,s,a,l;const c={videoEnabled:(n=e==null?void 0:e.videoEnabled)!=null?n:Ja.videoEnabled,audioEnabled:(r=e==null?void 0:e.audioEnabled)!=null?r:Ja.audioEnabled,videoDeviceId:(i=e==null?void 0:e.videoDeviceId)!=null?i:Ja.videoDeviceId,audioDeviceId:(o=e==null?void 0:e.audioDeviceId)!=null?o:Ja.audioDeviceId,username:(s=e==null?void 0:e.username)!=null?s:Ja.username,e2ee:(a=e==null?void 0:e.e2ee)!=null?a:Ja.e2ee,sharedPassphrase:(l=e==null?void 0:e.sharedPassphrase)!=null?l:Ja.sharedPassphrase};if(t)return c;{const u=X$();return Ay(Ay({},c),u??{})}}function y3(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=y3(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function q$(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=y3(e))&&(r&&(r+=" "),r+=t);return r}var Q$=Object.defineProperty,eX=Object.defineProperties,tX=Object.getOwnPropertyDescriptors,cp=Object.getOwnPropertySymbols,x3=Object.prototype.hasOwnProperty,I3=Object.prototype.propertyIsEnumerable,sk=(e,t,n)=>t in e?Q$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Me=(e,t)=>{for(var n in t||(t={}))x3.call(t,n)&&sk(e,n,t[n]);if(cp)for(var n of cp(t))I3.call(t,n)&&sk(e,n,t[n]);return e},Jn=(e,t)=>eX(e,tX(t)),Wn=(e,t)=>{var n={};for(var r in e)x3.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&cp)for(var r of cp(e))t.indexOf(r)<0&&I3.call(e,r)&&(n[r]=e[r]);return n},b3=(e,t,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(e,t)).next())});function ni(e,t){const[n,r]=S.useState(t);return S.useEffect(()=>{if(typeof window>"u"||!e)return;const i=e.subscribe(r);return()=>i.unsubscribe()},[e]),n}function nX(e){const t=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,r]=S.useState(t(e));function i(){r(t(e))}return S.useEffect(()=>{const o=window.matchMedia(e);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[e]),n}function rX(e,t){if(t.msg==="show_chat")return Jn(Me({},e),{showChat:!0,unreadMessages:0});if(t.msg==="hide_chat")return Jn(Me({},e),{showChat:!1});if(t.msg==="toggle_chat"){const n=Jn(Me({},e),{showChat:!e.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return t.msg==="unread_msg"?Jn(Me({},e),{unreadMessages:t.count}):Me({},e)}function iX(e,t){return t.msg==="set_pin"?[t.trackReference]:t.msg==="clear_pin"?[]:Me({},e)}var Jx=S.createContext(void 0);function oX(){const e=S.useContext(Jx);if(!e)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return e}function sX(e){const[t,n]=S.useReducer(iX,d$),[r,i]=S.useReducer(rX,f$);return e??{pin:{dispatch:n,state:t},widget:{dispatch:i,state:r}}}function A3(){return S.useContext(Jx)}var aX=S.createContext(void 0);function Pf(){return S.useContext(aX)}var Yx=S.createContext(void 0);function tg(){return S.useContext(Yx)}function zl(e){var t;const n=tg(),r=Pf(),i=(t=e??n)!=null?t:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var qx=S.createContext(void 0);function ng(){const e=S.useContext(qx);if(!e)throw Error("tried to access room context outside of livekit room component");return e}function rg(){return S.useContext(qx)}function Nf(e){const t=rg(),n=e??t;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var lX=S.createContext(void 0);function cX(...e){return(...t)=>{for(const n of e)typeof n=="function"&&n(...t)}}function Xa(...e){const t=Me({},e[0]);for(let n=1;n<e.length;n++){const r=e[n];for(const i in r){const o=t[i],s=r[i];typeof o=="function"&&typeof s=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?t[i]=cX(o,s):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?t[i]=q$(o,s):t[i]=s!==void 0?s:o}}return t}function uX(e={}){const t=zl(e.participant),{className:n,connectionQualityObserver:r}=S.useMemo(()=>R$(t),[t]),i=ni(r,fi.Unknown);return{className:n,quality:i}}function dX(e){const t=Nf(e),n=S.useMemo(()=>h$(t),[t]);return ni(n,t.state)}function fX(e){const t=ng(),n=dX(t);return{buttonProps:S.useMemo(()=>{const{className:i,disconnect:o}=T$(t);return Xa(e,{className:i,onClick:()=>{var a;return o((a=e.stopTracks)!=null?a:!0)},disabled:n===ft.Disconnected})},[t,e,n])}}function hX(e){if(e.publication instanceof lf){const t=e.publication.track;if(t){const{facingMode:n}=PH(t);return n}}return"undefined"}function ak(e,t={}){var n,r;const i=typeof e=="string"?t.participant:e.participant,o=zl(i),s=typeof e=="string"?{participant:o,source:e}:e,[a,l]=S.useState(!!((n=s.publication)!=null&&n.isMuted||(r=o.getTrack(s.source))!=null&&r.isMuted));return S.useEffect(()=>{const c=v3(s).subscribe(l);return()=>c.unsubscribe()},[m3(s)]),a}function pX(e){const t=zl(e),n=S.useMemo(()=>b$(t),[t]);return ni(n,t.isSpeaking)}var gX={connect:!0,audio:!1,video:!1};function mX(e){const t=Me(Me({},gX),e),{token:n,serverUrl:r,options:i,room:o,connectOptions:s,connect:a,audio:l,video:c,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:g,simulateParticipants:C}=t,v=Wn(t,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&Ct.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[m,y]=S.useState();S.useEffect(()=>{y(o??new ip(i))},[o]);const x=S.useMemo(()=>{const{className:b}=j$();return Xa(v,{className:b})},[v]);return S.useEffect(()=>{if(!m)return;const b=()=>{const E=m.localParticipant;Ct.debug("trying to publish local tracks"),Promise.all([E.setMicrophoneEnabled(!!l,typeof l!="boolean"?l:void 0),E.setCameraEnabled(!!c,typeof c!="boolean"?c:void 0),E.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(D=>{Ct.warn(D),h==null||h(D)})},k=E=>{const D=sf.getFailure(E);p==null||p(D)},A=E=>{g==null||g(E)};return m.on(ue.SignalConnected,b).on(ue.MediaDevicesError,k).on(ue.EncryptionError,A),()=>{m.off(ue.SignalConnected,b).off(ue.MediaDevicesError,k).off(ue.EncryptionError,A)}},[m,l,c,u,h,g,p]),S.useEffect(()=>{if(m){if(C){m.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(!n){Ct.debug("no token yet");return}if(!r){Ct.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(Ct.debug("connecting"),m.connect(r,n,s).catch(b=>{Ct.warn(b),h==null||h(b)})):(Ct.debug("disconnecting because connect is false"),m.disconnect())}},[a,n,JSON.stringify(s),m,h,r,C]),S.useEffect(()=>{if(!m)return;const b=k=>{switch(k){case ft.Disconnected:f&&f();break;case ft.Connected:d&&d();break}};return m.on(ue.ConnectionStateChanged,b),()=>{m.off(ue.ConnectionStateChanged,b)}},[n,d,f,m]),S.useEffect(()=>{if(m)return()=>{Ct.info("disconnecting on onmount"),m.disconnect()}},[m]),{room:m,htmlProps:x}}function vX(e={}){const t=Nf(e.room),[n,r]=S.useState(t.localParticipant),[i,o]=S.useState(n.isMicrophoneEnabled),[s,a]=S.useState(n.isMicrophoneEnabled),[l,c]=S.useState(n.lastMicrophoneError),[u,d]=S.useState(n.lastCameraError),[f,h]=S.useState(n.isMicrophoneEnabled),[p,g]=S.useState(void 0),[C,v]=S.useState(void 0),m=y=>{a(y.isCameraEnabled),o(y.isMicrophoneEnabled),h(y.isScreenShareEnabled),v(y.cameraTrack),g(y.microphoneTrack),c(y.participant.lastMicrophoneError),d(y.participant.lastCameraError),r(y.participant)};return S.useEffect(()=>{const y=Xx(n).subscribe(m);return()=>y.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:s,microphoneTrack:p,cameraTrack:C,lastMicrophoneError:l,lastCameraError:u,localParticipant:n}}function CX(){const e=ng(),t=S.useMemo(()=>w$(e.localParticipant),[e]);return ni(t,e.localParticipant.permissions)}function yX({kind:e,room:t,track:n,requestPermissions:r,onError:i}){const o=rg(),s=S.useMemo(()=>p$(e,i,r),[e,r,i]),a=ni(s,[]),[l,c]=S.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=S.useMemo(()=>E$(e,t??o,n),[e,t,o,n]);return S.useEffect(()=>{const h=d.subscribe(p=>{Ct.info("setCurrentDeviceId",p),p&&c(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:l,setActiveMediaDevice:f}}function xX(e){return e!==void 0}function xu(...e){return Xa(...e.filter(xX))}function w3(e,t,n){return S.Children.map(e,r=>S.isValidElement(r)&&S.Children.only(e)?S.cloneElement(r,Jn(Me({},t),{key:n})):r)}function S3(e,t={}){var n;const[r,i]=S.useState(wy(e)),[o,s]=S.useState(r==null?void 0:r.isMuted),[a,l]=S.useState(r==null?void 0:r.isSubscribed),[c,u]=S.useState(r==null?void 0:r.track),[d,f]=S.useState("landscape"),h=S.useRef(),{className:p,trackObserver:g}=S.useMemo(()=>y$(e),[(n=e.participant.sid)!=null?n:e.participant.identity,e.source,zx(e)&&e.publication.trackSid]);return S.useEffect(()=>{const C=g.subscribe(v=>{Ct.debug("update track",v),i(v),s(v==null?void 0:v.isMuted),l(v==null?void 0:v.isSubscribed),u(v==null?void 0:v.track)});return()=>C==null?void 0:C.unsubscribe()},[g]),S.useEffect(()=>{var C,v;return c&&(h.current&&c.detach(h.current),(C=t.element)!=null&&C.current&&!(i$(e.participant)&&(c==null?void 0:c.kind)==="audio")&&c.attach(t.element.current)),h.current=(v=t.element)==null?void 0:v.current,()=>{h.current&&(c==null||c.detach(h.current))}},[c,t.element]),S.useEffect(()=>{var C,v;if(typeof((C=r==null?void 0:r.dimensions)==null?void 0:C.width)=="number"&&typeof((v=r==null?void 0:r.dimensions)==null?void 0:v.height)=="number"){const m=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(m)}},[r]),{publication:r,isMuted:o,isSubscribed:a,track:c,elementProps:xu(t.props,Me({className:p,"data-lk-local-participant":e.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function IX({trackRef:e,participant:t,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:s}){const a=Pf(),l=zl(t),c=S.useMemo(()=>{var g,C,v,m,y,x;const b=(C=(g=e==null?void 0:e.source)!=null?g:a==null?void 0:a.source)!=null?C:n;if(b===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(m=(v=e==null?void 0:e.participant)!=null?v:a==null?void 0:a.participant)!=null?m:l,publication:(x=(y=e==null?void 0:e.publication)!=null?y:a==null?void 0:a.publication)!=null?x:r,source:b}},[e==null?void 0:e.participant,e==null?void 0:e.source,e==null?void 0:e.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,l,n,r]),u=S.useMemo(()=>{const{className:g}=P$();return Xa(s,{className:g,onClick:C=>{var v,m;if((v=s.onClick)==null||v.call(s,C),typeof i=="function"){const y=(m=c.publication)!=null?m:c.participant.getTrack(c.source);i({participant:c.participant,track:y})}}})},[s,i,c.publication,c.source,c.participant]),d=ak(re.Source.Camera,{participant:c.participant}),f=ak(re.Source.Microphone,{participant:c.participant}),h=pX(c.participant),p=hX(c);return{elementProps:Me({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":o===!0?!1:h,"data-lk-local-participant":c.participant.isLocal,"data-lk-source":c.source,"data-lk-facing-mode":p},u)}}function bX(e={}){const t=Nf(e.room),[n,r]=S.useState([]);return S.useEffect(()=>{const i=A$(t,{additionalRoomEvents:e.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[t,JSON.stringify(e.updateOnlyOn)]),n}function AX(e={}){const t=bX(e),{localParticipant:n}=vX(e);return[n,...t]}function wX({room:e,props:t}){const n=Nf(e),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=S.useMemo(()=>V$(),[]),s=S.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=ni(s,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:S.useMemo(()=>Xa(t,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[t,r,a,o,n]),canPlayAudio:a}}function SX({room:e,props:t}){const n=Nf(e),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=S.useMemo(()=>G$(),[]),s=S.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=ni(s,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:S.useMemo(()=>Xa(t,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[t,r,a,o,n]),canPlayVideo:a}}function kX({props:e}){const{dispatch:t,state:n}=oX().widget,{className:r}=S.useMemo(()=>W$(),[]);return{mergedProps:S.useMemo(()=>Xa(e,{className:r,onClick:()=>{t&&t({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[e,r,t,n])}}function EX(e,t={}){var n,r,i,o;let s=Pf();const a=(r=(n=tg())!=null?n:t.participant)!=null?r:s==null?void 0:s.participant;if(typeof e=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:a,source:e}}else if(e)s=e;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:l,mediaMutedObserver:c}=S.useMemo(()=>_$(s),[m3(s)]);return{isMuted:ni(c,!!((i=s.publication)!=null&&i.isMuted||(o=s.participant.getTrack(s.source))!=null&&o.isMuted)),className:l}}function TX(e){var t=e,{source:n,onChange:r,initialState:i,captureOptions:o}=t,s=Wn(t,["source","onChange","initialState","captureOptions"]),a;const l=rg(),c=(a=l==null?void 0:l.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=S.useMemo(()=>l?S$(n,l,o):k$(),[l,n,JSON.stringify(o)]),p=ni(f,!1),g=ni(h,i??!!(c!=null&&c.isEnabled));S.useEffect(()=>{r==null||r(g)},[g,r]),S.useEffect(()=>{i!==void 0&&(Ct.debug("forcing initial toggle state",n,i),u(i))},[]);const C=S.useMemo(()=>Xa(s,{className:d}),[s,d]),v=S.useCallback(m=>{var y;u(),(y=s.onClick)==null||y.call(s,m)},[s,u]);return{toggle:u,enabled:g,pending:p,track:c,buttonProps:Jn(Me({},C),{"aria-pressed":g,"data-lk-source":n,"data-lk-enabled":g,disabled:p,onClick:v})}}function RX(e,t={}){return S3(e,t)}function _X(e){const t=ng(),[n,r]=S.useState(),i=ni(n==null?void 0:n.isSendingObservable,!1),o=ni(n==null?void 0:n.messageObservable,[]);return S.useEffect(()=>{const s=U$(t,e);r(s)},[t,e]),{send:n==null?void 0:n.send,chatMessages:o,isSending:i}}function DX(e={}){var t;const[n,r]=S.useState(Y$(e.defaults,(t=e.preventLoad)!=null?t:!1)),i=S.useCallback(c=>{r(u=>Jn(Me({},u),{audioEnabled:c}))},[]),o=S.useCallback(c=>{r(u=>Jn(Me({},u),{videoEnabled:c}))},[]),s=S.useCallback(c=>{r(u=>Jn(Me({},u),{audioDeviceId:c}))},[]),a=S.useCallback(c=>{r(u=>Jn(Me({},u),{videoDeviceId:c}))},[]),l=S.useCallback(c=>{r(u=>Jn(Me({},u),{username:c}))},[]);return S.useEffect(()=>{var c;J$(n,(c=e.preventSave)!=null?c:!1)},[n,e.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:s,saveVideoInputDeviceId:a,saveUsername:l}}function PX(e){const{mergedProps:t}=kX({props:e});return S.createElement("button",Me({},t),e.children)}function NX(e){const{buttonProps:t}=fX(e);return S.createElement("button",Me({},t),e.children)}var BX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),S.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),S.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),OX=BX,FX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),S.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),MX=FX,LX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},e),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),UX=LX,VX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),GX=VX,WX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),S.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),S.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),jX=WX,zX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),S.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),S.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),HX=zX,ZX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),$X=ZX,XX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),KX=XX,JX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),YX=JX,qX=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),QX=qX,eK=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},e),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),tK=eK,nK=e=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},e),S.createElement("g",{fill:"currentColor"},S.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),S.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),rK=nK;function Qm(e){var t=e,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:s,exactMatch:a,track:l,requestPermissions:c,onError:u}=t,d=Wn(t,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=rg(),h=S.useCallback(b=>{f&&f.emit(ue.MediaDevicesError,b),u==null||u(b)},[f,u]),{devices:p,activeDeviceId:g,setActiveMediaDevice:C,className:v}=yX({kind:n,room:f,track:l,requestPermissions:c,onError:h});S.useEffect(()=>{r!==void 0&&C(r)},[C]),S.useEffect(()=>{typeof o=="function"&&o(p)},[o,p]),S.useEffect(()=>{g&&g!==""&&(i==null||i(g))},[g]);const m=b=>b3(this,null,function*(){try{yield C(b,{exact:a})}catch(k){if(k instanceof Error)s==null||s(k);else throw k}}),y=S.useMemo(()=>xu(d,{className:v},{className:"lk-list"}),[v,d]);function x(b,k,A){return b===k||A===0&&k==="default"}return S.createElement("ul",Me({},y),p.map((b,k)=>S.createElement("li",{key:b.deviceId,id:b.deviceId,"data-lk-active":x(b.deviceId,g,k),"aria-selected":x(b.deviceId,g,k),role:"option"},S.createElement("button",{className:"lk-button",onClick:()=>m(b.deviceId)},b.label))))}function k3(e,t){switch(e){case re.Source.Microphone:return t?S.createElement(HX,null):S.createElement(jX,null);case re.Source.Camera:return t?S.createElement(MX,null):S.createElement(OX,null);case re.Source.ScreenShare:return t?S.createElement(rK,null):S.createElement(tK,null);default:return}}function iK(e){switch(e){case fi.Excellent:return S.createElement($X,null);case fi.Good:return S.createElement(KX,null);case fi.Poor:return S.createElement(YX,null);default:return S.createElement(QX,null)}}function ev(e){var t=e,{showIcon:n}=t,r=Wn(t,["showIcon"]);const{buttonProps:i,enabled:o}=TX(r);return S.createElement("button",Me({},i),(n??!0)&&k3(r.source,o),r.children)}function oK(e){var t;const{className:n,quality:r}=uX(e),i=S.useMemo(()=>Jn(Me({},xu(e,{className:n})),{"data-lk-quality":r}),[r,e,n]);return S.createElement("div",Me({},i),(t=e.children)!=null?t:iK(r))}function sK(e){var t=e,{participant:n}=t,r=Wn(t,["participant"]);const i=zl(n),{className:o,infoObserver:s}=S.useMemo(()=>D$(i),[i]),{identity:a,name:l}=ni(s,{name:i.name,identity:i.identity,metadata:i.metadata}),c=S.useMemo(()=>xu(r,{className:o,"data-lk-participant-name":l}),[r,o,l]);return S.createElement("span",Me({},c),l!==""?l:a,r.children)}function aK(e){var t=e,{source:n,participant:r,trackRef:i,show:o="always"}=t,s=Wn(t,["source","participant","trackRef","show"]),a,l;const{className:c,isMuted:u}=EX(i??n,{participant:r}),d=o==="always"||o==="muted"&&u||o==="unmuted"&&!u,f=S.useMemo(()=>xu(s,{className:c}),[c,s]);return d?S.createElement("div",Jn(Me({},f),{"data-lk-muted":u}),(l=s.children)!=null?l:k3((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function lK(e){var t=e,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:o,name:s,publication:a,participant:l}=t,c=Wn(t,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,g,C,v,m,y;const x=Pf(),b=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=x==null?void 0:x.publication)==null?void 0:d.trackName)!=null?h:s,k=(g=(p=n==null?void 0:n.source)!=null?p:x==null?void 0:x.source)!=null?g:o,A=(v=(C=n==null?void 0:n.publication)!=null?C:x==null?void 0:x.publication)!=null?v:a,E=(y=(m=n==null?void 0:n.participant)!=null?m:x==null?void 0:x.participant)!=null?y:l;if(k===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const D=S.useRef(null),T=zl(E),{elementProps:R,isSubscribed:P,track:L,publication:z}=S3({source:k,name:b,participant:T,publication:A},{element:D,props:c});return S.useEffect(()=>{r==null||r(!!P)},[P,r]),S.useEffect(()=>{L===void 0||i===void 0||(L instanceof Cl?L.setVolume(i):Ct.warn("Volume can only be set on remote audio tracks."))},[i,L]),S.useEffect(()=>{z===void 0||c.muted===void 0||(z instanceof Lx?z.setEnabled(!c.muted):Ct.warn("Can only call setEnabled on remote track publications."))},[c.muted,z,L]),S.createElement("audio",Me({ref:D},R))}function cK(e){const t=!!tg();return e.participant&&!t?S.createElement(Yx.Provider,{value:e.participant},e.children):S.createElement(S.Fragment,null,e.children)}function uK({value:e,onPinChange:t,onWidgetChange:n,children:r}){const i=sX(e);return S.useEffect(()=>{Ct.debug("PinState Updated",{state:i.pin.state}),t&&i.pin.state&&t(i.pin.state)},[i.pin.state,t]),S.useEffect(()=>{Ct.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),S.createElement(Jx.Provider,{value:i},r)}function dK(e){const{room:t,htmlProps:n}=mX(e);return S.createElement("div",Me({},n),t&&S.createElement(qx.Provider,{value:t},S.createElement(lX.Provider,{value:e.featureFlags},e.children)))}function fK(e){var t=e,{participant:n,trackRef:r}=t,i=Wn(t,["participant","trackRef"]),o,s;const[a,l]=S.useState([]),c=200,u=90,d=6,f=4,h=50,p=7,g=(o=tg())!=null?o:n;let C=(s=Pf())!=null?s:r;if(!C){if(!g)throw Error("Participant missing, provide it directly or within a context");C={participant:g,source:re.Source.Microphone}}const{track:v}=RX(C);return S.useEffect(()=>{if(!v||!(v instanceof wr||v instanceof Cl))return;const{analyser:m,cleanup:y}=Uz(v,{smoothingTimeConstant:.8,fftSize:64}),x=new Uint8Array(m.frequencyBinCount),b=()=>{m.getByteFrequencyData(x);const A=new Array(p).fill(0);x.slice(1);const E=6;for(let D=0;D<p/2;D+=1){const T=Math.floor(p/2-D);for(let R=0;R<E;R+=1)A[T]+=Math.pow(x[D*E+R]/255,2);A[T]/=E}for(let D=0;D<p/2;D+=1){const T=Math.floor(p/2+D);if(A[T]===0){for(let R=0;R<E;R+=1)A[T]+=Math.pow(x[D*E+R]/255,2);A[T]/=E}}return A.map(D=>D*h)},k=setInterval(()=>{const A=b();l(A)},100);return()=>{clearInterval(k),y()}},[v]),S.createElement("svg",Jn(Me({width:"100%",height:"100%",viewBox:`0 0 ${c} ${u}`},i),{className:"lk-audio-visualizer"}),S.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),S.createElement("g",{style:{transform:`translate(${(c-p*(d+f))/2}px, 0)`}},a.map((m,y)=>S.createElement("rect",{key:y,x:y*(d+f),y:u/2-m/2,width:d,height:m}))))}function hK(e){var t=e,{participants:n}=t,r=Wn(t,["participants"]);return S.createElement(S.Fragment,null,n.map(i=>S.createElement(Yx.Provider,{value:i,key:i.identity},w3(r.children))))}function pK(e){var t=e,{participant:n,children:r,source:i,publication:o,disableSpeakingIndicator:s,onParticipantClick:a}=t,l=Wn(t,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const c=zl(n),{elementProps:u}=IX({participant:c,htmlProps:l,disableSpeakingIndicator:s,source:re.Source.Microphone,publication:o,onParticipantClick:a});return S.createElement("div",Me({style:{position:"relative"}},u),S.createElement(cK,{participant:c},r??S.createElement(S.Fragment,null,S.createElement(lK,{source:i??re.Source.Microphone}),S.createElement(fK,null),S.createElement("div",{className:"lk-participant-metadata"},S.createElement("div",{className:"lk-participant-metadata-item"},S.createElement(aK,{source:re.Source.Microphone}),S.createElement(sK,null)),S.createElement(oK,{className:"lk-participant-metadata-item"})))))}function gK(e){var t=e,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=t,s=Wn(t,["entry","hideName","hideTimestamp","messageFormatter"]),a,l,c,u;const d=S.useMemo(()=>o?o(n.message):n.message,[n.message,o]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return S.createElement("li",Me({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},s),(!i||!r)&&S.createElement("span",{className:"lk-meta-data"},!r&&S.createElement("strong",{className:"lk-participant-name"},(u=(l=n.from)==null?void 0:l.name)!=null?u:(c=n.from)==null?void 0:c.identity),!i&&S.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),S.createElement("span",{className:"lk-message-body"},d))}function mK(e){var t=e,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:o}=t,s=Wn(t,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=S.useRef(null),l=S.useRef(null),c=S.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:u,chatMessages:d,isSending:f}=_X(c),h=A3(),p=S.useRef(0);function g(C){return b3(this,null,function*(){C.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return S.useEffect(()=>{var C;l&&((C=l.current)==null||C.scrollTo({top:l.current.scrollHeight}))},[l,d]),S.useEffect(()=>{var C,v,m,y,x;if(!h||d.length===0)return;if((C=h.widget.state)!=null&&C.showChat&&d.length>0&&p.current!==((v=d[d.length-1])==null?void 0:v.timestamp)){p.current=(m=d[d.length-1])==null?void 0:m.timestamp;return}const b=d.filter(A=>!p.current||A.timestamp>p.current).length,{widget:k}=h;b>0&&((y=k.state)==null?void 0:y.unreadMessages)!==b&&((x=k.dispatch)==null||x.call(k,{msg:"unread_msg",count:b}))},[d,h==null?void 0:h.widget]),S.createElement("div",Jn(Me({},s),{className:"lk-chat"}),S.createElement("ul",{className:"lk-list lk-chat-messages",ref:l},s.children?d.map((C,v)=>w3(s.children,{entry:C,key:v,messageFormatter:n})):d.map((C,v,m)=>{const y=v>=1&&m[v-1].from===C.from,x=v>=1&&C.timestamp-m[v-1].timestamp<6e4;return S.createElement(gK,{key:v,hideName:y,hideTimestamp:y===!1?!1:x,entry:C,messageFormatter:n})})),S.createElement("form",{className:"lk-chat-form",onSubmit:g},S.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),S.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function lk(e){var t=e,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:s=!1}=t,a=Wn(t,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[l,c]=S.useState(!1),[u,d]=S.useState([]),[f,h]=S.useState(!0),p=(m,y)=>{Ct.debug("handle device change"),c(!1),i==null||i(m,y)},g=S.useRef(null),C=S.useRef(null);S.useLayoutEffect(()=>{g.current&&C.current&&(u||f)&&o$(g.current,C.current).then(({x:m,y})=>{C.current&&Object.assign(C.current.style,{left:`${m}px`,top:`${y}px`})}),h(!1)},[g,C,u,f]);const v=S.useCallback(m=>{C.current&&m.target!==g.current&&l&&s$(C.current,m)&&c(!1)},[l,C,g]);return S.useEffect(()=>(document.addEventListener("click",v),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",v),window.removeEventListener("resize",()=>h(!0))}),[v,h]),S.createElement(S.Fragment,null,S.createElement("button",Jn(Me({className:"lk-button lk-button-menu","aria-pressed":l},a),{onClick:()=>c(!l),ref:g}),a.children),!a.disabled&&S.createElement("div",{className:"lk-device-menu",ref:C,style:{visibility:l?"visible":"hidden"}},n?S.createElement(Qm,{initialSelection:r,onActiveDeviceChange:m=>p(n,m),onDeviceListChange:d,kind:n,track:o==null?void 0:o[n],requestPermissions:s}):S.createElement(S.Fragment,null,S.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),S.createElement(Qm,{kind:"audioinput",onActiveDeviceChange:m=>p("audioinput",m),onDeviceListChange:d,track:o==null?void 0:o.audioinput,requestPermissions:s}),S.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),S.createElement(Qm,{kind:"videoinput",onActiveDeviceChange:m=>p("videoinput",m),onDeviceListChange:d,track:o==null?void 0:o.videoinput,requestPermissions:s}))))}function vK(e){var t=e,{label:n}=t,r=Wn(t,["label"]);const i=ng(),{mergedProps:o,canPlayAudio:s}=wX({room:i,props:r}),{mergedProps:a,canPlayVideo:l}=SX({room:i,props:o}),c=a,{style:u}=c,d=Wn(c,["style"]);return u.display=s&&l?"none":"block",S.createElement("button",Me({style:u},d),n??`Start ${s?"Video":"Audio"}`)}function CK(e){var t=e,{variation:n,controls:r,saveUserChoices:i=!0}=t,o=Wn(t,["variation","controls","saveUserChoices"]),s,a,l,c,u;const[d,f]=S.useState(!1),h=A3();S.useEffect(()=>{var L,z;((L=h==null?void 0:h.widget.state)==null?void 0:L.showChat)!==void 0&&f((z=h==null?void 0:h.widget.state)==null?void 0:z.showChat)},[(s=h==null?void 0:h.widget.state)==null?void 0:s.showChat]);const g=nX(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=g);const C=Me({leave:!0},r),v=CX();v?((a=C.camera)!=null||(C.camera=v.canPublish),(l=C.microphone)!=null||(C.microphone=v.canPublish),(c=C.screenShare)!=null||(C.screenShare=v.canPublish),(u=C.chat)!=null||(C.chat=v.canPublishData&&(r==null?void 0:r.chat))):(C.camera=!1,C.chat=!1,C.microphone=!1,C.screenShare=!1);const m=S.useMemo(()=>n==="minimal"||n==="verbose",[n]),y=S.useMemo(()=>n==="textOnly"||n==="verbose",[n]),x=u$(),[b,k]=S.useState(!1),A=L=>{k(L)},E=xu({className:"lk-control-bar"},o),{saveAudioInputEnabled:D,saveVideoInputEnabled:T,saveAudioInputDeviceId:R,saveVideoInputDeviceId:P}=DX({preventSave:!i});return S.createElement("div",Me({},E),C.microphone&&S.createElement("div",{className:"lk-button-group"},S.createElement(ev,{source:re.Source.Microphone,showIcon:m,onChange:D},y&&"Microphone"),S.createElement("div",{className:"lk-button-group-menu"},S.createElement(lk,{kind:"audioinput",onActiveDeviceChange:(L,z)=>R(z??"")}))),C.camera&&S.createElement("div",{className:"lk-button-group"},S.createElement(ev,{source:re.Source.Camera,showIcon:m,onChange:T},y&&"Camera"),S.createElement("div",{className:"lk-button-group-menu"},S.createElement(lk,{kind:"videoinput",onActiveDeviceChange:(L,z)=>P(z??"")}))),C.screenShare&&x&&S.createElement(ev,{source:re.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:m,onChange:A},y&&(b?"Stop screen share":"Share screen")),C.chat&&S.createElement(PX,null,m&&S.createElement(UX,null),y&&"Chat"),C.leave&&S.createElement(NX,null,m&&S.createElement(GX,null),y&&"Leave"),S.createElement(vK,null))}function yK(e){var t=Wn(e,[]);const[n,r]=S.useState({showChat:!1,unreadMessages:0}),i=AX();return S.createElement(uK,{onWidgetChange:r},S.createElement("div",Me({className:"lk-audio-conference"},t),S.createElement("div",{className:"lk-audio-conference-stage"},S.createElement(hK,{participants:i},S.createElement(pK,null))),S.createElement(CK,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&S.createElement(mK,null)))}const xK="wss://mongoose-67t79p35.livekit.cloud",IK=({client:e})=>{const[t,n]=S.useState([]),[r,i]=S.useState(!1);return S.useEffect(()=>{const o=a=>{n(l=>[...l,a]),i(!0)},s=a=>{n(l=>{const c=l.filter(u=>u!==a);return c.length===0&&i(!1),c})};return e.on("livekitToken",o),e.on("livekitLeave",s),()=>{e.off("livekitToken",o),e.off("livekitLeave",s)}},[e]),t.length?G.jsxs("div",{"data-lk-theme":"default",children:[t.map((o,s)=>G.jsx(dK,{video:!1,audio:!0,token:o,serverUrl:xK,connect:!0,onDisconnected:()=>e.emit("livekitLeave",o),children:G.jsx(yK,{})},s)),G.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},Qx=({items:e,renderItem:t,listId:n,labelledBy:r,className:i="",itemClassName:o,getItemTextValue:s=l=>(l.name||l.id||"").toString().toLowerCase(),onSelectedIndexChange:a})=>{var p;const[l,c]=S.useState(-1),u=S.useRef(null),d=S.useCallback(g=>{c(g),a&&a(g)},[a]),f=()=>{l===-1&&e.length>0&&d(0)};S.useEffect(()=>{var g;if(l>=e.length&&d(e.length>0?0:-1),l!==-1&&e[l]){const C=`${n}-item-${(g=e[l])==null?void 0:g.id}`,v=document.getElementById(C);v&&v.scrollIntoView({block:"nearest"})}},[l,e,n]);const h=S.useCallback(g=>{if(e.length===0)return;let C=l,v=!0;switch(g.key){case"ArrowDown":C=(l+1)%e.length;break;case"ArrowUp":C=(l-1+e.length)%e.length;break;case"Home":C=0;break;case"End":C=e.length-1;break;case"PageUp":C=Math.max(l-5,0);break;case"PageDown":C=Math.min(l+5,e.length-1);break;default:if(g.key.length===1&&!g.ctrlKey&&!g.metaKey&&!g.altKey){const m=g.key.toLowerCase();let y=l===-1?0:(l+1)%e.length,x=-1;for(let b=0;b<e.length;b++){const k=(y+b)%e.length;if(s(e[k]).startsWith(m)){x=k;break}}x!==-1?C=x:v=!1}else v=!1;break}C!==l&&d(C),v&&g.preventDefault()},[l,e,s]);return G.jsx("div",{id:n,className:`accessible-list-container ${i}`,ref:u,tabIndex:0,role:"listbox","aria-labelledby":r,"aria-activedescendant":l!==-1?`${n}-item-${(p=e[l])==null?void 0:p.id}`:void 0,onFocus:f,onKeyDown:h,children:G.jsx("ul",{role:"none",className:"accessible-list-ul",children:e.map((g,C)=>{const v=C===l,m=t(g,C,v),y=o?o(g,C,v):"";return G.jsx("li",{id:`${n}-item-${g.id}`,className:`${y} ${v?"selected":""}`,role:"option","aria-selected":v,onClick:()=>d(C),children:m},g.id)})})})},bK=e=>({...e,id:e.Object}),AK=({users:e})=>{const t=e.map(bK),n=(o,s,a)=>{let l="Online";return o.away&&(l="Away"),o.idle&&(l==="Online"?l="Idle":l+=" + Idle"),G.jsxs(G.Fragment,{children:[o.Name,G.jsxs("span",{className:"sr-only",children:["",`(${l})`]})]})},r=(o,s,a)=>{let l="userlist-item";return o.away&&(l+=" away"),o.idle&&(l+=" idle"),l},i=o=>o.Name?o.Name.toLowerCase():"";return G.jsxs(G.Fragment,{children:[G.jsx("div",{className:"sidebar-header",id:"userlist-header","aria-hidden":"true",children:"Connected Players"}),G.jsxs("div",{className:"sidebar",children:[" ",G.jsxs("div",{className:"sidebar-content",children:[" ",G.jsx(Qx,{items:t,renderItem:n,listId:"userlist",labelledBy:"userlist-header",className:"userlist-accessible-container",itemClassName:r,getItemTextValue:i})]})]})]})},wK=({items:e,onItemSelected:t,listId:n,labelledBy:r})=>{const i=l=>{l>-1&&e[l]?t(e[l]):t(null)},o=(l,c,u)=>G.jsxs("span",{children:[" ",l.name]}),s=(l,c,u)=>"inventory-list-li",a=l=>l.name?l.name.toLowerCase():"";return G.jsx(Qx,{items:e,renderItem:o,listId:n,labelledBy:r,className:"inventory-accessible-list",itemClassName:s,getItemTextValue:a,onSelectedIndexChange:i})},E3=({item:e,onDrop:t,onWear:n,onRemove:r,onGet:i})=>{var u,d;const o=e.name,s=(u=e.Attrib)==null?void 0:u.includes("W"),a=(d=e.Attrib)==null?void 0:d.includes("w"),l=f=>{f.stopPropagation(),t&&t(e)},c=f=>{f.stopPropagation(),i&&i(e)};return G.jsxs("div",{className:"item-card",title:o,"data-item-id":e.id,children:[e.icon&&G.jsx("img",{src:e.icon,alt:"",className:"item-icon"}),G.jsxs("div",{className:"item-details",children:[" ",G.jsx("div",{className:"item-name",children:e.name})]}),G.jsxs("div",{className:"item-actions",children:[e.location==="room"&&i&&G.jsx("button",{className:"item-get-button",onClick:c,"aria-label":`Get ${e.name}`,tabIndex:0,accessKey:"g",children:"Get"}),e.location==="inv"&&s&&!a&&n&&G.jsx("button",{className:"item-wear-button",onClick:()=>n(e),"aria-label":`Wear ${e.name}`,tabIndex:0,accessKey:"w",children:"Wear"}),e.location==="inv"&&a&&r&&G.jsx("button",{className:"item-remove-button",onClick:()=>r(e),"aria-label":`Remove ${e.name}`,tabIndex:0,accessKey:"r",children:"Remove"}),e.location==="inv"&&t&&G.jsx("button",{className:"item-drop-button",onClick:l,"aria-label":`Drop ${e.name}`,tabIndex:0,accessKey:"d"})]})]})},SK=({client:e})=>{const[t,n]=S.useState([]),[r,i]=S.useState(null),o=S.useCallback((g,C)=>{g==="inv"&&(n(C),(C.length===0||!C.find(v=>v.id===(r==null?void 0:r.id)))&&i(null),e.emit("inventoryDataReceived"))},[e,r==null?void 0:r.id]),s=S.useCallback((g,C)=>{g==="inv"&&n(v=>{if(v.some(y=>y.id===C.id))return v;const m=[...v,C];return e.emit("inventoryDataReceived"),m})},[e]),a=S.useCallback((g,C)=>{g==="inv"&&n(v=>{const m=v.filter(y=>y.id!==C.id);return m.length<v.length&&e.emit("inventoryDataReceived"),(r==null?void 0:r.id)===C.id&&i(null),m})},[e,r==null?void 0:r.id]),l=S.useCallback((g,C)=>{g==="inv"&&(n(v=>v.map(m=>m.id===C.id?{...m,...C}:m)),(r==null?void 0:r.id)===C.id&&i(v=>v?{...v,...C}:null),e.emit("inventoryDataReceived"))},[e,r==null?void 0:r.id]);S.useEffect(()=>{const g=x=>o(x.location,x.items),C=x=>s(x.location,x.item),v=x=>a(x.location,x.item),m=x=>l(x.location,x.item);e.on("itemsList",g),e.on("itemAdd",C),e.on("itemRemove",v),e.on("itemUpdate",m);const y=e.gmcpHandlers["Char.Items"];return y!=null&&y.sendInventoryRequest&&y.sendInventoryRequest(),()=>{e.off("itemsList",g),e.off("itemAdd",C),e.off("itemRemove",v),e.off("itemUpdate",m)}},[e,o,s,a,l]);const c=g=>{i(g)},u=S.useCallback(g=>{e.sendCommand(`drop ${g.id}`)},[e]),d=S.useCallback(g=>{e.sendCommand(`wear ${g.id}`)},[e]),f=S.useCallback(g=>{e.sendCommand(`remove ${g.id}`)},[e]),h="inventory-heading";return G.jsxs("div",{className:"inventory-tab-content",role:"region","aria-labelledby":h,children:[G.jsx("h4",{id:h,tabIndex:-1,children:"Inventory"}),t.length===0?G.jsx("p",{children:"Your inventory is empty."}):G.jsx(wK,{items:t,onItemSelected:c,listId:"inventory-listbox",labelledBy:h}),r&&G.jsx("div",{className:"selected-item-card-container",style:{marginTop:"1rem"},children:G.jsx(E3,{item:r,onDrop:u,onWear:d,onRemove:f})})]})};function df(e,t,n){const[r,i]=S.useState(n);return S.useEffect(()=>{if(!e)return i(n),()=>{};const o=s=>{i(s)};return e.on(t,o),()=>{e.off(t,o)}},[e,t,n]),r}const kK=({client:e})=>{const[t,n]=S.useState(e.currentRoomInfo),[r,i]=S.useState([]),[o,s]=S.useState(null),a=e.gmcpHandlers["Char.Items"],l=S.useCallback(k=>{n(k)},[]);S.useEffect(()=>(e.on("roomInfo",l),a!=null&&a.sendRoomRequest&&a.sendRoomRequest(),()=>{e.off("roomInfo",l)}),[e,a,l]);const c=S.useCallback((k,A)=>{k==="room"&&(i(A),o&&!A.find(E=>E.id===o.id)&&s(null))},[o]),u=S.useCallback((k,A)=>{k==="room"&&i(E=>E.some(D=>D.id===A.id)?E:[...E,A])},[]),d=S.useCallback((k,A)=>{k==="room"&&(i(E=>E.filter(D=>D.id!==A.id)),(o==null?void 0:o.id)===A.id&&s(null))},[o]);S.useEffect(()=>{const k=D=>c(D.location,D.items),A=D=>u(D.location,D.item),E=D=>d(D.location,D.item);return e.on("itemsList",k),e.on("itemAdd",A),e.on("itemRemove",E),()=>{e.off("itemsList",k),e.off("itemAdd",A),e.off("itemRemove",E)}},[e,c,u,d]);const f=k=>{e.sendCommand(k)},h=k=>{s(k>-1&&r[k]?r[k]:null)},p=S.useCallback(k=>{e.sendCommand(`get ${k.id}`)},[e]),g=k=>G.jsx("span",{children:k.name}),C=()=>"room-item-li",v=k=>k.name.toLowerCase(),m="room-info-heading",y="room-contents-heading",x="room-contents-list";if(!t&&r.length===0)return G.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":m,children:[G.jsx("h4",{id:m,children:"Room Info"}),G.jsx("p",{children:"Waiting for room data..."})]});const b=t!=null&&t.exits?Object.entries(t.exits).sort(([k],[A])=>k.localeCompare(A)):[];return G.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":m,children:[t&&G.jsxs(G.Fragment,{children:[G.jsx("h4",{id:m,children:t.name||"Current Room"}),t.area&&G.jsxs("p",{className:"room-area",children:["Area: ",t.area]}),b.length>0&&G.jsxs("div",{className:"room-exits",children:[G.jsx("h5",{children:"Exits"}),G.jsx("ul",{"aria-label":"Room Exits",children:b.map(([k,A])=>G.jsx("li",{children:G.jsx("button",{onClick:()=>f(k),title:`Go ${k} (to room ${A})`,"aria-label":`Go ${k}`,children:k.toUpperCase()})},k))})]})]}),G.jsxs("div",{className:"room-contents-section",children:[G.jsx("h5",{id:y,tabIndex:-1,children:"Contents"}),r.length===0?G.jsx("p",{children:"Nothing on the ground."}):G.jsx(Qx,{items:r,renderItem:g,listId:x,labelledBy:y,className:"room-items-accessible-list",itemClassName:C,getItemTextValue:v,onSelectedIndexChange:h})]}),o&&G.jsx("div",{className:"selected-room-item-card-container",style:{marginTop:"1rem"},children:G.jsx(E3,{item:o,onGet:p})})]})},EK=Le.forwardRef(({client:e},t)=>{const n=df(e,"userlist",[]),[r,i]=S.useState(!0),[o,s]=S.useState(!1),[a,l]=S.useState(!!e.currentRoomInfo);S.useEffect(()=>{const d=()=>s(!0);return e.on("itemsList",d),()=>{e.off("itemsList",d)}},[e]),S.useEffect(()=>{const d=()=>{a||l(!0)};return e.on("roomInfo",d),()=>{e.off("roomInfo",d)}},[e,a]);const c=[{id:"room-tab",label:"Room",content:G.jsx(kK,{client:e}),condition:a},{id:"inventory-tab",label:"Inventory",content:G.jsx(SK,{client:e}),condition:o},{id:"users-tab",label:"Users",content:G.jsx(AK,{users:n}),condition:!0},{id:"files-tab",label:"Files",content:G.jsx(ij,{client:e,expanded:r}),condition:!0},{id:"audio-tab",label:"Audio",content:G.jsx(IK,{client:e}),condition:!0}],u=Le.useMemo(()=>c.filter(d=>d.condition??!0),[a,o]);return Le.useImperativeHandle(t,()=>({switchToTab:d=>{var f;if(d>=0&&d<u.length){const h=(f=u[d])==null?void 0:f.id;if(h){console.log(`switchToTab: Trying index ${d}, ID: ${h}`);const p=document.getElementById(h);p?(console.log("switchToTab: Found button element, attempting click..."),p.click(),console.log("switchToTab: Click simulation finished.")):console.error(`switchToTab: Could not find button element with ID: ${h}`)}else console.warn(`switchToTab: Could not determine targetTabId for index ${d}. Visible tabs:`,u)}else console.warn(`switchToTab: Invalid targetIndex ${d}. Visible tabs count: ${u.length}`)}}),[u]),S.useEffect(()=>{const d=()=>i(!0);return e.on("fileTransferOffer",d),()=>{e.off("fileTransferOffer",d)}},[e]),G.jsxs("div",{className:"sidebar",children:[" ",G.jsxs("div",{className:"sidebar-content",children:[G.jsx(N_,{tabs:u})," "]})]})}),TK=({client:e})=>{const[t,n]=S.useState("Not connected"),[r,i]=S.useState(null),o=S.useCallback(f=>n(f),[]),s=S.useCallback(()=>n("Connected"),[]),a=S.useCallback(()=>{n("Disconnected"),i(null)},[]),l=S.useCallback(f=>i(f),[]);S.useEffect(()=>(e.on("statustext",o),e.on("connect",s),e.on("disconnect",a),e.on("vitals",l),()=>{e.off("statustext",o),e.off("connect",s),e.off("disconnect",a),e.off("vitals",l)}),[e,o,s,a,l]);const c=(f,h)=>f===void 0||h===void 0?null:`${f}/${h}`,u=c(r==null?void 0:r.hp,r==null?void 0:r.maxhp),d=c(r==null?void 0:r.mp,r==null?void 0:r.maxmp);return G.jsxs("div",{className:"statusbar",children:[G.jsx("span",{className:"status-connection",children:t}),r&&G.jsxs("span",{className:"status-vitals",children:[u&&` HP: ${u}`,d&&` MP: ${d}`]})]})};var T3={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ck=Le.createContext&&Le.createContext(T3),RK=["attr","size","title"];function _K(e,t){if(e==null)return{};var n=DK(e,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function DK(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function up(){return up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},up.apply(this,arguments)}function uk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function dp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uk(Object(n),!0).forEach(function(r){PK(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uk(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PK(e,t,n){return t=NK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NK(e){var t=BK(e,"string");return typeof t=="symbol"?t:t+""}function BK(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R3(e){return e&&e.map((t,n)=>Le.createElement(t.tag,dp({key:n},t.attr),R3(t.child)))}function ro(e){return t=>Le.createElement(OK,up({attr:dp({},e.attr)},t),R3(e.child))}function OK(e){var t=n=>{var{attr:r,size:i,title:o}=e,s=_K(e,RK),a=i||n.size||"1em",l;return n.className&&(l=n.className),e.className&&(l=(l?l+" ":"")+e.className),Le.createElement("svg",up({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:l,style:dp(dp({color:e.color||n.color},n.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&Le.createElement("title",null,o),e.children)};return ck!==void 0?Le.createElement(ck.Consumer,null,n=>t(n)):t(T3)}function FK(e){return ro({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function MK(e){return ro({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(e)}function LK(e){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function UK(e){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(e)}function VK(e){return ro({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(e)}function GK(e){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function WK(e){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(e)}function _3(e){return ro({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function jK(e){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(e)}function zK(e){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(e)}function HK(e){return ro({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(e)}const ZK=({client:e,onClearLog:t,onSaveLog:n,onCopyLog:r,onToggleSidebar:i,onOpenPrefs:o,showSidebar:s})=>{const a=df(e,"connectionChange",e.connected),[l,c]=Le.useState(e.cacophony.muted),u=df(e,"autosayChanged",e.autosay)||!1,[d,f]=Le.useState(Yr.getState().general.volume),h=S.useCallback(()=>{c(!l),e.cacophony.muted=!l},[l,e]),p=S.useCallback(v=>{const m=Number(v.target.value)/100;f(m),e.cacophony.setGlobalVolume(m),Yr.dispatch({type:Lo.SetGeneral,data:{...Yr.getState().general,volume:m}})},[e]),g=S.useCallback(v=>{e.autosay=v.target.checked},[e]),C=S.useCallback(()=>{a?e.close():e.connect()},[a,e]);return G.jsxs("div",{className:"toolbar",children:[G.jsxs("button",{onClick:n,accessKey:"l",children:[G.jsx(_3,{}),"Save Log (Alt+L)"]}),G.jsxs("button",{onClick:r,accessKey:"C",children:[G.jsx(VK,{}),"Copy Log (Alt+Shift+C)"]}),G.jsxs("button",{onClick:t,accessKey:"E",children:[" ",G.jsx(WK,{}),"Clear Log (Alt+E)"]}),G.jsxs("button",{onClick:o,accessKey:"p",children:[G.jsx(LK,{}),"Preferences (Alt+P)"]}),G.jsxs("button",{onClick:h,accessKey:"M",children:[l?G.jsx(HK,{}):G.jsx(zK,{}),l?"Unmute":"Mute"]}),G.jsxs("label",{children:["Volume",G.jsx("input",{type:"range",min:"0",max:"100",value:d*100,onChange:p,accessKey:"V"})]}),G.jsxs("label",{children:[G.jsx(UK,{}),"Autosay",G.jsx("input",{type:"checkbox",checked:u,onChange:g})]}),G.jsx("button",{onClick:C,children:a?"Disconnect":"Connect"}),G.jsxs("button",{onClick:i,accessKey:"U",title:s?"Hide Sidebar (Alt+U)":"Show Sidebar (Alt+U)","aria-label":s?"Hide Sidebar":"Show Sidebar","aria-expanded":s,children:[s?G.jsx(MK,{}):G.jsx(FK,{}),s?"Hide Sidebar":"Show Sidebar"]})]})};function $K(){const[e,t]=S.useState(null),[n,r]=S.useState(!1),[i,o]=S.useState(!1),[s,a]=S.useState(!1);df(e,"userlist",[]);const l=Le.useRef(null),c=Le.useRef(null),u=Le.useRef(null),d=Le.useRef(null),f=S.useRef(!1),h=()=>{l.current&&l.current.saveLog()},p=()=>{l.current&&l.current.clearLog()},g=()=>{l.current&&l.current.copyLog()},C=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);S.useEffect(()=>{if(f.current)return;const x=new r7("mongoose.moo.mud.org",8765);x.registerGMCPPackage(s9),x.registerGMCPPackage(n9),x.registerGMCPPackage(r9),x.registerGMCPPackage(JO),x.registerGMCPPackage(a9),x.registerGMCPPackage(i9),x.registerGMCPPackage(o9),x.registerGMCPPackage(iO),x.registerGMCPPackage($O),x.registerGMCPPackage(QT),x.registerGMCPPackage(u9),x.registerGMCPPackage(aO),x.registerGMCPPackage(qT),x.registerGMCPPackage(oO),x.registerGMCPPackage(sO),x.registerGMCPPackage(lO),x.registerGMCPPackage(cO),x.registerGMCPPackage(uO),x.registerGMCPPackage(l9),x.registerGMCPPackage(c9),x.registerGMCPPackage(d9),x.registerGMCPPackage(f9),x.registerGMCPPackage(h9),x.registerGMCPPackage(p9),x.registerGMCPPackage(g9),x.registerMcpPackage(y9),x.registerMcpPackage(x9),x.registerMcpPackage(b9),x.registerMcpPackage(A9),x.connect(),x.requestNotificationPermission(),t(x),r(!C),window.mudClient=x,f.current=!0;const b=A=>{x&&(A.key==="Control"&&x.cancelSpeech(),A.key==="Escape"&&x.stopAllSounds())};window.addEventListener("keydown",b);const k=()=>{var A;(A=c.current)==null||A.focus()};return document.addEventListener("focus",k),()=>{window.removeEventListener("keydown",b),document.removeEventListener("focus",k)}},[C]),S.useEffect(()=>{const x=b=>{var A;if(!n||!b.ctrlKey)return;const k=parseInt(b.key,10);if(!isNaN(k)&&k>=1&&k<=9){const E=k-1;b.preventDefault(),console.log(`App: Detected CTRL+${k}, calling switchToTab(${E})`),(A=d.current)==null||A.switchToTab(E)}};return document.addEventListener("keydown",x,!0),()=>{document.removeEventListener("keydown",x,!0)}},[n]);const v=df(e,"fileTransferOffer",null),m=S.useCallback(x=>{e&&e.sendCommand(x)},[e]),y=S.useCallback(()=>{var x;(x=c.current)==null||x.focus()},[]);return S.useEffect(()=>{v!==null&&(a(!0),o(!0),e==null||e.sendNotification("File Transfer Offer",`${v.sender} wants to send you ${v.filename} (${Math.round(v.filesize/1024)} KB)`))},[v,e]),KT(x=>{e&&e.shutdown()}),S.useEffect(()=>{var x;(x=c.current)==null||x.focus()},[]),e?G.jsxs("div",{className:`App ${n?"sidebar-shown":""}`,children:[G.jsx("header",{role:"banner",style:{gridArea:"header"},children:G.jsx(ZK,{client:e,onSaveLog:h,onClearLog:p,onCopyLog:g,onToggleSidebar:()=>r(!n),onOpenPrefs:()=>{var x;return(x=u.current)==null?void 0:x.open()},showSidebar:n})}),G.jsx("main",{role:"main",style:{gridArea:"main"},children:G.jsx(FC,{client:e,ref:l,focusInput:y})}),G.jsx("div",{role:"region","aria-label":"Command input",style:{gridArea:"input"},children:G.jsx(a7,{onSend:m,inputRef:c})}),n&&G.jsx("aside",{role:"complementary","aria-roledescription":"Sidebar",style:{gridArea:"sidebar"},children:G.jsx(EK,{ref:d,client:e})}),G.jsx("footer",{role:"contentinfo",style:{gridArea:"status"},children:G.jsx(TK,{client:e})}),G.jsx(QW,{ref:u})]}):null}function XK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function fk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dk(Object(n),!0).forEach(function(r){XK(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dk(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,o;for(o=0;o<r.length;o++)i=r[o],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function JK(e,t){if(e==null)return{};var n=KK(e,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YK(e,t){return qK(e)||QK(e,t)||eJ(e,t)||tJ()}function qK(e){if(Array.isArray(e))return e}function QK(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,i=!1,o=void 0;try{for(var s=e[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(t&&n.length===t));r=!0);}catch(l){i=!0,o=l}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw o}}return n}}function eJ(e,t){if(e){if(typeof e=="string")return hk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hk(e,t)}}function hk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nJ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function gk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pk(Object(n),!0).forEach(function(r){nJ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pk(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rJ(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(i,o){return o(i)},r)}}function ld(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return t.apply(n,[].concat(i,a))}}}function fp(e){return{}.toString.call(e).includes("Object")}function iJ(e){return!Object.keys(e).length}function ff(e){return typeof e=="function"}function oJ(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function sJ(e,t){return fp(t)||Ba("changeType"),Object.keys(t).some(function(n){return!oJ(e,n)})&&Ba("changeField"),t}function aJ(e){ff(e)||Ba("selectorType")}function lJ(e){ff(e)||fp(e)||Ba("handlerType"),fp(e)&&Object.values(e).some(function(t){return!ff(t)})&&Ba("handlersType")}function cJ(e){e||Ba("initialIsRequired"),fp(e)||Ba("initialType"),iJ(e)&&Ba("initialContent")}function uJ(e,t){throw new Error(e[t]||e.default)}var dJ={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Ba=ld(uJ)(dJ),ph={changes:sJ,selector:aJ,handler:lJ,initial:cJ};function fJ(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ph.initial(e),ph.handler(t);var n={current:e},r=ld(gJ)(n,t),i=ld(pJ)(n),o=ld(ph.changes)(e),s=ld(hJ)(n);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return ph.selector(c),c(n.current)}function l(c){rJ(r,i,o,s)(c)}return[a,l]}function hJ(e,t){return ff(t)?t(e.current):t}function pJ(e,t){return e.current=gk(gk({},e.current),t),t}function gJ(e,t,n){return ff(t)?t(e.current):Object.keys(n).forEach(function(r){var i;return(i=t[r])===null||i===void 0?void 0:i.call(t,e.current[r])}),n}var mJ={create:fJ},vJ={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function CJ(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return t.apply(n,[].concat(i,a))}}}function yJ(e){return{}.toString.call(e).includes("Object")}function xJ(e){return e||mk("configIsRequired"),yJ(e)||mk("configType"),e.urls?(IJ(),{paths:{vs:e.urls.monacoBase}}):e}function IJ(){console.warn(D3.deprecation)}function bJ(e,t){throw new Error(e[t]||e.default)}var D3={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},mk=CJ(bJ)(D3),AJ={config:xJ},wJ=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(o,s){return s(o)},i)}};function P3(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],P3(e[n],t[n]))}),fk(fk({},e),t)}var SJ={type:"cancelation",msg:"operation is manually canceled"};function tv(e){var t=!1,n=new Promise(function(r,i){e.then(function(o){return t?i(SJ):r(o)}),e.catch(i)});return n.cancel=function(){return t=!0},n}var kJ=mJ.create({config:vJ,isInitialized:!1,resolve:null,reject:null,monaco:null}),N3=YK(kJ,2),Bf=N3[0],ig=N3[1];function EJ(e){var t=AJ.config(e),n=t.monaco,r=JK(t,["monaco"]);ig(function(i){return{config:P3(i.config,r),monaco:n}})}function TJ(){var e=Bf(function(t){var n=t.monaco,r=t.isInitialized,i=t.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!e.isInitialized){if(ig({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),tv(nv);if(window.monaco&&window.monaco.editor)return B3(window.monaco),e.resolve(window.monaco),tv(nv);wJ(RJ,DJ)(PJ)}return tv(nv)}function RJ(e){return document.body.appendChild(e)}function _J(e){var t=document.createElement("script");return e&&(t.src=e),t}function DJ(e){var t=Bf(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),n=_J("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function PJ(){var e=Bf(function(n){var r=n.config,i=n.resolve,o=n.reject;return{config:r,resolve:i,reject:o}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){B3(n),e.resolve(n)},function(n){e.reject(n)})}function B3(e){Bf().monaco||ig({monaco:e})}function NJ(){return Bf(function(e){var t=e.monaco;return t})}var nv=new Promise(function(e,t){return ig({resolve:e,reject:t})}),O3={config:EJ,init:TJ,__getMonacoInstance:NJ},BJ={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},rv=BJ,OJ={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},FJ=OJ;function MJ({children:e}){return Le.createElement("div",{style:FJ.container},e)}var LJ=MJ,UJ=LJ;function VJ({width:e,height:t,isEditorReady:n,loading:r,_ref:i,className:o,wrapperProps:s}){return Le.createElement("section",{style:{...rv.wrapper,width:e,height:t},...s},!n&&Le.createElement(UJ,null,r),Le.createElement("div",{ref:i,style:{...rv.fullWidth,...!n&&rv.hide},className:o}))}var GJ=VJ,F3=S.memo(GJ);function WJ(e){S.useEffect(e,[])}var M3=WJ;function jJ(e,t,n=!0){let r=S.useRef(!0);S.useEffect(r.current||!n?()=>{r.current=!1}:e,t)}var Xr=jJ;function kd(){}function vc(e,t,n,r){return zJ(e,r)||HJ(e,t,n,r)}function zJ(e,t){return e.editor.getModel(L3(e,t))}function HJ(e,t,n,r){return e.editor.createModel(t,n,r?L3(e,r):void 0)}function L3(e,t){return e.Uri.parse(t)}function ZJ({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:g={},beforeMount:C=kd,onMount:v=kd}){let[m,y]=S.useState(!1),[x,b]=S.useState(!0),k=S.useRef(null),A=S.useRef(null),E=S.useRef(null),D=S.useRef(v),T=S.useRef(C),R=S.useRef(!1);M3(()=>{let Z=O3.init();return Z.then(Q=>(A.current=Q)&&b(!1)).catch(Q=>(Q==null?void 0:Q.type)!=="cancelation"&&console.error("Monaco initialization: error:",Q)),()=>k.current?z():Z.cancel()}),Xr(()=>{if(k.current&&A.current){let Z=k.current.getOriginalEditor(),Q=vc(A.current,e||"",r||n||"text",o||"");Q!==Z.getModel()&&Z.setModel(Q)}},[o],m),Xr(()=>{if(k.current&&A.current){let Z=k.current.getModifiedEditor(),Q=vc(A.current,t||"",i||n||"text",s||"");Q!==Z.getModel()&&Z.setModel(Q)}},[s],m),Xr(()=>{let Z=k.current.getModifiedEditor();Z.getOption(A.current.editor.EditorOption.readOnly)?Z.setValue(t||""):t!==Z.getValue()&&(Z.executeEdits("",[{range:Z.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),Z.pushUndoStop())},[t],m),Xr(()=>{var Z,Q;(Q=(Z=k.current)==null?void 0:Z.getModel())==null||Q.original.setValue(e||"")},[e],m),Xr(()=>{let{original:Z,modified:Q}=k.current.getModel();A.current.editor.setModelLanguage(Z,r||n||"text"),A.current.editor.setModelLanguage(Q,i||n||"text")},[n,r,i],m),Xr(()=>{var Z;(Z=A.current)==null||Z.editor.setTheme(c)},[c],m),Xr(()=>{var Z;(Z=k.current)==null||Z.updateOptions(d)},[d],m);let P=S.useCallback(()=>{var ie;if(!A.current)return;T.current(A.current);let Z=vc(A.current,e||"",r||n||"text",o||""),Q=vc(A.current,t||"",i||n||"text",s||"");(ie=k.current)==null||ie.setModel({original:Z,modified:Q})},[n,t,i,e,r,o,s]),L=S.useCallback(()=>{var Z;!R.current&&E.current&&(k.current=A.current.editor.createDiffEditor(E.current,{automaticLayout:!0,...d}),P(),(Z=A.current)==null||Z.editor.setTheme(c),y(!0),R.current=!0)},[d,c,P]);S.useEffect(()=>{m&&D.current(k.current,A.current)},[m]),S.useEffect(()=>{!x&&!m&&L()},[x,m,L]);function z(){var Q,ie,$,q;let Z=(Q=k.current)==null?void 0:Q.getModel();a||((ie=Z==null?void 0:Z.original)==null||ie.dispose()),l||(($=Z==null?void 0:Z.modified)==null||$.dispose()),(q=k.current)==null||q.dispose()}return Le.createElement(F3,{width:h,height:f,isEditorReady:m,loading:u,_ref:E,className:p,wrapperProps:g})}var $J=ZJ;S.memo($J);function XJ(e){let t=S.useRef();return S.useEffect(()=>{t.current=e},[e]),t.current}var KJ=XJ,gh=new Map;function JJ({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:i,path:o,theme:s="light",line:a,loading:l="Loading...",options:c={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:g,wrapperProps:C={},beforeMount:v=kd,onMount:m=kd,onChange:y,onValidate:x=kd}){let[b,k]=S.useState(!1),[A,E]=S.useState(!0),D=S.useRef(null),T=S.useRef(null),R=S.useRef(null),P=S.useRef(m),L=S.useRef(v),z=S.useRef(),Z=S.useRef(r),Q=KJ(o),ie=S.useRef(!1),$=S.useRef(!1);M3(()=>{let O=O3.init();return O.then(j=>(D.current=j)&&E(!1)).catch(j=>(j==null?void 0:j.type)!=="cancelation"&&console.error("Monaco initialization: error:",j)),()=>T.current?te():O.cancel()}),Xr(()=>{var j,J,ee,se;let O=vc(D.current,e||r||"",t||i||"",o||n||"");O!==((j=T.current)==null?void 0:j.getModel())&&(d&&gh.set(Q,(J=T.current)==null?void 0:J.saveViewState()),(ee=T.current)==null||ee.setModel(O),d&&((se=T.current)==null||se.restoreViewState(gh.get(o))))},[o],b),Xr(()=>{var O;(O=T.current)==null||O.updateOptions(c)},[c],b),Xr(()=>{!T.current||r===void 0||(T.current.getOption(D.current.editor.EditorOption.readOnly)?T.current.setValue(r):r!==T.current.getValue()&&($.current=!0,T.current.executeEdits("",[{range:T.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),T.current.pushUndoStop(),$.current=!1))},[r],b),Xr(()=>{var j,J;let O=(j=T.current)==null?void 0:j.getModel();O&&i&&((J=D.current)==null||J.editor.setModelLanguage(O,i))},[i],b),Xr(()=>{var O;a!==void 0&&((O=T.current)==null||O.revealLine(a))},[a],b),Xr(()=>{var O;(O=D.current)==null||O.editor.setTheme(s)},[s],b);let q=S.useCallback(()=>{var O;if(!(!R.current||!D.current)&&!ie.current){L.current(D.current);let j=o||n,J=vc(D.current,r||e||"",t||i||"",j||"");T.current=(O=D.current)==null?void 0:O.editor.create(R.current,{model:J,automaticLayout:!0,...c},u),d&&T.current.restoreViewState(gh.get(j)),D.current.editor.setTheme(s),a!==void 0&&T.current.revealLine(a),k(!0),ie.current=!0}},[e,t,n,r,i,o,c,u,d,s,a]);S.useEffect(()=>{b&&P.current(T.current,D.current)},[b]),S.useEffect(()=>{!A&&!b&&q()},[A,b,q]),Z.current=r,S.useEffect(()=>{var O,j;b&&y&&((O=z.current)==null||O.dispose(),z.current=(j=T.current)==null?void 0:j.onDidChangeModelContent(J=>{$.current||y(T.current.getValue(),J)}))},[b,y]),S.useEffect(()=>{if(b){let O=D.current.editor.onDidChangeMarkers(j=>{var ee;let J=(ee=T.current.getModel())==null?void 0:ee.uri;if(J&&j.find(se=>se.path===J.path)){let se=D.current.editor.getModelMarkers({resource:J});x==null||x(se)}});return()=>{O==null||O.dispose()}}return()=>{}},[b,x]);function te(){var O,j;(O=z.current)==null||O.dispose(),f?d&&gh.set(o,T.current.saveViewState()):(j=T.current.getModel())==null||j.dispose(),T.current.dispose()}return Le.createElement(F3,{width:h,height:p,isEditorReady:b,loading:l,_ref:R,className:g,wrapperProps:C})}var YJ=JJ,qJ=S.memo(YJ),QJ=qJ,eY={restoreOnUnmount:!1};function tY(e,t){t===void 0&&(t=eY);var n=S.useRef(document.title);document.title!==e&&(document.title=e),S.useEffect(function(){if(t&&t.restoreOnUnmount)return function(){document.title=n.current}},[])}const nY=typeof document<"u"?tY:function(e){};function rY({onSave:e,onRevert:t,onDownload:n}){return G.jsx("div",{className:"editor-toolbar",children:G.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[G.jsxs("button",{onClick:e,accessKey:"s",title:"Save (Alt+S)",children:[G.jsx(_3,{"aria-hidden":"true"}),"Save"]}),G.jsxs("button",{onClick:t,accessKey:"r",title:"Revert (Alt+R)",children:[G.jsx(jK,{"aria-hidden":"true"}),"Revert"]}),G.jsxs("button",{onClick:n,accessKey:"d",title:"Download (Alt+D)",children:[G.jsx(GK,{"aria-hidden":"true"}),"Download"]})]})})}const iY=({docstate:e,session:t})=>G.jsxs("div",{"aria-live":"polite",className:"editor-statusbar",children:[G.jsx("span",{children:e}),G.jsx("span",{"aria-hidden":"true",children:"|"}),G.jsx("span",{children:t.reference}),G.jsx("span",{"aria-hidden":"true",children:"|"}),G.jsx("span",{children:t.type})]});function oY(){const e=$T(),t=Le.useRef(null),[n,r]=S.useState(""),[i,o]=S.useState(""),[s,a]=S.useState(""),[l,c]=S.useState(0),[u,d]=S.useState({name:"none",contents:[],reference:"",type:""}),f=(L,z)=>{t.current=L},[h,p]=zs();console.log(h);const g=h.editor.accessibilityMode,C=h.editor.autocompleteEnabled;KT(L=>{b.postMessage({type:"close",id:A}),l===1&&L.preventDefault()});const[v,m]=S.useState(!1),y=v?`${u.name} - Mongoose Editor`:"Mongoose Editor";nY(y);const x=S.useMemo(()=>{switch(l){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[l]),b=S.useMemo(()=>new BroadcastChannel("editor"),[]),k=new URLSearchParams(e.search),A=decodeURIComponent(k.get("reference")||"");S.useEffect(()=>{if(!A)return;console.log("ID: "+A),console.log("Sending ready message"),b.postMessage({type:"ready",id:A});const L=z=>{switch(console.log(z.data),z.data.type){case"load":if(n!=="")return;const Z=z.data.session.contents.join(`
`);o(Z),a(Z),d(z.data.session),c(0),r(z.data.clientId),m(!0),setTimeout(P,100);break;case"shutdown":if(console.log("Received shutdown message"),l===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;b.close(),window.close();break;default:console.warn("Unknown message type received",z.data.type)}};return b.addEventListener("message",L),()=>{b.removeEventListener("message",L),b.postMessage({type:"close",id:A})}},[b,n,A,l]);const E=()=>{o(s),c(0)},D=L=>{const z=i.split(/\r\n|\r|\n/),Z={...u,contents:z};b.postMessage({type:"save",session:Z,id:A}),c(2),P(),L.preventDefault()},T=L=>{L!==void 0&&(console.log("Original: "+s),console.log("New: "+L),o(L),L.split(/\r\n|\r|\n/).join(`
`)!==s?c(1):c(0),v||m(!0))},R=()=>{const L=new Blob([i],{type:"text/plain"}),z=URL.createObjectURL(L),Z=document.createElement("a"),Q=new Date,ie=Q.toLocaleDateString().replace(/\//g,"-"),$=Q.toLocaleTimeString().replace(/:/g,"-"),q=`${u.name}-${ie}-${$}.txt`;Z.download=q,Z.href=z,Z.click(),URL.revokeObjectURL(z),Z.remove()};return G.jsxs("div",{id:"editor-window",children:[G.jsx(rY,{onSave:D,onRevert:E,onDownload:R}),G.jsx(QJ,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:T,options:{wordWrap:"on",accessibilitySupport:g?"on":"off",quickSuggestions:C},onMount:f,path:u.reference}),G.jsx(iY,{docstate:x,session:u})]});function P(){t.current!==null&&t.current.focus()}}const sY="modulepreload",aY=function(e){return"/"+e},vk={},U3=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=aY(l),l in vk)return;vk[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":sY,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return t().catch(o)})},lY=e=>{e&&e instanceof Function&&U3(async()=>{const{getCLS:t,getFID:n,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-CFnx-5Zt.js");return{getCLS:t,getFID:n,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:t,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{t(e),n(e),r(e),i(e),o(e)})};function cY(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:s}=e;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await U3(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{s==null||s(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||r==null||r()}),a.register({immediate:t}).then(d=>{o?o("/sw.js",d):i==null||i(d)}).catch(d=>{s==null||s(d)})}}return l=u(),c}const uY=D4([{path:"/",element:G.jsx($K,{})},{path:"/editor",element:G.jsx(oY,{})}]),dY=ov.createRoot(document.getElementById("root"));dY.render(G.jsx(Le.StrictMode,{children:G.jsx(V4,{router:uY})}));lY(console.log);cY();

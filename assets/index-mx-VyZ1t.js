var xR=Object.defineProperty;var Ew=n=>{throw TypeError(n)};var wR=(n,e,t)=>e in n?xR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ae=(n,e,t)=>wR(n,typeof e!="symbol"?e+"":e,t),ev=(n,e,t)=>e.has(n)||Ew("Cannot "+t);var ue=(n,e,t)=>(ev(n,e,"read from private field"),t?t.call(n):e.get(n)),Rn=(n,e,t)=>e.has(n)?Ew("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),en=(n,e,t,r)=>(ev(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Mt=(n,e,t)=>(ev(n,e,"access private method"),t);var h0=(n,e,t,r)=>({set _(i){en(n,e,i,t)},get _(){return ue(n,e,r)}});function mA(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var R0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function IR(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var tv={exports:{}},af={},nv={exports:{}},Sn={},Tw;function bR(){if(Tw)return Sn;Tw=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),v=Symbol.iterator;function m(H){return H===null||typeof H!="object"?null:(H=v&&H[v]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,x={};function b(H,ee,ce){this.props=H,this.context=ee,this.refs=x,this.updater=ce||y}b.prototype.isReactComponent={},b.prototype.setState=function(H,ee){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ee,"setState")},b.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function S(){}S.prototype=b.prototype;function A(H,ee,ce){this.props=H,this.context=ee,this.refs=x,this.updater=ce||y}var E=A.prototype=new S;E.constructor=A,C(E,b.prototype),E.isPureReactComponent=!0;var R=Array.isArray,N=Object.prototype.hasOwnProperty,V={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function j(H,ee,ce){var Ce,_e={},Ne=null,ft=null;if(ee!=null)for(Ce in ee.ref!==void 0&&(ft=ee.ref),ee.key!==void 0&&(Ne=""+ee.key),ee)N.call(ee,Ce)&&!M.hasOwnProperty(Ce)&&(_e[Ce]=ee[Ce]);var ve=arguments.length-2;if(ve===1)_e.children=ce;else if(1<ve){for(var ct=Array(ve),At=0;At<ve;At++)ct[At]=arguments[At+2];_e.children=ct}if(H&&H.defaultProps)for(Ce in ve=H.defaultProps,ve)_e[Ce]===void 0&&(_e[Ce]=ve[Ce]);return{$$typeof:n,type:H,key:Ne,ref:ft,props:_e,_owner:V.current}}function J(H,ee){return{$$typeof:n,type:H.type,key:ee,ref:H.ref,props:H.props,_owner:H._owner}}function L(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function z(H){var ee={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ce){return ee[ce]})}var Y=/\/+/g;function ie(H,ee){return typeof H=="object"&&H!==null&&H.key!=null?z(""+H.key):ee.toString(36)}function pe(H,ee,ce,Ce,_e){var Ne=typeof H;(Ne==="undefined"||Ne==="boolean")&&(H=null);var ft=!1;if(H===null)ft=!0;else switch(Ne){case"string":case"number":ft=!0;break;case"object":switch(H.$$typeof){case n:case e:ft=!0}}if(ft)return ft=H,_e=_e(ft),H=Ce===""?"."+ie(ft,0):Ce,R(_e)?(ce="",H!=null&&(ce=H.replace(Y,"$&/")+"/"),pe(_e,ee,ce,"",function(At){return At})):_e!=null&&(L(_e)&&(_e=J(_e,ce+(!_e.key||ft&&ft.key===_e.key?"":(""+_e.key).replace(Y,"$&/")+"/")+H)),ee.push(_e)),1;if(ft=0,Ce=Ce===""?".":Ce+":",R(H))for(var ve=0;ve<H.length;ve++){Ne=H[ve];var ct=Ce+ie(Ne,ve);ft+=pe(Ne,ee,ce,ct,_e)}else if(ct=m(H),typeof ct=="function")for(H=ct.call(H),ve=0;!(Ne=H.next()).done;)Ne=Ne.value,ct=Ce+ie(Ne,ve++),ft+=pe(Ne,ee,ce,ct,_e);else if(Ne==="object")throw ee=String(H),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.");return ft}function xe(H,ee,ce){if(H==null)return H;var Ce=[],_e=0;return pe(H,Ce,"","",function(Ne){return ee.call(ce,Ne,_e++)}),Ce}function Ae(H){if(H._status===-1){var ee=H._result;ee=ee(),ee.then(function(ce){(H._status===0||H._status===-1)&&(H._status=1,H._result=ce)},function(ce){(H._status===0||H._status===-1)&&(H._status=2,H._result=ce)}),H._status===-1&&(H._status=0,H._result=ee)}if(H._status===1)return H._result.default;throw H._result}var Le={current:null},we={transition:null},Se={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:we,ReactCurrentOwner:V};function Ee(){throw Error("act(...) is not supported in production builds of React.")}return Sn.Children={map:xe,forEach:function(H,ee,ce){xe(H,function(){ee.apply(this,arguments)},ce)},count:function(H){var ee=0;return xe(H,function(){ee++}),ee},toArray:function(H){return xe(H,function(ee){return ee})||[]},only:function(H){if(!L(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Sn.Component=b,Sn.Fragment=t,Sn.Profiler=i,Sn.PureComponent=A,Sn.StrictMode=r,Sn.Suspense=d,Sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Se,Sn.act=Ee,Sn.cloneElement=function(H,ee,ce){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var Ce=C({},H.props),_e=H.key,Ne=H.ref,ft=H._owner;if(ee!=null){if(ee.ref!==void 0&&(Ne=ee.ref,ft=V.current),ee.key!==void 0&&(_e=""+ee.key),H.type&&H.type.defaultProps)var ve=H.type.defaultProps;for(ct in ee)N.call(ee,ct)&&!M.hasOwnProperty(ct)&&(Ce[ct]=ee[ct]===void 0&&ve!==void 0?ve[ct]:ee[ct])}var ct=arguments.length-2;if(ct===1)Ce.children=ce;else if(1<ct){ve=Array(ct);for(var At=0;At<ct;At++)ve[At]=arguments[At+2];Ce.children=ve}return{$$typeof:n,type:H.type,key:_e,ref:Ne,props:Ce,_owner:ft}},Sn.createContext=function(H){return H={$$typeof:a,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:s,_context:H},H.Consumer=H},Sn.createElement=j,Sn.createFactory=function(H){var ee=j.bind(null,H);return ee.type=H,ee},Sn.createRef=function(){return{current:null}},Sn.forwardRef=function(H){return{$$typeof:c,render:H}},Sn.isValidElement=L,Sn.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:Ae}},Sn.memo=function(H,ee){return{$$typeof:f,type:H,compare:ee===void 0?null:ee}},Sn.startTransition=function(H){var ee=we.transition;we.transition={};try{H()}finally{we.transition=ee}},Sn.unstable_act=Ee,Sn.useCallback=function(H,ee){return Le.current.useCallback(H,ee)},Sn.useContext=function(H){return Le.current.useContext(H)},Sn.useDebugValue=function(){},Sn.useDeferredValue=function(H){return Le.current.useDeferredValue(H)},Sn.useEffect=function(H,ee){return Le.current.useEffect(H,ee)},Sn.useId=function(){return Le.current.useId()},Sn.useImperativeHandle=function(H,ee,ce){return Le.current.useImperativeHandle(H,ee,ce)},Sn.useInsertionEffect=function(H,ee){return Le.current.useInsertionEffect(H,ee)},Sn.useLayoutEffect=function(H,ee){return Le.current.useLayoutEffect(H,ee)},Sn.useMemo=function(H,ee){return Le.current.useMemo(H,ee)},Sn.useReducer=function(H,ee,ce){return Le.current.useReducer(H,ee,ce)},Sn.useRef=function(H){return Le.current.useRef(H)},Sn.useState=function(H){return Le.current.useState(H)},Sn.useSyncExternalStore=function(H,ee,ce){return Le.current.useSyncExternalStore(H,ee,ce)},Sn.useTransition=function(){return Le.current.useTransition()},Sn.version="18.3.1",Sn}var _w;function oh(){return _w||(_w=1,nv.exports=bR()),nv.exports}var Rw;function SR(){if(Rw)return af;Rw=1;var n=oh(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(c,d,f){var h,v={},m=null,y=null;f!==void 0&&(m=""+f),d.key!==void 0&&(m=""+d.key),d.ref!==void 0&&(y=d.ref);for(h in d)r.call(d,h)&&!s.hasOwnProperty(h)&&(v[h]=d[h]);if(c&&c.defaultProps)for(h in d=c.defaultProps,d)v[h]===void 0&&(v[h]=d[h]);return{$$typeof:e,type:c,key:m,ref:y,props:v,_owner:i.current}}return af.Fragment=t,af.jsx=a,af.jsxs=a,af}var Dw;function AR(){return Dw||(Dw=1,tv.exports=SR()),tv.exports}var K=AR(),F=oh();const un=kc(F),kR=mA({__proto__:null,default:un},[F]);var p0={},rv={exports:{}},ls={},iv={exports:{}},sv={},Pw;function ER(){return Pw||(Pw=1,function(n){function e(we,Se){var Ee=we.length;we.push(Se);e:for(;0<Ee;){var H=Ee-1>>>1,ee=we[H];if(0<i(ee,Se))we[H]=Se,we[Ee]=ee,Ee=H;else break e}}function t(we){return we.length===0?null:we[0]}function r(we){if(we.length===0)return null;var Se=we[0],Ee=we.pop();if(Ee!==Se){we[0]=Ee;e:for(var H=0,ee=we.length,ce=ee>>>1;H<ce;){var Ce=2*(H+1)-1,_e=we[Ce],Ne=Ce+1,ft=we[Ne];if(0>i(_e,Ee))Ne<ee&&0>i(ft,_e)?(we[H]=ft,we[Ne]=Ee,H=Ne):(we[H]=_e,we[Ce]=Ee,H=Ce);else if(Ne<ee&&0>i(ft,Ee))we[H]=ft,we[Ne]=Ee,H=Ne;else break e}}return Se}function i(we,Se){var Ee=we.sortIndex-Se.sortIndex;return Ee!==0?Ee:we.id-Se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();n.unstable_now=function(){return a.now()-c}}var d=[],f=[],h=1,v=null,m=3,y=!1,C=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(we){for(var Se=t(f);Se!==null;){if(Se.callback===null)r(f);else if(Se.startTime<=we)r(f),Se.sortIndex=Se.expirationTime,e(d,Se);else break;Se=t(f)}}function R(we){if(x=!1,E(we),!C)if(t(d)!==null)C=!0,Ae(N);else{var Se=t(f);Se!==null&&Le(R,Se.startTime-we)}}function N(we,Se){C=!1,x&&(x=!1,S(j),j=-1),y=!0;var Ee=m;try{for(E(Se),v=t(d);v!==null&&(!(v.expirationTime>Se)||we&&!z());){var H=v.callback;if(typeof H=="function"){v.callback=null,m=v.priorityLevel;var ee=H(v.expirationTime<=Se);Se=n.unstable_now(),typeof ee=="function"?v.callback=ee:v===t(d)&&r(d),E(Se)}else r(d);v=t(d)}if(v!==null)var ce=!0;else{var Ce=t(f);Ce!==null&&Le(R,Ce.startTime-Se),ce=!1}return ce}finally{v=null,m=Ee,y=!1}}var V=!1,M=null,j=-1,J=5,L=-1;function z(){return!(n.unstable_now()-L<J)}function Y(){if(M!==null){var we=n.unstable_now();L=we;var Se=!0;try{Se=M(!0,we)}finally{Se?ie():(V=!1,M=null)}}else V=!1}var ie;if(typeof A=="function")ie=function(){A(Y)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,xe=pe.port2;pe.port1.onmessage=Y,ie=function(){xe.postMessage(null)}}else ie=function(){b(Y,0)};function Ae(we){M=we,V||(V=!0,ie())}function Le(we,Se){j=b(function(){we(n.unstable_now())},Se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(we){we.callback=null},n.unstable_continueExecution=function(){C||y||(C=!0,Ae(N))},n.unstable_forceFrameRate=function(we){0>we||125<we?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<we?Math.floor(1e3/we):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(we){switch(m){case 1:case 2:case 3:var Se=3;break;default:Se=m}var Ee=m;m=Se;try{return we()}finally{m=Ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(we,Se){switch(we){case 1:case 2:case 3:case 4:case 5:break;default:we=3}var Ee=m;m=we;try{return Se()}finally{m=Ee}},n.unstable_scheduleCallback=function(we,Se,Ee){var H=n.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?H+Ee:H):Ee=H,we){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Ee+ee,we={id:h++,callback:Se,priorityLevel:we,startTime:Ee,expirationTime:ee,sortIndex:-1},Ee>H?(we.sortIndex=Ee,e(f,we),t(d)===null&&we===t(f)&&(x?(S(j),j=-1):x=!0,Le(R,Ee-H))):(we.sortIndex=ee,e(d,we),C||y||(C=!0,Ae(N))),we},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(we){var Se=m;return function(){var Ee=m;m=Se;try{return we.apply(this,arguments)}finally{m=Ee}}}}(sv)),sv}var Nw;function TR(){return Nw||(Nw=1,iv.exports=ER()),iv.exports}var Mw;function _R(){if(Mw)return ls;Mw=1;var n=oh(),e=TR();function t(o){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+o,g=1;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(o,u){a(o,u),a(o+"Capture",u)}function a(o,u){for(i[o]=u,o=0;o<u.length;o++)r.add(u[o])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},v={};function m(o){return d.call(v,o)?!0:d.call(h,o)?!1:f.test(o)?v[o]=!0:(h[o]=!0,!1)}function y(o,u,g,w){if(g!==null&&g.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return w?!1:g!==null?!g.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function C(o,u,g,w){if(u===null||typeof u>"u"||y(o,u,g,w))return!0;if(w)return!1;if(g!==null)switch(g.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function x(o,u,g,w,k,P,Z){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=w,this.attributeNamespace=k,this.mustUseProperty=g,this.propertyName=o,this.type=u,this.sanitizeURL=P,this.removeEmptyString=Z}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){b[o]=new x(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var u=o[0];b[u]=new x(u,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){b[o]=new x(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){b[o]=new x(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){b[o]=new x(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){b[o]=new x(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){b[o]=new x(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){b[o]=new x(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){b[o]=new x(o,5,!1,o.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function A(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var u=o.replace(S,A);b[u]=new x(u,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var u=o.replace(S,A);b[u]=new x(u,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var u=o.replace(S,A);b[u]=new x(u,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){b[o]=new x(o,1,!1,o.toLowerCase(),null,!1,!1)}),b.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){b[o]=new x(o,1,!1,o.toLowerCase(),null,!0,!0)});function E(o,u,g,w){var k=b.hasOwnProperty(u)?b[u]:null;(k!==null?k.type!==0:w||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(C(u,g,k,w)&&(g=null),w||k===null?m(u)&&(g===null?o.removeAttribute(u):o.setAttribute(u,""+g)):k.mustUseProperty?o[k.propertyName]=g===null?k.type===3?!1:"":g:(u=k.attributeName,w=k.attributeNamespace,g===null?o.removeAttribute(u):(k=k.type,g=k===3||k===4&&g===!0?"":""+g,w?o.setAttributeNS(w,u,g):o.setAttribute(u,g))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),V=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),z=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),xe=Symbol.for("react.memo"),Ae=Symbol.for("react.lazy"),Le=Symbol.for("react.offscreen"),we=Symbol.iterator;function Se(o){return o===null||typeof o!="object"?null:(o=we&&o[we]||o["@@iterator"],typeof o=="function"?o:null)}var Ee=Object.assign,H;function ee(o){if(H===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);H=u&&u[1]||""}return`
`+H+o}var ce=!1;function Ce(o,u){if(!o||ce)return"";ce=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Ue){var w=Ue}Reflect.construct(o,[],u)}else{try{u.call()}catch(Ue){w=Ue}o.call(u.prototype)}else{try{throw Error()}catch(Ue){w=Ue}o()}}catch(Ue){if(Ue&&w&&typeof Ue.stack=="string"){for(var k=Ue.stack.split(`
`),P=w.stack.split(`
`),Z=k.length-1,de=P.length-1;1<=Z&&0<=de&&k[Z]!==P[de];)de--;for(;1<=Z&&0<=de;Z--,de--)if(k[Z]!==P[de]){if(Z!==1||de!==1)do if(Z--,de--,0>de||k[Z]!==P[de]){var ye=`
`+k[Z].replace(" at new "," at ");return o.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",o.displayName)),ye}while(1<=Z&&0<=de);break}}}finally{ce=!1,Error.prepareStackTrace=g}return(o=o?o.displayName||o.name:"")?ee(o):""}function _e(o){switch(o.tag){case 5:return ee(o.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return o=Ce(o.type,!1),o;case 11:return o=Ce(o.type.render,!1),o;case 1:return o=Ce(o.type,!0),o;default:return""}}function Ne(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case M:return"Fragment";case V:return"Portal";case J:return"Profiler";case j:return"StrictMode";case ie:return"Suspense";case pe:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case z:return(o.displayName||"Context")+".Consumer";case L:return(o._context.displayName||"Context")+".Provider";case Y:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case xe:return u=o.displayName||null,u!==null?u:Ne(o.type)||"Memo";case Ae:u=o._payload,o=o._init;try{return Ne(o(u))}catch{}}return null}function ft(o){var u=o.type;switch(o.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=u.render,o=o.displayName||o.name||"",u.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ne(u);case 8:return u===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function ve(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function ct(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function At(o){var u=ct(o)?"checked":"value",g=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),w=""+o[u];if(!o.hasOwnProperty(u)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var k=g.get,P=g.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return k.call(this)},set:function(Z){w=""+Z,P.call(this,Z)}}),Object.defineProperty(o,u,{enumerable:g.enumerable}),{getValue:function(){return w},setValue:function(Z){w=""+Z},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function Wt(o){o._valueTracker||(o._valueTracker=At(o))}function Nt(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var g=u.getValue(),w="";return o&&(w=ct(o)?o.checked?"true":"false":o.value),o=w,o!==g?(u.setValue(o),!0):!1}function bt(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Rt(o,u){var g=u.checked;return Ee({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??o._wrapperState.initialChecked})}function st(o,u){var g=u.defaultValue==null?"":u.defaultValue,w=u.checked!=null?u.checked:u.defaultChecked;g=ve(u.value!=null?u.value:g),o._wrapperState={initialChecked:w,initialValue:g,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function at(o,u){u=u.checked,u!=null&&E(o,"checked",u,!1)}function zt(o,u){at(o,u);var g=ve(u.value),w=u.type;if(g!=null)w==="number"?(g===0&&o.value===""||o.value!=g)&&(o.value=""+g):o.value!==""+g&&(o.value=""+g);else if(w==="submit"||w==="reset"){o.removeAttribute("value");return}u.hasOwnProperty("value")?_t(o,u.type,g):u.hasOwnProperty("defaultValue")&&_t(o,u.type,ve(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(o.defaultChecked=!!u.defaultChecked)}function jt(o,u,g){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var w=u.type;if(!(w!=="submit"&&w!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+o._wrapperState.initialValue,g||u===o.value||(o.value=u),o.defaultValue=u}g=o.name,g!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,g!==""&&(o.name=g)}function _t(o,u,g){(u!=="number"||bt(o.ownerDocument)!==o)&&(g==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+g&&(o.defaultValue=""+g))}var Xt=Array.isArray;function an(o,u,g,w){if(o=o.options,u){u={};for(var k=0;k<g.length;k++)u["$"+g[k]]=!0;for(g=0;g<o.length;g++)k=u.hasOwnProperty("$"+o[g].value),o[g].selected!==k&&(o[g].selected=k),k&&w&&(o[g].defaultSelected=!0)}else{for(g=""+ve(g),u=null,k=0;k<o.length;k++){if(o[k].value===g){o[k].selected=!0,w&&(o[k].defaultSelected=!0);return}u!==null||o[k].disabled||(u=o[k])}u!==null&&(u.selected=!0)}}function ot(o,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return Ee({},u,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function le(o,u){var g=u.value;if(g==null){if(g=u.children,u=u.defaultValue,g!=null){if(u!=null)throw Error(t(92));if(Xt(g)){if(1<g.length)throw Error(t(93));g=g[0]}u=g}u==null&&(u=""),g=u}o._wrapperState={initialValue:ve(g)}}function nn(o,u){var g=ve(u.value),w=ve(u.defaultValue);g!=null&&(g=""+g,g!==o.value&&(o.value=g),u.defaultValue==null&&o.defaultValue!==g&&(o.defaultValue=g)),w!=null&&(o.defaultValue=""+w)}function vn(o){var u=o.textContent;u===o._wrapperState.initialValue&&u!==""&&u!==null&&(o.value=u)}function Ln(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function X(o,u){return o==null||o==="http://www.w3.org/1999/xhtml"?Ln(u):o==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var D,B=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,g,w,k){MSApp.execUnsafeLocalFunction(function(){return o(u,g,w,k)})}:o}(function(o,u){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=u;else{for(D=D||document.createElement("div"),D.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=D.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;u.firstChild;)o.appendChild(u.firstChild)}});function te(o,u){if(u){var g=o.firstChild;if(g&&g===o.lastChild&&g.nodeType===3){g.nodeValue=u;return}}o.textContent=u}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},De=["Webkit","ms","Moz","O"];Object.keys(me).forEach(function(o){De.forEach(function(u){u=u+o.charAt(0).toUpperCase()+o.substring(1),me[u]=me[o]})});function Ge(o,u,g){return u==null||typeof u=="boolean"||u===""?"":g||typeof u!="number"||u===0||me.hasOwnProperty(o)&&me[o]?(""+u).trim():u+"px"}function Lt(o,u){o=o.style;for(var g in u)if(u.hasOwnProperty(g)){var w=g.indexOf("--")===0,k=Ge(g,u[g],w);g==="float"&&(g="cssFloat"),w?o.setProperty(g,k):o[g]=k}}var gn=Ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mn(o,u){if(u){if(gn[o]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function wn(o,u){if(o.indexOf("-")===-1)return typeof u.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hn=null;function Bn(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Sr=null,mr=null,Qt=null;function Yr(o){if(o=Hd(o)){if(typeof Sr!="function")throw Error(t(280));var u=o.stateNode;u&&(u=Th(u),Sr(o.stateNode,o.type,u))}}function Je(o){mr?Qt?Qt.push(o):Qt=[o]:mr=o}function En(){if(mr){var o=mr,u=Qt;if(Qt=mr=null,Yr(o),u)for(o=0;o<u.length;o++)Yr(u[o])}}function Ht(o,u){return o(u)}function fr(){}var $n=!1;function Qr(o,u,g){if($n)return o(u,g);$n=!0;try{return Ht(o,u,g)}finally{$n=!1,(mr!==null||Qt!==null)&&(fr(),En())}}function Mr(o,u){var g=o.stateNode;if(g===null)return null;var w=Th(g);if(w===null)return null;g=w[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(o=o.type,w=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!w;break e;default:o=!1}if(o)return null;if(g&&typeof g!="function")throw Error(t(231,u,typeof g));return g}var ge=!1;if(c)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){ge=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch{ge=!1}function Q(o,u,g,w,k,P,Z,de,ye){var Ue=Array.prototype.slice.call(arguments,3);try{u.apply(g,Ue)}catch(et){this.onError(et)}}var Ve=!1,tt=null,Et=!1,Bt=null,ht={onError:function(o){Ve=!0,tt=o}};function pt(o,u,g,w,k,P,Z,de,ye){Ve=!1,tt=null,Q.apply(ht,arguments)}function Ct(o,u,g,w,k,P,Z,de,ye){if(pt.apply(this,arguments),Ve){if(Ve){var Ue=tt;Ve=!1,tt=null}else throw Error(t(198));Et||(Et=!0,Bt=Ue)}}function Fe(o){var u=o,g=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(g=u.return),o=u.return;while(o)}return u.tag===3?g:null}function lt(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function We(o){if(Fe(o)!==o)throw Error(t(188))}function In(o){var u=o.alternate;if(!u){if(u=Fe(o),u===null)throw Error(t(188));return u!==o?null:o}for(var g=o,w=u;;){var k=g.return;if(k===null)break;var P=k.alternate;if(P===null){if(w=k.return,w!==null){g=w;continue}break}if(k.child===P.child){for(P=k.child;P;){if(P===g)return We(k),o;if(P===w)return We(k),u;P=P.sibling}throw Error(t(188))}if(g.return!==w.return)g=k,w=P;else{for(var Z=!1,de=k.child;de;){if(de===g){Z=!0,g=k,w=P;break}if(de===w){Z=!0,w=k,g=P;break}de=de.sibling}if(!Z){for(de=P.child;de;){if(de===g){Z=!0,g=P,w=k;break}if(de===w){Z=!0,w=P,g=k;break}de=de.sibling}if(!Z)throw Error(t(189))}}if(g.alternate!==w)throw Error(t(190))}if(g.tag!==3)throw Error(t(188));return g.stateNode.current===g?o:u}function it(o){return o=In(o),o!==null?fe(o):null}function fe(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var u=fe(o);if(u!==null)return u;o=o.sibling}return null}var ze=e.unstable_scheduleCallback,xt=e.unstable_cancelCallback,bn=e.unstable_shouldYield,Ot=e.unstable_requestPaint,wt=e.unstable_now,Zt=e.unstable_getCurrentPriorityLevel,Kn=e.unstable_ImmediatePriority,qn=e.unstable_UserBlockingPriority,nr=e.unstable_NormalPriority,Pn=e.unstable_LowPriority,tn=e.unstable_IdlePriority,yn=null,rr=null;function li(o){if(rr&&typeof rr.onCommitFiberRoot=="function")try{rr.onCommitFiberRoot(yn,o,void 0,(o.current.flags&128)===128)}catch{}}var Cn=Math.clz32?Math.clz32:Ls,Lr=Math.log,It=Math.LN2;function Ls(o){return o>>>=0,o===0?32:31-(Lr(o)/It|0)|0}var Qi=64,es=4194304;function St(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function rn(o,u){var g=o.pendingLanes;if(g===0)return 0;var w=0,k=o.suspendedLanes,P=o.pingedLanes,Z=g&268435455;if(Z!==0){var de=Z&~k;de!==0?w=St(de):(P&=Z,P!==0&&(w=St(P)))}else Z=g&~k,Z!==0?w=St(Z):P!==0&&(w=St(P));if(w===0)return 0;if(u!==0&&u!==w&&(u&k)===0&&(k=w&-w,P=u&-u,k>=P||k===16&&(P&4194240)!==0))return u;if((w&4)!==0&&(w|=g&16),u=o.entangledLanes,u!==0)for(o=o.entanglements,u&=w;0<u;)g=31-Cn(u),k=1<<g,w|=o[g],u&=~k;return w}function _(o,u){switch(o){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U(o,u){for(var g=o.suspendedLanes,w=o.pingedLanes,k=o.expirationTimes,P=o.pendingLanes;0<P;){var Z=31-Cn(P),de=1<<Z,ye=k[Z];ye===-1?((de&g)===0||(de&w)!==0)&&(k[Z]=_(de,u)):ye<=u&&(o.expiredLanes|=de),P&=~de}}function q(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function se(){var o=Qi;return Qi<<=1,(Qi&4194240)===0&&(Qi=64),o}function Be(o){for(var u=[],g=0;31>g;g++)u.push(o);return u}function ke(o,u,g){o.pendingLanes|=u,u!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,u=31-Cn(u),o[u]=g}function je(o,u){var g=o.pendingLanes&~u;o.pendingLanes=u,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=u,o.mutableReadLanes&=u,o.entangledLanes&=u,u=o.entanglements;var w=o.eventTimes;for(o=o.expirationTimes;0<g;){var k=31-Cn(g),P=1<<k;u[k]=0,w[k]=-1,o[k]=-1,g&=~P}}function ut(o,u){var g=o.entangledLanes|=u;for(o=o.entanglements;g;){var w=31-Cn(g),k=1<<w;k&u|o[w]&u&&(o[w]|=u),g&=~k}}var gt=0;function qt(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var cn,On,wi,Ii,ei,bi=!1,Si=[],vr=null,ti=null,Jn=null,Ur=new Map,Cs=new Map,xs=[],Ta="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ws(o,u){switch(o){case"focusin":case"focusout":vr=null;break;case"dragenter":case"dragleave":ti=null;break;case"mouseover":case"mouseout":Jn=null;break;case"pointerover":case"pointerout":Ur.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cs.delete(u.pointerId)}}function _a(o,u,g,w,k,P){return o===null||o.nativeEvent!==P?(o={blockedOn:u,domEventName:g,eventSystemFlags:w,nativeEvent:P,targetContainers:[k]},u!==null&&(u=Hd(u),u!==null&&On(u)),o):(o.eventSystemFlags|=w,u=o.targetContainers,k!==null&&u.indexOf(k)===-1&&u.push(k),o)}function Od(o,u,g,w,k){switch(u){case"focusin":return vr=_a(vr,o,u,g,w,k),!0;case"dragenter":return ti=_a(ti,o,u,g,w,k),!0;case"mouseover":return Jn=_a(Jn,o,u,g,w,k),!0;case"pointerover":var P=k.pointerId;return Ur.set(P,_a(Ur.get(P)||null,o,u,g,w,k)),!0;case"gotpointercapture":return P=k.pointerId,Cs.set(P,_a(Cs.get(P)||null,o,u,g,w,k)),!0}return!1}function ts(o){var u=Dl(o.target);if(u!==null){var g=Fe(u);if(g!==null){if(u=g.tag,u===13){if(u=lt(g),u!==null){o.blockedOn=u,ei(o.priority,function(){wi(g)});return}}else if(u===3&&g.stateNode.current.memoizedState.isDehydrated){o.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}o.blockedOn=null}function io(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var g=Wo(o.domEventName,o.eventSystemFlags,u[0],o.nativeEvent);if(g===null){g=o.nativeEvent;var w=new g.constructor(g.type,g);hn=w,g.target.dispatchEvent(w),hn=null}else return u=Hd(g),u!==null&&On(u),o.blockedOn=g,!1;u.shift()}return!0}function Ra(o,u,g){io(o)&&g.delete(u)}function Fn(){bi=!1,vr!==null&&io(vr)&&(vr=null),ti!==null&&io(ti)&&(ti=null),Jn!==null&&io(Jn)&&(Jn=null),Ur.forEach(Ra),Cs.forEach(Ra)}function yr(o,u){o.blockedOn===u&&(o.blockedOn=null,bi||(bi=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Fn)))}function vt(o){function u(k){return yr(k,o)}if(0<Si.length){yr(Si[0],o);for(var g=1;g<Si.length;g++){var w=Si[g];w.blockedOn===o&&(w.blockedOn=null)}}for(vr!==null&&yr(vr,o),ti!==null&&yr(ti,o),Jn!==null&&yr(Jn,o),Ur.forEach(u),Cs.forEach(u),g=0;g<xs.length;g++)w=xs[g],w.blockedOn===o&&(w.blockedOn=null);for(;0<xs.length&&(g=xs[0],g.blockedOn===null);)ts(g),g.blockedOn===null&&xs.shift()}var ui=R.ReactCurrentBatchConfig,ir=!0;function di(o,u,g,w){var k=gt,P=ui.transition;ui.transition=null;try{gt=1,Da(o,u,g,w)}finally{gt=k,ui.transition=P}}function ns(o,u,g,w){var k=gt,P=ui.transition;ui.transition=null;try{gt=4,Da(o,u,g,w)}finally{gt=k,ui.transition=P}}function Da(o,u,g,w){if(ir){var k=Wo(o,u,g,w);if(k===null)zg(o,u,w,Us,g),ws(o,w);else if(Od(k,o,u,g,w))w.stopPropagation();else if(ws(o,w),u&4&&-1<Ta.indexOf(o)){for(;k!==null;){var P=Hd(k);if(P!==null&&cn(P),P=Wo(o,u,g,w),P===null&&zg(o,u,w,Us,g),P===k)break;k=P}k!==null&&w.stopPropagation()}else zg(o,u,w,null,g)}}var Us=null;function Wo(o,u,g,w){if(Us=null,o=Bn(w),o=Dl(o),o!==null)if(u=Fe(o),u===null)o=null;else if(g=u.tag,g===13){if(o=lt(u),o!==null)return o;o=null}else if(g===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null);return Us=o,null}function Dc(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zt()){case Kn:return 1;case qn:return 4;case nr:case Pn:return 16;case tn:return 536870912;default:return 16}default:return 16}}var Vn=null,dn=null,Gr=null;function wu(){if(Gr)return Gr;var o,u=dn,g=u.length,w,k="value"in Vn?Vn.value:Vn.textContent,P=k.length;for(o=0;o<g&&u[o]===k[o];o++);var Z=g-o;for(w=1;w<=Z&&u[g-w]===k[P-w];w++);return Gr=k.slice(o,1<w?1-w:void 0)}function so(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function Pa(){return!0}function Na(){return!1}function Vr(o){function u(g,w,k,P,Z){this._reactName=g,this._targetInst=k,this.type=w,this.nativeEvent=P,this.target=Z,this.currentTarget=null;for(var de in o)o.hasOwnProperty(de)&&(g=o[de],this[de]=g?g(P):P[de]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Pa:Na,this.isPropagationStopped=Na,this}return Ee(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Pa)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Pa)},persist:function(){},isPersistent:Pa}),u}var Gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Is=Vr(Gs),bs=Ee({},Gs,{view:0,detail:0}),Al=Vr(bs),zo,oo,Vs,Ho=Ee({},bs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cr,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Vs&&(Vs&&o.type==="mousemove"?(zo=o.screenX-Vs.screenX,oo=o.screenY-Vs.screenY):oo=zo=0,Vs=o),zo)},movementY:function(o){return"movementY"in o?o.movementY:oo}}),kl=Vr(Ho),Pc=Ee({},Ho,{dataTransfer:0}),El=Vr(Pc),jr=Ee({},bs,{relatedTarget:0}),Ar=Vr(jr),Tl=Ee({},Gs,{animationName:0,elapsedTime:0,pseudoElement:0}),Fd=Vr(Tl),Iu=Ee({},Gs,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Nc=Vr(Iu),Mc=Ee({},Gs,{data:0}),js=Vr(Mc),Zo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _l(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=bu[o])?!!u[o]:!1}function Cr(){return _l}var Rl=Ee({},bs,{key:function(o){if(o.key){var u=Zo[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=so(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Bc[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cr,charCode:function(o){return o.type==="keypress"?so(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?so(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Ss=Vr(Rl),T=Ee({},Ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),G=Vr(T),$=Ee({},bs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cr}),re=Vr($),Me=Ee({},Gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Re=Vr(Me),Ze=Ee({},Ho,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Ye=Vr(Ze),Kt=[9,13,27,32],fn=c&&"CompositionEvent"in window,$t=null;c&&"documentMode"in document&&($t=document.documentMode);var Un=c&&"TextEvent"in window&&!$t,xr=c&&(!fn||$t&&8<$t&&11>=$t),Ai=" ",ki=!1;function rs(o,u){switch(o){case"keyup":return Kt.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oc(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Li=!1;function Su(o,u){switch(o){case"compositionend":return Oc(u);case"keypress":return u.which!==32?null:(ki=!0,Ai);case"textInput":return o=u.data,o===Ai&&ki?null:o;default:return null}}function Bg(o,u){if(Li)return o==="compositionend"||!fn&&rs(o,u)?(o=wu(),Gr=dn=Vn=null,Li=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return xr&&u.locale!=="ko"?null:u.data;default:return null}}var Og={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function l(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!Og[o.type]:u==="textarea"}function p(o,u,g,w){Je(w),u=Ah(u,"onChange"),0<u.length&&(g=new Is("onChange","change",null,g,w),o.push({event:g,listeners:u}))}var I=null,O=null;function W(o){W1(o,0)}function oe(o){var u=Ru(o);if(Nt(u))return o}function he(o,u){if(o==="change")return u}var He=!1;if(c){var $e;if(c){var mt="oninput"in document;if(!mt){var wr=document.createElement("div");wr.setAttribute("oninput","return;"),mt=typeof wr.oninput=="function"}$e=mt}else $e=!1;He=$e&&(!document.documentMode||9<document.documentMode)}function Ws(){I&&(I.detachEvent("onpropertychange",Au),O=I=null)}function Au(o){if(o.propertyName==="value"&&oe(O)){var u=[];p(u,O,o,Bn(o)),Qr(W,u)}}function Ld(o,u,g){o==="focusin"?(Ws(),I=u,O=g,I.attachEvent("onpropertychange",Au)):o==="focusout"&&Ws()}function b_(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return oe(O)}function S_(o,u){if(o==="click")return oe(u)}function A_(o,u){if(o==="input"||o==="change")return oe(u)}function k_(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var ao=typeof Object.is=="function"?Object.is:k_;function Ud(o,u){if(ao(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var g=Object.keys(o),w=Object.keys(u);if(g.length!==w.length)return!1;for(w=0;w<g.length;w++){var k=g[w];if(!d.call(u,k)||!ao(o[k],u[k]))return!1}return!0}function R1(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function D1(o,u){var g=R1(o);o=0;for(var w;g;){if(g.nodeType===3){if(w=o+g.textContent.length,o<=u&&w>=u)return{node:g,offset:u-o};o=w}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=R1(g)}}function P1(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?P1(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function N1(){for(var o=window,u=bt();u instanceof o.HTMLIFrameElement;){try{var g=typeof u.contentWindow.location.href=="string"}catch{g=!1}if(g)o=u.contentWindow;else break;u=bt(o.document)}return u}function Fg(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}function E_(o){var u=N1(),g=o.focusedElem,w=o.selectionRange;if(u!==g&&g&&g.ownerDocument&&P1(g.ownerDocument.documentElement,g)){if(w!==null&&Fg(g)){if(u=w.start,o=w.end,o===void 0&&(o=u),"selectionStart"in g)g.selectionStart=u,g.selectionEnd=Math.min(o,g.value.length);else if(o=(u=g.ownerDocument||document)&&u.defaultView||window,o.getSelection){o=o.getSelection();var k=g.textContent.length,P=Math.min(w.start,k);w=w.end===void 0?P:Math.min(w.end,k),!o.extend&&P>w&&(k=w,w=P,P=k),k=D1(g,P);var Z=D1(g,w);k&&Z&&(o.rangeCount!==1||o.anchorNode!==k.node||o.anchorOffset!==k.offset||o.focusNode!==Z.node||o.focusOffset!==Z.offset)&&(u=u.createRange(),u.setStart(k.node,k.offset),o.removeAllRanges(),P>w?(o.addRange(u),o.extend(Z.node,Z.offset)):(u.setEnd(Z.node,Z.offset),o.addRange(u)))}}for(u=[],o=g;o=o.parentNode;)o.nodeType===1&&u.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<u.length;g++)o=u[g],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var T_=c&&"documentMode"in document&&11>=document.documentMode,ku=null,Lg=null,Gd=null,Ug=!1;function M1(o,u,g){var w=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Ug||ku==null||ku!==bt(w)||(w=ku,"selectionStart"in w&&Fg(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Gd&&Ud(Gd,w)||(Gd=w,w=Ah(Lg,"onSelect"),0<w.length&&(u=new Is("onSelect","select",null,u,g),o.push({event:u,listeners:w}),u.target=ku)))}function Ih(o,u){var g={};return g[o.toLowerCase()]=u.toLowerCase(),g["Webkit"+o]="webkit"+u,g["Moz"+o]="moz"+u,g}var Eu={animationend:Ih("Animation","AnimationEnd"),animationiteration:Ih("Animation","AnimationIteration"),animationstart:Ih("Animation","AnimationStart"),transitionend:Ih("Transition","TransitionEnd")},Gg={},B1={};c&&(B1=document.createElement("div").style,"AnimationEvent"in window||(delete Eu.animationend.animation,delete Eu.animationiteration.animation,delete Eu.animationstart.animation),"TransitionEvent"in window||delete Eu.transitionend.transition);function bh(o){if(Gg[o])return Gg[o];if(!Eu[o])return o;var u=Eu[o],g;for(g in u)if(u.hasOwnProperty(g)&&g in B1)return Gg[o]=u[g];return o}var O1=bh("animationend"),F1=bh("animationiteration"),L1=bh("animationstart"),U1=bh("transitionend"),G1=new Map,V1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fc(o,u){G1.set(o,u),s(u,[o])}for(var Vg=0;Vg<V1.length;Vg++){var jg=V1[Vg],__=jg.toLowerCase(),R_=jg[0].toUpperCase()+jg.slice(1);Fc(__,"on"+R_)}Fc(O1,"onAnimationEnd"),Fc(F1,"onAnimationIteration"),Fc(L1,"onAnimationStart"),Fc("dblclick","onDoubleClick"),Fc("focusin","onFocus"),Fc("focusout","onBlur"),Fc(U1,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vd));function j1(o,u,g){var w=o.type||"unknown-event";o.currentTarget=g,Ct(w,u,void 0,o),o.currentTarget=null}function W1(o,u){u=(u&4)!==0;for(var g=0;g<o.length;g++){var w=o[g],k=w.event;w=w.listeners;e:{var P=void 0;if(u)for(var Z=w.length-1;0<=Z;Z--){var de=w[Z],ye=de.instance,Ue=de.currentTarget;if(de=de.listener,ye!==P&&k.isPropagationStopped())break e;j1(k,de,Ue),P=ye}else for(Z=0;Z<w.length;Z++){if(de=w[Z],ye=de.instance,Ue=de.currentTarget,de=de.listener,ye!==P&&k.isPropagationStopped())break e;j1(k,de,Ue),P=ye}}}if(Et)throw o=Bt,Et=!1,Bt=null,o}function sr(o,u){var g=u[qg];g===void 0&&(g=u[qg]=new Set);var w=o+"__bubble";g.has(w)||(z1(u,o,2,!1),g.add(w))}function Wg(o,u,g){var w=0;u&&(w|=4),z1(g,o,w,u)}var Sh="_reactListening"+Math.random().toString(36).slice(2);function jd(o){if(!o[Sh]){o[Sh]=!0,r.forEach(function(g){g!=="selectionchange"&&(D_.has(g)||Wg(g,!1,o),Wg(g,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[Sh]||(u[Sh]=!0,Wg("selectionchange",!1,u))}}function z1(o,u,g,w){switch(Dc(u)){case 1:var k=di;break;case 4:k=ns;break;default:k=Da}g=k.bind(null,u,g,o),k=void 0,!ge||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(k=!0),w?k!==void 0?o.addEventListener(u,g,{capture:!0,passive:k}):o.addEventListener(u,g,!0):k!==void 0?o.addEventListener(u,g,{passive:k}):o.addEventListener(u,g,!1)}function zg(o,u,g,w,k){var P=w;if((u&1)===0&&(u&2)===0&&w!==null)e:for(;;){if(w===null)return;var Z=w.tag;if(Z===3||Z===4){var de=w.stateNode.containerInfo;if(de===k||de.nodeType===8&&de.parentNode===k)break;if(Z===4)for(Z=w.return;Z!==null;){var ye=Z.tag;if((ye===3||ye===4)&&(ye=Z.stateNode.containerInfo,ye===k||ye.nodeType===8&&ye.parentNode===k))return;Z=Z.return}for(;de!==null;){if(Z=Dl(de),Z===null)return;if(ye=Z.tag,ye===5||ye===6){w=P=Z;continue e}de=de.parentNode}}w=w.return}Qr(function(){var Ue=P,et=Bn(g),nt=[];e:{var Qe=G1.get(o);if(Qe!==void 0){var Tt=Is,Ft=o;switch(o){case"keypress":if(so(g)===0)break e;case"keydown":case"keyup":Tt=Ss;break;case"focusin":Ft="focus",Tt=Ar;break;case"focusout":Ft="blur",Tt=Ar;break;case"beforeblur":case"afterblur":Tt=Ar;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Tt=kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Tt=El;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Tt=re;break;case O1:case F1:case L1:Tt=Fd;break;case U1:Tt=Re;break;case"scroll":Tt=Al;break;case"wheel":Tt=Ye;break;case"copy":case"cut":case"paste":Tt=Nc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Tt=G}var Ut=(u&4)!==0,_r=!Ut&&o==="scroll",Pe=Ut?Qe!==null?Qe+"Capture":null:Qe;Ut=[];for(var be=Ue,Oe;be!==null;){Oe=be;var dt=Oe.stateNode;if(Oe.tag===5&&dt!==null&&(Oe=dt,Pe!==null&&(dt=Mr(be,Pe),dt!=null&&Ut.push(Wd(be,dt,Oe)))),_r)break;be=be.return}0<Ut.length&&(Qe=new Tt(Qe,Ft,null,g,et),nt.push({event:Qe,listeners:Ut}))}}if((u&7)===0){e:{if(Qe=o==="mouseover"||o==="pointerover",Tt=o==="mouseout"||o==="pointerout",Qe&&g!==hn&&(Ft=g.relatedTarget||g.fromElement)&&(Dl(Ft)||Ft[Ma]))break e;if((Tt||Qe)&&(Qe=et.window===et?et:(Qe=et.ownerDocument)?Qe.defaultView||Qe.parentWindow:window,Tt?(Ft=g.relatedTarget||g.toElement,Tt=Ue,Ft=Ft?Dl(Ft):null,Ft!==null&&(_r=Fe(Ft),Ft!==_r||Ft.tag!==5&&Ft.tag!==6)&&(Ft=null)):(Tt=null,Ft=Ue),Tt!==Ft)){if(Ut=kl,dt="onMouseLeave",Pe="onMouseEnter",be="mouse",(o==="pointerout"||o==="pointerover")&&(Ut=G,dt="onPointerLeave",Pe="onPointerEnter",be="pointer"),_r=Tt==null?Qe:Ru(Tt),Oe=Ft==null?Qe:Ru(Ft),Qe=new Ut(dt,be+"leave",Tt,g,et),Qe.target=_r,Qe.relatedTarget=Oe,dt=null,Dl(et)===Ue&&(Ut=new Ut(Pe,be+"enter",Ft,g,et),Ut.target=Oe,Ut.relatedTarget=_r,dt=Ut),_r=dt,Tt&&Ft)t:{for(Ut=Tt,Pe=Ft,be=0,Oe=Ut;Oe;Oe=Tu(Oe))be++;for(Oe=0,dt=Pe;dt;dt=Tu(dt))Oe++;for(;0<be-Oe;)Ut=Tu(Ut),be--;for(;0<Oe-be;)Pe=Tu(Pe),Oe--;for(;be--;){if(Ut===Pe||Pe!==null&&Ut===Pe.alternate)break t;Ut=Tu(Ut),Pe=Tu(Pe)}Ut=null}else Ut=null;Tt!==null&&H1(nt,Qe,Tt,Ut,!1),Ft!==null&&_r!==null&&H1(nt,_r,Ft,Ut,!0)}}e:{if(Qe=Ue?Ru(Ue):window,Tt=Qe.nodeName&&Qe.nodeName.toLowerCase(),Tt==="select"||Tt==="input"&&Qe.type==="file")var Vt=he;else if(l(Qe))if(He)Vt=A_;else{Vt=b_;var Jt=Ld}else(Tt=Qe.nodeName)&&Tt.toLowerCase()==="input"&&(Qe.type==="checkbox"||Qe.type==="radio")&&(Vt=S_);if(Vt&&(Vt=Vt(o,Ue))){p(nt,Vt,g,et);break e}Jt&&Jt(o,Qe,Ue),o==="focusout"&&(Jt=Qe._wrapperState)&&Jt.controlled&&Qe.type==="number"&&_t(Qe,"number",Qe.value)}switch(Jt=Ue?Ru(Ue):window,o){case"focusin":(l(Jt)||Jt.contentEditable==="true")&&(ku=Jt,Lg=Ue,Gd=null);break;case"focusout":Gd=Lg=ku=null;break;case"mousedown":Ug=!0;break;case"contextmenu":case"mouseup":case"dragend":Ug=!1,M1(nt,g,et);break;case"selectionchange":if(T_)break;case"keydown":case"keyup":M1(nt,g,et)}var Yt;if(fn)e:{switch(o){case"compositionstart":var ln="onCompositionStart";break e;case"compositionend":ln="onCompositionEnd";break e;case"compositionupdate":ln="onCompositionUpdate";break e}ln=void 0}else Li?rs(o,g)&&(ln="onCompositionEnd"):o==="keydown"&&g.keyCode===229&&(ln="onCompositionStart");ln&&(xr&&g.locale!=="ko"&&(Li||ln!=="onCompositionStart"?ln==="onCompositionEnd"&&Li&&(Yt=wu()):(Vn=et,dn="value"in Vn?Vn.value:Vn.textContent,Li=!0)),Jt=Ah(Ue,ln),0<Jt.length&&(ln=new js(ln,o,null,g,et),nt.push({event:ln,listeners:Jt}),Yt?ln.data=Yt:(Yt=Oc(g),Yt!==null&&(ln.data=Yt)))),(Yt=Un?Su(o,g):Bg(o,g))&&(Ue=Ah(Ue,"onBeforeInput"),0<Ue.length&&(et=new js("onBeforeInput","beforeinput",null,g,et),nt.push({event:et,listeners:Ue}),et.data=Yt))}W1(nt,u)})}function Wd(o,u,g){return{instance:o,listener:u,currentTarget:g}}function Ah(o,u){for(var g=u+"Capture",w=[];o!==null;){var k=o,P=k.stateNode;k.tag===5&&P!==null&&(k=P,P=Mr(o,g),P!=null&&w.unshift(Wd(o,P,k)),P=Mr(o,u),P!=null&&w.push(Wd(o,P,k))),o=o.return}return w}function Tu(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function H1(o,u,g,w,k){for(var P=u._reactName,Z=[];g!==null&&g!==w;){var de=g,ye=de.alternate,Ue=de.stateNode;if(ye!==null&&ye===w)break;de.tag===5&&Ue!==null&&(de=Ue,k?(ye=Mr(g,P),ye!=null&&Z.unshift(Wd(g,ye,de))):k||(ye=Mr(g,P),ye!=null&&Z.push(Wd(g,ye,de)))),g=g.return}Z.length!==0&&o.push({event:u,listeners:Z})}var P_=/\r\n?/g,N_=/\u0000|\uFFFD/g;function Z1(o){return(typeof o=="string"?o:""+o).replace(P_,`
`).replace(N_,"")}function kh(o,u,g){if(u=Z1(u),Z1(o)!==u&&g)throw Error(t(425))}function Eh(){}var Hg=null,Zg=null;function Xg(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var $g=typeof setTimeout=="function"?setTimeout:void 0,M_=typeof clearTimeout=="function"?clearTimeout:void 0,X1=typeof Promise=="function"?Promise:void 0,B_=typeof queueMicrotask=="function"?queueMicrotask:typeof X1<"u"?function(o){return X1.resolve(null).then(o).catch(O_)}:$g;function O_(o){setTimeout(function(){throw o})}function Kg(o,u){var g=u,w=0;do{var k=g.nextSibling;if(o.removeChild(g),k&&k.nodeType===8)if(g=k.data,g==="/$"){if(w===0){o.removeChild(k),vt(u);return}w--}else g!=="$"&&g!=="$?"&&g!=="$!"||w++;g=k}while(g);vt(u)}function Lc(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return o}function $1(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var g=o.data;if(g==="$"||g==="$!"||g==="$?"){if(u===0)return o;u--}else g==="/$"&&u++}o=o.previousSibling}return null}var _u=Math.random().toString(36).slice(2),Xo="__reactFiber$"+_u,zd="__reactProps$"+_u,Ma="__reactContainer$"+_u,qg="__reactEvents$"+_u,F_="__reactListeners$"+_u,L_="__reactHandles$"+_u;function Dl(o){var u=o[Xo];if(u)return u;for(var g=o.parentNode;g;){if(u=g[Ma]||g[Xo]){if(g=u.alternate,u.child!==null||g!==null&&g.child!==null)for(o=$1(o);o!==null;){if(g=o[Xo])return g;o=$1(o)}return u}o=g,g=o.parentNode}return null}function Hd(o){return o=o[Xo]||o[Ma],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Ru(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Th(o){return o[zd]||null}var Jg=[],Du=-1;function Uc(o){return{current:o}}function or(o){0>Du||(o.current=Jg[Du],Jg[Du]=null,Du--)}function Yn(o,u){Du++,Jg[Du]=o.current,o.current=u}var Gc={},Ei=Uc(Gc),is=Uc(!1),Pl=Gc;function Pu(o,u){var g=o.type.contextTypes;if(!g)return Gc;var w=o.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===u)return w.__reactInternalMemoizedMaskedChildContext;var k={},P;for(P in g)k[P]=u[P];return w&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=u,o.__reactInternalMemoizedMaskedChildContext=k),k}function ss(o){return o=o.childContextTypes,o!=null}function _h(){or(is),or(Ei)}function K1(o,u,g){if(Ei.current!==Gc)throw Error(t(168));Yn(Ei,u),Yn(is,g)}function q1(o,u,g){var w=o.stateNode;if(u=u.childContextTypes,typeof w.getChildContext!="function")return g;w=w.getChildContext();for(var k in w)if(!(k in u))throw Error(t(108,ft(o)||"Unknown",k));return Ee({},g,w)}function Rh(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Gc,Pl=Ei.current,Yn(Ei,o),Yn(is,is.current),!0}function J1(o,u,g){var w=o.stateNode;if(!w)throw Error(t(169));g?(o=q1(o,u,Pl),w.__reactInternalMemoizedMergedChildContext=o,or(is),or(Ei),Yn(Ei,o)):or(is),Yn(is,g)}var Ba=null,Dh=!1,Yg=!1;function Y1(o){Ba===null?Ba=[o]:Ba.push(o)}function U_(o){Dh=!0,Y1(o)}function Vc(){if(!Yg&&Ba!==null){Yg=!0;var o=0,u=gt;try{var g=Ba;for(gt=1;o<g.length;o++){var w=g[o];do w=w(!0);while(w!==null)}Ba=null,Dh=!1}catch(k){throw Ba!==null&&(Ba=Ba.slice(o+1)),ze(Kn,Vc),k}finally{gt=u,Yg=!1}}return null}var Nu=[],Mu=0,Ph=null,Nh=0,zs=[],Hs=0,Nl=null,Oa=1,Fa="";function Ml(o,u){Nu[Mu++]=Nh,Nu[Mu++]=Ph,Ph=o,Nh=u}function Q1(o,u,g){zs[Hs++]=Oa,zs[Hs++]=Fa,zs[Hs++]=Nl,Nl=o;var w=Oa;o=Fa;var k=32-Cn(w)-1;w&=~(1<<k),g+=1;var P=32-Cn(u)+k;if(30<P){var Z=k-k%5;P=(w&(1<<Z)-1).toString(32),w>>=Z,k-=Z,Oa=1<<32-Cn(u)+k|g<<k|w,Fa=P+o}else Oa=1<<P|g<<k|w,Fa=o}function Qg(o){o.return!==null&&(Ml(o,1),Q1(o,1,0))}function em(o){for(;o===Ph;)Ph=Nu[--Mu],Nu[Mu]=null,Nh=Nu[--Mu],Nu[Mu]=null;for(;o===Nl;)Nl=zs[--Hs],zs[Hs]=null,Fa=zs[--Hs],zs[Hs]=null,Oa=zs[--Hs],zs[Hs]=null}var As=null,ks=null,hr=!1,co=null;function ex(o,u){var g=Ks(5,null,null,0);g.elementType="DELETED",g.stateNode=u,g.return=o,u=o.deletions,u===null?(o.deletions=[g],o.flags|=16):u.push(g)}function tx(o,u){switch(o.tag){case 5:var g=o.type;return u=u.nodeType!==1||g.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(o.stateNode=u,As=o,ks=Lc(u.firstChild),!0):!1;case 6:return u=o.pendingProps===""||u.nodeType!==3?null:u,u!==null?(o.stateNode=u,As=o,ks=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(g=Nl!==null?{id:Oa,overflow:Fa}:null,o.memoizedState={dehydrated:u,treeContext:g,retryLane:1073741824},g=Ks(18,null,null,0),g.stateNode=u,g.return=o,o.child=g,As=o,ks=null,!0):!1;default:return!1}}function tm(o){return(o.mode&1)!==0&&(o.flags&128)===0}function nm(o){if(hr){var u=ks;if(u){var g=u;if(!tx(o,u)){if(tm(o))throw Error(t(418));u=Lc(g.nextSibling);var w=As;u&&tx(o,u)?ex(w,g):(o.flags=o.flags&-4097|2,hr=!1,As=o)}}else{if(tm(o))throw Error(t(418));o.flags=o.flags&-4097|2,hr=!1,As=o}}}function nx(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;As=o}function Mh(o){if(o!==As)return!1;if(!hr)return nx(o),hr=!0,!1;var u;if((u=o.tag!==3)&&!(u=o.tag!==5)&&(u=o.type,u=u!=="head"&&u!=="body"&&!Xg(o.type,o.memoizedProps)),u&&(u=ks)){if(tm(o))throw rx(),Error(t(418));for(;u;)ex(o,u),u=Lc(u.nextSibling)}if(nx(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8){var g=o.data;if(g==="/$"){if(u===0){ks=Lc(o.nextSibling);break e}u--}else g!=="$"&&g!=="$!"&&g!=="$?"||u++}o=o.nextSibling}ks=null}}else ks=As?Lc(o.stateNode.nextSibling):null;return!0}function rx(){for(var o=ks;o;)o=Lc(o.nextSibling)}function Bu(){ks=As=null,hr=!1}function rm(o){co===null?co=[o]:co.push(o)}var G_=R.ReactCurrentBatchConfig;function Zd(o,u,g){if(o=g.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(t(309));var w=g.stateNode}if(!w)throw Error(t(147,o));var k=w,P=""+o;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===P?u.ref:(u=function(Z){var de=k.refs;Z===null?delete de[P]:de[P]=Z},u._stringRef=P,u)}if(typeof o!="string")throw Error(t(284));if(!g._owner)throw Error(t(290,o))}return o}function Bh(o,u){throw o=Object.prototype.toString.call(u),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o))}function ix(o){var u=o._init;return u(o._payload)}function sx(o){function u(Pe,be){if(o){var Oe=Pe.deletions;Oe===null?(Pe.deletions=[be],Pe.flags|=16):Oe.push(be)}}function g(Pe,be){if(!o)return null;for(;be!==null;)u(Pe,be),be=be.sibling;return null}function w(Pe,be){for(Pe=new Map;be!==null;)be.key!==null?Pe.set(be.key,be):Pe.set(be.index,be),be=be.sibling;return Pe}function k(Pe,be){return Pe=Kc(Pe,be),Pe.index=0,Pe.sibling=null,Pe}function P(Pe,be,Oe){return Pe.index=Oe,o?(Oe=Pe.alternate,Oe!==null?(Oe=Oe.index,Oe<be?(Pe.flags|=2,be):Oe):(Pe.flags|=2,be)):(Pe.flags|=1048576,be)}function Z(Pe){return o&&Pe.alternate===null&&(Pe.flags|=2),Pe}function de(Pe,be,Oe,dt){return be===null||be.tag!==6?(be=$m(Oe,Pe.mode,dt),be.return=Pe,be):(be=k(be,Oe),be.return=Pe,be)}function ye(Pe,be,Oe,dt){var Vt=Oe.type;return Vt===M?et(Pe,be,Oe.props.children,dt,Oe.key):be!==null&&(be.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===Ae&&ix(Vt)===be.type)?(dt=k(be,Oe.props),dt.ref=Zd(Pe,be,Oe),dt.return=Pe,dt):(dt=s0(Oe.type,Oe.key,Oe.props,null,Pe.mode,dt),dt.ref=Zd(Pe,be,Oe),dt.return=Pe,dt)}function Ue(Pe,be,Oe,dt){return be===null||be.tag!==4||be.stateNode.containerInfo!==Oe.containerInfo||be.stateNode.implementation!==Oe.implementation?(be=Km(Oe,Pe.mode,dt),be.return=Pe,be):(be=k(be,Oe.children||[]),be.return=Pe,be)}function et(Pe,be,Oe,dt,Vt){return be===null||be.tag!==7?(be=jl(Oe,Pe.mode,dt,Vt),be.return=Pe,be):(be=k(be,Oe),be.return=Pe,be)}function nt(Pe,be,Oe){if(typeof be=="string"&&be!==""||typeof be=="number")return be=$m(""+be,Pe.mode,Oe),be.return=Pe,be;if(typeof be=="object"&&be!==null){switch(be.$$typeof){case N:return Oe=s0(be.type,be.key,be.props,null,Pe.mode,Oe),Oe.ref=Zd(Pe,null,be),Oe.return=Pe,Oe;case V:return be=Km(be,Pe.mode,Oe),be.return=Pe,be;case Ae:var dt=be._init;return nt(Pe,dt(be._payload),Oe)}if(Xt(be)||Se(be))return be=jl(be,Pe.mode,Oe,null),be.return=Pe,be;Bh(Pe,be)}return null}function Qe(Pe,be,Oe,dt){var Vt=be!==null?be.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return Vt!==null?null:de(Pe,be,""+Oe,dt);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case N:return Oe.key===Vt?ye(Pe,be,Oe,dt):null;case V:return Oe.key===Vt?Ue(Pe,be,Oe,dt):null;case Ae:return Vt=Oe._init,Qe(Pe,be,Vt(Oe._payload),dt)}if(Xt(Oe)||Se(Oe))return Vt!==null?null:et(Pe,be,Oe,dt,null);Bh(Pe,Oe)}return null}function Tt(Pe,be,Oe,dt,Vt){if(typeof dt=="string"&&dt!==""||typeof dt=="number")return Pe=Pe.get(Oe)||null,de(be,Pe,""+dt,Vt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case N:return Pe=Pe.get(dt.key===null?Oe:dt.key)||null,ye(be,Pe,dt,Vt);case V:return Pe=Pe.get(dt.key===null?Oe:dt.key)||null,Ue(be,Pe,dt,Vt);case Ae:var Jt=dt._init;return Tt(Pe,be,Oe,Jt(dt._payload),Vt)}if(Xt(dt)||Se(dt))return Pe=Pe.get(Oe)||null,et(be,Pe,dt,Vt,null);Bh(be,dt)}return null}function Ft(Pe,be,Oe,dt){for(var Vt=null,Jt=null,Yt=be,ln=be=0,ii=null;Yt!==null&&ln<Oe.length;ln++){Yt.index>ln?(ii=Yt,Yt=null):ii=Yt.sibling;var Nn=Qe(Pe,Yt,Oe[ln],dt);if(Nn===null){Yt===null&&(Yt=ii);break}o&&Yt&&Nn.alternate===null&&u(Pe,Yt),be=P(Nn,be,ln),Jt===null?Vt=Nn:Jt.sibling=Nn,Jt=Nn,Yt=ii}if(ln===Oe.length)return g(Pe,Yt),hr&&Ml(Pe,ln),Vt;if(Yt===null){for(;ln<Oe.length;ln++)Yt=nt(Pe,Oe[ln],dt),Yt!==null&&(be=P(Yt,be,ln),Jt===null?Vt=Yt:Jt.sibling=Yt,Jt=Yt);return hr&&Ml(Pe,ln),Vt}for(Yt=w(Pe,Yt);ln<Oe.length;ln++)ii=Tt(Yt,Pe,ln,Oe[ln],dt),ii!==null&&(o&&ii.alternate!==null&&Yt.delete(ii.key===null?ln:ii.key),be=P(ii,be,ln),Jt===null?Vt=ii:Jt.sibling=ii,Jt=ii);return o&&Yt.forEach(function(qc){return u(Pe,qc)}),hr&&Ml(Pe,ln),Vt}function Ut(Pe,be,Oe,dt){var Vt=Se(Oe);if(typeof Vt!="function")throw Error(t(150));if(Oe=Vt.call(Oe),Oe==null)throw Error(t(151));for(var Jt=Vt=null,Yt=be,ln=be=0,ii=null,Nn=Oe.next();Yt!==null&&!Nn.done;ln++,Nn=Oe.next()){Yt.index>ln?(ii=Yt,Yt=null):ii=Yt.sibling;var qc=Qe(Pe,Yt,Nn.value,dt);if(qc===null){Yt===null&&(Yt=ii);break}o&&Yt&&qc.alternate===null&&u(Pe,Yt),be=P(qc,be,ln),Jt===null?Vt=qc:Jt.sibling=qc,Jt=qc,Yt=ii}if(Nn.done)return g(Pe,Yt),hr&&Ml(Pe,ln),Vt;if(Yt===null){for(;!Nn.done;ln++,Nn=Oe.next())Nn=nt(Pe,Nn.value,dt),Nn!==null&&(be=P(Nn,be,ln),Jt===null?Vt=Nn:Jt.sibling=Nn,Jt=Nn);return hr&&Ml(Pe,ln),Vt}for(Yt=w(Pe,Yt);!Nn.done;ln++,Nn=Oe.next())Nn=Tt(Yt,Pe,ln,Nn.value,dt),Nn!==null&&(o&&Nn.alternate!==null&&Yt.delete(Nn.key===null?ln:Nn.key),be=P(Nn,be,ln),Jt===null?Vt=Nn:Jt.sibling=Nn,Jt=Nn);return o&&Yt.forEach(function(CR){return u(Pe,CR)}),hr&&Ml(Pe,ln),Vt}function _r(Pe,be,Oe,dt){if(typeof Oe=="object"&&Oe!==null&&Oe.type===M&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case N:e:{for(var Vt=Oe.key,Jt=be;Jt!==null;){if(Jt.key===Vt){if(Vt=Oe.type,Vt===M){if(Jt.tag===7){g(Pe,Jt.sibling),be=k(Jt,Oe.props.children),be.return=Pe,Pe=be;break e}}else if(Jt.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===Ae&&ix(Vt)===Jt.type){g(Pe,Jt.sibling),be=k(Jt,Oe.props),be.ref=Zd(Pe,Jt,Oe),be.return=Pe,Pe=be;break e}g(Pe,Jt);break}else u(Pe,Jt);Jt=Jt.sibling}Oe.type===M?(be=jl(Oe.props.children,Pe.mode,dt,Oe.key),be.return=Pe,Pe=be):(dt=s0(Oe.type,Oe.key,Oe.props,null,Pe.mode,dt),dt.ref=Zd(Pe,be,Oe),dt.return=Pe,Pe=dt)}return Z(Pe);case V:e:{for(Jt=Oe.key;be!==null;){if(be.key===Jt)if(be.tag===4&&be.stateNode.containerInfo===Oe.containerInfo&&be.stateNode.implementation===Oe.implementation){g(Pe,be.sibling),be=k(be,Oe.children||[]),be.return=Pe,Pe=be;break e}else{g(Pe,be);break}else u(Pe,be);be=be.sibling}be=Km(Oe,Pe.mode,dt),be.return=Pe,Pe=be}return Z(Pe);case Ae:return Jt=Oe._init,_r(Pe,be,Jt(Oe._payload),dt)}if(Xt(Oe))return Ft(Pe,be,Oe,dt);if(Se(Oe))return Ut(Pe,be,Oe,dt);Bh(Pe,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"?(Oe=""+Oe,be!==null&&be.tag===6?(g(Pe,be.sibling),be=k(be,Oe),be.return=Pe,Pe=be):(g(Pe,be),be=$m(Oe,Pe.mode,dt),be.return=Pe,Pe=be),Z(Pe)):g(Pe,be)}return _r}var Ou=sx(!0),ox=sx(!1),Oh=Uc(null),Fh=null,Fu=null,im=null;function sm(){im=Fu=Fh=null}function om(o){var u=Oh.current;or(Oh),o._currentValue=u}function am(o,u,g){for(;o!==null;){var w=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,w!==null&&(w.childLanes|=u)):w!==null&&(w.childLanes&u)!==u&&(w.childLanes|=u),o===g)break;o=o.return}}function Lu(o,u){Fh=o,im=Fu=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&u)!==0&&(os=!0),o.firstContext=null)}function Zs(o){var u=o._currentValue;if(im!==o)if(o={context:o,memoizedValue:u,next:null},Fu===null){if(Fh===null)throw Error(t(308));Fu=o,Fh.dependencies={lanes:0,firstContext:o}}else Fu=Fu.next=o;return u}var Bl=null;function cm(o){Bl===null?Bl=[o]:Bl.push(o)}function ax(o,u,g,w){var k=u.interleaved;return k===null?(g.next=g,cm(u)):(g.next=k.next,k.next=g),u.interleaved=g,La(o,w)}function La(o,u){o.lanes|=u;var g=o.alternate;for(g!==null&&(g.lanes|=u),g=o,o=o.return;o!==null;)o.childLanes|=u,g=o.alternate,g!==null&&(g.childLanes|=u),g=o,o=o.return;return g.tag===3?g.stateNode:null}var jc=!1;function lm(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cx(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ua(o,u){return{eventTime:o,lane:u,tag:0,payload:null,callback:null,next:null}}function Wc(o,u,g){var w=o.updateQueue;if(w===null)return null;if(w=w.shared,(_n&2)!==0){var k=w.pending;return k===null?u.next=u:(u.next=k.next,k.next=u),w.pending=u,La(o,g)}return k=w.interleaved,k===null?(u.next=u,cm(w)):(u.next=k.next,k.next=u),w.interleaved=u,La(o,g)}function Lh(o,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194240)!==0)){var w=u.lanes;w&=o.pendingLanes,g|=w,u.lanes=g,ut(o,g)}}function lx(o,u){var g=o.updateQueue,w=o.alternate;if(w!==null&&(w=w.updateQueue,g===w)){var k=null,P=null;if(g=g.firstBaseUpdate,g!==null){do{var Z={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};P===null?k=P=Z:P=P.next=Z,g=g.next}while(g!==null);P===null?k=P=u:P=P.next=u}else k=P=u;g={baseState:w.baseState,firstBaseUpdate:k,lastBaseUpdate:P,shared:w.shared,effects:w.effects},o.updateQueue=g;return}o=g.lastBaseUpdate,o===null?g.firstBaseUpdate=u:o.next=u,g.lastBaseUpdate=u}function Uh(o,u,g,w){var k=o.updateQueue;jc=!1;var P=k.firstBaseUpdate,Z=k.lastBaseUpdate,de=k.shared.pending;if(de!==null){k.shared.pending=null;var ye=de,Ue=ye.next;ye.next=null,Z===null?P=Ue:Z.next=Ue,Z=ye;var et=o.alternate;et!==null&&(et=et.updateQueue,de=et.lastBaseUpdate,de!==Z&&(de===null?et.firstBaseUpdate=Ue:de.next=Ue,et.lastBaseUpdate=ye))}if(P!==null){var nt=k.baseState;Z=0,et=Ue=ye=null,de=P;do{var Qe=de.lane,Tt=de.eventTime;if((w&Qe)===Qe){et!==null&&(et=et.next={eventTime:Tt,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var Ft=o,Ut=de;switch(Qe=u,Tt=g,Ut.tag){case 1:if(Ft=Ut.payload,typeof Ft=="function"){nt=Ft.call(Tt,nt,Qe);break e}nt=Ft;break e;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=Ut.payload,Qe=typeof Ft=="function"?Ft.call(Tt,nt,Qe):Ft,Qe==null)break e;nt=Ee({},nt,Qe);break e;case 2:jc=!0}}de.callback!==null&&de.lane!==0&&(o.flags|=64,Qe=k.effects,Qe===null?k.effects=[de]:Qe.push(de))}else Tt={eventTime:Tt,lane:Qe,tag:de.tag,payload:de.payload,callback:de.callback,next:null},et===null?(Ue=et=Tt,ye=nt):et=et.next=Tt,Z|=Qe;if(de=de.next,de===null){if(de=k.shared.pending,de===null)break;Qe=de,de=Qe.next,Qe.next=null,k.lastBaseUpdate=Qe,k.shared.pending=null}}while(!0);if(et===null&&(ye=nt),k.baseState=ye,k.firstBaseUpdate=Ue,k.lastBaseUpdate=et,u=k.shared.interleaved,u!==null){k=u;do Z|=k.lane,k=k.next;while(k!==u)}else P===null&&(k.shared.lanes=0);Ll|=Z,o.lanes=Z,o.memoizedState=nt}}function ux(o,u,g){if(o=u.effects,u.effects=null,o!==null)for(u=0;u<o.length;u++){var w=o[u],k=w.callback;if(k!==null){if(w.callback=null,w=g,typeof k!="function")throw Error(t(191,k));k.call(w)}}}var Xd={},$o=Uc(Xd),$d=Uc(Xd),Kd=Uc(Xd);function Ol(o){if(o===Xd)throw Error(t(174));return o}function um(o,u){switch(Yn(Kd,u),Yn($d,o),Yn($o,Xd),o=u.nodeType,o){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:X(null,"");break;default:o=o===8?u.parentNode:u,u=o.namespaceURI||null,o=o.tagName,u=X(u,o)}or($o),Yn($o,u)}function Uu(){or($o),or($d),or(Kd)}function dx(o){Ol(Kd.current);var u=Ol($o.current),g=X(u,o.type);u!==g&&(Yn($d,o),Yn($o,g))}function dm(o){$d.current===o&&(or($o),or($d))}var Ir=Uc(0);function Gh(o){for(var u=o;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var fm=[];function hm(){for(var o=0;o<fm.length;o++)fm[o]._workInProgressVersionPrimary=null;fm.length=0}var Vh=R.ReactCurrentDispatcher,pm=R.ReactCurrentBatchConfig,Fl=0,br=null,Wr=null,ni=null,jh=!1,qd=!1,Jd=0,V_=0;function Ti(){throw Error(t(321))}function gm(o,u){if(u===null)return!1;for(var g=0;g<u.length&&g<o.length;g++)if(!ao(o[g],u[g]))return!1;return!0}function mm(o,u,g,w,k,P){if(Fl=P,br=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Vh.current=o===null||o.memoizedState===null?H_:Z_,o=g(w,k),qd){P=0;do{if(qd=!1,Jd=0,25<=P)throw Error(t(301));P+=1,ni=Wr=null,u.updateQueue=null,Vh.current=X_,o=g(w,k)}while(qd)}if(Vh.current=Hh,u=Wr!==null&&Wr.next!==null,Fl=0,ni=Wr=br=null,jh=!1,u)throw Error(t(300));return o}function vm(){var o=Jd!==0;return Jd=0,o}function Ko(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ni===null?br.memoizedState=ni=o:ni=ni.next=o,ni}function Xs(){if(Wr===null){var o=br.alternate;o=o!==null?o.memoizedState:null}else o=Wr.next;var u=ni===null?br.memoizedState:ni.next;if(u!==null)ni=u,Wr=o;else{if(o===null)throw Error(t(310));Wr=o,o={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},ni===null?br.memoizedState=ni=o:ni=ni.next=o}return ni}function Yd(o,u){return typeof u=="function"?u(o):u}function ym(o){var u=Xs(),g=u.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=o;var w=Wr,k=w.baseQueue,P=g.pending;if(P!==null){if(k!==null){var Z=k.next;k.next=P.next,P.next=Z}w.baseQueue=k=P,g.pending=null}if(k!==null){P=k.next,w=w.baseState;var de=Z=null,ye=null,Ue=P;do{var et=Ue.lane;if((Fl&et)===et)ye!==null&&(ye=ye.next={lane:0,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null}),w=Ue.hasEagerState?Ue.eagerState:o(w,Ue.action);else{var nt={lane:et,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null};ye===null?(de=ye=nt,Z=w):ye=ye.next=nt,br.lanes|=et,Ll|=et}Ue=Ue.next}while(Ue!==null&&Ue!==P);ye===null?Z=w:ye.next=de,ao(w,u.memoizedState)||(os=!0),u.memoizedState=w,u.baseState=Z,u.baseQueue=ye,g.lastRenderedState=w}if(o=g.interleaved,o!==null){k=o;do P=k.lane,br.lanes|=P,Ll|=P,k=k.next;while(k!==o)}else k===null&&(g.lanes=0);return[u.memoizedState,g.dispatch]}function Cm(o){var u=Xs(),g=u.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=o;var w=g.dispatch,k=g.pending,P=u.memoizedState;if(k!==null){g.pending=null;var Z=k=k.next;do P=o(P,Z.action),Z=Z.next;while(Z!==k);ao(P,u.memoizedState)||(os=!0),u.memoizedState=P,u.baseQueue===null&&(u.baseState=P),g.lastRenderedState=P}return[P,w]}function fx(){}function hx(o,u){var g=br,w=Xs(),k=u(),P=!ao(w.memoizedState,k);if(P&&(w.memoizedState=k,os=!0),w=w.queue,xm(mx.bind(null,g,w,o),[o]),w.getSnapshot!==u||P||ni!==null&&ni.memoizedState.tag&1){if(g.flags|=2048,Qd(9,gx.bind(null,g,w,k,u),void 0,null),ri===null)throw Error(t(349));(Fl&30)!==0||px(g,u,k)}return k}function px(o,u,g){o.flags|=16384,o={getSnapshot:u,value:g},u=br.updateQueue,u===null?(u={lastEffect:null,stores:null},br.updateQueue=u,u.stores=[o]):(g=u.stores,g===null?u.stores=[o]:g.push(o))}function gx(o,u,g,w){u.value=g,u.getSnapshot=w,vx(u)&&yx(o)}function mx(o,u,g){return g(function(){vx(u)&&yx(o)})}function vx(o){var u=o.getSnapshot;o=o.value;try{var g=u();return!ao(o,g)}catch{return!0}}function yx(o){var u=La(o,1);u!==null&&ho(u,o,1,-1)}function Cx(o){var u=Ko();return typeof o=="function"&&(o=o()),u.memoizedState=u.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yd,lastRenderedState:o},u.queue=o,o=o.dispatch=z_.bind(null,br,o),[u.memoizedState,o]}function Qd(o,u,g,w){return o={tag:o,create:u,destroy:g,deps:w,next:null},u=br.updateQueue,u===null?(u={lastEffect:null,stores:null},br.updateQueue=u,u.lastEffect=o.next=o):(g=u.lastEffect,g===null?u.lastEffect=o.next=o:(w=g.next,g.next=o,o.next=w,u.lastEffect=o)),o}function xx(){return Xs().memoizedState}function Wh(o,u,g,w){var k=Ko();br.flags|=o,k.memoizedState=Qd(1|u,g,void 0,w===void 0?null:w)}function zh(o,u,g,w){var k=Xs();w=w===void 0?null:w;var P=void 0;if(Wr!==null){var Z=Wr.memoizedState;if(P=Z.destroy,w!==null&&gm(w,Z.deps)){k.memoizedState=Qd(u,g,P,w);return}}br.flags|=o,k.memoizedState=Qd(1|u,g,P,w)}function wx(o,u){return Wh(8390656,8,o,u)}function xm(o,u){return zh(2048,8,o,u)}function Ix(o,u){return zh(4,2,o,u)}function bx(o,u){return zh(4,4,o,u)}function Sx(o,u){if(typeof u=="function")return o=o(),u(o),function(){u(null)};if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function Ax(o,u,g){return g=g!=null?g.concat([o]):null,zh(4,4,Sx.bind(null,u,o),g)}function wm(){}function kx(o,u){var g=Xs();u=u===void 0?null:u;var w=g.memoizedState;return w!==null&&u!==null&&gm(u,w[1])?w[0]:(g.memoizedState=[o,u],o)}function Ex(o,u){var g=Xs();u=u===void 0?null:u;var w=g.memoizedState;return w!==null&&u!==null&&gm(u,w[1])?w[0]:(o=o(),g.memoizedState=[o,u],o)}function Tx(o,u,g){return(Fl&21)===0?(o.baseState&&(o.baseState=!1,os=!0),o.memoizedState=g):(ao(g,u)||(g=se(),br.lanes|=g,Ll|=g,o.baseState=!0),u)}function j_(o,u){var g=gt;gt=g!==0&&4>g?g:4,o(!0);var w=pm.transition;pm.transition={};try{o(!1),u()}finally{gt=g,pm.transition=w}}function _x(){return Xs().memoizedState}function W_(o,u,g){var w=Xc(o);if(g={lane:w,action:g,hasEagerState:!1,eagerState:null,next:null},Rx(o))Dx(u,g);else if(g=ax(o,u,g,w),g!==null){var k=Gi();ho(g,o,w,k),Px(g,u,w)}}function z_(o,u,g){var w=Xc(o),k={lane:w,action:g,hasEagerState:!1,eagerState:null,next:null};if(Rx(o))Dx(u,k);else{var P=o.alternate;if(o.lanes===0&&(P===null||P.lanes===0)&&(P=u.lastRenderedReducer,P!==null))try{var Z=u.lastRenderedState,de=P(Z,g);if(k.hasEagerState=!0,k.eagerState=de,ao(de,Z)){var ye=u.interleaved;ye===null?(k.next=k,cm(u)):(k.next=ye.next,ye.next=k),u.interleaved=k;return}}catch{}finally{}g=ax(o,u,k,w),g!==null&&(k=Gi(),ho(g,o,w,k),Px(g,u,w))}}function Rx(o){var u=o.alternate;return o===br||u!==null&&u===br}function Dx(o,u){qd=jh=!0;var g=o.pending;g===null?u.next=u:(u.next=g.next,g.next=u),o.pending=u}function Px(o,u,g){if((g&4194240)!==0){var w=u.lanes;w&=o.pendingLanes,g|=w,u.lanes=g,ut(o,g)}}var Hh={readContext:Zs,useCallback:Ti,useContext:Ti,useEffect:Ti,useImperativeHandle:Ti,useInsertionEffect:Ti,useLayoutEffect:Ti,useMemo:Ti,useReducer:Ti,useRef:Ti,useState:Ti,useDebugValue:Ti,useDeferredValue:Ti,useTransition:Ti,useMutableSource:Ti,useSyncExternalStore:Ti,useId:Ti,unstable_isNewReconciler:!1},H_={readContext:Zs,useCallback:function(o,u){return Ko().memoizedState=[o,u===void 0?null:u],o},useContext:Zs,useEffect:wx,useImperativeHandle:function(o,u,g){return g=g!=null?g.concat([o]):null,Wh(4194308,4,Sx.bind(null,u,o),g)},useLayoutEffect:function(o,u){return Wh(4194308,4,o,u)},useInsertionEffect:function(o,u){return Wh(4,2,o,u)},useMemo:function(o,u){var g=Ko();return u=u===void 0?null:u,o=o(),g.memoizedState=[o,u],o},useReducer:function(o,u,g){var w=Ko();return u=g!==void 0?g(u):u,w.memoizedState=w.baseState=u,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:u},w.queue=o,o=o.dispatch=W_.bind(null,br,o),[w.memoizedState,o]},useRef:function(o){var u=Ko();return o={current:o},u.memoizedState=o},useState:Cx,useDebugValue:wm,useDeferredValue:function(o){return Ko().memoizedState=o},useTransition:function(){var o=Cx(!1),u=o[0];return o=j_.bind(null,o[1]),Ko().memoizedState=o,[u,o]},useMutableSource:function(){},useSyncExternalStore:function(o,u,g){var w=br,k=Ko();if(hr){if(g===void 0)throw Error(t(407));g=g()}else{if(g=u(),ri===null)throw Error(t(349));(Fl&30)!==0||px(w,u,g)}k.memoizedState=g;var P={value:g,getSnapshot:u};return k.queue=P,wx(mx.bind(null,w,P,o),[o]),w.flags|=2048,Qd(9,gx.bind(null,w,P,g,u),void 0,null),g},useId:function(){var o=Ko(),u=ri.identifierPrefix;if(hr){var g=Fa,w=Oa;g=(w&~(1<<32-Cn(w)-1)).toString(32)+g,u=":"+u+"R"+g,g=Jd++,0<g&&(u+="H"+g.toString(32)),u+=":"}else g=V_++,u=":"+u+"r"+g.toString(32)+":";return o.memoizedState=u},unstable_isNewReconciler:!1},Z_={readContext:Zs,useCallback:kx,useContext:Zs,useEffect:xm,useImperativeHandle:Ax,useInsertionEffect:Ix,useLayoutEffect:bx,useMemo:Ex,useReducer:ym,useRef:xx,useState:function(){return ym(Yd)},useDebugValue:wm,useDeferredValue:function(o){var u=Xs();return Tx(u,Wr.memoizedState,o)},useTransition:function(){var o=ym(Yd)[0],u=Xs().memoizedState;return[o,u]},useMutableSource:fx,useSyncExternalStore:hx,useId:_x,unstable_isNewReconciler:!1},X_={readContext:Zs,useCallback:kx,useContext:Zs,useEffect:xm,useImperativeHandle:Ax,useInsertionEffect:Ix,useLayoutEffect:bx,useMemo:Ex,useReducer:Cm,useRef:xx,useState:function(){return Cm(Yd)},useDebugValue:wm,useDeferredValue:function(o){var u=Xs();return Wr===null?u.memoizedState=o:Tx(u,Wr.memoizedState,o)},useTransition:function(){var o=Cm(Yd)[0],u=Xs().memoizedState;return[o,u]},useMutableSource:fx,useSyncExternalStore:hx,useId:_x,unstable_isNewReconciler:!1};function lo(o,u){if(o&&o.defaultProps){u=Ee({},u),o=o.defaultProps;for(var g in o)u[g]===void 0&&(u[g]=o[g]);return u}return u}function Im(o,u,g,w){u=o.memoizedState,g=g(w,u),g=g==null?u:Ee({},u,g),o.memoizedState=g,o.lanes===0&&(o.updateQueue.baseState=g)}var Zh={isMounted:function(o){return(o=o._reactInternals)?Fe(o)===o:!1},enqueueSetState:function(o,u,g){o=o._reactInternals;var w=Gi(),k=Xc(o),P=Ua(w,k);P.payload=u,g!=null&&(P.callback=g),u=Wc(o,P,k),u!==null&&(ho(u,o,k,w),Lh(u,o,k))},enqueueReplaceState:function(o,u,g){o=o._reactInternals;var w=Gi(),k=Xc(o),P=Ua(w,k);P.tag=1,P.payload=u,g!=null&&(P.callback=g),u=Wc(o,P,k),u!==null&&(ho(u,o,k,w),Lh(u,o,k))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var g=Gi(),w=Xc(o),k=Ua(g,w);k.tag=2,u!=null&&(k.callback=u),u=Wc(o,k,w),u!==null&&(ho(u,o,w,g),Lh(u,o,w))}};function Nx(o,u,g,w,k,P,Z){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(w,P,Z):u.prototype&&u.prototype.isPureReactComponent?!Ud(g,w)||!Ud(k,P):!0}function Mx(o,u,g){var w=!1,k=Gc,P=u.contextType;return typeof P=="object"&&P!==null?P=Zs(P):(k=ss(u)?Pl:Ei.current,w=u.contextTypes,P=(w=w!=null)?Pu(o,k):Gc),u=new u(g,P),o.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Zh,o.stateNode=u,u._reactInternals=o,w&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=k,o.__reactInternalMemoizedMaskedChildContext=P),u}function Bx(o,u,g,w){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,w),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,w),u.state!==o&&Zh.enqueueReplaceState(u,u.state,null)}function bm(o,u,g,w){var k=o.stateNode;k.props=g,k.state=o.memoizedState,k.refs={},lm(o);var P=u.contextType;typeof P=="object"&&P!==null?k.context=Zs(P):(P=ss(u)?Pl:Ei.current,k.context=Pu(o,P)),k.state=o.memoizedState,P=u.getDerivedStateFromProps,typeof P=="function"&&(Im(o,u,P,g),k.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(u=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),u!==k.state&&Zh.enqueueReplaceState(k,k.state,null),Uh(o,g,k,w),k.state=o.memoizedState),typeof k.componentDidMount=="function"&&(o.flags|=4194308)}function Gu(o,u){try{var g="",w=u;do g+=_e(w),w=w.return;while(w);var k=g}catch(P){k=`
Error generating stack: `+P.message+`
`+P.stack}return{value:o,source:u,stack:k,digest:null}}function Sm(o,u,g){return{value:o,source:null,stack:g??null,digest:u??null}}function Am(o,u){try{console.error(u.value)}catch(g){setTimeout(function(){throw g})}}var $_=typeof WeakMap=="function"?WeakMap:Map;function Ox(o,u,g){g=Ua(-1,g),g.tag=3,g.payload={element:null};var w=u.value;return g.callback=function(){Qh||(Qh=!0,Gm=w),Am(o,u)},g}function Fx(o,u,g){g=Ua(-1,g),g.tag=3;var w=o.type.getDerivedStateFromError;if(typeof w=="function"){var k=u.value;g.payload=function(){return w(k)},g.callback=function(){Am(o,u)}}var P=o.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(g.callback=function(){Am(o,u),typeof w!="function"&&(Hc===null?Hc=new Set([this]):Hc.add(this));var Z=u.stack;this.componentDidCatch(u.value,{componentStack:Z!==null?Z:""})}),g}function Lx(o,u,g){var w=o.pingCache;if(w===null){w=o.pingCache=new $_;var k=new Set;w.set(u,k)}else k=w.get(u),k===void 0&&(k=new Set,w.set(u,k));k.has(g)||(k.add(g),o=cR.bind(null,o,u,g),u.then(o,o))}function Ux(o){do{var u;if((u=o.tag===13)&&(u=o.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return o;o=o.return}while(o!==null);return null}function Gx(o,u,g,w,k){return(o.mode&1)===0?(o===u?o.flags|=65536:(o.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(u=Ua(-1,1),u.tag=2,Wc(g,u,1))),g.lanes|=1),o):(o.flags|=65536,o.lanes=k,o)}var K_=R.ReactCurrentOwner,os=!1;function Ui(o,u,g,w){u.child=o===null?ox(u,null,g,w):Ou(u,o.child,g,w)}function Vx(o,u,g,w,k){g=g.render;var P=u.ref;return Lu(u,k),w=mm(o,u,g,w,P,k),g=vm(),o!==null&&!os?(u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~k,Ga(o,u,k)):(hr&&g&&Qg(u),u.flags|=1,Ui(o,u,w,k),u.child)}function jx(o,u,g,w,k){if(o===null){var P=g.type;return typeof P=="function"&&!Xm(P)&&P.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(u.tag=15,u.type=P,Wx(o,u,P,w,k)):(o=s0(g.type,null,w,u,u.mode,k),o.ref=u.ref,o.return=u,u.child=o)}if(P=o.child,(o.lanes&k)===0){var Z=P.memoizedProps;if(g=g.compare,g=g!==null?g:Ud,g(Z,w)&&o.ref===u.ref)return Ga(o,u,k)}return u.flags|=1,o=Kc(P,w),o.ref=u.ref,o.return=u,u.child=o}function Wx(o,u,g,w,k){if(o!==null){var P=o.memoizedProps;if(Ud(P,w)&&o.ref===u.ref)if(os=!1,u.pendingProps=w=P,(o.lanes&k)!==0)(o.flags&131072)!==0&&(os=!0);else return u.lanes=o.lanes,Ga(o,u,k)}return km(o,u,g,w,k)}function zx(o,u,g){var w=u.pendingProps,k=w.children,P=o!==null?o.memoizedState:null;if(w.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Yn(ju,Es),Es|=g;else{if((g&1073741824)===0)return o=P!==null?P.baseLanes|g:g,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:o,cachePool:null,transitions:null},u.updateQueue=null,Yn(ju,Es),Es|=o,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=P!==null?P.baseLanes:g,Yn(ju,Es),Es|=w}else P!==null?(w=P.baseLanes|g,u.memoizedState=null):w=g,Yn(ju,Es),Es|=w;return Ui(o,u,k,g),u.child}function Hx(o,u){var g=u.ref;(o===null&&g!==null||o!==null&&o.ref!==g)&&(u.flags|=512,u.flags|=2097152)}function km(o,u,g,w,k){var P=ss(g)?Pl:Ei.current;return P=Pu(u,P),Lu(u,k),g=mm(o,u,g,w,P,k),w=vm(),o!==null&&!os?(u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~k,Ga(o,u,k)):(hr&&w&&Qg(u),u.flags|=1,Ui(o,u,g,k),u.child)}function Zx(o,u,g,w,k){if(ss(g)){var P=!0;Rh(u)}else P=!1;if(Lu(u,k),u.stateNode===null)$h(o,u),Mx(u,g,w),bm(u,g,w,k),w=!0;else if(o===null){var Z=u.stateNode,de=u.memoizedProps;Z.props=de;var ye=Z.context,Ue=g.contextType;typeof Ue=="object"&&Ue!==null?Ue=Zs(Ue):(Ue=ss(g)?Pl:Ei.current,Ue=Pu(u,Ue));var et=g.getDerivedStateFromProps,nt=typeof et=="function"||typeof Z.getSnapshotBeforeUpdate=="function";nt||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(de!==w||ye!==Ue)&&Bx(u,Z,w,Ue),jc=!1;var Qe=u.memoizedState;Z.state=Qe,Uh(u,w,Z,k),ye=u.memoizedState,de!==w||Qe!==ye||is.current||jc?(typeof et=="function"&&(Im(u,g,et,w),ye=u.memoizedState),(de=jc||Nx(u,g,de,w,Qe,ye,Ue))?(nt||typeof Z.UNSAFE_componentWillMount!="function"&&typeof Z.componentWillMount!="function"||(typeof Z.componentWillMount=="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount=="function"&&Z.UNSAFE_componentWillMount()),typeof Z.componentDidMount=="function"&&(u.flags|=4194308)):(typeof Z.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=w,u.memoizedState=ye),Z.props=w,Z.state=ye,Z.context=Ue,w=de):(typeof Z.componentDidMount=="function"&&(u.flags|=4194308),w=!1)}else{Z=u.stateNode,cx(o,u),de=u.memoizedProps,Ue=u.type===u.elementType?de:lo(u.type,de),Z.props=Ue,nt=u.pendingProps,Qe=Z.context,ye=g.contextType,typeof ye=="object"&&ye!==null?ye=Zs(ye):(ye=ss(g)?Pl:Ei.current,ye=Pu(u,ye));var Tt=g.getDerivedStateFromProps;(et=typeof Tt=="function"||typeof Z.getSnapshotBeforeUpdate=="function")||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(de!==nt||Qe!==ye)&&Bx(u,Z,w,ye),jc=!1,Qe=u.memoizedState,Z.state=Qe,Uh(u,w,Z,k);var Ft=u.memoizedState;de!==nt||Qe!==Ft||is.current||jc?(typeof Tt=="function"&&(Im(u,g,Tt,w),Ft=u.memoizedState),(Ue=jc||Nx(u,g,Ue,w,Qe,Ft,ye)||!1)?(et||typeof Z.UNSAFE_componentWillUpdate!="function"&&typeof Z.componentWillUpdate!="function"||(typeof Z.componentWillUpdate=="function"&&Z.componentWillUpdate(w,Ft,ye),typeof Z.UNSAFE_componentWillUpdate=="function"&&Z.UNSAFE_componentWillUpdate(w,Ft,ye)),typeof Z.componentDidUpdate=="function"&&(u.flags|=4),typeof Z.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof Z.componentDidUpdate!="function"||de===o.memoizedProps&&Qe===o.memoizedState||(u.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||de===o.memoizedProps&&Qe===o.memoizedState||(u.flags|=1024),u.memoizedProps=w,u.memoizedState=Ft),Z.props=w,Z.state=Ft,Z.context=ye,w=Ue):(typeof Z.componentDidUpdate!="function"||de===o.memoizedProps&&Qe===o.memoizedState||(u.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||de===o.memoizedProps&&Qe===o.memoizedState||(u.flags|=1024),w=!1)}return Em(o,u,g,w,P,k)}function Em(o,u,g,w,k,P){Hx(o,u);var Z=(u.flags&128)!==0;if(!w&&!Z)return k&&J1(u,g,!1),Ga(o,u,P);w=u.stateNode,K_.current=u;var de=Z&&typeof g.getDerivedStateFromError!="function"?null:w.render();return u.flags|=1,o!==null&&Z?(u.child=Ou(u,o.child,null,P),u.child=Ou(u,null,de,P)):Ui(o,u,de,P),u.memoizedState=w.state,k&&J1(u,g,!0),u.child}function Xx(o){var u=o.stateNode;u.pendingContext?K1(o,u.pendingContext,u.pendingContext!==u.context):u.context&&K1(o,u.context,!1),um(o,u.containerInfo)}function $x(o,u,g,w,k){return Bu(),rm(k),u.flags|=256,Ui(o,u,g,w),u.child}var Tm={dehydrated:null,treeContext:null,retryLane:0};function _m(o){return{baseLanes:o,cachePool:null,transitions:null}}function Kx(o,u,g){var w=u.pendingProps,k=Ir.current,P=!1,Z=(u.flags&128)!==0,de;if((de=Z)||(de=o!==null&&o.memoizedState===null?!1:(k&2)!==0),de?(P=!0,u.flags&=-129):(o===null||o.memoizedState!==null)&&(k|=1),Yn(Ir,k&1),o===null)return nm(u),o=u.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((u.mode&1)===0?u.lanes=1:o.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(Z=w.children,o=w.fallback,P?(w=u.mode,P=u.child,Z={mode:"hidden",children:Z},(w&1)===0&&P!==null?(P.childLanes=0,P.pendingProps=Z):P=o0(Z,w,0,null),o=jl(o,w,g,null),P.return=u,o.return=u,P.sibling=o,u.child=P,u.child.memoizedState=_m(g),u.memoizedState=Tm,o):Rm(u,Z));if(k=o.memoizedState,k!==null&&(de=k.dehydrated,de!==null))return q_(o,u,Z,w,de,k,g);if(P){P=w.fallback,Z=u.mode,k=o.child,de=k.sibling;var ye={mode:"hidden",children:w.children};return(Z&1)===0&&u.child!==k?(w=u.child,w.childLanes=0,w.pendingProps=ye,u.deletions=null):(w=Kc(k,ye),w.subtreeFlags=k.subtreeFlags&14680064),de!==null?P=Kc(de,P):(P=jl(P,Z,g,null),P.flags|=2),P.return=u,w.return=u,w.sibling=P,u.child=w,w=P,P=u.child,Z=o.child.memoizedState,Z=Z===null?_m(g):{baseLanes:Z.baseLanes|g,cachePool:null,transitions:Z.transitions},P.memoizedState=Z,P.childLanes=o.childLanes&~g,u.memoizedState=Tm,w}return P=o.child,o=P.sibling,w=Kc(P,{mode:"visible",children:w.children}),(u.mode&1)===0&&(w.lanes=g),w.return=u,w.sibling=null,o!==null&&(g=u.deletions,g===null?(u.deletions=[o],u.flags|=16):g.push(o)),u.child=w,u.memoizedState=null,w}function Rm(o,u){return u=o0({mode:"visible",children:u},o.mode,0,null),u.return=o,o.child=u}function Xh(o,u,g,w){return w!==null&&rm(w),Ou(u,o.child,null,g),o=Rm(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function q_(o,u,g,w,k,P,Z){if(g)return u.flags&256?(u.flags&=-257,w=Sm(Error(t(422))),Xh(o,u,Z,w)):u.memoizedState!==null?(u.child=o.child,u.flags|=128,null):(P=w.fallback,k=u.mode,w=o0({mode:"visible",children:w.children},k,0,null),P=jl(P,k,Z,null),P.flags|=2,w.return=u,P.return=u,w.sibling=P,u.child=w,(u.mode&1)!==0&&Ou(u,o.child,null,Z),u.child.memoizedState=_m(Z),u.memoizedState=Tm,P);if((u.mode&1)===0)return Xh(o,u,Z,null);if(k.data==="$!"){if(w=k.nextSibling&&k.nextSibling.dataset,w)var de=w.dgst;return w=de,P=Error(t(419)),w=Sm(P,w,void 0),Xh(o,u,Z,w)}if(de=(Z&o.childLanes)!==0,os||de){if(w=ri,w!==null){switch(Z&-Z){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(w.suspendedLanes|Z))!==0?0:k,k!==0&&k!==P.retryLane&&(P.retryLane=k,La(o,k),ho(w,o,k,-1))}return Zm(),w=Sm(Error(t(421))),Xh(o,u,Z,w)}return k.data==="$?"?(u.flags|=128,u.child=o.child,u=lR.bind(null,o),k._reactRetry=u,null):(o=P.treeContext,ks=Lc(k.nextSibling),As=u,hr=!0,co=null,o!==null&&(zs[Hs++]=Oa,zs[Hs++]=Fa,zs[Hs++]=Nl,Oa=o.id,Fa=o.overflow,Nl=u),u=Rm(u,w.children),u.flags|=4096,u)}function qx(o,u,g){o.lanes|=u;var w=o.alternate;w!==null&&(w.lanes|=u),am(o.return,u,g)}function Dm(o,u,g,w,k){var P=o.memoizedState;P===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:w,tail:g,tailMode:k}:(P.isBackwards=u,P.rendering=null,P.renderingStartTime=0,P.last=w,P.tail=g,P.tailMode=k)}function Jx(o,u,g){var w=u.pendingProps,k=w.revealOrder,P=w.tail;if(Ui(o,u,w.children,g),w=Ir.current,(w&2)!==0)w=w&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&qx(o,g,u);else if(o.tag===19)qx(o,g,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}w&=1}if(Yn(Ir,w),(u.mode&1)===0)u.memoizedState=null;else switch(k){case"forwards":for(g=u.child,k=null;g!==null;)o=g.alternate,o!==null&&Gh(o)===null&&(k=g),g=g.sibling;g=k,g===null?(k=u.child,u.child=null):(k=g.sibling,g.sibling=null),Dm(u,!1,k,g,P);break;case"backwards":for(g=null,k=u.child,u.child=null;k!==null;){if(o=k.alternate,o!==null&&Gh(o)===null){u.child=k;break}o=k.sibling,k.sibling=g,g=k,k=o}Dm(u,!0,g,null,P);break;case"together":Dm(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function $h(o,u){(u.mode&1)===0&&o!==null&&(o.alternate=null,u.alternate=null,u.flags|=2)}function Ga(o,u,g){if(o!==null&&(u.dependencies=o.dependencies),Ll|=u.lanes,(g&u.childLanes)===0)return null;if(o!==null&&u.child!==o.child)throw Error(t(153));if(u.child!==null){for(o=u.child,g=Kc(o,o.pendingProps),u.child=g,g.return=u;o.sibling!==null;)o=o.sibling,g=g.sibling=Kc(o,o.pendingProps),g.return=u;g.sibling=null}return u.child}function J_(o,u,g){switch(u.tag){case 3:Xx(u),Bu();break;case 5:dx(u);break;case 1:ss(u.type)&&Rh(u);break;case 4:um(u,u.stateNode.containerInfo);break;case 10:var w=u.type._context,k=u.memoizedProps.value;Yn(Oh,w._currentValue),w._currentValue=k;break;case 13:if(w=u.memoizedState,w!==null)return w.dehydrated!==null?(Yn(Ir,Ir.current&1),u.flags|=128,null):(g&u.child.childLanes)!==0?Kx(o,u,g):(Yn(Ir,Ir.current&1),o=Ga(o,u,g),o!==null?o.sibling:null);Yn(Ir,Ir.current&1);break;case 19:if(w=(g&u.childLanes)!==0,(o.flags&128)!==0){if(w)return Jx(o,u,g);u.flags|=128}if(k=u.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Yn(Ir,Ir.current),w)break;return null;case 22:case 23:return u.lanes=0,zx(o,u,g)}return Ga(o,u,g)}var Yx,Pm,Qx,ew;Yx=function(o,u){for(var g=u.child;g!==null;){if(g.tag===5||g.tag===6)o.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===u)break;for(;g.sibling===null;){if(g.return===null||g.return===u)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},Pm=function(){},Qx=function(o,u,g,w){var k=o.memoizedProps;if(k!==w){o=u.stateNode,Ol($o.current);var P=null;switch(g){case"input":k=Rt(o,k),w=Rt(o,w),P=[];break;case"select":k=Ee({},k,{value:void 0}),w=Ee({},w,{value:void 0}),P=[];break;case"textarea":k=ot(o,k),w=ot(o,w),P=[];break;default:typeof k.onClick!="function"&&typeof w.onClick=="function"&&(o.onclick=Eh)}mn(g,w);var Z;g=null;for(Ue in k)if(!w.hasOwnProperty(Ue)&&k.hasOwnProperty(Ue)&&k[Ue]!=null)if(Ue==="style"){var de=k[Ue];for(Z in de)de.hasOwnProperty(Z)&&(g||(g={}),g[Z]="")}else Ue!=="dangerouslySetInnerHTML"&&Ue!=="children"&&Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&Ue!=="autoFocus"&&(i.hasOwnProperty(Ue)?P||(P=[]):(P=P||[]).push(Ue,null));for(Ue in w){var ye=w[Ue];if(de=k!=null?k[Ue]:void 0,w.hasOwnProperty(Ue)&&ye!==de&&(ye!=null||de!=null))if(Ue==="style")if(de){for(Z in de)!de.hasOwnProperty(Z)||ye&&ye.hasOwnProperty(Z)||(g||(g={}),g[Z]="");for(Z in ye)ye.hasOwnProperty(Z)&&de[Z]!==ye[Z]&&(g||(g={}),g[Z]=ye[Z])}else g||(P||(P=[]),P.push(Ue,g)),g=ye;else Ue==="dangerouslySetInnerHTML"?(ye=ye?ye.__html:void 0,de=de?de.__html:void 0,ye!=null&&de!==ye&&(P=P||[]).push(Ue,ye)):Ue==="children"?typeof ye!="string"&&typeof ye!="number"||(P=P||[]).push(Ue,""+ye):Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ue)?(ye!=null&&Ue==="onScroll"&&sr("scroll",o),P||de===ye||(P=[])):(P=P||[]).push(Ue,ye))}g&&(P=P||[]).push("style",g);var Ue=P;(u.updateQueue=Ue)&&(u.flags|=4)}},ew=function(o,u,g,w){g!==w&&(u.flags|=4)};function ef(o,u){if(!hr)switch(o.tailMode){case"hidden":u=o.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?o.tail=null:g.sibling=null;break;case"collapsed":g=o.tail;for(var w=null;g!==null;)g.alternate!==null&&(w=g),g=g.sibling;w===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:w.sibling=null}}function _i(o){var u=o.alternate!==null&&o.alternate.child===o.child,g=0,w=0;if(u)for(var k=o.child;k!==null;)g|=k.lanes|k.childLanes,w|=k.subtreeFlags&14680064,w|=k.flags&14680064,k.return=o,k=k.sibling;else for(k=o.child;k!==null;)g|=k.lanes|k.childLanes,w|=k.subtreeFlags,w|=k.flags,k.return=o,k=k.sibling;return o.subtreeFlags|=w,o.childLanes=g,u}function Y_(o,u,g){var w=u.pendingProps;switch(em(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _i(u),null;case 1:return ss(u.type)&&_h(),_i(u),null;case 3:return w=u.stateNode,Uu(),or(is),or(Ei),hm(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(o===null||o.child===null)&&(Mh(u)?u.flags|=4:o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,co!==null&&(Wm(co),co=null))),Pm(o,u),_i(u),null;case 5:dm(u);var k=Ol(Kd.current);if(g=u.type,o!==null&&u.stateNode!=null)Qx(o,u,g,w,k),o.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!w){if(u.stateNode===null)throw Error(t(166));return _i(u),null}if(o=Ol($o.current),Mh(u)){w=u.stateNode,g=u.type;var P=u.memoizedProps;switch(w[Xo]=u,w[zd]=P,o=(u.mode&1)!==0,g){case"dialog":sr("cancel",w),sr("close",w);break;case"iframe":case"object":case"embed":sr("load",w);break;case"video":case"audio":for(k=0;k<Vd.length;k++)sr(Vd[k],w);break;case"source":sr("error",w);break;case"img":case"image":case"link":sr("error",w),sr("load",w);break;case"details":sr("toggle",w);break;case"input":st(w,P),sr("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!P.multiple},sr("invalid",w);break;case"textarea":le(w,P),sr("invalid",w)}mn(g,P),k=null;for(var Z in P)if(P.hasOwnProperty(Z)){var de=P[Z];Z==="children"?typeof de=="string"?w.textContent!==de&&(P.suppressHydrationWarning!==!0&&kh(w.textContent,de,o),k=["children",de]):typeof de=="number"&&w.textContent!==""+de&&(P.suppressHydrationWarning!==!0&&kh(w.textContent,de,o),k=["children",""+de]):i.hasOwnProperty(Z)&&de!=null&&Z==="onScroll"&&sr("scroll",w)}switch(g){case"input":Wt(w),jt(w,P,!0);break;case"textarea":Wt(w),vn(w);break;case"select":case"option":break;default:typeof P.onClick=="function"&&(w.onclick=Eh)}w=k,u.updateQueue=w,w!==null&&(u.flags|=4)}else{Z=k.nodeType===9?k:k.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Ln(g)),o==="http://www.w3.org/1999/xhtml"?g==="script"?(o=Z.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof w.is=="string"?o=Z.createElement(g,{is:w.is}):(o=Z.createElement(g),g==="select"&&(Z=o,w.multiple?Z.multiple=!0:w.size&&(Z.size=w.size))):o=Z.createElementNS(o,g),o[Xo]=u,o[zd]=w,Yx(o,u,!1,!1),u.stateNode=o;e:{switch(Z=wn(g,w),g){case"dialog":sr("cancel",o),sr("close",o),k=w;break;case"iframe":case"object":case"embed":sr("load",o),k=w;break;case"video":case"audio":for(k=0;k<Vd.length;k++)sr(Vd[k],o);k=w;break;case"source":sr("error",o),k=w;break;case"img":case"image":case"link":sr("error",o),sr("load",o),k=w;break;case"details":sr("toggle",o),k=w;break;case"input":st(o,w),k=Rt(o,w),sr("invalid",o);break;case"option":k=w;break;case"select":o._wrapperState={wasMultiple:!!w.multiple},k=Ee({},w,{value:void 0}),sr("invalid",o);break;case"textarea":le(o,w),k=ot(o,w),sr("invalid",o);break;default:k=w}mn(g,k),de=k;for(P in de)if(de.hasOwnProperty(P)){var ye=de[P];P==="style"?Lt(o,ye):P==="dangerouslySetInnerHTML"?(ye=ye?ye.__html:void 0,ye!=null&&B(o,ye)):P==="children"?typeof ye=="string"?(g!=="textarea"||ye!=="")&&te(o,ye):typeof ye=="number"&&te(o,""+ye):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(i.hasOwnProperty(P)?ye!=null&&P==="onScroll"&&sr("scroll",o):ye!=null&&E(o,P,ye,Z))}switch(g){case"input":Wt(o),jt(o,w,!1);break;case"textarea":Wt(o),vn(o);break;case"option":w.value!=null&&o.setAttribute("value",""+ve(w.value));break;case"select":o.multiple=!!w.multiple,P=w.value,P!=null?an(o,!!w.multiple,P,!1):w.defaultValue!=null&&an(o,!!w.multiple,w.defaultValue,!0);break;default:typeof k.onClick=="function"&&(o.onclick=Eh)}switch(g){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return _i(u),null;case 6:if(o&&u.stateNode!=null)ew(o,u,o.memoizedProps,w);else{if(typeof w!="string"&&u.stateNode===null)throw Error(t(166));if(g=Ol(Kd.current),Ol($o.current),Mh(u)){if(w=u.stateNode,g=u.memoizedProps,w[Xo]=u,(P=w.nodeValue!==g)&&(o=As,o!==null))switch(o.tag){case 3:kh(w.nodeValue,g,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&kh(w.nodeValue,g,(o.mode&1)!==0)}P&&(u.flags|=4)}else w=(g.nodeType===9?g:g.ownerDocument).createTextNode(w),w[Xo]=u,u.stateNode=w}return _i(u),null;case 13:if(or(Ir),w=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(hr&&ks!==null&&(u.mode&1)!==0&&(u.flags&128)===0)rx(),Bu(),u.flags|=98560,P=!1;else if(P=Mh(u),w!==null&&w.dehydrated!==null){if(o===null){if(!P)throw Error(t(318));if(P=u.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(t(317));P[Xo]=u}else Bu(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;_i(u),P=!1}else co!==null&&(Wm(co),co=null),P=!0;if(!P)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=g,u):(w=w!==null,w!==(o!==null&&o.memoizedState!==null)&&w&&(u.child.flags|=8192,(u.mode&1)!==0&&(o===null||(Ir.current&1)!==0?zr===0&&(zr=3):Zm())),u.updateQueue!==null&&(u.flags|=4),_i(u),null);case 4:return Uu(),Pm(o,u),o===null&&jd(u.stateNode.containerInfo),_i(u),null;case 10:return om(u.type._context),_i(u),null;case 17:return ss(u.type)&&_h(),_i(u),null;case 19:if(or(Ir),P=u.memoizedState,P===null)return _i(u),null;if(w=(u.flags&128)!==0,Z=P.rendering,Z===null)if(w)ef(P,!1);else{if(zr!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(Z=Gh(o),Z!==null){for(u.flags|=128,ef(P,!1),w=Z.updateQueue,w!==null&&(u.updateQueue=w,u.flags|=4),u.subtreeFlags=0,w=g,g=u.child;g!==null;)P=g,o=w,P.flags&=14680066,Z=P.alternate,Z===null?(P.childLanes=0,P.lanes=o,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=Z.childLanes,P.lanes=Z.lanes,P.child=Z.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=Z.memoizedProps,P.memoizedState=Z.memoizedState,P.updateQueue=Z.updateQueue,P.type=Z.type,o=Z.dependencies,P.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),g=g.sibling;return Yn(Ir,Ir.current&1|2),u.child}o=o.sibling}P.tail!==null&&wt()>Wu&&(u.flags|=128,w=!0,ef(P,!1),u.lanes=4194304)}else{if(!w)if(o=Gh(Z),o!==null){if(u.flags|=128,w=!0,g=o.updateQueue,g!==null&&(u.updateQueue=g,u.flags|=4),ef(P,!0),P.tail===null&&P.tailMode==="hidden"&&!Z.alternate&&!hr)return _i(u),null}else 2*wt()-P.renderingStartTime>Wu&&g!==1073741824&&(u.flags|=128,w=!0,ef(P,!1),u.lanes=4194304);P.isBackwards?(Z.sibling=u.child,u.child=Z):(g=P.last,g!==null?g.sibling=Z:u.child=Z,P.last=Z)}return P.tail!==null?(u=P.tail,P.rendering=u,P.tail=u.sibling,P.renderingStartTime=wt(),u.sibling=null,g=Ir.current,Yn(Ir,w?g&1|2:g&1),u):(_i(u),null);case 22:case 23:return Hm(),w=u.memoizedState!==null,o!==null&&o.memoizedState!==null!==w&&(u.flags|=8192),w&&(u.mode&1)!==0?(Es&1073741824)!==0&&(_i(u),u.subtreeFlags&6&&(u.flags|=8192)):_i(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function Q_(o,u){switch(em(u),u.tag){case 1:return ss(u.type)&&_h(),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return Uu(),or(is),or(Ei),hm(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 5:return dm(u),null;case 13:if(or(Ir),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(t(340));Bu()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return or(Ir),null;case 4:return Uu(),null;case 10:return om(u.type._context),null;case 22:case 23:return Hm(),null;case 24:return null;default:return null}}var Kh=!1,Ri=!1,eR=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function Vu(o,u){var g=o.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(w){kr(o,u,w)}else g.current=null}function Nm(o,u,g){try{g()}catch(w){kr(o,u,w)}}var tw=!1;function tR(o,u){if(Hg=ir,o=N1(),Fg(o)){if("selectionStart"in o)var g={start:o.selectionStart,end:o.selectionEnd};else e:{g=(g=o.ownerDocument)&&g.defaultView||window;var w=g.getSelection&&g.getSelection();if(w&&w.rangeCount!==0){g=w.anchorNode;var k=w.anchorOffset,P=w.focusNode;w=w.focusOffset;try{g.nodeType,P.nodeType}catch{g=null;break e}var Z=0,de=-1,ye=-1,Ue=0,et=0,nt=o,Qe=null;t:for(;;){for(var Tt;nt!==g||k!==0&&nt.nodeType!==3||(de=Z+k),nt!==P||w!==0&&nt.nodeType!==3||(ye=Z+w),nt.nodeType===3&&(Z+=nt.nodeValue.length),(Tt=nt.firstChild)!==null;)Qe=nt,nt=Tt;for(;;){if(nt===o)break t;if(Qe===g&&++Ue===k&&(de=Z),Qe===P&&++et===w&&(ye=Z),(Tt=nt.nextSibling)!==null)break;nt=Qe,Qe=nt.parentNode}nt=Tt}g=de===-1||ye===-1?null:{start:de,end:ye}}else g=null}g=g||{start:0,end:0}}else g=null;for(Zg={focusedElem:o,selectionRange:g},ir=!1,Dt=u;Dt!==null;)if(u=Dt,o=u.child,(u.subtreeFlags&1028)!==0&&o!==null)o.return=u,Dt=o;else for(;Dt!==null;){u=Dt;try{var Ft=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(Ft!==null){var Ut=Ft.memoizedProps,_r=Ft.memoizedState,Pe=u.stateNode,be=Pe.getSnapshotBeforeUpdate(u.elementType===u.type?Ut:lo(u.type,Ut),_r);Pe.__reactInternalSnapshotBeforeUpdate=be}break;case 3:var Oe=u.stateNode.containerInfo;Oe.nodeType===1?Oe.textContent="":Oe.nodeType===9&&Oe.documentElement&&Oe.removeChild(Oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(dt){kr(u,u.return,dt)}if(o=u.sibling,o!==null){o.return=u.return,Dt=o;break}Dt=u.return}return Ft=tw,tw=!1,Ft}function tf(o,u,g){var w=u.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var k=w=w.next;do{if((k.tag&o)===o){var P=k.destroy;k.destroy=void 0,P!==void 0&&Nm(u,g,P)}k=k.next}while(k!==w)}}function qh(o,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var g=u=u.next;do{if((g.tag&o)===o){var w=g.create;g.destroy=w()}g=g.next}while(g!==u)}}function Mm(o){var u=o.ref;if(u!==null){var g=o.stateNode;switch(o.tag){case 5:o=g;break;default:o=g}typeof u=="function"?u(o):u.current=o}}function nw(o){var u=o.alternate;u!==null&&(o.alternate=null,nw(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&(delete u[Xo],delete u[zd],delete u[qg],delete u[F_],delete u[L_])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function rw(o){return o.tag===5||o.tag===3||o.tag===4}function iw(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||rw(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Bm(o,u,g){var w=o.tag;if(w===5||w===6)o=o.stateNode,u?g.nodeType===8?g.parentNode.insertBefore(o,u):g.insertBefore(o,u):(g.nodeType===8?(u=g.parentNode,u.insertBefore(o,g)):(u=g,u.appendChild(o)),g=g._reactRootContainer,g!=null||u.onclick!==null||(u.onclick=Eh));else if(w!==4&&(o=o.child,o!==null))for(Bm(o,u,g),o=o.sibling;o!==null;)Bm(o,u,g),o=o.sibling}function Om(o,u,g){var w=o.tag;if(w===5||w===6)o=o.stateNode,u?g.insertBefore(o,u):g.appendChild(o);else if(w!==4&&(o=o.child,o!==null))for(Om(o,u,g),o=o.sibling;o!==null;)Om(o,u,g),o=o.sibling}var fi=null,uo=!1;function zc(o,u,g){for(g=g.child;g!==null;)sw(o,u,g),g=g.sibling}function sw(o,u,g){if(rr&&typeof rr.onCommitFiberUnmount=="function")try{rr.onCommitFiberUnmount(yn,g)}catch{}switch(g.tag){case 5:Ri||Vu(g,u);case 6:var w=fi,k=uo;fi=null,zc(o,u,g),fi=w,uo=k,fi!==null&&(uo?(o=fi,g=g.stateNode,o.nodeType===8?o.parentNode.removeChild(g):o.removeChild(g)):fi.removeChild(g.stateNode));break;case 18:fi!==null&&(uo?(o=fi,g=g.stateNode,o.nodeType===8?Kg(o.parentNode,g):o.nodeType===1&&Kg(o,g),vt(o)):Kg(fi,g.stateNode));break;case 4:w=fi,k=uo,fi=g.stateNode.containerInfo,uo=!0,zc(o,u,g),fi=w,uo=k;break;case 0:case 11:case 14:case 15:if(!Ri&&(w=g.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){k=w=w.next;do{var P=k,Z=P.destroy;P=P.tag,Z!==void 0&&((P&2)!==0||(P&4)!==0)&&Nm(g,u,Z),k=k.next}while(k!==w)}zc(o,u,g);break;case 1:if(!Ri&&(Vu(g,u),w=g.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=g.memoizedProps,w.state=g.memoizedState,w.componentWillUnmount()}catch(de){kr(g,u,de)}zc(o,u,g);break;case 21:zc(o,u,g);break;case 22:g.mode&1?(Ri=(w=Ri)||g.memoizedState!==null,zc(o,u,g),Ri=w):zc(o,u,g);break;default:zc(o,u,g)}}function ow(o){var u=o.updateQueue;if(u!==null){o.updateQueue=null;var g=o.stateNode;g===null&&(g=o.stateNode=new eR),u.forEach(function(w){var k=uR.bind(null,o,w);g.has(w)||(g.add(w),w.then(k,k))})}}function fo(o,u){var g=u.deletions;if(g!==null)for(var w=0;w<g.length;w++){var k=g[w];try{var P=o,Z=u,de=Z;e:for(;de!==null;){switch(de.tag){case 5:fi=de.stateNode,uo=!1;break e;case 3:fi=de.stateNode.containerInfo,uo=!0;break e;case 4:fi=de.stateNode.containerInfo,uo=!0;break e}de=de.return}if(fi===null)throw Error(t(160));sw(P,Z,k),fi=null,uo=!1;var ye=k.alternate;ye!==null&&(ye.return=null),k.return=null}catch(Ue){kr(k,u,Ue)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)aw(u,o),u=u.sibling}function aw(o,u){var g=o.alternate,w=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(fo(u,o),qo(o),w&4){try{tf(3,o,o.return),qh(3,o)}catch(Ut){kr(o,o.return,Ut)}try{tf(5,o,o.return)}catch(Ut){kr(o,o.return,Ut)}}break;case 1:fo(u,o),qo(o),w&512&&g!==null&&Vu(g,g.return);break;case 5:if(fo(u,o),qo(o),w&512&&g!==null&&Vu(g,g.return),o.flags&32){var k=o.stateNode;try{te(k,"")}catch(Ut){kr(o,o.return,Ut)}}if(w&4&&(k=o.stateNode,k!=null)){var P=o.memoizedProps,Z=g!==null?g.memoizedProps:P,de=o.type,ye=o.updateQueue;if(o.updateQueue=null,ye!==null)try{de==="input"&&P.type==="radio"&&P.name!=null&&at(k,P),wn(de,Z);var Ue=wn(de,P);for(Z=0;Z<ye.length;Z+=2){var et=ye[Z],nt=ye[Z+1];et==="style"?Lt(k,nt):et==="dangerouslySetInnerHTML"?B(k,nt):et==="children"?te(k,nt):E(k,et,nt,Ue)}switch(de){case"input":zt(k,P);break;case"textarea":nn(k,P);break;case"select":var Qe=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!P.multiple;var Tt=P.value;Tt!=null?an(k,!!P.multiple,Tt,!1):Qe!==!!P.multiple&&(P.defaultValue!=null?an(k,!!P.multiple,P.defaultValue,!0):an(k,!!P.multiple,P.multiple?[]:"",!1))}k[zd]=P}catch(Ut){kr(o,o.return,Ut)}}break;case 6:if(fo(u,o),qo(o),w&4){if(o.stateNode===null)throw Error(t(162));k=o.stateNode,P=o.memoizedProps;try{k.nodeValue=P}catch(Ut){kr(o,o.return,Ut)}}break;case 3:if(fo(u,o),qo(o),w&4&&g!==null&&g.memoizedState.isDehydrated)try{vt(u.containerInfo)}catch(Ut){kr(o,o.return,Ut)}break;case 4:fo(u,o),qo(o);break;case 13:fo(u,o),qo(o),k=o.child,k.flags&8192&&(P=k.memoizedState!==null,k.stateNode.isHidden=P,!P||k.alternate!==null&&k.alternate.memoizedState!==null||(Um=wt())),w&4&&ow(o);break;case 22:if(et=g!==null&&g.memoizedState!==null,o.mode&1?(Ri=(Ue=Ri)||et,fo(u,o),Ri=Ue):fo(u,o),qo(o),w&8192){if(Ue=o.memoizedState!==null,(o.stateNode.isHidden=Ue)&&!et&&(o.mode&1)!==0)for(Dt=o,et=o.child;et!==null;){for(nt=Dt=et;Dt!==null;){switch(Qe=Dt,Tt=Qe.child,Qe.tag){case 0:case 11:case 14:case 15:tf(4,Qe,Qe.return);break;case 1:Vu(Qe,Qe.return);var Ft=Qe.stateNode;if(typeof Ft.componentWillUnmount=="function"){w=Qe,g=Qe.return;try{u=w,Ft.props=u.memoizedProps,Ft.state=u.memoizedState,Ft.componentWillUnmount()}catch(Ut){kr(w,g,Ut)}}break;case 5:Vu(Qe,Qe.return);break;case 22:if(Qe.memoizedState!==null){uw(nt);continue}}Tt!==null?(Tt.return=Qe,Dt=Tt):uw(nt)}et=et.sibling}e:for(et=null,nt=o;;){if(nt.tag===5){if(et===null){et=nt;try{k=nt.stateNode,Ue?(P=k.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none"):(de=nt.stateNode,ye=nt.memoizedProps.style,Z=ye!=null&&ye.hasOwnProperty("display")?ye.display:null,de.style.display=Ge("display",Z))}catch(Ut){kr(o,o.return,Ut)}}}else if(nt.tag===6){if(et===null)try{nt.stateNode.nodeValue=Ue?"":nt.memoizedProps}catch(Ut){kr(o,o.return,Ut)}}else if((nt.tag!==22&&nt.tag!==23||nt.memoizedState===null||nt===o)&&nt.child!==null){nt.child.return=nt,nt=nt.child;continue}if(nt===o)break e;for(;nt.sibling===null;){if(nt.return===null||nt.return===o)break e;et===nt&&(et=null),nt=nt.return}et===nt&&(et=null),nt.sibling.return=nt.return,nt=nt.sibling}}break;case 19:fo(u,o),qo(o),w&4&&ow(o);break;case 21:break;default:fo(u,o),qo(o)}}function qo(o){var u=o.flags;if(u&2){try{e:{for(var g=o.return;g!==null;){if(rw(g)){var w=g;break e}g=g.return}throw Error(t(160))}switch(w.tag){case 5:var k=w.stateNode;w.flags&32&&(te(k,""),w.flags&=-33);var P=iw(o);Om(o,P,k);break;case 3:case 4:var Z=w.stateNode.containerInfo,de=iw(o);Bm(o,de,Z);break;default:throw Error(t(161))}}catch(ye){kr(o,o.return,ye)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function nR(o,u,g){Dt=o,cw(o)}function cw(o,u,g){for(var w=(o.mode&1)!==0;Dt!==null;){var k=Dt,P=k.child;if(k.tag===22&&w){var Z=k.memoizedState!==null||Kh;if(!Z){var de=k.alternate,ye=de!==null&&de.memoizedState!==null||Ri;de=Kh;var Ue=Ri;if(Kh=Z,(Ri=ye)&&!Ue)for(Dt=k;Dt!==null;)Z=Dt,ye=Z.child,Z.tag===22&&Z.memoizedState!==null?dw(k):ye!==null?(ye.return=Z,Dt=ye):dw(k);for(;P!==null;)Dt=P,cw(P),P=P.sibling;Dt=k,Kh=de,Ri=Ue}lw(o)}else(k.subtreeFlags&8772)!==0&&P!==null?(P.return=k,Dt=P):lw(o)}}function lw(o){for(;Dt!==null;){var u=Dt;if((u.flags&8772)!==0){var g=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Ri||qh(5,u);break;case 1:var w=u.stateNode;if(u.flags&4&&!Ri)if(g===null)w.componentDidMount();else{var k=u.elementType===u.type?g.memoizedProps:lo(u.type,g.memoizedProps);w.componentDidUpdate(k,g.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var P=u.updateQueue;P!==null&&ux(u,P,w);break;case 3:var Z=u.updateQueue;if(Z!==null){if(g=null,u.child!==null)switch(u.child.tag){case 5:g=u.child.stateNode;break;case 1:g=u.child.stateNode}ux(u,Z,g)}break;case 5:var de=u.stateNode;if(g===null&&u.flags&4){g=de;var ye=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":ye.autoFocus&&g.focus();break;case"img":ye.src&&(g.src=ye.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Ue=u.alternate;if(Ue!==null){var et=Ue.memoizedState;if(et!==null){var nt=et.dehydrated;nt!==null&&vt(nt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ri||u.flags&512&&Mm(u)}catch(Qe){kr(u,u.return,Qe)}}if(u===o){Dt=null;break}if(g=u.sibling,g!==null){g.return=u.return,Dt=g;break}Dt=u.return}}function uw(o){for(;Dt!==null;){var u=Dt;if(u===o){Dt=null;break}var g=u.sibling;if(g!==null){g.return=u.return,Dt=g;break}Dt=u.return}}function dw(o){for(;Dt!==null;){var u=Dt;try{switch(u.tag){case 0:case 11:case 15:var g=u.return;try{qh(4,u)}catch(ye){kr(u,g,ye)}break;case 1:var w=u.stateNode;if(typeof w.componentDidMount=="function"){var k=u.return;try{w.componentDidMount()}catch(ye){kr(u,k,ye)}}var P=u.return;try{Mm(u)}catch(ye){kr(u,P,ye)}break;case 5:var Z=u.return;try{Mm(u)}catch(ye){kr(u,Z,ye)}}}catch(ye){kr(u,u.return,ye)}if(u===o){Dt=null;break}var de=u.sibling;if(de!==null){de.return=u.return,Dt=de;break}Dt=u.return}}var rR=Math.ceil,Jh=R.ReactCurrentDispatcher,Fm=R.ReactCurrentOwner,$s=R.ReactCurrentBatchConfig,_n=0,ri=null,Br=null,hi=0,Es=0,ju=Uc(0),zr=0,nf=null,Ll=0,Yh=0,Lm=0,rf=null,as=null,Um=0,Wu=1/0,Va=null,Qh=!1,Gm=null,Hc=null,e0=!1,Zc=null,t0=0,sf=0,Vm=null,n0=-1,r0=0;function Gi(){return(_n&6)!==0?wt():n0!==-1?n0:n0=wt()}function Xc(o){return(o.mode&1)===0?1:(_n&2)!==0&&hi!==0?hi&-hi:G_.transition!==null?(r0===0&&(r0=se()),r0):(o=gt,o!==0||(o=window.event,o=o===void 0?16:Dc(o.type)),o)}function ho(o,u,g,w){if(50<sf)throw sf=0,Vm=null,Error(t(185));ke(o,g,w),((_n&2)===0||o!==ri)&&(o===ri&&((_n&2)===0&&(Yh|=g),zr===4&&$c(o,hi)),cs(o,w),g===1&&_n===0&&(u.mode&1)===0&&(Wu=wt()+500,Dh&&Vc()))}function cs(o,u){var g=o.callbackNode;U(o,u);var w=rn(o,o===ri?hi:0);if(w===0)g!==null&&xt(g),o.callbackNode=null,o.callbackPriority=0;else if(u=w&-w,o.callbackPriority!==u){if(g!=null&&xt(g),u===1)o.tag===0?U_(hw.bind(null,o)):Y1(hw.bind(null,o)),B_(function(){(_n&6)===0&&Vc()}),g=null;else{switch(qt(w)){case 1:g=Kn;break;case 4:g=qn;break;case 16:g=nr;break;case 536870912:g=tn;break;default:g=nr}g=ww(g,fw.bind(null,o))}o.callbackPriority=u,o.callbackNode=g}}function fw(o,u){if(n0=-1,r0=0,(_n&6)!==0)throw Error(t(327));var g=o.callbackNode;if(zu()&&o.callbackNode!==g)return null;var w=rn(o,o===ri?hi:0);if(w===0)return null;if((w&30)!==0||(w&o.expiredLanes)!==0||u)u=i0(o,w);else{u=w;var k=_n;_n|=2;var P=gw();(ri!==o||hi!==u)&&(Va=null,Wu=wt()+500,Gl(o,u));do try{oR();break}catch(de){pw(o,de)}while(!0);sm(),Jh.current=P,_n=k,Br!==null?u=0:(ri=null,hi=0,u=zr)}if(u!==0){if(u===2&&(k=q(o),k!==0&&(w=k,u=jm(o,k))),u===1)throw g=nf,Gl(o,0),$c(o,w),cs(o,wt()),g;if(u===6)$c(o,w);else{if(k=o.current.alternate,(w&30)===0&&!iR(k)&&(u=i0(o,w),u===2&&(P=q(o),P!==0&&(w=P,u=jm(o,P))),u===1))throw g=nf,Gl(o,0),$c(o,w),cs(o,wt()),g;switch(o.finishedWork=k,o.finishedLanes=w,u){case 0:case 1:throw Error(t(345));case 2:Vl(o,as,Va);break;case 3:if($c(o,w),(w&130023424)===w&&(u=Um+500-wt(),10<u)){if(rn(o,0)!==0)break;if(k=o.suspendedLanes,(k&w)!==w){Gi(),o.pingedLanes|=o.suspendedLanes&k;break}o.timeoutHandle=$g(Vl.bind(null,o,as,Va),u);break}Vl(o,as,Va);break;case 4:if($c(o,w),(w&4194240)===w)break;for(u=o.eventTimes,k=-1;0<w;){var Z=31-Cn(w);P=1<<Z,Z=u[Z],Z>k&&(k=Z),w&=~P}if(w=k,w=wt()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*rR(w/1960))-w,10<w){o.timeoutHandle=$g(Vl.bind(null,o,as,Va),w);break}Vl(o,as,Va);break;case 5:Vl(o,as,Va);break;default:throw Error(t(329))}}}return cs(o,wt()),o.callbackNode===g?fw.bind(null,o):null}function jm(o,u){var g=rf;return o.current.memoizedState.isDehydrated&&(Gl(o,u).flags|=256),o=i0(o,u),o!==2&&(u=as,as=g,u!==null&&Wm(u)),o}function Wm(o){as===null?as=o:as.push.apply(as,o)}function iR(o){for(var u=o;;){if(u.flags&16384){var g=u.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var w=0;w<g.length;w++){var k=g[w],P=k.getSnapshot;k=k.value;try{if(!ao(P(),k))return!1}catch{return!1}}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function $c(o,u){for(u&=~Lm,u&=~Yh,o.suspendedLanes|=u,o.pingedLanes&=~u,o=o.expirationTimes;0<u;){var g=31-Cn(u),w=1<<g;o[g]=-1,u&=~w}}function hw(o){if((_n&6)!==0)throw Error(t(327));zu();var u=rn(o,0);if((u&1)===0)return cs(o,wt()),null;var g=i0(o,u);if(o.tag!==0&&g===2){var w=q(o);w!==0&&(u=w,g=jm(o,w))}if(g===1)throw g=nf,Gl(o,0),$c(o,u),cs(o,wt()),g;if(g===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=u,Vl(o,as,Va),cs(o,wt()),null}function zm(o,u){var g=_n;_n|=1;try{return o(u)}finally{_n=g,_n===0&&(Wu=wt()+500,Dh&&Vc())}}function Ul(o){Zc!==null&&Zc.tag===0&&(_n&6)===0&&zu();var u=_n;_n|=1;var g=$s.transition,w=gt;try{if($s.transition=null,gt=1,o)return o()}finally{gt=w,$s.transition=g,_n=u,(_n&6)===0&&Vc()}}function Hm(){Es=ju.current,or(ju)}function Gl(o,u){o.finishedWork=null,o.finishedLanes=0;var g=o.timeoutHandle;if(g!==-1&&(o.timeoutHandle=-1,M_(g)),Br!==null)for(g=Br.return;g!==null;){var w=g;switch(em(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&_h();break;case 3:Uu(),or(is),or(Ei),hm();break;case 5:dm(w);break;case 4:Uu();break;case 13:or(Ir);break;case 19:or(Ir);break;case 10:om(w.type._context);break;case 22:case 23:Hm()}g=g.return}if(ri=o,Br=o=Kc(o.current,null),hi=Es=u,zr=0,nf=null,Lm=Yh=Ll=0,as=rf=null,Bl!==null){for(u=0;u<Bl.length;u++)if(g=Bl[u],w=g.interleaved,w!==null){g.interleaved=null;var k=w.next,P=g.pending;if(P!==null){var Z=P.next;P.next=k,w.next=Z}g.pending=w}Bl=null}return o}function pw(o,u){do{var g=Br;try{if(sm(),Vh.current=Hh,jh){for(var w=br.memoizedState;w!==null;){var k=w.queue;k!==null&&(k.pending=null),w=w.next}jh=!1}if(Fl=0,ni=Wr=br=null,qd=!1,Jd=0,Fm.current=null,g===null||g.return===null){zr=1,nf=u,Br=null;break}e:{var P=o,Z=g.return,de=g,ye=u;if(u=hi,de.flags|=32768,ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var Ue=ye,et=de,nt=et.tag;if((et.mode&1)===0&&(nt===0||nt===11||nt===15)){var Qe=et.alternate;Qe?(et.updateQueue=Qe.updateQueue,et.memoizedState=Qe.memoizedState,et.lanes=Qe.lanes):(et.updateQueue=null,et.memoizedState=null)}var Tt=Ux(Z);if(Tt!==null){Tt.flags&=-257,Gx(Tt,Z,de,P,u),Tt.mode&1&&Lx(P,Ue,u),u=Tt,ye=Ue;var Ft=u.updateQueue;if(Ft===null){var Ut=new Set;Ut.add(ye),u.updateQueue=Ut}else Ft.add(ye);break e}else{if((u&1)===0){Lx(P,Ue,u),Zm();break e}ye=Error(t(426))}}else if(hr&&de.mode&1){var _r=Ux(Z);if(_r!==null){(_r.flags&65536)===0&&(_r.flags|=256),Gx(_r,Z,de,P,u),rm(Gu(ye,de));break e}}P=ye=Gu(ye,de),zr!==4&&(zr=2),rf===null?rf=[P]:rf.push(P),P=Z;do{switch(P.tag){case 3:P.flags|=65536,u&=-u,P.lanes|=u;var Pe=Ox(P,ye,u);lx(P,Pe);break e;case 1:de=ye;var be=P.type,Oe=P.stateNode;if((P.flags&128)===0&&(typeof be.getDerivedStateFromError=="function"||Oe!==null&&typeof Oe.componentDidCatch=="function"&&(Hc===null||!Hc.has(Oe)))){P.flags|=65536,u&=-u,P.lanes|=u;var dt=Fx(P,de,u);lx(P,dt);break e}}P=P.return}while(P!==null)}vw(g)}catch(Vt){u=Vt,Br===g&&g!==null&&(Br=g=g.return);continue}break}while(!0)}function gw(){var o=Jh.current;return Jh.current=Hh,o===null?Hh:o}function Zm(){(zr===0||zr===3||zr===2)&&(zr=4),ri===null||(Ll&268435455)===0&&(Yh&268435455)===0||$c(ri,hi)}function i0(o,u){var g=_n;_n|=2;var w=gw();(ri!==o||hi!==u)&&(Va=null,Gl(o,u));do try{sR();break}catch(k){pw(o,k)}while(!0);if(sm(),_n=g,Jh.current=w,Br!==null)throw Error(t(261));return ri=null,hi=0,zr}function sR(){for(;Br!==null;)mw(Br)}function oR(){for(;Br!==null&&!bn();)mw(Br)}function mw(o){var u=xw(o.alternate,o,Es);o.memoizedProps=o.pendingProps,u===null?vw(o):Br=u,Fm.current=null}function vw(o){var u=o;do{var g=u.alternate;if(o=u.return,(u.flags&32768)===0){if(g=Y_(g,u,Es),g!==null){Br=g;return}}else{if(g=Q_(g,u),g!==null){g.flags&=32767,Br=g;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{zr=6,Br=null;return}}if(u=u.sibling,u!==null){Br=u;return}Br=u=o}while(u!==null);zr===0&&(zr=5)}function Vl(o,u,g){var w=gt,k=$s.transition;try{$s.transition=null,gt=1,aR(o,u,g,w)}finally{$s.transition=k,gt=w}return null}function aR(o,u,g,w){do zu();while(Zc!==null);if((_n&6)!==0)throw Error(t(327));g=o.finishedWork;var k=o.finishedLanes;if(g===null)return null;if(o.finishedWork=null,o.finishedLanes=0,g===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var P=g.lanes|g.childLanes;if(je(o,P),o===ri&&(Br=ri=null,hi=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||e0||(e0=!0,ww(nr,function(){return zu(),null})),P=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||P){P=$s.transition,$s.transition=null;var Z=gt;gt=1;var de=_n;_n|=4,Fm.current=null,tR(o,g),aw(g,o),E_(Zg),ir=!!Hg,Zg=Hg=null,o.current=g,nR(g),Ot(),_n=de,gt=Z,$s.transition=P}else o.current=g;if(e0&&(e0=!1,Zc=o,t0=k),P=o.pendingLanes,P===0&&(Hc=null),li(g.stateNode),cs(o,wt()),u!==null)for(w=o.onRecoverableError,g=0;g<u.length;g++)k=u[g],w(k.value,{componentStack:k.stack,digest:k.digest});if(Qh)throw Qh=!1,o=Gm,Gm=null,o;return(t0&1)!==0&&o.tag!==0&&zu(),P=o.pendingLanes,(P&1)!==0?o===Vm?sf++:(sf=0,Vm=o):sf=0,Vc(),null}function zu(){if(Zc!==null){var o=qt(t0),u=$s.transition,g=gt;try{if($s.transition=null,gt=16>o?16:o,Zc===null)var w=!1;else{if(o=Zc,Zc=null,t0=0,(_n&6)!==0)throw Error(t(331));var k=_n;for(_n|=4,Dt=o.current;Dt!==null;){var P=Dt,Z=P.child;if((Dt.flags&16)!==0){var de=P.deletions;if(de!==null){for(var ye=0;ye<de.length;ye++){var Ue=de[ye];for(Dt=Ue;Dt!==null;){var et=Dt;switch(et.tag){case 0:case 11:case 15:tf(8,et,P)}var nt=et.child;if(nt!==null)nt.return=et,Dt=nt;else for(;Dt!==null;){et=Dt;var Qe=et.sibling,Tt=et.return;if(nw(et),et===Ue){Dt=null;break}if(Qe!==null){Qe.return=Tt,Dt=Qe;break}Dt=Tt}}}var Ft=P.alternate;if(Ft!==null){var Ut=Ft.child;if(Ut!==null){Ft.child=null;do{var _r=Ut.sibling;Ut.sibling=null,Ut=_r}while(Ut!==null)}}Dt=P}}if((P.subtreeFlags&2064)!==0&&Z!==null)Z.return=P,Dt=Z;else e:for(;Dt!==null;){if(P=Dt,(P.flags&2048)!==0)switch(P.tag){case 0:case 11:case 15:tf(9,P,P.return)}var Pe=P.sibling;if(Pe!==null){Pe.return=P.return,Dt=Pe;break e}Dt=P.return}}var be=o.current;for(Dt=be;Dt!==null;){Z=Dt;var Oe=Z.child;if((Z.subtreeFlags&2064)!==0&&Oe!==null)Oe.return=Z,Dt=Oe;else e:for(Z=be;Dt!==null;){if(de=Dt,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:qh(9,de)}}catch(Vt){kr(de,de.return,Vt)}if(de===Z){Dt=null;break e}var dt=de.sibling;if(dt!==null){dt.return=de.return,Dt=dt;break e}Dt=de.return}}if(_n=k,Vc(),rr&&typeof rr.onPostCommitFiberRoot=="function")try{rr.onPostCommitFiberRoot(yn,o)}catch{}w=!0}return w}finally{gt=g,$s.transition=u}}return!1}function yw(o,u,g){u=Gu(g,u),u=Ox(o,u,1),o=Wc(o,u,1),u=Gi(),o!==null&&(ke(o,1,u),cs(o,u))}function kr(o,u,g){if(o.tag===3)yw(o,o,g);else for(;u!==null;){if(u.tag===3){yw(u,o,g);break}else if(u.tag===1){var w=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Hc===null||!Hc.has(w))){o=Gu(g,o),o=Fx(u,o,1),u=Wc(u,o,1),o=Gi(),u!==null&&(ke(u,1,o),cs(u,o));break}}u=u.return}}function cR(o,u,g){var w=o.pingCache;w!==null&&w.delete(u),u=Gi(),o.pingedLanes|=o.suspendedLanes&g,ri===o&&(hi&g)===g&&(zr===4||zr===3&&(hi&130023424)===hi&&500>wt()-Um?Gl(o,0):Lm|=g),cs(o,u)}function Cw(o,u){u===0&&((o.mode&1)===0?u=1:(u=es,es<<=1,(es&130023424)===0&&(es=4194304)));var g=Gi();o=La(o,u),o!==null&&(ke(o,u,g),cs(o,g))}function lR(o){var u=o.memoizedState,g=0;u!==null&&(g=u.retryLane),Cw(o,g)}function uR(o,u){var g=0;switch(o.tag){case 13:var w=o.stateNode,k=o.memoizedState;k!==null&&(g=k.retryLane);break;case 19:w=o.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(u),Cw(o,g)}var xw;xw=function(o,u,g){if(o!==null)if(o.memoizedProps!==u.pendingProps||is.current)os=!0;else{if((o.lanes&g)===0&&(u.flags&128)===0)return os=!1,J_(o,u,g);os=(o.flags&131072)!==0}else os=!1,hr&&(u.flags&1048576)!==0&&Q1(u,Nh,u.index);switch(u.lanes=0,u.tag){case 2:var w=u.type;$h(o,u),o=u.pendingProps;var k=Pu(u,Ei.current);Lu(u,g),k=mm(null,u,w,o,k,g);var P=vm();return u.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,ss(w)?(P=!0,Rh(u)):P=!1,u.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,lm(u),k.updater=Zh,u.stateNode=k,k._reactInternals=u,bm(u,w,o,g),u=Em(null,u,w,!0,P,g)):(u.tag=0,hr&&P&&Qg(u),Ui(null,u,k,g),u=u.child),u;case 16:w=u.elementType;e:{switch($h(o,u),o=u.pendingProps,k=w._init,w=k(w._payload),u.type=w,k=u.tag=fR(w),o=lo(w,o),k){case 0:u=km(null,u,w,o,g);break e;case 1:u=Zx(null,u,w,o,g);break e;case 11:u=Vx(null,u,w,o,g);break e;case 14:u=jx(null,u,w,lo(w.type,o),g);break e}throw Error(t(306,w,""))}return u;case 0:return w=u.type,k=u.pendingProps,k=u.elementType===w?k:lo(w,k),km(o,u,w,k,g);case 1:return w=u.type,k=u.pendingProps,k=u.elementType===w?k:lo(w,k),Zx(o,u,w,k,g);case 3:e:{if(Xx(u),o===null)throw Error(t(387));w=u.pendingProps,P=u.memoizedState,k=P.element,cx(o,u),Uh(u,w,null,g);var Z=u.memoizedState;if(w=Z.element,P.isDehydrated)if(P={element:w,isDehydrated:!1,cache:Z.cache,pendingSuspenseBoundaries:Z.pendingSuspenseBoundaries,transitions:Z.transitions},u.updateQueue.baseState=P,u.memoizedState=P,u.flags&256){k=Gu(Error(t(423)),u),u=$x(o,u,w,g,k);break e}else if(w!==k){k=Gu(Error(t(424)),u),u=$x(o,u,w,g,k);break e}else for(ks=Lc(u.stateNode.containerInfo.firstChild),As=u,hr=!0,co=null,g=ox(u,null,w,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Bu(),w===k){u=Ga(o,u,g);break e}Ui(o,u,w,g)}u=u.child}return u;case 5:return dx(u),o===null&&nm(u),w=u.type,k=u.pendingProps,P=o!==null?o.memoizedProps:null,Z=k.children,Xg(w,k)?Z=null:P!==null&&Xg(w,P)&&(u.flags|=32),Hx(o,u),Ui(o,u,Z,g),u.child;case 6:return o===null&&nm(u),null;case 13:return Kx(o,u,g);case 4:return um(u,u.stateNode.containerInfo),w=u.pendingProps,o===null?u.child=Ou(u,null,w,g):Ui(o,u,w,g),u.child;case 11:return w=u.type,k=u.pendingProps,k=u.elementType===w?k:lo(w,k),Vx(o,u,w,k,g);case 7:return Ui(o,u,u.pendingProps,g),u.child;case 8:return Ui(o,u,u.pendingProps.children,g),u.child;case 12:return Ui(o,u,u.pendingProps.children,g),u.child;case 10:e:{if(w=u.type._context,k=u.pendingProps,P=u.memoizedProps,Z=k.value,Yn(Oh,w._currentValue),w._currentValue=Z,P!==null)if(ao(P.value,Z)){if(P.children===k.children&&!is.current){u=Ga(o,u,g);break e}}else for(P=u.child,P!==null&&(P.return=u);P!==null;){var de=P.dependencies;if(de!==null){Z=P.child;for(var ye=de.firstContext;ye!==null;){if(ye.context===w){if(P.tag===1){ye=Ua(-1,g&-g),ye.tag=2;var Ue=P.updateQueue;if(Ue!==null){Ue=Ue.shared;var et=Ue.pending;et===null?ye.next=ye:(ye.next=et.next,et.next=ye),Ue.pending=ye}}P.lanes|=g,ye=P.alternate,ye!==null&&(ye.lanes|=g),am(P.return,g,u),de.lanes|=g;break}ye=ye.next}}else if(P.tag===10)Z=P.type===u.type?null:P.child;else if(P.tag===18){if(Z=P.return,Z===null)throw Error(t(341));Z.lanes|=g,de=Z.alternate,de!==null&&(de.lanes|=g),am(Z,g,u),Z=P.sibling}else Z=P.child;if(Z!==null)Z.return=P;else for(Z=P;Z!==null;){if(Z===u){Z=null;break}if(P=Z.sibling,P!==null){P.return=Z.return,Z=P;break}Z=Z.return}P=Z}Ui(o,u,k.children,g),u=u.child}return u;case 9:return k=u.type,w=u.pendingProps.children,Lu(u,g),k=Zs(k),w=w(k),u.flags|=1,Ui(o,u,w,g),u.child;case 14:return w=u.type,k=lo(w,u.pendingProps),k=lo(w.type,k),jx(o,u,w,k,g);case 15:return Wx(o,u,u.type,u.pendingProps,g);case 17:return w=u.type,k=u.pendingProps,k=u.elementType===w?k:lo(w,k),$h(o,u),u.tag=1,ss(w)?(o=!0,Rh(u)):o=!1,Lu(u,g),Mx(u,w,k),bm(u,w,k,g),Em(null,u,w,!0,o,g);case 19:return Jx(o,u,g);case 22:return zx(o,u,g)}throw Error(t(156,u.tag))};function ww(o,u){return ze(o,u)}function dR(o,u,g,w){this.tag=o,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ks(o,u,g,w){return new dR(o,u,g,w)}function Xm(o){return o=o.prototype,!(!o||!o.isReactComponent)}function fR(o){if(typeof o=="function")return Xm(o)?1:0;if(o!=null){if(o=o.$$typeof,o===Y)return 11;if(o===xe)return 14}return 2}function Kc(o,u){var g=o.alternate;return g===null?(g=Ks(o.tag,u,o.key,o.mode),g.elementType=o.elementType,g.type=o.type,g.stateNode=o.stateNode,g.alternate=o,o.alternate=g):(g.pendingProps=u,g.type=o.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=o.flags&14680064,g.childLanes=o.childLanes,g.lanes=o.lanes,g.child=o.child,g.memoizedProps=o.memoizedProps,g.memoizedState=o.memoizedState,g.updateQueue=o.updateQueue,u=o.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=o.sibling,g.index=o.index,g.ref=o.ref,g}function s0(o,u,g,w,k,P){var Z=2;if(w=o,typeof o=="function")Xm(o)&&(Z=1);else if(typeof o=="string")Z=5;else e:switch(o){case M:return jl(g.children,k,P,u);case j:Z=8,k|=8;break;case J:return o=Ks(12,g,u,k|2),o.elementType=J,o.lanes=P,o;case ie:return o=Ks(13,g,u,k),o.elementType=ie,o.lanes=P,o;case pe:return o=Ks(19,g,u,k),o.elementType=pe,o.lanes=P,o;case Le:return o0(g,k,P,u);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case L:Z=10;break e;case z:Z=9;break e;case Y:Z=11;break e;case xe:Z=14;break e;case Ae:Z=16,w=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return u=Ks(Z,g,u,k),u.elementType=o,u.type=w,u.lanes=P,u}function jl(o,u,g,w){return o=Ks(7,o,w,u),o.lanes=g,o}function o0(o,u,g,w){return o=Ks(22,o,w,u),o.elementType=Le,o.lanes=g,o.stateNode={isHidden:!1},o}function $m(o,u,g){return o=Ks(6,o,null,u),o.lanes=g,o}function Km(o,u,g){return u=Ks(4,o.children!==null?o.children:[],o.key,u),u.lanes=g,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}function hR(o,u,g,w,k){this.tag=u,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Be(0),this.expirationTimes=Be(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Be(0),this.identifierPrefix=w,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function qm(o,u,g,w,k,P,Z,de,ye){return o=new hR(o,u,g,de,ye),u===1?(u=1,P===!0&&(u|=8)):u=0,P=Ks(3,null,null,u),o.current=P,P.stateNode=o,P.memoizedState={element:w,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},lm(P),o}function pR(o,u,g){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:V,key:w==null?null:""+w,children:o,containerInfo:u,implementation:g}}function Iw(o){if(!o)return Gc;o=o._reactInternals;e:{if(Fe(o)!==o||o.tag!==1)throw Error(t(170));var u=o;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(ss(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(o.tag===1){var g=o.type;if(ss(g))return q1(o,g,u)}return u}function bw(o,u,g,w,k,P,Z,de,ye){return o=qm(g,w,!0,o,k,P,Z,de,ye),o.context=Iw(null),g=o.current,w=Gi(),k=Xc(g),P=Ua(w,k),P.callback=u??null,Wc(g,P,k),o.current.lanes=k,ke(o,k,w),cs(o,w),o}function a0(o,u,g,w){var k=u.current,P=Gi(),Z=Xc(k);return g=Iw(g),u.context===null?u.context=g:u.pendingContext=g,u=Ua(P,Z),u.payload={element:o},w=w===void 0?null:w,w!==null&&(u.callback=w),o=Wc(k,u,Z),o!==null&&(ho(o,k,Z,P),Lh(o,k,Z)),Z}function c0(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function Sw(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var g=o.retryLane;o.retryLane=g!==0&&g<u?g:u}}function Jm(o,u){Sw(o,u),(o=o.alternate)&&Sw(o,u)}function gR(){return null}var Aw=typeof reportError=="function"?reportError:function(o){console.error(o)};function Ym(o){this._internalRoot=o}l0.prototype.render=Ym.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(t(409));a0(o,u,null,null)},l0.prototype.unmount=Ym.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;Ul(function(){a0(null,o,null,null)}),u[Ma]=null}};function l0(o){this._internalRoot=o}l0.prototype.unstable_scheduleHydration=function(o){if(o){var u=Ii();o={blockedOn:null,target:o,priority:u};for(var g=0;g<xs.length&&u!==0&&u<xs[g].priority;g++);xs.splice(g,0,o),g===0&&ts(o)}};function Qm(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function u0(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function kw(){}function mR(o,u,g,w,k){if(k){if(typeof w=="function"){var P=w;w=function(){var Ue=c0(Z);P.call(Ue)}}var Z=bw(u,w,o,0,null,!1,!1,"",kw);return o._reactRootContainer=Z,o[Ma]=Z.current,jd(o.nodeType===8?o.parentNode:o),Ul(),Z}for(;k=o.lastChild;)o.removeChild(k);if(typeof w=="function"){var de=w;w=function(){var Ue=c0(ye);de.call(Ue)}}var ye=qm(o,0,!1,null,null,!1,!1,"",kw);return o._reactRootContainer=ye,o[Ma]=ye.current,jd(o.nodeType===8?o.parentNode:o),Ul(function(){a0(u,ye,g,w)}),ye}function d0(o,u,g,w,k){var P=g._reactRootContainer;if(P){var Z=P;if(typeof k=="function"){var de=k;k=function(){var ye=c0(Z);de.call(ye)}}a0(u,Z,o,k)}else Z=mR(g,u,o,k,w);return c0(Z)}cn=function(o){switch(o.tag){case 3:var u=o.stateNode;if(u.current.memoizedState.isDehydrated){var g=St(u.pendingLanes);g!==0&&(ut(u,g|1),cs(u,wt()),(_n&6)===0&&(Wu=wt()+500,Vc()))}break;case 13:Ul(function(){var w=La(o,1);if(w!==null){var k=Gi();ho(w,o,1,k)}}),Jm(o,1)}},On=function(o){if(o.tag===13){var u=La(o,134217728);if(u!==null){var g=Gi();ho(u,o,134217728,g)}Jm(o,134217728)}},wi=function(o){if(o.tag===13){var u=Xc(o),g=La(o,u);if(g!==null){var w=Gi();ho(g,o,u,w)}Jm(o,u)}},Ii=function(){return gt},ei=function(o,u){var g=gt;try{return gt=o,u()}finally{gt=g}},Sr=function(o,u,g){switch(u){case"input":if(zt(o,g),u=g.name,g.type==="radio"&&u!=null){for(g=o;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<g.length;u++){var w=g[u];if(w!==o&&w.form===o.form){var k=Th(w);if(!k)throw Error(t(90));Nt(w),zt(w,k)}}}break;case"textarea":nn(o,g);break;case"select":u=g.value,u!=null&&an(o,!!g.multiple,u,!1)}},Ht=zm,fr=Ul;var vR={usingClientEntryPoint:!1,Events:[Hd,Ru,Th,Je,En,zm]},of={findFiberByHostInstance:Dl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yR={bundleType:of.bundleType,version:of.version,rendererPackageName:of.rendererPackageName,rendererConfig:of.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=it(o),o===null?null:o.stateNode},findFiberByHostInstance:of.findFiberByHostInstance||gR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var f0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!f0.isDisabled&&f0.supportsFiber)try{yn=f0.inject(yR),rr=f0}catch{}}return ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vR,ls.createPortal=function(o,u){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qm(u))throw Error(t(200));return pR(o,u,null,g)},ls.createRoot=function(o,u){if(!Qm(o))throw Error(t(299));var g=!1,w="",k=Aw;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(k=u.onRecoverableError)),u=qm(o,1,!1,null,null,g,!1,w,k),o[Ma]=u.current,jd(o.nodeType===8?o.parentNode:o),new Ym(u)},ls.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=it(u),o=o===null?null:o.stateNode,o},ls.flushSync=function(o){return Ul(o)},ls.hydrate=function(o,u,g){if(!u0(u))throw Error(t(200));return d0(null,o,u,!0,g)},ls.hydrateRoot=function(o,u,g){if(!Qm(o))throw Error(t(405));var w=g!=null&&g.hydratedSources||null,k=!1,P="",Z=Aw;if(g!=null&&(g.unstable_strictMode===!0&&(k=!0),g.identifierPrefix!==void 0&&(P=g.identifierPrefix),g.onRecoverableError!==void 0&&(Z=g.onRecoverableError)),u=bw(u,null,o,1,g??null,k,!1,P,Z),o[Ma]=u.current,jd(o),w)for(o=0;o<w.length;o++)g=w[o],k=g._getVersion,k=k(g._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[g,k]:u.mutableSourceEagerHydrationData.push(g,k);return new l0(u)},ls.render=function(o,u,g){if(!u0(u))throw Error(t(200));return d0(null,o,u,!1,g)},ls.unmountComponentAtNode=function(o){if(!u0(o))throw Error(t(40));return o._reactRootContainer?(Ul(function(){d0(null,null,o,!1,function(){o._reactRootContainer=null,o[Ma]=null})}),!0):!1},ls.unstable_batchedUpdates=zm,ls.unstable_renderSubtreeIntoContainer=function(o,u,g,w){if(!u0(g))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return d0(o,u,g,!1,w)},ls.version="18.3.1-next-f1338f8080-20240426",ls}var Bw;function vA(){if(Bw)return rv.exports;Bw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),rv.exports=_R(),rv.exports}var Ow;function RR(){if(Ow)return p0;Ow=1;var n=vA();return p0.createRoot=n.createRoot,p0.hydrateRoot=n.hydrateRoot,p0}var DR=RR();const PR=kc(DR);var yA=vA();const NR=kc(yA),MR=mA({__proto__:null,default:NR},[yA]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pr(){return pr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},pr.apply(this,arguments)}var Fr;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Fr||(Fr={}));const Fw="popstate";function BR(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:a,hash:c}=r.location;return Gf("",{pathname:s,search:a,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:ah(i)}return FR(e,t,null,n)}function Dn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function fd(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function OR(){return Math.random().toString(36).substr(2,8)}function Lw(n,e){return{usr:n.state,key:n.key,idx:e}}function Gf(n,e,t,r){return t===void 0&&(t=null),pr({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Cl(e):e,{state:t,key:e&&e.key||r||OR()})}function ah(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Cl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function FR(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,c=Fr.Pop,d=null,f=h();f==null&&(f=0,a.replaceState(pr({},a.state,{idx:f}),""));function h(){return(a.state||{idx:null}).idx}function v(){c=Fr.Pop;let b=h(),S=b==null?null:b-f;f=b,d&&d({action:c,location:x.location,delta:S})}function m(b,S){c=Fr.Push;let A=Gf(x.location,b,S);f=h()+1;let E=Lw(A,f),R=x.createHref(A);try{a.pushState(E,"",R)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(R)}s&&d&&d({action:c,location:x.location,delta:1})}function y(b,S){c=Fr.Replace;let A=Gf(x.location,b,S);f=h();let E=Lw(A,f),R=x.createHref(A);a.replaceState(E,"",R),s&&d&&d({action:c,location:x.location,delta:0})}function C(b){let S=i.location.origin!=="null"?i.location.origin:i.location.href,A=typeof b=="string"?b:ah(b);return A=A.replace(/ $/,"%20"),Dn(S,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,S)}let x={get action(){return c},get location(){return n(i,a)},listen(b){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(Fw,v),d=b,()=>{i.removeEventListener(Fw,v),d=null}},createHref(b){return e(i,b)},createURL:C,encodeLocation(b){let S=C(b);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:y,go(b){return a.go(b)}};return x}var jn;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(jn||(jn={}));const LR=new Set(["lazy","caseSensitive","path","id","index","children"]);function UR(n){return n.index===!0}function Mp(n,e,t,r){return t===void 0&&(t=[]),r===void 0&&(r={}),n.map((i,s)=>{let a=[...t,String(s)],c=typeof i.id=="string"?i.id:a.join("-");if(Dn(i.index!==!0||!i.children,"Cannot specify children on an index route"),Dn(!r[c],'Found a route id collision on id "'+c+`".  Route id's must be globally unique within Data Router usages`),UR(i)){let d=pr({},i,e(i),{id:c});return r[c]=d,d}else{let d=pr({},i,e(i),{id:c,children:void 0});return r[c]=d,i.children&&(d.children=Mp(i.children,e,a,r)),d}})}function Hl(n,e,t){return t===void 0&&(t="/"),D0(n,e,t,!1)}function D0(n,e,t,r){let i=typeof e=="string"?Cl(e):e,s=ch(i.pathname||"/",t);if(s==null)return null;let a=CA(n);VR(a);let c=null;for(let d=0;c==null&&d<a.length;++d){let f=YR(s);c=qR(a[d],f,r)}return c}function GR(n,e){let{route:t,pathname:r,params:i}=n;return{id:t.id,pathname:r,params:i,data:e[t.id],handle:t.handle}}function CA(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,a,c)=>{let d={relativePath:c===void 0?s.path||"":c,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};d.relativePath.startsWith("/")&&(Dn(d.relativePath.startsWith(r),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(r.length));let f=Ql([r,d.relativePath]),h=t.concat(d);s.children&&s.children.length>0&&(Dn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),CA(s.children,e,h,f)),!(s.path==null&&!s.index)&&e.push({path:f,score:$R(f,s.index),routesMeta:h})};return n.forEach((s,a)=>{var c;if(s.path===""||!((c=s.path)!=null&&c.includes("?")))i(s,a);else for(let d of xA(s.path))i(s,a,d)}),e}function xA(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=xA(r.join("/")),c=[];return c.push(...a.map(d=>d===""?s:[s,d].join("/"))),i&&c.push(...a),c.map(d=>n.startsWith("/")&&d===""?"/":d)}function VR(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:KR(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const jR=/^:[\w-]+$/,WR=3,zR=2,HR=1,ZR=10,XR=-2,Uw=n=>n==="*";function $R(n,e){let t=n.split("/"),r=t.length;return t.some(Uw)&&(r+=XR),e&&(r+=zR),t.filter(i=>!Uw(i)).reduce((i,s)=>i+(jR.test(s)?WR:s===""?HR:ZR),r)}function KR(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function qR(n,e,t){t===void 0&&(t=!1);let{routesMeta:r}=n,i={},s="/",a=[];for(let c=0;c<r.length;++c){let d=r[c],f=c===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",v=Gw({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},h),m=d.route;if(!v&&f&&t&&!r[r.length-1].route.index&&(v=Gw({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},h)),!v)return null;Object.assign(i,v.params),a.push({params:i,pathname:Ql([s,v.pathname]),pathnameBase:r3(Ql([s,v.pathnameBase])),route:m}),v.pathnameBase!=="/"&&(s=Ql([s,v.pathnameBase]))}return a}function Gw(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=JR(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((f,h,v)=>{let{paramName:m,isOptional:y}=h;if(m==="*"){let x=c[v]||"";a=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const C=c[v];return y&&!C?f[m]=void 0:f[m]=(C||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:a,pattern:n}}function JR(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),fd(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function YR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return fd(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function ch(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function QR(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Cl(n):n;return{pathname:t?t.startsWith("/")?t:e3(t,e):e,search:i3(r),hash:s3(i)}}function e3(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function ov(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function wA(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function t3(n,e){let t=wA(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function n3(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Cl(n):(i=pr({},n),Dn(!i.pathname||!i.pathname.includes("?"),ov("?","pathname","search",i)),Dn(!i.pathname||!i.pathname.includes("#"),ov("#","pathname","hash",i)),Dn(!i.search||!i.search.includes("#"),ov("#","search","hash",i)));let s=n===""||i.pathname==="",a=s?"/":i.pathname,c;if(a==null)c=t;else{let v=e.length-1;if(!r&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),v-=1;i.pathname=m.join("/")}c=v>=0?e[v]:"/"}let d=QR(i,c),f=a&&a!=="/"&&a.endsWith("/"),h=(s||a===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(f||h)&&(d.pathname+="/"),d}const Ql=n=>n.join("/").replace(/\/\/+/g,"/"),r3=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),i3=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,s3=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class Bp{constructor(e,t,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=t||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Vf(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const IA=["post","put","patch","delete"],o3=new Set(IA),a3=["get",...IA],c3=new Set(a3),l3=new Set([301,302,303,307,308]),u3=new Set([307,308]),av={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},d3={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},cf={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},hC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,f3=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),bA="remix-router-transitions";function h3(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!t;Dn(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(n.mapRouteProperties)i=n.mapRouteProperties;else if(n.detectErrorBoundary){let ge=n.detectErrorBoundary;i=Ie=>({hasErrorBoundary:ge(Ie)})}else i=f3;let s={},a=Mp(n.routes,i,void 0,s),c,d=n.basename||"/",f=n.dataStrategy||v3,h=n.patchRoutesOnNavigation,v=pr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},n.future),m=null,y=new Set,C=null,x=null,b=null,S=n.hydrationData!=null,A=Hl(a,n.history.location,d),E=!1,R=null;if(A==null&&!h){let ge=ds(404,{pathname:n.history.location.pathname}),{matches:Ie,route:Q}=Jw(a);A=Ie,R={[Q.id]:ge}}A&&!n.hydrationData&&fr(A,a,n.history.location.pathname).active&&(A=null);let N;if(A)if(A.some(ge=>ge.route.lazy))N=!1;else if(!A.some(ge=>ge.route.loader))N=!0;else if(v.v7_partialHydration){let ge=n.hydrationData?n.hydrationData.loaderData:null,Ie=n.hydrationData?n.hydrationData.errors:null;if(Ie){let Q=A.findIndex(Ve=>Ie[Ve.route.id]!==void 0);N=A.slice(0,Q+1).every(Ve=>!Kv(Ve.route,ge,Ie))}else N=A.every(Q=>!Kv(Q.route,ge,Ie))}else N=n.hydrationData!=null;else if(N=!1,A=[],v.v7_partialHydration){let ge=fr(null,a,n.history.location.pathname);ge.active&&ge.matches&&(E=!0,A=ge.matches)}let V,M={historyAction:n.history.action,location:n.history.location,matches:A,initialized:N,navigation:av,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||R,fetchers:new Map,blockers:new Map},j=Fr.Pop,J=!1,L,z=!1,Y=new Map,ie=null,pe=!1,xe=!1,Ae=[],Le=new Set,we=new Map,Se=0,Ee=-1,H=new Map,ee=new Set,ce=new Map,Ce=new Map,_e=new Set,Ne=new Map,ft=new Map,ve;function ct(){if(m=n.history.listen(ge=>{let{action:Ie,location:Q,delta:Ve}=ge;if(ve){ve(),ve=void 0;return}fd(ft.size===0||Ve!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let tt=Sr({currentLocation:M.location,nextLocation:Q,historyAction:Ie});if(tt&&Ve!=null){let Et=new Promise(Bt=>{ve=Bt});n.history.go(Ve*-1),Bn(tt,{state:"blocked",location:Q,proceed(){Bn(tt,{state:"proceeding",proceed:void 0,reset:void 0,location:Q}),Et.then(()=>n.history.go(Ve))},reset(){let Bt=new Map(M.blockers);Bt.set(tt,cf),Nt({blockers:Bt})}});return}return at(Ie,Q)}),t){D3(e,Y);let ge=()=>P3(e,Y);e.addEventListener("pagehide",ge),ie=()=>e.removeEventListener("pagehide",ge)}return M.initialized||at(Fr.Pop,M.location,{initialHydration:!0}),V}function At(){m&&m(),ie&&ie(),y.clear(),L&&L.abort(),M.fetchers.forEach((ge,Ie)=>me(Ie)),M.blockers.forEach((ge,Ie)=>hn(Ie))}function Wt(ge){return y.add(ge),()=>y.delete(ge)}function Nt(ge,Ie){Ie===void 0&&(Ie={}),M=pr({},M,ge);let Q=[],Ve=[];v.v7_fetcherPersist&&M.fetchers.forEach((tt,Et)=>{tt.state==="idle"&&(_e.has(Et)?Ve.push(Et):Q.push(Et))}),_e.forEach(tt=>{!M.fetchers.has(tt)&&!we.has(tt)&&Ve.push(tt)}),[...y].forEach(tt=>tt(M,{deletedFetchers:Ve,viewTransitionOpts:Ie.viewTransitionOpts,flushSync:Ie.flushSync===!0})),v.v7_fetcherPersist?(Q.forEach(tt=>M.fetchers.delete(tt)),Ve.forEach(tt=>me(tt))):Ve.forEach(tt=>_e.delete(tt))}function bt(ge,Ie,Q){var Ve,tt;let{flushSync:Et}=Q===void 0?{}:Q,Bt=M.actionData!=null&&M.navigation.formMethod!=null&&ko(M.navigation.formMethod)&&M.navigation.state==="loading"&&((Ve=ge.state)==null?void 0:Ve._isRedirect)!==!0,ht;Ie.actionData?Object.keys(Ie.actionData).length>0?ht=Ie.actionData:ht=null:Bt?ht=M.actionData:ht=null;let pt=Ie.loaderData?Kw(M.loaderData,Ie.loaderData,Ie.matches||[],Ie.errors):M.loaderData,Ct=M.blockers;Ct.size>0&&(Ct=new Map(Ct),Ct.forEach((We,In)=>Ct.set(In,cf)));let Fe=J===!0||M.navigation.formMethod!=null&&ko(M.navigation.formMethod)&&((tt=ge.state)==null?void 0:tt._isRedirect)!==!0;c&&(a=c,c=void 0),pe||j===Fr.Pop||(j===Fr.Push?n.history.push(ge,ge.state):j===Fr.Replace&&n.history.replace(ge,ge.state));let lt;if(j===Fr.Pop){let We=Y.get(M.location.pathname);We&&We.has(ge.pathname)?lt={currentLocation:M.location,nextLocation:ge}:Y.has(ge.pathname)&&(lt={currentLocation:ge,nextLocation:M.location})}else if(z){let We=Y.get(M.location.pathname);We?We.add(ge.pathname):(We=new Set([ge.pathname]),Y.set(M.location.pathname,We)),lt={currentLocation:M.location,nextLocation:ge}}Nt(pr({},Ie,{actionData:ht,loaderData:pt,historyAction:j,location:ge,initialized:!0,navigation:av,revalidation:"idle",restoreScrollPosition:Ht(ge,Ie.matches||M.matches),preventScrollReset:Fe,blockers:Ct}),{viewTransitionOpts:lt,flushSync:Et===!0}),j=Fr.Pop,J=!1,z=!1,pe=!1,xe=!1,Ae=[]}async function Rt(ge,Ie){if(typeof ge=="number"){n.history.go(ge);return}let Q=$v(M.location,M.matches,d,v.v7_prependBasename,ge,v.v7_relativeSplatPath,Ie==null?void 0:Ie.fromRouteId,Ie==null?void 0:Ie.relative),{path:Ve,submission:tt,error:Et}=Vw(v.v7_normalizeFormMethod,!1,Q,Ie),Bt=M.location,ht=Gf(M.location,Ve,Ie&&Ie.state);ht=pr({},ht,n.history.encodeLocation(ht));let pt=Ie&&Ie.replace!=null?Ie.replace:void 0,Ct=Fr.Push;pt===!0?Ct=Fr.Replace:pt===!1||tt!=null&&ko(tt.formMethod)&&tt.formAction===M.location.pathname+M.location.search&&(Ct=Fr.Replace);let Fe=Ie&&"preventScrollReset"in Ie?Ie.preventScrollReset===!0:void 0,lt=(Ie&&Ie.flushSync)===!0,We=Sr({currentLocation:Bt,nextLocation:ht,historyAction:Ct});if(We){Bn(We,{state:"blocked",location:ht,proceed(){Bn(We,{state:"proceeding",proceed:void 0,reset:void 0,location:ht}),Rt(ge,Ie)},reset(){let In=new Map(M.blockers);In.set(We,cf),Nt({blockers:In})}});return}return await at(Ct,ht,{submission:tt,pendingError:Et,preventScrollReset:Fe,replace:Ie&&Ie.replace,enableViewTransition:Ie&&Ie.viewTransition,flushSync:lt})}function st(){if(X(),Nt({revalidation:"loading"}),M.navigation.state!=="submitting"){if(M.navigation.state==="idle"){at(M.historyAction,M.location,{startUninterruptedRevalidation:!0});return}at(j||M.historyAction,M.navigation.location,{overrideNavigation:M.navigation,enableViewTransition:z===!0})}}async function at(ge,Ie,Q){L&&L.abort(),L=null,j=ge,pe=(Q&&Q.startUninterruptedRevalidation)===!0,En(M.location,M.matches),J=(Q&&Q.preventScrollReset)===!0,z=(Q&&Q.enableViewTransition)===!0;let Ve=c||a,tt=Q&&Q.overrideNavigation,Et=Q!=null&&Q.initialHydration&&M.matches&&M.matches.length>0&&!E?M.matches:Hl(Ve,Ie,d),Bt=(Q&&Q.flushSync)===!0;if(Et&&M.initialized&&!xe&&b3(M.location,Ie)&&!(Q&&Q.submission&&ko(Q.submission.formMethod))){bt(Ie,{matches:Et},{flushSync:Bt});return}let ht=fr(Et,Ve,Ie.pathname);if(ht.active&&ht.matches&&(Et=ht.matches),!Et){let{error:it,notFoundMatches:fe,route:ze}=mr(Ie.pathname);bt(Ie,{matches:fe,loaderData:{},errors:{[ze.id]:it}},{flushSync:Bt});return}L=new AbortController;let pt=Hu(n.history,Ie,L.signal,Q&&Q.submission),Ct;if(Q&&Q.pendingError)Ct=[Zl(Et).route.id,{type:jn.error,error:Q.pendingError}];else if(Q&&Q.submission&&ko(Q.submission.formMethod)){let it=await zt(pt,Ie,Q.submission,Et,ht.active,{replace:Q.replace,flushSync:Bt});if(it.shortCircuited)return;if(it.pendingActionResult){let[fe,ze]=it.pendingActionResult;if(Ps(ze)&&Vf(ze.error)&&ze.error.status===404){L=null,bt(Ie,{matches:it.matches,loaderData:{},errors:{[fe]:ze.error}});return}}Et=it.matches||Et,Ct=it.pendingActionResult,tt=cv(Ie,Q.submission),Bt=!1,ht.active=!1,pt=Hu(n.history,pt.url,pt.signal)}let{shortCircuited:Fe,matches:lt,loaderData:We,errors:In}=await jt(pt,Ie,Et,ht.active,tt,Q&&Q.submission,Q&&Q.fetcherSubmission,Q&&Q.replace,Q&&Q.initialHydration===!0,Bt,Ct);Fe||(L=null,bt(Ie,pr({matches:lt||Et},qw(Ct),{loaderData:We,errors:In})))}async function zt(ge,Ie,Q,Ve,tt,Et){Et===void 0&&(Et={}),X();let Bt=_3(Ie,Q);if(Nt({navigation:Bt},{flushSync:Et.flushSync===!0}),tt){let Ct=await $n(Ve,Ie.pathname,ge.signal);if(Ct.type==="aborted")return{shortCircuited:!0};if(Ct.type==="error"){let Fe=Zl(Ct.partialMatches).route.id;return{matches:Ct.partialMatches,pendingActionResult:[Fe,{type:jn.error,error:Ct.error}]}}else if(Ct.matches)Ve=Ct.matches;else{let{notFoundMatches:Fe,error:lt,route:We}=mr(Ie.pathname);return{matches:Fe,pendingActionResult:[We.id,{type:jn.error,error:lt}]}}}let ht,pt=kf(Ve,Ie);if(!pt.route.action&&!pt.route.lazy)ht={type:jn.error,error:ds(405,{method:ge.method,pathname:Ie.pathname,routeId:pt.route.id})};else if(ht=(await vn("action",M,ge,[pt],Ve,null))[pt.route.id],ge.signal.aborted)return{shortCircuited:!0};if(ql(ht)){let Ct;return Et&&Et.replace!=null?Ct=Et.replace:Ct=Zw(ht.response.headers.get("Location"),new URL(ge.url),d)===M.location.pathname+M.location.search,await nn(ge,ht,!0,{submission:Q,replace:Ct}),{shortCircuited:!0}}if(al(ht))throw ds(400,{type:"defer-action"});if(Ps(ht)){let Ct=Zl(Ve,pt.route.id);return(Et&&Et.replace)!==!0&&(j=Fr.Push),{matches:Ve,pendingActionResult:[Ct.route.id,ht]}}return{matches:Ve,pendingActionResult:[pt.route.id,ht]}}async function jt(ge,Ie,Q,Ve,tt,Et,Bt,ht,pt,Ct,Fe){let lt=tt||cv(Ie,Et),We=Et||Bt||Qw(lt),In=!pe&&(!v.v7_partialHydration||!pt);if(Ve){if(In){let yn=_t(Fe);Nt(pr({navigation:lt},yn!==void 0?{actionData:yn}:{}),{flushSync:Ct})}let tn=await $n(Q,Ie.pathname,ge.signal);if(tn.type==="aborted")return{shortCircuited:!0};if(tn.type==="error"){let yn=Zl(tn.partialMatches).route.id;return{matches:tn.partialMatches,loaderData:{},errors:{[yn]:tn.error}}}else if(tn.matches)Q=tn.matches;else{let{error:yn,notFoundMatches:rr,route:li}=mr(Ie.pathname);return{matches:rr,loaderData:{},errors:{[li.id]:yn}}}}let it=c||a,[fe,ze]=Ww(n.history,M,Q,We,Ie,v.v7_partialHydration&&pt===!0,v.v7_skipActionErrorRevalidation,xe,Ae,Le,_e,ce,ee,it,d,Fe);if(Qt(tn=>!(Q&&Q.some(yn=>yn.route.id===tn))||fe&&fe.some(yn=>yn.route.id===tn)),Ee=++Se,fe.length===0&&ze.length===0){let tn=gn();return bt(Ie,pr({matches:Q,loaderData:{},errors:Fe&&Ps(Fe[1])?{[Fe[0]]:Fe[1].error}:null},qw(Fe),tn?{fetchers:new Map(M.fetchers)}:{}),{flushSync:Ct}),{shortCircuited:!0}}if(In){let tn={};if(!Ve){tn.navigation=lt;let yn=_t(Fe);yn!==void 0&&(tn.actionData=yn)}ze.length>0&&(tn.fetchers=Xt(ze)),Nt(tn,{flushSync:Ct})}ze.forEach(tn=>{Ge(tn.key),tn.controller&&we.set(tn.key,tn.controller)});let xt=()=>ze.forEach(tn=>Ge(tn.key));L&&L.signal.addEventListener("abort",xt);let{loaderResults:bn,fetcherResults:Ot}=await Ln(M,Q,fe,ze,ge);if(ge.signal.aborted)return{shortCircuited:!0};L&&L.signal.removeEventListener("abort",xt),ze.forEach(tn=>we.delete(tn.key));let wt=g0(bn);if(wt)return await nn(ge,wt.result,!0,{replace:ht}),{shortCircuited:!0};if(wt=g0(Ot),wt)return ee.add(wt.key),await nn(ge,wt.result,!0,{replace:ht}),{shortCircuited:!0};let{loaderData:Zt,errors:Kn}=$w(M,Q,bn,Fe,ze,Ot,Ne);Ne.forEach((tn,yn)=>{tn.subscribe(rr=>{(rr||tn.done)&&Ne.delete(yn)})}),v.v7_partialHydration&&pt&&M.errors&&(Kn=pr({},M.errors,Kn));let qn=gn(),nr=mn(Ee),Pn=qn||nr||ze.length>0;return pr({matches:Q,loaderData:Zt,errors:Kn},Pn?{fetchers:new Map(M.fetchers)}:{})}function _t(ge){if(ge&&!Ps(ge[1]))return{[ge[0]]:ge[1].data};if(M.actionData)return Object.keys(M.actionData).length===0?null:M.actionData}function Xt(ge){return ge.forEach(Ie=>{let Q=M.fetchers.get(Ie.key),Ve=lf(void 0,Q?Q.data:void 0);M.fetchers.set(Ie.key,Ve)}),new Map(M.fetchers)}function an(ge,Ie,Q,Ve){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ge(ge);let tt=(Ve&&Ve.flushSync)===!0,Et=c||a,Bt=$v(M.location,M.matches,d,v.v7_prependBasename,Q,v.v7_relativeSplatPath,Ie,Ve==null?void 0:Ve.relative),ht=Hl(Et,Bt,d),pt=fr(ht,Et,Bt);if(pt.active&&pt.matches&&(ht=pt.matches),!ht){B(ge,Ie,ds(404,{pathname:Bt}),{flushSync:tt});return}let{path:Ct,submission:Fe,error:lt}=Vw(v.v7_normalizeFormMethod,!0,Bt,Ve);if(lt){B(ge,Ie,lt,{flushSync:tt});return}let We=kf(ht,Ct),In=(Ve&&Ve.preventScrollReset)===!0;if(Fe&&ko(Fe.formMethod)){ot(ge,Ie,Ct,We,ht,pt.active,tt,In,Fe);return}ce.set(ge,{routeId:Ie,path:Ct}),le(ge,Ie,Ct,We,ht,pt.active,tt,In,Fe)}async function ot(ge,Ie,Q,Ve,tt,Et,Bt,ht,pt){X(),ce.delete(ge);function Ct(Cn){if(!Cn.route.action&&!Cn.route.lazy){let Lr=ds(405,{method:pt.formMethod,pathname:Q,routeId:Ie});return B(ge,Ie,Lr,{flushSync:Bt}),!0}return!1}if(!Et&&Ct(Ve))return;let Fe=M.fetchers.get(ge);D(ge,R3(pt,Fe),{flushSync:Bt});let lt=new AbortController,We=Hu(n.history,Q,lt.signal,pt);if(Et){let Cn=await $n(tt,new URL(We.url).pathname,We.signal,ge);if(Cn.type==="aborted")return;if(Cn.type==="error"){B(ge,Ie,Cn.error,{flushSync:Bt});return}else if(Cn.matches){if(tt=Cn.matches,Ve=kf(tt,Q),Ct(Ve))return}else{B(ge,Ie,ds(404,{pathname:Q}),{flushSync:Bt});return}}we.set(ge,lt);let In=Se,fe=(await vn("action",M,We,[Ve],tt,ge))[Ve.route.id];if(We.signal.aborted){we.get(ge)===lt&&we.delete(ge);return}if(v.v7_fetcherPersist&&_e.has(ge)){if(ql(fe)||Ps(fe)){D(ge,el(void 0));return}}else{if(ql(fe))if(we.delete(ge),Ee>In){D(ge,el(void 0));return}else return ee.add(ge),D(ge,lf(pt)),nn(We,fe,!1,{fetcherSubmission:pt,preventScrollReset:ht});if(Ps(fe)){B(ge,Ie,fe.error);return}}if(al(fe))throw ds(400,{type:"defer-action"});let ze=M.navigation.location||M.location,xt=Hu(n.history,ze,lt.signal),bn=c||a,Ot=M.navigation.state!=="idle"?Hl(bn,M.navigation.location,d):M.matches;Dn(Ot,"Didn't find any matches after fetcher action");let wt=++Se;H.set(ge,wt);let Zt=lf(pt,fe.data);M.fetchers.set(ge,Zt);let[Kn,qn]=Ww(n.history,M,Ot,pt,ze,!1,v.v7_skipActionErrorRevalidation,xe,Ae,Le,_e,ce,ee,bn,d,[Ve.route.id,fe]);qn.filter(Cn=>Cn.key!==ge).forEach(Cn=>{let Lr=Cn.key,It=M.fetchers.get(Lr),Ls=lf(void 0,It?It.data:void 0);M.fetchers.set(Lr,Ls),Ge(Lr),Cn.controller&&we.set(Lr,Cn.controller)}),Nt({fetchers:new Map(M.fetchers)});let nr=()=>qn.forEach(Cn=>Ge(Cn.key));lt.signal.addEventListener("abort",nr);let{loaderResults:Pn,fetcherResults:tn}=await Ln(M,Ot,Kn,qn,xt);if(lt.signal.aborted)return;lt.signal.removeEventListener("abort",nr),H.delete(ge),we.delete(ge),qn.forEach(Cn=>we.delete(Cn.key));let yn=g0(Pn);if(yn)return nn(xt,yn.result,!1,{preventScrollReset:ht});if(yn=g0(tn),yn)return ee.add(yn.key),nn(xt,yn.result,!1,{preventScrollReset:ht});let{loaderData:rr,errors:li}=$w(M,Ot,Pn,void 0,qn,tn,Ne);if(M.fetchers.has(ge)){let Cn=el(fe.data);M.fetchers.set(ge,Cn)}mn(wt),M.navigation.state==="loading"&&wt>Ee?(Dn(j,"Expected pending action"),L&&L.abort(),bt(M.navigation.location,{matches:Ot,loaderData:rr,errors:li,fetchers:new Map(M.fetchers)})):(Nt({errors:li,loaderData:Kw(M.loaderData,rr,Ot,li),fetchers:new Map(M.fetchers)}),xe=!1)}async function le(ge,Ie,Q,Ve,tt,Et,Bt,ht,pt){let Ct=M.fetchers.get(ge);D(ge,lf(pt,Ct?Ct.data:void 0),{flushSync:Bt});let Fe=new AbortController,lt=Hu(n.history,Q,Fe.signal);if(Et){let fe=await $n(tt,new URL(lt.url).pathname,lt.signal,ge);if(fe.type==="aborted")return;if(fe.type==="error"){B(ge,Ie,fe.error,{flushSync:Bt});return}else if(fe.matches)tt=fe.matches,Ve=kf(tt,Q);else{B(ge,Ie,ds(404,{pathname:Q}),{flushSync:Bt});return}}we.set(ge,Fe);let We=Se,it=(await vn("loader",M,lt,[Ve],tt,ge))[Ve.route.id];if(al(it)&&(it=await pC(it,lt.signal,!0)||it),we.get(ge)===Fe&&we.delete(ge),!lt.signal.aborted){if(_e.has(ge)){D(ge,el(void 0));return}if(ql(it))if(Ee>We){D(ge,el(void 0));return}else{ee.add(ge),await nn(lt,it,!1,{preventScrollReset:ht});return}if(Ps(it)){B(ge,Ie,it.error);return}Dn(!al(it),"Unhandled fetcher deferred data"),D(ge,el(it.data))}}async function nn(ge,Ie,Q,Ve){let{submission:tt,fetcherSubmission:Et,preventScrollReset:Bt,replace:ht}=Ve===void 0?{}:Ve;Ie.response.headers.has("X-Remix-Revalidate")&&(xe=!0);let pt=Ie.response.headers.get("Location");Dn(pt,"Expected a Location header on the redirect Response"),pt=Zw(pt,new URL(ge.url),d);let Ct=Gf(M.location,pt,{_isRedirect:!0});if(t){let fe=!1;if(Ie.response.headers.has("X-Remix-Reload-Document"))fe=!0;else if(hC.test(pt)){const ze=n.history.createURL(pt);fe=ze.origin!==e.location.origin||ch(ze.pathname,d)==null}if(fe){ht?e.location.replace(pt):e.location.assign(pt);return}}L=null;let Fe=ht===!0||Ie.response.headers.has("X-Remix-Replace")?Fr.Replace:Fr.Push,{formMethod:lt,formAction:We,formEncType:In}=M.navigation;!tt&&!Et&&lt&&We&&In&&(tt=Qw(M.navigation));let it=tt||Et;if(u3.has(Ie.response.status)&&it&&ko(it.formMethod))await at(Fe,Ct,{submission:pr({},it,{formAction:pt}),preventScrollReset:Bt||J,enableViewTransition:Q?z:void 0});else{let fe=cv(Ct,tt);await at(Fe,Ct,{overrideNavigation:fe,fetcherSubmission:Et,preventScrollReset:Bt||J,enableViewTransition:Q?z:void 0})}}async function vn(ge,Ie,Q,Ve,tt,Et){let Bt,ht={};try{Bt=await y3(f,ge,Ie,Q,Ve,tt,Et,s,i)}catch(pt){return Ve.forEach(Ct=>{ht[Ct.route.id]={type:jn.error,error:pt}}),ht}for(let[pt,Ct]of Object.entries(Bt))if(S3(Ct)){let Fe=Ct.result;ht[pt]={type:jn.redirect,response:w3(Fe,Q,pt,tt,d,v.v7_relativeSplatPath)}}else ht[pt]=await x3(Ct);return ht}async function Ln(ge,Ie,Q,Ve,tt){let Et=ge.matches,Bt=vn("loader",ge,tt,Q,Ie,null),ht=Promise.all(Ve.map(async Fe=>{if(Fe.matches&&Fe.match&&Fe.controller){let We=(await vn("loader",ge,Hu(n.history,Fe.path,Fe.controller.signal),[Fe.match],Fe.matches,Fe.key))[Fe.match.route.id];return{[Fe.key]:We}}else return Promise.resolve({[Fe.key]:{type:jn.error,error:ds(404,{pathname:Fe.path})}})})),pt=await Bt,Ct=(await ht).reduce((Fe,lt)=>Object.assign(Fe,lt),{});return await Promise.all([E3(Ie,pt,tt.signal,Et,ge.loaderData),T3(Ie,Ct,Ve)]),{loaderResults:pt,fetcherResults:Ct}}function X(){xe=!0,Ae.push(...Qt()),ce.forEach((ge,Ie)=>{we.has(Ie)&&Le.add(Ie),Ge(Ie)})}function D(ge,Ie,Q){Q===void 0&&(Q={}),M.fetchers.set(ge,Ie),Nt({fetchers:new Map(M.fetchers)},{flushSync:(Q&&Q.flushSync)===!0})}function B(ge,Ie,Q,Ve){Ve===void 0&&(Ve={});let tt=Zl(M.matches,Ie);me(ge),Nt({errors:{[tt.route.id]:Q},fetchers:new Map(M.fetchers)},{flushSync:(Ve&&Ve.flushSync)===!0})}function te(ge){return Ce.set(ge,(Ce.get(ge)||0)+1),_e.has(ge)&&_e.delete(ge),M.fetchers.get(ge)||d3}function me(ge){let Ie=M.fetchers.get(ge);we.has(ge)&&!(Ie&&Ie.state==="loading"&&H.has(ge))&&Ge(ge),ce.delete(ge),H.delete(ge),ee.delete(ge),v.v7_fetcherPersist&&_e.delete(ge),Le.delete(ge),M.fetchers.delete(ge)}function De(ge){let Ie=(Ce.get(ge)||0)-1;Ie<=0?(Ce.delete(ge),_e.add(ge),v.v7_fetcherPersist||me(ge)):Ce.set(ge,Ie),Nt({fetchers:new Map(M.fetchers)})}function Ge(ge){let Ie=we.get(ge);Ie&&(Ie.abort(),we.delete(ge))}function Lt(ge){for(let Ie of ge){let Q=te(Ie),Ve=el(Q.data);M.fetchers.set(Ie,Ve)}}function gn(){let ge=[],Ie=!1;for(let Q of ee){let Ve=M.fetchers.get(Q);Dn(Ve,"Expected fetcher: "+Q),Ve.state==="loading"&&(ee.delete(Q),ge.push(Q),Ie=!0)}return Lt(ge),Ie}function mn(ge){let Ie=[];for(let[Q,Ve]of H)if(Ve<ge){let tt=M.fetchers.get(Q);Dn(tt,"Expected fetcher: "+Q),tt.state==="loading"&&(Ge(Q),H.delete(Q),Ie.push(Q))}return Lt(Ie),Ie.length>0}function wn(ge,Ie){let Q=M.blockers.get(ge)||cf;return ft.get(ge)!==Ie&&ft.set(ge,Ie),Q}function hn(ge){M.blockers.delete(ge),ft.delete(ge)}function Bn(ge,Ie){let Q=M.blockers.get(ge)||cf;Dn(Q.state==="unblocked"&&Ie.state==="blocked"||Q.state==="blocked"&&Ie.state==="blocked"||Q.state==="blocked"&&Ie.state==="proceeding"||Q.state==="blocked"&&Ie.state==="unblocked"||Q.state==="proceeding"&&Ie.state==="unblocked","Invalid blocker state transition: "+Q.state+" -> "+Ie.state);let Ve=new Map(M.blockers);Ve.set(ge,Ie),Nt({blockers:Ve})}function Sr(ge){let{currentLocation:Ie,nextLocation:Q,historyAction:Ve}=ge;if(ft.size===0)return;ft.size>1&&fd(!1,"A router only supports one blocker at a time");let tt=Array.from(ft.entries()),[Et,Bt]=tt[tt.length-1],ht=M.blockers.get(Et);if(!(ht&&ht.state==="proceeding")&&Bt({currentLocation:Ie,nextLocation:Q,historyAction:Ve}))return Et}function mr(ge){let Ie=ds(404,{pathname:ge}),Q=c||a,{matches:Ve,route:tt}=Jw(Q);return Qt(),{notFoundMatches:Ve,route:tt,error:Ie}}function Qt(ge){let Ie=[];return Ne.forEach((Q,Ve)=>{(!ge||ge(Ve))&&(Q.cancel(),Ie.push(Ve),Ne.delete(Ve))}),Ie}function Yr(ge,Ie,Q){if(C=ge,b=Ie,x=Q||null,!S&&M.navigation===av){S=!0;let Ve=Ht(M.location,M.matches);Ve!=null&&Nt({restoreScrollPosition:Ve})}return()=>{C=null,b=null,x=null}}function Je(ge,Ie){return x&&x(ge,Ie.map(Ve=>GR(Ve,M.loaderData)))||ge.key}function En(ge,Ie){if(C&&b){let Q=Je(ge,Ie);C[Q]=b()}}function Ht(ge,Ie){if(C){let Q=Je(ge,Ie),Ve=C[Q];if(typeof Ve=="number")return Ve}return null}function fr(ge,Ie,Q){if(h)if(ge){if(Object.keys(ge[0].params).length>0)return{active:!0,matches:D0(Ie,Q,d,!0)}}else return{active:!0,matches:D0(Ie,Q,d,!0)||[]};return{active:!1,matches:null}}async function $n(ge,Ie,Q,Ve){if(!h)return{type:"success",matches:ge};let tt=ge;for(;;){let Et=c==null,Bt=c||a,ht=s;try{await h({signal:Q,path:Ie,matches:tt,fetcherKey:Ve,patch:(Fe,lt)=>{Q.aborted||Hw(Fe,lt,Bt,ht,i)}})}catch(Fe){return{type:"error",error:Fe,partialMatches:tt}}finally{Et&&!Q.aborted&&(a=[...a])}if(Q.aborted)return{type:"aborted"};let pt=Hl(Bt,Ie,d);if(pt)return{type:"success",matches:pt};let Ct=D0(Bt,Ie,d,!0);if(!Ct||tt.length===Ct.length&&tt.every((Fe,lt)=>Fe.route.id===Ct[lt].route.id))return{type:"success",matches:null};tt=Ct}}function Qr(ge){s={},c=Mp(ge,i,void 0,s)}function Mr(ge,Ie){let Q=c==null;Hw(ge,Ie,c||a,s,i),Q&&(a=[...a],Nt({}))}return V={get basename(){return d},get future(){return v},get state(){return M},get routes(){return a},get window(){return e},initialize:ct,subscribe:Wt,enableScrollRestoration:Yr,navigate:Rt,fetch:an,revalidate:st,createHref:ge=>n.history.createHref(ge),encodeLocation:ge=>n.history.encodeLocation(ge),getFetcher:te,deleteFetcher:De,dispose:At,getBlocker:wn,deleteBlocker:hn,patchRoutes:Mr,_internalFetchControllers:we,_internalActiveDeferreds:Ne,_internalSetRoutes:Qr},V}function p3(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function $v(n,e,t,r,i,s,a,c){let d,f;if(a){d=[];for(let v of e)if(d.push(v),v.route.id===a){f=v;break}}else d=e,f=e[e.length-1];let h=n3(i||".",t3(d,s),ch(n.pathname,t)||n.pathname,c==="path");if(i==null&&(h.search=n.search,h.hash=n.hash),(i==null||i===""||i===".")&&f){let v=gC(h.search);if(f.route.index&&!v)h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index";else if(!f.route.index&&v){let m=new URLSearchParams(h.search),y=m.getAll("index");m.delete("index"),y.filter(x=>x).forEach(x=>m.append("index",x));let C=m.toString();h.search=C?"?"+C:""}}return r&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ql([t,h.pathname])),ah(h)}function Vw(n,e,t,r){if(!r||!p3(r))return{path:t};if(r.formMethod&&!k3(r.formMethod))return{path:t,error:ds(405,{method:r.formMethod})};let i=()=>({path:t,error:ds(400,{type:"invalid-body"})}),s=r.formMethod||"get",a=n?s.toUpperCase():s.toLowerCase(),c=kA(t);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!ko(a))return i();let m=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((y,C)=>{let[x,b]=C;return""+y+x+"="+b+`
`},""):String(r.body);return{path:t,submission:{formMethod:a,formAction:c,formEncType:r.formEncType,formData:void 0,json:void 0,text:m}}}else if(r.formEncType==="application/json"){if(!ko(a))return i();try{let m=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:t,submission:{formMethod:a,formAction:c,formEncType:r.formEncType,formData:void 0,json:m,text:void 0}}}catch{return i()}}}Dn(typeof FormData=="function","FormData is not available in this environment");let d,f;if(r.formData)d=qv(r.formData),f=r.formData;else if(r.body instanceof FormData)d=qv(r.body),f=r.body;else if(r.body instanceof URLSearchParams)d=r.body,f=Xw(d);else if(r.body==null)d=new URLSearchParams,f=new FormData;else try{d=new URLSearchParams(r.body),f=Xw(d)}catch{return i()}let h={formMethod:a,formAction:c,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:f,json:void 0,text:void 0};if(ko(h.formMethod))return{path:t,submission:h};let v=Cl(t);return e&&v.search&&gC(v.search)&&d.append("index",""),v.search="?"+d,{path:ah(v),submission:h}}function jw(n,e,t){t===void 0&&(t=!1);let r=n.findIndex(i=>i.route.id===e);return r>=0?n.slice(0,t?r+1:r):n}function Ww(n,e,t,r,i,s,a,c,d,f,h,v,m,y,C,x){let b=x?Ps(x[1])?x[1].error:x[1].data:void 0,S=n.createURL(e.location),A=n.createURL(i),E=t;s&&e.errors?E=jw(t,Object.keys(e.errors)[0],!0):x&&Ps(x[1])&&(E=jw(t,x[0]));let R=x?x[1].statusCode:void 0,N=a&&R&&R>=400,V=E.filter((j,J)=>{let{route:L}=j;if(L.lazy)return!0;if(L.loader==null)return!1;if(s)return Kv(L,e.loaderData,e.errors);if(g3(e.loaderData,e.matches[J],j)||d.some(ie=>ie===j.route.id))return!0;let z=e.matches[J],Y=j;return zw(j,pr({currentUrl:S,currentParams:z.params,nextUrl:A,nextParams:Y.params},r,{actionResult:b,actionStatus:R,defaultShouldRevalidate:N?!1:c||S.pathname+S.search===A.pathname+A.search||S.search!==A.search||SA(z,Y)}))}),M=[];return v.forEach((j,J)=>{if(s||!t.some(pe=>pe.route.id===j.routeId)||h.has(J))return;let L=Hl(y,j.path,C);if(!L){M.push({key:J,routeId:j.routeId,path:j.path,matches:null,match:null,controller:null});return}let z=e.fetchers.get(J),Y=kf(L,j.path),ie=!1;m.has(J)?ie=!1:f.has(J)?(f.delete(J),ie=!0):z&&z.state!=="idle"&&z.data===void 0?ie=c:ie=zw(Y,pr({currentUrl:S,currentParams:e.matches[e.matches.length-1].params,nextUrl:A,nextParams:t[t.length-1].params},r,{actionResult:b,actionStatus:R,defaultShouldRevalidate:N?!1:c})),ie&&M.push({key:J,routeId:j.routeId,path:j.path,matches:L,match:Y,controller:new AbortController})}),[V,M]}function Kv(n,e,t){if(n.lazy)return!0;if(!n.loader)return!1;let r=e!=null&&e[n.id]!==void 0,i=t!=null&&t[n.id]!==void 0;return!r&&i?!1:typeof n.loader=="function"&&n.loader.hydrate===!0?!0:!r&&!i}function g3(n,e,t){let r=!e||t.route.id!==e.route.id,i=n[t.route.id]===void 0;return r||i}function SA(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function zw(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function Hw(n,e,t,r,i){var s;let a;if(n){let f=r[n];Dn(f,"No route found to patch children into: routeId = "+n),f.children||(f.children=[]),a=f.children}else a=t;let c=e.filter(f=>!a.some(h=>AA(f,h))),d=Mp(c,i,[n||"_","patch",String(((s=a)==null?void 0:s.length)||"0")],r);a.push(...d)}function AA(n,e){return"id"in n&&"id"in e&&n.id===e.id?!0:n.index===e.index&&n.path===e.path&&n.caseSensitive===e.caseSensitive?(!n.children||n.children.length===0)&&(!e.children||e.children.length===0)?!0:n.children.every((t,r)=>{var i;return(i=e.children)==null?void 0:i.some(s=>AA(t,s))}):!1}async function m3(n,e,t){if(!n.lazy)return;let r=await n.lazy();if(!n.lazy)return;let i=t[n.id];Dn(i,"No route found in manifest");let s={};for(let a in r){let d=i[a]!==void 0&&a!=="hasErrorBoundary";fd(!d,'Route "'+i.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!d&&!LR.has(a)&&(s[a]=r[a])}Object.assign(i,s),Object.assign(i,pr({},e(i),{lazy:void 0}))}async function v3(n){let{matches:e}=n,t=e.filter(i=>i.shouldLoad);return(await Promise.all(t.map(i=>i.resolve()))).reduce((i,s,a)=>Object.assign(i,{[t[a].route.id]:s}),{})}async function y3(n,e,t,r,i,s,a,c,d,f){let h=s.map(y=>y.route.lazy?m3(y.route,d,c):void 0),v=s.map((y,C)=>{let x=h[C],b=i.some(A=>A.route.id===y.route.id);return pr({},y,{shouldLoad:b,resolve:async A=>(A&&r.method==="GET"&&(y.route.lazy||y.route.loader)&&(b=!0),b?C3(e,r,y,x,A,f):Promise.resolve({type:jn.data,result:void 0}))})}),m=await n({matches:v,request:r,params:s[0].params,fetcherKey:a,context:f});try{await Promise.all(h)}catch{}return m}async function C3(n,e,t,r,i,s){let a,c,d=f=>{let h,v=new Promise((C,x)=>h=x);c=()=>h(),e.signal.addEventListener("abort",c);let m=C=>typeof f!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+n+'" [routeId: '+t.route.id+"]"))):f({request:e,params:t.params,context:s},...C!==void 0?[C]:[]),y=(async()=>{try{return{type:"data",result:await(i?i(x=>m(x)):m())}}catch(C){return{type:"error",result:C}}})();return Promise.race([y,v])};try{let f=t.route[n];if(r)if(f){let h,[v]=await Promise.all([d(f).catch(m=>{h=m}),r]);if(h!==void 0)throw h;a=v}else if(await r,f=t.route[n],f)a=await d(f);else if(n==="action"){let h=new URL(e.url),v=h.pathname+h.search;throw ds(405,{method:e.method,pathname:v,routeId:t.route.id})}else return{type:jn.data,result:void 0};else if(f)a=await d(f);else{let h=new URL(e.url),v=h.pathname+h.search;throw ds(404,{pathname:v})}Dn(a.result!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+t.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(f){return{type:jn.error,result:f}}finally{c&&e.signal.removeEventListener("abort",c)}return a}async function x3(n){let{result:e,type:t}=n;if(EA(e)){let v;try{let m=e.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?e.body==null?v=null:v=await e.json():v=await e.text()}catch(m){return{type:jn.error,error:m}}return t===jn.error?{type:jn.error,error:new Bp(e.status,e.statusText,v),statusCode:e.status,headers:e.headers}:{type:jn.data,data:v,statusCode:e.status,headers:e.headers}}if(t===jn.error){if(Yw(e)){var r,i;if(e.data instanceof Error){var s,a;return{type:jn.error,error:e.data,statusCode:(s=e.init)==null?void 0:s.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:jn.error,error:new Bp(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Vf(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:jn.error,error:e,statusCode:Vf(e)?e.status:void 0}}if(A3(e)){var c,d;return{type:jn.deferred,deferredData:e,statusCode:(c=e.init)==null?void 0:c.status,headers:((d=e.init)==null?void 0:d.headers)&&new Headers(e.init.headers)}}if(Yw(e)){var f,h;return{type:jn.data,data:e.data,statusCode:(f=e.init)==null?void 0:f.status,headers:(h=e.init)!=null&&h.headers?new Headers(e.init.headers):void 0}}return{type:jn.data,data:e}}function w3(n,e,t,r,i,s){let a=n.headers.get("Location");if(Dn(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!hC.test(a)){let c=r.slice(0,r.findIndex(d=>d.route.id===t)+1);a=$v(new URL(e.url),c,i,!0,a,s),n.headers.set("Location",a)}return n}function Zw(n,e,t){if(hC.test(n)){let r=n,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),s=ch(i.pathname,t)!=null;if(i.origin===e.origin&&s)return i.pathname+i.search+i.hash}return n}function Hu(n,e,t,r){let i=n.createURL(kA(e)).toString(),s={signal:t};if(r&&ko(r.formMethod)){let{formMethod:a,formEncType:c}=r;s.method=a.toUpperCase(),c==="application/json"?(s.headers=new Headers({"Content-Type":c}),s.body=JSON.stringify(r.json)):c==="text/plain"?s.body=r.text:c==="application/x-www-form-urlencoded"&&r.formData?s.body=qv(r.formData):s.body=r.formData}return new Request(i,s)}function qv(n){let e=new URLSearchParams;for(let[t,r]of n.entries())e.append(t,typeof r=="string"?r:r.name);return e}function Xw(n){let e=new FormData;for(let[t,r]of n.entries())e.append(t,r);return e}function I3(n,e,t,r,i){let s={},a=null,c,d=!1,f={},h=t&&Ps(t[1])?t[1].error:void 0;return n.forEach(v=>{if(!(v.route.id in e))return;let m=v.route.id,y=e[m];if(Dn(!ql(y),"Cannot handle redirect results in processLoaderData"),Ps(y)){let C=y.error;h!==void 0&&(C=h,h=void 0),a=a||{};{let x=Zl(n,m);a[x.route.id]==null&&(a[x.route.id]=C)}s[m]=void 0,d||(d=!0,c=Vf(y.error)?y.error.status:500),y.headers&&(f[m]=y.headers)}else al(y)?(r.set(m,y.deferredData),s[m]=y.deferredData.data,y.statusCode!=null&&y.statusCode!==200&&!d&&(c=y.statusCode),y.headers&&(f[m]=y.headers)):(s[m]=y.data,y.statusCode&&y.statusCode!==200&&!d&&(c=y.statusCode),y.headers&&(f[m]=y.headers))}),h!==void 0&&t&&(a={[t[0]]:h},s[t[0]]=void 0),{loaderData:s,errors:a,statusCode:c||200,loaderHeaders:f}}function $w(n,e,t,r,i,s,a){let{loaderData:c,errors:d}=I3(e,t,r,a);return i.forEach(f=>{let{key:h,match:v,controller:m}=f,y=s[h];if(Dn(y,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(Ps(y)){let C=Zl(n.matches,v==null?void 0:v.route.id);d&&d[C.route.id]||(d=pr({},d,{[C.route.id]:y.error})),n.fetchers.delete(h)}else if(ql(y))Dn(!1,"Unhandled fetcher revalidation redirect");else if(al(y))Dn(!1,"Unhandled fetcher deferred data");else{let C=el(y.data);n.fetchers.set(h,C)}}),{loaderData:c,errors:d}}function Kw(n,e,t,r){let i=pr({},e);for(let s of t){let a=s.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(i[a]=e[a]):n[a]!==void 0&&s.route.loader&&(i[a]=n[a]),r&&r.hasOwnProperty(a))break}return i}function qw(n){return n?Ps(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function Zl(n,e){return(e?n.slice(0,n.findIndex(r=>r.route.id===e)+1):[...n]).reverse().find(r=>r.route.hasErrorBoundary===!0)||n[0]}function Jw(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ds(n,e){let{pathname:t,routeId:r,method:i,type:s,message:a}=e===void 0?{}:e,c="Unknown Server Error",d="Unknown @remix-run/router error";return n===400?(c="Bad Request",i&&t&&r?d="You made a "+i+' request to "'+t+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":s==="defer-action"?d="defer() is not supported in actions":s==="invalid-body"&&(d="Unable to encode submission body")):n===403?(c="Forbidden",d='Route "'+r+'" does not match URL "'+t+'"'):n===404?(c="Not Found",d='No route matches URL "'+t+'"'):n===405&&(c="Method Not Allowed",i&&t&&r?d="You made a "+i.toUpperCase()+' request to "'+t+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(d='Invalid request method "'+i.toUpperCase()+'"')),new Bp(n||500,c,new Error(d),!0)}function g0(n){let e=Object.entries(n);for(let t=e.length-1;t>=0;t--){let[r,i]=e[t];if(ql(i))return{key:r,result:i}}}function kA(n){let e=typeof n=="string"?Cl(n):n;return ah(pr({},e,{hash:""}))}function b3(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function S3(n){return EA(n.result)&&l3.has(n.result.status)}function al(n){return n.type===jn.deferred}function Ps(n){return n.type===jn.error}function ql(n){return(n&&n.type)===jn.redirect}function Yw(n){return typeof n=="object"&&n!=null&&"type"in n&&"data"in n&&"init"in n&&n.type==="DataWithResponseInit"}function A3(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function EA(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function k3(n){return c3.has(n.toLowerCase())}function ko(n){return o3.has(n.toLowerCase())}async function E3(n,e,t,r,i){let s=Object.entries(e);for(let a=0;a<s.length;a++){let[c,d]=s[a],f=n.find(m=>(m==null?void 0:m.route.id)===c);if(!f)continue;let h=r.find(m=>m.route.id===f.route.id),v=h!=null&&!SA(h,f)&&(i&&i[f.route.id])!==void 0;al(d)&&v&&await pC(d,t,!1).then(m=>{m&&(e[c]=m)})}}async function T3(n,e,t){for(let r=0;r<t.length;r++){let{key:i,routeId:s,controller:a}=t[r],c=e[i];n.find(f=>(f==null?void 0:f.route.id)===s)&&al(c)&&(Dn(a,"Expected an AbortController for revalidating fetcher deferred result"),await pC(c,a.signal,!0).then(f=>{f&&(e[i]=f)}))}}async function pC(n,e,t){if(t===void 0&&(t=!1),!await n.deferredData.resolveData(e)){if(t)try{return{type:jn.data,data:n.deferredData.unwrappedData}}catch(i){return{type:jn.error,error:i}}return{type:jn.data,data:n.deferredData.data}}}function gC(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function kf(n,e){let t=typeof e=="string"?Cl(e).search:e.search;if(n[n.length-1].route.index&&gC(t||""))return n[n.length-1];let r=wA(n);return r[r.length-1]}function Qw(n){let{formMethod:e,formAction:t,formEncType:r,text:i,formData:s,json:a}=n;if(!(!e||!t||!r)){if(i!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:t,formEncType:r,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:a,text:void 0}}}function cv(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function _3(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function lf(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function R3(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function el(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function D3(n,e){try{let t=n.sessionStorage.getItem(bA);if(t){let r=JSON.parse(t);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function P3(n,e){if(e.size>0){let t={};for(let[r,i]of e)t[r]=[...i];try{n.sessionStorage.setItem(bA,JSON.stringify(t))}catch(r){fd(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jv(){return Jv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Jv.apply(this,arguments)}const TA=F.createContext(null),_A=F.createContext(null),RA=F.createContext(null),mC=F.createContext(null),fg=F.createContext({outlet:null,matches:[],isDataRoute:!1}),DA=F.createContext(null);function vC(){return F.useContext(mC)!=null}function PA(){return vC()||Dn(!1),F.useContext(mC).location}function N3(n,e,t,r){vC()||Dn(!1);let{navigator:i}=F.useContext(RA),{matches:s}=F.useContext(fg),a=s[s.length-1],c=a?a.params:{};a&&a.pathname;let d=a?a.pathnameBase:"/";a&&a.route;let f=PA(),h;h=f;let v=h.pathname||"/",m=v;if(d!=="/"){let x=d.replace(/^\//,"").split("/");m="/"+v.replace(/^\//,"").split("/").slice(x.length).join("/")}let y=Hl(n,{pathname:m});return L3(y&&y.map(x=>Object.assign({},x,{params:Object.assign({},c,x.params),pathname:Ql([d,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?d:Ql([d,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,t,r)}function M3(){let n=j3(),e=Vf(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),t?F.createElement("pre",{style:i},t):null,null)}const B3=F.createElement(M3,null);class O3 extends F.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?F.createElement(fg.Provider,{value:this.props.routeContext},F.createElement(DA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function F3(n){let{routeContext:e,match:t,children:r}=n,i=F.useContext(TA);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),F.createElement(fg.Provider,{value:e},r)}function L3(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,c=(i=t)==null?void 0:i.errors;if(c!=null){let h=a.findIndex(v=>v.route.id&&(c==null?void 0:c[v.route.id])!==void 0);h>=0||Dn(!1),a=a.slice(0,Math.min(a.length,h+1))}let d=!1,f=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<a.length;h++){let v=a[h];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=h),v.route.id){let{loaderData:m,errors:y}=t,C=v.route.loader&&m[v.route.id]===void 0&&(!y||y[v.route.id]===void 0);if(v.route.lazy||C){d=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((h,v,m)=>{let y,C=!1,x=null,b=null;t&&(y=c&&v.route.id?c[v.route.id]:void 0,x=v.route.errorElement||B3,d&&(f<0&&m===0?(W3("route-fallback"),C=!0,b=null):f===m&&(C=!0,b=v.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,m+1)),A=()=>{let E;return y?E=x:C?E=b:v.route.Component?E=F.createElement(v.route.Component,null):v.route.element?E=v.route.element:E=h,F.createElement(F3,{match:v,routeContext:{outlet:h,matches:S,isDataRoute:t!=null},children:E})};return t&&(v.route.ErrorBoundary||v.route.errorElement||m===0)?F.createElement(O3,{location:t.location,revalidation:t.revalidation,component:x,error:y,children:A(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):A()},null)}var NA=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(NA||{});function U3(n){let e=F.useContext(_A);return e||Dn(!1),e}function G3(n){let e=F.useContext(fg);return e||Dn(!1),e}function V3(n){let e=G3(),t=e.matches[e.matches.length-1];return t.route.id||Dn(!1),t.route.id}function j3(){var n;let e=F.useContext(DA),t=U3(NA.UseRouteError),r=V3();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}const eI={};function W3(n,e,t){eI[n]||(eI[n]=!0)}function z3(n,e){n==null||n.v7_startTransition,(n==null?void 0:n.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function H3(n){let{basename:e="/",children:t=null,location:r,navigationType:i=Fr.Pop,navigator:s,static:a=!1,future:c}=n;vC()&&Dn(!1);let d=e.replace(/^\/*/,"/"),f=F.useMemo(()=>({basename:d,navigator:s,static:a,future:Jv({v7_relativeSplatPath:!1},c)}),[d,c,s,a]);typeof r=="string"&&(r=Cl(r));let{pathname:h="/",search:v="",hash:m="",state:y=null,key:C="default"}=r,x=F.useMemo(()=>{let b=ch(h,d);return b==null?null:{location:{pathname:b,search:v,hash:m,state:y,key:C},navigationType:i}},[d,h,v,m,y,C,i]);return x==null?null:F.createElement(RA.Provider,{value:f},F.createElement(mC.Provider,{children:t,value:x}))}new Promise(()=>{});function Z3(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:F.createElement(n.Component),Component:void 0}),n.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:F.createElement(n.HydrateFallback),HydrateFallback:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:F.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Op(){return Op=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Op.apply(this,arguments)}const X3="6";try{window.__reactRouterVersion=X3}catch{}function $3(n,e){return h3({basename:void 0,future:Op({},void 0,{v7_prependBasename:!0}),history:BR({window:void 0}),hydrationData:K3(),routes:n,mapRouteProperties:Z3,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function K3(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=Op({},e,{errors:q3(e.errors)})),e}function q3(n){if(!n)return null;let e=Object.entries(n),t={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")t[r]=new Bp(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let a=new s(i.message);a.stack="",t[r]=a}catch{}}if(t[r]==null){let s=new Error(i.message);s.stack="",t[r]=s}}else t[r]=i;return t}const J3=F.createContext({isTransitioning:!1}),Y3=F.createContext(new Map),Q3="startTransition",tI=kR[Q3],eD="flushSync",nI=MR[eD];function tD(n){tI?tI(n):n()}function uf(n){nI?nI(n):n()}class nD{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}}function rD(n){let{fallbackElement:e,router:t,future:r}=n,[i,s]=F.useState(t.state),[a,c]=F.useState(),[d,f]=F.useState({isTransitioning:!1}),[h,v]=F.useState(),[m,y]=F.useState(),[C,x]=F.useState(),b=F.useRef(new Map),{v7_startTransition:S}=r||{},A=F.useCallback(j=>{S?tD(j):j()},[S]),E=F.useCallback((j,J)=>{let{deletedFetchers:L,flushSync:z,viewTransitionOpts:Y}=J;j.fetchers.forEach((pe,xe)=>{pe.data!==void 0&&b.current.set(xe,pe.data)}),L.forEach(pe=>b.current.delete(pe));let ie=t.window==null||t.window.document==null||typeof t.window.document.startViewTransition!="function";if(!Y||ie){z?uf(()=>s(j)):A(()=>s(j));return}if(z){uf(()=>{m&&(h&&h.resolve(),m.skipTransition()),f({isTransitioning:!0,flushSync:!0,currentLocation:Y.currentLocation,nextLocation:Y.nextLocation})});let pe=t.window.document.startViewTransition(()=>{uf(()=>s(j))});pe.finished.finally(()=>{uf(()=>{v(void 0),y(void 0),c(void 0),f({isTransitioning:!1})})}),uf(()=>y(pe));return}m?(h&&h.resolve(),m.skipTransition(),x({state:j,currentLocation:Y.currentLocation,nextLocation:Y.nextLocation})):(c(j),f({isTransitioning:!0,flushSync:!1,currentLocation:Y.currentLocation,nextLocation:Y.nextLocation}))},[t.window,m,h,b,A]);F.useLayoutEffect(()=>t.subscribe(E),[t,E]),F.useEffect(()=>{d.isTransitioning&&!d.flushSync&&v(new nD)},[d]),F.useEffect(()=>{if(h&&a&&t.window){let j=a,J=h.promise,L=t.window.document.startViewTransition(async()=>{A(()=>s(j)),await J});L.finished.finally(()=>{v(void 0),y(void 0),c(void 0),f({isTransitioning:!1})}),y(L)}},[A,a,h,t.window]),F.useEffect(()=>{h&&a&&i.location.key===a.location.key&&h.resolve()},[h,m,i.location,a]),F.useEffect(()=>{!d.isTransitioning&&C&&(c(C.state),f({isTransitioning:!0,flushSync:!1,currentLocation:C.currentLocation,nextLocation:C.nextLocation}),x(void 0))},[d.isTransitioning,C]),F.useEffect(()=>{},[]);let R=F.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:j=>t.navigate(j),push:(j,J,L)=>t.navigate(j,{state:J,preventScrollReset:L==null?void 0:L.preventScrollReset}),replace:(j,J,L)=>t.navigate(j,{replace:!0,state:J,preventScrollReset:L==null?void 0:L.preventScrollReset})}),[t]),N=t.basename||"/",V=F.useMemo(()=>({router:t,navigator:R,static:!1,basename:N}),[t,R,N]),M=F.useMemo(()=>({v7_relativeSplatPath:t.future.v7_relativeSplatPath}),[t.future.v7_relativeSplatPath]);return F.useEffect(()=>z3(r,t.future),[r,t.future]),F.createElement(F.Fragment,null,F.createElement(TA.Provider,{value:V},F.createElement(_A.Provider,{value:i},F.createElement(Y3.Provider,{value:b.current},F.createElement(J3.Provider,{value:d},F.createElement(H3,{basename:N,location:i.location,navigationType:i.historyAction,navigator:R,future:M},i.initialized||t.future.v7_partialHydration?F.createElement(iD,{routes:t.routes,future:t.future,state:i}):e))))),null)}const iD=F.memo(sD);function sD(n){let{routes:e,future:t,state:r}=n;return N3(e,void 0,r,t)}var rI;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(rI||(rI={}));var iI;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(iI||(iI={}));const MA=n=>{const e=typeof n=="function",t=F.useRef(n);F.useEffect(()=>{t.current=n}),F.useEffect(()=>{if(e){const r=i=>{const s=t.current(i);if(typeof s=="string")return i.preventDefault(),i.returnValue=s;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var lv={exports:{}},sI;function oD(){return sI||(sI=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(d,f,h){this.fn=d,this.context=f,this.once=h||!1}function s(d,f,h,v,m){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new i(h,v||d,m),C=t?t+f:f;return d._events[C]?d._events[C].fn?d._events[C]=[d._events[C],y]:d._events[C].push(y):(d._events[C]=y,d._eventsCount++),d}function a(d,f){--d._eventsCount===0?d._events=new r:delete d._events[f]}function c(){this._events=new r,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],h,v;if(this._eventsCount===0)return f;for(v in h=this._events)e.call(h,v)&&f.push(t?v.slice(1):v);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},c.prototype.listeners=function(f){var h=t?t+f:f,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var m=0,y=v.length,C=new Array(y);m<y;m++)C[m]=v[m].fn;return C},c.prototype.listenerCount=function(f){var h=t?t+f:f,v=this._events[h];return v?v.fn?1:v.length:0},c.prototype.emit=function(f,h,v,m,y,C){var x=t?t+f:f;if(!this._events[x])return!1;var b=this._events[x],S=arguments.length,A,E;if(b.fn){switch(b.once&&this.removeListener(f,b.fn,void 0,!0),S){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,v),!0;case 4:return b.fn.call(b.context,h,v,m),!0;case 5:return b.fn.call(b.context,h,v,m,y),!0;case 6:return b.fn.call(b.context,h,v,m,y,C),!0}for(E=1,A=new Array(S-1);E<S;E++)A[E-1]=arguments[E];b.fn.apply(b.context,A)}else{var R=b.length,N;for(E=0;E<R;E++)switch(b[E].once&&this.removeListener(f,b[E].fn,void 0,!0),S){case 1:b[E].fn.call(b[E].context);break;case 2:b[E].fn.call(b[E].context,h);break;case 3:b[E].fn.call(b[E].context,h,v);break;case 4:b[E].fn.call(b[E].context,h,v,m);break;default:if(!A)for(N=1,A=new Array(S-1);N<S;N++)A[N-1]=arguments[N];b[E].fn.apply(b[E].context,A)}}return!0},c.prototype.on=function(f,h,v){return s(this,f,h,v,!1)},c.prototype.once=function(f,h,v){return s(this,f,h,v,!0)},c.prototype.removeListener=function(f,h,v,m){var y=t?t+f:f;if(!this._events[y])return this;if(!h)return a(this,y),this;var C=this._events[y];if(C.fn)C.fn===h&&(!m||C.once)&&(!v||C.context===v)&&a(this,y);else{for(var x=0,b=[],S=C.length;x<S;x++)(C[x].fn!==h||m&&!C[x].once||v&&C[x].context!==v)&&b.push(C[x]);b.length?this._events[y]=b.length===1?b[0]:b:a(this,y)}return this},c.prototype.removeAllListeners=function(f){var h;return f?(h=t?t+f:f,this._events[h]&&a(this,h)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,n.exports=c}(lv)),lv.exports}var aD=oD();const hg=kc(aD);var uv={},df={},oI;function cD(){if(oI)return df;oI=1,df.byteLength=c,df.toByteArray=f,df.fromByteArray=m;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,s=r.length;i<s;++i)n[i]=r[i],e[r.charCodeAt(i)]=i;e[45]=62,e[95]=63;function a(y){var C=y.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=y.indexOf("=");x===-1&&(x=C);var b=x===C?0:4-x%4;return[x,b]}function c(y){var C=a(y),x=C[0],b=C[1];return(x+b)*3/4-b}function d(y,C,x){return(C+x)*3/4-x}function f(y){var C,x=a(y),b=x[0],S=x[1],A=new t(d(y,b,S)),E=0,R=S>0?b-4:b,N;for(N=0;N<R;N+=4)C=e[y.charCodeAt(N)]<<18|e[y.charCodeAt(N+1)]<<12|e[y.charCodeAt(N+2)]<<6|e[y.charCodeAt(N+3)],A[E++]=C>>16&255,A[E++]=C>>8&255,A[E++]=C&255;return S===2&&(C=e[y.charCodeAt(N)]<<2|e[y.charCodeAt(N+1)]>>4,A[E++]=C&255),S===1&&(C=e[y.charCodeAt(N)]<<10|e[y.charCodeAt(N+1)]<<4|e[y.charCodeAt(N+2)]>>2,A[E++]=C>>8&255,A[E++]=C&255),A}function h(y){return n[y>>18&63]+n[y>>12&63]+n[y>>6&63]+n[y&63]}function v(y,C,x){for(var b,S=[],A=C;A<x;A+=3)b=(y[A]<<16&16711680)+(y[A+1]<<8&65280)+(y[A+2]&255),S.push(h(b));return S.join("")}function m(y){for(var C,x=y.length,b=x%3,S=[],A=16383,E=0,R=x-b;E<R;E+=A)S.push(v(y,E,E+A>R?R:E+A));return b===1?(C=y[x-1],S.push(n[C>>2]+n[C<<4&63]+"==")):b===2&&(C=(y[x-2]<<8)+y[x-1],S.push(n[C>>10]+n[C>>4&63]+n[C<<2&63]+"=")),S.join("")}return df}var m0={},aI;function lD(){if(aI)return m0;aI=1;/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */return m0.read=function(n,e,t,r,i){var s,a,c=i*8-r-1,d=(1<<c)-1,f=d>>1,h=-7,v=t?i-1:0,m=t?-1:1,y=n[e+v];for(v+=m,s=y&(1<<-h)-1,y>>=-h,h+=c;h>0;s=s*256+n[e+v],v+=m,h-=8);for(a=s&(1<<-h)-1,s>>=-h,h+=r;h>0;a=a*256+n[e+v],v+=m,h-=8);if(s===0)s=1-f;else{if(s===d)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-f}return(y?-1:1)*a*Math.pow(2,s-r)},m0.write=function(n,e,t,r,i,s){var a,c,d,f=s*8-i-1,h=(1<<f)-1,v=h>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=r?0:s-1,C=r?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-a))<1&&(a--,d*=2),a+v>=1?e+=m/d:e+=m*Math.pow(2,1-v),e*d>=2&&(a++,d/=2),a+v>=h?(c=0,a=h):a+v>=1?(c=(e*d-1)*Math.pow(2,i),a=a+v):(c=e*Math.pow(2,v-1)*Math.pow(2,i),a=0));i>=8;n[t+y]=c&255,y+=C,c/=256,i-=8);for(a=a<<i|c,f+=i;f>0;n[t+y]=a&255,y+=C,a/=256,f-=8);n[t+y-C]|=x*128},m0}var cI;function uD(){return cI||(cI=1,function(n){const e=cD(),t=lD(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=c,n.SlowBuffer=A,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i,c.TYPED_ARRAY_SUPPORT=s(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const X=new Uint8Array(1),D={foo:function(){return 42}};return Object.setPrototypeOf(D,Uint8Array.prototype),Object.setPrototypeOf(X,D),X.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function a(X){if(X>i)throw new RangeError('The value "'+X+'" is invalid for option "size"');const D=new Uint8Array(X);return Object.setPrototypeOf(D,c.prototype),D}function c(X,D,B){if(typeof X=="number"){if(typeof D=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(X)}return d(X,D,B)}c.poolSize=8192;function d(X,D,B){if(typeof X=="string")return m(X,D);if(ArrayBuffer.isView(X))return C(X);if(X==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof X);if(ot(X,ArrayBuffer)||X&&ot(X.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ot(X,SharedArrayBuffer)||X&&ot(X.buffer,SharedArrayBuffer)))return x(X,D,B);if(typeof X=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const te=X.valueOf&&X.valueOf();if(te!=null&&te!==X)return c.from(te,D,B);const me=b(X);if(me)return me;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof X[Symbol.toPrimitive]=="function")return c.from(X[Symbol.toPrimitive]("string"),D,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof X)}c.from=function(X,D,B){return d(X,D,B)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function f(X){if(typeof X!="number")throw new TypeError('"size" argument must be of type number');if(X<0)throw new RangeError('The value "'+X+'" is invalid for option "size"')}function h(X,D,B){return f(X),X<=0?a(X):D!==void 0?typeof B=="string"?a(X).fill(D,B):a(X).fill(D):a(X)}c.alloc=function(X,D,B){return h(X,D,B)};function v(X){return f(X),a(X<0?0:S(X)|0)}c.allocUnsafe=function(X){return v(X)},c.allocUnsafeSlow=function(X){return v(X)};function m(X,D){if((typeof D!="string"||D==="")&&(D="utf8"),!c.isEncoding(D))throw new TypeError("Unknown encoding: "+D);const B=E(X,D)|0;let te=a(B);const me=te.write(X,D);return me!==B&&(te=te.slice(0,me)),te}function y(X){const D=X.length<0?0:S(X.length)|0,B=a(D);for(let te=0;te<D;te+=1)B[te]=X[te]&255;return B}function C(X){if(ot(X,Uint8Array)){const D=new Uint8Array(X);return x(D.buffer,D.byteOffset,D.byteLength)}return y(X)}function x(X,D,B){if(D<0||X.byteLength<D)throw new RangeError('"offset" is outside of buffer bounds');if(X.byteLength<D+(B||0))throw new RangeError('"length" is outside of buffer bounds');let te;return D===void 0&&B===void 0?te=new Uint8Array(X):B===void 0?te=new Uint8Array(X,D):te=new Uint8Array(X,D,B),Object.setPrototypeOf(te,c.prototype),te}function b(X){if(c.isBuffer(X)){const D=S(X.length)|0,B=a(D);return B.length===0||X.copy(B,0,0,D),B}if(X.length!==void 0)return typeof X.length!="number"||le(X.length)?a(0):y(X);if(X.type==="Buffer"&&Array.isArray(X.data))return y(X.data)}function S(X){if(X>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return X|0}function A(X){return+X!=X&&(X=0),c.alloc(+X)}c.isBuffer=function(D){return D!=null&&D._isBuffer===!0&&D!==c.prototype},c.compare=function(D,B){if(ot(D,Uint8Array)&&(D=c.from(D,D.offset,D.byteLength)),ot(B,Uint8Array)&&(B=c.from(B,B.offset,B.byteLength)),!c.isBuffer(D)||!c.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(D===B)return 0;let te=D.length,me=B.length;for(let De=0,Ge=Math.min(te,me);De<Ge;++De)if(D[De]!==B[De]){te=D[De],me=B[De];break}return te<me?-1:me<te?1:0},c.isEncoding=function(D){switch(String(D).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(D,B){if(!Array.isArray(D))throw new TypeError('"list" argument must be an Array of Buffers');if(D.length===0)return c.alloc(0);let te;if(B===void 0)for(B=0,te=0;te<D.length;++te)B+=D[te].length;const me=c.allocUnsafe(B);let De=0;for(te=0;te<D.length;++te){let Ge=D[te];if(ot(Ge,Uint8Array))De+Ge.length>me.length?(c.isBuffer(Ge)||(Ge=c.from(Ge)),Ge.copy(me,De)):Uint8Array.prototype.set.call(me,Ge,De);else if(c.isBuffer(Ge))Ge.copy(me,De);else throw new TypeError('"list" argument must be an Array of Buffers');De+=Ge.length}return me};function E(X,D){if(c.isBuffer(X))return X.length;if(ArrayBuffer.isView(X)||ot(X,ArrayBuffer))return X.byteLength;if(typeof X!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof X);const B=X.length,te=arguments.length>2&&arguments[2]===!0;if(!te&&B===0)return 0;let me=!1;for(;;)switch(D){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return zt(X).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B*2;case"hex":return B>>>1;case"base64":return Xt(X).length;default:if(me)return te?-1:zt(X).length;D=(""+D).toLowerCase(),me=!0}}c.byteLength=E;function R(X,D,B){let te=!1;if((D===void 0||D<0)&&(D=0),D>this.length||((B===void 0||B>this.length)&&(B=this.length),B<=0)||(B>>>=0,D>>>=0,B<=D))return"";for(X||(X="utf8");;)switch(X){case"hex":return Se(this,D,B);case"utf8":case"utf-8":return pe(this,D,B);case"ascii":return Le(this,D,B);case"latin1":case"binary":return we(this,D,B);case"base64":return ie(this,D,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,D,B);default:if(te)throw new TypeError("Unknown encoding: "+X);X=(X+"").toLowerCase(),te=!0}}c.prototype._isBuffer=!0;function N(X,D,B){const te=X[D];X[D]=X[B],X[B]=te}c.prototype.swap16=function(){const D=this.length;if(D%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let B=0;B<D;B+=2)N(this,B,B+1);return this},c.prototype.swap32=function(){const D=this.length;if(D%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let B=0;B<D;B+=4)N(this,B,B+3),N(this,B+1,B+2);return this},c.prototype.swap64=function(){const D=this.length;if(D%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let B=0;B<D;B+=8)N(this,B,B+7),N(this,B+1,B+6),N(this,B+2,B+5),N(this,B+3,B+4);return this},c.prototype.toString=function(){const D=this.length;return D===0?"":arguments.length===0?pe(this,0,D):R.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(D){if(!c.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D?!0:c.compare(this,D)===0},c.prototype.inspect=function(){let D="";const B=n.INSPECT_MAX_BYTES;return D=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(D+=" ... "),"<Buffer "+D+">"},r&&(c.prototype[r]=c.prototype.inspect),c.prototype.compare=function(D,B,te,me,De){if(ot(D,Uint8Array)&&(D=c.from(D,D.offset,D.byteLength)),!c.isBuffer(D))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof D);if(B===void 0&&(B=0),te===void 0&&(te=D?D.length:0),me===void 0&&(me=0),De===void 0&&(De=this.length),B<0||te>D.length||me<0||De>this.length)throw new RangeError("out of range index");if(me>=De&&B>=te)return 0;if(me>=De)return-1;if(B>=te)return 1;if(B>>>=0,te>>>=0,me>>>=0,De>>>=0,this===D)return 0;let Ge=De-me,Lt=te-B;const gn=Math.min(Ge,Lt),mn=this.slice(me,De),wn=D.slice(B,te);for(let hn=0;hn<gn;++hn)if(mn[hn]!==wn[hn]){Ge=mn[hn],Lt=wn[hn];break}return Ge<Lt?-1:Lt<Ge?1:0};function V(X,D,B,te,me){if(X.length===0)return-1;if(typeof B=="string"?(te=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),B=+B,le(B)&&(B=me?0:X.length-1),B<0&&(B=X.length+B),B>=X.length){if(me)return-1;B=X.length-1}else if(B<0)if(me)B=0;else return-1;if(typeof D=="string"&&(D=c.from(D,te)),c.isBuffer(D))return D.length===0?-1:M(X,D,B,te,me);if(typeof D=="number")return D=D&255,typeof Uint8Array.prototype.indexOf=="function"?me?Uint8Array.prototype.indexOf.call(X,D,B):Uint8Array.prototype.lastIndexOf.call(X,D,B):M(X,[D],B,te,me);throw new TypeError("val must be string, number or Buffer")}function M(X,D,B,te,me){let De=1,Ge=X.length,Lt=D.length;if(te!==void 0&&(te=String(te).toLowerCase(),te==="ucs2"||te==="ucs-2"||te==="utf16le"||te==="utf-16le")){if(X.length<2||D.length<2)return-1;De=2,Ge/=2,Lt/=2,B/=2}function gn(wn,hn){return De===1?wn[hn]:wn.readUInt16BE(hn*De)}let mn;if(me){let wn=-1;for(mn=B;mn<Ge;mn++)if(gn(X,mn)===gn(D,wn===-1?0:mn-wn)){if(wn===-1&&(wn=mn),mn-wn+1===Lt)return wn*De}else wn!==-1&&(mn-=mn-wn),wn=-1}else for(B+Lt>Ge&&(B=Ge-Lt),mn=B;mn>=0;mn--){let wn=!0;for(let hn=0;hn<Lt;hn++)if(gn(X,mn+hn)!==gn(D,hn)){wn=!1;break}if(wn)return mn}return-1}c.prototype.includes=function(D,B,te){return this.indexOf(D,B,te)!==-1},c.prototype.indexOf=function(D,B,te){return V(this,D,B,te,!0)},c.prototype.lastIndexOf=function(D,B,te){return V(this,D,B,te,!1)};function j(X,D,B,te){B=Number(B)||0;const me=X.length-B;te?(te=Number(te),te>me&&(te=me)):te=me;const De=D.length;te>De/2&&(te=De/2);let Ge;for(Ge=0;Ge<te;++Ge){const Lt=parseInt(D.substr(Ge*2,2),16);if(le(Lt))return Ge;X[B+Ge]=Lt}return Ge}function J(X,D,B,te){return an(zt(D,X.length-B),X,B,te)}function L(X,D,B,te){return an(jt(D),X,B,te)}function z(X,D,B,te){return an(Xt(D),X,B,te)}function Y(X,D,B,te){return an(_t(D,X.length-B),X,B,te)}c.prototype.write=function(D,B,te,me){if(B===void 0)me="utf8",te=this.length,B=0;else if(te===void 0&&typeof B=="string")me=B,te=this.length,B=0;else if(isFinite(B))B=B>>>0,isFinite(te)?(te=te>>>0,me===void 0&&(me="utf8")):(me=te,te=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const De=this.length-B;if((te===void 0||te>De)&&(te=De),D.length>0&&(te<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");me||(me="utf8");let Ge=!1;for(;;)switch(me){case"hex":return j(this,D,B,te);case"utf8":case"utf-8":return J(this,D,B,te);case"ascii":case"latin1":case"binary":return L(this,D,B,te);case"base64":return z(this,D,B,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,D,B,te);default:if(Ge)throw new TypeError("Unknown encoding: "+me);me=(""+me).toLowerCase(),Ge=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ie(X,D,B){return D===0&&B===X.length?e.fromByteArray(X):e.fromByteArray(X.slice(D,B))}function pe(X,D,B){B=Math.min(X.length,B);const te=[];let me=D;for(;me<B;){const De=X[me];let Ge=null,Lt=De>239?4:De>223?3:De>191?2:1;if(me+Lt<=B){let gn,mn,wn,hn;switch(Lt){case 1:De<128&&(Ge=De);break;case 2:gn=X[me+1],(gn&192)===128&&(hn=(De&31)<<6|gn&63,hn>127&&(Ge=hn));break;case 3:gn=X[me+1],mn=X[me+2],(gn&192)===128&&(mn&192)===128&&(hn=(De&15)<<12|(gn&63)<<6|mn&63,hn>2047&&(hn<55296||hn>57343)&&(Ge=hn));break;case 4:gn=X[me+1],mn=X[me+2],wn=X[me+3],(gn&192)===128&&(mn&192)===128&&(wn&192)===128&&(hn=(De&15)<<18|(gn&63)<<12|(mn&63)<<6|wn&63,hn>65535&&hn<1114112&&(Ge=hn))}}Ge===null?(Ge=65533,Lt=1):Ge>65535&&(Ge-=65536,te.push(Ge>>>10&1023|55296),Ge=56320|Ge&1023),te.push(Ge),me+=Lt}return Ae(te)}const xe=4096;function Ae(X){const D=X.length;if(D<=xe)return String.fromCharCode.apply(String,X);let B="",te=0;for(;te<D;)B+=String.fromCharCode.apply(String,X.slice(te,te+=xe));return B}function Le(X,D,B){let te="";B=Math.min(X.length,B);for(let me=D;me<B;++me)te+=String.fromCharCode(X[me]&127);return te}function we(X,D,B){let te="";B=Math.min(X.length,B);for(let me=D;me<B;++me)te+=String.fromCharCode(X[me]);return te}function Se(X,D,B){const te=X.length;(!D||D<0)&&(D=0),(!B||B<0||B>te)&&(B=te);let me="";for(let De=D;De<B;++De)me+=nn[X[De]];return me}function Ee(X,D,B){const te=X.slice(D,B);let me="";for(let De=0;De<te.length-1;De+=2)me+=String.fromCharCode(te[De]+te[De+1]*256);return me}c.prototype.slice=function(D,B){const te=this.length;D=~~D,B=B===void 0?te:~~B,D<0?(D+=te,D<0&&(D=0)):D>te&&(D=te),B<0?(B+=te,B<0&&(B=0)):B>te&&(B=te),B<D&&(B=D);const me=this.subarray(D,B);return Object.setPrototypeOf(me,c.prototype),me};function H(X,D,B){if(X%1!==0||X<0)throw new RangeError("offset is not uint");if(X+D>B)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(D,B,te){D=D>>>0,B=B>>>0,te||H(D,B,this.length);let me=this[D],De=1,Ge=0;for(;++Ge<B&&(De*=256);)me+=this[D+Ge]*De;return me},c.prototype.readUintBE=c.prototype.readUIntBE=function(D,B,te){D=D>>>0,B=B>>>0,te||H(D,B,this.length);let me=this[D+--B],De=1;for(;B>0&&(De*=256);)me+=this[D+--B]*De;return me},c.prototype.readUint8=c.prototype.readUInt8=function(D,B){return D=D>>>0,B||H(D,1,this.length),this[D]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(D,B){return D=D>>>0,B||H(D,2,this.length),this[D]|this[D+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(D,B){return D=D>>>0,B||H(D,2,this.length),this[D]<<8|this[D+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(D,B){return D=D>>>0,B||H(D,4,this.length),(this[D]|this[D+1]<<8|this[D+2]<<16)+this[D+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(D,B){return D=D>>>0,B||H(D,4,this.length),this[D]*16777216+(this[D+1]<<16|this[D+2]<<8|this[D+3])},c.prototype.readBigUInt64LE=vn(function(D){D=D>>>0,bt(D,"offset");const B=this[D],te=this[D+7];(B===void 0||te===void 0)&&Rt(D,this.length-8);const me=B+this[++D]*2**8+this[++D]*2**16+this[++D]*2**24,De=this[++D]+this[++D]*2**8+this[++D]*2**16+te*2**24;return BigInt(me)+(BigInt(De)<<BigInt(32))}),c.prototype.readBigUInt64BE=vn(function(D){D=D>>>0,bt(D,"offset");const B=this[D],te=this[D+7];(B===void 0||te===void 0)&&Rt(D,this.length-8);const me=B*2**24+this[++D]*2**16+this[++D]*2**8+this[++D],De=this[++D]*2**24+this[++D]*2**16+this[++D]*2**8+te;return(BigInt(me)<<BigInt(32))+BigInt(De)}),c.prototype.readIntLE=function(D,B,te){D=D>>>0,B=B>>>0,te||H(D,B,this.length);let me=this[D],De=1,Ge=0;for(;++Ge<B&&(De*=256);)me+=this[D+Ge]*De;return De*=128,me>=De&&(me-=Math.pow(2,8*B)),me},c.prototype.readIntBE=function(D,B,te){D=D>>>0,B=B>>>0,te||H(D,B,this.length);let me=B,De=1,Ge=this[D+--me];for(;me>0&&(De*=256);)Ge+=this[D+--me]*De;return De*=128,Ge>=De&&(Ge-=Math.pow(2,8*B)),Ge},c.prototype.readInt8=function(D,B){return D=D>>>0,B||H(D,1,this.length),this[D]&128?(255-this[D]+1)*-1:this[D]},c.prototype.readInt16LE=function(D,B){D=D>>>0,B||H(D,2,this.length);const te=this[D]|this[D+1]<<8;return te&32768?te|4294901760:te},c.prototype.readInt16BE=function(D,B){D=D>>>0,B||H(D,2,this.length);const te=this[D+1]|this[D]<<8;return te&32768?te|4294901760:te},c.prototype.readInt32LE=function(D,B){return D=D>>>0,B||H(D,4,this.length),this[D]|this[D+1]<<8|this[D+2]<<16|this[D+3]<<24},c.prototype.readInt32BE=function(D,B){return D=D>>>0,B||H(D,4,this.length),this[D]<<24|this[D+1]<<16|this[D+2]<<8|this[D+3]},c.prototype.readBigInt64LE=vn(function(D){D=D>>>0,bt(D,"offset");const B=this[D],te=this[D+7];(B===void 0||te===void 0)&&Rt(D,this.length-8);const me=this[D+4]+this[D+5]*2**8+this[D+6]*2**16+(te<<24);return(BigInt(me)<<BigInt(32))+BigInt(B+this[++D]*2**8+this[++D]*2**16+this[++D]*2**24)}),c.prototype.readBigInt64BE=vn(function(D){D=D>>>0,bt(D,"offset");const B=this[D],te=this[D+7];(B===void 0||te===void 0)&&Rt(D,this.length-8);const me=(B<<24)+this[++D]*2**16+this[++D]*2**8+this[++D];return(BigInt(me)<<BigInt(32))+BigInt(this[++D]*2**24+this[++D]*2**16+this[++D]*2**8+te)}),c.prototype.readFloatLE=function(D,B){return D=D>>>0,B||H(D,4,this.length),t.read(this,D,!0,23,4)},c.prototype.readFloatBE=function(D,B){return D=D>>>0,B||H(D,4,this.length),t.read(this,D,!1,23,4)},c.prototype.readDoubleLE=function(D,B){return D=D>>>0,B||H(D,8,this.length),t.read(this,D,!0,52,8)},c.prototype.readDoubleBE=function(D,B){return D=D>>>0,B||H(D,8,this.length),t.read(this,D,!1,52,8)};function ee(X,D,B,te,me,De){if(!c.isBuffer(X))throw new TypeError('"buffer" argument must be a Buffer instance');if(D>me||D<De)throw new RangeError('"value" argument is out of bounds');if(B+te>X.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(D,B,te,me){if(D=+D,B=B>>>0,te=te>>>0,!me){const Lt=Math.pow(2,8*te)-1;ee(this,D,B,te,Lt,0)}let De=1,Ge=0;for(this[B]=D&255;++Ge<te&&(De*=256);)this[B+Ge]=D/De&255;return B+te},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(D,B,te,me){if(D=+D,B=B>>>0,te=te>>>0,!me){const Lt=Math.pow(2,8*te)-1;ee(this,D,B,te,Lt,0)}let De=te-1,Ge=1;for(this[B+De]=D&255;--De>=0&&(Ge*=256);)this[B+De]=D/Ge&255;return B+te},c.prototype.writeUint8=c.prototype.writeUInt8=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,1,255,0),this[B]=D&255,B+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,2,65535,0),this[B]=D&255,this[B+1]=D>>>8,B+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,2,65535,0),this[B]=D>>>8,this[B+1]=D&255,B+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,4,4294967295,0),this[B+3]=D>>>24,this[B+2]=D>>>16,this[B+1]=D>>>8,this[B]=D&255,B+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,4,4294967295,0),this[B]=D>>>24,this[B+1]=D>>>16,this[B+2]=D>>>8,this[B+3]=D&255,B+4};function ce(X,D,B,te,me){Nt(D,te,me,X,B,7);let De=Number(D&BigInt(4294967295));X[B++]=De,De=De>>8,X[B++]=De,De=De>>8,X[B++]=De,De=De>>8,X[B++]=De;let Ge=Number(D>>BigInt(32)&BigInt(4294967295));return X[B++]=Ge,Ge=Ge>>8,X[B++]=Ge,Ge=Ge>>8,X[B++]=Ge,Ge=Ge>>8,X[B++]=Ge,B}function Ce(X,D,B,te,me){Nt(D,te,me,X,B,7);let De=Number(D&BigInt(4294967295));X[B+7]=De,De=De>>8,X[B+6]=De,De=De>>8,X[B+5]=De,De=De>>8,X[B+4]=De;let Ge=Number(D>>BigInt(32)&BigInt(4294967295));return X[B+3]=Ge,Ge=Ge>>8,X[B+2]=Ge,Ge=Ge>>8,X[B+1]=Ge,Ge=Ge>>8,X[B]=Ge,B+8}c.prototype.writeBigUInt64LE=vn(function(D,B=0){return ce(this,D,B,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=vn(function(D,B=0){return Ce(this,D,B,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(D,B,te,me){if(D=+D,B=B>>>0,!me){const gn=Math.pow(2,8*te-1);ee(this,D,B,te,gn-1,-gn)}let De=0,Ge=1,Lt=0;for(this[B]=D&255;++De<te&&(Ge*=256);)D<0&&Lt===0&&this[B+De-1]!==0&&(Lt=1),this[B+De]=(D/Ge>>0)-Lt&255;return B+te},c.prototype.writeIntBE=function(D,B,te,me){if(D=+D,B=B>>>0,!me){const gn=Math.pow(2,8*te-1);ee(this,D,B,te,gn-1,-gn)}let De=te-1,Ge=1,Lt=0;for(this[B+De]=D&255;--De>=0&&(Ge*=256);)D<0&&Lt===0&&this[B+De+1]!==0&&(Lt=1),this[B+De]=(D/Ge>>0)-Lt&255;return B+te},c.prototype.writeInt8=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,1,127,-128),D<0&&(D=255+D+1),this[B]=D&255,B+1},c.prototype.writeInt16LE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,2,32767,-32768),this[B]=D&255,this[B+1]=D>>>8,B+2},c.prototype.writeInt16BE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,2,32767,-32768),this[B]=D>>>8,this[B+1]=D&255,B+2},c.prototype.writeInt32LE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,4,2147483647,-2147483648),this[B]=D&255,this[B+1]=D>>>8,this[B+2]=D>>>16,this[B+3]=D>>>24,B+4},c.prototype.writeInt32BE=function(D,B,te){return D=+D,B=B>>>0,te||ee(this,D,B,4,2147483647,-2147483648),D<0&&(D=4294967295+D+1),this[B]=D>>>24,this[B+1]=D>>>16,this[B+2]=D>>>8,this[B+3]=D&255,B+4},c.prototype.writeBigInt64LE=vn(function(D,B=0){return ce(this,D,B,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=vn(function(D,B=0){return Ce(this,D,B,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function _e(X,D,B,te,me,De){if(B+te>X.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function Ne(X,D,B,te,me){return D=+D,B=B>>>0,me||_e(X,D,B,4),t.write(X,D,B,te,23,4),B+4}c.prototype.writeFloatLE=function(D,B,te){return Ne(this,D,B,!0,te)},c.prototype.writeFloatBE=function(D,B,te){return Ne(this,D,B,!1,te)};function ft(X,D,B,te,me){return D=+D,B=B>>>0,me||_e(X,D,B,8),t.write(X,D,B,te,52,8),B+8}c.prototype.writeDoubleLE=function(D,B,te){return ft(this,D,B,!0,te)},c.prototype.writeDoubleBE=function(D,B,te){return ft(this,D,B,!1,te)},c.prototype.copy=function(D,B,te,me){if(!c.isBuffer(D))throw new TypeError("argument should be a Buffer");if(te||(te=0),!me&&me!==0&&(me=this.length),B>=D.length&&(B=D.length),B||(B=0),me>0&&me<te&&(me=te),me===te||D.length===0||this.length===0)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(te<0||te>=this.length)throw new RangeError("Index out of range");if(me<0)throw new RangeError("sourceEnd out of bounds");me>this.length&&(me=this.length),D.length-B<me-te&&(me=D.length-B+te);const De=me-te;return this===D&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(B,te,me):Uint8Array.prototype.set.call(D,this.subarray(te,me),B),De},c.prototype.fill=function(D,B,te,me){if(typeof D=="string"){if(typeof B=="string"?(me=B,B=0,te=this.length):typeof te=="string"&&(me=te,te=this.length),me!==void 0&&typeof me!="string")throw new TypeError("encoding must be a string");if(typeof me=="string"&&!c.isEncoding(me))throw new TypeError("Unknown encoding: "+me);if(D.length===1){const Ge=D.charCodeAt(0);(me==="utf8"&&Ge<128||me==="latin1")&&(D=Ge)}}else typeof D=="number"?D=D&255:typeof D=="boolean"&&(D=Number(D));if(B<0||this.length<B||this.length<te)throw new RangeError("Out of range index");if(te<=B)return this;B=B>>>0,te=te===void 0?this.length:te>>>0,D||(D=0);let De;if(typeof D=="number")for(De=B;De<te;++De)this[De]=D;else{const Ge=c.isBuffer(D)?D:c.from(D,me),Lt=Ge.length;if(Lt===0)throw new TypeError('The value "'+D+'" is invalid for argument "value"');for(De=0;De<te-B;++De)this[De+B]=Ge[De%Lt]}return this};const ve={};function ct(X,D,B){ve[X]=class extends B{constructor(){super(),Object.defineProperty(this,"message",{value:D.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${X}]`,this.stack,delete this.name}get code(){return X}set code(me){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:me,writable:!0})}toString(){return`${this.name} [${X}]: ${this.message}`}}}ct("ERR_BUFFER_OUT_OF_BOUNDS",function(X){return X?`${X} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ct("ERR_INVALID_ARG_TYPE",function(X,D){return`The "${X}" argument must be of type number. Received type ${typeof D}`},TypeError),ct("ERR_OUT_OF_RANGE",function(X,D,B){let te=`The value of "${X}" is out of range.`,me=B;return Number.isInteger(B)&&Math.abs(B)>2**32?me=At(String(B)):typeof B=="bigint"&&(me=String(B),(B>BigInt(2)**BigInt(32)||B<-(BigInt(2)**BigInt(32)))&&(me=At(me)),me+="n"),te+=` It must be ${D}. Received ${me}`,te},RangeError);function At(X){let D="",B=X.length;const te=X[0]==="-"?1:0;for(;B>=te+4;B-=3)D=`_${X.slice(B-3,B)}${D}`;return`${X.slice(0,B)}${D}`}function Wt(X,D,B){bt(D,"offset"),(X[D]===void 0||X[D+B]===void 0)&&Rt(D,X.length-(B+1))}function Nt(X,D,B,te,me,De){if(X>B||X<D){const Ge=typeof D=="bigint"?"n":"";let Lt;throw D===0||D===BigInt(0)?Lt=`>= 0${Ge} and < 2${Ge} ** ${(De+1)*8}${Ge}`:Lt=`>= -(2${Ge} ** ${(De+1)*8-1}${Ge}) and < 2 ** ${(De+1)*8-1}${Ge}`,new ve.ERR_OUT_OF_RANGE("value",Lt,X)}Wt(te,me,De)}function bt(X,D){if(typeof X!="number")throw new ve.ERR_INVALID_ARG_TYPE(D,"number",X)}function Rt(X,D,B){throw Math.floor(X)!==X?(bt(X,B),new ve.ERR_OUT_OF_RANGE("offset","an integer",X)):D<0?new ve.ERR_BUFFER_OUT_OF_BOUNDS:new ve.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${D}`,X)}const st=/[^+/0-9A-Za-z-_]/g;function at(X){if(X=X.split("=")[0],X=X.trim().replace(st,""),X.length<2)return"";for(;X.length%4!==0;)X=X+"=";return X}function zt(X,D){D=D||1/0;let B;const te=X.length;let me=null;const De=[];for(let Ge=0;Ge<te;++Ge){if(B=X.charCodeAt(Ge),B>55295&&B<57344){if(!me){if(B>56319){(D-=3)>-1&&De.push(239,191,189);continue}else if(Ge+1===te){(D-=3)>-1&&De.push(239,191,189);continue}me=B;continue}if(B<56320){(D-=3)>-1&&De.push(239,191,189),me=B;continue}B=(me-55296<<10|B-56320)+65536}else me&&(D-=3)>-1&&De.push(239,191,189);if(me=null,B<128){if((D-=1)<0)break;De.push(B)}else if(B<2048){if((D-=2)<0)break;De.push(B>>6|192,B&63|128)}else if(B<65536){if((D-=3)<0)break;De.push(B>>12|224,B>>6&63|128,B&63|128)}else if(B<1114112){if((D-=4)<0)break;De.push(B>>18|240,B>>12&63|128,B>>6&63|128,B&63|128)}else throw new Error("Invalid code point")}return De}function jt(X){const D=[];for(let B=0;B<X.length;++B)D.push(X.charCodeAt(B)&255);return D}function _t(X,D){let B,te,me;const De=[];for(let Ge=0;Ge<X.length&&!((D-=2)<0);++Ge)B=X.charCodeAt(Ge),te=B>>8,me=B%256,De.push(me),De.push(te);return De}function Xt(X){return e.toByteArray(at(X))}function an(X,D,B,te){let me;for(me=0;me<te&&!(me+B>=D.length||me>=X.length);++me)D[me+B]=X[me];return me}function ot(X,D){return X instanceof D||X!=null&&X.constructor!=null&&X.constructor.name!=null&&X.constructor.name===D.name}function le(X){return X!==X}const nn=function(){const X="0123456789abcdef",D=new Array(256);for(let B=0;B<16;++B){const te=B*16;for(let me=0;me<16;++me)D[te+me]=X[B]+X[me]}return D}();function vn(X){return typeof BigInt>"u"?Ln:X}function Ln(){throw new Error("BigInt not supported")}}(uv)),uv}var Di=uD(),Ef=(n=>(n[n.BINARY=0]="BINARY",n[n.ECHO=1]="ECHO",n[n.RCP=2]="RCP",n[n.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",n[n.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",n[n.STATUS=5]="STATUS",n[n.TIMING_MARK=6]="TIMING_MARK",n[n.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",n[n.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",n[n.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",n[n.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",n[n.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",n[n.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",n[n.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",n[n.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",n[n.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",n[n.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",n[n.EXTENDED_ASCII=17]="EXTENDED_ASCII",n[n.LOGOUT=18]="LOGOUT",n[n.BYTE_MACRO=19]="BYTE_MACRO",n[n.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",n[n.SUPDUP=21]="SUPDUP",n[n.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",n[n.SEND_LOCATION=23]="SEND_LOCATION",n[n.TERMINAL_TYPE=24]="TERMINAL_TYPE",n[n.END_OF_RECORD=25]="END_OF_RECORD",n[n.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",n[n.OUTPUT_MARKING=27]="OUTPUT_MARKING",n[n.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",n[n.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",n[n.X_3_PAD=30]="X_3_PAD",n[n.NAWS=31]="NAWS",n[n.TERMINAL_SPEED=32]="TERMINAL_SPEED",n[n.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",n[n.LINEMODE=34]="LINEMODE",n[n.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",n[n.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",n[n.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",n[n.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",n[n.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",n[n.TN3270E=40]="TN3270E",n[n.XAUTH=41]="XAUTH",n[n.CHARSET=42]="CHARSET",n[n.RSP=43]="RSP",n[n.COM_PORT_OPTION=44]="COM_PORT_OPTION",n[n.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",n[n.START_TLS=46]="START_TLS",n[n.KERMIT=47]="KERMIT",n[n.SEND_URL=48]="SEND_URL",n[n.FORWARD_X=49]="FORWARD_X",n[n.PRAGMA_LOGON=138]="PRAGMA_LOGON",n[n.GMCP=201]="GMCP",n))(Ef||{}),Tf=(n=>(n[n.SE=240]="SE",n[n.NOP=241]="NOP",n[n.DM=242]="DM",n[n.BRK=243]="BRK",n[n.IP=244]="IP",n[n.AO=245]="AO",n[n.AYT=246]="AYT",n[n.EC=247]="EC",n[n.EL=248]="EL",n[n.GA=249]="GA",n[n.SB=250]="SB",n[n.WILL=251]="WILL",n[n.WONT=252]="WONT",n[n.DO=253]="DO",n[n.DONT=254]="DONT",n[n.IAC=255]="IAC",n))(Tf||{});class dD{constructor(e){ae(this,"ws");this.ws=e}on(e,t){if(e==="data"){this.ws.onmessage=i=>{t(i.data)};return}const r="on"+e;this[r]=t}write(e){this.ws.send(e)}}class fD extends hg{constructor(t){super();ae(this,"state");ae(this,"buffer");ae(this,"subBuffer");ae(this,"iacSEBuffer",Di.Buffer.from([255,240]));ae(this,"negotiationByte",0);ae(this,"stream");this.state=0,this.buffer=Di.Buffer.alloc(0),this.subBuffer=Di.Buffer.alloc(0),t&&t.on("data",r=>this.parse(r)),this.stream=t}parse(t){for(this.buffer=Di.Buffer.concat([this.buffer,Di.Buffer.from(t)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const t=this.buffer.indexOf(255);if(t===-1){this.emit("data",this.buffer),this.buffer=Di.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,t)),this.buffer=this.buffer.slice(t),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const t=this.buffer[1];switch(this.buffer=this.buffer.slice(2),t){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=Di.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=t,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const t=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",t,r),this.state=0,!1}handleSubnegotiation(){let t=this.buffer.indexOf(this.iacSEBuffer);if(t===-1)return!0;this.state=0;let r=this.buffer.slice(0,t);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(t+2),!1}handleGmcp(t){const r=t.toString(),[i,s]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,s)}sendNegotiation(t,r){this.stream.write(Di.Buffer.from([255,t,r]))}sendGmcp(t,r){const i=t+" "+r,s=Di.Buffer.from(i),a=Di.Buffer.concat([Di.Buffer.from([255,250]),Di.Buffer.from([201]),s,this.iacSEBuffer]);this.stream.write(a)}sendTerminalType(t){const r=Di.Buffer.from(t),i=Di.Buffer.concat([Di.Buffer.from([255,250]),Di.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function hD({onlyFirst:n=!1}={}){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(t,n?void 0:"g")}const pD=hD();function gD(n){if(typeof n!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof n}\``);return n.replace(pD,"")}class mD{constructor(e){ae(this,"editors");ae(this,"channel");this.client=e,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(e){console.log("Opening editor window for session:",e);const t=e.reference,r=this.editors.get(t);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(t),s=window.open(`/editor?reference=${i}`,"_blank"),a={...e,window:s,state:0};this.editors.set(t,a),s&&s.focus()}}saveEditorWindow(e){const t={reference:e.reference,type:e.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",t,e.contents)}setupChannelListeners(){this.channel.onmessage=e=>{console.log("Editor window message:",e);const{type:t,id:r,session:i}=e.data;switch(t){case"ready":console.log("Editor window ready, id:",r);const s=this.editors.get(r);if(s){s.state=1;const{window:c,...d}=s;this.channel.postMessage({type:"load",session:d})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const a=this.editors.get(r);a&&(a.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((e,t)=>{try{e.state===1&&e.window&&(console.log(`Closing editor window for ${t}`),e.window.close(),this.channel.postMessage({type:"shutdown",id:t}))}catch(r){console.error(`Error closing editor window ${t}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class tr{constructor(e){ae(this,"packageName");ae(this,"packageVersion",1);ae(this,"client");this.client=e}get enabled(){return!0}sendData(e,t){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(t))}shutdown(){}}class vD extends tr{constructor(){super(...arguments);ae(this,"packageName","Auth.Autologin")}handleToken(t){localStorage.setItem("LoginRefreshToken",t)}sendLogin(){var t=localStorage.getItem("LoginRefreshToken");t&&this.sendData("Login",t)}}class BA extends tr{constructor(){super(...arguments);ae(this,"packageName","Char")}handleName(t){this.client.worldData.playerId=t.name,this.client.worldData.playerName=t.fullname,this.client.emit("statustext",`Logged in as ${t.fullname}`)}handleVitals(t){console.log("Received Char.Vitals:",t),this.client.emit("vitals",t)}handleStatusVars(t){console.log("Received Char.StatusVars:",t),this.client.emit("statusVars",t)}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("statusUpdate",t)}sendLogin(t,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:t,password:r}))}}class yD extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Offer")}handleOffer(t){console.log("Received Char.Offer:",t),this.client.emit("offer",t)}sendOfferRequest(){this.sendData("Offer",{})}}class CD extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Prompt")}handlePrompt(t){console.log("Received Char.Prompt:",t),this.client.emit("prompt",t)}sendPromptRequest(){this.sendData("Prompt",{})}}class xD extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Status")}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("status",t)}sendStatusRequest(){this.sendData("Status",{})}}class wD extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Status.AffectedBy")}handleAffectedBy(t){console.log("Received Char.Status.AffectedBy:",t),this.client.emit("statusAffectedBy",t)}sendAffectedByRequest(){this.sendData("AffectedBy",{})}}class ID extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Status.Conditions")}handleConditions(t){console.log("Received Char.Status.Conditions:",t),this.client.emit("statusConditions",t)}sendConditionsRequest(){this.sendData("Conditions",{})}}class bD extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Status.Timers")}handleTimers(t){console.log("Received Char.Status.Timers:",t),this.client.emit("statusTimers",t)}sendTimersRequest(){this.sendData("Timers",{})}}class OA extends tr{constructor(){super(...arguments);ae(this,"packageName","Client.FileTransfer")}sendCandidate(t,r){this.sendData("Candidate",{recipient:t,candidate:JSON.stringify(r)})}handleCandidate(t){const r=JSON.parse(t.candidate);this.client.webRTCService.handleIceCandidate(r)}handleOffer(t){console.log("[GMCPClientFileTransfer] Received offer:",t),this.client.fileTransferManager.pendingOffers.set(`${t.hash}`,t),this.client.onFileTransferOffer(t.sender,t.hash,t.filename,t.filesize,t.offerSdp)}handleAccept(t){this.client.onFileTransferAccept(t.sender,t.hash,t.filename,t.answerSdp)}handleReject(t){this.client.onFileTransferReject(t.sender,t.hash)}handleCancel(t){this.client.onFileTransferCancel(t.sender,t.hash)}sendOffer(t,r,i,s,a){this.sendData("Offer",{recipient:t,filename:r,filesize:i,offerSdp:s,hash:a})}sendAccept(t,r,i,s){this.sendData("Accept",{sender:t,hash:r,filename:i,answerSdp:s})}sendReject(t,r){this.sendData("Reject",{sender:t,hash:r})}sendCancel(t,r){this.sendData("Cancel",{recipient:t,hash:r})}sendRequestResend(t,r){this.sendData("RequestResend",{sender:t,hash:r})}}function yC(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var pu=yC();function FA(n){pu=n}var Mf={exec:()=>null};function Gn(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(i,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(Zi.caret,"$1"),t=t.replace(i,a),r},getRegex:()=>new RegExp(t,e)};return r}var Zi={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},SD=/^(?:[ \t]*(?:\n|$))+/,AD=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,kD=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,lh=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,ED=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,CC=/(?:[*+-]|\d{1,9}[.)])/,LA=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,UA=Gn(LA).replace(/bull/g,CC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),TD=Gn(LA).replace(/bull/g,CC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),xC=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,_D=/^[^\n]+/,wC=/(?!\s*\])(?:\\.|[^\[\]\\])+/,RD=Gn(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",wC).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),DD=Gn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,CC).getRegex(),pg="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",IC=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,PD=Gn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",IC).replace("tag",pg).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),GA=Gn(xC).replace("hr",lh).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pg).getRegex(),ND=Gn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",GA).getRegex(),bC={blockquote:ND,code:AD,def:RD,fences:kD,heading:ED,hr:lh,html:PD,lheading:UA,list:DD,newline:SD,paragraph:GA,table:Mf,text:_D},lI=Gn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",lh).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pg).getRegex(),MD={...bC,lheading:TD,table:lI,paragraph:Gn(xC).replace("hr",lh).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",lI).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pg).getRegex()},BD={...bC,html:Gn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",IC).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Mf,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Gn(xC).replace("hr",lh).replace("heading",` *#{1,6} *[^
]`).replace("lheading",UA).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},OD=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,FD=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,VA=/^( {2,}|\\)\n(?!\s*$)/,LD=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,gg=/[\p{P}\p{S}]/u,SC=/[\s\p{P}\p{S}]/u,jA=/[^\s\p{P}\p{S}]/u,UD=Gn(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,SC).getRegex(),WA=/(?!~)[\p{P}\p{S}]/u,GD=/(?!~)[\s\p{P}\p{S}]/u,VD=/(?:[^\s\p{P}\p{S}]|~)/u,jD=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,zA=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,WD=Gn(zA,"u").replace(/punct/g,gg).getRegex(),zD=Gn(zA,"u").replace(/punct/g,WA).getRegex(),HA="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",HD=Gn(HA,"gu").replace(/notPunctSpace/g,jA).replace(/punctSpace/g,SC).replace(/punct/g,gg).getRegex(),ZD=Gn(HA,"gu").replace(/notPunctSpace/g,VD).replace(/punctSpace/g,GD).replace(/punct/g,WA).getRegex(),XD=Gn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,jA).replace(/punctSpace/g,SC).replace(/punct/g,gg).getRegex(),$D=Gn(/\\(punct)/,"gu").replace(/punct/g,gg).getRegex(),KD=Gn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),qD=Gn(IC).replace("(?:-->|$)","-->").getRegex(),JD=Gn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",qD).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Fp=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,YD=Gn(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Fp).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ZA=Gn(/^!?\[(label)\]\[(ref)\]/).replace("label",Fp).replace("ref",wC).getRegex(),XA=Gn(/^!?\[(ref)\](?:\[\])?/).replace("ref",wC).getRegex(),QD=Gn("reflink|nolink(?!\\()","g").replace("reflink",ZA).replace("nolink",XA).getRegex(),AC={_backpedal:Mf,anyPunctuation:$D,autolink:KD,blockSkip:jD,br:VA,code:FD,del:Mf,emStrongLDelim:WD,emStrongRDelimAst:HD,emStrongRDelimUnd:XD,escape:OD,link:YD,nolink:XA,punctuation:UD,reflink:ZA,reflinkSearch:QD,tag:JD,text:LD,url:Mf},eP={...AC,link:Gn(/^!?\[(label)\]\((.*?)\)/).replace("label",Fp).getRegex(),reflink:Gn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Fp).getRegex()},Yv={...AC,emStrongRDelimAst:ZD,emStrongLDelim:zD,url:Gn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},tP={...Yv,br:Gn(VA).replace("{2,}","*").getRegex(),text:Gn(Yv.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},v0={normal:bC,gfm:MD,pedantic:BD},ff={normal:AC,gfm:Yv,breaks:tP,pedantic:eP},nP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},uI=n=>nP[n];function Qo(n,e){if(e){if(Zi.escapeTest.test(n))return n.replace(Zi.escapeReplace,uI)}else if(Zi.escapeTestNoEncode.test(n))return n.replace(Zi.escapeReplaceNoEncode,uI);return n}function dI(n){try{n=encodeURI(n).replace(Zi.percentDecode,"%")}catch{return null}return n}function fI(n,e){var s;const t=n.replace(Zi.findPipe,(a,c,d)=>{let f=!1,h=c;for(;--h>=0&&d[h]==="\\";)f=!f;return f?"|":" |"}),r=t.split(Zi.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((s=r.at(-1))!=null&&s.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Zi.slashPipe,"|");return r}function hf(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function rP(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function hI(n,e,t,r,i){const s=e.href,a=e.title||null,c=n[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const d={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:s,title:a,text:c,tokens:r.inlineTokens(c)};return r.state.inLink=!1,d}function iP(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(s=>{const a=s.match(t.other.beginningSpace);if(a===null)return s;const[c]=a;return c.length>=i.length?s.slice(i.length):s}).join(`
`)}var Lp=class{constructor(n){ae(this,"options");ae(this,"rules");ae(this,"lexer");this.options=n||pu}space(n){const e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){const e=this.rules.block.code.exec(n);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:hf(t,`
`)}}}fences(n){const e=this.rules.block.fences.exec(n);if(e){const t=e[0],r=iP(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(n){const e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const r=hf(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){const e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:hf(e[0],`
`)}}blockquote(n){const e=this.rules.block.blockquote.exec(n);if(e){let t=hf(e[0],`
`).split(`
`),r="",i="";const s=[];for(;t.length>0;){let a=!1;const c=[];let d;for(d=0;d<t.length;d++)if(this.rules.other.blockquoteStart.test(t[d]))c.push(t[d]),a=!0;else if(!a)c.push(t[d]);else break;t=t.slice(d);const f=c.join(`
`),h=f.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${f}`:f,i=i?`${i}
${h}`:h;const v=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,s,!0),this.lexer.state.top=v,t.length===0)break;const m=s.at(-1);if((m==null?void 0:m.type)==="code")break;if((m==null?void 0:m.type)==="blockquote"){const y=m,C=y.raw+`
`+t.join(`
`),x=this.blockquote(C);s[s.length-1]=x,r=r.substring(0,r.length-y.raw.length)+x.raw,i=i.substring(0,i.length-y.text.length)+x.text;break}else if((m==null?void 0:m.type)==="list"){const y=m,C=y.raw+`
`+t.join(`
`),x=this.list(C);s[s.length-1]=x,r=r.substring(0,r.length-m.raw.length)+x.raw,i=i.substring(0,i.length-y.raw.length)+x.raw,t=C.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:i}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim();const r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");const s=this.rules.other.listItemRegex(t);let a=!1;for(;n;){let d=!1,f="",h="";if(!(e=s.exec(n))||this.rules.block.hr.test(n))break;f=e[0],n=n.substring(f.length);let v=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),m=n.split(`
`,1)[0],y=!v.trim(),C=0;if(this.options.pedantic?(C=2,h=v.trimStart()):y?C=e[1].length+1:(C=e[2].search(this.rules.other.nonSpaceChar),C=C>4?1:C,h=v.slice(C),C+=e[1].length),y&&this.rules.other.blankLine.test(m)&&(f+=m+`
`,n=n.substring(m.length+1),d=!0),!d){const S=this.rules.other.nextBulletRegex(C),A=this.rules.other.hrRegex(C),E=this.rules.other.fencesBeginRegex(C),R=this.rules.other.headingBeginRegex(C),N=this.rules.other.htmlBeginRegex(C);for(;n;){const V=n.split(`
`,1)[0];let M;if(m=V,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),M=m):M=m.replace(this.rules.other.tabCharGlobal,"    "),E.test(m)||R.test(m)||N.test(m)||S.test(m)||A.test(m))break;if(M.search(this.rules.other.nonSpaceChar)>=C||!m.trim())h+=`
`+M.slice(C);else{if(y||v.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(v)||R.test(v)||A.test(v))break;h+=`
`+m}!y&&!m.trim()&&(y=!0),f+=V+`
`,n=n.substring(V.length+1),v=M.slice(C)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(f)&&(a=!0));let x=null,b;this.options.gfm&&(x=this.rules.other.listIsTask.exec(h),x&&(b=x[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:f,task:!!x,checked:b,loose:!1,text:h,tokens:[]}),i.raw+=f}const c=i.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let d=0;d<i.items.length;d++)if(this.lexer.state.top=!1,i.items[d].tokens=this.lexer.blockTokens(i.items[d].text,[]),!i.loose){const f=i.items[d].tokens.filter(v=>v.type==="space"),h=f.length>0&&f.some(v=>this.rules.other.anyLine.test(v.raw));i.loose=h}if(i.loose)for(let d=0;d<i.items.length;d++)i.items[d].loose=!0;return i}}html(n){const e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){const e=this.rules.block.def.exec(n);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){var a;const e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=fI(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(const c of r)this.rules.other.tableAlignRight.test(c)?s.align.push("right"):this.rules.other.tableAlignCenter.test(c)?s.align.push("center"):this.rules.other.tableAlignLeft.test(c)?s.align.push("left"):s.align.push(null);for(let c=0;c<t.length;c++)s.header.push({text:t[c],tokens:this.lexer.inline(t[c]),header:!0,align:s.align[c]});for(const c of i)s.rows.push(fI(c,s.header.length).map((d,f)=>({text:d,tokens:this.lexer.inline(d),header:!1,align:s.align[f]})));return s}}lheading(n){const e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){const e=this.rules.block.paragraph.exec(n);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){const e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){const e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){const e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){const e=this.rules.inline.link.exec(n);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const s=hf(t.slice(0,-1),"\\");if((t.length-s.length)%2===0)return}else{const s=rP(e[2],"()");if(s===-2)return;if(s>-1){const c=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],i=s[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),hI(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){const r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[r.toLowerCase()];if(!i){const s=t[0].charAt(0);return{type:"text",raw:s,text:s}}return hI(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(n);if(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const s=[...r[0]].length-1;let a,c,d=s,f=0;const h=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*n.length+s);(r=h.exec(e))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(c=[...a].length,r[3]||r[4]){d+=c;continue}else if((r[5]||r[6])&&s%3&&!((s+c)%3)){f+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+f);const v=[...r[0]][0].length,m=n.slice(0,s+r.index+v+c);if(Math.min(s,c)%2){const C=m.slice(1,-1);return{type:"em",raw:m,text:C,tokens:this.lexer.inlineTokens(C)}}const y=m.slice(2,-2);return{type:"strong",raw:m,text:y,tokens:this.lexer.inlineTokens(y)}}}}codespan(n){const e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){const e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){const e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){const e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){var t;let e;if(e=this.rules.inline.url.exec(n)){let r,i;if(e[2]==="@")r=e[0],i="mailto:"+r;else{let s;do s=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(s!==e[0]);r=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(n){const e=this.rules.inline.text.exec(n);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},$a=class Qv{constructor(e){ae(this,"tokens");ae(this,"options");ae(this,"state");ae(this,"tokenizer");ae(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||pu,this.options.tokenizer=this.options.tokenizer||new Lp,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Zi,block:v0.normal,inline:ff.normal};this.options.pedantic?(t.block=v0.pedantic,t.inline=ff.pedantic):this.options.gfm&&(t.block=v0.gfm,this.options.breaks?t.inline=ff.breaks:t.inline=ff.gfm),this.tokenizer.rules=t}static get rules(){return{block:v0,inline:ff}}static lex(e,t){return new Qv(t).lex(e)}static lexInline(e,t){return new Qv(t).inlineTokens(e)}lex(e){e=e.replace(Zi.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){var i,s,a;for(this.options.pedantic&&(e=e.replace(Zi.tabCharGlobal,"    ").replace(Zi.spaceLine,""));e;){let c;if((s=(i=this.options.extensions)==null?void 0:i.block)!=null&&s.some(f=>(c=f.call({lexer:this},e,t))?(e=e.substring(c.raw.length),t.push(c),!0):!1))continue;if(c=this.tokenizer.space(e)){e=e.substring(c.raw.length);const f=t.at(-1);c.raw.length===1&&f!==void 0?f.raw+=`
`:t.push(c);continue}if(c=this.tokenizer.code(e)){e=e.substring(c.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+c.raw,f.text+=`
`+c.text,this.inlineQueue.at(-1).src=f.text):t.push(c);continue}if(c=this.tokenizer.fences(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.heading(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.hr(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.blockquote(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.list(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.html(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.def(e)){e=e.substring(c.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+c.raw,f.text+=`
`+c.raw,this.inlineQueue.at(-1).src=f.text):this.tokens.links[c.tag]||(this.tokens.links[c.tag]={href:c.href,title:c.title});continue}if(c=this.tokenizer.table(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.lheading(e)){e=e.substring(c.raw.length),t.push(c);continue}let d=e;if((a=this.options.extensions)!=null&&a.startBlock){let f=1/0;const h=e.slice(1);let v;this.options.extensions.startBlock.forEach(m=>{v=m.call({lexer:this},h),typeof v=="number"&&v>=0&&(f=Math.min(f,v))}),f<1/0&&f>=0&&(d=e.substring(0,f+1))}if(this.state.top&&(c=this.tokenizer.paragraph(d))){const f=t.at(-1);r&&(f==null?void 0:f.type)==="paragraph"?(f.raw+=`
`+c.raw,f.text+=`
`+c.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(c),r=d.length!==e.length,e=e.substring(c.raw.length);continue}if(c=this.tokenizer.text(e)){e=e.substring(c.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=`
`+c.raw,f.text+=`
`+c.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(c);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var c,d,f;let r=e,i=null;if(this.tokens.links){const h=Object.keys(this.tokens.links);if(h.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)h.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,a="";for(;e;){s||(a=""),s=!1;let h;if((d=(c=this.options.extensions)==null?void 0:c.inline)!=null&&d.some(m=>(h=m.call({lexer:this},e,t))?(e=e.substring(h.raw.length),t.push(h),!0):!1))continue;if(h=this.tokenizer.escape(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.tag(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.link(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(h.raw.length);const m=t.at(-1);h.type==="text"&&(m==null?void 0:m.type)==="text"?(m.raw+=h.raw,m.text+=h.text):t.push(h);continue}if(h=this.tokenizer.emStrong(e,r,a)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.codespan(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.br(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.del(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.autolink(e)){e=e.substring(h.raw.length),t.push(h);continue}if(!this.state.inLink&&(h=this.tokenizer.url(e))){e=e.substring(h.raw.length),t.push(h);continue}let v=e;if((f=this.options.extensions)!=null&&f.startInline){let m=1/0;const y=e.slice(1);let C;this.options.extensions.startInline.forEach(x=>{C=x.call({lexer:this},y),typeof C=="number"&&C>=0&&(m=Math.min(m,C))}),m<1/0&&m>=0&&(v=e.substring(0,m+1))}if(h=this.tokenizer.inlineText(v)){e=e.substring(h.raw.length),h.raw.slice(-1)!=="_"&&(a=h.raw.slice(-1)),s=!0;const m=t.at(-1);(m==null?void 0:m.type)==="text"?(m.raw+=h.raw,m.text+=h.text):t.push(h);continue}if(e){const m="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(m);break}else throw new Error(m)}}return t}},Up=class{constructor(n){ae(this,"options");ae(this,"parser");this.options=n||pu}space(n){return""}code({text:n,lang:e,escaped:t}){var s;const r=(s=(e||"").match(Zi.notSpaceStart))==null?void 0:s[0],i=n.replace(Zi.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Qo(r)+'">'+(t?i:Qo(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:Qo(i,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){const e=n.ordered,t=n.start;let r="";for(let a=0;a<n.items.length;a++){const c=n.items[a];r+=this.listitem(c)}const i=e?"ol":"ul",s=e&&t!==1?' start="'+t+'"':"";return"<"+i+s+`>
`+r+"</"+i+`>
`}listitem(n){var t;let e="";if(n.task){const r=this.checkbox({checked:!!n.checked});n.loose?((t=n.tokens[0])==null?void 0:t.type)==="paragraph"?(n.tokens[0].text=r+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&n.tokens[0].tokens[0].type==="text"&&(n.tokens[0].tokens[0].text=r+" "+Qo(n.tokens[0].tokens[0].text),n.tokens[0].tokens[0].escaped=!0)):n.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return e+=this.parser.parse(n.tokens,!!n.loose),`<li>${e}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let i=0;i<n.header.length;i++)t+=this.tablecell(n.header[i]);e+=this.tablerow({text:t});let r="";for(let i=0;i<n.rows.length;i++){const s=n.rows[i];t="";for(let a=0;a<s.length;a++)t+=this.tablecell(s[a]);r+=this.tablerow({text:t})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){const e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${Qo(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){const r=this.parser.parseInline(t),i=dI(n);if(i===null)return r;n=i;let s='<a href="'+n+'"';return e&&(s+=' title="'+Qo(e)+'"'),s+=">"+r+"</a>",s}image({href:n,title:e,text:t,tokens:r}){r&&(t=this.parser.parseInline(r,this.parser.textRenderer));const i=dI(n);if(i===null)return Qo(t);n=i;let s=`<img src="${n}" alt="${t}"`;return e&&(s+=` title="${Qo(e)}"`),s+=">",s}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:Qo(n.text)}},kC=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},Ka=class ey{constructor(e){ae(this,"options");ae(this,"renderer");ae(this,"textRenderer");this.options=e||pu,this.options.renderer=this.options.renderer||new Up,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new kC}static parse(e,t){return new ey(t).parse(e)}static parseInline(e,t){return new ey(t).parseInline(e)}parse(e,t=!0){var i,s;let r="";for(let a=0;a<e.length;a++){const c=e[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[c.type]){const f=c,h=this.options.extensions.renderers[f.type].call({parser:this},f);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type)){r+=h||"";continue}}const d=c;switch(d.type){case"space":{r+=this.renderer.space(d);continue}case"hr":{r+=this.renderer.hr(d);continue}case"heading":{r+=this.renderer.heading(d);continue}case"code":{r+=this.renderer.code(d);continue}case"table":{r+=this.renderer.table(d);continue}case"blockquote":{r+=this.renderer.blockquote(d);continue}case"list":{r+=this.renderer.list(d);continue}case"html":{r+=this.renderer.html(d);continue}case"paragraph":{r+=this.renderer.paragraph(d);continue}case"text":{let f=d,h=this.renderer.text(f);for(;a+1<e.length&&e[a+1].type==="text";)f=e[++a],h+=`
`+this.renderer.text(f);t?r+=this.renderer.paragraph({type:"paragraph",raw:h,text:h,tokens:[{type:"text",raw:h,text:h,escaped:!0}]}):r+=h;continue}default:{const f='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return r}parseInline(e,t=this.renderer){var i,s;let r="";for(let a=0;a<e.length;a++){const c=e[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[c.type]){const f=this.options.extensions.renderers[c.type].call({parser:this},c);if(f!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(c.type)){r+=f||"";continue}}const d=c;switch(d.type){case"escape":{r+=t.text(d);break}case"html":{r+=t.html(d);break}case"link":{r+=t.link(d);break}case"image":{r+=t.image(d);break}case"strong":{r+=t.strong(d);break}case"em":{r+=t.em(d);break}case"codespan":{r+=t.codespan(d);break}case"br":{r+=t.br(d);break}case"del":{r+=t.del(d);break}case"text":{r+=t.text(d);break}default:{const f='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return r}},Xv,P0=(Xv=class{constructor(n){ae(this,"options");ae(this,"block");this.options=n||pu}preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?$a.lex:$a.lexInline}provideParser(){return this.block?Ka.parse:Ka.parseInline}},ae(Xv,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Xv),sP=class{constructor(...n){ae(this,"defaults",yC());ae(this,"options",this.setOptions);ae(this,"parse",this.parseMarkdown(!0));ae(this,"parseInline",this.parseMarkdown(!1));ae(this,"Parser",Ka);ae(this,"Renderer",Up);ae(this,"TextRenderer",kC);ae(this,"Lexer",$a);ae(this,"Tokenizer",Lp);ae(this,"Hooks",P0);this.use(...n)}walkTokens(n,e){var r,i;let t=[];for(const s of n)switch(t=t.concat(e.call(this,s)),s.type){case"table":{const a=s;for(const c of a.header)t=t.concat(this.walkTokens(c.tokens,e));for(const c of a.rows)for(const d of c)t=t.concat(this.walkTokens(d.tokens,e));break}case"list":{const a=s;t=t.concat(this.walkTokens(a.items,e));break}default:{const a=s;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[a.type]?this.defaults.extensions.childTokens[a.type].forEach(c=>{const d=a[c].flat(1/0);t=t.concat(this.walkTokens(d,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const s=e.renderers[i.name];s?e.renderers[i.name]=function(...a){let c=i.renderer.apply(this,a);return c===!1&&(c=s.apply(this,a)),c}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=e[i.level];s?s.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){const i=this.defaults.renderer||new Up(this.defaults);for(const s in t.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const a=s,c=t.renderer[a],d=i[a];i[a]=(...f)=>{let h=c.apply(i,f);return h===!1&&(h=d.apply(i,f)),h||""}}r.renderer=i}if(t.tokenizer){const i=this.defaults.tokenizer||new Lp(this.defaults);for(const s in t.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const a=s,c=t.tokenizer[a],d=i[a];i[a]=(...f)=>{let h=c.apply(i,f);return h===!1&&(h=d.apply(i,f)),h}}r.tokenizer=i}if(t.hooks){const i=this.defaults.hooks||new P0;for(const s in t.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const a=s,c=t.hooks[a],d=i[a];P0.passThroughHooks.has(s)?i[a]=f=>{if(this.defaults.async)return Promise.resolve(c.call(i,f)).then(v=>d.call(i,v));const h=c.call(i,f);return d.call(i,h)}:i[a]=(...f)=>{let h=c.apply(i,f);return h===!1&&(h=d.apply(i,f)),h}}r.hooks=i}if(t.walkTokens){const i=this.defaults.walkTokens,s=t.walkTokens;r.walkTokens=function(a){let c=[];return c.push(s.call(this,a)),i&&(c=c.concat(i.call(this,a))),c}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return $a.lex(n,e??this.defaults)}parser(n,e){return Ka.parse(n,e??this.defaults)}parseMarkdown(n){return(t,r)=>{const i={...r},s={...this.defaults,...i},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=n);const c=s.hooks?s.hooks.provideLexer():n?$a.lex:$a.lexInline,d=s.hooks?s.hooks.provideParser():n?Ka.parse:Ka.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then(f=>c(f,s)).then(f=>s.hooks?s.hooks.processAllTokens(f):f).then(f=>s.walkTokens?Promise.all(this.walkTokens(f,s.walkTokens)).then(()=>f):f).then(f=>d(f,s)).then(f=>s.hooks?s.hooks.postprocess(f):f).catch(a);try{s.hooks&&(t=s.hooks.preprocess(t));let f=c(t,s);s.hooks&&(f=s.hooks.processAllTokens(f)),s.walkTokens&&this.walkTokens(f,s.walkTokens);let h=d(f,s);return s.hooks&&(h=s.hooks.postprocess(h)),h}catch(f){return a(f)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const r="<p>An error occurred:</p><pre>"+Qo(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},iu=new sP;function zn(n,e){return iu.parse(n,e)}zn.options=zn.setOptions=function(n){return iu.setOptions(n),zn.defaults=iu.defaults,FA(zn.defaults),zn};zn.getDefaults=yC;zn.defaults=pu;zn.use=function(...n){return iu.use(...n),zn.defaults=iu.defaults,FA(zn.defaults),zn};zn.walkTokens=function(n,e){return iu.walkTokens(n,e)};zn.parseInline=iu.parseInline;zn.Parser=Ka;zn.parser=Ka.parse;zn.Renderer=Up;zn.TextRenderer=kC;zn.Lexer=$a;zn.lexer=$a.lex;zn.Tokenizer=Lp;zn.Hooks=P0;zn.parse=zn;zn.options;zn.setOptions;zn.use;zn.walkTokens;zn.parseInline;Ka.parse;$a.lex;class oP extends tr{constructor(t){super(t);ae(this,"packageName","Client.Html")}handleAdd_html(t){this.client.emit("html",t.data.join(`
`))}handleAdd_markdown(t){const r=t.data.join(`
`),i=zn(r);this.client.emit("html",i)}}class aP{constructor(){ae(this,"state",{text:""});ae(this,"listeners",new Set);ae(this,"inputRef",null);ae(this,"dispatch",e=>{const t=this.state;this.state=this.reducer(this.state,e),this.state!==t&&this.listeners.forEach(r=>r())})}reducer(e,t){switch(t.type){case"SET_INPUT":return e.text!==t.data?{...e,text:t.data}:e;case"CLEAR_INPUT":return e.text!==""?{...e,text:""}:e;default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}registerInputRef(e){this.inputRef=e}focusInput(){var e;(e=this.inputRef)!=null&&e.current&&this.inputRef.current.focus()}}const xc=new aP,Xl=n=>{xc.dispatch({type:"SET_INPUT",data:n})},pI=n=>{xc.dispatch({type:"SET_INPUT",data:n}),xc.focusInput()},cP=()=>{xc.dispatch({type:"CLEAR_INPUT"})};class lP extends tr{constructor(t){super(t);ae(this,"packageName","Client.Keystrokes");ae(this,"bindings",[]);ae(this,"boundKeyDownHandler");this.boundKeyDownHandler=this.handleKeydown.bind(this),document.addEventListener("keydown",this.boundKeyDownHandler)}handleKeydown(t){const r=this.findBinding(t);if(r){t.preventDefault();const i=xc.getState().text,s=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(s):this.placeInInputField(s)}}shutdown(){document.removeEventListener("keydown",this.boundKeyDownHandler)}findBinding(t){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==t.key.toLowerCase())return!1;const i=new Set([t.altKey&&"alt",t.ctrlKey&&"control",t.shiftKey&&"shift",t.metaKey&&"meta"].filter(Boolean)),s=new Set((r.modifiers||[]).map(a=>a.toLowerCase()));return i.size!==s.size?!1:Array.from(s).every(a=>i.has(a))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(t,r){const i=r.trim().split(/\s+/);return t.replace(/%(\d+|\*)/g,(s,a)=>{if(a==="*")return r;const c=parseInt(a,10)-1;return c>=0&&c<i.length?i[c]:s})}placeInInputField(t){Xl(t)}bindKey(t){const r={key:t.key,modifiers:t.modifiers,command:t.command,autosend:t.autosend};this.bindings.push(r)}unbindKey(t){const r=new Set((t.modifiers||[]).map(i=>i.toLowerCase()));this.bindings=this.bindings.filter(i=>{const s=new Set((i.modifiers||[]).map(c=>c.toLowerCase()));return i.key.toLowerCase()!==t.key.toLowerCase()||s.size!==r.size?!0:!Array.from(r).every(c=>s.has(c))})}unbindAll(){this.bindings=[]}handleBind(t){this.bindKey(t)}handleUnbind(t){this.unbindKey(t)}handleBind_all(t){this.bindings=t.bindings.map(r=>({...r}))}handleUnbindAll(t){console.log("Received Client.Keystrokes.UnbindAll, clearing all bindings."),this.unbindAll()}handleListBindings(t){console.log("Received Client.Keystrokes.ListBindings request, sending current bindings.");const r=this.listBindings();this.sendData("BindingsList",r)}listBindings(){return[...this.bindings]}}const gI=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),mI=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),ty=(n,e)=>({startTime:e,type:"setValue",value:n}),$A=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),KA=(n,e,{startTime:t,target:r,timeConstant:i})=>r+(e-r)*Math.exp((t-n)/i),qu=n=>n.type==="exponentialRampToValue",Gp=n=>n.type==="linearRampToValue",sl=n=>qu(n)||Gp(n),EC=n=>n.type==="setValue",Wa=n=>n.type==="setValueCurve",Vp=(n,e,t,r)=>{const i=n[e];return i===void 0?r:sl(i)||EC(i)?i.value:Wa(i)?i.values[i.values.length-1]:KA(t,Vp(n,e-1,i.startTime,r),i)},vI=(n,e,t,r,i)=>t===void 0?[r.insertTime,i]:sl(t)?[t.endTime,t.value]:EC(t)?[t.startTime,t.value]:Wa(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,Vp(n,e-1,t.startTime,i)],ny=n=>n.type==="cancelAndHold",ry=n=>n.type==="cancelScheduledValues",Jc=n=>ny(n)||ry(n)?n.cancelTime:qu(n)||Gp(n)?n.endTime:n.startTime,yI=(n,e,t,{endTime:r,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(r-e)):0,CI=(n,e,t,{endTime:r,value:i})=>t+(n-e)/(r-e)*(i-t),uP=(n,e)=>{const t=Math.floor(e),r=Math.ceil(e);return t===r?n[t]:(1-(e-t))*n[t]+(1-(r-e))*n[r]},dP=(n,{duration:e,startTime:t,values:r})=>{const i=(n-t)/e*(r.length-1);return uP(r,i)},y0=n=>n.type==="setTarget";class fP{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Jc(e);if(ny(e)||ry(e)){const r=this._automationEvents.findIndex(s=>ry(e)&&Wa(s)?s.startTime+s.duration>=t:Jc(s)>=t),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),ny(e)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&sl(i)){if(s!==void 0&&y0(s))throw new Error("The internal list is malformed.");const a=s===void 0?i.insertTime:Wa(s)?s.startTime+s.duration:Jc(s),c=s===void 0?this._defaultValue:Wa(s)?s.values[s.values.length-1]:s.value,d=qu(i)?yI(t,a,c,i):CI(t,a,c,i),f=qu(i)?gI(d,t,this._currenTime):mI(d,t,this._currenTime);this._automationEvents.push(f)}if(s!==void 0&&y0(s)&&this._automationEvents.push(ty(this.getValue(t),t)),s!==void 0&&Wa(s)&&s.startTime+s.duration>t){const a=t-s.startTime,c=(s.values.length-1)/s.duration,d=Math.max(2,1+Math.ceil(a*c)),f=a/(d-1)*c,h=s.values.slice(0,d);if(f<1)for(let v=1;v<d;v+=1){const m=f*v%1;h[v]=s.values[v-1]*(1-m)+s.values[v]*m}this._automationEvents[this._automationEvents.length-1]=$A(h,s.startTime,a)}}}else{const r=this._automationEvents.findIndex(a=>Jc(a)>t),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Wa(i)&&Jc(i)+i.duration>t)return!1;const s=qu(e)?gI(e.value,e.endTime,this._currenTime):Gp(e)?mI(e.value,t,this._currenTime):e;if(r===-1)this._automationEvents.push(s);else{if(Wa(e)&&t+e.duration>Jc(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(e){const t=this._automationEvents.findIndex(r=>Jc(r)>e);if(t>1){const r=this._automationEvents.slice(t-1),i=r[0];y0(i)&&r.unshift(ty(Vp(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>Jc(a)>e),r=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,s=this._automationEvents[i];if(s!==void 0&&y0(s)&&(r===void 0||!sl(r)||r.insertTime>e))return KA(e,Vp(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&EC(s)&&(r===void 0||!sl(r)))return s.value;if(s!==void 0&&Wa(s)&&(r===void 0||!sl(r)||s.startTime+s.duration>e))return e<s.startTime+s.duration?dP(e,s):s.values[s.values.length-1];if(s!==void 0&&sl(s)&&(r===void 0||!sl(r)))return s.value;if(r!==void 0&&qu(r)){const[a,c]=vI(this._automationEvents,i,s,r,this._defaultValue);return yI(e,a,c,r)}if(r!==void 0&&Gp(r)){const[a,c]=vI(this._automationEvents,i,s,r,this._defaultValue);return CI(e,a,c,r)}return this._defaultValue}}const hP=n=>({cancelTime:n,type:"cancelAndHold"}),pP=n=>({cancelTime:n,type:"cancelScheduledValues"}),gP=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),mP=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),vP=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),yP=()=>new DOMException("","AbortError"),CP=n=>(e,t,[r,i,s],a)=>{n(e[i],[t,r,s],c=>c[0]===t&&c[1]===r,a)},xP=n=>(e,t,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},wP=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},hd=new WeakSet,qA=new WeakMap,JA=new WeakMap,YA=new WeakMap,QA=new WeakMap,ek=new WeakMap,tk=new WeakMap,iy=new WeakMap,sy=new WeakMap,oy=new WeakMap,nk={construct(){return nk}},IP=n=>{try{const e=new Proxy(n,nk);new e}catch{return!1}return!0},xI=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,wI=(n,e)=>{const t=[];let r=n.replace(/^[\s]+/,""),i=r.match(xI);for(;i!==null;){const s=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());t.push(a),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(xI)}return[t.join(";"),r]},II=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},bI=n=>{if(!IP(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},bP=(n,e,t,r,i,s,a,c,d,f,h,v,m)=>{let y=0;return(C,x,b={credentials:"omit"})=>{const S=h.get(C);if(S!==void 0&&S.has(x))return Promise.resolve();const A=f.get(C);if(A!==void 0){const N=A.get(x);if(N!==void 0)return N}const E=s(C),R=E.audioWorklet===void 0?i(x).then(([N,V])=>{const[M,j]=wI(N,V),J=`${M};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${j}
})})(window,'_AWGS')`;return t(J)}).then(()=>{const N=m._AWGS.pop();if(N===void 0)throw new SyntaxError;r(E.currentTime,E.sampleRate,()=>N(class{},void 0,(V,M)=>{if(V.trim()==="")throw e();const j=sy.get(E);if(j!==void 0){if(j.has(V))throw e();bI(M),II(M.parameterDescriptors),j.set(V,M)}else bI(M),II(M.parameterDescriptors),sy.set(E,new Map([[V,M]]))},E.sampleRate,void 0,void 0))}):Promise.all([i(x),Promise.resolve(n(v,v))]).then(([[N,V],M])=>{const j=y+1;y=j;const[J,L]=wI(N,V),pe=`${J};((AudioWorkletProcessor,registerProcessor)=>{${L}
})(${M?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${M?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${M?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${j}',class extends AudioWorkletProcessor{process(){return !1}})`,xe=new Blob([pe],{type:"application/javascript; charset=utf-8"}),Ae=URL.createObjectURL(xe);return E.audioWorklet.addModule(Ae,b).then(()=>{if(c(E))return E;const Le=a(E);return Le.audioWorklet.addModule(Ae,b).then(()=>Le)}).then(Le=>{if(d===null)throw new SyntaxError;try{new d(Le,`__sac${j}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(Ae))});return A===void 0?f.set(C,new Map([[x,R]])):A.set(x,R),R.then(()=>{const N=h.get(C);N===void 0?h.set(C,new Set([x])):N.add(x)}).finally(()=>{const N=f.get(C);N!==void 0&&N.delete(x)}),R}},Oo=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},mg=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return n.delete(r),r},rk=(n,e,t,r)=>{const i=Oo(n,e),s=mg(i,a=>a[0]===t&&a[1]===r);return i.size===0&&n.delete(e),s},uh=n=>Oo(tk,n),pd=n=>{if(hd.has(n))throw new Error("The AudioNode is already stored.");hd.add(n),uh(n).forEach(e=>e(!0))},ik=n=>"port"in n,dh=n=>{if(!hd.has(n))throw new Error("The AudioNode is not stored.");hd.delete(n),uh(n).forEach(e=>e(!1))},ay=(n,e)=>{!ik(n)&&e.every(t=>t.size===0)&&dh(n)},SP=(n,e,t,r,i,s,a,c,d,f,h,v,m)=>{const y=new WeakMap;return(C,x,b,S,A)=>{const{activeInputs:E,passiveInputs:R}=s(x),{outputs:N}=s(C),V=c(C),M=j=>{const J=d(x),L=d(C);if(j){const z=rk(R,C,b,S);n(E,C,z,!1),!A&&!v(C)&&t(L,J,b,S),m(x)&&pd(x)}else{const z=r(E,C,b,S);e(R,S,z,!1),!A&&!v(C)&&i(L,J,b,S);const Y=a(x);if(Y===0)h(x)&&ay(x,E);else{const ie=y.get(x);ie!==void 0&&clearTimeout(ie),y.set(x,setTimeout(()=>{h(x)&&ay(x,E)},Y*1e3))}}};return f(N,[x,b,S],j=>j[0]===x&&j[1]===b&&j[2]===S,!0)?(V.add(M),h(C)?n(E,C,[b,S,M],!0):e(R,S,[C,b,M],!0),!0):!1}},AP=n=>(e,t,[r,i,s],a)=>{const c=e.get(r);c===void 0?e.set(r,new Set([[i,t,s]])):n(c,[i,t,s],d=>d[0]===i&&d[1]===t,a)},kP=n=>(e,t)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(r),r.disconnect()};t.addEventListener("ended",i)},EP=n=>(e,t)=>{n(e).add(t)},TP={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},_P=(n,e,t,r,i,s)=>class extends n{constructor(c,d){const f=i(c),h={...TP,...d},v=r(f,h),m=s(f)?e():null;super(c,!1,v,m),this._nativeAnalyserNode=v}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(c){this._nativeAnalyserNode.fftSize=c}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(c){const d=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=c,!(c>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=d,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(c){const d=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=c,!(this._nativeAnalyserNode.maxDecibels>c))throw this._nativeAnalyserNode.minDecibels=d,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(c){this._nativeAnalyserNode.smoothingTimeConstant=c}getByteFrequencyData(c){this._nativeAnalyserNode.getByteFrequencyData(c)}getByteTimeDomainData(c){this._nativeAnalyserNode.getByteTimeDomainData(c)}getFloatFrequencyData(c){this._nativeAnalyserNode.getFloatFrequencyData(c)}getFloatTimeDomainData(c){this._nativeAnalyserNode.getFloatTimeDomainData(c)}},Oi=(n,e)=>n.context===e,RP=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let c=e(s);if(!Oi(c,a)){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,fftSize:c.fftSize,maxDecibels:c.maxDecibels,minDecibels:c.minDecibels,smoothingTimeConstant:c.smoothingTimeConstant};c=n(a,f)}return r.set(a,c),await t(s,a,c),c};return{render(s,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):i(s,a)}}},cy=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},ba=()=>new DOMException("","IndexSizeError"),sk=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(r){throw r.code===12?ba():r}})(n.getChannelData)},DP={numberOfChannels:1},PP=(n,e,t,r,i,s,a,c)=>{let d=null;return class ok{constructor(h){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:v,numberOfChannels:m,sampleRate:y}={...DP,...h};d===null&&(d=new i(1,1,44100));const C=r!==null&&e(s,s)?new r({length:v,numberOfChannels:m,sampleRate:y}):d.createBuffer(m,v,y);if(C.numberOfChannels===0)throw t();return typeof C.copyFromChannel!="function"?(a(C),sk(C)):e(cy,()=>cy(C))||c(C),n.add(C),C}static[Symbol.hasInstance](h){return h!==null&&typeof h=="object"&&Object.getPrototypeOf(h)===ok.prototype||n.has(h)}}},hs=-34028234663852886e22,zi=-hs,wc=n=>hd.has(n),NP={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},MP=(n,e,t,r,i,s,a,c)=>class extends n{constructor(f,h){const v=s(f),m={...NP,...h},y=i(v,m),C=a(v),x=C?e():null;super(f,!1,y,x),this._audioBufferSourceNodeRenderer=x,this._isBufferNullified=!1,this._isBufferSet=m.buffer!==null,this._nativeAudioBufferSourceNode=y,this._onended=null,this._playbackRate=t(this,C,y.playbackRate,zi,hs)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(f){if(this._nativeAudioBufferSourceNode.buffer=f,f!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(f){this._nativeAudioBufferSourceNode.loop=f}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(f){this._nativeAudioBufferSourceNode.loopEnd=f}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(f){this._nativeAudioBufferSourceNode.loopStart=f}get onended(){return this._onended}set onended(f){const h=typeof f=="function"?c(this,f):null;this._nativeAudioBufferSourceNode.onended=h;const v=this._nativeAudioBufferSourceNode.onended;this._onended=v!==null&&v===h?f:v}get playbackRate(){return this._playbackRate}start(f=0,h=0,v){if(this._nativeAudioBufferSourceNode.start(f,h,v),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=v===void 0?[f,h]:[f,h,v]),this.context.state!=="closed"){pd(this);const m=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",m),wc(this)&&dh(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",m)}}stop(f=0){this._nativeAudioBufferSourceNode.stop(f),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=f)}},BP=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,c=null;const d=async(f,h)=>{let v=t(f);const m=Oi(v,h);if(!m){const y={buffer:v.buffer,channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,loop:v.loop,loopEnd:v.loopEnd,loopStart:v.loopStart,playbackRate:v.playbackRate.value};v=e(h,y),a!==null&&v.start(...a),c!==null&&v.stop(c)}return s.set(h,v),m?await n(h,f.playbackRate,v.playbackRate):await r(h,f.playbackRate,v.playbackRate),await i(f,h,v),v};return{set start(f){a=f},set stop(f){c=f},render(f,h){const v=s.get(h);return v!==void 0?Promise.resolve(v):d(f,h)}}},OP=n=>"playbackRate"in n,FP=n=>"frequency"in n&&"gain"in n,LP=n=>"offset"in n,UP=n=>!("frequency"in n)&&"gain"in n,GP=n=>"detune"in n&&"frequency"in n&&!("gain"in n),VP=n=>"pan"in n,Xi=n=>Oo(qA,n),fh=n=>Oo(YA,n),ly=(n,e)=>{const{activeInputs:t}=Xi(n);t.forEach(i=>i.forEach(([s])=>{e.includes(n)||ly(s,[...e,n])}));const r=OP(n)?[n.playbackRate]:ik(n)?Array.from(n.parameters.values()):FP(n)?[n.Q,n.detune,n.frequency,n.gain]:LP(n)?[n.offset]:UP(n)?[n.gain]:GP(n)?[n.detune,n.frequency]:VP(n)?[n.pan]:[];for(const i of r){const s=fh(i);s!==void 0&&s.activeInputs.forEach(([a])=>ly(a,e))}wc(n)&&dh(n)},jP=n=>{ly(n.destination,[])},WP=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),zP=(n,e,t,r,i,s,a,c,d)=>class extends n{constructor(h={}){if(d===null)throw new Error("Missing the native AudioContext constructor.");let v;try{v=new d(h)}catch(C){throw C.code===12&&C.message==="sampleRate is not in range"?t():C}if(v===null)throw r();if(!WP(h.latencyHint))throw new TypeError(`The provided value '${h.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(h.sampleRate!==void 0&&v.sampleRate!==h.sampleRate)throw t();super(v,2);const{latencyHint:m}=h,{sampleRate:y}=v;if(this._baseLatency=typeof v.baseLatency=="number"?v.baseLatency:m==="balanced"?512/y:m==="interactive"||m===void 0?256/y:m==="playback"?1024/y:Math.max(2,Math.min(128,Math.round(m*y/128)))*128/y,this._nativeAudioContext=v,d.name==="webkitAudioContext"?(this._nativeGainNode=v.createGain(),this._nativeOscillatorNode=v.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(v.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,v.state==="running"){this._state="suspended";const C=()=>{this._state==="suspended"&&(this._state=null),v.removeEventListener("statechange",C)};v.addEventListener("statechange",C)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),jP(this)}))}createMediaElementSource(h){return new i(this,{mediaElement:h})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(h){return new a(this,{mediaStream:h})}createMediaStreamTrackSource(h){return new c(this,{mediaStreamTrack:h})}resume(){return this._state==="suspended"?new Promise((h,v)=>{const m=()=>{this._nativeAudioContext.removeEventListener("statechange",m),this._nativeAudioContext.state==="running"?h():this.resume().then(h,v)};this._nativeAudioContext.addEventListener("statechange",m)}):this._nativeAudioContext.resume().catch(h=>{throw h===void 0||h.code===15?e():h})}suspend(){return this._nativeAudioContext.suspend().catch(h=>{throw h===void 0?e():h})}},HP=(n,e,t,r,i,s,a,c)=>class extends n{constructor(f,h){const v=s(f),m=a(v),y=i(v,h,m),C=m?e(c):null;super(f,!1,y,C),this._isNodeOfNativeOfflineAudioContext=m,this._nativeAudioDestinationNode=y}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(f){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(f>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=f}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(f){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=f}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},ZP=n=>{const e=new WeakMap,t=async(r,i)=>{const s=i.destination;return e.set(i,s),await n(r,i,s),s};return{render(r,i){const s=e.get(i);return s!==void 0?Promise.resolve(s):t(r,i)}}},XP=(n,e,t,r,i,s,a,c)=>(d,f)=>{const h=f.listener,v=()=>{const N=new Float32Array(1),V=e(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),M=a(f);let j=!1,J=[0,0,-1,0,1,0],L=[0,0,0];const z=()=>{if(j)return;j=!0;const xe=r(f,256,9,0);xe.onaudioprocess=({inputBuffer:Ae})=>{const Le=[s(Ae,N,0),s(Ae,N,1),s(Ae,N,2),s(Ae,N,3),s(Ae,N,4),s(Ae,N,5)];Le.some((Se,Ee)=>Se!==J[Ee])&&(h.setOrientation(...Le),J=Le);const we=[s(Ae,N,6),s(Ae,N,7),s(Ae,N,8)];we.some((Se,Ee)=>Se!==L[Ee])&&(h.setPosition(...we),L=we)},V.connect(xe)},Y=xe=>Ae=>{Ae!==J[xe]&&(J[xe]=Ae,h.setOrientation(...J))},ie=xe=>Ae=>{Ae!==L[xe]&&(L[xe]=Ae,h.setPosition(...L))},pe=(xe,Ae,Le)=>{const we=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Ae});we.connect(V,0,xe),we.start(),Object.defineProperty(we.offset,"defaultValue",{get(){return Ae}});const Se=n({context:d},M,we.offset,zi,hs);return c(Se,"value",Ee=>()=>Ee.call(Se),Ee=>H=>{try{Ee.call(Se,H)}catch(ee){if(ee.code!==9)throw ee}z(),M&&Le(H)}),Se.cancelAndHoldAtTime=(Ee=>M?()=>{throw i()}:(...H)=>{const ee=Ee.apply(Se,H);return z(),ee})(Se.cancelAndHoldAtTime),Se.cancelScheduledValues=(Ee=>M?()=>{throw i()}:(...H)=>{const ee=Ee.apply(Se,H);return z(),ee})(Se.cancelScheduledValues),Se.exponentialRampToValueAtTime=(Ee=>M?()=>{throw i()}:(...H)=>{const ee=Ee.apply(Se,H);return z(),ee})(Se.exponentialRampToValueAtTime),Se.linearRampToValueAtTime=(Ee=>M?()=>{throw i()}:(...H)=>{const ee=Ee.apply(Se,H);return z(),ee})(Se.linearRampToValueAtTime),Se.setTargetAtTime=(Ee=>M?()=>{throw i()}:(...H)=>{const ee=Ee.apply(Se,H);return z(),ee})(Se.setTargetAtTime),Se.setValueAtTime=(Ee=>M?()=>{throw i()}:(...H)=>{const ee=Ee.apply(Se,H);return z(),ee})(Se.setValueAtTime),Se.setValueCurveAtTime=(Ee=>M?()=>{throw i()}:(...H)=>{const ee=Ee.apply(Se,H);return z(),ee})(Se.setValueCurveAtTime),Se};return{forwardX:pe(0,0,Y(0)),forwardY:pe(1,0,Y(1)),forwardZ:pe(2,-1,Y(2)),positionX:pe(6,0,ie(0)),positionY:pe(7,0,ie(1)),positionZ:pe(8,0,ie(2)),upX:pe(3,0,Y(3)),upY:pe(4,1,Y(4)),upZ:pe(5,0,Y(5))}},{forwardX:m,forwardY:y,forwardZ:C,positionX:x,positionY:b,positionZ:S,upX:A,upY:E,upZ:R}=h.forwardX===void 0?v():h;return{get forwardX(){return m},get forwardY(){return y},get forwardZ(){return C},get positionX(){return x},get positionY(){return b},get positionZ(){return S},get upX(){return A},get upY(){return E},get upZ(){return R}}},jp=n=>"context"in n,hh=n=>jp(n[0]),gu=(n,e,t,r)=>{for(const i of n)if(t(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},SI=(n,e,[t,r],i)=>{gu(n,[e,t,r],s=>s[0]===e&&s[1]===t,i)},AI=(n,[e,t,r],i)=>{const s=n.get(e);s===void 0?n.set(e,new Set([[t,r]])):gu(s,[t,r],a=>a[0]===t,i)},Id=n=>"inputs"in n,Wp=(n,e,t,r)=>{if(Id(e)){const i=e.inputs[r];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,r),[e,t,r]},ak=(n,e,t)=>{for(const r of n)if(r[0]===e&&r[1]===t)return n.delete(r),r;return null},$P=(n,e,t)=>mg(n,r=>r[0]===e&&r[1]===t),ck=(n,e)=>{if(!uh(n).delete(e))throw new Error("Missing the expected event listener.")},lk=(n,e,t)=>{const r=Oo(n,e),i=mg(r,s=>s[0]===t);return r.size===0&&n.delete(e),i},zp=(n,e,t,r)=>{Id(e)?n.disconnect(e.inputs[r],t,0):n.disconnect(e,t,r)},dr=n=>Oo(JA,n),jf=n=>Oo(QA,n),su=n=>iy.has(n),N0=n=>!hd.has(n),kI=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const r=n.createScriptProcessor(256,1,1),i=n.createGain(),s=n.createBuffer(1,2,44100),a=s.getChannelData(0);a[0]=1,a[1]=1;const c=n.createBufferSource();c.buffer=s,c.loop=!0,c.connect(r).connect(n.destination),c.connect(i),c.disconnect(i),r.onaudioprocess=d=>{const f=d.inputBuffer.getChannelData(0);Array.prototype.some.call(f,h=>h===1)?t(!0):t(!1),c.stop(),r.onaudioprocess=null,c.disconnect(r),r.disconnect(n.destination)},c.start()}}),dv=(n,e)=>{const t=new Map;for(const r of n)for(const i of r){const s=t.get(i);t.set(i,s===void 0?1:s+1)}t.forEach((r,i)=>e(i,r))},Hp=n=>"context"in n,KP=n=>{const e=new Map;n.connect=(t=>(r,i=0,s=0)=>{const a=Hp(r)?t(r,i,s):t(r,i),c=e.get(r);return c===void 0?e.set(r,[{input:s,output:i}]):c.every(d=>d.input!==s||d.output!==i)&&c.push({input:s,output:i}),a})(n.connect.bind(n)),n.disconnect=(t=>(r,i,s)=>{if(t.apply(n),r===void 0)e.clear();else if(typeof r=="number")for(const[a,c]of e){const d=c.filter(f=>f.output!==r);d.length===0?e.delete(a):e.set(a,d)}else if(e.has(r))if(i===void 0)e.delete(r);else{const a=e.get(r);if(a!==void 0){const c=a.filter(d=>d.output!==i&&(d.input!==s||s===void 0));c.length===0?e.delete(r):e.set(r,c)}}for(const[a,c]of e)c.forEach(d=>{Hp(a)?n.connect(a,d.output,d.input):n.connect(a,d.output)})})(n.disconnect)},qP=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:s}=fh(e),{outputs:a}=Xi(n),c=uh(n),d=f=>{const h=dr(n),v=jf(e);if(f){const m=lk(s,n,t);SI(i,n,m,!1),!r&&!su(n)&&h.connect(v,t)}else{const m=$P(i,n,t);AI(s,m,!1),!r&&!su(n)&&h.disconnect(v,t)}};return gu(a,[e,t],f=>f[0]===e&&f[1]===t,!0)?(c.add(d),wc(n)?SI(i,n,[t,d],!0):AI(s,[n,t,d],!0),!0):!1},JP=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:s}=Xi(e),a=ak(i[r],n,t);return a===null?[rk(s,n,t,r)[2],!1]:[a[2],!0]},YP=(n,e,t)=>{const{activeInputs:r,passiveInputs:i}=fh(e),s=ak(r,n,t);return s===null?[lk(i,n,t)[1],!1]:[s[2],!0]},TC=(n,e,t,r,i)=>{const[s,a]=JP(n,t,r,i);if(s!==null&&(ck(n,s),a&&!e&&!su(n)&&zp(dr(n),dr(t),r,i)),wc(t)){const{activeInputs:c}=Xi(t);ay(t,c)}},_C=(n,e,t,r)=>{const[i,s]=YP(n,t,r);i!==null&&(ck(n,i),s&&!e&&!su(n)&&dr(n).disconnect(jf(t),r))},QP=(n,e)=>{const t=Xi(n),r=[];for(const i of t.outputs)hh(i)?TC(n,e,...i):_C(n,e,...i),r.push(i[0]);return t.outputs.clear(),r},e4=(n,e,t)=>{const r=Xi(n),i=[];for(const s of r.outputs)s[1]===t&&(hh(s)?TC(n,e,...s):_C(n,e,...s),i.push(s[0]),r.outputs.delete(s));return i},t4=(n,e,t,r,i)=>{const s=Xi(n);return Array.from(s.outputs).filter(a=>a[0]===t&&(r===void 0||a[1]===r)&&(i===void 0||a[2]===i)).map(a=>(hh(a)?TC(n,e,...a):_C(n,e,...a),s.outputs.delete(a),a[0]))},n4=(n,e,t,r,i,s,a,c,d,f,h,v,m,y,C,x)=>class extends f{constructor(S,A,E,R){super(E),this._context=S,this._nativeAudioNode=E;const N=h(S);v(N)&&t(kI,()=>kI(N,x))!==!0&&KP(E),JA.set(this,E),tk.set(this,new Set),S.state!=="closed"&&A&&pd(this),n(this,R,E)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(S){this._nativeAudioNode.channelCount=S}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(S){this._nativeAudioNode.channelCountMode=S}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(S){this._nativeAudioNode.channelInterpretation=S}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(S,A=0,E=0){if(A<0||A>=this._nativeAudioNode.numberOfOutputs)throw i();const R=h(this._context),N=C(R);if(m(S)||y(S))throw s();if(jp(S)){const j=dr(S);try{const L=Wp(this._nativeAudioNode,j,A,E),z=N0(this);(N||z)&&this._nativeAudioNode.disconnect(...L),this.context.state!=="closed"&&!z&&N0(S)&&pd(S)}catch(L){throw L.code===12?s():L}if(e(this,S,A,E,N)){const L=d([this],S);dv(L,r(N))}return S}const V=jf(S);if(V.name==="playbackRate"&&V.maxValue===1024)throw a();try{this._nativeAudioNode.connect(V,A),(N||N0(this))&&this._nativeAudioNode.disconnect(V,A)}catch(j){throw j.code===12?s():j}if(qP(this,S,A,N)){const j=d([this],S);dv(j,r(N))}}disconnect(S,A,E){let R;const N=h(this._context),V=C(N);if(S===void 0)R=QP(this,V);else if(typeof S=="number"){if(S<0||S>=this.numberOfOutputs)throw i();R=e4(this,V,S)}else{if(A!==void 0&&(A<0||A>=this.numberOfOutputs)||jp(S)&&E!==void 0&&(E<0||E>=S.numberOfInputs))throw i();if(R=t4(this,V,S,A,E),R.length===0)throw s()}for(const M of R){const j=d([this],M);dv(j,c)}}},r4=(n,e,t,r,i,s,a,c,d,f,h,v,m)=>(y,C,x,b=null,S=null)=>{const A=x.value,E=new fP(A),R=C?r(E):null,N={get defaultValue(){return A},get maxValue(){return b===null?x.maxValue:b},get minValue(){return S===null?x.minValue:S},get value(){return x.value},set value(V){x.value=V,N.setValueAtTime(V,y.context.currentTime)},cancelAndHoldAtTime(V){if(typeof x.cancelAndHoldAtTime=="function")R===null&&E.flush(y.context.currentTime),E.add(i(V)),x.cancelAndHoldAtTime(V);else{const M=Array.from(E).pop();R===null&&E.flush(y.context.currentTime),E.add(i(V));const j=Array.from(E).pop();x.cancelScheduledValues(V),M!==j&&j!==void 0&&(j.type==="exponentialRampToValue"?x.exponentialRampToValueAtTime(j.value,j.endTime):j.type==="linearRampToValue"?x.linearRampToValueAtTime(j.value,j.endTime):j.type==="setValue"?x.setValueAtTime(j.value,j.startTime):j.type==="setValueCurve"&&x.setValueCurveAtTime(j.values,j.startTime,j.duration))}return N},cancelScheduledValues(V){return R===null&&E.flush(y.context.currentTime),E.add(s(V)),x.cancelScheduledValues(V),N},exponentialRampToValueAtTime(V,M){if(V===0)throw new RangeError;if(!Number.isFinite(M)||M<0)throw new RangeError;const j=y.context.currentTime;return R===null&&E.flush(j),Array.from(E).length===0&&(E.add(f(A,j)),x.setValueAtTime(A,j)),E.add(a(V,M)),x.exponentialRampToValueAtTime(V,M),N},linearRampToValueAtTime(V,M){const j=y.context.currentTime;return R===null&&E.flush(j),Array.from(E).length===0&&(E.add(f(A,j)),x.setValueAtTime(A,j)),E.add(c(V,M)),x.linearRampToValueAtTime(V,M),N},setTargetAtTime(V,M,j){return R===null&&E.flush(y.context.currentTime),E.add(d(V,M,j)),x.setTargetAtTime(V,M,j),N},setValueAtTime(V,M){return R===null&&E.flush(y.context.currentTime),E.add(f(V,M)),x.setValueAtTime(V,M),N},setValueCurveAtTime(V,M,j){const J=V instanceof Float32Array?V:new Float32Array(V);if(v!==null&&v.name==="webkitAudioContext"){const L=M+j,z=y.context.sampleRate,Y=Math.ceil(M*z),ie=Math.floor(L*z),pe=ie-Y,xe=new Float32Array(pe);for(let Le=0;Le<pe;Le+=1){const we=(J.length-1)/j*((Y+Le)/z-M),Se=Math.floor(we),Ee=Math.ceil(we);xe[Le]=Se===Ee?J[Se]:(1-(we-Se))*J[Se]+(1-(Ee-we))*J[Ee]}R===null&&E.flush(y.context.currentTime),E.add(h(xe,M,j)),x.setValueCurveAtTime(xe,M,j);const Ae=ie/z;Ae<L&&m(N,xe[xe.length-1],Ae),m(N,J[J.length-1],L)}else R===null&&E.flush(y.context.currentTime),E.add(h(J,M,j)),x.setValueCurveAtTime(J,M,j);return N}};return t.set(N,x),e.set(N,y),n(N,R),N},i4=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:r,value:i}=t;e.exponentialRampToValueAtTime(i,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:i}=t;e.linearRampToValueAtTime(i,r)}else if(t.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=t;e.setTargetAtTime(i,r,s)}else if(t.type==="setValue"){const{startTime:r,value:i}=t;e.setValueAtTime(i,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=t;e.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}});class uk{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,i)=>e.call(t,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const s4={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},o4=(n,e,t,r,i,s,a,c,d,f,h,v,m,y)=>class extends e{constructor(x,b,S){var A;const E=c(x),R=d(E),N=h({...s4,...S});m(N);const V=sy.get(E),M=V==null?void 0:V.get(b),j=R||E.state!=="closed"?E:(A=a(E))!==null&&A!==void 0?A:E,J=i(j,R?null:x.baseLatency,f,b,M,N),L=R?r(b,N,M):null;super(x,!0,J,L);const z=[];J.parameters.forEach((ie,pe)=>{const xe=t(this,R,ie);z.push([pe,xe])}),this._nativeAudioWorkletNode=J,this._onprocessorerror=null,this._parameters=new uk(z),R&&n(E,this);const{activeInputs:Y}=s(this);v(J,Y)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(x){const b=typeof x=="function"?y(this,x):null;this._nativeAudioWorkletNode.onprocessorerror=b;const S=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=S!==null&&S===b?x:S}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Zp(n,e,t,r,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],r,i);else{const s=n.getChannelData(r);if(e[t].byteLength===0)e[t]=s.slice(i,i+128);else{const a=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const dk=(n,e,t,r,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],r,i):e[t].byteLength!==0&&n.getChannelData(r).set(e[t],i)},Xp=(n,e)=>{const t=[];for(let r=0;r<n;r+=1){const i=[],s=typeof e=="number"?e:e[r];for(let a=0;a<s;a+=1)i.push(new Float32Array(128));t.push(i)}return t},a4=(n,e)=>{const t=Oo(oy,n),r=dr(e);return Oo(t,r)},c4=async(n,e,t,r,i,s,a)=>{const c=e===null?Math.ceil(n.context.length/128)*128:e.length,d=r.channelCount*r.numberOfInputs,f=i.reduce((b,S)=>b+S,0),h=f===0?null:t.createBuffer(f,c,t.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const v=Xi(n),m=await a4(t,n),y=Xp(r.numberOfInputs,r.channelCount),C=Xp(r.numberOfOutputs,i),x=Array.from(n.parameters.keys()).reduce((b,S)=>({...b,[S]:new Float32Array(128)}),{});for(let b=0;b<c;b+=128){if(r.numberOfInputs>0&&e!==null)for(let S=0;S<r.numberOfInputs;S+=1)for(let A=0;A<r.channelCount;A+=1)Zp(e,y[S],A,A,b);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:S},A)=>{Zp(e,x,S,d+A,b)});for(let S=0;S<r.numberOfInputs;S+=1)for(let A=0;A<i[S];A+=1)C[S][A].byteLength===0&&(C[S][A]=new Float32Array(128));try{const S=y.map((E,R)=>v.activeInputs[R].size===0?[]:E),A=a(b/t.sampleRate,t.sampleRate,()=>m.process(S,C,x));if(h!==null)for(let E=0,R=0;E<r.numberOfOutputs;E+=1){for(let N=0;N<i[E];N+=1)dk(h,C[E],N,R+N,b);R+=i[E]}if(!A)break}catch(S){n.dispatchEvent(new ErrorEvent("processorerror",{colno:S.colno,filename:S.filename,lineno:S.lineno,message:S.message}));break}}return h},l4=(n,e,t,r,i,s,a,c,d,f,h,v,m,y,C,x)=>(b,S,A)=>{const E=new WeakMap;let R=null;const N=async(V,M)=>{let j=h(V),J=null;const L=Oi(j,M),z=Array.isArray(S.outputChannelCount)?S.outputChannelCount:Array.from(S.outputChannelCount);if(v===null){const Y=z.reduce((Ae,Le)=>Ae+Le,0),ie=i(M,{channelCount:Math.max(1,Y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,Y)}),pe=[];for(let Ae=0;Ae<V.numberOfOutputs;Ae+=1)pe.push(r(M,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:z[Ae]}));const xe=a(M,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1});xe.connect=e.bind(null,pe),xe.disconnect=d.bind(null,pe),J=[ie,pe,xe]}else L||(j=new v(M,b));if(E.set(M,J===null?j:J[2]),J!==null){if(R===null){if(A===void 0)throw new Error("Missing the processor constructor.");if(m===null)throw new Error("Missing the native OfflineAudioContext constructor.");const Le=V.channelCount*V.numberOfInputs,we=A.parameterDescriptors===void 0?0:A.parameterDescriptors.length,Se=Le+we;R=c4(V,Se===0?null:await(async()=>{const H=new m(Se,Math.ceil(V.context.length/128)*128,M.sampleRate),ee=[],ce=[];for(let Ne=0;Ne<S.numberOfInputs;Ne+=1)ee.push(a(H,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1})),ce.push(i(H,{channelCount:S.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:S.channelCount}));const Ce=await Promise.all(Array.from(V.parameters.values()).map(async Ne=>{const ft=s(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Ne.value});return await y(H,Ne,ft.offset),ft})),_e=r(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Le+we)});for(let Ne=0;Ne<S.numberOfInputs;Ne+=1){ee[Ne].connect(ce[Ne]);for(let ft=0;ft<S.channelCount;ft+=1)ce[Ne].connect(_e,ft,Ne*S.channelCount+ft)}for(const[Ne,ft]of Ce.entries())ft.connect(_e,0,Le+Ne),ft.start(0);return _e.connect(H.destination),await Promise.all(ee.map(Ne=>C(V,H,Ne))),x(H)})(),M,S,z,A,f)}const Y=await R,ie=t(M,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[pe,xe,Ae]=J;Y!==null&&(ie.buffer=Y,ie.start(0)),ie.connect(pe);for(let Le=0,we=0;Le<V.numberOfOutputs;Le+=1){const Se=xe[Le];for(let Ee=0;Ee<z[Le];Ee+=1)pe.connect(Se,we+Ee,Ee);we+=z[Le]}return Ae}if(L)for(const[Y,ie]of V.parameters.entries())await n(M,ie,j.parameters.get(Y));else for(const[Y,ie]of V.parameters.entries())await y(M,ie,j.parameters.get(Y));return await C(V,M,j),j};return{render(V,M){c(M,V);const j=E.get(M);return j!==void 0?Promise.resolve(j):N(V,M)}}},u4=(n,e,t,r,i,s,a,c,d,f,h,v,m,y,C,x,b,S,A,E)=>class extends C{constructor(N,V){super(N,V),this._nativeContext=N,this._audioWorklet=n===void 0?void 0:{addModule:(M,j)=>n(this,M,j)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(N,V,M){return new t({length:V,numberOfChannels:N,sampleRate:M})}createBufferSource(){return new r(this)}createChannelMerger(N=6){return new s(this,{numberOfInputs:N})}createChannelSplitter(N=6){return new a(this,{numberOfOutputs:N})}createConstantSource(){return new c(this)}createConvolver(){return new d(this)}createDelay(N=1){return new h(this,{maxDelayTime:N})}createDynamicsCompressor(){return new v(this)}createGain(){return new m(this)}createIIRFilter(N,V){return new y(this,{feedback:V,feedforward:N})}createOscillator(){return new x(this)}createPanner(){return new b(this)}createPeriodicWave(N,V,M={disableNormalization:!1}){return new S(this,{...M,imag:V,real:N})}createStereoPanner(){return new A(this)}createWaveShaper(){return new E(this)}decodeAudioData(N,V,M){return f(this._nativeContext,N).then(j=>(typeof V=="function"&&V(j),j),j=>{throw typeof M=="function"&&M(j),j})}},d4={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},f4=(n,e,t,r,i,s,a,c)=>class extends n{constructor(f,h){const v=s(f),m={...d4,...h},y=i(v,m),C=a(v),x=C?t():null;super(f,!1,y,x),this._Q=e(this,C,y.Q,zi,hs),this._detune=e(this,C,y.detune,1200*Math.log2(zi),-1200*Math.log2(zi)),this._frequency=e(this,C,y.frequency,f.sampleRate/2,0),this._gain=e(this,C,y.gain,40*Math.log10(zi),hs),this._nativeBiquadFilterNode=y,c(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(f){this._nativeBiquadFilterNode.type=f}getFrequencyResponse(f,h,v){try{this._nativeBiquadFilterNode.getFrequencyResponse(f,h,v)}catch(m){throw m.code===11?r():m}if(f.length!==h.length||h.length!==v.length)throw r()}},h4=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(c,d)=>{let f=t(c);const h=Oi(f,d);if(!h){const v={Q:f.Q.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,gain:f.gain.value,type:f.type};f=e(d,v)}return s.set(d,f),h?(await n(d,c.Q,f.Q),await n(d,c.detune,f.detune),await n(d,c.frequency,f.frequency),await n(d,c.gain,f.gain)):(await r(d,c.Q,f.Q),await r(d,c.detune,f.detune),await r(d,c.frequency,f.frequency),await r(d,c.gain,f.gain)),await i(c,d,f),f};return{render(c,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):a(c,d)}}},p4=(n,e)=>(t,r)=>{const i=e.get(t);if(i!==void 0)return i;const s=n.get(t);if(s!==void 0)return s;try{const a=r();return a instanceof Promise?(n.set(t,a),a.catch(()=>!1).then(c=>(n.delete(t),e.set(t,c),c))):(e.set(t,a),a)}catch{return e.set(t,!1),!1}},g4={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},m4=(n,e,t,r,i)=>class extends n{constructor(a,c){const d=r(a),f={...g4,...c},h=t(d,f),v=i(d)?e():null;super(a,!1,h,v)}},v4=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let c=e(s);if(!Oi(c,a)){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfInputs:c.numberOfInputs};c=n(a,f)}return r.set(a,c),await t(s,a,c),c};return{render(s,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):i(s,a)}}},y4={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},C4=(n,e,t,r,i,s)=>class extends n{constructor(c,d){const f=r(c),h=s({...y4,...d}),v=t(f,h),m=i(f)?e():null;super(c,!1,v,m)}},x4=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let c=e(s);if(!Oi(c,a)){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfOutputs:c.numberOfOutputs};c=n(a,f)}return r.set(a,c),await t(s,a,c),c};return{render(s,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):i(s,a)}}},w4=n=>(e,t,r)=>n(t,e,r),I4=n=>(e,t,r=0,i=0)=>{const s=e[r];if(s===void 0)throw n();return Hp(t)?s.connect(t,0,i):s.connect(t,0)},b4=n=>(e,t)=>{const r=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},S4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},A4=(n,e,t,r,i,s,a)=>class extends n{constructor(d,f){const h=i(d),v={...S4,...f},m=r(h,v),y=s(h),C=y?t():null;super(d,!1,m,C),this._constantSourceNodeRenderer=C,this._nativeConstantSourceNode=m,this._offset=e(this,y,m.offset,zi,hs),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(d){const f=typeof d=="function"?a(this,d):null;this._nativeConstantSourceNode.onended=f;const h=this._nativeConstantSourceNode.onended;this._onended=h!==null&&h===f?d:h}start(d=0){if(this._nativeConstantSourceNode.start(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=d),this.context.state!=="closed"){pd(this);const f=()=>{this._nativeConstantSourceNode.removeEventListener("ended",f),wc(this)&&dh(this)};this._nativeConstantSourceNode.addEventListener("ended",f)}}stop(d=0){this._nativeConstantSourceNode.stop(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=d)}},k4=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,c=null;const d=async(f,h)=>{let v=t(f);const m=Oi(v,h);if(!m){const y={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,offset:v.offset.value};v=e(h,y),a!==null&&v.start(a),c!==null&&v.stop(c)}return s.set(h,v),m?await n(h,f.offset,v.offset):await r(h,f.offset,v.offset),await i(f,h,v),v};return{set start(f){a=f},set stop(f){c=f},render(f,h){const v=s.get(h);return v!==void 0?Promise.resolve(v):d(f,h)}}},E4=n=>e=>(n[0]=e,n[0]),T4={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},_4=(n,e,t,r,i,s)=>class extends n{constructor(c,d){const f=r(c),h={...T4,...d},v=t(f,h),y=i(f)?e():null;super(c,!1,v,y),this._isBufferNullified=!1,this._nativeConvolverNode=v,h.buffer!==null&&s(this,h.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(c){if(this._nativeConvolverNode.buffer=c,c===null&&this._nativeConvolverNode.buffer!==null){const d=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=d.createBuffer(1,1,d.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(c){this._nativeConvolverNode.normalize=c}},R4=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let c=e(s);if(!Oi(c,a)){const f={buffer:c.buffer,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,disableNormalization:!c.normalize};c=n(a,f)}return r.set(a,c),Id(c)?await t(s,a,c.inputs[0]):await t(s,a,c),c};return{render(s,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):i(s,a)}}},D4=()=>new DOMException("","DataCloneError"),EI=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{const i=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},P4=(n,e,t,r,i,s,a,c,d,f,h)=>(v,m)=>{const y=a(v)?v:s(v);if(i.has(m)){const C=t();return Promise.reject(C)}try{i.add(m)}catch{}return e(d,()=>d(y))?y.decodeAudioData(m).then(C=>(EI(m).catch(()=>{}),e(c,()=>c(C))||h(C),n.add(C),C)):new Promise((C,x)=>{const b=async()=>{try{await EI(m)}catch{}},S=A=>{x(A),b()};try{y.decodeAudioData(m,A=>{typeof A.copyFromChannel!="function"&&(f(A),sk(A)),n.add(A),b().then(()=>C(A))},A=>{S(A===null?r():A)})}catch(A){S(A)}})},N4=(n,e,t,r,i,s,a,c)=>(d,f)=>{const h=e.get(d);if(h===void 0)throw new Error("Missing the expected cycle count.");const v=s(d.context),m=c(v);if(h===f){if(e.delete(d),!m&&a(d)){const y=r(d),{outputs:C}=t(d);for(const x of C)if(hh(x)){const b=r(x[0]);n(y,b,x[1],x[2])}else{const b=i(x[0]);y.connect(b,x[1])}}}else e.set(d,h-f)},M4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},B4=(n,e,t,r,i,s,a)=>class extends n{constructor(d,f){const h=i(d),v={...M4,...f},m=r(h,v),y=s(h),C=y?t(v.maxDelayTime):null;super(d,!1,m,C),this._delayTime=e(this,y,m.delayTime),a(this,v.maxDelayTime)}get delayTime(){return this._delayTime}},O4=(n,e,t,r,i)=>s=>{const a=new WeakMap,c=async(d,f)=>{let h=t(d);const v=Oi(h,f);if(!v){const m={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:s};h=e(f,m)}return a.set(f,h),v?await n(f,d.delayTime,h.delayTime):await r(f,d.delayTime,h.delayTime),await i(d,f,h),h};return{render(d,f){const h=a.get(f);return h!==void 0?Promise.resolve(h):c(d,f)}}},F4=n=>(e,t,r,i)=>n(e[i],s=>s[0]===t&&s[1]===r),L4=n=>(e,t)=>{n(e).delete(t)},U4=n=>"delayTime"in n,G4=(n,e,t)=>function r(i,s){const a=jp(s)?s:t(n,s);if(U4(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];const{outputs:c}=e(a);return Array.from(c).map(d=>r([...i,a],d[0])).reduce((d,f)=>d.concat(f),[])},C0=(n,e,t)=>{const r=e[t];if(r===void 0)throw n();return r},V4=n=>(e,t=void 0,r=void 0,i=0)=>t===void 0?e.forEach(s=>s.disconnect()):typeof t=="number"?C0(n,e,t).disconnect():Hp(t)?r===void 0?e.forEach(s=>s.disconnect(t)):i===void 0?C0(n,e,r).disconnect(t,0):C0(n,e,r).disconnect(t,0,i):r===void 0?e.forEach(s=>s.disconnect(t)):C0(n,e,r).disconnect(t,0),j4={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},W4=(n,e,t,r,i,s,a,c)=>class extends n{constructor(f,h){const v=s(f),m={...j4,...h},y=r(v,m),C=a(v),x=C?t():null;super(f,!1,y,x),this._attack=e(this,C,y.attack),this._knee=e(this,C,y.knee),this._nativeDynamicsCompressorNode=y,this._ratio=e(this,C,y.ratio),this._release=e(this,C,y.release),this._threshold=e(this,C,y.threshold),c(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(f){const h=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=f,f>2)throw this._nativeDynamicsCompressorNode.channelCount=h,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(f){const h=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=f,f==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=h,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},z4=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(c,d)=>{let f=t(c);const h=Oi(f,d);if(!h){const v={attack:f.attack.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,knee:f.knee.value,ratio:f.ratio.value,release:f.release.value,threshold:f.threshold.value};f=e(d,v)}return s.set(d,f),h?(await n(d,c.attack,f.attack),await n(d,c.knee,f.knee),await n(d,c.ratio,f.ratio),await n(d,c.release,f.release),await n(d,c.threshold,f.threshold)):(await r(d,c.attack,f.attack),await r(d,c.knee,f.knee),await r(d,c.ratio,f.ratio),await r(d,c.release,f.release),await r(d,c.threshold,f.threshold)),await i(c,d,f),f};return{render(c,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):a(c,d)}}},H4=()=>new DOMException("","EncodingError"),Z4=n=>e=>new Promise((t,r)=>{if(n===null){r(new SyntaxError);return}const i=n.document.head;if(i===null)r(new SyntaxError);else{const s=n.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),c=URL.createObjectURL(a),d=n.onerror,f=()=>{n.onerror=d,URL.revokeObjectURL(c)};n.onerror=(h,v,m,y,C)=>{if(v===c||v===n.location.href&&m===1&&y===1)return f(),r(C),!1;if(d!==null)return d(h,v,m,y,C)},s.onerror=()=>{f(),r(new SyntaxError)},s.onload=()=>{f(),t()},s.src=c,s.type="module",i.appendChild(s)}}),X4=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=n(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(t,s,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,s===void 0?null:s,i)}},$4=n=>(e,t,r)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},K4=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},q4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},J4=(n,e,t,r,i,s)=>class extends n{constructor(c,d){const f=i(c),h={...q4,...d},v=r(f,h),m=s(f),y=m?t():null;super(c,!1,v,y),this._gain=e(this,m,v.gain,zi,hs)}get gain(){return this._gain}},Y4=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(c,d)=>{let f=t(c);const h=Oi(f,d);if(!h){const v={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:f.gain.value};f=e(d,v)}return s.set(d,f),h?await n(d,c.gain,f.gain):await r(d,c.gain,f.gain),await i(c,d,f),f};return{render(c,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):a(c,d)}}},Q4=(n,e)=>t=>e(n,t),e5=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},t5=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},n5=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},r5=n=>e=>n.get(e),vi=()=>new DOMException("","InvalidStateError"),i5=n=>e=>{const t=n.get(e);if(t===void 0)throw vi();return t},s5=(n,e)=>t=>{let r=n.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),n.set(t,r),r},o5=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},vg=()=>new DOMException("","InvalidAccessError"),a5=n=>{n.getFrequencyResponse=(e=>(t,r,i)=>{if(t.length!==r.length||r.length!==i.length)throw vg();return e.call(n,t,r,i)})(n.getFrequencyResponse)},c5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},l5=(n,e,t,r,i,s)=>class extends n{constructor(c,d){const f=r(c),h=i(f),v={...c5,...d},m=e(f,h?null:c.baseLatency,v),y=h?t(v.feedback,v.feedforward):null;super(c,!1,m,y),a5(m),this._nativeIIRFilterNode=m,s(this,1)}getFrequencyResponse(c,d,f){return this._nativeIIRFilterNode.getFrequencyResponse(c,d,f)}},fk=(n,e,t,r,i,s,a,c,d,f,h)=>{const v=f.length;let m=c;for(let y=0;y<v;y+=1){let C=t[0]*f[y];for(let x=1;x<i;x+=1){const b=m-x&d-1;C+=t[x]*s[b],C-=n[x]*a[b]}for(let x=i;x<r;x+=1)C+=t[x]*s[m-x&d-1];for(let x=i;x<e;x+=1)C-=n[x]*a[m-x&d-1];s[m]=f[y],a[m]=C,m=m+1&d-1,h[y]=C}return m},u5=(n,e,t,r)=>{const i=t instanceof Float64Array?t:new Float64Array(t),s=r instanceof Float64Array?r:new Float64Array(r),a=i.length,c=s.length,d=Math.min(a,c);if(i[0]!==1){for(let C=0;C<a;C+=1)s[C]/=i[0];for(let C=1;C<c;C+=1)i[C]/=i[0]}const f=32,h=new Float32Array(f),v=new Float32Array(f),m=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),y=n.numberOfChannels;for(let C=0;C<y;C+=1){const x=n.getChannelData(C),b=m.getChannelData(C);h.fill(0),v.fill(0),fk(i,a,s,c,d,h,v,0,f,x,b)}return m},d5=(n,e,t,r,i)=>(s,a)=>{const c=new WeakMap;let d=null;const f=async(h,v)=>{let m=null,y=e(h);const C=Oi(y,v);if(v.createIIRFilter===void 0?m=n(v,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):C||(y=v.createIIRFilter(a,s)),c.set(v,m===null?y:m),m!==null){if(d===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const b=new t(h.context.destination.channelCount,h.context.length,v.sampleRate);d=(async()=>{await r(h,b,b.destination);const S=await i(b);return u5(S,v,s,a)})()}const x=await d;return m.buffer=x,m.start(0),m}return await r(h,v,y),y};return{render(h,v){const m=c.get(v);return m!==void 0?Promise.resolve(m):f(h,v)}}},f5=(n,e,t,r,i,s)=>a=>(c,d)=>{const f=n.get(c);if(f===void 0){if(!a&&s(c)){const h=r(c),{outputs:v}=t(c);for(const m of v)if(hh(m)){const y=r(m[0]);e(h,y,m[1],m[2])}else{const y=i(m[0]);h.disconnect(y,m[1])}}n.set(c,d)}else n.set(c,f+d)},h5=n=>e=>n!==null&&e instanceof n,p5=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,g5=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,m5=(n,e)=>t=>n(t)||e(t),v5=n=>e=>n!==null&&e instanceof n,y5=n=>n!==null&&n.isSecureContext,C5=(n,e,t,r)=>class extends n{constructor(s,a){const c=t(s),d=e(c,a);if(r(c))throw TypeError();super(s,!0,d,null),this._nativeMediaElementAudioSourceNode=d}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},x5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},w5=(n,e,t,r)=>class extends n{constructor(s,a){const c=t(s);if(r(c))throw new TypeError;const d={...x5,...a},f=e(c,d);super(s,!1,f,null),this._nativeMediaStreamAudioDestinationNode=f}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},I5=(n,e,t,r)=>class extends n{constructor(s,a){const c=t(s),d=e(c,a);if(r(c))throw new TypeError;super(s,!0,d,null),this._nativeMediaStreamAudioSourceNode=d}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},b5=(n,e,t)=>class extends n{constructor(i,s){const a=t(i),c=e(a,s);super(i,!0,c,null)}},S5=(n,e,t,r,i,s)=>class extends t{constructor(c,d){super(c),this._nativeContext=c,ek.set(this,c),r(c)&&i.set(c,new Set),this._destination=new n(this,d),this._listener=e(this,c),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(c){const d=typeof c=="function"?s(this,c):null;this._nativeContext.onstatechange=d;const f=this._nativeContext.onstatechange;this._onstatechange=f!==null&&f===d?c:f}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},uy=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},A5=(n,e)=>(t,r,i)=>{const s=new Set;return t.connect=(a=>(c,d=0,f=0)=>{const h=s.size===0;if(e(c))return a.call(t,c,d,f),n(s,[c,d,f],v=>v[0]===c&&v[1]===d&&v[2]===f,!0),h&&r(),c;a.call(t,c,d),n(s,[c,d],v=>v[0]===c&&v[1]===d,!0),h&&r()})(t.connect),t.disconnect=(a=>(c,d,f)=>{const h=s.size>0;if(c===void 0)a.apply(t),s.clear();else if(typeof c=="number"){a.call(t,c);for(const m of s)m[1]===c&&s.delete(m)}else{e(c)?a.call(t,c,d,f):a.call(t,c,d);for(const m of s)m[0]===c&&(d===void 0||m[1]===d)&&(f===void 0||m[2]===f)&&s.delete(m)}const v=s.size===0;h&&v&&i()})(t.disconnect),t},gr=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t]&&(n[t]=r)},Jr=(n,e)=>{gr(n,e,"channelCount"),gr(n,e,"channelCountMode"),gr(n,e,"channelInterpretation")},TI=n=>typeof n.getFloatTimeDomainData=="function",k5=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const r=Math.max(t.length,n.fftSize);for(let i=0;i<r;i+=1)e[i]=(t[i]-128)*.0078125;return e}},E5=(n,e)=>(t,r)=>{const i=t.createAnalyser();if(Jr(i,r),!(r.maxDecibels>r.minDecibels))throw e();return gr(i,r,"fftSize"),gr(i,r,"maxDecibels"),gr(i,r,"minDecibels"),gr(i,r,"smoothingTimeConstant"),n(TI,()=>TI(i))||k5(i),i},T5=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,Tr=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t].value&&(n[t].value=r)},_5=n=>{n.start=(e=>{let t=!1;return(r=0,i=0,s)=>{if(t)throw vi();e.call(n,r,i,s),t=!0}})(n.start)},RC=n=>{n.start=(e=>(t=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,r,i)})(n.start)},DC=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},R5=(n,e,t,r,i,s,a,c,d,f,h)=>(v,m)=>{const y=v.createBufferSource();return Jr(y,m),Tr(y,m,"playbackRate"),gr(y,m,"buffer"),gr(y,m,"loop"),gr(y,m,"loopEnd"),gr(y,m,"loopStart"),e(t,()=>t(v))||_5(y),e(r,()=>r(v))||d(y),e(i,()=>i(v))||f(y,v),e(s,()=>s(v))||RC(y),e(a,()=>a(v))||h(y,v),e(c,()=>c(v))||DC(y),n(v,y),y},D5=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,P5=(n,e)=>(t,r,i)=>{const s=t.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const a=n(t,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(a,"channelCount",c=>()=>c.call(a),c=>d=>{c.call(a,d);try{s.channelCount=d}catch(f){if(d>s.maxChannelCount)throw f}}),e(a,"channelCountMode",c=>()=>c.call(a),c=>d=>{c.call(a,d),s.channelCountMode=d}),e(a,"channelInterpretation",c=>()=>c.call(a),c=>d=>{c.call(a,d),s.channelInterpretation=d}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a},N5=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,M5=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},B5=(n,e,t,r,i)=>(s,a,c,d,f,h)=>{if(c!==null)try{const v=new c(s,d,h),m=new Map;let y=null;if(Object.defineProperties(v,{channelCount:{get:()=>h.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>y,set:C=>{typeof y=="function"&&v.removeEventListener("processorerror",y),y=typeof C=="function"?C:null,typeof y=="function"&&v.addEventListener("processorerror",y)}}}),v.addEventListener=(C=>(...x)=>{if(x[0]==="processorerror"){const b=typeof x[1]=="function"?x[1]:typeof x[1]=="object"&&x[1]!==null&&typeof x[1].handleEvent=="function"?x[1].handleEvent:null;if(b!==null){const S=m.get(x[1]);S!==void 0?x[1]=S:(x[1]=A=>{A.type==="error"?(Object.defineProperties(A,{type:{value:"processorerror"}}),b(A)):b(new ErrorEvent(x[0],{...A}))},m.set(b,x[1]))}}return C.call(v,"error",x[1],x[2]),C.call(v,...x)})(v.addEventListener),v.removeEventListener=(C=>(...x)=>{if(x[0]==="processorerror"){const b=m.get(x[1]);b!==void 0&&(m.delete(x[1]),x[1]=b)}return C.call(v,"error",x[1],x[2]),C.call(v,x[0],x[1],x[2])})(v.removeEventListener),h.numberOfOutputs!==0){const C=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return v.connect(C).connect(s.destination),i(v,()=>C.disconnect(),()=>C.connect(s.destination))}return v}catch(v){throw v.code===11?r():v}if(f===void 0)throw r();return M5(h),e(s,a,f,h)},hk=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),O5=n=>new Promise((e,t)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),e(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),t(s)},i.postMessage(n)}),F5=async(n,e)=>{const t=await O5(e);return new n(t)},L5=(n,e,t,r)=>{let i=oy.get(n);i===void 0&&(i=new WeakMap,oy.set(n,i));const s=F5(t,r);return i.set(e,s),s},U5=(n,e,t,r,i,s,a,c,d,f,h,v,m)=>(y,C,x,b)=>{if(b.numberOfInputs===0&&b.numberOfOutputs===0)throw d();const S=Array.isArray(b.outputChannelCount)?b.outputChannelCount:Array.from(b.outputChannelCount);if(S.some(st=>st<1))throw d();if(S.length!==b.numberOfOutputs)throw e();if(b.channelCountMode!=="explicit")throw d();const A=b.channelCount*b.numberOfInputs,E=S.reduce((st,at)=>st+at,0),R=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length;if(A+R>6||E>6)throw d();const N=new MessageChannel,V=[],M=[];for(let st=0;st<b.numberOfInputs;st+=1)V.push(a(y,{channelCount:b.channelCount,channelCountMode:b.channelCountMode,channelInterpretation:b.channelInterpretation,gain:1})),M.push(i(y,{channelCount:b.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:b.channelCount}));const j=[];if(x.parameterDescriptors!==void 0)for(const{defaultValue:st,maxValue:at,minValue:zt,name:jt}of x.parameterDescriptors){const _t=s(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:b.parameterData[jt]!==void 0?b.parameterData[jt]:st===void 0?0:st});Object.defineProperties(_t.offset,{defaultValue:{get:()=>st===void 0?0:st},maxValue:{get:()=>at===void 0?zi:at},minValue:{get:()=>zt===void 0?hs:zt}}),j.push(_t)}const J=r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,A+R)}),L=hk(C,y.sampleRate),z=c(y,L,A+R,Math.max(1,E)),Y=i(y,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),ie=[];for(let st=0;st<b.numberOfOutputs;st+=1)ie.push(r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[st]}));for(let st=0;st<b.numberOfInputs;st+=1){V[st].connect(M[st]);for(let at=0;at<b.channelCount;at+=1)M[st].connect(J,at,st*b.channelCount+at)}const pe=new uk(x.parameterDescriptors===void 0?[]:x.parameterDescriptors.map(({name:st},at)=>{const zt=j[at];return zt.connect(J,0,A+at),zt.start(0),[st,zt.offset]}));J.connect(z);let xe=b.channelInterpretation,Ae=null;const Le=b.numberOfOutputs===0?[z]:ie,we={get bufferSize(){return L},get channelCount(){return b.channelCount},set channelCount(st){throw t()},get channelCountMode(){return b.channelCountMode},set channelCountMode(st){throw t()},get channelInterpretation(){return xe},set channelInterpretation(st){for(const at of V)at.channelInterpretation=st;xe=st},get context(){return z.context},get inputs(){return V},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},get onprocessorerror(){return Ae},set onprocessorerror(st){typeof Ae=="function"&&we.removeEventListener("processorerror",Ae),Ae=typeof st=="function"?st:null,typeof Ae=="function"&&we.addEventListener("processorerror",Ae)},get parameters(){return pe},get port(){return N.port2},addEventListener(...st){return z.addEventListener(st[0],st[1],st[2])},connect:n.bind(null,Le),disconnect:f.bind(null,Le),dispatchEvent(...st){return z.dispatchEvent(st[0])},removeEventListener(...st){return z.removeEventListener(st[0],st[1],st[2])}},Se=new Map;N.port1.addEventListener=(st=>(...at)=>{if(at[0]==="message"){const zt=typeof at[1]=="function"?at[1]:typeof at[1]=="object"&&at[1]!==null&&typeof at[1].handleEvent=="function"?at[1].handleEvent:null;if(zt!==null){const jt=Se.get(at[1]);jt!==void 0?at[1]=jt:(at[1]=_t=>{h(y.currentTime,y.sampleRate,()=>zt(_t))},Se.set(zt,at[1]))}}return st.call(N.port1,at[0],at[1],at[2])})(N.port1.addEventListener),N.port1.removeEventListener=(st=>(...at)=>{if(at[0]==="message"){const zt=Se.get(at[1]);zt!==void 0&&(Se.delete(at[1]),at[1]=zt)}return st.call(N.port1,at[0],at[1],at[2])})(N.port1.removeEventListener);let Ee=null;Object.defineProperty(N.port1,"onmessage",{get:()=>Ee,set:st=>{typeof Ee=="function"&&N.port1.removeEventListener("message",Ee),Ee=typeof st=="function"?st:null,typeof Ee=="function"&&(N.port1.addEventListener("message",Ee),N.port1.start())}}),x.prototype.port=N.port1;let H=null;L5(y,we,x,b).then(st=>H=st);const ce=Xp(b.numberOfInputs,b.channelCount),Ce=Xp(b.numberOfOutputs,S),_e=x.parameterDescriptors===void 0?[]:x.parameterDescriptors.reduce((st,{name:at})=>({...st,[at]:new Float32Array(128)}),{});let Ne=!0;const ft=()=>{b.numberOfOutputs>0&&z.disconnect(Y);for(let st=0,at=0;st<b.numberOfOutputs;st+=1){const zt=ie[st];for(let jt=0;jt<S[st];jt+=1)Y.disconnect(zt,at+jt,jt);at+=S[st]}},ve=new Map;z.onaudioprocess=({inputBuffer:st,outputBuffer:at})=>{if(H!==null){const zt=v(we);for(let jt=0;jt<L;jt+=128){for(let _t=0;_t<b.numberOfInputs;_t+=1)for(let Xt=0;Xt<b.channelCount;Xt+=1)Zp(st,ce[_t],Xt,Xt,jt);x.parameterDescriptors!==void 0&&x.parameterDescriptors.forEach(({name:_t},Xt)=>{Zp(st,_e,_t,A+Xt,jt)});for(let _t=0;_t<b.numberOfInputs;_t+=1)for(let Xt=0;Xt<S[_t];Xt+=1)Ce[_t][Xt].byteLength===0&&(Ce[_t][Xt]=new Float32Array(128));try{const _t=ce.map((an,ot)=>{if(zt[ot].size>0)return ve.set(ot,L/128),an;const nn=ve.get(ot);return nn===void 0?[]:(an.every(vn=>vn.every(Ln=>Ln===0))&&(nn===1?ve.delete(ot):ve.set(ot,nn-1)),an)});Ne=h(y.currentTime+jt/y.sampleRate,y.sampleRate,()=>H.process(_t,Ce,_e));for(let an=0,ot=0;an<b.numberOfOutputs;an+=1){for(let le=0;le<S[an];le+=1)dk(at,Ce[an],le,ot+le,jt);ot+=S[an]}}catch(_t){Ne=!1,we.dispatchEvent(new ErrorEvent("processorerror",{colno:_t.colno,filename:_t.filename,lineno:_t.lineno,message:_t.message}))}if(!Ne){for(let _t=0;_t<b.numberOfInputs;_t+=1){V[_t].disconnect(M[_t]);for(let Xt=0;Xt<b.channelCount;Xt+=1)M[jt].disconnect(J,Xt,_t*b.channelCount+Xt)}if(x.parameterDescriptors!==void 0){const _t=x.parameterDescriptors.length;for(let Xt=0;Xt<_t;Xt+=1){const an=j[Xt];an.disconnect(J,0,A+Xt),an.stop()}}J.disconnect(z),z.onaudioprocess=null,ct?ft():Nt();break}}}};let ct=!1;const At=a(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Wt=()=>z.connect(At).connect(y.destination),Nt=()=>{z.disconnect(At),At.disconnect()},bt=()=>{if(Ne){Nt(),b.numberOfOutputs>0&&z.connect(Y);for(let st=0,at=0;st<b.numberOfOutputs;st+=1){const zt=ie[st];for(let jt=0;jt<S[st];jt+=1)Y.connect(zt,at+jt,jt);at+=S[st]}}ct=!0},Rt=()=>{Ne&&(Wt(),ft()),ct=!1};return Wt(),m(we,bt,Rt)},pk=(n,e)=>{const t=n.createBiquadFilter();return Jr(t,e),Tr(t,e,"Q"),Tr(t,e,"detune"),Tr(t,e,"frequency"),Tr(t,e,"gain"),gr(t,e,"type"),t},G5=(n,e)=>(t,r)=>{const i=t.createChannelMerger(r.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),Jr(i,r),i},V5=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw vi()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw vi()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw vi()}})},ph=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return Jr(t,e),V5(t),t},j5=(n,e,t,r,i)=>(s,a)=>{if(s.createConstantSource===void 0)return t(s,a);const c=s.createConstantSource();return Jr(c,a),Tr(c,a,"offset"),e(r,()=>r(s))||RC(c),e(i,()=>i(s))||DC(c),n(s,c),c},bd=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),W5=(n,e,t,r)=>(i,{offset:s,...a})=>{const c=i.createBuffer(1,2,44100),d=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),f=t(i,{...a,gain:s}),h=c.getChannelData(0);h[0]=1,h[1]=1,d.buffer=c,d.loop=!0;const v={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(C){f.channelCount=C},get channelCountMode(){return f.channelCountMode},set channelCountMode(C){f.channelCountMode=C},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(C){f.channelInterpretation=C},get context(){return f.context},get inputs(){return[]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get offset(){return f.gain},get onended(){return d.onended},set onended(C){d.onended=C},addEventListener(...C){return d.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return d.dispatchEvent(C[0])},removeEventListener(...C){return d.removeEventListener(C[0],C[1],C[2])},start(C=0){d.start.call(d,C)},stop(C=0){d.stop.call(d,C)}},m=()=>d.connect(f),y=()=>d.disconnect(f);return n(i,d),r(bd(v,f),m,y)},z5=(n,e)=>(t,r)=>{const i=t.createConvolver();if(Jr(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),gr(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",s=>()=>s.call(i),s=>a=>{if(a>2)throw n();return s.call(i,a)}),r.channelCountMode==="max"))throw n();return e(i,"channelCountMode",s=>()=>s.call(i),s=>a=>{if(a==="max")throw n();return s.call(i,a)}),i},gk=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return Jr(t,e),Tr(t,e,"delayTime"),t},H5=n=>(e,t)=>{const r=e.createDynamicsCompressor();if(Jr(r,t),t.channelCount>2||t.channelCountMode==="max")throw n();return Tr(r,t,"attack"),Tr(r,t,"knee"),Tr(r,t,"ratio"),Tr(r,t,"release"),Tr(r,t,"threshold"),r},vs=(n,e)=>{const t=n.createGain();return Jr(t,e),Tr(t,e,"gain"),t},Z5=n=>(e,t,r)=>{if(e.createIIRFilter===void 0)return n(e,t,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return Jr(i,r),i};function X5(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function $5(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function _I(n,e){let t=[0,0];for(let r=n.length-1;r>=0;r-=1)t=$5(t,e),t[0]+=n[r];return t}const K5=(n,e,t,r)=>(i,s,{channelCount:a,channelCountMode:c,channelInterpretation:d,feedback:f,feedforward:h})=>{const v=hk(s,i.sampleRate),m=f instanceof Float64Array?f:new Float64Array(f),y=h instanceof Float64Array?h:new Float64Array(h),C=m.length,x=y.length,b=Math.min(C,x);if(C===0||C>20)throw r();if(m[0]===0)throw e();if(x===0||x>20)throw r();if(y[0]===0)throw e();if(m[0]!==1){for(let j=0;j<x;j+=1)y[j]/=m[0];for(let j=1;j<C;j+=1)m[j]/=m[0]}const S=t(i,v,a,a);S.channelCount=a,S.channelCountMode=c,S.channelInterpretation=d;const A=32,E=[],R=[],N=[];for(let j=0;j<a;j+=1){E.push(0);const J=new Float32Array(A),L=new Float32Array(A);J.fill(0),L.fill(0),R.push(J),N.push(L)}S.onaudioprocess=j=>{const J=j.inputBuffer,L=j.outputBuffer,z=J.numberOfChannels;for(let Y=0;Y<z;Y+=1){const ie=J.getChannelData(Y),pe=L.getChannelData(Y);E[Y]=fk(m,C,y,x,b,R[Y],N[Y],E[Y],A,ie,pe)}};const V=i.sampleRate/2;return bd({get bufferSize(){return v},get channelCount(){return S.channelCount},set channelCount(j){S.channelCount=j},get channelCountMode(){return S.channelCountMode},set channelCountMode(j){S.channelCountMode=j},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(j){S.channelInterpretation=j},get context(){return S.context},get inputs(){return[S]},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},addEventListener(...j){return S.addEventListener(j[0],j[1],j[2])},dispatchEvent(...j){return S.dispatchEvent(j[0])},getFrequencyResponse(j,J,L){if(j.length!==J.length||J.length!==L.length)throw n();const z=j.length;for(let Y=0;Y<z;Y+=1){const ie=-Math.PI*(j[Y]/V),pe=[Math.cos(ie),Math.sin(ie)],xe=_I(y,pe),Ae=_I(m,pe),Le=X5(xe,Ae);J[Y]=Math.sqrt(Le[0]*Le[0]+Le[1]*Le[1]),L[Y]=Math.atan2(Le[1],Le[0])}},removeEventListener(...j){return S.removeEventListener(j[0],j[1],j[2])}},S)},q5=(n,e)=>n.createMediaElementSource(e.mediaElement),J5=(n,e)=>{const t=n.createMediaStreamDestination();return Jr(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},Y5=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((s,a)=>s.id<a.id?-1:s.id>a.id?1:0);const r=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},Q5=(n,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=t.createMediaStreamSource(i);if(r.kind!=="audio")throw n();if(e(t))throw new TypeError;return s},eN=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,tN=(n,e,t,r,i,s)=>(a,c)=>{const d=a.createOscillator();return Jr(d,c),Tr(d,c,"detune"),Tr(d,c,"frequency"),c.periodicWave!==void 0?d.setPeriodicWave(c.periodicWave):gr(d,c,"type"),e(t,()=>t(a))||RC(d),e(r,()=>r(a))||s(d,a),e(i,()=>i(a))||DC(d),n(a,d),d},nN=n=>(e,t)=>{const r=e.createPanner();return r.orientationX===void 0?n(e,t):(Jr(r,t),Tr(r,t,"orientationX"),Tr(r,t,"orientationY"),Tr(r,t,"orientationZ"),Tr(r,t,"positionX"),Tr(r,t,"positionY"),Tr(r,t,"positionZ"),gr(r,t,"coneInnerAngle"),gr(r,t,"coneOuterAngle"),gr(r,t,"coneOuterGain"),gr(r,t,"distanceModel"),gr(r,t,"maxDistance"),gr(r,t,"panningModel"),gr(r,t,"refDistance"),gr(r,t,"rolloffFactor"),r)},rN=(n,e,t,r,i,s,a,c,d,f)=>(h,{coneInnerAngle:v,coneOuterAngle:m,coneOuterGain:y,distanceModel:C,maxDistance:x,orientationX:b,orientationY:S,orientationZ:A,panningModel:E,positionX:R,positionY:N,positionZ:V,refDistance:M,rolloffFactor:j,...J})=>{const L=h.createPanner();if(J.channelCount>2||J.channelCountMode==="max")throw a();Jr(L,J);const z={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},Y=t(h,{...z,channelInterpretation:"speakers",numberOfInputs:6}),ie=r(h,{...J,gain:1}),pe=r(h,{...z,gain:1}),xe=r(h,{...z,gain:0}),Ae=r(h,{...z,gain:0}),Le=r(h,{...z,gain:0}),we=r(h,{...z,gain:0}),Se=r(h,{...z,gain:0}),Ee=i(h,256,6,1),H=s(h,{...z,curve:new Float32Array([1,1]),oversample:"none"});let ee=[b,S,A],ce=[R,N,V];const Ce=new Float32Array(1);Ee.onaudioprocess=({inputBuffer:ve})=>{const ct=[d(ve,Ce,0),d(ve,Ce,1),d(ve,Ce,2)];ct.some((Wt,Nt)=>Wt!==ee[Nt])&&(L.setOrientation(...ct),ee=ct);const At=[d(ve,Ce,3),d(ve,Ce,4),d(ve,Ce,5)];At.some((Wt,Nt)=>Wt!==ce[Nt])&&(L.setPosition(...At),ce=At)},Object.defineProperty(xe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Ae.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Le.gain,"defaultValue",{get:()=>0}),Object.defineProperty(we.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Se.gain,"defaultValue",{get:()=>0});const _e={get bufferSize(){},get channelCount(){return L.channelCount},set channelCount(ve){if(ve>2)throw a();ie.channelCount=ve,L.channelCount=ve},get channelCountMode(){return L.channelCountMode},set channelCountMode(ve){if(ve==="max")throw a();ie.channelCountMode=ve,L.channelCountMode=ve},get channelInterpretation(){return L.channelInterpretation},set channelInterpretation(ve){ie.channelInterpretation=ve,L.channelInterpretation=ve},get coneInnerAngle(){return L.coneInnerAngle},set coneInnerAngle(ve){L.coneInnerAngle=ve},get coneOuterAngle(){return L.coneOuterAngle},set coneOuterAngle(ve){L.coneOuterAngle=ve},get coneOuterGain(){return L.coneOuterGain},set coneOuterGain(ve){if(ve<0||ve>1)throw e();L.coneOuterGain=ve},get context(){return L.context},get distanceModel(){return L.distanceModel},set distanceModel(ve){L.distanceModel=ve},get inputs(){return[ie]},get maxDistance(){return L.maxDistance},set maxDistance(ve){if(ve<0)throw new RangeError;L.maxDistance=ve},get numberOfInputs(){return L.numberOfInputs},get numberOfOutputs(){return L.numberOfOutputs},get orientationX(){return pe.gain},get orientationY(){return xe.gain},get orientationZ(){return Ae.gain},get panningModel(){return L.panningModel},set panningModel(ve){L.panningModel=ve},get positionX(){return Le.gain},get positionY(){return we.gain},get positionZ(){return Se.gain},get refDistance(){return L.refDistance},set refDistance(ve){if(ve<0)throw new RangeError;L.refDistance=ve},get rolloffFactor(){return L.rolloffFactor},set rolloffFactor(ve){if(ve<0)throw new RangeError;L.rolloffFactor=ve},addEventListener(...ve){return ie.addEventListener(ve[0],ve[1],ve[2])},dispatchEvent(...ve){return ie.dispatchEvent(ve[0])},removeEventListener(...ve){return ie.removeEventListener(ve[0],ve[1],ve[2])}};v!==_e.coneInnerAngle&&(_e.coneInnerAngle=v),m!==_e.coneOuterAngle&&(_e.coneOuterAngle=m),y!==_e.coneOuterGain&&(_e.coneOuterGain=y),C!==_e.distanceModel&&(_e.distanceModel=C),x!==_e.maxDistance&&(_e.maxDistance=x),b!==_e.orientationX.value&&(_e.orientationX.value=b),S!==_e.orientationY.value&&(_e.orientationY.value=S),A!==_e.orientationZ.value&&(_e.orientationZ.value=A),E!==_e.panningModel&&(_e.panningModel=E),R!==_e.positionX.value&&(_e.positionX.value=R),N!==_e.positionY.value&&(_e.positionY.value=N),V!==_e.positionZ.value&&(_e.positionZ.value=V),M!==_e.refDistance&&(_e.refDistance=M),j!==_e.rolloffFactor&&(_e.rolloffFactor=j),(ee[0]!==1||ee[1]!==0||ee[2]!==0)&&L.setOrientation(...ee),(ce[0]!==0||ce[1]!==0||ce[2]!==0)&&L.setPosition(...ce);const Ne=()=>{ie.connect(L),n(ie,H,0,0),H.connect(pe).connect(Y,0,0),H.connect(xe).connect(Y,0,1),H.connect(Ae).connect(Y,0,2),H.connect(Le).connect(Y,0,3),H.connect(we).connect(Y,0,4),H.connect(Se).connect(Y,0,5),Y.connect(Ee).connect(h.destination)},ft=()=>{ie.disconnect(L),c(ie,H,0,0),H.disconnect(pe),pe.disconnect(Y),H.disconnect(xe),xe.disconnect(Y),H.disconnect(Ae),Ae.disconnect(Y),H.disconnect(Le),Le.disconnect(Y),H.disconnect(we),we.disconnect(Y),H.disconnect(Se),Se.disconnect(Y),Y.disconnect(Ee),Ee.disconnect(h.destination)};return f(bd(_e,L),Ne,ft)},iN=n=>(e,{disableNormalization:t,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),a=i instanceof Float32Array?i:new Float32Array(i),c=e.createPeriodicWave(a,s,{disableNormalization:t});if(Array.from(r).length<2)throw n();return c},gh=(n,e,t,r)=>n.createScriptProcessor(e,t,r),sN=(n,e)=>(t,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,r);const s=t.createStereoPanner();return Jr(s,r),Tr(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:a=>{if(a!==i)throw e()}}),s},oN=(n,e,t,r,i,s)=>{const c=new Float32Array([1,1]),d=Math.PI/2,f={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...f,oversample:"none"},v=(C,x,b,S)=>{const A=new Float32Array(16385),E=new Float32Array(16385);for(let J=0;J<16385;J+=1){const L=J/16384*d;A[J]=Math.cos(L),E[J]=Math.sin(L)}const R=t(C,{...f,gain:0}),N=r(C,{...h,curve:A}),V=r(C,{...h,curve:c}),M=t(C,{...f,gain:0}),j=r(C,{...h,curve:E});return{connectGraph(){x.connect(R),x.connect(V.inputs===void 0?V:V.inputs[0]),x.connect(M),V.connect(b),b.connect(N.inputs===void 0?N:N.inputs[0]),b.connect(j.inputs===void 0?j:j.inputs[0]),N.connect(R.gain),j.connect(M.gain),R.connect(S,0,0),M.connect(S,0,1)},disconnectGraph(){x.disconnect(R),x.disconnect(V.inputs===void 0?V:V.inputs[0]),x.disconnect(M),V.disconnect(b),b.disconnect(N.inputs===void 0?N:N.inputs[0]),b.disconnect(j.inputs===void 0?j:j.inputs[0]),N.disconnect(R.gain),j.disconnect(M.gain),R.disconnect(S,0,0),M.disconnect(S,0,1)}}},m=(C,x,b,S)=>{const A=new Float32Array(16385),E=new Float32Array(16385),R=new Float32Array(16385),N=new Float32Array(16385),V=Math.floor(16385/2);for(let Le=0;Le<16385;Le+=1)if(Le>V){const we=(Le-V)/(16384-V)*d;A[Le]=Math.cos(we),E[Le]=Math.sin(we),R[Le]=0,N[Le]=1}else{const we=Le/(16384-V)*d;A[Le]=1,E[Le]=0,R[Le]=Math.cos(we),N[Le]=Math.sin(we)}const M=e(C,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),j=t(C,{...f,gain:0}),J=r(C,{...h,curve:A}),L=t(C,{...f,gain:0}),z=r(C,{...h,curve:E}),Y=r(C,{...h,curve:c}),ie=t(C,{...f,gain:0}),pe=r(C,{...h,curve:R}),xe=t(C,{...f,gain:0}),Ae=r(C,{...h,curve:N});return{connectGraph(){x.connect(M),x.connect(Y.inputs===void 0?Y:Y.inputs[0]),M.connect(j,0),M.connect(L,0),M.connect(ie,1),M.connect(xe,1),Y.connect(b),b.connect(J.inputs===void 0?J:J.inputs[0]),b.connect(z.inputs===void 0?z:z.inputs[0]),b.connect(pe.inputs===void 0?pe:pe.inputs[0]),b.connect(Ae.inputs===void 0?Ae:Ae.inputs[0]),J.connect(j.gain),z.connect(L.gain),pe.connect(ie.gain),Ae.connect(xe.gain),j.connect(S,0,0),ie.connect(S,0,0),L.connect(S,0,1),xe.connect(S,0,1)},disconnectGraph(){x.disconnect(M),x.disconnect(Y.inputs===void 0?Y:Y.inputs[0]),M.disconnect(j,0),M.disconnect(L,0),M.disconnect(ie,1),M.disconnect(xe,1),Y.disconnect(b),b.disconnect(J.inputs===void 0?J:J.inputs[0]),b.disconnect(z.inputs===void 0?z:z.inputs[0]),b.disconnect(pe.inputs===void 0?pe:pe.inputs[0]),b.disconnect(Ae.inputs===void 0?Ae:Ae.inputs[0]),J.disconnect(j.gain),z.disconnect(L.gain),pe.disconnect(ie.gain),Ae.disconnect(xe.gain),j.disconnect(S,0,0),ie.disconnect(S,0,0),L.disconnect(S,0,1),xe.disconnect(S,0,1)}}},y=(C,x,b,S,A)=>{if(x===1)return v(C,b,S,A);if(x===2)return m(C,b,S,A);throw i()};return(C,{channelCount:x,channelCountMode:b,pan:S,...A})=>{if(b==="max")throw i();const E=n(C,{...A,channelCount:1,channelCountMode:b,numberOfInputs:2}),R=t(C,{...A,channelCount:x,channelCountMode:b,gain:1}),N=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:S});let{connectGraph:V,disconnectGraph:M}=y(C,x,R,N,E);Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"maxValue",{get:()=>1}),Object.defineProperty(N.gain,"minValue",{get:()=>-1});const j={get bufferSize(){},get channelCount(){return R.channelCount},set channelCount(Y){R.channelCount!==Y&&(J&&M(),{connectGraph:V,disconnectGraph:M}=y(C,Y,R,N,E),J&&V()),R.channelCount=Y},get channelCountMode(){return R.channelCountMode},set channelCountMode(Y){if(Y==="clamped-max"||Y==="max")throw i();R.channelCountMode=Y},get channelInterpretation(){return R.channelInterpretation},set channelInterpretation(Y){R.channelInterpretation=Y},get context(){return R.context},get inputs(){return[R]},get numberOfInputs(){return R.numberOfInputs},get numberOfOutputs(){return R.numberOfOutputs},get pan(){return N.gain},addEventListener(...Y){return R.addEventListener(Y[0],Y[1],Y[2])},dispatchEvent(...Y){return R.dispatchEvent(Y[0])},removeEventListener(...Y){return R.removeEventListener(Y[0],Y[1],Y[2])}};let J=!1;const L=()=>{V(),J=!0},z=()=>{M(),J=!1};return s(bd(j,E),L,z)}},aN=(n,e,t,r,i,s,a)=>(c,d)=>{const f=c.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&c.createGain().gain.automationRate===void 0)return t(c,d);Jr(f,d);const h=d.curve===null||d.curve instanceof Float32Array?d.curve:new Float32Array(d.curve);if(h!==null&&h.length<2)throw e();gr(f,{curve:h},"curve"),gr(f,d,"oversample");let v=null,m=!1;return a(f,"curve",x=>()=>x.call(f),x=>b=>(x.call(f,b),m&&(r(b)&&v===null?v=n(c,f):!r(b)&&v!==null&&(v(),v=null)),b)),i(f,()=>{m=!0,r(f.curve)&&(v=n(c,f))},()=>{m=!1,v!==null&&(v(),v=null)})},cN=(n,e,t,r,i)=>(s,{curve:a,oversample:c,...d})=>{const f=s.createWaveShaper(),h=s.createWaveShaper();Jr(f,d),Jr(h,d);const v=t(s,{...d,gain:1}),m=t(s,{...d,gain:-1}),y=t(s,{...d,gain:1}),C=t(s,{...d,gain:-1});let x=null,b=!1,S=null;const A={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(N){v.channelCount=N,m.channelCount=N,f.channelCount=N,y.channelCount=N,h.channelCount=N,C.channelCount=N},get channelCountMode(){return f.channelCountMode},set channelCountMode(N){v.channelCountMode=N,m.channelCountMode=N,f.channelCountMode=N,y.channelCountMode=N,h.channelCountMode=N,C.channelCountMode=N},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(N){v.channelInterpretation=N,m.channelInterpretation=N,f.channelInterpretation=N,y.channelInterpretation=N,h.channelInterpretation=N,C.channelInterpretation=N},get context(){return f.context},get curve(){return S},set curve(N){if(N!==null&&N.length<2)throw e();if(N===null)f.curve=N,h.curve=N;else{const V=N.length,M=new Float32Array(V+2-V%2),j=new Float32Array(V+2-V%2);M[0]=N[0],j[0]=-N[V-1];const J=Math.ceil((V+1)/2),L=(V+1)/2-1;for(let z=1;z<J;z+=1){const Y=z/J*L,ie=Math.floor(Y),pe=Math.ceil(Y);M[z]=ie===pe?N[ie]:(1-(Y-ie))*N[ie]+(1-(pe-Y))*N[pe],j[z]=ie===pe?-N[V-1-ie]:-((1-(Y-ie))*N[V-1-ie])-(1-(pe-Y))*N[V-1-pe]}M[J]=V%2===1?N[J-1]:(N[J-2]+N[J-1])/2,f.curve=M,h.curve=j}S=N,b&&(r(S)&&x===null?x=n(s,v):x!==null&&(x(),x=null))},get inputs(){return[v]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get oversample(){return f.oversample},set oversample(N){f.oversample=N,h.oversample=N},addEventListener(...N){return v.addEventListener(N[0],N[1],N[2])},dispatchEvent(...N){return v.dispatchEvent(N[0])},removeEventListener(...N){return v.removeEventListener(N[0],N[1],N[2])}};a!==null&&(A.curve=a instanceof Float32Array?a:new Float32Array(a)),c!==A.oversample&&(A.oversample=c);const E=()=>{v.connect(f).connect(y),v.connect(m).connect(h).connect(C).connect(y),b=!0,r(S)&&(x=n(s,v))},R=()=>{v.disconnect(f),f.disconnect(y),v.disconnect(m),m.disconnect(h),h.disconnect(C),C.disconnect(y),b=!1,x!==null&&(x(),x=null)};return i(bd(A,y),E,R)},ys=()=>new DOMException("","NotSupportedError"),lN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},uN=(n,e,t,r,i,s,a)=>class extends n{constructor(d,f){const h=i(d),v={...lN,...f},m=t(h,v),y=s(h),C=y?r():null,x=d.sampleRate/2;super(d,!1,m,C),this._detune=e(this,y,m.detune,153600,-153600),this._frequency=e(this,y,m.frequency,x,-x),this._nativeOscillatorNode=m,this._onended=null,this._oscillatorNodeRenderer=C,this._oscillatorNodeRenderer!==null&&v.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=v.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(d){const f=typeof d=="function"?a(this,d):null;this._nativeOscillatorNode.onended=f;const h=this._nativeOscillatorNode.onended;this._onended=h!==null&&h===f?d:h}get type(){return this._nativeOscillatorNode.type}set type(d){this._nativeOscillatorNode.type=d,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(d){this._nativeOscillatorNode.setPeriodicWave(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=d)}start(d=0){if(this._nativeOscillatorNode.start(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=d),this.context.state!=="closed"){pd(this);const f=()=>{this._nativeOscillatorNode.removeEventListener("ended",f),wc(this)&&dh(this)};this._nativeOscillatorNode.addEventListener("ended",f)}}stop(d=0){this._nativeOscillatorNode.stop(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=d)}},dN=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,c=null,d=null;const f=async(h,v)=>{let m=t(h);const y=Oi(m,v);if(!y){const C={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,detune:m.detune.value,frequency:m.frequency.value,periodicWave:a===null?void 0:a,type:m.type};m=e(v,C),c!==null&&m.start(c),d!==null&&m.stop(d)}return s.set(v,m),y?(await n(v,h.detune,m.detune),await n(v,h.frequency,m.frequency)):(await r(v,h.detune,m.detune),await r(v,h.frequency,m.frequency)),await i(h,v,m),m};return{set periodicWave(h){a=h},set start(h){c=h},set stop(h){d=h},render(h,v){const m=s.get(v);return m!==void 0?Promise.resolve(m):f(h,v)}}},fN={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},hN=(n,e,t,r,i,s,a)=>class extends n{constructor(d,f){const h=i(d),v={...fN,...f},m=t(h,v),y=s(h),C=y?r():null;super(d,!1,m,C),this._nativePannerNode=m,this._orientationX=e(this,y,m.orientationX,zi,hs),this._orientationY=e(this,y,m.orientationY,zi,hs),this._orientationZ=e(this,y,m.orientationZ,zi,hs),this._positionX=e(this,y,m.positionX,zi,hs),this._positionY=e(this,y,m.positionY,zi,hs),this._positionZ=e(this,y,m.positionZ,zi,hs),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(d){this._nativePannerNode.coneInnerAngle=d}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(d){this._nativePannerNode.coneOuterAngle=d}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(d){this._nativePannerNode.coneOuterGain=d}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(d){this._nativePannerNode.distanceModel=d}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(d){this._nativePannerNode.maxDistance=d}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(d){this._nativePannerNode.panningModel=d}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(d){this._nativePannerNode.refDistance=d}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(d){this._nativePannerNode.rolloffFactor=d}},pN=(n,e,t,r,i,s,a,c,d,f)=>()=>{const h=new WeakMap;let v=null;const m=async(y,C)=>{let x=null,b=s(y);const S={channelCount:b.channelCount,channelCountMode:b.channelCountMode,channelInterpretation:b.channelInterpretation},A={...S,coneInnerAngle:b.coneInnerAngle,coneOuterAngle:b.coneOuterAngle,coneOuterGain:b.coneOuterGain,distanceModel:b.distanceModel,maxDistance:b.maxDistance,panningModel:b.panningModel,refDistance:b.refDistance,rolloffFactor:b.rolloffFactor},E=Oi(b,C);if("bufferSize"in b)x=r(C,{...S,gain:1});else if(!E){const R={...A,orientationX:b.orientationX.value,orientationY:b.orientationY.value,orientationZ:b.orientationZ.value,positionX:b.positionX.value,positionY:b.positionY.value,positionZ:b.positionZ.value};b=i(C,R)}if(h.set(C,x===null?b:x),x!==null){if(v===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const z=new a(6,y.context.length,C.sampleRate),Y=e(z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});Y.connect(z.destination),v=(async()=>{const ie=await Promise.all([y.orientationX,y.orientationY,y.orientationZ,y.positionX,y.positionY,y.positionZ].map(async(pe,xe)=>{const Ae=t(z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:xe===0?1:0});return await c(z,pe,Ae.offset),Ae}));for(let pe=0;pe<6;pe+=1)ie[pe].connect(Y,0,pe),ie[pe].start(0);return f(z)})()}const R=await v,N=r(C,{...S,gain:1});await d(y,C,N);const V=[];for(let z=0;z<R.numberOfChannels;z+=1)V.push(R.getChannelData(z));let M=[V[0][0],V[1][0],V[2][0]],j=[V[3][0],V[4][0],V[5][0]],J=r(C,{...S,gain:1}),L=i(C,{...A,orientationX:M[0],orientationY:M[1],orientationZ:M[2],positionX:j[0],positionY:j[1],positionZ:j[2]});N.connect(J).connect(L.inputs[0]),L.connect(x);for(let z=128;z<R.length;z+=128){const Y=[V[0][z],V[1][z],V[2][z]],ie=[V[3][z],V[4][z],V[5][z]];if(Y.some((pe,xe)=>pe!==M[xe])||ie.some((pe,xe)=>pe!==j[xe])){M=Y,j=ie;const pe=z/C.sampleRate;J.gain.setValueAtTime(0,pe),J=r(C,{...S,gain:0}),L=i(C,{...A,orientationX:M[0],orientationY:M[1],orientationZ:M[2],positionX:j[0],positionY:j[1],positionZ:j[2]}),J.gain.setValueAtTime(1,pe),N.connect(J).connect(L.inputs[0]),L.connect(x)}}return x}return E?(await n(C,y.orientationX,b.orientationX),await n(C,y.orientationY,b.orientationY),await n(C,y.orientationZ,b.orientationZ),await n(C,y.positionX,b.positionX),await n(C,y.positionY,b.positionY),await n(C,y.positionZ,b.positionZ)):(await c(C,y.orientationX,b.orientationX),await c(C,y.orientationY,b.orientationY),await c(C,y.orientationZ,b.orientationZ),await c(C,y.positionX,b.positionX),await c(C,y.positionY,b.positionY),await c(C,y.positionZ,b.positionZ)),Id(b)?await d(y,C,b.inputs[0]):await d(y,C,b),b};return{render(y,C){const x=h.get(C);return x!==void 0?Promise.resolve(x):m(y,C)}}},gN={disableNormalization:!1},mN=(n,e,t,r)=>class mk{constructor(s,a){const c=e(s),d=r({...gN,...a}),f=n(c,d);return t.add(f),f}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===mk.prototype||t.has(s)}},vN=(n,e)=>(t,r,i)=>(n(r).replay(i),e(r,t,i)),yN=(n,e,t)=>async(r,i,s)=>{const a=n(r);await Promise.all(a.activeInputs.map((c,d)=>Array.from(c).map(async([f,h])=>{const m=await e(f).render(f,i),y=r.context.destination;!t(f)&&(r!==y||!t(r))&&m.connect(s,h,d)})).reduce((c,d)=>[...c,...d],[]))},CN=(n,e,t)=>async(r,i,s)=>{const a=e(r);await Promise.all(Array.from(a.activeInputs).map(async([c,d])=>{const h=await n(c).render(c,i);t(c)||h.connect(s,d)}))},xN=(n,e,t,r)=>i=>n(uy,()=>uy(i))?Promise.resolve(n(r,r)).then(s=>{if(!s){const a=t(i,512,0,1);i.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>i.currentTime,a.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const a=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=c=>{a.disconnect(),s(c.renderedBuffer)},a.connect(i.destination),i.startRendering()}),wN=n=>(e,t)=>{n.set(e,t)},IN=n=>(e,t)=>n.set(e,t),bN={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},SN=(n,e,t,r,i,s)=>class extends n{constructor(c,d){const f=i(c),h={...bN,...d},v=t(f,h),m=s(f),y=m?r():null;super(c,!1,v,y),this._pan=e(this,m,v.pan)}get pan(){return this._pan}},AN=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(c,d)=>{let f=t(c);const h=Oi(f,d);if(!h){const v={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,pan:f.pan.value};f=e(d,v)}return s.set(d,f),h?await n(d,c.pan,f.pan):await r(d,c.pan,f.pan),Id(f)?await i(c,d,f.inputs[0]):await i(c,d,f),f};return{render(c,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):a(c,d)}}},kN=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},EN=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(t);let s=!1,a=!1;try{await r.audioWorklet.addModule(i);const c=new n(r,"a",{numberOfOutputs:0}),d=r.createOscillator();c.port.onmessage=()=>s=!0,c.onprocessorerror=()=>a=!0,d.connect(c),d.start(0),await r.startRendering(),await new Promise(f=>setTimeout(f))}catch{}finally{URL.revokeObjectURL(i)}return s&&!a},TN=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{r.disconnect(),i(t.currentTime!==0)},t.startRendering()})},_N=()=>new DOMException("","UnknownError"),RN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},DN=(n,e,t,r,i,s,a)=>class extends n{constructor(d,f){const h=i(d),v={...RN,...f},m=t(h,v),C=s(h)?r():null;super(d,!0,m,C),this._isCurveNullified=!1,this._nativeWaveShaperNode=m,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(d){if(d===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(d.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=d}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(d){this._nativeWaveShaperNode.oversample=d}},PN=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let c=e(s);if(!Oi(c,a)){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,curve:c.curve,oversample:c.oversample};c=n(a,f)}return r.set(a,c),Id(c)?await t(s,a,c.inputs[0]):await t(s,a,c),c};return{render(s,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):i(s,a)}}},NN=()=>typeof window>"u"?null:window,MN=(n,e)=>t=>{t.copyFromChannel=(r,i,s=0)=>{const a=n(s),c=n(i);if(c>=t.numberOfChannels)throw e();const d=t.length,f=t.getChannelData(c),h=r.length;for(let v=a<0?-a:0;v+a<d&&v<h;v+=1)r[v]=f[v+a]},t.copyToChannel=(r,i,s=0)=>{const a=n(s),c=n(i);if(c>=t.numberOfChannels)throw e();const d=t.length,f=t.getChannelData(c),h=r.length;for(let v=a<0?-a:0;v+a<d&&v<h;v+=1)f[v+a]=r[v]}},BN=n=>e=>{e.copyFromChannel=(t=>(r,i,s=0)=>{const a=n(s),c=n(i);if(a<e.length)return t.call(e,r,c,a)})(e.copyFromChannel),e.copyToChannel=(t=>(r,i,s=0)=>{const a=n(s),c=n(i);if(a<e.length)return t.call(e,r,c,a)})(e.copyToChannel)},ON=n=>(e,t)=>{const r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),n(e,"buffer",i=>()=>{const s=i.call(e);return s===r?null:s},i=>s=>i.call(e,s===null?r:s))},FN=(n,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(r,()=>{const c=r.numberOfInputs;for(let d=0;d<c;d+=1)i.connect(r,0,d)},()=>i.disconnect(r))},vk=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),yk=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},mh=(n,e,t,r)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:a}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(s),set:r(a)})},LN=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),UN=n=>({...n,channelCount:n.numberOfOutputs}),GN=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},Ck=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;Ck(n,e,t+1e-7)}},VN=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},jN=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},WN=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},PC=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},xk=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},NC=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},zN=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},HN=n=>{n.start=(e=>(t=0,r=0,i)=>{const s=n.buffer,a=s===null?r:Math.min(s.duration,r);s!==null&&a>s.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,a,i)})(n.start)},wk=(n,e)=>{const t=e.createGain();n.connect(t);const r=(i=>()=>{i.call(n,t),n.removeEventListener("ended",r)})(n.disconnect);n.addEventListener("ended",r),bd(n,t),n.stop=(i=>{let s=!1;return(a=0)=>{if(s)try{i.call(n,a)}catch{t.gain.setValueAtTime(0,a)}else i.call(n,a),s=!0}})(n.stop)},Sd=(n,e)=>t=>{const r={value:n};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},ZN=CP(gu),XN=AP(gu),$N=F4(mg),Ik=new WeakMap,KN=t5(Ik),Ec=p4(new Map,new WeakMap),xa=NN(),bk=E5(Ec,ba),Sk=e5(Xi),xi=yN(Xi,Sk,su),qN=RP(bk,dr,xi),er=i5(ek),xl=eN(xa),Xn=v5(xl),Ak=new WeakMap,kk=X4(Sd),vh=D5(xa),Ek=h5(vh),Tk=p5(xa),JN=g5(xa),Wf=N5(xa),Nr=n4(xP(qA),SP(ZN,XN,Wp,$N,zp,Xi,KN,uh,dr,gu,wc,su,N0),Ec,f5(iy,zp,Xi,dr,jf,wc),ba,vg,ys,N4(Wp,iy,Xi,dr,jf,er,wc,Xn),G4(Ak,Xi,Oo),kk,er,Ek,Tk,JN,Xn,Wf),YN=_P(Nr,qN,ba,bk,er,Xn),_k=new WeakSet,RI=T5(xa),Rk=E4(new Uint32Array(1)),Dk=MN(Rk,ba),Pk=BN(Rk),QN=PP(_k,Ec,ys,RI,xl,kN(RI),Dk,Pk),yg=kP(vs),Nk=CN(Sk,fh,su),Sa=w4(Nk),Ad=R5(yg,Ec,VN,jN,WN,PC,xk,NC,HN,ON(mh),wk),Aa=vN(n5(fh),Nk),eM=BP(Sa,Ad,dr,Aa,xi),Go=r4(wP(YA),Ak,QA,i4,hP,pP,gP,mP,vP,ty,$A,vh,Ck),tM=MP(Nr,eM,Go,vi,Ad,er,Xn,Sd),nM=HP(Nr,ZP,ba,vi,P5(vs,mh),er,Xn,xi),rM=h4(Sa,pk,dr,Aa,xi),mu=IN(Ik),iM=f4(Nr,Go,rM,vg,pk,er,Xn,mu),wl=A5(gu,Tk),sM=FN(vi,wl),Il=G5(vh,sM),oM=v4(Il,dr,xi),aM=m4(Nr,oM,Il,er,Xn),cM=x4(ph,dr,xi),lM=C4(Nr,cM,ph,er,Xn,UN),uM=W5(yg,Ad,vs,wl),kd=j5(yg,Ec,uM,PC,NC),dM=k4(Sa,kd,dr,Aa,xi),fM=A4(Nr,Go,dM,kd,er,Xn,Sd),Mk=z5(ys,mh),hM=R4(Mk,dr,xi),pM=_4(Nr,hM,Mk,er,Xn,mu),gM=O4(Sa,gk,dr,Aa,xi),mM=B4(Nr,Go,gM,gk,er,Xn,mu),Bk=H5(ys),vM=z4(Sa,Bk,dr,Aa,xi),yM=W4(Nr,Go,vM,Bk,ys,er,Xn,mu),CM=Y4(Sa,vs,dr,Aa,xi),xM=J4(Nr,Go,CM,vs,er,Xn),wM=K5(vg,vi,gh,ys),MC=xN(Ec,vs,gh,TN(vs,xl)),IM=d5(Ad,dr,xl,xi,MC),bM=Z5(wM),SM=l5(Nr,bM,IM,er,Xn,mu),AM=XP(Go,Il,kd,gh,ys,vk,Xn,mh),Ok=new WeakMap,kM=S5(nM,AM,kk,Xn,Ok,Sd),Fk=tN(yg,Ec,PC,xk,NC,wk),EM=dN(Sa,Fk,dr,Aa,xi),TM=uN(Nr,Go,Fk,EM,er,Xn,Sd),Lk=b4(Ad),_M=cN(Lk,vi,vs,yk,wl),Cg=aN(Lk,vi,_M,yk,wl,vh,mh),RM=rN(Wp,vi,Il,vs,gh,Cg,ys,zp,vk,wl),Uk=nN(RM),DM=pN(Sa,Il,kd,vs,Uk,dr,xl,Aa,xi,MC),PM=hN(Nr,Go,Uk,DM,er,Xn,mu),NM=iN(ba),MM=mN(NM,er,new WeakSet,GN),BM=oN(Il,ph,vs,Cg,ys,wl),Gk=sN(BM,ys),OM=AN(Sa,Gk,dr,Aa,xi),FM=SN(Nr,Go,Gk,OM,er,Xn),LM=PN(Cg,dr,xi),UM=DN(Nr,vi,Cg,LM,er,Xn,mu),Vk=y5(xa),BC=$4(xa),jk=new WeakMap,GM=s5(jk,xl),VM=Vk?bP(Ec,ys,Z4(xa),BC,K4(yP),er,GM,Xn,Wf,new WeakMap,new WeakMap,EN(Wf,xl),xa):void 0,jM=m5(Ek,Xn),WM=P4(_k,Ec,D4,H4,new WeakSet,er,jM,cy,uy,Dk,Pk),zM=u4(VM,YN,QN,tM,iM,aM,lM,fM,pM,WM,mM,yM,xM,SM,kM,TM,PM,MM,FM,UM),HM=C5(Nr,q5,er,Xn),ZM=w5(Nr,J5,er,Xn),XM=I5(Nr,Y5,er,Xn),$M=Q5(vi,Xn),KM=b5(Nr,$M,er),qM=zP(zM,vi,ys,_N,HM,ZM,XM,KM,vh),Wk=o5(Ok),JM=EP(Wk),zk=I4(ba),YM=L4(Wk),Hk=V4(ba),Zk=new WeakMap,QM=Q4(Zk,Oo),eB=U5(zk,ba,vi,Il,ph,kd,vs,gh,ys,Hk,BC,QM,wl),tB=B5(vi,eB,vs,ys,wl),nB=l4(Sa,zk,Ad,Il,ph,kd,vs,YM,Hk,BC,dr,Wf,xl,Aa,xi,MC),rB=r5(jk),iB=wN(Zk),DI=Vk?o4(JM,Nr,Go,nB,tB,Xi,rB,er,Xn,Wf,LN,iB,zN,Sd):void 0,sB="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";class PI{constructor(e){ae(this,"maxSize");ae(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;r!==void 0&&this.cache.delete(r)}this.cache.set(e,t)}has(e){return this.cache.has(e)}}const NI=100,Rr=class Rr{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getOrCreatePendingRequest(e,t){let r=this.pendingRequests.get(e);if(!r){const i=(async()=>{try{const s=await t();if(s===void 0)throw new Error("Failed to create audio buffer.");return s}finally{this.pendingRequests.delete(e)}})();return this.pendingRequests.set(e,i),i}return r}static async updateMetadata(e,t,r){const i={url:t,timestamp:Date.now(),...r};await e.put(`${t}:meta`,new Response(JSON.stringify(i),{headers:{"Content-Type":"application/json"}}))}static async getBufferFromCache(e,t){try{const r=await t.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,t,r,i){const s=new Headers;r&&s.append("If-None-Match",r),i&&s.append("If-Modified-Since",i);const a=await fetch(e,{headers:s});if(a.status===304){const c=await t.match(e);if(c){const d=Date.now();return await this.updateMetadata(t,e,{timestamp:d,etag:r,lastModified:i}),await c.arrayBuffer()}else{console.warn(`Cache inconsistency detected for ${e}: 304 response but no cached body. Re-fetching.`);const d=await fetch(e);if(d.status===200){const f=d.clone(),h=d.headers.get("ETag"),v=d.headers.get("Last-Modified");try{await Promise.all([t.put(e,f),this.updateMetadata(t,e,{timestamp:Date.now(),etag:h||void 0,lastModified:v||void 0})])}catch(m){throw await t.delete(e),await t.delete(`${e}:meta`),m}return await d.arrayBuffer()}else throw new Error(`Failed to fetch resource after cache inconsistency: ${d.status} ${d.statusText}`)}}if(a.status===200){const c=a.clone(),d=a.headers.get("ETag"),f=a.headers.get("Last-Modified");try{await Promise.all([t.put(e,c),this.updateMetadata(t,e,{timestamp:Date.now(),etag:d||void 0,lastModified:f||void 0})])}catch(h){throw await t.delete(e),await t.delete(`${e}:meta`),h}}return await a.arrayBuffer()}static async decodeAudioData(e,t){try{return await e.decodeAudioData(t)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,t){try{const r=await t.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}async getAudioBuffer(e,t){if(Rr.decodedBuffers.has(t))return Rr.decodedBuffers.get(t);if(t.startsWith("data:")){const a=t.split(",")[1],c=Uint8Array.from(atob(a),f=>f.charCodeAt(0)).buffer,d=await Rr.decodeAudioData(e,c);return Rr.decodedBuffers.set(t,d),d}const r=await Rr.openCache(),i=await Rr.getMetadataFromCache(t,r),s=!i||i.etag||i.lastModified||Date.now()-i.timestamp>Rr.cacheExpirationTime;return Rr.getOrCreatePendingRequest(t,async()=>{if(s){const a=await Rr.fetchAndCacheBuffer(t,r,i==null?void 0:i.etag,i==null?void 0:i.lastModified),c=await Rr.decodeAudioData(e,a);return Rr.decodedBuffers.set(t,c),c}else{const a=await Rr.getBufferFromCache(t,r);if(a){const c=await Rr.decodeAudioData(e,a);return Rr.decodedBuffers.set(t,c),c}}})}clearMemoryCache(){Rr.decodedBuffers=new PI(NI),Rr.pendingRequests.clear()}};ae(Rr,"pendingRequests",new Map),ae(Rr,"decodedBuffers",new PI(NI)),ae(Rr,"cacheExpirationTime",24*60*60*1e3);let dy=Rr;class MI{constructor(e=[]){ae(this,"_position",[0,0,0]);ae(this,"loopCount",0);ae(this,"playIndex",0);this.sounds=e}preplayRandom(){if(this.sounds.length===0)return;const e=this.randomSound().preplay();return e.length>0?e[0]:void 0}playRandom(){const e=this.preplayRandom();return e&&e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)return;const t=this.sounds[this.playIndex].preplay();if(t.length!==0)return this.playIndex=(this.playIndex+1)%this.sounds.length,!e&&this.playIndex===0&&(this.playIndex=this.sounds.length),t[0]}playOrdered(e=!0){const t=this.preplayOrdered(e);return t&&t.play(),t}get duration(){return this.sounds.map(e=>e.duration).reduce((e,t)=>Math.max(e,t),0)}seek(e){this.sounds.forEach(t=>t.seek&&t.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.map(e=>e.preplay()).flat()}play(){const e=[];return this.preplay().forEach(t=>{t.play(),e.push(t)}),e}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(t=>t.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(t=>t.addFilter(e))}removeFilter(e){this.sounds.forEach(t=>t.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(t=>t.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,t)=>e+t,0)/this.sounds.length}set volume(e){this.sounds.forEach(t=>t.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(t=>t.playbackRate=e)}}class Ed{constructor(){ae(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(t=>t.frequency.value!==e.frequency.value&&t.type!==e.type&&t.Q.value!==e.Q.value&&t.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((t,r)=>(t.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(t=>this.addFilter(t))}removeFilters(e){e.forEach(t=>this.removeFilter(t))}}let oB=class extends Ed{constructor(t,r,i,s=0){super();ae(this,"context");ae(this,"source");ae(this,"gainNode");ae(this,"panner");this.source=t,this.gainNode=r,this.context=i,this.panner=i.createPanner(),t.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(t){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=t}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!0)}addFilter(t){super.addFilter(t),this.refreshFilters()}removeFilter(t){super.removeFilter(t),this.refreshFilters()}set position(t){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=t;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=s}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.source;this.source.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(t){}};class aB extends Ed{constructor(t){super();ae(this,"context");ae(this,"_position",[0,0,0]);ae(this,"loopCount",0);ae(this,"prevVolume",1);ae(this,"microphoneGainNode");ae(this,"streamPlayback");ae(this,"stream");ae(this,"streamSource");this.context=t,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{this.stream=t,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new oB(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(t=>{console.error("Error initializing microphone stream:",t)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(t){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(t){this.streamPlayback&&this.streamPlayback.addFilter(t)}removeFilter(t){this.streamPlayback&&this.streamPlayback.removeFilter(t)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(t){this.streamPlayback&&(this.streamPlayback.volume=t)}get position(){return[0,0,0]}set position(t){}loop(t){return 0}get playbackRate(){return 1}set playbackRate(t){}}function Xk(n){class e extends n{constructor(){super(...arguments);ae(this,"playbacks",[]);ae(this,"_position",[0,0,0]);ae(this,"_stereoPan",0);ae(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});ae(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(s=>s.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(s=>s.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(s=>s.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(s=>s.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(s=>s.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(s=>s.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(s=>s.volume=i)}}return e}function $k(n){class e extends n{constructor(){super(...arguments);ae(this,"panner");ae(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,s){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=s.createStereoPanner():this.panner=s.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=BI(i,-1,1),this.panner.pan.setValueAtTime(BI(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const s=this.panner;s.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:s.coneInnerAngle,s.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:s.coneOuterAngle,s.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:s.coneOuterGain,s.distanceModel=i.distanceModel||s.distanceModel,s.maxDistance=i.maxDistance!==void 0?i.maxDistance:s.maxDistance,s.channelCount=i.channelCount!==void 0?i.channelCount:s.channelCount,s.channelCountMode=i.channelCountMode||s.channelCountMode,s.channelInterpretation=i.channelInterpretation||s.channelInterpretation,s.panningModel=i.panningModel||s.panningModel,s.refDistance=i.refDistance!==void 0?i.refDistance:s.refDistance,s.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:s.rolloffFactor,s.positionX.value=i.positionX!==void 0?i.positionX:s.positionX.value,s.positionY.value=i.positionY!==void 0?i.positionY:s.positionY.value,s.positionZ.value=i.positionZ!==void 0?i.positionZ:s.positionZ.value,s.orientationX.value=i.orientationX!==void 0?i.orientationX:s.orientationX.value,s.orientationY.value=i.orientationY!==void 0?i.orientationY:s.orientationY.value,s.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:s.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[s,a,c]=i,d=this.panner;d.positionX.value=s,d.positionY.value=a,d.positionZ.value=c}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function BI(n,e,t){return Math.min(Math.max(n,e),t)}function Kk(n){class e extends n{constructor(){super(...arguments);ae(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}class qk extends $k(Kk(Ed)){constructor(){super(...arguments);ae(this,"source");ae(this,"_playing",!1);ae(this,"origin")}get isPlaying(){return this.source?this._playing:!1}}class OC extends qk{constructor(t,r,i){super();ae(this,"context");ae(this,"loopCount",0);ae(this,"currentLoop",0);ae(this,"buffer");ae(this,"_offset",0);ae(this,"_startTime",0);ae(this,"_state",0);ae(this,"_playbackRate",1);ae(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():this.play()))});this.origin=t,this.context=t.context,this.loopCount=t.loopCount,this.setPanType(t.panType,t.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(t){if("mediaElement"in t&&t.mediaElement)t.mediaElement.onended=this.loopEnded;else if("onended"in t)t.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(t){if(t<=0)throw new Error("Playback rate must be greater than 0");if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=t,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=t))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const t=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=t,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(t){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(t)||t<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=t,"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.currentTime=t),r&&this.play()}get currentTime(){if(this._state===1){const t=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+t}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&(!("mediaElement"in this.source)&&"onended"in this.source&&(this.source.onended=null),this.source.disconnect()),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(t){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=t)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(t=>{t&&t.disconnect()}),this._filters=[]}loop(t){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(t!==void 0&&(this.loopCount=t==="infinite"?"infinite":Math.max(0,t),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(t){const r=this.context.createBiquadFilter();r.type=t.type,r.frequency.value=t.frequency.value,r.Q.value=t.Q.value,r.gain.value=t.gain.value,this._filters.push(r),this.refreshFilters()}removeFilter(t){const r=this._filters.indexOf(t);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}clone(t={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=t.panType||this.panType,i=this.context.createGain();let s;if("buffer"in this.source&&this.source.buffer)s=this.context.createBufferSource(),s.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)s=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const a=t.loopCount!==void 0?t.loopCount:this.loopCount,c=new OC(this.origin,s,i);return c.loopCount=a,c.currentLoop=this.currentLoop,c.setPanType(r,this.context),c.volume=this.volume,c.playbackRate=this._playbackRate,c._offset=this._offset,c._state=this._state,this._filters.forEach(d=>{const f=this.context.createBiquadFilter();f.type=d.type,f.frequency.value=d.frequency.value,f.Q.value=d.Q.value,f.gain.value=d.gain.value,c.addFilter(f)}),this._state===1&&c.play(),c}}let x0=class Jk extends Xk(Ed){constructor(t,r,i,s,a=zf.Buffer,c="HRTF"){super();ae(this,"buffer");ae(this,"context");ae(this,"loopCount",0);ae(this,"_playbackRate",1);this.url=t,this.globalGainNode=s,this.soundType=a,this.panType=c,this.buffer=r,this.context=i}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan,s=t.threeDOptions||this.threeDOptions,a=t.loopCount!==void 0?t.loopCount:this.loopCount,c=t.playbackRate||this.playbackRate,d=t.volume!==void 0?t.volume:this.volume,f=t.position!==void 0?t.position:this.position,h=t.filters&&t.filters.length?t.filters:this._filters,v=new Jk(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return v.loop(a),v.playbackRate=c,v.volume=d,r==="HRTF"?(v.threeDOptions=s,v.position=f):v.stereoPan=i,v.addFilters(h),v}preplay(){let t;if(this.buffer)t=this.context.createBufferSource(),t.buffer=this.buffer;else{const s=new Audio;s.crossOrigin="anonymous",s.src=this.url,s.preload="auto",t=this.context.createMediaElementSource(s)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new OC(this,t,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(s=>i.addFilter(s)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(t){this.playbacks.forEach(r=>r.seek(t))}get duration(){var t;return this.playbacks.length>0?this.playbacks[0].duration:((t=this.buffer)==null?void 0:t.duration)||NaN}loop(t){return t===void 0?this.loopCount:(this.loopCount=t,this.playbacks.forEach(r=>r.loop(t)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.playbacks.forEach(r=>r.playbackRate=t)}};function cB(n){class e extends qk{constructor(){super(...arguments);ae(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}class lB extends cB($k(Kk(Ed))){constructor(t,r,i){super();ae(this,"context");this.origin=t,this.source=r,this.context=t.context,this.setPanType(t.panType,t.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}}class FC extends Xk(Ed){constructor(t,r,i=zf.Oscillator,s="HRTF",a={}){super();ae(this,"_oscillatorOptions");ae(this,"playbacks",[]);this.context=t,this.globalGainNode=r,this.soundType=i,this.panType=s,this.context=t,this._oscillatorOptions=a}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan??0,s=t.threeDOptions||this.threeDOptions,a=t.volume!==void 0?t.volume:this.volume,c=t.position&&t.position.length?t.position:this.position,d=t.filters&&t.filters.length?t.filters:this._filters,f=t.oscillatorOptions||this._oscillatorOptions,h=new FC(this.context,this.globalGainNode,this.soundType,r,f);return h._volume=a,h._position=c,h._stereoPan=i,h._threeDOptions=s,h.addFilters(d),h}preplay(){const t=this.context.createOscillator();this.oscillatorOptions.detune&&(t.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(t.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(t.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new lB(this,t,r);return i.volume=this.volume,this._filters.forEach(s=>i.addFilter(s)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(t){this._oscillatorOptions=t,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(t){this._oscillatorOptions.frequency=t,this.playbacks.forEach(r=>r.frequency=t)}get detune(){return this.oscillatorOptions.detune}set detune(t){this._oscillatorOptions.detune=t,this.playbacks.forEach(r=>r.detune=t)}get type(){return this.oscillatorOptions.type||"sine"}set type(t){this._oscillatorOptions.type=t,this.playbacks.forEach(r=>r.type=t)}}var zf=(n=>(n.HTML="HTML",n.Streaming="Streaming",n.Buffer="Buffer",n.Oscillator="oscillator",n))(zf||{});class uB{constructor(e,t){ae(this,"context");ae(this,"globalGainNode");ae(this,"listener");ae(this,"prevVolume",1);ae(this,"finalizationRegistry");ae(this,"cache");ae(this,"createBiquadFilter",({type:e,frequency:t,gain:r,Q:i})=>{t===void 0&&(t=350);const s=this.context.createBiquadFilter();return s.type=e||"lowpass",s.frequency.value=t,s.gain.value=r||0,s.Q.value=i||1,s});this.context=e||new qM,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.cache=t||new dy,this.finalizationRegistry=new FinalizationRegistry(r=>{r.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",sB):console.warn("AudioWorklet not supported")}async createWorkletNode(e,t){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new DI(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",t);try{await this.context.audioWorklet.addModule(t)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${t}`)}return new DI(this.context,e)}}clearMemoryCache(){this.cache.clearMemoryCache()}createOscillator(e,t="HRTF"){return new FC(this.context,this.globalGainNode,"oscillator",t,e)}async createSound(e,t="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new x0("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(t==="HTML"){const s=new Audio;return s.src=i,s.crossOrigin="anonymous",new x0(i,void 0,this.context,this.globalGainNode,"HTML",r)}return this.cache.getAudioBuffer(this.context,i).then(s=>new x0(i,s,this.context,this.globalGainNode,t,r))}async createGroup(e){const t=new MI;return e.forEach(r=>t.addSound(r)),t}async createGroupFromUrls(e,t="Buffer",r="HRTF"){const i=new MI;return(await Promise.all(e.map(s=>this.createSound(s,t,r)))).forEach(s=>i.addSound(s)),i}async createStream(e){return new x0(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:t,coneOuterGain:r,distanceModel:i,maxDistance:s,channelCount:a,channelCountMode:c,channelInterpretation:d,panningModel:f,refDistance:h,rolloffFactor:v,positionX:m,positionY:y,positionZ:C,orientationX:x,orientationY:b,orientationZ:S}){const A=this.context.createPanner();return A.coneInnerAngle=e||360,A.coneOuterAngle=t||360,A.coneOuterGain=r||0,A.distanceModel=i||"inverse",A.maxDistance=s||1e4,A.channelCount=a||2,A.channelCountMode=c||"clamped-max",A.channelInterpretation=d||"speakers",A.panningModel=f||"HRTF",A.refDistance=h||1,A.rolloffFactor=v||1,A.positionX.value=m||0,A.positionY.value=y||0,A.positionZ.value=C||0,A.orientationX.value=x||0,A.orientationY.value=b||0,A.orientationZ.value=S||0,A}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new aB(this.context);i.play(),e(i)}).catch(r=>{t(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:t,up:r}=e,[i,s,a]=t,[c,d,f]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=s,this.listener.forwardZ.value=a,this.listener.upX.value=c,this.listener.upY.value=d,this.listener.upZ.value=f}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[t,r,i]=e;this.listener.upX.value=t,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[t,r,i]=e;this.listener.forwardX.value=t,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[t,r,i]=e,s=this.context.currentTime;this.listener.positionX.setValueAtTime(t,s),this.listener.positionY.setValueAtTime(r,s),this.listener.positionZ.setValueAtTime(i,s)}}const dB="https://mongoose.world:9080/?url=";class fB extends tr{constructor(){super(...arguments);ae(this,"packageName","Client.Media");ae(this,"sounds",{});ae(this,"defaultUrl","")}handleDefault(t){this.defaultUrl=t}async handleLoad(t){const r=(t.url||this.defaultUrl)+t.name,i=t.url+t.name;if(!this.sounds[i]){let a=await this.client.cacophony.createSound(r);a.key=i,this.sounds[i]=a}}mediaUrl(t){var i;let r=(t.url||this.defaultUrl)+t.name;return((i=t.type)==null?void 0:i.toLowerCase())==="music"&&(r=dB+encodeURIComponent(r)),r}async handlePlay(t){let r=this.mediaUrl(t);t.key=t.key||r;let i=this.sounds[t.key];const s=t.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(t.type==="music"?i=await this.client.cacophony.createSound(r,zf.HTML,s):i=await this.client.cacophony.createSound(r,zf.Buffer,s)),t.volume!==void 0&&(i.volume=t.volume/100),t.loops!==void 0){const a=t.loops===-1?1/0:t.loops-1;i.loop(a)}if(t.start&&i.seek(t.start/1e3),t.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},t.end),t.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[t.position[0],t.position[1],t.position[2]]),t.priority){for(let a in this.sounds){const c=this.sounds[a];c.priority&&c.priority<t.priority&&c.stop()}i.priority=t.priority}i.isPlaying||(i.play()[0],t.fadein,t.fadeout),i.key=t.key,this.sounds[i.key]=i}handleStop(t){t.name&&this.soundsByName(t.name).forEach(r=>this.stopSound(r)),t.type&&this.soundsByType(t.type).forEach(r=>this.stopSound(r)),t.tag&&this.soundsByTag(t.tag).forEach(r=>this.stopSound(r)),t.key&&this.soundsByKey(t.key).forEach(r=>this.stopSound(r)),!t.name&&!t.type&&!t.tag&&!t.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(t){delete this.sounds[t.key],t.stop()}handleListenerPosition(t){var r;(r=t.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=t.position)}handleListenerOrientation(t){t.up&&t.up.length&&(this.client.cacophony.listenerUpOrientation=t.up),t.forward&&t.forward.length&&(this.client.cacophony.listenerForwardOrientation=t.forward)}soundsByName(t){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(t))}soundsByKey(t){return Object.values(this.sounds).filter(r=>r.key===t)}soundsByTag(t){return Object.values(this.sounds).filter(r=>r.tag===t)}soundsByType(t){return Object.values(this.sounds).filter(r=>r.mediaType===t)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(t=>t.stop()),this.sounds={}}}var M0={exports:{}},fv,OI;function hB(){return OI||(OI=1,fv=void 0),fv}var pB=M0.exports,FI;function gB(){return FI||(FI=1,function(n,e){(function(t,r){n.exports=r()})(pB,function(){var t=typeof window>"u"?R0:window,r="1.9.3",i,s,a,c,d,f=Date.now||function(){return new Date().getTime()},h=f(),v=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return f()-h},m=function(l){setTimeout(l,0)};function y(){}function C(l){return typeof l=="function"}function x(){this._orig=this,this._ready=!1,this._queue=[],this._log=[]}x.prototype._exec=function(){for(;this._ready&&this._queue.length;){var l=this._queue.shift();l[0].apply(this,l[1])}},x.prototype._push=function(l,p){this._queue.push([l,p]),x.prototype._exec.apply(this)},x.prototype._slip=function(l,p){this._queue.unshift([l,p])},x.prototype._pause=function(){this._ready=!1},x.prototype._resume=function(){this._ready=!0,x.prototype._exec.apply(this)},x.prototype._break=function(l){this._orig._bad=!0,this._orig._log.push(l||"Unknown JZZ error")},x.prototype._repair=function(){this._orig._bad=!1},x.prototype._crash=function(l){this._break(l),this._resume()},x.prototype._err=function(){return this._log[this._log.length-1]},x.prototype.log=function(){return Y(this._log)},x.prototype._dup=function(){var l=function(){};l.prototype=this._orig;var p=new l;return p._ready=!1,p._queue=[],p},x.prototype._image=function(){return this._dup()},x.prototype._thenable=function(){if(this.then)return this;var l=this,p=function(){};p.prototype=l;var I=new p;return I.then=function(O,W){return l._push(b,[O,W]),this},I};function b(l,p){this._bad?C(p)&&p.apply(this,[new Error(this._err())]):C(l)&&l.apply(this,[this])}function S(l,p){this._bad?l._crash(this._err()):setTimeout(function(){l._resume()},p)}x.prototype.wait=function(l){if(!l)return this;var p=this._image();return this._push(S,[p,l]),p._thenable()};function A(l){this._bad&&l._break(this._err()),l._resume()}function E(l,p,I){l[I]=function(){var O=arguments,W=p._image();return this._push(A,[W]),W[I].apply(W,O)}}function R(l){this._bad||(C(l)?l.apply(this):console.log(l))}x.prototype.and=function(l){return this._push(R,[l]),this._thenable()};function N(l){this._bad&&(C(l)?l.apply(this):console.log(l))}x.prototype.or=function(l){return this._push(N,[l]),this._thenable()},x.prototype._info={},x.prototype.info=function(){var l=Y(this._orig._info);return typeof l.engine>"u"&&(l.engine="none"),typeof l.sysex>"u"&&(l.sysex=!0),l},x.prototype.name=function(){return this.info().name};function V(l){this._bad?l._crash(this._err()):(this._break("Closed"),l._resume())}x.prototype.close=function(){var l=new x;return this._close&&this._push(this._close,[]),this._push(V,[l]),l._thenable()};function M(l){if(!l.length){this._break();return}var p=l.shift();if(l.length){var I=this;this._slip(N,[function(){M.apply(I,[l])}])}try{this._repair(),p.apply(this)}catch(O){this._break(O.toString())}}function j(l,p){for(var I=0;I<l.length;I++)if(l[I]===p)return;l.push(p)}function J(l,p){for(var I=0;I<l.length;I++)if(l[I]===p){l.splice(I,1);return}}function L(){x.apply(this)}L.prototype=new x;function z(l,p){for(var I in l)l.hasOwnProperty(I)&&p.call(this,I)}function Y(l,p,I){if(typeof p>"u")return Y(l,[],[]);if(l instanceof Object){for(var O=0;O<p.length;O++)if(p[O]===l)return I[O];var W;return l instanceof Array?W=[]:W={},p.push(l),I.push(W),z(l,function(oe){W[oe]=Y(l[oe],p,I)}),W}return l}L.prototype._info={name:"JZZ.js",ver:r,version:r,inputs:[],outputs:[]};var ie=[],pe=[],xe=[],Ae=[],Le={},we={};function Se(){ot._info.engine=le._type,ot._info.version=le._version,ot._info.sysex=le._sysex,ot._info.inputs=[],ot._info.outputs=[],ie=[],pe=[],le._allOuts={},le._allIns={};var l,p;for(l=0;l<le._outs.length;l++)p=le._outs[l],!Le[p.name]&&(p.engine=le,le._allOuts[p.name]=p,ot._info.outputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:le._type}),ie.push(p));for(l=0;l<nn._outs.length;l++)p=nn._outs[l],!Le[p.name]&&(ot._info.outputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:p.type}),ie.push(p));for(l=0;l<le._ins.length;l++)p=le._ins[l],!we[p.name]&&(p.engine=le,le._allIns[p.name]=p,ot._info.inputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:le._type}),pe.push(p));for(l=0;l<nn._ins.length;l++)p=nn._ins[l],!we[p.name]&&(ot._info.inputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:p.type}),pe.push(p));if(ot._watcher&&ot._watcher._handles.length){var I=Xt(Ae,xe,ot._info.inputs,ot._info.outputs);if(I){for(s=0;s<I.inputs.removed.length;s++)p=le._inMap[I.inputs.removed[s].name],p&&p._closeAll();for(s=0;s<I.outputs.removed.length;s++)p=le._outMap[I.outputs.removed[s].name],p&&p._closeAll();m(function(){an(I)})}}Ae=ot._info.inputs,xe=ot._info.outputs}function Ee(){this._bad||le._refresh(this)}L.prototype.refresh=function(){return this._push(Ee,[]),this._thenable()};function H(l,p){var I,O;C(l)&&(l=l(p)),l instanceof Array||(l=[l]);var W=[],oe=[],he=p.slice(),He=W;for(I=0;I<l.length;I++)if(typeof l[I]>"u")He=oe;else if(l[I]instanceof RegExp)for(O=0;O<he.length;O++)l[I].test(he[O].name)&&(He.push(he[O]),he.splice(O,1),O--);else for(O=0;O<he.length;O++)(l[I]+""==O+""||l[I]===he[O].name||l[I]instanceof Object&&l[I].name===he[O].name)&&(He.push(he[O]),he.splice(O,1),O--);return He==W?W:W.concat(he).concat(oe)}function ee(l,p){var I;p instanceof RegExp?I="Port matching "+p+" not found":p instanceof Object||typeof p>"u"?I="Port not found":I='Port "'+p+'" not found',l._crash(I)}function ce(l,p){if(this._bad)l._crash(this._err());else{var I=H(p,ie);if(!I.length){ee(l,p);return}for(var O=function(oe){return function(){oe.engine._openOut(this,oe.name)}},W=0;W<I.length;W++)I[W]=O(I[W]);l._slip(M,[I]),l._resume()}}L.prototype.openMidiOut=function(l){var p=new Ne;return this._push(Ee,[]),this._push(ce,[p,l]),p._thenable()},L.prototype._openMidiOutNR=function(l){var p=new Ne;return this._push(ce,[p,l]),p._thenable()};function Ce(l,p){if(this._bad)l._crash(this._err());else{var I=H(p,pe);if(!I.length){ee(l,p);return}for(var O=function(oe){return function(){oe.engine._openIn(this,oe.name)}},W=0;W<I.length;W++)I[W]=O(I[W]);l._slip(M,[I]),l._resume()}}L.prototype.openMidiIn=function(l){var p=new Ne;return this._push(Ee,[]),this._push(Ce,[p,l]),p._thenable()},L.prototype._openMidiInNR=function(l){var p=new Ne;return this._push(Ce,[p,l]),p._thenable()};function _e(l,p){this._bad?l._crash():(l._slip(zt,[p]),l._resume())}L.prototype.onChange=function(l){this._orig._watcher||(this._orig._watcher=new at);var p=this._orig._watcher._image();return this._push(_e,[p,l]),p._thenable()},L.prototype._close=function(){le._close();for(var l=vn.slice(),p=0;p<l.length;p++)l[p]&&(l[p]._close?l[p]._close():l[p].close&&l[p].close())};function Ne(){x.apply(this),this._handles=[],this._outs=[]}Ne.prototype=new x,Ne.prototype._filter=function(l){if(this._orig._mpe){var p,I=0;this._handles&&this._handles.length&&(I=this._handles.length,p=this._handles[0]),this._outs&&this._outs.length&&(I=this._outs.length,p=this._outs[0]),I==1&&!p._mpe&&(l=this._orig._mpe.filter(l))}return l},Ne.prototype._receive=function(l){this._emit(this._filter(l))};function ft(l){this._bad||this._receive(l)}Ne.prototype.send=function(){return this._push(ft,[ve.apply(null,arguments)]),this._thenable()},Ne.prototype.note=function(l,p,I,O){return this.noteOn(l,p,I),typeof this._ch>"u"&&typeof this._master>"u"?O>0&&this.wait(O).noteOff(l,p):I>0&&this.wait(I).noteOff(l),this._thenable()};function ve(l){return l.isMidi2?new vt(l):Q.apply(null,arguments)}Ne.prototype._emit=function(l){var p,I;for(p=0;p<this._handles.length;p++)I=ve(l),this._handles[p].apply(this,[I._stamp(this)]);for(p=0;p<this._outs.length;p++)I=ve(l),I._stamped(this._outs[p])||this._outs[p].send(I._stamp(this))};function ct(l){this._emit(l)}Ne.prototype.emit=function(l){return this._push(ct,[l]),this._thenable()};function At(l){C(l)?j(this._orig._handles,l):j(this._orig._outs,l)}function Wt(l){typeof l>"u"?(this._orig._handles=[],this._orig._outs=[]):C(l)?J(this._orig._handles,l):J(this._orig._outs,l)}Ne.prototype.connect=function(l){return this._push(At,[l]),this._thenable()},Ne.prototype.disconnect=function(l){return this._push(Wt,[l]),this._thenable()},Ne.prototype.connected=function(){return this._orig._handles.length+this._orig._outs.length},Ne.prototype._image=function(){var l=this._dup();return l._gr=this._gr,l._ch=this._ch,l._sxid=this._sxid,l._master=this._master,l._band=this._band,l},Ne.prototype._sxid=127,Ne.prototype.sxId=function(l){if(typeof l>"u"&&(l=Ne.prototype._sxid),l==this._sxid)return this._thenable();l=We(l);var p=this._image();return p._sxid=l,this._push(A,[p]),p._thenable()},Ne.prototype.ch=function(l){if(l==this._ch||typeof l>"u"&&typeof this._ch>"u")return this._thenable();var p=this._image();return typeof l<"u"&&(l=Fe(l)),p._ch=l,p._master=void 0,p._band=void 0,this._push(A,[p]),p._thenable()},Ne.prototype.MIDI1=function(){var l=this._image();return l._ch=void 0,l._sxid=Ne.prototype._sxid,l._master=void 0,l._band=void 0,this._push(A,[l]),l._thenable()},Ne.prototype.MIDI2=function(){var l=this._image();l._ch=void 0,l._sxid=Ne.prototype._sxid,l._master=void 0,l._band=void 0;var p=new Rt(l);return this._push(A,[p]),p._thenable()};function Nt(l,p){this._orig._mpe||(this._orig._mpe=new yr),this._orig._mpe.setup(l,p)}Ne.prototype.mpe=function(l,p){if(l==this._master&&p==this._band||typeof l>"u"&&typeof this._master>"u")return this._thenable();if(typeof l<"u"&&yr.validate(l,p),!p)return this.ch(l);var I=this._image();return I._ch=void 0,I._master=l,I._band=p,this._push(Nt,[l,p]),this._push(A,[I]),I._thenable()};function bt(l){if(l!=parseInt(l)||l<0||l>15)throw RangeError("Bad channel value (must not be less than 0 or more than 15): "+l)}function Rt(l){x.apply(this),this._sink=l}Rt.prototype=new x,Rt.prototype._sxid=Ne.prototype._sxid,Rt.prototype._receive=function(l){this._sink._receive(l)};function st(l){return l.isMidi&&!l.isMidi2?new Q(l):vt.apply(null,arguments)}Rt.prototype.send=function(){return this._push(ft,[st.apply(null,arguments)]),this._thenable()},Rt.prototype._image=Ne.prototype._image,Rt.prototype.connect=function(l){return this._sink.connect(l),this._push(A,[this._sink]),this._thenable()},Rt.prototype.disconnect=function(l){return this._sink.disconnect(l),this._push(A,[this._sink]),this._thenable()},Rt.prototype.connected=function(){return this._sink.connected()},Rt.prototype.sxId=Ne.prototype.sxId,Rt.prototype.ch=Ne.prototype.ch,Rt.prototype.gr=function(l){if(l==this._gr||typeof l>"u"&&typeof this._gr>"u")return this._thenable();var p=this._image();return typeof l<"u"&&(l=We(l)),p._gr=l,this._push(A,[p]),p._thenable()},Rt.prototype.MIDI1=function(){var l=this._sink._image();return this._push(A,[l]),l._thenable()},Rt.prototype.MIDI2=function(){var l=this._image();return l._gr=void 0,l._ch=void 0,l._sxid=Ne.prototype._sxid,this._push(A,[l]),l._thenable()};function at(){x.apply(this),this._handles=[],E(this,ot,"refresh"),E(this,ot,"openMidiOut"),E(this,ot,"openMidiIn"),E(this,ot,"onChange"),E(this,ot,"close")}at.prototype=new x;function zt(l){C(l)&&(this._orig._handles.length||le._watch(),j(this._orig._handles,l))}function jt(l){typeof l>"u"?this._orig._handles=[]:J(this._orig._handles,l),this._orig._handles.length||le._unwatch()}at.prototype.connect=function(l){return this._push(zt,[l]),this._thenable()},at.prototype.disconnect=function(l){return this._push(jt,[l]),this._thenable()};function _t(l,p,I,O){var W;if(l.length!=I.length||p.length!=O.length)return!0;for(W=0;W<l.length;W++)if(l[W].name!=I[W].name)return!0;for(W=0;W<p.length;W++)if(p[W].name!=O[W].name)return!0;return!1}function Xt(l,p,I,O){if(_t(l,p,I,O)){var W=[],oe=[],he=[],He=[],$e,mt={};for($e=0;$e<l.length;$e++)mt[l[$e].name]=!0;for($e=0;$e<I.length;$e++)mt[I[$e].name]||W.push(I[$e]);for(mt={},$e=0;$e<I.length;$e++)mt[I[$e].name]=!0;for($e=0;$e<l.length;$e++)mt[l[$e].name]||he.push(l[$e]);for(mt={},$e=0;$e<p.length;$e++)mt[p[$e].name]=!0;for($e=0;$e<O.length;$e++)mt[O[$e].name]||oe.push(O[$e]);for(mt={},$e=0;$e<O.length;$e++)mt[O[$e].name]=!0;for($e=0;$e<p.length;$e++)mt[p[$e].name]||He.push(p[$e]);return{inputs:{added:W,removed:he},outputs:{added:oe,removed:He}}}}function an(l){for(i=0;i<ot._watcher._handles.length;i++)ot._watcher._handles[i].apply(ot,[l])}var ot,le={_outs:[],_ins:[],_close:y},nn={_outs:[],_ins:[]},vn=[];function Ln(){if(n.exports){var l=hB();if(l){Sr(l);return}}this._break()}function X(){var l=document.createElement("div");l.style.visibility="hidden",document.body.appendChild(l);var p=document.createElement("object");if(p.style.visibility="hidden",p.style.width="0px",p.style.height="0px",p.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",p.type="audio/x-jazz",document.body.appendChild(p),p.isJazz){mr(p);return}this._break()}var D,B;function te(){if(typeof navigator<"u"&&navigator.requestMIDIAccess){D=navigator,B=navigator.requestMIDIAccess;try{B.toString().indexOf("JZZ(")!=-1&&(B=void 0)}catch{}}}function me(){if(te(),B){var l=this,p=function(W){Qt(W),l._resume()},I=function(W){l._crash(W)},O={};B.call(D,O).then(p,I),this._pause();return}this._break()}function De(){if(te(),B){var l=this,p=function(W){Qt(W,!0),l._resume()},I=function(W){l._crash(W)},O={sysex:!0};B.call(D,O).then(p,I),this._pause();return}this._break()}function Ge(){var l=this,p,I;function O(W){p=!0;var oe=W.detail;if(!oe){if(I||(I=document.getElementById("jazz-midi-msg")),!I)return;try{oe=JSON.parse(I.innerText)}catch{}I.innerText=""}document.removeEventListener("jazz-midi-msg",O),oe[0]==="version"?(Yr(I,oe[2]),l._resume()):l._crash()}this._pause();try{document.addEventListener("jazz-midi-msg",O),document.dispatchEvent(new Event("jazz-midi"))}catch{}setTimeout(function(){p||l._crash()},50)}function Lt(){this._pause();var l=this;m(function(){l._crash()})}function gn(l){for(var p=[],I=mn(l),O=0;O<I.length;O++)I[O]=="webmidi"?(l&&l.sysex===!0&&p.push(De),(!l||l.sysex!==!0||l.degrade===!0)&&p.push(me)):I[O]=="node"?(p.push(Ln),p.push(Lt)):I[O]=="extension"?p.push(Ge):I[O]=="plugin"&&p.push(X);return p.push(hn),p}function mn(l){var p=["node","extension","plugin","webmidi"];if(!l||!l.engine)return p;var I=l.engine instanceof Array?l.engine:[l.engine],O={},W,oe,he=[],He=[],$e;for($e=0;$e<I.length;$e++){var mt=I[$e].toString().toLowerCase();O[mt]||(O[mt]=!0,mt==="none"&&(W=!0),(mt==="etc"||typeof mt>"u")&&(oe=!0),oe?He.push(mt):he.push(mt),J(p,mt))}return(oe||he.length||He.length)&&(W=!1),W?[]:he.concat(oe?p:He)}function wn(l){ot=new L,ot._options=l,ot._push(M,[gn(l)]),ot.refresh(),ot._resume()}function hn(){le._type="none",le._version=r,le._sysex=!0,le._outs=[],le._ins=[],le._outMap={},le._inMap={},le._refresh=function(){Se()},le._watch=y,le._unwatch=y,le._close=y}function Bn(){le._inArr=[],le._outArr=[],le._inMap={},le._outMap={},le._outsW=[],le._insW=[],le._version=le._main.version,le._sysex=!0;var l;function p(){for(var I=0;I<this.clients.length;I++)this._close(this.clients[I])}le._refresh=function(){le._outs=[],le._ins=[];var I,O;for(I=0;(O=le._main.MidiOutInfo(I)).length;I++)le._outs.push({type:le._type,name:O[0],manufacturer:O[1],version:O[2]});for(I=0;(O=le._main.MidiInInfo(I)).length;I++)le._ins.push({type:le._type,name:O[0],manufacturer:O[1],version:O[2]});Se()},le._openOut=function(I,O){var W=le._outMap[O];if(!W){le._pool.length<=le._outArr.length&&le._pool.push(le._newPlugin()),W={name:O,clients:[],info:{name:O,manufacturer:le._allOuts[O].manufacturer,version:le._allOuts[O].version,type:"MIDI-out",sysex:le._sysex,engine:le._type},_close:function(He){le._closeOut(He)},_closeAll:p,_receive:function(He){He.length&&this.plugin.MidiOutRaw(He.slice())}};var oe=le._pool[le._outArr.length];W.plugin=oe,le._outArr.push(W),le._outMap[O]=W}if(!W.open){var he=W.plugin.MidiOutOpen(O);if(he!==O){he&&W.plugin.MidiOutClose(),I._break();return}W.open=!0}I._orig._impl=W,j(W.clients,I._orig),I._info=W.info,I._receive=function(He){W._receive(He)},I._close=function(){W._close(this)}},le._openIn=function(I,O){var W=le._inMap[O];if(!W){le._pool.length<=le._inArr.length&&le._pool.push(le._newPlugin()),W={name:O,clients:[],info:{name:O,manufacturer:le._allIns[O].manufacturer,version:le._allIns[O].version,type:"MIDI-in",sysex:le._sysex,engine:le._type},_close:function($e){le._closeIn($e)},_closeAll:p,handle:function($e,mt){for(var wr=0;wr<this.clients.length;wr++){var Ws=Q(mt);this.clients[wr]._emit(Ws)}}};var oe=function($e){return function(mt,wr){$e.handle(mt,wr)}};W.onmidi=oe(W);var he=le._pool[le._inArr.length];W.plugin=he,le._inArr.push(W),le._inMap[O]=W}if(!W.open){var He=W.plugin.MidiInOpen(O,W.onmidi);if(He!==O){He&&W.plugin.MidiInClose(),I._break();return}W.open=!0}I._orig._impl=W,j(W.clients,I._orig),I._info=W.info,I._close=function(){W._close(this)}},le._closeOut=function(I){var O=I._impl;J(O.clients,I._orig),!O.clients.length&&O.open&&(O.open=!1,O.plugin.MidiOutClose())},le._closeIn=function(I){var O=I._impl;J(O.clients,I._orig),!O.clients.length&&O.open&&(O.open=!1,O.plugin.MidiInClose())},le._close=function(){for(var I=0;I<le._inArr.length;I++)le._inArr[I].open&&le._inArr[I].plugin.MidiInClose();le._unwatch()},le._watch=function(){l||(l=setInterval(function(){le._refresh()},250))},le._unwatch=function(){l&&clearInterval(l),l=void 0}}function Sr(l){le._type="node",le._main=l,le._pool=[],le._newPlugin=function(){return new l.MIDI},Bn()}function mr(l){le._type="plugin",le._main=l,le._pool=[l],le._newPlugin=function(){var p=document.createElement("object");return p.style.visibility="hidden",p.style.width="0px",l.style.height="0px",p.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",p.type="audio/x-jazz",document.body.appendChild(p),p.isJazz?p:void 0},Bn()}function Qt(l,p){le._type="webmidi",le._version=43,le._sysex=!!p,le._access=l,le._inMap={},le._outMap={},le._outsW=[],le._insW=[];var I;function O(){for(var W=0;W<this.clients.length;W++)this._close(this.clients[W])}le._refresh=function(){le._outs=[],le._ins=[],le._access.outputs.forEach(function(W){le._outs.push({type:le._type,name:W.name,manufacturer:W.manufacturer,version:W.version})}),le._access.inputs.forEach(function(W){le._ins.push({type:le._type,name:W.name,manufacturer:W.manufacturer,version:W.version})}),Se()},le._openOut=function(W,oe){var he=le._outMap[oe];he||(he={name:oe,clients:[],info:{name:oe,manufacturer:le._allOuts[oe].manufacturer,version:le._allOuts[oe].version,type:"MIDI-out",sysex:le._sysex,engine:le._type},_close:function($e){le._closeOut($e)},_closeAll:O,_receive:function($e){he.dev&&$e.length&&this.dev.send($e.slice())}});var He;le._access.outputs.forEach(function($e){$e.name===oe&&(He=$e)}),He?(he.dev=He,le._outMap[oe]=he,W._orig._impl=he,j(he.clients,W._orig),W._info=he.info,W._receive=function($e){he._receive($e)},W._close=function(){he._close(this)},he.dev.open&&(W._pause(),he.dev.open().then(function(){W._resume()},function(){W._crash()}))):W._break()},le._openIn=function(W,oe){var he=le._inMap[oe];he||(he={name:oe,clients:[],info:{name:oe,manufacturer:le._allIns[oe].manufacturer,version:le._allIns[oe].version,type:"MIDI-in",sysex:le._sysex,engine:le._type},_close:function(mt){le._closeIn(mt)},_closeAll:O,handle:function(mt){for(var wr=0;wr<this.clients.length;wr++){var Ws=Q([].slice.call(mt.data));this.clients[wr]._emit(Ws)}}});var He;if(le._access.inputs.forEach(function(mt){mt.name===oe&&(He=mt)}),He){he.dev=He;var $e=function(mt){return function(wr){mt.handle(wr)}};he.dev.onmidimessage=$e(he),le._inMap[oe]=he,W._orig._impl=he,j(he.clients,W._orig),W._info=he.info,W._close=function(){he._close(this)},he.dev.open&&(W._pause(),he.dev.open().then(function(){W._resume()},function(){W._crash()}))}else W._break()},le._closeOut=function(W){var oe=W._impl;J(oe.clients,W._orig),oe.clients.length||(oe.dev&&oe.dev.close&&oe.dev.close(),oe.dev=void 0)},le._closeIn=function(W){var oe=W._impl;J(oe.clients,W._orig),oe.clients.length||(oe.dev&&(oe.dev.onmidimessage=null,oe.dev.close&&oe.dev.close()),oe.dev=void 0)},le._close=function(){le._unwatch()},le._watch=function(){le._access.onstatechange=function(){I=!0,m(function(){I&&(le._refresh(),I=!1)})}},le._unwatch=function(){le._access.onstatechange=void 0}}function Yr(l,p){le._type="extension",le._version=p,le._sysex=!0,le._pool=[],le._outs=[],le._ins=[],le._inArr=[],le._outArr=[],le._inMap={},le._outMap={},le._outsW=[],le._insW=[],le.refreshClients=[],le._msg=l,le._newPlugin=function(){var W={id:le._pool.length};le._pool.push(W),W.id?document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["new"]})):W.ready=!0},le._newPlugin(),le._refresh=function(W){le.refreshClients.push(W),W._pause(),m(function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["refresh"]}))})};function I(){for(var W=0;W<this.clients.length;W++)this._close(this.clients[W])}le._openOut=function(W,oe){var he=le._outMap[oe];if(!he){le._pool.length<=le._outArr.length&&le._newPlugin();var He=le._pool[le._outArr.length];he={name:oe,clients:[],info:{name:oe,manufacturer:le._allOuts[oe].manufacturer,version:le._allOuts[oe].version,type:"MIDI-out",sysex:le._sysex,engine:le._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openout",He.id,oe]}))},_close:function($e){le._closeOut($e)},_closeAll:I,_receive:function($e){if($e.length){var mt=$e.slice();mt.splice(0,0,"play",He.id),document.dispatchEvent(new CustomEvent("jazz-midi",{detail:mt}))}}},he.plugin=He,He.output=he,le._outArr.push(he),le._outMap[oe]=he}W._orig._impl=he,j(he.clients,W._orig),W._info=he.info,W._receive=function($e){he._receive($e)},W._close=function(){he._close(this)},he.open||(W._pause(),he.plugin.ready&&he._start())},le._openIn=function(W,oe){var he=le._inMap[oe];if(!he){le._pool.length<=le._inArr.length&&le._newPlugin();var He=le._pool[le._inArr.length];he={name:oe,clients:[],info:{name:oe,manufacturer:le._allIns[oe].manufacturer,version:le._allIns[oe].version,type:"MIDI-in",sysex:le._sysex,engine:le._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openin",He.id,oe]}))},_close:function($e){le._closeIn($e)},_closeAll:I},he.plugin=He,He.input=he,le._inArr.push(he),le._inMap[oe]=he}W._orig._impl=he,j(he.clients,W._orig),W._info=he.info,W._close=function(){he._close(this)},he.open||(W._pause(),he.plugin.ready&&he._start())},le._closeOut=function(W){var oe=W._impl;J(oe.clients,W._orig),!oe.clients.length&&oe.open&&(oe.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closeout",oe.plugin.id]})))},le._closeIn=function(W){var oe=W._impl;J(oe.clients,W._orig),!oe.clients.length&&oe.open&&(oe.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closein",oe.plugin.id]})))},le._close=function(){le._unwatch()};var O;le._watch=function(){le._insW=le._ins,le._outsW=le._outs,O=setInterval(function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["refresh"]}))},250)},le._unwatch=function(){clearInterval(O),O=void 0},document.addEventListener("jazz-midi-msg",function(W){var oe,he,He,$e=W.detail?[W.detail]:void 0;if(!$e)for($e=le._msg.innerText.split(`
`),le._msg.innerText="",oe=0;oe<$e.length;oe++)try{$e[oe]=JSON.parse($e[oe])}catch{$e[oe]=[]}for(oe=0;oe<$e.length;oe++){var mt=$e[oe];if(mt.length){if(mt[0]==="refresh"){if(mt[1].ins){for(he=0;he<mt[1].ins.length;he++)mt[1].ins[he].type=le._type;le._ins=mt[1].ins}if(mt[1].outs){for(he=0;he<mt[1].outs.length;he++)mt[1].outs[he].type=le._type;le._outs=mt[1].outs}for(Se(),he=0;he<le.refreshClients.length;he++)le.refreshClients[he]._resume();le.refreshClients=[]}else if(mt[0]==="version"){var wr=le._pool[mt[1]];wr&&(wr.ready=!0,wr.input&&wr.input._start(),wr.output&&wr.output._start())}else if(mt[0]==="openout"){if(He=le._pool[mt[1]].output,He){if(mt[2]==He.name){if(He.open=!0,He.clients)for(he=0;he<He.clients.length;he++)He.clients[he]._resume()}else if(He.clients)for(he=0;he<He.clients.length;he++)He.clients[he]._crash()}}else if(mt[0]==="openin"){if(He=le._pool[mt[1]].input,He){if(mt[2]==He.name){if(He.open=!0,He.clients)for(he=0;he<He.clients.length;he++)He.clients[he]._resume()}else if(He.clients)for(he=0;he<He.clients.length;he++)He.clients[he]._crash()}}else if(mt[0]==="midi"&&(He=le._pool[mt[1]].input,He&&He.clients))for(he=0;he<He.clients.length;he++){var Ws=Q(mt.slice(3));He.clients[he]._emit(Ws)}}}})}var Je=function(l){return ot||wn(l),ot._thenable()};Je.JZZ=Je,Je.version=r,Je.info=function(){return L.prototype.info()};function En(l){var p=new Ne;return l instanceof Object&&z(l,function(I){p[I]=l[I]}),p._resume(),p}Je.Widget=En,L.prototype.Widget=Je.Widget,Je.addMidiIn=function(l,p){var I=Y(p._info||{});I.name=l,I.type=I.type||"javascript",I.manufacturer=I.manufacturer||"virtual",I.version=I.version||"0.0";var O={_info:function(){return I},_openIn:function(W){W._pause(),W._info=Y(I),W._close=function(){p.disconnect(W)},p.connect(W),W._resume()}};return Je.lib.registerMidiIn(l,O)},L.prototype.addMidiIn=Je.addMidiIn,Je.addMidiOut=function(l,p){var I=Y(p._info||{});I.name=l,I.type=I.type||"javascript",I.manufacturer=I.manufacturer||"virtual",I.version=I.version||"0.0";var O={_info:function(){return I},_openOut:function(W){W._pause(),W._info=Y(I),W._close=function(){W.disconnect()},At.apply(W,[p]),W._resume()}};return Je.lib.registerMidiOut(l,O)},L.prototype.addMidiOut=Je.addMidiOut,Je.removeMidiOut=function(l){return Je.lib.unregisterMidiOut(l)},L.prototype.removeMidiOut=Je.removeMidiOut,Je.removeMidiIn=function(l){return Je.lib.unregisterMidiIn(l)},L.prototype.removeMidiIn=Je.removeMidiIn,Je.maskMidiIn=function(l){we[l]=!0},L.prototype.maskMidiIn=Je.maskMidiIn,Je.unmaskMidiIn=function(l){delete we[l]},L.prototype.unmaskMidiIn=Je.unmaskMidiIn,Je.maskMidiOut=function(l){Le[l]=!0},L.prototype.maskMidiOut=Je.maskMidiOut,Je.unmaskMidiOut=function(l){delete Le[l]},L.prototype.unmaskMidiOut=Je.unmaskMidiOut;function Ht(){var l=this instanceof Ht?this:l=new Ht;return Ht.prototype.reset.apply(l,arguments),l}Ht.prototype.reset=function(l){if(l instanceof Ht)return this.setType(l.getType()),this.setHour(l.getHour()),this.setMinute(l.getMinute()),this.setSecond(l.getSecond()),this.setFrame(l.getFrame()),this.setQuarter(l.getQuarter()),this;var p=l instanceof Array?l:arguments;return this.setType(p[0]),this.setHour(p[1]),this.setMinute(p[2]),this.setSecond(p[3]),this.setFrame(p[4]),this.setQuarter(p[5]),this};function fr(){this.type==29.97&&!this.second&&this.frame<2&&this.minute%10&&(this.frame=2)}Ht.prototype.isFullFrame=function(){return this.quarter==0||this.quarter==4},Ht.prototype.getType=function(){return this.type},Ht.prototype.getHour=function(){return this.hour},Ht.prototype.getMinute=function(){return this.minute},Ht.prototype.getSecond=function(){return this.second},Ht.prototype.getFrame=function(){return this.frame},Ht.prototype.getQuarter=function(){return this.quarter},Ht.prototype.setType=function(l){if(typeof l>"u"||l==24)this.type=24;else if(l==25)this.type=25;else if(l==29.97)this.type=29.97,fr.apply(this);else if(l==30)this.type=30;else throw RangeError("Bad SMPTE frame rate: "+l);return this.frame>=this.type&&(this.frame=this.type-1),this},Ht.prototype.setHour=function(l){if(typeof l>"u"&&(l=0),l!=parseInt(l)||l<0||l>=24)throw RangeError("Bad SMPTE hours value: "+l);return this.hour=l,this},Ht.prototype.setMinute=function(l){if(typeof l>"u"&&(l=0),l!=parseInt(l)||l<0||l>=60)throw RangeError("Bad SMPTE minutes value: "+l);return this.minute=l,fr.apply(this),this},Ht.prototype.setSecond=function(l){if(typeof l>"u"&&(l=0),l!=parseInt(l)||l<0||l>=60)throw RangeError("Bad SMPTE seconds value: "+l);return this.second=l,fr.apply(this),this},Ht.prototype.setFrame=function(l){if(typeof l>"u"&&(l=0),l!=parseInt(l)||l<0||l>=this.type)throw RangeError("Bad SMPTE frame number: "+l);return this.frame=l,fr.apply(this),this},Ht.prototype.setQuarter=function(l){if(typeof l>"u"&&(l=0),l!=parseInt(l)||l<0||l>=8)throw RangeError("Bad SMPTE quarter frame: "+l);return this.quarter=l,this},Ht.prototype.incrFrame=function(){return this.frame++,this.frame>=this.type&&(this.frame=0,this.second++,this.second>=60&&(this.second=0,this.minute++,this.minute>=60&&(this.minute=0,this.hour=this.hour>=23?0:this.hour+1))),fr.apply(this),this},Ht.prototype.decrFrame=function(){return!this.second&&this.frame==2&&this.type==29.97&&this.minute%10&&(this.frame=0),this.frame--,this.frame<0&&(this.frame=this.type==29.97?29:this.type-1,this.second--,this.second<0&&(this.second=59,this.minute--,this.minute<0&&(this.minute=59,this.hour=this.hour?this.hour-1:23))),this},Ht.prototype.incrQF=function(){return this.backwards=!1,this.quarter=this.quarter+1&7,(this.quarter==0||this.quarter==4)&&this.incrFrame(),this},Ht.prototype.decrQF=function(){return this.backwards=!0,this.quarter=this.quarter+7&7,(this.quarter==3||this.quarter==7)&&this.decrFrame(),this};function $n(l){return[[24,25,29.97,30][l[7]>>1&3],(l[7]&1)<<4|l[6],l[5]<<4|l[4],l[3]<<4|l[2],l[1]<<4|l[0]]}Ht.prototype.read=function(l){if(l instanceof Q||(l=Q.apply(null,arguments)),l[0]==240&&l[1]==127&&l[3]==1&&l[4]==1&&l[9]==247)return this.type=[24,25,29.97,30][l[5]>>5&3],this.hour=l[5]&31,this.minute=l[6],this.second=l[7],this.frame=l[8],this.quarter=0,this._=void 0,this._b=void 0,this._f=void 0,!0;if(l[0]==241&&typeof l[1]<"u"){var p=l[1]>>4,I=l[1]&15;return p==0?this._==7&&(this._f==7&&(this.reset($n(this._a)),this.incrFrame()),this.incrFrame()):p==3?this._==4&&this.decrFrame():p==4?this._==3&&this.incrFrame():p==7&&this._===0&&(this._b===0&&(this.reset($n(this._a)),this.decrFrame()),this.decrFrame()),this._a||(this._a=[]),this._a[p]=I,this._f=this._f===p-1||p==0?p:void 0,this._b=this._b===p+1||p==7?p:void 0,this._=p,this.quarter=p,!0}return!1};function Qr(l){!l.backwards&&l.quarter>=4?l.decrFrame():l.backwards&&l.quarter<4&&l.incrFrame();var p;switch(l.quarter>>1){case 0:p=l.frame;break;case 1:p=l.second;break;case 2:p=l.minute;break;default:p=l.hour}return l.quarter&1?p>>=4:p&=15,l.quarter==7&&(l.type==25?p|=2:l.type==29.97?p|=4:l.type==30&&(p|=6)),!l.backwards&&l.quarter>=4?l.incrFrame():l.backwards&&l.quarter<4&&l.decrFrame(),p|l.quarter<<4}function Mr(l){return l.type==25?l.hour|32:l.type==29.97?l.hour|64:l.type==30?l.hour|96:l.hour}function ge(l){return l<10?"0"+l:l}function Ie(l){for(var p=[],I=0;I<l.length;I++)p[I]=ge(I?l[I]:l[I]&31);return p.join(":")}Ht.prototype.toString=function(){return Ie([this.hour,this.minute,this.second,this.frame])},Je.SMPTE=Ht,L.prototype.SMPTE=Ht;function Q(l){var p=this instanceof Q?this:p=new Q,I;if(l instanceof Q)return p._from=l._from.slice(),z(l,function(W){W!="_from"&&(p[W]=l[W])}),p;if(p._from=[],typeof l>"u")return p;var O=l instanceof Array?l:arguments;for(I=0;I<O.length;I++)d=O[I],I==1&&(p[0]>=128&&p[0]<=175&&(d=Q.noteValue(d)),p[0]>=192&&p[0]<=207&&(d=Q.programValue(d))),(d!=parseInt(d)||d<0||d>255)&&ht(O[I]),p.push(d);return p}Q.prototype=[],Q.prototype.constructor=Q,Q.prototype.isMidi=function(){return 1};var Ve={};Q.noteValue=function(l){return typeof l>"u"?void 0:Ve[l.toString().toLowerCase()]},Q.programValue=function(l){return l},Q.octaveValue=function(l){var p=Ve[l.toString().toLowerCase()];return typeof p>"u"&&(p=Ve[l.toString().toLowerCase()+"1"]),typeof p>"u"?void 0:p%12},Q.freq=function(l,p){return typeof p>"u"&&(p=440),tt(p),l!=parseFloat(l)&&(l=Ot(l)),p*Math.pow(2,(l-69)/12)};function tt(l){if(l!=parseFloat(l))throw TypeError("Not a number: "+l)}Q.shift=function(l,p){return typeof p>"u"&&(p=440),tt(l),tt(p),Math.log2(l/p)*12},Q.midi=function(l,p){return l!=parseFloat(l)?Ot(l):Q.shift(l,p)+69},Q.to7b=function(l){return tt(l),l<=0?0:l>=1?127:Math.floor(l*128)},Q.to14b=function(l){return tt(l),l<=0?0:l>=1?16383:Math.floor(l*16384)},Q.to21b=function(l){return typeof l>"u"?2097151:(tt(l),l<=0?0:(l=(Math.floor(l)<<14)+Q.to14b(l-Math.floor(l)),l<2097151?l:2097150))},Q.to32b=function(l){return tt(l),l<=0?0:l>=1?4294967295:Math.floor(l*4294967296)};function Et(){}Et.prototype=Q,Q._sxid=127,Q.sxId=function(l){if(typeof l>"u"&&(l=Q._sxid),l==this._sxid)return this;l=We(l);var p=new Et;return p._ch=this._ch,p._sxid=l,p},Q.ch=function(l){if(l==this._ch||typeof l>"u"&&typeof this._ch>"u")return this;var p=new Et;return typeof l<"u"&&(l=Fe(l)),p._ch=l,p._sxid=this._sxid,p};var Bt={c:0,d:2,e:4,f:5,g:7,a:9,b:11,h:11};for(z(Bt,function(l){for(d=0;d<12&&(c=Bt[l]+d*12,!(c>127));d++)Ve[l+d]=c,Ve[l+""+d]=c,c>0&&(Ve[l+"b"+d]=c-1,Ve[l+""+d]=c-1,Ve[l+"bb"+d]=c-2,Ve[l+""+d]=c-2,Ve[l+""+d]=c-2),c<127&&(Ve[l+"#"+d]=c+1,Ve[l+""+d]=c+1,Ve[l+"##"+d]=c+2,Ve[l+""+d]=c+2,Ve[l+""+d]=c+2)}),d=0;d<128;d++)Ve[d]=d;function ht(l){throw RangeError("Bad MIDI value: "+l)}function pt(l){throw TypeError("Invalid value: "+l)}function Ct(l){throw RangeError("Out of range: "+l)}function Fe(l){return bt(l),parseInt(l)}function lt(l){if(l!=parseInt(l)||l<0||l>15)throw RangeError("Expected a 4-bit value: "+l);return parseInt(l)}function We(l,p){return(l!=parseInt(l)||l<0||l>127)&&ht(typeof p>"u"?l:p),parseInt(l)}function In(l){return(l!=parseInt(l)||l<0||l>255)&&ht(l),parseInt(l)}function it(l){return(l!=parseInt(l)||l<0||l>16383)&&ht(l),parseInt(l)}function fe(l){if(l!=parseInt(l)||l<0||l>65535)throw RangeError("Expected a 16-bit value: "+l);return parseInt(l)}function ze(l){if(l!=parseInt(l)||l<0||l>1048575)throw RangeError("Expected a 20-bit value: "+l);return parseInt(l)}function xt(l){return(l!=parseInt(l)||l<0||l>2097151)&&ht(l),parseInt(l)}function bn(l){return(l!=parseInt(l)||l<0||l>4294967295)&&ht(l),parseInt(l)}function Ot(l){return We(Q.noteValue(l),l)}function wt(l){return it(l)&127}function Zt(l){return it(l)>>7}function Kn(l){l=""+l;for(var p=0;p<l.length;p++)l.charCodeAt(p)>255&&ht(l[p]);return l}function qn(l){return[l>>14,l>>7&127,l&127]}function nr(l,p){return l!=parseFloat(l)&&pt(typeof p>"u"?l:p),(l<0||l>1)&&Ct(typeof p>"u"?l:p),parseFloat(l)}function Pn(l){return typeof l<"u"&&!l?126:127}function tn(l){var p,I,O=[],W={};z(l,function(he){if(I=xt(l[he]),he=Ot(he),he in W)throw RangeError("Duplicate MIDI value: "+he);O.push(he),W[he]=I}),O.sort();var oe=[O.length];for(p=0;p<O.length;p++)oe=oe.concat([O[p]],qn(W[O[p]]));return oe}function yn(l){var p={};return z(l,function(I){p[I]=Q.to21b(l[I]==parseFloat(l[I])?l[I]:Ot(l[I]))}),p}function rr(l){var p={};return z(l,function(I){p[I]=Q.to21b(Q.midi(l[I]))}),p}function li(l){var p=[];if(!(l instanceof Array)||l.length!=12)throw TypeError("Expected an array of size 12");for(var I=0;I<12;I++)p.push(We(l[I]));return p}function Cn(l){var p=[];if(!(l instanceof Array)||l.length!=12)throw TypeError("Expected an array of size 12");for(var I=0;I<12;I++)p.push(Zt(l[I])),p.push(wt(l[I]));return p}var Lr={noteOff:function(l,p,I){return typeof I>"u"&&(I=64),[128+Fe(l),Ot(p),We(I)]},noteOn:function(l,p,I){return typeof I>"u"&&(I=127),[144+Fe(l),Ot(p),We(I)]},aftertouch:function(l,p,I){return[160+Fe(l),Ot(p),We(I)]}},It={control:function(l,p,I){return[176+Fe(l),We(p),We(I)]},program:function(l,p){return[192+Fe(l),We(Q.programValue(p),p)]},pressure:function(l,p){return[208+Fe(l),We(p)]},pitchBend:function(l,p,I){return typeof I>"u"?[224+Fe(l),wt(p),Zt(p)]:[224+Fe(l),We(I),We(p)]},pitchBendF:function(l,p){return It.pitchBend(l,Q.to14b((p+1)/2))},bankMSB:function(l,p){return[176+Fe(l),0,We(p)]},bankLSB:function(l,p){return[176+Fe(l),32,We(p)]},modMSB:function(l,p){return[176+Fe(l),1,We(p)]},modLSB:function(l,p){return[176+Fe(l),33,We(p)]},breathMSB:function(l,p){return[176+Fe(l),2,We(p)]},breathLSB:function(l,p){return[176+Fe(l),34,We(p)]},footMSB:function(l,p){return[176+Fe(l),4,We(p)]},footLSB:function(l,p){return[176+Fe(l),36,We(p)]},portamentoMSB:function(l,p){return[176+Fe(l),5,We(p)]},portamentoLSB:function(l,p){return[176+Fe(l),37,We(p)]},dataMSB:function(l,p){return[176+Fe(l),6,We(p)]},dataLSB:function(l,p){return[176+Fe(l),38,We(p)]},volumeMSB:function(l,p){return[176+Fe(l),7,We(p)]},volumeLSB:function(l,p){return[176+Fe(l),39,We(p)]},balanceMSB:function(l,p){return[176+Fe(l),8,We(p)]},balanceLSB:function(l,p){return[176+Fe(l),40,We(p)]},panMSB:function(l,p){return[176+Fe(l),10,We(p)]},panLSB:function(l,p){return[176+Fe(l),42,We(p)]},expressionMSB:function(l,p){return[176+Fe(l),11,We(p)]},expressionLSB:function(l,p){return[176+Fe(l),43,We(p)]},damper:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),64,p?127:0]},portamento:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),65,p?127:0]},sostenuto:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),66,p?127:0]},soft:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),67,p?127:0]},legato:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),68,p?127:0]},hold2:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),69,p?127:0]},soundVariation:function(l,p){return[176+Fe(l),70,Ot(p)]},filterResonance:function(l,p){return[176+Fe(l),71,Ot(p)]},releaseTime:function(l,p){return[176+Fe(l),72,Ot(p)]},attackTime:function(l,p){return[176+Fe(l),73,Ot(p)]},brightness:function(l,p){return[176+Fe(l),74,Ot(p)]},decayTime:function(l,p){return[176+Fe(l),75,Ot(p)]},vibratoRate:function(l,p){return[176+Fe(l),76,Ot(p)]},vibratoDepth:function(l,p){return[176+Fe(l),77,Ot(p)]},vibratoDelay:function(l,p){return[176+Fe(l),78,Ot(p)]},ptc:function(l,p){return[176+Fe(l),84,Ot(p)]},dataIncr:function(l){return[176+Fe(l),96,0]},dataDecr:function(l){return[176+Fe(l),97,0]},nrpnLSB:function(l,p){return[176+Fe(l),98,We(p)]},nrpnMSB:function(l,p){return[176+Fe(l),99,We(p)]},rpnLSB:function(l,p){return[176+Fe(l),100,We(p)]},rpnMSB:function(l,p){return[176+Fe(l),101,We(p)]},allSoundOff:function(l){return[176+Fe(l),120,0]},resetAllControllers:function(l){return[176+Fe(l),121,0]},localControl:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),122,p?127:0]},allNotesOff:function(l){return[176+Fe(l),123,0]},omni:function(l,p){return typeof p>"u"&&(p=!0),[176+Fe(l),p?125:124,0]},mono:function(l,p){return typeof p>"u"&&(p=1),[176+Fe(l),126,We(p)]},poly:function(l){return[176+Fe(l),127,0]}};function Ls(l,p,I,O){return typeof p<"u"?[We(l),We(p),We(I),We(O)]:((l!=parseInt(l)||l<0||l>65535)&&pt(l),l=parseInt(l),[l>>12&15,l>>8&15,l>>4&15,l&15])}function Qi(l){return tt(l),l=Math.round(l*65536+16384),l<0?0:l>65535?65535:l}var es={mtc:function(l){return[241,Qr(l)]},songPosition:function(l,p){return typeof p>"u"?[242,wt(l),Zt(l)]:[242,We(p),We(l)]},songSelect:function(l){return[243,We(l)]},tune:function(){return[246]},clock:function(){return[248]},start:function(){return[250]},continue:function(){return[251]},stop:function(){return[252]},active:function(){return[254]},reset:function(){return[255]}},St={sxIdRequest:function(){return[240,126,this._sxid,6,1,247]},sxTuningDumpRequest:function(l,p){return typeof p>"u"?[240,126,this._sxid,8,0,We(l),247]:[240,126,this._sxid,8,3,We(l),We(p),247]},sxFullFrame:function(l){return[240,127,this._sxid,1,1,Mr(l),l.getMinute(),l.getSecond(),l.getFrame(),247]},sxMasterVolume:function(l,p){return typeof p>"u"?[240,127,this._sxid,4,1,wt(l),Zt(l),247]:[240,127,this._sxid,4,1,We(p),We(l),247]},sxMasterVolumeF:function(l){return St.sxMasterVolume.call(this,Q.to14b(nr(l)))},sxMasterFineTuning:function(l,p){return typeof p>"u"?[240,127,this._sxid,4,3,wt(l),Zt(l),247]:[240,127,this._sxid,4,3,We(p),We(l),247]},sxMasterFineTuningF:function(l){return St.sxMasterFineTuning.call(this,Q.to14b(nr((l%1+1)/2,l)))},sxMasterCoarseTuning:function(l){return[240,127,this._sxid,4,4,0,We(l),247]},sxMasterCoarseTuningF:function(l){return St.sxMasterCoarseTuning.call(this,64+(l-l%1))},sxNoteTuning:function(l,p,I,O){return p==parseInt(p)?[240,Pn(O),this._sxid,8,7,We(l),We(p)].concat(tn(I),[247]):[240,127,this._sxid,8,2,We(l)].concat(tn(p),[247])},sxNoteTuningF:function(l,p,I,O){return p==parseInt(p)?St.sxNoteTuning.call(this,l,p,yn(I),O):St.sxNoteTuning.call(this,l,yn(p))},sxNoteTuningHZ:function(l,p,I,O){return p==parseInt(p)?St.sxNoteTuning.call(this,l,p,rr(I),O):St.sxNoteTuning.call(this,l,rr(p))},sxScaleTuning1:function(l,p,I){return l==parseInt(l)?[240,Pn(I),this._sxid,8,8].concat(qn(fe(l)),li(p),[247]):St.sxScaleTuning1.call(this,65535,l,p)},sxScaleTuning1F:function(l,p,I){if(l!=parseInt(l))return St.sxScaleTuning1F.call(this,65535,l,p);for(var O=[],W=0;W<p.length;W++){if(p[W]<-.64||p[W]>.63)throw RangeError("Out of range: "+p[W]);O.push(Math.floor(p[W]*100+64))}return St.sxScaleTuning1.call(this,l,O,I)},sxScaleTuning2:function(l,p,I){return l==parseInt(l)?[240,Pn(I),this._sxid,8,9].concat(qn(fe(l)),Cn(p),[247]):St.sxScaleTuning2.call(this,65535,l,p)},sxScaleTuning2F:function(l,p,I){if(l!=parseInt(l))return St.sxScaleTuning2F.call(this,65535,l,p);for(var O=[],W=0;W<p.length;W++){var oe=(p[W]+1)/2;if(oe<-1||oe>1)throw RangeError("Out of range: "+p[W]);O.push(Q.to14b((p[W]+1)/2))}return St.sxScaleTuning2.call(this,l,O,I)},sxGM:function(l){return typeof l>"u"&&(l=1),[240,126,this._sxid,9,l?l==2?3:1:2,247]},sxGS:function(l){for(var p=typeof l>"u"?[64,0,127,0]:l instanceof Array?l:arguments,I=0,O=[240,65,this._sxid,66,18],W=0;W<p.length;W++){var oe=We(p[W]);O.push(oe),I+=oe}return I%=128,O.push(I?128-I:0),O.push(247),O},sxXG:function(l){var p=typeof l>"u"?[0,0,126,0]:l instanceof Array?l:arguments,I=this._sxid==127?0:this._sxid;I>15&&ht("Bad Yamaha device number: "+I);for(var O=[240,67,16+I,76],W=0;W<p.length;W++)O.push(We(p[W]));return O.push(247),O},sxMidiSoft:function(l,p){var I=[240,0,32,36,0,We(l||0)];p=typeof p>"u"?"":""+p;for(var O=0;O<p.length;O++)I.push(We(p.charCodeAt(O)));return I.push(247),I},gsMasterVolume:function(l){return St.sxGS.call(this,[64,0,4,We(l)])},gsMasterVolumeF:function(l){return St.gsMasterVolume.call(this,Q.to7b(nr(l)))},gsMasterFineTuning:function(l,p,I,O){return l=Ls(l,p,I,O),St.sxGS.call(this,[64,0,0,l[0],l[1],l[2],l[3]])},gsMasterFineTuningF:function(l){return St.gsMasterFineTuning.call(this,Qi(l%1))},gsMasterCoarseTuning:function(l){return St.sxGS.call(this,[64,0,5,We(l)])},gsMasterCoarseTuningF:function(l){return St.gsMasterCoarseTuning.call(this,64+(l-l%1))},gsOctaveTuning:function(l,p,I){return St.sxGS.call(this,[64,16+[1,2,3,4,5,6,7,8,9,0,11,12,13,14,15][Fe(l)],64+Q.octaveValue(p),We(I)])},gsOctaveTuningF:function(l,p,I){if(I<-.64||I>.63)throw RangeError("Out of range: "+I);return St.gsOctaveTuning.call(this,l,p,Math.floor(I*100+64))},xgMasterVolume:function(l){return St.sxXG.call(this,[0,0,4,We(l)])},xgMasterVolumeF:function(l){return St.xgMasterVolume.call(this,Q.to7b(nr(l)))},xgMasterFineTuning:function(l,p,I,O){return l=Ls(l,p,I,O),St.sxXG.call(this,[0,0,0,l[0],l[1],l[2],l[3]])},xgMasterFineTuningF:function(l){return St.xgMasterFineTuning.call(this,Qi(l%1))},xgMasterCoarseTuning:function(l){return St.sxXG.call(this,[0,0,6,We(l)])},xgMasterCoarseTuningF:function(l){return St.xgMasterCoarseTuning.call(this,64+(l-l%1))},xgOctaveTuning:function(l,p,I){return St.sxXG.call(this,[8,Fe(l),65+Q.octaveValue(p),We(I)])},xgOctaveTuningF:function(l,p,I){if(I<-.64||I>.63)throw RangeError("Out of range: "+I);return St.xgOctaveTuning.call(this,l,p,Math.floor(I*100+64))}};St.sxScaleTuning=St.sxScaleTuning2,St.sxScaleTuningF=St.sxScaleTuning2F,St.sxMasterTranspose=St.sxMasterCoarseTuning,St.sxMasterTransposeF=St.sxMasterCoarseTuningF,St.gsMasterTranspose=St.gsMasterCoarseTuning,St.gsMasterTransposeF=St.gsMasterCoarseTuningF,St.xgMasterTranspose=St.xgMasterCoarseTuning,St.xgMasterTransposeF=St.xgMasterCoarseTuningF;var rn={bank:function(l,p,I){return typeof I>"u"?[It.bankMSB(l,Zt(p)),It.bankLSB(l,wt(p))]:[It.bankMSB(l,p),It.bankLSB(l,I)]},modF:function(l,p){return rn.mod(l,Q.to14b(p))},mod:function(l,p,I){return typeof I>"u"?[It.modMSB(l,Zt(p)),It.modLSB(l,wt(p))]:[It.modMSB(l,p),It.modLSB(l,I)]},breathF:function(l,p){return rn.breath(l,Q.to14b(p))},breath:function(l,p,I){return typeof I>"u"?[It.breathMSB(l,Zt(p)),It.breathLSB(l,wt(p))]:[It.breathMSB(l,p),It.breathLSB(l,I)]},footF:function(l,p){return rn.foot(l,Q.to14b(p))},foot:function(l,p,I){return typeof I>"u"?[It.footMSB(l,Zt(p)),It.footLSB(l,wt(p))]:[It.footMSB(l,p),It.footLSB(l,I)]},portamentoTimeF:function(l,p){return rn.portamentoTime(l,Q.to14b(p))},portamentoTime:function(l,p,I){return typeof I>"u"?[It.portamentoMSB(l,Zt(p)),It.portamentoLSB(l,wt(p))]:[It.portamentoMSB(l,p),It.portamentoLSB(l,I)]},dataF:function(l,p){return rn.data(l,Q.to14b(p))},data:function(l,p,I){return typeof I>"u"?[It.dataMSB(l,Zt(p)),It.dataLSB(l,wt(p))]:[It.dataMSB(l,p),It.dataLSB(l,I)]},volumeF:function(l,p){return rn.volume(l,Q.to14b(p))},volume:function(l,p,I){return typeof I>"u"?[It.volumeMSB(l,Zt(p)),It.volumeLSB(l,wt(p))]:[It.volumeMSB(l,p),It.volumeLSB(l,I)]},balanceF:function(l,p){return rn.balance(l,Q.to14b((p+1)/2))},balance:function(l,p,I){return typeof I>"u"?[It.balanceMSB(l,Zt(p)),It.balanceLSB(l,wt(p))]:[It.balanceMSB(l,p),It.balanceLSB(l,I)]},panF:function(l,p){return rn.pan(l,Q.to14b((p+1)/2))},pan:function(l,p,I){return typeof I>"u"?[It.panMSB(l,Zt(p)),It.panLSB(l,wt(p))]:[It.panMSB(l,p),It.panLSB(l,I)]},expressionF:function(l,p){return rn.expression(l,Q.to14b(p))},expression:function(l,p,I){return typeof I>"u"?[It.expressionMSB(l,Zt(p)),It.expressionLSB(l,wt(p))]:[It.expressionMSB(l,p),It.expressionLSB(l,I)]},nrpn:function(l,p,I){return typeof I>"u"?[It.nrpnMSB(l,Zt(p)),It.nrpnLSB(l,wt(p))]:[It.nrpnMSB(l,p),It.nrpnLSB(l,I)]},rpn:function(l,p,I){return typeof I>"u"?[It.rpnMSB(l,Zt(p)),It.rpnLSB(l,wt(p))]:[It.rpnMSB(l,p),It.rpnLSB(l,I)]},rpnPitchBendRange:function(l,p,I){return rn.rpn(l,0,0).concat(rn.data(l,p,I))},rpnPitchBendRangeF:function(l,p){return rn.rpnPitchBendRange(l,We(p-p%1),Math.floor(p%1*100))},rpnFineTuning:function(l,p,I){return rn.rpn(l,0,1).concat(rn.data(l,p,I))},rpnFineTuningF:function(l,p){return rn.rpn(l,0,1).concat(rn.dataF(l,(p%1+1)/2))},rpnCoarseTuning:function(l,p){return rn.rpn(l,0,2).concat([It.dataMSB(l,p)])},rpnCoarseTuningF:function(l,p){return rn.rpn(l,0,2).concat([It.dataMSB(l,64+(p-p%1))])},rpnTuning:function(l,p,I,O){return rn.rpnCoarseTuning(l,p).concat(rn.rpnFineTuning(l,I,O))},rpnTuningF:function(l,p){return rn.rpnCoarseTuningF(l,p).concat(rn.rpnFineTuningF(l,p))},rpnTuningA:function(l,p){return rn.rpnTuningF(l,Q.shift(p))},rpnSelectTuningProgram:function(l,p){return rn.rpn(l,0,3).concat([It.dataMSB(l,p)])},rpnSelectTuningBank:function(l,p){return rn.rpn(l,0,4).concat([It.dataMSB(l,p)])},rpnSelectTuning:function(l,p,I){return typeof I>"u"?rn.rpnSelectTuningProgram(l,p):rn.rpnSelectTuningBank(l,p).concat(rn.rpnSelectTuningProgram(l,I))},rpnModulationDepthRange:function(l,p,I){return rn.rpn(l,0,5).concat(rn.data(l,p,I))},rpnModulationDepthRangeF:function(l,p){return rn.rpnModulationDepthRange(l,We(p-p%1),Math.floor(p%1*128))},rpnNull:function(l){return rn.rpn(l,127,127)},mode1:function(l){return[It.omni(l,!0),It.poly(l)]},mode2:function(l){return[It.omni(l,!0),It.mono(l)]},mode3:function(l){return[It.omni(l,!1),It.poly(l)]},mode4:function(l){return[It.omni(l,!1),It.mono(l)]}};rn.rpnTranspose=rn.rpnCoarseTuningF;var _={sxMasterTuning:function(l,p,I){return[St.sxMasterCoarseTuning.call(this,l),St.sxMasterFineTuning.call(this,p,I)]},sxMasterTuningF:function(l){return[St.sxMasterCoarseTuningF.call(this,l),St.sxMasterFineTuningF.call(this,l)]},gsMasterTuningF:function(l){return[St.gsMasterCoarseTuningF.call(this,l),St.gsMasterFineTuningF.call(this,l)]},xgMasterTuningF:function(l){return[St.xgMasterCoarseTuningF.call(this,l),St.xgMasterFineTuningF.call(this,l)]},sxMasterTuningA:function(l){return _.sxMasterTuningF.call(this,Q.shift(l))},gsMasterTuningA:function(l){return _.gsMasterTuningF.call(this,Q.shift(l))},xgMasterTuningA:function(l){return _.xgMasterTuningF.call(this,Q.shift(l))},gsScaleTuning:function(l,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var O=0;O<12;O++)I.push(St.gsOctaveTuning.call(this,l,O,p[O]));return I},gsScaleTuningF:function(l,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var O=0;O<12;O++)I.push(St.gsOctaveTuningF.call(this,l,O,p[O]));return I},xgScaleTuning:function(l,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var O=0;O<12;O++)I.push(St.xgOctaveTuning.call(this,l,O,p[O]));return I},xgScaleTuningF:function(l,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var O=0;O<12;O++)I.push(St.xgOctaveTuningF.call(this,l,O,p[O]));return I}};function U(l,p){var I=new Q;return I.ff=In(l),I.dd=typeof p>"u"?"":Kn(p),I}var q={smf:function(l){if(l instanceof Q)return new Q(l);var p=l instanceof Array?l:arguments,I=In(p[0]),O="";return p.length==2?O=vr(p[1]):p.length>2&&(O=vr(Array.prototype.slice.call(p,1))),U(I,O)},smfSeqNumber:function(l){if(l==parseInt(l)){if(l<0||l>65535)throw RangeError("Sequence number out of range: "+l);l=String.fromCharCode(l>>8)+String.fromCharCode(l&255)}else if(l=""+l,l.length==0)l="\0\0";else if(l.length==1)l="\0"+l;else if(l.length>2)throw RangeError("Sequence number out of range"+ws(l));return U(0,l)},smfText:function(l){return U(1,Je.lib.toUTF8(l))},smfCopyright:function(l){return U(2,Je.lib.toUTF8(l))},smfSeqName:function(l){return U(3,Je.lib.toUTF8(l))},smfInstrName:function(l){return U(4,Je.lib.toUTF8(l))},smfLyric:function(l){return U(5,Je.lib.toUTF8(l))},smfMarker:function(l){return U(6,Je.lib.toUTF8(l))},smfCuePoint:function(l){return U(7,Je.lib.toUTF8(l))},smfProgName:function(l){return U(8,Je.lib.toUTF8(l))},smfDevName:function(l){return U(9,Je.lib.toUTF8(l))},smfChannelPrefix:function(l){if(l==parseInt(l))bt(l),l=String.fromCharCode(l);else if(l=""+l,l.length==0)l="\0";else if(l.length>1||l.charCodeAt(0)>15)throw RangeError("Channel number out of range"+ws(l));return U(32,l)},smfMidiPort:function(l){if(l==parseInt(l)){if(l<0||l>127)throw RangeError("Port number out of range: "+l);l=String.fromCharCode(l)}else if(l=""+l,l.length==0)l="\0";else if(l.length>1||l.charCodeAt(0)>127)throw RangeError("Port number out of range"+ws(l));return U(33,l)},smfEndOfTrack:function(l){if(vr(l)!="")throw RangeError("Unexpected data"+ws(vr(l)));return U(47)},smfTempo:function(l){if((""+l).length==3)return U(81,l);if(l==parseInt(l)&&l>0&&l<=16777215)return U(81,String.fromCharCode(l>>16)+String.fromCharCode(l>>8&255)+String.fromCharCode(l&255));throw RangeError("Out of range"+ws(vr(l)))},smfBPM:function(l){return q.smfTempo(Math.round(6e7/l))},smfSMPTE:function(l){if(l instanceof Ht)return U(84,String.fromCharCode(l.hour)+String.fromCharCode(l.minute)+String.fromCharCode(l.second)+String.fromCharCode(l.frame)+String.fromCharCode(l.quarter%4*25));var p=""+l;if(p.length==5)return U(84,l);var I=l instanceof Array?l:Array.prototype.slice.call(arguments);return I.splice(0,0,30),q.smfSMPTE(new Ht(I))},smfTimeSignature:function(l,p,I,O){var W,oe,he,He,$e=(""+l).match(/^\s*(\d+)\s*\/\s*(\d+)\s*$/);if($e){if(W=parseInt($e[1]),oe=parseInt($e[2]),W>0&&W<256&&oe>0&&!(oe&oe-1)){for(he=oe,oe=0,he>>=1;he;he>>=1)oe++;return he=p==parseInt(p)?p:24,He=I==parseInt(I)?I:8,U(88,String.fromCharCode(W)+String.fromCharCode(oe)+String.fromCharCode(he)+String.fromCharCode(He))}else if((""+l).length==4)return U(88,l)}else if(l==parseInt(l)&&p==parseInt(p)){if(l>0&&l<256&&p>0&&!(p&p-1)){for(W=l,oe=0,he=p,he>>=1;he;he>>=1)oe++;return he=I==parseInt(I)?I:24,He=O==parseInt(O)?O:8,U(88,String.fromCharCode(W)+String.fromCharCode(oe)+String.fromCharCode(he)+String.fromCharCode(He))}else if((""+l).length==4)return U(88,l);l=l+"/"+p}else if((""+l).length==4)return U(88,l);throw RangeError("Wrong time signature"+ws(vr(""+l)))},smfKeySignature:function(l){l=""+l;var p=l.match(/^\s*([A-H][b#]?)\s*(|maj|major|dur|m|min|minor|moll)\s*$/i);if(p){var I={CB:0,GB:1,DB:2,AB:3,EB:4,BB:5,F:6,C:7,G:8,D:9,A:10,E:11,B:12,H:12,"F#":13,"C#":14,"G#":15,"D#":16,"A#":17}[p[1].toUpperCase()],O={"":0,MAJ:0,MAJOR:0,DUR:0,M:1,MIN:1,MINOR:1,MOLL:1}[p[2].toUpperCase()];typeof I<"u"&&typeof O<"u"&&(O&&(I-=3),I-=7,I>=-7&&I<0?l=String.fromCharCode(256+I)+String.fromCharCode(O):I>=0&&I<=7&&(l=String.fromCharCode(I)+String.fromCharCode(O)))}if(l.length==2&&l.charCodeAt(1)<=1&&(l.charCodeAt(0)<=7||l.charCodeAt(0)<=255&&l.charCodeAt(0)>=249))return U(89,l);throw RangeError("Incorrect key signature"+ws(l))},smfSequencer:function(l){return U(127,vr(l))}},se={};function Be(l,p){Q[l]=function(){return new Q(p.apply(this,arguments))},se[l]=function(){return this.send(p.apply(this,arguments))}}function ke(l,p){Q[l]=function(){return p.apply(this,arguments)},se[l]=function(){return this.send(p.apply(this,arguments))}}function je(l,p){Q[l]=function(){var I,O=[],W=p.apply(this,arguments);for(I=0;I<W.length;I++)O.push(new Q(W[I]));return O},se[l]=function(){for(var I=p.apply(this,arguments),O=this,W=0;W<I.length;W++)O=O.send(I[W]);return O}}function ut(l,p){Q[l]=function(){return new Q(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))},se[l]=function(){if(typeof this._master<"u"){var I=new Q(p.apply(this,[this._master].concat(Array.prototype.slice.call(arguments))));return I._mpe=I[1],this.send(I)}return this.send(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))}}function gt(l,p){Q[l]=function(){return new Q(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))},se[l]=function(){if(typeof this._master<"u"){var I,O=Array.prototype.slice.call(arguments);O.length<p.length?O=[this._master].concat(O):(I=Ot(O[0]),O[0]=this._master);var W=new Q(p.apply(this,O));return W._mpe=I,this.send(W)}return this.send(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))}}function qt(l,p){Q[l]=function(){var I,O=[],W=p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments)));for(I=0;I<W.length;I++)O.push(new Q(W[I]));return O},se[l]=function(){var I,O,W;if(typeof this._master<"u"){var oe,he=Array.prototype.slice.call(arguments);for(he.length<p.length?he=[this._master].concat(he):(oe=Ot(he[0]),he[0]=this._master),O=p.apply(this,he),W=this,I=0;I<O.length;I++){var He=Q(O[I]);He._mpe=oe,W=W.send(He)}return W}for(O=p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))),W=this,I=0;I<O.length;I++)W=W.send(O[I]);return W}}z(es,function(l){Be(l,es[l])}),z(St,function(l){Be(l,St[l])}),z(q,function(l){ke(l,q[l])}),z(_,function(l){je(l,_[l])}),z(Lr,function(l){ut(l,Lr[l])}),z(It,function(l){gt(l,It[l])}),z(rn,function(l){qt(l,rn[l])});function cn(l){z(se,function(p){l.prototype[p]=se[p]})}cn(Ne);var On={a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};for(a=0;a<16;a++)On[a]=a;Q.prototype.getChannel=function(){if(this.ff==32&&this.dd.length==1&&this.dd.charCodeAt(0)<16)return this.dd.charCodeAt(0);var l=this[0];if(!(typeof l>"u"||l<128||l>239))return l&15},Q.prototype.setChannel=function(l){if(l=On[l],typeof l>"u")return this;if(this.ff==32)this.dd=String.fromCharCode(l);else{var p=this[0];typeof p<"u"&&p>=128&&p<=239&&(this[0]=p&240|l)}return this},Q.prototype.getNote=function(){var l=this[0];if(!(typeof l>"u"||l<128||l>175))return this[1]},Q.prototype.setNote=function(l){var p=this[0];return typeof p>"u"||p<128||p>175?this:(l=Q.noteValue(l),typeof l<"u"&&(this[1]=l),this)},Q.prototype.getVelocity=function(){var l=this[0];if(!(typeof l>"u"||l<128||l>159))return this[2]},Q.prototype.setVelocity=function(l){var p=this[0];return typeof p>"u"||p<128||p>159?this:(l=parseInt(l),l>=0&&l<128&&(this[2]=l),this)},Q.prototype.getSysExId=function(){if(this[0]==240)return this[2]},Q.prototype.setSysExId=function(l){return this[0]==240&&this.length>2&&(l=parseInt(l),l>=0&&l<128&&(this[2]=l)),this},Q.prototype.getData=function(){if(typeof this.dd<"u")return this.dd.toString()},Q.prototype.setData=function(l){return this.dd=vr(l),this};function wi(l,p){return l==127&&typeof p<"u"&&p.charCodeAt(0)==67&&p.charCodeAt(1)==123}function Ii(l,p){return wi(l,p)&&p.charCodeAt(2)==1}function ei(l,p){if(l>=0&&l<=127&&p>=0&&p<=127){var I=l&15,O=l>>4;if(I>0&&I<8&&O<7)I=["C","D","E","F","G","A","B"][I-1]+["bbb","bb","b","","#","##","###"][O];else return"-";return p>34?I+"?":I+["","6","Maj7","Maj7(#11)","(9)","Maj7(9)","6(9)","aug","m","m6","m7","m7b5","m(9)","m7(9)","m7(11)","m+7","m+7(9)","dim","dim7","7","7sus4","7b5","7(9)","7(#11)","7(13)","7(b9)","7(b13)","7(#9)","Maj7aug","7aug","1+8","1+5","sus4","1+2+5","cc"][p]}return"-"}Q.prototype.getText=function(){if(typeof this.dd<"u")return Ii(this.ff,this.dd)?ei(this.dd.charCodeAt(3),this.dd.charCodeAt(4)):Je.lib.fromUTF8(this.dd);if(this.isMidiSoft()){for(var l=[],p=6;p<this.length-1;p++)l.push(String.fromCharCode(this[p]));return l.join("")}},Q.prototype.setText=function(l){return this.dd=Je.lib.toUTF8(l),this},Q.prototype.getTempo=function(){if(this.ff==81&&typeof this.dd<"u")return this.dd.charCodeAt(0)*65536+this.dd.charCodeAt(1)*256+this.dd.charCodeAt(2)},Q.prototype.getBPM=function(){var l=this.getTempo();if(l)return 6e7/l},Q.prototype.getTimeSignature=function(){if(this.ff==88&&typeof this.dd<"u")return[this.dd.charCodeAt(0),1<<this.dd.charCodeAt(1)]},Q.prototype.getTimeSignature4=function(){if(this.ff==88&&typeof this.dd<"u"){var l=[this.dd.charCodeAt(0),1<<this.dd.charCodeAt(1)];return this.dd.length==4&&l.push(this.dd.charCodeAt(2),this.dd.charCodeAt(3)),l}},Q.prototype.getKeySignature=function(){if(this.ff==89&&typeof this.dd<"u"){var l=this.dd.charCodeAt(0),p=this.dd.charCodeAt(1);if(l&128&&(l=l-256),l>=-7&&l<=7&&p>=0&&p<=1)return[l,["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#","G#","D#","A#"][p?l+10:l+7],!!p]}},Q.prototype.isNoteOn=function(){var l=this[0];return typeof l>"u"||l<144||l>159?!1:this[2]>0},Q.prototype.isNoteOff=function(){var l=this[0];return typeof l>"u"||l<128||l>159?!1:l<144?!0:this[2]==0},Q.prototype.isSysEx=function(){return this[0]==240},Q.prototype.isFullSysEx=function(){return this[0]==240&&this[this.length-1]==247},Q.prototype.isMidiSoft=function(){return this.isFullSysEx()&&this[1]==0&&this[2]==32&&this[3]==36&&this[4]==0},Q.prototype.isSMF=function(){return this.ff>=0&&this.ff<=127},Q.prototype.isEOT=function(){return this.ff==47},Q.prototype.isText=function(){return this.ff==1},Q.prototype.isCopyright=function(){return this.ff==2},Q.prototype.isSeqName=function(){return this.ff==3},Q.prototype.isInstrName=function(){return this.ff==4},Q.prototype.isLyric=function(){return this.ff==5},Q.prototype.isMarker=function(){return this.ff==6},Q.prototype.isCuePoint=function(){return this.ff==7},Q.prototype.isProgName=function(){return this.ff==8},Q.prototype.isDevName=function(){return this.ff==9},Q.prototype.isTempo=function(){return this.ff==81},Q.prototype.isTimeSignature=function(){return this.ff==88},Q.prototype.isKeySignature=function(){return this.ff==89},Q.prototype.isGmReset=function(){return this.match([240,126,[0,0],9,[0,0],247])},Q.prototype.isGsReset=function(){return this.match([240,65,[0,0],66,18,64,0,127,0,65,247])},Q.prototype.isXgReset=function(){return this.match([240,67,[16,240],76,0,0,126,0,247])},Q.prototype.match=function(l){var p,I;for(p=0;p<l.length;p++)if(I=l[p][1],typeof I>"u"){if(this[p]!=l[p])return!1}else if((this[p]&I)!=(l[p][0]&I))return!1;return!0};function bi(l){for(var p=[],I=0;I<l.length;I++)p[I]=l.charCodeAt(I);return p}function Si(l){for(var p="",I=0;I<l.length;I++)p+=String.fromCharCode(l[I]);return p}function vr(l){return l instanceof Array?Si(l):typeof l>"u"?"":""+l}function ti(l){for(var p=0,I=0;I<l.length;I++)p=(p<<8)+l.charCodeAt(I);return p}function Jn(l){return(l<16?"0":"")+l.toString(16)}function Ur(l){for(var p=[],I=0;I<l.length;I++)p.push(Jn(l[I]));return p.join(" ")}function Cs(l){for(var p=[],I=0;I<l.length;I++)I&&I%4==0&&p.push(" "),p.push(Jn(l[I]));return p.join("")}function xs(l){for(var p="",I=0;I<l.length;I++)l[I]==`
`?p+="\\n":l[I]=="\r"?p+="\\r":l[I]=="	"?p+="\\t":l.charCodeAt(I)<32?p+="\\x"+Jn(l.charCodeAt(I)):p+=l[I];return p}function Ta(l){return l.length?": "+Ur(bi(l)):""}function ws(l){return l.length?": "+xs(Je.lib.fromUTF8(l)):""}Q.prototype.label=function(l){return this.lbl=this.lbl?this.lbl+", "+l:l,this},Q.prototype.toString=function(){return this.lbl?this._str()+" ("+this.lbl+")":this._str()},Q.prototype._str=function(){var l,p;if(this.length)l=Ur(this);else{if(typeof this.ff>"u")return"empty";l="ff"+Jn(this.ff)}return p=this._string(),p?l+" -- "+p:l},Q.prototype._string=function(){var l="",p;if(!this.length){if(this.ff==0)l+="Sequence Number: "+ti(this.dd);else if(this.ff>0&&this.ff<10)l+=["","Text","Copyright","Sequence Name","Instrument Name","Lyric","Marker","Cue Point","Program Name","Device Name"][this.ff]+ws(this.dd);else if(this.ff==32)l+="Channel Prefix"+Ta(this.dd);else if(this.ff==33)l+="MIDI Port"+Ta(this.dd);else if(this.ff==47)l+="End of Track"+Ta(this.dd);else if(this.ff==81){var I=Math.round(this.getBPM()*100)/100;l+="Tempo: "+I+" bpm"}else if(this.ff==84)l+="SMPTE Offset: "+Ie(bi(this.dd));else if(this.ff==88){var O=1<<this.dd.charCodeAt(1);l+="Time Signature: "+this.dd.charCodeAt(0)+"/"+O,l+=" "+this.dd.charCodeAt(2)+" "+this.dd.charCodeAt(3)}else if(this.ff==89){l+="Key Signature: ";var W=this.getKeySignature();W?(l+=W[1],W[2]&&(l+=" min")):l+="invalid"}else if(this.ff==127){if(this.dd.charCodeAt(0)==67&&this.dd.charCodeAt(1)==123)return l+="[XF:"+Jn(this.dd.charCodeAt(2))+"]",p={0:"Version",1:"Chord",2:"Rehearsal Mark",3:"Phrase Mark",4:"Max Phrase Mark",5:"Fingering Number",12:"Guide Track Flag",16:"Guitar Info",18:"Chord Voicing",127:"XG Song Data Number"}[this.dd.charCodeAt(2)],l+=p?" "+p:"",l+=": ",this.dd.charCodeAt(2)==0?l+this.dd.substring(3,7)+" "+Ur(bi(this.dd.substring(7))):this.dd.charCodeAt(2)==1?l+this.getText():l+Ur(bi(this.dd.substring(3)));l+="Sequencer Specific"+Ta(this.dd)}else l+="SMF"+Ta(this.dd);return l}if(p={241:"MIDI Time Code",242:"Song Position",243:"Song Select",244:"Undefined",245:"Undefined",246:"Tune request",248:"Timing clock",249:"Undefined",250:"Start",251:"Continue",252:"Stop",253:"Undefined",254:"Active Sensing",255:"Reset"}[this[0]],p)return p;if(this.isMidiSoft())return p=xs(this.getText()),p&&(p=" "+p),"[K:"+Jn(this[5])+"]"+p;var oe=this[0]>>4;return p={8:"Note Off",10:"Aftertouch",12:"Program Change",13:"Channel Aftertouch",14:"Pitch Wheel"}[oe],p||(oe==9?this[2]?"Note On":"Note Off":oe!=11?l:(p={0:"Bank Select MSB",1:"Modulation Wheel MSB",2:"Breath Controller MSB",4:"Foot Controller MSB",5:"Portamento Time MSB",6:"Data Entry MSB",7:"Channel Volume MSB",8:"Balance MSB",10:"Pan MSB",11:"Expression Controller MSB",12:"Effect Control 1 MSB",13:"Effect Control 2 MSB",16:"General Purpose Controller 1 MSB",17:"General Purpose Controller 2 MSB",18:"General Purpose Controller 3 MSB",19:"General Purpose Controller 4 MSB",31:"Karaoke",32:"Bank Select LSB",33:"Modulation Wheel LSB",34:"Breath Controller LSB",36:"Foot Controller LSB",37:"Portamento Time LSB",38:"Data Entry LSB",39:"Channel Volume LSB",40:"Balance LSB",42:"Pan LSB",43:"Expression Controller LSB",44:"Effect control 1 LSB",45:"Effect control 2 LSB",48:"General Purpose Controller 1 LSB",49:"General Purpose Controller 2 LSB",50:"General Purpose Controller 3 LSB",51:"General Purpose Controller 4 LSB",64:"Damper Pedal",65:"Portamento",66:"Sostenuto",67:"Soft Pedal",68:"Legato",69:"Hold 2",70:"Sound Variation",71:"Filter Resonance",72:"Release Time",73:"Attack Time",74:"Brightness",75:"Decay Time",76:"Vibrato Rate",77:"Vibrato Depth",78:"Vibrato Delay",79:"Sound Controller 10",80:"General Purpose Controller 5",81:"General Purpose Controller 6",82:"General Purpose Controller 7",83:"General Purpose Controller 8",84:"Portamento Control",88:"High Resolution Velocity Prefix",91:"Effects 1 Depth",92:"Effects 2 Depth",93:"Effects 3 Depth",94:"Effects 4 Depth",95:"Effects 5 Depth",96:"Data Increment",97:"Data Decrement",98:"Non-Registered Parameter Number LSB",99:"Non-Registered Parameter Number MSB",100:"Registered Parameter Number LSB",101:"Registered Parameter Number MSB",120:"All Sound Off",121:"Reset All Controllers",122:"Local Control On/Off",123:"All Notes Off",124:"Omni Mode Off",125:"Omni Mode On",126:"Mono Mode On",127:"Poly Mode On"}[this[1]],this[1]>=64&&this[1]<=69&&(p+=this[2]<64?" Off":" On"),p||(p="Undefined"),p))},Q.prototype._stamp=function(l){return this._from.push(l._orig?l._orig:l),this},Q.prototype._unstamp=function(l){if(typeof l>"u")this._from=[];else{l._orig&&(l=l._orig);var p=this._from.indexOf(l);p>-1&&this._from.splice(p,1)}return this},Q.prototype._stamped=function(l){l._orig&&(l=l._orig);for(var p=0;p<this._from.length;p++)if(this._from[p]==l)return!0;return!1},Je.MIDI=Q,L.prototype.MIDI=Q;function _a(l){typeof l>"u"?this._cc={}:this._cc[l]={}}function Od(l,p){var I=typeof l>"u"?"??":Jn(l),O=typeof p>"u"?"??":Jn(p),W={"0000":"Pitch Bend Sensitivity","0001":"Channel Fine Tuning","0002":"Channel Coarse Tuning","0003":"Select Tuning Program","0004":"Select Tuning Bank","0005":"Vibrato Depth Range","7f7f":"NONE"}[I+""+O];return"RPN "+I+" "+O+(W?": "+W:"")}function ts(l,p){var I=typeof l>"u"?"??":Jn(l),O=typeof p>"u"?"??":Jn(p);return"NRPN "+I+" "+O}function io(l){var p,I="";for(p=0;p<l.length&&l[p];p++)I+=String.fromCharCode(l[p]);return Je.lib.fromUTF8(I)}function Ra(l){var p,I,O,W,oe,he,He,$e="x",mt="x";if(l.isMidi2?(O=l[0]>>4,$e=(l[0]&15).toString(16),I=$e,this._cc[I]||(this._cc[I]={}),O==2?p=new Q(l.slice(1)):O==3?(W=l[1]>>4,oe=l[1]&15,he=l.slice(2,2+oe),W==0&&(p=new Q([240].concat(he,[247])),this._cc[I].sx=void 0),W==1&&(this._cc[I].sx=he),W==2&&this._cc[I].sx&&(this._cc[I].sx=this._cc[I].sx.concat(he)),W==3&&this._cc[I].sx&&(he=this._cc[I].sx.concat(he),p=new Q([240].concat(he,[247])),this._cc[I].sx=void 0)):O==4?(W=l[1]>>4,mt=(l[1]&15).toString(16),I=$e+mt,this._cc[I]||(this._cc[I]={}),W==12&&(l[3]&1&&(this._cc[I].bm=l[6],this._cc[I].bl=l[7]),l._bm=this._cc[I].bm,l._bl=this._cc[I].bl,Je.MIDI.programName&&l.label(Je.MIDI.programName(l[4],l._bm,l._bl)))):O==13&&(W=l[1]>>6,l[1]&48||(mt=(l[1]&15).toString(16)),I=$e+mt,this._cc[I]||(this._cc[I]={}),he=l.slice(4),W==0&&(l.label(io(he)),this._cc[I].tx=void 0),W==1&&(this._cc[I].tx=he),W==2&&this._cc[I].tx&&(this._cc[I].tx=this._cc[I].tx.concat(he)),W==3&&this._cc[I].tx&&(he=this._cc[I].tx.concat(he),l.label(io(he)),this._cc[I].tx=void 0))):p=l,!p||!p.length||p[0]<128)return l;if(p[0]==255)return this._clear(),l;if(W=p[0]>>4,mt=(p[0]&15).toString(16),I=W==15?$e:$e+mt,this._cc[I]||(this._cc[I]={}),W==12)p._bm=this._cc[I].bm,p._bl=this._cc[I].bl,Je.MIDI.programName&&l.label(Je.MIDI.programName(p[1],p._bm,p._bl));else if(W==11)switch(p[1]){case 0:this._cc[I].bm=p[2];break;case 32:this._cc[I].bl=p[2];break;case 98:this._cc[I].nl=p[2],this._cc[I].rn="n";break;case 99:this._cc[I].nm=p[2],this._cc[I].rn="n";break;case 100:this._cc[I].rl=p[2],this._cc[I].rn="r";break;case 101:this._cc[I].rm=p[2],this._cc[I].rn="r";break;case 6:case 38:case 96:case 97:this._cc[I].rn=="r"&&(p._rm=this._cc[I].rm,p._rl=this._cc[I].rl,l.label(Od(this._cc[I].rm,this._cc[I].rl))),this._cc[I].rn=="n"&&(p._nm=this._cc[I].rm,p._nl=this._cc[I].nl,l.label(ts(this._cc[I].nm,this._cc[I].nl)));break}else p.isFullSysEx()&&(p[1]==127?p[3]==4?(He={1:"Master Volume",2:"Master Balance",3:"Master Fine Tuning",4:"Master Coarse Tuning"}[p[4]],He&&l.label(He)):p[3]==8&&(He={2:"Note Tuning",7:"Note Tuning, Bank",8:"Scale Tuning, 1 byte format",9:"Scale Tuning, 2 byte format"}[p[4]],He&&l.label(He)):p[1]==126?p[3]==6?p[4]==1?l.label("Device ID Request"):p[4]==2&&l.label("Device ID Response"):p[3]==8?(He={0:"Bulk Tuning Dump Request",1:"Bulk Tuning Dump",3:"Bulk Tuning Dump Request, Bank",4:"Bulk Tuning Dump, Bank",5:"Scale Tuning Dump, 1 byte format",6:"Scale Tuning Dump, 2 byte format",7:"Note Tuning, Bank",8:"Scale Tuning, 1 byte format",9:"Scale Tuning, 2 byte format"}[p[4]],He&&l.label(He)):p[3]==9&&(p[4]==1?(l.label("GM1 System On"),this._clear($e),this._cc[$e].gm="1"):p[4]==2?(l.label("GM System Off"),this._clear($e),this._cc[$e].gm="0"):p[4]==3&&(l.label("GM2 System On"),this._clear($e),this._cc[$e].gm="2")):p[1]==67?(p[2]&240)==16&&p[3]==76&&(p[4]==0&&p[5]==0&&p[6]==126&&p[7]==0?(l.label("XG System On"),this._clear($e),this._cc[$e].gm="Y"):p[4]==0&&p[5]==0&&p[6]==0?l.label("XG Master Tuning"):p[4]==0&&p[5]==0&&p[6]==4?l.label("XG Master Volume"):p[4]==0&&p[5]==0&&p[6]==6?l.label("XG Master Transpose"):p[4]==8&&p[5]<16&&p[6]>=65&&p[6]<=76?l.label("XG Scale Tuning"):l.label("XG Parameter")):p[1]==65&&p[3]==66&&p[4]==18&&(p[5]==64&&(p[6]==0?p[7]==127&&p[8]==0&&p[9]==65?(l.label("GS Reset"),this._clear($e),this._cc[$e].gm="R"):p[7]==0?l.label("GS Master Tuning"):p[7]==4?l.label("GS Master Volume"):p[7]==5?l.label("GS Master Transpose"):l.label("GS Parameter"):(p[6]&240)==16&&p[7]==21?l.label("GS Drum Part Change"):(p[6]&240)==16&&p[7]>=64&&p[7]<=75?l.label("GS Scale Tuning"):l.label("GS Parameter")),p[5]==65&&l.label("GS Parameter")));return l}function Fn(){var l=new Ne;return l._clear=_a,l._read=Ra,l._receive=function(p){this._emit(this._read(p))},l.gm=function(p){return typeof p>"u"&&(p="x"),this._cc[p]&&this._cc[p].gm||0},l._clear(),l._resume(),l}Je.Context=Fn,L.prototype.Context=Fn;function yr(){var l=this instanceof yr?this:l=new yr;return l.reset(),arguments.length&&yr.prototype.setup.apply(l,arguments),l}yr.validate=function(l){var p=l instanceof Array?l:arguments;if(p[0]!=parseInt(p[0])||p[0]<0||p[0]>14)throw RangeError("Bad master channel value: "+p[0]);if(p[1]!=parseInt(p[1])||p[1]<0||p[0]+p[1]>15)throw RangeError("Bad zone size value: "+p[1])},yr.prototype.reset=function(){for(var l=0;l<16;l++)this[l]={band:0,master:l}},yr.prototype.setup=function(l,p){yr.validate(l,p);var I,O=l+p;if(!(this[l].master==l&&this[l].band==p)&&!(!p&&!this[l].band)){for(this[l].band?(I=l+this[l].band,O<I&&(O=I)):this[l].master==l-1?(I=l-1,I=I+this[I].band,O<I&&(O=I),this[l-1]={band:0,master:l-1}):this[l].master!=l&&(I=this[l].master,I=I+this[I].band,O<I&&(O=I),this[this[l].master].band=l-this[l].master-1),this[l].master=l,this[l].band=p,I=l+1;I<=l+p;I++)this[I].band&&O<I+this[I].band&&(O=I+this[I].band),this[I]={band:0,master:l};for(;I<=O;I++)this[I]={band:0,master:I}}},yr.prototype.filter=function(l){var p=l.getChannel();if(!this[p]||!this[this[p].master].band)return l;var I=this[p].master,O=this[I].band,W,oe,he;if(typeof l._mpe<"u"){for(he=256,W=I+1;W<=I+O;W++)if(!this[W].notes)he>0&&(p=W,he=0);else for(he>this[W].notes.length&&(p=W,he=this[W].notes.length),oe=0;oe<this[W].notes.length;oe++)if(this[W].notes[oe]==l._mpe){p=W,he=-1;break}l.setChannel(p),l._mpe=void 0}return p==I||(l.isNoteOn()?(this[p].notes||(this[p].notes=[]),j(this[p].notes,l.getNote())):l.isNoteOff()&&this[p].notes&&J(this[p].notes,l.getNote())),l},Je.MPE=yr;function vt(l){var p=this instanceof vt?this:p=new vt,I;if(l instanceof vt)return p._from=l._from.slice(),z(l,function(W){W!="_from"&&(p[W]=l[W])}),p;p._from=[],typeof l>"u"&&(l=[0,0,0,0]);var O=l instanceof Array?l:arguments;for(p.length=0,I=0;I<O.length;I++)d=O[I],(d!=parseInt(d)||d<0||d>255)&&ht(O[I]),p.push(d);if(p.length!=[4,4,4,8,8,16,4,4,8,8,8,12,12,16,16,16][p[0]>>4])throw RangeError("Wrong UMP size");return p}vt.prototype=[],vt.prototype.constructor=vt,vt.prototype.isMidi=function(){return 2},vt.prototype.isMidi2=!0,vt.prototype.dump=function(){var l,p="";for(l=0;l<this.length;l++)p+=String.fromCharCode(this[l]);return p};function ui(){}ui.prototype=vt,vt._sxid=127,vt.sxId=function(l){if(typeof l>"u"&&(l=vt._sxid),l==this._sxid)return this;l=We(l);var p=new ui;return p._ch=this._ch,p._gr=this._gr,p._sxid=l,p},vt.ch=function(l){if(l==this._ch||typeof l>"u"&&typeof this._ch>"u")return this;var p=new ui;return typeof l<"u"&&(l=Fe(l)),p._ch=l,p._gr=this._gr,p._sxid=this._sxid,p},vt.gr=function(l){if(l==this._gr||typeof l>"u"&&typeof this._gr>"u")return this;var p=new ui;return typeof l<"u"&&(l=lt(l)),p._ch=this._ch,p._gr=l,p._sxid=this._sxid,p},vt.prototype.getGroup=function(){if(this[0]){var l=this[0]>>4;if(l==1||l==2||l==3||l==4||l==5||l==13)return this[0]&15}};var ir=[0,0,0,0,0,0,0,0,0,0,0,0,0];function di(l,p,I,O){return typeof p<"u"?[In(l),In(p),In(I),In(O)]:(l=bn(l),[l>>24&255,l>>16&255,l>>8&255,l&255])}function ns(l){return l=Math.floor(l*4294967296),l>4294967295?4294967295:l<0?0:l}var Da={noop:function(){return[0,0,0,0]},umpClock:function(l){return l=fe(l),[0,16,l>>8,l&255]},umpTimestamp:function(l){return l=fe(l),[0,32,l>>8,l&255]},umpTicksPQN:function(l){return l=fe(l),[0,48,l>>8,l&255]},umpDelta:function(l){return l=l||0,l=ze(l),[0,64+(l>>16),l>>8&255,l&255]},umpStartClip:function(){return[240,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},umpEndClip:function(){return[240,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Us={umpTempo:function(l,p){return[208+lt(l),16,0,0].concat(di(p),[0,0,0,0,0,0,0,0])},umpBPM:function(l,p){return Us.umpTempo(l,Math.round(6e9/p))},umpTimeSignature:function(l,p,I){var O,W,oe,he=(""+p).match(/^\s*(\d+)\s*\/\s*(\d+)\s*$/);if(he?(O=parseInt(he[1]),W=parseInt(he[2])):p==parseInt(p)&&I==parseInt(I)&&(O=parseInt(p),W=parseInt(I)),O>0&&O<256&&W>0&&!(W&W-1)){for(oe=0,W>>=1;W;W>>=1)oe++;if(W=Math.round(O*32/(1<<oe)),W<256)return[208+lt(l),16,0,1,O,oe,W,0,0,0,0,0,0,0,0,0]}throw RangeError("Wrong time signature "+p+(typeof I>"u"?"":"/"+I))}},Wo={umpMetadata:function(l,p){return dn.umpCustomText(l,0,1,1,0,p)},umpProjectName:function(l,p){return dn.umpCustomText(l,0,1,1,1,p)},umpCompositionName:function(l,p){return dn.umpCustomText(l,0,1,1,2,p)},umpClipName:function(l,p){return dn.umpCustomText(l,0,1,1,3,p)},umpCopyright:function(l,p){return dn.umpCustomText(l,0,1,1,4,p)},umpComposerName:function(l,p){return dn.umpCustomText(l,0,1,1,5,p)},umpLyricistName:function(l,p){return dn.umpCustomText(l,0,1,1,6,p)},umpArrangerName:function(l,p){return dn.umpCustomText(l,0,1,1,7,p)},umpPublisherName:function(l,p){return dn.umpCustomText(l,0,1,1,8,p)},umpPerformerName:function(l,p){return dn.umpCustomText(l,0,1,1,9,p)},umpAccPerformerName:function(l,p){return dn.umpCustomText(l,0,1,1,10,p)},umpRecordingDate:function(l,p){return dn.umpCustomText(l,0,1,1,11,p)},umpRecordingLocation:function(l,p){return dn.umpCustomText(l,0,1,1,12,p)},umpText:function(l,p){return dn.umpCustomText(l,0,1,2,0,p)},umpLyrics:function(l,p){return dn.umpCustomText(l,0,1,2,1,p)},umpLyricsLanguage:function(l,p){return dn.umpCustomText(l,0,1,2,2,p)},umpRuby:function(l,p){return dn.umpCustomText(l,0,1,2,3,p)},umpRubyLanguage:function(l,p){return dn.umpCustomText(l,0,1,2,4,p)},umpData:function(l,p,I){typeof I>"u"&&(I=p,p=0);var O,W=Is(Al(I),13);for(O=0;O<W.length;O++)W[O]=[80+lt(l),Gs(W.length,O)*16+W[O].length,In(p)].concat(W[O],ir).slice(0,16);return W}},Dc=[0,6,32,38,98,99,100,101],Vn={umpNoteOn:function(l,p,I,O,W,oe){return typeof O>"u"&&(O=65535),W=W||0,oe=oe||0,O=fe(O),oe=fe(oe),[64+lt(l),144+Fe(p),Ot(I),In(W),O>>8,O&255,oe>>8,oe&255]},umpNoteOff:function(l,p,I,O,W,oe){return O=O||0,W=W||0,oe=oe||0,O=fe(O),oe=fe(oe),[64+lt(l),128+Fe(p),Ot(I),In(W),O>>8,O&255,oe>>8,oe&255]},umpAftertouch:function(l,p,I,O,W,oe,he){return[64+lt(l),160+Fe(p),Ot(I),0].concat(di(O,W,oe,he))},umpAftertouchF:function(l,p,I,O){return Vn.umpAftertouch(l,p,I,ns(O))},umpControl:function(l,p,I,O,W,oe,he){return Dc.includes(I)&&ht(I),[64+lt(l),176+Fe(p),We(I),0].concat(di(O,W,oe,he))},umpPortamento:function(l,p,I){return[64+lt(l),176+Fe(p),84,0,Ot(I),0,0,0]},umpPressure:function(l,p,I,O,W,oe){return[64+lt(l),208+Fe(p),0,0].concat(di(I,O,W,oe))},umpPressureF:function(l,p,I){return Vn.umpPressure(l,p,ns(I))},umpProgram:function(l,p,I,O,W){return typeof O>"u"&&typeof W>"u"?[64+lt(l),192+Fe(p),0,0,Ot(I),0,0,0]:typeof W>"u"?[64+lt(l),192+Fe(p),0,1,Ot(I),0,Zt(O),wt(O)]:[64+lt(l),192+Fe(p),0,1,Ot(I),0,We(O),We(W)]},umpPitchBend:function(l,p,I,O,W,oe){return[64+lt(l),224+Fe(p),0,0].concat(di(I,O,W,oe))},umpPitchBendF:function(l,p,I){return Vn.umpPitchBend(l,p,ns((I+1)/2))},umpPnPitchBend:function(l,p,I,O,W,oe,he){return[64+lt(l),96+Fe(p),Ot(I),0].concat(di(O,W,oe,he))},umpPnPitchBendF:function(l,p,I,O){return Vn.umpPnPitchBend(l,p,I,ns((O+1)/2))},umpRPN:function(l,p,I,O,W,oe,he,He){return[64+lt(l),32+Fe(p),We(I),We(O)].concat(di(W,oe,he,He))},umpNRPN:function(l,p,I,O,W,oe,he,He){return[64+lt(l),48+Fe(p),We(I),We(O)].concat(di(W,oe,he,He))},umpPnRPN:function(l,p,I,O,W,oe,he,He){return[64+lt(l),0+Fe(p),Ot(I),In(O)].concat(di(W,oe,he,He))},umpPnNRPN:function(l,p,I,O,W,oe,he,He){return[64+lt(l),16+Fe(p),Ot(I),In(O)].concat(di(W,oe,he,He))},umpFineTuning:function(l,p,I,O,W,oe){return Vn.umpRPN(l,p,0,1,I,O,W,oe)},umpFineTuningF:function(l,p,I){return Vn.umpFineTuning(l,p,Q.to32b(nr((I%1+1)/2,I)))},umpCoarseTuning:function(l,p,I){return[64+lt(l),32+Fe(p),0,2,We(I)*2,0,0,0]},umpCoarseTuningF:function(l,p,I){return Vn.umpCoarseTuning(l,p,64+(I-I%1))},umpTuningProgram:function(l,p,I){return[64+lt(l),32+Fe(p),0,3,We(I)*2,0,0,0]},umpTuningBank:function(l,p,I){return[64+lt(l),32+Fe(p),0,4,We(I)*2,0,0,0]},umpPnManagement:function(l,p,I,O){for(var W=O.toString().split(""),oe=0,he=0;he<W.length;he++)if(W[he]=="S"&&!(oe&1))oe|=1;else if(W[he]=="D"&&!(oe&2))oe|=2;else{oe=O;break}return[64+lt(l),240+Fe(p),Ot(I),In(oe),0,0,0,0]}};Vn.umpPnPressure=Vn.umpAftertouch,Vn.umpPnPressureF=Vn.umpAftertouchF,Vn.umpTranspose=Vn.umpCoarseTuningF;var dn={umpTuningF:function(l,p,I){return[Vn.umpCoarseTuningF(l,p,I),Vn.umpFineTuningF(l,p,I)]},umpTuningA:function(l,p,I){return dn.umpTuningF(l,p,Q.shift(I))},umpCustomText:function(l,p,I,O,W,oe){var he,He=[];for(oe=Je.lib.toUTF8(""+oe),he=0;he<oe.length;he++)He.push(oe.charCodeAt(he));for(He=Is(He,12),he=0;he<He.length;he++)He[he]=[208+lt(l),Gs(He.length,he)*64+(I?16:0)+Fe(p),O,W].concat(He[he],ir).slice(0,16);return He},umpCMetadata:function(l,p,I){return dn.umpCustomText(l,p,0,1,0,I)},umpCProjectName:function(l,p,I){return dn.umpCustomText(l,p,0,1,1,I)},umpCCompositionName:function(l,p,I){return dn.umpCustomText(l,p,0,1,2,I)},umpCClipName:function(l,p,I){return dn.umpCustomText(l,p,0,1,3,I)},umpCCopyright:function(l,p,I){return dn.umpCustomText(l,p,0,1,4,I)},umpCComposerName:function(l,p,I){return dn.umpCustomText(l,p,0,1,5,I)},umpCLyricistName:function(l,p,I){return dn.umpCustomText(l,p,0,1,6,I)},umpCArrangerName:function(l,p,I){return dn.umpCustomText(l,p,0,1,7,I)},umpCPublisherName:function(l,p,I){return dn.umpCustomText(l,p,0,1,8,I)},umpCPerformerName:function(l,p,I){return dn.umpCustomText(l,p,0,1,9,I)},umpCAccPerformerName:function(l,p,I){return dn.umpCustomText(l,p,0,1,10,I)},umpCRecordingDate:function(l,p,I){return dn.umpCustomText(l,p,0,1,11,I)},umpCRecordingLocation:function(l,p,I){return dn.umpCustomText(l,p,0,1,12,I)},umpCText:function(l,p,I){return dn.umpCustomText(l,p,0,2,0,I)},umpCLyrics:function(l,p,I){return dn.umpCustomText(l,p,0,2,1,I)},umpCLyricsLanguage:function(l,p,I){return dn.umpCustomText(l,p,0,2,2,I)},umpCRuby:function(l,p,I){return dn.umpCustomText(l,p,0,2,3,I)},umpCRubyLanguage:function(l,p,I){return dn.umpCustomText(l,p,0,2,4,I)}},Gr={};function wu(l,p){vt[l]=function(){return new vt(p.apply(this,arguments))},Gr[l]=function(){return this.send(p.apply(this,arguments))}}function so(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),new vt(p.apply(this,I))},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),this.send(p.apply(this,I))}}function Pa(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var O=p.apply(this,I),W=0;W<O.length;W++)O[W]=new vt(O[W]);return O},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var O=p.apply(this,I),W=0;W<O.length;W++)this.send(O[W]);return this}}function Na(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),new vt(p.apply(this,I))},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),this.send(p.apply(this,I))}}function Vr(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var O=p.apply(this,I),W=0;W<O.length;W++)O[W]=new vt(O[W]);return O},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var O=p.apply(this,I),W=0;W<O.length;W++)this.send(O[W]);return this}}function Gs(l,p){return l==1?0:p==0?1:p==l-1?3:2}function Is(l,p){for(var I=[],O=l;O.length;O=O.slice(p))I.push(O.slice(0,p));return I.length?I:[[]]}function bs(l,p){for(var I=Is(p.slice(1,p.length-1),6),O=0;O<I.length;O++)I[O]=new vt([48+l,Gs(I.length,O)*16+I[O].length].concat(I[O],ir).slice(0,8));return I}function Al(l){var p,I=[];if(typeof l=="string")for(p=0;p<l.length;p++)I.push(l.charCodeAt(p));else for(p=0;p<l.length;p++)I.push(l[p]);for(p=0;p<I.length;p++)if(I[p]!=parseInt(I[p])||I[p]<0||I[p]>255)throw RangeError("Bad data");return I}function zo(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),bs(lt(I[0]),p.apply(this,I.slice(1)))},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var O=bs(lt(I[0]),p.apply(this,I.slice(1))),W=this,oe=0;oe<O.length;oe++)W=W.send(O[oe]);return W}}function oo(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var O=p.apply(this,I.slice(1)),W=[],oe=0;oe<O.length;oe++)W=W.concat(bs(lt(I[0]),O[oe]));return W},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var O=p.apply(this,I.slice(1)),W=this,oe=0;oe<O.length;oe++)for(var he=bs(lt(I[0]),O[oe]),He=0;He<he.length;He++)W=W.send(he[He]);return W}}function Vs(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),new vt([16+lt(I[0])].concat(p.apply(this,I.slice(1)),ir).slice(0,4))},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),this.send([16+lt(I[0])].concat(p.apply(this,I.slice(1)),ir).slice(0,4))}}function Ho(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),new vt([32+lt(I[0])].concat(p.apply(this,I.slice(1)),ir).slice(0,4))},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),this.send([32+lt(I[0])].concat(p.apply(this,I.slice(1)),ir).slice(0,4))}}function kl(l,p){vt[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var O=p.apply(this,I.slice(1)),W=0;W<O.length;W++)O[W]=new vt([32+lt(I[0])].concat(O[W],ir).slice(0,4));return O},Gr[l]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var O=p.apply(this,I.slice(1)),W=this,oe=0;oe<O.length;oe++)W=W.send([32+lt(I[0])].concat(O[oe],ir).slice(0,4));return W}}z(Da,function(l){wu(l,Da[l])}),z(Us,function(l){so(l,Us[l])}),z(Wo,function(l){Pa(l,Wo[l])}),z(Vn,function(l){Na(l,Vn[l])}),z(dn,function(l){Vr(l,dn[l])}),z(es,function(l){Vs(l,es[l])}),z(Lr,function(l){Ho(l,Lr[l])}),z(It,function(l){Ho(l,It[l])}),z(rn,function(l){kl(l,rn[l])}),z(St,function(l){zo(l,St[l])}),z(_,function(l){oo(l,_[l])});function Pc(l){z(Gr,function(p){l.prototype[p]=Gr[p]})}Pc(Rt),vt.prototype.getTempo=function(){if(this.isTempo())return(this[4]<<24)+(this[5]<<16)+(this[6]<<8)+this[7]},vt.prototype.getBPM=function(){var l=this.getTempo();if(l)return Math.round(6e9/l)},vt.prototype.getTimeSignature=function(){if(this.isTimeSignature())return[this[4],1<<this[5]]},vt.prototype.getTicksPQN=function(){if(this.isTicksPQN())return(this[2]<<8)+this[3]},vt.prototype.getDelta=function(){if(this.isDelta())return((this[1]&15)<<16)+(this[2]<<8)+this[3]},vt.prototype.getStatus=function(){if(this.isFlex())return this[1]>>6;if(this.isData()||this.isSX())return this[1]>>4},vt.prototype.isTempo=function(){return this[0]>>4==13&&this[1]>>4==1&&this[2]==0&&this[3]==0},vt.prototype.isTimeSignature=function(){return this[0]>>4==13&&this[1]>>4==1&&this[2]==0&&this[3]==1},vt.prototype.isTicksPQN=function(){return this[0]==0&&this[1]>>4==3},vt.prototype.isDelta=function(){return this[0]==0&&this[1]>>4==4},vt.prototype.isStartClip=function(){return this.match([240,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},vt.prototype.isEndClip=function(){return this.match([240,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},vt.prototype.isData=function(){return(this[0]&240)==80},vt.prototype.isFlex=function(){return(this[0]&240)==208},vt.prototype.isText=function(){return(this[0]&240)==208&&(this[2]==1||this[2]==2)},vt.prototype.isSX=function(){return(this[0]&240)==48},vt.prototype.isNoteOn=function(){var l=(this[0]||0)>>4,p=(this[1]||0)>>4;return l==4?p==9:l==2?p==9&&!!this[3]:!1},vt.prototype.isNoteOff=function(){var l=(this[0]||0)>>4,p=(this[1]||0)>>4;return l==4?p==8:l==2?p==8||p==9&&!this[3]:!1},vt.prototype.label=Q.prototype.label,vt.prototype.toString=Q.prototype.toString,vt.prototype._str=function(){var l=this._string();return l?Cs(this)+" -- "+l:Cs(this)},vt.prototype._string=function(){var l,p,I,O=this[0]>>4;return O==1||O==2?new Q(this.slice(1))._string():(O==0?(l=this[1]>>4,p=["NOOP","JR Clock","JR Timestamp","Ticks Per Quarter Note","Delta Ticks"][l]):O==3?p="SysEx":O==4?(l=this[1]>>4,p={0:"Registered Per-Note Controller",1:"Assignable Per-Note Controller",2:"Registered Controller",3:"Assignable Controller",4:"Relative Registered Controller",5:"Relative Assignable Controller",6:"Per-Note Pitch Bend",8:"Note Off",9:"Note On",10:"Poly Pressure",11:"Control Change",12:"Program Change",13:"Channel Pressure",14:"Pitch Bend",15:"Per-Note Management"}[l],l==11&&(p={84:"Portamento"}[this[2]]||p),l==2&&(I={"0000":"Pitch Bend Sensitivity","0001":"Fine Tuning","0002":"Coarse Tuning","0003":"Select Tuning Program","0004":"Select Tuning Bank","0005":"Vibrato Depth Range","7f7f":"NONE"}[Jn(this[2])+""+Jn(this[3])],I&&(p+=": "+I))):O==5?p="Data":O==13&&(l=this[2],l==0?(l=this[3],p={0:"Tempo ",1:"Time Signature ",2:"Metronome",5:"Key Signature",6:"Chord Name"}[l],l==0?p+=this.getBPM()+" BPM":l==1&&(p+=this.getTimeSignature().join("/"))):l==1?(l=this[3],p={0:"Metadata",1:"Project Name",2:"Composition Name",3:"Clip Name",4:"Copyright",5:"Composer Name",6:"Lyricist Name",7:"Arranger Name",8:"Publisher Name",9:"Primary Performer Name",10:"Accompanying Performer Name",11:"Recording Date",12:"Recording Location"}[l]||"Unknown Text"):l==2&&(l=this[3],p={0:"Text",1:"Lyrics",2:"Lyrics Language",3:"Ruby",4:"Ruby Language"}[l]||"Unknown Text")),O==15&&(p={32:"Start of Clip",33:"End of Clip"}[this[1]]),p)},vt.prototype._stamp=Q.prototype._stamp,vt.prototype._unstamp=Q.prototype._unstamp,vt.prototype._stamped=Q.prototype._stamped,vt.prototype.match=Q.prototype.match,Je.UMP=vt,L.prototype.UMP=vt,Je.MIDI2=vt,L.prototype.MIDI2=vt;function El(l,p){var I=l*256+p;return I?I>>9||1:0}function jr(l,p,I,O){var W=l*16777216+p*65536+I*256+O;return W>>25&127}function Ar(l,p){return l.gr=p,l}function Tl(l){if(l.isMidi2){var p,I,O,W=l[0]>>4,oe=l[0]&15;if(W==1||W==2)this._emit(Ar(new Q(l.slice(1)),oe));else if(W==3)I=l[1]>>4,p=l[1]&15,I==0?(this._emit(Ar(new Q([240].concat(l.slice(2,2+p),[247])),oe)),this._sx[oe]=void 0):I==1?this._sx[oe]=l.slice(2,2+p):I==2?this._sx[oe]&&(this._sx[oe]=this._sx[oe].concat(l.slice(2,2+p))):I==3&&(this._sx[oe]&&this._emit(Ar(new Q([240].concat(this._sx[oe],l.slice(2,2+p),[247])),oe)),this._sx[oe]=void 0);else if(W==4){if(p=l[1]>>4,I=l[1]&15,p==2||p==3?(this._emit(Ar(new Q([176+I,p==2?101:99,l[2]]),oe)),this._emit(Ar(new Q([176+I,p==2?100:98,l[3]]),oe)),this._emit(Ar(new Q([176+I,6,l[4]>>1]),oe)),this._emit(Ar(new Q([176+I,38,(l[4]&1)*64+(l[4]>>2)]),oe))):(p==8||p==9)&&this._emit(Ar(new Q([l[1],l[2],El(l[4],l[5])]),oe)),p==10&&this._emit(Ar(new Q([l[1],l[2],jr(l[4],l[5],l[6],l[7])]),oe)),p==11){if(Dc.includes(l[2]))return;this._emit(Ar(new Q([l[1],l[2],jr(l[4],l[5],l[6],l[7])]),oe))}p==13&&this._emit(Ar(new Q([l[1],jr(l[4],l[5],l[6],l[7])]),oe)),p==14?(O=l[4]*16777216+l[5]*65536+l[6]*256+l[4]>>18,this._emit(Ar(new Q([l[1],O&127,O>>7&127]),oe))):p==12&&(l[3]&&(this._emit(Ar(new Q([176+I,0,l[6]]),oe)),this._emit(Ar(new Q([176+I,32,l[7]]),oe))),this._emit(Ar(new Q([l[1],l[4]]),oe)))}}else this._emit(l)}function Fd(){var l=new Ne;return l._sx=[],l._receive=Tl,l._resume(),l.MIDI2()}Je.M2M1=Fd,L.prototype.M2M1=Je.M2M1;function Iu(l){if(l.isMidi2)this._emit(l);else{var p=l.gr>=0&&l.gr<=15?l.gr:0;if(l[0]>=128&&l[0]<240)this._emit(Je.MIDI2([32+p].concat(l.slice(),ir).slice(0,4)));else if(l[0]>240&&l[0]<=255&&l[0]!=247)this._emit(Je.MIDI2([16+p].concat(l.slice(),ir).slice(0,4)));else if(l.isFullSysEx())for(var I=bs(p,l.slice()),O=0;O<I.length;O++)this._emit(Je.MIDI2(I[O]))}}function Nc(){var l=new Ne;return l._receive=Iu,l._resume(),l}Je.M1M2=Nc,L.prototype.M1M2=Je.M1M2,Je.lib={},Je.lib.now=v,Je.lib.schedule=m,Je.lib.R=x;var Mc=[],js,Zo=0;try{var Bc=URL.createObjectURL(new Blob(["(",(function(){function l(){postMessage({}),setTimeout(l,0)}l()}).toString(),")()"],{type:"application/javascript"})),bu=function(){for(var l=Mc.length,p=0;p<l;p++)Mc.shift()();Zo++,Zo>20&&js&&(js.terminate(),js=void 0)},_l=function(l){Mc.push(l),Zo=0,js||(js=new Worker(Bc),js.onmessage=bu)};_l(function(){Je.lib.schedule=_l})}catch{}Je.lib.openMidiOut=function(l,p){var I=new Ne;return p._openOut(I),I._info=p._info(l),I},Je.lib.openMidiIn=function(l,p){var I=new Ne;return p._openIn(I),I._info=p._info(l),I},Je.lib.registerMidiOut=function(l,p){for(var I=p._info(l),O=0;O<nn._outs.length;O++)if(nn._outs[O].name==I.name)return!1;return I.engine=p,nn._outs.push(I),ot&&(Se(),ot._bad&&(ot._repair(),ot._resume())),!0},Je.lib.registerMidiIn=function(l,p){for(var I=p._info(l),O=0;O<nn._ins.length;O++)if(nn._ins[O].name==I.name)return!1;return I.engine=p,nn._ins.push(I),ot&&(Se(),ot._bad&&(ot._repair(),ot._resume())),!0},Je.lib.unregisterMidiOut=function(l){for(var p=0;p<nn._outs.length;p++)if(nn._outs[p].name==l)return nn._outs.splice(p,p+1),ot&&Se(),!0;return!1},Je.lib.unregisterMidiIn=function(l){for(var p=0;p<nn._ins.length;p++)if(nn._ins[p].name==l)return nn._ins.splice(p,p+1),ot&&Se(),!0;return!1},Je.lib.plug=function(l){for(var p=0;p<vn.length;p++)if(vn[p]==l)return;vn.push(l)},Je.lib.unplug=function(l){for(var p=0;p<vn.length;p++)if(vn[p]==l){vn.splice(p,1);return}};var Cr;function Rl(){if(!Cr&&typeof window<"u"){var l=window.AudioContext||window.webkitAudioContext;if(l){Cr=new l,Cr&&!Cr.createGain&&(Cr.createGain=Cr.createGainNode);var p=function(){if(Cr.state!="running"){Cr.resume();var I=Cr.createOscillator(),O=Cr.createGain();try{O.gain.value=0}catch{}O.gain.setTargetAtTime(0,Cr.currentTime,.01),I.connect(O),O.connect(Cr.destination),I.start||(I.start=I.noteOn),I.stop||(I.stop=I.noteOff),I.start(.1),I.stop(.11)}else typeof document<"u"&&(document.removeEventListener("touchstart",p),document.removeEventListener("touchend",p),document.removeEventListener("mousedown",p),document.removeEventListener("keydown",p))};typeof document<"u"&&(document.addEventListener("touchstart",p),document.addEventListener("touchend",p),document.addEventListener("mousedown",p),document.addEventListener("keydown",p)),p()}}}Je.lib.copyMidiHelpers=cn,Je.lib.copyMidi2Helpers=Pc,Je.lib.copyUmpHelpers=Pc,Je.lib.getAudioContext=function(){return Rl(),Cr},Je.lib.closeAudioContext=function(){Cr&&Cr.close(),Cr=void 0};var Ss="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Je.lib.fromBase64=function(l){var p="",I,O,W,oe,he,He,$e,mt=0;for(l=l.replace(/[^A-Za-z0-9+/=]/g,"");mt<l.length;)oe=Ss.indexOf(l.charAt(mt++)),he=Ss.indexOf(l.charAt(mt++)),He=Ss.indexOf(l.charAt(mt++)),$e=Ss.indexOf(l.charAt(mt++)),I=oe<<2|he>>4,O=(he&15)<<4|He>>2,W=(He&3)<<6|$e,p=p+String.fromCharCode(I),He!=64&&(p=p+String.fromCharCode(O)),$e!=64&&(p=p+String.fromCharCode(W));return p},Je.lib.toBase64=function(l){var p,I,O,W,oe,he,He,$e,mt=0,wr=0,Ws="",Au=[];if(!l)return l;do p=l.charCodeAt(mt++),I=l.charCodeAt(mt++),O=l.charCodeAt(mt++),$e=p<<16|I<<8|O,W=$e>>18&63,oe=$e>>12&63,he=$e>>6&63,He=$e&63,Au[wr++]=Ss.charAt(W)+Ss.charAt(oe)+Ss.charAt(he)+Ss.charAt(He);while(mt<l.length);Ws=Au.join("");var Ld=l.length%3;return Ld?Ws.slice(0,Ld-3)+"===".slice(Ld):Ws},Je.lib.fromUTF8=function(l){l=typeof l>"u"?"":""+l;var p="",I,O,W;for(I=0;I<l.length;I++){if(O=l.charCodeAt(I),O>255)return l;if(O<128)p+=l[I];else if((O&224)==192){if(O=(O&31)<<6,I++,I>=l.length||(W=l.charCodeAt(I),(W&192)!=128))return l;O+=W&63,p+=String.fromCharCode(O)}else if((O&240)==224){if(O=(O&15)<<12,I++,I>=l.length||(W=l.charCodeAt(I),(W&192)!=128)||(O+=(W&63)<<6,I++,I>=l.length)||(W=l.charCodeAt(I),(W&192)!=128))return l;O+=W&63,p+=String.fromCharCode(O)}else if((O&248)==240){if(O=(O&7)<<18,I++,I>=l.length||(W=l.charCodeAt(I),(W&192)!=128)||(O+=(W&63)<<12,I++,I>=l.length)||(W=l.charCodeAt(I),(W&192)!=128)||(O+=(W&63)<<6,I++,I>=l.length)||(W=l.charCodeAt(I),(W&192)!=128)||(O+=W&63,O>1114111))return l;O-=65536,p+=String.fromCharCode(55296+(O>>10)),p+=String.fromCharCode(56320+(O&1023))}}return p},Je.lib.toUTF8=function(l){l=typeof l>"u"?"":""+l;var p="",I,O;for(I=0;I<l.length;I++)O=l.charCodeAt(I),O<128?p+=l[I]:O<2048?(p+=String.fromCharCode(192+(O>>6)),p+=String.fromCharCode(128+(O&63))):O<65536?(p+=String.fromCharCode(224+(O>>12)),p+=String.fromCharCode(128+(O>>6&63)),p+=String.fromCharCode(128+(O&63))):(p+=String.fromCharCode(240+(O>>18)),p+=String.fromCharCode(128+(O>>12&63)),p+=String.fromCharCode(128+(O>>6&63)),p+=String.fromCharCode(128+(O&63)));return p};var T=[],G={},$={},re=t.Promise;typeof re!="function"&&(re=function(l){this.executor=l},re.prototype.then=function(l,p){typeof l!="function"&&(l=y),typeof p!="function"&&(p=y),this.executor(l,p)});function Me(l,p,I){this.name=l,this.message=p,this.code=I}function Re(l,p){this.bubbles=!1,this.cancelBubble=!1,this.cancelable=!1,this.currentTarget=p,this.defaultPrevented=!1,this.eventPhase=0,this.path=[],this.port=l,this.returnValue=!0,this.srcElement=p,this.target=p,this.timeStamp=v(),this.type="statechange"}function Ze(l,p){this.bubbles=!1,this.cancelBubble=!1,this.cancelable=!1,this.currentTarget=l,this.data=p,this.defaultPrevented=!1,this.eventPhase=0,this.path=[],this.receivedTime=v(),this.returnValue=!0,this.srcElement=l,this.target=l,this.timeStamp=this.receivedTime,this.type="midimessage"}function Ye(l,p){l&&(l.onstatechange&&l.onstatechange(new Re(l,l)),p.onstatechange&&p.onstatechange(new Re(l,p)))}function Kt(l,p){var I=this,O=!1,W=null,oe=null;this.type="input",this.id=p.id,this.name=p.name,this.manufacturer=p.man,this.version=p.ver,Object.defineProperty(this,"state",{get:function(){return p.connected?"connected":"disconnected"},enumerable:!0}),Object.defineProperty(this,"connection",{get:function(){return O?p.proxy?"open":"pending":"closed"},enumerable:!0}),Object.defineProperty(this,"onmidimessage",{get:function(){return oe},set:function(he){C(he)?(oe=he,O||I.open().then(y,y)):oe=null},enumerable:!0}),Object.defineProperty(this,"onstatechange",{get:function(){return W},set:function(he){C(he)?W=he:W=null},enumerable:!0}),this.open=function(){return new re(function(he,He){O?he(I):p.open().then(function(){O||(O=!0,Ye(I,l)),he(I)},function(){He(new Me("InvalidAccessError","Port is not available",15))})})},this.close=function(){return new re(function(he){O&&(O=!1,p.close(),Ye(I,l)),he(I)})},Object.freeze(this)}function fn(l){for(var p,I;l.length;){for(p=0;p<l.length&&!(l[p]==parseInt(l[p])&&l[p]>=128&&l[p]<=255&&l[p]!=247);p++);if(l.splice(0,p),!l.length)return;if(l[0]==240){for(p=1;p<l.length&&l[p]!=247;p++);return p==l.length?void 0:l.splice(0,p+1)}else{if(I=Un(l[0])+1,I>l.length)return;for(p=1;p<I&&!(l[p]!=parseInt(l[p])||l[p]<0||l[p]>=128);p++);if(p==I)return l.splice(0,p);l.splice(0,p)}}}function $t(l,p,I,O){var W=this;this.id=l,this.name=p,this.man=I,this.ver=O,this.connected=!0,this.ports=[],this.pending=[],this.proxy=void 0,this.queue=[],this.onmidi=function(oe){var he;for(W.queue=W.queue.concat(oe.slice()),he=fn(W.queue);he;he=fn(W.queue))for(i=0;i<W.ports.length;i++)W.ports[i][0].onmidimessage&&(he[0]!=240||W.ports[i][1])&&W.ports[i][0].onmidimessage(new Ze(W,new Uint8Array(he)))}}$t.prototype.open=function(){var l=this;return new re(function(p,I){var O;l.proxy||!l.connected?p():(l.pending.push([p,I]),l.pending.length==1&&Je().openMidiIn(l.name).or(function(){for(O=0;O<l.pending.length;O++)l.pending[O][1]();l.pending=[]}).and(function(){for(l.proxy=this,l.proxy.connect(l.onmidi),O=0;O<l.pending.length;O++)l.pending[O][0]();l.pending=[]}))})},$t.prototype.close=function(){var l;if(this.proxy){for(l=0;l<this.ports.length;l++)if(this.ports[l].connection=="open")return;this.proxy.close(),this.proxy=void 0}},$t.prototype.disconnect=function(){this.connected=!1,this.proxy&&(this.proxy.close(),this.proxy=void 0)},$t.prototype.reconnect=function(){var l=this,p,I,O=[];for(this.connected=!0,p=0;p<T.length;p++)I=T[p].inputs.get(this.id),I.connection=="closed"?Ye(I,T[p]):O.push([I,T[p]]);O.length&&Je()._openMidiInNR(l.name).or(function(){for(p=0;p<O.length;p++)O[p][0].close()}).and(function(){for(l.proxy=this,l.proxy.connect(l.onmidi),p=0;p<O.length;p++)Ye(O[p][0],O[p][1])})};function Un(l){return l>=128&&l<=191||l>=224&&l<=239||l==242?2:l>=192&&l<=223||l==241||l==243?1:0}var xr="Failed to execute 'send' on 'MIDIOutput': ";function Ai(l,p){var I,O,W,oe=[];for(I=0;I<l.length;I++)if(l[I]!=parseInt(l[I])||l[I]<0||l[I]>255)throw TypeError(xr+l[I]+" is not a UInt8 value.");for(O=0,I=0;I<l.length;I++)if(O){if(l[I]>127)throw TypeError(xr+"Unexpected status byte at index "+I+" ("+l[I]+").");W.push(l[I]),O--}else{if(l[I]<128)throw TypeError(xr+"Running status is not allowed at index "+I+" ("+l[I]+").");if(l[I]==247)throw TypeError(xr+"Unexpected end of system exclusive message at index "+I+" ("+l[I]+").");if(W=[l[I]],oe.push(W),l[I]==240){if(!p)throw new Me("InvalidAccessError",xr+"System exclusive messag is not allowed at index "+I+" ("+l[I]+").",15);for(O=-1;I<l.length;I++)if(W.push(l[I]),l[I]==247){O=0;break}}else O=Un(l[I])}if(O)throw TypeError(xr+"Message is incomplete");return[oe]}function ki(l,p){var I=this,O=!1,W=null;this.type="output",this.id=p.id,this.name=p.name,this.manufacturer=p.man,this.version=p.ver,Object.defineProperty(this,"state",{get:function(){return p.connected?"connected":"disconnected"},enumerable:!0}),Object.defineProperty(this,"connection",{get:function(){return O?p.proxy?"open":"pending":"closed"},enumerable:!0}),Object.defineProperty(this,"onstatechange",{get:function(){return W},set:function(oe){C(oe)?W=oe:W=null},enumerable:!0}),this.open=function(){return new re(function(oe,he){O?oe(I):p.open().then(function(){O||(O=!0,Ye(I,l)),oe(I)},function(){he(new Me("InvalidAccessError","Port is not available",15))})})},this.close=function(){return new re(function(oe){O&&(O=!1,I.clear(),p.close(),Ye(I,l)),oe(I)})},this.clear=function(){},this.send=function(oe,he){if(Ai(oe,l.sysexEnabled),!p.connected)throw new Me("InvalidStateError","Port is not connected",11);if(O){var He=v();he>He?setTimeout(function(){p.proxy.send(oe)},he-He):p.proxy.send(oe)}else this.open().then(function(){I.send(oe,he)},y)},Object.freeze(this)}function rs(l,p,I,O){this.id=l,this.name=p,this.man=I,this.ver=O,this.connected=!0,this.ports=[],this.pending=[],this.proxy=void 0}rs.prototype.open=function(){var l=this;return new re(function(p,I){var O;l.proxy||!l.connected?p():(l.pending.push([p,I]),l.pending.length==1&&Je().openMidiOut(l.name).or(function(){for(O=0;O<l.pending.length;O++)l.pending[O][1]();l.pending=[]}).and(function(){for(l.proxy=this,O=0;O<l.pending.length;O++)l.pending[O][0]();l.pending=[]}))})},rs.prototype.close=function(){var l;if(this.proxy){for(l=0;l<this.ports.length;l++)if(this.ports[l].connection=="open")return;this.proxy.close(),this.proxy=void 0}},rs.prototype.disconnect=function(){this.connected=!1,this.proxy&&(this.proxy.close(),this.proxy=void 0)},rs.prototype.reconnect=function(){var l=this,p,I,O=[];for(this.connected=!0,p=0;p<T.length;p++)I=T[p].outputs.get(this.id),I.connection=="closed"?Ye(I,T[p]):O.push([I,T[p]]);O.length&&Je()._openMidiOutNR(l.name).or(function(){for(p=0;p<O.length;p++)O[p][0].close()}).and(function(){for(l.proxy=this,p=0;p<O.length;p++)Ye(O[p][0],O[p][1])})};function Oc(l){this.has=function(p){return l.hasOwnProperty(p)&&l[p].connected},this.keys=function(){try{var p=new Map;for(var I in l)this.has(I)&&p.set(I,this.get(I));return p.keys()}catch{}},this.values=function(){try{var p=new Map;for(var I in l)this.has(I)&&p.set(I,this.get(I));return p.values()}catch{}},this.entries=function(){try{var p=new Map;for(var I in l)this.has(I)&&p.set(I,this.get(I));return p.entries()}catch{}},this.forEach=function(p,I){typeof I>"u"&&(I=this);for(var O in l)this.has(O)&&p.call(I,this.get(O),O,this)},Object.defineProperty(this,"size",{get:function(){var p=0;for(var I in l)this.has(I)&&p++;return p},enumerable:!0})}function Li(l,p){this.get=function(I){if($.hasOwnProperty(I)&&$[I].connected)return p[I]||(p[I]=new Kt(l,$[I]),$[I].ports.push([p[I],l.sysexEnabled])),p[I]},Object.freeze(this)}Li.prototype=new Oc($),Li.prototype.constructor=Li;function Su(l,p){this.get=function(I){if(G.hasOwnProperty(I)&&G[I].connected)return p[I]||(p[I]=new ki(l,G[I]),G[I].ports.push([p[I],l.sysexEnabled])),p[I]},Object.freeze(this)}Su.prototype=new Oc(G),Su.prototype.constructor=Su;function Bg(l){var p,I,O,W;for(p=0;p<l.inputs.added.length;p++)O=l.inputs.added[p],$.hasOwnProperty(O.id)||($[O.id]=new $t(O.id,O.name,O.manufacturer,O.version)),$[O.id].reconnect();for(p=0;p<l.outputs.added.length;p++)O=l.outputs.added[p],G.hasOwnProperty(O.id)||(G[O.id]=new rs(O.id,O.name,O.manufacturer,O.version)),G[O.id].reconnect();for(p=0;p<l.inputs.removed.length;p++)if(O=l.inputs.removed[p],$.hasOwnProperty(O.id)){for(W=[],I=0;I<T.length;I++)W.push([T[I].inputs.get(O.id),T[I]]);for($[O.id].disconnect(),I=0;I<W.length;I++)Ye(W[I][0],W[I][1])}for(p=0;p<l.outputs.removed.length;p++)if(O=l.outputs.removed[p],G.hasOwnProperty(O.id)){for(W=[],I=0;I<T.length;I++)W.push([T[I].outputs.get(O.id),T[I]]);for(G[O.id].disconnect(),I=0;I<W.length;I++)Ye(W[I][0],W[I][1])}}function Og(l){var p={},I={},O=null,W=this;this.sysexEnabled=l,this.inputs=new Li(W,p),this.outputs=new Su(W,I),Object.defineProperty(this,"onstatechange",{get:function(){return O},set:function($e){O=C($e)?$e:null},enumerable:!0}),Object.freeze(this);var oe,he,He=ot._info;for(oe=0;oe<He.inputs.length;oe++)he=He.inputs[oe],$.hasOwnProperty(he.id)||($[he.id]=new $t(he.id,he.name,he.manufacturer,he.version));for(oe=0;oe<He.outputs.length;oe++)he=He.outputs[oe],G.hasOwnProperty(he.id)||(G[he.id]=new rs(he.id,he.name,he.manufacturer,he.version));T.length||Je().onChange(Bg),T.push(this)}return Je.requestMIDIAccess=function(l){return new re(function(p,I){Je.JZZ(l).or(function(){}).and(function(){var O=!!(l&&l.sysex);if(O&&!this.info().sysex)I(new Me("SecurityError","Sysex is not allowed",18));else{var W=new Og(O);p(W)}})})},typeof navigator<"u"&&!navigator.requestMIDIAccess&&(navigator.requestMIDIAccess=Je.requestMIDIAccess),Je.close=function(){le._close&&le._close()},Je})}(M0)),M0.exports}var mB=gB();const _f=kc(mB);var B0={exports:{}},vB=B0.exports,LI;function yB(){return LI||(LI=1,function(n,e){(function(t,r){r.Tiny=r,n.exports=r})(vB,function(t){if(!t||(t.synth||(t.synth={}),t.synth.Tiny))return;var r="1.4.3";function i(h){this.__proto__=this.sy={is:"webaudio-tinysynth",properties:{masterVol:{type:Number,value:.5,observer:"setMasterVol"},reverbLev:{type:Number,value:.3,observer:"setReverbLev"},quality:{type:Number,value:1,observer:"setQuality"},debug:{type:Number,value:0},src:{type:String,value:null,observer:"loadMIDIUrl"},loop:{type:Number,value:0},tsmode:{type:Number,value:0},voices:{type:Number,value:64},useReverb:{type:Number,value:1}},program:[],drummap:[],program1:[[{w:"sine",v:.4,d:.7,r:.1},{w:"triangle",v:3,d:.7,s:.1,g:1,a:.01,k:-1.2}],[{w:"triangle",v:.4,d:.7,r:.1},{w:"triangle",v:4,t:3,d:.4,s:.1,g:1,k:-1,a:.01}],[{w:"sine",d:.7,r:.1},{w:"triangle",v:4,f:2,d:.5,s:.5,g:1,k:-1}],[{w:"sine",d:.7,v:.2},{w:"triangle",v:4,t:3,f:2,d:.3,g:1,k:-1,a:.01,s:.5}],[{w:"sine",v:.35,d:.7},{w:"sine",v:3,t:7,f:1,d:1,s:1,g:1,k:-.7}],[{w:"sine",v:.35,d:.7},{w:"sine",v:8,t:7,f:1,d:.5,s:1,g:1,k:-.7}],[{w:"sawtooth",v:.34,d:2},{w:"sine",v:8,f:.1,d:2,s:1,r:2,g:1}],[{w:"triangle",v:.34,d:1.5},{w:"square",v:6,f:.1,d:1.5,s:.5,r:2,g:1}],[{w:"sine",d:.3,r:.3},{w:"sine",v:7,t:11,d:.03,g:1}],[{w:"sine",d:.3,r:.3},{w:"sine",v:11,t:6,d:.2,s:.4,g:1}],[{w:"sine",v:.2,d:.3,r:.3},{w:"sine",v:11,t:5,d:.1,s:.4,g:1}],[{w:"sine",v:.2,d:.6,r:.6},{w:"triangle",v:11,t:5,f:1,s:.5,g:1}],[{w:"sine",v:.3,d:.2,r:.2},{w:"sine",v:6,t:5,d:.02,g:1}],[{w:"sine",v:.3,d:.2,r:.2},{w:"sine",v:7,t:11,d:.03,g:1}],[{w:"sine",v:.2,d:1,r:1},{w:"sine",v:11,t:3.5,d:1,r:1,g:1}],[{w:"triangle",v:.2,d:.5,r:.2},{w:"sine",v:6,t:2.5,d:.2,s:.1,r:.2,g:1}],[{w:"w9999",v:.22,s:.9},{w:"w9999",v:.22,t:2,f:2,s:.9}],[{w:"w9999",v:.2,s:1},{w:"sine",v:11,t:6,f:2,s:.1,g:1,h:.006,r:.002,d:.002},{w:"w9999",v:.2,t:2,f:1,h:0,s:1}],[{w:"w9999",v:.2,d:.1,s:.9},{w:"w9999",v:.25,t:4,f:2,s:.5}],[{w:"w9999",v:.3,a:.04,s:.9},{w:"w9999",v:.2,t:8,f:2,a:.04,s:.9}],[{w:"sine",v:.2,a:.02,d:.05,s:1},{w:"sine",v:6,t:3,f:1,a:.02,d:.05,s:1,g:1}],[{w:"triangle",v:.2,a:.02,d:.05,s:.8},{w:"square",v:7,t:3,f:1,d:.05,s:1.5,g:1}],[{w:"square",v:.2,a:.02,d:.2,s:.5},{w:"square",v:1,d:.03,s:2,g:1}],[{w:"square",v:.2,a:.02,d:.1,s:.8},{w:"square",v:1,a:.3,d:.1,s:2,g:1}],[{w:"sine",v:.3,d:.5,f:1},{w:"triangle",v:5,t:3,f:-1,d:1,s:.1,g:1}],[{w:"sine",v:.4,d:.6,f:1},{w:"triangle",v:12,t:3,d:.6,s:.1,g:1,f:-1}],[{w:"triangle",v:.3,d:1,f:1},{w:"triangle",v:6,f:-1,d:.4,s:.5,g:1,t:3}],[{w:"sine",v:.3,d:1,f:-1},{w:"triangle",v:11,f:1,d:.4,s:.5,g:1,t:3}],[{w:"sine",v:.4,d:.1,r:.01},{w:"sine",v:7,g:1}],[{w:"triangle",v:.4,d:1,f:1},{w:"square",v:4,f:-1,d:1,s:.7,g:1}],[{w:"triangle",v:.35,d:1,f:1},{w:"square",v:7,f:-1,d:.3,s:.5,g:1}],[{w:"sine",v:.2,t:1.5,a:.005,h:.2,d:.6},{w:"sine",v:11,t:5,f:2,d:1,s:.5,g:1}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"w9999",d:.3,v:.7,s:.5},{w:"sawtooth",v:1.2,d:.02,s:.5,g:1,h:0,r:.02}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"triangle",v:.3,t:2,d:1},{w:"triangle",v:15,t:2.5,d:.04,s:.1,g:1}],[{w:"triangle",v:.3,t:2,d:1},{w:"triangle",v:15,t:2.5,d:.04,s:.1,g:1}],[{w:"triangle",d:.7},{w:"square",v:.4,t:.5,f:1,d:.2,s:10,g:1}],[{w:"triangle",d:.7},{w:"square",v:.4,t:.5,f:1,d:.2,s:10,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,t:.5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,t:.5,d:11,s:.2,g:1}],[{w:"sine",v:.4,a:.1,d:11},{w:"sine",v:6,f:2.5,d:.05,s:1.1,g:1}],[{w:"sine",v:.3,d:.1,r:.1},{w:"square",v:4,t:3,d:1,s:.2,g:1}],[{w:"sine",v:.3,d:.5,r:.5},{w:"sine",v:7,t:2,f:2,d:1,r:1,g:1}],[{w:"triangle",v:.6,h:.03,d:.3,r:.3,t:.5},{w:"n0",v:8,t:1.5,d:.08,r:.08,g:1}],[{w:"sawtooth",v:.3,a:.03,s:.5},{w:"sawtooth",v:.2,t:2,f:2,d:1,s:2}],[{w:"sawtooth",v:.3,f:-2,a:.03,s:.5},{w:"sawtooth",v:.2,t:2,f:2,d:1,s:2}],[{w:"sawtooth",v:.2,a:.02,s:1},{w:"sawtooth",v:.2,t:2,f:2,a:1,d:1,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1},{w:"sawtooth",v:.2,f:2,a:.02,d:1,s:1}],[{w:"triangle",v:.3,a:.03,s:1},{w:"sine",v:3,t:5,f:1,d:1,s:1,g:1}],[{w:"sine",v:.4,a:.03,s:.9},{w:"sine",v:1,t:2,f:3,d:.03,s:.2,g:1}],[{w:"triangle",v:.6,a:.05,s:.5},{w:"sine",v:1,f:.8,d:.2,s:.2,g:1}],[{w:"square",v:.15,a:.01,d:.2,r:.2,t:.5,h:.03},{w:"square",v:4,f:.5,d:.2,r:11,a:.01,g:1,h:.02},{w:"square",v:.15,t:4,f:1,a:.02,d:.15,r:.15,h:.03},{g:3,w:"square",v:4,f:-.5,a:.01,h:.02,d:.15,r:11}],[{w:"square",v:.2,a:.01,d:1,s:.6,r:.04},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.04,d:1,s:.4,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.15,a:.04,s:1},{w:"sine",v:2,d:.1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6,r:.08},{w:"sine",v:1,f:.2,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:.5,s:.7,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:2,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:2,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"sine",v:.4,a:.02,d:.7,s:.5},{w:"square",v:5,t:2,d:.2,s:.5,g:1}],[{w:"sine",v:.3,a:.05,d:.2,s:.8},{w:"sawtooth",v:6,f:.1,d:.1,s:.3,g:1}],[{w:"sine",v:.3,a:.03,d:.2,s:.4},{w:"square",v:7,f:.2,d:1,s:.1,g:1}],[{w:"square",v:.2,a:.05,d:.1,s:.8},{w:"square",v:4,d:.1,s:1.1,g:1}],[{w:"sine",a:.02,d:2},{w:"sine",v:6,t:2,d:.04,g:1}],[{w:"sine",v:.7,a:.03,d:.4,s:.4},{w:"sine",v:4,t:2,f:.2,d:.4,g:1}],[{w:"sine",v:.7,a:.02,d:.4,s:.6},{w:"sine",v:3,t:2,d:0,s:1,g:1}],[{w:"sine",v:.4,a:.06,d:.3,s:.3},{w:"sine",v:7,t:2,d:.2,s:.2,g:1}],[{w:"sine",a:.02,d:.3,s:.3},{w:"sawtooth",v:3,t:2,d:.3,g:1}],[{w:"sine",v:.4,a:.02,d:2,s:.1},{w:"sawtooth",v:8,t:2,f:1,d:.5,g:1}],[{w:"sine",v:.7,a:.03,d:.5,s:.3},{w:"sine",v:.003,t:0,f:4,d:.1,s:.002,g:1}],[{w:"sine",v:.7,a:.02,d:2},{w:"sine",v:1,t:2,f:1,d:.02,g:1}],[{w:"square",v:.3,d:1,s:.5},{w:"square",v:1,f:.2,d:1,s:.5,g:1}],[{w:"sawtooth",v:.3,d:2,s:.5},{w:"square",v:2,f:.1,s:.5,g:1}],[{w:"triangle",v:.5,a:.05,d:2,s:.6},{w:"sine",v:4,t:2,g:1}],[{w:"triangle",v:.3,a:.01,d:2,s:.3},{w:"sine",v:22,t:2,f:1,d:.03,s:.2,g:1}],[{w:"sawtooth",v:.3,d:1,s:.5},{w:"sine",v:11,t:11,a:.2,d:.05,s:.3,g:1}],[{w:"sine",v:.3,a:.06,d:1,s:.5},{w:"sine",v:7,f:1,d:1,s:.2,g:1}],[{w:"sawtooth",v:.3,a:.03,d:.7,s:.3,r:.2},{w:"sawtooth",v:.3,t:.75,d:.7,a:.1,s:.3,r:.2}],[{w:"triangle",v:.3,a:.01,d:.7,s:.5},{w:"square",v:5,t:.5,d:.7,s:.5,g:1}],[{w:"triangle",v:.3,a:.02,d:.3,s:.3,r:.3},{w:"square",v:3,t:4,f:1,a:.02,d:.1,s:1,g:1},{w:"triangle",v:.08,t:.5,a:.1,h:0,d:.1,s:.5,r:.1,b:0,c:0}],[{w:"sine",v:.3,a:.05,d:1,s:.7,r:.3},{w:"sine",v:2,f:1,d:.3,s:1,g:1}],[{w:"square",v:.3,a:.03,d:.5,s:.3,r:.1},{w:"square",v:4,f:1,a:.03,d:.1,g:1}],[{w:"triangle",v:.3,a:.08,d:1,s:.3,r:.1},{w:"square",v:2,f:1,d:.3,s:.3,g:1,t:4,a:.08}],[{w:"sine",v:.3,a:.05,d:1,s:.3,r:.1},{w:"sine",v:.1,t:2.001,f:1,d:1,s:50,g:1}],[{w:"triangle",v:.3,a:.03,d:.7,s:.3,r:.2},{w:"sine",v:12,t:7,f:1,d:.5,s:1.7,g:1}],[{w:"sine",v:.3,a:.05,d:1,s:.3,r:.1},{w:"sawtooth",v:22,t:6,d:.06,s:.3,g:1}],[{w:"triangle",v:.3,a:.05,d:11,r:.3},{w:"triangle",v:1,d:1,s:8,g:1}],[{w:"sawtooth",v:.3,d:4,s:.8,r:.1},{w:"square",v:1,t:2,f:8,a:1,d:1,s:1,r:.1,g:1}],[{w:"triangle",v:.3,d:1,s:.5,t:.8,a:.2,p:1.25,q:.2},{w:"sawtooth",v:.2,a:.2,d:.3,s:1,t:1.2,p:1.25,q:.2}],[{w:"sine",v:.3,d:1,s:.3},{w:"square",v:22,t:11,d:.5,s:.1,g:1}],[{w:"sawtooth",v:.3,a:.04,d:1,s:.8,r:.1},{w:"square",v:1,t:.5,d:1,s:2,g:1}],[{w:"triangle",v:.3,d:1,s:.3},{w:"sine",v:22,t:6,d:.6,s:.05,g:1}],[{w:"sine",v:.6,a:.1,d:.05,s:.4},{w:"sine",v:5,t:5,f:1,d:.05,s:.3,g:1}],[{w:"sine",a:.1,d:.05,s:.4,v:.8},{w:"sine",v:5,t:5,f:1,d:.05,s:.3,g:1}],[{w:"square",v:.3,a:.1,d:.1,s:.4},{w:"square",v:1,f:1,d:.3,s:.1,g:1}],[{w:"sawtooth",v:.3,d:.5,r:.5},{w:"sawtooth",v:11,t:5,d:.05,g:1}],[{w:"square",v:.3,d:.2,r:.2},{w:"square",v:7,t:3,d:.05,g:1}],[{w:"triangle",d:.2,r:.2},{w:"square",v:9,t:3,d:.1,r:.1,g:1}],[{w:"triangle",d:.3,r:.3},{w:"square",v:6,t:3,d:1,r:1,g:1}],[{w:"triangle",v:.4,d:.2,r:.2},{w:"square",v:22,t:12,d:.1,r:.1,g:1}],[{w:"sine",v:.25,a:.02,d:.05,s:.8},{w:"square",v:1,t:2,d:.03,s:11,g:1}],[{w:"sine",v:.3,a:.05,d:11},{w:"square",v:7,t:3,f:1,s:.7,g:1}],[{w:"square",v:.3,a:.05,d:.1,s:.8},{w:"square",v:4,d:.1,s:1.1,g:1}],[{w:"sine",v:.4,d:.3,r:.3},{w:"sine",v:7,t:9,d:.1,r:.1,g:1}],[{w:"sine",v:.7,d:.1,r:.1},{w:"sine",v:22,t:7,d:.05,g:1}],[{w:"sine",v:.6,d:.15,r:.15},{w:"square",v:11,t:3.2,d:.1,r:.1,g:1}],[{w:"sine",v:.8,d:.07,r:.07},{w:"square",v:11,t:7,r:.01,g:1}],[{w:"triangle",v:.7,t:.5,d:.2,r:.2,p:.95},{w:"n0",v:9,g:1,d:.2,r:.2}],[{w:"sine",v:.7,d:.1,r:.1,p:.9},{w:"square",v:14,t:2,d:.005,r:.005,g:1}],[{w:"square",d:.15,r:.15,p:.5},{w:"square",v:4,t:5,d:.001,r:.001,g:1}],[{w:"n1",v:.3,a:1,s:1,d:.15,r:0,t:.5}],[{w:"sine",t:12.5,d:0,r:0,p:.5,v:.3,h:.2,q:.5},{g:1,w:"sine",v:1,t:2,d:0,r:0,s:1},{g:1,w:"n0",v:.2,t:2,a:.6,h:0,d:.1,r:.1,b:0,c:0}],[{w:"n0",v:.2,a:.05,h:.02,d:.02,r:.02}],[{w:"n0",v:.4,a:1,d:1,t:.25}],[{w:"sine",v:.3,a:.1,d:1,s:.5},{w:"sine",v:4,t:0,f:1.5,d:1,s:1,r:.1,g:1},{g:1,w:"sine",v:4,t:0,f:2,a:.6,h:0,d:.1,s:1,r:.1,b:0,c:0}],[{w:"square",v:.3,t:.25,d:11,s:1},{w:"square",v:12,t:0,f:8,d:1,s:1,r:11,g:1}],[{w:"n0",v:.4,t:.5,a:1,d:11,s:1,r:.5},{w:"square",v:1,t:0,f:14,d:1,s:1,r:11,g:1}],[{w:"sine",t:0,f:1221,a:.2,d:1,r:.25,s:1},{g:1,w:"n0",v:3,t:.5,d:1,s:1,r:1}],[{w:"sine",d:.4,r:.4,p:.1,t:2.5,v:1},{w:"n0",v:12,t:2,d:1,r:1,g:1}]],program0:[[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"sawtooth",v:.3,d:.7}],[{w:"sawtooth",v:.3,d:.7}],[{w:"sine",v:.5,d:.3,r:.3}],[{w:"triangle",v:.5,d:.3,r:.3}],[{w:"square",v:.2,d:.3,r:.3}],[{w:"square",v:.2,d:.3,r:.3}],[{w:"sine",v:.5,d:.1,r:.1}],[{w:"sine",v:.5,d:.1,r:.1}],[{w:"square",v:.2,d:1,r:1}],[{w:"sawtooth",v:.3,d:.7,r:.7}],[{w:"sine",v:.5,a:.01,s:1}],[{w:"sine",v:.7,d:.02,s:.7}],[{w:"square",v:.2,s:1}],[{w:"triangle",v:.5,a:.01,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.05,s:1}],[{w:"triangle",v:.5,d:.5}],[{w:"square",v:.2,d:.6}],[{w:"square",v:.2,d:.6}],[{w:"triangle",v:.8,d:.6}],[{w:"triangle",v:.4,d:.05}],[{w:"square",v:.2,d:1}],[{w:"square",v:.2,d:1}],[{w:"sine",v:.4,d:.6}],[{w:"triangle",v:.7,d:.4}],[{w:"triangle",v:.7,d:.7}],[{w:"triangle",v:.7,d:.7}],[{w:"triangle",v:.7,d:.7}],[{w:"square",v:.3,d:.2}],[{w:"square",v:.3,d:.2}],[{w:"square",v:.3,d:.1,s:.2}],[{w:"sawtooth",v:.4,d:.1,s:.2}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.3,d:.1}],[{w:"sawtooth",v:.3,d:.5,r:.5}],[{w:"triangle",v:.6,d:.1,r:.1,h:.03,p:.8}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"triangle",v:.3,a:.03,s:1}],[{w:"sine",v:.3,a:.03,s:1}],[{w:"triangle",v:.3,a:.05,s:1}],[{w:"sawtooth",v:.5,a:.01,d:.1}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.2,a:.05,d:.01,s:1}],[{w:"square",v:.3,a:.05,s:1}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"square",v:.3,a:.04,d:2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.05,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"square",v:.3,s:.7}],[{w:"sawtooth",v:.4,s:.7}],[{w:"triangle",v:.5,s:.7}],[{w:"sawtooth",v:.4,s:.7}],[{w:"sawtooth",v:.4,d:12}],[{w:"sine",v:.4,a:.06,d:12}],[{w:"sawtooth",v:.4,d:12}],[{w:"sawtooth",v:.4,d:12}],[{w:"sawtooth",v:.3,d:12}],[{w:"triangle",v:.5,d:12}],[{w:"square",v:.3,d:12}],[{w:"triangle",v:.5,a:.08,d:11}],[{w:"sawtooth",v:.5,a:.05,d:11}],[{w:"sawtooth",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"square",v:.3,d:11}],[{w:"sawtooth",v:.5,a:.04,d:11}],[{w:"sawtooth",v:.5,d:11}],[{w:"triangle",v:.5,a:.8,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"square",v:.3,d:11}],[{w:"sawtooth",v:.3,d:1,r:1}],[{w:"sawtooth",v:.5,d:.3}],[{w:"sawtooth",v:.5,d:.3,r:.3}],[{w:"sawtooth",v:.5,d:.3,r:.3}],[{w:"square",v:.3,d:.2,r:.2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"sawtooth",v:.2,a:.02,d:.7}],[{w:"triangle",v:.5,d:1}],[{w:"sawtooth",v:.3,d:.3,r:.3}],[{w:"sine",v:.8,d:.1,r:.1}],[{w:"square",v:.2,d:.1,r:.1,p:1.05}],[{w:"sine",v:.8,d:.05,r:.05}],[{w:"triangle",v:.5,d:.1,r:.1,p:.96}],[{w:"triangle",v:.5,d:.1,r:.1,p:.97}],[{w:"square",v:.3,d:.1,r:.1}],[{w:"n1",v:.3,a:1,s:1,d:.15,r:0,t:.5}],[{w:"triangle",v:.5,d:.03,t:0,f:1332,r:.001,p:1.1}],[{w:"n0",v:.2,t:.1,d:.02,a:.05,h:.02,r:.02}],[{w:"n0",v:.4,a:1,d:1,t:.25}],[{w:"sine",v:.3,a:.8,d:1,t:0,f:1832}],[{w:"triangle",d:.5,t:0,f:444,s:1}],[{w:"n0",v:.4,d:1,t:0,f:22,s:1}],[{w:"n0",v:.5,a:.2,d:11,t:0,f:44}],[{w:"n0",v:.5,t:.25,d:.4,r:.4}]],drummap1:[[{w:"triangle",t:0,f:70,v:1,d:.05,h:.03,p:.9,q:.1},{w:"n0",g:1,t:6,v:17,r:.01,h:0,p:0}],[{w:"triangle",t:0,f:88,v:1,d:.05,h:.03,p:.5,q:.1},{w:"n0",g:1,t:5,v:42,r:.01,h:0,p:0}],[{w:"n0",f:222,p:0,t:0,r:.01,h:0}],[{w:"triangle",v:.3,f:180,d:.05,t:0,h:.03,p:.9,q:.1},{w:"n0",v:.6,t:0,f:70,h:.02,r:.01,p:0},{g:1,w:"square",v:2,t:0,f:360,r:.01,b:0,c:0}],[{w:"square",f:1150,v:.34,t:0,r:.03,h:.025,d:.03},{g:1,w:"n0",t:0,f:13,h:.025,d:.1,s:1,r:.1,v:1}],[{w:"triangle",f:200,v:1,d:.06,t:0,r:.06},{w:"n0",g:1,t:0,f:400,v:12,r:.02,d:.02}],[{w:"triangle",f:100,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.4,h:.015,d:.005,r:.005}],[{w:"n1",f:390,v:.25,r:.01,t:0}],[{w:"triangle",f:120,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.5,h:.015,d:.005,r:.005}],[{w:"n1",v:.25,f:390,r:.03,t:0,h:.005,d:.03}],[{w:"triangle",f:140,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",v:.25,f:390,t:0,d:.2,r:.2},{w:"n0",v:.3,t:0,c:0,f:440,h:.005,d:.05}],[{w:"triangle",f:155,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"triangle",f:180,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",v:.3,f:1200,d:.2,r:.2,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,p:1.2,f:440}],[{w:"triangle",f:220,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",f:500,v:.15,d:.4,r:.4,h:0,t:0},{w:"n0",v:.1,t:0,r:.01,f:440}],[{w:"n1",v:.3,f:800,d:.2,r:.2,h:.05,t:0},{w:"square",t:0,v:1,d:.1,r:.1,p:.1,f:220,g:1}],[{w:"sine",f:1651,v:.15,d:.2,r:.2,h:0,t:0},{w:"sawtooth",g:1,t:1.21,v:7.2,d:.1,r:11,h:1},{g:1,w:"n0",v:3.1,t:.152,d:.002,r:.002}],null,[{w:"n1",v:.3,f:1200,d:.2,r:.2,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,p:1.2,f:440}],null,[{w:"n1",v:.3,f:555,d:.25,r:.25,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,f:440,a:.005,h:.02}],[{w:"sawtooth",f:776,v:.2,d:.3,t:0,r:.3},{g:1,w:"n0",v:2,t:0,f:776,a:.005,h:.02,d:.1,s:1,r:.1,c:0},{g:11,w:"sine",v:.1,t:0,f:22,d:.3,r:.3,b:0,c:0}],[{w:"n1",f:440,v:.15,d:.4,r:.4,h:0,t:0},{w:"n0",v:.4,t:0,r:.01,f:440}],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,[{w:"sine",f:1720,v:.3,d:.02,t:0,r:.02},{w:"square",g:1,t:0,f:2876,v:6,d:.2,s:1,r:.2}],[{w:"sine",f:1720,v:.3,d:.25,t:0,r:.25},{w:"square",g:1,t:0,f:2876,v:6,d:.2,s:1,r:.2}]],drummap0:[[{w:"triangle",t:0,f:110,v:1,d:.05,h:.02,p:.1}],[{w:"triangle",t:0,f:150,v:.8,d:.1,p:.1,h:.02,r:.01}],[{w:"n0",f:392,v:.5,d:.01,p:0,t:0,r:.05}],[{w:"n0",f:33,d:.05,t:0}],[{w:"n0",f:100,v:.7,d:.03,t:0,r:.03,h:.02}],[{w:"n0",f:44,v:.7,d:.02,p:.1,t:0,h:.02}],[{w:"triangle",f:240,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,r:.01,t:0}],[{w:"triangle",f:270,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,d:.04,r:.04,t:0}],[{w:"triangle",f:300,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,d:.1,r:.1,h:.02,t:0}],[{w:"triangle",f:320,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"triangle",f:360,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.1,h:.05,t:0,p:.1}],[{w:"triangle",f:400,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:440,v:.3,d:.1,p:.9,t:0,r:.1}],[{w:"n0",f:200,v:.2,d:.05,p:.9,t:0}],[{w:"n0",f:440,v:.3,d:.12,p:.9,t:0}],[{w:"sine",f:800,v:.4,d:.06,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:33,v:.3,d:.2,p:.9,t:0}],[{w:"n0",f:300,v:.3,d:.14,p:.9,t:0}],[{w:"sine",f:200,d:.06,t:0}],[{w:"sine",f:150,d:.06,t:0}],[{w:"sine",f:300,t:0}],[{w:"sine",f:300,d:.06,t:0}],[{w:"sine",f:250,d:.06,t:0}],[{w:"square",f:300,v:.3,d:.06,p:.8,t:0}],[{w:"square",f:260,v:.3,d:.06,p:.8,t:0}],[{w:"sine",f:850,v:.5,d:.07,t:0}],[{w:"sine",f:790,v:.5,d:.07,t:0}],[{w:"n0",f:440,v:.3,a:.05,t:0}],[{w:"n0",f:440,v:.3,a:.05,t:0}],[{w:"triangle",f:1800,v:.4,p:.9,t:0,h:.03}],[{w:"triangle",f:1800,v:.3,p:.9,t:0,h:.13}],[{w:"n0",f:330,v:.3,a:.02,t:0,r:.01}],[{w:"n0",f:330,v:.3,a:.02,t:0,h:.04,r:.01}],[{w:"n0",f:440,v:.3,t:0}],[{w:"sine",f:800,t:0}],[{w:"sine",f:700,t:0}],[{w:"n0",f:330,v:.3,t:0}],[{w:"n0",f:330,v:.3,t:0,h:.1,r:.01,p:.7}],[{w:"sine",t:0,f:1200,v:.3,r:.01}],[{w:"sine",t:0,f:1200,v:.3,d:.2,r:.2}]],ready:function(){var m;this.pg=[],this.vol=[],this.ex=[],this.bend=[],this.rpnidx=[],this.brange=[],this.sustain=[],this.notetab=[],this.rhythm=[],this.masterTuningC=0,this.masterTuningF=0,this.tuningC=[],this.tuningF=[],this.scaleTuning=[],this.maxTick=0,this.playTick=0,this.playing=0,this.releaseRatio=3.5;for(var m=0;m<16;++m)this.pg[m]=0,this.vol[m]=3*100*100/(127*127),this.bend[m]=0,this.brange[m]=256,this.tuningC[m]=0,this.tuningF[m]=0,this.scaleTuning[m]=[0,0,0,0,0,0,0,0,0,0,0,0],this.rhythm[m]=0;this.rhythm[9]=1,this.preroll=.2,this.relcnt=0,setInterval((function(){if(++this.relcnt>=3){this.relcnt=0;for(var y=this.notetab.length-1;y>=0;--y){var C=this.notetab[y];this.actx.currentTime>C.e&&(this._pruneNote(C),this.notetab.splice(y,1))}}if(this.playing&&this.song.ev.length>0)for(var x=this.song.ev[this.playIndex];this.actx.currentTime+this.preroll>this.playTime;)if(x.m[0]==65361?(this.song.tempo=x.m[1],this.tick2Time=4*60/this.song.tempo/this.song.timebase):this.send(x.m,this.playTime),++this.playIndex,this.playIndex>=this.song.ev.length)if(this.loop)x=this.song.ev[this.playIndex=0],this.playTick=x.t;else{this.playTick=this.maxTick,this.playing=0;break}else x=this.song.ev[this.playIndex],this.playTime+=(x.t-this.playTick)*this.tick2Time,this.playTick=x.t}).bind(this),60),this.isReady=1},setMasterVol:function(m){m!=null&&(this.masterVol=m),this.out&&(this.out.gain.value=this.masterVol)},setReverbLev:function(m){m!=null&&(this.reverbLev=m);var y=parseFloat(this.reverbLev);this.rev&&!isNaN(y)&&(this.rev.gain.value=y*8)},setLoop:function(m){this.loop=m},setVoices:function(m){this.voices=m},reset:function(){for(var m=0;m<16;++m)this.setProgram(m,0),this.setBendRange(m,256),this.setModulation(m,0),this.setChVol(m,100),this.setPan(m,64),this.resetAllControllers(m),this.allSoundOff(m),this.rhythm[m]=0,this.tuningC[m]=0,this.tuningF[m]=0,this.scaleTuning[m]=[0,0,0,0,0,0,0,0,0,0,0,0];this.masterTuningC=0,this.masterTuningF=0,this.rhythm[9]=1},setQuality:function(m){var y;for(m!=null&&(this.quality=m),y=0;y<128;++y)this.setTimbre(0,y,this.program0[y]);for(y=0;y<this.drummap0.length;++y)this.setTimbre(1,y+35,this.drummap0[y]);if(this.quality){for(y=0;y<this.program1.length;++y)this.setTimbre(0,y,this.program1[y]);for(y=0;y<this.drummap.length;++y)this.drummap1[y]&&this.setTimbre(1,y+35,this.drummap1[y])}},setTimbre:function(m,y,C){var x={g:0,w:"sine",t:1,f:0,v:.5,a:0,h:.01,d:.01,s:0,r:.05,p:1,q:1,k:0};function b(S){for(y=0;y<S.length;++y)for(v in x)(!S[y].hasOwnProperty(v)||typeof S[y][v]>"u")&&(S[y][v]=x[v]);return S}m&&y>=35&&y<=81&&(this.drummap[y-35]=b(C)),m==0&&y>=0&&y<=127&&(this.program[y]=b(C))},_pruneNote:function(m){for(var y=m.o.length-1;y>=0;--y){if(m.o[y].frequency?m.o[y].frequency.cancelScheduledValues(0):m.o[y].playbackRate.cancelScheduledValues(0),m.g[y].gain.cancelScheduledValues(0),m.o[y].stop(),m.o[y].detune)try{this.chmod[m.ch].disconnect(m.o[y].detune)}catch{}m.g[y].gain.value=0}},_limitVoices:function(m,y){this.notetab.sort(function(b,S){return b.f!=S.f?b.f-S.f:b.e!=S.e?S.e-b.e:S.t-b.t});for(var C=this.notetab.length-1;C>=0;--C){var x=this.notetab[C];(this.actx.currentTime>x.e||C>=this.voices-1)&&(this._pruneNote(x),this.notetab.splice(C,1))}},_note:function(m,y,C,x,b){var S,A,E,R=[],N=[],V=[],M=[],j=[],J=440*Math.pow(2,(C-69+this.masterTuningC+this.tuningC[y]+(this.masterTuningF+this.tuningF[y]/8192+this.scaleTuning[y][C%12]))/12);this._limitVoices(y,C);for(var L=0;L<b.length;++L){E=b[L];var z=m+E.a+E.h;switch(E.g==0?(S=this.chvol[y],A=x*x/16384,M[L]=J*E.t+E.f):E.g>10?(S=N[E.g-11].gain,A=1,M[L]=M[E.g-11]*E.t+E.f):R[E.g-1].frequency?(S=R[E.g-1].frequency,A=M[E.g-1],M[L]=M[E.g-1]*E.t+E.f):(S=R[E.g-1].playbackRate,A=M[E.g-1]/440,M[L]=M[E.g-1]*E.t+E.f),E.w[0]){case"n":R[L]=this.actx.createBufferSource(),R[L].buffer=this.noiseBuf[E.w],R[L].loop=!0,R[L].playbackRate.value=M[L]/440,E.p!=1&&this._setParamTarget(R[L].playbackRate,M[L]/440*E.p,m,E.q),R[L].detune&&(this.chmod[y].connect(R[L].detune),R[L].detune.value=this.bend[y]);break;default:R[L]=this.actx.createOscillator(),R[L].frequency.value=M[L],E.p!=1&&this._setParamTarget(R[L].frequency,M[L]*E.p,m,E.q),E.w[0]=="w"?R[L].setPeriodicWave(this.wave[E.w]):R[L].type=E.w,R[L].detune&&(this.chmod[y].connect(R[L].detune),R[L].detune.value=this.bend[y]);break}N[L]=this.actx.createGain(),j[L]=E.r,R[L].connect(N[L]),N[L].connect(S),V[L]=A*E.v,E.k&&(V[L]*=Math.pow(2,(C-60)/12*E.k)),E.a?(N[L].gain.value=0,N[L].gain.setValueAtTime(0,m),N[L].gain.linearRampToValueAtTime(V[L],m+E.a)):N[L].gain.setValueAtTime(V[L],m),this._setParamTarget(N[L].gain,E.s*V[L],z,E.d),R[L].start(m),this.rhythm[y]&&(R[L].onended=function(Y,ie){return function(){ie&&Y.disconnect(ie)}}(this.chmod[y],R[L].detune),R[L].stop(m+b[0].d*this.releaseRatio))}this.rhythm[y]||this.notetab.push({t:m,e:99999,ch:y,n:C,o:R,g:N,t2:m+E.a,v:V,r:j,f:0})},_setParamTarget:function(m,y,C,x){x!=0?m.setTargetAtTime(y,C,x):m.setValueAtTime(y,C)},_releaseNote:function(m,y){if(m.ch!=9)for(var C=m.g.length-1;C>=0;--C)m.g[C].gain.cancelScheduledValues(y),y==m.t2?m.g[C].gain.setValueAtTime(m.v[C],y):y<m.t2&&m.g[C].gain.setValueAtTime(m.v[C]*(y-m.t)/(m.t2-m.t),y),this._setParamTarget(m.g[C].gain,0,y,m.r[C]);m.e=y+m.r[0]*this.releaseRatio,m.f=1},setModulation:function(m,y,C){this.chmod[m].gain.setValueAtTime(y*100/127,this._tsConv(C))},setChVol:function(m,y,C){this.vol[m]=3*y*y/(127*127),this.chvol[m].gain.setValueAtTime(this.vol[m]*this.ex[m],this._tsConv(C))},setPan:function(m,y,C){this.chpan[m]&&this.chpan[m].pan.setValueAtTime((y-64)/64,this._tsConv(C))},setExpression:function(m,y,C){this.ex[m]=y*y/(127*127),this.chvol[m].gain.setValueAtTime(this.vol[m]*this.ex[m],this._tsConv(C))},setSustain:function(m,y,C){if(this.sustain[m]=y,C=this._tsConv(C),y<64)for(var x=this.notetab.length-1;x>=0;--x){var b=this.notetab[x];C>=b.t&&b.ch==m&&b.f==1&&this._releaseNote(b,C)}},allSoundOff:function(m){for(var y=this.notetab.length-1;y>=0;--y){var C=this.notetab[y];C.ch==m&&(this._pruneNote(C),this.notetab.splice(y,1))}},resetAllControllers:function(m){this.bend[m]=0,this.ex[m]=1,this.rpnidx[m]=16383,this.sustain[m]=0,this.chvol[m]&&(this.chvol[m].gain.value=this.vol[m]*this.ex[m],this.chmod[m].gain.value=0)},setBendRange:function(m,y){this.brange[m]=y},setProgram:function(m,y){this.debug&&console.log("Pg("+m+")="+y),this.pg[m]=y},setBend:function(m,y,C){C=this._tsConv(C);var x=this.brange[m]*100/127;this.bend[m]=(y-8192)*x/8192;for(var b=this.notetab.length-1;b>=0;--b){var S=this.notetab[b];if(S.ch==m)for(var A=S.o.length-1;A>=0;--A)S.o[A].frequency&&S.o[A].detune&&S.o[A].detune.setValueAtTime(this.bend[m],C)}},noteOn:function(m,y,C,x){if(C==0){this.noteOff(m,y,x);return}if(x=this._tsConv(x),this.rhythm[m]){y>=35&&y<=81&&this._note(x,m,y,C,this.drummap[y-35]);return}this._note(x,m,y,C,this.program[this.pg[m]])},noteOff:function(m,y,C){if(!this.rhythm[m]){C=this._tsConv(C);for(var x=this.notetab.length-1;x>=0;--x){var b=this.notetab[x];C>=b.t&&b.ch==m&&b.n==y&&b.f==0&&(b.f=1,this.sustain[m]<64&&this._releaseNote(b,C))}}},_tsConv:function(m){return m==null||m<=0?(m=0,this.actx&&(m=this.actx.currentTime)):this.tsmode&&(m=m*.001-this.tsdiff),m},setTsMode:function(m){this.tsmode=m},send:function(m,y){var C=m[0]&15,x=m[0]&-16;if(!(x<128||x>=256))switch(this.audioContext.state=="suspended"&&this.audioContext.resume(),x){case 176:switch(m[1]){case 1:this.setModulation(C,m[2],y);break;case 7:this.setChVol(C,m[2],y);break;case 10:this.setPan(C,m[2],y);break;case 11:this.setExpression(C,m[2],y);break;case 64:this.setSustain(C,m[2],y);break;case 98:case 99:this.rpnidx[C]=16383;break;case 100:this.rpnidx[C]=this.rpnidx[C]&16256|m[2];break;case 101:this.rpnidx[C]=this.rpnidx[C]&127|m[2]<<7;break;case 6:switch(this.rpnidx[C]){case 0:this.brange[C]=(m[2]<<7)+(this.brange[C]&127);break;case 1:this.tuningF[C]=(m[2]<<7)+(this.tuningF[C]+8192&127)-8192;break;case 2:this.tuningC[C]=m[2]-64;break}break;case 38:switch(this.rpnidx[C]){case 0:this.brange[C]=this.brange[C]&16256|m[2];break;case 1:this.tuningF[C]=(this.tuningF[C]+8192&16256|m[2])-8192;break}break;case 120:case 123:case 124:case 125:case 126:case 127:this.allSoundOff(C);break;case 121:this.resetAllControllers(C);break}break;case 192:this.setProgram(C,m[1]);break;case 224:this.setBend(C,m[1]+(m[2]<<7),y);break;case 144:this.noteOn(C,m[1],m[2],y);break;case 128:this.noteOff(C,m[1],y);break;case 240:if(m[0]==255){this.reset();break}if(m[0]!=254&&this.debug)for(var b=[],S=0;S<m.length;++S)b.push(m[S].toString(16));if(m[0]==240&&(m[1]==127&&m[3]==4&&(m[4]==3&&m.length>=8&&(this.masterTuningF=(m[6]*128+m[5]-8192)/8192),m[4]==4&&m.length>=8&&(this.masterTuningC=m[6]-64)),m[1]==65&&m[3]==66&&m[4]==18&&m[5]==64))if((m[6]&240)==16&&m.length==11){var A=[9,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15][m[6]&15];m[7]==21?this.rhythm[A]=m[8]:m[7]>=64&&m[7]<=75&&(this.scaleTuning[A][m[7]-64]=(m[8]-64)/100)}else m[6]==0&&(m[7]==0&&m.length==14?this.masterTuningF=(m[8]*4096+m[9]*256+m[10]*16+m[11]-1024)/1e3:m[7]==5&&m.length==11&&(this.masterTuningC=m[8]-64));break}},_createWave:function(m){for(var y=new Float32Array(m.length),C=new Float32Array(m.length),x=1;x<m.length;++x)y[x]=m[x];return this.actx.createPeriodicWave(C,y)},getAudioContext:function(){return this.actx},setAudioContext:function(m,y){this.audioContext=this.actx=m,this.dest=y,y||(this.dest=m.destination),this.tsdiff=performance.now()*.001-this.actx.currentTime,this.out=this.actx.createGain(),this.comp=this.actx.createDynamicsCompressor();var C=this.actx.sampleRate*.5|0;this.convBuf=this.actx.createBuffer(2,C,this.actx.sampleRate),this.noiseBuf={},this.noiseBuf.n0=this.actx.createBuffer(1,C,this.actx.sampleRate),this.noiseBuf.n1=this.actx.createBuffer(1,C,this.actx.sampleRate);for(var x=this.convBuf.getChannelData(0),b=this.convBuf.getChannelData(1),S=this.noiseBuf.n0.getChannelData(0),A=this.noiseBuf.n1.getChannelData(0),E=0;E<C;++E)E/C<Math.random()&&(x[E]=Math.exp(-3*E/C)*(Math.random()-.5)*.5,b[E]=Math.exp(-3*E/C)*(Math.random()-.5)*.5),S[E]=Math.random()*2-1;for(var R=0;R<64;++R){var N=Math.random()*10+1,V=Math.random()*10+1;for(E=0;E<C;++E){var M=Math.sin(E/C*2*Math.PI*440*N)*Math.sin(E/C*2*Math.PI*440*V);A[E]+=M/8}}for(this.useReverb&&(this.conv=this.actx.createConvolver(),this.conv.buffer=this.convBuf,this.rev=this.actx.createGain(),this.rev.gain.value=this.reverbLev,this.out.connect(this.conv),this.conv.connect(this.rev),this.rev.connect(this.comp)),this.setMasterVol(),this.out.connect(this.comp),this.comp.connect(this.dest),this.chvol=[],this.chmod=[],this.chpan=[],this.wave={w9999:this._createWave("w9999")},this.lfo=this.actx.createOscillator(),this.lfo.frequency.value=5,this.lfo.start(0),E=0;E<16;++E)this.chvol[E]=this.actx.createGain(),this.actx.createStereoPanner?(this.chpan[E]=this.actx.createStereoPanner(),this.chvol[E].connect(this.chpan[E]),this.chpan[E].connect(this.out)):(this.chpan[E]=null,this.chvol[E].connect(this.out)),this.chmod[E]=this.actx.createGain(),this.lfo.connect(this.chmod[E]),this.pg[E]=0,this.resetAllControllers(E);this.setReverbLev(),this.reset()}};for(var v in this.sy.properties)this[v]=this.sy.properties[v].value;this.setQuality(1),h&&(h.useReverb!=null&&(this.useReverb=h.useReverb),h.quality!=null&&this.setQuality(h.quality),h.voices!=null&&this.setVoices(h.voices)),this.ready()}function s(h,v,m){if(typeof v>"u")return s(h,[],[]);if(h instanceof Object){for(var y=0;y<v.length;y++)if(v[y]===h)return m[y];var C;h instanceof Array?C=[]:C={},v.push(h),m.push(C);for(var x in h)h.hasOwnProperty(x)&&(C[x]=s(h[x],v,m));return C}return h}var a;function c(){return a||(a=t.lib.getAudioContext()),!!a}var d={},f={};f._info=function(h){return h||(h="JZZ.synth.Tiny"),{type:"Web Audio",name:h,manufacturer:"virtual",version:r}},f._openOut=function(h,v){if(c(),!a){h._crash("AudioContext not supported");return}var m;typeof v<"u"?(v=""+v,d[v]||(d[v]=new i),m=d[v]):m=new i,m.setAudioContext(a),h.plug=function(y){y&&(y.context instanceof AudioContext||y.context instanceof webkitAudioContext)&&m.setAudioContext(y.context,y)},h.setSynth=function(y,C,x){m.setTimbre(!!x,y,s(C))},h.getSynth=function(y,C){return s(C?m.drummap[y-35]:m.program[y])},h._info=f._info(v),h._receive=function(y){m.send(y)},h._resume()},t.synth.Tiny=function(h){return t.lib.openMidiOut(h,f)},t.synth.Tiny.register=function(h){return c()?t.lib.registerMidiOut(h,f):!1},t.synth.Tiny.version=function(){return r}})}(B0)),B0.exports}var CB=yB();const $l=class $l{constructor(){ae(this,"isInitialized",!1);ae(this,"virtualPort",null);ae(this,"portName","Virtual Synthesizer")}static getInstance(){return $l.instance||($l.instance=new $l),$l.instance}async initialize(){if(this.isInitialized)return!0;try{const e=await _f();return CB.Tiny(_f),_f.synth.Tiny.register(this.portName),e.refresh(),console.log(`Virtual MIDI synthesizer registered as: ${this.portName}`),this.isInitialized=!0,!0}catch(e){return console.error("Failed to initialize virtual MIDI synthesizer:",e),!1}}async getVirtualPort(){if(!this.isInitialized&&!await this.initialize())return null;try{return this.virtualPort=await _f().openMidiOut(this.portName),this.virtualPort}catch(e){return console.error("Failed to open virtual MIDI port:",e),null}}getPortName(){return this.portName}get initialized(){return this.isInitialized}close(){this.virtualPort&&(this.virtualPort.close(),this.virtualPort=null)}};ae($l,"instance");let fy=$l;const ta=fy.getInstance();var hy=(n=>(n.Off="off",n.Unfocused="unfocused",n.All="all",n))(hy||{}),to=(n=>(n.SetGeneral="SET_GENERAL",n.SetSpeech="SET_SPEECH",n.SetSound="SET_SOUND",n.SetChannels="SET_CHANNELS",n.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",n.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",n.SetMidi="SET_MIDI",n))(to||{});class xB{constructor(){ae(this,"state");ae(this,"listeners",new Set);ae(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(t=>t())});var i;const e=localStorage.getItem("preferences"),t=this.getInitialPreferences();let r=e?JSON.parse(e):null;((i=r==null?void 0:r.general)==null?void 0:i.volume)!==void 0&&(r!=null&&r.sound)&&(r.sound.volume||(r.sound.volume=r.general.volume),delete r.general.volume),this.state=r?this.mergePreferences(t,r):t}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},sound:{muteInBackground:!1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0},midi:{enabled:!1}}}mergePreferences(e,t){return{...e,general:{...e.general,...t.general},speech:{...e.speech,...t.speech},sound:{...e.sound,...t.sound},channels:t.channels?{...e.channels,...t.channels}:e.channels,editor:{...e.editor,...t.editor},midi:{...e.midi,...t.midi}}}reducer(e,t){switch(t.type){case"SET_GENERAL":return{...e,general:t.data};case"SET_SPEECH":return{...e,speech:t.data};case"SET_SOUND":return{...e,sound:t.data};case"SET_CHANNELS":return{...e,channels:t.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:t.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:t.data}};case"SET_MIDI":return{...e,midi:t.data};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const ur=new xB;class wB{constructor(){ae(this,"jzz",null);ae(this,"inputDevice",null);ae(this,"outputDevice",null);ae(this,"inputCallback",null);ae(this,"deviceChangeCallbacks",new Set);ae(this,"deviceWatcher",null);ae(this,"connectionState",{inputConnected:!1,outputConnected:!1})}async initialize(){try{return this.jzz=await _f(),console.log("JZZ MIDI engine initialized"),this.deviceWatcher=this.jzz.onChange(e=>{const t=this.processDeviceChanges(e);this.deviceChangeCallbacks.forEach(r=>r(t)),this.handleDeviceDisconnections(t)}),await this.attemptAutoReconnect(),!0}catch(e){return console.error("Failed to initialize JZZ MIDI engine:",e),!1}}getInputDevices(){if(!this.jzz)return[];const e=[],t=this.jzz.info();return t&&t.inputs&&t.inputs.forEach(r=>{e.push({id:r.id||r.name,name:r.name||"Unknown Input Device"})}),e}getOutputDevices(){const e=[];if(ta.initialized&&e.push({id:"virtual-synth",name:ta.getPortName()}),this.jzz){const t=this.jzz.info();t&&t.outputs&&t.outputs.forEach(r=>{e.push({id:r.id||r.name,name:r.name||"Unknown Output Device"})})}return e}async connectInputDevice(e,t){if(!this.jzz)return!1;try{this.inputDevice&&this.inputDevice.close(),this.inputDevice=await this.jzz.openMidiIn(e),this.inputCallback=t,this.inputDevice.connect(s=>{var m;const a=s.data||s,c=a[0];if(c===254)return;const d=c&240,f=c&15,h={hex:Array.from(a).map(y=>y.toString(16).padStart(2,"0").toUpperCase()).join(" "),data:new Uint8Array(a),type:this.getMidiMessageType(c)},v={rawData:h};if(d===144||d===128){const y=a[1],C=a[2],x=d===144&&C>0;v.note={note:y,velocity:C,on:x,channel:f}}else if(d===176){const y=a[1],C=a[2];v.controlChange={controller:y,value:C,channel:f}}else if(d===192){const y=a[1];v.programChange={program:y,channel:f}}else(c&240)===240?v.systemMessage={type:this.getSystemMessageType(c),data:Array.from(a)}:v.raw=h;(m=this.inputCallback)==null||m.call(this,v)}),this.connectionState.inputConnected=!0,this.connectionState.inputDeviceId=e;const i=this.getInputDevices().find(s=>s.id===e);return this.connectionState.inputDeviceName=(i==null?void 0:i.name)||"Unknown Device",ur.dispatch({type:"SET_MIDI",data:{...ur.getState().midi,lastInputDeviceId:e}}),console.log(`Connected to MIDI input: ${this.connectionState.inputDeviceName}`),!0}catch(r){return console.error("Failed to connect to MIDI input:",r),!1}}async connectOutputDevice(e){var t,r;try{if(this.outputDevice&&((r=(t=this.outputDevice).close)==null||r.call(t)),e==="virtual-synth"){const a=await ta.getVirtualPort();return a?(this.outputDevice=a,this.connectionState.outputConnected=!0,this.connectionState.outputDeviceId=e,this.connectionState.outputDeviceName=ta.getPortName(),ur.dispatch({type:"SET_MIDI",data:{...ur.getState().midi,lastOutputDeviceId:e}}),console.log(`Connected to virtual MIDI synthesizer: ${ta.getPortName()}`),!0):!1}if(!this.jzz)return!1;this.outputDevice=await this.jzz.openMidiOut(e),this.connectionState.outputConnected=!0,this.connectionState.outputDeviceId=e;const s=this.getOutputDevices().find(a=>a.id===e);return this.connectionState.outputDeviceName=(s==null?void 0:s.name)||"Unknown Device",ur.dispatch({type:"SET_MIDI",data:{...ur.getState().midi,lastOutputDeviceId:e}}),console.log(`Connected to MIDI output: ${this.connectionState.outputDeviceName}`),!0}catch(i){return console.error("Failed to connect to MIDI output:",i),!1}}sendNote(e){if(!this.outputDevice)return;const t=e.channel||0,r=e.on?144|t:128|t,i=e.on?Math.max(1,Math.min(127,e.velocity)):0;this.outputDevice.send([r,e.note,i])}sendRawMessage(e){this.outputDevice&&this.outputDevice.send(e)}sendAllNotesOff(){if(this.outputDevice)for(let e=0;e<16;e++)this.outputDevice.send([176|e,123,0]),this.outputDevice.send([176|e,120,0])}disconnect(){var e,t,r,i;this.inputDevice&&((t=(e=this.inputDevice).close)==null||t.call(e),this.inputDevice=null),this.outputDevice&&((i=(r=this.outputDevice).close)==null||i.call(r),this.outputDevice=null),this.inputCallback=null,this.connectionState.inputConnected=!1,this.connectionState.outputConnected=!1,this.connectionState.inputDeviceId=void 0,this.connectionState.outputDeviceId=void 0,this.connectionState.inputDeviceName=void 0,this.connectionState.outputDeviceName=void 0}get isSupported(){return!0}get isInitialized(){return!!this.jzz}get hasInputDevice(){return this.connectionState.inputConnected}get hasOutputDevice(){return this.connectionState.outputConnected}get connectionStatus(){return{...this.connectionState}}onDeviceChange(e){return this.deviceChangeCallbacks.add(e),()=>this.deviceChangeCallbacks.delete(e)}refresh(){this.jzz&&this.jzz.refresh()}processDeviceChanges(e){var r,i,s,a;const t={inputs:{added:[],removed:[]},outputs:{added:[],removed:[]}};return(r=e.inputs)!=null&&r.added&&e.inputs.added.forEach(c=>{t.inputs.added.push({id:c.id||c.name,name:c.name||"Unknown Input Device"})}),(i=e.inputs)!=null&&i.removed&&e.inputs.removed.forEach(c=>{t.inputs.removed.push({id:c.id||c.name,name:c.name||"Unknown Input Device"})}),(s=e.outputs)!=null&&s.added&&e.outputs.added.forEach(c=>{t.outputs.added.push({id:c.id||c.name,name:c.name||"Unknown Output Device"})}),(a=e.outputs)!=null&&a.removed&&e.outputs.removed.forEach(c=>{t.outputs.removed.push({id:c.id||c.name,name:c.name||"Unknown Output Device"})}),t}handleDeviceDisconnections(e){this.connectionState.inputConnected&&this.connectionState.inputDeviceId&&e.inputs.removed.some(r=>r.id===this.connectionState.inputDeviceId)&&(console.log(`Input device ${this.connectionState.inputDeviceName} was disconnected`),this.connectionState.inputConnected=!1,this.inputDevice=null),this.connectionState.outputConnected&&this.connectionState.outputDeviceId&&e.outputs.removed.some(r=>r.id===this.connectionState.outputDeviceId)&&(console.log(`Output device ${this.connectionState.outputDeviceName} was disconnected`),this.connectionState.outputConnected=!1,this.outputDevice=null)}async attemptAutoReconnect(){const e=ur.getState().midi;if(e.lastInputDeviceId){const r=this.getInputDevices().find(i=>i.id===e.lastInputDeviceId);r&&console.log(`Input device available for auto-reconnect: ${r.name}`)}if(e.lastOutputDeviceId){const r=this.getOutputDevices().find(i=>i.id===e.lastOutputDeviceId);r&&(console.log(`Attempting to auto-reconnect to output device: ${r.name}`),await this.connectOutputDevice(e.lastOutputDeviceId))}}async attemptAutoReconnectInput(e){const t=ur.getState().midi;if(t.lastInputDeviceId){const i=this.getInputDevices().find(s=>s.id===t.lastInputDeviceId);if(i)return console.log(`Attempting to auto-reconnect to input device: ${i.name}`),await this.connectInputDevice(t.lastInputDeviceId,e)}return!1}canReconnectToDevice(e,t){return(t==="input"?this.getInputDevices():this.getOutputDevices()).some(i=>i.id===e)}async attemptReconnect(e,t){return t==="input"&&this.inputCallback?await this.connectInputDevice(e,this.inputCallback):t==="output"?await this.connectOutputDevice(e):!1}shutdown(){this.disconnect(),this.deviceWatcher&&(this.deviceWatcher.disconnect(),this.deviceWatcher=null),this.jzz&&(this.jzz.close(),this.jzz=null),this.deviceChangeCallbacks.clear()}getMidiMessageType(e){const t=e&240,r=(e&15)+1;switch(t){case 128:return`Note Off Ch.${r}`;case 144:return`Note On Ch.${r}`;case 160:return`Polyphonic Aftertouch Ch.${r}`;case 176:return`Control Change Ch.${r}`;case 192:return`Program Change Ch.${r}`;case 208:return`Channel Aftertouch Ch.${r}`;case 224:return`Pitch Bend Ch.${r}`;case 240:return this.getSystemMessageType(e);default:return`Unknown (${e.toString(16).toUpperCase()})`}}getSystemMessageType(e){switch(e){case 240:return"System Exclusive";case 241:return"MIDI Time Code Quarter Frame";case 242:return"Song Position Pointer";case 243:return"Song Select";case 246:return"Tune Request";case 247:return"End of Exclusive";case 248:return"Timing Clock";case 250:return"Start";case 251:return"Continue";case 252:return"Stop";case 254:return"Active Sensing";case 255:return"Reset";default:return`System (${e.toString(16).toUpperCase()})`}}}const sn=new wB;class IB extends tr{constructor(t){super(t);ae(this,"packageName","Client.Midi");ae(this,"packageVersion",1);ae(this,"activeNotes",new Map);ae(this,"isAdvertised",!1);ae(this,"debugCallback")}get enabled(){return ur.getState().midi.enabled}async ensureInitialized(){if(this.isInitialized)return!0;if(!sn.isSupported)return console.log("MIDI not supported in this browser"),!1;const t=await sn.initialize();return t&&(console.log("MIDI service initialized"),await sn.attemptAutoReconnectInput(r=>{this.handleInputMessage(r)})),t}get isInitialized(){return sn.isInitialized}async connectInputDevice(t){return await this.ensureInitialized()?await sn.connectInputDevice(t,i=>{this.handleInputMessage(i)}):!1}async connectOutputDevice(t){return await this.ensureInitialized()?await sn.connectOutputDevice(t):!1}handleInputMessage(t){let r="";const i=t.rawData.hex,s=t.rawData.type;if(t.note){const a={note:t.note.note,velocity:t.note.velocity,on:t.note.on,channel:t.note.channel};this.sendData("Note",a),r=`Client.Midi.Note ${JSON.stringify(a)}`}else if(t.controlChange){const a={controller:t.controlChange.controller,value:t.controlChange.value,channel:t.controlChange.channel};this.sendData("ControlChange",a),r=`Client.Midi.ControlChange ${JSON.stringify(a)}`}else if(t.programChange){const a={program:t.programChange.program,channel:t.programChange.channel};this.sendData("ProgramChange",a),r=`Client.Midi.ProgramChange ${JSON.stringify(a)}`}else if(t.systemMessage){const a={type:t.systemMessage.type,data:t.systemMessage.data};this.sendData("SystemMessage",a),r=`Client.Midi.SystemMessage ${JSON.stringify(a)}`}else if(t.raw){const a={hex:t.raw.hex,data:Array.from(t.raw.data),type:t.raw.type};this.sendData("RawMessage",a),r=`Client.Midi.RawMessage ${JSON.stringify(a)}`}this.debugCallback&&r&&this.debugCallback(i,s,r)}sendNoteToServer(t,r){const i={note:t.note,velocity:t.velocity,on:t.on,channel:t.channel};r!==void 0&&(i.duration=r),this.sendData("Note",i)}handleNote(t){const r={note:t.note,velocity:t.velocity,on:t.on,channel:t.channel},i=`${t.note}_${t.channel||0}`;if(this.activeNotes.has(i)&&(clearTimeout(this.activeNotes.get(i)),this.activeNotes.delete(i)),sn.sendNote(r),t.on&&t.duration){const s=setTimeout(()=>{sn.sendNote({...r,on:!1,velocity:0}),this.activeNotes.delete(i)},t.duration);this.activeNotes.set(i,s)}}handleControlChange(t){if(sn.hasOutputDevice){const r=176|t.channel;sn.sendRawMessage([r,t.controller,t.value])}}handleProgramChange(t){if(sn.hasOutputDevice){const r=192|t.channel;sn.sendRawMessage([r,t.program])}}handleSystemMessage(t){sn.hasOutputDevice&&sn.sendRawMessage(t.data)}handleRawMessage(t){sn.hasOutputDevice&&sn.sendRawMessage(t.data)}handleEnable(t){console.log("Server MIDI enable status:",t.enabled)}advertiseMidiSupport(){if(!this.isAdvertised){const t=this.client.gmcpHandlers["Core.Supports"];t&&(t.sendAdd([{name:"Client.Midi",version:this.packageVersion||1}]),this.isAdvertised=!0,console.log("Advertised MIDI support to server"))}}unadvertiseMidiSupport(){if(this.isAdvertised){const t=this.client.gmcpHandlers["Core.Supports"];t&&(t.sendRemove(["Client.Midi"]),this.isAdvertised=!1,console.log("Removed MIDI support advertisement from server"))}}sendMidiCapability(){this.sendData("Enable",{enabled:sn.isSupported&&sn.isInitialized})}sendManualNote(t,r,i,s,a){const c={note:t,velocity:r,on:i,channel:s||0};this.sendNoteToServer(c,a)}sendAllNotesOff(){sn.sendAllNotesOff(),this.activeNotes.forEach(t=>{clearTimeout(t)}),this.activeNotes.clear()}async getInputDevices(){return await this.ensureInitialized()?sn.getInputDevices():[]}async getOutputDevices(){return await this.ensureInitialized()?sn.getOutputDevices():[]}get hasInputDevice(){return sn.hasInputDevice}get hasOutputDevice(){return sn.hasOutputDevice}setDebugCallback(t){this.debugCallback=t}shutdown(){sn.disconnect(),this.activeNotes.forEach(t=>{clearTimeout(t)}),this.activeNotes.clear()}}class bB extends tr{constructor(){super(...arguments);ae(this,"packageName","Client.Speech")}handleSpeak(t){const r=new SpeechSynthesisUtterance(t.text);r.rate=t.rate,r.pitch=t.pitch,r.volume=t.volume,speechSynthesis.speak(r)}}class SB extends tr{constructor(){super(...arguments);ae(this,"packageName","Comm.Channel");ae(this,"channels",[])}handleList(t){this.channels=t}sendList(){this.sendData("List")}handleText(t){console.log(`Received Comm.Channel.Text on ${t.channel} from ${t.talker}: ${t.text}`),this.client.emit("channelText",t),t.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${t.talker}`,`${t.text}`))}handlePlayers(t){console.log("Received Comm.Channel.Players:",t),this.client.emit("channelPlayers",t)}sendPlayersRequest(){this.sendData("Players","")}sendEnable(t){this.sendData("Enable",t)}handleStart(t){console.log(`Received Comm.Channel.Start for ${t}`),this.client.emit("channelStart",t)}handleEnd(t){console.log(`Received Comm.Channel.End for ${t}`),this.client.emit("channelEnd",t)}}class AB extends tr{constructor(){super(...arguments);ae(this,"packageName","Comm.LiveKit")}handleroom_token(t){this.client.worldData.liveKitTokens.push(t.token),this.client.emit("livekitToken",t.token)}handleroom_leave(t){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==t.token),this.client.emit("livekitLeave",t.token)}}class kB extends tr{constructor(){super(...arguments);ae(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}sendKeepAlive(){this.sendData("KeepAlive")}sendPing(t){this.sendData("Ping",t)}handlePing(){console.log("Received Core.Ping response from server."),this.client.emit("corePing")}handleGoodbye(t){console.log(`Server sent Core.Goodbye: ${t}`),this.client.emit("coreGoodbye",t)}}class EB extends tr{constructor(){super(...arguments);ae(this,"packageName","Core.Supports")}sendSet(){const t=Object.values(this.client.gmcpHandlers).filter(r=>r.packageName&&r.packageVersion&&r.enabled).map(r=>`${r.packageName} ${r.packageVersion.toString()}`);this.sendData("Set",t)}sendAdd(t){const r=t.map(i=>`${i.name} ${i.version}`);this.sendData("Add",r)}sendRemove(t){this.sendData("Remove",t)}}class TB extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Afflictions")}handleList(t){console.log("Received Char.Afflictions.List:",t),this.client.emit("afflictionsList",t)}handleAdd(t){console.log("Received Char.Afflictions.Add:",t),this.client.emit("afflictionAdd",t)}handleRemove(t){console.log("Received Char.Afflictions.Remove:",t),this.client.emit("afflictionRemove",t)}}class _B extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Defences")}handleList(t){console.log("Received Char.Defences.List:",t),this.client.emit("defencesList",t)}handleAdd(t){console.log("Received Char.Defences.Add:",t),this.client.emit("defenceAdd",t)}handleRemove(t){console.log("Received Char.Defences.Remove:",t),this.client.emit("defenceRemove",t)}}class RB extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Items")}handleList(t){console.log(`Received Char.Items.List for ${t.location}:`,t.items);const r=t.items.map(i=>({...i,location:t.location}));this.client.emit("itemsList",{...t,items:r})}handleAdd(t){console.log(`Received Char.Items.Add for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemAdd",{...t,item:r})}handleRemove(t){console.log(`Received Char.Items.Remove for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemRemove",{...t,item:r})}handleUpdate(t){console.log(`Received Char.Items.Update for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemUpdate",{...t,item:r})}sendContentsRequest(t){this.sendData("Contents",t)}sendInventoryRequest(){this.sendData("Inv","")}sendRoomRequest(){this.sendData("Room","")}}class DB extends tr{constructor(){super(...arguments);ae(this,"packageName","Char.Skills")}handleGroups(t){console.log("Received Char.Skills.Groups:",t),this.client.emit("skillGroups",t)}handleList(t){console.log(`Received Char.Skills.List for ${t.group}:`,t),this.client.emit("skillList",t)}handleInfo(t){console.log(`Received Char.Skills.Info for ${t.group}.${t.skill}:`,t.info),this.client.emit("skillInfo",t)}sendGetRequest(t,r){const i={};t&&(i.group=t),r&&(i.name=r),this.sendData("Get",i)}}class PB extends tr{constructor(){super(...arguments);ae(this,"packageName","Group")}handleInfo(t){console.log("Received Group.Info:",t),this.client.emit("groupInfo",t)}sendInfoRequest(){this.sendData("Info",{})}}class NB extends tr{constructor(){super(...arguments);ae(this,"packageName","Logging")}handleError(t){console.error("Received Logging.Error from server:",t),this.client.emit("gmcpError",t)}}class MB extends tr{constructor(){super(...arguments);ae(this,"packageName","Redirect")}handleWindow(t){const r=t||"main";console.log(`Received Redirect.Window: ${r}`),this.client.emit("redirectWindow",r)}}class BB extends tr{constructor(){super(...arguments);ae(this,"packageName","Room");ae(this,"name","");ae(this,"id","");ae(this,"exits",[]);ae(this,"people",[])}handleInfo(t){this.client.worldData.roomPlayers=[],this.name=t.name,this.id=t.num.toString(),this.client.worldData.roomId=this.id,this.client.currentRoomInfo=t,console.log("Received Room.Info:",t),this.client.emit("roomInfo",t)}handleWrongDir(t){console.log(`Received Room.WrongDir: ${t}`),this.client.emit("roomWrongDir",t)}handlePlayers(t){console.log("Received Room.Players:",t),this.client.worldData.roomPlayers=t.sort((r,i)=>r.fullname.localeCompare(i.fullname)),this.client.emit("roomPlayers",t)}handleAddPlayer(t){console.log("Received Room.AddPlayer:",t),this.client.worldData.roomPlayers.some(r=>r.name===t.name)||(this.client.worldData.roomPlayers.push(t),this.client.worldData.roomPlayers.sort((r,i)=>r.fullname.localeCompare(i.fullname))),this.client.emit("roomAddPlayer",t)}handleRemovePlayer(t){console.log("Received Room.RemovePlayer:",t),this.client.worldData.roomPlayers=this.client.worldData.roomPlayers.filter(r=>r.name!==t),this.client.emit("roomRemovePlayer",t)}}const Zu=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Yk=new Set,py=typeof process=="object"&&process?process:{},Qk=(n,e,t,r)=>{typeof py.emitWarning=="function"?py.emitWarning(n,e,t,r):console.error(`[${t}] ${e}: ${n}`)};let $p=globalThis.AbortController,UI=globalThis.AbortSignal;var hA;if(typeof $p>"u"){UI=class{constructor(){ae(this,"onabort");ae(this,"_onabort",[]);ae(this,"reason");ae(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},$p=class{constructor(){ae(this,"signal",new UI);e()}abort(r){var i,s;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const a of this.signal._onabort)a(r);(s=(i=this.signal).onabort)==null||s.call(i,r)}}};let n=((hA=py.env)==null?void 0:hA.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{n&&(n=!1,Qk("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const OB=n=>!Yk.has(n),tl=n=>n&&n===Math.floor(n)&&n>0&&isFinite(n),eE=n=>tl(n)?n<=Math.pow(2,8)?Uint8Array:n<=Math.pow(2,16)?Uint16Array:n<=Math.pow(2,32)?Uint32Array:n<=Number.MAX_SAFE_INTEGER?O0:null:null;class O0 extends Array{constructor(e){super(e),this.fill(0)}}var cd;const Kl=class Kl{constructor(e,t){ae(this,"heap");ae(this,"length");if(!ue(Kl,cd))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}static create(e){const t=eE(e);if(!t)return[];en(Kl,cd,!0);const r=new Kl(e,t);return en(Kl,cd,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};cd=new WeakMap,Rn(Kl,cd,!1);let gy=Kl;var pA,gA,yo,Ts,Co,xo,ld,ud,Hr,wo,Or,cr,pn,ji,_s,Pi,si,Io,oi,bo,So,Rs,Ao,ol,Wi,yt,vy,Jl,Za,ih,Ds,tE,Yl,dd,sh,nl,rl,yy,F0,L0,ar,Cy,Rf,il,xy;const _1=class _1{constructor(e){Rn(this,yt);Rn(this,yo);Rn(this,Ts);Rn(this,Co);Rn(this,xo);Rn(this,ld);Rn(this,ud);ae(this,"ttl");ae(this,"ttlResolution");ae(this,"ttlAutopurge");ae(this,"updateAgeOnGet");ae(this,"updateAgeOnHas");ae(this,"allowStale");ae(this,"noDisposeOnSet");ae(this,"noUpdateTTL");ae(this,"maxEntrySize");ae(this,"sizeCalculation");ae(this,"noDeleteOnFetchRejection");ae(this,"noDeleteOnStaleGet");ae(this,"allowStaleOnFetchAbort");ae(this,"allowStaleOnFetchRejection");ae(this,"ignoreFetchAbort");Rn(this,Hr);Rn(this,wo);Rn(this,Or);Rn(this,cr);Rn(this,pn);Rn(this,ji);Rn(this,_s);Rn(this,Pi);Rn(this,si);Rn(this,Io);Rn(this,oi);Rn(this,bo);Rn(this,So);Rn(this,Rs);Rn(this,Ao);Rn(this,ol);Rn(this,Wi);Rn(this,Jl,()=>{});Rn(this,Za,()=>{});Rn(this,ih,()=>{});Rn(this,Ds,()=>!1);Rn(this,Yl,e=>{});Rn(this,dd,(e,t,r)=>{});Rn(this,sh,(e,t,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});ae(this,pA,"LRUCache");const{max:t=0,ttl:r,ttlResolution:i=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:d,dispose:f,disposeAfter:h,noDisposeOnSet:v,noUpdateTTL:m,maxSize:y=0,maxEntrySize:C=0,sizeCalculation:x,fetchMethod:b,memoMethod:S,noDeleteOnFetchRejection:A,noDeleteOnStaleGet:E,allowStaleOnFetchRejection:R,allowStaleOnFetchAbort:N,ignoreFetchAbort:V}=e;if(t!==0&&!tl(t))throw new TypeError("max option must be a nonnegative integer");const M=t?eE(t):Array;if(!M)throw new Error("invalid max value: "+t);if(en(this,yo,t),en(this,Ts,y),this.maxEntrySize=C||ue(this,Ts),this.sizeCalculation=x,this.sizeCalculation){if(!ue(this,Ts)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(S!==void 0&&typeof S!="function")throw new TypeError("memoMethod must be a function if defined");if(en(this,ud,S),b!==void 0&&typeof b!="function")throw new TypeError("fetchMethod must be a function if specified");if(en(this,ld,b),en(this,ol,!!b),en(this,Or,new Map),en(this,cr,new Array(t).fill(void 0)),en(this,pn,new Array(t).fill(void 0)),en(this,ji,new M(t)),en(this,_s,new M(t)),en(this,Pi,0),en(this,si,0),en(this,Io,gy.create(t)),en(this,Hr,0),en(this,wo,0),typeof f=="function"&&en(this,Co,f),typeof h=="function"?(en(this,xo,h),en(this,oi,[])):(en(this,xo,void 0),en(this,oi,void 0)),en(this,Ao,!!ue(this,Co)),en(this,Wi,!!ue(this,xo)),this.noDisposeOnSet=!!v,this.noUpdateTTL=!!m,this.noDeleteOnFetchRejection=!!A,this.allowStaleOnFetchRejection=!!R,this.allowStaleOnFetchAbort=!!N,this.ignoreFetchAbort=!!V,this.maxEntrySize!==0){if(ue(this,Ts)!==0&&!tl(ue(this,Ts)))throw new TypeError("maxSize must be a positive integer if specified");if(!tl(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Mt(this,yt,tE).call(this)}if(this.allowStale=!!d,this.noDeleteOnStaleGet=!!E,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=tl(i)||i===0?i:1,this.ttlAutopurge=!!s,this.ttl=r||0,this.ttl){if(!tl(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Mt(this,yt,vy).call(this)}if(ue(this,yo)===0&&this.ttl===0&&ue(this,Ts)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!ue(this,yo)&&!ue(this,Ts)){const j="LRU_CACHE_UNBOUNDED";OB(j)&&(Yk.add(j),Qk("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",j,_1))}}static unsafeExposeInternals(e){return{starts:ue(e,So),ttls:ue(e,Rs),sizes:ue(e,bo),keyMap:ue(e,Or),keyList:ue(e,cr),valList:ue(e,pn),next:ue(e,ji),prev:ue(e,_s),get head(){return ue(e,Pi)},get tail(){return ue(e,si)},free:ue(e,Io),isBackgroundFetch:t=>{var r;return Mt(r=e,yt,ar).call(r,t)},backgroundFetch:(t,r,i,s)=>{var a;return Mt(a=e,yt,L0).call(a,t,r,i,s)},moveToTail:t=>{var r;return Mt(r=e,yt,Rf).call(r,t)},indexes:t=>{var r;return Mt(r=e,yt,nl).call(r,t)},rindexes:t=>{var r;return Mt(r=e,yt,rl).call(r,t)},isStale:t=>{var r;return ue(r=e,Ds).call(r,t)}}}get max(){return ue(this,yo)}get maxSize(){return ue(this,Ts)}get calculatedSize(){return ue(this,wo)}get size(){return ue(this,Hr)}get fetchMethod(){return ue(this,ld)}get memoMethod(){return ue(this,ud)}get dispose(){return ue(this,Co)}get disposeAfter(){return ue(this,xo)}getRemainingTTL(e){return ue(this,Or).has(e)?1/0:0}*entries(){for(const e of Mt(this,yt,nl).call(this))ue(this,pn)[e]!==void 0&&ue(this,cr)[e]!==void 0&&!Mt(this,yt,ar).call(this,ue(this,pn)[e])&&(yield[ue(this,cr)[e],ue(this,pn)[e]])}*rentries(){for(const e of Mt(this,yt,rl).call(this))ue(this,pn)[e]!==void 0&&ue(this,cr)[e]!==void 0&&!Mt(this,yt,ar).call(this,ue(this,pn)[e])&&(yield[ue(this,cr)[e],ue(this,pn)[e]])}*keys(){for(const e of Mt(this,yt,nl).call(this)){const t=ue(this,cr)[e];t!==void 0&&!Mt(this,yt,ar).call(this,ue(this,pn)[e])&&(yield t)}}*rkeys(){for(const e of Mt(this,yt,rl).call(this)){const t=ue(this,cr)[e];t!==void 0&&!Mt(this,yt,ar).call(this,ue(this,pn)[e])&&(yield t)}}*values(){for(const e of Mt(this,yt,nl).call(this))ue(this,pn)[e]!==void 0&&!Mt(this,yt,ar).call(this,ue(this,pn)[e])&&(yield ue(this,pn)[e])}*rvalues(){for(const e of Mt(this,yt,rl).call(this))ue(this,pn)[e]!==void 0&&!Mt(this,yt,ar).call(this,ue(this,pn)[e])&&(yield ue(this,pn)[e])}[(gA=Symbol.iterator,pA=Symbol.toStringTag,gA)](){return this.entries()}find(e,t={}){for(const r of Mt(this,yt,nl).call(this)){const i=ue(this,pn)[r],s=Mt(this,yt,ar).call(this,i)?i.__staleWhileFetching:i;if(s!==void 0&&e(s,ue(this,cr)[r],this))return this.get(ue(this,cr)[r],t)}}forEach(e,t=this){for(const r of Mt(this,yt,nl).call(this)){const i=ue(this,pn)[r],s=Mt(this,yt,ar).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(t,s,ue(this,cr)[r],this)}}rforEach(e,t=this){for(const r of Mt(this,yt,rl).call(this)){const i=ue(this,pn)[r],s=Mt(this,yt,ar).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(t,s,ue(this,cr)[r],this)}}purgeStale(){let e=!1;for(const t of Mt(this,yt,rl).call(this,{allowStale:!0}))ue(this,Ds).call(this,t)&&(Mt(this,yt,il).call(this,ue(this,cr)[t],"expire"),e=!0);return e}info(e){const t=ue(this,Or).get(e);if(t===void 0)return;const r=ue(this,pn)[t],i=Mt(this,yt,ar).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const s={value:i};if(ue(this,Rs)&&ue(this,So)){const a=ue(this,Rs)[t],c=ue(this,So)[t];if(a&&c){const d=a-(Zu.now()-c);s.ttl=d,s.start=Date.now()}}return ue(this,bo)&&(s.size=ue(this,bo)[t]),s}dump(){const e=[];for(const t of Mt(this,yt,nl).call(this,{allowStale:!0})){const r=ue(this,cr)[t],i=ue(this,pn)[t],s=Mt(this,yt,ar).call(this,i)?i.__staleWhileFetching:i;if(s===void 0||r===void 0)continue;const a={value:s};if(ue(this,Rs)&&ue(this,So)){a.ttl=ue(this,Rs)[t];const c=Zu.now()-ue(this,So)[t];a.start=Math.floor(Date.now()-c)}ue(this,bo)&&(a.size=ue(this,bo)[t]),e.unshift([r,a])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const i=Date.now()-r.start;r.start=Zu.now()-i}this.set(t,r.value,r)}}set(e,t,r={}){var m,y,C,x,b;if(t===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:d}=r;let{noUpdateTTL:f=this.noUpdateTTL}=r;const h=ue(this,sh).call(this,e,t,r.size||0,c);if(this.maxEntrySize&&h>this.maxEntrySize)return d&&(d.set="miss",d.maxEntrySizeExceeded=!0),Mt(this,yt,il).call(this,e,"set"),this;let v=ue(this,Hr)===0?void 0:ue(this,Or).get(e);if(v===void 0)v=ue(this,Hr)===0?ue(this,si):ue(this,Io).length!==0?ue(this,Io).pop():ue(this,Hr)===ue(this,yo)?Mt(this,yt,F0).call(this,!1):ue(this,Hr),ue(this,cr)[v]=e,ue(this,pn)[v]=t,ue(this,Or).set(e,v),ue(this,ji)[ue(this,si)]=v,ue(this,_s)[v]=ue(this,si),en(this,si,v),h0(this,Hr)._++,ue(this,dd).call(this,v,h,d),d&&(d.set="add"),f=!1;else{Mt(this,yt,Rf).call(this,v);const S=ue(this,pn)[v];if(t!==S){if(ue(this,ol)&&Mt(this,yt,ar).call(this,S)){S.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:A}=S;A!==void 0&&!a&&(ue(this,Ao)&&((m=ue(this,Co))==null||m.call(this,A,e,"set")),ue(this,Wi)&&((y=ue(this,oi))==null||y.push([A,e,"set"])))}else a||(ue(this,Ao)&&((C=ue(this,Co))==null||C.call(this,S,e,"set")),ue(this,Wi)&&((x=ue(this,oi))==null||x.push([S,e,"set"])));if(ue(this,Yl).call(this,v),ue(this,dd).call(this,v,h,d),ue(this,pn)[v]=t,d){d.set="replace";const A=S&&Mt(this,yt,ar).call(this,S)?S.__staleWhileFetching:S;A!==void 0&&(d.oldValue=A)}}else d&&(d.set="update")}if(i!==0&&!ue(this,Rs)&&Mt(this,yt,vy).call(this),ue(this,Rs)&&(f||ue(this,ih).call(this,v,i,s),d&&ue(this,Za).call(this,d,v)),!a&&ue(this,Wi)&&ue(this,oi)){const S=ue(this,oi);let A;for(;A=S==null?void 0:S.shift();)(b=ue(this,xo))==null||b.call(this,...A)}return this}pop(){var e;try{for(;ue(this,Hr);){const t=ue(this,pn)[ue(this,Pi)];if(Mt(this,yt,F0).call(this,!0),Mt(this,yt,ar).call(this,t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(ue(this,Wi)&&ue(this,oi)){const t=ue(this,oi);let r;for(;r=t==null?void 0:t.shift();)(e=ue(this,xo))==null||e.call(this,...r)}}}has(e,t={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=t,s=ue(this,Or).get(e);if(s!==void 0){const a=ue(this,pn)[s];if(Mt(this,yt,ar).call(this,a)&&a.__staleWhileFetching===void 0)return!1;if(ue(this,Ds).call(this,s))i&&(i.has="stale",ue(this,Za).call(this,i,s));else return r&&ue(this,Jl).call(this,s),i&&(i.has="hit",ue(this,Za).call(this,i,s)),!0}else i&&(i.has="miss");return!1}peek(e,t={}){const{allowStale:r=this.allowStale}=t,i=ue(this,Or).get(e);if(i===void 0||!r&&ue(this,Ds).call(this,i))return;const s=ue(this,pn)[i];return Mt(this,yt,ar).call(this,s)?s.__staleWhileFetching:s}async fetch(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:d=0,sizeCalculation:f=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:v=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:m=this.allowStaleOnFetchRejection,ignoreFetchAbort:y=this.ignoreFetchAbort,allowStaleOnFetchAbort:C=this.allowStaleOnFetchAbort,context:x,forceRefresh:b=!1,status:S,signal:A}=t;if(!ue(this,ol))return S&&(S.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,status:S});const E={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:d,sizeCalculation:f,noUpdateTTL:h,noDeleteOnFetchRejection:v,allowStaleOnFetchRejection:m,allowStaleOnFetchAbort:C,ignoreFetchAbort:y,status:S,signal:A};let R=ue(this,Or).get(e);if(R===void 0){S&&(S.fetch="miss");const N=Mt(this,yt,L0).call(this,e,R,E,x);return N.__returned=N}else{const N=ue(this,pn)[R];if(Mt(this,yt,ar).call(this,N)){const L=r&&N.__staleWhileFetching!==void 0;return S&&(S.fetch="inflight",L&&(S.returnedStale=!0)),L?N.__staleWhileFetching:N.__returned=N}const V=ue(this,Ds).call(this,R);if(!b&&!V)return S&&(S.fetch="hit"),Mt(this,yt,Rf).call(this,R),i&&ue(this,Jl).call(this,R),S&&ue(this,Za).call(this,S,R),N;const M=Mt(this,yt,L0).call(this,e,R,E,x),J=M.__staleWhileFetching!==void 0&&r;return S&&(S.fetch=V?"stale":"refresh",J&&V&&(S.returnedStale=!0)),J?M.__staleWhileFetching:M.__returned=M}}async forceFetch(e,t={}){const r=await this.fetch(e,t);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,t={}){const r=ue(this,ud);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:s,...a}=t,c=this.get(e,a);if(!s&&c!==void 0)return c;const d=r(e,c,{options:a,context:i});return this.set(e,d,a),d}get(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=t,c=ue(this,Or).get(e);if(c!==void 0){const d=ue(this,pn)[c],f=Mt(this,yt,ar).call(this,d);return a&&ue(this,Za).call(this,a,c),ue(this,Ds).call(this,c)?(a&&(a.get="stale"),f?(a&&r&&d.__staleWhileFetching!==void 0&&(a.returnedStale=!0),r?d.__staleWhileFetching:void 0):(s||Mt(this,yt,il).call(this,e,"expire"),a&&r&&(a.returnedStale=!0),r?d:void 0)):(a&&(a.get="hit"),f?d.__staleWhileFetching:(Mt(this,yt,Rf).call(this,c),i&&ue(this,Jl).call(this,c),d))}else a&&(a.get="miss")}delete(e){return Mt(this,yt,il).call(this,e,"delete")}clear(){return Mt(this,yt,xy).call(this,"delete")}};yo=new WeakMap,Ts=new WeakMap,Co=new WeakMap,xo=new WeakMap,ld=new WeakMap,ud=new WeakMap,Hr=new WeakMap,wo=new WeakMap,Or=new WeakMap,cr=new WeakMap,pn=new WeakMap,ji=new WeakMap,_s=new WeakMap,Pi=new WeakMap,si=new WeakMap,Io=new WeakMap,oi=new WeakMap,bo=new WeakMap,So=new WeakMap,Rs=new WeakMap,Ao=new WeakMap,ol=new WeakMap,Wi=new WeakMap,yt=new WeakSet,vy=function(){const e=new O0(ue(this,yo)),t=new O0(ue(this,yo));en(this,Rs,e),en(this,So,t),en(this,ih,(s,a,c=Zu.now())=>{if(t[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){const d=setTimeout(()=>{ue(this,Ds).call(this,s)&&Mt(this,yt,il).call(this,ue(this,cr)[s],"expire")},a+1);d.unref&&d.unref()}}),en(this,Jl,s=>{t[s]=e[s]!==0?Zu.now():0}),en(this,Za,(s,a)=>{if(e[a]){const c=e[a],d=t[a];if(!c||!d)return;s.ttl=c,s.start=d,s.now=r||i();const f=s.now-d;s.remainingTTL=c-f}});let r=0;const i=()=>{const s=Zu.now();if(this.ttlResolution>0){r=s;const a=setTimeout(()=>r=0,this.ttlResolution);a.unref&&a.unref()}return s};this.getRemainingTTL=s=>{const a=ue(this,Or).get(s);if(a===void 0)return 0;const c=e[a],d=t[a];if(!c||!d)return 1/0;const f=(r||i())-d;return c-f},en(this,Ds,s=>{const a=t[s],c=e[s];return!!c&&!!a&&(r||i())-a>c})},Jl=new WeakMap,Za=new WeakMap,ih=new WeakMap,Ds=new WeakMap,tE=function(){const e=new O0(ue(this,yo));en(this,wo,0),en(this,bo,e),en(this,Yl,t=>{en(this,wo,ue(this,wo)-e[t]),e[t]=0}),en(this,sh,(t,r,i,s)=>{if(Mt(this,yt,ar).call(this,r))return 0;if(!tl(i))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(i=s(r,t),!tl(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),en(this,dd,(t,r,i)=>{if(e[t]=r,ue(this,Ts)){const s=ue(this,Ts)-e[t];for(;ue(this,wo)>s;)Mt(this,yt,F0).call(this,!0)}en(this,wo,ue(this,wo)+e[t]),i&&(i.entrySize=r,i.totalCalculatedSize=ue(this,wo))})},Yl=new WeakMap,dd=new WeakMap,sh=new WeakMap,nl=function*({allowStale:e=this.allowStale}={}){if(ue(this,Hr))for(let t=ue(this,si);!(!Mt(this,yt,yy).call(this,t)||((e||!ue(this,Ds).call(this,t))&&(yield t),t===ue(this,Pi)));)t=ue(this,_s)[t]},rl=function*({allowStale:e=this.allowStale}={}){if(ue(this,Hr))for(let t=ue(this,Pi);!(!Mt(this,yt,yy).call(this,t)||((e||!ue(this,Ds).call(this,t))&&(yield t),t===ue(this,si)));)t=ue(this,ji)[t]},yy=function(e){return e!==void 0&&ue(this,Or).get(ue(this,cr)[e])===e},F0=function(e){var s,a;const t=ue(this,Pi),r=ue(this,cr)[t],i=ue(this,pn)[t];return ue(this,ol)&&Mt(this,yt,ar).call(this,i)?i.__abortController.abort(new Error("evicted")):(ue(this,Ao)||ue(this,Wi))&&(ue(this,Ao)&&((s=ue(this,Co))==null||s.call(this,i,r,"evict")),ue(this,Wi)&&((a=ue(this,oi))==null||a.push([i,r,"evict"]))),ue(this,Yl).call(this,t),e&&(ue(this,cr)[t]=void 0,ue(this,pn)[t]=void 0,ue(this,Io).push(t)),ue(this,Hr)===1?(en(this,Pi,en(this,si,0)),ue(this,Io).length=0):en(this,Pi,ue(this,ji)[t]),ue(this,Or).delete(r),h0(this,Hr)._--,t},L0=function(e,t,r,i){const s=t===void 0?void 0:ue(this,pn)[t];if(Mt(this,yt,ar).call(this,s))return s;const a=new $p,{signal:c}=r;c==null||c.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});const d={signal:a.signal,options:r,context:i},f=(x,b=!1)=>{const{aborted:S}=a.signal,A=r.ignoreFetchAbort&&x!==void 0;if(r.status&&(S&&!b?(r.status.fetchAborted=!0,r.status.fetchError=a.signal.reason,A&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),S&&!A&&!b)return v(a.signal.reason);const E=y;return ue(this,pn)[t]===y&&(x===void 0?E.__staleWhileFetching?ue(this,pn)[t]=E.__staleWhileFetching:Mt(this,yt,il).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,x,d.options))),x},h=x=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=x),v(x)),v=x=>{const{aborted:b}=a.signal,S=b&&r.allowStaleOnFetchAbort,A=S||r.allowStaleOnFetchRejection,E=A||r.noDeleteOnFetchRejection,R=y;if(ue(this,pn)[t]===y&&(!E||R.__staleWhileFetching===void 0?Mt(this,yt,il).call(this,e,"fetch"):S||(ue(this,pn)[t]=R.__staleWhileFetching)),A)return r.status&&R.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),R.__staleWhileFetching;if(R.__returned===R)throw x},m=(x,b)=>{var A;const S=(A=ue(this,ld))==null?void 0:A.call(this,e,s,d);S&&S instanceof Promise&&S.then(E=>x(E===void 0?void 0:E),b),a.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(x(void 0),r.allowStaleOnFetchAbort&&(x=E=>f(E,!0)))})};r.status&&(r.status.fetchDispatched=!0);const y=new Promise(m).then(f,h),C=Object.assign(y,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return t===void 0?(this.set(e,C,{...d.options,status:void 0}),t=ue(this,Or).get(e)):ue(this,pn)[t]=C,C},ar=function(e){if(!ue(this,ol))return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof $p},Cy=function(e,t){ue(this,_s)[t]=e,ue(this,ji)[e]=t},Rf=function(e){e!==ue(this,si)&&(e===ue(this,Pi)?en(this,Pi,ue(this,ji)[e]):Mt(this,yt,Cy).call(this,ue(this,_s)[e],ue(this,ji)[e]),Mt(this,yt,Cy).call(this,ue(this,si),e),en(this,si,e))},il=function(e,t){var i,s,a,c;let r=!1;if(ue(this,Hr)!==0){const d=ue(this,Or).get(e);if(d!==void 0)if(r=!0,ue(this,Hr)===1)Mt(this,yt,xy).call(this,t);else{ue(this,Yl).call(this,d);const f=ue(this,pn)[d];if(Mt(this,yt,ar).call(this,f)?f.__abortController.abort(new Error("deleted")):(ue(this,Ao)||ue(this,Wi))&&(ue(this,Ao)&&((i=ue(this,Co))==null||i.call(this,f,e,t)),ue(this,Wi)&&((s=ue(this,oi))==null||s.push([f,e,t]))),ue(this,Or).delete(e),ue(this,cr)[d]=void 0,ue(this,pn)[d]=void 0,d===ue(this,si))en(this,si,ue(this,_s)[d]);else if(d===ue(this,Pi))en(this,Pi,ue(this,ji)[d]);else{const h=ue(this,_s)[d];ue(this,ji)[h]=ue(this,ji)[d];const v=ue(this,ji)[d];ue(this,_s)[v]=ue(this,_s)[d]}h0(this,Hr)._--,ue(this,Io).push(d)}}if(ue(this,Wi)&&((a=ue(this,oi))!=null&&a.length)){const d=ue(this,oi);let f;for(;f=d==null?void 0:d.shift();)(c=ue(this,xo))==null||c.call(this,...f)}return r},xy=function(e){var t,r,i;for(const s of Mt(this,yt,rl).call(this,{allowStale:!0})){const a=ue(this,pn)[s];if(Mt(this,yt,ar).call(this,a))a.__abortController.abort(new Error("deleted"));else{const c=ue(this,cr)[s];ue(this,Ao)&&((t=ue(this,Co))==null||t.call(this,a,c,e)),ue(this,Wi)&&((r=ue(this,oi))==null||r.push([a,c,e]))}}if(ue(this,Or).clear(),ue(this,pn).fill(void 0),ue(this,cr).fill(void 0),ue(this,Rs)&&ue(this,So)&&(ue(this,Rs).fill(0),ue(this,So).fill(0)),ue(this,bo)&&ue(this,bo).fill(0),en(this,Pi,0),en(this,si,0),ue(this,Io).length=0,en(this,wo,0),en(this,Hr,0),ue(this,Wi)&&ue(this,oi)){const s=ue(this,oi);let a;for(;a=s==null?void 0:s.shift();)(i=ue(this,xo))==null||i.call(this,...a)}};let my=_1;function FB(n){const e=n.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+n+"`"),null;const t=e[1],r=e[2],i={},s=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let a;for(;a=s.exec(e[3]);){const c=a[1]||a[3],d=a[2]||a[4];c in i?console.log(`Invalid message format: duplicate key ${c} detected`):i[c]=d}return{name:t,authKey:r,keyvals:i}}function GI(n){const e=n.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+n+"`"),null;const t=e[1]||e[4],r=void 0,i=e[2],s=e[3],a={};return a[i]=s,{name:t,authKey:r,keyvals:a}}function VI(){return(Math.random()+1).toString(36).substring(3,9)}class Td{constructor(e){ae(this,"packageName");ae(this,"minVersion",1);ae(this,"maxVersion",1);ae(this,"packageVersion",0);ae(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,t){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,t)}}class LB extends Td{constructor(){super(...arguments);ae(this,"packageName","mcp-negotiate");ae(this,"minVersion",2);ae(this,"maxVersion",2)}handle(t){t.name}sendNegotiate(){var t,r;for(const i of Object.values(this.client.mcpHandlers)){let s=(t=i.minVersion)==null?void 0:t.toFixed(1),a=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":s,"max-version":a})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class UB extends Td{constructor(){super(...arguments);ae(this,"packageName","dns-com-awns-status")}handle(t){console.log(t),this.client.emit("statustext",t.keyvals.text)}}class GB extends Td{constructor(t){super(t);ae(this,"packageName","dns-org-mud-moo-simpleedit");ae(this,"currentSession",null)}handle(t){t.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:t.keyvals.name,reference:t.keyvals.reference,type:t.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${t}`)}handleMultiline(t){this.currentSession&&"content"in t.keyvals?this.currentSession.contents.push(t.keyvals.content):console.log(`Unexpected simpleedit ML ${t}`)}closeMultiline(t){console.log(`Closing multiline ${t.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class VB extends Td{constructor(){super(...arguments);ae(this,"packageName","dns-com-awns-getset");ae(this,"id",1);ae(this,"cache",new my({max:10}));ae(this,"LocalCache",{})}handle(t){switch(t.name){case"dns-com-awns-getset-ack":const r=this.cache.get(t.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${t.keyvals.id}`);break}const i=t.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(t){const r=(this.id++).toString();this.cache.set(r,t),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:t})}sendSet(t,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:t,value:r})}sendDrop(t){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:t})}}class jB extends Td{constructor(){super(...arguments);ae(this,"packageName","dns-com-vmoo-userlist");ae(this,"maxVersion",1.1);ae(this,"player");ae(this,"fields",["Object","Name","Icon"]);ae(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);ae(this,"players",[])}handle(t){switch(t.name){case"dns-com-vmoo-userlist-you":this.player=t.keyvals.nr;break}}handleMultiline(t){if("fields"in t.keyvals&&(this.fields=po(t.keyvals.fields.trim())),"icons"in t.keyvals&&(this.icons=po(t.keyvals.icons.trim())),"d"in t.keyvals){const s=t.keyvals.d[0];switch(s){case"=":var r=po(t.keyvals.d.slice(1));this.players=r.map(c=>this.playerFromArray(c));break;case"+":this.players.push(this.playerFromArray(po(t.keyvals.d.slice(1))));break;case"-":var i=po(t.keyvals.d.slice(1));this.players=this.players.filter(c=>!i.includes(c.Object));break;case"*":const a=this.playerFromArray(po(t.keyvals.d.slice(1)));this.updatePlayer(a);break;case"<":i=po(t.keyvals.d.slice(1)),this.players.forEach((c,d)=>{i.includes(c.Object)&&(c.idle=!0,this.players[d]=c)});break;case">":i=po(t.keyvals.d.slice(1)),this.players.forEach((c,d)=>{i.includes(c.Object)&&(c.idle=!1,this.players[d]=c)});break;case"[":i=po(t.keyvals.d.slice(1)),this.players.forEach((c,d)=>{i.includes(c.Object)&&(c.away=!0,this.players[d]=c)});break;case"]":i=po(t.keyvals.d.slice(1)),this.players.forEach((c,d)=>{i.includes(c.Object)&&(c.away=!1,this.players[d]=c)});break;default:console.log(`Unknown userlist mode ${s} in ${t.keyvals.d}`);break}this.update()}}updatePlayer(t){const r=this.players.findIndex(i=>i.Object===t.Object);r!==-1?this.players[r]=t:this.players.push(t)}update(){this.players.sort((r,i)=>t(i)-t(r)),this.client.emit("userlist",this.players);function t(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(t){const r={};return t.forEach((i,s)=>{r[this.fields[s]]=i}),r.away=!1,r.idle=!1,r}}function po(n){n=n.slice(1,-1);let e=[],t="",r=0;for(let s=0;s<n.length;s++){const a=n[s];if(a==="{")r++;else if(a==="}")r--;else if(a===","&&r===0){i(),t="";continue}t+=a}return t.length>0&&i(),e;function i(){t=t.trim(),t.startsWith("{")&&t.endsWith("}")?e.push(po(t)):Number.isNaN(Number(t))?t.startsWith('"')&&t.endsWith('"')?e.push(t.slice(1,-1)):e.push(t):e.push(Number(t))}}class WB extends Td{constructor(){super(...arguments);ae(this,"packageName","dns-com-awns-ping");ae(this,"id",1)}handle(t){switch(t.name){case"dns-com-awns-ping":this.send("reply",t.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}class zB extends hg{constructor(t){super();ae(this,"peerConnection",null);ae(this,"dataChannel",null);ae(this,"client");ae(this,"connectionTimeout",3e5);ae(this,"connectionTimeoutId");ae(this,"recipient","");ae(this,"pendingCandidates",[]);ae(this,"remoteOfferReceived",!1);this.client=t}isDataChannelOpen(){return this.dataChannel!==null&&this.dataChannel.readyState==="open"}async createPeerConnection(){try{const t={iceServers:[{urls:["turn:mongoose.world:3478","stun:mongoose.world:3478"],username:"p2p",credential:"p2p"},{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(t),this.peerConnection.onconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.connectionState;switch(console.log("[WebRTCService] Connection state changed to:",r),this.emit("webRTCStateChange",`Connection: ${r}`),r){case"connected":console.log("[WebRTCService] Peer connection established successfully"),this.emit("webRTCConnected");break;case"disconnected":console.log("[WebRTCService] Connection temporarily disconnected"),this.emit("webRTCDisconnected"),setTimeout(()=>{var s;((s=this.peerConnection)==null?void 0:s.connectionState)==="disconnected"&&this.attemptRecovery()},5e3);break;case"failed":console.log("[WebRTCService] Connection failed - attempting immediate recovery"),this.attemptRecovery();break}},this.peerConnection.oniceconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceConnectionState;console.log("[WebRTCService] ICE connection state changed to:",r),this.emit("webRTCStateChange",`ICE: ${r}`),r==="failed"&&(console.log("[WebRTCService] ICE connection failed"),this.attemptRecovery())},this.peerConnection.onsignalingstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.signalingState;console.log("[WebRTCService] Signaling state changed to:",r),this.emit("webRTCStateChange",`Signaling: ${r}`),r==="stable"&&console.log("[WebRTCService] Signaling completed successfully")},this.peerConnection.onicegatheringstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceGatheringState;console.log("[WebRTCService] ICE gathering state changed to:",r),this.emit("webRTCStateChange",`ICE Gathering: ${r}`),r==="complete"&&(console.log("[WebRTCService] ICE gathering completed"),this.emit("iceGatheringComplete"))},this.peerConnection.onicecandidate=r=>{r.candidate?(console.debug("[WebRTCService] New ICE candidate:",{type:r.candidate.type,protocol:r.candidate.protocol,address:r.candidate.address,port:r.candidate.port}),this.recipient&&this.client.gmcp_fileTransfer.sendCandidate(this.recipient,r.candidate)):console.log("[WebRTCService] ICE gathering complete")},this.peerConnection.ondatachannel=r=>{console.log("[WebRTCService] Received data channel"),this.dataChannel=r.channel,this.setupDataChannel()},this.dataChannel||(console.log("[WebRTCService] Creating data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(t){throw console.error("Error creating peer connection:",t),t}}setupDataChannel(){this.dataChannel&&(this.dataChannel.onopen=()=>{var t;console.log("[WebRTCService] Data channel opened with state:",(t=this.dataChannel)==null?void 0:t.readyState),this.emit("dataChannelOpen")},this.dataChannel.onclose=()=>{console.log("[WebRTCService] Data channel closed"),this.emit("dataChannelClose")},this.dataChannel.onerror=t=>{console.error("[WebRTCService] Data channel error:",t),this.emit("dataChannelError",t)},this.dataChannel.onmessage=t=>{t.data instanceof ArrayBuffer&&this.emit("dataChannelMessage",t.data)})}async attemptRecovery(){try{console.log("[WebRTCService] Attempting connection recovery"),this.close(),await new Promise(t=>setTimeout(t,1e3)),await this.createPeerConnection(),console.log("[WebRTCService] Recovery attempt completed")}catch(t){console.error("[WebRTCService] Recovery attempt failed:",t)}}async attemptChannelRecovery(){var t;try{this.dataChannel=((t=this.peerConnection)==null?void 0:t.createDataChannel("fileTransfer"))??null,this.setupDataChannel()}catch(r){console.error("Failed to recover data channel:",r),this.emit("dataChannelRecoveryFailed",r)}}async sendData(t){if(!this.dataChannel)throw new Error("Data channel not initialized");if(this.dataChannel.readyState!=="open")throw new Error("Data channel is not open");try{for(;this.dataChannel.bufferedAmount>1048576;)await new Promise(i=>{var a;const s=()=>{var c;(c=this.dataChannel)==null||c.removeEventListener("bufferedamountlow",s),i()};(a=this.dataChannel)==null||a.addEventListener("bufferedamountlow",s),this.dataChannel.bufferedAmountLowThreshold=1048576/2});this.dataChannel.send(t)}catch(r){throw console.error("[WebRTCService] Error sending data:",r),r}}async createOffer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createOffer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating offer:",t),t}}async createAnswer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating answer:",t),t}}async handleAnswer(t){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{console.log("[WebRTCService] Received WebRTC answer:",t),console.log("[WebRTCService] Current connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Current signaling state:",this.peerConnection.signalingState),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),console.log("[WebRTCService] Remote description set successfully"),console.log("[WebRTCService] Updated connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Updated signaling state:",this.peerConnection.signalingState),this.pendingCandidates.length>0?(console.log(`[WebRTCService] Adding ${this.pendingCandidates.length} pending ICE candidates`),await Promise.all(this.pendingCandidates.map(async(r,i)=>{console.log(`[WebRTCService] Adding ICE candidate ${i+1}/${this.pendingCandidates.length}`),await this.peerConnection.addIceCandidate(new RTCIceCandidate(r))})),console.log("[WebRTCService] All pending ICE candidates added successfully"),this.pendingCandidates=[]):console.log("[WebRTCService] No pending ICE candidates to add")}catch(r){throw console.error("Error handling answer:",r),r}}async handleIceCandidate(t){if(!this.peerConnection||!this.peerConnection.remoteDescription){console.log("[WebRTCService] Storing ICE candidate until peer connection is ready"),this.pendingCandidates.push(t);return}try{console.log("[WebRTCService] Adding ICE candidate immediately"),await this.peerConnection.addIceCandidate(new RTCIceCandidate(t))}catch(r){throw console.error("Error handling ICE candidate:",r),r}}async reconnect(){this.close(),await this.createPeerConnection(),this.emit("webRTCReconnecting")}cleanup(){this.connectionTimeoutId&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0),this.close()}close(){this.pendingCandidates=[],this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.emit("webRTCClosed")}async waitForConnection(){return new Promise((t,r)=>{if(this.connectionTimeoutId=window.setTimeout(()=>{a(),r(new Error("Connection timeout"))},this.connectionTimeout),this.isDataChannelOpen())return clearTimeout(this.connectionTimeoutId),t();const i=()=>{clearTimeout(this.connectionTimeoutId),a(),t()},s=()=>{var d;((d=this.peerConnection)==null?void 0:d.connectionState)==="failed"&&(clearTimeout(this.connectionTimeoutId),a(),r(new Error("Connection failed")))},a=()=>{this.dataChannel&&this.dataChannel.removeEventListener("open",i),this.peerConnection&&this.peerConnection.removeEventListener("connectionstatechange",s),this.off("dataChannelOpen",i),this.off("webRTCFailed",c)},c=()=>{clearTimeout(this.connectionTimeoutId),a(),r(new Error("Connection failed"))};this.dataChannel&&this.dataChannel.addEventListener("open",i),this.peerConnection&&this.peerConnection.addEventListener("connectionstatechange",s),this.on("dataChannelOpen",i),this.on("webRTCFailed",c)})}isPeerConnectionInitialized(){var t;return console.log("[WebRTCService] Peer connection state:",(t=this.peerConnection)==null?void 0:t.connectionState),this.peerConnection!==null&&this.peerConnection.connectionState!=="closed"}hasRemoteOffer(){return this.remoteOfferReceived}async waitForRemoteOffer(t=3e4){return console.log("[WebRTCService] Waiting for remote offer..."),new Promise((r,i)=>{const s=setTimeout(()=>{c(),console.log("[WebRTCService] Timeout waiting for remote offer"),i(new Error("Timeout waiting for remote offer"))},t),a=()=>{console.log("[WebRTCService] Remote offer received"),clearTimeout(s),c(),r()},c=()=>{this.client.off("remoteOfferReceived",a)};if(this.remoteOfferReceived){console.log("[WebRTCService] Remote offer already received"),clearTimeout(s),r();return}this.client.on("remoteOfferReceived",a)})}async handleOffer(t){console.log("[WebRTCService] Handling WebRTC offer:",t),this.peerConnection||(console.log("[WebRTCService] Creating new peer connection for offer"),await this.createPeerConnection());try{if(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),this.remoteOfferReceived=!0,this.client.emit("remoteOfferReceived"),console.log("[WebRTCService] Remote offer set successfully"),this.pendingCandidates.length>0){console.log(`[WebRTCService] Processing ${this.pendingCandidates.length} pending ICE candidates`);const r=[...this.pendingCandidates];this.pendingCandidates=[];for(const i of r)try{await this.peerConnection.addIceCandidate(new RTCIceCandidate(i)),console.log("[WebRTCService] Successfully added pending ICE candidate")}catch(s){console.warn("[WebRTCService] Failed to add pending ICE candidate:",s)}}}catch(r){throw console.error("[WebRTCService] Error handling offer:",r),r}}}var U0={exports:{}};function HB(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var G0={exports:{}};const ZB={},XB=Object.freeze(Object.defineProperty({__proto__:null,default:ZB},Symbol.toStringTag,{value:"Module"})),$B=IR(XB);var KB=G0.exports,jI;function Tn(){return jI||(jI=1,function(n,e){(function(t,r){n.exports=r()})(KB,function(){var t=t||function(r,i){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof R0<"u"&&R0.crypto&&(s=R0.crypto),!s&&typeof HB=="function")try{s=$B}catch{}var a=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function A(){}return function(E){var R;return A.prototype=E,R=new A,A.prototype=null,R}}(),d={},f=d.lib={},h=f.Base=function(){return{extend:function(A){var E=c(this);return A&&E.mixIn(A),(!E.hasOwnProperty("init")||this.init===E.init)&&(E.init=function(){E.$super.init.apply(this,arguments)}),E.init.prototype=E,E.$super=this,E},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var E in A)A.hasOwnProperty(E)&&(this[E]=A[E]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),v=f.WordArray=h.extend({init:function(A,E){A=this.words=A||[],E!=i?this.sigBytes=E:this.sigBytes=A.length*4},toString:function(A){return(A||y).stringify(this)},concat:function(A){var E=this.words,R=A.words,N=this.sigBytes,V=A.sigBytes;if(this.clamp(),N%4)for(var M=0;M<V;M++){var j=R[M>>>2]>>>24-M%4*8&255;E[N+M>>>2]|=j<<24-(N+M)%4*8}else for(var J=0;J<V;J+=4)E[N+J>>>2]=R[J>>>2];return this.sigBytes+=V,this},clamp:function(){var A=this.words,E=this.sigBytes;A[E>>>2]&=4294967295<<32-E%4*8,A.length=r.ceil(E/4)},clone:function(){var A=h.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var E=[],R=0;R<A;R+=4)E.push(a());return new v.init(E,A)}}),m=d.enc={},y=m.Hex={stringify:function(A){for(var E=A.words,R=A.sigBytes,N=[],V=0;V<R;V++){var M=E[V>>>2]>>>24-V%4*8&255;N.push((M>>>4).toString(16)),N.push((M&15).toString(16))}return N.join("")},parse:function(A){for(var E=A.length,R=[],N=0;N<E;N+=2)R[N>>>3]|=parseInt(A.substr(N,2),16)<<24-N%8*4;return new v.init(R,E/2)}},C=m.Latin1={stringify:function(A){for(var E=A.words,R=A.sigBytes,N=[],V=0;V<R;V++){var M=E[V>>>2]>>>24-V%4*8&255;N.push(String.fromCharCode(M))}return N.join("")},parse:function(A){for(var E=A.length,R=[],N=0;N<E;N++)R[N>>>2]|=(A.charCodeAt(N)&255)<<24-N%4*8;return new v.init(R,E)}},x=m.Utf8={stringify:function(A){try{return decodeURIComponent(escape(C.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return C.parse(unescape(encodeURIComponent(A)))}},b=f.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new v.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=x.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var E,R=this._data,N=R.words,V=R.sigBytes,M=this.blockSize,j=M*4,J=V/j;A?J=r.ceil(J):J=r.max((J|0)-this._minBufferSize,0);var L=J*M,z=r.min(L*4,V);if(L){for(var Y=0;Y<L;Y+=M)this._doProcessBlock(N,Y);E=N.splice(0,L),R.sigBytes-=z}return new v.init(E,z)},clone:function(){var A=h.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});f.Hasher=b.extend({cfg:h.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var E=this._doFinalize();return E},blockSize:16,_createHelper:function(A){return function(E,R){return new A.init(R).finalize(E)}},_createHmacHelper:function(A){return function(E,R){return new S.HMAC.init(A,R).finalize(E)}}});var S=d.algo={};return d}(Math);return t})}(G0)),G0.exports}var V0={exports:{}},qB=V0.exports,WI;function xg(){return WI||(WI=1,function(n,e){(function(t,r){n.exports=r(Tn())})(qB,function(t){return function(r){var i=t,s=i.lib,a=s.Base,c=s.WordArray,d=i.x64={};d.Word=a.extend({init:function(f,h){this.high=f,this.low=h}}),d.WordArray=a.extend({init:function(f,h){f=this.words=f||[],h!=r?this.sigBytes=h:this.sigBytes=f.length*8},toX32:function(){for(var f=this.words,h=f.length,v=[],m=0;m<h;m++){var y=f[m];v.push(y.high),v.push(y.low)}return c.create(v,this.sigBytes)},clone:function(){for(var f=a.clone.call(this),h=f.words=this.words.slice(0),v=h.length,m=0;m<v;m++)h[m]=h[m].clone();return f}})}(),t})}(V0)),V0.exports}var j0={exports:{}},JB=j0.exports,zI;function YB(){return zI||(zI=1,function(n,e){(function(t,r){n.exports=r(Tn())})(JB,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,i=r.lib,s=i.WordArray,a=s.init,c=s.init=function(d){if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),(d instanceof Int8Array||typeof Uint8ClampedArray<"u"&&d instanceof Uint8ClampedArray||d instanceof Int16Array||d instanceof Uint16Array||d instanceof Int32Array||d instanceof Uint32Array||d instanceof Float32Array||d instanceof Float64Array)&&(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)),d instanceof Uint8Array){for(var f=d.byteLength,h=[],v=0;v<f;v++)h[v>>>2]|=d[v]<<24-v%4*8;a.call(this,h,f)}else a.apply(this,arguments)};c.prototype=s}}(),t.lib.WordArray})}(j0)),j0.exports}var W0={exports:{}},QB=W0.exports,HI;function eO(){return HI||(HI=1,function(n,e){(function(t,r){n.exports=r(Tn())})(QB,function(t){return function(){var r=t,i=r.lib,s=i.WordArray,a=r.enc;a.Utf16=a.Utf16BE={stringify:function(d){for(var f=d.words,h=d.sigBytes,v=[],m=0;m<h;m+=2){var y=f[m>>>2]>>>16-m%4*8&65535;v.push(String.fromCharCode(y))}return v.join("")},parse:function(d){for(var f=d.length,h=[],v=0;v<f;v++)h[v>>>1]|=d.charCodeAt(v)<<16-v%2*16;return s.create(h,f*2)}},a.Utf16LE={stringify:function(d){for(var f=d.words,h=d.sigBytes,v=[],m=0;m<h;m+=2){var y=c(f[m>>>2]>>>16-m%4*8&65535);v.push(String.fromCharCode(y))}return v.join("")},parse:function(d){for(var f=d.length,h=[],v=0;v<f;v++)h[v>>>1]|=c(d.charCodeAt(v)<<16-v%2*16);return s.create(h,f*2)}};function c(d){return d<<8&4278255360|d>>>8&16711935}}(),t.enc.Utf16})}(W0)),W0.exports}var z0={exports:{}},tO=z0.exports,ZI;function vu(){return ZI||(ZI=1,function(n,e){(function(t,r){n.exports=r(Tn())})(tO,function(t){return function(){var r=t,i=r.lib,s=i.WordArray,a=r.enc;a.Base64={stringify:function(d){var f=d.words,h=d.sigBytes,v=this._map;d.clamp();for(var m=[],y=0;y<h;y+=3)for(var C=f[y>>>2]>>>24-y%4*8&255,x=f[y+1>>>2]>>>24-(y+1)%4*8&255,b=f[y+2>>>2]>>>24-(y+2)%4*8&255,S=C<<16|x<<8|b,A=0;A<4&&y+A*.75<h;A++)m.push(v.charAt(S>>>6*(3-A)&63));var E=v.charAt(64);if(E)for(;m.length%4;)m.push(E);return m.join("")},parse:function(d){var f=d.length,h=this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var m=0;m<h.length;m++)v[h.charCodeAt(m)]=m}var y=h.charAt(64);if(y){var C=d.indexOf(y);C!==-1&&(f=C)}return c(d,f,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(d,f,h){for(var v=[],m=0,y=0;y<f;y++)if(y%4){var C=h[d.charCodeAt(y-1)]<<y%4*2,x=h[d.charCodeAt(y)]>>>6-y%4*2,b=C|x;v[m>>>2]|=b<<24-m%4*8,m++}return s.create(v,m)}}(),t.enc.Base64})}(z0)),z0.exports}var H0={exports:{}},nO=H0.exports,XI;function rO(){return XI||(XI=1,function(n,e){(function(t,r){n.exports=r(Tn())})(nO,function(t){return function(){var r=t,i=r.lib,s=i.WordArray,a=r.enc;a.Base64url={stringify:function(d,f){f===void 0&&(f=!0);var h=d.words,v=d.sigBytes,m=f?this._safe_map:this._map;d.clamp();for(var y=[],C=0;C<v;C+=3)for(var x=h[C>>>2]>>>24-C%4*8&255,b=h[C+1>>>2]>>>24-(C+1)%4*8&255,S=h[C+2>>>2]>>>24-(C+2)%4*8&255,A=x<<16|b<<8|S,E=0;E<4&&C+E*.75<v;E++)y.push(m.charAt(A>>>6*(3-E)&63));var R=m.charAt(64);if(R)for(;y.length%4;)y.push(R);return y.join("")},parse:function(d,f){f===void 0&&(f=!0);var h=d.length,v=f?this._safe_map:this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var y=0;y<v.length;y++)m[v.charCodeAt(y)]=y}var C=v.charAt(64);if(C){var x=d.indexOf(C);x!==-1&&(h=x)}return c(d,h,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function c(d,f,h){for(var v=[],m=0,y=0;y<f;y++)if(y%4){var C=h[d.charCodeAt(y-1)]<<y%4*2,x=h[d.charCodeAt(y)]>>>6-y%4*2,b=C|x;v[m>>>2]|=b<<24-m%4*8,m++}return s.create(v,m)}}(),t.enc.Base64url})}(H0)),H0.exports}var Z0={exports:{}},iO=Z0.exports,$I;function yu(){return $I||($I=1,function(n,e){(function(t,r){n.exports=r(Tn())})(iO,function(t){return function(r){var i=t,s=i.lib,a=s.WordArray,c=s.Hasher,d=i.algo,f=[];(function(){for(var x=0;x<64;x++)f[x]=r.abs(r.sin(x+1))*4294967296|0})();var h=d.MD5=c.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,b){for(var S=0;S<16;S++){var A=b+S,E=x[A];x[A]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}var R=this._hash.words,N=x[b+0],V=x[b+1],M=x[b+2],j=x[b+3],J=x[b+4],L=x[b+5],z=x[b+6],Y=x[b+7],ie=x[b+8],pe=x[b+9],xe=x[b+10],Ae=x[b+11],Le=x[b+12],we=x[b+13],Se=x[b+14],Ee=x[b+15],H=R[0],ee=R[1],ce=R[2],Ce=R[3];H=v(H,ee,ce,Ce,N,7,f[0]),Ce=v(Ce,H,ee,ce,V,12,f[1]),ce=v(ce,Ce,H,ee,M,17,f[2]),ee=v(ee,ce,Ce,H,j,22,f[3]),H=v(H,ee,ce,Ce,J,7,f[4]),Ce=v(Ce,H,ee,ce,L,12,f[5]),ce=v(ce,Ce,H,ee,z,17,f[6]),ee=v(ee,ce,Ce,H,Y,22,f[7]),H=v(H,ee,ce,Ce,ie,7,f[8]),Ce=v(Ce,H,ee,ce,pe,12,f[9]),ce=v(ce,Ce,H,ee,xe,17,f[10]),ee=v(ee,ce,Ce,H,Ae,22,f[11]),H=v(H,ee,ce,Ce,Le,7,f[12]),Ce=v(Ce,H,ee,ce,we,12,f[13]),ce=v(ce,Ce,H,ee,Se,17,f[14]),ee=v(ee,ce,Ce,H,Ee,22,f[15]),H=m(H,ee,ce,Ce,V,5,f[16]),Ce=m(Ce,H,ee,ce,z,9,f[17]),ce=m(ce,Ce,H,ee,Ae,14,f[18]),ee=m(ee,ce,Ce,H,N,20,f[19]),H=m(H,ee,ce,Ce,L,5,f[20]),Ce=m(Ce,H,ee,ce,xe,9,f[21]),ce=m(ce,Ce,H,ee,Ee,14,f[22]),ee=m(ee,ce,Ce,H,J,20,f[23]),H=m(H,ee,ce,Ce,pe,5,f[24]),Ce=m(Ce,H,ee,ce,Se,9,f[25]),ce=m(ce,Ce,H,ee,j,14,f[26]),ee=m(ee,ce,Ce,H,ie,20,f[27]),H=m(H,ee,ce,Ce,we,5,f[28]),Ce=m(Ce,H,ee,ce,M,9,f[29]),ce=m(ce,Ce,H,ee,Y,14,f[30]),ee=m(ee,ce,Ce,H,Le,20,f[31]),H=y(H,ee,ce,Ce,L,4,f[32]),Ce=y(Ce,H,ee,ce,ie,11,f[33]),ce=y(ce,Ce,H,ee,Ae,16,f[34]),ee=y(ee,ce,Ce,H,Se,23,f[35]),H=y(H,ee,ce,Ce,V,4,f[36]),Ce=y(Ce,H,ee,ce,J,11,f[37]),ce=y(ce,Ce,H,ee,Y,16,f[38]),ee=y(ee,ce,Ce,H,xe,23,f[39]),H=y(H,ee,ce,Ce,we,4,f[40]),Ce=y(Ce,H,ee,ce,N,11,f[41]),ce=y(ce,Ce,H,ee,j,16,f[42]),ee=y(ee,ce,Ce,H,z,23,f[43]),H=y(H,ee,ce,Ce,pe,4,f[44]),Ce=y(Ce,H,ee,ce,Le,11,f[45]),ce=y(ce,Ce,H,ee,Ee,16,f[46]),ee=y(ee,ce,Ce,H,M,23,f[47]),H=C(H,ee,ce,Ce,N,6,f[48]),Ce=C(Ce,H,ee,ce,Y,10,f[49]),ce=C(ce,Ce,H,ee,Se,15,f[50]),ee=C(ee,ce,Ce,H,L,21,f[51]),H=C(H,ee,ce,Ce,Le,6,f[52]),Ce=C(Ce,H,ee,ce,j,10,f[53]),ce=C(ce,Ce,H,ee,xe,15,f[54]),ee=C(ee,ce,Ce,H,V,21,f[55]),H=C(H,ee,ce,Ce,ie,6,f[56]),Ce=C(Ce,H,ee,ce,Ee,10,f[57]),ce=C(ce,Ce,H,ee,z,15,f[58]),ee=C(ee,ce,Ce,H,we,21,f[59]),H=C(H,ee,ce,Ce,J,6,f[60]),Ce=C(Ce,H,ee,ce,Ae,10,f[61]),ce=C(ce,Ce,H,ee,M,15,f[62]),ee=C(ee,ce,Ce,H,pe,21,f[63]),R[0]=R[0]+H|0,R[1]=R[1]+ee|0,R[2]=R[2]+ce|0,R[3]=R[3]+Ce|0},_doFinalize:function(){var x=this._data,b=x.words,S=this._nDataBytes*8,A=x.sigBytes*8;b[A>>>5]|=128<<24-A%32;var E=r.floor(S/4294967296),R=S;b[(A+64>>>9<<4)+15]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,b[(A+64>>>9<<4)+14]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,x.sigBytes=(b.length+1)*4,this._process();for(var N=this._hash,V=N.words,M=0;M<4;M++){var j=V[M];V[M]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360}return N},clone:function(){var x=c.clone.call(this);return x._hash=this._hash.clone(),x}});function v(x,b,S,A,E,R,N){var V=x+(b&S|~b&A)+E+N;return(V<<R|V>>>32-R)+b}function m(x,b,S,A,E,R,N){var V=x+(b&A|S&~A)+E+N;return(V<<R|V>>>32-R)+b}function y(x,b,S,A,E,R,N){var V=x+(b^S^A)+E+N;return(V<<R|V>>>32-R)+b}function C(x,b,S,A,E,R,N){var V=x+(S^(b|~A))+E+N;return(V<<R|V>>>32-R)+b}i.MD5=c._createHelper(h),i.HmacMD5=c._createHmacHelper(h)}(Math),t.MD5})}(Z0)),Z0.exports}var X0={exports:{}},sO=X0.exports,KI;function nE(){return KI||(KI=1,function(n,e){(function(t,r){n.exports=r(Tn())})(sO,function(t){return function(){var r=t,i=r.lib,s=i.WordArray,a=i.Hasher,c=r.algo,d=[],f=c.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,v){for(var m=this._hash.words,y=m[0],C=m[1],x=m[2],b=m[3],S=m[4],A=0;A<80;A++){if(A<16)d[A]=h[v+A]|0;else{var E=d[A-3]^d[A-8]^d[A-14]^d[A-16];d[A]=E<<1|E>>>31}var R=(y<<5|y>>>27)+S+d[A];A<20?R+=(C&x|~C&b)+1518500249:A<40?R+=(C^x^b)+1859775393:A<60?R+=(C&x|C&b|x&b)-1894007588:R+=(C^x^b)-899497514,S=b,b=x,x=C<<30|C>>>2,C=y,y=R}m[0]=m[0]+y|0,m[1]=m[1]+C|0,m[2]=m[2]+x|0,m[3]=m[3]+b|0,m[4]=m[4]+S|0},_doFinalize:function(){var h=this._data,v=h.words,m=this._nDataBytes*8,y=h.sigBytes*8;return v[y>>>5]|=128<<24-y%32,v[(y+64>>>9<<4)+14]=Math.floor(m/4294967296),v[(y+64>>>9<<4)+15]=m,h.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var h=a.clone.call(this);return h._hash=this._hash.clone(),h}});r.SHA1=a._createHelper(f),r.HmacSHA1=a._createHmacHelper(f)}(),t.SHA1})}(X0)),X0.exports}var $0={exports:{}},oO=$0.exports,qI;function LC(){return qI||(qI=1,function(n,e){(function(t,r){n.exports=r(Tn())})(oO,function(t){return function(r){var i=t,s=i.lib,a=s.WordArray,c=s.Hasher,d=i.algo,f=[],h=[];(function(){function y(S){for(var A=r.sqrt(S),E=2;E<=A;E++)if(!(S%E))return!1;return!0}function C(S){return(S-(S|0))*4294967296|0}for(var x=2,b=0;b<64;)y(x)&&(b<8&&(f[b]=C(r.pow(x,1/2))),h[b]=C(r.pow(x,1/3)),b++),x++})();var v=[],m=d.SHA256=c.extend({_doReset:function(){this._hash=new a.init(f.slice(0))},_doProcessBlock:function(y,C){for(var x=this._hash.words,b=x[0],S=x[1],A=x[2],E=x[3],R=x[4],N=x[5],V=x[6],M=x[7],j=0;j<64;j++){if(j<16)v[j]=y[C+j]|0;else{var J=v[j-15],L=(J<<25|J>>>7)^(J<<14|J>>>18)^J>>>3,z=v[j-2],Y=(z<<15|z>>>17)^(z<<13|z>>>19)^z>>>10;v[j]=L+v[j-7]+Y+v[j-16]}var ie=R&N^~R&V,pe=b&S^b&A^S&A,xe=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),Ae=(R<<26|R>>>6)^(R<<21|R>>>11)^(R<<7|R>>>25),Le=M+Ae+ie+h[j]+v[j],we=xe+pe;M=V,V=N,N=R,R=E+Le|0,E=A,A=S,S=b,b=Le+we|0}x[0]=x[0]+b|0,x[1]=x[1]+S|0,x[2]=x[2]+A|0,x[3]=x[3]+E|0,x[4]=x[4]+R|0,x[5]=x[5]+N|0,x[6]=x[6]+V|0,x[7]=x[7]+M|0},_doFinalize:function(){var y=this._data,C=y.words,x=this._nDataBytes*8,b=y.sigBytes*8;return C[b>>>5]|=128<<24-b%32,C[(b+64>>>9<<4)+14]=r.floor(x/4294967296),C[(b+64>>>9<<4)+15]=x,y.sigBytes=C.length*4,this._process(),this._hash},clone:function(){var y=c.clone.call(this);return y._hash=this._hash.clone(),y}});i.SHA256=c._createHelper(m),i.HmacSHA256=c._createHmacHelper(m)}(Math),t.SHA256})}($0)),$0.exports}var K0={exports:{}},aO=K0.exports,JI;function cO(){return JI||(JI=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),LC())})(aO,function(t){return function(){var r=t,i=r.lib,s=i.WordArray,a=r.algo,c=a.SHA256,d=a.SHA224=c.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var f=c._doFinalize.call(this);return f.sigBytes-=4,f}});r.SHA224=c._createHelper(d),r.HmacSHA224=c._createHmacHelper(d)}(),t.SHA224})}(K0)),K0.exports}var q0={exports:{}},lO=q0.exports,YI;function rE(){return YI||(YI=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),xg())})(lO,function(t){return function(){var r=t,i=r.lib,s=i.Hasher,a=r.x64,c=a.Word,d=a.WordArray,f=r.algo;function h(){return c.create.apply(c,arguments)}var v=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],m=[];(function(){for(var C=0;C<80;C++)m[C]=h()})();var y=f.SHA512=s.extend({_doReset:function(){this._hash=new d.init([new c.init(1779033703,4089235720),new c.init(3144134277,2227873595),new c.init(1013904242,4271175723),new c.init(2773480762,1595750129),new c.init(1359893119,2917565137),new c.init(2600822924,725511199),new c.init(528734635,4215389547),new c.init(1541459225,327033209)])},_doProcessBlock:function(C,x){for(var b=this._hash.words,S=b[0],A=b[1],E=b[2],R=b[3],N=b[4],V=b[5],M=b[6],j=b[7],J=S.high,L=S.low,z=A.high,Y=A.low,ie=E.high,pe=E.low,xe=R.high,Ae=R.low,Le=N.high,we=N.low,Se=V.high,Ee=V.low,H=M.high,ee=M.low,ce=j.high,Ce=j.low,_e=J,Ne=L,ft=z,ve=Y,ct=ie,At=pe,Wt=xe,Nt=Ae,bt=Le,Rt=we,st=Se,at=Ee,zt=H,jt=ee,_t=ce,Xt=Ce,an=0;an<80;an++){var ot,le,nn=m[an];if(an<16)le=nn.high=C[x+an*2]|0,ot=nn.low=C[x+an*2+1]|0;else{var vn=m[an-15],Ln=vn.high,X=vn.low,D=(Ln>>>1|X<<31)^(Ln>>>8|X<<24)^Ln>>>7,B=(X>>>1|Ln<<31)^(X>>>8|Ln<<24)^(X>>>7|Ln<<25),te=m[an-2],me=te.high,De=te.low,Ge=(me>>>19|De<<13)^(me<<3|De>>>29)^me>>>6,Lt=(De>>>19|me<<13)^(De<<3|me>>>29)^(De>>>6|me<<26),gn=m[an-7],mn=gn.high,wn=gn.low,hn=m[an-16],Bn=hn.high,Sr=hn.low;ot=B+wn,le=D+mn+(ot>>>0<B>>>0?1:0),ot=ot+Lt,le=le+Ge+(ot>>>0<Lt>>>0?1:0),ot=ot+Sr,le=le+Bn+(ot>>>0<Sr>>>0?1:0),nn.high=le,nn.low=ot}var mr=bt&st^~bt&zt,Qt=Rt&at^~Rt&jt,Yr=_e&ft^_e&ct^ft&ct,Je=Ne&ve^Ne&At^ve&At,En=(_e>>>28|Ne<<4)^(_e<<30|Ne>>>2)^(_e<<25|Ne>>>7),Ht=(Ne>>>28|_e<<4)^(Ne<<30|_e>>>2)^(Ne<<25|_e>>>7),fr=(bt>>>14|Rt<<18)^(bt>>>18|Rt<<14)^(bt<<23|Rt>>>9),$n=(Rt>>>14|bt<<18)^(Rt>>>18|bt<<14)^(Rt<<23|bt>>>9),Qr=v[an],Mr=Qr.high,ge=Qr.low,Ie=Xt+$n,Q=_t+fr+(Ie>>>0<Xt>>>0?1:0),Ie=Ie+Qt,Q=Q+mr+(Ie>>>0<Qt>>>0?1:0),Ie=Ie+ge,Q=Q+Mr+(Ie>>>0<ge>>>0?1:0),Ie=Ie+ot,Q=Q+le+(Ie>>>0<ot>>>0?1:0),Ve=Ht+Je,tt=En+Yr+(Ve>>>0<Ht>>>0?1:0);_t=zt,Xt=jt,zt=st,jt=at,st=bt,at=Rt,Rt=Nt+Ie|0,bt=Wt+Q+(Rt>>>0<Nt>>>0?1:0)|0,Wt=ct,Nt=At,ct=ft,At=ve,ft=_e,ve=Ne,Ne=Ie+Ve|0,_e=Q+tt+(Ne>>>0<Ie>>>0?1:0)|0}L=S.low=L+Ne,S.high=J+_e+(L>>>0<Ne>>>0?1:0),Y=A.low=Y+ve,A.high=z+ft+(Y>>>0<ve>>>0?1:0),pe=E.low=pe+At,E.high=ie+ct+(pe>>>0<At>>>0?1:0),Ae=R.low=Ae+Nt,R.high=xe+Wt+(Ae>>>0<Nt>>>0?1:0),we=N.low=we+Rt,N.high=Le+bt+(we>>>0<Rt>>>0?1:0),Ee=V.low=Ee+at,V.high=Se+st+(Ee>>>0<at>>>0?1:0),ee=M.low=ee+jt,M.high=H+zt+(ee>>>0<jt>>>0?1:0),Ce=j.low=Ce+Xt,j.high=ce+_t+(Ce>>>0<Xt>>>0?1:0)},_doFinalize:function(){var C=this._data,x=C.words,b=this._nDataBytes*8,S=C.sigBytes*8;x[S>>>5]|=128<<24-S%32,x[(S+128>>>10<<5)+30]=Math.floor(b/4294967296),x[(S+128>>>10<<5)+31]=b,C.sigBytes=x.length*4,this._process();var A=this._hash.toX32();return A},clone:function(){var C=s.clone.call(this);return C._hash=this._hash.clone(),C},blockSize:1024/32});r.SHA512=s._createHelper(y),r.HmacSHA512=s._createHmacHelper(y)}(),t.SHA512})}(q0)),q0.exports}var J0={exports:{}},uO=J0.exports,QI;function dO(){return QI||(QI=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),xg(),rE())})(uO,function(t){return function(){var r=t,i=r.x64,s=i.Word,a=i.WordArray,c=r.algo,d=c.SHA512,f=c.SHA384=d.extend({_doReset:function(){this._hash=new a.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var h=d._doFinalize.call(this);return h.sigBytes-=16,h}});r.SHA384=d._createHelper(f),r.HmacSHA384=d._createHmacHelper(f)}(),t.SHA384})}(J0)),J0.exports}var Y0={exports:{}},fO=Y0.exports,eb;function hO(){return eb||(eb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),xg())})(fO,function(t){return function(r){var i=t,s=i.lib,a=s.WordArray,c=s.Hasher,d=i.x64,f=d.Word,h=i.algo,v=[],m=[],y=[];(function(){for(var b=1,S=0,A=0;A<24;A++){v[b+5*S]=(A+1)*(A+2)/2%64;var E=S%5,R=(2*b+3*S)%5;b=E,S=R}for(var b=0;b<5;b++)for(var S=0;S<5;S++)m[b+5*S]=S+(2*b+3*S)%5*5;for(var N=1,V=0;V<24;V++){for(var M=0,j=0,J=0;J<7;J++){if(N&1){var L=(1<<J)-1;L<32?j^=1<<L:M^=1<<L-32}N&128?N=N<<1^113:N<<=1}y[V]=f.create(M,j)}})();var C=[];(function(){for(var b=0;b<25;b++)C[b]=f.create()})();var x=h.SHA3=c.extend({cfg:c.cfg.extend({outputLength:512}),_doReset:function(){for(var b=this._state=[],S=0;S<25;S++)b[S]=new f.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(b,S){for(var A=this._state,E=this.blockSize/2,R=0;R<E;R++){var N=b[S+2*R],V=b[S+2*R+1];N=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,V=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360;var M=A[R];M.high^=V,M.low^=N}for(var j=0;j<24;j++){for(var J=0;J<5;J++){for(var L=0,z=0,Y=0;Y<5;Y++){var M=A[J+5*Y];L^=M.high,z^=M.low}var ie=C[J];ie.high=L,ie.low=z}for(var J=0;J<5;J++)for(var pe=C[(J+4)%5],xe=C[(J+1)%5],Ae=xe.high,Le=xe.low,L=pe.high^(Ae<<1|Le>>>31),z=pe.low^(Le<<1|Ae>>>31),Y=0;Y<5;Y++){var M=A[J+5*Y];M.high^=L,M.low^=z}for(var we=1;we<25;we++){var L,z,M=A[we],Se=M.high,Ee=M.low,H=v[we];H<32?(L=Se<<H|Ee>>>32-H,z=Ee<<H|Se>>>32-H):(L=Ee<<H-32|Se>>>64-H,z=Se<<H-32|Ee>>>64-H);var ee=C[m[we]];ee.high=L,ee.low=z}var ce=C[0],Ce=A[0];ce.high=Ce.high,ce.low=Ce.low;for(var J=0;J<5;J++)for(var Y=0;Y<5;Y++){var we=J+5*Y,M=A[we],_e=C[we],Ne=C[(J+1)%5+5*Y],ft=C[(J+2)%5+5*Y];M.high=_e.high^~Ne.high&ft.high,M.low=_e.low^~Ne.low&ft.low}var M=A[0],ve=y[j];M.high^=ve.high,M.low^=ve.low}},_doFinalize:function(){var b=this._data,S=b.words;this._nDataBytes*8;var A=b.sigBytes*8,E=this.blockSize*32;S[A>>>5]|=1<<24-A%32,S[(r.ceil((A+1)/E)*E>>>5)-1]|=128,b.sigBytes=S.length*4,this._process();for(var R=this._state,N=this.cfg.outputLength/8,V=N/8,M=[],j=0;j<V;j++){var J=R[j],L=J.high,z=J.low;L=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,z=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360,M.push(z),M.push(L)}return new a.init(M,N)},clone:function(){for(var b=c.clone.call(this),S=b._state=this._state.slice(0),A=0;A<25;A++)S[A]=S[A].clone();return b}});i.SHA3=c._createHelper(x),i.HmacSHA3=c._createHmacHelper(x)}(Math),t.SHA3})}(Y0)),Y0.exports}var Q0={exports:{}},pO=Q0.exports,tb;function gO(){return tb||(tb=1,function(n,e){(function(t,r){n.exports=r(Tn())})(pO,function(t){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=t,s=i.lib,a=s.WordArray,c=s.Hasher,d=i.algo,f=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),v=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),m=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),y=a.create([0,1518500249,1859775393,2400959708,2840853838]),C=a.create([1352829926,1548603684,1836072691,2053994217,0]),x=d.RIPEMD160=c.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(V,M){for(var j=0;j<16;j++){var J=M+j,L=V[J];V[J]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}var z=this._hash.words,Y=y.words,ie=C.words,pe=f.words,xe=h.words,Ae=v.words,Le=m.words,we,Se,Ee,H,ee,ce,Ce,_e,Ne,ft;ce=we=z[0],Ce=Se=z[1],_e=Ee=z[2],Ne=H=z[3],ft=ee=z[4];for(var ve,j=0;j<80;j+=1)ve=we+V[M+pe[j]]|0,j<16?ve+=b(Se,Ee,H)+Y[0]:j<32?ve+=S(Se,Ee,H)+Y[1]:j<48?ve+=A(Se,Ee,H)+Y[2]:j<64?ve+=E(Se,Ee,H)+Y[3]:ve+=R(Se,Ee,H)+Y[4],ve=ve|0,ve=N(ve,Ae[j]),ve=ve+ee|0,we=ee,ee=H,H=N(Ee,10),Ee=Se,Se=ve,ve=ce+V[M+xe[j]]|0,j<16?ve+=R(Ce,_e,Ne)+ie[0]:j<32?ve+=E(Ce,_e,Ne)+ie[1]:j<48?ve+=A(Ce,_e,Ne)+ie[2]:j<64?ve+=S(Ce,_e,Ne)+ie[3]:ve+=b(Ce,_e,Ne)+ie[4],ve=ve|0,ve=N(ve,Le[j]),ve=ve+ft|0,ce=ft,ft=Ne,Ne=N(_e,10),_e=Ce,Ce=ve;ve=z[1]+Ee+Ne|0,z[1]=z[2]+H+ft|0,z[2]=z[3]+ee+ce|0,z[3]=z[4]+we+Ce|0,z[4]=z[0]+Se+_e|0,z[0]=ve},_doFinalize:function(){var V=this._data,M=V.words,j=this._nDataBytes*8,J=V.sigBytes*8;M[J>>>5]|=128<<24-J%32,M[(J+64>>>9<<4)+14]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,V.sigBytes=(M.length+1)*4,this._process();for(var L=this._hash,z=L.words,Y=0;Y<5;Y++){var ie=z[Y];z[Y]=(ie<<8|ie>>>24)&16711935|(ie<<24|ie>>>8)&4278255360}return L},clone:function(){var V=c.clone.call(this);return V._hash=this._hash.clone(),V}});function b(V,M,j){return V^M^j}function S(V,M,j){return V&M|~V&j}function A(V,M,j){return(V|~M)^j}function E(V,M,j){return V&j|M&~j}function R(V,M,j){return V^(M|~j)}function N(V,M){return V<<M|V>>>32-M}i.RIPEMD160=c._createHelper(x),i.HmacRIPEMD160=c._createHmacHelper(x)}(),t.RIPEMD160})}(Q0)),Q0.exports}var ep={exports:{}},mO=ep.exports,nb;function UC(){return nb||(nb=1,function(n,e){(function(t,r){n.exports=r(Tn())})(mO,function(t){(function(){var r=t,i=r.lib,s=i.Base,a=r.enc,c=a.Utf8,d=r.algo;d.HMAC=s.extend({init:function(f,h){f=this._hasher=new f.init,typeof h=="string"&&(h=c.parse(h));var v=f.blockSize,m=v*4;h.sigBytes>m&&(h=f.finalize(h)),h.clamp();for(var y=this._oKey=h.clone(),C=this._iKey=h.clone(),x=y.words,b=C.words,S=0;S<v;S++)x[S]^=1549556828,b[S]^=909522486;y.sigBytes=C.sigBytes=m,this.reset()},reset:function(){var f=this._hasher;f.reset(),f.update(this._iKey)},update:function(f){return this._hasher.update(f),this},finalize:function(f){var h=this._hasher,v=h.finalize(f);h.reset();var m=h.finalize(this._oKey.clone().concat(v));return m}})})()})}(ep)),ep.exports}var tp={exports:{}},vO=tp.exports,rb;function yO(){return rb||(rb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),LC(),UC())})(vO,function(t){return function(){var r=t,i=r.lib,s=i.Base,a=i.WordArray,c=r.algo,d=c.SHA256,f=c.HMAC,h=c.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:d,iterations:25e4}),init:function(v){this.cfg=this.cfg.extend(v)},compute:function(v,m){for(var y=this.cfg,C=f.create(y.hasher,v),x=a.create(),b=a.create([1]),S=x.words,A=b.words,E=y.keySize,R=y.iterations;S.length<E;){var N=C.update(m).finalize(b);C.reset();for(var V=N.words,M=V.length,j=N,J=1;J<R;J++){j=C.finalize(j),C.reset();for(var L=j.words,z=0;z<M;z++)V[z]^=L[z]}x.concat(N),A[0]++}return x.sigBytes=E*4,x}});r.PBKDF2=function(v,m,y){return h.create(y).compute(v,m)}}(),t.PBKDF2})}(tp)),tp.exports}var np={exports:{}},CO=np.exports,ib;function bl(){return ib||(ib=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),nE(),UC())})(CO,function(t){return function(){var r=t,i=r.lib,s=i.Base,a=i.WordArray,c=r.algo,d=c.MD5,f=c.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:d,iterations:1}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,v){for(var m,y=this.cfg,C=y.hasher.create(),x=a.create(),b=x.words,S=y.keySize,A=y.iterations;b.length<S;){m&&C.update(m),m=C.update(h).finalize(v),C.reset();for(var E=1;E<A;E++)m=C.finalize(m),C.reset();x.concat(m)}return x.sigBytes=S*4,x}});r.EvpKDF=function(h,v,m){return f.create(m).compute(h,v)}}(),t.EvpKDF})}(np)),np.exports}var rp={exports:{}},xO=rp.exports,sb;function ci(){return sb||(sb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),bl())})(xO,function(t){t.lib.Cipher||function(r){var i=t,s=i.lib,a=s.Base,c=s.WordArray,d=s.BufferedBlockAlgorithm,f=i.enc;f.Utf8;var h=f.Base64,v=i.algo,m=v.EvpKDF,y=s.Cipher=d.extend({cfg:a.extend(),createEncryptor:function(L,z){return this.create(this._ENC_XFORM_MODE,L,z)},createDecryptor:function(L,z){return this.create(this._DEC_XFORM_MODE,L,z)},init:function(L,z,Y){this.cfg=this.cfg.extend(Y),this._xformMode=L,this._key=z,this.reset()},reset:function(){d.reset.call(this),this._doReset()},process:function(L){return this._append(L),this._process()},finalize:function(L){L&&this._append(L);var z=this._doFinalize();return z},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function L(z){return typeof z=="string"?J:V}return function(z){return{encrypt:function(Y,ie,pe){return L(ie).encrypt(z,Y,ie,pe)},decrypt:function(Y,ie,pe){return L(ie).decrypt(z,Y,ie,pe)}}}}()});s.StreamCipher=y.extend({_doFinalize:function(){var L=this._process(!0);return L},blockSize:1});var C=i.mode={},x=s.BlockCipherMode=a.extend({createEncryptor:function(L,z){return this.Encryptor.create(L,z)},createDecryptor:function(L,z){return this.Decryptor.create(L,z)},init:function(L,z){this._cipher=L,this._iv=z}}),b=C.CBC=function(){var L=x.extend();L.Encryptor=L.extend({processBlock:function(Y,ie){var pe=this._cipher,xe=pe.blockSize;z.call(this,Y,ie,xe),pe.encryptBlock(Y,ie),this._prevBlock=Y.slice(ie,ie+xe)}}),L.Decryptor=L.extend({processBlock:function(Y,ie){var pe=this._cipher,xe=pe.blockSize,Ae=Y.slice(ie,ie+xe);pe.decryptBlock(Y,ie),z.call(this,Y,ie,xe),this._prevBlock=Ae}});function z(Y,ie,pe){var xe,Ae=this._iv;Ae?(xe=Ae,this._iv=r):xe=this._prevBlock;for(var Le=0;Le<pe;Le++)Y[ie+Le]^=xe[Le]}return L}(),S=i.pad={},A=S.Pkcs7={pad:function(L,z){for(var Y=z*4,ie=Y-L.sigBytes%Y,pe=ie<<24|ie<<16|ie<<8|ie,xe=[],Ae=0;Ae<ie;Ae+=4)xe.push(pe);var Le=c.create(xe,ie);L.concat(Le)},unpad:function(L){var z=L.words[L.sigBytes-1>>>2]&255;L.sigBytes-=z}};s.BlockCipher=y.extend({cfg:y.cfg.extend({mode:b,padding:A}),reset:function(){var L;y.reset.call(this);var z=this.cfg,Y=z.iv,ie=z.mode;this._xformMode==this._ENC_XFORM_MODE?L=ie.createEncryptor:(L=ie.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==L?this._mode.init(this,Y&&Y.words):(this._mode=L.call(ie,this,Y&&Y.words),this._mode.__creator=L)},_doProcessBlock:function(L,z){this._mode.processBlock(L,z)},_doFinalize:function(){var L,z=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(z.pad(this._data,this.blockSize),L=this._process(!0)):(L=this._process(!0),z.unpad(L)),L},blockSize:128/32});var E=s.CipherParams=a.extend({init:function(L){this.mixIn(L)},toString:function(L){return(L||this.formatter).stringify(this)}}),R=i.format={},N=R.OpenSSL={stringify:function(L){var z,Y=L.ciphertext,ie=L.salt;return ie?z=c.create([1398893684,1701076831]).concat(ie).concat(Y):z=Y,z.toString(h)},parse:function(L){var z,Y=h.parse(L),ie=Y.words;return ie[0]==1398893684&&ie[1]==1701076831&&(z=c.create(ie.slice(2,4)),ie.splice(0,4),Y.sigBytes-=16),E.create({ciphertext:Y,salt:z})}},V=s.SerializableCipher=a.extend({cfg:a.extend({format:N}),encrypt:function(L,z,Y,ie){ie=this.cfg.extend(ie);var pe=L.createEncryptor(Y,ie),xe=pe.finalize(z),Ae=pe.cfg;return E.create({ciphertext:xe,key:Y,iv:Ae.iv,algorithm:L,mode:Ae.mode,padding:Ae.padding,blockSize:L.blockSize,formatter:ie.format})},decrypt:function(L,z,Y,ie){ie=this.cfg.extend(ie),z=this._parse(z,ie.format);var pe=L.createDecryptor(Y,ie).finalize(z.ciphertext);return pe},_parse:function(L,z){return typeof L=="string"?z.parse(L,this):L}}),M=i.kdf={},j=M.OpenSSL={execute:function(L,z,Y,ie,pe){if(ie||(ie=c.random(64/8)),pe)var xe=m.create({keySize:z+Y,hasher:pe}).compute(L,ie);else var xe=m.create({keySize:z+Y}).compute(L,ie);var Ae=c.create(xe.words.slice(z),Y*4);return xe.sigBytes=z*4,E.create({key:xe,iv:Ae,salt:ie})}},J=s.PasswordBasedCipher=V.extend({cfg:V.cfg.extend({kdf:j}),encrypt:function(L,z,Y,ie){ie=this.cfg.extend(ie);var pe=ie.kdf.execute(Y,L.keySize,L.ivSize,ie.salt,ie.hasher);ie.iv=pe.iv;var xe=V.encrypt.call(this,L,z,pe.key,ie);return xe.mixIn(pe),xe},decrypt:function(L,z,Y,ie){ie=this.cfg.extend(ie),z=this._parse(z,ie.format);var pe=ie.kdf.execute(Y,L.keySize,L.ivSize,z.salt,ie.hasher);ie.iv=pe.iv;var xe=V.decrypt.call(this,L,z,pe.key,ie);return xe}})}()})}(rp)),rp.exports}var ip={exports:{}},wO=ip.exports,ob;function IO(){return ob||(ob=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(wO,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(s,a){var c=this._cipher,d=c.blockSize;i.call(this,s,a,d,c),this._prevBlock=s.slice(a,a+d)}}),r.Decryptor=r.extend({processBlock:function(s,a){var c=this._cipher,d=c.blockSize,f=s.slice(a,a+d);i.call(this,s,a,d,c),this._prevBlock=f}});function i(s,a,c,d){var f,h=this._iv;h?(f=h.slice(0),this._iv=void 0):f=this._prevBlock,d.encryptBlock(f,0);for(var v=0;v<c;v++)s[a+v]^=f[v]}return r}(),t.mode.CFB})}(ip)),ip.exports}var sp={exports:{}},bO=sp.exports,ab;function SO(){return ab||(ab=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(bO,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,a){var c=this._cipher,d=c.blockSize,f=this._iv,h=this._counter;f&&(h=this._counter=f.slice(0),this._iv=void 0);var v=h.slice(0);c.encryptBlock(v,0),h[d-1]=h[d-1]+1|0;for(var m=0;m<d;m++)s[a+m]^=v[m]}});return r.Decryptor=i,r}(),t.mode.CTR})}(sp)),sp.exports}var op={exports:{}},AO=op.exports,cb;function kO(){return cb||(cb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(AO,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function i(c){if((c>>24&255)===255){var d=c>>16&255,f=c>>8&255,h=c&255;d===255?(d=0,f===255?(f=0,h===255?h=0:++h):++f):++d,c=0,c+=d<<16,c+=f<<8,c+=h}else c+=1<<24;return c}function s(c){return(c[0]=i(c[0]))===0&&(c[1]=i(c[1])),c}var a=r.Encryptor=r.extend({processBlock:function(c,d){var f=this._cipher,h=f.blockSize,v=this._iv,m=this._counter;v&&(m=this._counter=v.slice(0),this._iv=void 0),s(m);var y=m.slice(0);f.encryptBlock(y,0);for(var C=0;C<h;C++)c[d+C]^=y[C]}});return r.Decryptor=a,r}(),t.mode.CTRGladman})}(op)),op.exports}var ap={exports:{}},EO=ap.exports,lb;function TO(){return lb||(lb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(EO,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,a){var c=this._cipher,d=c.blockSize,f=this._iv,h=this._keystream;f&&(h=this._keystream=f.slice(0),this._iv=void 0),c.encryptBlock(h,0);for(var v=0;v<d;v++)s[a+v]^=h[v]}});return r.Decryptor=i,r}(),t.mode.OFB})}(ap)),ap.exports}var cp={exports:{}},_O=cp.exports,ub;function RO(){return ub||(ub=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(_O,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,s){this._cipher.encryptBlock(i,s)}}),r.Decryptor=r.extend({processBlock:function(i,s){this._cipher.decryptBlock(i,s)}}),r}(),t.mode.ECB})}(cp)),cp.exports}var lp={exports:{}},DO=lp.exports,db;function PO(){return db||(db=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(DO,function(t){return t.pad.AnsiX923={pad:function(r,i){var s=r.sigBytes,a=i*4,c=a-s%a,d=s+c-1;r.clamp(),r.words[d>>>2]|=c<<24-d%4*8,r.sigBytes+=c},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Ansix923})}(lp)),lp.exports}var up={exports:{}},NO=up.exports,fb;function MO(){return fb||(fb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(NO,function(t){return t.pad.Iso10126={pad:function(r,i){var s=i*4,a=s-r.sigBytes%s;r.concat(t.lib.WordArray.random(a-1)).concat(t.lib.WordArray.create([a<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Iso10126})}(up)),up.exports}var dp={exports:{}},BO=dp.exports,hb;function OO(){return hb||(hb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(BO,function(t){return t.pad.Iso97971={pad:function(r,i){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,i)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(dp)),dp.exports}var fp={exports:{}},FO=fp.exports,pb;function LO(){return pb||(pb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(FO,function(t){return t.pad.ZeroPadding={pad:function(r,i){var s=i*4;r.clamp(),r.sigBytes+=s-(r.sigBytes%s||s)},unpad:function(r){for(var i=r.words,s=r.sigBytes-1,s=r.sigBytes-1;s>=0;s--)if(i[s>>>2]>>>24-s%4*8&255){r.sigBytes=s+1;break}}},t.pad.ZeroPadding})}(fp)),fp.exports}var hp={exports:{}},UO=hp.exports,gb;function GO(){return gb||(gb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(UO,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(hp)),hp.exports}var pp={exports:{}},VO=pp.exports,mb;function jO(){return mb||(mb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),ci())})(VO,function(t){return function(r){var i=t,s=i.lib,a=s.CipherParams,c=i.enc,d=c.Hex,f=i.format;f.Hex={stringify:function(h){return h.ciphertext.toString(d)},parse:function(h){var v=d.parse(h);return a.create({ciphertext:v})}}}(),t.format.Hex})}(pp)),pp.exports}var gp={exports:{}},WO=gp.exports,vb;function zO(){return vb||(vb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),vu(),yu(),bl(),ci())})(WO,function(t){return function(){var r=t,i=r.lib,s=i.BlockCipher,a=r.algo,c=[],d=[],f=[],h=[],v=[],m=[],y=[],C=[],x=[],b=[];(function(){for(var E=[],R=0;R<256;R++)R<128?E[R]=R<<1:E[R]=R<<1^283;for(var N=0,V=0,R=0;R<256;R++){var M=V^V<<1^V<<2^V<<3^V<<4;M=M>>>8^M&255^99,c[N]=M,d[M]=N;var j=E[N],J=E[j],L=E[J],z=E[M]*257^M*16843008;f[N]=z<<24|z>>>8,h[N]=z<<16|z>>>16,v[N]=z<<8|z>>>24,m[N]=z;var z=L*16843009^J*65537^j*257^N*16843008;y[M]=z<<24|z>>>8,C[M]=z<<16|z>>>16,x[M]=z<<8|z>>>24,b[M]=z,N?(N=j^E[E[E[L^j]]],V^=E[E[V]]):N=V=1}})();var S=[0,1,2,4,8,16,32,64,128,27,54],A=a.AES=s.extend({_doReset:function(){var E;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var R=this._keyPriorReset=this._key,N=R.words,V=R.sigBytes/4,M=this._nRounds=V+6,j=(M+1)*4,J=this._keySchedule=[],L=0;L<j;L++)L<V?J[L]=N[L]:(E=J[L-1],L%V?V>6&&L%V==4&&(E=c[E>>>24]<<24|c[E>>>16&255]<<16|c[E>>>8&255]<<8|c[E&255]):(E=E<<8|E>>>24,E=c[E>>>24]<<24|c[E>>>16&255]<<16|c[E>>>8&255]<<8|c[E&255],E^=S[L/V|0]<<24),J[L]=J[L-V]^E);for(var z=this._invKeySchedule=[],Y=0;Y<j;Y++){var L=j-Y;if(Y%4)var E=J[L];else var E=J[L-4];Y<4||L<=4?z[Y]=E:z[Y]=y[c[E>>>24]]^C[c[E>>>16&255]]^x[c[E>>>8&255]]^b[c[E&255]]}}},encryptBlock:function(E,R){this._doCryptBlock(E,R,this._keySchedule,f,h,v,m,c)},decryptBlock:function(E,R){var N=E[R+1];E[R+1]=E[R+3],E[R+3]=N,this._doCryptBlock(E,R,this._invKeySchedule,y,C,x,b,d);var N=E[R+1];E[R+1]=E[R+3],E[R+3]=N},_doCryptBlock:function(E,R,N,V,M,j,J,L){for(var z=this._nRounds,Y=E[R]^N[0],ie=E[R+1]^N[1],pe=E[R+2]^N[2],xe=E[R+3]^N[3],Ae=4,Le=1;Le<z;Le++){var we=V[Y>>>24]^M[ie>>>16&255]^j[pe>>>8&255]^J[xe&255]^N[Ae++],Se=V[ie>>>24]^M[pe>>>16&255]^j[xe>>>8&255]^J[Y&255]^N[Ae++],Ee=V[pe>>>24]^M[xe>>>16&255]^j[Y>>>8&255]^J[ie&255]^N[Ae++],H=V[xe>>>24]^M[Y>>>16&255]^j[ie>>>8&255]^J[pe&255]^N[Ae++];Y=we,ie=Se,pe=Ee,xe=H}var we=(L[Y>>>24]<<24|L[ie>>>16&255]<<16|L[pe>>>8&255]<<8|L[xe&255])^N[Ae++],Se=(L[ie>>>24]<<24|L[pe>>>16&255]<<16|L[xe>>>8&255]<<8|L[Y&255])^N[Ae++],Ee=(L[pe>>>24]<<24|L[xe>>>16&255]<<16|L[Y>>>8&255]<<8|L[ie&255])^N[Ae++],H=(L[xe>>>24]<<24|L[Y>>>16&255]<<16|L[ie>>>8&255]<<8|L[pe&255])^N[Ae++];E[R]=we,E[R+1]=Se,E[R+2]=Ee,E[R+3]=H},keySize:256/32});r.AES=s._createHelper(A)}(),t.AES})}(gp)),gp.exports}var mp={exports:{}},HO=mp.exports,yb;function ZO(){return yb||(yb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),vu(),yu(),bl(),ci())})(HO,function(t){return function(){var r=t,i=r.lib,s=i.WordArray,a=i.BlockCipher,c=r.algo,d=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],f=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],v=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],y=c.DES=a.extend({_doReset:function(){for(var S=this._key,A=S.words,E=[],R=0;R<56;R++){var N=d[R]-1;E[R]=A[N>>>5]>>>31-N%32&1}for(var V=this._subKeys=[],M=0;M<16;M++){for(var j=V[M]=[],J=h[M],R=0;R<24;R++)j[R/6|0]|=E[(f[R]-1+J)%28]<<31-R%6,j[4+(R/6|0)]|=E[28+(f[R+24]-1+J)%28]<<31-R%6;j[0]=j[0]<<1|j[0]>>>31;for(var R=1;R<7;R++)j[R]=j[R]>>>(R-1)*4+3;j[7]=j[7]<<5|j[7]>>>27}for(var L=this._invSubKeys=[],R=0;R<16;R++)L[R]=V[15-R]},encryptBlock:function(S,A){this._doCryptBlock(S,A,this._subKeys)},decryptBlock:function(S,A){this._doCryptBlock(S,A,this._invSubKeys)},_doCryptBlock:function(S,A,E){this._lBlock=S[A],this._rBlock=S[A+1],C.call(this,4,252645135),C.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),C.call(this,1,1431655765);for(var R=0;R<16;R++){for(var N=E[R],V=this._lBlock,M=this._rBlock,j=0,J=0;J<8;J++)j|=v[J][((M^N[J])&m[J])>>>0];this._lBlock=M,this._rBlock=V^j}var L=this._lBlock;this._lBlock=this._rBlock,this._rBlock=L,C.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),C.call(this,16,65535),C.call(this,4,252645135),S[A]=this._lBlock,S[A+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function C(S,A){var E=(this._lBlock>>>S^this._rBlock)&A;this._rBlock^=E,this._lBlock^=E<<S}function x(S,A){var E=(this._rBlock>>>S^this._lBlock)&A;this._lBlock^=E,this._rBlock^=E<<S}r.DES=a._createHelper(y);var b=c.TripleDES=a.extend({_doReset:function(){var S=this._key,A=S.words;if(A.length!==2&&A.length!==4&&A.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var E=A.slice(0,2),R=A.length<4?A.slice(0,2):A.slice(2,4),N=A.length<6?A.slice(0,2):A.slice(4,6);this._des1=y.createEncryptor(s.create(E)),this._des2=y.createEncryptor(s.create(R)),this._des3=y.createEncryptor(s.create(N))},encryptBlock:function(S,A){this._des1.encryptBlock(S,A),this._des2.decryptBlock(S,A),this._des3.encryptBlock(S,A)},decryptBlock:function(S,A){this._des3.decryptBlock(S,A),this._des2.encryptBlock(S,A),this._des1.decryptBlock(S,A)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=a._createHelper(b)}(),t.TripleDES})}(mp)),mp.exports}var vp={exports:{}},XO=vp.exports,Cb;function $O(){return Cb||(Cb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),vu(),yu(),bl(),ci())})(XO,function(t){return function(){var r=t,i=r.lib,s=i.StreamCipher,a=r.algo,c=a.RC4=s.extend({_doReset:function(){for(var h=this._key,v=h.words,m=h.sigBytes,y=this._S=[],C=0;C<256;C++)y[C]=C;for(var C=0,x=0;C<256;C++){var b=C%m,S=v[b>>>2]>>>24-b%4*8&255;x=(x+y[C]+S)%256;var A=y[C];y[C]=y[x],y[x]=A}this._i=this._j=0},_doProcessBlock:function(h,v){h[v]^=d.call(this)},keySize:256/32,ivSize:0});function d(){for(var h=this._S,v=this._i,m=this._j,y=0,C=0;C<4;C++){v=(v+1)%256,m=(m+h[v])%256;var x=h[v];h[v]=h[m],h[m]=x,y|=h[(h[v]+h[m])%256]<<24-C*8}return this._i=v,this._j=m,y}r.RC4=s._createHelper(c);var f=a.RC4Drop=c.extend({cfg:c.cfg.extend({drop:192}),_doReset:function(){c._doReset.call(this);for(var h=this.cfg.drop;h>0;h--)d.call(this)}});r.RC4Drop=s._createHelper(f)}(),t.RC4})}(vp)),vp.exports}var yp={exports:{}},KO=yp.exports,xb;function qO(){return xb||(xb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),vu(),yu(),bl(),ci())})(KO,function(t){return function(){var r=t,i=r.lib,s=i.StreamCipher,a=r.algo,c=[],d=[],f=[],h=a.Rabbit=s.extend({_doReset:function(){for(var m=this._key.words,y=this.cfg.iv,C=0;C<4;C++)m[C]=(m[C]<<8|m[C]>>>24)&16711935|(m[C]<<24|m[C]>>>8)&4278255360;var x=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],b=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var C=0;C<4;C++)v.call(this);for(var C=0;C<8;C++)b[C]^=x[C+4&7];if(y){var S=y.words,A=S[0],E=S[1],R=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,N=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,V=R>>>16|N&4294901760,M=N<<16|R&65535;b[0]^=R,b[1]^=V,b[2]^=N,b[3]^=M,b[4]^=R,b[5]^=V,b[6]^=N,b[7]^=M;for(var C=0;C<4;C++)v.call(this)}},_doProcessBlock:function(m,y){var C=this._X;v.call(this),c[0]=C[0]^C[5]>>>16^C[3]<<16,c[1]=C[2]^C[7]>>>16^C[5]<<16,c[2]=C[4]^C[1]>>>16^C[7]<<16,c[3]=C[6]^C[3]>>>16^C[1]<<16;for(var x=0;x<4;x++)c[x]=(c[x]<<8|c[x]>>>24)&16711935|(c[x]<<24|c[x]>>>8)&4278255360,m[y+x]^=c[x]},blockSize:128/32,ivSize:64/32});function v(){for(var m=this._X,y=this._C,C=0;C<8;C++)d[C]=y[C];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<d[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<d[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<d[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<d[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<d[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<d[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<d[6]>>>0?1:0)|0,this._b=y[7]>>>0<d[7]>>>0?1:0;for(var C=0;C<8;C++){var x=m[C]+y[C],b=x&65535,S=x>>>16,A=((b*b>>>17)+b*S>>>15)+S*S,E=((x&4294901760)*x|0)+((x&65535)*x|0);f[C]=A^E}m[0]=f[0]+(f[7]<<16|f[7]>>>16)+(f[6]<<16|f[6]>>>16)|0,m[1]=f[1]+(f[0]<<8|f[0]>>>24)+f[7]|0,m[2]=f[2]+(f[1]<<16|f[1]>>>16)+(f[0]<<16|f[0]>>>16)|0,m[3]=f[3]+(f[2]<<8|f[2]>>>24)+f[1]|0,m[4]=f[4]+(f[3]<<16|f[3]>>>16)+(f[2]<<16|f[2]>>>16)|0,m[5]=f[5]+(f[4]<<8|f[4]>>>24)+f[3]|0,m[6]=f[6]+(f[5]<<16|f[5]>>>16)+(f[4]<<16|f[4]>>>16)|0,m[7]=f[7]+(f[6]<<8|f[6]>>>24)+f[5]|0}r.Rabbit=s._createHelper(h)}(),t.Rabbit})}(yp)),yp.exports}var Cp={exports:{}},JO=Cp.exports,wb;function YO(){return wb||(wb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),vu(),yu(),bl(),ci())})(JO,function(t){return function(){var r=t,i=r.lib,s=i.StreamCipher,a=r.algo,c=[],d=[],f=[],h=a.RabbitLegacy=s.extend({_doReset:function(){var m=this._key.words,y=this.cfg.iv,C=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],x=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var b=0;b<4;b++)v.call(this);for(var b=0;b<8;b++)x[b]^=C[b+4&7];if(y){var S=y.words,A=S[0],E=S[1],R=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,N=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,V=R>>>16|N&4294901760,M=N<<16|R&65535;x[0]^=R,x[1]^=V,x[2]^=N,x[3]^=M,x[4]^=R,x[5]^=V,x[6]^=N,x[7]^=M;for(var b=0;b<4;b++)v.call(this)}},_doProcessBlock:function(m,y){var C=this._X;v.call(this),c[0]=C[0]^C[5]>>>16^C[3]<<16,c[1]=C[2]^C[7]>>>16^C[5]<<16,c[2]=C[4]^C[1]>>>16^C[7]<<16,c[3]=C[6]^C[3]>>>16^C[1]<<16;for(var x=0;x<4;x++)c[x]=(c[x]<<8|c[x]>>>24)&16711935|(c[x]<<24|c[x]>>>8)&4278255360,m[y+x]^=c[x]},blockSize:128/32,ivSize:64/32});function v(){for(var m=this._X,y=this._C,C=0;C<8;C++)d[C]=y[C];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<d[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<d[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<d[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<d[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<d[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<d[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<d[6]>>>0?1:0)|0,this._b=y[7]>>>0<d[7]>>>0?1:0;for(var C=0;C<8;C++){var x=m[C]+y[C],b=x&65535,S=x>>>16,A=((b*b>>>17)+b*S>>>15)+S*S,E=((x&4294901760)*x|0)+((x&65535)*x|0);f[C]=A^E}m[0]=f[0]+(f[7]<<16|f[7]>>>16)+(f[6]<<16|f[6]>>>16)|0,m[1]=f[1]+(f[0]<<8|f[0]>>>24)+f[7]|0,m[2]=f[2]+(f[1]<<16|f[1]>>>16)+(f[0]<<16|f[0]>>>16)|0,m[3]=f[3]+(f[2]<<8|f[2]>>>24)+f[1]|0,m[4]=f[4]+(f[3]<<16|f[3]>>>16)+(f[2]<<16|f[2]>>>16)|0,m[5]=f[5]+(f[4]<<8|f[4]>>>24)+f[3]|0,m[6]=f[6]+(f[5]<<16|f[5]>>>16)+(f[4]<<16|f[4]>>>16)|0,m[7]=f[7]+(f[6]<<8|f[6]>>>24)+f[5]|0}r.RabbitLegacy=s._createHelper(h)}(),t.RabbitLegacy})}(Cp)),Cp.exports}var xp={exports:{}},QO=xp.exports,Ib;function eF(){return Ib||(Ib=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),vu(),yu(),bl(),ci())})(QO,function(t){return function(){var r=t,i=r.lib,s=i.BlockCipher,a=r.algo;const c=16,d=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],f=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var h={pbox:[],sbox:[]};function v(b,S){let A=S>>24&255,E=S>>16&255,R=S>>8&255,N=S&255,V=b.sbox[0][A]+b.sbox[1][E];return V=V^b.sbox[2][R],V=V+b.sbox[3][N],V}function m(b,S,A){let E=S,R=A,N;for(let V=0;V<c;++V)E=E^b.pbox[V],R=v(b,E)^R,N=E,E=R,R=N;return N=E,E=R,R=N,R=R^b.pbox[c],E=E^b.pbox[c+1],{left:E,right:R}}function y(b,S,A){let E=S,R=A,N;for(let V=c+1;V>1;--V)E=E^b.pbox[V],R=v(b,E)^R,N=E,E=R,R=N;return N=E,E=R,R=N,R=R^b.pbox[1],E=E^b.pbox[0],{left:E,right:R}}function C(b,S,A){for(let M=0;M<4;M++){b.sbox[M]=[];for(let j=0;j<256;j++)b.sbox[M][j]=f[M][j]}let E=0;for(let M=0;M<c+2;M++)b.pbox[M]=d[M]^S[E],E++,E>=A&&(E=0);let R=0,N=0,V=0;for(let M=0;M<c+2;M+=2)V=m(b,R,N),R=V.left,N=V.right,b.pbox[M]=R,b.pbox[M+1]=N;for(let M=0;M<4;M++)for(let j=0;j<256;j+=2)V=m(b,R,N),R=V.left,N=V.right,b.sbox[M][j]=R,b.sbox[M][j+1]=N;return!0}var x=a.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var b=this._keyPriorReset=this._key,S=b.words,A=b.sigBytes/4;C(h,S,A)}},encryptBlock:function(b,S){var A=m(h,b[S],b[S+1]);b[S]=A.left,b[S+1]=A.right},decryptBlock:function(b,S){var A=y(h,b[S],b[S+1]);b[S]=A.left,b[S+1]=A.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=s._createHelper(x)}(),t.Blowfish})}(xp)),xp.exports}var tF=U0.exports,bb;function nF(){return bb||(bb=1,function(n,e){(function(t,r,i){n.exports=r(Tn(),xg(),YB(),eO(),vu(),rO(),yu(),nE(),LC(),cO(),rE(),dO(),hO(),gO(),UC(),yO(),bl(),ci(),IO(),SO(),kO(),TO(),RO(),PO(),MO(),OO(),LO(),GO(),jO(),zO(),ZO(),$O(),qO(),YO(),eF())})(tF,function(t){return t})}(U0)),U0.exports}var rF=nF();const Sb=kc(rF);class qs extends Error{constructor(e,t){super(t),this.code=e,this.name="FileTransferError"}}const Jo={CONNECTION_FAILED:"CONNECTION_FAILED",TRANSFER_TIMEOUT:"TRANSFER_TIMEOUT",INVALID_FILE:"INVALID_FILE",DATA_CHANNEL_ERROR:"DATA_CHANNEL_ERROR"};class iF extends hg{constructor(t,r){super();ae(this,"webRTCService");ae(this,"client");ae(this,"gmcpFileTransfer");ae(this,"chunkSize",16384);ae(this,"transferTimeoutInterval");ae(this,"incomingTransfers",new Map);ae(this,"outgoingTransfers",new Map);ae(this,"maxFileSize",100*1024*1024);ae(this,"transferTimeout",3e4);ae(this,"pendingOffers",new Map);this.client=t,this.gmcpFileTransfer=r,this.webRTCService=t.webRTCService,this.setupListeners()}isDataChannelReady(){return this.webRTCService.isDataChannelOpen()}setupListeners(){this.webRTCService.on("dataChannelMessage",this.handleIncomingChunk.bind(this)),this.client.on("fileTransferAccepted",this.handleAcceptedTransfer.bind(this)),this.transferTimeoutInterval=window.setInterval(()=>this.checkTransferTimeouts(),5e3)}async initializeWebRTC(){this.webRTCService.isDataChannelOpen()||await this.webRTCService.createPeerConnection()}async sendFile(t,r){if(t.size>this.maxFileSize)throw new qs(Jo.INVALID_FILE,`File size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);const i=await this.computeFileHash(t);console.log(`[FileTransferManager] Computed hash for ${t.name}: ${i}`),console.log(`[FileTransferManager] Registering outgoing transfer for file: ${t.name}`),this.outgoingTransfers.set(i,{file:t,filename:t.name,hash:i,lastActivityTimestamp:Date.now()});try{await this.initializeWebRTC(),this.webRTCService.recipient=r;const s=await this.webRTCService.createOffer();console.log(`[FileTransferManager] Sending offer for file: ${t.name}`),await this.gmcpFileTransfer.sendOffer(r,t.name,t.size,JSON.stringify(s),i),await this.webRTCService.waitForConnection()}catch(s){console.error(`[FileTransferManager] Failed to send file ${t.name}:`,s),this.handleTransferError(i,t.name,"send",s instanceof qs?s:new qs(Jo.CONNECTION_FAILED,"Failed to establish connection")),this.cleanupTransfer(i)}}async computeFileHash(t){return new Promise((r,i)=>{const s=new FileReader;s.onload=()=>{if(s.result instanceof ArrayBuffer){const a=Sb.lib.WordArray.create(s.result),c=Sb.SHA256(a).toString();r(c)}else i(new Error("Failed to read file for hashing"))},s.onerror=()=>i(s.error),s.readAsArrayBuffer(t)})}async startFileTransfer(t,r){let i=0;const s=new FileReader;for(;i<t.size;){const a=t.slice(i,i+this.chunkSize),c=await new Promise((f,h)=>{s.onload=()=>{s.result instanceof ArrayBuffer?f(s.result):h(new qs(Jo.INVALID_FILE,"Failed to read file chunk"))},s.onerror=()=>h(new qs(Jo.INVALID_FILE,"Error reading file")),s.readAsArrayBuffer(a)});await this.sendChunk(t.name,r,c,i,t.size),i+=c.byteLength;const d={hash:r,filename:t.name,sentBytes:i,totalBytes:t.size};this.emit("fileSendProgress",d)}}async sendChunk(t,r,i,s,a){try{const c={hash:r,filename:t,chunkIndex:Math.floor(s/this.chunkSize),totalChunks:Math.ceil(a/this.chunkSize),chunkSize:i.byteLength,totalSize:a},d=JSON.stringify(c),f=new TextEncoder().encode(d),h=new ArrayBuffer(4);new DataView(h).setUint32(0,f.byteLength,!0);const v=new Uint8Array(4+f.byteLength+i.byteLength);v.set(new Uint8Array(h),0),v.set(f,4),v.set(new Uint8Array(i),4+f.byteLength),await this.webRTCService.sendData(v.buffer)}catch{throw new qs(Jo.DATA_CHANNEL_ERROR,"Failed to send chunk")}}async handleAcceptedTransfer(t){console.log("[FileTransferManager] Handling accepted transfer for file transfer request ",t);const{sender:r,hash:i,filename:s,answerSdp:a}=t,c=this.outgoingTransfers.get(i);if(!c){const d=`No outgoing transfer found for hash: ${i} (${s}). Active transfers: ${Array.from(this.outgoingTransfers.keys()).join(", ")}`;console.error(`[FileTransferManager] ${d}`),this.client.onFileTransferError(i,s,"send",d);return}try{console.log(`[FileTransferManager] Processing WebRTC answer for file: ${s}`);const d=JSON.parse(a);console.log(`[FileTransferManager] Answer object for file: ${s}`,d),await this.webRTCService.handleAnswer(d),console.log(`[FileTransferManager] Waiting for data channel to open for file: ${s}`),await this.waitForDataChannel(i),console.log(`[FileTransferManager] Data channel ready for outgoing transfer of: ${s}`),await this.startFileTransfer(c.file,c.hash),console.log(`[FileTransferManager] File transfer completed successfully: ${s}`),this.client.onFileSendComplete(i,s)}catch(d){console.error(`[FileTransferManager] Error in accepted transfer for ${s}:`,d),this.handleTransferError(i,s,"send",d)}finally{console.log(`[FileTransferManager] Cleaning up successful transfer: ${s} (${i})`),this.outgoingTransfers.delete(i)}}async waitForDataChannel(t){return new Promise((r,i)=>{if(this.isDataChannelReady()){r();return}let s=0;const a=50,c=setInterval(()=>{s++,this.isDataChannelReady()?(clearInterval(c),r()):s>=a&&(clearInterval(c),i(new qs(Jo.CONNECTION_FAILED,`Data channel failed to open for transfer ${t} after ${s} attempts`)))},100)})}async handleIncomingChunk(t){try{if(t.byteLength<4)throw new Error("Received data is too short to contain header size");const r=new Uint8Array(t.slice(0,4)),i=new DataView(r.buffer).getUint32(0,!0);if(t.byteLength<4+i)throw new Error("Received data is too short to contain header");const s=new TextDecoder().decode(t.slice(4,4+i)),a=JSON.parse(s);if(t.byteLength<4+i+a.chunkSize)throw new Error("Received data is too short to contain chunk data");const c=this.pendingOffers.get(a.hash),d=(c==null?void 0:c.sender)||"unknown";if(typeof a.chunkIndex!="number"||a.chunkIndex<0||a.chunkIndex>=a.totalChunks)throw new Error("Invalid chunk index in header");if(typeof a.totalChunks!="number"||a.totalChunks<=0)throw new Error("Invalid total chunks in header");const f=t.slice(4+i,4+i+a.chunkSize);let h=this.incomingTransfers.get(a.hash);if(!h){if(a.totalSize>this.maxFileSize){this.client.onFileTransferError(a.hash,a.filename,"receive",`Incoming file size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);return}h={hash:a.hash,filename:a.filename,totalSize:a.totalSize,receivedSize:0,chunks:new Array(a.totalChunks),lastActivityTimestamp:Date.now(),sender:d},this.incomingTransfers.set(a.hash,h)}h.chunks[a.chunkIndex]=f,h.receivedSize+=f.byteLength,h.lastActivityTimestamp=Date.now();const v={hash:a.hash,filename:a.filename,receivedBytes:h.receivedSize,totalBytes:h.totalSize};if(this.emit("fileReceiveProgress",v),h.receivedSize===h.totalSize)if(h.chunks.every(m=>m)){const m=new Blob(h.chunks),y=new File([m],h.filename,{type:m.type});if(await this.computeFileHash(y)!==h.hash){this.client.onFileTransferError(h.hash,a.filename,"receive","File integrity check failed - hash mismatch"),this.incomingTransfers.delete(h.hash);return}const x=window.URL.createObjectURL(m),b=document.createElement("a");b.href=x,b.download=a.filename,document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(x);const S={hash:h.hash,filename:a.filename,file:m};this.emit("fileReceiveComplete",S),this.incomingTransfers.delete(h.hash)}else this.client.onFileTransferError(h.hash,a.filename,"receive","Missing chunks in received file")}catch(r){this.handleTransferError("unknown","unknown_file","receive",new qs("UNKNOWN_ERROR",r instanceof Error?r.message:"Unknown error"))}}handleTransferError(t,r,i,s){console.error(`Error ${i}ing file ${r} (${t}):`,s);const a=s instanceof Error?s.message:"Unknown error";this.client.onFileTransferError(t,r,i,a),this.cleanupTransfer(t),this.attemptRecovery(t,r,i)}cleanupTransfer(t){console.log(`[FileTransferManager] Starting cleanup for hash: ${t}`);const r=this.outgoingTransfers.get(t);r&&(console.log(`[FileTransferManager] Cleaning up outgoing transfer for: ${r.filename} (${t})`),this.outgoingTransfers.delete(t));const i=this.incomingTransfers.get(t);if(i&&(console.log(`[FileTransferManager] Cleaning up incoming transfer for: ${i.filename} (${t})`),this.incomingTransfers.delete(t)),this.pendingOffers.has(t)){const s=this.pendingOffers.get(t);console.log(`[FileTransferManager] Removing pending offer for: ${s==null?void 0:s.filename} (${t})`),this.pendingOffers.delete(t)}console.log(`[FileTransferManager] Cleanup complete for hash: ${t}`)}async attemptRecovery(t,r,i){try{if(await this.webRTCService.createPeerConnection(),this.client.onConnectionRecovered({hash:t,filename:r,direction:i}),i==="send"){const s=this.outgoingTransfers.get(t);s&&await this.startFileTransfer(s.file,s.hash)}else if(i==="receive"){const s=this.incomingTransfers.get(t);s&&this.gmcpFileTransfer.sendRequestResend(s.sender,t)}}catch(s){console.error("Failed to recover connection:",s),this.client.onRecoveryFailed({filename:r,direction:i,error:s instanceof Error?s.message:"Unknown error"})}}checkTransferTimeouts(){const t=Date.now();this.incomingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"receive",new qs(Jo.TRANSFER_TIMEOUT,"Transfer timeout - no data received"))}),this.outgoingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"send",new qs(Jo.TRANSFER_TIMEOUT,"Transfer timeout - no activity"))})}cleanup(){this.transferTimeoutInterval&&(clearInterval(this.transferTimeoutInterval),this.transferTimeoutInterval=void 0),[...this.outgoingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),[...this.incomingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),this.incomingTransfers.clear(),this.outgoingTransfers.clear(),this.pendingOffers.clear(),this.webRTCService.cleanup()}cancelTransfer(t){const r=this.outgoingTransfers.get(t)||this.incomingTransfers.get(t);r?(console.log(`[FileTransferManager] Cancelling transfer for hash: ${t} (${r.filename})`),this.cleanupTransfer(t),this.client.onFileTransferCancel(this.client.worldData.playerId,t),this.gmcpFileTransfer.sendCancel(this.client.worldData.playerId,t)):console.log(`[FileTransferManager] No active transfer found for hash: ${t}`)}async acceptTransfer(t,r){if(console.log("[FileTransferManager] Accepting transfer",t,r),this.incomingTransfers.has(r))throw new Error("Already receiving this file");const i=this.pendingOffers.get(r);if(console.log("[FileTransferManager] Checking pending offers:",Array.from(this.pendingOffers.entries())),!i)throw new qs(Jo.INVALID_FILE,`No pending offer found for transfer with hash: ${r}`);console.log("[FileTransferManager] Found pending offer for transfer:",{sender:t,hash:r,filename:i.filename,filesize:i.filesize});try{await this.initializeWebRTC(),this.webRTCService.recipient=t,console.log("[FileTransferManager] Setting remote description with offer"),await this.webRTCService.handleOffer(JSON.parse(i.offerSdp)),console.log("[FileTransferManager] Creating WebRTC answer");const s=await this.webRTCService.createAnswer();if(console.log("[FileTransferManager] WebRTC answer created successfully"),this.pendingOffers.has(r))await this.gmcpFileTransfer.sendAccept(t,r,i.filename,JSON.stringify(s)),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready for incoming transfer"),this.pendingOffers.delete(r);else throw new Error("Transfer was cancelled during setup")}catch(s){throw console.error("Failed to accept transfer:",s),this.cleanupTransfer(r),new qs(Jo.CONNECTION_FAILED,`Failed to accept transfer: ${s instanceof Error?s.message:"Unknown error"}`)}}}class sF extends hg{constructor(t,r){super();ae(this,"ws");ae(this,"decoder",new TextDecoder("utf8"));ae(this,"telnet");ae(this,"_connected",!1);ae(this,"intentionalDisconnect",!1);ae(this,"host");ae(this,"port");ae(this,"telnetNegotiation",!1);ae(this,"telnetBuffer","");ae(this,"gmcpHandlers",{});ae(this,"mcpHandlers",{});ae(this,"mcpMultilines",{});ae(this,"mcpAuthKey",null);ae(this,"mcp_negotiate");ae(this,"mcp_getset");ae(this,"gmcp_char");ae(this,"gmcp_fileTransfer");ae(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[],roomPlayers:[]});ae(this,"cacophony");ae(this,"editors");ae(this,"webRTCService");ae(this,"fileTransferManager");ae(this,"currentRoomInfo",null);ae(this,"_autosay",!1);ae(this,"globalMuted",!1);ae(this,"isWindowFocused",!0);this.host=t,this.port=r,this.mcp_negotiate=this.registerMcpPackage(LB),this.mcp_getset=this.registerMcpPackage(VB),this.gmcp_char=this.registerGMCPPackage(BA),this.gmcp_fileTransfer=this.registerGMCPPackage(OA),this.cacophony=new uB,this.cacophony.setGlobalVolume(ur.getState().sound.volume),this.editors=new mD(this),this.webRTCService=new zB(this),this.fileTransferManager=new iF(this,this.gmcp_fileTransfer),window.addEventListener("focus",()=>{this.isWindowFocused=!0,this.updateBackgroundMuteState()}),window.addEventListener("blur",()=>{this.isWindowFocused=!1,this.updateBackgroundMuteState()}),ur.subscribe(()=>{this.updateBackgroundMuteState()})}get connected(){return this._connected}get autosay(){return this._autosay}set autosay(t){this._autosay=t,this.emit("autosayChanged",t)}async sendFile(t,r){await this.fileTransferManager.sendFile(t,r)}cancelTransfer(t){this.fileTransferManager.cancelTransfer(t)}acceptTransfer(t,r){this.fileTransferManager.acceptTransfer(t,r)}rejectTransfer(t,r){this.gmcp_fileTransfer.sendReject(t,r)}onFileTransferOffer(t,r,i,s,a){console.log("[MudClient] Emitting fileTransferOffer event:",{sender:t,hash:r,filename:i,filesize:s,offerSdp:a}),this.emit("fileTransferOffer",{sender:t,hash:r,filename:i,filesize:s,offerSdp:a})}onFileTransferAccept(t,r,i,s){console.log("[MudClient] Emitting fileTransferAccepted event:",{sender:t,hash:r,filename:i,answerSdp:s}),this.emit("fileTransferAccepted",{sender:t,hash:r,filename:i,answerSdp:s})}onFileTransferReject(t,r){this.emit("fileTransferRejected",{sender:t,hash:r})}onFileTransferCancel(t,r){this.emit("fileTransferCancelled",{sender:t,hash:r})}onFileSendComplete(t,r){this.emit("fileSendComplete",{hash:t,filename:r})}onFileTransferError(t,r,i,s){this.emit("fileTransferError",{hash:t,filename:r,direction:i,error:s})}onConnectionRecovered(t){this.emit("connectionRecovered",t)}onRecoveryFailed(t){this.emit("recoveryFailed",t)}sendFileTransferOffer(t,r,i,s,a){this.gmcp_fileTransfer.sendOffer(t,r,s,a,i)}sendFileTransferAccept(t,r,i,s){this.gmcp_fileTransfer.sendAccept(t,i,r,s)}registerGMCPPackage(t){const r=new t(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(t){const r=new t(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.intentionalDisconnect=!1,this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new fD(new dD(this.ws)),this.ws.onopen=()=>{this._connected=!0,this.emit("connect"),this.emit("connectionChange",!0)},this.telnet.on("data",t=>{this.handleData(t)}),this.telnet.on("negotiation",(t,r)=>{t===Tf.WILL&&r===Ef.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Tf.DO,Ef.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):t===Tf.DO&&r===Ef.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Tf.WILL,Ef.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(t,r)=>{console.log("GMCP Package:",t,r);try{this.handleGmcpData(t,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.cleanupConnection(),this.intentionalDisconnect||setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=t=>{this.emit("error",t)}}send(t){this.ws.send(t)}cleanupConnection(){this._connected=!1,this.mcpAuthKey=null,this.telnetBuffer="",this.telnetNegotiation=!1,this.currentRoomInfo=null,this.webRTCService.cleanup(),this.fileTransferManager.cleanup(),this.emit("disconnect"),this.emit("connectionChange",!1)}close(){this.intentionalDisconnect=!0,this.ws&&this.ws.close(),this.cleanupConnection()}sendCommand(t){ur.getState().general.localEcho&&this.emit("command",t),this.autosay&&!t.startsWith("-")&&!t.startsWith("'")&&(t="say "+t),this.send(t+`\r
`),console.log("> "+t)}handleData(t){const r=this.decoder.decode(t).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(t){if(t.startsWith("#$#*")){const i=GI(t.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(t.startsWith("#$#:")){const i=GI(t.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=FB(t.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=VI(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(t,r){const i=t.lastIndexOf("."),s=t.substring(0,i),a=t.substring(i+1);console.log("GMCP Message:",s,a,r);const c=this.gmcpHandlers[s];if(!c){console.log("No handler for GMCP package:",s);return}const d=c["handle"+a];if(d){console.log("Calling handler for:",a,d);let f;typeof r=="string"&&r.trim()!==""?f=r:(console.warn(`GMCP message data for ${s}.${a} is missing or empty. Defaulting to {}. Original data:`,r),f="{}");try{const h=JSON.parse(f);d.call(c,h)}catch(h){console.error(`Error parsing GMCP JSON for ${s}.${a}:`,h),console.error("Attempted to parse:",f)}}else console.log("No handler on package:",s,a)}emitMessage(t){const r=ur.getState().speech.autoreadMode;r===hy.All&&this.speak(t),r===hy.Unfocused&&!document.hasFocus()&&this.speak(t),this.emit("message",t)}sendGmcp(t,r){console.log("Sending GMCP:",t,r),this.telnet.sendGmcp(t,r)}sendMcp(t,r){if(typeof r=="object"){let s="";for(const[a,c]of Object.entries(r))s+=` ${a}: ${c||'""'}`;r=s}const i=`#$#${t} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(t,r,i){this.send(`#$#* ${t} ${r}: ${i}\r
`)}closeMcpML(t){this.send(`#$#: ${t}\r
`)}sendMCPMultiline(t,r,i){const s=VI();r["_data-tag"]=s,this.sendMcp(t,r);for(const a of i)this.sendMcpMLLine(s,"content",a);this.closeMcpML(s)}shutdown(){Object.values(this.mcpHandlers).forEach(t=>{t.shutdown()}),Object.values(this.gmcpHandlers).forEach(t=>{t.shutdown()}),this.editors.shutdown(),this.webRTCService.cleanup(),this.fileTransferManager.cleanup()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(t,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(t,{body:r})}speak(t){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(gD(t));r.lang="en-US";const{rate:i,pitch:s,voice:a,volume:c}=ur.getState().speech;r.rate=i,r.pitch=s,r.volume=c;const f=speechSynthesis.getVoices().find(h=>h.name===a);f&&(r.voice=f),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}updateBackgroundMuteState(){const r=ur.getState().sound.muteInBackground&&!this.isWindowFocused;this.cacophony.muted=this.globalMuted||r}setGlobalMute(t){this.globalMuted=t,this.updateBackgroundMuteState()}}class oF{constructor(){ae(this,"history",[]);ae(this,"currentIndex",-1);ae(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&this.history.push(e.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(e){return this.currentIndex===-1&&(this.unsentInput=e),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(e){return this.currentIndex===-1&&(this.unsentInput=e),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}getHistory(){return[...this.history]}}const aF=()=>{const[,n]=F.useReducer(e=>e+1,0);return F.useEffect(()=>xc.subscribe(n),[]),[xc.getState(),xc.dispatch]},Ab="command_history",cF=1e3,hv=n=>n.includes(" ")?`"${n}"`:n,pv=n=>{if(n.startsWith('"'))return{leadingPunctuation:"",namePart:n.substring(1)};{const e=n.match(/^([^\w\s"]+)(.*)$/);return e?{leadingPunctuation:e[1],namePart:e[2]}:{leadingPunctuation:"",namePart:n}}},lF=({onSend:n,inputRef:e,client:t})=>{const r=F.useRef(new oF),[i,s]=aF(),a=F.useRef([]),c=F.useRef(0),d=F.useRef(null);F.useEffect(()=>{const y=localStorage.getItem(Ab);y&&JSON.parse(y).forEach(x=>{r.current.addCommand(x)})},[]),F.useEffect(()=>{xc.registerInputRef(e)},[e]);const f=()=>{try{const C=r.current.getHistory().slice(-cF);localStorage.setItem(Ab,JSON.stringify(C))}catch(y){console.warn("Failed to save command history:",y)}},h=F.useCallback(()=>{a.current=[],c.current=0,d.current=null},[]),v=F.useCallback(()=>{var C;const y=i.text;y.trim()&&(n(y),r.current.addCommand(y),f(),cP(),(C=e.current)==null||C.focus(),h())},[i.text,n,e,h]),m=F.useCallback(y=>{const C=r.current,x=i.text,b=e.current;if(y.key==="Tab"){if(!b)return;if(x===""){h();return}y.preventDefault();const S=b.selectionStart,A=x.substring(0,S),E=A.match(/(?:[^"\s]\S*|"[^"]*"?)$/),R=E?E[0]:"",N=E?A.lastIndexOf(R):-1;if(R===""&&d.current===null){h();return}let V=!1;if(d.current!==null&&a.current.length>0){const M=a.current[c.current],{leadingPunctuation:j}=pv(d.current),J=j+hv(M.name);V=R===J}if(V){c.current=(c.current+1)%a.current.length;const M=a.current[c.current],{leadingPunctuation:j}=pv(d.current),J=hv(M.name),L=j+J,z=x.substring(0,N)+L+x.substring(S);Xl(z);const Y=N+L.length;requestAnimationFrame(()=>b.setSelectionRange(Y,Y))}else{h();const{leadingPunctuation:M,namePart:j}=pv(R);if(j==="")return;const L=(t.worldData.roomPlayers||[]).filter(z=>{const Y=typeof z.name=="string"&&z.name.toLowerCase().startsWith(j.toLowerCase()),pe=(typeof z.fullname=="string"?z.fullname.toLowerCase().split(" "):[]).some(xe=>xe.startsWith(j.toLowerCase()));return Y||pe}).sort((z,Y)=>{const ie=z.name.localeCompare(Y.name);return ie!==0?ie:z.fullname.localeCompare(Y.fullname)});if(L.length>0){d.current=R,a.current=L,c.current=0;const z=L[0],Y=hv(z.name),ie=M+Y,pe=x.substring(0,N)+ie+x.substring(S);Xl(pe);const xe=N+ie.length;requestAnimationFrame(()=>b.setSelectionRange(xe,xe))}}}else if(y.key==="Enter"&&!y.shiftKey)y.preventDefault(),v();else if(y.key==="ArrowUp"){y.preventDefault();const S=C.navigateUp(x);Xl(S),h()}else if(y.key==="ArrowDown"){y.preventDefault();const S=C.navigateDown(x);Xl(S),h()}else(y.key.length===1||y.key==="Backspace"||y.key==="Delete")&&h()},[i.text,t,e,n,h,v]);return K.jsxs("div",{className:"command-input-container",children:[K.jsx("textarea",{value:i.text,onChange:y=>{Xl(y.target.value),h()},onKeyDown:m,id:"command-input",ref:e,autoFocus:!0}),K.jsx("button",{onClick:v,className:"send-button",children:"Send"})]})},iE=7e3;let Yo=null;function kb(n,e="assertive",t=iE){Yo?Yo.announce(n,e,t):(Yo=new uF,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?Yo.announce(n,e,t):setTimeout(()=>{Yo!=null&&Yo.isAttached()&&(Yo==null||Yo.announce(n,e,t))},100))}class uF{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let t=document.createElement("div");return t.setAttribute("role","log"),t.setAttribute("aria-live",e),t.setAttribute("aria-relevant","additions"),t}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,t="assertive",r=iE){var i,s;if(!this.node)return;let a=document.createElement("div");typeof e=="object"?(a.setAttribute("role","img"),a.setAttribute("aria-labelledby",e["aria-labelledby"])):a.textContent=e,t==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(a):(s=this.politeLog)===null||s===void 0||s.appendChild(a),e!==""&&setTimeout(()=>{a.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var gv,Eb;function dF(){if(Eb)return gv;Eb=1;var n=function(){function s(a,c){for(var d=0;d<c.length;d++){var f=c[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(a,f.key,f)}}return function(a,c,d){return c&&s(a.prototype,c),d&&s(a,d),a}}();function e(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var t=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],r=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,i=function(){n(s,null,[{key:"escapeForHtml",value:function(c){return new s().escapeForHtml(c)}},{key:"linkify",value:function(c){return new s().linkify(c)}},{key:"ansiToHtml",value:function(c,d){return new s().ansiToHtml(c,d)}},{key:"ansiToJson",value:function(c,d){return new s().ansiToJson(c,d)}},{key:"ansiToText",value:function(c){return new s().ansiToText(c)}}]);function s(){e(this,s),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return n(s,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var c=0;c<2;++c)for(var d=0;d<8;++d)this.PALETTE_COLORS.push(t[c][d].color);for(var f=[0,95,135,175,215,255],h=function(S,A,E){return f[S]+", "+f[A]+", "+f[E]},v=0;v<6;++v)for(var m=0;m<6;++m)for(var y=0;y<6;++y)this.PALETTE_COLORS.push(h(v,m,y));for(var C=8,x=0;x<24;++x,C+=10)this.PALETTE_COLORS.push(h(C,C,C))}},{key:"escapeForHtml",value:function(c){return c.replace(/[&<>\"]/gm,function(d){return d=="&"?"&amp;":d=='"'?"&quot;":d=="<"?"&lt;":d==">"?"&gt;":""})}},{key:"linkify",value:function(c){return c.replace(r,function(d){return'<a href="'+d+'">'+d+"</a>"})}},{key:"ansiToHtml",value:function(c,d){return this.process(c,d,!0)}},{key:"ansiToJson",value:function(c,d){return d=d||{},d.json=!0,d.clearLine=!1,this.process(c,d,!0)}},{key:"ansiToText",value:function(c){return this.process(c,{},!1)}},{key:"process",value:function(c,d,f){var h=this,v=this,m=c.split(/\033\[/),y=m.shift();d==null&&(d={}),d.clearLine=/\r/.test(c);var C=m.map(function(b){return h.processChunk(b,d,f)});if(d&&d.json){var x=v.processChunkJson("");return x.content=y,x.clearLine=d.clearLine,C.unshift(x),d.remove_empty&&(C=C.filter(function(b){return!b.isEmpty()})),C}else C.unshift(y);return C.join("")}},{key:"processChunkJson",value:function(c,d,f){d=typeof d>"u"?{}:d;var h=d.use_classes=typeof d.use_classes<"u"&&d.use_classes,v=d.key=h?"class":"color",m={content:c,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:d.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!m.content}},y=c.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!y)return m;m.content=y[4];var C=y[2].split(";");if(y[1]!==""||y[3]!=="m"||!f)return m;for(var x=this;C.length>0;){var b=C.shift(),S=parseInt(b);if(isNaN(S)||S===0)x.fg=x.bg=null,x.decorations=[];else if(S===1)x.decorations.push("bold");else if(S===2)x.decorations.push("dim");else if(S===3)x.decorations.push("italic");else if(S===4)x.decorations.push("underline");else if(S===5)x.decorations.push("blink");else if(S===7)x.decorations.push("reverse");else if(S===8)x.decorations.push("hidden");else if(S===9)x.decorations.push("strikethrough");else if(S===21)x.removeDecoration("bold");else if(S===22)x.removeDecoration("bold"),x.removeDecoration("dim");else if(S===23)x.removeDecoration("italic");else if(S===24)x.removeDecoration("underline");else if(S===25)x.removeDecoration("blink");else if(S===27)x.removeDecoration("reverse");else if(S===28)x.removeDecoration("hidden");else if(S===29)x.removeDecoration("strikethrough");else if(S===39)x.fg=null;else if(S===49)x.bg=null;else if(S>=30&&S<38)x.fg=t[0][S%10][v];else if(S>=90&&S<98)x.fg=t[1][S%10][v];else if(S>=40&&S<48)x.bg=t[0][S%10][v];else if(S>=100&&S<108)x.bg=t[1][S%10][v];else if(S===38||S===48){var A=S===38;if(C.length>=1){var E=C.shift();if(E==="5"&&C.length>=1){var R=parseInt(C.shift());if(R>=0&&R<=255)if(!h)this.PALETTE_COLORS||x.setupPalette(),A?x.fg=this.PALETTE_COLORS[R]:x.bg=this.PALETTE_COLORS[R];else{var N=R>=16?"ansi-palette-"+R:t[R>7?1:0][R%8].class;A?x.fg=N:x.bg=N}}else if(E==="2"&&C.length>=3){var V=parseInt(C.shift()),M=parseInt(C.shift()),j=parseInt(C.shift());if(V>=0&&V<=255&&M>=0&&M<=255&&j>=0&&j<=255){var J=V+", "+M+", "+j;h?A?(x.fg="ansi-truecolor",x.fg_truecolor=J):(x.bg="ansi-truecolor",x.bg_truecolor=J):A?x.fg=J:x.bg=J}}}}}return x.fg===null&&x.bg===null&&x.decorations.length===0||(m.fg=x.fg,m.bg=x.bg,m.fg_truecolor=x.fg_truecolor,m.bg_truecolor=x.bg_truecolor,m.decorations=x.decorations,m.decoration=x.decorations.slice(-1).pop()||null,m.was_processed=!0),m}},{key:"processChunk",value:function(c,d,f){var h=this;d=d||{};var v=this.processChunkJson(c,d,f),m=d.use_classes;if(v.decorations=v.decorations.filter(function(A){if(A==="reverse"){v.fg||(v.fg=t[0][7][m?"class":"color"]),v.bg||(v.bg=t[0][0][m?"class":"color"]);var E=v.fg;v.fg=v.bg,v.bg=E;var R=v.fg_truecolor;return v.fg_truecolor=v.bg_truecolor,v.bg_truecolor=R,v.isInverted=!0,!1}return!0}),d.json)return v;if(v.isEmpty())return"";if(!v.was_processed)return v.content;var y=[],C=[],x=[],b={},S=function(E){var R=[],N=void 0;for(N in E)E.hasOwnProperty(N)&&R.push("data-"+N+'="'+h.escapeForHtml(E[N])+'"');return R.length>0?" "+R.join(" "):""};return v.isInverted&&(b["ansi-is-inverted"]="true"),v.fg&&(m?(y.push(v.fg+"-fg"),v.fg_truecolor!==null&&(b["ansi-truecolor-fg"]=v.fg_truecolor,v.fg_truecolor=null)):y.push("color:rgb("+v.fg+")")),v.bg&&(m?(y.push(v.bg+"-bg"),v.bg_truecolor!==null&&(b["ansi-truecolor-bg"]=v.bg_truecolor,v.bg_truecolor=null)):y.push("background-color:rgb("+v.bg+")")),v.decorations.forEach(function(A){if(m){C.push("ansi-"+A);return}A==="bold"?C.push("font-weight:bold"):A==="dim"?C.push("opacity:0.5"):A==="italic"?C.push("font-style:italic"):A==="hidden"?C.push("visibility:hidden"):A==="strikethrough"?x.push("line-through"):x.push(A)}),x.length&&C.push("text-decoration:"+x.join(" ")),m?'<span class="'+y.concat(C).join(" ")+'"'+S(b)+">"+v.content+"</span>":'<span style="'+y.concat(C).join(";")+'"'+S(b)+">"+v.content+"</span>"}},{key:"removeDecoration",value:function(c){var d=this.decorations.indexOf(c);d>=0&&this.decorations.splice(d,1)}}]),s}();return gv=i,gv}var fF=dF();const hF=kc(fF);function pF(n,e){let t=[];for(const r of n.split(`\r
`)){const i=hF.ansiToJson(r,{json:!0,remove_empty:!1});let s=[];for(const a of i){const c=yF(a,e);s=[...s,...c]}t=[...t,K.jsx("span",{children:s},t.length)]}return t}const gF=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,mF=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,vF=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function yF(n,e){const t=CF(n),r=[];let i=0,s=0;function a(h,v){let m;for(;(m=h.exec(n.content))!==null;){const y=m.index;y>i&&r.push(n.content.substring(i,y)),r.push(v(m)),i=h.lastIndex}}function c(h){const[,v,m]=h,y=m;return K.jsxs(K.Fragment,{children:[v,K.jsx("a",{href:y,target:"_blank",rel:"noreferrer",children:m})]})}function d(h){const v=h.groups.name,m=`mailto:${v}`;return K.jsxs(K.Fragment,{children:[h.groups.slorp1,K.jsx("a",{href:m,target:"_blank",rel:"noreferrer",children:v}),h.groups.slorp2]})}function f(h){const[,v,m]=h;return K.jsx("a",{onClick:()=>e(v),className:"exit",children:m})}return a(gF,c),a(mF,d),a(vF,f),i<n.content.length&&r.push(n.content.substring(i)),r.map(h=>K.jsx("span",{style:t,children:h},s++))}function CF(n){const e={};switch(n.bg&&(e.backgroundColor=`rgb(${n.bg})`),n.fg&&(e.color=`rgb(${n.fg})`),n.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var Yc={},Wl={},Tb;function xF(){if(Tb)return Wl;Tb=1;var n=oh();function e(_){for(var U="https://reactjs.org/docs/error-decoder.html?invariant="+_,q=1;q<arguments.length;q++)U+="&args[]="+encodeURIComponent(arguments[q]);return"Minified React error #"+_+"; visit "+U+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=Object.prototype.hasOwnProperty,r=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i={},s={};function a(_){return t.call(s,_)?!0:t.call(i,_)?!1:r.test(_)?s[_]=!0:(i[_]=!0,!1)}function c(_,U,q,se,Be,ke,je){this.acceptsBooleans=U===2||U===3||U===4,this.attributeName=se,this.attributeNamespace=Be,this.mustUseProperty=q,this.propertyName=_,this.type=U,this.sanitizeURL=ke,this.removeEmptyString=je}var d={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){d[_]=new c(_,0,!1,_,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var U=_[0];d[U]=new c(U,1,!1,_[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(_){d[_]=new c(_,2,!1,_.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){d[_]=new c(_,2,!1,_,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){d[_]=new c(_,3,!1,_.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(_){d[_]=new c(_,3,!0,_,null,!1,!1)}),["capture","download"].forEach(function(_){d[_]=new c(_,4,!1,_,null,!1,!1)}),["cols","rows","size","span"].forEach(function(_){d[_]=new c(_,6,!1,_,null,!1,!1)}),["rowSpan","start"].forEach(function(_){d[_]=new c(_,5,!1,_.toLowerCase(),null,!1,!1)});var f=/[\-:]([a-z])/g;function h(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var U=_.replace(f,h);d[U]=new c(U,1,!1,_,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var U=_.replace(f,h);d[U]=new c(U,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(_){var U=_.replace(f,h);d[U]=new c(U,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(_){d[_]=new c(_,1,!1,_.toLowerCase(),null,!1,!1)}),d.xlinkHref=new c("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(_){d[_]=new c(_,1,!1,_.toLowerCase(),null,!0,!0)});var v={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},m=["Webkit","ms","Moz","O"];Object.keys(v).forEach(function(_){m.forEach(function(U){U=U+_.charAt(0).toUpperCase()+_.substring(1),v[U]=v[_]})});var y=/["'&<>]/;function C(_){if(typeof _=="boolean"||typeof _=="number")return""+_;_=""+_;var U=y.exec(_);if(U){var q="",se,Be=0;for(se=U.index;se<_.length;se++){switch(_.charCodeAt(se)){case 34:U="&quot;";break;case 38:U="&amp;";break;case 39:U="&#x27;";break;case 60:U="&lt;";break;case 62:U="&gt;";break;default:continue}Be!==se&&(q+=_.substring(Be,se)),Be=se+1,q+=U}_=Be!==se?q+_.substring(Be,se):q}return _}var x=/([A-Z])/g,b=/^ms-/,S=Array.isArray;function A(_,U){return{insertionMode:_,selectedValue:U}}function E(_,U,q){switch(U){case"select":return A(1,q.value!=null?q.value:q.defaultValue);case"svg":return A(2,null);case"math":return A(3,null);case"foreignObject":return A(1,null);case"table":return A(4,null);case"thead":case"tbody":case"tfoot":return A(5,null);case"colgroup":return A(7,null);case"tr":return A(6,null)}return 4<=_.insertionMode||_.insertionMode===0?A(1,null):_}var R=new Map;function N(_,U,q){if(typeof q!="object")throw Error(e(62));U=!0;for(var se in q)if(t.call(q,se)){var Be=q[se];if(Be!=null&&typeof Be!="boolean"&&Be!==""){if(se.indexOf("--")===0){var ke=C(se);Be=C((""+Be).trim())}else{ke=se;var je=R.get(ke);je!==void 0||(je=C(ke.replace(x,"-$1").toLowerCase().replace(b,"-ms-")),R.set(ke,je)),ke=je,Be=typeof Be=="number"?Be===0||t.call(v,se)?""+Be:Be+"px":C((""+Be).trim())}U?(U=!1,_.push(' style="',ke,":",Be)):_.push(";",ke,":",Be)}}U||_.push('"')}function V(_,U,q,se){switch(q){case"style":N(_,U,se);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<q.length)||q[0]!=="o"&&q[0]!=="O"||q[1]!=="n"&&q[1]!=="N"){if(U=d.hasOwnProperty(q)?d[q]:null,U!==null){switch(typeof se){case"function":case"symbol":return;case"boolean":if(!U.acceptsBooleans)return}switch(q=U.attributeName,U.type){case 3:se&&_.push(" ",q,'=""');break;case 4:se===!0?_.push(" ",q,'=""'):se!==!1&&_.push(" ",q,'="',C(se),'"');break;case 5:isNaN(se)||_.push(" ",q,'="',C(se),'"');break;case 6:!isNaN(se)&&1<=se&&_.push(" ",q,'="',C(se),'"');break;default:U.sanitizeURL&&(se=""+se),_.push(" ",q,'="',C(se),'"')}}else if(a(q)){switch(typeof se){case"function":case"symbol":return;case"boolean":if(U=q.toLowerCase().slice(0,5),U!=="data-"&&U!=="aria-")return}_.push(" ",q,'="',C(se),'"')}}}function M(_,U,q){if(U!=null){if(q!=null)throw Error(e(60));if(typeof U!="object"||!("__html"in U))throw Error(e(61));U=U.__html,U!=null&&_.push(""+U)}}function j(_){var U="";return n.Children.forEach(_,function(q){q!=null&&(U+=q)}),U}function J(_,U,q,se){_.push(Y(q));var Be=q=null,ke;for(ke in U)if(t.call(U,ke)){var je=U[ke];if(je!=null)switch(ke){case"children":q=je;break;case"dangerouslySetInnerHTML":Be=je;break;default:V(_,se,ke,je)}}return _.push(">"),M(_,Be,q),typeof q=="string"?(_.push(C(q)),null):q}var L=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,z=new Map;function Y(_){var U=z.get(_);if(U===void 0){if(!L.test(_))throw Error(e(65,_));U="<"+_,z.set(_,U)}return U}function ie(_,U,q,se,Be){switch(U){case"select":_.push(Y("select"));var ke=null,je=null;for(cn in q)if(t.call(q,cn)){var ut=q[cn];if(ut!=null)switch(cn){case"children":ke=ut;break;case"dangerouslySetInnerHTML":je=ut;break;case"defaultValue":case"value":break;default:V(_,se,cn,ut)}}return _.push(">"),M(_,je,ke),ke;case"option":je=Be.selectedValue,_.push(Y("option"));var gt=ut=null,qt=null,cn=null;for(ke in q)if(t.call(q,ke)){var On=q[ke];if(On!=null)switch(ke){case"children":ut=On;break;case"selected":qt=On;break;case"dangerouslySetInnerHTML":cn=On;break;case"value":gt=On;default:V(_,se,ke,On)}}if(je!=null)if(q=gt!==null?""+gt:j(ut),S(je)){for(se=0;se<je.length;se++)if(""+je[se]===q){_.push(' selected=""');break}}else""+je===q&&_.push(' selected=""');else qt&&_.push(' selected=""');return _.push(">"),M(_,cn,ut),ut;case"textarea":_.push(Y("textarea")),cn=je=ke=null;for(ut in q)if(t.call(q,ut)&&(gt=q[ut],gt!=null))switch(ut){case"children":cn=gt;break;case"value":ke=gt;break;case"defaultValue":je=gt;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:V(_,se,ut,gt)}if(ke===null&&je!==null&&(ke=je),_.push(">"),cn!=null){if(ke!=null)throw Error(e(92));if(S(cn)&&1<cn.length)throw Error(e(93));ke=""+cn}return typeof ke=="string"&&ke[0]===`
`&&_.push(`
`),ke!==null&&_.push(C(""+ke)),null;case"input":_.push(Y("input")),gt=cn=ut=ke=null;for(je in q)if(t.call(q,je)&&(qt=q[je],qt!=null))switch(je){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":gt=qt;break;case"defaultValue":ut=qt;break;case"checked":cn=qt;break;case"value":ke=qt;break;default:V(_,se,je,qt)}return cn!==null?V(_,se,"checked",cn):gt!==null&&V(_,se,"checked",gt),ke!==null?V(_,se,"value",ke):ut!==null&&V(_,se,"value",ut),_.push("/>"),null;case"menuitem":_.push(Y("menuitem"));for(var wi in q)if(t.call(q,wi)&&(ke=q[wi],ke!=null))switch(wi){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:V(_,se,wi,ke)}return _.push(">"),null;case"title":_.push(Y("title")),ke=null;for(On in q)if(t.call(q,On)&&(je=q[On],je!=null))switch(On){case"children":ke=je;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:V(_,se,On,je)}return _.push(">"),ke;case"listing":case"pre":_.push(Y(U)),je=ke=null;for(gt in q)if(t.call(q,gt)&&(ut=q[gt],ut!=null))switch(gt){case"children":ke=ut;break;case"dangerouslySetInnerHTML":je=ut;break;default:V(_,se,gt,ut)}if(_.push(">"),je!=null){if(ke!=null)throw Error(e(60));if(typeof je!="object"||!("__html"in je))throw Error(e(61));q=je.__html,q!=null&&(typeof q=="string"&&0<q.length&&q[0]===`
`?_.push(`
`,q):_.push(""+q))}return typeof ke=="string"&&ke[0]===`
`&&_.push(`
`),ke;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":_.push(Y(U));for(var Ii in q)if(t.call(q,Ii)&&(ke=q[Ii],ke!=null))switch(Ii){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,U));default:V(_,se,Ii,ke)}return _.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return J(_,q,U,se);case"html":return Be.insertionMode===0&&_.push("<!DOCTYPE html>"),J(_,q,U,se);default:if(U.indexOf("-")===-1&&typeof q.is!="string")return J(_,q,U,se);_.push(Y(U)),je=ke=null;for(qt in q)if(t.call(q,qt)&&(ut=q[qt],ut!=null))switch(qt){case"children":ke=ut;break;case"dangerouslySetInnerHTML":je=ut;break;case"style":N(_,se,ut);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:a(qt)&&typeof ut!="function"&&typeof ut!="symbol"&&_.push(" ",qt,'="',C(ut),'"')}return _.push(">"),M(_,je,ke),ke}}function pe(_,U,q){if(_.push('<!--$?--><template id="'),q===null)throw Error(e(395));return _.push(q),_.push('"></template>')}function xe(_,U,q,se){switch(q.insertionMode){case 0:case 1:return _.push('<div hidden id="'),_.push(U.segmentPrefix),U=se.toString(16),_.push(U),_.push('">');case 2:return _.push('<svg aria-hidden="true" style="display:none" id="'),_.push(U.segmentPrefix),U=se.toString(16),_.push(U),_.push('">');case 3:return _.push('<math aria-hidden="true" style="display:none" id="'),_.push(U.segmentPrefix),U=se.toString(16),_.push(U),_.push('">');case 4:return _.push('<table hidden id="'),_.push(U.segmentPrefix),U=se.toString(16),_.push(U),_.push('">');case 5:return _.push('<table hidden><tbody id="'),_.push(U.segmentPrefix),U=se.toString(16),_.push(U),_.push('">');case 6:return _.push('<table hidden><tr id="'),_.push(U.segmentPrefix),U=se.toString(16),_.push(U),_.push('">');case 7:return _.push('<table hidden><colgroup id="'),_.push(U.segmentPrefix),U=se.toString(16),_.push(U),_.push('">');default:throw Error(e(397))}}function Ae(_,U){switch(U.insertionMode){case 0:case 1:return _.push("</div>");case 2:return _.push("</svg>");case 3:return _.push("</math>");case 4:return _.push("</table>");case 5:return _.push("</tbody></table>");case 6:return _.push("</tr></table>");case 7:return _.push("</colgroup></table>");default:throw Error(e(397))}}var Le=/[<\u2028\u2029]/g;function we(_){return JSON.stringify(_).replace(Le,function(U){switch(U){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function Se(_,U){return U=U===void 0?"":U,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:U+"P:",segmentPrefix:U+"S:",boundaryPrefix:U+"B:",idPrefix:U,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:_}}function Ee(_,U,q,se){return q.generateStaticMarkup?(_.push(C(U)),!1):(U===""?_=se:(se&&_.push("<!-- -->"),_.push(C(U)),_=!0),_)}var H=Object.assign,ee=Symbol.for("react.element"),ce=Symbol.for("react.portal"),Ce=Symbol.for("react.fragment"),_e=Symbol.for("react.strict_mode"),Ne=Symbol.for("react.profiler"),ft=Symbol.for("react.provider"),ve=Symbol.for("react.context"),ct=Symbol.for("react.forward_ref"),At=Symbol.for("react.suspense"),Wt=Symbol.for("react.suspense_list"),Nt=Symbol.for("react.memo"),bt=Symbol.for("react.lazy"),Rt=Symbol.for("react.scope"),st=Symbol.for("react.debug_trace_mode"),at=Symbol.for("react.legacy_hidden"),zt=Symbol.for("react.default_value"),jt=Symbol.iterator;function _t(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case Ce:return"Fragment";case ce:return"Portal";case Ne:return"Profiler";case _e:return"StrictMode";case At:return"Suspense";case Wt:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case ve:return(_.displayName||"Context")+".Consumer";case ft:return(_._context.displayName||"Context")+".Provider";case ct:var U=_.render;return _=_.displayName,_||(_=U.displayName||U.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case Nt:return U=_.displayName||null,U!==null?U:_t(_.type)||"Memo";case bt:U=_._payload,_=_._init;try{return _t(_(U))}catch{}}return null}var Xt={};function an(_,U){if(_=_.contextTypes,!_)return Xt;var q={},se;for(se in _)q[se]=U[se];return q}var ot=null;function le(_,U){if(_!==U){_.context._currentValue2=_.parentValue,_=_.parent;var q=U.parent;if(_===null){if(q!==null)throw Error(e(401))}else{if(q===null)throw Error(e(401));le(_,q)}U.context._currentValue2=U.value}}function nn(_){_.context._currentValue2=_.parentValue,_=_.parent,_!==null&&nn(_)}function vn(_){var U=_.parent;U!==null&&vn(U),_.context._currentValue2=_.value}function Ln(_,U){if(_.context._currentValue2=_.parentValue,_=_.parent,_===null)throw Error(e(402));_.depth===U.depth?le(_,U):Ln(_,U)}function X(_,U){var q=U.parent;if(q===null)throw Error(e(402));_.depth===q.depth?le(_,q):X(_,q),U.context._currentValue2=U.value}function D(_){var U=ot;U!==_&&(U===null?vn(_):_===null?nn(U):U.depth===_.depth?le(U,_):U.depth>_.depth?Ln(U,_):X(U,_),ot=_)}var B={isMounted:function(){return!1},enqueueSetState:function(_,U){_=_._reactInternals,_.queue!==null&&_.queue.push(U)},enqueueReplaceState:function(_,U){_=_._reactInternals,_.replace=!0,_.queue=[U]},enqueueForceUpdate:function(){}};function te(_,U,q,se){var Be=_.state!==void 0?_.state:null;_.updater=B,_.props=q,_.state=Be;var ke={queue:[],replace:!1};_._reactInternals=ke;var je=U.contextType;if(_.context=typeof je=="object"&&je!==null?je._currentValue2:se,je=U.getDerivedStateFromProps,typeof je=="function"&&(je=je(q,Be),Be=je==null?Be:H({},Be,je),_.state=Be),typeof U.getDerivedStateFromProps!="function"&&typeof _.getSnapshotBeforeUpdate!="function"&&(typeof _.UNSAFE_componentWillMount=="function"||typeof _.componentWillMount=="function"))if(U=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),U!==_.state&&B.enqueueReplaceState(_,_.state,null),ke.queue!==null&&0<ke.queue.length)if(U=ke.queue,je=ke.replace,ke.queue=null,ke.replace=!1,je&&U.length===1)_.state=U[0];else{for(ke=je?U[0]:_.state,Be=!0,je=je?1:0;je<U.length;je++){var ut=U[je];ut=typeof ut=="function"?ut.call(_,ke,q,se):ut,ut!=null&&(Be?(Be=!1,ke=H({},ke,ut)):H(ke,ut))}_.state=ke}else ke.queue=null}var me={id:1,overflow:""};function De(_,U,q){var se=_.id;_=_.overflow;var Be=32-Ge(se)-1;se&=~(1<<Be),q+=1;var ke=32-Ge(U)+Be;if(30<ke){var je=Be-Be%5;return ke=(se&(1<<je)-1).toString(32),se>>=je,Be-=je,{id:1<<32-Ge(U)+Be|q<<Be|se,overflow:ke+_}}return{id:1<<ke|q<<Be|se,overflow:_}}var Ge=Math.clz32?Math.clz32:mn,Lt=Math.log,gn=Math.LN2;function mn(_){return _>>>=0,_===0?32:31-(Lt(_)/gn|0)|0}function wn(_,U){return _===U&&(_!==0||1/_===1/U)||_!==_&&U!==U}var hn=typeof Object.is=="function"?Object.is:wn,Bn=null,Sr=null,mr=null,Qt=null,Yr=!1,Je=!1,En=0,Ht=null,fr=0;function $n(){if(Bn===null)throw Error(e(321));return Bn}function Qr(){if(0<fr)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Mr(){return Qt===null?mr===null?(Yr=!1,mr=Qt=Qr()):(Yr=!0,Qt=mr):Qt.next===null?(Yr=!1,Qt=Qt.next=Qr()):(Yr=!0,Qt=Qt.next),Qt}function ge(){Sr=Bn=null,Je=!1,mr=null,fr=0,Qt=Ht=null}function Ie(_,U){return typeof U=="function"?U(_):U}function Q(_,U,q){if(Bn=$n(),Qt=Mr(),Yr){var se=Qt.queue;if(U=se.dispatch,Ht!==null&&(q=Ht.get(se),q!==void 0)){Ht.delete(se),se=Qt.memoizedState;do se=_(se,q.action),q=q.next;while(q!==null);return Qt.memoizedState=se,[se,U]}return[Qt.memoizedState,U]}return _=_===Ie?typeof U=="function"?U():U:q!==void 0?q(U):U,Qt.memoizedState=_,_=Qt.queue={last:null,dispatch:null},_=_.dispatch=tt.bind(null,Bn,_),[Qt.memoizedState,_]}function Ve(_,U){if(Bn=$n(),Qt=Mr(),U=U===void 0?null:U,Qt!==null){var q=Qt.memoizedState;if(q!==null&&U!==null){var se=q[1];e:if(se===null)se=!1;else{for(var Be=0;Be<se.length&&Be<U.length;Be++)if(!hn(U[Be],se[Be])){se=!1;break e}se=!0}if(se)return q[0]}}return _=_(),Qt.memoizedState=[_,U],_}function tt(_,U,q){if(25<=fr)throw Error(e(301));if(_===Bn)if(Je=!0,_={action:q,next:null},Ht===null&&(Ht=new Map),q=Ht.get(U),q===void 0)Ht.set(U,_);else{for(U=q;U.next!==null;)U=U.next;U.next=_}}function Et(){throw Error(e(394))}function Bt(){}var ht={readContext:function(_){return _._currentValue2},useContext:function(_){return $n(),_._currentValue2},useMemo:Ve,useReducer:Q,useRef:function(_){Bn=$n(),Qt=Mr();var U=Qt.memoizedState;return U===null?(_={current:_},Qt.memoizedState=_):U},useState:function(_){return Q(Ie,_)},useInsertionEffect:Bt,useLayoutEffect:function(){},useCallback:function(_,U){return Ve(function(){return _},U)},useImperativeHandle:Bt,useEffect:Bt,useDebugValue:Bt,useDeferredValue:function(_){return $n(),_},useTransition:function(){return $n(),[!1,Et]},useId:function(){var _=Sr.treeContext,U=_.overflow;_=_.id,_=(_&~(1<<32-Ge(_)-1)).toString(32)+U;var q=pt;if(q===null)throw Error(e(404));return U=En++,_=":"+q.idPrefix+"R"+_,0<U&&(_+="H"+U.toString(32)),_+":"},useMutableSource:function(_,U){return $n(),U(_._source)},useSyncExternalStore:function(_,U,q){if(q===void 0)throw Error(e(407));return q()}},pt=null,Ct=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Fe(_){return console.error(_),null}function lt(){}function We(_,U,q,se,Be,ke,je,ut,gt){var qt=[],cn=new Set;return U={destination:null,responseState:U,progressiveChunkSize:se===void 0?12800:se,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:cn,pingedTasks:qt,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Be===void 0?Fe:Be,onAllReady:lt,onShellReady:je===void 0?lt:je,onShellError:lt,onFatalError:lt},q=it(U,0,null,q,!1,!1),q.parentFlushed=!0,_=In(U,_,null,q,cn,Xt,null,me),qt.push(_),U}function In(_,U,q,se,Be,ke,je,ut){_.allPendingTasks++,q===null?_.pendingRootTasks++:q.pendingTasks++;var gt={node:U,ping:function(){var qt=_.pingedTasks;qt.push(gt),qt.length===1&&rr(_)},blockedBoundary:q,blockedSegment:se,abortSet:Be,legacyContext:ke,context:je,treeContext:ut};return Be.add(gt),gt}function it(_,U,q,se,Be,ke){return{status:0,id:-1,index:U,parentFlushed:!1,chunks:[],children:[],formatContext:se,boundary:q,lastPushedText:Be,textEmbedded:ke}}function fe(_,U){if(_=_.onError(U),_!=null&&typeof _!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof _+'" instead');return _}function ze(_,U){var q=_.onShellError;q(U),q=_.onFatalError,q(U),_.destination!==null?(_.status=2,_.destination.destroy(U)):(_.status=1,_.fatalError=U)}function xt(_,U,q,se,Be){for(Bn={},Sr=U,En=0,_=q(se,Be);Je;)Je=!1,En=0,fr+=1,Qt=null,_=q(se,Be);return ge(),_}function bn(_,U,q,se){var Be=q.render(),ke=se.childContextTypes;if(ke!=null){var je=U.legacyContext;if(typeof q.getChildContext!="function")se=je;else{q=q.getChildContext();for(var ut in q)if(!(ut in ke))throw Error(e(108,_t(se)||"Unknown",ut));se=H({},je,q)}U.legacyContext=se,Zt(_,U,Be),U.legacyContext=je}else Zt(_,U,Be)}function Ot(_,U){if(_&&_.defaultProps){U=H({},U),_=_.defaultProps;for(var q in _)U[q]===void 0&&(U[q]=_[q]);return U}return U}function wt(_,U,q,se,Be){if(typeof q=="function")if(q.prototype&&q.prototype.isReactComponent){Be=an(q,U.legacyContext);var ke=q.contextType;ke=new q(se,typeof ke=="object"&&ke!==null?ke._currentValue2:Be),te(ke,q,se,Be),bn(_,U,ke,q)}else{ke=an(q,U.legacyContext),Be=xt(_,U,q,se,ke);var je=En!==0;if(typeof Be=="object"&&Be!==null&&typeof Be.render=="function"&&Be.$$typeof===void 0)te(Be,q,se,ke),bn(_,U,Be,q);else if(je){se=U.treeContext,U.treeContext=De(se,1,0);try{Zt(_,U,Be)}finally{U.treeContext=se}}else Zt(_,U,Be)}else if(typeof q=="string"){switch(Be=U.blockedSegment,ke=ie(Be.chunks,q,se,_.responseState,Be.formatContext),Be.lastPushedText=!1,je=Be.formatContext,Be.formatContext=E(je,q,se),qn(_,U,ke),Be.formatContext=je,q){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Be.chunks.push("</",q,">")}Be.lastPushedText=!1}else{switch(q){case at:case st:case _e:case Ne:case Ce:Zt(_,U,se.children);return;case Wt:Zt(_,U,se.children);return;case Rt:throw Error(e(343));case At:e:{q=U.blockedBoundary,Be=U.blockedSegment,ke=se.fallback,se=se.children,je=new Set;var ut={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:je,errorDigest:null},gt=it(_,Be.chunks.length,ut,Be.formatContext,!1,!1);Be.children.push(gt),Be.lastPushedText=!1;var qt=it(_,0,null,Be.formatContext,!1,!1);qt.parentFlushed=!0,U.blockedBoundary=ut,U.blockedSegment=qt;try{if(qn(_,U,se),_.responseState.generateStaticMarkup||qt.lastPushedText&&qt.textEmbedded&&qt.chunks.push("<!-- -->"),qt.status=1,tn(ut,qt),ut.pendingTasks===0)break e}catch(cn){qt.status=4,ut.forceClientRender=!0,ut.errorDigest=fe(_,cn)}finally{U.blockedBoundary=q,U.blockedSegment=Be}U=In(_,ke,q,gt,je,U.legacyContext,U.context,U.treeContext),_.pingedTasks.push(U)}return}if(typeof q=="object"&&q!==null)switch(q.$$typeof){case ct:if(se=xt(_,U,q.render,se,Be),En!==0){q=U.treeContext,U.treeContext=De(q,1,0);try{Zt(_,U,se)}finally{U.treeContext=q}}else Zt(_,U,se);return;case Nt:q=q.type,se=Ot(q,se),wt(_,U,q,se,Be);return;case ft:if(Be=se.children,q=q._context,se=se.value,ke=q._currentValue2,q._currentValue2=se,je=ot,ot=se={parent:je,depth:je===null?0:je.depth+1,context:q,parentValue:ke,value:se},U.context=se,Zt(_,U,Be),_=ot,_===null)throw Error(e(403));se=_.parentValue,_.context._currentValue2=se===zt?_.context._defaultValue:se,_=ot=_.parent,U.context=_;return;case ve:se=se.children,se=se(q._currentValue2),Zt(_,U,se);return;case bt:Be=q._init,q=Be(q._payload),se=Ot(q,se),wt(_,U,q,se,void 0);return}throw Error(e(130,q==null?q:typeof q,""))}}function Zt(_,U,q){if(U.node=q,typeof q=="object"&&q!==null){switch(q.$$typeof){case ee:wt(_,U,q.type,q.props,q.ref);return;case ce:throw Error(e(257));case bt:var se=q._init;q=se(q._payload),Zt(_,U,q);return}if(S(q)){Kn(_,U,q);return}if(q===null||typeof q!="object"?se=null:(se=jt&&q[jt]||q["@@iterator"],se=typeof se=="function"?se:null),se&&(se=se.call(q))){if(q=se.next(),!q.done){var Be=[];do Be.push(q.value),q=se.next();while(!q.done);Kn(_,U,Be)}return}throw _=Object.prototype.toString.call(q),Error(e(31,_==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":_))}typeof q=="string"?(se=U.blockedSegment,se.lastPushedText=Ee(U.blockedSegment.chunks,q,_.responseState,se.lastPushedText)):typeof q=="number"&&(se=U.blockedSegment,se.lastPushedText=Ee(U.blockedSegment.chunks,""+q,_.responseState,se.lastPushedText))}function Kn(_,U,q){for(var se=q.length,Be=0;Be<se;Be++){var ke=U.treeContext;U.treeContext=De(ke,se,Be);try{qn(_,U,q[Be])}finally{U.treeContext=ke}}}function qn(_,U,q){var se=U.blockedSegment.formatContext,Be=U.legacyContext,ke=U.context;try{return Zt(_,U,q)}catch(gt){if(ge(),typeof gt=="object"&&gt!==null&&typeof gt.then=="function"){q=gt;var je=U.blockedSegment,ut=it(_,je.chunks.length,null,je.formatContext,je.lastPushedText,!0);je.children.push(ut),je.lastPushedText=!1,_=In(_,U.node,U.blockedBoundary,ut,U.abortSet,U.legacyContext,U.context,U.treeContext).ping,q.then(_,_),U.blockedSegment.formatContext=se,U.legacyContext=Be,U.context=ke,D(ke)}else throw U.blockedSegment.formatContext=se,U.legacyContext=Be,U.context=ke,D(ke),gt}}function nr(_){var U=_.blockedBoundary;_=_.blockedSegment,_.status=3,yn(this,U,_)}function Pn(_,U,q){var se=_.blockedBoundary;_.blockedSegment.status=3,se===null?(U.allPendingTasks--,U.status!==2&&(U.status=2,U.destination!==null&&U.destination.push(null))):(se.pendingTasks--,se.forceClientRender||(se.forceClientRender=!0,_=q===void 0?Error(e(432)):q,se.errorDigest=U.onError(_),se.parentFlushed&&U.clientRenderedBoundaries.push(se)),se.fallbackAbortableTasks.forEach(function(Be){return Pn(Be,U,q)}),se.fallbackAbortableTasks.clear(),U.allPendingTasks--,U.allPendingTasks===0&&(se=U.onAllReady,se()))}function tn(_,U){if(U.chunks.length===0&&U.children.length===1&&U.children[0].boundary===null){var q=U.children[0];q.id=U.id,q.parentFlushed=!0,q.status===1&&tn(_,q)}else _.completedSegments.push(U)}function yn(_,U,q){if(U===null){if(q.parentFlushed){if(_.completedRootSegment!==null)throw Error(e(389));_.completedRootSegment=q}_.pendingRootTasks--,_.pendingRootTasks===0&&(_.onShellError=lt,U=_.onShellReady,U())}else U.pendingTasks--,U.forceClientRender||(U.pendingTasks===0?(q.parentFlushed&&q.status===1&&tn(U,q),U.parentFlushed&&_.completedBoundaries.push(U),U.fallbackAbortableTasks.forEach(nr,_),U.fallbackAbortableTasks.clear()):q.parentFlushed&&q.status===1&&(tn(U,q),U.completedSegments.length===1&&U.parentFlushed&&_.partialBoundaries.push(U)));_.allPendingTasks--,_.allPendingTasks===0&&(_=_.onAllReady,_())}function rr(_){if(_.status!==2){var U=ot,q=Ct.current;Ct.current=ht;var se=pt;pt=_.responseState;try{var Be=_.pingedTasks,ke;for(ke=0;ke<Be.length;ke++){var je=Be[ke],ut=_,gt=je.blockedSegment;if(gt.status===0){D(je.context);try{Zt(ut,je,je.node),ut.responseState.generateStaticMarkup||gt.lastPushedText&&gt.textEmbedded&&gt.chunks.push("<!-- -->"),je.abortSet.delete(je),gt.status=1,yn(ut,je.blockedBoundary,gt)}catch(ei){if(ge(),typeof ei=="object"&&ei!==null&&typeof ei.then=="function"){var qt=je.ping;ei.then(qt,qt)}else{je.abortSet.delete(je),gt.status=4;var cn=je.blockedBoundary,On=ei,wi=fe(ut,On);if(cn===null?ze(ut,On):(cn.pendingTasks--,cn.forceClientRender||(cn.forceClientRender=!0,cn.errorDigest=wi,cn.parentFlushed&&ut.clientRenderedBoundaries.push(cn))),ut.allPendingTasks--,ut.allPendingTasks===0){var Ii=ut.onAllReady;Ii()}}}finally{}}}Be.splice(0,ke),_.destination!==null&&Qi(_,_.destination)}catch(ei){fe(_,ei),ze(_,ei)}finally{pt=se,Ct.current=q,q===ht&&D(U)}}}function li(_,U,q){switch(q.parentFlushed=!0,q.status){case 0:var se=q.id=_.nextSegmentId++;return q.lastPushedText=!1,q.textEmbedded=!1,_=_.responseState,U.push('<template id="'),U.push(_.placeholderPrefix),_=se.toString(16),U.push(_),U.push('"></template>');case 1:q.status=2;var Be=!0;se=q.chunks;var ke=0;q=q.children;for(var je=0;je<q.length;je++){for(Be=q[je];ke<Be.index;ke++)U.push(se[ke]);Be=Cn(_,U,Be)}for(;ke<se.length-1;ke++)U.push(se[ke]);return ke<se.length&&(Be=U.push(se[ke])),Be;default:throw Error(e(390))}}function Cn(_,U,q){var se=q.boundary;if(se===null)return li(_,U,q);if(se.parentFlushed=!0,se.forceClientRender)return _.responseState.generateStaticMarkup||(se=se.errorDigest,U.push("<!--$!-->"),U.push("<template"),se&&(U.push(' data-dgst="'),se=C(se),U.push(se),U.push('"')),U.push("></template>")),li(_,U,q),_=_.responseState.generateStaticMarkup?!0:U.push("<!--/$-->"),_;if(0<se.pendingTasks){se.rootSegmentID=_.nextSegmentId++,0<se.completedSegments.length&&_.partialBoundaries.push(se);var Be=_.responseState,ke=Be.nextSuspenseID++;return Be=Be.boundaryPrefix+ke.toString(16),se=se.id=Be,pe(U,_.responseState,se),li(_,U,q),U.push("<!--/$-->")}if(se.byteSize>_.progressiveChunkSize)return se.rootSegmentID=_.nextSegmentId++,_.completedBoundaries.push(se),pe(U,_.responseState,se.id),li(_,U,q),U.push("<!--/$-->");if(_.responseState.generateStaticMarkup||U.push("<!--$-->"),q=se.completedSegments,q.length!==1)throw Error(e(391));return Cn(_,U,q[0]),_=_.responseState.generateStaticMarkup?!0:U.push("<!--/$-->"),_}function Lr(_,U,q){return xe(U,_.responseState,q.formatContext,q.id),Cn(_,U,q),Ae(U,q.formatContext)}function It(_,U,q){for(var se=q.completedSegments,Be=0;Be<se.length;Be++)Ls(_,U,q,se[Be]);if(se.length=0,_=_.responseState,se=q.id,q=q.rootSegmentID,U.push(_.startInlineScript),_.sentCompleteBoundaryFunction?U.push('$RC("'):(_.sentCompleteBoundaryFunction=!0,U.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),se===null)throw Error(e(395));return q=q.toString(16),U.push(se),U.push('","'),U.push(_.segmentPrefix),U.push(q),U.push('")<\/script>')}function Ls(_,U,q,se){if(se.status===2)return!0;var Be=se.id;if(Be===-1){if((se.id=q.rootSegmentID)===-1)throw Error(e(392));return Lr(_,U,se)}return Lr(_,U,se),_=_.responseState,U.push(_.startInlineScript),_.sentCompleteSegmentFunction?U.push('$RS("'):(_.sentCompleteSegmentFunction=!0,U.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),U.push(_.segmentPrefix),Be=Be.toString(16),U.push(Be),U.push('","'),U.push(_.placeholderPrefix),U.push(Be),U.push('")<\/script>')}function Qi(_,U){try{var q=_.completedRootSegment;if(q!==null&&_.pendingRootTasks===0){Cn(_,U,q),_.completedRootSegment=null;var se=_.responseState.bootstrapChunks;for(q=0;q<se.length-1;q++)U.push(se[q]);q<se.length&&U.push(se[q])}var Be=_.clientRenderedBoundaries,ke;for(ke=0;ke<Be.length;ke++){var je=Be[ke];se=U;var ut=_.responseState,gt=je.id,qt=je.errorDigest,cn=je.errorMessage,On=je.errorComponentStack;if(se.push(ut.startInlineScript),ut.sentClientRenderFunction?se.push('$RX("'):(ut.sentClientRenderFunction=!0,se.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),gt===null)throw Error(e(395));if(se.push(gt),se.push('"'),qt||cn||On){se.push(",");var wi=we(qt||"");se.push(wi)}if(cn||On){se.push(",");var Ii=we(cn||"");se.push(Ii)}if(On){se.push(",");var ei=we(On);se.push(ei)}if(!se.push(")<\/script>")){_.destination=null,ke++,Be.splice(0,ke);return}}Be.splice(0,ke);var bi=_.completedBoundaries;for(ke=0;ke<bi.length;ke++)if(!It(_,U,bi[ke])){_.destination=null,ke++,bi.splice(0,ke);return}bi.splice(0,ke);var Si=_.partialBoundaries;for(ke=0;ke<Si.length;ke++){var vr=Si[ke];e:{Be=_,je=U;var ti=vr.completedSegments;for(ut=0;ut<ti.length;ut++)if(!Ls(Be,je,vr,ti[ut])){ut++,ti.splice(0,ut);var Jn=!1;break e}ti.splice(0,ut),Jn=!0}if(!Jn){_.destination=null,ke++,Si.splice(0,ke);return}}Si.splice(0,ke);var Ur=_.completedBoundaries;for(ke=0;ke<Ur.length;ke++)if(!It(_,U,Ur[ke])){_.destination=null,ke++,Ur.splice(0,ke);return}Ur.splice(0,ke)}finally{_.allPendingTasks===0&&_.pingedTasks.length===0&&_.clientRenderedBoundaries.length===0&&_.completedBoundaries.length===0&&U.push(null)}}function es(_,U){try{var q=_.abortableTasks;q.forEach(function(se){return Pn(se,_,U)}),q.clear(),_.destination!==null&&Qi(_,_.destination)}catch(se){fe(_,se),ze(_,se)}}function St(){}function rn(_,U,q,se){var Be=!1,ke=null,je="",ut={push:function(qt){return qt!==null&&(je+=qt),!0},destroy:function(qt){Be=!0,ke=qt}},gt=!1;if(_=We(_,Se(q,U?U.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,St,void 0,function(){gt=!0}),rr(_),es(_,se),_.status===1)_.status=2,ut.destroy(_.fatalError);else if(_.status!==2&&_.destination===null){_.destination=ut;try{Qi(_,ut)}catch(qt){fe(_,qt),ze(_,qt)}}if(Be)throw ke;if(!gt)throw Error(e(426));return je}return Wl.renderToNodeStream=function(){throw Error(e(207))},Wl.renderToStaticMarkup=function(_,U){return rn(_,U,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Wl.renderToStaticNodeStream=function(){throw Error(e(208))},Wl.renderToString=function(_,U){return rn(_,U,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Wl.version="18.3.1",Wl}var w0={},_b;function wF(){if(_b)return w0;_b=1;var n=oh();function e(T){for(var G="https://reactjs.org/docs/error-decoder.html?invariant="+T,$=1;$<arguments.length;$++)G+="&args[]="+encodeURIComponent(arguments[$]);return"Minified React error #"+T+"; visit "+G+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=null,r=0;function i(T,G){if(G.length!==0)if(512<G.length)0<r&&(T.enqueue(new Uint8Array(t.buffer,0,r)),t=new Uint8Array(512),r=0),T.enqueue(G);else{var $=t.length-r;$<G.length&&($===0?T.enqueue(t):(t.set(G.subarray(0,$),r),T.enqueue(t),G=G.subarray($)),t=new Uint8Array(512),r=0),t.set(G,r),r+=G.length}}function s(T,G){return i(T,G),!0}function a(T){t&&0<r&&(T.enqueue(new Uint8Array(t.buffer,0,r)),t=null,r=0)}var c=new TextEncoder;function d(T){return c.encode(T)}function f(T){return c.encode(T)}function h(T,G){typeof T.error=="function"?T.error(G):T.close()}var v=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},C={};function x(T){return v.call(C,T)?!0:v.call(y,T)?!1:m.test(T)?C[T]=!0:(y[T]=!0,!1)}function b(T,G,$,re,Me,Re,Ze){this.acceptsBooleans=G===2||G===3||G===4,this.attributeName=re,this.attributeNamespace=Me,this.mustUseProperty=$,this.propertyName=T,this.type=G,this.sanitizeURL=Re,this.removeEmptyString=Ze}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(T){S[T]=new b(T,0,!1,T,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(T){var G=T[0];S[G]=new b(G,1,!1,T[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(T){S[T]=new b(T,2,!1,T.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(T){S[T]=new b(T,2,!1,T,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(T){S[T]=new b(T,3,!1,T.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(T){S[T]=new b(T,3,!0,T,null,!1,!1)}),["capture","download"].forEach(function(T){S[T]=new b(T,4,!1,T,null,!1,!1)}),["cols","rows","size","span"].forEach(function(T){S[T]=new b(T,6,!1,T,null,!1,!1)}),["rowSpan","start"].forEach(function(T){S[T]=new b(T,5,!1,T.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function E(T){return T[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(T){var G=T.replace(A,E);S[G]=new b(G,1,!1,T,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(T){var G=T.replace(A,E);S[G]=new b(G,1,!1,T,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(T){var G=T.replace(A,E);S[G]=new b(G,1,!1,T,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(T){S[T]=new b(T,1,!1,T.toLowerCase(),null,!1,!1)}),S.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(T){S[T]=new b(T,1,!1,T.toLowerCase(),null,!0,!0)});var R={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N=["Webkit","ms","Moz","O"];Object.keys(R).forEach(function(T){N.forEach(function(G){G=G+T.charAt(0).toUpperCase()+T.substring(1),R[G]=R[T]})});var V=/["'&<>]/;function M(T){if(typeof T=="boolean"||typeof T=="number")return""+T;T=""+T;var G=V.exec(T);if(G){var $="",re,Me=0;for(re=G.index;re<T.length;re++){switch(T.charCodeAt(re)){case 34:G="&quot;";break;case 38:G="&amp;";break;case 39:G="&#x27;";break;case 60:G="&lt;";break;case 62:G="&gt;";break;default:continue}Me!==re&&($+=T.substring(Me,re)),Me=re+1,$+=G}T=Me!==re?$+T.substring(Me,re):$}return T}var j=/([A-Z])/g,J=/^ms-/,L=Array.isArray,z=f("<script>"),Y=f("<\/script>"),ie=f('<script src="'),pe=f('<script type="module" src="'),xe=f('" async=""><\/script>'),Ae=/(<\/|<)(s)(cript)/gi;function Le(T,G,$,re){return""+G+($==="s"?"\\u0073":"\\u0053")+re}function we(T,G,$,re,Me){T=T===void 0?"":T,G=G===void 0?z:f('<script nonce="'+M(G)+'">');var Re=[];if($!==void 0&&Re.push(G,d((""+$).replace(Ae,Le)),Y),re!==void 0)for($=0;$<re.length;$++)Re.push(ie,d(M(re[$])),xe);if(Me!==void 0)for(re=0;re<Me.length;re++)Re.push(pe,d(M(Me[re])),xe);return{bootstrapChunks:Re,startInlineScript:G,placeholderPrefix:f(T+"P:"),segmentPrefix:f(T+"S:"),boundaryPrefix:T+"B:",idPrefix:T,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Se(T,G){return{insertionMode:T,selectedValue:G}}function Ee(T){return Se(T==="http://www.w3.org/2000/svg"?2:T==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function H(T,G,$){switch(G){case"select":return Se(1,$.value!=null?$.value:$.defaultValue);case"svg":return Se(2,null);case"math":return Se(3,null);case"foreignObject":return Se(1,null);case"table":return Se(4,null);case"thead":case"tbody":case"tfoot":return Se(5,null);case"colgroup":return Se(7,null);case"tr":return Se(6,null)}return 4<=T.insertionMode||T.insertionMode===0?Se(1,null):T}var ee=f("<!-- -->");function ce(T,G,$,re){return G===""?re:(re&&T.push(ee),T.push(d(M(G))),!0)}var Ce=new Map,_e=f(' style="'),Ne=f(":"),ft=f(";");function ve(T,G,$){if(typeof $!="object")throw Error(e(62));G=!0;for(var re in $)if(v.call($,re)){var Me=$[re];if(Me!=null&&typeof Me!="boolean"&&Me!==""){if(re.indexOf("--")===0){var Re=d(M(re));Me=d(M((""+Me).trim()))}else{Re=re;var Ze=Ce.get(Re);Ze!==void 0||(Ze=f(M(Re.replace(j,"-$1").toLowerCase().replace(J,"-ms-"))),Ce.set(Re,Ze)),Re=Ze,Me=typeof Me=="number"?Me===0||v.call(R,re)?d(""+Me):d(Me+"px"):d(M((""+Me).trim()))}G?(G=!1,T.push(_e,Re,Ne,Me)):T.push(ft,Re,Ne,Me)}}G||T.push(Wt)}var ct=f(" "),At=f('="'),Wt=f('"'),Nt=f('=""');function bt(T,G,$,re){switch($){case"style":ve(T,G,re);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<$.length)||$[0]!=="o"&&$[0]!=="O"||$[1]!=="n"&&$[1]!=="N"){if(G=S.hasOwnProperty($)?S[$]:null,G!==null){switch(typeof re){case"function":case"symbol":return;case"boolean":if(!G.acceptsBooleans)return}switch($=d(G.attributeName),G.type){case 3:re&&T.push(ct,$,Nt);break;case 4:re===!0?T.push(ct,$,Nt):re!==!1&&T.push(ct,$,At,d(M(re)),Wt);break;case 5:isNaN(re)||T.push(ct,$,At,d(M(re)),Wt);break;case 6:!isNaN(re)&&1<=re&&T.push(ct,$,At,d(M(re)),Wt);break;default:G.sanitizeURL&&(re=""+re),T.push(ct,$,At,d(M(re)),Wt)}}else if(x($)){switch(typeof re){case"function":case"symbol":return;case"boolean":if(G=$.toLowerCase().slice(0,5),G!=="data-"&&G!=="aria-")return}T.push(ct,d($),At,d(M(re)),Wt)}}}var Rt=f(">"),st=f("/>");function at(T,G,$){if(G!=null){if($!=null)throw Error(e(60));if(typeof G!="object"||!("__html"in G))throw Error(e(61));G=G.__html,G!=null&&T.push(d(""+G))}}function zt(T){var G="";return n.Children.forEach(T,function($){$!=null&&(G+=$)}),G}var jt=f(' selected=""');function _t(T,G,$,re){T.push(le($));var Me=$=null,Re;for(Re in G)if(v.call(G,Re)){var Ze=G[Re];if(Ze!=null)switch(Re){case"children":$=Ze;break;case"dangerouslySetInnerHTML":Me=Ze;break;default:bt(T,re,Re,Ze)}}return T.push(Rt),at(T,Me,$),typeof $=="string"?(T.push(d(M($))),null):$}var Xt=f(`
`),an=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ot=new Map;function le(T){var G=ot.get(T);if(G===void 0){if(!an.test(T))throw Error(e(65,T));G=f("<"+T),ot.set(T,G)}return G}var nn=f("<!DOCTYPE html>");function vn(T,G,$,re,Me){switch(G){case"select":T.push(le("select"));var Re=null,Ze=null;for($t in $)if(v.call($,$t)){var Ye=$[$t];if(Ye!=null)switch($t){case"children":Re=Ye;break;case"dangerouslySetInnerHTML":Ze=Ye;break;case"defaultValue":case"value":break;default:bt(T,re,$t,Ye)}}return T.push(Rt),at(T,Ze,Re),Re;case"option":Ze=Me.selectedValue,T.push(le("option"));var Kt=Ye=null,fn=null,$t=null;for(Re in $)if(v.call($,Re)){var Un=$[Re];if(Un!=null)switch(Re){case"children":Ye=Un;break;case"selected":fn=Un;break;case"dangerouslySetInnerHTML":$t=Un;break;case"value":Kt=Un;default:bt(T,re,Re,Un)}}if(Ze!=null)if($=Kt!==null?""+Kt:zt(Ye),L(Ze)){for(re=0;re<Ze.length;re++)if(""+Ze[re]===$){T.push(jt);break}}else""+Ze===$&&T.push(jt);else fn&&T.push(jt);return T.push(Rt),at(T,$t,Ye),Ye;case"textarea":T.push(le("textarea")),$t=Ze=Re=null;for(Ye in $)if(v.call($,Ye)&&(Kt=$[Ye],Kt!=null))switch(Ye){case"children":$t=Kt;break;case"value":Re=Kt;break;case"defaultValue":Ze=Kt;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:bt(T,re,Ye,Kt)}if(Re===null&&Ze!==null&&(Re=Ze),T.push(Rt),$t!=null){if(Re!=null)throw Error(e(92));if(L($t)&&1<$t.length)throw Error(e(93));Re=""+$t}return typeof Re=="string"&&Re[0]===`
`&&T.push(Xt),Re!==null&&T.push(d(M(""+Re))),null;case"input":T.push(le("input")),Kt=$t=Ye=Re=null;for(Ze in $)if(v.call($,Ze)&&(fn=$[Ze],fn!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":Kt=fn;break;case"defaultValue":Ye=fn;break;case"checked":$t=fn;break;case"value":Re=fn;break;default:bt(T,re,Ze,fn)}return $t!==null?bt(T,re,"checked",$t):Kt!==null&&bt(T,re,"checked",Kt),Re!==null?bt(T,re,"value",Re):Ye!==null&&bt(T,re,"value",Ye),T.push(st),null;case"menuitem":T.push(le("menuitem"));for(var xr in $)if(v.call($,xr)&&(Re=$[xr],Re!=null))switch(xr){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:bt(T,re,xr,Re)}return T.push(Rt),null;case"title":T.push(le("title")),Re=null;for(Un in $)if(v.call($,Un)&&(Ze=$[Un],Ze!=null))switch(Un){case"children":Re=Ze;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:bt(T,re,Un,Ze)}return T.push(Rt),Re;case"listing":case"pre":T.push(le(G)),Ze=Re=null;for(Kt in $)if(v.call($,Kt)&&(Ye=$[Kt],Ye!=null))switch(Kt){case"children":Re=Ye;break;case"dangerouslySetInnerHTML":Ze=Ye;break;default:bt(T,re,Kt,Ye)}if(T.push(Rt),Ze!=null){if(Re!=null)throw Error(e(60));if(typeof Ze!="object"||!("__html"in Ze))throw Error(e(61));$=Ze.__html,$!=null&&(typeof $=="string"&&0<$.length&&$[0]===`
`?T.push(Xt,d($)):T.push(d(""+$)))}return typeof Re=="string"&&Re[0]===`
`&&T.push(Xt),Re;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":T.push(le(G));for(var Ai in $)if(v.call($,Ai)&&(Re=$[Ai],Re!=null))switch(Ai){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,G));default:bt(T,re,Ai,Re)}return T.push(st),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return _t(T,$,G,re);case"html":return Me.insertionMode===0&&T.push(nn),_t(T,$,G,re);default:if(G.indexOf("-")===-1&&typeof $.is!="string")return _t(T,$,G,re);T.push(le(G)),Ze=Re=null;for(fn in $)if(v.call($,fn)&&(Ye=$[fn],Ye!=null))switch(fn){case"children":Re=Ye;break;case"dangerouslySetInnerHTML":Ze=Ye;break;case"style":ve(T,re,Ye);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:x(fn)&&typeof Ye!="function"&&typeof Ye!="symbol"&&T.push(ct,d(fn),At,d(M(Ye)),Wt)}return T.push(Rt),at(T,Ze,Re),Re}}var Ln=f("</"),X=f(">"),D=f('<template id="'),B=f('"></template>'),te=f("<!--$-->"),me=f('<!--$?--><template id="'),De=f('"></template>'),Ge=f("<!--$!-->"),Lt=f("<!--/$-->"),gn=f("<template"),mn=f('"'),wn=f(' data-dgst="');f(' data-msg="'),f(' data-stck="');var hn=f("></template>");function Bn(T,G,$){if(i(T,me),$===null)throw Error(e(395));return i(T,$),s(T,De)}var Sr=f('<div hidden id="'),mr=f('">'),Qt=f("</div>"),Yr=f('<svg aria-hidden="true" style="display:none" id="'),Je=f('">'),En=f("</svg>"),Ht=f('<math aria-hidden="true" style="display:none" id="'),fr=f('">'),$n=f("</math>"),Qr=f('<table hidden id="'),Mr=f('">'),ge=f("</table>"),Ie=f('<table hidden><tbody id="'),Q=f('">'),Ve=f("</tbody></table>"),tt=f('<table hidden><tr id="'),Et=f('">'),Bt=f("</tr></table>"),ht=f('<table hidden><colgroup id="'),pt=f('">'),Ct=f("</colgroup></table>");function Fe(T,G,$,re){switch($.insertionMode){case 0:case 1:return i(T,Sr),i(T,G.segmentPrefix),i(T,d(re.toString(16))),s(T,mr);case 2:return i(T,Yr),i(T,G.segmentPrefix),i(T,d(re.toString(16))),s(T,Je);case 3:return i(T,Ht),i(T,G.segmentPrefix),i(T,d(re.toString(16))),s(T,fr);case 4:return i(T,Qr),i(T,G.segmentPrefix),i(T,d(re.toString(16))),s(T,Mr);case 5:return i(T,Ie),i(T,G.segmentPrefix),i(T,d(re.toString(16))),s(T,Q);case 6:return i(T,tt),i(T,G.segmentPrefix),i(T,d(re.toString(16))),s(T,Et);case 7:return i(T,ht),i(T,G.segmentPrefix),i(T,d(re.toString(16))),s(T,pt);default:throw Error(e(397))}}function lt(T,G){switch(G.insertionMode){case 0:case 1:return s(T,Qt);case 2:return s(T,En);case 3:return s(T,$n);case 4:return s(T,ge);case 5:return s(T,Ve);case 6:return s(T,Bt);case 7:return s(T,Ct);default:throw Error(e(397))}}var We=f('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),In=f('$RS("'),it=f('","'),fe=f('")<\/script>'),ze=f('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),xt=f('$RC("'),bn=f('","'),Ot=f('")<\/script>'),wt=f('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),Zt=f('$RX("'),Kn=f('"'),qn=f(")<\/script>"),nr=f(","),Pn=/[<\u2028\u2029]/g;function tn(T){return JSON.stringify(T).replace(Pn,function(G){switch(G){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var yn=Object.assign,rr=Symbol.for("react.element"),li=Symbol.for("react.portal"),Cn=Symbol.for("react.fragment"),Lr=Symbol.for("react.strict_mode"),It=Symbol.for("react.profiler"),Ls=Symbol.for("react.provider"),Qi=Symbol.for("react.context"),es=Symbol.for("react.forward_ref"),St=Symbol.for("react.suspense"),rn=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),q=Symbol.for("react.scope"),se=Symbol.for("react.debug_trace_mode"),Be=Symbol.for("react.legacy_hidden"),ke=Symbol.for("react.default_value"),je=Symbol.iterator;function ut(T){if(T==null)return null;if(typeof T=="function")return T.displayName||T.name||null;if(typeof T=="string")return T;switch(T){case Cn:return"Fragment";case li:return"Portal";case It:return"Profiler";case Lr:return"StrictMode";case St:return"Suspense";case rn:return"SuspenseList"}if(typeof T=="object")switch(T.$$typeof){case Qi:return(T.displayName||"Context")+".Consumer";case Ls:return(T._context.displayName||"Context")+".Provider";case es:var G=T.render;return T=T.displayName,T||(T=G.displayName||G.name||"",T=T!==""?"ForwardRef("+T+")":"ForwardRef"),T;case _:return G=T.displayName||null,G!==null?G:ut(T.type)||"Memo";case U:G=T._payload,T=T._init;try{return ut(T(G))}catch{}}return null}var gt={};function qt(T,G){if(T=T.contextTypes,!T)return gt;var $={},re;for(re in T)$[re]=G[re];return $}var cn=null;function On(T,G){if(T!==G){T.context._currentValue=T.parentValue,T=T.parent;var $=G.parent;if(T===null){if($!==null)throw Error(e(401))}else{if($===null)throw Error(e(401));On(T,$)}G.context._currentValue=G.value}}function wi(T){T.context._currentValue=T.parentValue,T=T.parent,T!==null&&wi(T)}function Ii(T){var G=T.parent;G!==null&&Ii(G),T.context._currentValue=T.value}function ei(T,G){if(T.context._currentValue=T.parentValue,T=T.parent,T===null)throw Error(e(402));T.depth===G.depth?On(T,G):ei(T,G)}function bi(T,G){var $=G.parent;if($===null)throw Error(e(402));T.depth===$.depth?On(T,$):bi(T,$),G.context._currentValue=G.value}function Si(T){var G=cn;G!==T&&(G===null?Ii(T):T===null?wi(G):G.depth===T.depth?On(G,T):G.depth>T.depth?ei(G,T):bi(G,T),cn=T)}var vr={isMounted:function(){return!1},enqueueSetState:function(T,G){T=T._reactInternals,T.queue!==null&&T.queue.push(G)},enqueueReplaceState:function(T,G){T=T._reactInternals,T.replace=!0,T.queue=[G]},enqueueForceUpdate:function(){}};function ti(T,G,$,re){var Me=T.state!==void 0?T.state:null;T.updater=vr,T.props=$,T.state=Me;var Re={queue:[],replace:!1};T._reactInternals=Re;var Ze=G.contextType;if(T.context=typeof Ze=="object"&&Ze!==null?Ze._currentValue:re,Ze=G.getDerivedStateFromProps,typeof Ze=="function"&&(Ze=Ze($,Me),Me=Ze==null?Me:yn({},Me,Ze),T.state=Me),typeof G.getDerivedStateFromProps!="function"&&typeof T.getSnapshotBeforeUpdate!="function"&&(typeof T.UNSAFE_componentWillMount=="function"||typeof T.componentWillMount=="function"))if(G=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),G!==T.state&&vr.enqueueReplaceState(T,T.state,null),Re.queue!==null&&0<Re.queue.length)if(G=Re.queue,Ze=Re.replace,Re.queue=null,Re.replace=!1,Ze&&G.length===1)T.state=G[0];else{for(Re=Ze?G[0]:T.state,Me=!0,Ze=Ze?1:0;Ze<G.length;Ze++){var Ye=G[Ze];Ye=typeof Ye=="function"?Ye.call(T,Re,$,re):Ye,Ye!=null&&(Me?(Me=!1,Re=yn({},Re,Ye)):yn(Re,Ye))}T.state=Re}else Re.queue=null}var Jn={id:1,overflow:""};function Ur(T,G,$){var re=T.id;T=T.overflow;var Me=32-Cs(re)-1;re&=~(1<<Me),$+=1;var Re=32-Cs(G)+Me;if(30<Re){var Ze=Me-Me%5;return Re=(re&(1<<Ze)-1).toString(32),re>>=Ze,Me-=Ze,{id:1<<32-Cs(G)+Me|$<<Me|re,overflow:Re+T}}return{id:1<<Re|$<<Me|re,overflow:T}}var Cs=Math.clz32?Math.clz32:ws,xs=Math.log,Ta=Math.LN2;function ws(T){return T>>>=0,T===0?32:31-(xs(T)/Ta|0)|0}function _a(T,G){return T===G&&(T!==0||1/T===1/G)||T!==T&&G!==G}var Od=typeof Object.is=="function"?Object.is:_a,ts=null,io=null,Ra=null,Fn=null,yr=!1,vt=!1,ui=0,ir=null,di=0;function ns(){if(ts===null)throw Error(e(321));return ts}function Da(){if(0<di)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Us(){return Fn===null?Ra===null?(yr=!1,Ra=Fn=Da()):(yr=!0,Fn=Ra):Fn.next===null?(yr=!1,Fn=Fn.next=Da()):(yr=!0,Fn=Fn.next),Fn}function Wo(){io=ts=null,vt=!1,Ra=null,di=0,Fn=ir=null}function Dc(T,G){return typeof G=="function"?G(T):G}function Vn(T,G,$){if(ts=ns(),Fn=Us(),yr){var re=Fn.queue;if(G=re.dispatch,ir!==null&&($=ir.get(re),$!==void 0)){ir.delete(re),re=Fn.memoizedState;do re=T(re,$.action),$=$.next;while($!==null);return Fn.memoizedState=re,[re,G]}return[Fn.memoizedState,G]}return T=T===Dc?typeof G=="function"?G():G:$!==void 0?$(G):G,Fn.memoizedState=T,T=Fn.queue={last:null,dispatch:null},T=T.dispatch=Gr.bind(null,ts,T),[Fn.memoizedState,T]}function dn(T,G){if(ts=ns(),Fn=Us(),G=G===void 0?null:G,Fn!==null){var $=Fn.memoizedState;if($!==null&&G!==null){var re=$[1];e:if(re===null)re=!1;else{for(var Me=0;Me<re.length&&Me<G.length;Me++)if(!Od(G[Me],re[Me])){re=!1;break e}re=!0}if(re)return $[0]}}return T=T(),Fn.memoizedState=[T,G],T}function Gr(T,G,$){if(25<=di)throw Error(e(301));if(T===ts)if(vt=!0,T={action:$,next:null},ir===null&&(ir=new Map),$=ir.get(G),$===void 0)ir.set(G,T);else{for(G=$;G.next!==null;)G=G.next;G.next=T}}function wu(){throw Error(e(394))}function so(){}var Pa={readContext:function(T){return T._currentValue},useContext:function(T){return ns(),T._currentValue},useMemo:dn,useReducer:Vn,useRef:function(T){ts=ns(),Fn=Us();var G=Fn.memoizedState;return G===null?(T={current:T},Fn.memoizedState=T):G},useState:function(T){return Vn(Dc,T)},useInsertionEffect:so,useLayoutEffect:function(){},useCallback:function(T,G){return dn(function(){return T},G)},useImperativeHandle:so,useEffect:so,useDebugValue:so,useDeferredValue:function(T){return ns(),T},useTransition:function(){return ns(),[!1,wu]},useId:function(){var T=io.treeContext,G=T.overflow;T=T.id,T=(T&~(1<<32-Cs(T)-1)).toString(32)+G;var $=Na;if($===null)throw Error(e(404));return G=ui++,T=":"+$.idPrefix+"R"+T,0<G&&(T+="H"+G.toString(32)),T+":"},useMutableSource:function(T,G){return ns(),G(T._source)},useSyncExternalStore:function(T,G,$){if($===void 0)throw Error(e(407));return $()}},Na=null,Vr=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Gs(T){return console.error(T),null}function Is(){}function bs(T,G,$,re,Me,Re,Ze,Ye,Kt){var fn=[],$t=new Set;return G={destination:null,responseState:G,progressiveChunkSize:re===void 0?12800:re,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:$t,pingedTasks:fn,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Me===void 0?Gs:Me,onAllReady:Re===void 0?Is:Re,onShellReady:Ze===void 0?Is:Ze,onShellError:Ye===void 0?Is:Ye,onFatalError:Kt===void 0?Is:Kt},$=zo(G,0,null,$,!1,!1),$.parentFlushed=!0,T=Al(G,T,null,$,$t,gt,null,Jn),fn.push(T),G}function Al(T,G,$,re,Me,Re,Ze,Ye){T.allPendingTasks++,$===null?T.pendingRootTasks++:$.pendingTasks++;var Kt={node:G,ping:function(){var fn=T.pingedTasks;fn.push(Kt),fn.length===1&&js(T)},blockedBoundary:$,blockedSegment:re,abortSet:Me,legacyContext:Re,context:Ze,treeContext:Ye};return Me.add(Kt),Kt}function zo(T,G,$,re,Me,Re){return{status:0,id:-1,index:G,parentFlushed:!1,chunks:[],children:[],formatContext:re,boundary:$,lastPushedText:Me,textEmbedded:Re}}function oo(T,G){if(T=T.onError(G),T!=null&&typeof T!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof T+'" instead');return T}function Vs(T,G){var $=T.onShellError;$(G),$=T.onFatalError,$(G),T.destination!==null?(T.status=2,h(T.destination,G)):(T.status=1,T.fatalError=G)}function Ho(T,G,$,re,Me){for(ts={},io=G,ui=0,T=$(re,Me);vt;)vt=!1,ui=0,di+=1,Fn=null,T=$(re,Me);return Wo(),T}function kl(T,G,$,re){var Me=$.render(),Re=re.childContextTypes;if(Re!=null){var Ze=G.legacyContext;if(typeof $.getChildContext!="function")re=Ze;else{$=$.getChildContext();for(var Ye in $)if(!(Ye in Re))throw Error(e(108,ut(re)||"Unknown",Ye));re=yn({},Ze,$)}G.legacyContext=re,jr(T,G,Me),G.legacyContext=Ze}else jr(T,G,Me)}function Pc(T,G){if(T&&T.defaultProps){G=yn({},G),T=T.defaultProps;for(var $ in T)G[$]===void 0&&(G[$]=T[$]);return G}return G}function El(T,G,$,re,Me){if(typeof $=="function")if($.prototype&&$.prototype.isReactComponent){Me=qt($,G.legacyContext);var Re=$.contextType;Re=new $(re,typeof Re=="object"&&Re!==null?Re._currentValue:Me),ti(Re,$,re,Me),kl(T,G,Re,$)}else{Re=qt($,G.legacyContext),Me=Ho(T,G,$,re,Re);var Ze=ui!==0;if(typeof Me=="object"&&Me!==null&&typeof Me.render=="function"&&Me.$$typeof===void 0)ti(Me,$,re,Re),kl(T,G,Me,$);else if(Ze){re=G.treeContext,G.treeContext=Ur(re,1,0);try{jr(T,G,Me)}finally{G.treeContext=re}}else jr(T,G,Me)}else if(typeof $=="string"){switch(Me=G.blockedSegment,Re=vn(Me.chunks,$,re,T.responseState,Me.formatContext),Me.lastPushedText=!1,Ze=Me.formatContext,Me.formatContext=H(Ze,$,re),Tl(T,G,Re),Me.formatContext=Ze,$){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Me.chunks.push(Ln,d($),X)}Me.lastPushedText=!1}else{switch($){case Be:case se:case Lr:case It:case Cn:jr(T,G,re.children);return;case rn:jr(T,G,re.children);return;case q:throw Error(e(343));case St:e:{$=G.blockedBoundary,Me=G.blockedSegment,Re=re.fallback,re=re.children,Ze=new Set;var Ye={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Ze,errorDigest:null},Kt=zo(T,Me.chunks.length,Ye,Me.formatContext,!1,!1);Me.children.push(Kt),Me.lastPushedText=!1;var fn=zo(T,0,null,Me.formatContext,!1,!1);fn.parentFlushed=!0,G.blockedBoundary=Ye,G.blockedSegment=fn;try{if(Tl(T,G,re),fn.lastPushedText&&fn.textEmbedded&&fn.chunks.push(ee),fn.status=1,Nc(Ye,fn),Ye.pendingTasks===0)break e}catch($t){fn.status=4,Ye.forceClientRender=!0,Ye.errorDigest=oo(T,$t)}finally{G.blockedBoundary=$,G.blockedSegment=Me}G=Al(T,Re,$,Kt,Ze,G.legacyContext,G.context,G.treeContext),T.pingedTasks.push(G)}return}if(typeof $=="object"&&$!==null)switch($.$$typeof){case es:if(re=Ho(T,G,$.render,re,Me),ui!==0){$=G.treeContext,G.treeContext=Ur($,1,0);try{jr(T,G,re)}finally{G.treeContext=$}}else jr(T,G,re);return;case _:$=$.type,re=Pc($,re),El(T,G,$,re,Me);return;case Ls:if(Me=re.children,$=$._context,re=re.value,Re=$._currentValue,$._currentValue=re,Ze=cn,cn=re={parent:Ze,depth:Ze===null?0:Ze.depth+1,context:$,parentValue:Re,value:re},G.context=re,jr(T,G,Me),T=cn,T===null)throw Error(e(403));re=T.parentValue,T.context._currentValue=re===ke?T.context._defaultValue:re,T=cn=T.parent,G.context=T;return;case Qi:re=re.children,re=re($._currentValue),jr(T,G,re);return;case U:Me=$._init,$=Me($._payload),re=Pc($,re),El(T,G,$,re,void 0);return}throw Error(e(130,$==null?$:typeof $,""))}}function jr(T,G,$){if(G.node=$,typeof $=="object"&&$!==null){switch($.$$typeof){case rr:El(T,G,$.type,$.props,$.ref);return;case li:throw Error(e(257));case U:var re=$._init;$=re($._payload),jr(T,G,$);return}if(L($)){Ar(T,G,$);return}if($===null||typeof $!="object"?re=null:(re=je&&$[je]||$["@@iterator"],re=typeof re=="function"?re:null),re&&(re=re.call($))){if($=re.next(),!$.done){var Me=[];do Me.push($.value),$=re.next();while(!$.done);Ar(T,G,Me)}return}throw T=Object.prototype.toString.call($),Error(e(31,T==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":T))}typeof $=="string"?(re=G.blockedSegment,re.lastPushedText=ce(G.blockedSegment.chunks,$,T.responseState,re.lastPushedText)):typeof $=="number"&&(re=G.blockedSegment,re.lastPushedText=ce(G.blockedSegment.chunks,""+$,T.responseState,re.lastPushedText))}function Ar(T,G,$){for(var re=$.length,Me=0;Me<re;Me++){var Re=G.treeContext;G.treeContext=Ur(Re,re,Me);try{Tl(T,G,$[Me])}finally{G.treeContext=Re}}}function Tl(T,G,$){var re=G.blockedSegment.formatContext,Me=G.legacyContext,Re=G.context;try{return jr(T,G,$)}catch(Kt){if(Wo(),typeof Kt=="object"&&Kt!==null&&typeof Kt.then=="function"){$=Kt;var Ze=G.blockedSegment,Ye=zo(T,Ze.chunks.length,null,Ze.formatContext,Ze.lastPushedText,!0);Ze.children.push(Ye),Ze.lastPushedText=!1,T=Al(T,G.node,G.blockedBoundary,Ye,G.abortSet,G.legacyContext,G.context,G.treeContext).ping,$.then(T,T),G.blockedSegment.formatContext=re,G.legacyContext=Me,G.context=Re,Si(Re)}else throw G.blockedSegment.formatContext=re,G.legacyContext=Me,G.context=Re,Si(Re),Kt}}function Fd(T){var G=T.blockedBoundary;T=T.blockedSegment,T.status=3,Mc(this,G,T)}function Iu(T,G,$){var re=T.blockedBoundary;T.blockedSegment.status=3,re===null?(G.allPendingTasks--,G.status!==2&&(G.status=2,G.destination!==null&&G.destination.close())):(re.pendingTasks--,re.forceClientRender||(re.forceClientRender=!0,T=$===void 0?Error(e(432)):$,re.errorDigest=G.onError(T),re.parentFlushed&&G.clientRenderedBoundaries.push(re)),re.fallbackAbortableTasks.forEach(function(Me){return Iu(Me,G,$)}),re.fallbackAbortableTasks.clear(),G.allPendingTasks--,G.allPendingTasks===0&&(re=G.onAllReady,re()))}function Nc(T,G){if(G.chunks.length===0&&G.children.length===1&&G.children[0].boundary===null){var $=G.children[0];$.id=G.id,$.parentFlushed=!0,$.status===1&&Nc(T,$)}else T.completedSegments.push(G)}function Mc(T,G,$){if(G===null){if($.parentFlushed){if(T.completedRootSegment!==null)throw Error(e(389));T.completedRootSegment=$}T.pendingRootTasks--,T.pendingRootTasks===0&&(T.onShellError=Is,G=T.onShellReady,G())}else G.pendingTasks--,G.forceClientRender||(G.pendingTasks===0?($.parentFlushed&&$.status===1&&Nc(G,$),G.parentFlushed&&T.completedBoundaries.push(G),G.fallbackAbortableTasks.forEach(Fd,T),G.fallbackAbortableTasks.clear()):$.parentFlushed&&$.status===1&&(Nc(G,$),G.completedSegments.length===1&&G.parentFlushed&&T.partialBoundaries.push(G)));T.allPendingTasks--,T.allPendingTasks===0&&(T=T.onAllReady,T())}function js(T){if(T.status!==2){var G=cn,$=Vr.current;Vr.current=Pa;var re=Na;Na=T.responseState;try{var Me=T.pingedTasks,Re;for(Re=0;Re<Me.length;Re++){var Ze=Me[Re],Ye=T,Kt=Ze.blockedSegment;if(Kt.status===0){Si(Ze.context);try{jr(Ye,Ze,Ze.node),Kt.lastPushedText&&Kt.textEmbedded&&Kt.chunks.push(ee),Ze.abortSet.delete(Ze),Kt.status=1,Mc(Ye,Ze.blockedBoundary,Kt)}catch(ki){if(Wo(),typeof ki=="object"&&ki!==null&&typeof ki.then=="function"){var fn=Ze.ping;ki.then(fn,fn)}else{Ze.abortSet.delete(Ze),Kt.status=4;var $t=Ze.blockedBoundary,Un=ki,xr=oo(Ye,Un);if($t===null?Vs(Ye,Un):($t.pendingTasks--,$t.forceClientRender||($t.forceClientRender=!0,$t.errorDigest=xr,$t.parentFlushed&&Ye.clientRenderedBoundaries.push($t))),Ye.allPendingTasks--,Ye.allPendingTasks===0){var Ai=Ye.onAllReady;Ai()}}}finally{}}}Me.splice(0,Re),T.destination!==null&&Rl(T,T.destination)}catch(ki){oo(T,ki),Vs(T,ki)}finally{Na=re,Vr.current=$,$===Pa&&Si(G)}}}function Zo(T,G,$){switch($.parentFlushed=!0,$.status){case 0:var re=$.id=T.nextSegmentId++;return $.lastPushedText=!1,$.textEmbedded=!1,T=T.responseState,i(G,D),i(G,T.placeholderPrefix),T=d(re.toString(16)),i(G,T),s(G,B);case 1:$.status=2;var Me=!0;re=$.chunks;var Re=0;$=$.children;for(var Ze=0;Ze<$.length;Ze++){for(Me=$[Ze];Re<Me.index;Re++)i(G,re[Re]);Me=Bc(T,G,Me)}for(;Re<re.length-1;Re++)i(G,re[Re]);return Re<re.length&&(Me=s(G,re[Re])),Me;default:throw Error(e(390))}}function Bc(T,G,$){var re=$.boundary;if(re===null)return Zo(T,G,$);if(re.parentFlushed=!0,re.forceClientRender)re=re.errorDigest,s(G,Ge),i(G,gn),re&&(i(G,wn),i(G,d(M(re))),i(G,mn)),s(G,hn),Zo(T,G,$);else if(0<re.pendingTasks){re.rootSegmentID=T.nextSegmentId++,0<re.completedSegments.length&&T.partialBoundaries.push(re);var Me=T.responseState,Re=Me.nextSuspenseID++;Me=f(Me.boundaryPrefix+Re.toString(16)),re=re.id=Me,Bn(G,T.responseState,re),Zo(T,G,$)}else if(re.byteSize>T.progressiveChunkSize)re.rootSegmentID=T.nextSegmentId++,T.completedBoundaries.push(re),Bn(G,T.responseState,re.id),Zo(T,G,$);else{if(s(G,te),$=re.completedSegments,$.length!==1)throw Error(e(391));Bc(T,G,$[0])}return s(G,Lt)}function bu(T,G,$){return Fe(G,T.responseState,$.formatContext,$.id),Bc(T,G,$),lt(G,$.formatContext)}function _l(T,G,$){for(var re=$.completedSegments,Me=0;Me<re.length;Me++)Cr(T,G,$,re[Me]);if(re.length=0,T=T.responseState,re=$.id,$=$.rootSegmentID,i(G,T.startInlineScript),T.sentCompleteBoundaryFunction?i(G,xt):(T.sentCompleteBoundaryFunction=!0,i(G,ze)),re===null)throw Error(e(395));return $=d($.toString(16)),i(G,re),i(G,bn),i(G,T.segmentPrefix),i(G,$),s(G,Ot)}function Cr(T,G,$,re){if(re.status===2)return!0;var Me=re.id;if(Me===-1){if((re.id=$.rootSegmentID)===-1)throw Error(e(392));return bu(T,G,re)}return bu(T,G,re),T=T.responseState,i(G,T.startInlineScript),T.sentCompleteSegmentFunction?i(G,In):(T.sentCompleteSegmentFunction=!0,i(G,We)),i(G,T.segmentPrefix),Me=d(Me.toString(16)),i(G,Me),i(G,it),i(G,T.placeholderPrefix),i(G,Me),s(G,fe)}function Rl(T,G){t=new Uint8Array(512),r=0;try{var $=T.completedRootSegment;if($!==null&&T.pendingRootTasks===0){Bc(T,G,$),T.completedRootSegment=null;var re=T.responseState.bootstrapChunks;for($=0;$<re.length-1;$++)i(G,re[$]);$<re.length&&s(G,re[$])}var Me=T.clientRenderedBoundaries,Re;for(Re=0;Re<Me.length;Re++){var Ze=Me[Re];re=G;var Ye=T.responseState,Kt=Ze.id,fn=Ze.errorDigest,$t=Ze.errorMessage,Un=Ze.errorComponentStack;if(i(re,Ye.startInlineScript),Ye.sentClientRenderFunction?i(re,Zt):(Ye.sentClientRenderFunction=!0,i(re,wt)),Kt===null)throw Error(e(395));i(re,Kt),i(re,Kn),(fn||$t||Un)&&(i(re,nr),i(re,d(tn(fn||"")))),($t||Un)&&(i(re,nr),i(re,d(tn($t||"")))),Un&&(i(re,nr),i(re,d(tn(Un)))),s(re,qn)}Me.splice(0,Re);var xr=T.completedBoundaries;for(Re=0;Re<xr.length;Re++)_l(T,G,xr[Re]);xr.splice(0,Re),a(G),t=new Uint8Array(512),r=0;var Ai=T.partialBoundaries;for(Re=0;Re<Ai.length;Re++){var ki=Ai[Re];e:{Me=T,Ze=G;var rs=ki.completedSegments;for(Ye=0;Ye<rs.length;Ye++)if(!Cr(Me,Ze,ki,rs[Ye])){Ye++,rs.splice(0,Ye);var Oc=!1;break e}rs.splice(0,Ye),Oc=!0}if(!Oc){T.destination=null,Re++,Ai.splice(0,Re);return}}Ai.splice(0,Re);var Li=T.completedBoundaries;for(Re=0;Re<Li.length;Re++)_l(T,G,Li[Re]);Li.splice(0,Re)}finally{a(G),T.allPendingTasks===0&&T.pingedTasks.length===0&&T.clientRenderedBoundaries.length===0&&T.completedBoundaries.length===0&&G.close()}}function Ss(T,G){try{var $=T.abortableTasks;$.forEach(function(re){return Iu(re,T,G)}),$.clear(),T.destination!==null&&Rl(T,T.destination)}catch(re){oo(T,re),Vs(T,re)}}return w0.renderToReadableStream=function(T,G){return new Promise(function($,re){var Me,Re,Ze=new Promise(function($t,Un){Re=$t,Me=Un}),Ye=bs(T,we(G?G.identifierPrefix:void 0,G?G.nonce:void 0,G?G.bootstrapScriptContent:void 0,G?G.bootstrapScripts:void 0,G?G.bootstrapModules:void 0),Ee(G?G.namespaceURI:void 0),G?G.progressiveChunkSize:void 0,G?G.onError:void 0,Re,function(){var $t=new ReadableStream({type:"bytes",pull:function(Un){if(Ye.status===1)Ye.status=2,h(Un,Ye.fatalError);else if(Ye.status!==2&&Ye.destination===null){Ye.destination=Un;try{Rl(Ye,Un)}catch(xr){oo(Ye,xr),Vs(Ye,xr)}}},cancel:function(){Ss(Ye)}},{highWaterMark:0});$t.allReady=Ze,$($t)},function($t){Ze.catch(function(){}),re($t)},Me);if(G&&G.signal){var Kt=G.signal,fn=function(){Ss(Ye,Kt.reason),Kt.removeEventListener("abort",fn)};Kt.addEventListener("abort",fn)}js(Ye)})},w0.version="18.3.1",w0}var Rb;function IF(){if(Rb)return Yc;Rb=1;var n,e;return n=xF(),e=wF(),Yc.version=n.version,Yc.renderToString=n.renderToString,Yc.renderToStaticMarkup=n.renderToStaticMarkup,Yc.renderToNodeStream=n.renderToNodeStream,Yc.renderToStaticNodeStream=n.renderToStaticNodeStream,Yc.renderToReadableStream=e.renderToReadableStream,Yc}var bF=IF();const Db=kc(bF);/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:sE,setPrototypeOf:Pb,isFrozen:SF,getPrototypeOf:AF,getOwnPropertyDescriptor:kF}=Object;let{freeze:qi,seal:no,create:oE}=Object,{apply:wy,construct:Iy}=typeof Reflect<"u"&&Reflect;qi||(qi=function(e){return e});no||(no=function(e){return e});wy||(wy=function(e,t,r){return e.apply(t,r)});Iy||(Iy=function(e,t){return new e(...t)});const I0=Ji(Array.prototype.forEach),EF=Ji(Array.prototype.lastIndexOf),Nb=Ji(Array.prototype.pop),pf=Ji(Array.prototype.push),TF=Ji(Array.prototype.splice),wp=Ji(String.prototype.toLowerCase),mv=Ji(String.prototype.toString),Mb=Ji(String.prototype.match),gf=Ji(String.prototype.replace),_F=Ji(String.prototype.indexOf),RF=Ji(String.prototype.trim),go=Ji(Object.prototype.hasOwnProperty),Vi=Ji(RegExp.prototype.test),mf=DF(TypeError);function Ji(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return wy(n,e,r)}}function DF(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Iy(n,t)}}function An(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wp;Pb&&Pb(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=t(i);s!==i&&(SF(e)||(e[r]=s),i=s)}n[i]=!0}return n}function PF(n){for(let e=0;e<n.length;e++)go(n,e)||(n[e]=null);return n}function ja(n){const e=oE(null);for(const[t,r]of sE(n))go(n,t)&&(Array.isArray(r)?e[t]=PF(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=ja(r):e[t]=r);return e}function vf(n,e){for(;n!==null;){const r=kF(n,e);if(r){if(r.get)return Ji(r.get);if(typeof r.value=="function")return Ji(r.value)}n=AF(n)}function t(){return null}return t}const Bb=qi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),vv=qi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),yv=qi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),NF=qi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Cv=qi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),MF=qi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ob=qi(["#text"]),Fb=qi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),xv=qi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Lb=qi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),b0=qi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),BF=no(/\{\{[\w\W]*|[\w\W]*\}\}/gm),OF=no(/<%[\w\W]*|[\w\W]*%>/gm),FF=no(/\$\{[\w\W]*/gm),LF=no(/^data-[\-\w.\u00B7-\uFFFF]+$/),UF=no(/^aria-[\-\w]+$/),aE=no(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),GF=no(/^(?:\w+script|data):/i),VF=no(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),cE=no(/^html$/i),jF=no(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ub=Object.freeze({__proto__:null,ARIA_ATTR:UF,ATTR_WHITESPACE:VF,CUSTOM_ELEMENT:jF,DATA_ATTR:LF,DOCTYPE_NAME:cE,ERB_EXPR:OF,IS_ALLOWED_URI:aE,IS_SCRIPT_OR_DATA:GF,MUSTACHE_EXPR:BF,TMPLIT_EXPR:FF});const yf={element:1,text:3,progressingInstruction:7,comment:8,document:9},WF=function(){return typeof window>"u"?null:window},zF=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},Gb=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function lE(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:WF();const e=it=>lE(it);if(e.version="3.2.6",e.removed=[],!n||!n.document||n.document.nodeType!==yf.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:c,Element:d,NodeFilter:f,NamedNodeMap:h=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:v,DOMParser:m,trustedTypes:y}=n,C=d.prototype,x=vf(C,"cloneNode"),b=vf(C,"remove"),S=vf(C,"nextSibling"),A=vf(C,"childNodes"),E=vf(C,"parentNode");if(typeof a=="function"){const it=t.createElement("template");it.content&&it.content.ownerDocument&&(t=it.content.ownerDocument)}let R,N="";const{implementation:V,createNodeIterator:M,createDocumentFragment:j,getElementsByTagName:J}=t,{importNode:L}=r;let z=Gb();e.isSupported=typeof sE=="function"&&typeof E=="function"&&V&&V.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Y,ERB_EXPR:ie,TMPLIT_EXPR:pe,DATA_ATTR:xe,ARIA_ATTR:Ae,IS_SCRIPT_OR_DATA:Le,ATTR_WHITESPACE:we,CUSTOM_ELEMENT:Se}=Ub;let{IS_ALLOWED_URI:Ee}=Ub,H=null;const ee=An({},[...Bb,...vv,...yv,...Cv,...Ob]);let ce=null;const Ce=An({},[...Fb,...xv,...Lb,...b0]);let _e=Object.seal(oE(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ne=null,ft=null,ve=!0,ct=!0,At=!1,Wt=!0,Nt=!1,bt=!0,Rt=!1,st=!1,at=!1,zt=!1,jt=!1,_t=!1,Xt=!0,an=!1;const ot="user-content-";let le=!0,nn=!1,vn={},Ln=null;const X=An({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let D=null;const B=An({},["audio","video","img","source","image","track"]);let te=null;const me=An({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),De="http://www.w3.org/1998/Math/MathML",Ge="http://www.w3.org/2000/svg",Lt="http://www.w3.org/1999/xhtml";let gn=Lt,mn=!1,wn=null;const hn=An({},[De,Ge,Lt],mv);let Bn=An({},["mi","mo","mn","ms","mtext"]),Sr=An({},["annotation-xml"]);const mr=An({},["title","style","font","a","script"]);let Qt=null;const Yr=["application/xhtml+xml","text/html"],Je="text/html";let En=null,Ht=null;const fr=t.createElement("form"),$n=function(fe){return fe instanceof RegExp||fe instanceof Function},Qr=function(){let fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ht&&Ht===fe)){if((!fe||typeof fe!="object")&&(fe={}),fe=ja(fe),Qt=Yr.indexOf(fe.PARSER_MEDIA_TYPE)===-1?Je:fe.PARSER_MEDIA_TYPE,En=Qt==="application/xhtml+xml"?mv:wp,H=go(fe,"ALLOWED_TAGS")?An({},fe.ALLOWED_TAGS,En):ee,ce=go(fe,"ALLOWED_ATTR")?An({},fe.ALLOWED_ATTR,En):Ce,wn=go(fe,"ALLOWED_NAMESPACES")?An({},fe.ALLOWED_NAMESPACES,mv):hn,te=go(fe,"ADD_URI_SAFE_ATTR")?An(ja(me),fe.ADD_URI_SAFE_ATTR,En):me,D=go(fe,"ADD_DATA_URI_TAGS")?An(ja(B),fe.ADD_DATA_URI_TAGS,En):B,Ln=go(fe,"FORBID_CONTENTS")?An({},fe.FORBID_CONTENTS,En):X,Ne=go(fe,"FORBID_TAGS")?An({},fe.FORBID_TAGS,En):ja({}),ft=go(fe,"FORBID_ATTR")?An({},fe.FORBID_ATTR,En):ja({}),vn=go(fe,"USE_PROFILES")?fe.USE_PROFILES:!1,ve=fe.ALLOW_ARIA_ATTR!==!1,ct=fe.ALLOW_DATA_ATTR!==!1,At=fe.ALLOW_UNKNOWN_PROTOCOLS||!1,Wt=fe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Nt=fe.SAFE_FOR_TEMPLATES||!1,bt=fe.SAFE_FOR_XML!==!1,Rt=fe.WHOLE_DOCUMENT||!1,zt=fe.RETURN_DOM||!1,jt=fe.RETURN_DOM_FRAGMENT||!1,_t=fe.RETURN_TRUSTED_TYPE||!1,at=fe.FORCE_BODY||!1,Xt=fe.SANITIZE_DOM!==!1,an=fe.SANITIZE_NAMED_PROPS||!1,le=fe.KEEP_CONTENT!==!1,nn=fe.IN_PLACE||!1,Ee=fe.ALLOWED_URI_REGEXP||aE,gn=fe.NAMESPACE||Lt,Bn=fe.MATHML_TEXT_INTEGRATION_POINTS||Bn,Sr=fe.HTML_INTEGRATION_POINTS||Sr,_e=fe.CUSTOM_ELEMENT_HANDLING||{},fe.CUSTOM_ELEMENT_HANDLING&&$n(fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_e.tagNameCheck=fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&$n(fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_e.attributeNameCheck=fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&typeof fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(_e.allowCustomizedBuiltInElements=fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Nt&&(ct=!1),jt&&(zt=!0),vn&&(H=An({},Ob),ce=[],vn.html===!0&&(An(H,Bb),An(ce,Fb)),vn.svg===!0&&(An(H,vv),An(ce,xv),An(ce,b0)),vn.svgFilters===!0&&(An(H,yv),An(ce,xv),An(ce,b0)),vn.mathMl===!0&&(An(H,Cv),An(ce,Lb),An(ce,b0))),fe.ADD_TAGS&&(H===ee&&(H=ja(H)),An(H,fe.ADD_TAGS,En)),fe.ADD_ATTR&&(ce===Ce&&(ce=ja(ce)),An(ce,fe.ADD_ATTR,En)),fe.ADD_URI_SAFE_ATTR&&An(te,fe.ADD_URI_SAFE_ATTR,En),fe.FORBID_CONTENTS&&(Ln===X&&(Ln=ja(Ln)),An(Ln,fe.FORBID_CONTENTS,En)),le&&(H["#text"]=!0),Rt&&An(H,["html","head","body"]),H.table&&(An(H,["tbody"]),delete Ne.tbody),fe.TRUSTED_TYPES_POLICY){if(typeof fe.TRUSTED_TYPES_POLICY.createHTML!="function")throw mf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof fe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw mf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=fe.TRUSTED_TYPES_POLICY,N=R.createHTML("")}else R===void 0&&(R=zF(y,i)),R!==null&&typeof N=="string"&&(N=R.createHTML(""));qi&&qi(fe),Ht=fe}},Mr=An({},[...vv,...yv,...NF]),ge=An({},[...Cv,...MF]),Ie=function(fe){let ze=E(fe);(!ze||!ze.tagName)&&(ze={namespaceURI:gn,tagName:"template"});const xt=wp(fe.tagName),bn=wp(ze.tagName);return wn[fe.namespaceURI]?fe.namespaceURI===Ge?ze.namespaceURI===Lt?xt==="svg":ze.namespaceURI===De?xt==="svg"&&(bn==="annotation-xml"||Bn[bn]):!!Mr[xt]:fe.namespaceURI===De?ze.namespaceURI===Lt?xt==="math":ze.namespaceURI===Ge?xt==="math"&&Sr[bn]:!!ge[xt]:fe.namespaceURI===Lt?ze.namespaceURI===Ge&&!Sr[bn]||ze.namespaceURI===De&&!Bn[bn]?!1:!ge[xt]&&(mr[xt]||!Mr[xt]):!!(Qt==="application/xhtml+xml"&&wn[fe.namespaceURI]):!1},Q=function(fe){pf(e.removed,{element:fe});try{E(fe).removeChild(fe)}catch{b(fe)}},Ve=function(fe,ze){try{pf(e.removed,{attribute:ze.getAttributeNode(fe),from:ze})}catch{pf(e.removed,{attribute:null,from:ze})}if(ze.removeAttribute(fe),fe==="is")if(zt||jt)try{Q(ze)}catch{}else try{ze.setAttribute(fe,"")}catch{}},tt=function(fe){let ze=null,xt=null;if(at)fe="<remove></remove>"+fe;else{const wt=Mb(fe,/^[\r\n\t ]+/);xt=wt&&wt[0]}Qt==="application/xhtml+xml"&&gn===Lt&&(fe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+fe+"</body></html>");const bn=R?R.createHTML(fe):fe;if(gn===Lt)try{ze=new m().parseFromString(bn,Qt)}catch{}if(!ze||!ze.documentElement){ze=V.createDocument(gn,"template",null);try{ze.documentElement.innerHTML=mn?N:bn}catch{}}const Ot=ze.body||ze.documentElement;return fe&&xt&&Ot.insertBefore(t.createTextNode(xt),Ot.childNodes[0]||null),gn===Lt?J.call(ze,Rt?"html":"body")[0]:Rt?ze.documentElement:Ot},Et=function(fe){return M.call(fe.ownerDocument||fe,fe,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},Bt=function(fe){return fe instanceof v&&(typeof fe.nodeName!="string"||typeof fe.textContent!="string"||typeof fe.removeChild!="function"||!(fe.attributes instanceof h)||typeof fe.removeAttribute!="function"||typeof fe.setAttribute!="function"||typeof fe.namespaceURI!="string"||typeof fe.insertBefore!="function"||typeof fe.hasChildNodes!="function")},ht=function(fe){return typeof c=="function"&&fe instanceof c};function pt(it,fe,ze){I0(it,xt=>{xt.call(e,fe,ze,Ht)})}const Ct=function(fe){let ze=null;if(pt(z.beforeSanitizeElements,fe,null),Bt(fe))return Q(fe),!0;const xt=En(fe.nodeName);if(pt(z.uponSanitizeElement,fe,{tagName:xt,allowedTags:H}),bt&&fe.hasChildNodes()&&!ht(fe.firstElementChild)&&Vi(/<[/\w!]/g,fe.innerHTML)&&Vi(/<[/\w!]/g,fe.textContent)||fe.nodeType===yf.progressingInstruction||bt&&fe.nodeType===yf.comment&&Vi(/<[/\w]/g,fe.data))return Q(fe),!0;if(!H[xt]||Ne[xt]){if(!Ne[xt]&&lt(xt)&&(_e.tagNameCheck instanceof RegExp&&Vi(_e.tagNameCheck,xt)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(xt)))return!1;if(le&&!Ln[xt]){const bn=E(fe)||fe.parentNode,Ot=A(fe)||fe.childNodes;if(Ot&&bn){const wt=Ot.length;for(let Zt=wt-1;Zt>=0;--Zt){const Kn=x(Ot[Zt],!0);Kn.__removalCount=(fe.__removalCount||0)+1,bn.insertBefore(Kn,S(fe))}}}return Q(fe),!0}return fe instanceof d&&!Ie(fe)||(xt==="noscript"||xt==="noembed"||xt==="noframes")&&Vi(/<\/no(script|embed|frames)/i,fe.innerHTML)?(Q(fe),!0):(Nt&&fe.nodeType===yf.text&&(ze=fe.textContent,I0([Y,ie,pe],bn=>{ze=gf(ze,bn," ")}),fe.textContent!==ze&&(pf(e.removed,{element:fe.cloneNode()}),fe.textContent=ze)),pt(z.afterSanitizeElements,fe,null),!1)},Fe=function(fe,ze,xt){if(Xt&&(ze==="id"||ze==="name")&&(xt in t||xt in fr))return!1;if(!(ct&&!ft[ze]&&Vi(xe,ze))){if(!(ve&&Vi(Ae,ze))){if(!ce[ze]||ft[ze]){if(!(lt(fe)&&(_e.tagNameCheck instanceof RegExp&&Vi(_e.tagNameCheck,fe)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(fe))&&(_e.attributeNameCheck instanceof RegExp&&Vi(_e.attributeNameCheck,ze)||_e.attributeNameCheck instanceof Function&&_e.attributeNameCheck(ze))||ze==="is"&&_e.allowCustomizedBuiltInElements&&(_e.tagNameCheck instanceof RegExp&&Vi(_e.tagNameCheck,xt)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(xt))))return!1}else if(!te[ze]){if(!Vi(Ee,gf(xt,we,""))){if(!((ze==="src"||ze==="xlink:href"||ze==="href")&&fe!=="script"&&_F(xt,"data:")===0&&D[fe])){if(!(At&&!Vi(Le,gf(xt,we,"")))){if(xt)return!1}}}}}}return!0},lt=function(fe){return fe!=="annotation-xml"&&Mb(fe,Se)},We=function(fe){pt(z.beforeSanitizeAttributes,fe,null);const{attributes:ze}=fe;if(!ze||Bt(fe))return;const xt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ce,forceKeepAttr:void 0};let bn=ze.length;for(;bn--;){const Ot=ze[bn],{name:wt,namespaceURI:Zt,value:Kn}=Ot,qn=En(wt),nr=Kn;let Pn=wt==="value"?nr:RF(nr);if(xt.attrName=qn,xt.attrValue=Pn,xt.keepAttr=!0,xt.forceKeepAttr=void 0,pt(z.uponSanitizeAttribute,fe,xt),Pn=xt.attrValue,an&&(qn==="id"||qn==="name")&&(Ve(wt,fe),Pn=ot+Pn),bt&&Vi(/((--!?|])>)|<\/(style|title)/i,Pn)){Ve(wt,fe);continue}if(xt.forceKeepAttr)continue;if(!xt.keepAttr){Ve(wt,fe);continue}if(!Wt&&Vi(/\/>/i,Pn)){Ve(wt,fe);continue}Nt&&I0([Y,ie,pe],yn=>{Pn=gf(Pn,yn," ")});const tn=En(fe.nodeName);if(!Fe(tn,qn,Pn)){Ve(wt,fe);continue}if(R&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!Zt)switch(y.getAttributeType(tn,qn)){case"TrustedHTML":{Pn=R.createHTML(Pn);break}case"TrustedScriptURL":{Pn=R.createScriptURL(Pn);break}}if(Pn!==nr)try{Zt?fe.setAttributeNS(Zt,wt,Pn):fe.setAttribute(wt,Pn),Bt(fe)?Q(fe):Nb(e.removed)}catch{Ve(wt,fe)}}pt(z.afterSanitizeAttributes,fe,null)},In=function it(fe){let ze=null;const xt=Et(fe);for(pt(z.beforeSanitizeShadowDOM,fe,null);ze=xt.nextNode();)pt(z.uponSanitizeShadowNode,ze,null),Ct(ze),We(ze),ze.content instanceof s&&it(ze.content);pt(z.afterSanitizeShadowDOM,fe,null)};return e.sanitize=function(it){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ze=null,xt=null,bn=null,Ot=null;if(mn=!it,mn&&(it="<!-->"),typeof it!="string"&&!ht(it))if(typeof it.toString=="function"){if(it=it.toString(),typeof it!="string")throw mf("dirty is not a string, aborting")}else throw mf("toString is not a function");if(!e.isSupported)return it;if(st||Qr(fe),e.removed=[],typeof it=="string"&&(nn=!1),nn){if(it.nodeName){const Kn=En(it.nodeName);if(!H[Kn]||Ne[Kn])throw mf("root node is forbidden and cannot be sanitized in-place")}}else if(it instanceof c)ze=tt("<!---->"),xt=ze.ownerDocument.importNode(it,!0),xt.nodeType===yf.element&&xt.nodeName==="BODY"||xt.nodeName==="HTML"?ze=xt:ze.appendChild(xt);else{if(!zt&&!Nt&&!Rt&&it.indexOf("<")===-1)return R&&_t?R.createHTML(it):it;if(ze=tt(it),!ze)return zt?null:_t?N:""}ze&&at&&Q(ze.firstChild);const wt=Et(nn?it:ze);for(;bn=wt.nextNode();)Ct(bn),We(bn),bn.content instanceof s&&In(bn.content);if(nn)return it;if(zt){if(jt)for(Ot=j.call(ze.ownerDocument);ze.firstChild;)Ot.appendChild(ze.firstChild);else Ot=ze;return(ce.shadowroot||ce.shadowrootmode)&&(Ot=L.call(r,Ot,!0)),Ot}let Zt=Rt?ze.outerHTML:ze.innerHTML;return Rt&&H["!doctype"]&&ze.ownerDocument&&ze.ownerDocument.doctype&&ze.ownerDocument.doctype.name&&Vi(cE,ze.ownerDocument.doctype.name)&&(Zt="<!DOCTYPE "+ze.ownerDocument.doctype.name+`>
`+Zt),Nt&&I0([Y,ie,pe],Kn=>{Zt=gf(Zt,Kn," ")}),R&&_t?R.createHTML(Zt):Zt},e.setConfig=function(){let it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qr(it),st=!0},e.clearConfig=function(){Ht=null,st=!1},e.isValidAttribute=function(it,fe,ze){Ht||Qr({});const xt=En(it),bn=En(fe);return Fe(xt,bn,ze)},e.addHook=function(it,fe){typeof fe=="function"&&pf(z[it],fe)},e.removeHook=function(it,fe){if(fe!==void 0){const ze=EF(z[it],fe);return ze===-1?void 0:TF(z[it],ze,1)[0]}return Nb(z[it])},e.removeHooks=function(it){z[it]=[]},e.removeAllHooks=function(){z=Gb()},e}var HF=lE();function ZF(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}return n}function by(n,e){return Array(e+1).join(n)}function XF(n){return n.replace(/^\n*/,"")}function $F(n){for(var e=n.length;e>0&&n[e-1]===`
`;)e--;return n.substring(0,e)}var KF=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function GC(n){return VC(n,KF)}var uE=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function dE(n){return VC(n,uE)}function qF(n){return hE(n,uE)}var fE=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function JF(n){return VC(n,fE)}function YF(n){return hE(n,fE)}function VC(n,e){return e.indexOf(n.nodeName)>=0}function hE(n,e){return n.getElementsByTagName&&e.some(function(t){return n.getElementsByTagName(t).length})}var Fi={};Fi.paragraph={filter:"p",replacement:function(n){return`

`+n+`

`}};Fi.lineBreak={filter:"br",replacement:function(n,e,t){return t.br+`
`}};Fi.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(n,e,t){var r=Number(e.nodeName.charAt(1));if(t.headingStyle==="setext"&&r<3){var i=by(r===1?"=":"-",n.length);return`

`+n+`
`+i+`

`}else return`

`+by("#",r)+" "+n+`

`}};Fi.blockquote={filter:"blockquote",replacement:function(n){return n=n.replace(/^\n+|\n+$/g,""),n=n.replace(/^/gm,"> "),`

`+n+`

`}};Fi.list={filter:["ul","ol"],replacement:function(n,e){var t=e.parentNode;return t.nodeName==="LI"&&t.lastElementChild===e?`
`+n:`

`+n+`

`}};Fi.listItem={filter:"li",replacement:function(n,e,t){n=n.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=t.bulletListMarker+"   ",i=e.parentNode;if(i.nodeName==="OL"){var s=i.getAttribute("start"),a=Array.prototype.indexOf.call(i.children,e);r=(s?Number(s)+a:a+1)+".  "}return r+n+(e.nextSibling&&!/\n$/.test(n)?`
`:"")}};Fi.indentedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="indented"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){return`

    `+e.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Fi.fencedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="fenced"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){for(var r=e.firstChild.getAttribute("class")||"",i=(r.match(/language-(\S+)/)||[null,""])[1],s=e.firstChild.textContent,a=t.fence.charAt(0),c=3,d=new RegExp("^"+a+"{3,}","gm"),f;f=d.exec(s);)f[0].length>=c&&(c=f[0].length+1);var h=by(a,c);return`

`+h+i+`
`+s.replace(/\n$/,"")+`
`+h+`

`}};Fi.horizontalRule={filter:"hr",replacement:function(n,e,t){return`

`+t.hr+`

`}};Fi.inlineLink={filter:function(n,e){return e.linkStyle==="inlined"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e){var t=e.getAttribute("href");t&&(t=t.replace(/([()])/g,"\\$1"));var r=Kp(e.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+n+"]("+t+r+")"}};Fi.referenceLink={filter:function(n,e){return e.linkStyle==="referenced"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e,t){var r=e.getAttribute("href"),i=Kp(e.getAttribute("title"));i&&(i=' "'+i+'"');var s,a;switch(t.linkReferenceStyle){case"collapsed":s="["+n+"][]",a="["+n+"]: "+r+i;break;case"shortcut":s="["+n+"]",a="["+n+"]: "+r+i;break;default:var c=this.references.length+1;s="["+n+"]["+c+"]",a="["+c+"]: "+r+i}return this.references.push(a),s},references:[],append:function(n){var e="";return this.references.length&&(e=`

`+this.references.join(`
`)+`

`,this.references=[]),e}};Fi.emphasis={filter:["em","i"],replacement:function(n,e,t){return n.trim()?t.emDelimiter+n+t.emDelimiter:""}};Fi.strong={filter:["strong","b"],replacement:function(n,e,t){return n.trim()?t.strongDelimiter+n+t.strongDelimiter:""}};Fi.code={filter:function(n){var e=n.previousSibling||n.nextSibling,t=n.parentNode.nodeName==="PRE"&&!e;return n.nodeName==="CODE"&&!t},replacement:function(n){if(!n)return"";n=n.replace(/\r?\n|\r/g," ");for(var e=/^`|^ .*?[^ ].* $|`$/.test(n)?" ":"",t="`",r=n.match(/`+/gm)||[];r.indexOf(t)!==-1;)t=t+"`";return t+e+n+e+t}};Fi.image={filter:"img",replacement:function(n,e){var t=Kp(e.getAttribute("alt")),r=e.getAttribute("src")||"",i=Kp(e.getAttribute("title")),s=i?' "'+i+'"':"";return r?"!["+t+"]("+r+s+")":""}};function Kp(n){return n?n.replace(/(\n+\s*)+/g,`
`):""}function pE(n){this.options=n,this._keep=[],this._remove=[],this.blankRule={replacement:n.blankReplacement},this.keepReplacement=n.keepReplacement,this.defaultRule={replacement:n.defaultReplacement},this.array=[];for(var e in n.rules)this.array.push(n.rules[e])}pE.prototype={add:function(n,e){this.array.unshift(e)},keep:function(n){this._keep.unshift({filter:n,replacement:this.keepReplacement})},remove:function(n){this._remove.unshift({filter:n,replacement:function(){return""}})},forNode:function(n){if(n.isBlank)return this.blankRule;var e;return(e=wv(this.array,n,this.options))||(e=wv(this._keep,n,this.options))||(e=wv(this._remove,n,this.options))?e:this.defaultRule},forEach:function(n){for(var e=0;e<this.array.length;e++)n(this.array[e],e)}};function wv(n,e,t){for(var r=0;r<n.length;r++){var i=n[r];if(QF(i,e,t))return i}}function QF(n,e,t){var r=n.filter;if(typeof r=="string"){if(r===e.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(e.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(n,e,t))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function e8(n){var e=n.element,t=n.isBlock,r=n.isVoid,i=n.isPre||function(v){return v.nodeName==="PRE"};if(!(!e.firstChild||i(e))){for(var s=null,a=!1,c=null,d=Vb(c,e,i);d!==e;){if(d.nodeType===3||d.nodeType===4){var f=d.data.replace(/[ \r\n\t]+/g," ");if((!s||/ $/.test(s.data))&&!a&&f[0]===" "&&(f=f.substr(1)),!f){d=Iv(d);continue}d.data=f,s=d}else if(d.nodeType===1)t(d)||d.nodeName==="BR"?(s&&(s.data=s.data.replace(/ $/,"")),s=null,a=!1):r(d)||i(d)?(s=null,a=!0):s&&(a=!1);else{d=Iv(d);continue}var h=Vb(c,d,i);c=d,d=h}s&&(s.data=s.data.replace(/ $/,""),s.data||Iv(s))}}function Iv(n){var e=n.nextSibling||n.parentNode;return n.parentNode.removeChild(n),e}function Vb(n,e,t){return n&&n.parentNode===e||t(e)?e.nextSibling||e.parentNode:e.firstChild||e.nextSibling||e.parentNode}var jC=typeof window<"u"?window:{};function t8(){var n=jC.DOMParser,e=!1;try{new n().parseFromString("","text/html")&&(e=!0)}catch{}return e}function n8(){var n=function(){};return r8()?n.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:n.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},n}function r8(){var n=!1;try{document.implementation.createHTMLDocument("").open()}catch{jC.ActiveXObject&&(n=!0)}return n}var i8=t8()?jC.DOMParser:n8();function s8(n,e){var t;if(typeof n=="string"){var r=o8().parseFromString('<x-turndown id="turndown-root">'+n+"</x-turndown>","text/html");t=r.getElementById("turndown-root")}else t=n.cloneNode(!0);return e8({element:t,isBlock:GC,isVoid:dE,isPre:e.preformattedCode?a8:null}),t}var bv;function o8(){return bv=bv||new i8,bv}function a8(n){return n.nodeName==="PRE"||n.nodeName==="CODE"}function c8(n,e){return n.isBlock=GC(n),n.isCode=n.nodeName==="CODE"||n.parentNode.isCode,n.isBlank=l8(n),n.flankingWhitespace=u8(n,e),n}function l8(n){return!dE(n)&&!JF(n)&&/^\s*$/i.test(n.textContent)&&!qF(n)&&!YF(n)}function u8(n,e){if(n.isBlock||e.preformattedCode&&n.isCode)return{leading:"",trailing:""};var t=d8(n.textContent);return t.leadingAscii&&jb("left",n,e)&&(t.leading=t.leadingNonAscii),t.trailingAscii&&jb("right",n,e)&&(t.trailing=t.trailingNonAscii),{leading:t.leading,trailing:t.trailing}}function d8(n){var e=n.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:e[1],leadingAscii:e[2],leadingNonAscii:e[3],trailing:e[4],trailingNonAscii:e[5],trailingAscii:e[6]}}function jb(n,e,t){var r,i,s;return n==="left"?(r=e.previousSibling,i=/ $/):(r=e.nextSibling,i=/^ /),r&&(r.nodeType===3?s=i.test(r.nodeValue):t.preformattedCode&&r.nodeName==="CODE"?s=!1:r.nodeType===1&&!GC(r)&&(s=i.test(r.textContent))),s}var f8=Array.prototype.reduce,h8=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function qp(n){if(!(this instanceof qp))return new qp(n);var e={rules:Fi,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(t,r){return r.isBlock?`

`:""},keepReplacement:function(t,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(t,r){return r.isBlock?`

`+t+`

`:t}};this.options=ZF({},e,n),this.rules=new pE(this.options)}qp.prototype={turndown:function(n){if(!m8(n))throw new TypeError(n+" is not a string, or an element/document/fragment node.");if(n==="")return"";var e=gE.call(this,new s8(n,this.options));return p8.call(this,e)},use:function(n){if(Array.isArray(n))for(var e=0;e<n.length;e++)this.use(n[e]);else if(typeof n=="function")n(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(n,e){return this.rules.add(n,e),this},keep:function(n){return this.rules.keep(n),this},remove:function(n){return this.rules.remove(n),this},escape:function(n){return h8.reduce(function(e,t){return e.replace(t[0],t[1])},n)}};function gE(n){var e=this;return f8.call(n.childNodes,function(t,r){r=new c8(r,e.options);var i="";return r.nodeType===3?i=r.isCode?r.nodeValue:e.escape(r.nodeValue):r.nodeType===1&&(i=g8.call(e,r)),mE(t,i)},"")}function p8(n){var e=this;return this.rules.forEach(function(t){typeof t.append=="function"&&(n=mE(n,t.append(e.options)))}),n.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function g8(n){var e=this.rules.forNode(n),t=gE.call(this,n),r=n.flankingWhitespace;return(r.leading||r.trailing)&&(t=t.trim()),r.leading+e.replacement(t,n,this.options)+r.trailing}function mE(n,e){var t=$F(n),r=XF(e),i=Math.max(n.length-t.length,e.length-r.length),s=`

`.substring(0,i);return t+s+r}function m8(n){return n!=null&&(typeof n=="string"||n.nodeType&&(n.nodeType===1||n.nodeType===9||n.nodeType===11))}const Wb=1,v8=2,vo=class vo extends un.Component{constructor(t){super(t);ae(this,"outputRef",un.createRef());ae(this,"messageKey",0);ae(this,"unsubscribePrefs");ae(this,"turndownService",new qp({headingStyle:"atx",emDelimiter:"*"}));ae(this,"handlePreferencesChange",()=>{this.setState({localEchoActive:ur.getState().general.localEcho})});ae(this,"saveOutput",()=>{const t=this.state.output.map(i=>{let s="";const a=i.content.props;if(a.dangerouslySetInnerHTML&&a.dangerouslySetInnerHTML.__html)s=a.dangerouslySetInnerHTML.__html;else if(a.children){const c=a.children;un.isValidElement(c)&&c.props.dangerouslySetInnerHTML&&c.props.dangerouslySetInnerHTML.__html?s=c.props.dangerouslySetInnerHTML.__html:un.isValidElement(c)||Array.isArray(c)&&c.every(d=>un.isValidElement(d)||typeof d=="string")?s=Db.renderToStaticMarkup(c):typeof c=="string"?s=c:(console.warn("Unexpected children structure in OutputLine for saving:",c),s="")}return{type:i.type,htmlContent:s}}).filter(i=>i.htmlContent!==""),r={version:Wb,lines:t};localStorage.setItem(vo.LOCAL_STORAGE_KEY,JSON.stringify(r))});ae(this,"loadOutput",()=>{const t=localStorage.getItem(vo.LOCAL_STORAGE_KEY);if(t)try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"version"in r&&"lines"in r){const i=r;return i.version===Wb?i.lines.map(s=>{const a=this.messageKey++;return{id:a,type:s.type,content:un.createElement("div",{key:a,className:`output-line output-line-${s.type}`,dangerouslySetInnerHTML:{__html:s.htmlContent}})}}):(console.warn(`Unsupported log version: ${i.version}. Discarding.`),localStorage.removeItem(vo.LOCAL_STORAGE_KEY),[])}else return Array.isArray(r)?(console.log("Loading old format output log."),r.map(s=>{const a=this.messageKey++;return{id:a,type:"serverMessage",content:un.createElement("div",{key:a,className:"output-line output-line-serverMessage",dangerouslySetInnerHTML:{__html:s}})}})):(console.error("Saved output log is in an unrecognized format:",r),localStorage.removeItem(vo.LOCAL_STORAGE_KEY),[])}catch(r){return console.error("Failed to parse saved output log:",r),localStorage.removeItem(vo.LOCAL_STORAGE_KEY),[]}return[]});ae(this,"addCommand",t=>{this.addToOutput([K.jsx("span",{className:"command","aria-live":"off",children:t})],"command",!1)});ae(this,"addError",t=>this.addToOutput([K.jsxs("h2",{children:[" Error: ",t.message]})],"errorMessage"));ae(this,"handleConnected",()=>this.addToOutput([K.jsx("h2",{children:" Connected"})],"systemInfo"));ae(this,"handleDisconnected",()=>{this.addToOutput([K.jsx("h2",{children:" Disconnected"})],"systemInfo"),this.setState({sidebarVisible:!1})});ae(this,"handleUserList",t=>this.setState({sidebarVisible:!!t}));ae(this,"addCopyButtons",()=>{const t=this.outputRef.current;if(!t)return;t.querySelectorAll("blockquote:not(:has(.blockquote-copy-button))").forEach(i=>{const s=document.createElement("button");s.classList.add("blockquote-copy-button"),s.textContent="Copy",s.setAttribute("type","button"),window.getComputedStyle(i).position==="static"&&(i.style.position="relative"),i.appendChild(s)})});ae(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});ae(this,"isScrolledToBottom",()=>{const t=this.outputRef.current;if(!t)return!1;const r=Math.ceil(t.scrollHeight-t.scrollTop),i=Math.ceil(t.clientHeight);return r<=i+v8});ae(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});ae(this,"scrollToBottom",()=>{const t=this.outputRef.current;t&&requestAnimationFrame(()=>{t.scrollTop=t.scrollHeight})});ae(this,"handleMessage",t=>{if(!t)return;const r=pF(t,this.handleExitClick);this.addToOutput(r,"serverMessage")});ae(this,"handleHtml",t=>{const r=HF.sanitize(t),i=K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i],"serverMessage")});ae(this,"handleExitClick",t=>{this.props.client.sendCommand(t)});ae(this,"handleDataTextClick",t=>{var a,c;const r=t.target,i=r.closest(".blockquote-copy-button");if(i instanceof HTMLButtonElement){t.preventDefault(),t.stopPropagation();const d=i.closest("blockquote");if(d){const f=d.cloneNode(!0),h=f.querySelector(".blockquote-copy-button");h&&h.remove();let v;if(d.dataset.contentType==="text/markdown"){const y=f.innerHTML;v=this.turndownService.turndown(y)}else v=f.textContent||"";navigator.clipboard.writeText(v.trim()).then(()=>{i.textContent="Copied!",i.classList.add("copied"),setTimeout(()=>{i.textContent="Copy",i.classList.remove("copied")},1500)}).catch(y=>{console.error("Failed to copy text: ",y),i.textContent="Error",setTimeout(()=>{i.textContent="Copy"},1500)})}return}const s=r.closest("a.command[data-text]");if(s instanceof HTMLAnchorElement){t.preventDefault();const d=s.dataset.text;d!=null&&(Xl(d),(c=(a=this.props).focusInput)==null||c.call(a))}});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0,localEchoActive:ur.getState().general.localEcho}}getSnapshotBeforeUpdate(t,r){return this.outputRef.current?(this.outputRef.current,this.isScrolledToBottom()):null}componentDidUpdate(t,r,i){i&&this.scrollToBottom();const s=this.state.output.slice(r.output.length);if(s.length>0){const a=s.filter(c=>this.state.localEchoActive||c.type!=="command").length;a>0&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState(c=>({newLinesCount:c.newLinesCount+a})))}this.saveOutput(),this.addCopyButtons()}componentDidMount(){const{client:t}=this.props;t.on("message",this.handleMessage),t.on("html",this.handleHtml),t.on("connect",this.handleConnected),t.on("disconnect",this.handleDisconnected),t.on("error",this.addError),t.on("command",this.addCommand),t.on("userlist",this.handleUserList),this.unsubscribePrefs=ur.subscribe(this.handlePreferencesChange)}componentWillUnmount(){const{client:t}=this.props;this.unsubscribePrefs&&this.unsubscribePrefs(),t.removeListener("message",this.handleMessage),t.removeListener("html",this.handleHtml),t.removeListener("connect",this.handleConnected),t.removeListener("disconnect",this.handleDisconnected),t.removeListener("error",this.addError),t.removeListener("command",this.addCommand),t.removeListener("userlist",this.handleUserList)}sanitizeHtml(t){return new DOMParser().parseFromString(t,"text/html").body.textContent||""}addToOutput(t,r,i=!0){i&&t.forEach(s=>{if(un.isValidElement(s)){const a=Db.renderToString(s),c=this.sanitizeHtml(a);kb(c)}else typeof s=="string"&&kb(s)}),this.setState(s=>{const a=t.map(f=>{const h=this.messageKey++;return{id:h,type:r,content:K.jsx("div",{className:`output-line output-line-${r}`,children:f},h)}});return{output:[...s.output,...a].slice(-vo.MAX_OUTPUT_LENGTH)}})}saveLog(){const t=this.outputRef.current;if(t){const r=t.innerHTML,i=new Blob([r],{type:"text/html"}),s=URL.createObjectURL(i),a=document.createElement("a"),c=new Date,d=c.toLocaleDateString(),f=c.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),v=`${document.title.replace(/\s+/g,"-")}-log-${d}-${f}.html`;a.download=v,a.href=s,a.click(),URL.revokeObjectURL(s),a.remove()}}clearLog(){this.setState({output:[]}),localStorage.removeItem(vo.LOCAL_STORAGE_KEY)}copyLog(){const t=this.outputRef.current;if(t){const r=t.innerText;navigator.clipboard.writeText(r).then(()=>{console.log("Log copied to clipboard.")}).catch(i=>{console.error("Failed to copy log: ",i),alert("Failed to copy log to clipboard. See console for details.")})}}render(){var t="output";this.state.sidebarVisible&&(t+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return K.jsxs("div",{ref:this.outputRef,className:t,onScroll:this.handleScroll,onClick:this.handleDataTextClick,children:[this.state.output.filter(i=>this.state.localEchoActive||i.type!=="command").map(i=>i.content),this.state.newLinesCount>0&&K.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};ae(vo,"MAX_OUTPUT_LENGTH",7500),ae(vo,"LOCAL_STORAGE_KEY","outputLog");let Sy=vo;const y8="12eb2fd14641e79ce5efa89d09937aefb50e8b54",Fs=()=>{const[,n]=F.useReducer(e=>e+1,0);return F.useEffect(()=>ur.subscribe(n),[]),[ur.getState(),ur.dispatch]},C8=()=>{const[n,e]=F.useState([]);return F.useEffect(()=>{const t=()=>{e(window.speechSynthesis.getVoices())};t(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=t)},[]),n},vE=({tabs:n})=>{const[e,t]=F.useState(0),r=F.useRef([]),i=F.useRef(!1);return F.useEffect(()=>{r.current=r.current.slice(0,n.length)},[n]),F.useEffect(()=>{const s=c=>{switch(c.key){case"ArrowLeft":i.current=!0,t(d=>d>0?d-1:n.length-1);break;case"ArrowRight":i.current=!0,t(d=>d<n.length-1?d+1:0);break;case"Home":i.current=!0,t(0);break;case"End":i.current=!0,t(n.length-1);break}},a=r.current[e];return a==null||a.addEventListener("keydown",s),()=>{a==null||a.removeEventListener("keydown",s)}},[n.length,e]),F.useEffect(()=>{var s;i.current&&((s=r.current[e])==null||s.focus())},[e]),K.jsxs("div",{className:"tabs-container",children:[K.jsx("div",{role:"tablist",children:n.map((s,a)=>K.jsx("button",{ref:c=>r.current[a]=c,role:"tab","aria-selected":e===a,id:s.id,"aria-controls":`${s.id}-panel`,onClick:()=>{console.log(`Tab onClick triggered for: ${s.label} (Index: ${a})`),i.current=!0,t(a),console.log(`Tab state updated to index: ${a}`)},tabIndex:e===a?void 0:-1,children:s.label},a))}),n.map((s,a)=>K.jsx("div",{role:"tabpanel",id:`${s.id}-panel`,"aria-labelledby":s.id,hidden:e!==a,children:K.jsx("div",{className:"sidebar-tab-content",children:s.content})},s.id))]})},x8=()=>{const[n,e]=Fs();return K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.general.localEcho,onChange:t=>e({type:to.SetGeneral,data:{...n.general,localEcho:t.target.checked}})}),"Local Echo"]})},w8=()=>{const[n,e]=Fs();return K.jsxs("label",{children:["Auto Read:",K.jsxs("select",{value:n.speech.autoreadMode,onChange:t=>e({type:to.SetSpeech,data:{...n.speech,autoreadMode:t.target.value}}),children:[K.jsx("option",{value:"off",children:"Off"}),K.jsx("option",{value:"unfocused",children:"Unfocused"}),K.jsx("option",{value:"all",children:"Always"})]})]})},I8=()=>{const[n,e]=Fs(),t=C8();return K.jsxs("label",{children:["Voice:",K.jsx("select",{value:n.speech.voice,onChange:r=>e({type:to.SetSpeech,data:{...n.speech,voice:r.target.value}}),children:t.map(r=>K.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},b8=()=>{const[n,e]=Fs();return K.jsxs("label",{children:["Rate (0.1 - 10.0):",K.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:n.speech.rate,onChange:t=>e({type:to.SetSpeech,data:{...n.speech,rate:parseFloat(t.target.value)}})})]})},S8=()=>{const[n,e]=Fs();return K.jsxs("label",{children:["Pitch (0 - 2):",K.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:n.speech.pitch,onChange:t=>e({type:to.SetSpeech,data:{...n.speech,pitch:parseFloat(t.target.value)}})})]})},A8=()=>{const[n,e]=Fs();return K.jsxs("label",{children:["Volume (0 - 1):",K.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:n.speech.volume,onChange:t=>e({type:to.SetSpeech,data:{...n.speech,volume:parseFloat(t.target.value)}})})]})},k8=()=>{const[n]=Fs(),[e,t]=F.useState(!1),r=un.useRef(!0);un.useEffect(()=>()=>{r.current=!1,speechSynthesis.cancel()},[]);const i=()=>{if(e)return;t(!0),console.log("Preview button clicked");const s=()=>{if(!r.current)return;const a=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),c=speechSynthesis.getVoices();console.log("Available voices:",c.map(f=>f.name));const d=c.find(f=>f.name===n.speech.voice);console.log("Selected voice:",d?d.name:"Not found"),a.voice=d||null,a.rate=n.speech.rate,a.pitch=n.speech.pitch,a.volume=n.speech.volume,console.log("Utterance settings:",{voice:a.voice?a.voice.name:"Default",rate:a.rate,pitch:a.pitch,volume:a.volume}),a.onend=()=>{r.current&&(console.log("Speech ended"),t(!1))},a.onerror=f=>{r.current&&(console.error("Speech synthesis error:",f),t(!1))},speechSynthesis.cancel(),speechSynthesis.speak(a),console.log("Speech started")};if(speechSynthesis.getVoices().length>0)s();else{let a=()=>{a&&(speechSynthesis.onvoiceschanged=null,a=null,r.current&&s())};speechSynthesis.onvoiceschanged=a;const c=()=>{a&&(speechSynthesis.onvoiceschanged=null,a=null)};un.useEffect(()=>c,[])}};return K.jsx("button",{onClick:i,disabled:e,children:e?"Playing...":"Preview Voice"})},E8=()=>K.jsxs("div",{children:[K.jsx(w8,{}),K.jsx("br",{}),K.jsx(I8,{}),K.jsx("br",{}),K.jsx(b8,{}),K.jsx("br",{}),K.jsx(S8,{}),K.jsx("br",{}),K.jsx(A8,{}),K.jsx("br",{}),K.jsx(k8,{})]}),T8=()=>{const[n,e]=Fs();return K.jsx("div",{children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.sound.muteInBackground,onChange:t=>e({type:to.SetSound,data:{...n.sound,muteInBackground:t.target.checked}})}),"Mute sounds when in background"]})})},_8=()=>{const[n,e]=Fs(),t=n.editor,r=s=>{e({type:to.SetEditorAutocompleteEnabled,data:s.target.checked})},i=s=>{e({type:to.SetEditorAccessibilityMode,data:s.target.checked})};return K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),K.jsx("br",{}),K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),K.jsx("br",{})]})},R8=()=>{const[n,e]=Fs(),t=r=>{e({type:to.SetMidi,data:{enabled:r.target.checked}})};return sn.isSupported?K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.midi.enabled,onChange:t}),"Enable MIDI"]}),K.jsx("br",{}),K.jsx("br",{}),n.midi.enabled&&K.jsx("p",{style:{color:"#666",fontSize:"0.9em"},children:"Device selection and management is available in the MIDI tab when connected to a server."})]}):K.jsxs("div",{children:[K.jsx("p",{children:"MIDI is not supported in this browser."}),K.jsx("p",{children:"MIDI support is available in Chrome, Edge, Opera, and Brave."})]})},D8=()=>{const n=[{label:"General",content:K.jsx(x8,{})},{label:"Speech",content:K.jsx(E8,{})},{label:"Sounds",content:K.jsx(T8,{})},{label:"Editor",content:K.jsx(_8,{})},{label:"MIDI",content:K.jsx(R8,{})}];return K.jsx(vE,{tabs:n})};function P8(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function Hf(){return Hf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Hf.apply(null,arguments)}var Ay="data-focus-lock",yE="data-focus-lock-disabled",N8="data-no-focus-lock",M8="data-autofocus-inside",B8="data-no-autofocus";function Sv(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function O8(n,e){var t=F.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var i=t.value;i!==r&&(t.value=r,t.callback(r,i))}}}})[0];return t.callback=e,t.facade}var F8=typeof window<"u"?F.useLayoutEffect:F.useEffect,zb=new WeakMap;function L8(n,e){var t=O8(null,function(r){return n.forEach(function(i){return Sv(i,r)})});return F8(function(){var r=zb.get(t);if(r){var i=new Set(r),s=new Set(n),a=t.current;i.forEach(function(c){s.has(c)||Sv(c,null)}),s.forEach(function(c){i.has(c)||Sv(c,a)})}zb.set(t,n)},[n]),t}var Av={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},ky=function(n,e){return ky=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},ky(n,e)};function _d(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ky(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ey=function(){return Ey=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ey.apply(this,arguments)};function U8(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(h){try{f(r.next(h))}catch(v){a(v)}}function d(h){try{f(r.throw(h))}catch(v){a(v)}}function f(h){h.done?s(h.value):i(h.value).then(c,d)}f((r=r.apply(n,e||[])).next())})}function CE(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(h){return d([f,h])}}function d(f){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,f[0]&&(t=0)),t;)try{if(r=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,i=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){t.label=f[1];break}if(f[0]===6&&t.label<s[1]){t.label=s[1],s=f;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(f);break}s[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(n,t)}catch(h){f=[6,h],i=0}finally{r=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function gd(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ty(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}function _y(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}function Qu(n){return this instanceof Qu?(this.v=n,this):new Qu(n)}function G8(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(y){return function(C){return Promise.resolve(C).then(y,v)}}function c(y,C){r[y]&&(i[y]=function(x){return new Promise(function(b,S){s.push([y,x,b,S])>1||d(y,x)})},C&&(i[y]=C(i[y])))}function d(y,C){try{f(r[y](C))}catch(x){m(s[0][3],x)}}function f(y){y.value instanceof Qu?Promise.resolve(y.value.v).then(h,v):m(s[0][2],y)}function h(y){d("next",y)}function v(y){d("throw",y)}function m(y,C){y(C),s.shift(),s.length&&d(s[0][0],s[0][1])}}function V8(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof gd=="function"?gd(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(a){return new Promise(function(c,d){a=n[s](a),i(c,d,a.done,a.value)})}}function i(s,a,c,d){Promise.resolve(d).then(function(f){s({value:f,done:c})},a)}}function xE(n){return n}function wE(n,e){e===void 0&&(e=xE);var t=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(s){var a=e(s,r);return t.push(a),function(){t=t.filter(function(c){return c!==a})}},assignSyncMedium:function(s){for(r=!0;t.length;){var a=t;t=[],a.forEach(s)}t={push:function(c){return s(c)},filter:function(){return t}}},assignMedium:function(s){r=!0;var a=[];if(t.length){var c=t;t=[],c.forEach(s),a=t}var d=function(){var h=a;a=[],h.forEach(s)},f=function(){return Promise.resolve().then(d)};f(),t={push:function(h){a.push(h),f()},filter:function(h){return a=a.filter(h),t}}}};return i}function WC(n,e){return e===void 0&&(e=xE),wE(n,e)}function j8(n){n===void 0&&(n={});var e=wE(null);return e.options=Ey({async:!0,ssr:!1},n),e}var IE=WC({},function(n){var e=n.target,t=n.currentTarget;return{target:e,currentTarget:t}}),bE=WC(),W8=WC(),z8=j8({async:!0,ssr:typeof document<"u"}),H8=F.createContext(void 0),Z8=[],zC=F.forwardRef(function(e,t){var r,i=F.useState(),s=i[0],a=i[1],c=F.useRef(),d=F.useRef(!1),f=F.useRef(null),h=F.useState({}),v=h[1],m=e.children,y=e.disabled,C=y===void 0?!1:y,x=e.noFocusGuards,b=x===void 0?!1:x,S=e.persistentFocus,A=S===void 0?!1:S,E=e.crossFrame,R=E===void 0?!0:E,N=e.autoFocus,V=N===void 0?!0:N;e.allowTextSelection;var M=e.group,j=e.className,J=e.whiteList,L=e.hasPositiveIndices,z=e.shards,Y=z===void 0?Z8:z,ie=e.as,pe=ie===void 0?"div":ie,xe=e.lockProps,Ae=xe===void 0?{}:xe,Le=e.sideCar,we=e.returnFocus,Se=we===void 0?!1:we,Ee=e.focusOptions,H=e.onActivation,ee=e.onDeactivation,ce=F.useState({}),Ce=ce[0],_e=F.useCallback(function(at){var zt=at.captureFocusRestore;if(!f.current){var jt,_t=(jt=document)==null?void 0:jt.activeElement;f.current=_t,_t!==document.body&&(f.current=zt(_t))}c.current&&H&&H(c.current),d.current=!0,v()},[H]),Ne=F.useCallback(function(){d.current=!1,ee&&ee(c.current),v()},[ee]),ft=F.useCallback(function(at){var zt=f.current;if(zt){var jt=(typeof zt=="function"?zt():zt)||document.body,_t=typeof Se=="function"?Se(jt):Se;if(_t){var Xt=typeof _t=="object"?_t:void 0;f.current=null,at?Promise.resolve().then(function(){return jt.focus(Xt)}):jt.focus(Xt)}}},[Se]),ve=F.useCallback(function(at){d.current&&IE.useMedium(at)},[]),ct=bE.useMedium,At=F.useCallback(function(at){c.current!==at&&(c.current=at,a(at))},[]),Wt=Hf((r={},r[yE]=C&&"disabled",r[Ay]=M,r),Ae),Nt=b!==!0,bt=Nt&&b!=="tail",Rt=L8([t,At]),st=F.useMemo(function(){return{observed:c,shards:Y,enabled:!C,active:d.current}},[C,d.current,Y,s]);return un.createElement(F.Fragment,null,Nt&&[un.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:C?-1:0,style:Av}),L?un.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:C?-1:1,style:Av}):null],!C&&un.createElement(Le,{id:Ce,sideCar:z8,observed:s,disabled:C,persistentFocus:A,crossFrame:R,autoFocus:V,whiteList:J,shards:Y,onActivation:_e,onDeactivation:Ne,returnFocus:ft,focusOptions:Ee,noFocusGuards:b}),un.createElement(pe,Hf({ref:Rt},Wt,{className:j,onBlur:ct,onFocus:ve}),un.createElement(H8.Provider,{value:st},m)),bt&&un.createElement("div",{"data-focus-guard":!0,tabIndex:C?-1:0,style:Av}))});zC.propTypes={};function Ry(n,e){return Ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Ry(n,e)}function X8(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Ry(n,e)}function Zf(n){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zf(n)}function $8(n,e){if(Zf(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Zf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function K8(n){var e=$8(n,"string");return Zf(e)=="symbol"?e:e+""}function q8(n,e,t){return(e=K8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J8(n,e){function t(r){return r.displayName||r.name||"Component"}return function(i){var s=[],a;function c(){a=n(s.map(function(f){return f.props})),e(a)}var d=function(f){X8(h,f);function h(){return f.apply(this,arguments)||this}h.peek=function(){return a};var v=h.prototype;return v.componentDidMount=function(){s.push(this),c()},v.componentDidUpdate=function(){c()},v.componentWillUnmount=function(){var y=s.indexOf(this);s.splice(y,1),c()},v.render=function(){return un.createElement(i,this.props)},h}(F.PureComponent);return q8(d,"displayName","SideEffect("+t(i)+")"),d}}var ka=function(n){for(var e=Array(n.length),t=0;t<n.length;++t)e[t]=n[t];return e},ou=function(n){return Array.isArray(n)?n:[n]},SE=function(n){return Array.isArray(n)?n[0]:n},Y8=function(n){if(n.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(n,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},AE=function(n){return n.parentNode&&n.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.parentNode.host:n.parentNode},kE=function(n){return n===document||n&&n.nodeType===Node.DOCUMENT_NODE},Q8=function(n){return n.hasAttribute("inert")},eL=function(n,e){return!n||kE(n)||!Y8(n)&&!Q8(n)&&e(AE(n))},EE=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=eL(e,EE.bind(void 0,n));return n.set(e,r),r},tL=function(n,e){return n&&!kE(n)?iL(n)?e(AE(n)):!1:!0},TE=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=tL(e,TE.bind(void 0,n));return n.set(e,r),r},_E=function(n){return n.dataset},nL=function(n){return n.tagName==="BUTTON"},RE=function(n){return n.tagName==="INPUT"},DE=function(n){return RE(n)&&n.type==="radio"},rL=function(n){return!((RE(n)||nL(n))&&(n.type==="hidden"||n.disabled))},iL=function(n){var e=n.getAttribute(B8);return![!0,"true",""].includes(e)},HC=function(n){var e;return!!(n&&(!((e=_E(n))===null||e===void 0)&&e.focusGuard))},Dy=function(n){return!HC(n)},sL=function(n){return!!n},oL=function(n,e){var t=Math.max(0,n.tabIndex),r=Math.max(0,e.tabIndex),i=t-r,s=n.index-e.index;if(i){if(!t)return 1;if(!r)return-1}return i||s},aL=function(n){return n.tabIndex<0&&!n.hasAttribute("tabindex")?0:n.tabIndex},ZC=function(n,e,t){return ka(n).map(function(r,i){var s=aL(r);return{node:r,index:i,tabIndex:t&&s===-1?(r.dataset||{}).focusGuard?0:-1:s}}).filter(function(r){return!e||r.tabIndex>=0}).sort(oL)},cL=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],XC=cL.join(","),lL="".concat(XC,", [data-focus-guard]"),PE=function(n,e){return ka((n.shadowRoot||n).children).reduce(function(t,r){return t.concat(r.matches(e?lL:XC)?[r]:[],PE(r))},[])},uL=function(n,e){var t;return n instanceof HTMLIFrameElement&&(!((t=n.contentDocument)===null||t===void 0)&&t.body)?md([n.contentDocument.body],e):[n]},md=function(n,e){return n.reduce(function(t,r){var i,s=PE(r,e),a=(i=[]).concat.apply(i,s.map(function(c){return uL(c,e)}));return t.concat(a,r.parentNode?ka(r.parentNode.querySelectorAll(XC)).filter(function(c){return c===r}):[])},[])},dL=function(n){var e=n.querySelectorAll("[".concat(M8,"]"));return ka(e).map(function(t){return md([t])}).reduce(function(t,r){return t.concat(r)},[])},$C=function(n,e){return ka(n).filter(function(t){return EE(e,t)}).filter(function(t){return rL(t)})},Hb=function(n,e){return e===void 0&&(e=new Map),ka(n).filter(function(t){return TE(e,t)})},KC=function(n,e,t){return ZC($C(md(n,t),e),!0,t)},Xf=function(n,e){return ZC($C(md(n),e),!1)},fL=function(n,e){return $C(dL(n),e)},eu=function(n,e){return n.shadowRoot?eu(n.shadowRoot,e):Object.getPrototypeOf(n).contains!==void 0&&Object.getPrototypeOf(n).contains.call(n,e)?!0:ka(n.children).some(function(t){var r;if(t instanceof HTMLIFrameElement){var i=(r=t.contentDocument)===null||r===void 0?void 0:r.body;return i?eu(i,e):!1}return eu(t,e)})},hL=function(n){for(var e=new Set,t=n.length,r=0;r<t;r+=1)for(var i=r+1;i<t;i+=1){var s=n[r].compareDocumentPosition(n[i]);(s&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(s&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return n.filter(function(a,c){return!e.has(c)})},NE=function(n){return n.parentNode?NE(n.parentNode):n},qC=function(n){var e=ou(n);return e.filter(Boolean).reduce(function(t,r){var i=r.getAttribute(Ay);return t.push.apply(t,i?hL(ka(NE(r).querySelectorAll("[".concat(Ay,'="').concat(i,'"]:not([').concat(yE,'="disabled"])')))):[r]),t},[])},pL=function(n){try{return n()}catch{return}},$f=function(n){if(n===void 0&&(n=document),!(!n||!n.activeElement)){var e=n.activeElement;return e.shadowRoot?$f(e.shadowRoot):e instanceof HTMLIFrameElement&&pL(function(){return e.contentWindow.document})?$f(e.contentWindow.document):e}},gL=function(n,e){return n===e},mL=function(n,e){return!!ka(n.querySelectorAll("iframe")).some(function(t){return gL(t,e)})},ME=function(n,e){return e===void 0&&(e=$f(SE(n).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:qC(n).some(function(t){return eu(t,e)||mL(t,e)})},vL=function(n){n===void 0&&(n=document);var e=$f(n);return e?ka(n.querySelectorAll("[".concat(N8,"]"))).some(function(t){return eu(t,e)}):!1},yL=function(n,e){return e.filter(DE).filter(function(t){return t.name===n.name}).filter(function(t){return t.checked})[0]||n},JC=function(n,e){return DE(n)&&n.name?yL(n,e):n},CL=function(n){var e=new Set;return n.forEach(function(t){return e.add(JC(t,n))}),n.filter(function(t){return e.has(t)})},Zb=function(n){return n[0]&&n.length>1?JC(n[0],n):n[0]},Xb=function(n,e){return n.indexOf(JC(e,n))},Py="NEW_FOCUS",xL=function(n,e,t,r,i){var s=n.length,a=n[0],c=n[s-1],d=HC(r);if(!(r&&n.indexOf(r)>=0)){var f=r!==void 0?t.indexOf(r):-1,h=i?t.indexOf(i):f,v=i?n.indexOf(i):-1;if(f===-1)return v!==-1?v:Py;if(v===-1)return Py;var m=f-h,y=t.indexOf(a),C=t.indexOf(c),x=CL(t),b=r!==void 0?x.indexOf(r):-1,S=i?x.indexOf(i):b,A=x.filter(function(j){return j.tabIndex>=0}),E=r!==void 0?A.indexOf(r):-1,R=i?A.indexOf(i):E,N=E>=0&&R>=0?R-E:S-b;if(!m&&v>=0||e.length===0)return v;var V=Xb(n,e[0]),M=Xb(n,e[e.length-1]);if(f<=y&&d&&Math.abs(m)>1)return M;if(f>=C&&d&&Math.abs(m)>1)return V;if(m&&Math.abs(N)>1)return v;if(f<=y)return M;if(f>C)return V;if(m)return Math.abs(m)>1?v:(s+v+m)%s}},wL=function(n){return function(e){var t,r=(t=_E(e))===null||t===void 0?void 0:t.autofocus;return e.autofocus||r!==void 0&&r!=="false"||n.indexOf(e)>=0}},$b=function(n,e,t){var r=n.map(function(s){var a=s.node;return a}),i=Hb(r.filter(wL(t)));return i&&i.length?Zb(i):Zb(Hb(e))},Ny=function(n,e){return e===void 0&&(e=[]),e.push(n),n.parentNode&&Ny(n.parentNode.host||n.parentNode,e),e},kv=function(n,e){for(var t=Ny(n),r=Ny(e),i=0;i<t.length;i+=1){var s=t[i];if(r.indexOf(s)>=0)return s}return!1},BE=function(n,e,t){var r=ou(n),i=ou(e),s=r[0],a=!1;return i.filter(Boolean).forEach(function(c){a=kv(a||c,c)||a,t.filter(Boolean).forEach(function(d){var f=kv(s,d);f&&(!a||eu(f,a)?a=f:a=kv(f,a))})}),a},Kb=function(n,e){return n.reduce(function(t,r){return t.concat(fL(r,e))},[])},IL=function(n,e){var t=new Map;return e.forEach(function(r){return t.set(r.node,r)}),n.map(function(r){return t.get(r)}).filter(sL)},bL=function(n,e){var t=$f(ou(n).length>0?document:SE(n).ownerDocument),r=qC(n).filter(Dy),i=BE(t||n,n,r),s=new Map,a=Xf(r,s),c=a.filter(function(C){var x=C.node;return Dy(x)});if(c[0]){var d=Xf([i],s).map(function(C){var x=C.node;return x}),f=IL(d,c),h=f.map(function(C){var x=C.node;return x}),v=f.filter(function(C){var x=C.tabIndex;return x>=0}).map(function(C){var x=C.node;return x}),m=xL(h,v,d,t,e);if(m===Py){var y=$b(a,v,Kb(r,s))||$b(a,h,Kb(r,s));if(y)return{node:y};console.warn("focus-lock: cannot find any node to move focus into");return}return m===void 0?m:f[m]}},SL=function(n){var e=qC(n).filter(Dy),t=BE(n,n,e),r=ZC(md([t],!0),!0,!0),i=md(e,!1);return r.map(function(s){var a=s.node,c=s.index;return{node:a,index:c,lockItem:i.indexOf(a)>=0,guard:HC(a)}})},YC=function(n,e){n&&("focus"in n&&n.focus(e),"contentWindow"in n&&n.contentWindow&&n.contentWindow.focus())},Ev=0,Tv=!1,OE=function(n,e,t){t===void 0&&(t={});var r=bL(n,e);if(!Tv&&r){if(Ev>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Tv=!0,setTimeout(function(){Tv=!1},1);return}Ev++,YC(r.node,t.focusOptions),Ev--}};function Cf(n){if(!n)return null;if(typeof WeakRef>"u")return function(){return n||null};var e=n?new WeakRef(n):null;return function(){return(e==null?void 0:e.deref())||null}}var AL=function(n){if(!n)return null;for(var e=[],t=n;t&&t!==document.body;)e.push({current:Cf(t),parent:Cf(t.parentElement),left:Cf(t.previousElementSibling),right:Cf(t.nextElementSibling)}),t=t.parentElement;return{element:Cf(n),stack:e,ownerDocument:n.ownerDocument}},kL=function(n){var e,t,r,i,s;if(n)for(var a=n.stack,c=n.ownerDocument,d=new Map,f=0,h=a;f<h.length;f++){var v=h[f],m=(e=v.parent)===null||e===void 0?void 0:e.call(v);if(m&&c.contains(m)){for(var y=(t=v.left)===null||t===void 0?void 0:t.call(v),C=v.current(),x=m.contains(C)?C:void 0,b=(r=v.right)===null||r===void 0?void 0:r.call(v),S=KC([m],d),A=(s=(i=x??(y==null?void 0:y.nextElementSibling))!==null&&i!==void 0?i:b)!==null&&s!==void 0?s:y;A;){for(var E=0,R=S;E<R.length;E++){var N=R[E];if(A!=null&&A.contains(N.node))return N.node}A=A.nextElementSibling}if(S.length)return S[0].node}}},FE=function(n){var e=AL(n);return function(){return kL(e)}},EL=function(n,e,t){if(!n||!e)return console.error("no element or scope given"),{};var r=ou(e);if(r.every(function(a){return!eu(a,n)}))return console.error("Active element is not contained in the scope"),{};var i=t?KC(r,new Map):Xf(r,new Map),s=i.findIndex(function(a){var c=a.node;return c===n});if(s!==-1)return{prev:i[s-1],next:i[s+1],first:i[0],last:i[i.length-1]}},TL=function(n,e){var t=e?KC(ou(n),new Map):Xf(ou(n),new Map);return{first:t[0],last:t[t.length-1]}},_L=function(n){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},n)},LE=function(n,e,t){e===void 0&&(e={});var r=_L(e),i=EL(n,r.scope,r.onlyTabbable);if(i){var s=t(i,r.cycle);s&&YC(s.node,r.focusOptions)}},RL=function(n,e){e===void 0&&(e={}),LE(n,e,function(t,r){var i=t.next,s=t.first;return i||r&&s})},DL=function(n,e){e===void 0&&(e={}),LE(n,e,function(t,r){var i=t.prev,s=t.last;return i||r&&s})},UE=function(n,e,t){var r,i=TL(n,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),s=i[t];s&&YC(s.node,e.focusOptions)},PL=function(n,e){e===void 0&&(e={}),UE(n,e,"first")},NL=function(n,e){e===void 0&&(e={}),UE(n,e,"last")};function QC(n){setTimeout(n,1)}var ML=function(e){return e&&"current"in e?e.current:e},GE=function(){return document&&document.activeElement===document.body},BL=function(){return GE()||vL()},ed=null,us=null,qb=function(){return null},td=null,Kf=!1,e1=!1,OL=function(){return!0},FL=function(e){return(ed.whiteList||OL)(e)},LL=function(e,t){td={observerNode:e,portaledElement:t}},UL=function(e){return td&&td.portaledElement===e};function Jb(n,e,t,r){var i=null,s=n;do{var a=r[s];if(a.guard)a.node.dataset.focusAutoGuard&&(i=a);else if(a.lockItem){if(s!==n)return;i=null}else break}while((s+=t)!==e);i&&(i.node.tabIndex=0)}var GL=function(e){return e?!!Kf:Kf==="meanwhile"},VL=function n(e,t,r){return t&&(t.host===e&&(!t.activeElement||r.contains(t.activeElement))||t.parentNode&&n(e,t.parentNode,r))},jL=function(e,t){return t.some(function(r){return VL(e,r,r)})},VE=function(e){return Xf(e,new Map)},WL=function(e){return!VE([e.parentNode]).some(function(t){return t.node===e})},Jp=function(){var e=!1;if(ed){var t=ed,r=t.observed,i=t.persistentFocus,s=t.autoFocus,a=t.shards,c=t.crossFrame,d=t.focusOptions,f=t.noFocusGuards,h=r||td&&td.portaledElement;if(GE()&&us&&us!==document.body&&(!document.body.contains(us)||WL(us))){var v=qb();v&&v.focus()}var m=document&&document.activeElement;if(h){var y=[h].concat(a.map(ML).filter(Boolean)),C=function(){if(!GL(c)||!f||!us||e1)return!1;var E=VE(y),R=E.findIndex(function(N){var V=N.node;return V===us});return R===0||R===E.length-1};if((!m||FL(m))&&(i||C()||!BL()||!us&&s)&&(h&&!(ME(y)||m&&jL(m,y)||UL(m))&&(document&&!us&&m&&!s?(m.blur&&m.blur(),document.body.focus()):(e=OE(y,us,{focusOptions:d}),td={})),us=document&&document.activeElement,us!==document.body&&(qb=FE(us)),Kf=!1),document&&m!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var x=document&&document.activeElement,b=SL(y),S=b.map(function(A){var E=A.node;return E}).indexOf(x);S>-1&&(b.filter(function(A){var E=A.guard,R=A.node;return E&&R.dataset.focusAutoGuard}).forEach(function(A){var E=A.node;return E.removeAttribute("tabIndex")}),Jb(S,b.length,1,b),Jb(S,-1,-1,b))}}}return e},jE=function(e){Jp()&&e&&(e.stopPropagation(),e.preventDefault())},t1=function(){return QC(Jp)},zL=function(e){var t=e.target,r=e.currentTarget;r.contains(t)||LL(r,t)},HL=function(){return null},WE=function(){e1=!0},zE=function(){e1=!1,Kf="just",QC(function(){Kf="meanwhile"})},ZL=function(){document.addEventListener("focusin",jE),document.addEventListener("focusout",t1),window.addEventListener("focus",WE),window.addEventListener("blur",zE)},XL=function(){document.removeEventListener("focusin",jE),document.removeEventListener("focusout",t1),window.removeEventListener("focus",WE),window.removeEventListener("blur",zE)};function $L(n){return n.filter(function(e){var t=e.disabled;return!t})}var HE={moveFocusInside:OE,focusInside:ME,focusNextElement:RL,focusPrevElement:DL,focusFirstElement:PL,focusLastElement:NL,captureFocusRestore:FE};function KL(n){var e=n.slice(-1)[0];e&&!ed&&ZL();var t=ed,r=t&&e&&e.id===t.id;ed=e,t&&!r&&(t.onDeactivation(),n.filter(function(i){var s=i.id;return s===t.id}).length||t.returnFocus(!e)),e?(us=null,(!r||t.observed!==e.observed)&&e.onActivation(HE),Jp(),QC(Jp)):(XL(),us=null)}IE.assignSyncMedium(zL);bE.assignMedium(t1);W8.assignMedium(function(n){return n(HE)});const qL=J8($L,KL)(HL);var ZE=F.forwardRef(function(e,t){return un.createElement(zC,Hf({sideCar:qL,ref:t},e))}),XE=zC.propTypes||{};XE.sideCar;P8(XE,["sideCar"]);ZE.propTypes={};const JL=un.forwardRef((n,e)=>{const[t,r]=F.useState(!1),i=F.useRef(null);return un.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),F.useEffect(()=>{var s;t&&((s=i.current)==null||s.focus())},[t]),F.useEffect(()=>{const s=a=>{a.key==="Escape"&&r(!1)};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[]),K.jsx(ZE,{disabled:!t,children:K.jsxs("dialog",{className:"preferences-dialog",open:t,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[K.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),t&&K.jsx(D8,{}),K.jsx("button",{onClick:()=>r(!1),children:"Close"}),K.jsx("br",{}),K.jsxs("span",{id:"commit-hash",children:["Version: ",y8]})]})})}),YL=({onFileChange:n,onRecipientChange:e,onSendFile:t,selectedFile:r,recipient:i})=>{const s=c=>{c.target.files&&c.target.files.length>0&&n(c.target.files[0])},a=c=>{e(c.target.value)};return K.jsxs("div",{className:"file-transfer-controls",children:[K.jsx("input",{type:"file",onChange:s}),K.jsx("input",{type:"text",placeholder:"Recipient",value:i,onChange:a}),K.jsx("button",{onClick:t,disabled:!r||!i,children:"Send File"})]})},QL=({progress:n})=>K.jsxs("div",{className:"progress-bar",children:[K.jsx("progress",{value:n,max:"100"}),K.jsxs("span",{children:[n.toFixed(2),"%"]})]}),e6=({offer:n,onAccept:e,onReject:t})=>K.jsxs("div",{className:"incoming-transfer",children:[K.jsxs("p",{children:["Incoming file: ",n.filename," from ",n.sender]}),K.jsx("button",{onClick:()=>e(n.sender,n.hash),children:"Accept"}),K.jsx("button",{onClick:()=>t(n.sender,n.hash),children:"Reject"})]}),t6=({history:n})=>K.jsxs("div",{className:"transfer-history","aria-live":"polite",children:[K.jsx("h4",{children:"Transfer History"}),K.jsx("ul",{children:n.map((e,t)=>K.jsx("li",{children:e},t))})]}),n6=({client:n,expanded:e})=>{const[t,r]=F.useState(null),[i,s]=F.useState(""),[a,c]=F.useState(0),[d,f]=F.useState(0),[h,v]=F.useState([]),[m,y]=F.useState([]),C=F.useCallback(z=>{y(Y=>[...Y,z].slice(-10))},[]),x=F.useCallback(z=>{const Y=z.sentBytes/z.totalBytes*100;c(Y)},[]),b=F.useCallback(z=>{const Y=z.receivedBytes/z.totalBytes*100;f(Y)},[]),S=F.useCallback(z=>{C(`File sent successfully: ${z.filename}`),c(0)},[C]),A=F.useCallback(z=>{C(`File received successfully: ${z.filename}`),f(0)},[C]),E=F.useCallback(z=>{C(`Error ${z.direction}ing file ${z.filename}: ${z.error}`),z.direction==="send"?c(0):f(0)},[C]),R=F.useCallback(z=>{C(`File transfer cancelled: ${z.filename} (${z.direction})`),z.direction==="send"?c(0):f(0)},[C]),N=F.useCallback(z=>{C(`File transfer rejected: ${z.filename} from ${z.sender}`)},[C]),V=F.useCallback(z=>{C(`File transfer accepted: ${z.filename} by ${z.sender}`)},[C]),M=F.useCallback(z=>{v(Y=>[...Y,z]),C(`Incoming file offer: ${z.filename} from ${z.sender}`)},[C]);F.useEffect(()=>(n.on("fileTransferOffer",M),n.on("fileTransferAccepted",V),n.fileTransferManager.on("fileSendProgress",x),n.fileTransferManager.on("fileReceiveProgress",b),n.on("fileTransferError",E),n.on("fileTransferCancelled",R),n.on("fileTransferRejected",N),n.on("fileSendComplete",S),n.fileTransferManager.on("fileReceiveComplete",A),()=>{n.off("fileTransferOffer",M),n.off("fileTransferAccepted",V),n.fileTransferManager.off("fileSendProgress",x),n.fileTransferManager.off("fileReceiveProgress",b),n.off("fileTransferError",E),n.off("fileTransferCancelled",R),n.off("fileTransferRejected",N),n.off("fileSendComplete",S),n.fileTransferManager.off("fileReceiveComplete",A)}),[n,M,V,x,b,E,R,N,S,A]);const j=()=>{t&&i&&n.sendFile(t,i).then(()=>{C(`Sending ${t.name} to ${i}`)}).catch(z=>{C(`Error sending file: ${z.message}`)})},J=(z,Y)=>{n.acceptTransfer(z,Y);const ie=h.find(pe=>pe.hash===Y);ie&&C(`Accepting file transfer: ${ie.filename} from ${z}`),v(pe=>pe.filter(xe=>xe.hash!==Y))},L=(z,Y)=>{n.rejectTransfer(z,Y);const ie=h.find(pe=>pe.hash===Y);ie&&C(`Rejected file transfer: ${ie.filename} from ${z}`),v(pe=>pe.filter(xe=>xe.hash!==Y))};return K.jsxs("div",{className:`file-transfer-ui ${e?"expanded":"collapsed"}`,children:[K.jsx("h3",{children:"File Transfer"}),K.jsx(YL,{onFileChange:r,onRecipientChange:s,onSendFile:j,selectedFile:t,recipient:i}),(a>0||d>0)&&K.jsx(QL,{progress:a>0?a:d}),h.map(z=>K.jsx(e6,{offer:z,onAccept:J,onReject:L},`${z.sender}-${z.filename}`)),K.jsx(t6,{history:m})]})};var Yb={};function r6(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}var i6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function s6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var $E={exports:{}};(function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(i6,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(x,b){var S=x[b];if(typeof S.bind=="function")return S.bind(x);try{return Function.prototype.bind.call(S,x)}catch{return function(){return Function.prototype.apply.apply(S,[x,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(x){return x==="debug"&&(x="log"),typeof console===t?!1:x==="trace"&&r?a:console[x]!==void 0?s(console,x):console.log!==void 0?s(console,"log"):e}function d(x,b){for(var S=0;S<i.length;S++){var A=i[S];this[A]=S<x?e:this.methodFactory(A,x,b)}this.log=this.debug}function f(x,b,S){return function(){typeof console!==t&&(d.call(this,b,S),this[x].apply(this,arguments))}}function h(x,b,S){return c(x)||f.apply(this,arguments)}function v(x,b,S){var A=this,E;b=b??"WARN";var R="loglevel";typeof x=="string"?R+=":"+x:typeof x=="symbol"&&(R=void 0);function N(J){var L=(i[J]||"silent").toUpperCase();if(!(typeof window===t||!R)){try{window.localStorage[R]=L;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+L+";"}catch{}}}function V(){var J;if(!(typeof window===t||!R)){try{J=window.localStorage[R]}catch{}if(typeof J===t)try{var L=window.document.cookie,z=L.indexOf(encodeURIComponent(R)+"=");z!==-1&&(J=/^([^;]+)/.exec(L.slice(z))[1])}catch{}return A.levels[J]===void 0&&(J=void 0),J}}function M(){if(!(typeof window===t||!R)){try{window.localStorage.removeItem(R);return}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}A.name=x,A.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},A.methodFactory=S||h,A.getLevel=function(){return E},A.setLevel=function(J,L){if(typeof J=="string"&&A.levels[J.toUpperCase()]!==void 0&&(J=A.levels[J.toUpperCase()]),typeof J=="number"&&J>=0&&J<=A.levels.SILENT){if(E=J,L!==!1&&N(J),d.call(A,J,x),typeof console===t&&J<A.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+J},A.setDefaultLevel=function(J){b=J,V()||A.setLevel(J,!1)},A.resetLevel=function(){A.setLevel(b,!1),M()},A.enableAll=function(J){A.setLevel(A.levels.TRACE,J)},A.disableAll=function(J){A.setLevel(A.levels.SILENT,J)};var j=V();j==null&&(j=b),A.setLevel(j,!1)}var m=new v,y={};m.getLogger=function(b){if(typeof b!="symbol"&&typeof b!="string"||b==="")throw new TypeError("You must supply a name when creating a logger.");var S=y[b];return S||(S=y[b]=new v(b,m.getLevel(),m.methodFactory)),S};var C=typeof window!==t?window.log:void 0;return m.noConflict=function(){return typeof window!==t&&window.log===m&&(window.log=C),m},m.getLoggers=function(){return y},m.default=m,m})})($E);var n1=$E.exports,My;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(My||(My={}));var wa;(function(n){n.Default="livekit",n.Room="livekit-room",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(wa||(wa={}));let kn=n1.getLogger("livekit");kn.setDefaultLevel(My.info);function Sc(n){const e=n1.getLogger(n);return e.setDefaultLevel(kn.getLevel()),e}n1.getLogger("lk-e2ee");function ps(n,e){if(!n)throw new Error(e)}const o6=34028234663852886e22,a6=-34028234663852886e22,c6=4294967295,l6=2147483647,u6=-2147483648;function Ip(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>l6||n<u6)throw new Error("invalid int 32: "+n)}function By(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>c6||n<0)throw new Error("invalid uint 32: "+n)}function KE(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>o6||n<a6))throw new Error("invalid float 32: "+n)}const qE=Symbol("@bufbuild/protobuf/enum-type");function d6(n){const e=n[qE];return ps(e,"missing enum type on enum object"),e}function JE(n,e,t,r){n[qE]=YE(e,t.map(i=>({no:i.no,name:i.name,localName:n[i.no]})))}function YE(n,e,t){const r=Object.create(null),i=Object.create(null),s=[];for(const a of e){const c=QE(a);s.push(c),r[a.name]=c,i[a.no]=c}return{typeName:n,values:s,findName(a){return r[a]},findNumber(a){return i[a]}}}function f6(n,e,t){const r={};for(const i of e){const s=QE(i);r[s.localName]=s.no,r[s.no]=s.localName}return JE(r,n,e),r}function QE(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class Pt{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),i=r.runtime.bin,s=i.makeReadOptions(t);return i.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,t){const r=this.getType(),i=r.runtime.json,s=i.makeReadOptions(t);return i.readMessage(r,e,s,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,i=r.makeWriteOptions(e),s=i.writerFactory();return r.writeMessage(this,s,i),s.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function h6(n,e,t,r){var i;const s=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),a={[s]:function(c){n.util.initFields(this),n.util.initPartial(c,this)}}[s];return Object.setPrototypeOf(a.prototype,new Pt),Object.assign(a,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(c,d){return new a().fromBinary(c,d)},fromJson(c,d){return new a().fromJson(c,d)},fromJsonString(c,d){return new a().fromJsonString(c,d)},equals(c,d){return n.util.equals(a,c,d)}}),a}function p6(n,e,t,r){return{syntax:n,json:e,bin:t,util:r,makeMessageType(i,s,a){return h6(this,i,s,a)},makeEnum:f6,makeEnumType:YE,getEnumType:d6}}var Ke;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(Ke||(Ke={}));var au;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(au||(au={}));function g6(){let n=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(n|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function _v(n,e,t){for(let s=0;s<28;s=s+7){const a=n>>>s,c=!(!(a>>>7)&&e==0),d=(c?a|128:a)&255;if(t.push(d),!c)return}const r=n>>>28&15|(e&7)<<4,i=e>>3!=0;if(t.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const a=e>>>s,c=!!(a>>>7),d=(c?a|128:a)&255;if(t.push(d),!c)return}t.push(e>>>31&1)}}const bp=4294967296;function Qb(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,i=0;function s(a,c){const d=Number(n.slice(a,c));i*=t,r=r*t+d,r>=bp&&(i=i+(r/bp|0),r=r%bp)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?tT(r,i):r1(r,i)}function m6(n,e){let t=r1(n,e);const r=t.hi&2147483648;r&&(t=tT(t.lo,t.hi));const i=eT(t.lo,t.hi);return r?"-"+i:i}function eT(n,e){if({lo:n,hi:e}=v6(n,e),e<=2097151)return String(bp*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,i=e>>16&65535;let s=t+r*6777216+i*6710656,a=r+i*8147497,c=i*2;const d=1e7;return s>=d&&(a+=Math.floor(s/d),s%=d),a>=d&&(c+=Math.floor(a/d),a%=d),c.toString()+eS(a)+eS(s)}function v6(n,e){return{lo:n>>>0,hi:e>>>0}}function r1(n,e){return{lo:n|0,hi:e|0}}function tT(n,e){return e=~e,n?n=~n+1:e+=1,r1(n,e)}const eS=n=>{const e=String(n);return"0000000".slice(e.length)+e};function tS(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function y6(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function C6(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof Yb!="object"||Yb.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),a=BigInt("0"),c=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(d){const f=typeof d=="bigint"?d:BigInt(d);if(f>s||f<i)throw new Error("int64 invalid: ".concat(d));return f},uParse(d){const f=typeof d=="bigint"?d:BigInt(d);if(f>c||f<a)throw new Error("uint64 invalid: ".concat(d));return f},enc(d){return n.setBigInt64(0,this.parse(d),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(d){return n.setBigInt64(0,this.uParse(d),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(d,f){return n.setInt32(0,d,!0),n.setInt32(4,f,!0),n.getBigInt64(0,!0)},uDec(d,f){return n.setInt32(0,d,!0),n.setInt32(4,f,!0),n.getBigUint64(0,!0)}}}const t=i=>ps(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>ps(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),t(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),t(i),Qb(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Qb(i)},dec(i,s){return m6(i,s)},uDec(i,s){return eT(i,s)}}}const xn=C6();var Dr;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Dr||(Dr={}));class x6{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(By(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ip(e),tS(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){KE(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){By(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){Ip(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return Ip(e),e=(e<<1^e>>31)>>>0,tS(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=xn.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=xn.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=xn.enc(e);return _v(t.lo,t.hi,this.buf),this}sint64(e){let t=xn.enc(e),r=t.hi>>31,i=t.lo<<1^r,s=(t.hi<<1|t.lo>>>31)^r;return _v(i,s,this.buf),this}uint64(e){let t=xn.uEnc(e);return _v(t.lo,t.hi,this.buf),this}}class w6{constructor(e,t){this.varint64=g6,this.uint32=y6,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e){let t=this.pos;switch(e){case Dr.Varint:for(;this.buf[this.pos++]&128;);break;case Dr.Bit64:this.pos+=4;case Dr.Bit32:this.pos+=4;break;case Dr.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Dr.StartGroup:let i;for(;(i=this.tag()[1])!==Dr.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return xn.dec(...this.varint64())}uint64(){return xn.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,xn.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return xn.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return xn.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function Oy(n,e){return e instanceof Pt||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}Ke.DOUBLE,Ke.FLOAT,Ke.INT64,Ke.UINT64,Ke.INT32,Ke.UINT32,Ke.BOOL,Ke.STRING,Ke.BYTES;function Qc(n,e,t){if(e===t)return!0;if(n==Ke.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case Ke.UINT64:case Ke.FIXED64:case Ke.INT64:case Ke.SFIXED64:case Ke.SINT64:return e==t}return!1}function Fy(n,e){switch(n){case Ke.BOOL:return!1;case Ke.UINT64:case Ke.FIXED64:case Ke.INT64:case Ke.SFIXED64:case Ke.SINT64:return e==0?xn.zero:"0";case Ke.DOUBLE:case Ke.FLOAT:return 0;case Ke.BYTES:return new Uint8Array(0);case Ke.STRING:return"";default:return 0}}function nT(n,e){const t=e===void 0;let r=Dr.Varint,i=e===0;switch(n){case Ke.STRING:i=t||!e.length,r=Dr.LengthDelimited;break;case Ke.BOOL:i=e===!1;break;case Ke.DOUBLE:r=Dr.Bit64;break;case Ke.FLOAT:r=Dr.Bit32;break;case Ke.INT64:i=t||e==0;break;case Ke.UINT64:i=t||e==0;break;case Ke.FIXED64:i=t||e==0,r=Dr.Bit64;break;case Ke.BYTES:i=t||!e.byteLength,r=Dr.LengthDelimited;break;case Ke.FIXED32:r=Dr.Bit32;break;case Ke.SFIXED32:r=Dr.Bit32;break;case Ke.SFIXED64:i=t||e==0,r=Dr.Bit64;break;case Ke.SINT64:i=t||e==0;break}const s=Ke[n].toLowerCase();return[r,s,t||i]}const Xu=Symbol("@bufbuild/protobuf/unknown-fields"),nS={readUnknownFields:!0,readerFactory:n=>new w6(n)},rS={writeUnknownFields:!0,writerFactory:()=>new x6};function I6(n){return n?Object.assign(Object.assign({},nS),n):nS}function b6(n){return n?Object.assign(Object.assign({},rS),n):rS}function S6(){return{makeReadOptions:I6,makeWriteOptions:b6,listUnknownFields(n){var e;return(e=n[Xu])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[Xu]},writeUnknownFields(n,e){const r=n[Xu];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(n,e,t,r){const i=n;Array.isArray(i[Xu])||(i[Xu]=[]),i[Xu].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r){const i=n.getType(),s=t===void 0?e.len:e.pos+t;for(;e.pos<s;){const[a,c]=e.tag(),d=i.fields.find(a);if(!d){const m=e.skip(c);r.readUnknownFields&&this.onUnknownField(n,a,c,m);continue}let f=n,h=d.repeated,v=d.localName;switch(d.oneof&&(f=f[d.oneof.localName],f.case!=v&&delete f.value,f.case=v,v="value"),d.kind){case"scalar":case"enum":const m=d.kind=="enum"?Ke.INT32:d.T;let y=Yp;if(d.kind=="scalar"&&d.L>0&&(y=k6),h){let S=f[v];if(c==Dr.LengthDelimited&&m!=Ke.STRING&&m!=Ke.BYTES){let A=e.uint32()+e.pos;for(;e.pos<A;)S.push(y(e,m))}else S.push(y(e,m))}else f[v]=y(e,m);break;case"message":const C=d.T;h?f[v].push(Sp(e,new C,r)):f[v]instanceof Pt?Sp(e,f[v],r):(f[v]=Sp(e,new C,r),C.fieldWrapper&&!d.oneof&&!d.repeated&&(f[v]=C.fieldWrapper.unwrapField(f[v])));break;case"map":let[x,b]=A6(d,e,r);f[v][x]=b;break}}}}}function Sp(n,e,t){return e.getType().runtime.bin.readMessage(e,n,n.uint32(),t),e}function A6(n,e,t){const r=e.uint32(),i=e.pos+r;let s,a;for(;e.pos<i;){let[c]=e.tag();switch(c){case 1:s=Yp(e,n.K);break;case 2:switch(n.V.kind){case"scalar":a=Yp(e,n.V.T);break;case"enum":a=e.int32();break;case"message":a=Sp(e,new n.V.T,t);break}break}}if(s===void 0){let c=Fy(n.K,au.BIGINT);s=n.K==Ke.BOOL?c.toString():c}if(typeof s!="string"&&typeof s!="number"&&(s=s.toString()),a===void 0)switch(n.V.kind){case"scalar":a=Fy(n.V.T,au.BIGINT);break;case"enum":a=0;break;case"message":a=new n.V.T;break}return[s,a]}function k6(n,e){const t=Yp(n,e);return typeof t=="bigint"?t.toString():t}function Yp(n,e){switch(e){case Ke.STRING:return n.string();case Ke.BOOL:return n.bool();case Ke.DOUBLE:return n.double();case Ke.FLOAT:return n.float();case Ke.INT32:return n.int32();case Ke.INT64:return n.int64();case Ke.UINT64:return n.uint64();case Ke.FIXED64:return n.fixed64();case Ke.BYTES:return n.bytes();case Ke.FIXED32:return n.fixed32();case Ke.SFIXED32:return n.sfixed32();case Ke.SFIXED64:return n.sfixed64();case Ke.SINT64:return n.sint64();case Ke.UINT32:return n.uint32();case Ke.SINT32:return n.sint32()}}function E6(n,e,t,r,i){n.tag(t.no,Dr.LengthDelimited),n.fork();let s=r;switch(t.K){case Ke.INT32:case Ke.FIXED32:case Ke.UINT32:case Ke.SFIXED32:case Ke.SINT32:s=Number.parseInt(r);break;case Ke.BOOL:ps(r=="true"||r=="false"),s=r=="true";break}switch(Bf(n,t.K,1,s,!0),t.V.kind){case"scalar":Bf(n,t.V.T,2,i,!0);break;case"enum":Bf(n,Ke.INT32,2,i,!0);break;case"message":Ly(n,e,t.V.T,2,i);break}n.join()}function Ly(n,e,t,r,i){if(i!==void 0){const s=Oy(t,i);n.tag(r,Dr.LengthDelimited).bytes(s.toBinary(e))}}function Bf(n,e,t,r,i){let[s,a,c]=nT(e,r);(!c||i)&&n.tag(t,s)[a](r)}function T6(n,e,t,r){if(!r.length)return;n.tag(t,Dr.LengthDelimited).fork();let[,i]=nT(e);for(let s=0;s<r.length;s++)n[i](r[s]);n.join()}function _6(){return Object.assign(Object.assign({},S6()),{writeMessage(n,e,t){const r=n.getType();for(const i of r.fields.byNumber()){let s,a=i.repeated,c=i.localName;if(i.oneof){const d=n[i.oneof.localName];if(d.case!==c)continue;s=d.value}else s=n[c];switch(i.kind){case"scalar":case"enum":let d=i.kind=="enum"?Ke.INT32:i.T;if(a)if(i.packed)T6(e,d,i.no,s);else for(const f of s)Bf(e,d,i.no,f,!0);else s!==void 0&&Bf(e,d,i.no,s,!!i.oneof||i.opt);break;case"message":if(a)for(const f of s)Ly(e,t,i.T,i.no,f);else Ly(e,t,i.T,i.no,s);break;case"map":for(const[f,h]of Object.entries(s))E6(e,t,i,f,h);break}}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e}})}let Xa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),wg=[];for(let n=0;n<Xa.length;n++)wg[Xa[n].charCodeAt(0)]=n;wg[45]=Xa.indexOf("+");wg[95]=Xa.indexOf("/");const rT={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,i=0,s,a=0;for(let c=0;c<n.length;c++){if(s=wg[n.charCodeAt(c)],s===void 0)switch(n[c]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:a=s,i=1;break;case 1:t[r++]=a<<2|(s&48)>>4,a=s,i=2;break;case 2:t[r++]=(a&15)<<4|(s&60)>>2,a=s,i=3;break;case 3:t[r++]=(a&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,i=0;for(let s=0;s<n.length;s++)switch(r=n[s],t){case 0:e+=Xa[r>>2],i=(r&3)<<4,t=1;break;case 1:e+=Xa[i|r>>4],i=(r&15)<<2,t=2;break;case 2:e+=Xa[i|r>>6],e+=Xa[r&63],t=0;break}return t&&(e+=Xa[i],e+="=",t==1&&(e+="=")),e}},iS={ignoreUnknownFields:!1},sS={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function R6(n){return n?Object.assign(Object.assign({},iS),n):iS}function D6(n){return n?Object.assign(Object.assign({},sS),n):sS}function P6(n){const e=n(N6,oS);return{makeReadOptions:R6,makeWriteOptions:D6,readMessage(t,r,i,s){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(this.debug(r)));s=s??new t;const a={};for(const[c,d]of Object.entries(r)){const f=t.fields.findJsonName(c);if(!f){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(c,'" is unknown'));continue}let h=f.localName,v=s;if(f.oneof){if(d===null&&f.kind=="scalar")continue;const m=a[f.oneof.localName];if(m)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(f.oneof.name,'" present: "').concat(m,'", "').concat(c,'"'));a[f.oneof.localName]=c,v=v[f.oneof.localName]={case:h},h="value"}if(f.repeated){if(d===null)continue;if(!Array.isArray(d))throw new Error("cannot decode field ".concat(t.typeName,".").concat(f.name," from JSON: ").concat(this.debug(d)));const m=v[h];for(const y of d){if(y===null)throw new Error("cannot decode field ".concat(t.typeName,".").concat(f.name," from JSON: ").concat(this.debug(y)));let C;switch(f.kind){case"message":C=f.T.fromJson(y,i);break;case"enum":if(C=Rv(f.T,y,i.ignoreUnknownFields),C===void 0)continue;break;case"scalar":try{C=xf(f.T,y,f.L)}catch(x){let b="cannot decode field ".concat(t.typeName,".").concat(f.name," from JSON: ").concat(this.debug(y));throw x instanceof Error&&x.message.length>0&&(b+=": ".concat(x.message)),new Error(b)}break}m.push(C)}}else if(f.kind=="map"){if(d===null)continue;if(Array.isArray(d)||typeof d!="object")throw new Error("cannot decode field ".concat(t.typeName,".").concat(f.name," from JSON: ").concat(this.debug(d)));const m=v[h];for(const[y,C]of Object.entries(d)){if(C===null)throw new Error("cannot decode field ".concat(t.typeName,".").concat(f.name," from JSON: map value null"));let x;switch(f.V.kind){case"message":x=f.V.T.fromJson(C,i);break;case"enum":if(x=Rv(f.V.T,C,i.ignoreUnknownFields),x===void 0)continue;break;case"scalar":try{x=xf(f.V.T,C,au.BIGINT)}catch(b){let S="cannot decode map value for field ".concat(t.typeName,".").concat(f.name," from JSON: ").concat(this.debug(d));throw b instanceof Error&&b.message.length>0&&(S+=": ".concat(b.message)),new Error(S)}break}try{m[xf(f.K,f.K==Ke.BOOL?y=="true"?!0:y=="false"?!1:y:y,au.BIGINT).toString()]=x}catch(b){let S="cannot decode map key for field ".concat(t.typeName,".").concat(f.name," from JSON: ").concat(this.debug(d));throw b instanceof Error&&b.message.length>0&&(S+=": ".concat(b.message)),new Error(S)}}}else switch(f.kind){case"message":const m=f.T;if(d===null&&m.typeName!="google.protobuf.Value"){if(f.oneof)throw new Error("cannot decode field ".concat(t.typeName,".").concat(f.name,' from JSON: null is invalid for oneof field "').concat(c,'"'));continue}v[h]instanceof Pt?v[h].fromJson(d,i):(v[h]=m.fromJson(d,i),m.fieldWrapper&&!f.oneof&&(v[h]=m.fieldWrapper.unwrapField(v[h])));break;case"enum":const y=Rv(f.T,d,i.ignoreUnknownFields);y!==void 0&&(v[h]=y);break;case"scalar":try{v[h]=xf(f.T,d,f.L)}catch(C){let x="cannot decode field ".concat(t.typeName,".").concat(f.name," from JSON: ").concat(this.debug(d));throw C instanceof Error&&C.message.length>0&&(x+=": ".concat(C.message)),new Error(x)}break}}return s},writeMessage(t,r){const i=t.getType(),s={};let a;try{for(const c of i.fields.byMember()){let d;if(c.kind=="oneof"){const f=t[c.localName];if(f.value===void 0)continue;if(a=c.findField(f.case),!a)throw"oneof case not found: "+f.case;d=e(a,f.value,r)}else a=c,d=e(a,t[a.localName],r);d!==void 0&&(s[r.useProtoFieldName?a.name:a.jsonName]=d)}}catch(c){const d=a?"cannot encode field ".concat(i.typeName,".").concat(a.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),f=c instanceof Error?c.message:String(c);throw new Error(d+(f.length>0?": ".concat(f):""))}return s},readScalar:xf,writeScalar:oS,debug:iT}}function iT(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function xf(n,e,t){switch(n){case Ke.DOUBLE:case Ke.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return n==Ke.FLOAT&&KE(r),r;case Ke.INT32:case Ke.FIXED32:case Ke.SFIXED32:case Ke.SINT32:case Ke.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return n==Ke.UINT32?By(i):Ip(i),i;case Ke.INT64:case Ke.SFIXED64:case Ke.SINT64:if(e===null)return xn.zero;if(typeof e!="number"&&typeof e!="string")break;const s=xn.parse(e);return t?s.toString():s;case Ke.FIXED64:case Ke.UINT64:if(e===null)return xn.zero;if(typeof e!="number"&&typeof e!="string")break;const a=xn.uParse(e);return t?a.toString():a;case Ke.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case Ke.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case Ke.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return rT.dec(e)}throw new Error}function Rv(n,e,t){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=n.findName(e);if(r||t)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(iT(e)))}function N6(n,e,t,r){var i;if(e===void 0)return e;if(e===0&&!t)return;if(r)return e;if(n.typeName=="google.protobuf.NullValue")return null;const s=n.findNumber(e);return(i=s==null?void 0:s.name)!==null&&i!==void 0?i:e}function oS(n,e,t){if(e!==void 0)switch(n){case Ke.INT32:case Ke.SFIXED32:case Ke.SINT32:case Ke.FIXED32:case Ke.UINT32:return ps(typeof e=="number"),e!=0||t?e:void 0;case Ke.FLOAT:case Ke.DOUBLE:return ps(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||t?e:void 0;case Ke.STRING:return ps(typeof e=="string"),e.length>0||t?e:void 0;case Ke.BOOL:return ps(typeof e=="boolean"),e||t?e:void 0;case Ke.UINT64:case Ke.FIXED64:case Ke.INT64:case Ke.SFIXED64:case Ke.SINT64:return ps(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),t||e!=0?e.toString(10):void 0;case Ke.BYTES:return ps(e instanceof Uint8Array),t||e.byteLength>0?rT.enc(e):void 0}}function M6(){return P6((n,e)=>function(r,i,s){if(r.kind=="map"){const a={};switch(r.V.kind){case"scalar":for(const[d,f]of Object.entries(i)){const h=e(r.V.T,f,!0);ps(h!==void 0),a[d.toString()]=h}break;case"message":for(const[d,f]of Object.entries(i))a[d.toString()]=f.toJson(s);break;case"enum":const c=r.V.T;for(const[d,f]of Object.entries(i)){ps(f===void 0||typeof f=="number");const h=n(c,f,!0,s.enumAsInteger);ps(h!==void 0),a[d.toString()]=h}break}return s.emitDefaultValues||Object.keys(a).length>0?a:void 0}else if(r.repeated){const a=[];switch(r.kind){case"scalar":for(let c=0;c<i.length;c++)a.push(e(r.T,i[c],!0));break;case"enum":for(let c=0;c<i.length;c++)a.push(n(r.T,i[c],!0,s.enumAsInteger));break;case"message":for(let c=0;c<i.length;c++)a.push(Oy(r.T,i[c]).toJson(s));break}return s.emitDefaultValues||a.length>0?a:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues);case"enum":return n(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues,s.enumAsInteger);case"message":return i!==void 0?Oy(r.T,i).toJson(s):void 0}})}function B6(){return{setEnumType:JE,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const i=r.localName,s=e,a=n;if(a[i]!==void 0)switch(r.kind){case"oneof":const c=a[i].case;if(c===void 0)continue;const d=r.findField(c);let f=a[i].value;d&&d.kind=="message"&&!(f instanceof d.T)?f=new d.T(f):d&&d.kind==="scalar"&&d.T===Ke.BYTES&&(f=wf(f)),s[i]={case:c,value:f};break;case"scalar":case"enum":let h=a[i];r.T===Ke.BYTES&&(h=r.repeated?h.map(wf):wf(h)),s[i]=h;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Ke.BYTES)for(const[y,C]of Object.entries(a[i]))s[i][y]=wf(C);else Object.assign(s[i],a[i]);break;case"message":const m=r.V.T;for(const y of Object.keys(a[i])){let C=a[i][y];m.fieldWrapper||(C=new m(C)),s[i][y]=C}break}break;case"message":const v=r.T;if(r.repeated)s[i]=a[i].map(m=>m instanceof v?m:new v(m));else if(a[i]!==void 0){const m=a[i];v.fieldWrapper?v.typeName==="google.protobuf.BytesValue"?s[i]=wf(m):s[i]=m:s[i]=m instanceof v?m:new v(m)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const i=e[r.localName],s=t[r.localName];if(r.repeated){if(i.length!==s.length)return!1;switch(r.kind){case"message":return i.every((a,c)=>r.T.equals(a,s[c]));case"scalar":return i.every((a,c)=>Qc(r.T,a,s[c]));case"enum":return i.every((a,c)=>Qc(Ke.INT32,a,s[c]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,s);case"enum":return Qc(Ke.INT32,i,s);case"scalar":return Qc(r.T,i,s);case"oneof":if(i.case!==s.case)return!1;const a=r.findField(i.case);if(a===void 0)return!0;switch(a.kind){case"message":return a.T.equals(i.value,s.value);case"enum":return Qc(Ke.INT32,i.value,s.value);case"scalar":return Qc(a.T,i.value,s.value)}throw new Error("oneof cannot contain ".concat(a.kind));case"map":const c=Object.keys(i).concat(Object.keys(s));switch(r.V.kind){case"message":const d=r.V.T;return c.every(h=>d.equals(i[h],s[h]));case"enum":return c.every(h=>Qc(Ke.INT32,i[h],s[h]));case"scalar":const f=r.V.T;return c.every(h=>Qc(f,i[h],s[h]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const i of e.fields.byMember()){const s=n[i.localName];let a;if(i.repeated)a=s.map(S0);else if(i.kind=="map"){a=r[i.localName];for(const[c,d]of Object.entries(s))a[c]=S0(d)}else i.kind=="oneof"?a=i.findField(s.case)?{case:s.case,value:S0(s.value)}:{case:void 0}:a=S0(s);r[i.localName]=a}return t}}}function S0(n){if(n===void 0)return n;if(n instanceof Pt)return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function wf(n){return n instanceof Uint8Array?n:new Uint8Array(n)}class O6{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function sT(n,e){const t=oT(n);return e?t:j6(V6(t))}function F6(n){return sT(n,!1)}const L6=oT;function oT(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let i=n.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),t.push(i);break}}return t.join("")}const U6=new Set(["constructor","toString","toJSON","valueOf"]),G6=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),aT=n=>"".concat(n,"$"),V6=n=>G6.has(n)?aT(n):n,j6=n=>U6.has(n)?aT(n):n;class W6{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=F6(e)}addField(e){ps(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}const ne=p6("proto3",M6(),_6(),Object.assign(Object.assign({},B6()),{newFieldList(n){return new O6(n,z6)},initFields(n){for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=Fy(e.T,e.L);break}}}}));function z6(n){var e,t,r,i;const s=[];let a;for(const c of typeof n=="function"?n():n){const d=c;if(d.localName=sT(c.name,c.oneof!==void 0),d.jsonName=(e=c.jsonName)!==null&&e!==void 0?e:L6(c.name),d.repeated=(t=c.repeated)!==null&&t!==void 0?t:!1,c.kind=="scalar"&&(d.L=(r=c.L)!==null&&r!==void 0?r:au.BIGINT),d.packed=(i=c.packed)!==null&&i!==void 0?i:c.kind=="enum"||c.kind=="scalar"&&c.T!=Ke.BYTES&&c.T!=Ke.STRING,c.oneof!==void 0){const f=typeof c.oneof=="string"?c.oneof:c.oneof.name;(!a||a.name!=f)&&(a=new W6(f)),d.oneof=a,a.addField(d)}s.push(d)}return s}class ai extends Pt{constructor(e){super(),this.seconds=xn.zero,this.nanos=0,ne.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(ne.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=xn.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return ai.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new ai({seconds:xn.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new ai().fromBinary(e,t)}static fromJson(e,t){return new ai().fromJson(e,t)}static fromJsonString(e,t){return new ai().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ai,e,t)}}ai.runtime=ne;ai.typeName="google.protobuf.Timestamp";ai.fields=ne.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var Uy;(function(n){n[n.DEFAULT_AC=0]="DEFAULT_AC",n[n.OPUS=1]="OPUS",n[n.AAC=2]="AAC"})(Uy||(Uy={}));ne.util.setEnumType(Uy,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var Gy;(function(n){n[n.DEFAULT_VC=0]="DEFAULT_VC",n[n.H264_BASELINE=1]="H264_BASELINE",n[n.H264_MAIN=2]="H264_MAIN",n[n.H264_HIGH=3]="H264_HIGH",n[n.VP8=4]="VP8"})(Gy||(Gy={}));ne.util.setEnumType(Gy,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var Vy;(function(n){n[n.IC_DEFAULT=0]="IC_DEFAULT",n[n.IC_JPEG=1]="IC_JPEG"})(Vy||(Vy={}));ne.util.setEnumType(Vy,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Ni;(function(n){n[n.AUDIO=0]="AUDIO",n[n.VIDEO=1]="VIDEO",n[n.DATA=2]="DATA"})(Ni||(Ni={}));ne.util.setEnumType(Ni,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Pr;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.CAMERA=1]="CAMERA",n[n.MICROPHONE=2]="MICROPHONE",n[n.SCREEN_SHARE=3]="SCREEN_SHARE",n[n.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Pr||(Pr={}));ne.util.setEnumType(Pr,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var Kr;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH",n[n.OFF=3]="OFF"})(Kr||(Kr={}));ne.util.setEnumType(Kr,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var qa;(function(n){n[n.POOR=0]="POOR",n[n.GOOD=1]="GOOD",n[n.EXCELLENT=2]="EXCELLENT",n[n.LOST=3]="LOST"})(qa||(qa={}));ne.util.setEnumType(qa,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Fo;(function(n){n[n.UNSET=0]="UNSET",n[n.DISABLED=1]="DISABLED",n[n.ENABLED=2]="ENABLED"})(Fo||(Fo={}));ne.util.setEnumType(Fo,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var Ic;(function(n){n[n.UNKNOWN_REASON=0]="UNKNOWN_REASON",n[n.CLIENT_INITIATED=1]="CLIENT_INITIATED",n[n.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",n[n.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",n[n.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",n[n.ROOM_DELETED=5]="ROOM_DELETED",n[n.STATE_MISMATCH=6]="STATE_MISMATCH",n[n.JOIN_FAILURE=7]="JOIN_FAILURE"})(Ic||(Ic={}));ne.util.setEnumType(Ic,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var za;(function(n){n[n.RR_UNKNOWN=0]="RR_UNKNOWN",n[n.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",n[n.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",n[n.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",n[n.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(za||(za={}));ne.util.setEnumType(za,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var qf;(function(n){n[n.SE_UNKNOWN=0]="SE_UNKNOWN",n[n.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",n[n.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(qf||(qf={}));ne.util.setEnumType(qf,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Rd=class Df extends Pt{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=xn.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,ne.util.initPartial(e,this)}static fromBinary(e,t){return new Df().fromBinary(e,t)}static fromJson(e,t){return new Df().fromJson(e,t)}static fromJsonString(e,t){return new Df().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Df,e,t)}};Rd.runtime=ne;Rd.typeName="livekit.Room";Rd.fields=ne.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:To,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class To extends Pt{constructor(e){super(),this.mime="",this.fmtpLine="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new To().fromBinary(e,t)}static fromJson(e,t){return new To().fromJson(e,t)}static fromJsonString(e,t){return new To().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(To,e,t)}}To.runtime=ne;To.typeName="livekit.Codec";To.fields=ne.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class cl extends Pt{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,ne.util.initPartial(e,this)}static fromBinary(e,t){return new cl().fromBinary(e,t)}static fromJson(e,t){return new cl().fromJson(e,t)}static fromJsonString(e,t){return new cl().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(cl,e,t)}}cl.runtime=ne;cl.typeName="livekit.PlayoutDelay";cl.fields=ne.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class Ja extends Pt{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,ne.util.initPartial(e,this)}static fromBinary(e,t){return new Ja().fromBinary(e,t)}static fromJson(e,t){return new Ja().fromJson(e,t)}static fromJsonString(e,t){return new Ja().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Ja,e,t)}}Ja.runtime=ne;Ja.typeName="livekit.ParticipantPermission";Ja.fields=ne.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:ne.getEnumType(Pr),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Ms extends Pt{constructor(e){super(),this.sid="",this.identity="",this.state=cu.JOINING,this.tracks=[],this.metadata="",this.joinedAt=xn.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,ne.util.initPartial(e,this)}static fromBinary(e,t){return new Ms().fromBinary(e,t)}static fromJson(e,t){return new Ms().fromJson(e,t)}static fromJsonString(e,t){return new Ms().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Ms,e,t)}}Ms.runtime=ne;Ms.typeName="livekit.ParticipantInfo";Ms.fields=ne.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ne.getEnumType(cu)},{no:4,name:"tracks",kind:"message",T:gs,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Ja},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var cu;(function(n){n[n.JOINING=0]="JOINING",n[n.JOINED=1]="JOINED",n[n.ACTIVE=2]="ACTIVE",n[n.DISCONNECTED=3]="DISCONNECTED"})(cu||(cu={}));ne.util.setEnumType(cu,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class ll extends Pt{constructor(e){super(),ne.util.initPartial(e,this)}static fromBinary(e,t){return new ll().fromBinary(e,t)}static fromJson(e,t){return new ll().fromJson(e,t)}static fromJsonString(e,t){return new ll().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ll,e,t)}}ll.runtime=ne;ll.typeName="livekit.Encryption";ll.fields=ne.util.newFieldList(()=>[]);var gi;(function(n){n[n.NONE=0]="NONE",n[n.GCM=1]="GCM",n[n.CUSTOM=2]="CUSTOM"})(gi||(gi={}));ne.util.setEnumType(gi,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Ya extends Pt{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new Ya().fromBinary(e,t)}static fromJson(e,t){return new Ya().fromJson(e,t)}static fromJsonString(e,t){return new Ya().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Ya,e,t)}}Ya.runtime=ne;Ya.typeName="livekit.SimulcastCodecInfo";Ya.fields=ne.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:$i,repeated:!0}]);class gs extends Pt{constructor(e){super(),this.sid="",this.type=Ni.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Pr.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=gi.NONE,this.stream="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new gs().fromBinary(e,t)}static fromJson(e,t){return new gs().fromJson(e,t)}static fromJsonString(e,t){return new gs().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(gs,e,t)}}gs.runtime=ne;gs.typeName="livekit.TrackInfo";gs.fields=ne.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:ne.getEnumType(Ni)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:ne.getEnumType(Pr)},{no:10,name:"layers",kind:"message",T:$i,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Ya,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:ne.getEnumType(gi)},{no:17,name:"stream",kind:"scalar",T:9}]);class $i extends Pt{constructor(e){super(),this.quality=Kr.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,ne.util.initPartial(e,this)}static fromBinary(e,t){return new $i().fromBinary(e,t)}static fromJson(e,t){return new $i().fromJson(e,t)}static fromJsonString(e,t){return new $i().fromJsonString(e,t)}static equals(e,t){return ne.util.equals($i,e,t)}}$i.runtime=ne;$i.typeName="livekit.VideoLayer";$i.fields=ne.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:ne.getEnumType(Kr)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class na extends Pt{constructor(e){super(),this.kind=Xr.RELIABLE,this.value={case:void 0},ne.util.initPartial(e,this)}static fromBinary(e,t){return new na().fromBinary(e,t)}static fromJson(e,t){return new na().fromJson(e,t)}static fromJsonString(e,t){return new na().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(na,e,t)}}na.runtime=ne;na.typeName="livekit.DataPacket";na.fields=ne.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:ne.getEnumType(Xr)},{no:2,name:"user",kind:"message",T:ia,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Qa,oneof:"value"}]);var Xr;(function(n){n[n.RELIABLE=0]="RELIABLE",n[n.LOSSY=1]="LOSSY"})(Xr||(Xr={}));ne.util.setEnumType(Xr,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Qa extends Pt{constructor(e){super(),this.speakers=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new Qa().fromBinary(e,t)}static fromJson(e,t){return new Qa().fromJson(e,t)}static fromJsonString(e,t){return new Qa().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Qa,e,t)}}Qa.runtime=ne;Qa.typeName="livekit.ActiveSpeakerUpdate";Qa.fields=ne.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:ra,repeated:!0}]);class ra extends Pt{constructor(e){super(),this.sid="",this.level=0,this.active=!1,ne.util.initPartial(e,this)}static fromBinary(e,t){return new ra().fromBinary(e,t)}static fromJson(e,t){return new ra().fromJson(e,t)}static fromJsonString(e,t){return new ra().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ra,e,t)}}ra.runtime=ne;ra.typeName="livekit.SpeakerInfo";ra.fields=ne.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class ia extends Pt{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new ia().fromBinary(e,t)}static fromJson(e,t){return new ia().fromJson(e,t)}static fromJsonString(e,t){return new ia().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ia,e,t)}}ia.runtime=ne;ia.typeName="livekit.UserPacket";ia.fields=ne.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class sa extends Pt{constructor(e){super(),this.participantSid="",this.trackSids=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new sa().fromBinary(e,t)}static fromJson(e,t){return new sa().fromJson(e,t)}static fromJsonString(e,t){return new sa().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(sa,e,t)}}sa.runtime=ne;sa.typeName="livekit.ParticipantTracks";sa.fields=ne.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class ec extends Pt{constructor(e){super(),this.edition=vd.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new ec().fromBinary(e,t)}static fromJson(e,t){return new ec().fromJson(e,t)}static fromJsonString(e,t){return new ec().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ec,e,t)}}ec.runtime=ne;ec.typeName="livekit.ServerInfo";ec.fields=ne.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:ne.getEnumType(vd)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var vd;(function(n){n[n.Standard=0]="Standard",n[n.Cloud=1]="Cloud"})(vd||(vd={}));ne.util.setEnumType(vd,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class tc extends Pt{constructor(e){super(),this.sdk=yd.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new tc().fromBinary(e,t)}static fromJson(e,t){return new tc().fromJson(e,t)}static fromJsonString(e,t){return new tc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(tc,e,t)}}tc.runtime=ne;tc.typeName="livekit.ClientInfo";tc.fields=ne.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:ne.getEnumType(yd)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var yd;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.JS=1]="JS",n[n.SWIFT=2]="SWIFT",n[n.ANDROID=3]="ANDROID",n[n.FLUTTER=4]="FLUTTER",n[n.GO=5]="GO",n[n.UNITY=6]="UNITY",n[n.REACT_NATIVE=7]="REACT_NATIVE",n[n.RUST=8]="RUST",n[n.PYTHON=9]="PYTHON",n[n.CPP=10]="CPP"})(yd||(yd={}));ne.util.setEnumType(yd,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class oa extends Pt{constructor(e){super(),this.resumeConnection=Fo.UNSET,this.forceRelay=Fo.UNSET,ne.util.initPartial(e,this)}static fromBinary(e,t){return new oa().fromBinary(e,t)}static fromJson(e,t){return new oa().fromJson(e,t)}static fromJsonString(e,t){return new oa().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(oa,e,t)}}oa.runtime=ne;oa.typeName="livekit.ClientConfiguration";oa.fields=ne.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:aa},{no:2,name:"screen",kind:"message",T:aa},{no:3,name:"resume_connection",kind:"enum",T:ne.getEnumType(Fo)},{no:4,name:"disabled_codecs",kind:"message",T:nc},{no:5,name:"force_relay",kind:"enum",T:ne.getEnumType(Fo)}]);class aa extends Pt{constructor(e){super(),this.hardwareEncoder=Fo.UNSET,ne.util.initPartial(e,this)}static fromBinary(e,t){return new aa().fromBinary(e,t)}static fromJson(e,t){return new aa().fromJson(e,t)}static fromJsonString(e,t){return new aa().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(aa,e,t)}}aa.runtime=ne;aa.typeName="livekit.VideoConfiguration";aa.fields=ne.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:ne.getEnumType(Fo)}]);class nc extends Pt{constructor(e){super(),this.codecs=[],this.publish=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new nc().fromBinary(e,t)}static fromJson(e,t){return new nc().fromJson(e,t)}static fromJsonString(e,t){return new nc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(nc,e,t)}}nc.runtime=ne;nc.typeName="livekit.DisabledCodecs";nc.fields=ne.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:To,repeated:!0},{no:2,name:"publish",kind:"message",T:To,repeated:!0}]);class ca extends Pt{constructor(e){super(),this.duration=0,this.startTimestamp=xn.zero,this.endTimestamp=xn.zero,this.rtpClockTicks=xn.zero,this.driftSamples=xn.zero,this.driftMs=0,this.clockRate=0,ne.util.initPartial(e,this)}static fromBinary(e,t){return new ca().fromBinary(e,t)}static fromJson(e,t){return new ca().fromJson(e,t)}static fromJsonString(e,t){return new ca().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ca,e,t)}}ca.runtime=ne;ca.typeName="livekit.RTPDrift";ca.fields=ne.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:ai},{no:2,name:"end_time",kind:"message",T:ai},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class ul extends Pt{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=xn.zero,this.headerBytes=xn.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=xn.zero,this.headerBytesDuplicate=xn.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=xn.zero,this.headerBytesPadding=xn.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,ne.util.initPartial(e,this)}static fromBinary(e,t){return new ul().fromBinary(e,t)}static fromJson(e,t){return new ul().fromJson(e,t)}static fromJsonString(e,t){return new ul().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ul,e,t)}}ul.runtime=ne;ul.typeName="livekit.RTPStats";ul.fields=ne.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:ai},{no:2,name:"end_time",kind:"message",T:ai},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:ai},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:ai},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:ai},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:ai},{no:44,name:"packet_drift",kind:"message",T:ca},{no:45,name:"report_drift",kind:"message",T:ca}]);class dl extends Pt{constructor(e){super(),this.unixMicro=xn.zero,this.ticks=0,ne.util.initPartial(e,this)}static fromBinary(e,t){return new dl().fromBinary(e,t)}static fromJson(e,t){return new dl().fromJson(e,t)}static fromJsonString(e,t){return new dl().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(dl,e,t)}}dl.runtime=ne;dl.typeName="livekit.TimedVersion";dl.fields=ne.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const If=7e3,H6=[0,300,2*2*300,3*3*300,4*4*300,If,If,If,If,If];class Z6{constructor(e){this._retryDelays=e!==void 0?[...e]:H6}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function Te(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(h){try{f(r.next(h))}catch(v){a(v)}}function d(h){try{f(r.throw(h))}catch(v){a(v)}}function f(h){h.done?s(h.value):i(h.value).then(c,d)}f((r=r.apply(n,[])).next())})}function aS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ku(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof aS=="function"?aS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(a){return new Promise(function(c,d){a=n[s](a),i(c,d,a.done,a.value)})}}function i(s,a,c,d){Promise.resolve(d).then(function(f){s({value:f,done:c})},a)}}var i1={exports:{}},nd=typeof Reflect=="object"?Reflect:null,cS=nd&&typeof nd.apply=="function"?nd.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},Ap;nd&&typeof nd.ownKeys=="function"?Ap=nd.ownKeys:Object.getOwnPropertySymbols?Ap=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ap=function(e){return Object.getOwnPropertyNames(e)};function X6(n){console&&console.warn&&console.warn(n)}var cT=Number.isNaN||function(e){return e!==e};function Zn(){Zn.init.call(this)}i1.exports=Zn;i1.exports.once=J6;Zn.EventEmitter=Zn;Zn.prototype._events=void 0;Zn.prototype._eventsCount=0;Zn.prototype._maxListeners=void 0;var lS=10;function Ig(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Zn,"defaultMaxListeners",{enumerable:!0,get:function(){return lS},set:function(n){if(typeof n!="number"||n<0||cT(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");lS=n}});Zn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Zn.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||cT(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function lT(n){return n._maxListeners===void 0?Zn.defaultMaxListeners:n._maxListeners}Zn.prototype.getMaxListeners=function(){return lT(this)};Zn.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var d=s[e];if(d===void 0)return!1;if(typeof d=="function")cS(d,this,t);else for(var f=d.length,h=pT(d,f),r=0;r<f;++r)cS(h[r],this,t);return!0};function uT(n,e,t,r){var i,s,a;if(Ig(t),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),s=n._events),a=s[e]),a===void 0)a=s[e]=t,++n._eventsCount;else if(typeof a=="function"?a=s[e]=r?[t,a]:[a,t]:r?a.unshift(t):a.push(t),i=lT(n),i>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=n,c.type=e,c.count=a.length,X6(c)}return n}Zn.prototype.addListener=function(e,t){return uT(this,e,t,!1)};Zn.prototype.on=Zn.prototype.addListener;Zn.prototype.prependListener=function(e,t){return uT(this,e,t,!0)};function $6(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function dT(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=$6.bind(r);return i.listener=t,r.wrapFn=i,i}Zn.prototype.once=function(e,t){return Ig(t),this.on(e,dT(this,e,t)),this};Zn.prototype.prependOnceListener=function(e,t){return Ig(t),this.prependListener(e,dT(this,e,t)),this};Zn.prototype.removeListener=function(e,t){var r,i,s,a,c;if(Ig(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(s=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){c=r[a].listener,s=a;break}if(s<0)return this;s===0?r.shift():K6(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};Zn.prototype.off=Zn.prototype.removeListener;Zn.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function fT(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?q6(i):pT(i,i.length)}Zn.prototype.listeners=function(e){return fT(this,e,!0)};Zn.prototype.rawListeners=function(e){return fT(this,e,!1)};Zn.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):hT.call(n,e)};Zn.prototype.listenerCount=hT;function hT(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Zn.prototype.eventNames=function(){return this._eventsCount>0?Ap(this._events):[]};function pT(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function K6(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function q6(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function J6(n,e){return new Promise(function(t,r){function i(a){n.removeListener(e,s),r(a)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}gT(n,e,s,{once:!0}),e!=="error"&&Y6(n,i,{once:!0})})}function Y6(n,e,t){typeof n.on=="function"&&gT(n,"error",e,t)}function gT(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(s){r.once&&n.removeEventListener(e,i),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var Ea=i1.exports;let mT=!0,vT=!0;function kp(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseInt(r[t],10)}function Cu(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(a,c){if(a!==e)return i.apply(this,arguments);const d=f=>{const h=t(f);h&&(c.handleEvent?c.handleEvent(h):c(h))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(c,d),i.apply(this,[a,d])};const s=r.removeEventListener;r.removeEventListener=function(a,c){if(a!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(c))return s.apply(this,arguments);const d=this._eventMap[e].get(c);return this._eventMap[e].delete(c),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,d])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function Q6(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(mT=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function e9(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(vT=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function yT(){if(typeof window=="object"){if(mT)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function s1(n,e){vT&&console.warn(n+" is deprecated, please use "+e+" instead.")}function t9(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.mozGetUserMedia)e.browser="firefox",e.version=kp(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=kp(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=kp(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function uS(n){return Object.prototype.toString.call(n)==="[object Object]"}function CT(n){return uS(n)?Object.keys(n).reduce(function(e,t){const r=uS(n[t]),i=r?CT(n[t]):n[t],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[t]:i})},{}):n}function jy(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?jy(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{jy(n,n.get(i),t)})}))}function dS(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return n.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&s.push(a)}),s.forEach(a=>{n.forEach(c=>{c.type===r&&c.trackId===a.id&&jy(n,c,i)})}),i}const fS=yT;function xT(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(c){if(typeof c!="object"||c.mandatory||c.optional)return c;const d={};return Object.keys(c).forEach(f=>{if(f==="require"||f==="advanced"||f==="mediaSource")return;const h=typeof c[f]=="object"?c[f]:{ideal:c[f]};h.exact!==void 0&&typeof h.exact=="number"&&(h.min=h.max=h.exact);const v=function(m,y){return m?m+y.charAt(0).toUpperCase()+y.slice(1):y==="deviceId"?"sourceId":y};if(h.ideal!==void 0){d.optional=d.optional||[];let m={};typeof h.ideal=="number"?(m[v("min",f)]=h.ideal,d.optional.push(m),m={},m[v("max",f)]=h.ideal,d.optional.push(m)):(m[v("",f)]=h.ideal,d.optional.push(m))}h.exact!==void 0&&typeof h.exact!="number"?(d.mandatory=d.mandatory||{},d.mandatory[v("",f)]=h.exact):["min","max"].forEach(m=>{h[m]!==void 0&&(d.mandatory=d.mandatory||{},d.mandatory[v(m,f)]=h[m])})}),c.advanced&&(d.optional=(d.optional||[]).concat(c.advanced)),d},i=function(c,d){if(e.version>=61)return d(c);if(c=JSON.parse(JSON.stringify(c)),c&&typeof c.audio=="object"){const f=function(h,v,m){v in h&&!(m in h)&&(h[m]=h[v],delete h[v])};c=JSON.parse(JSON.stringify(c)),f(c.audio,"autoGainControl","googAutoGainControl"),f(c.audio,"noiseSuppression","googNoiseSuppression"),c.audio=r(c.audio)}if(c&&typeof c.video=="object"){let f=c.video.facingMode;f=f&&(typeof f=="object"?f:{ideal:f});const h=e.version<66;if(f&&(f.exact==="user"||f.exact==="environment"||f.ideal==="user"||f.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!h)){delete c.video.facingMode;let v;if(f.exact==="environment"||f.ideal==="environment"?v=["back","rear"]:(f.exact==="user"||f.ideal==="user")&&(v=["front"]),v)return t.mediaDevices.enumerateDevices().then(m=>{m=m.filter(C=>C.kind==="videoinput");let y=m.find(C=>v.some(x=>C.label.toLowerCase().includes(x)));return!y&&m.length&&v.includes("back")&&(y=m[m.length-1]),y&&(c.video.deviceId=f.exact?{exact:y.deviceId}:{ideal:y.deviceId}),c.video=r(c.video),fS("chrome: "+JSON.stringify(c)),d(c)})}c.video=r(c.video)}return fS("chrome: "+JSON.stringify(c)),d(c)},s=function(c){return e.version>=64?c:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[c.name]||c.name,message:c.message,constraint:c.constraint||c.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(c,d,f){i(c,h=>{t.webkitGetUserMedia(h,d,v=>{f&&f(s(v))})})};if(t.getUserMedia=a.bind(t),t.mediaDevices.getUserMedia){const c=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(d){return i(d,f=>c(f).then(h=>{if(f.audio&&!h.getAudioTracks().length||f.video&&!h.getVideoTracks().length)throw h.getTracks().forEach(v=>{v.stop()}),new DOMException("","NotFoundError");return h},h=>Promise.reject(s(h))))}}}function n9(n,e){if(!(n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices)&&n.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}n.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const s=r.video&&r.video.width,a=r.video&&r.video.height,c=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:c||3}},s&&(r.video.mandatory.maxWidth=s),a&&(r.video.mandatory.maxHeight=a),n.navigator.mediaDevices.getUserMedia(r)})}}}function wT(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function IT(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(c=>c.track&&c.track.id===i.track.id):s={track:i.track};const a=new Event("track");a.track=i.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[r.stream],this.dispatchEvent(a)}),r.stream.getTracks().forEach(i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(c=>c.track&&c.track.id===i.id):s={track:i};const a=new Event("track");a.track=i,a.receiver=s,a.transceiver={receiver:s},a.streams=[r.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Cu(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function bT(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(c,d){let f=i.apply(this,arguments);return f||(f=e(this,c),this._senders.push(f)),f};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(c){s.apply(this,arguments);const d=this._senders.indexOf(c);d!==-1&&this._senders.splice(d,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],t.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(a=>{const c=this._senders.find(d=>d.track===a);c&&this._senders.splice(this._senders.indexOf(c),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ST(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[r,i,s]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const a=function(d){const f={};return d.result().forEach(v=>{const m={id:v.id,timestamp:v.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[v.type]||v.type};v.names().forEach(y=>{m[y]=v.stat(y)}),f[m.id]=m}),f},c=function(d){return new Map(Object.keys(d).map(f=>[f,d[f]]))};if(arguments.length>=2){const d=function(f){i(c(a(f)))};return e.apply(this,[d,r])}return new Promise((d,f)=>{e.apply(this,[function(h){d(c(a(h)))},f])}).then(i,s)}}function AT(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(a=>a._pc=this),s});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),n.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>dS(a,s.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(s=>s._pc=this),i}),Cu(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>dS(s,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,s,a;return this.getSenders().forEach(c=>{c.track===r&&(i?a=!0:i=c)}),this.getReceivers().forEach(c=>(c.track===r&&(s?a=!0:s=c),c.track===r)),a||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function kT(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const d=e.apply(this,arguments);return this._shimmedLocalStreams[c.id]?this._shimmedLocalStreams[c.id].indexOf(d)===-1&&this._shimmedLocalStreams[c.id].push(d):this._shimmedLocalStreams[c.id]=[c,d],d};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(f=>{if(this.getSenders().find(v=>v.track===f))throw new DOMException("Track already exists.","InvalidAccessError")});const c=this.getSenders();t.apply(this,arguments);const d=this.getSenders().filter(f=>c.indexOf(f)===-1);this._shimmedLocalStreams[a.id]=[a].concat(d)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(c=>{const d=this._shimmedLocalStreams[c].indexOf(a);d!==-1&&this._shimmedLocalStreams[c].splice(d,1),this._shimmedLocalStreams[c].length===1&&delete this._shimmedLocalStreams[c]}),i.apply(this,arguments)}}function ET(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return kT(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const h=t.apply(this);return this._reverseStreams=this._reverseStreams||{},h.map(v=>this._reverseStreams[v.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(h){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},h.getTracks().forEach(v=>{if(this.getSenders().find(y=>y.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[h.id]){const v=new n.MediaStream(h.getTracks());this._streams[h.id]=v,this._reverseStreams[v.id]=h,h=v}r.apply(this,[h])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(h){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[h.id]||h]),delete this._reverseStreams[this._streams[h.id]?this._streams[h.id].id:h.id],delete this._streams[h.id]},n.RTCPeerConnection.prototype.addTrack=function(h,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const m=[].slice.call(arguments,1);if(m.length!==1||!m[0].getTracks().find(x=>x===h))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(x=>x.track===h))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[v.id];if(C)C.addTrack(h),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const x=new n.MediaStream([h]);this._streams[v.id]=x,this._reverseStreams[x.id]=v,this.addStream(x)}return this.getSenders().find(x=>x.track===h)};function s(f,h){let v=h.sdp;return Object.keys(f._reverseStreams||[]).forEach(m=>{const y=f._reverseStreams[m],C=f._streams[y.id];v=v.replace(new RegExp(C.id,"g"),y.id)}),new RTCSessionDescription({type:h.type,sdp:v})}function a(f,h){let v=h.sdp;return Object.keys(f._reverseStreams||[]).forEach(m=>{const y=f._reverseStreams[m],C=f._streams[y.id];v=v.replace(new RegExp(y.id,"g"),C.id)}),new RTCSessionDescription({type:h.type,sdp:v})}["createOffer","createAnswer"].forEach(function(f){const h=n.RTCPeerConnection.prototype[f],v={[f](){const m=arguments;return arguments.length&&typeof arguments[0]=="function"?h.apply(this,[C=>{const x=s(this,C);m[0].apply(null,[x])},C=>{m[1]&&m[1].apply(null,C)},arguments[2]]):h.apply(this,arguments).then(C=>s(this,C))}};n.RTCPeerConnection.prototype[f]=v[f]});const c=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?c.apply(this,arguments):(arguments[0]=a(this,arguments[0]),c.apply(this,arguments))};const d=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const f=d.get.apply(this);return f.type===""?f:s(this,f)}}),n.RTCPeerConnection.prototype.removeTrack=function(h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!h._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(h._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let m;Object.keys(this._streams).forEach(y=>{this._streams[y].getTracks().find(x=>h.track===x)&&(m=this._streams[y])}),m&&(m.getTracks().length===1?this.removeStream(this._reverseStreams[m.id]):m.removeTrack(h.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Wy(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function TT(n,e){Cu(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}var hS=Object.freeze({__proto__:null,fixNegotiationNeeded:TT,shimAddTrackRemoveTrack:ET,shimAddTrackRemoveTrackWithNative:kT,shimGetDisplayMedia:n9,shimGetSendersWithDtmf:bT,shimGetStats:ST,shimGetUserMedia:xT,shimMediaStream:wT,shimOnTrack:IT,shimPeerConnection:Wy,shimSenderReceiverGetStats:AT});function _T(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,s,a){s1("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(s,a)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(a,c,d){c in a&&!(d in a)&&(a[d]=a[c],delete a[c])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a.audio,"autoGainControl","mozAutoGainControl"),i(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},r&&r.prototype.getSettings){const a=r.prototype.getSettings;r.prototype.getSettings=function(){const c=a.apply(this,arguments);return i(c,"mozAutoGainControl","autoGainControl"),i(c,"mozNoiseSuppression","noiseSuppression"),c}}if(r&&r.prototype.applyConstraints){const a=r.prototype.applyConstraints;r.prototype.applyConstraints=function(c){return this.kind==="audio"&&typeof c=="object"&&(c=JSON.parse(JSON.stringify(c)),i(c,"autoGainControl","mozAutoGainControl"),i(c,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[c])}}}}function r9(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function RT(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function zy(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=n.RTCPeerConnection.prototype[i],a={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=a[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[s,a,c]=arguments;return r.apply(this,[s||null]).then(d=>{if(e.version<53&&!a)try{d.forEach(f=>{f.type=t[f.type]||f.type})}catch(f){if(f.name!=="TypeError")throw f;d.forEach((h,v)=>{d.set(v,Object.assign({},h,{type:t[h.type]||h.type}))})}return d}).then(a,c)}}function DT(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function PT(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Cu(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function NT(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){s1("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function MT(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function BT(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:a}=s,c=a.getParameters();(!("encodings"in c)||c.encodings.length===1&&Object.keys(c.encodings[0]).length===0)&&(c.encodings=r,a.sendEncodings=r,this.setParametersPromises.push(a.setParameters(c).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function OT(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function FT(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function LT(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var pS=Object.freeze({__proto__:null,shimAddTransceiver:BT,shimCreateAnswer:LT,shimCreateOffer:FT,shimGetDisplayMedia:r9,shimGetParameters:OT,shimGetUserMedia:_T,shimOnTrack:RT,shimPeerConnection:zy,shimRTCDataChannel:MT,shimReceiverGetStats:PT,shimRemoveStream:NT,shimSenderGetStats:DT});function UT(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return s&&s.forEach(c=>{this._localStreams?this._localStreams.includes(c)||this._localStreams.push(c):this._localStreams=[c]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function GT(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,r.dispatchEvent(a)})}),e.apply(r,arguments)}}}function VT(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(f,h){const v=arguments.length>=2?arguments[2]:arguments[0],m=t.apply(this,[v]);return h?(m.then(f,h),Promise.resolve()):m},e.createAnswer=function(f,h){const v=arguments.length>=2?arguments[2]:arguments[0],m=r.apply(this,[v]);return h?(m.then(f,h),Promise.resolve()):m};let c=function(d,f,h){const v=i.apply(this,[d]);return h?(v.then(f,h),Promise.resolve()):v};e.setLocalDescription=c,c=function(d,f,h){const v=s.apply(this,[d]);return h?(v.then(f,h),Promise.resolve()):v},e.setRemoteDescription=c,c=function(d,f,h){const v=a.apply(this,[d]);return h?(v.then(f,h),Promise.resolve()):v},e.addIceCandidate=c}function jT(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(WT(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function WT(n){return n&&n.video!==void 0?Object.assign({},n,{video:CT(n.video)}):n}function zT(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let a=0;a<r.iceServers.length;a++){let c=r.iceServers[a];c.urls===void 0&&c.url?(s1("RTCIceServer.url","RTCIceServer.urls"),c=JSON.parse(JSON.stringify(c)),c.urls=c.url,delete c.url,s.push(c)):s.push(r.iceServers[a])}r.iceServers=s}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function HT(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ZT(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function XT(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var gS=Object.freeze({__proto__:null,shimAudioContext:XT,shimCallbacksAPI:VT,shimConstraints:WT,shimCreateOfferLegacy:ZT,shimGetUserMedia:jT,shimLocalStreamsAPI:UT,shimRTCIceServerUrls:zT,shimRemoteStreamsAPI:GT,shimTrackEventTransceiver:HT}),$T={exports:{}};(function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const s=t.type;return r.push("typ"),r.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const s=t.substring(t.indexOf(" ")+1).split(";");for(let a=0;a<s.length;a++)i=s[a].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(a=>{t.parameters[a]!==void 0?s.push(a+"="+t.parameters[a]):s.push(a)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},s=t.indexOf(":",r);return s>-1?(i.attribute=t.substring(r+1,s),i.value=t.substring(s+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(t)[0].split(" ");r.profile=s[2];for(let c=3;c<s.length;c++){const d=s[c],f=e.matchPrefix(t,"a=rtpmap:"+d+" ")[0];if(f){const h=e.parseRtpMap(f),v=e.matchPrefix(t,"a=fmtp:"+d+" ");switch(h.parameters=v.length?e.parseFmtp(v[0]):{},h.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+d+" ").map(e.parseRtcpFb),r.codecs.push(h),h.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(h.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(c=>{r.headerExtensions.push(e.parseExtmap(c))});const a=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(c=>{a.forEach(d=>{c.rtcpFeedback.find(h=>h.type===d.type&&h.parameter===d.parameter)||c.rtcpFeedback.push(d)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(a=>{i+=e.writeRtpMap(a),i+=e.writeFmtp(a),i+=e.writeRtcpFb(a)});let s=0;return r.codecs.forEach(a=>{a.maxptime>s&&(s=a.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(a=>{i+=e.writeExtmap(a)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),s=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,c=e.matchPrefix(t,"a=ssrc:").map(m=>e.parseSsrcMedia(m)).filter(m=>m.attribute==="cname"),d=c.length>0&&c[0].ssrc;let f;const h=e.matchPrefix(t,"a=ssrc-group:FID").map(m=>m.substring(17).split(" ").map(C=>parseInt(C,10)));h.length>0&&h[0].length>1&&h[0][0]===d&&(f=h[0][1]),i.codecs.forEach(m=>{if(m.name.toUpperCase()==="RTX"&&m.parameters.apt){let y={ssrc:d,codecPayloadType:parseInt(m.parameters.apt,10)};d&&f&&(y.rtx={ssrc:f}),r.push(y),s&&(y=JSON.parse(JSON.stringify(y)),y.fec={ssrc:d,mechanism:a?"red+ulpfec":"red"},r.push(y))}}),r.length===0&&d&&r.push({ssrc:d});let v=e.matchPrefix(t,"b=");return v.length&&(v[0].indexOf("b=TIAS:")===0?v=parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?v=parseInt(v[0].substring(5),10)*1e3*.95-50*40*8:v=void 0,r.forEach(m=>{m.maxBitrate=v})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(c=>e.parseSsrcMedia(c)).filter(c=>c.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const a=e.matchPrefix(t,"a=rtcp-mux");return r.mux=a.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const a=e.matchPrefix(t,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const c=e.matchPrefix(t,"a=sctpmap:");if(c.length>0){const d=c[0].substring(10).split(" ");return{port:parseInt(d[0],10),protocol:d[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let s;const a=r!==void 0?r:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e})($T);var KT=$T.exports,rd=s6(KT),i9=r6({__proto__:null,default:rd},[KT]);function Ep(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=rd.parseCandidate(r.candidate);for(const a in s)a in i||Object.defineProperty(i,a,{value:s[a]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,Cu(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Hy(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||Cu(n,"icecandidate",e=>{if(e.candidate){const t=rd.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Tp(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(c){if(!c||!c.sdp)return!1;const d=rd.splitSections(c.sdp);return d.shift(),d.some(f=>{const h=rd.parseMLine(f);return h&&h.kind==="application"&&h.protocol.indexOf("SCTP")!==-1})},r=function(c){const d=c.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(d===null||d.length<2)return-1;const f=parseInt(d[1],10);return f!==f?-1:f},i=function(c){let d=65536;return e.browser==="firefox"&&(e.version<57?c===-1?d=16384:d=2147483637:e.version<60?d=e.version===57?65535:65536:d=2147483637),d},s=function(c,d){let f=65536;e.browser==="firefox"&&e.version===57&&(f=65535);const h=rd.matchPrefix(c.sdp,"a=max-message-size:");return h.length>0?f=parseInt(h[0].substring(19),10):e.browser==="firefox"&&d!==-1&&(f=2147483637),f},a=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:d}=this.getConfiguration();d==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const d=r(arguments[0]),f=i(d),h=s(arguments[0],d);let v;f===0&&h===0?v=Number.POSITIVE_INFINITY:f===0||h===0?v=Math.max(f,h):v=Math.min(f,h);const m={};Object.defineProperty(m,"maxMessageSize",{get(){return v}}),this._sctp=m}return a.apply(this,arguments)}}function _p(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const c=arguments[0],d=c.length||c.size||c.byteLength;if(r.readyState==="open"&&i.sctp&&d>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},Cu(n,"datachannel",r=>(e(r.channel,r.target),r))}function Zy(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",i);s.dispatchEvent(a)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Xy(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return t.apply(this,arguments)}}function Rp(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Dp(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}var s9=Object.freeze({__proto__:null,removeExtmapAllowMixed:Xy,shimAddIceCandidateNullOrEmpty:Rp,shimConnectionState:Zy,shimMaxMessageSize:Tp,shimParameterlessSetLocalDescription:Dp,shimRTCIceCandidate:Ep,shimRTCIceCandidateRelayProtocol:Hy,shimSendThrowTypeError:_p});function o9(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=yT,r=t9(n),i={browserDetails:r,commonShim:s9,extractVersion:kp,disableLog:Q6,disableWarnings:e9,sdp:i9};switch(r.browser){case"chrome":if(!hS||!Wy||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=hS,Rp(n,r),Dp(n),xT(n,r),wT(n),Wy(n,r),IT(n),ET(n,r),bT(n),ST(n),AT(n),TT(n,r),Ep(n),Hy(n),Zy(n),Tp(n,r),_p(n),Xy(n,r);break;case"firefox":if(!pS||!zy||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=pS,Rp(n,r),Dp(n),_T(n,r),zy(n,r),RT(n),NT(n),DT(n),PT(n),MT(n),BT(n),OT(n),FT(n),LT(n),Ep(n),Zy(n),Tp(n,r),_p(n);break;case"safari":if(!gS||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=gS,Rp(n,r),Dp(n),zT(n),ZT(n),VT(n),UT(n),GT(n),HT(n),jT(n),XT(n),Ep(n),Hy(n),Tp(n,r),_p(n),Xy(n,r);break;default:t("Unsupported browser!");break}return i}o9({window:typeof window>"u"?void 0:window});const a9=10,A0="lk_e2ee",c9="LKFrameEncryptionKey",l9={sharedKey:!1,ratchetSalt:c9,ratchetWindowSize:8,failureTolerance:a9};var gl;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(gl||(gl={}));var mS;(function(n){n.KeyRatcheted="keyRatcheted"})(mS||(mS={}));var fl;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(fl||(fl={}));var vS;(function(n){n.Error="cryptorError"})(vS||(vS={}));function u9(){return d9()||$y()}function $y(){return typeof window.RTCRtpScriptTransform<"u"}function d9(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class iH extends Ea.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,r)=>{kn.debug("key ratcheted event received",{material:t,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},l9),e),this.on(gl.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,r){const i={key:e,participantIdentity:t,keyIndex:r};this.keyInfoMap.set("".concat(t??"shared","-").concat(r??0),i),this.emit(gl.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(gl.RatchetRequest,e,t)}}class Dd extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}class Qn extends Dd{constructor(e,t,r){super(1,e),this.status=r,this.reason=t}}class o1 extends Dd{constructor(e){super(21,e??"device is unsupported")}}class ea extends Dd{constructor(e){super(20,e??"track is invalid")}}class f9 extends Dd{constructor(e){super(10,e??"unsupported server")}}class Zr extends Dd{constructor(e){super(12,e??"unexpected connection state")}}class Ky extends Dd{constructor(e){super(13,e??"unable to negotiate")}}var Jf;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(Jf||(Jf={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(Jf||(Jf={}));var qe;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.StateChanged="connectionStateChanged",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged"})(qe||(qe={}));var rt;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded"})(rt||(rt={}));var Gt;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished"})(Gt||(Gt={}));var kt;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed"})(kt||(kt={}));function a1(n,e,t){var r,i,s;e===void 0&&(e=50),t===void 0&&(t={});var a=(r=t.isImmediate)!=null&&r,c=(i=t.callback)!=null&&i,d=t.maxWait,f=Date.now(),h=[];function v(){if(d!==void 0){var y=Date.now()-f;if(y+e>=d)return d-y}return e}var m=function(){var y=[].slice.call(arguments),C=this;return new Promise(function(x,b){var S=a&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,f=Date.now(),!a){var E=n.apply(C,y);c&&c(E),h.forEach(function(R){return(0,R.resolve)(E)}),h=[]}},v()),S){var A=n.apply(C,y);return c&&c(A),x(A)}h.push({resolve:x,reject:b})})};return m.cancel=function(y){s!==void 0&&clearTimeout(s),h.forEach(function(C){return(0,C.reject)(y)}),h=[]},m}const h9=/version\/(\d+(\.?_?\d+)+)/i;let Dv;function Ac(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(Dv===void 0||e){const r=p9.find(i=>{let{test:s}=i;return s.test(t)});Dv=r==null?void 0:r.describe(t)}return Dv}const p9=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:Pv(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:Pv(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:Pv(h9,n),os:n.includes("mobile/")?"iOS":"macOS"}}}];function Pv(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(n);return r&&r.length>=t&&r[t]||""}var g9="1.15.13";const m9=g9,v9=11;class mi{}mi.setTimeout=function(){return setTimeout(...arguments)};mi.setInterval=function(){return setInterval(...arguments)};mi.clearTimeout=function(){return clearTimeout(...arguments)};mi.clearInterval=function(){return clearInterval(...arguments)};class Hn{constructor(e,t,r,i,s){this.width=e,this.height=t,this.encoding={maxBitrate:r,maxFramerate:i,priority:s}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const y9=["vp8","h264"],qT=["vp8","h264","vp9","av1"];function C9(n){return!!y9.find(e=>e===n)}var Qp;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:2e4},n.music={maxBitrate:32e3},n.musicStereo={maxBitrate:48e3},n.musicHighQuality={maxBitrate:64e3},n.musicHighQualityStereo={maxBitrate:96e3}})(Qp||(Qp={}));const Yf={h90:new Hn(160,90,9e4,20),h180:new Hn(320,180,16e4,20),h216:new Hn(384,216,18e4,20),h360:new Hn(640,360,45e4,20),h540:new Hn(960,540,8e5,25),h720:new Hn(1280,720,17e5,30),h1080:new Hn(1920,1080,3e6,30),h1440:new Hn(2560,1440,5e6,30),h2160:new Hn(3840,2160,8e6,30)},qy={h120:new Hn(160,120,7e4,20),h180:new Hn(240,180,125e3,20),h240:new Hn(320,240,14e4,20),h360:new Hn(480,360,33e4,20),h480:new Hn(640,480,5e5,20),h540:new Hn(720,540,6e5,25),h720:new Hn(960,720,13e5,30),h1080:new Hn(1440,1080,23e5,30),h1440:new Hn(1920,1440,38e5,30)},c1={h360fps3:new Hn(640,360,2e5,3,"medium"),h360fps15:new Hn(640,360,4e5,15,"medium"),h720fps5:new Hn(1280,720,8e5,5,"medium"),h720fps15:new Hn(1280,720,15e5,15,"medium"),h720fps30:new Hn(1280,720,2e6,30,"medium"),h1080fps15:new Hn(1920,1080,25e5,15,"medium"),h1080fps30:new Hn(1920,1080,5e6,30,"medium"),original:new Hn(0,0,7e6,30,"medium")};var Mi;(function(n){n[n.PUBLISHER=0]="PUBLISHER",n[n.SUBSCRIBER=1]="SUBSCRIBER"})(Mi||(Mi={}));ne.util.setEnumType(Mi,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var lu;(function(n){n[n.ACTIVE=0]="ACTIVE",n[n.PAUSED=1]="PAUSED"})(lu||(lu={}));ne.util.setEnumType(lu,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var eg;(function(n){n[n.UDP=0]="UDP",n[n.TCP=1]="TCP",n[n.TLS=2]="TLS"})(eg||(eg={}));ne.util.setEnumType(eg,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class rc extends Pt{constructor(e){super(),this.message={case:void 0},ne.util.initPartial(e,this)}static fromBinary(e,t){return new rc().fromBinary(e,t)}static fromJson(e,t){return new rc().fromJson(e,t)}static fromJsonString(e,t){return new rc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(rc,e,t)}}rc.runtime=ne;rc.typeName="livekit.SignalRequest";rc.fields=ne.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:Ki,oneof:"message"},{no:2,name:"answer",kind:"message",T:Ki,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Do,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ro,oneof:"message"},{no:5,name:"mute",kind:"message",T:Po,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Qs,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:ua,oneof:"message"},{no:8,name:"leave",kind:"message",T:eo,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:da,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:ga,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:ma,oneof:"message"},{no:13,name:"simulate",kind:"message",T:pi,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:fa,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:ya,oneof:"message"}]);class la extends Pt{constructor(e){super(),this.message={case:void 0},ne.util.initPartial(e,this)}static fromBinary(e,t){return new la().fromBinary(e,t)}static fromJson(e,t){return new la().fromJson(e,t)}static fromJsonString(e,t){return new la().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(la,e,t)}}la.runtime=ne;la.typeName="livekit.SignalResponse";la.fields=ne.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:ic,oneof:"message"},{no:2,name:"answer",kind:"message",T:Ki,oneof:"message"},{no:3,name:"offer",kind:"message",T:Ki,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Do,oneof:"message"},{no:5,name:"update",kind:"message",T:ac,oneof:"message"},{no:6,name:"track_published",kind:"message",T:No,oneof:"message"},{no:8,name:"leave",kind:"message",T:eo,oneof:"message"},{no:9,name:"mute",kind:"message",T:Po,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:cc,oneof:"message"},{no:11,name:"room_update",kind:"message",T:lc,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:dc,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:hc,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:gc,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:mc,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:oc,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:sc,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:vc,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Cc,oneof:"message"}]);class _o extends Pt{constructor(e){super(),this.codec="",this.cid="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new _o().fromBinary(e,t)}static fromJson(e,t){return new _o().fromJson(e,t)}static fromJsonString(e,t){return new _o().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(_o,e,t)}}_o.runtime=ne;_o.typeName="livekit.SimulcastCodec";_o.fields=ne.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Ro extends Pt{constructor(e){super(),this.cid="",this.name="",this.type=Ni.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Pr.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=gi.NONE,this.stream="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new Ro().fromBinary(e,t)}static fromJson(e,t){return new Ro().fromJson(e,t)}static fromJsonString(e,t){return new Ro().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Ro,e,t)}}Ro.runtime=ne;Ro.typeName="livekit.AddTrackRequest";Ro.fields=ne.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:ne.getEnumType(Ni)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:ne.getEnumType(Pr)},{no:9,name:"layers",kind:"message",T:$i,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:_o,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:ne.getEnumType(gi)},{no:15,name:"stream",kind:"scalar",T:9}]);class Do extends Pt{constructor(e){super(),this.candidateInit="",this.target=Mi.PUBLISHER,ne.util.initPartial(e,this)}static fromBinary(e,t){return new Do().fromBinary(e,t)}static fromJson(e,t){return new Do().fromJson(e,t)}static fromJsonString(e,t){return new Do().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Do,e,t)}}Do.runtime=ne;Do.typeName="livekit.TrickleRequest";Do.fields=ne.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:ne.getEnumType(Mi)}]);class Po extends Pt{constructor(e){super(),this.sid="",this.muted=!1,ne.util.initPartial(e,this)}static fromBinary(e,t){return new Po().fromBinary(e,t)}static fromJson(e,t){return new Po().fromJson(e,t)}static fromJsonString(e,t){return new Po().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Po,e,t)}}Po.runtime=ne;Po.typeName="livekit.MuteTrackRequest";Po.fields=ne.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class ic extends Pt{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),ne.util.initPartial(e,this)}static fromBinary(e,t){return new ic().fromBinary(e,t)}static fromJson(e,t){return new ic().fromJson(e,t)}static fromJsonString(e,t){return new ic().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ic,e,t)}}ic.runtime=ne;ic.typeName="livekit.JoinResponse";ic.fields=ne.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Rd},{no:2,name:"participant",kind:"message",T:Ms},{no:3,name:"other_participants",kind:"message",T:Ms,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:ha,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:oa},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:ec},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class sc extends Pt{constructor(e){super(),this.iceServers=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new sc().fromBinary(e,t)}static fromJson(e,t){return new sc().fromJson(e,t)}static fromJsonString(e,t){return new sc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(sc,e,t)}}sc.runtime=ne;sc.typeName="livekit.ReconnectResponse";sc.fields=ne.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:ha,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:oa}]);class No extends Pt{constructor(e){super(),this.cid="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new No().fromBinary(e,t)}static fromJson(e,t){return new No().fromJson(e,t)}static fromJsonString(e,t){return new No().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(No,e,t)}}No.runtime=ne;No.typeName="livekit.TrackPublishedResponse";No.fields=ne.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:gs}]);class oc extends Pt{constructor(e){super(),this.trackSid="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new oc().fromBinary(e,t)}static fromJson(e,t){return new oc().fromJson(e,t)}static fromJsonString(e,t){return new oc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(oc,e,t)}}oc.runtime=ne;oc.typeName="livekit.TrackUnpublishedResponse";oc.fields=ne.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class Ki extends Pt{constructor(e){super(),this.type="",this.sdp="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new Ki().fromBinary(e,t)}static fromJson(e,t){return new Ki().fromJson(e,t)}static fromJsonString(e,t){return new Ki().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Ki,e,t)}}Ki.runtime=ne;Ki.typeName="livekit.SessionDescription";Ki.fields=ne.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class ac extends Pt{constructor(e){super(),this.participants=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new ac().fromBinary(e,t)}static fromJson(e,t){return new ac().fromJson(e,t)}static fromJsonString(e,t){return new ac().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ac,e,t)}}ac.runtime=ne;ac.typeName="livekit.ParticipantUpdate";ac.fields=ne.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Ms,repeated:!0}]);class Qs extends Pt{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new Qs().fromBinary(e,t)}static fromJson(e,t){return new Qs().fromJson(e,t)}static fromJsonString(e,t){return new Qs().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Qs,e,t)}}Qs.runtime=ne;Qs.typeName="livekit.UpdateSubscription";Qs.fields=ne.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:sa,repeated:!0}]);class ua extends Pt{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=Kr.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,ne.util.initPartial(e,this)}static fromBinary(e,t){return new ua().fromBinary(e,t)}static fromJson(e,t){return new ua().fromJson(e,t)}static fromJsonString(e,t){return new ua().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ua,e,t)}}ua.runtime=ne;ua.typeName="livekit.UpdateTrackSettings";ua.fields=ne.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:ne.getEnumType(Kr)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class eo extends Pt{constructor(e){super(),this.canReconnect=!1,this.reason=Ic.UNKNOWN_REASON,ne.util.initPartial(e,this)}static fromBinary(e,t){return new eo().fromBinary(e,t)}static fromJson(e,t){return new eo().fromJson(e,t)}static fromJsonString(e,t){return new eo().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(eo,e,t)}}eo.runtime=ne;eo.typeName="livekit.LeaveRequest";eo.fields=ne.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:ne.getEnumType(Ic)}]);class da extends Pt{constructor(e){super(),this.trackSid="",this.layers=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new da().fromBinary(e,t)}static fromJson(e,t){return new da().fromJson(e,t)}static fromJsonString(e,t){return new da().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(da,e,t)}}da.runtime=ne;da.typeName="livekit.UpdateVideoLayers";da.fields=ne.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:$i,repeated:!0}]);class fa extends Pt{constructor(e){super(),this.metadata="",this.name="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new fa().fromBinary(e,t)}static fromJson(e,t){return new fa().fromJson(e,t)}static fromJsonString(e,t){return new fa().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(fa,e,t)}}fa.runtime=ne;fa.typeName="livekit.UpdateParticipantMetadata";fa.fields=ne.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class ha extends Pt{constructor(e){super(),this.urls=[],this.username="",this.credential="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new ha().fromBinary(e,t)}static fromJson(e,t){return new ha().fromJson(e,t)}static fromJsonString(e,t){return new ha().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ha,e,t)}}ha.runtime=ne;ha.typeName="livekit.ICEServer";ha.fields=ne.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class cc extends Pt{constructor(e){super(),this.speakers=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new cc().fromBinary(e,t)}static fromJson(e,t){return new cc().fromJson(e,t)}static fromJsonString(e,t){return new cc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(cc,e,t)}}cc.runtime=ne;cc.typeName="livekit.SpeakersChanged";cc.fields=ne.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:ra,repeated:!0}]);class lc extends Pt{constructor(e){super(),ne.util.initPartial(e,this)}static fromBinary(e,t){return new lc().fromBinary(e,t)}static fromJson(e,t){return new lc().fromJson(e,t)}static fromJsonString(e,t){return new lc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(lc,e,t)}}lc.runtime=ne;lc.typeName="livekit.RoomUpdate";lc.fields=ne.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Rd}]);class uc extends Pt{constructor(e){super(),this.participantSid="",this.quality=qa.POOR,this.score=0,ne.util.initPartial(e,this)}static fromBinary(e,t){return new uc().fromBinary(e,t)}static fromJson(e,t){return new uc().fromJson(e,t)}static fromJsonString(e,t){return new uc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(uc,e,t)}}uc.runtime=ne;uc.typeName="livekit.ConnectionQualityInfo";uc.fields=ne.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:ne.getEnumType(qa)},{no:3,name:"score",kind:"scalar",T:2}]);class dc extends Pt{constructor(e){super(),this.updates=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new dc().fromBinary(e,t)}static fromJson(e,t){return new dc().fromJson(e,t)}static fromJsonString(e,t){return new dc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(dc,e,t)}}dc.runtime=ne;dc.typeName="livekit.ConnectionQualityUpdate";dc.fields=ne.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:uc,repeated:!0}]);class fc extends Pt{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=lu.ACTIVE,ne.util.initPartial(e,this)}static fromBinary(e,t){return new fc().fromBinary(e,t)}static fromJson(e,t){return new fc().fromJson(e,t)}static fromJsonString(e,t){return new fc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(fc,e,t)}}fc.runtime=ne;fc.typeName="livekit.StreamStateInfo";fc.fields=ne.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ne.getEnumType(lu)}]);class hc extends Pt{constructor(e){super(),this.streamStates=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new hc().fromBinary(e,t)}static fromJson(e,t){return new hc().fromJson(e,t)}static fromJsonString(e,t){return new hc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(hc,e,t)}}hc.runtime=ne;hc.typeName="livekit.StreamStateUpdate";hc.fields=ne.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:fc,repeated:!0}]);class Mo extends Pt{constructor(e){super(),this.quality=Kr.LOW,this.enabled=!1,ne.util.initPartial(e,this)}static fromBinary(e,t){return new Mo().fromBinary(e,t)}static fromJson(e,t){return new Mo().fromJson(e,t)}static fromJsonString(e,t){return new Mo().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Mo,e,t)}}Mo.runtime=ne;Mo.typeName="livekit.SubscribedQuality";Mo.fields=ne.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:ne.getEnumType(Kr)},{no:2,name:"enabled",kind:"scalar",T:8}]);class pc extends Pt{constructor(e){super(),this.codec="",this.qualities=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new pc().fromBinary(e,t)}static fromJson(e,t){return new pc().fromJson(e,t)}static fromJsonString(e,t){return new pc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(pc,e,t)}}pc.runtime=ne;pc.typeName="livekit.SubscribedCodec";pc.fields=ne.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Mo,repeated:!0}]);class gc extends Pt{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new gc().fromBinary(e,t)}static fromJson(e,t){return new gc().fromJson(e,t)}static fromJsonString(e,t){return new gc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(gc,e,t)}}gc.runtime=ne;gc.typeName="livekit.SubscribedQualityUpdate";gc.fields=ne.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Mo,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:pc,repeated:!0}]);class pa extends Pt{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",ne.util.initPartial(e,this)}static fromBinary(e,t){return new pa().fromBinary(e,t)}static fromJson(e,t){return new pa().fromJson(e,t)}static fromJsonString(e,t){return new pa().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(pa,e,t)}}pa.runtime=ne;pa.typeName="livekit.TrackPermission";pa.fields=ne.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class ga extends Pt{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new ga().fromBinary(e,t)}static fromJson(e,t){return new ga().fromJson(e,t)}static fromJsonString(e,t){return new ga().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ga,e,t)}}ga.runtime=ne;ga.typeName="livekit.SubscriptionPermission";ga.fields=ne.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:pa,repeated:!0}]);class mc extends Pt{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,ne.util.initPartial(e,this)}static fromBinary(e,t){return new mc().fromBinary(e,t)}static fromJson(e,t){return new mc().fromJson(e,t)}static fromJsonString(e,t){return new mc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(mc,e,t)}}mc.runtime=ne;mc.typeName="livekit.SubscriptionPermissionUpdate";mc.fields=ne.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class ma extends Pt{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new ma().fromBinary(e,t)}static fromJson(e,t){return new ma().fromJson(e,t)}static fromJsonString(e,t){return new ma().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ma,e,t)}}ma.runtime=ne;ma.typeName="livekit.SyncState";ma.fields=ne.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:Ki},{no:2,name:"subscription",kind:"message",T:Qs},{no:3,name:"publish_tracks",kind:"message",T:No,repeated:!0},{no:4,name:"data_channels",kind:"message",T:va,repeated:!0},{no:5,name:"offer",kind:"message",T:Ki}]);class va extends Pt{constructor(e){super(),this.label="",this.id=0,this.target=Mi.PUBLISHER,ne.util.initPartial(e,this)}static fromBinary(e,t){return new va().fromBinary(e,t)}static fromJson(e,t){return new va().fromJson(e,t)}static fromJsonString(e,t){return new va().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(va,e,t)}}va.runtime=ne;va.typeName="livekit.DataChannelInfo";va.fields=ne.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:ne.getEnumType(Mi)}]);class pi extends Pt{constructor(e){super(),this.scenario={case:void 0},ne.util.initPartial(e,this)}static fromBinary(e,t){return new pi().fromBinary(e,t)}static fromJson(e,t){return new pi().fromJson(e,t)}static fromJsonString(e,t){return new pi().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(pi,e,t)}}pi.runtime=ne;pi.typeName="livekit.SimulateScenario";pi.fields=ne.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:ne.getEnumType(eg),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class ya extends Pt{constructor(e){super(),this.timestamp=xn.zero,this.rtt=xn.zero,ne.util.initPartial(e,this)}static fromBinary(e,t){return new ya().fromBinary(e,t)}static fromJson(e,t){return new ya().fromJson(e,t)}static fromJsonString(e,t){return new ya().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ya,e,t)}}ya.runtime=ne;ya.typeName="livekit.Ping";ya.fields=ne.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class vc extends Pt{constructor(e){super(),this.lastPingTimestamp=xn.zero,this.timestamp=xn.zero,ne.util.initPartial(e,this)}static fromBinary(e,t){return new vc().fromBinary(e,t)}static fromJson(e,t){return new vc().fromJson(e,t)}static fromJsonString(e,t){return new vc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(vc,e,t)}}vc.runtime=ne;vc.typeName="livekit.Pong";vc.fields=ne.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class hl extends Pt{constructor(e){super(),this.regions=[],ne.util.initPartial(e,this)}static fromBinary(e,t){return new hl().fromBinary(e,t)}static fromJson(e,t){return new hl().fromJson(e,t)}static fromJsonString(e,t){return new hl().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(hl,e,t)}}hl.runtime=ne;hl.typeName="livekit.RegionSettings";hl.fields=ne.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:yc,repeated:!0}]);class yc extends Pt{constructor(e){super(),this.region="",this.url="",this.distance=xn.zero,ne.util.initPartial(e,this)}static fromBinary(e,t){return new yc().fromBinary(e,t)}static fromJson(e,t){return new yc().fromJson(e,t)}static fromJsonString(e,t){return new yc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(yc,e,t)}}yc.runtime=ne;yc.typeName="livekit.RegionInfo";yc.fields=ne.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class Cc extends Pt{constructor(e){super(),this.trackSid="",this.err=qf.SE_UNKNOWN,ne.util.initPartial(e,this)}static fromBinary(e,t){return new Cc().fromBinary(e,t)}static fromJson(e,t){return new Cc().fromJson(e,t)}static fromJsonString(e,t){return new Cc().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(Cc,e,t)}}Cc.runtime=ne;Cc.typeName="livekit.SubscriptionResponse";Cc.fields=ne.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:ne.getEnumType(qf)}]);function x9(n){if(!(typeof n>"u"))return typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}const w9=5e3,bf=[];class Xe extends Ea.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Xe.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=kn,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),w9):this.handleAppVisibilityChanged()},this.log=Sc((i=r.loggerName)!==null&&i!==void 0?i:wa.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Xe.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),lr(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===Xe.Kind.Video&&(t="video"),this.attachedElements.length===0&&Xe.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(bf.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&bf.splice(bf.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),Ju(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(i?kt.AudioPlaybackStarted:kt.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(i?kt.AudioPlaybackFailed:kt.VideoPlaybackFailed,s):s.name==="AbortError"?kn.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):kn.warn("could not playback ".concat(i?"audio":"video"),s),i&&e&&r.some(a=>a.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(kt.ElementAttached,e),e}detach(e){try{if(e){id(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(kt.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(r=>{id(this.mediaStreamTrack,r),t.push(r),this.recycleElement(r),this.emit(kt.ElementDetached,r)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=Sc(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),bf.forEach(r=>{r.parentElement||(t=!1)}),t&&bf.push(e)}}handleAppVisibilityChanged(){return Te(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){ms()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){ms()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Ju(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let r;n.kind==="audio"?r=t.getAudioTracks():r=t.getVideoTracks(),r.includes(n)||(r.forEach(i=>{t.removeTrack(i)}),t.addTrack(n)),(!uu()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(uu()||Cd())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function id(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(f){f.Audio="audio",f.Video="video",f.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(f){f.Camera="camera",f.Microphone="microphone",f.ScreenShare="screen_share",f.ScreenShareAudio="screen_share_audio",f.Unknown="unknown"})(t=n.Source||(n.Source={}));let r;(function(f){f.Active="active",f.Paused="paused",f.Unknown="unknown"})(r=n.StreamState||(n.StreamState={}));function i(f){switch(f){case e.Audio:return Ni.AUDIO;case e.Video:return Ni.VIDEO;default:return Ni.DATA}}n.kindToProto=i;function s(f){switch(f){case Ni.AUDIO:return e.Audio;case Ni.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=s;function a(f){switch(f){case t.Camera:return Pr.CAMERA;case t.Microphone:return Pr.MICROPHONE;case t.ScreenShare:return Pr.SCREEN_SHARE;case t.ScreenShareAudio:return Pr.SCREEN_SHARE_AUDIO;default:return Pr.UNKNOWN}}n.sourceToProto=a;function c(f){switch(f){case Pr.CAMERA:return t.Camera;case Pr.MICROPHONE:return t.Microphone;case Pr.SCREEN_SHARE:return t.ScreenShare;case Pr.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=c;function d(f){switch(f){case lu.ACTIVE:return r.Active;case lu.PAUSED:return r.Paused;default:return r.Unknown}}n.streamStateFromProto=d})(Xe||(Xe={}));function JT(n,e,t){var r;const i=(r=x9(n))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&Jy(i.audio,e),i.video&&Jy(i.video,t),i}function Jy(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function bg(n){const e={};if(n.video)if(typeof n.video=="object"){const t={},r=t,i=n.video;Object.keys(i).forEach(s=>{switch(s){case"resolution":Jy(r,i.resolution);break;default:r[s]=i[s]}}),e.video=t}else e.video=n.video;else e.video=!1;return n.audio?typeof n.audio=="object"?e.audio=n.audio:e.audio=!0:e.audio=!1,e}function I9(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return Te(this,void 0,void 0,function*(){const t=l1();if(t){const r=t.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,s=new Uint8Array(i);t.createMediaStreamSource(new MediaStream([n.mediaStreamTrack])).connect(r),yield bc(e),r.getByteTimeDomainData(s);const c=s.some(d=>d!==128&&d!==0);return t.close(),!c}return!1})}function l1(){const n=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(n)return new n({latencyHint:"interactive"})}function b9(n){return n===Xe.Source.Microphone?"audioinput":n===Xe.Source.Camera?"videoinput":void 0}function S9(n){var e,t;let r=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(r=typeof r=="boolean"?{}:r,uu()?r=Object.assign(Object.assign({},r),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:r,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio}}function YT(n){const e=n.split("/")[1].toLowerCase();if(!qT.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function A9(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new No({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function lr(n){return n instanceof Xe?{trackSid:n.sid,trackSource:n.source,trackMuted:n.isMuted,trackEnabled:n.mediaStreamTrack.enabled,trackKind:n.kind}:{trackSid:n.trackSid,trackName:n.trackName,track:n.track?lr(n.track):void 0,trackEnabled:n.isEnabled,trackEncrypted:n.isEncrypted,trackMimeType:n.mimeType}}const k9="|",yS="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function E9(n){const e=n.split(k9);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function bc(n){return Te(this,void 0,void 0,function*(){return new Promise(e=>mi.setTimeout(e,n))})}function CS(){return"addTransceiver"in RTCPeerConnection.prototype}function xS(){return"addTrack"in RTCPeerConnection.prototype}function T9(){if(!("getCapabilities"in RTCRtpSender)||uu())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/AV1"){e=!0;break}}return e}function _9(){if(!("getCapabilities"in RTCRtpSender)||Cd())return!1;if(uu()){const t=Ac();if(t!=null&&t.version&&u1(t.version,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/VP9"){e=!0;break}}return e}function Of(n){return n==="av1"||n==="vp9"}function Yy(n){return document?(n||(n=document.createElement("audio")),"setSinkId"in n):!1}const R9={Chrome:"100",Safari:"15",Firefox:"100"};function D9(n){if(!ms()||!("setCodecPreferences"in n))return!1;const e=Ac();if(!(e!=null&&e.name)||!e.version)return!1;const t=R9[e.name];return t?u1(e.version,t)>=0:!1}function Cd(){var n;return((n=Ac())===null||n===void 0?void 0:n.name)==="Firefox"}function P9(){var n;return((n=Ac())===null||n===void 0?void 0:n.name)==="Chrome"}function uu(){var n;return((n=Ac())===null||n===void 0?void 0:n.name)==="Safari"}function N9(){const n=Ac();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")}function QT(){return ms()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function ms(){return typeof document<"u"}function du(){return navigator.product=="ReactNative"}function Qy(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function e2(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function t2(){if(!du())return;let n=e2();if(n)return n.platform}function wS(){if(ms())return window.devicePixelRatio;if(du()){let n=e2();if(n)return n.devicePixelRatio}return 1}function u1(n,e){const t=n.split("."),r=e.split("."),i=Math.min(t.length,r.length);for(let s=0;s<i;++s){const a=parseInt(t[s],10),c=parseInt(r[s],10);if(a>c)return 1;if(a<c)return-1;if(s===i-1&&a===c)return 0}return n===""&&e!==""?-1:e===""?1:t.length==r.length?0:t.length<r.length?-1:1}function M9(n){for(const e of n)e.target.handleResize(e)}function B9(n){for(const e of n)e.target.handleVisibilityChanged(e)}let Nv=null;const IS=()=>(Nv||(Nv=new ResizeObserver(M9)),Nv);let Mv=null;const bS=()=>(Mv||(Mv=new IntersectionObserver(B9,{root:null,rootMargin:"0px"})),Mv);function O9(){var n;const e=new tc({sdk:yd.JS,protocol:v9,version:m9});return du()&&(e.os=(n=t2())!==null&&n!==void 0?n:""),e}function SS(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=n,i.height=e;const s=i.getContext("2d");s==null||s.fillRect(0,0,i.width,i.height),r&&s&&(s.beginPath(),s.arc(n/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const a=i.captureStream(),[c]=a.getTracks();if(!c)throw Error("Could not get empty media stream video track");return c.enabled=t,c}let Sf;function Bv(){if(!Sf){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const r=n.createMediaStreamDestination();if(e.connect(t),t.connect(r),e.start(),[Sf]=r.stream.getAudioTracks(),!Sf)throw Error("Could not get empty media stream audio track");Sf.enabled=!1}return Sf.clone()}class n2{constructor(e,t){this.onFinally=t,this.promise=new Promise((r,i)=>Te(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function F9(n,e){const t=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=l1();if(!r)throw new Error("Audio Context not supported on this browser");const i=t.cloneTrack?n.mediaStreamTrack.clone():n.mediaStreamTrack,s=r.createMediaStreamSource(new MediaStream([i])),a=r.createAnalyser();a.minDecibels=t.minDecibels,a.maxDecibels=t.maxDecibels,a.fftSize=t.fftSize,a.smoothingTimeConstant=t.smoothingTimeConstant,s.connect(a);const c=new Uint8Array(a.frequencyBinCount);return{calculateVolume:()=>{a.getByteFrequencyData(c);let h=0;for(const m of c)h+=Math.pow(m/255,2);return Math.sqrt(h/c.length)},analyser:a,cleanup:()=>Te(this,void 0,void 0,function*(){yield r.close(),t.cloneTrack&&i.stop()})}}class Bo{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),r}}function L9(n){return qT.includes(n)}function tu(n){if(typeof n=="string")return n;if(Array.isArray(n))return n[0];if(n.exact)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function U9(n){return n.startsWith("http")?n.replace(/^(http)/,"ws"):n}function AS(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}const kS="default";class Hi{static getInstance(){return this.instance===void 0&&(this.instance=new Hi),this.instance}getDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return Te(this,void 0,void 0,function*(){if(((r=Hi.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){kn.debug("awaiting getUserMedia promise");try{e?yield Hi.userMediaPromiseMap.get(e):yield Promise.all(Hi.userMediaPromiseMap.values())}catch{kn.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(t&&!(uu()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(a=>{const c=a.label==="",d=e?a.kind===e:!0;return c&&d}))){const a={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},c=yield navigator.mediaDevices.getUserMedia(a);i=yield navigator.mediaDevices.enumerateDevices(),c.getTracks().forEach(d=>{d.stop()})}return e&&(i=i.filter(s=>s.kind===e)),i})}normalizeDeviceId(e,t,r){return Te(this,void 0,void 0,function*(){if(t!==kS)return t;const s=(yield this.getDevices(e)).find(a=>a.groupId===r&&a.deviceId!==kS);return s==null?void 0:s.deviceId})}hasDeviceInUse(e){return e?Hi.userMediaPromiseMap.has(e):Hi.userMediaPromiseMap.size>0}}Hi.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Hi.userMediaPromiseMap=new Map;const G9=1e3;class xd extends Xe{get constraints(){return this._constraints}constructor(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(e,t,s),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=a1(()=>Te(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>Te(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(kt.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Bo,this.pauseUpstreamLock=new Bo,this.processorLock=new Bo,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Xe.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}setMediaStreamTrack(e,t){return Te(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{id(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");Ju(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{Ju(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G9;var t;return Te(this,void 0,void 0,function*(){if(this.kind===Xe.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((t=Ac())===null||t===void 0?void 0:t.os)==="iOS"&&(yield bc(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield bc(50)}throw new ea("unable to get track dimensions after timeout")})}getDeviceId(){return Te(this,void 0,void 0,function*(){if(this.source===Xe.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this._mediaStreamTrack.getSettings(),r=this.kind===Xe.Kind.Audio?"audioinput":"videoinput";return Hi.getInstance().normalizeDeviceId(r,e,t)})}mute(){return Te(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return Te(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Te(this,void 0,void 0,function*(){if(!this.sender)throw new ea("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=t,this.processor&&(yield this.stopProcessor()),this})}restart(e){return Te(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const t={audio:!1,video:!1};this.kind===Xe.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach(s=>{id(this.mediaStreamTrack,s)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(t)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(kt.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?kt.Muted:kt.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Te(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),QT()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return Te(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(kt.UpstreamPaused,this);const t=Ac();if((t==null?void 0:t.name)==="Safari"&&u1(t.version,"12.0")<0)throw new o1("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return Te(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(kt.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return Te(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return Te(this,void 0,void 0,function*(){const s=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),Ju(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(c=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:c})));const a={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(a),this.processor=e,this.processor.processedTrack){for(const c of this.attachedElements)c!==this.processorElement&&t&&(id(this._mediaStreamTrack,c),Ju(this.processor.processedTrack,c));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{s()}})}getProcessor(){return this.processor}stopProcessor(){var e,t;return Te(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(t=this.processorElement)===null||t===void 0||t.remove(),this.processorElement=void 0,yield this.restart())})}}class V9 extends Ea.EventEmitter{constructor(e){super(),this.onWorkerMessage=t=>{var r,i;const{kind:s,data:a}=t.data;switch(s){case"error":kn.error(a.error.message),this.emit(fl.EncryptionError,a.error);break;case"initAck":a.enabled&&this.keyProvider.getKeys().forEach(c=>{this.postKey(c)});break;case"enable":if(this.encryptionEnabled!==a.enabled&&a.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(fl.ParticipantEncryptionStatusChanged,a.enabled,this.room.localParticipant),this.encryptionEnabled=a.enabled;else if(a.participantIdentity){const c=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(a.participantIdentity);if(!c)throw TypeError("couldn't set encryption status, participant not found".concat(a.participantIdentity));this.emit(fl.ParticipantEncryptionStatusChanged,a.enabled,c)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(c=>{this.postKey(c)});break;case"ratchetKey":this.keyProvider.emit(gl.KeyRatcheted,a.material,a.keyIndex);break}},this.onWorkerError=t=>{kn.error("e2ee worker encountered an error:",{error:t.error}),this.emit(fl.EncryptionError,t.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!u9())throw new o1("tried to setup end-to-end encryption on an unsupported browser");if(kn.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(kn.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){kn.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?kn.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Gt.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(qe.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==gi.NONE,i.identity)),e.on(qe.ConnectionStateChanged,r=>{r===Mn.Connected&&e.participants.forEach(i=>{i.tracks.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==gi.NONE,i.identity)})})}).on(qe.TrackUnsubscribed,(r,i,s)=>{var a;const c={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(a=this.worker)===null||a===void 0||a.postMessage(c)}).on(qe.TrackSubscribed,(r,i,s)=>{this.setupE2EEReceiver(r,s.identity,i.trackInfo)}).on(qe.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),t.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(rt.LocalTrackPublished,r=>Te(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),t.on(gl.SetKey,r=>this.postKey(r)).on(gl.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(r)}postKey(e){let{key:t,participantIdentity:r,keyIndex:i}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const a={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(a)}postEnable(e,t){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?YT(r.mimeType):void 0)}}setupE2EESender(e,t){if(!(e instanceof xd)||!t){t||kn.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,r,i){return Te(this,void 0,void 0,function*(){if(this.worker){if($y()){const s={kind:"decode",participantIdentity:r,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(A0 in e&&i){const d={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:r}};this.worker.postMessage(d);return}let s=e.writableStream,a=e.readableStream;if(!s||!a){const d=e.createEncodedStreams();e.writableStream=d.writable,s=d.writable,e.readableStream=d.readable,a=d.readable}const c={kind:"decode",data:{readableStream:a,writableStream:s,trackId:t,codec:i,participantIdentity:r}};this.worker.postMessage(c,[a,s])}e[A0]=!0}})}handleSender(e,t,r){var i;if(!(A0 in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if($y()){kn.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{kn.info("initialize encoded streams");const s=e.createEncodedStreams(),a={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(a,[s.readable,s.writable])}e[A0]=!0}}}var Ff;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(Ff||(Ff={}));class j9{constructor(){this.pendingTasks=new Map,this.taskMutex=new Bo,this.nextTaskIndex=0}run(e){return Te(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Ff.WAITING};this.pendingTasks.set(t.id,t);const r=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=Ff.RUNNING,yield e()}finally{t.status=Ff.COMPLETED,this.pendingTasks.delete(t.id),r()}})}flush(){return Te(this,void 0,void 0,function*(){return this.run(()=>Te(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const W9=["syncState","trickle","offer","answer","simulate","leave"];function z9(n){const e=W9.indexOf(n.case)>=0;return kn.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var Er;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})(Er||(Er={}));class d1{get currentState(){return this.state}get isDisconnected(){return this.state===Er.DISCONNECTING||this.state===Er.DISCONNECTED}get isEstablishingConnection(){return this.state===Er.CONNECTING||this.state===Er.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Er.DISCONNECTED,this.log=kn,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Sc((r=t.loggerName)!==null&&r!==void 0?r:wa.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new j9,this.queuedRequests=[],this.closingLock=new Bo,this.connectionLock=new Bo,this.state=Er.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,r,i){return Te(this,void 0,void 0,function*(){return this.state=Er.CONNECTING,this.options=r,yield this.connect(e,t,r,i)})}reconnect(e,t,r,i){return Te(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Er.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,t,r,i){this.connectOptions=r,e=U9(e),e=e.replace(/\/$/,""),e+="/rtc";const s=O9(),a=H9(t,s,r);return new Promise((c,d)=>Te(this,void 0,void 0,function*(){const f=yield this.connectionLock.lock();try{const h=()=>Te(this,void 0,void 0,function*(){this.close(),clearTimeout(v),d(new Qn("room connection has been cancelled (signal)"))}),v=setTimeout(()=>{this.close(),d(new Qn("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&h(),i==null||i.addEventListener("abort",h),this.log.debug("connecting to ".concat(e+a),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+a),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(v)},this.ws.onerror=m=>Te(this,void 0,void 0,function*(){if(this.state!==Er.CONNECTED){clearTimeout(v);try{const y=yield fetch("http".concat(e.substring(2),"/validate").concat(a));if(y.status.toFixed(0).startsWith("4")){const C=yield y.text();d(new Qn(C,0,y.status))}else d(new Qn("Internal error",2,y.status))}catch{d(new Qn("server was not reachable",1))}return}this.handleWSError(m)}),this.ws.onmessage=m=>Te(this,void 0,void 0,function*(){var y,C,x,b;let S;if(typeof m.data=="string"){const A=JSON.parse(m.data);S=la.fromJson(A)}else if(m.data instanceof ArrayBuffer)S=la.fromBinary(new Uint8Array(m.data));else{this.log.error("could not decode websocket message: ".concat(typeof m.data),this.logContext);return}if(this.state!==Er.CONNECTED){let A=!1;if(((y=S.message)===null||y===void 0?void 0:y.case)==="join"?(this.state=Er.CONNECTED,i==null||i.removeEventListener("abort",h),this.pingTimeoutDuration=S.message.value.pingTimeout,this.pingIntervalDuration=S.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),c(S.message.value)):this.state===Er.RECONNECTING&&S.message.case!=="leave"?(this.state=Er.CONNECTED,i==null||i.removeEventListener("abort",h),this.startPingInterval(),((C=S.message)===null||C===void 0?void 0:C.case)==="reconnect"?c((x=S.message)===null||x===void 0?void 0:x.value):(c(),A=!0)):this.isEstablishingConnection&&S.message.case==="leave"?d(new Qn("Received leave request while trying to (re)connect",4)):r.reconnect||d(new Qn("did not receive join response, got ".concat((b=S.message)===null||b===void 0?void 0:b.case," instead"))),!A)return}this.signalLatency&&(yield bc(this.signalLatency)),this.handleSignalResponse(S)}),this.ws.onclose=m=>{this.isEstablishingConnection&&d(new Qn("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:m.reason,state:this.state})),this.handleOnClose(m.reason)}}finally{f()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return Te(this,void 0,void 0,function*(){const t=yield this.closingLock.lock();try{if(e&&(this.state=Er.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,bc(250)])),this.ws=void 0}}finally{e&&(this.state=Er.DISCONNECTED),this.clearPingInterval(),t()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:tg(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:tg(e)})}sendIceCandidate(e,t){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Do({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Po({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return this.sendRequest({case:"updateMetadata",value:new fa({metadata:e,name:t})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new da({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new ga({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:xn.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new ya({timestamp:xn.parse(Date.now()),rtt:xn.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new eo({canReconnect:!1,reason:Ic.CLIENT_INITIATED})})}sendRequest(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Te(this,void 0,void 0,function*(){if(!t&&!z9(e)&&this.state===Er.RECONNECTING){this.queuedRequests.push(()=>Te(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(t||(yield this.requestQueue.flush()),this.signalLatency&&(yield bc(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new rc({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(s){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:s}))}})}handleSignalResponse(e){var t,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(i.case==="answer"){const a=ES(i.value);this.onAnswer&&this.onAnswer(a)}else if(i.case==="offer"){const a=ES(i.value);this.onOffer&&this.onOffer(a)}else if(i.case==="trickle"){const a=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(a,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=i.value.participants)!==null&&t!==void 0?t:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return Te(this,void 0,void 0,function*(){if(this.state===Er.DISCONNECTED)return;const t=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=mi.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&mi.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=mi.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&mi.clearInterval(this.pingInterval)}}function ES(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function tg(n){return new Ki({sdp:n.sdp,type:n.type})}function H9(n,e,t){var r;const i=new URLSearchParams;return i.set("access_token",n),t.reconnect&&(i.set("reconnect","1"),t.sid&&i.set("sid",t.sid)),i.set("auto_subscribe",t.autoSubscribe?"1":"0"),i.set("sdk",du()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),t.publishOnly!==void 0&&i.set("publish",t.publishOnly),t.adaptiveStream&&i.set("adaptive_stream","1"),t.reconnectReason&&i.set("reconnect_reason",t.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var r2={},i2={exports:{}},TS=i2.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(n){return n.encoding?"rtpmap:%d %s/%s/%s":n.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(n){return n.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(n){return n.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(n){return"extmap:%d"+(n.direction?"/%s":"%v")+(n["encrypt-uri"]?" %s":"%v")+" %s"+(n.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(n){return n.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(n){var e="candidate:%s %d %s %d %s %d typ %s";return e+=n.raddr!=null?" raddr %s rport %d":"%v%v",e+=n.tcptype!=null?" tcptype %s":"%v",n.generation!=null&&(e+=" generation %d"),e+=n["network-id"]!=null?" network-id %d":"%v",e+=n["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(n){var e="ssrc:%d";return n.attribute!=null&&(e+=" %s",n.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(n){return n.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(n){return n.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(n){return"imageattr:%s %s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(n){return"simulcast:%s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(n){return"ts-refclk:%s"+(n.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(n){var e="mediaclk:";return e+=n.id!=null?"id=%s %s":"%v%s",e+=n.mediaClockValue!=null?"=%s":"",e+=n.rateNumerator!=null?" rate=%s":"",e+=n.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(TS).forEach(function(n){var e=TS[n];e.forEach(function(t){t.reg||(t.reg=/(.*)/),t.format||(t.format="%s")})});var s2=i2.exports;(function(n){var e=function(c){return String(Number(c))===c?Number(c):c},t=function(c,d,f,h){if(h&&!f)d[h]=e(c[1]);else for(var v=0;v<f.length;v+=1)c[v+1]!=null&&(d[f[v]]=e(c[v+1]))},r=function(c,d,f){var h=c.name&&c.names;c.push&&!d[c.push]?d[c.push]=[]:h&&!d[c.name]&&(d[c.name]={});var v=c.push?{}:h?d[c.name]:d;t(f.match(c.reg),v,c.names,c.name),c.push&&d[c.push].push(v)},i=s2,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(c){var d={},f=[],h=d;return c.split(/(\r\n|\r|\n)/).filter(s).forEach(function(v){var m=v[0],y=v.slice(2);m==="m"&&(f.push({rtp:[],fmtp:[]}),h=f[f.length-1]);for(var C=0;C<(i[m]||[]).length;C+=1){var x=i[m][C];if(x.reg.test(y))return r(x,h,y)}}),d.media=f,d};var a=function(c,d){var f=d.split(/=(.+)/,2);return f.length===2?c[f[0]]=e(f[1]):f.length===1&&d.length>1&&(c[f[0]]=void 0),c};n.parseParams=function(c){return c.split(/;\s?/).reduce(a,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(c){return c.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(c){for(var d=[],f=c.split(" ").map(e),h=0;h<f.length;h+=3)d.push({component:f[h],ip:f[h+1],port:f[h+2]});return d},n.parseImageAttributes=function(c){return c.split(" ").map(function(d){return d.substring(1,d.length-1).split(",").reduce(a,{})})},n.parseSimulcastStreamList=function(c){return c.split(";").map(function(d){return d.split(",").map(function(f){var h,v=!1;return f[0]!=="~"?h=e(f):(h=e(f.substring(1,f.length)),v=!0),{scid:h,paused:v}})})}})(r2);var Ov=s2,Z9=/%[sdv%]/g,X9=function(n){var e=1,t=arguments,r=t.length;return n.replace(Z9,function(i){if(e>=r)return i;var s=t[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},Af=function(n,e,t){var r=e.format instanceof Function?e.format(e.push?t:t[e.name]):e.format,i=[n+"="+r];if(e.names)for(var s=0;s<e.names.length;s+=1){var a=e.names[s];e.name?i.push(t[e.name][a]):i.push(t[e.names[s]])}else i.push(t[e.name]);return X9.apply(null,i)},$9=["v","o","s","i","u","e","p","c","b","t","r","z","a"],K9=["i","c","b","a"],q9=function(n,e){e=e||{},n.version==null&&(n.version=0),n.name==null&&(n.name=" "),n.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var t=e.outerOrder||$9,r=e.innerOrder||K9,i=[];return t.forEach(function(s){Ov[s].forEach(function(a){a.name in n&&n[a.name]!=null?i.push(Af(s,a,n)):a.push in n&&n[a.push]!=null&&n[a.push].forEach(function(c){i.push(Af(s,a,c))})})}),n.media.forEach(function(s){i.push(Af("m",Ov.m[0],s)),r.forEach(function(a){Ov[a].forEach(function(c){c.name in s&&s[c.name]!=null?i.push(Af(a,c,s)):c.push in s&&s[c.push]!=null&&s[c.push].forEach(function(d){i.push(Af(a,c,d))})})})}),i.join(`\r
`)+`\r
`},J9=r2,Y9=q9,Fv=Y9,Pf=J9.parse;const _S=.7,sd={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class RS extends Ea.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=kn,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=a1(s=>Te(this,void 0,void 0,function*(){this.emit(sd.NegotiationStarted);try{yield this.createAndSendOffer()}catch(a){if(s)s(a);else throw a}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Sc((i=r.loggerName)!==null&&i!==void 0?i:wa.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=t,this._pc=this.createPC()}createPC(){const e=P9()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var r;t.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,t.candidate))},e.onicecandidateerror=t=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,t)},e.ontrack=t=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return Te(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var t;return Te(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:s}=e7(e);this.remoteStereoMids=i,this.remoteNackMids=s}else if(e.type==="answer"){const i=Pf((t=e.sdp)!==null&&t!==void 0?t:"");i.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(a=>{if(!a.transceiver||s.mid!=a.transceiver.mid)return!1;let c=0;if(s.rtp.some(f=>f.codec.toUpperCase()===a.codec.toUpperCase()?(c=f.payload,!0):!1),c===0)return!0;let d=!1;for(const f of s.fmtp)if(f.payload===c){f.config=f.config.split(";").filter(h=>!h.includes("maxaveragebitrate")).join(";"),a.maxbr>0&&(f.config+=";maxaveragebitrate=".concat(a.maxbr*1e3)),d=!0;break}return d||a.maxbr>0&&s.fmtp.push({payload:c,config:"maxaveragebitrate=".concat(a.maxbr*1e3)}),!0})}),r=Fv(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(sd.NegotiationComplete),e.sdp&&Pf(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(sd.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){var t;return Te(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=Pf((t=r.sdp)!==null&&t!==void 0?t:"");i.media.forEach(s=>{s.type==="audio"?DS(s,[],[]):s.type==="video"&&(Q9(s),this.trackBitrates.some(a=>{if(!s.msid||!a.cid||!s.msid.includes(a.cid))return!1;let c=0;if(s.rtp.some(f=>f.codec.toUpperCase()===a.codec.toUpperCase()?(c=f.payload,!0):!1),c===0)return!0;let d=!1;for(const f of s.fmtp)if(f.payload===c){f.config.includes("x-google-start-bitrate")||(f.config+=";x-google-start-bitrate=".concat(Math.round(a.maxbr*_S))),f.config.includes("x-google-max-bitrate")||(f.config+=";x-google-max-bitrate=".concat(a.maxbr)),d=!0;break}return d||s.fmtp.push({payload:c,config:"x-google-start-bitrate=".concat(Math.round(a.maxbr*_S),";x-google-max-bitrate=").concat(a.maxbr)}),!0}))}),yield this.setMungedSDP(r,Fv(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return Te(this,void 0,void 0,function*(){const t=yield this.pc.createAnswer(),r=Pf((e=t.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&DS(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Fv(r)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new Zr("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new Zr("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return Te(this,void 0,void 0,function*(){if(!this._pc)return;let t="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(c=>{switch(c.type){case"transport":t=c.selectedCandidatePairId;break;case"candidate-pair":t===""&&c.selected&&(t=c.id),r.set(c.id,c);break;case"remote-candidate":i.set(c.id,"".concat(c.address,":").concat(c.port));break}}),t==="")return;const a=(e=r.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(a!==void 0)return i.get(a)})}setMungedSDP(e,t,r){return Te(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:t})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let s="unknown error";i instanceof Error?s=i.message:typeof i=="string"&&(s=i);const a={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(a.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:a})),new Ky(s)}})}}function DS(n,e,t){let r=0;n.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(n.mid)&&!n.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&n.rtcpFb.push({payload:r,type:"nack"}),e.includes(n.mid)&&n.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function Q9(n){var e,t,r,i;const s=(t=(e=n.rtp[0])===null||e===void 0?void 0:e.codec)===null||t===void 0?void 0:t.toLowerCase();if(!Of(s))return;let a=0;((r=n.ext)===null||r===void 0?void 0:r.some(d=>d.uri===yS?!0:(d.value>a&&(a=d.value),!1)))||(i=n.ext)===null||i===void 0||i.push({value:a+1,uri:yS})}function e7(n){var e;const t=[],r=[],i=Pf((e=n.sdp)!==null&&e!==void 0?e:"");let s=0;return i.media.forEach(a=>{var c;a.type==="audio"&&(a.rtp.some(d=>d.codec==="opus"?(s=d.payload,!0):!1),!((c=a.rtcpFb)===null||c===void 0)&&c.some(d=>d.payload===s&&d.type==="nack")&&r.push(a.mid),a.fmtp.some(d=>d.payload===s?(d.config.includes("sprop-stereo=1")&&t.push(a.mid),!0):!1))}),{stereoMids:t,nackMids:r}}const eC="vp8",t7={audioBitrate:Qp.music.maxBitrate,audioPreset:Qp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:c1.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:eC,backupCodec:!0},o2={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},a2={resolution:Yf.h720.resolution},n7={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new Z6,disconnectOnPageLeave:!0,expWebAudioMix:!1},f1={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var $r;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})($r||($r={}));class r7{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,r){var i;this.peerConnectionTimeout=f1.peerConnectionTimeout,this.log=kn,this.updateState=()=>{var a;const c=this.state,d=this.requiredTransports.map(f=>f.getConnectionState());d.every(f=>f==="connected")?this.state=$r.CONNECTED:d.some(f=>f==="failed")?this.state=$r.FAILED:d.some(f=>f==="connecting")?this.state=$r.CONNECTING:d.every(f=>f==="closed")?this.state=$r.CLOSED:d.some(f=>f==="closed")?this.state=$r.CLOSING:d.every(f=>f==="new")&&(this.state=$r.NEW),c!==this.state&&(this.log.debug("pc state change: from ".concat($r[c]," to ").concat($r[this.state]),this.logContext),(a=this.onStateChange)===null||a===void 0||a.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Sc((i=r.loggerName)!==null&&i!==void 0?i:wa.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t;const s={optional:[{googDscp:!0}]};this.publisher=new RS(e,s,r),this.subscriber=new RS(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var c;(c=this.onIceCandidate)===null||c===void 0||c.call(this,a,Mi.PUBLISHER)},this.subscriber.onIceCandidate=a=>{var c;(c=this.onIceCandidate)===null||c===void 0||c.call(this,a,Mi.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var c;(c=this.onDataChannel)===null||c===void 0||c.call(this,a)},this.subscriber.onTrack=a=>{var c;(c=this.onTrack)===null||c===void 0||c.call(this,a)},this.publisher.onOffer=a=>{var c;(c=this.onPublisherOffer)===null||c===void 0||c.call(this,a)},this.state=$r.NEW,this.connectionLock=new Bo}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return Te(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return Te(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return Te(this,void 0,void 0,function*(){t===Mi.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return Te(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){var r;return Te(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,t)))}finally{i()}})}negotiate(e){return Te(this,void 0,void 0,function*(){return new Promise((t,r)=>Te(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(sd.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(sd.NegotiationComplete,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(a=>{clearTimeout(i),r(a)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Mi.PUBLISHER?this.publisher.getConnectedAddress():e===Mi.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return Te(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((s,a)=>Te(this,void 0,void 0,function*(){const c=()=>{this.log.warn("abort transport connection",this.logContext),mi.clearTimeout(d),a(new Qn("room connection has been cancelled",3))};t!=null&&t.signal.aborted&&c(),t==null||t.signal.addEventListener("abort",c);const d=mi.setTimeout(()=>{t==null||t.signal.removeEventListener("abort",c),a(new Qn("could not establish pc connection"))},r);for(;this.state!==$r.CONNECTED;)if(yield bc(50),t!=null&&t.signal.aborted){a(new Qn("room connection has been cancelled",3));return}mi.clearTimeout(d),t==null||t.signal.removeEventListener("abort",c),s()}))})}}const PS="_lossy",NS="_reliable",i7=2*1e3,MS="leave-reconnect";var mo;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(mo||(mo={}));class s7 extends Ea.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=f1.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=mo.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=kn,this.handleDataChannel=r=>{let{channel:i}=r;return Te(this,void 0,void 0,function*(){if(i){if(i.label===NS)this.reliableDCSub=i;else if(i.label===PS)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>Te(this,void 0,void 0,function*(){var i,s;const a=yield this.dataProcessLock.lock();try{let c;if(r.data instanceof ArrayBuffer)c=r.data;else if(r.data instanceof Blob)c=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const d=na.fromBinary(new Uint8Array(c));((i=d.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(Gt.ActiveSpeakersUpdate,d.value.value.speakers):((s=d.value)===null||s===void 0?void 0:s.case)==="user"&&this.emit(Gt.DataPacketReceived,d.value.value,d.kind)}finally{a()}}),this.handleDataError=r=>{const s=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:a}=r.error;this.log.error("DataChannel error on ".concat(s,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:a}))}else this.log.error("Unknown DataChannel error on ".concat(s),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const s=r.currentTarget.maxRetransmits===0?Xr.LOSSY:Xr.RELIABLE;this.updateAndEmitDCBufferStatus(s)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=d=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(d,"ms. giving up"),this.logContext),this.emit(Gt.Disconnected),this.close()},a=Date.now()-this.reconnectStart;let c=this.getNextRetryDelay({elapsedMs:a,retryCount:this.reconnectAttempts});if(c===null){s(a);return}r===MS&&(c=0),this.log.debug("reconnecting in ".concat(c,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=mi.setTimeout(()=>this.attemptReconnect(i),c)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===mo.Connected&&r();const s=()=>{this.off(Gt.Disconnected,a),r()},a=()=>{this.off(Gt.Restarted,s),i()};this.once(Gt.Restarted,s),this.once(Gt.Disconnected,a)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(Gt.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Er.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(za.RR_SIGNAL_DISCONNECTED))},this.log=Sc((t=e.loggerName)!==null&&t!==void 0?t:wa.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new d1(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Bo,this.dataProcessLock=new Bo,this.dcBufferStatus=new Map([[Xr.LOSSY,!0],[Xr.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Gt.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Gt.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Gt.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Gt.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Gt.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Gt.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Gt.StreamStateChanged,r)}get logContext(){var e,t,r,i,s,a;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(a=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||a===void 0?void 0:a.identity}}join(e,t,r,i){return Te(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,t,r,i);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof Qn&&s.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,r,i);throw s}})}close(){return Te(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(Gt.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return Te(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return Te(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ea("a track with the same ID has already been published");return new Promise((t,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Qn("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(i),t(s)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return Te(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var t;return Te(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==$r.NEW)return;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new r7(r,e.subscriberPrimary,this.loggerOptions),this.emit(Gt.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,s)=>{this.client.sendIceCandidate(i,s)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,s,a)=>Te(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===$r.CONNECTED){const c=this.pcState===mo.New;this.pcState=mo.Connected,c&&this.emit(Gt.Connected,e)}else i===$r.FAILED&&this.pcState===mo.Connected&&(this.pcState=mo.Disconnected,this.handleDisconnect("peerconnection failed",a==="failed"?za.RR_SUBSCRIBER_FAILED:za.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(Gt.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>Te(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=e=>Te(this,void 0,void 0,function*(){if(!this.pcManager)return;const t=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Gt.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Gt.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Gt.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",za.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(MS)):(this.emit(Gt.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var t;const r=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(s=>{const a={urls:s.urls};s.username&&(a.username=s.username),s.credential&&(a.credential=s.credential),i.push(a)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Fo.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(PS,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(NS,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,t,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(t);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const s=[],a=[],c=[];i.codecs.forEach(d=>{const f=d.mimeType.toLowerCase();if(f==="audio/opus"){s.push(d);return}if(!(f==="video/".concat(r))){c.push(d);return}if(r==="h264"){d.sdpFmtpLine&&d.sdpFmtpLine.includes("profile-level-id=42e01f")?s.push(d):a.push(d);return}s.push(d)}),D9(e)&&e.setCodecPreferences(s.concat(a,c))}createSender(e,t,r){return Te(this,void 0,void 0,function*(){if(CS())return yield this.createTransceiverRTCRtpSender(e,t,r);if(xS())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Zr("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,r,i){return Te(this,void 0,void 0,function*(){if(CS())return this.createSimulcastTransceiverSender(e,t,r,i);if(xS())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Zr("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,r){return Te(this,void 0,void 0,function*(){if(!this.pcManager)throw new Zr("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const s={direction:"sendonly",streams:i};r&&(s.sendEncodings=r);const a=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s);return e.kind===Xe.Kind.Video&&t.videoCodec&&(this.setPreferredCodec(a,e.kind,t.videoCodec),e.codec=t.videoCodec),a.sender})}createSimulcastTransceiverSender(e,t,r,i){return Te(this,void 0,void 0,function*(){if(!this.pcManager)throw new Zr("publisher is closed");const s={direction:"sendonly"};i&&(s.sendEncodings=i);const a=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,s);if(r.videoCodec)return this.setPreferredCodec(a,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,a.sender),a.sender})}createRTCRtpSender(e){return Te(this,void 0,void 0,function*(){if(!this.pcManager)throw new Zr("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var t,r,i;return Te(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){kn.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===Fo.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:$r.NEW)===$r.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let a=!0;s instanceof Zr?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),a=!1):s instanceof $u||(this.fullReconnectOnNext=!0),a?this.handleDisconnect("reconnect",za.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Gt.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){var t,r,i;return Te(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new Zr("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Gt.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new $u;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(a){throw a instanceof Qn&&a.reason===0?new Zr("could not reconnect, token might be expired"):new $u}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Gt.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==Er.CONNECTED)throw new $u("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(Gt.Restarted)}catch(s){const a=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(a){yield this.restartConnection(a);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),s}})}resumeConnection(e){var t;return Te(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new Zr("could not reconnect, url or token not saved");if(!this.pcManager)throw new Zr("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Gt.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof Qn&&r.reason===0?new Zr("could not reconnect, token might be expired"):r instanceof Qn&&r.reason===4?r:new $u(i)}if(this.emit(Gt.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Er.CONNECTED)throw new $u("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Gt.Resumed)})}waitForPCInitialConnection(e,t){return Te(this,void 0,void 0,function*(){if(!this.pcManager)throw new Zr("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return Te(this,void 0,void 0,function*(){this.pcState=mo.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield bc(i7),!this.pcManager)throw new Zr("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=mo.Connected}catch(e){throw this.pcState=mo.Disconnected,new Qn("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,t){return Te(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(t);const i=this.dataChannelForKind(t);i&&i.send(r),this.updateAndEmitDCBufferStatus(t)})}ensureDataTransportConnected(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return Te(this,void 0,void 0,function*(){if(!this.pcManager)throw new Zr("PC manager is closed");const i=t?this.pcManager.subscriber:this.pcManager.publisher,s=t?"Subscriber":"Publisher";if(!i)throw new Qn("".concat(s," connection not set"));!t&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const a=this.dataChannelForKind(e,t);if((a==null?void 0:a.readyState)==="open")return;const c=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<c;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,t))===null||r===void 0?void 0:r.readyState)==="open")return;yield bc(50)}throw new Qn("could not establish ".concat(s," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return Te(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==$r.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return Te(this,void 0,void 0,function*(){return new Promise((e,t)=>Te(this,void 0,void 0,function*(){if(!this.pcManager){t(new Ky("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Gt.Closing,i),this.pcManager.publisher.once(sd.RTPVideoPayloadTypes,s=>{const a=new Map;s.forEach(c=>{const d=c.codec.toLowerCase();L9(d)&&a.set(c.payload,d)}),this.emit(Gt.RTPVideoMapUpdate,a)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof Ky&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",za.RR_UNKNOWN),t(s)}finally{this.off(Gt.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===Xr.LOSSY)return this.lossyDCSub;if(e===Xr.RELIABLE)return this.reliableDCSub}else{if(e===Xr.LOSSY)return this.lossyDC;if(e===Xr.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const s=this.pcManager.subscriber.getLocalDescription(),a=this.pcManager.subscriber.getRemoteDescription(),c=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,d=new Array;e.forEach(f=>{f.isDesired!==c&&d.push(f.trackSid)}),this.client.sendSyncState(new ma({answer:s?tg({sdp:s.sdp,type:s.type}):void 0,offer:a?tg({sdp:a.sdp,type:a.type}):void 0,subscription:new Qs({trackSids:d,subscribe:!c,participantTracks:[]}),publishTracks:A9(t),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new va({label:r.label,id:r.id,target:i}))};return t(this.dataChannelForKind(Xr.LOSSY),Mi.PUBLISHER),t(this.dataChannelForKind(Xr.RELIABLE),Mi.PUBLISHER),t(this.dataChannelForKind(Xr.LOSSY,!0),Mi.SUBSCRIBER),t(this.dataChannelForKind(Xr.RELIABLE,!0),Mi.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&mi.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){ms()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){ms()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class $u extends Error{}class BS{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Qy(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return Te(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(t.length>0){const r=t[0];return this.attemptedRegions.push(r),kn.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return Te(this,void 0,void 0,function*(){const t=yield fetch("".concat(o7(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(t.ok){const r=yield t.json();return this.lastUpdateAt=Date.now(),r}else throw new Qn("Could not fetch region settings: ".concat(t.statusText),t.status===401?0:void 0,t.status)})}}function o7(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}const h1=2e3;function Sg(n,e){if(!e)return 0;let t,r;return"bytesReceived"in n?(t=n.bytesReceived,r=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,r=e.bytesSent),t===void 0||r===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-r)*8*1e3/(n.timestamp-e.timestamp)}class fs extends xd{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,Xe.Kind.Audio,t,r,s),this.stopOnMute=!1,this.monitorSender=()=>Te(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(c){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:c}));return}a&&this.prevStats&&(this._currentBitrate=Sg(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return Te(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||tu(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Te(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===Xe.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Te(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==tu(this._constraints.deviceId);return this.source===Xe.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return Te(this,void 0,void 0,function*(){let t;if(e){const r=bg({audio:e});typeof r.audio!="boolean"&&(t=r.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return Te(this,void 0,void 0,function*(){const r=yield t.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){ms()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},h1)))}setProcessor(e){var t;return Te(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return Te(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let r;return t.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return Te(this,void 0,void 0,function*(){const e=yield I9(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(kt.AudioSilenceDetected)),e})}}function c2(n,e,t){switch(n.kind){case"audio":return new fs(n,e,!1,void 0,t);case"video":return new Js(n,e,!1,t);default:throw new ea("unsupported track type: ".concat(n.kind))}}const a7=Object.values(Yf),c7=Object.values(qy),l7=Object.values(c1),u7=[Yf.h180,Yf.h360],d7=[qy.h180,qy.h360],f7=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(t=>{var r,i;return new Hn(Math.floor(n.width/t.scaleResolutionDownBy),Math.floor(n.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*(((r=n.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=t.fps)!==null&&i!==void 0?i:30))))),t.fps,n.encoding.priority)}),tC=["q","h","f"];function nC(n,e,t,r){var i,s;let a=r==null?void 0:r.videoEncoding;n&&(a=r==null?void 0:r.screenShareEncoding);const c=r==null?void 0:r.simulcast,d=r==null?void 0:r.scalabilityMode,f=r==null?void 0:r.videoCodec;if(!a&&!c&&!d||!e||!t)return[{}];a||(a=p7(n,e,t,f),kn.debug("using video encoding",a));const h=new Hn(e,t,a.maxBitrate,a.maxFramerate,a.priority);if(d&&Of(f)){kn.debug("using svc with scalabilityMode ".concat(d));const y=new l2(d),C=[];if(y.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(d));for(let x=0;x<y.spatial;x+=1)C.push({rid:tC[2-x],maxBitrate:a.maxBitrate/Math.pow(3,x),maxFramerate:h.encoding.maxFramerate});return C[0].scalabilityMode=d,kn.debug("encodings",C),C}if(!c)return[a];let v=[];n?v=(i=FS(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:OS(n,h):v=(s=FS(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:OS(n,h);let m;if(v.length>0){const y=v[0];v.length>1&&([,m]=v);const C=Math.max(e,t);if(C>=960&&m)return Lv(e,t,[y,m,h]);if(C>=480)return Lv(e,t,[y,h])}return Lv(e,t,[h])}function h7(n,e,t){var r,i,s,a;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&kn.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const c=n.mediaStreamTrack.getSettings(),d=(r=c.width)!==null&&r!==void 0?r:(i=n.dimensions)===null||i===void 0?void 0:i.width,f=(s=c.height)!==null&&s!==void 0?s:(a=n.dimensions)===null||a===void 0?void 0:a.height;return nC(n.source===Xe.Source.ScreenShare,d,f,t)}function p7(n,e,t,r){const i=g7(n,e,t);let{encoding:s}=i[0];const a=Math.max(e,t);for(let c=0;c<i.length;c+=1){const d=i[c];if(s=d.encoding,d.width>=a)break}if(r)switch(r){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function g7(n,e,t){if(n)return l7;const r=e>t?e/t:t/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?a7:c7}function OS(n,e){if(n)return f7(e);const{width:t,height:r}=e,i=t>r?t/r:r/t;return Math.abs(i-16/9)<Math.abs(i-4/3)?u7:d7}function Lv(n,e,t){const r=[];if(t.forEach((i,s)=>{if(s>=tC.length)return;const a=Math.min(n,e),d={rid:tC[s],scaleResolutionDownBy:Math.max(1,a/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(d.maxFramerate=i.encoding.maxFramerate);const f=Cd()||s===0;i.encoding.priority&&f&&(d.priority=i.encoding.priority,d.networkPriority=i.encoding.priority),r.push(d)}),du()&&t2()==="ios"){let i;r.forEach(a=>{i?a.maxFramerate&&a.maxFramerate>i&&(i=a.maxFramerate):i=a.maxFramerate});let s=!0;r.forEach(a=>{var c;a.maxFramerate!=i&&(s&&(s=!1,kn.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),kn.info('Setting framerate of encoding "'.concat((c=a.rid)!==null&&c!==void 0?c:"",'" to ').concat(i)),a.maxFramerate=i)})}return r}function FS(n){if(n)return n.sort((e,t)=>{const{encoding:r}=e,{encoding:i}=t;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class l2{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const m7=5e3;class Js extends xd{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Xe.Kind.Video,t,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>Te(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(c){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:c}));return}const a=new Map(s.map(c=>[c.rid,c]));if(this.prevStats){let c=0;a.forEach((d,f)=>{var h;const v=(h=this.prevStats)===null||h===void 0?void 0:h.get(f);c+=Sg(d,v)}),this._currentBitrate=c}this.prevStats=a}),this.senderLock=new Bo}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!ms())return;const r=(t=this.sender)===null||t===void 0?void 0:t.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},h1))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var t,r,i,s,a;return Te(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var c=!0,d=Ku(this.simulcastCodecs.values()),f;f=yield d.next(),t=f.done,!t;c=!0)s=f.value,c=!1,yield(a=s.sender)===null||a===void 0?void 0:a.replaceTrack(null)}catch(h){r={error:h}}finally{try{!c&&!t&&(i=d.return)&&(yield i.call(d))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var t,r,i,s,a;return Te(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var c=!0,d=Ku(this.simulcastCodecs.values()),f;f=yield d.next(),t=f.done,!t;c=!0){s=f.value,c=!1;const h=s;yield(a=h.sender)===null||a===void 0?void 0:a.replaceTrack(h.mediaStreamTrack)}}catch(h){r={error:h}}finally{try{!c&&!t&&(i=d.return)&&(yield i.call(d))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Te(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===Xe.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Te(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===Xe.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return Te(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],r=yield this.sender.getStats();return r.forEach(i=>{var s;if(i.type==="outbound-rtp"){const a={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(s=i.rid)!==null&&s!==void 0?s:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},c=r.get(i.remoteId);c&&(a.jitter=c.jitter,a.packetsLost=c.packetsLost,a.roundTripTime=c.roundTripTime),t.push(a)}}),t})}setPublishingQuality(e){const t=[];for(let r=Kr.LOW;r<=Kr.HIGH;r+=1)t.push(new Mo({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(t)}setDeviceId(e){return Te(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===tu(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||tu(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var t,r,i,s;return Te(this,void 0,void 0,function*(){let a;if(e){const h=bg({video:e});typeof h.video!="boolean"&&(a=h.video)}yield this.restart(a);try{for(var c=!0,d=Ku(this.simulcastCodecs.values()),f;f=yield d.next(),t=f.done,!t;c=!0){s=f.value,c=!1;const h=s;h.sender&&(h.mediaStreamTrack=this.mediaStreamTrack.clone(),yield h.sender.replaceTrack(h.mediaStreamTrack))}}catch(h){r={error:h}}finally{try{!c&&!t&&(i=d.return)&&(yield i.call(d))}finally{if(r)throw r.error}}})}setProcessor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,s,a,c,d,f;return Te(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,t),!((d=this.processor)===null||d===void 0)&&d.processedTrack)try{for(var h=!0,v=Ku(this.simulcastCodecs.values()),m;m=yield v.next(),i=m.done,!i;h=!0)c=m.value,h=!1,yield(f=c.sender)===null||f===void 0?void 0:f.replaceTrack(this.processor.processedTrack)}catch(y){s={error:y}}finally{try{!h&&!i&&(a=v.return)&&(yield a.call(v))}finally{if(s)throw s.error}}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,t){const r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},m7))}setPublishingCodecs(e){var t,r,i,s,a,c,d;return Te(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const f=[];try{for(t=!0,r=Ku(e);i=yield r.next(),s=i.done,!s;t=!0){d=i.value,t=!1;const h=d;if(!this.codec||this.codec===h.codec)yield this.setPublishingLayers(h.qualities);else{const v=this.simulcastCodecs.get(h.codec);if(this.log.debug("try setPublishingCodec for ".concat(h.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:v})),!v||!v.sender){for(const m of h.qualities)if(m.enabled){f.push(h.codec);break}}else v.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(h.codec),this.logContext),yield LS(v.sender,v.encodings,h.qualities,this.senderLock,this.log,this.logContext))}}}catch(h){a={error:h}}finally{try{!t&&!s&&(c=r.return)&&(yield c.call(r))}finally{if(a)throw a.error}}return f})}setPublishingLayers(e){return Te(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield LS(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Te(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),QT()&&this.isInBackground&&this.source===Xe.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function LS(n,e,t,r,i,s){return Te(this,void 0,void 0,function*(){const a=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},s),{sender:n,qualities:t,senderEncodings:e}));try{const c=n.getParameters(),{encodings:d}=c;if(!d)return;if(d.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let f=!1;!1&&d[0].scalabilityMode||d.forEach((v,m)=>{var y;let C=(y=v.rid)!==null&&y!==void 0?y:"";C===""&&(C="q");const x=u2(C),b=t.find(S=>S.quality===x);b&&v.active!==b.enabled&&(f=!0,v.active=b.enabled,i.debug("setting layer ".concat(b.quality," to ").concat(v.active?"enabled":"disabled"),s),Cd()&&(b.enabled?(v.scaleResolutionDownBy=e[m].scaleResolutionDownBy,v.maxBitrate=e[m].maxBitrate,v.maxFrameRate=e[m].maxFrameRate):(v.scaleResolutionDownBy=4,v.maxBitrate=10,v.maxFrameRate=2)))}),f&&(c.encodings=d,i.debug("setting encodings",Object.assign(Object.assign({},s),{encodings:c.encodings})),yield n.setParameters(c))}finally{a()}})}function u2(n){switch(n){case"f":return Kr.HIGH;case"h":return Kr.MEDIUM;case"q":return Kr.LOW;default:return Kr.HIGH}}function US(n,e,t,r){if(!t)return[new $i({quality:Kr.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(r){const i=t[0].scalabilityMode,s=new l2(i),a=[];for(let c=0;c<s.spatial;c+=1)a.push(new $i({quality:Kr.HIGH-c,width:Math.ceil(n/Math.pow(2,c)),height:Math.ceil(e/Math.pow(2,c)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(3,c)):0,ssrc:0}));return a}return t.map(i=>{var s,a,c;const d=(s=i.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let f=u2((a=i.rid)!==null&&a!==void 0?a:"");return new $i({quality:f,width:Math.ceil(n/d),height:Math.ceil(e/d),bitrate:(c=i.maxBitrate)!==null&&c!==void 0?c:0,ssrc:0})})}class d2 extends Xe{constructor(e,t,r,i,s){super(e,r,s),this.sid=t,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?kt.Muted:kt.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver=void 0,this._currentBitrate=0,this.emit(kt.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return Te(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),h1))}}class nu extends d2{constructor(e,t,r,i,s,a){super(e,t,Xe.Kind.Audio,r,a),this.monitorReceiver=()=>Te(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const c=yield this.getReceiverStats();c&&this.prevStats&&this.receiver&&(this._currentBitrate=Sg(c,this.prevStats)),this.prevStats=c}),this.audioContext=i,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var t;for(const r of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):r.volume=e;du()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(du())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return Te(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Yy(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Yy(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(kt.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(kt.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return Te(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(r=>{r.type==="inbound-rtp"&&(t={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),t})}}const Uv=100;class Lf extends d2{constructor(e,t,r,i,s){super(e,t,Xe.Kind.Video,r,s),this.elementInfos=[],this.monitorReceiver=()=>Te(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Sg(a,this.prevStats)),this.prevStats=a}),this.debouncedHandleResize=a1(()=>{this.updateDimensions()},Uv),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?id(this._mediaStreamTrack,t):Ju(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new v7(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(r=>r===e);for(const r of t)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const r of t)this.stopObservingElement(r);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return Te(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,r="",i=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,t={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&i.set(s.id,s)}),t&&r!==""&&i.get(r)&&(t.mimeType=i.get(r).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(r=>r.element===e);for(const r of t)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Te(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,t;const r=this.elementInfos.reduce((c,d)=>Math.max(c,d.visibilityChangedAt||0),0),i=!((t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&t!==void 0)||t?this.isInBackground:!1,s=this.elementInfos.some(c=>c.pictureInPicture),a=this.elementInfos.some(c=>c.visible)&&!i||s;if(this.lastVisible!==a){if(!a&&Date.now()-r<Uv){mi.setTimeout(()=>{this.updateVisibility()},Uv);return}this.lastVisible=a,this.emit(kt.VisibilityChanged,a,this)}}updateDimensions(){var e,t;let r=0,i=0;const s=this.getPixelDensity();for(const a of this.elementInfos){const c=a.width()*s,d=a.height()*s;c+d>r+i&&(r=c,i=d)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===i||(this.lastDimensions={width:r,height:i},this.emit(kt.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?wS():t||(wS()>2?2:1)}}class v7{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=r=>{var i;const{target:s,isIntersecting:a}=r;s===this.element&&(this.isIntersecting=a,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=t??GS(e),this.isPiP=ms()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=GS(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,bS().observe(this.element),IS().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,t;(e=bS())===null||e===void 0||e.unobserve(this.element),(t=IS())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function GS(n){let e=n.offsetTop,t=n.offsetLeft;const r=n.offsetWidth,i=n.offsetHeight,{hidden:s}=n,{opacity:a,display:c}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,e+=n.offsetTop,t+=n.offsetLeft;return e<window.pageYOffset+window.innerHeight&&t<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&t+r>window.pageXOffset&&!s&&(a!==""?parseFloat(a)>0:!0)&&c!=="none"}class Ha extends Ea.EventEmitter{constructor(e,t,r,i){var s;super(),this.metadataMuted=!1,this.encryption=gi.NONE,this.log=kn,this.handleMuted=()=>{this.emit(kt.Muted)},this.handleUnmuted=()=>{this.emit(kt.Unmuted)},this.log=Sc((s=i==null?void 0:i.loggerName)!==null&&s!==void 0?s:wa.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=r,this.source=Xe.Source.Unknown}setTrack(e){this.track&&(this.track.off(kt.Muted,this.handleMuted),this.track.off(kt.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(kt.Muted,this.handleMuted),e.on(kt.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),lr(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==gi.NONE}get audioTrack(){if(this.track instanceof fs||this.track instanceof nu)return this.track}get videoTrack(){if(this.track instanceof Js||this.track instanceof Lf)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Xe.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Xe.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(Ha||(Ha={}));class Qf extends Ha{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(kt.Ended)},this.updateInfo(t),this.setTrack(r)}setTrack(e){this.track&&this.track.off(kt.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(kt.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return Te(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return Te(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return Te(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return Te(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var Ys;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(Ys||(Ys={}));function y7(n){switch(n){case qa.EXCELLENT:return Ys.Excellent;case qa.GOOD:return Ys.Good;case qa.POOR:return Ys.Poor;case qa.LOST:return Ys.Lost;default:return Ys.Unknown}}class f2 extends Ea.EventEmitter{get logContext(){var e,t;return Object.assign(Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,t;return(t=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&t!==void 0?t:!1}constructor(e,t,r,i,s){var a;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ys.Unknown,this.log=kn,this.log=Sc((a=s==null?void 0:s.loggerName)!==null&&a!==void 0?a:wa.Participant),this.loggerOptions=s,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,t]of this.tracks)if(t.source===e)return t}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(Xe.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(Xe.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Xe.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const t=this.metadata!==e,r=this.metadata;this.metadata=e,t&&this.emit(rt.ParticipantMetadataChanged,r)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(rt.ParticipantNameChanged,e)}setPermissions(e){var t,r,i,s,a;const c=this.permissions,d=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((a=this.permissions)===null||a===void 0?void 0:a.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((f,h)=>{var v;return f!==((v=this.permissions)===null||v===void 0?void 0:v.canPublishSources[h])});return this.permissions=e,d&&this.emit(rt.ParticipantPermissionsChanged,c),d}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(rt.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=y7(e),t!==this._connectionQuality&&this.emit(rt.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(t=>(t.track instanceof nu||t.track instanceof fs)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(kt.Muted,()=>{this.emit(rt.TrackMuted,e)}),e.on(kt.Unmuted,()=>{this.emit(rt.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Xe.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Xe.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function C7(n){var e,t,r;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new pa({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(r=n.allowAll)!==null&&r!==void 0?r:!1,trackSids:n.allowedTrackSids||[]})}class p1 extends Ha{constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Kr.HIGH,this.handleEnded=s=>{this.setTrack(void 0),this.emit(kt.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensions=s,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Qs({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new sa({participantSid:"",trackSids:[this.trackSid]})]});this.emit(kt.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?Ha.SubscriptionStatus.Unsubscribed:super.isSubscribed?Ha.SubscriptionStatus.Subscribed:Ha.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Ha.PermissionStatus.Allowed:Ha.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,r;this.isManualOperationAllowed()&&(((t=this.videoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof Lf&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Lf&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const t=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(kt.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(kt.VisibilityChanged,this.handleVisibilityChange),i.off(kt.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(kt.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(kt.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(kt.VisibilityChanged,this.handleVisibilityChange),e.on(kt.Ended,this.handleEnded),this.emit(kt.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(kt.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?kt.Muted:kt.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(kt.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(kt.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Xe.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof Lf&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new ua({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=Kr.HIGH,this.emit(kt.UpdateSettings,e)}}class eh extends f2{static fromParticipantInfo(e,t){return new eh(e,t.sid,t.identity,t.name,t.metadata)}constructor(e,t,r,i,s,a){super(t,r||"",i,s,a),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(kt.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),lr(e))),this.signalClient.sendUpdateTrackSettings(t)}),e.on(kt.UpdateSubscription,t=>{t.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(kt.SubscriptionPermissionChanged,t=>{this.emit(rt.TrackSubscriptionPermissionChanged,e,t)}),e.on(kt.SubscriptionStatusChanged,t=>{this.emit(rt.TrackSubscriptionStatusChanged,e,t)}),e.on(kt.Subscribed,t=>{this.emit(rt.TrackSubscribed,t,e)}),e.on(kt.Unsubscribed,t=>{this.emit(rt.TrackUnsubscribed,t,e)}),e.on(kt.SubscriptionFailed,t=>{this.emit(rt.TrackSubscriptionFailed,e.trackSid,t)})}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xe.Source.Microphone;this.volumeMap.set(t,e);const r=this.getTrack(t);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xe.Source.Microphone;const t=this.getTrack(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,r,i,s,a){let c=this.getTrackPublication(t);if(c||t.startsWith("TR")||this.tracks.forEach(h=>{!c&&e.kind===h.kind.toString()&&(c=h)}),!c){if(a===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit(rt.TrackSubscriptionFailed,t);return}a===void 0&&(a=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,r,i,s,a-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),lr(c))),this.emit(rt.TrackSubscriptionFailed,t);return}const d=e.kind==="video";let f;return d?f=new Lf(e,t,i,s):f=new nu(e,t,i,this.audioContext,this.audioOutput),f.source=c.source,f.isMuted=c.isMuted,f.setMediaStream(r),f.start(),c.setTrack(f),this.volumeMap.has(c.source)&&f instanceof nu&&f.setVolume(this.volumeMap.get(c.source)),c}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,r=new Map;return e.tracks.forEach(i=>{var s,a;let c=this.getTrackPublication(i.sid);if(c)c.updateInfo(i);else{const d=Xe.kindFromProto(i.type);if(!d)return;c=new p1(d,i,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(a=this.loggerOptions)===null||a===void 0?void 0:a.loggerName}),c.updateInfo(i),r.set(i.sid,c);const f=Array.from(this.tracks.values()).find(h=>h.source===(c==null?void 0:c.source));f&&c.source!==Xe.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(c.source),Object.assign(Object.assign({},this.logContext),{oldTrack:lr(f),newTrack:lr(c)})),this.addTrackPublication(c)}t.set(i.sid,c)}),this.tracks.forEach(i=>{t.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),lr(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(rt.TrackPublished,i)}),!0}unpublishTrack(e,t){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case Xe.Kind.Audio:this.audioTracks.delete(e);break;case Xe.Kind.Video:this.videoTracks.delete(e);break}t&&this.emit(rt.TrackUnpublished,r)}setAudioOutput(e){return Te(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTracks.forEach(r=>{var i;r.track instanceof nu&&t.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class rC extends f2{constructor(e,t,r,i){super(e,t,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=gi.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new n2)},this.handleReconnected=()=>{var s,a;(a=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||a===void 0||a.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,a;this.reconnectFuture&&(this.reconnectFuture.promise.catch(c=>this.log.warn(c.message,this.logContext)),(a=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||a===void 0||a.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>C7(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,a)=>{if(a===void 0&&(a=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),lr(s)));return}this.engine.updateMuteStatus(s.sid,a)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),lr(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),lr(s))),this.onTrackMuted(s,s.isMuted)},this.handleSubscribedQualityUpdate=s=>Te(this,void 0,void 0,function*(){var a,c,d,f,h,v;if(!(!((h=this.roomOptions)===null||h===void 0)&&h.dynacast))return;const m=this.videoTracks.get(s.trackSid);if(!m){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(s.subscribedCodecs.length>0){if(!m.videoTrack)return;const b=yield m.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var y=!0,C=Ku(b),x;x=yield C.next(),a=x.done,!a;y=!0){f=x.value,y=!1;const S=f;C9(S)&&(this.log.debug("publish ".concat(S," for ").concat(m.videoTrack.sid),Object.assign(Object.assign({},this.logContext),lr(m))),yield this.publishAdditionalCodecForTrack(m.videoTrack,S,m.options))}}catch(S){c={error:S}}finally{try{!y&&!a&&(d=C.return)&&(yield d.call(C))}finally{if(c)throw c.error}}}else s.subscribedQualities.length>0&&(yield(v=m.videoTrack)===null||v===void 0?void 0:v.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const a=this.tracks.get(s.trackSid);if(!a){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(a.track)},this.handleTrackEnded=s=>Te(this,void 0,void 0,function*(){if(s.source===Xe.Source.ScreenShare||s.source===Xe.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),lr(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof fs||s instanceof Js)try{if(ms())try{const a=yield navigator==null?void 0:navigator.permissions.query({name:s.source===Xe.Source.Camera?"camera":"microphone"});if(a&&a.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),lr(s))),a.onchange=()=>{a.state!=="denied"&&(s.isMuted||s.restartTrack(),a.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),lr(s))),yield s.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),lr(s))),yield s.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==gi.NONE}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.on(Gt.RemoteMute,(t,r)=>{const i=this.tracks.get(t);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(Gt.Connected,this.handleReconnected).on(Gt.SignalRestarted,this.handleReconnected).on(Gt.SignalResumed,this.handleReconnected).on(Gt.Restarting,this.handleReconnecting).on(Gt.Resuming,this.handleReconnecting).on(Gt.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Gt.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Gt.Disconnected,this.handleDisconnected)}setMetadata(e){var t;this.engine.client.sendUpdateLocalMetadata(e,(t=this.name)!==null&&t!==void 0?t:"")}setName(e){var t;this.engine.client.sendUpdateLocalMetadata((t=this.metadata)!==null&&t!==void 0?t:"",e)}setCameraEnabled(e,t,r){return this.setTrackEnabled(Xe.Source.Camera,e,t,r)}setMicrophoneEnabled(e,t,r){return this.setTrackEnabled(Xe.Source.Microphone,e,t,r)}setScreenShareEnabled(e,t,r){return this.setTrackEnabled(Xe.Source.ScreenShare,e,t,r)}setPermissions(e){const t=this.permissions,r=super.setPermissions(e);return r&&t&&this.emit(rt.ParticipantPermissionsChanged,t),r}setE2EEEnabled(e){return Te(this,void 0,void 0,function*(){this.encryptionType=e?gi.GCM:gi.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,r,i){var s,a;return Te(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t}));let c=this.getTrack(e);if(t)if(c)yield c.unmute();else{let d;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case Xe.Source.Camera:d=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case Xe.Source.Microphone:d=yield this.createTracks({audio:(a=r)!==null&&a!==void 0?a:!0});break;case Xe.Source.ScreenShare:d=yield this.createScreenTracks(Object.assign({},r));break;default:throw new ea(e)}const f=[];for(const v of d)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),lr(v))),f.push(this.publishTrack(v,i));[c]=yield Promise.all(f)}catch(f){throw d==null||d.forEach(h=>{h.stop()}),f instanceof Error&&!(f instanceof ea)&&this.emit(rt.MediaDevicesError,f),f}finally{this.pendingPublishing.delete(e)}}else if(c&&c.track)if(e===Xe.Source.ScreenShare){c=yield this.unpublishTrack(c.track);const d=this.getTrack(Xe.Source.ScreenShareAudio);d&&d.track&&this.unpublishTrack(d.track)}else yield c.mute();return c})}enableCameraAndMicrophone(){return Te(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Xe.Source.Camera)||this.pendingPublishing.has(Xe.Source.Microphone))){this.pendingPublishing.add(Xe.Source.Camera),this.pendingPublishing.add(Xe.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(Xe.Source.Camera),this.pendingPublishing.delete(Xe.Source.Microphone)}}})}createTracks(e){var t,r;return Te(this,void 0,void 0,function*(){const i=JT(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),s=bg(i);let a;try{a=yield navigator.mediaDevices.getUserMedia(s)}catch(c){throw c instanceof Error&&(s.audio&&(this.microphoneError=c),s.video&&(this.cameraError=c)),c}return s.audio&&(this.microphoneError=void 0,this.emit(rt.AudioStreamAcquired)),s.video&&(this.cameraError=void 0),a.getTracks().map(c=>{const d=c.kind==="audio";d?e.audio:e.video;let f;const h=d?s.audio:s.video;typeof h!="boolean"&&(f=h);const v=c2(c,f,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return v.kind===Xe.Kind.Video?v.source=Xe.Source.Camera:v.kind===Xe.Kind.Audio&&(v.source=Xe.Source.Microphone),v.mediaStream=a,v})})}createScreenTracks(e){return Te(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new o1("getDisplayMedia not supported");e.resolution===void 0&&!N9()&&(e.resolution=c1.h1080fps30.resolution);const t=S9(e),r=yield navigator.mediaDevices.getDisplayMedia(t),i=r.getVideoTracks();if(i.length===0)throw new ea("no video track found");const s=new Js(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=Xe.Source.ScreenShare,e.contentHint&&(s.mediaStreamTrack.contentHint=e.contentHint);const a=[s];if(r.getAudioTracks().length>0){this.emit(rt.AudioStreamAcquired);const c=new fs(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});c.source=Xe.Source.ScreenShareAudio,a.push(c)}return a})}publishTrack(e,t){var r,i,s,a;return Te(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof xd&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let c;if(e instanceof MediaStreamTrack)c=e.getConstraints();else{c=e.constraints;let y;switch(e.source){case Xe.Source.Microphone:y="audioinput";break;case Xe.Source.Camera:y="videoinput"}y&&this.activeDeviceMap.has(y)&&(c=Object.assign(Object.assign({},c),{deviceId:this.activeDeviceMap.get(y)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new fs(e,c,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new Js(e,c,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new ea("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof fs&&e.setAudioContext(this.audioContext);let d;if(this.tracks.forEach(y=>{y.track&&y.track===e&&(d=y)}),d)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),lr(d))),d;const f="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,h=(i=t==null?void 0:t.forceStereo)!==null&&i!==void 0?i:f;h&&(t||(t={}),t.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),lr(e))),t.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=t.dtx)!==null&&s!==void 0||(t.dtx=!1),(a=t.red)!==null&&a!==void 0||(t.red=!1));const v=Object.assign(Object.assign({},this.roomOptions.publishDefaults),t);uu()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),v.simulcast=!1),v.source&&(e.source=v.source);const m=this.publish(e,v,h);this.pendingPublishPromises.set(e,m);try{return yield m}catch(y){throw y}finally{this.pendingPublishPromises.delete(e)}})}publish(e,t,r){var i,s,a,c,d,f,h,v,m,y,C,x,b;return Te(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(j=>e instanceof xd&&j.source===e.source)&&e.source!==Xe.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),lr(e))),t.stopMicTrackOnMute&&e instanceof fs&&(e.stopOnMute=!0),e.source===Xe.Source.ScreenShare&&Cd()&&(t.simulcast=!1),t.videoCodec==="av1"&&!T9()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!_9()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=eC);const A=t.videoCodec;e.on(kt.Muted,this.onTrackMuted),e.on(kt.Unmuted,this.onTrackUnmuted),e.on(kt.Ended,this.handleTrackEnded),e.on(kt.UpstreamPaused,this.onTrackUpstreamPaused),e.on(kt.UpstreamResumed,this.onTrackUpstreamResumed);const E=new Ro({cid:e.mediaStreamTrack.id,name:t.name,type:Xe.kindToProto(e.kind),muted:e.isMuted,source:Xe.sourceToProto(e.source),disableDtx:!(!((i=t.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=t.red)!==null&&s!==void 0)||s),stream:t==null?void 0:t.stream});let R;if(e.kind===Xe.Kind.Video){let j={width:0,height:0};try{j=yield e.waitForDimensions()}catch{const L=(c=(a=this.roomOptions.videoCaptureDefaults)===null||a===void 0?void 0:a.resolution)!==null&&c!==void 0?c:Yf.h720.resolution;j={width:L.width,height:L.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),lr(e)),{dims:j}))}E.width=j.width,E.height=j.height,e instanceof Js&&(Of(A)&&(e.source===Xe.Source.ScreenShare&&A==="vp9"&&(t.scalabilityMode="L1T3"),t.scalabilityMode=(d=t.scalabilityMode)!==null&&d!==void 0?d:"L3T3_KEY"),E.simulcastCodecs=[new _o({codec:A,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:eC}),t.backupCodec&&A!==t.backupCodec.codec&&E.encryption===gi.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),E.simulcastCodecs.push(new _o({codec:t.backupCodec.codec,cid:""})))),R=nC(e.source===Xe.Source.ScreenShare,E.width,E.height,t),E.layers=US(E.width,E.height,R,Of(t.videoCodec))}else e.kind===Xe.Kind.Audio&&(R=[{maxBitrate:(h=(f=t.audioPreset)===null||f===void 0?void 0:f.maxBitrate)!==null&&h!==void 0?h:t.audioBitrate,priority:(m=(v=t.audioPreset)===null||v===void 0?void 0:v.priority)!==null&&m!==void 0?m:"high",networkPriority:(C=(y=t.audioPreset)===null||y===void 0?void 0:y.priority)!==null&&C!==void 0?C:"high"}]);if(!this.engine||this.engine.isClosed)throw new Zr("cannot publish track when not connected");const N=yield this.engine.addTrack(E);let V;if(N.codecs.forEach(j=>{V===void 0&&(V=j.mimeType)}),V&&e.kind===Xe.Kind.Video){const j=YT(V);j!==A&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),lr(e)),{codec:j})),t.videoCodec=j,R=nC(e.source===Xe.Source.ScreenShare,E.width,E.height,t))}const M=new Qf(e.kind,N,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(M.options=t,e.sid=N.sid,!this.engine.pcManager)throw new Zr("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:R,trackInfo:N})),e.sender=yield this.engine.createSender(e,t,R),R)if(Cd()&&e.kind===Xe.Kind.Audio){let j;for(const J of this.engine.pcManager.publisher.getTransceivers())if(J.sender===e.sender){j=J;break}j&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:j,codec:"opus",maxbr:!((x=R[0])===null||x===void 0)&&x.maxBitrate?R[0].maxBitrate/1e3:0})}else e.codec&&Of(e.codec)&&(!((b=R[0])===null||b===void 0)&&b.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:E.cid,codec:e.codec,maxbr:R[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof Js?e.startMonitor(this.engine.client):e instanceof fs&&e.startMonitor(),this.addTrackPublication(M),this.emit(rt.LocalTrackPublished,M),M})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,r){var i;return Te(this,void 0,void 0,function*(){if(this.encryptionType!==gi.NONE)return;let s;if(this.tracks.forEach(v=>{v.track&&v.track===e&&(s=v)}),!s)throw new ea("track is not published");if(!(e instanceof Js))throw new ea("track is not a video track");const a=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),c=h7(e,t,a);if(!c){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),lr(e)));return}const d=e.addSimulcastTrack(t,c),f=new Ro({cid:d.mediaStreamTrack.id,type:Xe.kindToProto(e.kind),muted:e.isMuted,source:Xe.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:a.videoCodec,cid:d.mediaStreamTrack.id}]});if(f.layers=US(f.width,f.height,c),!this.engine||this.engine.isClosed)throw new Zr("cannot publish track when not connected");const h=yield this.engine.addTrack(f);yield this.engine.createSimulcastSender(e,d,a,c),yield this.engine.negotiate(),this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:c,trackInfo:h}))})}unpublishTrack(e,t){var r,i;return Te(this,void 0,void 0,function*(){const s=this.getPublicationForTrack(e),a=s?lr(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),a)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),a));return}e=s.track,e.off(kt.Muted,this.onTrackMuted),e.off(kt.Unmuted,this.onTrackUnmuted),e.off(kt.Ended,this.handleTrackEnded),e.off(kt.UpstreamPaused,this.onTrackUpstreamPaused),e.off(kt.UpstreamResumed,this.onTrackUpstreamResumed),t===void 0&&(t=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),t&&e.stop();let c=!1;const d=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<$r.FAILED&&d)try{for(const f of this.engine.pcManager.publisher.getTransceivers())f.sender===d&&(f.direction="inactive",c=!0);if(this.engine.removeTrack(d)&&(c=!0),e instanceof Js){for(const[,f]of e.simulcastCodecs)f.sender&&(this.engine.removeTrack(f.sender)&&(c=!0),f.sender=void 0);e.simulcastCodecs.clear()}}catch(f){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),a),{error:f}))}switch(this.tracks.delete(s.trackSid),s.kind){case Xe.Kind.Audio:this.audioTracks.delete(s.trackSid);break;case Xe.Kind.Video:this.videoTracks.delete(s.trackSid);break}return this.emit(rt.LocalTrackUnpublished,s),s.setTrack(void 0),c&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return Te(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Qf)})}republishAllTracks(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Te(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>Te(this,void 0,void 0,function*(){const s=i.track;yield this.unpublishTrack(s,!1),t&&!s.isMuted&&s.source!==Xe.Source.ScreenShare&&s.source!==Xe.Source.ScreenShareAudio&&(s instanceof fs||s instanceof Js)&&!s.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield s.restartTrack()),yield this.publishTrack(s,i.options)})))})}publishData(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Te(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,s=[],a=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(d=>{d instanceof eh?s.push(d.sid):s.push(d)});const c=new na({kind:t,value:{case:"user",value:new ia({participantSid:this.sid,payload:e,destinationSids:s,topic:a})}});yield this.engine.sendDataPacket(c,t)})}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(t=>{var r,i;const s=this.tracks.get(t.sid);if(s){const a=s.isMuted||((i=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);a!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),lr(s)),{mutedOnServer:a})),this.engine.client.sendMuteTrack(t.sid,a))}}),!0)}getPublicationForTrack(e){let t;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof fs||i instanceof Js)&&i.mediaStreamTrack===e&&(t=r):e===i&&(t=r))}),t}}var Mn;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting"})(Mn||(Mn={}));const x7=2*1e3;class ng extends Ea.EventEmitter{constructor(e){var t,r,i;super(),t=this,this.state=Mn.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=kn,this.bufferedEvents=[],this.connect=(s,a,c)=>Te(this,void 0,void 0,function*(){var d;const f=yield this.disconnectLock.lock();if(this.state===Mn.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),f(),Promise.resolve();if(this.connectFuture)return f(),this.connectFuture.promise;this.setAndEmitConnectionState(Mn.Connecting),((d=this.regionUrlProvider)===null||d===void 0?void 0:d.getServerUrl().toString())!==s&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Qy(new URL(s))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new BS(s,a):this.regionUrlProvider.updateToken(a),this.regionUrlProvider.fetchRegionSettings().catch(m=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:m}))}));const h=(m,y,C)=>Te(this,void 0,void 0,function*(){var x;this.abortController&&this.abortController.abort();const b=new AbortController;this.abortController=b,f==null||f();try{yield this.attemptConnection(C??s,a,c,b),this.abortController=void 0,m()}catch(S){if(this.regionUrlProvider&&S instanceof Qn&&S.reason!==3&&S.reason!==0){let A=null;try{A=yield this.regionUrlProvider.getNextBestRegionUrl((x=this.abortController)===null||x===void 0?void 0:x.signal)}catch(E){if(E instanceof Qn&&(E.status===401||E.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),y(E);return}}A?(this.log.info("Initial connection failed with ConnectionError: ".concat(S.message,". Retrying with another region: ").concat(A),this.logContext),yield h(m,y,A)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),y(S))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),y(S)}}),v=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new n2((m,y)=>{h(m,y,v)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(s,a,c,d,f,h)=>Te(this,void 0,void 0,function*(){var v,m,y;const C=yield c.join(s,a,{autoSubscribe:d.autoSubscribe,publishOnly:d.publishOnly,adaptiveStream:typeof f.adaptiveStream=="object"?!0:f.adaptiveStream,maxRetries:d.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:d.websocketTimeout},h.signal);let x=C.serverInfo;if(x||(x={version:C.serverVersion,region:C.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(x).map(b=>{let[S,A]=b;return"".concat(S,": ").concat(A)}).join(", ")),{room:(v=C.room)===null||v===void 0?void 0:v.name,roomSid:(m=C.room)===null||m===void 0?void 0:m.sid,identity:(y=C.participant)===null||y===void 0?void 0:y.identity}),!C.serverVersion)throw new f9("unknown server version");return C.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),f.dynacast=!1),C}),this.applyJoinResponse=s=>{const a=s.participant;this.localParticipant.sid=a.sid,this.localParticipant.identity=a.identity,this.handleParticipantUpdates([a,...s.otherParticipants]),s.room&&this.handleRoomUpdate(s.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(s.sifTrailer)},this.attemptConnection=(s,a,c,d)=>Te(this,void 0,void 0,function*(){var f,h;this.state===Mn.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((f=this.regionUrlProvider)===null||f===void 0)&&f.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},f1),c),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const v=yield this.connectSignal(s,a,this.engine,this.connOptions,this.options,d);this.applyJoinResponse(v),this.setupLocalParticipantEvents(),this.emit(qe.SignalConnected)}catch(v){yield this.engine.close(),this.recreateEngine();const m=new Qn("could not establish signal connection");throw v instanceof Error&&(m.message="".concat(m.message,": ").concat(v.message)),v instanceof Qn&&(m.reason=v.reason,m.status=v.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:v})),m}if(d.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Qn("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,d)}catch(v){throw yield this.engine.close(),this.recreateEngine(),v}ms()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),ms()&&(document.addEventListener("freeze",this.onPageLeave),(h=navigator.mediaDevices)===null||h===void 0||h.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Mn.Connected),this.emit(qe.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return Te(t,void 0,void 0,function*(){var a,c,d,f;const h=yield this.disconnectLock.lock();try{if(this.state===Mn.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===Mn.Connecting||this.state===Mn.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(a=this.abortController)===null||a===void 0||a.abort(),(d=(c=this.connectFuture)===null||c===void 0?void 0:c.reject)===null||d===void 0||d.call(c,new Qn("Client initiated disconnect")),this.connectFuture=void 0),!((f=this.engine)===null||f===void 0)&&f.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(s,Ic.CLIENT_INITIATED),this.engine=void 0}finally{h()}})},this.onPageLeave=()=>Te(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>Te(this,void 0,void 0,function*(){const s=[],a=Ac();if(a&&a.os==="iOS"){const c="livekit-dummy-audio-el";let d=document.getElementById(c);if(!d){d=document.createElement("audio"),d.id=c,d.autoplay=!0,d.hidden=!0;const f=Bv();f.enabled=!0;const h=new MediaStream([f]);d.srcObject=h,document.addEventListener("visibilitychange",()=>{d&&(d.srcObject=document.hidden?null:h,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(d),this.once(qe.Disconnected,()=>{d==null||d.remove(),d=null})}s.push(d)}this.participants.forEach(c=>{c.audioTracks.forEach(d=>{d.track&&d.track.attachedElements.forEach(f=>{s.push(f)})})});try{yield Promise.all([this.acquireAudioContext(),...s.map(c=>(c.muted=!1,c.play()))]),this.handleAudioPlaybackStarted()}catch(c){throw this.handleAudioPlaybackFailed(c),c}}),this.startVideo=()=>Te(this,void 0,void 0,function*(){const s=[];for(const a of this.participants.values())a.videoTracks.forEach(c=>{var d;(d=c.track)===null||d===void 0||d.attachedElements.forEach(f=>{s.includes(f)||s.push(f)})});yield Promise.all(s.map(a=>a.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(a=>{a.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const s of this.participants.values())this.handleParticipantDisconnected(s.sid,s);this.setAndEmitConnectionState(Mn.Reconnecting)&&this.emit(qe.Reconnecting)},this.handleSignalRestarted=s=>Te(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(s.serverRegion),Object.assign(Object.assign({},this.logContext),{region:s.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(s);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(a){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:a}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:s.serverRegion}))}catch{return}this.setAndEmitConnectionState(Mn.Connected),this.emit(qe.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=s=>{s.forEach(a=>{if(a.identity===this.localParticipant.identity){this.localParticipant.updateInfo(a);return}const c=this.identityToSid.get(a.identity);c&&c!==a.sid&&this.handleParticipantDisconnected(c,this.participants.get(c));let d=this.participants.get(a.sid);const f=!d;a.state===cu.DISCONNECTED?this.handleParticipantDisconnected(a.sid,d):(d=this.getOrCreateParticipant(a.sid,a),f||d.updateInfo(a))})},this.handleActiveSpeakersUpdate=s=>{const a=[],c={};s.forEach(d=>{if(c[d.sid]=!0,d.sid===this.localParticipant.sid)this.localParticipant.audioLevel=d.level,this.localParticipant.setIsSpeaking(!0),a.push(this.localParticipant);else{const f=this.participants.get(d.sid);f&&(f.audioLevel=d.level,f.setIsSpeaking(!0),a.push(f))}}),c[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(d=>{c[d.sid]||(d.audioLevel=0,d.setIsSpeaking(!1))}),this.activeSpeakers=a,this.emitWhenConnected(qe.ActiveSpeakersChanged,a)},this.handleSpeakersChanged=s=>{const a=new Map;this.activeSpeakers.forEach(d=>{a.set(d.sid,d)}),s.forEach(d=>{let f=this.participants.get(d.sid);d.sid===this.localParticipant.sid&&(f=this.localParticipant),f&&(f.audioLevel=d.level,f.setIsSpeaking(d.active),d.active?a.set(d.sid,f):a.delete(d.sid))});const c=Array.from(a.values());c.sort((d,f)=>f.audioLevel-d.audioLevel),this.activeSpeakers=c,this.emitWhenConnected(qe.ActiveSpeakersChanged,c)},this.handleStreamStateUpdate=s=>{s.streamStates.forEach(a=>{const c=this.participants.get(a.participantSid);if(!c)return;const d=c.getTrackPublication(a.trackSid);!d||!d.track||(d.track.streamState=Xe.streamStateFromProto(a.state),c.emit(rt.TrackStreamStateChanged,d,d.track.streamState),this.emitWhenConnected(qe.TrackStreamStateChanged,d,d.track.streamState,c))})},this.handleSubscriptionPermissionUpdate=s=>{const a=this.participants.get(s.participantSid);if(!a)return;const c=a.getTrackPublication(s.trackSid);c&&c.setAllowed(s.allowed)},this.handleSubscriptionError=s=>{const a=Array.from(this.participants.values()).find(d=>d.tracks.has(s.trackSid));if(!a)return;const c=a.getTrackPublication(s.trackSid);c&&c.setSubscriptionError(s.err)},this.handleDataPacket=(s,a)=>{const c=this.participants.get(s.participantSid);this.emit(qe.DataReceived,s.payload,c,a,s.topic),c==null||c.emit(rt.DataReceived,s.payload,a)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(qe.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=s=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:s})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(qe.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(qe.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(qe.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>Te(this,void 0,void 0,function*(){this.emit(qe.MediaDevicesChanged)}),this.handleRoomUpdate=s=>{const a=this.roomInfo;this.roomInfo=s,a&&a.metadata!==s.metadata&&this.emitWhenConnected(qe.RoomMetadataChanged,s.metadata),(a==null?void 0:a.activeRecording)!==s.activeRecording&&this.emitWhenConnected(qe.RecordingStatusChanged,s.activeRecording)},this.handleConnectionQualityUpdate=s=>{s.updates.forEach(a=>{if(a.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(a.quality);return}const c=this.participants.get(a.participantSid);c&&c.setConnectionQuality(a.quality)})},this.onLocalParticipantMetadataChanged=s=>{this.emit(qe.ParticipantMetadataChanged,s,this.localParticipant)},this.onLocalParticipantNameChanged=s=>{this.emit(qe.ParticipantNameChanged,s,this.localParticipant)},this.onLocalTrackMuted=s=>{this.emit(qe.TrackMuted,s,this.localParticipant)},this.onLocalTrackUnmuted=s=>{this.emit(qe.TrackUnmuted,s,this.localParticipant)},this.onLocalTrackPublished=s=>Te(this,void 0,void 0,function*(){var a;this.emit(qe.LocalTrackPublished,s,this.localParticipant),s.track instanceof fs&&(yield s.track.checkForSilence())&&this.emit(qe.LocalAudioSilenceDetected,s);const c=yield(a=s.track)===null||a===void 0?void 0:a.getDeviceId(),d=b9(s.source);d&&c&&c!==this.localParticipant.activeDeviceMap.get(d)&&(this.localParticipant.activeDeviceMap.set(d,c),this.emit(qe.ActiveDeviceChanged,d,c))}),this.onLocalTrackUnpublished=s=>{this.emit(qe.LocalTrackUnpublished,s,this.localParticipant)},this.onLocalConnectionQualityChanged=s=>{this.emit(qe.ConnectionQualityChanged,s,this.localParticipant)},this.onMediaDevicesError=s=>{this.emit(qe.MediaDevicesError,s)},this.onLocalParticipantPermissionsChanged=s=>{this.emit(qe.ParticipantPermissionsChanged,s,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},n7),e),this.log=Sc((r=this.options.loggerName)!==null&&r!==void 0?r:wa.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},o2),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},a2),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},t7),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Bo,this.localParticipant=new rC("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",tu(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",tu(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",tu(this.options.audioOutput.deviceId)).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return Te(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new V9(this.options.e2ee),this.e2eeManager.on(fl.ParticipantEncryptionStatusChanged,(t,r)=>{r instanceof rC&&(this.isE2EEEnabled=t),this.emit(qe.ParticipantEncryptionStatusChanged,t,r)}),this.e2eeManager.on(fl.EncryptionError,t=>this.emit(qe.EncryptionError,t)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}get sid(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&t!==void 0?t:""}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new s7(this.options),this.engine.on(Gt.ParticipantUpdate,this.handleParticipantUpdates).on(Gt.RoomUpdate,this.handleRoomUpdate).on(Gt.SpeakersChanged,this.handleSpeakersChanged).on(Gt.StreamStateChanged,this.handleStreamStateUpdate).on(Gt.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Gt.SubscriptionError,this.handleSubscriptionError).on(Gt.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Gt.MediaTrackAdded,(e,t,r)=>{this.onTrackAdded(e,t,r)}).on(Gt.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Gt.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Gt.DataPacketReceived,this.handleDataPacket).on(Gt.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(Mn.Reconnecting)&&this.emit(qe.Reconnecting)}).on(Gt.Resumed,()=>{this.setAndEmitConnectionState(Mn.Connected),this.emit(qe.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(Gt.SignalResumed,()=>{this.bufferedEvents=[],this.state===Mn.Reconnecting&&this.sendSyncState()}).on(Gt.Restarting,this.handleRestarting).on(Gt.SignalRestarted,this.handleSignalRestarted).on(Gt.DCBufferStatusChanged,(e,t)=>{this.emit(qe.DCBufferStatusChanged,e,t)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Hi.getInstance().getDevices(e,t)}prepareConnection(e,t){return Te(this,void 0,void 0,function*(){if(this.state===Mn.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Qy(new URL(e))&&t){this.regionUrlProvider=new BS(e,t);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Mn.Disconnected&&(this.regionUrl=r,yield fetch(AS(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(AS(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const t=this.identityToSid.get(e);if(t)return this.participants.get(t)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return Te(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new pi({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new pi({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new pi({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new pi({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>Te(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new pi({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>Te(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new pi({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new pi({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>Te(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new eo({reason:Ic.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new pi({scenario:{case:"subscriberBandwidth",value:BigInt(t)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,t;return(t=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&t!==void 0?t:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,s,a;return Te(this,void 0,void 0,function*(){let c=!1,d=!0;const f=r?{exact:t}:t;if(e==="audioinput"){const h=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=f,c=h!==f;const v=Array.from(this.localParticipant.audioTracks.values()).filter(m=>m.source===Xe.Source.Microphone);try{d=(yield Promise.all(v.map(m=>{var y;return(y=m.audioTrack)===null||y===void 0?void 0:y.setDeviceId(f)}))).every(m=>m===!0)}catch(m){throw this.options.audioCaptureDefaults.deviceId=h,m}}else if(e==="videoinput"){const h=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=f,c=h!==f;const v=Array.from(this.localParticipant.videoTracks.values()).filter(m=>m.source===Xe.Source.Camera);try{d=(yield Promise.all(v.map(m=>{var y;return(y=m.videoTrack)===null||y===void 0?void 0:y.setDeviceId(f)}))).every(m=>m===!0)}catch(m){throw this.options.videoCaptureDefaults.deviceId=h,m}}else if(e==="audiooutput"){if(!Yy()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(a=this.options).audioOutput)!==null&&i!==void 0||(a.audioOutput={});const h=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=t,c=h!==f;try{this.options.expWebAudioMix?(s=this.audioContext)===null||s===void 0||s.setSinkId(t):yield Promise.all(Array.from(this.participants.values()).map(v=>v.setAudioOutput({deviceId:t})))}catch(v){throw this.options.audioOutput.deviceId=h,v}}return c&&d&&(this.localParticipant.activeDeviceMap.set(e,t),this.emit(qe.ActiveDeviceChanged,e,t)),d})}setupLocalParticipantEvents(){this.localParticipant.on(rt.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(rt.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(rt.TrackMuted,this.onLocalTrackMuted).on(rt.TrackUnmuted,this.onLocalTrackUnmuted).on(rt.LocalTrackPublished,this.onLocalTrackPublished).on(rt.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(rt.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(rt.MediaDevicesError,this.onMediaDevicesError).on(rt.AudioStreamAcquired,this.startAudio).on(rt.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,r){if(this.state===Mn.Connecting||this.state===Mn.Reconnecting){const h=()=>{this.onTrackAdded(e,t,r),v()},v=()=>{this.off(qe.Reconnected,h),this.off(qe.Connected,h),this.off(qe.Disconnected,v)};this.once(qe.Reconnected,h),this.once(qe.Connected,h),this.once(qe.Disconnected,v);return}if(this.state===Mn.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=E9(t.id),s=i[0];let a=i[1],c=e.id;if(a&&a.startsWith("TR")&&(c=a),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const d=this.participants.get(s);if(!d){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}let f;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?f=this.options.adaptiveStream:f={}),d.addSubscribedMediaTrack(e,c,t,r,f)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==Mn.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(s=>{i.unpublishTrack(s.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var s,a;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((s=i.track)===null||s===void 0||s.detach(),(a=i.track)===null||a===void 0||a.stop())}),this.localParticipant.off(rt.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(rt.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(rt.TrackMuted,this.onLocalTrackMuted).off(rt.TrackUnmuted,this.onLocalTrackUnmuted).off(rt.LocalTrackPublished,this.onLocalTrackPublished).off(rt.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(rt.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(rt.MediaDevicesError,this.onMediaDevicesError).off(rt.AudioStreamAcquired,this.startAudio).off(rt.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),ms()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Mn.Disconnected),this.emit(qe.Disconnected,t)}}}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(this.identityToSid.delete(t.identity),t.tracks.forEach(r=>{t.unpublishTrack(r.trackSid,!0)}),this.emit(qe.ParticipantDisconnected,t))}acquireAudioContext(){var e,t;return Te(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=l1())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(qe.AudioPlaybackStatusChanged,r))})}createParticipant(e,t){var r;let i;return t?i=eh.fromParticipantInfo(this.engine.client,t):i=new eh(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,t);return this.participants.set(e,r),this.identityToSid.set(t.identity,t.sid),this.emitWhenConnected(qe.ParticipantConnected,r),r.on(rt.TrackPublished,i=>{this.emitWhenConnected(qe.TrackPublished,i,r)}).on(rt.TrackSubscribed,(i,s)=>{i.kind===Xe.Kind.Audio?(i.on(kt.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(kt.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Xe.Kind.Video&&(i.on(kt.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(kt.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(qe.TrackSubscribed,i,s,r)}).on(rt.TrackUnpublished,i=>{this.emit(qe.TrackUnpublished,i,r)}).on(rt.TrackUnsubscribed,(i,s)=>{this.emit(qe.TrackUnsubscribed,i,s,r)}).on(rt.TrackSubscriptionFailed,i=>{this.emit(qe.TrackSubscriptionFailed,i,r)}).on(rt.TrackMuted,i=>{this.emitWhenConnected(qe.TrackMuted,i,r)}).on(rt.TrackUnmuted,i=>{this.emitWhenConnected(qe.TrackUnmuted,i,r)}).on(rt.ParticipantMetadataChanged,i=>{this.emitWhenConnected(qe.ParticipantMetadataChanged,i,r)}).on(rt.ParticipantNameChanged,i=>{this.emitWhenConnected(qe.ParticipantNameChanged,i,r)}).on(rt.ConnectionQualityChanged,i=>{this.emitWhenConnected(qe.ConnectionQualityChanged,i,r)}).on(rt.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(qe.ParticipantPermissionsChanged,i,r)}).on(rt.TrackSubscriptionStatusChanged,(i,s)=>{this.emitWhenConnected(qe.TrackSubscriptionStatusChanged,i,s,r)}).on(rt.TrackSubscriptionFailed,(i,s)=>{this.emit(qe.TrackSubscriptionFailed,i,r,s)}).on(rt.TrackSubscriptionPermissionChanged,(i,s)=>{this.emitWhenConnected(qe.TrackSubscriptionPermissionChanged,i,s,r)}),t&&r.updateInfo(t),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),t=this.localParticipant.getTracks();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.participants.values())for(const t of e.videoTracks.values())t.isSubscribed&&t instanceof p1&&t.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=mi.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ic.STATE_MISMATCH))):e=0},x7)}clearConnectionReconcile(){this.connectionReconcileInterval&&mi.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(qe.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,r]=e;this.emit(t,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this.state===Mn.Connected?this.emit(e,...r):(this.state===Mn.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var t,r;return Te(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Rd({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:xn.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Ms({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(qe.SignalConnected),this.emit(qe.Connected),this.setAndEmitConnectionState(Mn.Connected),i.video){const a=new Qf(Xe.Kind.Video,new gs({source:Pr.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ni.AUDIO,name:"video-dummy"}),new Js(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:SS(160*((t=s.aspectRatios[0])!==null&&t!==void 0?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(rt.LocalTrackPublished,a)}if(i.audio){const a=new Qf(Xe.Kind.Audio,new gs({source:Pr.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ni.AUDIO}),new fs(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Bv(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(rt.LocalTrackPublished,a)}for(let a=0;a<s.count-1;a+=1){let c=new Ms({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(a),state:cu.ACTIVE,tracks:[],joinedAt:xn.parse(Date.now())});const d=this.getOrCreateParticipant(c.identity,c);if(s.video){const f=SS(160*((r=s.aspectRatios[a%s.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),h=new gs({source:Pr.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ni.AUDIO});d.addSubscribedMediaTrack(f,h.sid,new MediaStream([f])),c.tracks=[...c.tracks,h]}if(s.audio){const f=Bv(),h=new gs({source:Pr.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ni.AUDIO});d.addSubscribedMediaTrack(f,h.sid,new MediaStream([f])),c.tracks=[...c.tracks,h]}d.updateInfo(c)}})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(e!==qe.ActiveSpeakersChanged){const s=h2(r).filter(a=>a!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s}))}return super.emit(e,...r)}}function h2(n){return n.map(e=>{if(e)return Array.isArray(e)?h2(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var Eo;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(Eo||(Eo={}));class Pd extends Ea.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Eo.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=t,this.name=this.constructor.name,this.room=new ng(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return Te(this,void 0,void 0,function*(){if(this.status!==Eo.IDLE)throw Error("check is running already");this.setStatus(Eo.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==Eo.SKIPPED&&this.setStatus(this.isSuccess()?Eo.SUCCESS:Eo.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return Te(this,void 0,void 0,function*(){return this.room.state===Mn.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return Te(this,void 0,void 0,function*(){this.room&&this.room.state!==Mn.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Eo.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function p2(n){var e,t;return Te(this,void 0,void 0,function*(){n??(n={}),(e=n.audio)!==null&&e!==void 0||(n.audio=!0),(t=n.video)!==null&&t!==void 0||(n.video=!0);const r=JT(n,o2,a2),i=bg(r),s=navigator.mediaDevices.getUserMedia(i);n.audio&&(Hi.userMediaPromiseMap.set("audioinput",s),s.catch(()=>Hi.userMediaPromiseMap.delete("audioinput"))),n.video&&(Hi.userMediaPromiseMap.set("videoinput",s),s.catch(()=>Hi.userMediaPromiseMap.delete("videoinput")));const a=yield s;return a.getTracks().map(c=>{const d=c.kind==="audio";d?n.audio:n.video;let f;const h=d?i.audio:i.video;typeof h!="boolean"&&(f=h),f?f.deviceId=c.getSettings().deviceId:f={deviceId:c.getSettings().deviceId};const v=c2(c,f);return v.kind===Xe.Kind.Video?v.source=Xe.Source.Camera:v.kind===Xe.Kind.Audio&&(v.source=Xe.Source.Microphone),v.mediaStream=a,v})})}function w7(n){return Te(this,void 0,void 0,function*(){return(yield p2({audio:!1,video:n}))[0]})}function I7(n){return Te(this,void 0,void 0,function*(){return(yield p2({audio:n,video:!1}))[0]})}class b7 extends Pd{get description(){return"Can publish audio"}perform(){var e;return Te(this,void 0,void 0,function*(){const t=yield this.connect(),r=yield I7();t.localParticipant.publishTrack(r),yield new Promise(a=>setTimeout(a,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(a=>{a.type==="outbound-rtp"&&a.mediaType==="audio"&&(s=a.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class S7 extends Pd{get description(){return"Can publish video"}perform(){var e;return Te(this,void 0,void 0,function*(){const t=yield this.connect(),r=yield w7();t.localParticipant.publishTrack(r),yield new Promise(a=>setTimeout(a,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(a=>{a.type==="outbound-rtp"&&a.mediaType==="video"&&(s=a.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class A7 extends Pd{get description(){return"Resuming connection after interruption"}perform(){var e;return Te(this,void 0,void 0,function*(){const t=yield this.connect();let r=!1,i=!1,s;const a=new Promise(d=>{setTimeout(d,5e3),s=d});t.on(qe.Reconnecting,()=>{r=!0}).on(qe.Reconnected,()=>{i=!0,s(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const c=t.engine.client.onClose;if(c&&c(""),yield a,r){if(!i||t.state!==Mn.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class k7 extends Pd{get description(){return"Can connect via TURN"}perform(){var e,t;return Te(this,void 0,void 0,function*(){const r=new d1,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,a=!1,c=!1;for(let d of i.iceServers)for(let f of d.urls)f.startsWith("turn:")?(a=!0,c=!0):f.startsWith("turns:")&&(a=!0,c=!0,s=!0),f.startsWith("stun:")&&(c=!0);c?a&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((t=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||t===void 0)&&t.iceServers||a?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(d=>setTimeout(d,0)))})}}class E7 extends Pd{get description(){return"Establishing WebRTC connection"}perform(){return Te(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(qe.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,s)=>{if(i.candidate){const a=new RTCIceCandidate(i);let c="".concat(a.protocol," ").concat(a.address,":").concat(a.port," ").concat(a.type);a.address&&(T7(a.address)?c+=" (private)":a.protocol==="tcp"&&a.tcpType==="passive"?(e=!0,c+=" (passive)"):a.protocol==="udp"&&(t=!0)),this.appendMessage(c)}r&&r(i,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),kn.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function T7(n){const e=n.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class _7 extends Pd{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,t,r;return Te(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new d1;const s=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===vd.Cloud&&(!((t=s.serverInfo)===null||t===void 0)&&t.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class sH extends Ea.EventEmitter{constructor(e,t){super(),this.checkResults=new Map,this.url=e,this.token=t}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Eo.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Eo.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return Te(this,void 0,void 0,function*(){const t=this.getNextCheckId(),r=new e(this.url,this.token),i=a=>{this.updateCheck(t,a)};r.on("update",i);const s=yield r.run();return r.off("update",i),s})}checkWebsocket(){return Te(this,void 0,void 0,function*(){return this.createAndRunCheck(_7)})}checkWebRTC(){return Te(this,void 0,void 0,function*(){return this.createAndRunCheck(E7)})}checkTURN(){return Te(this,void 0,void 0,function*(){return this.createAndRunCheck(k7)})}checkReconnect(){return Te(this,void 0,void 0,function*(){return this.createAndRunCheck(A7)})}checkPublishAudio(){return Te(this,void 0,void 0,function*(){return this.createAndRunCheck(b7)})}checkPublishVideo(){return Te(this,void 0,void 0,function*(){return this.createAndRunCheck(S7)})}}function R7(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var t;const r=n instanceof xd?n.mediaStreamTrack:n,i=r.getSettings();let s={facingMode:(t=e.defaultFacingMode)!==null&&t!==void 0?t:"user",confidence:"low"};if("facingMode"in i){const a=i.facingMode;kn.debug("rawFacingMode",{rawFacingMode:a}),a&&typeof a=="string"&&N7(a)&&(s={facingMode:a,confidence:"high"})}if(["low","medium"].includes(s.confidence)){kn.debug("Try to get facing mode from device label: (".concat(r.label,")"));const a=P7(r.label);a!==void 0&&(s=a)}return s}const VS=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),D7=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function P7(n){var e;const t=n.trim().toLowerCase();if(t!=="")return VS.has(t)?VS.get(t):(e=Array.from(D7.entries()).find(r=>{let[i]=r;return t.includes(i)}))===null||e===void 0?void 0:e[1]}function N7(n){return n===void 0||["user","environment","left","right"].includes(n)}const iC=Math.min,od=Math.max,rg=Math.round,Ca=n=>({x:n,y:n}),M7={left:"right",right:"left",bottom:"top",top:"bottom"},B7={start:"end",end:"start"};function jS(n,e,t){return od(n,iC(e,t))}function Ag(n,e){return typeof n=="function"?n(e):n}function fu(n){return n.split("-")[0]}function kg(n){return n.split("-")[1]}function g2(n){return n==="x"?"y":"x"}function m2(n){return n==="y"?"height":"width"}const O7=new Set(["top","bottom"]);function pl(n){return O7.has(fu(n))?"y":"x"}function v2(n){return g2(pl(n))}function F7(n,e,t){t===void 0&&(t=!1);const r=kg(n),i=v2(n),s=m2(i);let a=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=ig(a)),[a,ig(a)]}function L7(n){const e=ig(n);return[sC(n),e,sC(e)]}function sC(n){return n.replace(/start|end/g,e=>B7[e])}const WS=["left","right"],zS=["right","left"],U7=["top","bottom"],G7=["bottom","top"];function V7(n,e,t){switch(n){case"top":case"bottom":return t?e?zS:WS:e?WS:zS;case"left":case"right":return e?U7:G7;default:return[]}}function j7(n,e,t,r){const i=kg(n);let s=V7(fu(n),t==="start",r);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(sC)))),s}function ig(n){return n.replace(/left|right|bottom|top/g,e=>M7[e])}function W7(n){return{top:0,right:0,bottom:0,left:0,...n}}function z7(n){return typeof n!="number"?W7(n):{top:n,right:n,bottom:n,left:n}}function sg(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function HS(n,e,t){let{reference:r,floating:i}=n;const s=pl(e),a=v2(e),c=m2(a),d=fu(e),f=s==="y",h=r.x+r.width/2-i.width/2,v=r.y+r.height/2-i.height/2,m=r[c]/2-i[c]/2;let y;switch(d){case"top":y={x:h,y:r.y-i.height};break;case"bottom":y={x:h,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:v};break;case"left":y={x:r.x-i.width,y:v};break;default:y={x:r.x,y:r.y}}switch(kg(e)){case"start":y[a]-=m*(t&&f?-1:1);break;case"end":y[a]+=m*(t&&f?-1:1);break}return y}const H7=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=t,c=s.filter(Boolean),d=await(a.isRTL==null?void 0:a.isRTL(e));let f=await a.getElementRects({reference:n,floating:e,strategy:i}),{x:h,y:v}=HS(f,r,d),m=r,y={},C=0;for(let x=0;x<c.length;x++){const{name:b,fn:S}=c[x],{x:A,y:E,data:R,reset:N}=await S({x:h,y:v,initialPlacement:r,placement:m,strategy:i,middlewareData:y,rects:f,platform:a,elements:{reference:n,floating:e}});h=A??h,v=E??v,y={...y,[b]:{...y[b],...R}},N&&C<=50&&(C++,typeof N=="object"&&(N.placement&&(m=N.placement),N.rects&&(f=N.rects===!0?await a.getElementRects({reference:n,floating:e,strategy:i}):N.rects),{x:h,y:v}=HS(f,m,d)),x=-1)}return{x:h,y:v,placement:m,strategy:i,middlewareData:y}};async function y2(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:a,elements:c,strategy:d}=n,{boundary:f="clippingAncestors",rootBoundary:h="viewport",elementContext:v="floating",altBoundary:m=!1,padding:y=0}=Ag(e,n),C=z7(y),b=c[m?v==="floating"?"reference":"floating":v],S=sg(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(b)))==null||t?b:b.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(c.floating)),boundary:f,rootBoundary:h,strategy:d})),A=v==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,E=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c.floating)),R=await(s.isElement==null?void 0:s.isElement(E))?await(s.getScale==null?void 0:s.getScale(E))||{x:1,y:1}:{x:1,y:1},N=sg(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:A,offsetParent:E,strategy:d}):A);return{top:(S.top-N.top+C.top)/R.y,bottom:(N.bottom-S.bottom+C.bottom)/R.y,left:(S.left-N.left+C.left)/R.x,right:(N.right-S.right+C.right)/R.x}}const Z7=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:s,rects:a,initialPlacement:c,platform:d,elements:f}=e,{mainAxis:h=!0,crossAxis:v=!0,fallbackPlacements:m,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:C="none",flipAlignment:x=!0,...b}=Ag(n,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const S=fu(i),A=pl(c),E=fu(c)===c,R=await(d.isRTL==null?void 0:d.isRTL(f.floating)),N=m||(E||!x?[ig(c)]:L7(c)),V=C!=="none";!m&&V&&N.push(...j7(c,x,C,R));const M=[c,...N],j=await y2(e,b),J=[];let L=((r=s.flip)==null?void 0:r.overflows)||[];if(h&&J.push(j[S]),v){const pe=F7(i,a,R);J.push(j[pe[0]],j[pe[1]])}if(L=[...L,{placement:i,overflows:J}],!J.every(pe=>pe<=0)){var z,Y;const pe=(((z=s.flip)==null?void 0:z.index)||0)+1,xe=M[pe];if(xe&&(!(v==="alignment"?A!==pl(xe):!1)||L.every(we=>we.overflows[0]>0&&pl(we.placement)===A)))return{data:{index:pe,overflows:L},reset:{placement:xe}};let Ae=(Y=L.filter(Le=>Le.overflows[0]<=0).sort((Le,we)=>Le.overflows[1]-we.overflows[1])[0])==null?void 0:Y.placement;if(!Ae)switch(y){case"bestFit":{var ie;const Le=(ie=L.filter(we=>{if(V){const Se=pl(we.placement);return Se===A||Se==="y"}return!0}).map(we=>[we.placement,we.overflows.filter(Se=>Se>0).reduce((Se,Ee)=>Se+Ee,0)]).sort((we,Se)=>we[1]-Se[1])[0])==null?void 0:ie[0];Le&&(Ae=Le);break}case"initialPlacement":Ae=c;break}if(i!==Ae)return{reset:{placement:Ae}}}return{}}}},X7=new Set(["left","top"]);async function $7(n,e){const{placement:t,platform:r,elements:i}=n,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=fu(t),c=kg(t),d=pl(t)==="y",f=X7.has(a)?-1:1,h=s&&d?-1:1,v=Ag(e,n);let{mainAxis:m,crossAxis:y,alignmentAxis:C}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:v.mainAxis||0,crossAxis:v.crossAxis||0,alignmentAxis:v.alignmentAxis};return c&&typeof C=="number"&&(y=c==="end"?C*-1:C),d?{x:y*h,y:m*f}:{x:m*f,y:y*h}}const K7=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:s,placement:a,middlewareData:c}=e,d=await $7(e,n);return a===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:i+d.x,y:s+d.y,data:{...d,placement:a}}}}},q7=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:c={fn:b=>{let{x:S,y:A}=b;return{x:S,y:A}}},...d}=Ag(n,e),f={x:t,y:r},h=await y2(e,d),v=pl(fu(i)),m=g2(v);let y=f[m],C=f[v];if(s){const b=m==="y"?"top":"left",S=m==="y"?"bottom":"right",A=y+h[b],E=y-h[S];y=jS(A,y,E)}if(a){const b=v==="y"?"top":"left",S=v==="y"?"bottom":"right",A=C+h[b],E=C-h[S];C=jS(A,C,E)}const x=c.fn({...e,[m]:y,[v]:C});return{...x,data:{x:x.x-t,y:x.y-r,enabled:{[m]:s,[v]:a}}}}}};function Eg(){return typeof window<"u"}function Nd(n){return C2(n)?(n.nodeName||"").toLowerCase():"#document"}function Bs(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Tc(n){var e;return(e=(C2(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function C2(n){return Eg()?n instanceof Node||n instanceof Bs(n).Node:!1}function Lo(n){return Eg()?n instanceof Element||n instanceof Bs(n).Element:!1}function Ia(n){return Eg()?n instanceof HTMLElement||n instanceof Bs(n).HTMLElement:!1}function ZS(n){return!Eg()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Bs(n).ShadowRoot}const J7=new Set(["inline","contents"]);function yh(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=Uo(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!J7.has(i)}const Y7=new Set(["table","td","th"]);function Q7(n){return Y7.has(Nd(n))}const eU=[":popover-open",":modal"];function Tg(n){return eU.some(e=>{try{return n.matches(e)}catch{return!1}})}const tU=["transform","translate","scale","rotate","perspective"],nU=["transform","translate","scale","rotate","perspective","filter"],rU=["paint","layout","strict","content"];function g1(n){const e=m1(),t=Lo(n)?Uo(n):n;return tU.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||nU.some(r=>(t.willChange||"").includes(r))||rU.some(r=>(t.contain||"").includes(r))}function iU(n){let e=vl(n);for(;Ia(e)&&!wd(e);){if(g1(e))return e;if(Tg(e))return null;e=vl(e)}return null}function m1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const sU=new Set(["html","body","#document"]);function wd(n){return sU.has(Nd(n))}function Uo(n){return Bs(n).getComputedStyle(n)}function _g(n){return Lo(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function vl(n){if(Nd(n)==="html")return n;const e=n.assignedSlot||n.parentNode||ZS(n)&&n.host||Tc(n);return ZS(e)?e.host:e}function x2(n){const e=vl(n);return wd(e)?n.ownerDocument?n.ownerDocument.body:n.body:Ia(e)&&yh(e)?e:x2(e)}function w2(n,e,t){var r;e===void 0&&(e=[]);const i=x2(n),s=i===((r=n.ownerDocument)==null?void 0:r.body),a=Bs(i);return s?(oC(a),e.concat(a,a.visualViewport||[],yh(i)?i:[],[])):e.concat(i,w2(i,[]))}function oC(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function I2(n){const e=Uo(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Ia(n),s=i?n.offsetWidth:t,a=i?n.offsetHeight:r,c=rg(t)!==s||rg(r)!==a;return c&&(t=s,r=a),{width:t,height:r,$:c}}function b2(n){return Lo(n)?n:n.contextElement}function ad(n){const e=b2(n);if(!Ia(e))return Ca(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:s}=I2(e);let a=(s?rg(t.width):t.width)/r,c=(s?rg(t.height):t.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!c||!Number.isFinite(c))&&(c=1),{x:a,y:c}}const oU=Ca(0);function S2(n){const e=Bs(n);return!m1()||!e.visualViewport?oU:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function aU(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Bs(n)?!1:e}function th(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),s=b2(n);let a=Ca(1);e&&(r?Lo(r)&&(a=ad(r)):a=ad(n));const c=aU(s,t,r)?S2(s):Ca(0);let d=(i.left+c.x)/a.x,f=(i.top+c.y)/a.y,h=i.width/a.x,v=i.height/a.y;if(s){const m=Bs(s),y=r&&Lo(r)?Bs(r):r;let C=m,x=oC(C);for(;x&&r&&y!==C;){const b=ad(x),S=x.getBoundingClientRect(),A=Uo(x),E=S.left+(x.clientLeft+parseFloat(A.paddingLeft))*b.x,R=S.top+(x.clientTop+parseFloat(A.paddingTop))*b.y;d*=b.x,f*=b.y,h*=b.x,v*=b.y,d+=E,f+=R,C=Bs(x),x=oC(C)}}return sg({width:h,height:v,x:d,y:f})}function v1(n,e){const t=_g(n).scrollLeft;return e?e.left+t:th(Tc(n)).left+t}function A2(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:v1(n,r)),s=r.top+e.scrollTop;return{x:i,y:s}}function cU(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const s=i==="fixed",a=Tc(r),c=e?Tg(e.floating):!1;if(r===a||c&&s)return t;let d={scrollLeft:0,scrollTop:0},f=Ca(1);const h=Ca(0),v=Ia(r);if((v||!v&&!s)&&((Nd(r)!=="body"||yh(a))&&(d=_g(r)),Ia(r))){const y=th(r);f=ad(r),h.x=y.x+r.clientLeft,h.y=y.y+r.clientTop}const m=a&&!v&&!s?A2(a,d,!0):Ca(0);return{width:t.width*f.x,height:t.height*f.y,x:t.x*f.x-d.scrollLeft*f.x+h.x+m.x,y:t.y*f.y-d.scrollTop*f.y+h.y+m.y}}function lU(n){return Array.from(n.getClientRects())}function uU(n){const e=Tc(n),t=_g(n),r=n.ownerDocument.body,i=od(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=od(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-t.scrollLeft+v1(n);const c=-t.scrollTop;return Uo(r).direction==="rtl"&&(a+=od(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:c}}function dU(n,e){const t=Bs(n),r=Tc(n),i=t.visualViewport;let s=r.clientWidth,a=r.clientHeight,c=0,d=0;if(i){s=i.width,a=i.height;const f=m1();(!f||f&&e==="fixed")&&(c=i.offsetLeft,d=i.offsetTop)}return{width:s,height:a,x:c,y:d}}const fU=new Set(["absolute","fixed"]);function hU(n,e){const t=th(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,s=Ia(n)?ad(n):Ca(1),a=n.clientWidth*s.x,c=n.clientHeight*s.y,d=i*s.x,f=r*s.y;return{width:a,height:c,x:d,y:f}}function XS(n,e,t){let r;if(e==="viewport")r=dU(n,t);else if(e==="document")r=uU(Tc(n));else if(Lo(e))r=hU(e,t);else{const i=S2(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return sg(r)}function k2(n,e){const t=vl(n);return t===e||!Lo(t)||wd(t)?!1:Uo(t).position==="fixed"||k2(t,e)}function pU(n,e){const t=e.get(n);if(t)return t;let r=w2(n,[]).filter(c=>Lo(c)&&Nd(c)!=="body"),i=null;const s=Uo(n).position==="fixed";let a=s?vl(n):n;for(;Lo(a)&&!wd(a);){const c=Uo(a),d=g1(a);!d&&c.position==="fixed"&&(i=null),(s?!d&&!i:!d&&c.position==="static"&&!!i&&fU.has(i.position)||yh(a)&&!d&&k2(n,a))?r=r.filter(h=>h!==a):i=c,a=vl(a)}return e.set(n,r),r}function gU(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const a=[...t==="clippingAncestors"?Tg(e)?[]:pU(e,this._c):[].concat(t),r],c=a[0],d=a.reduce((f,h)=>{const v=XS(e,h,i);return f.top=od(v.top,f.top),f.right=iC(v.right,f.right),f.bottom=iC(v.bottom,f.bottom),f.left=od(v.left,f.left),f},XS(e,c,i));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function mU(n){const{width:e,height:t}=I2(n);return{width:e,height:t}}function vU(n,e,t){const r=Ia(e),i=Tc(e),s=t==="fixed",a=th(n,!0,s,e);let c={scrollLeft:0,scrollTop:0};const d=Ca(0);function f(){d.x=v1(i)}if(r||!r&&!s)if((Nd(e)!=="body"||yh(i))&&(c=_g(e)),r){const y=th(e,!0,s,e);d.x=y.x+e.clientLeft,d.y=y.y+e.clientTop}else i&&f();s&&!r&&i&&f();const h=i&&!r&&!s?A2(i,c):Ca(0),v=a.left+c.scrollLeft-d.x-h.x,m=a.top+c.scrollTop-d.y-h.y;return{x:v,y:m,width:a.width,height:a.height}}function Gv(n){return Uo(n).position==="static"}function $S(n,e){if(!Ia(n)||Uo(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Tc(n)===t&&(t=t.ownerDocument.body),t}function E2(n,e){const t=Bs(n);if(Tg(n))return t;if(!Ia(n)){let i=vl(n);for(;i&&!wd(i);){if(Lo(i)&&!Gv(i))return i;i=vl(i)}return t}let r=$S(n,e);for(;r&&Q7(r)&&Gv(r);)r=$S(r,e);return r&&wd(r)&&Gv(r)&&!g1(r)?t:r||iU(n)||t}const yU=async function(n){const e=this.getOffsetParent||E2,t=this.getDimensions,r=await t(n.floating);return{reference:vU(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function CU(n){return Uo(n).direction==="rtl"}const xU={convertOffsetParentRelativeRectToViewportRelativeRect:cU,getDocumentElement:Tc,getClippingRect:gU,getOffsetParent:E2,getElementRects:yU,getClientRects:lU,getDimensions:mU,getScale:ad,isElement:Lo,isRTL:CU},wU=K7,IU=q7,bU=Z7,SU=(n,e,t)=>{const r=new Map,i={platform:xU,...t},s={...i.platform,_c:r};return H7(n,e,{...i,platform:s})};var Pp={exports:{}},AU=Pp.exports,KS;function kU(){return KS||(KS=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(AU,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},a=null;function c(x,b){var S=x[b];if(typeof S.bind=="function")return S.bind(x);try{return Function.prototype.bind.call(S,x)}catch{return function(){return Function.prototype.apply.apply(S,[x,arguments])}}}function d(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function f(x){return x==="debug"&&(x="log"),typeof console===t?!1:x==="trace"&&r?d:console[x]!==void 0?c(console,x):console.log!==void 0?c(console,"log"):e}function h(){for(var x=this.getLevel(),b=0;b<i.length;b++){var S=i[b];this[S]=b<x?e:this.methodFactory(S,x,this.name)}if(this.log=this.debug,typeof console===t&&x<this.levels.SILENT)return"No console available for logging"}function v(x){return function(){typeof console!==t&&(h.call(this),this[x].apply(this,arguments))}}function m(x,b,S){return f(x)||v.apply(this,arguments)}function y(x,b){var S=this,A,E,R,N="loglevel";typeof x=="string"?N+=":"+x:typeof x=="symbol"&&(N=void 0);function V(z){var Y=(i[z]||"silent").toUpperCase();if(!(typeof window===t||!N)){try{window.localStorage[N]=Y;return}catch{}try{window.document.cookie=encodeURIComponent(N)+"="+Y+";"}catch{}}}function M(){var z;if(!(typeof window===t||!N)){try{z=window.localStorage[N]}catch{}if(typeof z===t)try{var Y=window.document.cookie,ie=encodeURIComponent(N),pe=Y.indexOf(ie+"=");pe!==-1&&(z=/^([^;]+)/.exec(Y.slice(pe+ie.length+1))[1])}catch{}return S.levels[z]===void 0&&(z=void 0),z}}function j(){if(!(typeof window===t||!N)){try{window.localStorage.removeItem(N)}catch{}try{window.document.cookie=encodeURIComponent(N)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function J(z){var Y=z;if(typeof Y=="string"&&S.levels[Y.toUpperCase()]!==void 0&&(Y=S.levels[Y.toUpperCase()]),typeof Y=="number"&&Y>=0&&Y<=S.levels.SILENT)return Y;throw new TypeError("log.setLevel() called with invalid level: "+z)}S.name=x,S.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},S.methodFactory=b||m,S.getLevel=function(){return R??E??A},S.setLevel=function(z,Y){return R=J(z),Y!==!1&&V(R),h.call(S)},S.setDefaultLevel=function(z){E=J(z),M()||S.setLevel(z,!1)},S.resetLevel=function(){R=null,j(),h.call(S)},S.enableAll=function(z){S.setLevel(S.levels.TRACE,z)},S.disableAll=function(z){S.setLevel(S.levels.SILENT,z)},S.rebuild=function(){if(a!==S&&(A=J(a.getLevel())),h.call(S),a===S)for(var z in s)s[z].rebuild()},A=J(a?a.getLevel():"WARN");var L=M();L!=null&&(R=J(L)),h.call(S)}a=new y,a.getLogger=function(b){if(typeof b!="symbol"&&typeof b!="string"||b==="")throw new TypeError("You must supply a name when creating a logger.");var S=s[b];return S||(S=s[b]=new y(b,a.methodFactory)),S};var C=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=C),a},a.getLoggers=function(){return s},a.default=a,a})}(Pp)),Pp.exports}var EU=kU();const TU=kc(EU);function qr(n){return typeof n=="function"}function T2(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Vv=T2(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function aC(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Rg=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,i,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=gd(a),d=c.next();!d.done;d=c.next()){var f=d.value;f.remove(this)}}catch(x){e={error:x}}finally{try{d&&!d.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else a.remove(this);var h=this.initialTeardown;if(qr(h))try{h()}catch(x){s=x instanceof Vv?x.errors:[x]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var m=gd(v),y=m.next();!y.done;y=m.next()){var C=y.value;try{qS(C)}catch(x){s=s??[],x instanceof Vv?s=_y(_y([],Ty(s)),Ty(x.errors)):s.push(x)}}}catch(x){r={error:x}}finally{try{y&&!y.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}}if(s)throw new Vv(s)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)qS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&aC(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&aC(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),_2=Rg.EMPTY;function R2(n){return n instanceof Rg||n&&"closed"in n&&qr(n.remove)&&qr(n.add)&&qr(n.unsubscribe)}function qS(n){qr(n)?n():n.unsubscribe()}var _U={Promise:void 0},RU={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,_y([n,e],Ty(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function D2(n){RU.setTimeout(function(){throw n})}function cC(){}function Np(n){n()}var y1=function(n){_d(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,R2(t)&&t.add(r)):r.destination=NU,r}return e.create=function(t,r,i){return new lC(t,r,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Rg),DU=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){k0(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){k0(r)}else k0(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){k0(t)}},n}(),lC=function(n){_d(e,n);function e(t,r,i){var s=n.call(this)||this,a;return qr(t)||!t?a={next:t??void 0,error:r??void 0,complete:i??void 0}:a=t,s.destination=new DU(a),s}return e}(y1);function k0(n){D2(n)}function PU(n){throw n}var NU={closed:!0,next:cC,error:PU,complete:cC},C1=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function P2(n){return n}function MU(n){return n.length===0?P2:n.length===1?n[0]:function(t){return n.reduce(function(r,i){return i(r)},t)}}var yi=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,s=OU(e)?e:new lC(e,t,r);return Np(function(){var a=i,c=a.operator,d=a.source;s.add(c?c.call(s,d):d?i._subscribe(s):i._trySubscribe(s))}),s},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=JS(t),new t(function(i,s){var a=new lC({next:function(c){try{e(c)}catch(d){s(d),a.unsubscribe()}},error:s,complete:i});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[C1]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return MU(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=JS(e),new e(function(r,i){var s;t.subscribe(function(a){return s=a},function(a){return i(a)},function(){return r(s)})})},n.create=function(e){return new n(e)},n}();function JS(n){var e;return(e=n??_U.Promise)!==null&&e!==void 0?e:Promise}function BU(n){return n&&qr(n.next)&&qr(n.error)&&qr(n.complete)}function OU(n){return n&&n instanceof y1||BU(n)&&R2(n)}function FU(n){return qr(n==null?void 0:n.lift)}function _c(n){return function(e){if(FU(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function hu(n,e,t,r,i){return new LU(n,e,t,r,i)}var LU=function(n){_d(e,n);function e(t,r,i,s,a,c){var d=n.call(this,t)||this;return d.onFinalize=a,d.shouldUnsubscribe=c,d._next=r?function(f){try{r(f)}catch(h){t.error(h)}}:n.prototype._next,d._error=s?function(f){try{s(f)}catch(h){t.error(h)}finally{this.unsubscribe()}}:n.prototype._error,d._complete=i?function(){try{i()}catch(f){t.error(f)}finally{this.unsubscribe()}}:n.prototype._complete,d}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(y1),UU=T2(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),yl=function(n){_d(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new YS(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new UU},e.prototype.next=function(t){var r=this;Np(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=gd(r.currentObservers),c=a.next();!c.done;c=a.next()){var d=c.value;d.next(t)}}catch(f){i={error:f}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;Np(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;Np(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,s=i.hasError,a=i.isStopped,c=i.observers;return s||a?_2:(this.currentObservers=null,c.push(t),new Rg(function(){r.currentObservers=null,aC(c,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,s=r.thrownError,a=r.isStopped;i?t.error(s):a&&t.complete()},e.prototype.asObservable=function(){var t=new yi;return t.source=this,t},e.create=function(t,r){return new YS(t,r)},e}(yi),YS=function(n){_d(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:_2},e}(yl),N2=function(n){_d(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,i=t.thrownError,s=t._value;if(r)throw i;return this._throwIfClosed(),s},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(yl);function GU(n){return n&&qr(n.schedule)}function VU(n){return n[n.length-1]}function M2(n){return GU(VU(n))?n.pop():void 0}var B2=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function O2(n){return qr(n==null?void 0:n.then)}function F2(n){return qr(n[C1])}function L2(n){return Symbol.asyncIterator&&qr(n==null?void 0:n[Symbol.asyncIterator])}function U2(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function jU(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var G2=jU();function V2(n){return qr(n==null?void 0:n[G2])}function j2(n){return G8(this,arguments,function(){var t,r,i,s;return CE(this,function(a){switch(a.label){case 0:t=n.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Qu(t.read())];case 3:return r=a.sent(),i=r.value,s=r.done,s?[4,Qu(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Qu(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function W2(n){return qr(n==null?void 0:n.getReader)}function Md(n){if(n instanceof yi)return n;if(n!=null){if(F2(n))return WU(n);if(B2(n))return zU(n);if(O2(n))return HU(n);if(L2(n))return z2(n);if(V2(n))return ZU(n);if(W2(n))return XU(n)}throw U2(n)}function WU(n){return new yi(function(e){var t=n[C1]();if(qr(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function zU(n){return new yi(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function HU(n){return new yi(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,D2)})}function ZU(n){return new yi(function(e){var t,r;try{for(var i=gd(n),s=i.next();!s.done;s=i.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()})}function z2(n){return new yi(function(e){$U(n,e).catch(function(t){return e.error(t)})})}function XU(n){return z2(j2(n))}function $U(n,e){var t,r,i,s;return U8(this,void 0,void 0,function(){var a,c;return CE(this,function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),t=V8(n),d.label=1;case 1:return[4,t.next()];case 2:if(r=d.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=d.sent(),i={error:c},[3,11];case 6:return d.trys.push([6,,9,10]),r&&!r.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function ru(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function H2(n,e){return e===void 0&&(e=0),_c(function(t,r){t.subscribe(hu(r,function(i){return ru(r,n,function(){return r.next(i)},e)},function(){return ru(r,n,function(){return r.complete()},e)},function(i){return ru(r,n,function(){return r.error(i)},e)}))})}function Z2(n,e){return e===void 0&&(e=0),_c(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function KU(n,e){return Md(n).pipe(Z2(e),H2(e))}function qU(n,e){return Md(n).pipe(Z2(e),H2(e))}function JU(n,e){return new yi(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function YU(n,e){return new yi(function(t){var r;return ru(t,e,function(){r=n[G2](),ru(t,e,function(){var i,s,a;try{i=r.next(),s=i.value,a=i.done}catch(c){t.error(c);return}a?t.complete():t.next(s)},0,!0)}),function(){return qr(r==null?void 0:r.return)&&r.return()}})}function X2(n,e){if(!n)throw new Error("Iterable cannot be null");return new yi(function(t){ru(t,e,function(){var r=n[Symbol.asyncIterator]();ru(t,e,function(){r.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function QU(n,e){return X2(j2(n),e)}function eG(n,e){if(n!=null){if(F2(n))return KU(n,e);if(B2(n))return JU(n,e);if(O2(n))return qU(n,e);if(L2(n))return X2(n,e);if(V2(n))return YU(n,e);if(W2(n))return QU(n,e)}throw U2(n)}function tG(n,e){return e?eG(n,e):Md(n)}function Yi(n,e){return _c(function(t,r){var i=0;t.subscribe(hu(r,function(s){r.next(n.call(e,s,i++))}))})}function nG(n,e,t,r,i,s,a,c){var d=[],f=0,h=0,v=!1,m=function(){v&&!d.length&&!f&&e.complete()},y=function(x){return f<r?C(x):d.push(x)},C=function(x){f++;var b=!1;Md(t(x,h++)).subscribe(hu(e,function(S){e.next(S)},function(){b=!0},void 0,function(){if(b)try{f--;for(var S=function(){var A=d.shift();a||C(A)};d.length&&f<r;)S();m()}catch(A){e.error(A)}}))};return n.subscribe(hu(e,y,function(){v=!0,m()})),function(){}}function $2(n,e,t){return t===void 0&&(t=1/0),qr(e)?$2(function(r,i){return Yi(function(s,a){return e(r,s,i,a)})(Md(n(r,i)))},t):(typeof e=="number"&&(t=e),_c(function(r,i){return nG(r,i,n,t)}))}function rG(n){return $2(P2,n)}function iG(){return rG(1)}function uC(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return iG()(tG(n,M2(n)))}function K2(n,e){return _c(function(t,r){var i=0;t.subscribe(hu(r,function(s){return n.call(e,s,i++)&&r.next(s)}))})}function sG(n,e,t,r,i){return function(s,a){var c=t,d=e,f=0;s.subscribe(hu(a,function(h){var v=f++;d=c?n(d,h,v):(c=!0,h),a.next(d)},i))}}function oG(n){return _c(function(e,t){try{e.subscribe(t)}finally{t.add(n)}})}function aG(n,e){return _c(sG(n,e,arguments.length>=2,!0))}function Vo(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=M2(n);return _c(function(r,i){(t?uC(n,r,t):uC(n,r)).subscribe(i)})}function QS(n){return _c(function(e,t){Md(n).subscribe(hu(t,function(){return t.complete()},cC)),!t.closed&&e.subscribe(t)})}var cG=Object.defineProperty,lG=Object.defineProperties,uG=Object.getOwnPropertyDescriptors,og=Object.getOwnPropertySymbols,q2=Object.prototype.hasOwnProperty,J2=Object.prototype.propertyIsEnumerable,eA=(n,e,t)=>e in n?cG(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dC=(n,e)=>{for(var t in e||(e={}))q2.call(e,t)&&eA(n,t,e[t]);if(og)for(var t of og(e))J2.call(e,t)&&eA(n,t,e[t]);return n},dG=(n,e)=>lG(n,uG(e)),fG=(n,e)=>{var t={};for(var r in n)q2.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&og)for(var r of og(n))e.indexOf(r)<0&&J2.call(n,r)&&(t[r]=n[r]);return t},Rc=(n,e,t)=>new Promise((r,i)=>{var s=d=>{try{c(t.next(d))}catch(f){i(f)}},a=d=>{try{c(t.throw(d))}catch(f){i(f)}},c=d=>d.done?r(d.value):Promise.resolve(d.value).then(s,a);c((t=t.apply(n,e)).next())}),Y2="lk";function x1(n){return typeof n>"u"?!1:hG(n)||pG(n)}function hG(n){var e;return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("track")&&typeof((e=n.publication)==null?void 0:e.track)<"u":!1}function pG(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("publication")&&typeof n.publication<"u":!1}function gG(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&typeof n.publication>"u":!1}function Q2(n){if(typeof n=="string"||typeof n=="number")return`${n}`;if(gG(n))return`${n.participant.identity}_${n.source}_placeholder`;if(x1(n))return`${n.participant.identity}_${n.publication.source}_${n.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${n}`)}function mG(n){return n instanceof rC}function vG(n,e){return Rc(this,null,function*(){const{x:t,y:r}=yield SU(n,e,{placement:"top",middleware:[wU(6),bU(),IU({padding:5})]});return{x:t,y:r}})}function yG(n,e){return!n.contains(e.target)}var CG=[qe.ConnectionStateChanged,qe.RoomMetadataChanged,qe.ActiveSpeakersChanged,qe.ConnectionQualityChanged,qe.ParticipantConnected,qe.ParticipantDisconnected,qe.ParticipantPermissionsChanged,qe.ParticipantMetadataChanged,qe.TrackMuted,qe.TrackUnmuted,qe.TrackPublished,qe.TrackUnpublished,qe.TrackStreamStateChanged,qe.TrackSubscriptionFailed,qe.TrackSubscriptionPermissionChanged,qe.TrackSubscriptionStatusChanged],xG=[...CG,qe.LocalTrackPublished,qe.LocalTrackUnpublished],wG=[rt.ConnectionQualityChanged,rt.IsSpeakingChanged,rt.ParticipantMetadataChanged,rt.ParticipantPermissionsChanged,rt.TrackMuted,rt.TrackUnmuted,rt.TrackPublished,rt.TrackUnpublished,rt.TrackStreamStateChanged,rt.TrackSubscriptionFailed,rt.TrackSubscriptionPermissionChanged,rt.TrackSubscriptionStatusChanged];[...wG,rt.LocalTrackPublished,rt.LocalTrackUnpublished];var Wn=TU.getLogger("lk-components-js");Wn.setDefaultLevel("WARN");function IG(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var bG=[],SG={showChat:!1,unreadMessages:0};function w1(n,...e){return new yi(r=>{const i=()=>{r.next(n)};return e.forEach(a=>{n.on(a,i)}),()=>{e.forEach(a=>{n.off(a,i)})}}).pipe(Vo(n))}function I1(n,e){return new yi(r=>{const i=(...a)=>{r.next(a)};return n.on(e,i),()=>{n.off(e,i)}})}function AG(n){return I1(n,qe.ConnectionStateChanged).pipe(Yi(([e])=>e),Vo(n.state))}function kG(n,e,t=!0){var r;const i=()=>Rc(this,null,function*(){try{const c=yield ng.getLocalDevices(n,t);s.next(c)}catch(c){e==null||e(c)}}),s=new yl,a=s.pipe(oG(()=>{var c;(c=navigator==null?void 0:navigator.mediaDevices)==null||c.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return uC(ng.getLocalDevices(n,t).catch(c=>e==null?void 0:e(c)),a)}function EG(n){return I1(n,qe.DataReceived)}function TG(n){return w1(n,qe.AudioPlaybackStatusChanged).pipe(Yi(t=>({canPlayAudio:t.canPlaybackAudio})))}function _G(n){return w1(n,qe.VideoPlaybackStatusChanged).pipe(Yi(t=>({canPlayVideo:t.canPlaybackVideo})))}function RG(n,e){return I1(n,qe.ActiveDeviceChanged).pipe(K2(([t])=>t===e),Yi(([t,r])=>(Wn.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:t,deviceId:r}),r)),Vo(n.getActiveDevice(e)))}function ro(n){return`${Y2}-${n}`}function DG(n){const e=fC(n),t=S1(n.participant).pipe(Yi(()=>fC(n)),Vo(e));return{className:ro(n.source===Xe.Source.Camera||n.source===Xe.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:t}}function fC(n){if(x1(n))return n.publication;{const{source:e,name:t,participant:r}=n;if(e&&t)return r.getTracks().find(i=>i.source===e&&i.trackName===t);if(t)return r.getTrackByName(t);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function b1(n,...e){return new yi(r=>{const i=()=>{r.next(n)};return e.forEach(a=>{n.on(a,i)}),()=>{e.forEach(a=>{n.off(a,i)})}}).pipe(Vo(n))}function S1(n){return b1(n,rt.TrackMuted,rt.TrackUnmuted,rt.ParticipantPermissionsChanged,rt.TrackPublished,rt.TrackUnpublished,rt.LocalTrackPublished,rt.LocalTrackUnpublished,rt.MediaDevicesError,rt.TrackSubscriptionStatusChanged).pipe(Yi(t=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:s}=t,a=t.getTrack(Xe.Source.Microphone),c=t.getTrack(Xe.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:s,cameraTrack:c,microphoneTrack:a,participant:t}}))}function PG(n){return b1(n,rt.ParticipantMetadataChanged).pipe(Yi(({name:t,identity:r,metadata:i})=>({name:t,identity:r,metadata:i})),Vo({name:n.name,identity:n.identity,metadata:n.metadata}))}function NG(n){return A1(n,rt.ConnectionQualityChanged).pipe(Yi(([t])=>t),Vo(n.connectionQuality))}function A1(n,e){return new yi(r=>{const i=(...a)=>{r.next(a)};return n.on(e,i),()=>{n.off(e,i)}})}function e_(n){var e,t,r,i;return b1(n.participant,rt.TrackMuted,rt.TrackUnmuted,rt.TrackSubscribed,rt.TrackUnsubscribed,rt.LocalTrackPublished,rt.LocalTrackUnpublished).pipe(Yi(s=>{var a,c;const d=(a=n.publication)!=null?a:s.getTrack(n.source);return(c=d==null?void 0:d.isMuted)!=null?c:!0}),Vo((i=(r=(e=n.publication)==null?void 0:e.isMuted)!=null?r:(t=n.participant.getTrack(n.source))==null?void 0:t.isMuted)!=null?i:!0))}function MG(n){return A1(n,rt.IsSpeakingChanged).pipe(Yi(([e])=>e))}function BG(n,e={}){var t;let r;const i=new yi(d=>(r=d,()=>c.unsubscribe())).pipe(Vo(Array.from(n.participants.values()))),s=(t=e.additionalRoomEvents)!=null?t:xG,a=Array.from(new Set([qe.ParticipantConnected,qe.ParticipantDisconnected,qe.ConnectionStateChanged,...s])),c=w1(n,...a).subscribe(d=>r==null?void 0:r.next(Array.from(d.participants.values())));return n.participants.size>0&&(r==null||r.next(Array.from(n.participants.values()))),i}function OG(n){return A1(n,rt.ParticipantPermissionsChanged).pipe(Yi(()=>n.permissions),Vo(n.permissions))}function FG(n,e,t){const{localParticipant:r}=e,i=(f,h)=>{let v=!1;switch(f){case Xe.Source.Camera:v=h.isCameraEnabled;break;case Xe.Source.Microphone:v=h.isMicrophoneEnabled;break;case Xe.Source.ScreenShare:v=h.isScreenShareEnabled;break}return v},s=S1(r).pipe(Yi(f=>i(n,f.participant)),Vo(i(n,r))),a=new yl,c=(f,h)=>Rc(this,null,function*(){try{switch(h??(h=t),a.next(!0),n){case Xe.Source.Camera:yield r.setCameraEnabled(f??!r.isCameraEnabled,h);break;case Xe.Source.Microphone:yield r.setMicrophoneEnabled(f??!r.isMicrophoneEnabled,h);break;case Xe.Source.ScreenShare:yield r.setScreenShareEnabled(f??!r.isScreenShareEnabled,h);break;default:break}}finally{a.next(!1)}});return{className:ro("button"),toggle:c,enabledObserver:s,pendingObserver:a.asObservable()}}function LG(){let n=!1;const e=new yl,t=new yl,r=s=>{t.next(!0),n=s??!n,e.next(n),t.next(!1)};return{className:ro("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:t.asObservable()}}function UG(n,e,t){const r=new N2(void 0),i=e?RG(e,n):r.asObservable(),s=(c,...d)=>Rc(this,[c,...d],function*(f,h={}){var v,m,y;if(e){Wn.debug(`Switching active device of kind "${n}" with id ${f}.`),yield e.switchActiveDevice(n,f,h.exact);const C=(v=e.getActiveDevice(n))!=null?v:f;C!==f&&f!=="default"&&Wn.info(`We tried to select the device with id (${f}), but the browser decided to select the device with id (${C}) instead.`);let x;n==="audioinput"?x=(m=e.localParticipant.getTrack(Xe.Source.Microphone))==null?void 0:m.track:n==="videoinput"&&(x=(y=e.localParticipant.getTrack(Xe.Source.Camera))==null?void 0:y.track);const b=f==="default"&&!x||f==="default"&&(x==null?void 0:x.mediaStreamTrack.label.startsWith("Default"));r.next(b?f:C)}else if(t){yield t.setDeviceId(h.exact?{exact:f}:f);const C=yield t.getDeviceId();r.next(f==="default"&&t.mediaStreamTrack.label.startsWith("Default")?f:C)}else r.value!==f&&(Wn.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(f))});return{className:ro("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:s}}function GG(n){const e=r=>{n.disconnect(r)};return{className:ro("disconnect-button"),disconnect:e}}function VG(n){const e=ro("connection-quality"),t=NG(n);return{className:e,connectionQualityObserver:t}}function jG(n){let e="track-muted-indicator-camera";switch(n.source){case Xe.Source.Camera:e="track-muted-indicator-camera";break;case Xe.Source.Microphone:e="track-muted-indicator-microphone";break}const t=ro(e),r=e_(n);return{className:t,mediaMutedObserver:r}}function WG(n){return{className:"lk-participant-name",infoObserver:PG(n)}}function zG(){return{className:ro("participant-tile")}}var HG={CHAT:"lk-chat-topic"};function t_(n,e,t){return Rc(this,arguments,function*(r,i,s,a={}){const{kind:c,destination:d}=a;yield r.publishData(i,c??Xr.RELIABLE,{destination:d,topic:s})})}function ZG(n,e,t){const r=EG(n).pipe(K2(([,,,c])=>e===void 0||c===e),Yi(([c,d,,f])=>({payload:c,topic:f,from:d})));let i;const s=new yi(c=>{i=c});return{messageObservable:r,isSendingObservable:s,send:(c,...d)=>Rc(this,[c,...d],function*(f,h={}){i.next(!0);try{yield t_(n.localParticipant,f,e,h)}finally{i.next(!1)}})}}var XG=new TextEncoder,$G=new TextDecoder,E0=new Map,KG=n=>XG.encode(JSON.stringify({message:n.message,timestamp:n.timestamp})),qG=n=>JSON.parse($G.decode(n));function JG(n,e){var t,r;const i=new yl,{messageDecoder:s,messageEncoder:a,channelTopic:c}=e??{},d=c??HG.CHAT;let f=!1;E0.has(n)||(f=!0);const h=(t=E0.get(n))!=null?t:new Map,v=(r=h.get(d))!=null?r:new yl;if(h.set(d,v),E0.set(n,h),f){const{messageObservable:A}=ZG(n,d);A.pipe(QS(i)).subscribe(v)}const m=s??qG,y=v.pipe(Yi(A=>{const E=m(A.payload);return dG(dC({},E),{from:A.from})}),aG((A,E)=>[...A,E],[]),QS(i)),C=new N2(!1),x=a??KG,b=A=>Rc(this,null,function*(){const E=Date.now(),R=x({message:A,timestamp:E});C.next(!0);try{yield t_(n.localParticipant,R,d,{kind:Xr.RELIABLE}),v.next({payload:R,topic:d,from:n.localParticipant})}finally{C.next(!1)}});function S(){i.next(),i.complete(),E0.clear()}return n.once(qe.Disconnected,S),{messageObservable:y,isSendingObservable:C,send:b}}function YG(){const n=t=>Rc(this,null,function*(){Wn.info("Start Audio for room: ",t),yield t.startAudio()});return{className:ro("start-audio-button"),roomAudioPlaybackAllowedObservable:TG,handleStartAudioPlayback:n}}function QG(){const n=t=>Rc(this,null,function*(){Wn.info("Start Video for room: ",t),yield t.startVideo()});return{className:ro("start-audio-button"),roomVideoPlaybackAllowedObservable:_G,handleStartVideoPlayback:n}}function eV(){return{className:[ro("button"),ro("chat-toggle")].join(" ")}}function tV(){return{className:"lk-room-container"}}function nV(n,e){if(typeof localStorage>"u"){Wn.error("Local storage is not available.");return}try{localStorage.setItem(n,JSON.stringify(e))}catch(t){Wn.error(`Error setting item to local storage: ${t}`)}}function rV(n){if(typeof localStorage>"u"){Wn.error("Local storage is not available.");return}try{const e=localStorage.getItem(n);if(!e){Wn.warn(`Item with key ${n} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Wn.error(`Error getting item from local storage: ${e}`);return}}function iV(n){return{load:()=>rV(n),save:e=>nV(n,e)}}var sV=`${Y2}-user-choices`,zl={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:oV,save:aV}=iV(sV);function cV(n,e=!1){if(e===!0)return;const t=n,{e2ee:r,sharedPassphrase:i}=t,s=fG(t,["e2ee","sharedPassphrase"]);aV(s)}function lV(n,e=!1){var t,r,i,s,a,c,d;const f={videoEnabled:(t=n==null?void 0:n.videoEnabled)!=null?t:zl.videoEnabled,audioEnabled:(r=n==null?void 0:n.audioEnabled)!=null?r:zl.audioEnabled,videoDeviceId:(i=n==null?void 0:n.videoDeviceId)!=null?i:zl.videoDeviceId,audioDeviceId:(s=n==null?void 0:n.audioDeviceId)!=null?s:zl.audioDeviceId,username:(a=n==null?void 0:n.username)!=null?a:zl.username,e2ee:(c=n==null?void 0:n.e2ee)!=null?c:zl.e2ee,sharedPassphrase:(d=n==null?void 0:n.sharedPassphrase)!=null?d:zl.sharedPassphrase};if(e)return f;{const h=oV();return dC(dC({},f),h??{})}}function n_(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=n_(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function uV(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=n_(n))&&(r&&(r+=" "),r+=e);return r}var dV=Object.defineProperty,fV=Object.defineProperties,hV=Object.getOwnPropertyDescriptors,ag=Object.getOwnPropertySymbols,r_=Object.prototype.hasOwnProperty,i_=Object.prototype.propertyIsEnumerable,tA=(n,e,t)=>e in n?dV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,on=(n,e)=>{for(var t in e||(e={}))r_.call(e,t)&&tA(n,t,e[t]);if(ag)for(var t of ag(e))i_.call(e,t)&&tA(n,t,e[t]);return n},Bi=(n,e)=>fV(n,hV(e)),Ci=(n,e)=>{var t={};for(var r in n)r_.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ag)for(var r of ag(n))e.indexOf(r)<0&&i_.call(n,r)&&(t[r]=n[r]);return t},s_=(n,e,t)=>new Promise((r,i)=>{var s=d=>{try{c(t.next(d))}catch(f){i(f)}},a=d=>{try{c(t.throw(d))}catch(f){i(f)}},c=d=>d.done?r(d.value):Promise.resolve(d.value).then(s,a);c((t=t.apply(n,e)).next())});function Os(n,e){const[t,r]=F.useState(e);return F.useEffect(()=>{if(typeof window>"u"||!n)return;const i=n.subscribe(r);return()=>i.unsubscribe()},[n]),t}function pV(n){const e=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[t,r]=F.useState(e(n));function i(){r(e(n))}return F.useEffect(()=>{const s=window.matchMedia(n);return i(),s.addListener?s.addListener(i):s.addEventListener("change",i),()=>{s.removeListener?s.removeListener(i):s.removeEventListener("change",i)}},[n]),t}function gV(n,e){if(e.msg==="show_chat")return Bi(on({},n),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Bi(on({},n),{showChat:!1});if(e.msg==="toggle_chat"){const t=Bi(on({},n),{showChat:!n.showChat});return t.showChat===!0&&(t.unreadMessages=0),t}else return e.msg==="unread_msg"?Bi(on({},n),{unreadMessages:e.count}):on({},n)}function mV(n,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:on({},n)}var k1=F.createContext(void 0);function vV(){const n=F.useContext(k1);if(!n)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return n}function yV(n){const[e,t]=F.useReducer(mV,bG),[r,i]=F.useReducer(gV,SG);return n??{pin:{dispatch:t,state:e},widget:{dispatch:i,state:r}}}function o_(){return F.useContext(k1)}var CV=F.createContext(void 0);function Ch(){return F.useContext(CV)}var E1=F.createContext(void 0);function Dg(){return F.useContext(E1)}function xu(n){var e;const t=Dg(),r=Ch(),i=(e=n??t)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var T1=F.createContext(void 0);function Pg(){const n=F.useContext(T1);if(!n)throw Error("tried to access room context outside of livekit room component");return n}function Ng(){return F.useContext(T1)}function xh(n){const e=Ng(),t=n??e;if(!t)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return t}var xV=F.createContext(void 0);function wV(...n){return(...e)=>{for(const t of n)typeof t=="function"&&t(...e)}}function Sl(...n){const e=on({},n[0]);for(let t=1;t<n.length;t++){const r=n[t];for(const i in r){const s=e[i],a=r[i];typeof s=="function"&&typeof a=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=wV(s,a):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof a=="string"?e[i]=uV(s,a):e[i]=a!==void 0?a:s}}return e}function IV(n={}){const e=xu(n.participant),{className:t,connectionQualityObserver:r}=F.useMemo(()=>VG(e),[e]),i=Os(r,Ys.Unknown);return{className:t,quality:i}}function bV(n){const e=xh(n),t=F.useMemo(()=>AG(e),[e]);return Os(t,e.state)}function SV(n){const e=Pg(),t=bV(e);return{buttonProps:F.useMemo(()=>{const{className:i,disconnect:s}=GG(e);return Sl(n,{className:i,onClick:()=>{var c;return s((c=n.stopTracks)!=null?c:!0)},disabled:t===Mn.Disconnected})},[e,n,t])}}function AV(n){if(n.publication instanceof Qf){const e=n.publication.track;if(e){const{facingMode:t}=R7(e);return t}}return"undefined"}function nA(n,e={}){var t,r;const i=typeof n=="string"?e.participant:n.participant,s=xu(i),a=typeof n=="string"?{participant:s,source:n}:n,[c,d]=F.useState(!!((t=a.publication)!=null&&t.isMuted||(r=s.getTrack(a.source))!=null&&r.isMuted));return F.useEffect(()=>{const f=e_(a).subscribe(d);return()=>f.unsubscribe()},[Q2(a)]),c}function kV(n){const e=xu(n),t=F.useMemo(()=>MG(e),[e]);return Os(t,e.isSpeaking)}var EV={connect:!0,audio:!1,video:!1};function TV(n){const e=on(on({},EV),n),{token:t,serverUrl:r,options:i,room:s,connectOptions:a,connect:c,audio:d,video:f,screen:h,onConnected:v,onDisconnected:m,onError:y,onMediaDeviceFailure:C,onEncryptionError:x,simulateParticipants:b}=e,S=Ci(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&s&&Wn.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[A,E]=F.useState();F.useEffect(()=>{E(s??new ng(i))},[s]);const R=F.useMemo(()=>{const{className:N}=tV();return Sl(S,{className:N})},[S]);return F.useEffect(()=>{if(!A)return;const N=()=>{const j=A.localParticipant;Wn.debug("trying to publish local tracks"),Promise.all([j.setMicrophoneEnabled(!!d,typeof d!="boolean"?d:void 0),j.setCameraEnabled(!!f,typeof f!="boolean"?f:void 0),j.setScreenShareEnabled(!!h,typeof h!="boolean"?h:void 0)]).catch(J=>{Wn.warn(J),y==null||y(J)})},V=j=>{const J=Jf.getFailure(j);C==null||C(J)},M=j=>{x==null||x(j)};return A.on(qe.SignalConnected,N).on(qe.MediaDevicesError,V).on(qe.EncryptionError,M),()=>{A.off(qe.SignalConnected,N).off(qe.MediaDevicesError,V).off(qe.EncryptionError,M)}},[A,d,f,h,y,x,C]),F.useEffect(()=>{if(A){if(b){A.simulateParticipants({participants:{count:b},publish:{audio:!0,useRealTracks:!0}});return}if(!t){Wn.debug("no token yet");return}if(!r){Wn.warn("no livekit url provided"),y==null||y(Error("no livekit url provided"));return}c?(Wn.debug("connecting"),A.connect(r,t,a).catch(N=>{Wn.warn(N),y==null||y(N)})):(Wn.debug("disconnecting because connect is false"),A.disconnect())}},[c,t,JSON.stringify(a),A,y,r,b]),F.useEffect(()=>{if(!A)return;const N=V=>{switch(V){case Mn.Disconnected:m&&m();break;case Mn.Connected:v&&v();break}};return A.on(qe.ConnectionStateChanged,N),()=>{A.off(qe.ConnectionStateChanged,N)}},[t,v,m,A]),F.useEffect(()=>{if(A)return()=>{Wn.info("disconnecting on onmount"),A.disconnect()}},[A]),{room:A,htmlProps:R}}function _V(n={}){const e=xh(n.room),[t,r]=F.useState(e.localParticipant),[i,s]=F.useState(t.isMicrophoneEnabled),[a,c]=F.useState(t.isMicrophoneEnabled),[d,f]=F.useState(t.lastMicrophoneError),[h,v]=F.useState(t.lastCameraError),[m,y]=F.useState(t.isMicrophoneEnabled),[C,x]=F.useState(void 0),[b,S]=F.useState(void 0),A=E=>{c(E.isCameraEnabled),s(E.isMicrophoneEnabled),y(E.isScreenShareEnabled),S(E.cameraTrack),x(E.microphoneTrack),f(E.participant.lastMicrophoneError),v(E.participant.lastCameraError),r(E.participant)};return F.useEffect(()=>{const E=S1(t).subscribe(A);return()=>E.unsubscribe()},[t]),{isMicrophoneEnabled:i,isScreenShareEnabled:m,isCameraEnabled:a,microphoneTrack:C,cameraTrack:b,lastMicrophoneError:d,lastCameraError:h,localParticipant:t}}function RV(){const n=Pg(),e=F.useMemo(()=>OG(n.localParticipant),[n]);return Os(e,n.localParticipant.permissions)}function DV({kind:n,room:e,track:t,requestPermissions:r,onError:i}){const s=Ng(),a=F.useMemo(()=>kG(n,i,r),[n,r,i]),c=Os(a,[]),[d,f]=F.useState(""),{className:h,activeDeviceObservable:v,setActiveMediaDevice:m}=F.useMemo(()=>UG(n,e??s,t),[n,e,s,t]);return F.useEffect(()=>{const y=v.subscribe(C=>{Wn.info("setCurrentDeviceId",C),C&&f(C)});return()=>{y==null||y.unsubscribe()}},[v]),{devices:c,className:h,activeDeviceId:d,setActiveMediaDevice:m}}function PV(n){return n!==void 0}function Bd(...n){return Sl(...n.filter(PV))}function a_(n,e,t){return F.Children.map(n,r=>F.isValidElement(r)&&F.Children.only(n)?F.cloneElement(r,Bi(on({},e),{key:t})):r)}function c_(n,e={}){var t;const[r,i]=F.useState(fC(n)),[s,a]=F.useState(r==null?void 0:r.isMuted),[c,d]=F.useState(r==null?void 0:r.isSubscribed),[f,h]=F.useState(r==null?void 0:r.track),[v,m]=F.useState("landscape"),y=F.useRef(),{className:C,trackObserver:x}=F.useMemo(()=>DG(n),[(t=n.participant.sid)!=null?t:n.participant.identity,n.source,x1(n)&&n.publication.trackSid]);return F.useEffect(()=>{const b=x.subscribe(S=>{Wn.debug("update track",S),i(S),a(S==null?void 0:S.isMuted),d(S==null?void 0:S.isSubscribed),h(S==null?void 0:S.track)});return()=>b==null?void 0:b.unsubscribe()},[x]),F.useEffect(()=>{var b,S;return f&&(y.current&&f.detach(y.current),(b=e.element)!=null&&b.current&&!(mG(n.participant)&&(f==null?void 0:f.kind)==="audio")&&f.attach(e.element.current)),y.current=(S=e.element)==null?void 0:S.current,()=>{y.current&&(f==null||f.detach(y.current))}},[f,e.element]),F.useEffect(()=>{var b,S;if(typeof((b=r==null?void 0:r.dimensions)==null?void 0:b.width)=="number"&&typeof((S=r==null?void 0:r.dimensions)==null?void 0:S.height)=="number"){const A=r.dimensions.width>r.dimensions.height?"landscape":"portrait";m(A)}},[r]),{publication:r,isMuted:s,isSubscribed:c,track:f,elementProps:Bd(e.props,on({className:C,"data-lk-local-participant":n.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":v}))}}function NV({trackRef:n,participant:e,source:t,publication:r,onParticipantClick:i,disableSpeakingIndicator:s,htmlProps:a}){const c=Ch(),d=xu(e),f=F.useMemo(()=>{var x,b,S,A,E,R;const N=(b=(x=n==null?void 0:n.source)!=null?x:c==null?void 0:c.source)!=null?b:t;if(N===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(A=(S=n==null?void 0:n.participant)!=null?S:c==null?void 0:c.participant)!=null?A:d,publication:(R=(E=n==null?void 0:n.publication)!=null?E:c==null?void 0:c.publication)!=null?R:r,source:N}},[n==null?void 0:n.participant,n==null?void 0:n.source,n==null?void 0:n.publication,c==null?void 0:c.participant,c==null?void 0:c.source,c==null?void 0:c.publication,d,t,r]),h=F.useMemo(()=>{const{className:x}=zG();return Sl(a,{className:x,onClick:b=>{var S,A;if((S=a.onClick)==null||S.call(a,b),typeof i=="function"){const E=(A=f.publication)!=null?A:f.participant.getTrack(f.source);i({participant:f.participant,track:E})}}})},[a,i,f.publication,f.source,f.participant]),v=nA(Xe.Source.Camera,{participant:f.participant}),m=nA(Xe.Source.Microphone,{participant:f.participant}),y=kV(f.participant),C=AV(f);return{elementProps:on({"data-lk-audio-muted":m,"data-lk-video-muted":v,"data-lk-speaking":s===!0?!1:y,"data-lk-local-participant":f.participant.isLocal,"data-lk-source":f.source,"data-lk-facing-mode":C},h)}}function MV(n={}){const e=xh(n.room),[t,r]=F.useState([]);return F.useEffect(()=>{const i=BG(e,{additionalRoomEvents:n.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(n.updateOnlyOn)]),t}function BV(n={}){const e=MV(n),{localParticipant:t}=_V(n);return[t,...e]}function OV({room:n,props:e}){const t=xh(n),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:s}=F.useMemo(()=>YG(),[]),a=F.useMemo(()=>i(t),[t,i]),{canPlayAudio:c}=Os(a,{canPlayAudio:t.canPlaybackAudio});return{mergedProps:F.useMemo(()=>Sl(e,{className:r,onClick:()=>{s(t)},style:{display:c?"none":"block"}}),[e,r,c,s,t]),canPlayAudio:c}}function FV({room:n,props:e}){const t=xh(n),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:s}=F.useMemo(()=>QG(),[]),a=F.useMemo(()=>i(t),[t,i]),{canPlayVideo:c}=Os(a,{canPlayVideo:t.canPlaybackVideo});return{mergedProps:F.useMemo(()=>Sl(e,{className:r,onClick:()=>{s(t)},style:{display:c?"none":"block"}}),[e,r,c,s,t]),canPlayVideo:c}}function LV({props:n}){const{dispatch:e,state:t}=vV().widget,{className:r}=F.useMemo(()=>eV(),[]);return{mergedProps:F.useMemo(()=>Sl(n,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":t!=null&&t.showChat?"true":"false","data-lk-unread-msgs":t?t.unreadMessages<10?t.unreadMessages.toFixed(0):"9+":"0"}),[n,r,e,t])}}function UV(n,e={}){var t,r,i,s;let a=Ch();const c=(r=(t=Dg())!=null?t:e.participant)!=null?r:a==null?void 0:a.participant;if(typeof n=="string"){if(!c)throw Error("Participant missing, either provide it via context or pass it in directly");a={participant:c,source:n}}else if(n)a=n;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:d,mediaMutedObserver:f}=F.useMemo(()=>jG(a),[Q2(a)]);return{isMuted:Os(f,!!((i=a.publication)!=null&&i.isMuted||(s=a.participant.getTrack(a.source))!=null&&s.isMuted)),className:d}}function GV(n){var e=n,{source:t,onChange:r,initialState:i,captureOptions:s}=e,a=Ci(e,["source","onChange","initialState","captureOptions"]),c;const d=Ng(),f=(c=d==null?void 0:d.localParticipant)==null?void 0:c.getTrack(t),{toggle:h,className:v,pendingObserver:m,enabledObserver:y}=F.useMemo(()=>d?FG(t,d,s):LG(),[d,t,JSON.stringify(s)]),C=Os(m,!1),x=Os(y,i??!!(f!=null&&f.isEnabled));F.useEffect(()=>{r==null||r(x)},[x,r]),F.useEffect(()=>{i!==void 0&&(Wn.debug("forcing initial toggle state",t,i),h(i))},[]);const b=F.useMemo(()=>Sl(a,{className:v}),[a,v]),S=F.useCallback(A=>{var E;h(),(E=a.onClick)==null||E.call(a,A)},[a,h]);return{toggle:h,enabled:x,pending:C,track:f,buttonProps:Bi(on({},b),{"aria-pressed":x,"data-lk-source":t,"data-lk-enabled":x,disabled:C,onClick:S})}}function VV(n,e={}){return c_(n,e)}function jV(n){const e=Pg(),[t,r]=F.useState(),i=Os(t==null?void 0:t.isSendingObservable,!1),s=Os(t==null?void 0:t.messageObservable,[]);return F.useEffect(()=>{const a=JG(e,n);r(a)},[e,n]),{send:t==null?void 0:t.send,chatMessages:s,isSending:i}}function WV(n={}){var e;const[t,r]=F.useState(lV(n.defaults,(e=n.preventLoad)!=null?e:!1)),i=F.useCallback(f=>{r(h=>Bi(on({},h),{audioEnabled:f}))},[]),s=F.useCallback(f=>{r(h=>Bi(on({},h),{videoEnabled:f}))},[]),a=F.useCallback(f=>{r(h=>Bi(on({},h),{audioDeviceId:f}))},[]),c=F.useCallback(f=>{r(h=>Bi(on({},h),{videoDeviceId:f}))},[]),d=F.useCallback(f=>{r(h=>Bi(on({},h),{username:f}))},[]);return F.useEffect(()=>{var f;cV(t,(f=n.preventSave)!=null?f:!1)},[t,n.preventSave]),{userChoices:t,saveAudioInputEnabled:i,saveVideoInputEnabled:s,saveAudioInputDeviceId:a,saveVideoInputDeviceId:c,saveUsername:d}}function zV(n){const{mergedProps:e}=LV({props:n});return F.createElement("button",on({},e),n.children)}function HV(n){const{buttonProps:e}=SV(n);return F.createElement("button",on({},e),n.children)}var ZV=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),F.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),F.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),XV=ZV,$V=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),F.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),KV=$V,qV=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},n),F.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),F.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),JV=qV,YV=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},n),F.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),F.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),QV=YV,ej=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),F.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),F.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),tj=ej,nj=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),F.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),F.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),rj=nj,ij=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},n),F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),sj=ij,oj=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},n),F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("g",{opacity:.25},F.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),aj=oj,cj=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},n),F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("g",{opacity:.25},F.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),F.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),lj=cj,uj=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),F.createElement("g",{opacity:.25},F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),F.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),dj=uj,fj=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},n),F.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),F.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),hj=fj,pj=n=>F.createElement("svg",on({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},n),F.createElement("g",{fill:"currentColor"},F.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),F.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),gj=pj;function jv(n){var e=n,{kind:t,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:s,onDeviceSelectError:a,exactMatch:c,track:d,requestPermissions:f,onError:h}=e,v=Ci(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const m=Ng(),y=F.useCallback(N=>{m&&m.emit(qe.MediaDevicesError,N),h==null||h(N)},[m,h]),{devices:C,activeDeviceId:x,setActiveMediaDevice:b,className:S}=DV({kind:t,room:m,track:d,requestPermissions:f,onError:y});F.useEffect(()=>{r!==void 0&&b(r)},[b]),F.useEffect(()=>{typeof s=="function"&&s(C)},[s,C]),F.useEffect(()=>{x&&x!==""&&(i==null||i(x))},[x]);const A=N=>s_(this,null,function*(){try{yield b(N,{exact:c})}catch(V){if(V instanceof Error)a==null||a(V);else throw V}}),E=F.useMemo(()=>Bd(v,{className:S},{className:"lk-list"}),[S,v]);function R(N,V,M){return N===V||M===0&&V==="default"}return F.createElement("ul",on({},E),C.map((N,V)=>F.createElement("li",{key:N.deviceId,id:N.deviceId,"data-lk-active":R(N.deviceId,x,V),"aria-selected":R(N.deviceId,x,V),role:"option"},F.createElement("button",{className:"lk-button",onClick:()=>A(N.deviceId)},N.label))))}function l_(n,e){switch(n){case Xe.Source.Microphone:return e?F.createElement(rj,null):F.createElement(tj,null);case Xe.Source.Camera:return e?F.createElement(KV,null):F.createElement(XV,null);case Xe.Source.ScreenShare:return e?F.createElement(gj,null):F.createElement(hj,null);default:return}}function mj(n){switch(n){case Ys.Excellent:return F.createElement(sj,null);case Ys.Good:return F.createElement(aj,null);case Ys.Poor:return F.createElement(lj,null);default:return F.createElement(dj,null)}}function Wv(n){var e=n,{showIcon:t}=e,r=Ci(e,["showIcon"]);const{buttonProps:i,enabled:s}=GV(r);return F.createElement("button",on({},i),(t??!0)&&l_(r.source,s),r.children)}function vj(n){var e;const{className:t,quality:r}=IV(n),i=F.useMemo(()=>Bi(on({},Bd(n,{className:t})),{"data-lk-quality":r}),[r,n,t]);return F.createElement("div",on({},i),(e=n.children)!=null?e:mj(r))}function yj(n){var e=n,{participant:t}=e,r=Ci(e,["participant"]);const i=xu(t),{className:s,infoObserver:a}=F.useMemo(()=>WG(i),[i]),{identity:c,name:d}=Os(a,{name:i.name,identity:i.identity,metadata:i.metadata}),f=F.useMemo(()=>Bd(r,{className:s,"data-lk-participant-name":d}),[r,s,d]);return F.createElement("span",on({},f),d!==""?d:c,r.children)}function Cj(n){var e=n,{source:t,participant:r,trackRef:i,show:s="always"}=e,a=Ci(e,["source","participant","trackRef","show"]),c,d;const{className:f,isMuted:h}=UV(i??t,{participant:r}),v=s==="always"||s==="muted"&&h||s==="unmuted"&&!h,m=F.useMemo(()=>Bd(a,{className:f}),[f,a]);return v?F.createElement("div",Bi(on({},m),{"data-lk-muted":h}),(d=a.children)!=null?d:l_((c=i==null?void 0:i.source)!=null?c:t,!h)):null}function xj(n){var e=n,{trackRef:t,onSubscriptionStatusChanged:r,volume:i,source:s,name:a,publication:c,participant:d}=e,f=Ci(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),h,v,m,y,C,x,b,S,A,E;const R=Ch(),N=(y=(m=(h=t==null?void 0:t.publication)==null?void 0:h.trackName)!=null?m:(v=R==null?void 0:R.publication)==null?void 0:v.trackName)!=null?y:a,V=(x=(C=t==null?void 0:t.source)!=null?C:R==null?void 0:R.source)!=null?x:s,M=(S=(b=t==null?void 0:t.publication)!=null?b:R==null?void 0:R.publication)!=null?S:c,j=(E=(A=t==null?void 0:t.participant)!=null?A:R==null?void 0:R.participant)!=null?E:d;if(V===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const J=F.useRef(null),L=xu(j),{elementProps:z,isSubscribed:Y,track:ie,publication:pe}=c_({source:V,name:N,participant:L,publication:M},{element:J,props:f});return F.useEffect(()=>{r==null||r(!!Y)},[Y,r]),F.useEffect(()=>{ie===void 0||i===void 0||(ie instanceof nu?ie.setVolume(i):Wn.warn("Volume can only be set on remote audio tracks."))},[i,ie]),F.useEffect(()=>{pe===void 0||f.muted===void 0||(pe instanceof p1?pe.setEnabled(!f.muted):Wn.warn("Can only call setEnabled on remote track publications."))},[f.muted,pe,ie]),F.createElement("audio",on({ref:J},z))}function wj(n){const e=!!Dg();return n.participant&&!e?F.createElement(E1.Provider,{value:n.participant},n.children):F.createElement(F.Fragment,null,n.children)}function Ij({value:n,onPinChange:e,onWidgetChange:t,children:r}){const i=yV(n);return F.useEffect(()=>{Wn.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),F.useEffect(()=>{Wn.debug("Widget Updated",{widgetState:i.widget.state}),t&&i.widget.state&&t(i.widget.state)},[t,i.widget.state]),F.createElement(k1.Provider,{value:i},r)}function bj(n){const{room:e,htmlProps:t}=TV(n);return F.createElement("div",on({},t),e&&F.createElement(T1.Provider,{value:e},F.createElement(xV.Provider,{value:n.featureFlags},n.children)))}function Sj(n){var e=n,{participant:t,trackRef:r}=e,i=Ci(e,["participant","trackRef"]),s,a;const[c,d]=F.useState([]),f=200,h=90,v=6,m=4,y=50,C=7,x=(s=Dg())!=null?s:t;let b=(a=Ch())!=null?a:r;if(!b){if(!x)throw Error("Participant missing, provide it directly or within a context");b={participant:x,source:Xe.Source.Microphone}}const{track:S}=VV(b);return F.useEffect(()=>{if(!S||!(S instanceof fs||S instanceof nu))return;const{analyser:A,cleanup:E}=F9(S,{smoothingTimeConstant:.8,fftSize:64}),R=new Uint8Array(A.frequencyBinCount),N=()=>{A.getByteFrequencyData(R);const M=new Array(C).fill(0);R.slice(1);const j=6;for(let J=0;J<C/2;J+=1){const L=Math.floor(C/2-J);for(let z=0;z<j;z+=1)M[L]+=Math.pow(R[J*j+z]/255,2);M[L]/=j}for(let J=0;J<C/2;J+=1){const L=Math.floor(C/2+J);if(M[L]===0){for(let z=0;z<j;z+=1)M[L]+=Math.pow(R[J*j+z]/255,2);M[L]/=j}}return M.map(J=>J*y)},V=setInterval(()=>{const M=N();d(M)},100);return()=>{clearInterval(V),E()}},[S]),F.createElement("svg",Bi(on({width:"100%",height:"100%",viewBox:`0 0 ${f} ${h}`},i),{className:"lk-audio-visualizer"}),F.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),F.createElement("g",{style:{transform:`translate(${(f-C*(v+m))/2}px, 0)`}},c.map((A,E)=>F.createElement("rect",{key:E,x:E*(v+m),y:h/2-A/2,width:v,height:A}))))}function Aj(n){var e=n,{participants:t}=e,r=Ci(e,["participants"]);return F.createElement(F.Fragment,null,t.map(i=>F.createElement(E1.Provider,{value:i,key:i.identity},a_(r.children))))}function kj(n){var e=n,{participant:t,children:r,source:i,publication:s,disableSpeakingIndicator:a,onParticipantClick:c}=e,d=Ci(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const f=xu(t),{elementProps:h}=NV({participant:f,htmlProps:d,disableSpeakingIndicator:a,source:Xe.Source.Microphone,publication:s,onParticipantClick:c});return F.createElement("div",on({style:{position:"relative"}},h),F.createElement(wj,{participant:f},r??F.createElement(F.Fragment,null,F.createElement(xj,{source:i??Xe.Source.Microphone}),F.createElement(Sj,null),F.createElement("div",{className:"lk-participant-metadata"},F.createElement("div",{className:"lk-participant-metadata-item"},F.createElement(Cj,{source:Xe.Source.Microphone}),F.createElement(yj,null)),F.createElement(vj,{className:"lk-participant-metadata-item"})))))}function Ej(n){var e=n,{entry:t,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:s}=e,a=Ci(e,["entry","hideName","hideTimestamp","messageFormatter"]),c,d,f,h;const v=F.useMemo(()=>s?s(t.message):t.message,[t.message,s]),m=new Date(t.timestamp),y=navigator?navigator.language:"en-US";return F.createElement("li",on({className:"lk-chat-entry",title:m.toLocaleTimeString(y,{timeStyle:"full"}),"data-lk-message-origin":(c=t.from)!=null&&c.isLocal?"local":"remote"},a),(!i||!r)&&F.createElement("span",{className:"lk-meta-data"},!r&&F.createElement("strong",{className:"lk-participant-name"},(h=(d=t.from)==null?void 0:d.name)!=null?h:(f=t.from)==null?void 0:f.identity),!i&&F.createElement("span",{className:"lk-timestamp"},m.toLocaleTimeString(y,{timeStyle:"short"}))),F.createElement("span",{className:"lk-message-body"},v))}function Tj(n){var e=n,{messageFormatter:t,messageDecoder:r,messageEncoder:i,channelTopic:s}=e,a=Ci(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const c=F.useRef(null),d=F.useRef(null),f=F.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:s}),[r,i,s]),{send:h,chatMessages:v,isSending:m}=jV(f),y=o_(),C=F.useRef(0);function x(b){return s_(this,null,function*(){b.preventDefault(),c.current&&c.current.value.trim()!==""&&h&&(yield h(c.current.value),c.current.value="",c.current.focus())})}return F.useEffect(()=>{var b;d&&((b=d.current)==null||b.scrollTo({top:d.current.scrollHeight}))},[d,v]),F.useEffect(()=>{var b,S,A,E,R;if(!y||v.length===0)return;if((b=y.widget.state)!=null&&b.showChat&&v.length>0&&C.current!==((S=v[v.length-1])==null?void 0:S.timestamp)){C.current=(A=v[v.length-1])==null?void 0:A.timestamp;return}const N=v.filter(M=>!C.current||M.timestamp>C.current).length,{widget:V}=y;N>0&&((E=V.state)==null?void 0:E.unreadMessages)!==N&&((R=V.dispatch)==null||R.call(V,{msg:"unread_msg",count:N}))},[v,y==null?void 0:y.widget]),F.createElement("div",Bi(on({},a),{className:"lk-chat"}),F.createElement("ul",{className:"lk-list lk-chat-messages",ref:d},a.children?v.map((b,S)=>a_(a.children,{entry:b,key:S,messageFormatter:t})):v.map((b,S,A)=>{const E=S>=1&&A[S-1].from===b.from,R=S>=1&&b.timestamp-A[S-1].timestamp<6e4;return F.createElement(Ej,{key:S,hideName:E,hideTimestamp:E===!1?!1:R,entry:b,messageFormatter:t})})),F.createElement("form",{className:"lk-chat-form",onSubmit:x},F.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:m,ref:c,type:"text",placeholder:"Enter a message..."}),F.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:m},"Send")))}function rA(n){var e=n,{kind:t,initialSelection:r,onActiveDeviceChange:i,tracks:s,requestPermissions:a=!1}=e,c=Ci(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[d,f]=F.useState(!1),[h,v]=F.useState([]),[m,y]=F.useState(!0),C=(A,E)=>{Wn.debug("handle device change"),f(!1),i==null||i(A,E)},x=F.useRef(null),b=F.useRef(null);F.useLayoutEffect(()=>{x.current&&b.current&&(h||m)&&vG(x.current,b.current).then(({x:A,y:E})=>{b.current&&Object.assign(b.current.style,{left:`${A}px`,top:`${E}px`})}),y(!1)},[x,b,h,m]);const S=F.useCallback(A=>{b.current&&A.target!==x.current&&d&&yG(b.current,A)&&f(!1)},[d,b,x]);return F.useEffect(()=>(document.addEventListener("click",S),window.addEventListener("resize",()=>y(!0)),()=>{document.removeEventListener("click",S),window.removeEventListener("resize",()=>y(!0))}),[S,y]),F.createElement(F.Fragment,null,F.createElement("button",Bi(on({className:"lk-button lk-button-menu","aria-pressed":d},c),{onClick:()=>f(!d),ref:x}),c.children),!c.disabled&&F.createElement("div",{className:"lk-device-menu",ref:b,style:{visibility:d?"visible":"hidden"}},t?F.createElement(jv,{initialSelection:r,onActiveDeviceChange:A=>C(t,A),onDeviceListChange:v,kind:t,track:s==null?void 0:s[t],requestPermissions:a}):F.createElement(F.Fragment,null,F.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),F.createElement(jv,{kind:"audioinput",onActiveDeviceChange:A=>C("audioinput",A),onDeviceListChange:v,track:s==null?void 0:s.audioinput,requestPermissions:a}),F.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),F.createElement(jv,{kind:"videoinput",onActiveDeviceChange:A=>C("videoinput",A),onDeviceListChange:v,track:s==null?void 0:s.videoinput,requestPermissions:a}))))}function _j(n){var e=n,{label:t}=e,r=Ci(e,["label"]);const i=Pg(),{mergedProps:s,canPlayAudio:a}=OV({room:i,props:r}),{mergedProps:c,canPlayVideo:d}=FV({room:i,props:s}),f=c,{style:h}=f,v=Ci(f,["style"]);return h.display=a&&d?"none":"block",F.createElement("button",on({style:h},v),t??`Start ${a?"Video":"Audio"}`)}function Rj(n){var e=n,{variation:t,controls:r,saveUserChoices:i=!0}=e,s=Ci(e,["variation","controls","saveUserChoices"]),a,c,d,f,h;const[v,m]=F.useState(!1),y=o_();F.useEffect(()=>{var ie,pe;((ie=y==null?void 0:y.widget.state)==null?void 0:ie.showChat)!==void 0&&m((pe=y==null?void 0:y.widget.state)==null?void 0:pe.showChat)},[(a=y==null?void 0:y.widget.state)==null?void 0:a.showChat]);const x=pV(`(max-width: ${v?1e3:760}px)`)?"minimal":"verbose";t??(t=x);const b=on({leave:!0},r),S=RV();S?((c=b.camera)!=null||(b.camera=S.canPublish),(d=b.microphone)!=null||(b.microphone=S.canPublish),(f=b.screenShare)!=null||(b.screenShare=S.canPublish),(h=b.chat)!=null||(b.chat=S.canPublishData&&(r==null?void 0:r.chat))):(b.camera=!1,b.chat=!1,b.microphone=!1,b.screenShare=!1);const A=F.useMemo(()=>t==="minimal"||t==="verbose",[t]),E=F.useMemo(()=>t==="textOnly"||t==="verbose",[t]),R=IG(),[N,V]=F.useState(!1),M=ie=>{V(ie)},j=Bd({className:"lk-control-bar"},s),{saveAudioInputEnabled:J,saveVideoInputEnabled:L,saveAudioInputDeviceId:z,saveVideoInputDeviceId:Y}=WV({preventSave:!i});return F.createElement("div",on({},j),b.microphone&&F.createElement("div",{className:"lk-button-group"},F.createElement(Wv,{source:Xe.Source.Microphone,showIcon:A,onChange:J},E&&"Microphone"),F.createElement("div",{className:"lk-button-group-menu"},F.createElement(rA,{kind:"audioinput",onActiveDeviceChange:(ie,pe)=>z(pe??"")}))),b.camera&&F.createElement("div",{className:"lk-button-group"},F.createElement(Wv,{source:Xe.Source.Camera,showIcon:A,onChange:L},E&&"Camera"),F.createElement("div",{className:"lk-button-group-menu"},F.createElement(rA,{kind:"videoinput",onActiveDeviceChange:(ie,pe)=>Y(pe??"")}))),b.screenShare&&R&&F.createElement(Wv,{source:Xe.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:A,onChange:M},E&&(N?"Stop screen share":"Share screen")),b.chat&&F.createElement(zV,null,A&&F.createElement(JV,null),E&&"Chat"),b.leave&&F.createElement(HV,null,A&&F.createElement(QV,null),E&&"Leave"),F.createElement(_j,null))}function Dj(n){var e=Ci(n,[]);const[t,r]=F.useState({showChat:!1,unreadMessages:0}),i=BV();return F.createElement(Ij,{onWidgetChange:r},F.createElement("div",on({className:"lk-audio-conference"},e),F.createElement("div",{className:"lk-audio-conference-stage"},F.createElement(Aj,{participants:i},F.createElement(kj,null))),F.createElement(Rj,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),t.showChat&&F.createElement(Tj,null)))}const Pj="wss://mongoose-67t79p35.livekit.cloud",Nj=({client:n})=>{const[e,t]=F.useState([]),[r,i]=F.useState(!1);return F.useEffect(()=>{const s=c=>{t(d=>[...d,c]),i(!0)},a=c=>{t(d=>{const f=d.filter(h=>h!==c);return f.length===0&&i(!1),f})};return n.on("livekitToken",s),n.on("livekitLeave",a),()=>{n.off("livekitToken",s),n.off("livekitLeave",a)}},[n]),e.length?K.jsxs("div",{"data-lk-theme":"default",children:[e.map((s,a)=>K.jsx(bj,{video:!1,audio:!0,token:s,serverUrl:Pj,connect:!0,onDisconnected:()=>n.emit("livekitLeave",s),children:K.jsx(Dj,{})},a)),K.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},cg=({items:n,renderItem:e,listId:t,labelledBy:r,className:i="",itemClassName:s,getItemTextValue:a=d=>(d.name||d.id||"").toString().toLowerCase(),onSelectedIndexChange:c})=>{var C;const[d,f]=F.useState(-1),h=F.useRef(null),v=F.useCallback(x=>{f(x),c&&c(x)},[c]),m=()=>{d===-1&&n.length>0&&v(0)};F.useEffect(()=>{var x;if(d>=n.length&&v(n.length>0?0:-1),d!==-1&&n[d]){const b=`${t}-item-${(x=n[d])==null?void 0:x.id}`,S=document.getElementById(b);S&&S.scrollIntoView({block:"nearest"})}},[d,n,t]);const y=F.useCallback(x=>{if(n.length===0)return;let b=d,S=!0;switch(x.key){case"ArrowDown":b=(d+1)%n.length;break;case"ArrowUp":b=(d-1+n.length)%n.length;break;case"Home":b=0;break;case"End":b=n.length-1;break;case"PageUp":b=Math.max(d-5,0);break;case"PageDown":b=Math.min(d+5,n.length-1);break;default:if(x.key.length===1&&!x.ctrlKey&&!x.metaKey&&!x.altKey){const A=x.key.toLowerCase();let E=d===-1?0:(d+1)%n.length,R=-1;for(let N=0;N<n.length;N++){const V=(E+N)%n.length;if(a(n[V]).startsWith(A)){R=V;break}}R!==-1?b=R:S=!1}else S=!1;break}b!==d&&v(b),S&&x.preventDefault()},[d,n,a]);return K.jsx("div",{id:t,className:`accessible-list-container ${i}`,ref:h,tabIndex:0,role:"listbox","aria-labelledby":r,"aria-activedescendant":d!==-1?`${t}-item-${(C=n[d])==null?void 0:C.id}`:void 0,onFocus:m,onKeyDown:y,children:K.jsx("ul",{role:"none",className:"accessible-list-ul",children:n.map((x,b)=>{const S=b===d,A=e(x,b,S),E=s?s(x,b,S):"";return K.jsx("li",{id:`${t}-item-${x.id}`,className:`${E} ${S?"selected":""}`,role:"option","aria-selected":S,onClick:()=>v(b),children:A},x.id)})})})},Mj=n=>({...n,id:n.Object}),Bj=({users:n})=>{const e=n.map(Mj),t=(s,a,c)=>{let d="Online";return s.away&&(d="Away"),s.idle&&(d==="Online"?d="Idle":d+=" + Idle"),K.jsxs(K.Fragment,{children:[s.Name,K.jsxs("span",{className:"sr-only",children:["",`(${d})`]})]})},r=(s,a,c)=>{let d="userlist-item";return s.away&&(d+=" away"),s.idle&&(d+=" idle"),d},i=s=>s.Name?s.Name.toLowerCase():"";return K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"sidebar-header",id:"userlist-header","aria-hidden":"true",children:"Connected Players"}),K.jsxs("div",{className:"sidebar",children:[" ",K.jsxs("div",{className:"sidebar-content",children:[" ",K.jsx(cg,{items:e,renderItem:t,listId:"userlist",labelledBy:"userlist-header",className:"userlist-accessible-container",itemClassName:r,getItemTextValue:i})]})]})]})},Oj=({items:n,onItemSelected:e,listId:t,labelledBy:r})=>{const i=d=>{d>-1&&n[d]?e(n[d]):e(null)},s=(d,f,h)=>K.jsxs("span",{children:[" ",d.name]}),a=(d,f,h)=>"inventory-list-li",c=d=>d.name?d.name.toLowerCase():"";return K.jsx(cg,{items:n,renderItem:s,listId:t,labelledBy:r,className:"inventory-accessible-list",itemClassName:a,getItemTextValue:c,onSelectedIndexChange:i})},u_=({item:n,onDrop:e,onWear:t,onRemove:r,onGet:i})=>{var h,v;const s=n.name,a=(h=n.Attrib)==null?void 0:h.includes("W"),c=(v=n.Attrib)==null?void 0:v.includes("w"),d=m=>{m.stopPropagation(),e&&e(n)},f=m=>{m.stopPropagation(),i&&i(n)};return K.jsxs("div",{className:"item-card",title:s,"data-item-id":n.id,children:[n.icon&&K.jsx("img",{src:n.icon,alt:"",className:"item-icon"}),K.jsxs("div",{className:"item-details",children:[" ",K.jsx("div",{className:"item-name",children:n.name})]}),K.jsxs("div",{className:"item-actions",children:[n.location==="room"&&i&&K.jsx("button",{className:"item-get-button",onClick:f,"aria-label":`Get ${n.name}`,tabIndex:0,accessKey:"g",children:"Get"}),n.location==="inv"&&a&&!c&&t&&K.jsx("button",{className:"item-wear-button",onClick:()=>t(n),"aria-label":`Wear ${n.name}`,tabIndex:0,accessKey:"w",children:"Wear"}),n.location==="inv"&&c&&r&&K.jsx("button",{className:"item-remove-button",onClick:()=>r(n),"aria-label":`Remove ${n.name}`,tabIndex:0,accessKey:"r",children:"Remove"}),n.location==="inv"&&e&&K.jsx("button",{className:"item-drop-button",onClick:d,"aria-label":`Drop ${n.name}`,tabIndex:0,accessKey:"d"})]})]})},Fj=({client:n})=>{const[e,t]=F.useState([]),[r,i]=F.useState(null),s=F.useCallback((x,b)=>{x==="inv"&&(t(b),(b.length===0||!b.find(S=>S.id===(r==null?void 0:r.id)))&&i(null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]),a=F.useCallback((x,b)=>{x==="inv"&&t(S=>{if(S.some(E=>E.id===b.id))return S;const A=[...S,b];return n.emit("inventoryDataReceived"),A})},[n]),c=F.useCallback((x,b)=>{x==="inv"&&t(S=>{const A=S.filter(E=>E.id!==b.id);return A.length<S.length&&n.emit("inventoryDataReceived"),(r==null?void 0:r.id)===b.id&&i(null),A})},[n,r==null?void 0:r.id]),d=F.useCallback((x,b)=>{x==="inv"&&(t(S=>S.map(A=>A.id===b.id?{...A,...b}:A)),(r==null?void 0:r.id)===b.id&&i(S=>S?{...S,...b}:null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]);F.useEffect(()=>{const x=R=>s(R.location,R.items),b=R=>a(R.location,R.item),S=R=>c(R.location,R.item),A=R=>d(R.location,R.item);n.on("itemsList",x),n.on("itemAdd",b),n.on("itemRemove",S),n.on("itemUpdate",A);const E=n.gmcpHandlers["Char.Items"];return E!=null&&E.sendInventoryRequest&&E.sendInventoryRequest(),()=>{n.off("itemsList",x),n.off("itemAdd",b),n.off("itemRemove",S),n.off("itemUpdate",A)}},[n,s,a,c,d]);const f=x=>{i(x)},h=F.useCallback(x=>{n.sendCommand(`drop ${x.id}`)},[n]),v=F.useCallback(x=>{n.sendCommand(`wear ${x.id}`)},[n]),m=F.useCallback(x=>{n.sendCommand(`remove ${x.id}`)},[n]),y="inventory-heading";return K.jsxs("div",{className:"inventory-tab-content",role:"region","aria-labelledby":y,children:[K.jsx("h4",{id:y,tabIndex:-1,children:"Inventory"}),e.length===0?K.jsx("p",{children:"Your inventory is empty."}):K.jsx(Oj,{items:e,onItemSelected:f,listId:"inventory-listbox",labelledBy:y}),r&&K.jsx("div",{className:"selected-item-card-container",style:{marginTop:"1rem"},children:K.jsx(u_,{item:r,onDrop:h,onWear:v,onRemove:m})})]})};function nh(n,e,t){const[r,i]=F.useState(t);return F.useEffect(()=>{if(!n)return i(t),()=>{};const s=a=>{i(a)};return n.on(e,s),()=>{n.off(e,s)}},[n,e,t]),r}const Lj=({player:n,onLook:e,onFollow:t})=>{const r=c=>{c.stopPropagation(),pI(`page ${n.name} `)},i=c=>{c.stopPropagation(),pI(`-${n.name} `)},s=c=>{c.stopPropagation(),e(n)},a=c=>{c.stopPropagation(),t(n)};return K.jsxs("div",{className:"player-card",title:n.fullname,"data-player-name":n.name,children:[K.jsx("div",{className:"player-details",children:K.jsx("div",{className:"player-name",children:n.fullname})}),K.jsxs("div",{className:"player-actions",children:[K.jsx("button",{className:"player-page-button",onClick:r,"aria-label":`Page ${n.fullname}`,tabIndex:0,accessKey:"p",children:"Page"}),K.jsx("button",{className:"player-sayto-button",onClick:i,"aria-label":`Say to ${n.fullname} (using -${n.name})`,title:`Say to ${n.fullname} (uses -${n.name} command)`,tabIndex:0,accessKey:"s",children:"Say To"}),K.jsx("button",{className:"player-look-button",onClick:s,"aria-label":`Look at ${n.fullname}`,tabIndex:0,accessKey:"l",children:"Look"}),K.jsx("button",{className:"player-follow-button",onClick:a,"aria-label":`Follow ${n.fullname}`,tabIndex:0,accessKey:"f",children:"Follow"})]})]})},Uj=({client:n})=>{const[e,t]=F.useState(n.currentRoomInfo),[r,i]=F.useState([]),[s,a]=F.useState(null),[c,d]=F.useState(n.worldData.roomPlayers||[]),[f,h]=F.useState(null),v=n.gmcpHandlers["Char.Items"],m=F.useCallback((ce,Ce)=>Ce.some(_e=>ce.name.toLowerCase()===_e.fullname.toLowerCase()),[]),y=F.useMemo(()=>r.filter(ce=>!m(ce,c)),[r,c,m]),C=F.useCallback(ce=>{t(ce)},[]);F.useEffect(()=>(n.on("roomInfo",C),v!=null&&v.sendRoomRequest&&v.sendRoomRequest(),()=>{n.off("roomInfo",C)}),[n,v,C]);const x=F.useCallback((ce,Ce)=>{ce==="room"&&(i(Ce),s&&!Ce.find(_e=>_e.id===s.id)&&a(null))},[s]),b=F.useCallback((ce,Ce)=>{ce==="room"&&i(_e=>_e.some(Ne=>Ne.id===Ce.id)?_e:[..._e,Ce])},[]),S=F.useCallback((ce,Ce)=>{ce==="room"&&(i(_e=>_e.filter(Ne=>Ne.id!==Ce.id)),(s==null?void 0:s.id)===Ce.id&&a(null))},[s]);F.useEffect(()=>{const ce=Ne=>x(Ne.location,Ne.items),Ce=Ne=>b(Ne.location,Ne.item),_e=Ne=>S(Ne.location,Ne.item);return n.on("itemsList",ce),n.on("itemAdd",Ce),n.on("itemRemove",_e),()=>{n.off("itemsList",ce),n.off("itemAdd",Ce),n.off("itemRemove",_e)}},[n,x,b,S]);const A=F.useCallback(ce=>{d(ce),f&&!ce.find(Ce=>Ce.name===f.name)&&h(null)},[f]),E=F.useCallback(ce=>{d(Ce=>Ce.some(_e=>_e.name===ce.name)?Ce:[...Ce,ce])},[]),R=F.useCallback(ce=>{d(Ce=>Ce.filter(_e=>_e.name!==ce)),(f==null?void 0:f.name)===ce&&h(null)},[f]);F.useEffect(()=>(n.on("roomPlayers",A),n.on("roomAddPlayer",E),n.on("roomRemovePlayer",R),()=>{n.off("roomPlayers",A),n.off("roomAddPlayer",E),n.off("roomRemovePlayer",R)}),[n,A,E,R]);const N=ce=>{n.sendCommand(ce)},V=ce=>{a(ce>-1&&y[ce]?y[ce]:null)},M=F.useCallback(ce=>{n.sendCommand(`get ${ce.id}`)},[n]),j=ce=>{h(ce>-1&&c[ce]?c[ce]:null)},J=F.useCallback(ce=>{n.sendCommand(`look ${ce.name}`)},[n]),L=F.useCallback(ce=>{n.sendCommand(`follow ${ce.name}`)},[n]),z=ce=>K.jsx("span",{children:ce.name}),Y=()=>"room-item-li",ie=ce=>ce.name.toLowerCase(),pe=ce=>K.jsx("span",{children:ce.fullname}),xe=()=>"room-player-li",Ae=ce=>ce.fullname.toLowerCase(),Le="room-info-heading",we="room-contents-heading",Se="room-contents-list",Ee="room-players-heading",H="room-players-list";if(!e&&y.length===0)return K.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":Le,children:[K.jsx("h4",{id:Le,children:"Room Info"}),K.jsx("p",{children:"Waiting for room data..."})]});const ee=e!=null&&e.exits?Object.entries(e.exits).sort(([ce],[Ce])=>ce.localeCompare(Ce)):[];return K.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":Le,children:[e&&K.jsxs(K.Fragment,{children:[K.jsx("h4",{id:Le,children:e.name||"Current Room"}),e.area&&K.jsxs("p",{className:"room-area",children:["Area: ",e.area]}),ee.length>0&&K.jsxs("div",{className:"room-exits",children:[K.jsx("h5",{children:"Exits"}),K.jsx("ul",{"aria-label":"Room Exits",children:ee.map(([ce,Ce])=>K.jsx("li",{children:K.jsx("button",{onClick:()=>N(ce),title:`Go ${ce} (to room ${Ce})`,"aria-label":`Go ${ce}`,children:ce.toUpperCase()})},ce))})]})]}),K.jsxs("div",{className:"room-contents-section",children:[K.jsx("h5",{id:we,tabIndex:-1,children:"Contents"}),y.length===0?K.jsx("p",{children:"Nothing on the ground."}):K.jsx(cg,{items:y,renderItem:z,listId:Se,labelledBy:we,className:"room-items-accessible-list",itemClassName:Y,getItemTextValue:ie,onSelectedIndexChange:V})]}),s&&K.jsx("div",{className:"selected-room-item-card-container",style:{marginTop:"1rem"},children:K.jsx(u_,{item:s,onGet:M})}),K.jsxs("div",{className:"room-players-section",children:[K.jsx("h5",{id:Ee,tabIndex:-1,children:"Players in Room"}),c.length===0?K.jsx("p",{children:"No other players here."}):K.jsx(cg,{items:c.map(ce=>({...ce,id:ce.name})),renderItem:pe,listId:H,labelledBy:Ee,className:"room-players-accessible-list",itemClassName:xe,getItemTextValue:Ae,onSelectedIndexChange:j})]}),f&&K.jsx("div",{className:"selected-player-card-container",style:{marginTop:"1rem"},children:K.jsx(Lj,{player:f,onLook:J,onFollow:L})})]})},Gj=({client:n})=>{const[e]=Fs(),[t,r]=F.useState(null),[i,s]=F.useState([]),[a,c]=F.useState([]),[d,f]=F.useState(""),[h,v]=F.useState(""),[m,y]=F.useState(sn.connectionStatus),[C,x]=F.useState([]),[b,S]=F.useState({}),[A,E]=F.useState(60),[R,N]=F.useState(64),[V,M]=F.useState(!0),[j,J]=F.useState(0),[L,z]=F.useState(!1),[Y,ie]=F.useState(1e3),[pe,xe]=F.useState([]);F.useEffect(()=>{const ve=n.gmcpHandlers["Client.Midi"];ve&&r(ve)},[n]);const Ae=async()=>{if(!e.midi.enabled)return;ta.initialized||await ta.initialize();const ve=sn.getInputDevices(),ct=sn.getOutputDevices();s(ve),c(ct),y(sn.connectionStatus),await Le()},Le=async()=>{const ve=ur.getState().midi,ct={};if(ve.lastInputDeviceId&&!m.inputConnected){const At=i.find(Wt=>Wt.id===ve.lastInputDeviceId);if(At&&sn.canReconnectToDevice(ve.lastInputDeviceId,"input")&&(ct.input=At,t))try{if(await t.connectInputDevice(ve.lastInputDeviceId)){y(sn.connectionStatus),x(Nt=>[{timestamp:new Date().toLocaleTimeString(),message:`Auto-reconnected to input: ${At.name}`,type:"reconnect"},...Nt].slice(0,10));return}}catch(Wt){console.error("Error during input auto-reconnection:",Wt)}}if(ve.lastOutputDeviceId&&!m.outputConnected){const At=a.find(Wt=>Wt.id===ve.lastOutputDeviceId);if(At&&sn.canReconnectToDevice(ve.lastOutputDeviceId,"output")&&(ct.output=At,t))try{if(await t.connectOutputDevice(ve.lastOutputDeviceId)){y(sn.connectionStatus),x(Nt=>[{timestamp:new Date().toLocaleTimeString(),message:`Auto-reconnected to output: ${At.name}`,type:"reconnect"},...Nt].slice(0,10));return}}catch(Wt){console.error("Error during output auto-reconnection:",Wt)}}S(ct)};F.useEffect(()=>{if(e.midi.enabled){!sn.isInitialized&&t?t.ensureInitialized().then(()=>{Ae()}):Ae();const ve=setInterval(()=>{Ae();const At=sn.connectionStatus;JSON.stringify(At)!==JSON.stringify(m)&&y(At)},2e3),ct=sn.onDeviceChange(At=>{const Wt=new Date().toLocaleTimeString(),Nt=[];At.inputs.added.forEach(bt=>{Nt.push({timestamp:Wt,message:`Input device connected: ${bt.name}`,type:"connected"})}),At.outputs.added.forEach(bt=>{Nt.push({timestamp:Wt,message:`Output device connected: ${bt.name}`,type:"connected"})}),At.inputs.removed.forEach(bt=>{Nt.push({timestamp:Wt,message:`Input device disconnected: ${bt.name}`,type:"disconnected"})}),At.outputs.removed.forEach(bt=>{Nt.push({timestamp:Wt,message:`Output device disconnected: ${bt.name}`,type:"disconnected"})}),Nt.length>0&&x(bt=>[...Nt,...bt].slice(0,10)),Ae()});return()=>{clearInterval(ve),ct()}}else s([]),c([]),y({inputConnected:!1,outputConnected:!1}),S({})},[e.midi.enabled,sn.isInitialized]),F.useEffect(()=>{Le()},[m,i,a,t]);const we=async()=>{if(!t||!d)return;await t.connectInputDevice(d)&&(y(sn.connectionStatus),f(""),Ae())},Se=()=>{sn.disconnect(),y(sn.connectionStatus),Ae()},Ee=async()=>{if(!t||!h)return;await t.connectOutputDevice(h)&&(y(sn.connectionStatus),v(""),Ae())},H=()=>{sn.disconnect(),y(sn.connectionStatus),Ae()},ee=async()=>{sn.refresh(),ta.initialized||await ta.initialize(),Ae(),y(sn.connectionStatus)},ce=async()=>{if(!b.input||!t)return;await sn.attemptReconnect(b.input.id,"input")&&(y(sn.connectionStatus),Ae(),x(ct=>[{timestamp:new Date().toLocaleTimeString(),message:`Reconnected to input: ${b.input.name}`,type:"reconnect"},...ct].slice(0,10)))},Ce=async()=>{if(!b.output||!t)return;await sn.attemptReconnect(b.output.id,"output")&&(y(sn.connectionStatus),Ae(),x(ct=>[{timestamp:new Date().toLocaleTimeString(),message:`Reconnected to output: ${b.output.name}`,type:"reconnect"},...ct].slice(0,10)))};F.useEffect(()=>{if(t)return t.setDebugCallback((ve,ct,At)=>{const Wt=new Date().toLocaleTimeString(),Nt={hex:ve,type:ct,gmcp:At,timestamp:Wt};xe(bt=>[Nt,...bt].slice(0,15))}),()=>{t.setDebugCallback(()=>{})}},[t]);const _e=()=>{t&&t.sendAllNotesOff()},Ne=()=>{if(!t)return;const ve=L&&V?Y:void 0;t.sendManualNote(A,R,V,j,ve)},ft=ve=>{const ct=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],At=Math.floor(ve/12)-1;return`${ct[ve%12]}${At}`};return e.midi.enabled?K.jsxs("div",{style:{padding:"10px"},children:[K.jsx("h3",{children:"MIDI Status"}),K.jsxs("div",{style:{marginBottom:"15px"},children:[K.jsx("div",{style:{marginBottom:"8px"},children:K.jsx("strong",{children:"Input Device:"})}),m.inputConnected?K.jsxs("div",{style:{marginBottom:"8px"},children:[K.jsxs("span",{style:{color:"green"},children:[" ",m.inputDeviceName]}),K.jsx("button",{onClick:Se,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em"},children:"Disconnect"})]}):K.jsxs("div",{style:{marginBottom:"8px"},children:[b.input&&K.jsxs("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"#e3f2fd",border:"1px solid #2196F3",borderRadius:"4px"},children:[K.jsx("div",{style:{fontSize:"0.9em",marginBottom:"5px"},children:K.jsx("span",{style:{color:"#1976D2"},children:" Last used device available:"})}),K.jsxs("div",{children:[K.jsx("span",{children:b.input.name}),K.jsx("button",{onClick:ce,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"},children:"Reconnect"})]})]}),i.length===0?K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:"No input devices found"}):K.jsxs(K.Fragment,{children:[K.jsxs("select",{value:d,onChange:ve=>f(ve.target.value),style:{marginRight:"10px"},children:[K.jsx("option",{value:"",children:"Select input device..."}),i.map(ve=>K.jsx("option",{value:ve.id,children:ve.name},ve.id))]}),K.jsx("button",{onClick:we,disabled:!d,style:{padding:"2px 8px",fontSize:"0.8em",marginRight:"5px"},children:"Connect"})]})]})]}),K.jsxs("div",{style:{marginBottom:"15px"},children:[K.jsx("div",{style:{marginBottom:"8px"},children:K.jsx("strong",{children:"Output Device:"})}),m.outputConnected?K.jsxs("div",{style:{marginBottom:"8px"},children:[K.jsxs("span",{style:{color:"green"},children:[" ",m.outputDeviceName]}),K.jsx("button",{onClick:H,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em"},children:"Disconnect"})]}):K.jsxs("div",{style:{marginBottom:"8px"},children:[b.output&&K.jsxs("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"#e8f5e8",border:"1px solid #4CAF50",borderRadius:"4px"},children:[K.jsx("div",{style:{fontSize:"0.9em",marginBottom:"5px"},children:K.jsx("span",{style:{color:"#2E7D32"},children:" Last used device available:"})}),K.jsxs("div",{children:[K.jsx("span",{children:b.output.name}),K.jsx("button",{onClick:Ce,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"},children:"Reconnect"})]})]}),a.length===0?K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:"No output devices found"}):K.jsxs(K.Fragment,{children:[K.jsxs("select",{value:h,onChange:ve=>v(ve.target.value),style:{marginRight:"10px"},children:[K.jsx("option",{value:"",children:"Select output device..."}),a.map(ve=>K.jsx("option",{value:ve.id,children:ve.name},ve.id))]}),K.jsx("button",{onClick:Ee,disabled:!h,style:{padding:"2px 8px",fontSize:"0.8em",marginRight:"5px"},children:"Connect"})]})]})]}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:ee,style:{padding:"4px 12px",fontSize:"0.8em"},children:"Refresh Devices"})}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:_e,children:"All Notes Off"})}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Manual Note Controls"})}),K.jsxs("div",{style:{padding:"10px 0"},children:[K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Note:"})," ",K.jsx("input",{type:"number",min:"0",max:"127",value:A,onChange:ve=>E(parseInt(ve.target.value)),style:{width:"60px",marginRight:"10px"}}),K.jsxs("span",{style:{fontSize:"0.9em",color:"#666"},children:["(",ft(A),")"]})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Velocity:"})," ",K.jsx("input",{type:"range",min:"1",max:"127",value:R,onChange:ve=>N(parseInt(ve.target.value)),style:{width:"100px",marginRight:"10px"}}),K.jsx("span",{style:{fontSize:"0.9em"},children:R})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Channel:"})," ",K.jsx("select",{value:j,onChange:ve=>J(parseInt(ve.target.value)),style:{marginRight:"10px"},children:Array.from({length:16},(ve,ct)=>K.jsx("option",{value:ct,children:ct+1},ct))})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:L,onChange:ve=>z(ve.target.checked),style:{marginRight:"8px"}}),K.jsx("strong",{children:"Use Duration"})," (auto Note Off)"]})}),L?K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Duration:"})," ",K.jsx("input",{type:"number",min:"100",max:"10000",step:"100",value:Y,onChange:ve=>ie(parseInt(ve.target.value)),style:{width:"80px",marginRight:"10px"}}),K.jsx("span",{style:{fontSize:"0.9em",color:"#666"},children:"ms"})]})}):K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:V,onChange:ve=>M(ve.target.checked),style:{marginRight:"8px"}}),K.jsx("strong",{children:"Note On"})," (unchecked = Note Off)"]})}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:Ne,style:{padding:"8px 16px",backgroundColor:L?"#2196F3":V?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:L?`Send Note (${Y}ms duration)`:`Send ${V?"Note On":"Note Off"} to Server`})})]})]}),C.length>0&&K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Device Connection Events"})}),K.jsx("div",{style:{padding:"10px 0"},children:K.jsx("div",{style:{maxHeight:"200px",overflow:"auto",fontFamily:"monospace",fontSize:"0.8em",backgroundColor:"#f9f9f9",padding:"10px",border:"1px solid #ddd",marginBottom:"15px"},children:C.map((ve,ct)=>K.jsxs("div",{style:{marginBottom:"5px",paddingBottom:"5px",borderBottom:ct<C.length-1?"1px solid #eee":"none",color:ve.type==="connected"?"#2E7D32":ve.type==="disconnected"?"#D32F2F":"#1976D2"},children:[K.jsx("span",{style:{color:"#666"},children:ve.timestamp})," - ",ve.message]},ct))})})]}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"MIDI Debug Monitor"})}),K.jsx("div",{style:{padding:"10px 0"},children:K.jsxs("div",{style:{maxHeight:"300px",overflow:"auto",fontFamily:"monospace",fontSize:"0.8em",backgroundColor:"#f5f5f5",padding:"10px",border:"1px solid #ddd",marginBottom:"15px"},children:[pe.length===0?K.jsx("div",{style:{color:"#999"},children:"No MIDI messages received yet"}):pe.map((ve,ct)=>K.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"8px",borderBottom:ct<pe.length-1?"1px solid #ddd":"none"},children:[K.jsxs("div",{children:[K.jsx("strong",{children:"MIDI:"})," ",ve.hex," (",ve.type,") ",K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:ve.timestamp})]}),K.jsxs("div",{children:[K.jsx("strong",{children:"GMCP:"})," ",ve.gmcp]})]},ct)),K.jsx("div",{style:{marginTop:"10px",color:"#666",fontSize:"0.9em",borderTop:"1px solid #ddd",paddingTop:"5px"},children:"Showing last 15 messages  Active Sensing (0xFE) suppressed"})]})})]}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Usage"})}),K.jsxs("div",{style:{padding:"10px 0",fontSize:"0.9em",color:"#666"},children:[K.jsx("p",{children:" Press keys on your MIDI keyboard to send notes to the server"}),K.jsx("p",{children:" Server can send notes back to play on your MIDI device"}),K.jsx("p",{children:" Use manual controls above to test server communication"}),K.jsxs("p",{children:[" ",K.jsx("strong",{children:"Duration Mode:"})," Send Note On with auto Note Off after specified time"]}),K.jsxs("p",{children:[" ",K.jsx("strong",{children:"Manual Mode:"})," Send explicit Note On/Off messages"]}),K.jsx("p",{children:" Press Escape to stop all sounds and MIDI notes"}),K.jsx("p",{children:" MIDI notes: 0-127 (60 = Middle C, 69 = A4-440Hz)"})]})]})]}):K.jsx("div",{style:{padding:"10px"},children:K.jsx("p",{children:"MIDI is disabled. Enable it in preferences to use MIDI features."})})},Vj=un.forwardRef(({client:n},e)=>{const t=nh(n,"userlist",[]),[r]=Fs(),[i,s]=F.useState(!0),[a,c]=F.useState(!1),[d,f]=F.useState(!!n.currentRoomInfo);F.useEffect(()=>{const m=n.gmcpHandlers["Client.Midi"];m&&n.connected&&(r.midi.enabled?m.advertiseMidiSupport():m.unadvertiseMidiSupport())},[r.midi.enabled,n]),F.useEffect(()=>{const m=()=>c(!0);return n.on("itemsList",m),()=>{n.off("itemsList",m)}},[n]),F.useEffect(()=>{const m=()=>{d||f(!0)};return n.on("roomInfo",m),()=>{n.off("roomInfo",m)}},[n,d]);const h=[{id:"room-tab",label:"Room",content:K.jsx(Uj,{client:n}),condition:d},{id:"inventory-tab",label:"Inventory",content:K.jsx(Fj,{client:n}),condition:a},{id:"users-tab",label:"Users",content:K.jsx(Bj,{users:t}),condition:!0},{id:"midi-tab",label:"MIDI",content:K.jsx(Gj,{client:n}),condition:r.midi.enabled},{id:"files-tab",label:"Files",content:K.jsx(n6,{client:n,expanded:i}),condition:!0},{id:"audio-tab",label:"Audio",content:K.jsx(Nj,{client:n}),condition:!0}],v=un.useMemo(()=>h.filter(m=>m.condition??!0),[d,a,r.midi.enabled]);return un.useImperativeHandle(e,()=>({switchToTab:m=>{var y;if(m>=0&&m<v.length){const C=(y=v[m])==null?void 0:y.id;if(C){console.log(`switchToTab: Trying index ${m}, ID: ${C}`);const x=document.getElementById(C);x?(console.log("switchToTab: Found button element, attempting click..."),x.click(),console.log("switchToTab: Click simulation finished.")):console.error(`switchToTab: Could not find button element with ID: ${C}`)}else console.warn(`switchToTab: Could not determine targetTabId for index ${m}. Visible tabs:`,v)}else console.warn(`switchToTab: Invalid targetIndex ${m}. Visible tabs count: ${v.length}`)}}),[v]),F.useEffect(()=>{const m=()=>s(!0);return n.on("fileTransferOffer",m),()=>{n.off("fileTransferOffer",m)}},[n]),K.jsxs("div",{className:"sidebar",children:[" ",K.jsxs("div",{className:"sidebar-content",children:[K.jsx(vE,{tabs:v})," "]})]})}),jj=({client:n})=>{const[e,t]=F.useState("Not connected"),[r,i]=F.useState(null),s=F.useCallback(m=>t(m),[]),a=F.useCallback(()=>t("Connected"),[]),c=F.useCallback(()=>{t("Disconnected"),i(null)},[]),d=F.useCallback(m=>i(m),[]);F.useEffect(()=>(n.on("statustext",s),n.on("connect",a),n.on("disconnect",c),n.on("vitals",d),()=>{n.off("statustext",s),n.off("connect",a),n.off("disconnect",c),n.off("vitals",d)}),[n,s,a,c,d]);const f=(m,y)=>m===void 0||y===void 0?null:`${m}/${y}`,h=f(r==null?void 0:r.hp,r==null?void 0:r.maxhp),v=f(r==null?void 0:r.mp,r==null?void 0:r.maxmp);return K.jsxs("div",{className:"statusbar",children:[K.jsx("span",{className:"status-connection",children:e}),r&&K.jsxs("span",{className:"status-vitals",children:[h&&` HP: ${h}`,v&&` MP: ${v}`]})]})};var d_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},iA=un.createContext&&un.createContext(d_),Wj=["attr","size","title"];function zj(n,e){if(n==null)return{};var t=Hj(n,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function Hj(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function lg(){return lg=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},lg.apply(this,arguments)}function sA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function ug(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sA(Object(t),!0).forEach(function(r){Zj(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):sA(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Zj(n,e,t){return e=Xj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xj(n){var e=$j(n,"string");return typeof e=="symbol"?e:e+""}function $j(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function f_(n){return n&&n.map((e,t)=>un.createElement(e.tag,ug({key:t},e.attr),f_(e.child)))}function jo(n){return e=>un.createElement(Kj,lg({attr:ug({},n.attr)},e),f_(n.child))}function Kj(n){var e=t=>{var{attr:r,size:i,title:s}=n,a=zj(n,Wj),c=i||t.size||"1em",d;return t.className&&(d=t.className),n.className&&(d=(d?d+" ":"")+n.className),un.createElement("svg",lg({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:d,style:ug(ug({color:n.color||t.color},t.style),n.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),s&&un.createElement("title",null,s),n.children)};return iA!==void 0?un.createElement(iA.Consumer,null,t=>e(t)):e(d_)}function qj(n){return jo({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(n)}function Jj(n){return jo({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(n)}function Yj(n){return jo({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(n)}function Qj(n){return jo({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(n)}function eW(n){return jo({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(n)}function tW(n){return jo({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(n)}function nW(n){return jo({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(n)}function h_(n){return jo({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(n)}function rW(n){return jo({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(n)}function iW(n){return jo({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(n)}function sW(n){return jo({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(n)}const oW=({client:n,onClearLog:e,onSaveLog:t,onCopyLog:r,onToggleSidebar:i,onOpenPrefs:s,showSidebar:a})=>{const c=nh(n,"connectionChange",n.connected),[d,f]=un.useState(n.cacophony.muted),h=nh(n,"autosayChanged",n.autosay)||!1,[v,m]=un.useState(ur.getState().sound.volume),y=F.useCallback(()=>{const S=!d;f(S),n.setGlobalMute(S)},[d,n]),C=F.useCallback(S=>{const A=Number(S.target.value)/100;m(A),n.cacophony.setGlobalVolume(A),ur.dispatch({type:to.SetSound,data:{...ur.getState().sound,volume:A}})},[n]),x=F.useCallback(S=>{n.autosay=S.target.checked},[n]),b=F.useCallback(()=>{c?n.close():n.connect()},[c,n]);return K.jsxs("div",{className:"toolbar",children:[K.jsxs("button",{onClick:t,accessKey:"l",children:[K.jsx(h_,{}),"Save Log (Alt+L)"]}),K.jsxs("button",{onClick:r,accessKey:"C",children:[K.jsx(eW,{}),"Copy Log (Alt+Shift+C)"]}),K.jsxs("button",{onClick:e,accessKey:"E",children:[" ",K.jsx(nW,{}),"Clear Log (Alt+E)"]}),K.jsxs("button",{onClick:s,accessKey:"p",children:[K.jsx(Yj,{}),"Preferences (Alt+P)"]}),K.jsxs("button",{onClick:y,accessKey:"M",children:[d?K.jsx(sW,{}):K.jsx(iW,{}),d?"Unmute":"Mute"]}),K.jsxs("label",{children:["Volume",K.jsx("input",{type:"range",min:"0",max:"100",value:v*100,onChange:C,accessKey:"V"})]}),K.jsxs("label",{children:[K.jsx(Qj,{}),"Autosay",K.jsx("input",{type:"checkbox",checked:h,onChange:x})]}),K.jsx("button",{onClick:b,children:c?"Disconnect":"Connect"}),K.jsxs("button",{onClick:i,accessKey:"U",title:a?"Hide Sidebar (Alt+U)":"Show Sidebar (Alt+U)","aria-label":a?"Hide Sidebar":"Show Sidebar","aria-expanded":a,children:[a?K.jsx(Jj,{}):K.jsx(qj,{}),a?"Hide Sidebar":"Show Sidebar"]})]})};function aW(){const[n,e]=F.useState(null),[t,r]=F.useState(!1),[i,s]=F.useState(!1),[a,c]=F.useState(!1);nh(n,"userlist",[]);const d=un.useRef(null),f=un.useRef(null),h=un.useRef(null),v=un.useRef(null),m=F.useRef(!1),y=()=>{d.current&&d.current.saveLog()},C=()=>{d.current&&d.current.clearLog()},x=()=>{d.current&&d.current.copyLog()},b=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);F.useEffect(()=>{if(m.current)return;const R=new sF("mongoose.moo.mud.org",8765);R.registerGMCPPackage(kB),R.registerGMCPPackage(fB),R.registerGMCPPackage(IB),R.registerGMCPPackage(bB),R.registerGMCPPackage(lP),R.registerGMCPPackage(EB),R.registerGMCPPackage(SB),R.registerGMCPPackage(AB),R.registerGMCPPackage(vD),R.registerGMCPPackage(oP),R.registerGMCPPackage(OA),R.registerGMCPPackage(RB),R.registerGMCPPackage(xD),R.registerGMCPPackage(BA),R.registerGMCPPackage(yD),R.registerGMCPPackage(CD),R.registerGMCPPackage(wD),R.registerGMCPPackage(ID),R.registerGMCPPackage(bD),R.registerGMCPPackage(TB),R.registerGMCPPackage(_B),R.registerGMCPPackage(DB),R.registerGMCPPackage(PB),R.registerGMCPPackage(NB),R.registerGMCPPackage(MB),R.registerGMCPPackage(BB),R.registerMcpPackage(UB),R.registerMcpPackage(GB),R.registerMcpPackage(jB),R.registerMcpPackage(WB),R.connect(),R.requestNotificationPermission(),e(R),r(!b),window.mudClient=R,m.current=!0,ta.initialize().then(M=>{console.log(M?"Virtual MIDI synthesizer initialized":"Failed to initialize virtual MIDI synthesizer")}).catch(M=>{console.error("Error initializing virtual MIDI synthesizer:",M)});const N=M=>{if(R&&(M.key==="Control"&&R.cancelSpeech(),M.key==="Escape")){R.stopAllSounds();const j=R.gmcpHandlers["Client.Midi"];j&&j.sendAllNotesOff()}};window.addEventListener("keydown",N);const V=()=>{var M;(M=f.current)==null||M.focus()};return document.addEventListener("focus",V),()=>{window.removeEventListener("keydown",N),document.removeEventListener("focus",V)}},[b]),F.useEffect(()=>{const R=N=>{var M;if(!t||!N.ctrlKey)return;const V=parseInt(N.key,10);if(!isNaN(V)&&V>=1&&V<=9){const j=V-1;N.preventDefault(),console.log(`App: Detected CTRL+${V}, calling switchToTab(${j})`),(M=v.current)==null||M.switchToTab(j)}};return document.addEventListener("keydown",R,!0),()=>{document.removeEventListener("keydown",R,!0)}},[t]);const S=nh(n,"fileTransferOffer",null),A=F.useCallback(R=>{n&&n.sendCommand(R)},[n]),E=F.useCallback(()=>{var R;(R=f.current)==null||R.focus()},[]);return F.useEffect(()=>{S!==null&&(c(!0),s(!0),n==null||n.sendNotification("File Transfer Offer",`${S.sender} wants to send you ${S.filename} (${Math.round(S.filesize/1024)} KB)`))},[S,n]),MA(R=>{n&&n.shutdown()}),F.useEffect(()=>{var R;(R=f.current)==null||R.focus()},[]),n?K.jsxs("div",{className:`App ${t?"sidebar-shown":""}`,children:[K.jsx("header",{role:"banner",style:{gridArea:"header"},children:K.jsx(oW,{client:n,onSaveLog:y,onClearLog:C,onCopyLog:x,onToggleSidebar:()=>r(!t),onOpenPrefs:()=>{var R;return(R=h.current)==null?void 0:R.open()},showSidebar:t})}),K.jsx("main",{role:"main",style:{gridArea:"main"},children:K.jsx(Sy,{client:n,ref:d,focusInput:E})}),K.jsx("div",{role:"region","aria-label":"Command input",style:{gridArea:"input"},children:K.jsx(lF,{onSend:A,inputRef:f,client:n})}),t&&K.jsx("aside",{role:"complementary","aria-roledescription":"Sidebar",style:{gridArea:"sidebar"},children:K.jsx(Vj,{ref:v,client:n})}),K.jsx("footer",{role:"contentinfo",style:{gridArea:"status"},children:K.jsx(jj,{client:n})}),K.jsx(JL,{ref:h})]}):null}function cW(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function aA(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?oA(Object(t),!0).forEach(function(r){cW(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):oA(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function lW(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function uW(n,e){if(n==null)return{};var t=lW(n,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function dW(n,e){return fW(n)||hW(n,e)||pW(n,e)||gW()}function fW(n){if(Array.isArray(n))return n}function hW(n,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(n)))){var t=[],r=!0,i=!1,s=void 0;try{for(var a=n[Symbol.iterator](),c;!(r=(c=a.next()).done)&&(t.push(c.value),!(e&&t.length===e));r=!0);}catch(d){i=!0,s=d}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw s}}return t}}function pW(n,e){if(n){if(typeof n=="string")return cA(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return cA(n,e)}}function cA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function gW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mW(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function uA(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lA(Object(t),!0).forEach(function(r){mW(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lA(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function vW(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(r){return e.reduceRight(function(i,s){return s(i)},r)}}function Nf(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=n.length?n.apply(this,i):function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return e.apply(t,[].concat(i,c))}}}function dg(n){return{}.toString.call(n).includes("Object")}function yW(n){return!Object.keys(n).length}function rh(n){return typeof n=="function"}function CW(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function xW(n,e){return dg(e)||ml("changeType"),Object.keys(e).some(function(t){return!CW(n,t)})&&ml("changeField"),e}function wW(n){rh(n)||ml("selectorType")}function IW(n){rh(n)||dg(n)||ml("handlerType"),dg(n)&&Object.values(n).some(function(e){return!rh(e)})&&ml("handlersType")}function bW(n){n||ml("initialIsRequired"),dg(n)||ml("initialType"),yW(n)&&ml("initialContent")}function SW(n,e){throw new Error(n[e]||n.default)}var AW={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},ml=Nf(SW)(AW),T0={changes:xW,selector:wW,handler:IW,initial:bW};function kW(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};T0.initial(n),T0.handler(e);var t={current:n},r=Nf(_W)(t,e),i=Nf(TW)(t),s=Nf(T0.changes)(n),a=Nf(EW)(t);function c(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return T0.selector(f),f(t.current)}function d(f){vW(r,i,s,a)(f)}return[c,d]}function EW(n,e){return rh(e)?e(n.current):e}function TW(n,e){return n.current=uA(uA({},n.current),e),e}function _W(n,e,t){return rh(e)?e(n.current):Object.keys(t).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,n.current[r])}),t}var RW={create:kW},DW={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function PW(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=n.length?n.apply(this,i):function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return e.apply(t,[].concat(i,c))}}}function NW(n){return{}.toString.call(n).includes("Object")}function MW(n){return n||dA("configIsRequired"),NW(n)||dA("configType"),n.urls?(BW(),{paths:{vs:n.urls.monacoBase}}):n}function BW(){console.warn(p_.deprecation)}function OW(n,e){throw new Error(n[e]||n.default)}var p_={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},dA=PW(OW)(p_),FW={config:MW},LW=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduceRight(function(s,a){return a(s)},i)}};function g_(n,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&n[t]&&Object.assign(e[t],g_(n[t],e[t]))}),aA(aA({},n),e)}var UW={type:"cancelation",msg:"operation is manually canceled"};function zv(n){var e=!1,t=new Promise(function(r,i){n.then(function(s){return e?i(UW):r(s)}),n.catch(i)});return t.cancel=function(){return e=!0},t}var GW=RW.create({config:DW,isInitialized:!1,resolve:null,reject:null,monaco:null}),m_=dW(GW,2),wh=m_[0],Mg=m_[1];function VW(n){var e=FW.config(n),t=e.monaco,r=uW(e,["monaco"]);Mg(function(i){return{config:g_(i.config,r),monaco:t}})}function jW(){var n=wh(function(e){var t=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:t,isInitialized:r,resolve:i}});if(!n.isInitialized){if(Mg({isInitialized:!0}),n.monaco)return n.resolve(n.monaco),zv(Hv);if(window.monaco&&window.monaco.editor)return v_(window.monaco),n.resolve(window.monaco),zv(Hv);LW(WW,HW)(ZW)}return zv(Hv)}function WW(n){return document.body.appendChild(n)}function zW(n){var e=document.createElement("script");return n&&(e.src=n),e}function HW(n){var e=wh(function(r){var i=r.config,s=r.reject;return{config:i,reject:s}}),t=zW("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return n()},t.onerror=e.reject,t}function ZW(){var n=wh(function(t){var r=t.config,i=t.resolve,s=t.reject;return{config:r,resolve:i,reject:s}}),e=window.require;e.config(n.config),e(["vs/editor/editor.main"],function(t){v_(t),n.resolve(t)},function(t){n.reject(t)})}function v_(n){wh().monaco||Mg({monaco:n})}function XW(){return wh(function(n){var e=n.monaco;return e})}var Hv=new Promise(function(n,e){return Mg({resolve:n,reject:e})}),y_={config:VW,init:jW,__getMonacoInstance:XW},$W={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Zv=$W,KW={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},qW=KW;function JW({children:n}){return un.createElement("div",{style:qW.container},n)}var YW=JW,QW=YW;function ez({width:n,height:e,isEditorReady:t,loading:r,_ref:i,className:s,wrapperProps:a}){return un.createElement("section",{style:{...Zv.wrapper,width:n,height:e},...a},!t&&un.createElement(QW,null,r),un.createElement("div",{ref:i,style:{...Zv.fullWidth,...!t&&Zv.hide},className:s}))}var tz=ez,C_=F.memo(tz);function nz(n){F.useEffect(n,[])}var x_=nz;function rz(n,e,t=!0){let r=F.useRef(!0);F.useEffect(r.current||!t?()=>{r.current=!1}:n,e)}var Ns=rz;function Uf(){}function Yu(n,e,t,r){return iz(n,r)||sz(n,e,t,r)}function iz(n,e){return n.editor.getModel(w_(n,e))}function sz(n,e,t,r){return n.editor.createModel(e,t,r?w_(n,r):void 0)}function w_(n,e){return n.Uri.parse(e)}function oz({original:n,modified:e,language:t,originalLanguage:r,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:a,keepCurrentOriginalModel:c=!1,keepCurrentModifiedModel:d=!1,theme:f="light",loading:h="Loading...",options:v={},height:m="100%",width:y="100%",className:C,wrapperProps:x={},beforeMount:b=Uf,onMount:S=Uf}){let[A,E]=F.useState(!1),[R,N]=F.useState(!0),V=F.useRef(null),M=F.useRef(null),j=F.useRef(null),J=F.useRef(S),L=F.useRef(b),z=F.useRef(!1);x_(()=>{let xe=y_.init();return xe.then(Ae=>(M.current=Ae)&&N(!1)).catch(Ae=>(Ae==null?void 0:Ae.type)!=="cancelation"&&console.error("Monaco initialization: error:",Ae)),()=>V.current?pe():xe.cancel()}),Ns(()=>{if(V.current&&M.current){let xe=V.current.getOriginalEditor(),Ae=Yu(M.current,n||"",r||t||"text",s||"");Ae!==xe.getModel()&&xe.setModel(Ae)}},[s],A),Ns(()=>{if(V.current&&M.current){let xe=V.current.getModifiedEditor(),Ae=Yu(M.current,e||"",i||t||"text",a||"");Ae!==xe.getModel()&&xe.setModel(Ae)}},[a],A),Ns(()=>{let xe=V.current.getModifiedEditor();xe.getOption(M.current.editor.EditorOption.readOnly)?xe.setValue(e||""):e!==xe.getValue()&&(xe.executeEdits("",[{range:xe.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),xe.pushUndoStop())},[e],A),Ns(()=>{var xe,Ae;(Ae=(xe=V.current)==null?void 0:xe.getModel())==null||Ae.original.setValue(n||"")},[n],A),Ns(()=>{let{original:xe,modified:Ae}=V.current.getModel();M.current.editor.setModelLanguage(xe,r||t||"text"),M.current.editor.setModelLanguage(Ae,i||t||"text")},[t,r,i],A),Ns(()=>{var xe;(xe=M.current)==null||xe.editor.setTheme(f)},[f],A),Ns(()=>{var xe;(xe=V.current)==null||xe.updateOptions(v)},[v],A);let Y=F.useCallback(()=>{var Le;if(!M.current)return;L.current(M.current);let xe=Yu(M.current,n||"",r||t||"text",s||""),Ae=Yu(M.current,e||"",i||t||"text",a||"");(Le=V.current)==null||Le.setModel({original:xe,modified:Ae})},[t,e,i,n,r,s,a]),ie=F.useCallback(()=>{var xe;!z.current&&j.current&&(V.current=M.current.editor.createDiffEditor(j.current,{automaticLayout:!0,...v}),Y(),(xe=M.current)==null||xe.editor.setTheme(f),E(!0),z.current=!0)},[v,f,Y]);F.useEffect(()=>{A&&J.current(V.current,M.current)},[A]),F.useEffect(()=>{!R&&!A&&ie()},[R,A,ie]);function pe(){var Ae,Le,we,Se;let xe=(Ae=V.current)==null?void 0:Ae.getModel();c||((Le=xe==null?void 0:xe.original)==null||Le.dispose()),d||((we=xe==null?void 0:xe.modified)==null||we.dispose()),(Se=V.current)==null||Se.dispose()}return un.createElement(C_,{width:y,height:m,isEditorReady:A,loading:h,_ref:j,className:C,wrapperProps:x})}var az=oz;F.memo(az);function cz(n){let e=F.useRef();return F.useEffect(()=>{e.current=n},[n]),e.current}var lz=cz,_0=new Map;function uz({defaultValue:n,defaultLanguage:e,defaultPath:t,value:r,language:i,path:s,theme:a="light",line:c,loading:d="Loading...",options:f={},overrideServices:h={},saveViewState:v=!0,keepCurrentModel:m=!1,width:y="100%",height:C="100%",className:x,wrapperProps:b={},beforeMount:S=Uf,onMount:A=Uf,onChange:E,onValidate:R=Uf}){let[N,V]=F.useState(!1),[M,j]=F.useState(!0),J=F.useRef(null),L=F.useRef(null),z=F.useRef(null),Y=F.useRef(A),ie=F.useRef(S),pe=F.useRef(),xe=F.useRef(r),Ae=lz(s),Le=F.useRef(!1),we=F.useRef(!1);x_(()=>{let H=y_.init();return H.then(ee=>(J.current=ee)&&j(!1)).catch(ee=>(ee==null?void 0:ee.type)!=="cancelation"&&console.error("Monaco initialization: error:",ee)),()=>L.current?Ee():H.cancel()}),Ns(()=>{var ee,ce,Ce,_e;let H=Yu(J.current,n||r||"",e||i||"",s||t||"");H!==((ee=L.current)==null?void 0:ee.getModel())&&(v&&_0.set(Ae,(ce=L.current)==null?void 0:ce.saveViewState()),(Ce=L.current)==null||Ce.setModel(H),v&&((_e=L.current)==null||_e.restoreViewState(_0.get(s))))},[s],N),Ns(()=>{var H;(H=L.current)==null||H.updateOptions(f)},[f],N),Ns(()=>{!L.current||r===void 0||(L.current.getOption(J.current.editor.EditorOption.readOnly)?L.current.setValue(r):r!==L.current.getValue()&&(we.current=!0,L.current.executeEdits("",[{range:L.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),L.current.pushUndoStop(),we.current=!1))},[r],N),Ns(()=>{var ee,ce;let H=(ee=L.current)==null?void 0:ee.getModel();H&&i&&((ce=J.current)==null||ce.editor.setModelLanguage(H,i))},[i],N),Ns(()=>{var H;c!==void 0&&((H=L.current)==null||H.revealLine(c))},[c],N),Ns(()=>{var H;(H=J.current)==null||H.editor.setTheme(a)},[a],N);let Se=F.useCallback(()=>{var H;if(!(!z.current||!J.current)&&!Le.current){ie.current(J.current);let ee=s||t,ce=Yu(J.current,r||n||"",e||i||"",ee||"");L.current=(H=J.current)==null?void 0:H.editor.create(z.current,{model:ce,automaticLayout:!0,...f},h),v&&L.current.restoreViewState(_0.get(ee)),J.current.editor.setTheme(a),c!==void 0&&L.current.revealLine(c),V(!0),Le.current=!0}},[n,e,t,r,i,s,f,h,v,a,c]);F.useEffect(()=>{N&&Y.current(L.current,J.current)},[N]),F.useEffect(()=>{!M&&!N&&Se()},[M,N,Se]),xe.current=r,F.useEffect(()=>{var H,ee;N&&E&&((H=pe.current)==null||H.dispose(),pe.current=(ee=L.current)==null?void 0:ee.onDidChangeModelContent(ce=>{we.current||E(L.current.getValue(),ce)}))},[N,E]),F.useEffect(()=>{if(N){let H=J.current.editor.onDidChangeMarkers(ee=>{var Ce;let ce=(Ce=L.current.getModel())==null?void 0:Ce.uri;if(ce&&ee.find(_e=>_e.path===ce.path)){let _e=J.current.editor.getModelMarkers({resource:ce});R==null||R(_e)}});return()=>{H==null||H.dispose()}}return()=>{}},[N,R]);function Ee(){var H,ee;(H=pe.current)==null||H.dispose(),m?v&&_0.set(s,L.current.saveViewState()):(ee=L.current.getModel())==null||ee.dispose(),L.current.dispose()}return un.createElement(C_,{width:y,height:C,isEditorReady:N,loading:d,_ref:z,className:x,wrapperProps:b})}var dz=uz,fz=F.memo(dz),hz=fz,pz={restoreOnUnmount:!1};function gz(n,e){e===void 0&&(e=pz);var t=F.useRef(document.title);document.title!==n&&(document.title=n),F.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=t.current}},[])}const mz=typeof document<"u"?gz:function(n){};function vz({onSave:n,onRevert:e,onDownload:t}){return K.jsx("div",{className:"editor-toolbar",children:K.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[K.jsxs("button",{onClick:n,accessKey:"s",title:"Save (Alt+S)",children:[K.jsx(h_,{"aria-hidden":"true"}),"Save"]}),K.jsxs("button",{onClick:e,accessKey:"r",title:"Revert (Alt+R)",children:[K.jsx(rW,{"aria-hidden":"true"}),"Revert"]}),K.jsxs("button",{onClick:t,accessKey:"d",title:"Download (Alt+D)",children:[K.jsx(tW,{"aria-hidden":"true"}),"Download"]})]})})}const yz=({docstate:n,session:e})=>K.jsxs("div",{"aria-live":"polite",className:"editor-statusbar",children:[K.jsx("span",{children:n}),K.jsx("span",{"aria-hidden":"true",children:"|"}),K.jsx("span",{children:e.reference}),K.jsx("span",{"aria-hidden":"true",children:"|"}),K.jsx("span",{children:e.type})]});function Cz(){const n=PA(),e=un.useRef(null),[t,r]=F.useState(""),[i,s]=F.useState(""),[a,c]=F.useState(""),[d,f]=F.useState(0),[h,v]=F.useState({name:"none",contents:[],reference:"",type:""}),m=(ie,pe)=>{e.current=ie},[y,C]=Fs();console.log(y);const x=y.editor.accessibilityMode,b=y.editor.autocompleteEnabled;MA(ie=>{N.postMessage({type:"close",id:M}),d===1&&ie.preventDefault()});const[S,A]=F.useState(!1),E=S?`${h.name} - Mongoose Editor`:"Mongoose Editor";mz(E);const R=F.useMemo(()=>{switch(d){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[d]),N=F.useMemo(()=>new BroadcastChannel("editor"),[]),V=new URLSearchParams(n.search),M=decodeURIComponent(V.get("reference")||"");F.useEffect(()=>{if(!M)return;console.log("ID: "+M),console.log("Sending ready message"),N.postMessage({type:"ready",id:M});const ie=pe=>{switch(console.log(pe.data),pe.data.type){case"load":if(t!=="")return;const xe=pe.data.session.contents.join(`
`);s(xe),c(xe),v(pe.data.session),f(0),r(pe.data.clientId),A(!0),setTimeout(Y,100);break;case"shutdown":if(console.log("Received shutdown message"),d===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;N.close(),window.close();break;default:console.warn("Unknown message type received",pe.data.type)}};return N.addEventListener("message",ie),()=>{N.removeEventListener("message",ie),N.postMessage({type:"close",id:M})}},[N,t,M,d]);const j=()=>{s(a),f(0)},J=ie=>{const pe=i.split(/\r\n|\r|\n/),xe={...h,contents:pe};N.postMessage({type:"save",session:xe,id:M}),f(2),Y(),ie.preventDefault()},L=ie=>{ie!==void 0&&(console.log("Original: "+a),console.log("New: "+ie),s(ie),ie.split(/\r\n|\r|\n/).join(`
`)!==a?f(1):f(0),S||A(!0))},z=()=>{const ie=new Blob([i],{type:"text/plain"}),pe=URL.createObjectURL(ie),xe=document.createElement("a"),Ae=new Date,Le=Ae.toLocaleDateString().replace(/\//g,"-"),we=Ae.toLocaleTimeString().replace(/:/g,"-"),Se=`${h.name}-${Le}-${we}.txt`;xe.download=Se,xe.href=pe,xe.click(),URL.revokeObjectURL(pe),xe.remove()};return K.jsxs("div",{id:"editor-window",children:[K.jsx(vz,{onSave:J,onRevert:j,onDownload:z}),K.jsx(hz,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:L,options:{wordWrap:"on",accessibilitySupport:x?"on":"off",quickSuggestions:b},onMount:m,path:h.reference}),K.jsx(yz,{docstate:R,session:h})]});function Y(){e.current!==null&&e.current.focus()}}const xz="modulepreload",wz=function(n){return"/"+n},fA={},I_=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let a=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=a(t.map(f=>{if(f=wz(f),f in fA)return;fA[f]=!0;const h=f.endsWith(".css"),v=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":xz,h||(m.as="script"),m.crossOrigin="",m.href=f,d&&m.setAttribute("nonce",d),document.head.appendChild(m),h)return new Promise((y,C)=>{m.addEventListener("load",y),m.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return i.then(a=>{for(const c of a||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})},Iz=n=>{n&&n instanceof Function&&I_(async()=>{const{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:s}=await import("./web-vitals-CFnx-5Zt.js");return{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:s}},[]).then(({getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:s})=>{e(n),t(n),r(n),i(n),s(n)})};function bz(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:a}=n;let c,d;const f=async(v=!0)=>{await d};async function h(){if("serviceWorker"in navigator){if(c=await I_(async()=>{const{Workbox:v}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:v}},[]).then(({Workbox:v})=>new v("/sw.js",{scope:"/",type:"classic"})).catch(v=>{a==null||a(v)}),!c)return;c.addEventListener("activated",v=>{(v.isUpdate||v.isExternal)&&window.location.reload()}),c.addEventListener("installed",v=>{v.isUpdate||r==null||r()}),c.register({immediate:e}).then(v=>{s?s("/sw.js",v):i==null||i(v)}).catch(v=>{a==null||a(v)})}}return d=h(),f}const Sz=$3([{path:"/",element:K.jsx(aW,{})},{path:"/editor",element:K.jsx(Cz,{})}]),Az=PR.createRoot(document.getElementById("root"));Az.render(K.jsx(un.StrictMode,{children:K.jsx(rD,{router:Sz})}));Iz(console.log);bz();

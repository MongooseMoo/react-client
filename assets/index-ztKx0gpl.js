var kO=Object.defineProperty;var TO=(t,e,n)=>e in t?kO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var _O=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var V=(t,e,n)=>(TO(t,typeof e!="symbol"?e+"":e,n),n),sg=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var O=(t,e,n)=>(sg(t,e,"read from private field"),n?n.call(t):e.get(t)),Re=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Se=(t,e,n,r)=>(sg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var bf=(t,e,n,r)=>({set _(i){Se(t,e,i,n)},get _(){return O(t,e,r)}}),ge=(t,e,n)=>(sg(t,e,"access private method"),n);var pQ=_O((ZQ,SO)=>{function V_(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var CO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var z_={exports:{}},Vp={},W_={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qd=Symbol.for("react.element"),IO=Symbol.for("react.portal"),RO=Symbol.for("react.fragment"),PO=Symbol.for("react.strict_mode"),xO=Symbol.for("react.profiler"),NO=Symbol.for("react.provider"),MO=Symbol.for("react.context"),OO=Symbol.for("react.forward_ref"),AO=Symbol.for("react.suspense"),DO=Symbol.for("react.memo"),LO=Symbol.for("react.lazy"),wb=Symbol.iterator;function FO(t){return t===null||typeof t!="object"?null:(t=wb&&t[wb]||t["@@iterator"],typeof t=="function"?t:null)}var H_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G_=Object.assign,q_={};function $l(t,e,n){this.props=t,this.context=e,this.refs=q_,this.updater=n||H_}$l.prototype.isReactComponent={};$l.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$l.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function J_(){}J_.prototype=$l.prototype;function G0(t,e,n){this.props=t,this.context=e,this.refs=q_,this.updater=n||H_}var q0=G0.prototype=new J_;q0.constructor=G0;G_(q0,$l.prototype);q0.isPureReactComponent=!0;var bb=Array.isArray,K_=Object.prototype.hasOwnProperty,J0={current:null},Y_={key:!0,ref:!0,__self:!0,__source:!0};function X_(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)K_.call(e,r)&&!Y_.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:qd,type:t,key:s,ref:o,props:i,_owner:J0.current}}function UO(t,e){return{$$typeof:qd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function K0(t){return typeof t=="object"&&t!==null&&t.$$typeof===qd}function BO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Eb=/\/+/g;function og(t,e){return typeof t=="object"&&t!==null&&t.key!=null?BO(""+t.key):e.toString(36)}function ih(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case qd:case IO:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+og(o,0):r,bb(i)?(n="",t!=null&&(n=t.replace(Eb,"$&/")+"/"),ih(i,e,n,"",function(l){return l})):i!=null&&(K0(i)&&(i=UO(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Eb,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",bb(t))for(var a=0;a<t.length;a++){s=t[a];var c=r+og(s,a);o+=ih(s,e,n,c,i)}else if(c=FO(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=r+og(s,a++),o+=ih(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ef(t,e,n){if(t==null)return t;var r=[],i=0;return ih(t,r,"","",function(s){return e.call(n,s,i++)}),r}function jO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Jn={current:null},sh={transition:null},$O={ReactCurrentDispatcher:Jn,ReactCurrentBatchConfig:sh,ReactCurrentOwner:J0};De.Children={map:Ef,forEach:function(t,e,n){Ef(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ef(t,function(){e++}),e},toArray:function(t){return Ef(t,function(e){return e})||[]},only:function(t){if(!K0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=$l;De.Fragment=RO;De.Profiler=xO;De.PureComponent=G0;De.StrictMode=PO;De.Suspense=AO;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$O;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=G_({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=J0.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)K_.call(e,c)&&!Y_.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:qd,type:t.type,key:i,ref:s,props:r,_owner:o}};De.createContext=function(t){return t={$$typeof:MO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:NO,_context:t},t.Consumer=t};De.createElement=X_;De.createFactory=function(t){var e=X_.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:OO,render:t}};De.isValidElement=K0;De.lazy=function(t){return{$$typeof:LO,_payload:{_status:-1,_result:t},_init:jO}};De.memo=function(t,e){return{$$typeof:DO,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=sh.transition;sh.transition={};try{t()}finally{sh.transition=e}};De.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};De.useCallback=function(t,e){return Jn.current.useCallback(t,e)};De.useContext=function(t){return Jn.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return Jn.current.useDeferredValue(t)};De.useEffect=function(t,e){return Jn.current.useEffect(t,e)};De.useId=function(){return Jn.current.useId()};De.useImperativeHandle=function(t,e,n){return Jn.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return Jn.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return Jn.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return Jn.current.useMemo(t,e)};De.useReducer=function(t,e,n){return Jn.current.useReducer(t,e,n)};De.useRef=function(t){return Jn.current.useRef(t)};De.useState=function(t){return Jn.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return Jn.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return Jn.current.useTransition()};De.version="18.2.0";W_.exports=De;var E=W_.exports;const pt=Gd(E),VO=V_({__proto__:null,default:pt},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zO=E,WO=Symbol.for("react.element"),HO=Symbol.for("react.fragment"),GO=Object.prototype.hasOwnProperty,qO=zO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JO={key:!0,ref:!0,__self:!0,__source:!0};function Q_(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)GO.call(e,r)&&!JO.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:WO,type:t,key:s,ref:o,props:i,_owner:qO.current}}Vp.Fragment=HO;Vp.jsx=Q_;Vp.jsxs=Q_;z_.exports=Vp;var X=z_.exports,gv={},Z_={exports:{}},Cr={},e1={exports:{}},t1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,ee){var oe=H.length;H.push(ee);e:for(;0<oe;){var q=oe-1>>>1,ie=H[q];if(0<i(ie,ee))H[q]=ee,H[oe]=ie,oe=q;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var ee=H[0],oe=H.pop();if(oe!==ee){H[0]=oe;e:for(var q=0,ie=H.length,ke=ie>>>1;q<ke;){var _e=2*(q+1)-1,me=H[_e],nt=_e+1,gt=H[nt];if(0>i(me,oe))nt<ie&&0>i(gt,me)?(H[q]=gt,H[nt]=oe,q=nt):(H[q]=me,H[_e]=oe,q=_e);else if(nt<ie&&0>i(gt,oe))H[q]=gt,H[nt]=oe,q=nt;else break e}}return ee}function i(H,ee){var oe=H.sortIndex-ee.sortIndex;return oe!==0?oe:H.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,d=null,f=3,h=!1,p=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(H){for(var ee=n(l);ee!==null;){if(ee.callback===null)r(l);else if(ee.startTime<=H)r(l),ee.sortIndex=ee.expirationTime,e(c,ee);else break;ee=n(l)}}function C(H){if(m=!1,b(H),!p)if(n(c)!==null)p=!0,K(T);else{var ee=n(l);ee!==null&&re(C,ee.startTime-H)}}function T(H,ee){p=!1,m&&(m=!1,g(R),R=-1),h=!0;var oe=f;try{for(b(ee),d=n(c);d!==null&&(!(d.expirationTime>ee)||H&&!L());){var q=d.callback;if(typeof q=="function"){d.callback=null,f=d.priorityLevel;var ie=q(d.expirationTime<=ee);ee=t.unstable_now(),typeof ie=="function"?d.callback=ie:d===n(c)&&r(c),b(ee)}else r(c);d=n(c)}if(d!==null)var ke=!0;else{var _e=n(l);_e!==null&&re(C,_e.startTime-ee),ke=!1}return ke}finally{d=null,f=oe,h=!1}}var k=!1,I=null,R=-1,N=5,M=-1;function L(){return!(t.unstable_now()-M<N)}function F(){if(I!==null){var H=t.unstable_now();M=H;var ee=!0;try{ee=I(!0,H)}finally{ee?W():(k=!1,I=null)}}else k=!1}var W;if(typeof v=="function")W=function(){v(F)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,Y=z.port2;z.port1.onmessage=F,W=function(){Y.postMessage(null)}}else W=function(){w(F,0)};function K(H){I=H,k||(k=!0,W())}function re(H,ee){R=w(function(){H(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,K(T))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(f){case 1:case 2:case 3:var ee=3;break;default:ee=f}var oe=f;f=ee;try{return H()}finally{f=oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,ee){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var oe=f;f=H;try{return ee()}finally{f=oe}},t.unstable_scheduleCallback=function(H,ee,oe){var q=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?q+oe:q):oe=q,H){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=oe+ie,H={id:u++,callback:ee,priorityLevel:H,startTime:oe,expirationTime:ie,sortIndex:-1},oe>q?(H.sortIndex=oe,e(l,H),n(c)===null&&H===n(l)&&(m?(g(R),R=-1):m=!0,re(C,oe-q))):(H.sortIndex=ie,e(c,H),p||h||(p=!0,K(T))),H},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(H){var ee=f;return function(){var oe=f;f=ee;try{return H.apply(this,arguments)}finally{f=oe}}}})(t1);e1.exports=t1;var KO=e1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1=E,Tr=KO;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r1=new Set,id={};function ec(t,e){yl(t,e),yl(t+"Capture",e)}function yl(t,e){for(id[t]=e,t=0;t<e.length;t++)r1.add(e[t])}var Xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vv=Object.prototype.hasOwnProperty,YO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kb={},Tb={};function XO(t){return vv.call(Tb,t)?!0:vv.call(kb,t)?!1:YO.test(t)?Tb[t]=!0:(kb[t]=!0,!1)}function QO(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ZO(t,e,n,r){if(e===null||typeof e>"u"||QO(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Kn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var yn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){yn[t]=new Kn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];yn[e]=new Kn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){yn[t]=new Kn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){yn[t]=new Kn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){yn[t]=new Kn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){yn[t]=new Kn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){yn[t]=new Kn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){yn[t]=new Kn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){yn[t]=new Kn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Y0=/[\-:]([a-z])/g;function X0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Y0,X0);yn[e]=new Kn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Y0,X0);yn[e]=new Kn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Y0,X0);yn[e]=new Kn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){yn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!1,!1)});yn.xlinkHref=new Kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){yn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Q0(t,e,n,r){var i=yn.hasOwnProperty(e)?yn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ZO(e,n,i,r)&&(n=null),r||i===null?XO(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var so=n1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kf=Symbol.for("react.element"),_c=Symbol.for("react.portal"),Cc=Symbol.for("react.fragment"),Z0=Symbol.for("react.strict_mode"),yv=Symbol.for("react.profiler"),i1=Symbol.for("react.provider"),s1=Symbol.for("react.context"),eS=Symbol.for("react.forward_ref"),Sv=Symbol.for("react.suspense"),wv=Symbol.for("react.suspense_list"),tS=Symbol.for("react.memo"),ko=Symbol.for("react.lazy"),o1=Symbol.for("react.offscreen"),_b=Symbol.iterator;function su(t){return t===null||typeof t!="object"?null:(t=_b&&t[_b]||t["@@iterator"],typeof t=="function"?t:null)}var _t=Object.assign,ag;function Iu(t){if(ag===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ag=e&&e[1]||""}return`
`+ag+t}var cg=!1;function lg(t,e){if(!t||cg)return"";cg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{cg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Iu(t):""}function eA(t){switch(t.tag){case 5:return Iu(t.type);case 16:return Iu("Lazy");case 13:return Iu("Suspense");case 19:return Iu("SuspenseList");case 0:case 2:case 15:return t=lg(t.type,!1),t;case 11:return t=lg(t.type.render,!1),t;case 1:return t=lg(t.type,!0),t;default:return""}}function bv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Cc:return"Fragment";case _c:return"Portal";case yv:return"Profiler";case Z0:return"StrictMode";case Sv:return"Suspense";case wv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case s1:return(t.displayName||"Context")+".Consumer";case i1:return(t._context.displayName||"Context")+".Provider";case eS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tS:return e=t.displayName||null,e!==null?e:bv(t.type)||"Memo";case ko:e=t._payload,t=t._init;try{return bv(t(e))}catch{}}return null}function tA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bv(e);case 8:return e===Z0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function na(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function a1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function nA(t){var e=a1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Tf(t){t._valueTracker||(t._valueTracker=nA(t))}function c1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=a1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ah(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ev(t,e){var n=e.checked;return _t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Cb(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=na(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function l1(t,e){e=e.checked,e!=null&&Q0(t,"checked",e,!1)}function kv(t,e){l1(t,e);var n=na(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Tv(t,e.type,n):e.hasOwnProperty("defaultValue")&&Tv(t,e.type,na(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ib(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Tv(t,e,n){(e!=="number"||Ah(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ru=Array.isArray;function qc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+na(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function _v(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return _t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ae(92));if(Ru(n)){if(1<n.length)throw Error(ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:na(n)}}function u1(t,e){var n=na(e.value),r=na(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Pb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function d1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?d1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _f,f1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_f=_f||document.createElement("div"),_f.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_f.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Uu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rA=["Webkit","ms","Moz","O"];Object.keys(Uu).forEach(function(t){rA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Uu[e]=Uu[t]})});function h1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Uu.hasOwnProperty(t)&&Uu[t]?(""+e).trim():e+"px"}function p1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=h1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var iA=_t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Iv(t,e){if(e){if(iA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function Rv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pv=null;function nS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var xv=null,Jc=null,Kc=null;function xb(t){if(t=Yd(t)){if(typeof xv!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=qp(e),xv(t.stateNode,t.type,e))}}function m1(t){Jc?Kc?Kc.push(t):Kc=[t]:Jc=t}function g1(){if(Jc){var t=Jc,e=Kc;if(Kc=Jc=null,xb(t),e)for(t=0;t<e.length;t++)xb(e[t])}}function v1(t,e){return t(e)}function y1(){}var ug=!1;function S1(t,e,n){if(ug)return t(e,n);ug=!0;try{return v1(t,e,n)}finally{ug=!1,(Jc!==null||Kc!==null)&&(y1(),g1())}}function od(t,e){var n=t.stateNode;if(n===null)return null;var r=qp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ae(231,e,typeof n));return n}var Nv=!1;if(Xs)try{var ou={};Object.defineProperty(ou,"passive",{get:function(){Nv=!0}}),window.addEventListener("test",ou,ou),window.removeEventListener("test",ou,ou)}catch{Nv=!1}function sA(t,e,n,r,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var Bu=!1,Dh=null,Lh=!1,Mv=null,oA={onError:function(t){Bu=!0,Dh=t}};function aA(t,e,n,r,i,s,o,a,c){Bu=!1,Dh=null,sA.apply(oA,arguments)}function cA(t,e,n,r,i,s,o,a,c){if(aA.apply(this,arguments),Bu){if(Bu){var l=Dh;Bu=!1,Dh=null}else throw Error(ae(198));Lh||(Lh=!0,Mv=l)}}function tc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function w1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Nb(t){if(tc(t)!==t)throw Error(ae(188))}function lA(t){var e=t.alternate;if(!e){if(e=tc(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Nb(i),t;if(s===r)return Nb(i),e;s=s.sibling}throw Error(ae(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?t:e}function b1(t){return t=lA(t),t!==null?E1(t):null}function E1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=E1(t);if(e!==null)return e;t=t.sibling}return null}var k1=Tr.unstable_scheduleCallback,Mb=Tr.unstable_cancelCallback,uA=Tr.unstable_shouldYield,dA=Tr.unstable_requestPaint,Lt=Tr.unstable_now,fA=Tr.unstable_getCurrentPriorityLevel,rS=Tr.unstable_ImmediatePriority,T1=Tr.unstable_UserBlockingPriority,Fh=Tr.unstable_NormalPriority,hA=Tr.unstable_LowPriority,_1=Tr.unstable_IdlePriority,zp=null,rs=null;function pA(t){if(rs&&typeof rs.onCommitFiberRoot=="function")try{rs.onCommitFiberRoot(zp,t,void 0,(t.current.flags&128)===128)}catch{}}var gi=Math.clz32?Math.clz32:vA,mA=Math.log,gA=Math.LN2;function vA(t){return t>>>=0,t===0?32:31-(mA(t)/gA|0)|0}var Cf=64,If=4194304;function Pu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Uh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Pu(a):(s&=o,s!==0&&(r=Pu(s)))}else o=n&~i,o!==0?r=Pu(o):s!==0&&(r=Pu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-gi(e),i=1<<n,r|=t[n],e&=~i;return r}function yA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function SA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-gi(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=yA(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function Ov(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function C1(){var t=Cf;return Cf<<=1,!(Cf&4194240)&&(Cf=64),t}function dg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Jd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gi(e),t[e]=n}function wA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-gi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function iS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-gi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var qe=0;function I1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var R1,sS,P1,x1,N1,Av=!1,Rf=[],Vo=null,zo=null,Wo=null,ad=new Map,cd=new Map,Po=[],bA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ob(t,e){switch(t){case"focusin":case"focusout":Vo=null;break;case"dragenter":case"dragleave":zo=null;break;case"mouseover":case"mouseout":Wo=null;break;case"pointerover":case"pointerout":ad.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":cd.delete(e.pointerId)}}function au(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Yd(e),e!==null&&sS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function EA(t,e,n,r,i){switch(e){case"focusin":return Vo=au(Vo,t,e,n,r,i),!0;case"dragenter":return zo=au(zo,t,e,n,r,i),!0;case"mouseover":return Wo=au(Wo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ad.set(s,au(ad.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,cd.set(s,au(cd.get(s)||null,t,e,n,r,i)),!0}return!1}function M1(t){var e=ka(t.target);if(e!==null){var n=tc(e);if(n!==null){if(e=n.tag,e===13){if(e=w1(n),e!==null){t.blockedOn=e,N1(t.priority,function(){P1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function oh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Dv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Pv=r,n.target.dispatchEvent(r),Pv=null}else return e=Yd(n),e!==null&&sS(e),t.blockedOn=n,!1;e.shift()}return!0}function Ab(t,e,n){oh(t)&&n.delete(e)}function kA(){Av=!1,Vo!==null&&oh(Vo)&&(Vo=null),zo!==null&&oh(zo)&&(zo=null),Wo!==null&&oh(Wo)&&(Wo=null),ad.forEach(Ab),cd.forEach(Ab)}function cu(t,e){t.blockedOn===e&&(t.blockedOn=null,Av||(Av=!0,Tr.unstable_scheduleCallback(Tr.unstable_NormalPriority,kA)))}function ld(t){function e(i){return cu(i,t)}if(0<Rf.length){cu(Rf[0],t);for(var n=1;n<Rf.length;n++){var r=Rf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Vo!==null&&cu(Vo,t),zo!==null&&cu(zo,t),Wo!==null&&cu(Wo,t),ad.forEach(e),cd.forEach(e),n=0;n<Po.length;n++)r=Po[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Po.length&&(n=Po[0],n.blockedOn===null);)M1(n),n.blockedOn===null&&Po.shift()}var Yc=so.ReactCurrentBatchConfig,Bh=!0;function TA(t,e,n,r){var i=qe,s=Yc.transition;Yc.transition=null;try{qe=1,oS(t,e,n,r)}finally{qe=i,Yc.transition=s}}function _A(t,e,n,r){var i=qe,s=Yc.transition;Yc.transition=null;try{qe=4,oS(t,e,n,r)}finally{qe=i,Yc.transition=s}}function oS(t,e,n,r){if(Bh){var i=Dv(t,e,n,r);if(i===null)bg(t,e,r,jh,n),Ob(t,r);else if(EA(i,t,e,n,r))r.stopPropagation();else if(Ob(t,r),e&4&&-1<bA.indexOf(t)){for(;i!==null;){var s=Yd(i);if(s!==null&&R1(s),s=Dv(t,e,n,r),s===null&&bg(t,e,r,jh,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else bg(t,e,r,null,n)}}var jh=null;function Dv(t,e,n,r){if(jh=null,t=nS(r),t=ka(t),t!==null)if(e=tc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=w1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jh=t,null}function O1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fA()){case rS:return 1;case T1:return 4;case Fh:case hA:return 16;case _1:return 536870912;default:return 16}default:return 16}}var Oo=null,aS=null,ah=null;function A1(){if(ah)return ah;var t,e=aS,n=e.length,r,i="value"in Oo?Oo.value:Oo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ah=i.slice(t,1<r?1-r:void 0)}function ch(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Pf(){return!0}function Db(){return!1}function Ir(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Pf:Db,this.isPropagationStopped=Db,this}return _t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Pf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Pf)},persist:function(){},isPersistent:Pf}),e}var Vl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cS=Ir(Vl),Kd=_t({},Vl,{view:0,detail:0}),CA=Ir(Kd),fg,hg,lu,Wp=_t({},Kd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==lu&&(lu&&t.type==="mousemove"?(fg=t.screenX-lu.screenX,hg=t.screenY-lu.screenY):hg=fg=0,lu=t),fg)},movementY:function(t){return"movementY"in t?t.movementY:hg}}),Lb=Ir(Wp),IA=_t({},Wp,{dataTransfer:0}),RA=Ir(IA),PA=_t({},Kd,{relatedTarget:0}),pg=Ir(PA),xA=_t({},Vl,{animationName:0,elapsedTime:0,pseudoElement:0}),NA=Ir(xA),MA=_t({},Vl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),OA=Ir(MA),AA=_t({},Vl,{data:0}),Fb=Ir(AA),DA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=FA[t])?!!e[t]:!1}function lS(){return UA}var BA=_t({},Kd,{key:function(t){if(t.key){var e=DA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ch(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?LA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lS,charCode:function(t){return t.type==="keypress"?ch(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ch(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jA=Ir(BA),$A=_t({},Wp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ub=Ir($A),VA=_t({},Kd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lS}),zA=Ir(VA),WA=_t({},Vl,{propertyName:0,elapsedTime:0,pseudoElement:0}),HA=Ir(WA),GA=_t({},Wp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),qA=Ir(GA),JA=[9,13,27,32],uS=Xs&&"CompositionEvent"in window,ju=null;Xs&&"documentMode"in document&&(ju=document.documentMode);var KA=Xs&&"TextEvent"in window&&!ju,D1=Xs&&(!uS||ju&&8<ju&&11>=ju),Bb=" ",jb=!1;function L1(t,e){switch(t){case"keyup":return JA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ic=!1;function YA(t,e){switch(t){case"compositionend":return F1(e);case"keypress":return e.which!==32?null:(jb=!0,Bb);case"textInput":return t=e.data,t===Bb&&jb?null:t;default:return null}}function XA(t,e){if(Ic)return t==="compositionend"||!uS&&L1(t,e)?(t=A1(),ah=aS=Oo=null,Ic=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return D1&&e.locale!=="ko"?null:e.data;default:return null}}var QA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $b(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!QA[t.type]:e==="textarea"}function U1(t,e,n,r){m1(r),e=$h(e,"onChange"),0<e.length&&(n=new cS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var $u=null,ud=null;function ZA(t){K1(t,0)}function Hp(t){var e=xc(t);if(c1(e))return t}function eD(t,e){if(t==="change")return e}var B1=!1;if(Xs){var mg;if(Xs){var gg="oninput"in document;if(!gg){var Vb=document.createElement("div");Vb.setAttribute("oninput","return;"),gg=typeof Vb.oninput=="function"}mg=gg}else mg=!1;B1=mg&&(!document.documentMode||9<document.documentMode)}function zb(){$u&&($u.detachEvent("onpropertychange",j1),ud=$u=null)}function j1(t){if(t.propertyName==="value"&&Hp(ud)){var e=[];U1(e,ud,t,nS(t)),S1(ZA,e)}}function tD(t,e,n){t==="focusin"?(zb(),$u=e,ud=n,$u.attachEvent("onpropertychange",j1)):t==="focusout"&&zb()}function nD(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Hp(ud)}function rD(t,e){if(t==="click")return Hp(e)}function iD(t,e){if(t==="input"||t==="change")return Hp(e)}function sD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wi=typeof Object.is=="function"?Object.is:sD;function dd(t,e){if(wi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!vv.call(e,i)||!wi(t[i],e[i]))return!1}return!0}function Wb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hb(t,e){var n=Wb(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wb(n)}}function $1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function V1(){for(var t=window,e=Ah();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ah(t.document)}return e}function dS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function oD(t){var e=V1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$1(n.ownerDocument.documentElement,n)){if(r!==null&&dS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Hb(n,s);var o=Hb(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var aD=Xs&&"documentMode"in document&&11>=document.documentMode,Rc=null,Lv=null,Vu=null,Fv=!1;function Gb(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Fv||Rc==null||Rc!==Ah(r)||(r=Rc,"selectionStart"in r&&dS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vu&&dd(Vu,r)||(Vu=r,r=$h(Lv,"onSelect"),0<r.length&&(e=new cS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Rc)))}function xf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Pc={animationend:xf("Animation","AnimationEnd"),animationiteration:xf("Animation","AnimationIteration"),animationstart:xf("Animation","AnimationStart"),transitionend:xf("Transition","TransitionEnd")},vg={},z1={};Xs&&(z1=document.createElement("div").style,"AnimationEvent"in window||(delete Pc.animationend.animation,delete Pc.animationiteration.animation,delete Pc.animationstart.animation),"TransitionEvent"in window||delete Pc.transitionend.transition);function Gp(t){if(vg[t])return vg[t];if(!Pc[t])return t;var e=Pc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in z1)return vg[t]=e[n];return t}var W1=Gp("animationend"),H1=Gp("animationiteration"),G1=Gp("animationstart"),q1=Gp("transitionend"),J1=new Map,qb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function la(t,e){J1.set(t,e),ec(e,[t])}for(var yg=0;yg<qb.length;yg++){var Sg=qb[yg],cD=Sg.toLowerCase(),lD=Sg[0].toUpperCase()+Sg.slice(1);la(cD,"on"+lD)}la(W1,"onAnimationEnd");la(H1,"onAnimationIteration");la(G1,"onAnimationStart");la("dblclick","onDoubleClick");la("focusin","onFocus");la("focusout","onBlur");la(q1,"onTransitionEnd");yl("onMouseEnter",["mouseout","mouseover"]);yl("onMouseLeave",["mouseout","mouseover"]);yl("onPointerEnter",["pointerout","pointerover"]);yl("onPointerLeave",["pointerout","pointerover"]);ec("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ec("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ec("onBeforeInput",["compositionend","keypress","textInput","paste"]);ec("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ec("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ec("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uD=new Set("cancel close invalid load scroll toggle".split(" ").concat(xu));function Jb(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,cA(r,e,void 0,t),t.currentTarget=null}function K1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;Jb(i,a,l),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;Jb(i,a,l),s=c}}}if(Lh)throw t=Mv,Lh=!1,Mv=null,t}function ut(t,e){var n=e[Vv];n===void 0&&(n=e[Vv]=new Set);var r=t+"__bubble";n.has(r)||(Y1(e,t,2,!1),n.add(r))}function wg(t,e,n){var r=0;e&&(r|=4),Y1(n,t,r,e)}var Nf="_reactListening"+Math.random().toString(36).slice(2);function fd(t){if(!t[Nf]){t[Nf]=!0,r1.forEach(function(n){n!=="selectionchange"&&(uD.has(n)||wg(n,!1,t),wg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nf]||(e[Nf]=!0,wg("selectionchange",!1,e))}}function Y1(t,e,n,r){switch(O1(e)){case 1:var i=TA;break;case 4:i=_A;break;default:i=oS}n=i.bind(null,e,n,t),i=void 0,!Nv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function bg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ka(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}S1(function(){var l=s,u=nS(n),d=[];e:{var f=J1.get(t);if(f!==void 0){var h=cS,p=t;switch(t){case"keypress":if(ch(n)===0)break e;case"keydown":case"keyup":h=jA;break;case"focusin":p="focus",h=pg;break;case"focusout":p="blur",h=pg;break;case"beforeblur":case"afterblur":h=pg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Lb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=RA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=zA;break;case W1:case H1:case G1:h=NA;break;case q1:h=HA;break;case"scroll":h=CA;break;case"wheel":h=qA;break;case"copy":case"cut":case"paste":h=OA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Ub}var m=(e&4)!==0,w=!m&&t==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var v=l,b;v!==null;){b=v;var C=b.stateNode;if(b.tag===5&&C!==null&&(b=C,g!==null&&(C=od(v,g),C!=null&&m.push(hd(v,C,b)))),w)break;v=v.return}0<m.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Pv&&(p=n.relatedTarget||n.fromElement)&&(ka(p)||p[Qs]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?ka(p):null,p!==null&&(w=tc(p),p!==w||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(m=Lb,C="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=Ub,C="onPointerLeave",g="onPointerEnter",v="pointer"),w=h==null?f:xc(h),b=p==null?f:xc(p),f=new m(C,v+"leave",h,n,u),f.target=w,f.relatedTarget=b,C=null,ka(u)===l&&(m=new m(g,v+"enter",p,n,u),m.target=b,m.relatedTarget=w,C=m),w=C,h&&p)t:{for(m=h,g=p,v=0,b=m;b;b=gc(b))v++;for(b=0,C=g;C;C=gc(C))b++;for(;0<v-b;)m=gc(m),v--;for(;0<b-v;)g=gc(g),b--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=gc(m),g=gc(g)}m=null}else m=null;h!==null&&Kb(d,f,h,m,!1),p!==null&&w!==null&&Kb(d,w,p,m,!0)}}e:{if(f=l?xc(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var T=eD;else if($b(f))if(B1)T=iD;else{T=nD;var k=tD}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=rD);if(T&&(T=T(t,l))){U1(d,T,n,u);break e}k&&k(t,f,l),t==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&Tv(f,"number",f.value)}switch(k=l?xc(l):window,t){case"focusin":($b(k)||k.contentEditable==="true")&&(Rc=k,Lv=l,Vu=null);break;case"focusout":Vu=Lv=Rc=null;break;case"mousedown":Fv=!0;break;case"contextmenu":case"mouseup":case"dragend":Fv=!1,Gb(d,n,u);break;case"selectionchange":if(aD)break;case"keydown":case"keyup":Gb(d,n,u)}var I;if(uS)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Ic?L1(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(D1&&n.locale!=="ko"&&(Ic||R!=="onCompositionStart"?R==="onCompositionEnd"&&Ic&&(I=A1()):(Oo=u,aS="value"in Oo?Oo.value:Oo.textContent,Ic=!0)),k=$h(l,R),0<k.length&&(R=new Fb(R,t,null,n,u),d.push({event:R,listeners:k}),I?R.data=I:(I=F1(n),I!==null&&(R.data=I)))),(I=KA?YA(t,n):XA(t,n))&&(l=$h(l,"onBeforeInput"),0<l.length&&(u=new Fb("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=I))}K1(d,e)})}function hd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $h(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=od(t,n),s!=null&&r.unshift(hd(t,s,i)),s=od(t,e),s!=null&&r.push(hd(t,s,i))),t=t.return}return r}function gc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Kb(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=od(n,s),c!=null&&o.unshift(hd(n,c,a))):i||(c=od(n,s),c!=null&&o.push(hd(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var dD=/\r\n?/g,fD=/\u0000|\uFFFD/g;function Yb(t){return(typeof t=="string"?t:""+t).replace(dD,`
`).replace(fD,"")}function Mf(t,e,n){if(e=Yb(e),Yb(t)!==e&&n)throw Error(ae(425))}function Vh(){}var Uv=null,Bv=null;function jv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $v=typeof setTimeout=="function"?setTimeout:void 0,hD=typeof clearTimeout=="function"?clearTimeout:void 0,Xb=typeof Promise=="function"?Promise:void 0,pD=typeof queueMicrotask=="function"?queueMicrotask:typeof Xb<"u"?function(t){return Xb.resolve(null).then(t).catch(mD)}:$v;function mD(t){setTimeout(function(){throw t})}function Eg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ld(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ld(e)}function Ho(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Qb(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var zl=Math.random().toString(36).slice(2),Di="__reactFiber$"+zl,pd="__reactProps$"+zl,Qs="__reactContainer$"+zl,Vv="__reactEvents$"+zl,gD="__reactListeners$"+zl,vD="__reactHandles$"+zl;function ka(t){var e=t[Di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qs]||n[Di]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Qb(t);t!==null;){if(n=t[Di])return n;t=Qb(t)}return e}t=n,n=t.parentNode}return null}function Yd(t){return t=t[Di]||t[Qs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function qp(t){return t[pd]||null}var zv=[],Nc=-1;function ua(t){return{current:t}}function ht(t){0>Nc||(t.current=zv[Nc],zv[Nc]=null,Nc--)}function ct(t,e){Nc++,zv[Nc]=t.current,t.current=e}var ra={},xn=ua(ra),sr=ua(!1),Fa=ra;function Sl(t,e){var n=t.type.contextTypes;if(!n)return ra;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function or(t){return t=t.childContextTypes,t!=null}function zh(){ht(sr),ht(xn)}function Zb(t,e,n){if(xn.current!==ra)throw Error(ae(168));ct(xn,e),ct(sr,n)}function X1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ae(108,tA(t)||"Unknown",i));return _t({},n,r)}function Wh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ra,Fa=xn.current,ct(xn,t),ct(sr,sr.current),!0}function eE(t,e,n){var r=t.stateNode;if(!r)throw Error(ae(169));n?(t=X1(t,e,Fa),r.__reactInternalMemoizedMergedChildContext=t,ht(sr),ht(xn),ct(xn,t)):ht(sr),ct(sr,n)}var gs=null,Jp=!1,kg=!1;function Q1(t){gs===null?gs=[t]:gs.push(t)}function yD(t){Jp=!0,Q1(t)}function da(){if(!kg&&gs!==null){kg=!0;var t=0,e=qe;try{var n=gs;for(qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}gs=null,Jp=!1}catch(i){throw gs!==null&&(gs=gs.slice(t+1)),k1(rS,da),i}finally{qe=e,kg=!1}}return null}var Mc=[],Oc=0,Hh=null,Gh=0,Mr=[],Or=0,Ua=null,bs=1,Es="";function wa(t,e){Mc[Oc++]=Gh,Mc[Oc++]=Hh,Hh=t,Gh=e}function Z1(t,e,n){Mr[Or++]=bs,Mr[Or++]=Es,Mr[Or++]=Ua,Ua=t;var r=bs;t=Es;var i=32-gi(r)-1;r&=~(1<<i),n+=1;var s=32-gi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,bs=1<<32-gi(e)+i|n<<i|r,Es=s+t}else bs=1<<s|n<<i|r,Es=t}function fS(t){t.return!==null&&(wa(t,1),Z1(t,1,0))}function hS(t){for(;t===Hh;)Hh=Mc[--Oc],Mc[Oc]=null,Gh=Mc[--Oc],Mc[Oc]=null;for(;t===Ua;)Ua=Mr[--Or],Mr[Or]=null,Es=Mr[--Or],Mr[Or]=null,bs=Mr[--Or],Mr[Or]=null}var Er=null,Sr=null,St=!1,ai=null;function eC(t,e){var n=Dr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function tE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Er=t,Sr=Ho(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Er=t,Sr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ua!==null?{id:bs,overflow:Es}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Dr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Er=t,Sr=null,!0):!1;default:return!1}}function Wv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Hv(t){if(St){var e=Sr;if(e){var n=e;if(!tE(t,e)){if(Wv(t))throw Error(ae(418));e=Ho(n.nextSibling);var r=Er;e&&tE(t,e)?eC(r,n):(t.flags=t.flags&-4097|2,St=!1,Er=t)}}else{if(Wv(t))throw Error(ae(418));t.flags=t.flags&-4097|2,St=!1,Er=t}}}function nE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Er=t}function Of(t){if(t!==Er)return!1;if(!St)return nE(t),St=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jv(t.type,t.memoizedProps)),e&&(e=Sr)){if(Wv(t))throw tC(),Error(ae(418));for(;e;)eC(t,e),e=Ho(e.nextSibling)}if(nE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Sr=Ho(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Sr=null}}else Sr=Er?Ho(t.stateNode.nextSibling):null;return!0}function tC(){for(var t=Sr;t;)t=Ho(t.nextSibling)}function wl(){Sr=Er=null,St=!1}function pS(t){ai===null?ai=[t]:ai.push(t)}var SD=so.ReactCurrentBatchConfig;function Kr(t,e){if(t&&t.defaultProps){e=_t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var qh=ua(null),Jh=null,Ac=null,mS=null;function gS(){mS=Ac=Jh=null}function vS(t){var e=qh.current;ht(qh),t._currentValue=e}function Gv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Xc(t,e){Jh=t,mS=Ac=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rr=!0),t.firstContext=null)}function jr(t){var e=t._currentValue;if(mS!==t)if(t={context:t,memoizedValue:e,next:null},Ac===null){if(Jh===null)throw Error(ae(308));Ac=t,Jh.dependencies={lanes:0,firstContext:t}}else Ac=Ac.next=t;return e}var Ta=null;function yS(t){Ta===null?Ta=[t]:Ta.push(t)}function nC(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,yS(e)):(n.next=i.next,i.next=n),e.interleaved=n,Zs(t,r)}function Zs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var To=!1;function SS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Go(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,$e&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Zs(t,n)}return i=r.interleaved,i===null?(e.next=e,yS(r)):(e.next=i.next,i.next=e),r.interleaved=e,Zs(t,n)}function lh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iS(t,n)}}function rE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Kh(t,e,n,r){var i=t.updateQueue;To=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(s!==null){var d=i.baseState;o=0,u=l=c=null,a=s;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=_t({},d,f);break e;case 2:To=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=h,c=d):u=u.next=h,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ja|=o,t.lanes=o,t.memoizedState=d}}function iE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ae(191,i));i.call(r)}}}var iC=new n1.Component().refs;function qv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:_t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Kp={isMounted:function(t){return(t=t._reactInternals)?tc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Gn(),i=Jo(t),s=qs(r,i);s.payload=e,n!=null&&(s.callback=n),e=Go(t,s,i),e!==null&&(vi(e,t,i,r),lh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Gn(),i=Jo(t),s=qs(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Go(t,s,i),e!==null&&(vi(e,t,i,r),lh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Gn(),r=Jo(t),i=qs(n,r);i.tag=2,e!=null&&(i.callback=e),e=Go(t,i,r),e!==null&&(vi(e,t,r,n),lh(e,t,r))}};function sE(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!dd(n,r)||!dd(i,s):!0}function sC(t,e,n){var r=!1,i=ra,s=e.contextType;return typeof s=="object"&&s!==null?s=jr(s):(i=or(e)?Fa:xn.current,r=e.contextTypes,s=(r=r!=null)?Sl(t,i):ra),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Kp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function oE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Kp.enqueueReplaceState(e,e.state,null)}function Jv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=iC,SS(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=jr(s):(s=or(e)?Fa:xn.current,i.context=Sl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(qv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Kp.enqueueReplaceState(i,i.state,null),Kh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function uu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===iC&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,t))}return t}function Af(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function aE(t){var e=t._init;return e(t._payload)}function oC(t){function e(g,v){if(t){var b=g.deletions;b===null?(g.deletions=[v],g.flags|=16):b.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function i(g,v){return g=Ko(g,v),g.index=0,g.sibling=null,g}function s(g,v,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<v?(g.flags|=2,v):b):(g.flags|=2,v)):(g.flags|=1048576,v)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,v,b,C){return v===null||v.tag!==6?(v=xg(b,g.mode,C),v.return=g,v):(v=i(v,b),v.return=g,v)}function c(g,v,b,C){var T=b.type;return T===Cc?u(g,v,b.props.children,C,b.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ko&&aE(T)===v.type)?(C=i(v,b.props),C.ref=uu(g,v,b),C.return=g,C):(C=mh(b.type,b.key,b.props,null,g.mode,C),C.ref=uu(g,v,b),C.return=g,C)}function l(g,v,b,C){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=Ng(b,g.mode,C),v.return=g,v):(v=i(v,b.children||[]),v.return=g,v)}function u(g,v,b,C,T){return v===null||v.tag!==7?(v=Oa(b,g.mode,C,T),v.return=g,v):(v=i(v,b),v.return=g,v)}function d(g,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=xg(""+v,g.mode,b),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case kf:return b=mh(v.type,v.key,v.props,null,g.mode,b),b.ref=uu(g,null,v),b.return=g,b;case _c:return v=Ng(v,g.mode,b),v.return=g,v;case ko:var C=v._init;return d(g,C(v._payload),b)}if(Ru(v)||su(v))return v=Oa(v,g.mode,b,null),v.return=g,v;Af(g,v)}return null}function f(g,v,b,C){var T=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return T!==null?null:a(g,v,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case kf:return b.key===T?c(g,v,b,C):null;case _c:return b.key===T?l(g,v,b,C):null;case ko:return T=b._init,f(g,v,T(b._payload),C)}if(Ru(b)||su(b))return T!==null?null:u(g,v,b,C,null);Af(g,b)}return null}function h(g,v,b,C,T){if(typeof C=="string"&&C!==""||typeof C=="number")return g=g.get(b)||null,a(v,g,""+C,T);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case kf:return g=g.get(C.key===null?b:C.key)||null,c(v,g,C,T);case _c:return g=g.get(C.key===null?b:C.key)||null,l(v,g,C,T);case ko:var k=C._init;return h(g,v,b,k(C._payload),T)}if(Ru(C)||su(C))return g=g.get(b)||null,u(v,g,C,T,null);Af(v,C)}return null}function p(g,v,b,C){for(var T=null,k=null,I=v,R=v=0,N=null;I!==null&&R<b.length;R++){I.index>R?(N=I,I=null):N=I.sibling;var M=f(g,I,b[R],C);if(M===null){I===null&&(I=N);break}t&&I&&M.alternate===null&&e(g,I),v=s(M,v,R),k===null?T=M:k.sibling=M,k=M,I=N}if(R===b.length)return n(g,I),St&&wa(g,R),T;if(I===null){for(;R<b.length;R++)I=d(g,b[R],C),I!==null&&(v=s(I,v,R),k===null?T=I:k.sibling=I,k=I);return St&&wa(g,R),T}for(I=r(g,I);R<b.length;R++)N=h(I,g,R,b[R],C),N!==null&&(t&&N.alternate!==null&&I.delete(N.key===null?R:N.key),v=s(N,v,R),k===null?T=N:k.sibling=N,k=N);return t&&I.forEach(function(L){return e(g,L)}),St&&wa(g,R),T}function m(g,v,b,C){var T=su(b);if(typeof T!="function")throw Error(ae(150));if(b=T.call(b),b==null)throw Error(ae(151));for(var k=T=null,I=v,R=v=0,N=null,M=b.next();I!==null&&!M.done;R++,M=b.next()){I.index>R?(N=I,I=null):N=I.sibling;var L=f(g,I,M.value,C);if(L===null){I===null&&(I=N);break}t&&I&&L.alternate===null&&e(g,I),v=s(L,v,R),k===null?T=L:k.sibling=L,k=L,I=N}if(M.done)return n(g,I),St&&wa(g,R),T;if(I===null){for(;!M.done;R++,M=b.next())M=d(g,M.value,C),M!==null&&(v=s(M,v,R),k===null?T=M:k.sibling=M,k=M);return St&&wa(g,R),T}for(I=r(g,I);!M.done;R++,M=b.next())M=h(I,g,R,M.value,C),M!==null&&(t&&M.alternate!==null&&I.delete(M.key===null?R:M.key),v=s(M,v,R),k===null?T=M:k.sibling=M,k=M);return t&&I.forEach(function(F){return e(g,F)}),St&&wa(g,R),T}function w(g,v,b,C){if(typeof b=="object"&&b!==null&&b.type===Cc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case kf:e:{for(var T=b.key,k=v;k!==null;){if(k.key===T){if(T=b.type,T===Cc){if(k.tag===7){n(g,k.sibling),v=i(k,b.props.children),v.return=g,g=v;break e}}else if(k.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ko&&aE(T)===k.type){n(g,k.sibling),v=i(k,b.props),v.ref=uu(g,k,b),v.return=g,g=v;break e}n(g,k);break}else e(g,k);k=k.sibling}b.type===Cc?(v=Oa(b.props.children,g.mode,C,b.key),v.return=g,g=v):(C=mh(b.type,b.key,b.props,null,g.mode,C),C.ref=uu(g,v,b),C.return=g,g=C)}return o(g);case _c:e:{for(k=b.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){n(g,v.sibling),v=i(v,b.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=Ng(b,g.mode,C),v.return=g,g=v}return o(g);case ko:return k=b._init,w(g,v,k(b._payload),C)}if(Ru(b))return p(g,v,b,C);if(su(b))return m(g,v,b,C);Af(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(n(g,v.sibling),v=i(v,b),v.return=g,g=v):(n(g,v),v=xg(b,g.mode,C),v.return=g,g=v),o(g)):n(g,v)}return w}var bl=oC(!0),aC=oC(!1),Xd={},is=ua(Xd),md=ua(Xd),gd=ua(Xd);function _a(t){if(t===Xd)throw Error(ae(174));return t}function wS(t,e){switch(ct(gd,e),ct(md,t),ct(is,Xd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cv(e,t)}ht(is),ct(is,e)}function El(){ht(is),ht(md),ht(gd)}function cC(t){_a(gd.current);var e=_a(is.current),n=Cv(e,t.type);e!==n&&(ct(md,t),ct(is,n))}function bS(t){md.current===t&&(ht(is),ht(md))}var wt=ua(0);function Yh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Tg=[];function ES(){for(var t=0;t<Tg.length;t++)Tg[t]._workInProgressVersionPrimary=null;Tg.length=0}var uh=so.ReactCurrentDispatcher,_g=so.ReactCurrentBatchConfig,Ba=0,kt=null,Ht=null,on=null,Xh=!1,zu=!1,vd=0,wD=0;function En(){throw Error(ae(321))}function kS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wi(t[n],e[n]))return!1;return!0}function TS(t,e,n,r,i,s){if(Ba=s,kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,uh.current=t===null||t.memoizedState===null?TD:_D,t=n(r,i),zu){s=0;do{if(zu=!1,vd=0,25<=s)throw Error(ae(301));s+=1,on=Ht=null,e.updateQueue=null,uh.current=CD,t=n(r,i)}while(zu)}if(uh.current=Qh,e=Ht!==null&&Ht.next!==null,Ba=0,on=Ht=kt=null,Xh=!1,e)throw Error(ae(300));return t}function _S(){var t=vd!==0;return vd=0,t}function Pi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?kt.memoizedState=on=t:on=on.next=t,on}function $r(){if(Ht===null){var t=kt.alternate;t=t!==null?t.memoizedState:null}else t=Ht.next;var e=on===null?kt.memoizedState:on.next;if(e!==null)on=e,Ht=t;else{if(t===null)throw Error(ae(310));Ht=t,t={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},on===null?kt.memoizedState=on=t:on=on.next=t}return on}function yd(t,e){return typeof e=="function"?e(t):e}function Cg(t){var e=$r(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=Ht,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,l=s;do{var u=l.lane;if((Ba&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,o=r):c=c.next=d,kt.lanes|=u,ja|=u}l=l.next}while(l!==null&&l!==s);c===null?o=r:c.next=a,wi(r,e.memoizedState)||(rr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,kt.lanes|=s,ja|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ig(t){var e=$r(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);wi(s,e.memoizedState)||(rr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function lC(){}function uC(t,e){var n=kt,r=$r(),i=e(),s=!wi(r.memoizedState,i);if(s&&(r.memoizedState=i,rr=!0),r=r.queue,CS(hC.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||on!==null&&on.memoizedState.tag&1){if(n.flags|=2048,Sd(9,fC.bind(null,n,r,i,e),void 0,null),ln===null)throw Error(ae(349));Ba&30||dC(n,e,i)}return i}function dC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function fC(t,e,n,r){e.value=n,e.getSnapshot=r,pC(e)&&mC(t)}function hC(t,e,n){return n(function(){pC(e)&&mC(t)})}function pC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wi(t,n)}catch{return!0}}function mC(t){var e=Zs(t,1);e!==null&&vi(e,t,1,-1)}function cE(t){var e=Pi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yd,lastRenderedState:t},e.queue=t,t=t.dispatch=kD.bind(null,kt,t),[e.memoizedState,t]}function Sd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function gC(){return $r().memoizedState}function dh(t,e,n,r){var i=Pi();kt.flags|=t,i.memoizedState=Sd(1|e,n,void 0,r===void 0?null:r)}function Yp(t,e,n,r){var i=$r();r=r===void 0?null:r;var s=void 0;if(Ht!==null){var o=Ht.memoizedState;if(s=o.destroy,r!==null&&kS(r,o.deps)){i.memoizedState=Sd(e,n,s,r);return}}kt.flags|=t,i.memoizedState=Sd(1|e,n,s,r)}function lE(t,e){return dh(8390656,8,t,e)}function CS(t,e){return Yp(2048,8,t,e)}function vC(t,e){return Yp(4,2,t,e)}function yC(t,e){return Yp(4,4,t,e)}function SC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function wC(t,e,n){return n=n!=null?n.concat([t]):null,Yp(4,4,SC.bind(null,e,t),n)}function IS(){}function bC(t,e){var n=$r();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&kS(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function EC(t,e){var n=$r();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&kS(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function kC(t,e,n){return Ba&21?(wi(n,e)||(n=C1(),kt.lanes|=n,ja|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rr=!0),t.memoizedState=n)}function bD(t,e){var n=qe;qe=n!==0&&4>n?n:4,t(!0);var r=_g.transition;_g.transition={};try{t(!1),e()}finally{qe=n,_g.transition=r}}function TC(){return $r().memoizedState}function ED(t,e,n){var r=Jo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_C(t))CC(e,n);else if(n=nC(t,e,n,r),n!==null){var i=Gn();vi(n,t,r,i),IC(n,e,r)}}function kD(t,e,n){var r=Jo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_C(t))CC(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,wi(a,o)){var c=e.interleaved;c===null?(i.next=i,yS(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=nC(t,e,i,r),n!==null&&(i=Gn(),vi(n,t,r,i),IC(n,e,r))}}function _C(t){var e=t.alternate;return t===kt||e!==null&&e===kt}function CC(t,e){zu=Xh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function IC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iS(t,n)}}var Qh={readContext:jr,useCallback:En,useContext:En,useEffect:En,useImperativeHandle:En,useInsertionEffect:En,useLayoutEffect:En,useMemo:En,useReducer:En,useRef:En,useState:En,useDebugValue:En,useDeferredValue:En,useTransition:En,useMutableSource:En,useSyncExternalStore:En,useId:En,unstable_isNewReconciler:!1},TD={readContext:jr,useCallback:function(t,e){return Pi().memoizedState=[t,e===void 0?null:e],t},useContext:jr,useEffect:lE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,dh(4194308,4,SC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return dh(4194308,4,t,e)},useInsertionEffect:function(t,e){return dh(4,2,t,e)},useMemo:function(t,e){var n=Pi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Pi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ED.bind(null,kt,t),[r.memoizedState,t]},useRef:function(t){var e=Pi();return t={current:t},e.memoizedState=t},useState:cE,useDebugValue:IS,useDeferredValue:function(t){return Pi().memoizedState=t},useTransition:function(){var t=cE(!1),e=t[0];return t=bD.bind(null,t[1]),Pi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=kt,i=Pi();if(St){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=e(),ln===null)throw Error(ae(349));Ba&30||dC(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,lE(hC.bind(null,r,s,t),[t]),r.flags|=2048,Sd(9,fC.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Pi(),e=ln.identifierPrefix;if(St){var n=Es,r=bs;n=(r&~(1<<32-gi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=vd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},_D={readContext:jr,useCallback:bC,useContext:jr,useEffect:CS,useImperativeHandle:wC,useInsertionEffect:vC,useLayoutEffect:yC,useMemo:EC,useReducer:Cg,useRef:gC,useState:function(){return Cg(yd)},useDebugValue:IS,useDeferredValue:function(t){var e=$r();return kC(e,Ht.memoizedState,t)},useTransition:function(){var t=Cg(yd)[0],e=$r().memoizedState;return[t,e]},useMutableSource:lC,useSyncExternalStore:uC,useId:TC,unstable_isNewReconciler:!1},CD={readContext:jr,useCallback:bC,useContext:jr,useEffect:CS,useImperativeHandle:wC,useInsertionEffect:vC,useLayoutEffect:yC,useMemo:EC,useReducer:Ig,useRef:gC,useState:function(){return Ig(yd)},useDebugValue:IS,useDeferredValue:function(t){var e=$r();return Ht===null?e.memoizedState=t:kC(e,Ht.memoizedState,t)},useTransition:function(){var t=Ig(yd)[0],e=$r().memoizedState;return[t,e]},useMutableSource:lC,useSyncExternalStore:uC,useId:TC,unstable_isNewReconciler:!1};function kl(t,e){try{var n="",r=e;do n+=eA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Rg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Kv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ID=typeof WeakMap=="function"?WeakMap:Map;function RC(t,e,n){n=qs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ep||(ep=!0,sy=r),Kv(t,e)},n}function PC(t,e,n){n=qs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Kv(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Kv(t,e),typeof r!="function"&&(qo===null?qo=new Set([this]):qo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function uE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ID;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=$D.bind(null,t,e,n),e.then(t,t))}function dE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fE(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qs(-1,1),e.tag=2,Go(n,e,1))),n.lanes|=1),t)}var RD=so.ReactCurrentOwner,rr=!1;function Un(t,e,n,r){e.child=t===null?aC(e,null,n,r):bl(e,t.child,n,r)}function hE(t,e,n,r,i){n=n.render;var s=e.ref;return Xc(e,i),r=TS(t,e,n,r,s,i),n=_S(),t!==null&&!rr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,eo(t,e,i)):(St&&n&&fS(e),e.flags|=1,Un(t,e,r,i),e.child)}function pE(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!DS(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,xC(t,e,s,r,i)):(t=mh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:dd,n(o,r)&&t.ref===e.ref)return eo(t,e,i)}return e.flags|=1,t=Ko(s,r),t.ref=e.ref,t.return=e,e.child=t}function xC(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(dd(s,r)&&t.ref===e.ref)if(rr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(rr=!0);else return e.lanes=t.lanes,eo(t,e,i)}return Yv(t,e,n,r,i)}function NC(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Lc,mr),mr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(Lc,mr),mr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ct(Lc,mr),mr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ct(Lc,mr),mr|=r;return Un(t,e,i,n),e.child}function MC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Yv(t,e,n,r,i){var s=or(n)?Fa:xn.current;return s=Sl(e,s),Xc(e,i),n=TS(t,e,n,r,s,i),r=_S(),t!==null&&!rr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,eo(t,e,i)):(St&&r&&fS(e),e.flags|=1,Un(t,e,n,i),e.child)}function mE(t,e,n,r,i){if(or(n)){var s=!0;Wh(e)}else s=!1;if(Xc(e,i),e.stateNode===null)fh(t,e),sC(e,n,r),Jv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=jr(l):(l=or(n)?Fa:xn.current,l=Sl(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==l)&&oE(e,o,r,l),To=!1;var f=e.memoizedState;o.state=f,Kh(e,r,o,i),c=e.memoizedState,a!==r||f!==c||sr.current||To?(typeof u=="function"&&(qv(e,n,u,r),c=e.memoizedState),(a=To||sE(e,n,a,r,f,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,rC(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:Kr(e.type,a),o.props=l,d=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=jr(c):(c=or(n)?Fa:xn.current,c=Sl(e,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==c)&&oE(e,o,r,c),To=!1,f=e.memoizedState,o.state=f,Kh(e,r,o,i);var p=e.memoizedState;a!==d||f!==p||sr.current||To?(typeof h=="function"&&(qv(e,n,h,r),p=e.memoizedState),(l=To||sE(e,n,l,r,f,p,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Xv(t,e,n,r,s,i)}function Xv(t,e,n,r,i,s){MC(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&eE(e,n,!1),eo(t,e,s);r=e.stateNode,RD.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=bl(e,t.child,null,s),e.child=bl(e,null,a,s)):Un(t,e,a,s),e.memoizedState=r.state,i&&eE(e,n,!0),e.child}function OC(t){var e=t.stateNode;e.pendingContext?Zb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Zb(t,e.context,!1),wS(t,e.containerInfo)}function gE(t,e,n,r,i){return wl(),pS(i),e.flags|=256,Un(t,e,n,r),e.child}var Qv={dehydrated:null,treeContext:null,retryLane:0};function Zv(t){return{baseLanes:t,cachePool:null,transitions:null}}function AC(t,e,n){var r=e.pendingProps,i=wt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ct(wt,i&1),t===null)return Hv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Zp(o,r,0,null),t=Oa(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Zv(n),e.memoizedState=Qv,t):RS(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return PD(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ko(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ko(a,s):(s=Oa(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Zv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Qv,r}return s=t.child,t=s.sibling,r=Ko(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function RS(t,e){return e=Zp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Df(t,e,n,r){return r!==null&&pS(r),bl(e,t.child,null,n),t=RS(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PD(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Rg(Error(ae(422))),Df(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Zp({mode:"visible",children:r.children},i,0,null),s=Oa(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&bl(e,t.child,null,o),e.child.memoizedState=Zv(o),e.memoizedState=Qv,s);if(!(e.mode&1))return Df(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ae(419)),r=Rg(s,r,void 0),Df(t,e,o,r)}if(a=(o&t.childLanes)!==0,rr||a){if(r=ln,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Zs(t,i),vi(r,t,i,-1))}return AS(),r=Rg(Error(ae(421))),Df(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=VD.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Sr=Ho(i.nextSibling),Er=e,St=!0,ai=null,t!==null&&(Mr[Or++]=bs,Mr[Or++]=Es,Mr[Or++]=Ua,bs=t.id,Es=t.overflow,Ua=e),e=RS(e,r.children),e.flags|=4096,e)}function vE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Gv(t.return,e,n)}function Pg(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function DC(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Un(t,e,r.children,n),r=wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vE(t,n,e);else if(t.tag===19)vE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ct(wt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Yh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Pg(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Yh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Pg(e,!0,n,null,s);break;case"together":Pg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function eo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ja|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,n=Ko(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ko(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xD(t,e,n){switch(e.tag){case 3:OC(e),wl();break;case 5:cC(e);break;case 1:or(e.type)&&Wh(e);break;case 4:wS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ct(qh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ct(wt,wt.current&1),e.flags|=128,null):n&e.child.childLanes?AC(t,e,n):(ct(wt,wt.current&1),t=eo(t,e,n),t!==null?t.sibling:null);ct(wt,wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return DC(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ct(wt,wt.current),r)break;return null;case 22:case 23:return e.lanes=0,NC(t,e,n)}return eo(t,e,n)}var LC,ey,FC,UC;LC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ey=function(){};FC=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,_a(is.current);var s=null;switch(n){case"input":i=Ev(t,i),r=Ev(t,r),s=[];break;case"select":i=_t({},i,{value:void 0}),r=_t({},r,{value:void 0}),s=[];break;case"textarea":i=_v(t,i),r=_v(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Vh)}Iv(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(id.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(id.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&ut("scroll",t),s||a===c||(s=[])):(s=s||[]).push(l,c))}n&&(s=s||[]).push("style",n);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};UC=function(t,e,n,r){n!==r&&(e.flags|=4)};function du(t,e){if(!St)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function kn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ND(t,e,n){var r=e.pendingProps;switch(hS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(e),null;case 1:return or(e.type)&&zh(),kn(e),null;case 3:return r=e.stateNode,El(),ht(sr),ht(xn),ES(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Of(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ai!==null&&(cy(ai),ai=null))),ey(t,e),kn(e),null;case 5:bS(e);var i=_a(gd.current);if(n=e.type,t!==null&&e.stateNode!=null)FC(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ae(166));return kn(e),null}if(t=_a(is.current),Of(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Di]=e,r[pd]=s,t=(e.mode&1)!==0,n){case"dialog":ut("cancel",r),ut("close",r);break;case"iframe":case"object":case"embed":ut("load",r);break;case"video":case"audio":for(i=0;i<xu.length;i++)ut(xu[i],r);break;case"source":ut("error",r);break;case"img":case"image":case"link":ut("error",r),ut("load",r);break;case"details":ut("toggle",r);break;case"input":Cb(r,s),ut("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ut("invalid",r);break;case"textarea":Rb(r,s),ut("invalid",r)}Iv(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Mf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Mf(r.textContent,a,t),i=["children",""+a]):id.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ut("scroll",r)}switch(n){case"input":Tf(r),Ib(r,s,!0);break;case"textarea":Tf(r),Pb(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Vh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=d1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Di]=e,t[pd]=r,LC(t,e,!1,!1),e.stateNode=t;e:{switch(o=Rv(n,r),n){case"dialog":ut("cancel",t),ut("close",t),i=r;break;case"iframe":case"object":case"embed":ut("load",t),i=r;break;case"video":case"audio":for(i=0;i<xu.length;i++)ut(xu[i],t);i=r;break;case"source":ut("error",t),i=r;break;case"img":case"image":case"link":ut("error",t),ut("load",t),i=r;break;case"details":ut("toggle",t),i=r;break;case"input":Cb(t,r),i=Ev(t,r),ut("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=_t({},r,{value:void 0}),ut("invalid",t);break;case"textarea":Rb(t,r),i=_v(t,r),ut("invalid",t);break;default:i=r}Iv(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?p1(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&f1(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&sd(t,c):typeof c=="number"&&sd(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(id.hasOwnProperty(s)?c!=null&&s==="onScroll"&&ut("scroll",t):c!=null&&Q0(t,s,c,o))}switch(n){case"input":Tf(t),Ib(t,r,!1);break;case"textarea":Tf(t),Pb(t);break;case"option":r.value!=null&&t.setAttribute("value",""+na(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?qc(t,!!r.multiple,s,!1):r.defaultValue!=null&&qc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Vh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return kn(e),null;case 6:if(t&&e.stateNode!=null)UC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ae(166));if(n=_a(gd.current),_a(is.current),Of(e)){if(r=e.stateNode,n=e.memoizedProps,r[Di]=e,(s=r.nodeValue!==n)&&(t=Er,t!==null))switch(t.tag){case 3:Mf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Mf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Di]=e,e.stateNode=r}return kn(e),null;case 13:if(ht(wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(St&&Sr!==null&&e.mode&1&&!(e.flags&128))tC(),wl(),e.flags|=98560,s=!1;else if(s=Of(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ae(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ae(317));s[Di]=e}else wl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;kn(e),s=!1}else ai!==null&&(cy(ai),ai=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||wt.current&1?Jt===0&&(Jt=3):AS())),e.updateQueue!==null&&(e.flags|=4),kn(e),null);case 4:return El(),ey(t,e),t===null&&fd(e.stateNode.containerInfo),kn(e),null;case 10:return vS(e.type._context),kn(e),null;case 17:return or(e.type)&&zh(),kn(e),null;case 19:if(ht(wt),s=e.memoizedState,s===null)return kn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)du(s,!1);else{if(Jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Yh(t),o!==null){for(e.flags|=128,du(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(wt,wt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Lt()>Tl&&(e.flags|=128,r=!0,du(s,!1),e.lanes=4194304)}else{if(!r)if(t=Yh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),du(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!St)return kn(e),null}else 2*Lt()-s.renderingStartTime>Tl&&n!==1073741824&&(e.flags|=128,r=!0,du(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Lt(),e.sibling=null,n=wt.current,ct(wt,r?n&1|2:n&1),e):(kn(e),null);case 22:case 23:return OS(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?mr&1073741824&&(kn(e),e.subtreeFlags&6&&(e.flags|=8192)):kn(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function MD(t,e){switch(hS(e),e.tag){case 1:return or(e.type)&&zh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return El(),ht(sr),ht(xn),ES(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bS(e),null;case 13:if(ht(wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));wl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ht(wt),null;case 4:return El(),null;case 10:return vS(e.type._context),null;case 22:case 23:return OS(),null;case 24:return null;default:return null}}var Lf=!1,_n=!1,OD=typeof WeakSet=="function"?WeakSet:Set,de=null;function Dc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pt(t,e,r)}else n.current=null}function ty(t,e,n){try{n()}catch(r){Pt(t,e,r)}}var yE=!1;function AD(t,e){if(Uv=Bh,t=V1(),dS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++l===i&&(a=o),f===s&&++u===r&&(c=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bv={focusedElem:t,selectionRange:n},Bh=!1,de=e;de!==null;)if(e=de,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,de=t;else for(;de!==null;){e=de;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,w=p.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Kr(e.type,m),w);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(C){Pt(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}return p=yE,yE=!1,p}function Wu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ty(e,n,s)}i=i.next}while(i!==r)}}function Xp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ny(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function BC(t){var e=t.alternate;e!==null&&(t.alternate=null,BC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Di],delete e[pd],delete e[Vv],delete e[gD],delete e[vD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function jC(t){return t.tag===5||t.tag===3||t.tag===4}function SE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||jC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ry(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Vh));else if(r!==4&&(t=t.child,t!==null))for(ry(t,e,n),t=t.sibling;t!==null;)ry(t,e,n),t=t.sibling}function iy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(iy(t,e,n),t=t.sibling;t!==null;)iy(t,e,n),t=t.sibling}var pn=null,ii=!1;function mo(t,e,n){for(n=n.child;n!==null;)$C(t,e,n),n=n.sibling}function $C(t,e,n){if(rs&&typeof rs.onCommitFiberUnmount=="function")try{rs.onCommitFiberUnmount(zp,n)}catch{}switch(n.tag){case 5:_n||Dc(n,e);case 6:var r=pn,i=ii;pn=null,mo(t,e,n),pn=r,ii=i,pn!==null&&(ii?(t=pn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):pn.removeChild(n.stateNode));break;case 18:pn!==null&&(ii?(t=pn,n=n.stateNode,t.nodeType===8?Eg(t.parentNode,n):t.nodeType===1&&Eg(t,n),ld(t)):Eg(pn,n.stateNode));break;case 4:r=pn,i=ii,pn=n.stateNode.containerInfo,ii=!0,mo(t,e,n),pn=r,ii=i;break;case 0:case 11:case 14:case 15:if(!_n&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ty(n,e,o),i=i.next}while(i!==r)}mo(t,e,n);break;case 1:if(!_n&&(Dc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Pt(n,e,a)}mo(t,e,n);break;case 21:mo(t,e,n);break;case 22:n.mode&1?(_n=(r=_n)||n.memoizedState!==null,mo(t,e,n),_n=r):mo(t,e,n);break;default:mo(t,e,n)}}function wE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new OD),e.forEach(function(r){var i=zD.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Hr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:pn=a.stateNode,ii=!1;break e;case 3:pn=a.stateNode.containerInfo,ii=!0;break e;case 4:pn=a.stateNode.containerInfo,ii=!0;break e}a=a.return}if(pn===null)throw Error(ae(160));$C(s,o,i),pn=null,ii=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Pt(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)VC(e,t),e=e.sibling}function VC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hr(e,t),Ii(t),r&4){try{Wu(3,t,t.return),Xp(3,t)}catch(m){Pt(t,t.return,m)}try{Wu(5,t,t.return)}catch(m){Pt(t,t.return,m)}}break;case 1:Hr(e,t),Ii(t),r&512&&n!==null&&Dc(n,n.return);break;case 5:if(Hr(e,t),Ii(t),r&512&&n!==null&&Dc(n,n.return),t.flags&32){var i=t.stateNode;try{sd(i,"")}catch(m){Pt(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&l1(i,s),Rv(a,o);var l=Rv(a,s);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?p1(i,d):u==="dangerouslySetInnerHTML"?f1(i,d):u==="children"?sd(i,d):Q0(i,u,d,l)}switch(a){case"input":kv(i,s);break;case"textarea":u1(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?qc(i,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?qc(i,!!s.multiple,s.defaultValue,!0):qc(i,!!s.multiple,s.multiple?[]:"",!1))}i[pd]=s}catch(m){Pt(t,t.return,m)}}break;case 6:if(Hr(e,t),Ii(t),r&4){if(t.stateNode===null)throw Error(ae(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Pt(t,t.return,m)}}break;case 3:if(Hr(e,t),Ii(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ld(e.containerInfo)}catch(m){Pt(t,t.return,m)}break;case 4:Hr(e,t),Ii(t);break;case 13:Hr(e,t),Ii(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(NS=Lt())),r&4&&wE(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(_n=(l=_n)||u,Hr(e,t),_n=l):Hr(e,t),Ii(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(de=t,u=t.child;u!==null;){for(d=de=u;de!==null;){switch(f=de,h=f.child,f.tag){case 0:case 11:case 14:case 15:Wu(4,f,f.return);break;case 1:Dc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Pt(r,n,m)}}break;case 5:Dc(f,f.return);break;case 22:if(f.memoizedState!==null){EE(d);continue}}h!==null?(h.return=f,de=h):EE(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=h1("display",o))}catch(m){Pt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){Pt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Hr(e,t),Ii(t),r&4&&wE(t);break;case 21:break;default:Hr(e,t),Ii(t)}}function Ii(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(jC(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(sd(i,""),r.flags&=-33);var s=SE(t);iy(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=SE(t);ry(t,a,o);break;default:throw Error(ae(161))}}catch(c){Pt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DD(t,e,n){de=t,zC(t)}function zC(t,e,n){for(var r=(t.mode&1)!==0;de!==null;){var i=de,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Lf;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||_n;a=Lf;var l=_n;if(Lf=o,(_n=c)&&!l)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?kE(i):c!==null?(c.return=o,de=c):kE(i);for(;s!==null;)de=s,zC(s),s=s.sibling;de=i,Lf=a,_n=l}bE(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,de=s):bE(t)}}function bE(t){for(;de!==null;){var e=de;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:_n||Xp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!_n)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Kr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&iE(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}iE(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ld(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}_n||e.flags&512&&ny(e)}catch(f){Pt(e,e.return,f)}}if(e===t){de=null;break}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}}function EE(t){for(;de!==null;){var e=de;if(e===t){de=null;break}var n=e.sibling;if(n!==null){n.return=e.return,de=n;break}de=e.return}}function kE(t){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Xp(4,e)}catch(c){Pt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Pt(e,i,c)}}var s=e.return;try{ny(e)}catch(c){Pt(e,s,c)}break;case 5:var o=e.return;try{ny(e)}catch(c){Pt(e,o,c)}}}catch(c){Pt(e,e.return,c)}if(e===t){de=null;break}var a=e.sibling;if(a!==null){a.return=e.return,de=a;break}de=e.return}}var LD=Math.ceil,Zh=so.ReactCurrentDispatcher,PS=so.ReactCurrentOwner,Br=so.ReactCurrentBatchConfig,$e=0,ln=null,Bt=null,vn=0,mr=0,Lc=ua(0),Jt=0,wd=null,ja=0,Qp=0,xS=0,Hu=null,er=null,NS=0,Tl=1/0,hs=null,ep=!1,sy=null,qo=null,Ff=!1,Ao=null,tp=0,Gu=0,oy=null,hh=-1,ph=0;function Gn(){return $e&6?Lt():hh!==-1?hh:hh=Lt()}function Jo(t){return t.mode&1?$e&2&&vn!==0?vn&-vn:SD.transition!==null?(ph===0&&(ph=C1()),ph):(t=qe,t!==0||(t=window.event,t=t===void 0?16:O1(t.type)),t):1}function vi(t,e,n,r){if(50<Gu)throw Gu=0,oy=null,Error(ae(185));Jd(t,n,r),(!($e&2)||t!==ln)&&(t===ln&&(!($e&2)&&(Qp|=n),Jt===4&&xo(t,vn)),ar(t,r),n===1&&$e===0&&!(e.mode&1)&&(Tl=Lt()+500,Jp&&da()))}function ar(t,e){var n=t.callbackNode;SA(t,e);var r=Uh(t,t===ln?vn:0);if(r===0)n!==null&&Mb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Mb(n),e===1)t.tag===0?yD(TE.bind(null,t)):Q1(TE.bind(null,t)),pD(function(){!($e&6)&&da()}),n=null;else{switch(I1(r)){case 1:n=rS;break;case 4:n=T1;break;case 16:n=Fh;break;case 536870912:n=_1;break;default:n=Fh}n=XC(n,WC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function WC(t,e){if(hh=-1,ph=0,$e&6)throw Error(ae(327));var n=t.callbackNode;if(Qc()&&t.callbackNode!==n)return null;var r=Uh(t,t===ln?vn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=np(t,r);else{e=r;var i=$e;$e|=2;var s=GC();(ln!==t||vn!==e)&&(hs=null,Tl=Lt()+500,Ma(t,e));do try{BD();break}catch(a){HC(t,a)}while(!0);gS(),Zh.current=s,$e=i,Bt!==null?e=0:(ln=null,vn=0,e=Jt)}if(e!==0){if(e===2&&(i=Ov(t),i!==0&&(r=i,e=ay(t,i))),e===1)throw n=wd,Ma(t,0),xo(t,r),ar(t,Lt()),n;if(e===6)xo(t,r);else{if(i=t.current.alternate,!(r&30)&&!FD(i)&&(e=np(t,r),e===2&&(s=Ov(t),s!==0&&(r=s,e=ay(t,s))),e===1))throw n=wd,Ma(t,0),xo(t,r),ar(t,Lt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ae(345));case 2:ba(t,er,hs);break;case 3:if(xo(t,r),(r&130023424)===r&&(e=NS+500-Lt(),10<e)){if(Uh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Gn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=$v(ba.bind(null,t,er,hs),e);break}ba(t,er,hs);break;case 4:if(xo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-gi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*LD(r/1960))-r,10<r){t.timeoutHandle=$v(ba.bind(null,t,er,hs),r);break}ba(t,er,hs);break;case 5:ba(t,er,hs);break;default:throw Error(ae(329))}}}return ar(t,Lt()),t.callbackNode===n?WC.bind(null,t):null}function ay(t,e){var n=Hu;return t.current.memoizedState.isDehydrated&&(Ma(t,e).flags|=256),t=np(t,e),t!==2&&(e=er,er=n,e!==null&&cy(e)),t}function cy(t){er===null?er=t:er.push.apply(er,t)}function FD(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!wi(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xo(t,e){for(e&=~xS,e&=~Qp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-gi(e),r=1<<n;t[n]=-1,e&=~r}}function TE(t){if($e&6)throw Error(ae(327));Qc();var e=Uh(t,0);if(!(e&1))return ar(t,Lt()),null;var n=np(t,e);if(t.tag!==0&&n===2){var r=Ov(t);r!==0&&(e=r,n=ay(t,r))}if(n===1)throw n=wd,Ma(t,0),xo(t,e),ar(t,Lt()),n;if(n===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ba(t,er,hs),ar(t,Lt()),null}function MS(t,e){var n=$e;$e|=1;try{return t(e)}finally{$e=n,$e===0&&(Tl=Lt()+500,Jp&&da())}}function $a(t){Ao!==null&&Ao.tag===0&&!($e&6)&&Qc();var e=$e;$e|=1;var n=Br.transition,r=qe;try{if(Br.transition=null,qe=1,t)return t()}finally{qe=r,Br.transition=n,$e=e,!($e&6)&&da()}}function OS(){mr=Lc.current,ht(Lc)}function Ma(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,hD(n)),Bt!==null)for(n=Bt.return;n!==null;){var r=n;switch(hS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zh();break;case 3:El(),ht(sr),ht(xn),ES();break;case 5:bS(r);break;case 4:El();break;case 13:ht(wt);break;case 19:ht(wt);break;case 10:vS(r.type._context);break;case 22:case 23:OS()}n=n.return}if(ln=t,Bt=t=Ko(t.current,null),vn=mr=e,Jt=0,wd=null,xS=Qp=ja=0,er=Hu=null,Ta!==null){for(e=0;e<Ta.length;e++)if(n=Ta[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ta=null}return t}function HC(t,e){do{var n=Bt;try{if(gS(),uh.current=Qh,Xh){for(var r=kt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xh=!1}if(Ba=0,on=Ht=kt=null,zu=!1,vd=0,PS.current=null,n===null||n.return===null){Jt=1,wd=e,Bt=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=vn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=dE(o);if(h!==null){h.flags&=-257,fE(h,o,a,s,e),h.mode&1&&uE(s,l,e),e=h,c=l;var p=e.updateQueue;if(p===null){var m=new Set;m.add(c),e.updateQueue=m}else p.add(c);break e}else{if(!(e&1)){uE(s,l,e),AS();break e}c=Error(ae(426))}}else if(St&&a.mode&1){var w=dE(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),fE(w,o,a,s,e),pS(kl(c,a));break e}}s=c=kl(c,a),Jt!==4&&(Jt=2),Hu===null?Hu=[s]:Hu.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=RC(s,c,e);rE(s,g);break e;case 1:a=c;var v=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qo===null||!qo.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var C=PC(s,a,e);rE(s,C);break e}}s=s.return}while(s!==null)}JC(n)}catch(T){e=T,Bt===n&&n!==null&&(Bt=n=n.return);continue}break}while(!0)}function GC(){var t=Zh.current;return Zh.current=Qh,t===null?Qh:t}function AS(){(Jt===0||Jt===3||Jt===2)&&(Jt=4),ln===null||!(ja&268435455)&&!(Qp&268435455)||xo(ln,vn)}function np(t,e){var n=$e;$e|=2;var r=GC();(ln!==t||vn!==e)&&(hs=null,Ma(t,e));do try{UD();break}catch(i){HC(t,i)}while(!0);if(gS(),$e=n,Zh.current=r,Bt!==null)throw Error(ae(261));return ln=null,vn=0,Jt}function UD(){for(;Bt!==null;)qC(Bt)}function BD(){for(;Bt!==null&&!uA();)qC(Bt)}function qC(t){var e=YC(t.alternate,t,mr);t.memoizedProps=t.pendingProps,e===null?JC(t):Bt=e,PS.current=null}function JC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=MD(n,e),n!==null){n.flags&=32767,Bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jt=6,Bt=null;return}}else if(n=ND(n,e,mr),n!==null){Bt=n;return}if(e=e.sibling,e!==null){Bt=e;return}Bt=e=t}while(e!==null);Jt===0&&(Jt=5)}function ba(t,e,n){var r=qe,i=Br.transition;try{Br.transition=null,qe=1,jD(t,e,n,r)}finally{Br.transition=i,qe=r}return null}function jD(t,e,n,r){do Qc();while(Ao!==null);if($e&6)throw Error(ae(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(wA(t,s),t===ln&&(Bt=ln=null,vn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ff||(Ff=!0,XC(Fh,function(){return Qc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Br.transition,Br.transition=null;var o=qe;qe=1;var a=$e;$e|=4,PS.current=null,AD(t,n),VC(n,t),oD(Bv),Bh=!!Uv,Bv=Uv=null,t.current=n,DD(n),dA(),$e=a,qe=o,Br.transition=s}else t.current=n;if(Ff&&(Ff=!1,Ao=t,tp=i),s=t.pendingLanes,s===0&&(qo=null),pA(n.stateNode),ar(t,Lt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ep)throw ep=!1,t=sy,sy=null,t;return tp&1&&t.tag!==0&&Qc(),s=t.pendingLanes,s&1?t===oy?Gu++:(Gu=0,oy=t):Gu=0,da(),null}function Qc(){if(Ao!==null){var t=I1(tp),e=Br.transition,n=qe;try{if(Br.transition=null,qe=16>t?16:t,Ao===null)var r=!1;else{if(t=Ao,Ao=null,tp=0,$e&6)throw Error(ae(331));var i=$e;for($e|=4,de=t.current;de!==null;){var s=de,o=s.child;if(de.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(de=l;de!==null;){var u=de;switch(u.tag){case 0:case 11:case 15:Wu(8,u,s)}var d=u.child;if(d!==null)d.return=u,de=d;else for(;de!==null;){u=de;var f=u.sibling,h=u.return;if(BC(u),u===l){de=null;break}if(f!==null){f.return=h,de=f;break}de=h}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}de=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,de=o;else e:for(;de!==null;){if(s=de,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wu(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,de=g;break e}de=s.return}}var v=t.current;for(de=v;de!==null;){o=de;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,de=b;else e:for(o=v;de!==null;){if(a=de,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Xp(9,a)}}catch(T){Pt(a,a.return,T)}if(a===o){de=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,de=C;break e}de=a.return}}if($e=i,da(),rs&&typeof rs.onPostCommitFiberRoot=="function")try{rs.onPostCommitFiberRoot(zp,t)}catch{}r=!0}return r}finally{qe=n,Br.transition=e}}return!1}function _E(t,e,n){e=kl(n,e),e=RC(t,e,1),t=Go(t,e,1),e=Gn(),t!==null&&(Jd(t,1,e),ar(t,e))}function Pt(t,e,n){if(t.tag===3)_E(t,t,n);else for(;e!==null;){if(e.tag===3){_E(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qo===null||!qo.has(r))){t=kl(n,t),t=PC(e,t,1),e=Go(e,t,1),t=Gn(),e!==null&&(Jd(e,1,t),ar(e,t));break}}e=e.return}}function $D(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Gn(),t.pingedLanes|=t.suspendedLanes&n,ln===t&&(vn&n)===n&&(Jt===4||Jt===3&&(vn&130023424)===vn&&500>Lt()-NS?Ma(t,0):xS|=n),ar(t,e)}function KC(t,e){e===0&&(t.mode&1?(e=If,If<<=1,!(If&130023424)&&(If=4194304)):e=1);var n=Gn();t=Zs(t,e),t!==null&&(Jd(t,e,n),ar(t,n))}function VD(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),KC(t,n)}function zD(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(e),KC(t,n)}var YC;YC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||sr.current)rr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rr=!1,xD(t,e,n);rr=!!(t.flags&131072)}else rr=!1,St&&e.flags&1048576&&Z1(e,Gh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;fh(t,e),t=e.pendingProps;var i=Sl(e,xn.current);Xc(e,n),i=TS(null,e,r,t,i,n);var s=_S();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,or(r)?(s=!0,Wh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,SS(e),i.updater=Kp,e.stateNode=i,i._reactInternals=e,Jv(e,r,t,n),e=Xv(null,e,r,!0,s,n)):(e.tag=0,St&&s&&fS(e),Un(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(fh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=HD(r),t=Kr(r,t),i){case 0:e=Yv(null,e,r,t,n);break e;case 1:e=mE(null,e,r,t,n);break e;case 11:e=hE(null,e,r,t,n);break e;case 14:e=pE(null,e,r,Kr(r.type,t),n);break e}throw Error(ae(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kr(r,i),Yv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kr(r,i),mE(t,e,r,i,n);case 3:e:{if(OC(e),t===null)throw Error(ae(387));r=e.pendingProps,s=e.memoizedState,i=s.element,rC(t,e),Kh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=kl(Error(ae(423)),e),e=gE(t,e,r,n,i);break e}else if(r!==i){i=kl(Error(ae(424)),e),e=gE(t,e,r,n,i);break e}else for(Sr=Ho(e.stateNode.containerInfo.firstChild),Er=e,St=!0,ai=null,n=aC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wl(),r===i){e=eo(t,e,n);break e}Un(t,e,r,n)}e=e.child}return e;case 5:return cC(e),t===null&&Hv(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,jv(r,i)?o=null:s!==null&&jv(r,s)&&(e.flags|=32),MC(t,e),Un(t,e,o,n),e.child;case 6:return t===null&&Hv(e),null;case 13:return AC(t,e,n);case 4:return wS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=bl(e,null,r,n):Un(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kr(r,i),hE(t,e,r,i,n);case 7:return Un(t,e,e.pendingProps,n),e.child;case 8:return Un(t,e,e.pendingProps.children,n),e.child;case 12:return Un(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ct(qh,r._currentValue),r._currentValue=o,s!==null)if(wi(s.value,o)){if(s.children===i.children&&!sr.current){e=eo(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=qs(-1,n&-n),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Gv(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ae(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Gv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Un(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Xc(e,n),i=jr(i),r=r(i),e.flags|=1,Un(t,e,r,n),e.child;case 14:return r=e.type,i=Kr(r,e.pendingProps),i=Kr(r.type,i),pE(t,e,r,i,n);case 15:return xC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kr(r,i),fh(t,e),e.tag=1,or(r)?(t=!0,Wh(e)):t=!1,Xc(e,n),sC(e,r,i),Jv(e,r,i,n),Xv(null,e,r,!0,t,n);case 19:return DC(t,e,n);case 22:return NC(t,e,n)}throw Error(ae(156,e.tag))};function XC(t,e){return k1(t,e)}function WD(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(t,e,n,r){return new WD(t,e,n,r)}function DS(t){return t=t.prototype,!(!t||!t.isReactComponent)}function HD(t){if(typeof t=="function")return DS(t)?1:0;if(t!=null){if(t=t.$$typeof,t===eS)return 11;if(t===tS)return 14}return 2}function Ko(t,e){var n=t.alternate;return n===null?(n=Dr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function mh(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")DS(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Cc:return Oa(n.children,i,s,e);case Z0:o=8,i|=8;break;case yv:return t=Dr(12,n,e,i|2),t.elementType=yv,t.lanes=s,t;case Sv:return t=Dr(13,n,e,i),t.elementType=Sv,t.lanes=s,t;case wv:return t=Dr(19,n,e,i),t.elementType=wv,t.lanes=s,t;case o1:return Zp(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case i1:o=10;break e;case s1:o=9;break e;case eS:o=11;break e;case tS:o=14;break e;case ko:o=16,r=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=Dr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Oa(t,e,n,r){return t=Dr(7,t,r,e),t.lanes=n,t}function Zp(t,e,n,r){return t=Dr(22,t,r,e),t.elementType=o1,t.lanes=n,t.stateNode={isHidden:!1},t}function xg(t,e,n){return t=Dr(6,t,null,e),t.lanes=n,t}function Ng(t,e,n){return e=Dr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function GD(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dg(0),this.expirationTimes=dg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function LS(t,e,n,r,i,s,o,a,c){return t=new GD(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Dr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},SS(s),t}function qD(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_c,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function QC(t){if(!t)return ra;t=t._reactInternals;e:{if(tc(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(or(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var n=t.type;if(or(n))return X1(t,n,e)}return e}function ZC(t,e,n,r,i,s,o,a,c){return t=LS(n,r,!0,t,i,s,o,a,c),t.context=QC(null),n=t.current,r=Gn(),i=Jo(n),s=qs(r,i),s.callback=e??null,Go(n,s,i),t.current.lanes=i,Jd(t,i,r),ar(t,r),t}function em(t,e,n,r){var i=e.current,s=Gn(),o=Jo(i);return n=QC(n),e.context===null?e.context=n:e.pendingContext=n,e=qs(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Go(i,e,o),t!==null&&(vi(t,i,o,s),lh(t,i,o)),o}function rp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function CE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function FS(t,e){CE(t,e),(t=t.alternate)&&CE(t,e)}function JD(){return null}var eI=typeof reportError=="function"?reportError:function(t){console.error(t)};function US(t){this._internalRoot=t}tm.prototype.render=US.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));em(t,e,null,null)};tm.prototype.unmount=US.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$a(function(){em(null,t,null,null)}),e[Qs]=null}};function tm(t){this._internalRoot=t}tm.prototype.unstable_scheduleHydration=function(t){if(t){var e=x1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Po.length&&e!==0&&e<Po[n].priority;n++);Po.splice(n,0,t),n===0&&M1(t)}};function BS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function nm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function IE(){}function KD(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var l=rp(o);s.call(l)}}var o=ZC(e,r,t,0,null,!1,!1,"",IE);return t._reactRootContainer=o,t[Qs]=o.current,fd(t.nodeType===8?t.parentNode:t),$a(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=rp(c);a.call(l)}}var c=LS(t,0,!1,null,null,!1,!1,"",IE);return t._reactRootContainer=c,t[Qs]=c.current,fd(t.nodeType===8?t.parentNode:t),$a(function(){em(e,c,n,r)}),c}function rm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=rp(o);a.call(c)}}em(e,o,t,i)}else o=KD(n,e,t,i,r);return rp(o)}R1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Pu(e.pendingLanes);n!==0&&(iS(e,n|1),ar(e,Lt()),!($e&6)&&(Tl=Lt()+500,da()))}break;case 13:$a(function(){var r=Zs(t,1);if(r!==null){var i=Gn();vi(r,t,1,i)}}),FS(t,1)}};sS=function(t){if(t.tag===13){var e=Zs(t,134217728);if(e!==null){var n=Gn();vi(e,t,134217728,n)}FS(t,134217728)}};P1=function(t){if(t.tag===13){var e=Jo(t),n=Zs(t,e);if(n!==null){var r=Gn();vi(n,t,e,r)}FS(t,e)}};x1=function(){return qe};N1=function(t,e){var n=qe;try{return qe=t,e()}finally{qe=n}};xv=function(t,e,n){switch(e){case"input":if(kv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=qp(r);if(!i)throw Error(ae(90));c1(r),kv(r,i)}}}break;case"textarea":u1(t,n);break;case"select":e=n.value,e!=null&&qc(t,!!n.multiple,e,!1)}};v1=MS;y1=$a;var YD={usingClientEntryPoint:!1,Events:[Yd,xc,qp,m1,g1,MS]},fu={findFiberByHostInstance:ka,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},XD={bundleType:fu.bundleType,version:fu.version,rendererPackageName:fu.rendererPackageName,rendererConfig:fu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:so.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=b1(t),t===null?null:t.stateNode},findFiberByHostInstance:fu.findFiberByHostInstance||JD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uf.isDisabled&&Uf.supportsFiber)try{zp=Uf.inject(XD),rs=Uf}catch{}}Cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YD;Cr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!BS(e))throw Error(ae(200));return qD(t,e,null,n)};Cr.createRoot=function(t,e){if(!BS(t))throw Error(ae(299));var n=!1,r="",i=eI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=LS(t,1,!1,null,null,n,!1,r,i),t[Qs]=e.current,fd(t.nodeType===8?t.parentNode:t),new US(e)};Cr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=b1(e),t=t===null?null:t.stateNode,t};Cr.flushSync=function(t){return $a(t)};Cr.hydrate=function(t,e,n){if(!nm(e))throw Error(ae(200));return rm(null,t,e,!0,n)};Cr.hydrateRoot=function(t,e,n){if(!BS(t))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=eI;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=ZC(e,null,t,1,n??null,i,!1,s,o),t[Qs]=e.current,fd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new tm(e)};Cr.render=function(t,e,n){if(!nm(e))throw Error(ae(200));return rm(null,t,e,!1,n)};Cr.unmountComponentAtNode=function(t){if(!nm(t))throw Error(ae(40));return t._reactRootContainer?($a(function(){rm(null,null,t,!1,function(){t._reactRootContainer=null,t[Qs]=null})}),!0):!1};Cr.unstable_batchedUpdates=MS;Cr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!nm(n))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return rm(t,e,n,!1,r)};Cr.version="18.2.0-next-9e3b772b8-20220608";function tI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tI)}catch(t){console.error(t)}}tI(),Z_.exports=Cr;var jS=Z_.exports;const QD=Gd(jS),ZD=V_({__proto__:null,default:QD},[jS]);var RE=jS;gv.createRoot=RE.createRoot,gv.hydrateRoot=RE.hydrateRoot;/**
 * @remix-run/router v1.14.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xt(){return xt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xt.apply(this,arguments)}var Ot;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ot||(Ot={}));const PE="popstate";function eL(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return bd("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Qd(i)}return nL(e,n,null,t)}function Ue(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Va(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tL(){return Math.random().toString(36).substr(2,8)}function xE(t,e){return{usr:t.state,key:t.key,idx:e}}function bd(t,e,n,r){return n===void 0&&(n=null),xt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?oo(e):e,{state:n,key:e&&e.key||r||tL()})}function Qd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function oo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function nL(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Ot.Pop,c=null,l=u();l==null&&(l=0,o.replaceState(xt({},o.state,{idx:l}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Ot.Pop;let w=u(),g=w==null?null:w-l;l=w,c&&c({action:a,location:m.location,delta:g})}function f(w,g){a=Ot.Push;let v=bd(m.location,w,g);n&&n(v,w),l=u()+1;let b=xE(v,l),C=m.createHref(v);try{o.pushState(b,"",C)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(C)}s&&c&&c({action:a,location:m.location,delta:1})}function h(w,g){a=Ot.Replace;let v=bd(m.location,w,g);n&&n(v,w),l=u();let b=xE(v,l),C=m.createHref(v);o.replaceState(b,"",C),s&&c&&c({action:a,location:m.location,delta:0})}function p(w){let g=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof w=="string"?w:Qd(w);return Ue(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let m={get action(){return a},get location(){return t(i,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(PE,d),c=w,()=>{i.removeEventListener(PE,d),c=null}},createHref(w){return e(i,w)},createURL:p,encodeLocation(w){let g=p(w);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(w){return o.go(w)}};return m}var Rt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Rt||(Rt={}));const rL=new Set(["lazy","caseSensitive","path","id","index","children"]);function iL(t){return t.index===!0}function ly(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,s)=>{let o=[...n,s],a=typeof i.id=="string"?i.id:o.join("-");if(Ue(i.index!==!0||!i.children,"Cannot specify children on an index route"),Ue(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),iL(i)){let c=xt({},i,e(i),{id:a});return r[a]=c,c}else{let c=xt({},i,e(i),{id:a,children:void 0});return r[a]=c,i.children&&(c.children=ly(i.children,e,o,r)),c}})}function Fc(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?oo(e):e,i=Zd(r.pathname||"/",n);if(i==null)return null;let s=nI(t);oL(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=mL(s[a],yL(i));return o}function sL(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function nI(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let c={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(Ue(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=Aa([r,c.relativePath]),u=n.concat(c);s.children&&s.children.length>0&&(Ue(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),nI(s.children,e,u,l)),!(s.path==null&&!s.index)&&e.push({path:l,score:hL(l,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let c of rI(s.path))i(s,o,c)}),e}function rI(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=rI(r.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function oL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:pL(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const aL=/^:\w+$/,cL=3,lL=2,uL=1,dL=10,fL=-2,NE=t=>t==="*";function hL(t,e){let n=t.split("/"),r=n.length;return n.some(NE)&&(r+=fL),e&&(r+=lL),n.filter(i=>!NE(i)).reduce((i,s)=>i+(aL.test(s)?cL:s===""?uL:dL),r)}function pL(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function mL(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],c=o===n.length-1,l=i==="/"?e:e.slice(i.length)||"/",u=gL({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},l);if(!u)return null;Object.assign(r,u.params);let d=a.route;s.push({params:r,pathname:Aa([i,u.pathname]),pathnameBase:TL(Aa([i,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(i=Aa([i,u.pathnameBase]))}return s}function gL(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=vL(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let m=a[d]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?l[f]=void 0:l[f]=SL(p||"",f),l},{}),pathname:s,pathnameBase:o,pattern:t}}function vL(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Va(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function yL(t){try{return decodeURI(t)}catch(e){return Va(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function SL(t,e){try{return decodeURIComponent(t)}catch(n){return Va(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Zd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function wL(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?oo(t):t;return{pathname:n?n.startsWith("/")?n:bL(n,e):e,search:_L(r),hash:CL(i)}}function bL(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Mg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function iI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function EL(t,e){let n=iI(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function kL(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=oo(t):(i=xt({},t),Ue(!i.pathname||!i.pathname.includes("?"),Mg("?","pathname","search",i)),Ue(!i.pathname||!i.pathname.includes("#"),Mg("#","pathname","hash",i)),Ue(!i.search||!i.search.includes("#"),Mg("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let c=wL(i,a),l=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Aa=t=>t.join("/").replace(/\/\/+/g,"/"),TL=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_L=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,CL=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class $S{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function sI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const oI=["post","put","patch","delete"],IL=new Set(oI),RL=["get",...oI],PL=new Set(RL),xL=new Set([301,302,303,307,308]),NL=new Set([307,308]),Og={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ML={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},hu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},aI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,OL=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),cI="remix-router-transitions";function AL(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Ue(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let U=t.detectErrorBoundary;i=$=>({hasErrorBoundary:U($)})}else i=OL;let s={},o=ly(t.routes,i,void 0,s),a,c=t.basename||"/",l=xt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},t.future),u=null,d=new Set,f=null,h=null,p=null,m=t.hydrationData!=null,w=Fc(o,t.history.location,c),g=null;if(w==null){let U=Nr(404,{pathname:t.history.location.pathname}),{matches:$,route:Z}=BE(o);w=$,g={[Z.id]:U}}let v,b=w.some(U=>U.route.lazy),C=w.some(U=>U.route.loader);if(b)v=!1;else if(!C)v=!0;else if(l.v7_partialHydration){let U=t.hydrationData?t.hydrationData.loaderData:null,$=t.hydrationData?t.hydrationData.errors:null;v=w.every(Z=>Z.route.loader&&Z.route.loader.hydrate!==!0&&(U&&U[Z.route.id]!==void 0||$&&$[Z.route.id]!==void 0))}else v=t.hydrationData!=null;let T,k={historyAction:t.history.action,location:t.history.location,matches:w,initialized:v,navigation:Og,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||g,fetchers:new Map,blockers:new Map},I=Ot.Pop,R=!1,N,M=!1,L=new Map,F=null,W=!1,z=!1,Y=[],K=[],re=new Map,H=0,ee=-1,oe=new Map,q=new Set,ie=new Map,ke=new Map,_e=new Set,me=new Map,nt=new Map,gt=!1;function ce(){if(u=t.history.listen(U=>{let{action:$,location:Z,delta:le}=U;if(gt){gt=!1;return}Va(nt.size===0||le!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let pe=Xe({currentLocation:k.location,nextLocation:Z,historyAction:$});if(pe&&le!=null){gt=!0,t.history.go(le*-1),Ye(pe,{state:"blocked",location:Z,proceed(){Ye(pe,{state:"proceeding",proceed:void 0,reset:void 0,location:Z}),t.history.go(le)},reset(){let Oe=new Map(k.blockers);Oe.set(pe,hu),Mt({blockers:Oe})}});return}return lr($,Z)}),n){HL(e,L);let U=()=>GL(e,L);e.addEventListener("pagehide",U),F=()=>e.removeEventListener("pagehide",U)}return k.initialized||lr(Ot.Pop,k.location,{initialHydration:!0}),T}function Qt(){u&&u(),F&&F(),d.clear(),N&&N.abort(),k.fetchers.forEach((U,$)=>_($)),k.blockers.forEach((U,$)=>Ie($))}function Qn(U){return d.add(U),()=>d.delete(U)}function Mt(U,$){$===void 0&&($={}),k=xt({},k,U);let Z=[],le=[];l.v7_fetcherPersist&&k.fetchers.forEach((pe,Oe)=>{pe.state==="idle"&&(_e.has(Oe)?le.push(Oe):Z.push(Oe))}),[...d].forEach(pe=>pe(k,{deletedFetchers:le,unstable_viewTransitionOpts:$.viewTransitionOpts,unstable_flushSync:$.flushSync===!0})),l.v7_fetcherPersist&&(Z.forEach(pe=>k.fetchers.delete(pe)),le.forEach(pe=>_(pe)))}function Zn(U,$,Z){var le,pe;let{flushSync:Oe}=Z===void 0?{}:Z,Ee=k.actionData!=null&&k.navigation.formMethod!=null&&si(k.navigation.formMethod)&&k.navigation.state==="loading"&&((le=U.state)==null?void 0:le._isRedirect)!==!0,be;$.actionData?Object.keys($.actionData).length>0?be=$.actionData:be=null:Ee?be=k.actionData:be=null;let ve=$.loaderData?UE(k.loaderData,$.loaderData,$.matches||[],$.errors):k.loaderData,Le=k.blockers;Le.size>0&&(Le=new Map(Le),Le.forEach((it,fn)=>Le.set(fn,hu)));let en=R===!0||k.navigation.formMethod!=null&&si(k.navigation.formMethod)&&((pe=U.state)==null?void 0:pe._isRedirect)!==!0;a&&(o=a,a=void 0),W||I===Ot.Pop||(I===Ot.Push?t.history.push(U,U.state):I===Ot.Replace&&t.history.replace(U,U.state));let xe;if(I===Ot.Pop){let it=L.get(k.location.pathname);it&&it.has(U.pathname)?xe={currentLocation:k.location,nextLocation:U}:L.has(U.pathname)&&(xe={currentLocation:U,nextLocation:k.location})}else if(M){let it=L.get(k.location.pathname);it?it.add(U.pathname):(it=new Set([U.pathname]),L.set(k.location.pathname,it)),xe={currentLocation:k.location,nextLocation:U}}Mt(xt({},$,{actionData:be,loaderData:ve,historyAction:I,location:U,initialized:!0,navigation:Og,revalidation:"idle",restoreScrollPosition:Sb(U,$.matches||k.matches),preventScrollReset:en,blockers:Le}),{viewTransitionOpts:xe,flushSync:Oe===!0}),I=Ot.Pop,R=!1,M=!1,W=!1,z=!1,Y=[],K=[]}async function dn(U,$){if(typeof U=="number"){t.history.go(U);return}let Z=uy(k.location,k.matches,c,l.v7_prependBasename,U,l.v7_relativeSplatPath,$==null?void 0:$.fromRouteId,$==null?void 0:$.relative),{path:le,submission:pe,error:Oe}=ME(l.v7_normalizeFormMethod,!1,Z,$),Ee=k.location,be=bd(k.location,le,$&&$.state);be=xt({},be,t.history.encodeLocation(be));let ve=$&&$.replace!=null?$.replace:void 0,Le=Ot.Push;ve===!0?Le=Ot.Replace:ve===!1||pe!=null&&si(pe.formMethod)&&pe.formAction===k.location.pathname+k.location.search&&(Le=Ot.Replace);let en=$&&"preventScrollReset"in $?$.preventScrollReset===!0:void 0,xe=($&&$.unstable_flushSync)===!0,it=Xe({currentLocation:Ee,nextLocation:be,historyAction:Le});if(it){Ye(it,{state:"blocked",location:be,proceed(){Ye(it,{state:"proceeding",proceed:void 0,reset:void 0,location:be}),dn(U,$)},reset(){let fn=new Map(k.blockers);fn.set(it,hu),Mt({blockers:fn})}});return}return await lr(Le,be,{submission:pe,pendingError:Oe,preventScrollReset:en,replace:$&&$.replace,enableViewTransition:$&&$.unstable_viewTransition,flushSync:xe})}function On(){if(An(),Mt({revalidation:"loading"}),k.navigation.state!=="submitting"){if(k.navigation.state==="idle"){lr(k.historyAction,k.location,{startUninterruptedRevalidation:!0});return}lr(I||k.historyAction,k.navigation.location,{overrideNavigation:k.navigation})}}async function lr(U,$,Z){N&&N.abort(),N=null,I=U,W=(Z&&Z.startUninterruptedRevalidation)===!0,wO(k.location,k.matches),R=(Z&&Z.preventScrollReset)===!0,M=(Z&&Z.enableViewTransition)===!0;let le=a||o,pe=Z&&Z.overrideNavigation,Oe=Fc(le,$,c),Ee=(Z&&Z.flushSync)===!0;if(!Oe){let fn=Nr(404,{pathname:$.pathname}),{matches:Pr,route:tn}=BE(le);rt(),Zn($,{matches:Pr,loaderData:{},errors:{[tn.id]:fn}},{flushSync:Ee});return}if(k.initialized&&!z&&BL(k.location,$)&&!(Z&&Z.submission&&si(Z.submission.formMethod))){Zn($,{matches:Oe},{flushSync:Ee});return}N=new AbortController;let be=mu(t.history,$,N.signal,Z&&Z.submission),ve,Le;if(Z&&Z.pendingError)Le={[qu(Oe).route.id]:Z.pendingError};else if(Z&&Z.submission&&si(Z.submission.formMethod)){let fn=await fc(be,$,Z.submission,Oe,{replace:Z.replace,flushSync:Ee});if(fn.shortCircuited)return;ve=fn.pendingActionData,Le=fn.pendingActionError,pe=Ag($,Z.submission),Ee=!1,be=new Request(be.url,{signal:be.signal})}let{shortCircuited:en,loaderData:xe,errors:it}=await _i(be,$,Oe,pe,Z&&Z.submission,Z&&Z.fetcherSubmission,Z&&Z.replace,Z&&Z.initialHydration===!0,Ee,ve,Le);en||(N=null,Zn($,xt({matches:Oe},ve?{actionData:ve}:{},{loaderData:xe,errors:it})))}async function fc(U,$,Z,le,pe){pe===void 0&&(pe={}),An();let Oe=zL($,Z);Mt({navigation:Oe},{flushSync:pe.flushSync===!0});let Ee,be=fy(le,$);if(!be.route.action&&!be.route.lazy)Ee={type:Rt.error,error:Nr(405,{method:U.method,pathname:$.pathname,routeId:be.route.id})};else if(Ee=await pu("action",U,be,le,s,i,c,l.v7_relativeSplatPath),U.signal.aborted)return{shortCircuited:!0};if(Ia(Ee)){let ve;return pe&&pe.replace!=null?ve=pe.replace:ve=Ee.location===k.location.pathname+k.location.search,await Fe(k,Ee,{submission:Z,replace:ve}),{shortCircuited:!0}}if(Uc(Ee)){let ve=qu(le,be.route.id);return(pe&&pe.replace)!==!0&&(I=Ot.Push),{pendingActionData:{},pendingActionError:{[ve.route.id]:Ee.error}}}if(Ca(Ee))throw Nr(400,{type:"defer-action"});return{pendingActionData:{[be.route.id]:Ee.data}}}async function _i(U,$,Z,le,pe,Oe,Ee,be,ve,Le,en){let xe=le||Ag($,pe),it=pe||Oe||VE(xe),fn=a||o,[Pr,tn]=OE(t.history,k,Z,it,$,l.v7_partialHydration&&be===!0,z,Y,K,_e,ie,q,fn,c,Le,en);if(rt(Qe=>!(Z&&Z.some(vt=>vt.route.id===Qe))||Pr&&Pr.some(vt=>vt.route.id===Qe)),ee=++H,Pr.length===0&&tn.length===0){let Qe=A();return Zn($,xt({matches:Z,loaderData:{},errors:en||null},Le?{actionData:Le}:{},Qe?{fetchers:new Map(k.fetchers)}:{}),{flushSync:ve}),{shortCircuited:!0}}if(!W&&(!l.v7_partialHydration||!be)){tn.forEach(vt=>{let Ci=k.fetchers.get(vt.key),wf=gu(void 0,Ci?Ci.data:void 0);k.fetchers.set(vt.key,wf)});let Qe=Le||k.actionData;Mt(xt({navigation:xe},Qe?Object.keys(Qe).length===0?{actionData:null}:{actionData:Qe}:{},tn.length>0?{fetchers:new Map(k.fetchers)}:{}),{flushSync:ve})}tn.forEach(Qe=>{re.has(Qe.key)&&S(Qe.key),Qe.controller&&re.set(Qe.key,Qe.controller)});let hc=()=>tn.forEach(Qe=>S(Qe.key));N&&N.signal.addEventListener("abort",hc);let{results:tg,loaderResults:pc,fetcherResults:po}=await We(k.matches,Z,Pr,tn,U);if(U.signal.aborted)return{shortCircuited:!0};N&&N.signal.removeEventListener("abort",hc),tn.forEach(Qe=>re.delete(Qe.key));let ya=jE(tg);if(ya){if(ya.idx>=Pr.length){let Qe=tn[ya.idx-Pr.length].key;q.add(Qe)}return await Fe(k,ya.result,{replace:Ee}),{shortCircuited:!0}}let{loaderData:ng,errors:rg}=FE(k,Z,Pr,pc,en,tn,po,me);me.forEach((Qe,vt)=>{Qe.subscribe(Ci=>{(Ci||Qe.done)&&me.delete(vt)})});let ig=A(),mc=j(ee),Sf=ig||mc||tn.length>0;return xt({loaderData:ng,errors:rg},Sf?{fetchers:new Map(k.fetchers)}:{})}function va(U,$,Z,le){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");re.has(U)&&S(U);let pe=(le&&le.unstable_flushSync)===!0,Oe=a||o,Ee=uy(k.location,k.matches,c,l.v7_prependBasename,Z,l.v7_relativeSplatPath,$,le==null?void 0:le.relative),be=Fc(Oe,Ee,c);if(!be){Zt(U,$,Nr(404,{pathname:Ee}),{flushSync:pe});return}let{path:ve,submission:Le,error:en}=ME(l.v7_normalizeFormMethod,!0,Ee,le);if(en){Zt(U,$,en,{flushSync:pe});return}let xe=fy(be,ve);if(R=(le&&le.preventScrollReset)===!0,Le&&si(Le.formMethod)){Ce(U,$,ve,xe,be,pe,Le);return}ie.set(U,{routeId:$,path:ve}),bn(U,$,ve,xe,be,pe,Le)}async function Ce(U,$,Z,le,pe,Oe,Ee){if(An(),ie.delete(U),!le.route.action&&!le.route.lazy){let vt=Nr(405,{method:Ee.formMethod,pathname:Z,routeId:$});Zt(U,$,vt,{flushSync:Oe});return}let be=k.fetchers.get(U);Ae(U,WL(Ee,be),{flushSync:Oe});let ve=new AbortController,Le=mu(t.history,Z,ve.signal,Ee);re.set(U,ve);let en=H,xe=await pu("action",Le,le,pe,s,i,c,l.v7_relativeSplatPath);if(Le.signal.aborted){re.get(U)===ve&&re.delete(U);return}if(l.v7_fetcherPersist&&_e.has(U)){if(Ia(xe)||Uc(xe)){Ae(U,So(void 0));return}}else{if(Ia(xe))if(re.delete(U),ee>en){Ae(U,So(void 0));return}else return q.add(U),Ae(U,gu(Ee)),Fe(k,xe,{fetcherSubmission:Ee});if(Uc(xe)){Zt(U,$,xe.error);return}}if(Ca(xe))throw Nr(400,{type:"defer-action"});let it=k.navigation.location||k.location,fn=mu(t.history,it,ve.signal),Pr=a||o,tn=k.navigation.state!=="idle"?Fc(Pr,k.navigation.location,c):k.matches;Ue(tn,"Didn't find any matches after fetcher action");let hc=++H;oe.set(U,hc);let tg=gu(Ee,xe.data);k.fetchers.set(U,tg);let[pc,po]=OE(t.history,k,tn,Ee,it,!1,z,Y,K,_e,ie,q,Pr,c,{[le.route.id]:xe.data},void 0);po.filter(vt=>vt.key!==U).forEach(vt=>{let Ci=vt.key,wf=k.fetchers.get(Ci),EO=gu(void 0,wf?wf.data:void 0);k.fetchers.set(Ci,EO),re.has(Ci)&&S(Ci),vt.controller&&re.set(Ci,vt.controller)}),Mt({fetchers:new Map(k.fetchers)});let ya=()=>po.forEach(vt=>S(vt.key));ve.signal.addEventListener("abort",ya);let{results:ng,loaderResults:rg,fetcherResults:ig}=await We(k.matches,tn,pc,po,fn);if(ve.signal.aborted)return;ve.signal.removeEventListener("abort",ya),oe.delete(U),re.delete(U),po.forEach(vt=>re.delete(vt.key));let mc=jE(ng);if(mc){if(mc.idx>=pc.length){let vt=po[mc.idx-pc.length].key;q.add(vt)}return Fe(k,mc.result)}let{loaderData:Sf,errors:Qe}=FE(k,k.matches,pc,rg,void 0,po,ig,me);if(k.fetchers.has(U)){let vt=So(xe.data);k.fetchers.set(U,vt)}j(hc),k.navigation.state==="loading"&&hc>ee?(Ue(I,"Expected pending action"),N&&N.abort(),Zn(k.navigation.location,{matches:tn,loaderData:Sf,errors:Qe,fetchers:new Map(k.fetchers)})):(Mt({errors:Qe,loaderData:UE(k.loaderData,Sf,tn,Qe),fetchers:new Map(k.fetchers)}),z=!1)}async function bn(U,$,Z,le,pe,Oe,Ee){let be=k.fetchers.get(U);Ae(U,gu(Ee,be?be.data:void 0),{flushSync:Oe});let ve=new AbortController,Le=mu(t.history,Z,ve.signal);re.set(U,ve);let en=H,xe=await pu("loader",Le,le,pe,s,i,c,l.v7_relativeSplatPath);if(Ca(xe)&&(xe=await dI(xe,Le.signal,!0)||xe),re.get(U)===ve&&re.delete(U),!Le.signal.aborted){if(_e.has(U)){Ae(U,So(void 0));return}if(Ia(xe))if(ee>en){Ae(U,So(void 0));return}else{q.add(U),await Fe(k,xe);return}if(Uc(xe)){Zt(U,$,xe.error);return}Ue(!Ca(xe),"Unhandled fetcher deferred data"),Ae(U,So(xe.data))}}async function Fe(U,$,Z){let{submission:le,fetcherSubmission:pe,replace:Oe}=Z===void 0?{}:Z;$.revalidate&&(z=!0);let Ee=bd(U.location,$.location,{_isRedirect:!0});if(Ue(Ee,"Expected a location on the redirect navigation"),n){let it=!1;if($.reloadDocument)it=!0;else if(aI.test($.location)){const fn=t.history.createURL($.location);it=fn.origin!==e.location.origin||Zd(fn.pathname,c)==null}if(it){Oe?e.location.replace($.location):e.location.assign($.location);return}}N=null;let be=Oe===!0?Ot.Replace:Ot.Push,{formMethod:ve,formAction:Le,formEncType:en}=U.navigation;!le&&!pe&&ve&&Le&&en&&(le=VE(U.navigation));let xe=le||pe;if(NL.has($.status)&&xe&&si(xe.formMethod))await lr(be,Ee,{submission:xt({},xe,{formAction:$.location}),preventScrollReset:R});else{let it=Ag(Ee,le);await lr(be,Ee,{overrideNavigation:it,fetcherSubmission:pe,preventScrollReset:R})}}async function We(U,$,Z,le,pe){let Oe=await Promise.all([...Z.map(ve=>pu("loader",pe,ve,$,s,i,c,l.v7_relativeSplatPath)),...le.map(ve=>ve.matches&&ve.match&&ve.controller?pu("loader",mu(t.history,ve.path,ve.controller.signal),ve.match,ve.matches,s,i,c,l.v7_relativeSplatPath):{type:Rt.error,error:Nr(404,{pathname:ve.path})})]),Ee=Oe.slice(0,Z.length),be=Oe.slice(Z.length);return await Promise.all([$E(U,Z,Ee,Ee.map(()=>pe.signal),!1,k.loaderData),$E(U,le.map(ve=>ve.match),be,le.map(ve=>ve.controller?ve.controller.signal:null),!0)]),{results:Oe,loaderResults:Ee,fetcherResults:be}}function An(){z=!0,Y.push(...rt()),ie.forEach((U,$)=>{re.has($)&&(K.push($),S($))})}function Ae(U,$,Z){Z===void 0&&(Z={}),k.fetchers.set(U,$),Mt({fetchers:new Map(k.fetchers)},{flushSync:(Z&&Z.flushSync)===!0})}function Zt(U,$,Z,le){le===void 0&&(le={});let pe=qu(k.matches,$);_(U),Mt({errors:{[pe.route.id]:Z},fetchers:new Map(k.fetchers)},{flushSync:(le&&le.flushSync)===!0})}function yf(U){return l.v7_fetcherPersist&&(ke.set(U,(ke.get(U)||0)+1),_e.has(U)&&_e.delete(U)),k.fetchers.get(U)||ML}function _(U){let $=k.fetchers.get(U);re.has(U)&&!($&&$.state==="loading"&&oe.has(U))&&S(U),ie.delete(U),oe.delete(U),q.delete(U),_e.delete(U),k.fetchers.delete(U)}function y(U){if(l.v7_fetcherPersist){let $=(ke.get(U)||0)-1;$<=0?(ke.delete(U),_e.add(U)):ke.set(U,$)}else _(U);Mt({fetchers:new Map(k.fetchers)})}function S(U){let $=re.get(U);Ue($,"Expected fetch controller: "+U),$.abort(),re.delete(U)}function x(U){for(let $ of U){let Z=yf($),le=So(Z.data);k.fetchers.set($,le)}}function A(){let U=[],$=!1;for(let Z of q){let le=k.fetchers.get(Z);Ue(le,"Expected fetcher: "+Z),le.state==="loading"&&(q.delete(Z),U.push(Z),$=!0)}return x(U),$}function j(U){let $=[];for(let[Z,le]of oe)if(le<U){let pe=k.fetchers.get(Z);Ue(pe,"Expected fetcher: "+Z),pe.state==="loading"&&(S(Z),oe.delete(Z),$.push(Z))}return x($),$.length>0}function Q(U,$){let Z=k.blockers.get(U)||hu;return nt.get(U)!==$&&nt.set(U,$),Z}function Ie(U){k.blockers.delete(U),nt.delete(U)}function Ye(U,$){let Z=k.blockers.get(U)||hu;Ue(Z.state==="unblocked"&&$.state==="blocked"||Z.state==="blocked"&&$.state==="blocked"||Z.state==="blocked"&&$.state==="proceeding"||Z.state==="blocked"&&$.state==="unblocked"||Z.state==="proceeding"&&$.state==="unblocked","Invalid blocker state transition: "+Z.state+" -> "+$.state);let le=new Map(k.blockers);le.set(U,$),Mt({blockers:le})}function Xe(U){let{currentLocation:$,nextLocation:Z,historyAction:le}=U;if(nt.size===0)return;nt.size>1&&Va(!1,"A router only supports one blocker at a time");let pe=Array.from(nt.entries()),[Oe,Ee]=pe[pe.length-1],be=k.blockers.get(Oe);if(!(be&&be.state==="proceeding")&&Ee({currentLocation:$,nextLocation:Z,historyAction:le}))return Oe}function rt(U){let $=[];return me.forEach((Z,le)=>{(!U||U(le))&&(Z.cancel(),$.push(le),me.delete(le))}),$}function He(U,$,Z){if(f=U,p=$,h=Z||null,!m&&k.navigation===Og){m=!0;let le=Sb(k.location,k.matches);le!=null&&Mt({restoreScrollPosition:le})}return()=>{f=null,p=null,h=null}}function yb(U,$){return h&&h(U,$.map(le=>sL(le,k.loaderData)))||U.key}function wO(U,$){if(f&&p){let Z=yb(U,$);f[Z]=p()}}function Sb(U,$){if(f){let Z=yb(U,$),le=f[Z];if(typeof le=="number")return le}return null}function bO(U){s={},a=ly(U,i,void 0,s)}return T={get basename(){return c},get future(){return l},get state(){return k},get routes(){return o},get window(){return e},initialize:ce,subscribe:Qn,enableScrollRestoration:He,navigate:dn,fetch:va,revalidate:On,createHref:U=>t.history.createHref(U),encodeLocation:U=>t.history.encodeLocation(U),getFetcher:yf,deleteFetcher:y,dispose:Qt,getBlocker:Q,deleteBlocker:Ie,_internalFetchControllers:re,_internalActiveDeferreds:me,_internalSetRoutes:bO},T}function DL(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function uy(t,e,n,r,i,s,o,a){let c,l;if(o){c=[];for(let d of e)if(c.push(d),d.route.id===o){l=d;break}}else c=e,l=e[e.length-1];let u=kL(i||".",EL(c,s),Zd(t.pathname,n)||t.pathname,a==="path");return i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&l&&l.route.index&&!VS(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:Aa([n,u.pathname])),Qd(u)}function ME(t,e,n,r){if(!r||!DL(r))return{path:n};if(r.formMethod&&!VL(r.formMethod))return{path:n,error:Nr(405,{method:r.formMethod})};let i=()=>({path:n,error:Nr(400,{type:"invalid-body"})}),s=r.formMethod||"get",o=t?s.toUpperCase():s.toLowerCase(),a=uI(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!si(o))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[m,w]=p;return""+h+m+"="+w+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!si(o))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}Ue(typeof FormData=="function","FormData is not available in this environment");let c,l;if(r.formData)c=dy(r.formData),l=r.formData;else if(r.body instanceof FormData)c=dy(r.body),l=r.body;else if(r.body instanceof URLSearchParams)c=r.body,l=LE(c);else if(r.body==null)c=new URLSearchParams,l=new FormData;else try{c=new URLSearchParams(r.body),l=LE(c)}catch{return i()}let u={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(si(u.formMethod))return{path:n,submission:u};let d=oo(n);return e&&d.search&&VS(d.search)&&c.append("index",""),d.search="?"+c,{path:Qd(d),submission:u}}function LL(t,e){let n=t;if(e){let r=t.findIndex(i=>i.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function OE(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,m){let w=m?Object.values(m)[0]:p?Object.values(p)[0]:void 0,g=t.createURL(e.location),v=t.createURL(i),b=m?Object.keys(m)[0]:void 0,T=LL(n,b).filter((I,R)=>{let{route:N}=I;if(N.lazy)return!0;if(N.loader==null)return!1;if(s)return N.loader.hydrate?!0:e.loaderData[N.id]===void 0&&(!e.errors||e.errors[N.id]===void 0);if(FL(e.loaderData,e.matches[R],I)||a.some(F=>F===I.route.id))return!0;let M=e.matches[R],L=I;return AE(I,xt({currentUrl:g,currentParams:M.params,nextUrl:v,nextParams:L.params},r,{actionResult:w,defaultShouldRevalidate:o||g.pathname+g.search===v.pathname+v.search||g.search!==v.search||lI(M,L)}))}),k=[];return u.forEach((I,R)=>{if(s||!n.some(W=>W.route.id===I.routeId)||l.has(R))return;let N=Fc(f,I.path,h);if(!N){k.push({key:R,routeId:I.routeId,path:I.path,matches:null,match:null,controller:null});return}let M=e.fetchers.get(R),L=fy(N,I.path),F=!1;d.has(R)?F=!1:c.includes(R)?F=!0:M&&M.state!=="idle"&&M.data===void 0?F=o:F=AE(L,xt({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:w,defaultShouldRevalidate:o})),F&&k.push({key:R,routeId:I.routeId,path:I.path,matches:N,match:L,controller:new AbortController})}),[T,k]}function FL(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function lI(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function AE(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function DE(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];Ue(i,"No route found in manifest");let s={};for(let o in r){let c=i[o]!==void 0&&o!=="hasErrorBoundary";Va(!c,'Route "'+i.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!rL.has(o)&&(s[o]=r[o])}Object.assign(i,s),Object.assign(i,xt({},e(i),{lazy:void 0}))}async function pu(t,e,n,r,i,s,o,a,c){c===void 0&&(c={});let l,u,d,f=m=>{let w,g=new Promise((v,b)=>w=b);return d=()=>w(),e.signal.addEventListener("abort",d),Promise.race([m({request:e,params:n.params,context:c.requestContext}),g])};try{let m=n.route[t];if(n.route.lazy)if(m){let w,g=await Promise.all([f(m).catch(v=>{w=v}),DE(n.route,s,i)]);if(w)throw w;u=g[0]}else if(await DE(n.route,s,i),m=n.route[t],m)u=await f(m);else if(t==="action"){let w=new URL(e.url),g=w.pathname+w.search;throw Nr(405,{method:e.method,pathname:g,routeId:n.route.id})}else return{type:Rt.data,data:void 0};else if(m)u=await f(m);else{let w=new URL(e.url),g=w.pathname+w.search;throw Nr(404,{pathname:g})}Ue(u!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){l=Rt.error,u=m}finally{d&&e.signal.removeEventListener("abort",d)}if($L(u)){let m=u.status;if(xL.has(m)){let g=u.headers.get("Location");if(Ue(g,"Redirects returned/thrown from loaders/actions must have a Location header"),!aI.test(g))g=uy(new URL(e.url),r.slice(0,r.indexOf(n)+1),o,!0,g,a);else if(!c.isStaticRequest){let v=new URL(e.url),b=g.startsWith("//")?new URL(v.protocol+g):new URL(g),C=Zd(b.pathname,o)!=null;b.origin===v.origin&&C&&(g=b.pathname+b.search+b.hash)}if(c.isStaticRequest)throw u.headers.set("Location",g),u;return{type:Rt.redirect,status:m,location:g,revalidate:u.headers.get("X-Remix-Revalidate")!==null,reloadDocument:u.headers.get("X-Remix-Reload-Document")!==null}}if(c.isRouteRequest)throw{type:l===Rt.error?Rt.error:Rt.data,response:u};let w;try{let g=u.headers.get("Content-Type");g&&/\bapplication\/json\b/.test(g)?w=await u.json():w=await u.text()}catch(g){return{type:Rt.error,error:g}}return l===Rt.error?{type:l,error:new $S(m,u.statusText,w),headers:u.headers}:{type:Rt.data,data:w,statusCode:u.status,headers:u.headers}}if(l===Rt.error)return{type:l,error:u};if(jL(u)){var h,p;return{type:Rt.deferred,deferredData:u,statusCode:(h=u.init)==null?void 0:h.status,headers:((p=u.init)==null?void 0:p.headers)&&new Headers(u.init.headers)}}return{type:Rt.data,data:u}}function mu(t,e,n,r){let i=t.createURL(uI(e)).toString(),s={signal:n};if(r&&si(r.formMethod)){let{formMethod:o,formEncType:a}=r;s.method=o.toUpperCase(),a==="application/json"?(s.headers=new Headers({"Content-Type":a}),s.body=JSON.stringify(r.json)):a==="text/plain"?s.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?s.body=dy(r.formData):s.body=r.formData}return new Request(i,s)}function dy(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function LE(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function UL(t,e,n,r,i){let s={},o=null,a,c=!1,l={};return n.forEach((u,d)=>{let f=e[d].route.id;if(Ue(!Ia(u),"Cannot handle redirect results in processLoaderData"),Uc(u)){let h=qu(t,f),p=u.error;r&&(p=Object.values(r)[0],r=void 0),o=o||{},o[h.route.id]==null&&(o[h.route.id]=p),s[f]=void 0,c||(c=!0,a=sI(u.error)?u.error.status:500),u.headers&&(l[f]=u.headers)}else Ca(u)?(i.set(f,u.deferredData),s[f]=u.deferredData.data):s[f]=u.data,u.statusCode!=null&&u.statusCode!==200&&!c&&(a=u.statusCode),u.headers&&(l[f]=u.headers)}),r&&(o=r,s[Object.keys(r)[0]]=void 0),{loaderData:s,errors:o,statusCode:a||200,loaderHeaders:l}}function FE(t,e,n,r,i,s,o,a){let{loaderData:c,errors:l}=UL(e,n,r,i,a);for(let u=0;u<s.length;u++){let{key:d,match:f,controller:h}=s[u];Ue(o!==void 0&&o[u]!==void 0,"Did not find corresponding fetcher result");let p=o[u];if(!(h&&h.signal.aborted))if(Uc(p)){let m=qu(t.matches,f==null?void 0:f.route.id);l&&l[m.route.id]||(l=xt({},l,{[m.route.id]:p.error})),t.fetchers.delete(d)}else if(Ia(p))Ue(!1,"Unhandled fetcher revalidation redirect");else if(Ca(p))Ue(!1,"Unhandled fetcher deferred data");else{let m=So(p.data);t.fetchers.set(d,m)}}return{loaderData:c,errors:l}}function UE(t,e,n,r){let i=xt({},e);for(let s of n){let o=s.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(i[o]=e[o]):t[o]!==void 0&&s.route.loader&&(i[o]=t[o]),r&&r.hasOwnProperty(o))break}return i}function qu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function BE(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Nr(t,e){let{pathname:n,routeId:r,method:i,type:s}=e===void 0?{}:e,o="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(o="Bad Request",i&&n&&r?a="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":s==="defer-action"?a="defer() is not supported in actions":s==="invalid-body"&&(a="Unable to encode submission body")):t===403?(o="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(o="Not Found",a='No route matches URL "'+n+'"'):t===405&&(o="Method Not Allowed",i&&n&&r?a="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(a='Invalid request method "'+i.toUpperCase()+'"')),new $S(t||500,o,new Error(a),!0)}function jE(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Ia(n))return{result:n,idx:e}}}function uI(t){let e=typeof t=="string"?oo(t):t;return Qd(xt({},e,{hash:""}))}function BL(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function Ca(t){return t.type===Rt.deferred}function Uc(t){return t.type===Rt.error}function Ia(t){return(t&&t.type)===Rt.redirect}function jL(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function $L(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function VL(t){return PL.has(t.toLowerCase())}function si(t){return IL.has(t.toLowerCase())}async function $E(t,e,n,r,i,s){for(let o=0;o<n.length;o++){let a=n[o],c=e[o];if(!c)continue;let l=t.find(d=>d.route.id===c.route.id),u=l!=null&&!lI(l,c)&&(s&&s[c.route.id])!==void 0;if(Ca(a)&&(i||u)){let d=r[o];Ue(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await dI(a,d,i).then(f=>{f&&(n[o]=f||n[o])})}}}async function dI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Rt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:Rt.error,error:i}}return{type:Rt.data,data:t.deferredData.data}}}function VS(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function fy(t,e){let n=typeof e=="string"?oo(e).search:e.search;if(t[t.length-1].route.index&&VS(n||""))return t[t.length-1];let r=iI(t);return r[r.length-1]}function VE(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:s,json:o}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:s,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function Ag(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function zL(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function gu(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function WL(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function So(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function HL(t,e){try{let n=t.sessionStorage.getItem(cI);if(n){let r=JSON.parse(n);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function GL(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(cI,JSON.stringify(n))}catch(r){Va(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ip(){return ip=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ip.apply(this,arguments)}const fI=E.createContext(null),hI=E.createContext(null),pI=E.createContext(null),im=E.createContext(null),sm=E.createContext({outlet:null,matches:[],isDataRoute:!1}),mI=E.createContext(null);function zS(){return E.useContext(im)!=null}function gI(){return zS()||Ue(!1),E.useContext(im).location}function qL(t,e,n,r){zS()||Ue(!1);let{navigator:i}=E.useContext(pI),{matches:s}=E.useContext(sm),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let l=gI(),u;if(e){var d;let w=typeof e=="string"?oo(e):e;c==="/"||(d=w.pathname)!=null&&d.startsWith(c)||Ue(!1),u=w}else u=l;let f=u.pathname||"/",h=c==="/"?f:f.slice(c.length)||"/",p=Fc(t,{pathname:h}),m=QL(p&&p.map(w=>Object.assign({},w,{params:Object.assign({},a,w.params),pathname:Aa([c,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Aa([c,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,n,r);return e&&m?E.createElement(im.Provider,{value:{location:ip({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ot.Pop}},m):m}function JL(){let t=n5(),e=sI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),n?E.createElement("pre",{style:i},n):null,s)}const KL=E.createElement(JL,null);class YL extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?E.createElement(sm.Provider,{value:this.props.routeContext},E.createElement(mI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function XL(t){let{routeContext:e,match:n,children:r}=t,i=E.useContext(fI);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),E.createElement(sm.Provider,{value:e},r)}function QL(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id]));u>=0||Ue(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){c=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((u,d,f)=>{let h,p=!1,m=null,w=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||KL,c&&(l<0&&f===0?(r5("route-fallback",!1),p=!0,w=null):l===f&&(p=!0,w=d.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),v=()=>{let b;return h?b=m:p?b=w:d.route.Component?b=E.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=u,E.createElement(XL,{match:d,routeContext:{outlet:u,matches:g,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?E.createElement(YL,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}var hy=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(hy||{});function ZL(t){let e=E.useContext(hI);return e||Ue(!1),e}function e5(t){let e=E.useContext(sm);return e||Ue(!1),e}function t5(t){let e=e5(),n=e.matches[e.matches.length-1];return n.route.id||Ue(!1),n.route.id}function n5(){var t;let e=E.useContext(mI),n=ZL(hy.UseRouteError),r=t5(hy.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const zE={};function r5(t,e,n){!e&&!zE[t]&&(zE[t]=!0)}function i5(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Ot.Pop,navigator:s,static:o=!1,future:a}=t;zS()&&Ue(!1);let c=e.replace(/^\/*/,"/"),l=E.useMemo(()=>({basename:c,navigator:s,static:o,future:ip({v7_relativeSplatPath:!1},a)}),[c,a,s,o]);typeof r=="string"&&(r=oo(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=E.useMemo(()=>{let w=Zd(u,c);return w==null?null:{location:{pathname:w,search:d,hash:f,state:h,key:p},navigationType:i}},[c,u,d,f,h,p,i]);return m==null?null:E.createElement(pI.Provider,{value:l},E.createElement(im.Provider,{children:n,value:m}))}new Promise(()=>{});function s5(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:E.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:E.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:E.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sp(){return sp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sp.apply(this,arguments)}function o5(t,e){return AL({basename:e==null?void 0:e.basename,future:sp({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:eL({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||a5(),routes:t,mapRouteProperties:s5,window:e==null?void 0:e.window}).initialize()}function a5(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=sp({},e,{errors:c5(e.errors)})),e}function c5(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new $S(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let o=new s(i.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let s=new Error(i.message);s.stack="",n[r]=s}}else n[r]=i;return n}const l5=E.createContext({isTransitioning:!1}),u5=E.createContext(new Map),d5="startTransition",WE=VO[d5],f5="flushSync",HE=ZD[f5];function h5(t){WE?WE(t):t()}function vu(t){HE?HE(t):t()}class p5{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function m5(t){let{fallbackElement:e,router:n,future:r}=t,[i,s]=E.useState(n.state),[o,a]=E.useState(),[c,l]=E.useState({isTransitioning:!1}),[u,d]=E.useState(),[f,h]=E.useState(),[p,m]=E.useState(),w=E.useRef(new Map),{v7_startTransition:g}=r||{},v=E.useCallback(I=>{g?h5(I):I()},[g]),b=E.useCallback((I,R)=>{let{deletedFetchers:N,unstable_flushSync:M,unstable_viewTransitionOpts:L}=R;N.forEach(W=>w.current.delete(W)),I.fetchers.forEach((W,z)=>{W.data!==void 0&&w.current.set(z,W.data)});let F=n.window==null||typeof n.window.document.startViewTransition!="function";if(!L||F){M?vu(()=>s(I)):v(()=>s(I));return}if(M){vu(()=>{f&&(u&&u.resolve(),f.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:L.currentLocation,nextLocation:L.nextLocation})});let W=n.window.document.startViewTransition(()=>{vu(()=>s(I))});W.finished.finally(()=>{vu(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})})}),vu(()=>h(W));return}f?(u&&u.resolve(),f.skipTransition(),m({state:I,currentLocation:L.currentLocation,nextLocation:L.nextLocation})):(a(I),l({isTransitioning:!0,flushSync:!1,currentLocation:L.currentLocation,nextLocation:L.nextLocation}))},[n.window,f,u,w,v]);E.useLayoutEffect(()=>n.subscribe(b),[n,b]),E.useEffect(()=>{c.isTransitioning&&!c.flushSync&&d(new p5)},[c]),E.useEffect(()=>{if(u&&o&&n.window){let I=o,R=u.promise,N=n.window.document.startViewTransition(async()=>{v(()=>s(I)),await R});N.finished.finally(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})}),h(N)}},[v,o,u,n.window]),E.useEffect(()=>{u&&o&&i.location.key===o.location.key&&u.resolve()},[u,f,i.location,o]),E.useEffect(()=>{!c.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[c.isTransitioning,p]),E.useEffect(()=>{},[]);let C=E.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:I=>n.navigate(I),push:(I,R,N)=>n.navigate(I,{state:R,preventScrollReset:N==null?void 0:N.preventScrollReset}),replace:(I,R,N)=>n.navigate(I,{replace:!0,state:R,preventScrollReset:N==null?void 0:N.preventScrollReset})}),[n]),T=n.basename||"/",k=E.useMemo(()=>({router:n,navigator:C,static:!1,basename:T}),[n,C,T]);return E.createElement(E.Fragment,null,E.createElement(fI.Provider,{value:k},E.createElement(hI.Provider,{value:i},E.createElement(u5.Provider,{value:w.current},E.createElement(l5.Provider,{value:c},E.createElement(i5,{basename:T,location:i.location,navigationType:i.historyAction,navigator:C,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},i.initialized||n.future.v7_partialHydration?E.createElement(g5,{routes:n.routes,future:n.future,state:i}):e))))),null)}function g5(t){let{routes:e,future:n,state:r}=t;return qL(e,void 0,r,n)}var GE;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(GE||(GE={}));var qE;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(qE||(qE={}));const vI=t=>{const e=typeof t=="function",n=E.useRef(t);E.useEffect(()=>{n.current=t}),E.useEffect(()=>{if(e){const r=i=>{const s=n.current(i);if(typeof s=="string")return i.preventDefault(),i.returnValue=s;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var JE=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function v5(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var go=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],y5=function(){JE(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){v5(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return JE(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(go[n][r].color);for(var i=[0,95,135,175,215,255],s=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},o=0;o<6;++o)for(var a=0;a<6;++a)for(var c=0;c<6;++c)this.PALETTE_COLORS.push(s(o,a,c));for(var l=8,u=0;u<24;++u,l+=10)this.PALETTE_COLORS.push(s(l,l,l))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(/(https?:\/\/[^\s]+)/gm,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var s=this,o=this,a=n.split(/\033\[/),c=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var l=a.map(function(d){return s.processChunk(d,r,i)});if(r&&r.json){var u=o.processChunkJson("");return u.content=c,u.clearLine=r.clearLine,l.unshift(u),r.remove_empty&&(l=l.filter(function(d){return!d.isEmpty()})),l}else l.unshift(c);return l.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var s=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,o=r.key=s?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},c=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!c)return a;a.content=c[4];var l=c[2].split(";");if(c[1]!==""||c[3]!=="m"||!i)return a;for(var u=this;l.length>0;){var d=l.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=go[0][f%10][o];else if(f>=90&&f<98)u.fg=go[1][f%10][o];else if(f>=40&&f<48)u.bg=go[0][f%10][o];else if(f>=100&&f<108)u.bg=go[1][f%10][o];else if(f===38||f===48){var h=f===38;if(l.length>=1){var p=l.shift();if(p==="5"&&l.length>=1){var m=parseInt(l.shift());if(m>=0&&m<=255)if(!s)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[m]:u.bg=this.PALETTE_COLORS[m];else{var w=m>=16?"ansi-palette-"+m:go[m>7?1:0][m%8].class;h?u.fg=w:u.bg=w}}else if(p==="2"&&l.length>=3){var g=parseInt(l.shift()),v=parseInt(l.shift()),b=parseInt(l.shift());if(g>=0&&g<=255&&v>=0&&v<=255&&b>=0&&b<=255){var C=g+", "+v+", "+b;s?h?(u.fg="ansi-truecolor",u.fg_truecolor=C):(u.bg="ansi-truecolor",u.bg_truecolor=C):h?u.fg=C:u.bg=C}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var s=this;r=r||{};var o=this.processChunkJson(n,r,i),a=r.use_classes;if(o.decorations=o.decorations.filter(function(h){if(h==="reverse"){o.fg||(o.fg=go[0][7][a?"class":"color"]),o.bg||(o.bg=go[0][0][a?"class":"color"]);var p=o.fg;o.fg=o.bg,o.bg=p;var m=o.fg_truecolor;return o.fg_truecolor=o.bg_truecolor,o.bg_truecolor=m,o.isInverted=!0,!1}return!0}),r.json)return o;if(o.isEmpty())return"";if(!o.was_processed)return o.content;var c=[],l=[],u=[],d={},f=function(p){var m=[],w=void 0;for(w in p)p.hasOwnProperty(w)&&m.push("data-"+w+'="'+s.escapeForHtml(p[w])+'"');return m.length>0?" "+m.join(" "):""};return o.isInverted&&(d["ansi-is-inverted"]="true"),o.fg&&(a?(c.push(o.fg+"-fg"),o.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=o.fg_truecolor,o.fg_truecolor=null)):c.push("color:rgb("+o.fg+")")),o.bg&&(a?(c.push(o.bg+"-bg"),o.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=o.bg_truecolor,o.bg_truecolor=null)):c.push("background-color:rgb("+o.bg+")")),o.decorations.forEach(function(h){if(a){l.push("ansi-"+h);return}h==="bold"?l.push("font-weight:bold"):h==="dim"?l.push("opacity:0.5"):h==="italic"?l.push("font-style:italic"):h==="hidden"?l.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&l.push("text-decoration:"+u.join(" ")),a?'<span class="'+c.concat(l).join(" ")+'"'+f(d)+">"+o.content+"</span>":'<span style="'+c.concat(l).join(";")+'"'+f(d)+">"+o.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),S5=y5;const w5=Gd(S5);function b5(t,e){let n=[];for(const r of t.split(`\r
`)){const i=w5.ansiToJson(r,{json:!0,remove_empty:!1});let s=[];for(const o of i){const a=_5(o,e);s=[...s,...a]}n=[...n,X.jsx("span",{children:s},n.length)]}return n}const E5=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,k5=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,T5=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function _5(t,e){const n=C5(t),r=[];let i=0;function s(l,u){let d;for(;(d=l.exec(t.content))!==null;){const f=d.index;f>i&&r.push(t.content.substring(i,f)),r.push(u(d)),i=l.lastIndex}}function o(l){const[,u,d]=l,f=d;return X.jsxs(X.Fragment,{children:[u,X.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d})]})}function a(l){const u=l.groups.name,d=`mailto:${u}`;return X.jsxs(X.Fragment,{children:[l.groups.slorp1,X.jsx("a",{href:d,target:"_blank",rel:"noreferrer",children:u}),l.groups.slorp2]})}function c(l){const[,u,d]=l;return X.jsx("a",{onClick:()=>e(u),className:"exit",children:d})}return s(E5,o),s(k5,a),s(T5,c),i<t.content.length&&r.push(t.content.substring(i)),r.map(l=>X.jsx("span",{style:n,children:l}))}function C5(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}class I5 extends pt.Component{constructor(n){super(n);V(this,"outputRef",pt.createRef());V(this,"state",{output:[],sidebarVisible:!1});V(this,"addCommand",n=>{this.addToOutput([X.jsx("span",{className:"command","aria-live":"off",children:n})])});V(this,"addError",n=>this.addToOutput([X.jsxs("h2",{children:[" Error: ",n.message]})]));V(this,"handleConnected",()=>this.addToOutput([X.jsx("h2",{children:" Connected"})]));V(this,"handleDisconnected",()=>{this.addToOutput([X.jsx("h2",{children:" Disconnected"})]),this.state.sidebarVisible=!1});V(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));V(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});V(this,"handleMessage",n=>{const r=b5(n,this.handleExitClick);this.addToOutput(r)});V(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.props.client.on("message",this.handleMessage),this.props.client.on("connect",this.handleConnected),this.props.client.on("disconnect",this.handleDisconnected),this.props.client.on("error",this.addError),this.props.client.on("command",this.addCommand),this.props.client.on("userlist",this.handleUserList)}componentDidUpdate(){this.scrollToBottom()}componentWillUnmount(){this.props.client.removeListener("message",this.handleMessage)}addToOutput(n){this.setState(r=>{const i=r.output.length,s=n.map((o,a)=>X.jsx("div",{children:o},i+a));return{output:[...r.output,...s]}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),s=URL.createObjectURL(i),o=document.createElement("a"),a=new Date,c=a.toLocaleDateString(),l=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${c}-${l}.html`;o.download=d,o.href=s,o.click(),URL.revokeObjectURL(s),o.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";return this.state.sidebarVisible&&(n+=" sidebar-visible"),X.jsx("div",{ref:this.outputRef,className:n,"aria-live":"polite",role:"log",children:this.state.output})}}var yI={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function s(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||c,f),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,f,h,p){var m=n?n+l:l;if(!this._events[m])return!1;var w=this._events[m],g=arguments.length,v,b;if(w.fn){switch(w.once&&this.removeListener(l,w.fn,void 0,!0),g){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,u),!0;case 3:return w.fn.call(w.context,u,d),!0;case 4:return w.fn.call(w.context,u,d,f),!0;case 5:return w.fn.call(w.context,u,d,f,h),!0;case 6:return w.fn.call(w.context,u,d,f,h,p),!0}for(b=1,v=new Array(g-1);b<g;b++)v[b-1]=arguments[b];w.fn.apply(w.context,v)}else{var C=w.length,T;for(b=0;b<C;b++)switch(w[b].once&&this.removeListener(l,w[b].fn,void 0,!0),g){case 1:w[b].fn.call(w[b].context);break;case 2:w[b].fn.call(w[b].context,u);break;case 3:w[b].fn.call(w[b].context,u,d);break;case 4:w[b].fn.call(w[b].context,u,d,f);break;default:if(!v)for(T=1,v=new Array(g-1);T<g;T++)v[T-1]=arguments[T];w[b].fn.apply(w[b].context,v)}}return!0},a.prototype.on=function(l,u,d){return s(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return s(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,f){var h=n?n+l:l;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var m=0,w=[],g=p.length;m<g;m++)(p[m].fn!==u||f&&!p[m].once||d&&p[m].context!==d)&&w.push(p[m]);w.length?this._events[h]=w.length===1?w[0]:w:o(this,h)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(yI);var R5=yI.exports;const SI=Gd(R5);var hn={},om={};om.byteLength=N5;om.toByteArray=O5;om.fromByteArray=L5;var Li=[],xr=[],P5=typeof Uint8Array<"u"?Uint8Array:Array,Dg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var vc=0,x5=Dg.length;vc<x5;++vc)Li[vc]=Dg[vc],xr[Dg.charCodeAt(vc)]=vc;xr[45]=62;xr[95]=63;function wI(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function N5(t){var e=wI(t),n=e[0],r=e[1];return(n+r)*3/4-r}function M5(t,e,n){return(e+n)*3/4-n}function O5(t){var e,n=wI(t),r=n[0],i=n[1],s=new P5(M5(t,r,i)),o=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=xr[t.charCodeAt(c)]<<18|xr[t.charCodeAt(c+1)]<<12|xr[t.charCodeAt(c+2)]<<6|xr[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=xr[t.charCodeAt(c)]<<2|xr[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=xr[t.charCodeAt(c)]<<10|xr[t.charCodeAt(c+1)]<<4|xr[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function A5(t){return Li[t>>18&63]+Li[t>>12&63]+Li[t>>6&63]+Li[t&63]}function D5(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(A5(r));return i.join("")}function L5(t){for(var e,n=t.length,r=n%3,i=[],s=16383,o=0,a=n-r;o<a;o+=s)i.push(D5(t,o,o+s>a?a:o+s));return r===1?(e=t[n-1],i.push(Li[e>>2]+Li[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(Li[e>>10]+Li[e>>4&63]+Li[e<<2&63]+"=")),i.join("")}var WS={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */WS.read=function(t,e,n,r,i){var s,o,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,s=h&(1<<-u)-1,h>>=-u,u+=a;u>0;s=s*256+t[e+d],d+=f,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=o*256+t[e+d],d+=f,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(h?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-l}return(h?-1:1)*o*Math.pow(2,s-r)};WS.write=function(t,e,n,r,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:s-1,p=r?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=f/c:e+=f*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,i),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;t[n+h]=o&255,h+=p,o/=256,l-=8);t[n+h-p]|=m*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=om,n=WS,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const _=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(_,y),_.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(_){if(_>i)throw new RangeError('The value "'+_+'" is invalid for option "size"');const y=new Uint8Array(_);return Object.setPrototypeOf(y,a.prototype),y}function a(_,y,S){if(typeof _=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(_)}return c(_,y,S)}a.poolSize=8192;function c(_,y,S){if(typeof _=="string")return f(_,y);if(ArrayBuffer.isView(_))return p(_);if(_==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(We(_,ArrayBuffer)||_&&We(_.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(We(_,SharedArrayBuffer)||_&&We(_.buffer,SharedArrayBuffer)))return m(_,y,S);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const x=_.valueOf&&_.valueOf();if(x!=null&&x!==_)return a.from(x,y,S);const A=w(_);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return a.from(_[Symbol.toPrimitive]("string"),y,S);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}a.from=function(_,y,S){return c(_,y,S)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(_<0)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function u(_,y,S){return l(_),_<=0?o(_):y!==void 0?typeof S=="string"?o(_).fill(y,S):o(_).fill(y):o(_)}a.alloc=function(_,y,S){return u(_,y,S)};function d(_){return l(_),o(_<0?0:g(_)|0)}a.allocUnsafe=function(_){return d(_)},a.allocUnsafeSlow=function(_){return d(_)};function f(_,y){if((typeof y!="string"||y==="")&&(y="utf8"),!a.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const S=b(_,y)|0;let x=o(S);const A=x.write(_,y);return A!==S&&(x=x.slice(0,A)),x}function h(_){const y=_.length<0?0:g(_.length)|0,S=o(y);for(let x=0;x<y;x+=1)S[x]=_[x]&255;return S}function p(_){if(We(_,Uint8Array)){const y=new Uint8Array(_);return m(y.buffer,y.byteOffset,y.byteLength)}return h(_)}function m(_,y,S){if(y<0||_.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<y+(S||0))throw new RangeError('"length" is outside of buffer bounds');let x;return y===void 0&&S===void 0?x=new Uint8Array(_):S===void 0?x=new Uint8Array(_,y):x=new Uint8Array(_,y,S),Object.setPrototypeOf(x,a.prototype),x}function w(_){if(a.isBuffer(_)){const y=g(_.length)|0,S=o(y);return S.length===0||_.copy(S,0,0,y),S}if(_.length!==void 0)return typeof _.length!="number"||An(_.length)?o(0):h(_);if(_.type==="Buffer"&&Array.isArray(_.data))return h(_.data)}function g(_){if(_>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return _|0}function v(_){return+_!=_&&(_=0),a.alloc(+_)}a.isBuffer=function(y){return y!=null&&y._isBuffer===!0&&y!==a.prototype},a.compare=function(y,S){if(We(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),We(S,Uint8Array)&&(S=a.from(S,S.offset,S.byteLength)),!a.isBuffer(y)||!a.isBuffer(S))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(y===S)return 0;let x=y.length,A=S.length;for(let j=0,Q=Math.min(x,A);j<Q;++j)if(y[j]!==S[j]){x=y[j],A=S[j];break}return x<A?-1:A<x?1:0},a.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(y,S){if(!Array.isArray(y))throw new TypeError('"list" argument must be an Array of Buffers');if(y.length===0)return a.alloc(0);let x;if(S===void 0)for(S=0,x=0;x<y.length;++x)S+=y[x].length;const A=a.allocUnsafe(S);let j=0;for(x=0;x<y.length;++x){let Q=y[x];if(We(Q,Uint8Array))j+Q.length>A.length?(a.isBuffer(Q)||(Q=a.from(Q)),Q.copy(A,j)):Uint8Array.prototype.set.call(A,Q,j);else if(a.isBuffer(Q))Q.copy(A,j);else throw new TypeError('"list" argument must be an Array of Buffers');j+=Q.length}return A};function b(_,y){if(a.isBuffer(_))return _.length;if(ArrayBuffer.isView(_)||We(_,ArrayBuffer))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);const S=_.length,x=arguments.length>2&&arguments[2]===!0;if(!x&&S===0)return 0;let A=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return S;case"utf8":case"utf-8":return _i(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S*2;case"hex":return S>>>1;case"base64":return bn(_).length;default:if(A)return x?-1:_i(_).length;y=(""+y).toLowerCase(),A=!0}}a.byteLength=b;function C(_,y,S){let x=!1;if((y===void 0||y<0)&&(y=0),y>this.length||((S===void 0||S>this.length)&&(S=this.length),S<=0)||(S>>>=0,y>>>=0,S<=y))return"";for(_||(_="utf8");;)switch(_){case"hex":return ee(this,y,S);case"utf8":case"utf-8":return z(this,y,S);case"ascii":return re(this,y,S);case"latin1":case"binary":return H(this,y,S);case"base64":return W(this,y,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,y,S);default:if(x)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),x=!0}}a.prototype._isBuffer=!0;function T(_,y,S){const x=_[y];_[y]=_[S],_[S]=x}a.prototype.swap16=function(){const y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let S=0;S<y;S+=2)T(this,S,S+1);return this},a.prototype.swap32=function(){const y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let S=0;S<y;S+=4)T(this,S,S+3),T(this,S+1,S+2);return this},a.prototype.swap64=function(){const y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let S=0;S<y;S+=8)T(this,S,S+7),T(this,S+1,S+6),T(this,S+2,S+5),T(this,S+3,S+4);return this},a.prototype.toString=function(){const y=this.length;return y===0?"":arguments.length===0?z(this,0,y):C.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(y){if(!a.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:a.compare(this,y)===0},a.prototype.inspect=function(){let y="";const S=t.INSPECT_MAX_BYTES;return y=this.toString("hex",0,S).replace(/(.{2})/g,"$1 ").trim(),this.length>S&&(y+=" ... "),"<Buffer "+y+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(y,S,x,A,j){if(We(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),!a.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof y);if(S===void 0&&(S=0),x===void 0&&(x=y?y.length:0),A===void 0&&(A=0),j===void 0&&(j=this.length),S<0||x>y.length||A<0||j>this.length)throw new RangeError("out of range index");if(A>=j&&S>=x)return 0;if(A>=j)return-1;if(S>=x)return 1;if(S>>>=0,x>>>=0,A>>>=0,j>>>=0,this===y)return 0;let Q=j-A,Ie=x-S;const Ye=Math.min(Q,Ie),Xe=this.slice(A,j),rt=y.slice(S,x);for(let He=0;He<Ye;++He)if(Xe[He]!==rt[He]){Q=Xe[He],Ie=rt[He];break}return Q<Ie?-1:Ie<Q?1:0};function k(_,y,S,x,A){if(_.length===0)return-1;if(typeof S=="string"?(x=S,S=0):S>2147483647?S=2147483647:S<-2147483648&&(S=-2147483648),S=+S,An(S)&&(S=A?0:_.length-1),S<0&&(S=_.length+S),S>=_.length){if(A)return-1;S=_.length-1}else if(S<0)if(A)S=0;else return-1;if(typeof y=="string"&&(y=a.from(y,x)),a.isBuffer(y))return y.length===0?-1:I(_,y,S,x,A);if(typeof y=="number")return y=y&255,typeof Uint8Array.prototype.indexOf=="function"?A?Uint8Array.prototype.indexOf.call(_,y,S):Uint8Array.prototype.lastIndexOf.call(_,y,S):I(_,[y],S,x,A);throw new TypeError("val must be string, number or Buffer")}function I(_,y,S,x,A){let j=1,Q=_.length,Ie=y.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(_.length<2||y.length<2)return-1;j=2,Q/=2,Ie/=2,S/=2}function Ye(rt,He){return j===1?rt[He]:rt.readUInt16BE(He*j)}let Xe;if(A){let rt=-1;for(Xe=S;Xe<Q;Xe++)if(Ye(_,Xe)===Ye(y,rt===-1?0:Xe-rt)){if(rt===-1&&(rt=Xe),Xe-rt+1===Ie)return rt*j}else rt!==-1&&(Xe-=Xe-rt),rt=-1}else for(S+Ie>Q&&(S=Q-Ie),Xe=S;Xe>=0;Xe--){let rt=!0;for(let He=0;He<Ie;He++)if(Ye(_,Xe+He)!==Ye(y,He)){rt=!1;break}if(rt)return Xe}return-1}a.prototype.includes=function(y,S,x){return this.indexOf(y,S,x)!==-1},a.prototype.indexOf=function(y,S,x){return k(this,y,S,x,!0)},a.prototype.lastIndexOf=function(y,S,x){return k(this,y,S,x,!1)};function R(_,y,S,x){S=Number(S)||0;const A=_.length-S;x?(x=Number(x),x>A&&(x=A)):x=A;const j=y.length;x>j/2&&(x=j/2);let Q;for(Q=0;Q<x;++Q){const Ie=parseInt(y.substr(Q*2,2),16);if(An(Ie))return Q;_[S+Q]=Ie}return Q}function N(_,y,S,x){return Fe(_i(y,_.length-S),_,S,x)}function M(_,y,S,x){return Fe(va(y),_,S,x)}function L(_,y,S,x){return Fe(bn(y),_,S,x)}function F(_,y,S,x){return Fe(Ce(y,_.length-S),_,S,x)}a.prototype.write=function(y,S,x,A){if(S===void 0)A="utf8",x=this.length,S=0;else if(x===void 0&&typeof S=="string")A=S,x=this.length,S=0;else if(isFinite(S))S=S>>>0,isFinite(x)?(x=x>>>0,A===void 0&&(A="utf8")):(A=x,x=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const j=this.length-S;if((x===void 0||x>j)&&(x=j),y.length>0&&(x<0||S<0)||S>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");let Q=!1;for(;;)switch(A){case"hex":return R(this,y,S,x);case"utf8":case"utf-8":return N(this,y,S,x);case"ascii":case"latin1":case"binary":return M(this,y,S,x);case"base64":return L(this,y,S,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,y,S,x);default:if(Q)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),Q=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(_,y,S){return y===0&&S===_.length?e.fromByteArray(_):e.fromByteArray(_.slice(y,S))}function z(_,y,S){S=Math.min(_.length,S);const x=[];let A=y;for(;A<S;){const j=_[A];let Q=null,Ie=j>239?4:j>223?3:j>191?2:1;if(A+Ie<=S){let Ye,Xe,rt,He;switch(Ie){case 1:j<128&&(Q=j);break;case 2:Ye=_[A+1],(Ye&192)===128&&(He=(j&31)<<6|Ye&63,He>127&&(Q=He));break;case 3:Ye=_[A+1],Xe=_[A+2],(Ye&192)===128&&(Xe&192)===128&&(He=(j&15)<<12|(Ye&63)<<6|Xe&63,He>2047&&(He<55296||He>57343)&&(Q=He));break;case 4:Ye=_[A+1],Xe=_[A+2],rt=_[A+3],(Ye&192)===128&&(Xe&192)===128&&(rt&192)===128&&(He=(j&15)<<18|(Ye&63)<<12|(Xe&63)<<6|rt&63,He>65535&&He<1114112&&(Q=He))}}Q===null?(Q=65533,Ie=1):Q>65535&&(Q-=65536,x.push(Q>>>10&1023|55296),Q=56320|Q&1023),x.push(Q),A+=Ie}return K(x)}const Y=4096;function K(_){const y=_.length;if(y<=Y)return String.fromCharCode.apply(String,_);let S="",x=0;for(;x<y;)S+=String.fromCharCode.apply(String,_.slice(x,x+=Y));return S}function re(_,y,S){let x="";S=Math.min(_.length,S);for(let A=y;A<S;++A)x+=String.fromCharCode(_[A]&127);return x}function H(_,y,S){let x="";S=Math.min(_.length,S);for(let A=y;A<S;++A)x+=String.fromCharCode(_[A]);return x}function ee(_,y,S){const x=_.length;(!y||y<0)&&(y=0),(!S||S<0||S>x)&&(S=x);let A="";for(let j=y;j<S;++j)A+=Ae[_[j]];return A}function oe(_,y,S){const x=_.slice(y,S);let A="";for(let j=0;j<x.length-1;j+=2)A+=String.fromCharCode(x[j]+x[j+1]*256);return A}a.prototype.slice=function(y,S){const x=this.length;y=~~y,S=S===void 0?x:~~S,y<0?(y+=x,y<0&&(y=0)):y>x&&(y=x),S<0?(S+=x,S<0&&(S=0)):S>x&&(S=x),S<y&&(S=y);const A=this.subarray(y,S);return Object.setPrototypeOf(A,a.prototype),A};function q(_,y,S){if(_%1!==0||_<0)throw new RangeError("offset is not uint");if(_+y>S)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(y,S,x){y=y>>>0,S=S>>>0,x||q(y,S,this.length);let A=this[y],j=1,Q=0;for(;++Q<S&&(j*=256);)A+=this[y+Q]*j;return A},a.prototype.readUintBE=a.prototype.readUIntBE=function(y,S,x){y=y>>>0,S=S>>>0,x||q(y,S,this.length);let A=this[y+--S],j=1;for(;S>0&&(j*=256);)A+=this[y+--S]*j;return A},a.prototype.readUint8=a.prototype.readUInt8=function(y,S){return y=y>>>0,S||q(y,1,this.length),this[y]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(y,S){return y=y>>>0,S||q(y,2,this.length),this[y]|this[y+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(y,S){return y=y>>>0,S||q(y,2,this.length),this[y]<<8|this[y+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(y,S){return y=y>>>0,S||q(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(y,S){return y=y>>>0,S||q(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},a.prototype.readBigUInt64LE=Zt(function(y){y=y>>>0,dn(y,"offset");const S=this[y],x=this[y+7];(S===void 0||x===void 0)&&On(y,this.length-8);const A=S+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24,j=this[++y]+this[++y]*2**8+this[++y]*2**16+x*2**24;return BigInt(A)+(BigInt(j)<<BigInt(32))}),a.prototype.readBigUInt64BE=Zt(function(y){y=y>>>0,dn(y,"offset");const S=this[y],x=this[y+7];(S===void 0||x===void 0)&&On(y,this.length-8);const A=S*2**24+this[++y]*2**16+this[++y]*2**8+this[++y],j=this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+x;return(BigInt(A)<<BigInt(32))+BigInt(j)}),a.prototype.readIntLE=function(y,S,x){y=y>>>0,S=S>>>0,x||q(y,S,this.length);let A=this[y],j=1,Q=0;for(;++Q<S&&(j*=256);)A+=this[y+Q]*j;return j*=128,A>=j&&(A-=Math.pow(2,8*S)),A},a.prototype.readIntBE=function(y,S,x){y=y>>>0,S=S>>>0,x||q(y,S,this.length);let A=S,j=1,Q=this[y+--A];for(;A>0&&(j*=256);)Q+=this[y+--A]*j;return j*=128,Q>=j&&(Q-=Math.pow(2,8*S)),Q},a.prototype.readInt8=function(y,S){return y=y>>>0,S||q(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},a.prototype.readInt16LE=function(y,S){y=y>>>0,S||q(y,2,this.length);const x=this[y]|this[y+1]<<8;return x&32768?x|4294901760:x},a.prototype.readInt16BE=function(y,S){y=y>>>0,S||q(y,2,this.length);const x=this[y+1]|this[y]<<8;return x&32768?x|4294901760:x},a.prototype.readInt32LE=function(y,S){return y=y>>>0,S||q(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},a.prototype.readInt32BE=function(y,S){return y=y>>>0,S||q(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},a.prototype.readBigInt64LE=Zt(function(y){y=y>>>0,dn(y,"offset");const S=this[y],x=this[y+7];(S===void 0||x===void 0)&&On(y,this.length-8);const A=this[y+4]+this[y+5]*2**8+this[y+6]*2**16+(x<<24);return(BigInt(A)<<BigInt(32))+BigInt(S+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24)}),a.prototype.readBigInt64BE=Zt(function(y){y=y>>>0,dn(y,"offset");const S=this[y],x=this[y+7];(S===void 0||x===void 0)&&On(y,this.length-8);const A=(S<<24)+this[++y]*2**16+this[++y]*2**8+this[++y];return(BigInt(A)<<BigInt(32))+BigInt(this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+x)}),a.prototype.readFloatLE=function(y,S){return y=y>>>0,S||q(y,4,this.length),n.read(this,y,!0,23,4)},a.prototype.readFloatBE=function(y,S){return y=y>>>0,S||q(y,4,this.length),n.read(this,y,!1,23,4)},a.prototype.readDoubleLE=function(y,S){return y=y>>>0,S||q(y,8,this.length),n.read(this,y,!0,52,8)},a.prototype.readDoubleBE=function(y,S){return y=y>>>0,S||q(y,8,this.length),n.read(this,y,!1,52,8)};function ie(_,y,S,x,A,j){if(!a.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>A||y<j)throw new RangeError('"value" argument is out of bounds');if(S+x>_.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(y,S,x,A){if(y=+y,S=S>>>0,x=x>>>0,!A){const Ie=Math.pow(2,8*x)-1;ie(this,y,S,x,Ie,0)}let j=1,Q=0;for(this[S]=y&255;++Q<x&&(j*=256);)this[S+Q]=y/j&255;return S+x},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(y,S,x,A){if(y=+y,S=S>>>0,x=x>>>0,!A){const Ie=Math.pow(2,8*x)-1;ie(this,y,S,x,Ie,0)}let j=x-1,Q=1;for(this[S+j]=y&255;--j>=0&&(Q*=256);)this[S+j]=y/Q&255;return S+x},a.prototype.writeUint8=a.prototype.writeUInt8=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,1,255,0),this[S]=y&255,S+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,2,65535,0),this[S]=y&255,this[S+1]=y>>>8,S+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,2,65535,0),this[S]=y>>>8,this[S+1]=y&255,S+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,4,4294967295,0),this[S+3]=y>>>24,this[S+2]=y>>>16,this[S+1]=y>>>8,this[S]=y&255,S+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,4,4294967295,0),this[S]=y>>>24,this[S+1]=y>>>16,this[S+2]=y>>>8,this[S+3]=y&255,S+4};function ke(_,y,S,x,A){Zn(y,x,A,_,S,7);let j=Number(y&BigInt(4294967295));_[S++]=j,j=j>>8,_[S++]=j,j=j>>8,_[S++]=j,j=j>>8,_[S++]=j;let Q=Number(y>>BigInt(32)&BigInt(4294967295));return _[S++]=Q,Q=Q>>8,_[S++]=Q,Q=Q>>8,_[S++]=Q,Q=Q>>8,_[S++]=Q,S}function _e(_,y,S,x,A){Zn(y,x,A,_,S,7);let j=Number(y&BigInt(4294967295));_[S+7]=j,j=j>>8,_[S+6]=j,j=j>>8,_[S+5]=j,j=j>>8,_[S+4]=j;let Q=Number(y>>BigInt(32)&BigInt(4294967295));return _[S+3]=Q,Q=Q>>8,_[S+2]=Q,Q=Q>>8,_[S+1]=Q,Q=Q>>8,_[S]=Q,S+8}a.prototype.writeBigUInt64LE=Zt(function(y,S=0){return ke(this,y,S,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Zt(function(y,S=0){return _e(this,y,S,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(y,S,x,A){if(y=+y,S=S>>>0,!A){const Ye=Math.pow(2,8*x-1);ie(this,y,S,x,Ye-1,-Ye)}let j=0,Q=1,Ie=0;for(this[S]=y&255;++j<x&&(Q*=256);)y<0&&Ie===0&&this[S+j-1]!==0&&(Ie=1),this[S+j]=(y/Q>>0)-Ie&255;return S+x},a.prototype.writeIntBE=function(y,S,x,A){if(y=+y,S=S>>>0,!A){const Ye=Math.pow(2,8*x-1);ie(this,y,S,x,Ye-1,-Ye)}let j=x-1,Q=1,Ie=0;for(this[S+j]=y&255;--j>=0&&(Q*=256);)y<0&&Ie===0&&this[S+j+1]!==0&&(Ie=1),this[S+j]=(y/Q>>0)-Ie&255;return S+x},a.prototype.writeInt8=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,1,127,-128),y<0&&(y=255+y+1),this[S]=y&255,S+1},a.prototype.writeInt16LE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,2,32767,-32768),this[S]=y&255,this[S+1]=y>>>8,S+2},a.prototype.writeInt16BE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,2,32767,-32768),this[S]=y>>>8,this[S+1]=y&255,S+2},a.prototype.writeInt32LE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,4,2147483647,-2147483648),this[S]=y&255,this[S+1]=y>>>8,this[S+2]=y>>>16,this[S+3]=y>>>24,S+4},a.prototype.writeInt32BE=function(y,S,x){return y=+y,S=S>>>0,x||ie(this,y,S,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[S]=y>>>24,this[S+1]=y>>>16,this[S+2]=y>>>8,this[S+3]=y&255,S+4},a.prototype.writeBigInt64LE=Zt(function(y,S=0){return ke(this,y,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Zt(function(y,S=0){return _e(this,y,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function me(_,y,S,x,A,j){if(S+x>_.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("Index out of range")}function nt(_,y,S,x,A){return y=+y,S=S>>>0,A||me(_,y,S,4),n.write(_,y,S,x,23,4),S+4}a.prototype.writeFloatLE=function(y,S,x){return nt(this,y,S,!0,x)},a.prototype.writeFloatBE=function(y,S,x){return nt(this,y,S,!1,x)};function gt(_,y,S,x,A){return y=+y,S=S>>>0,A||me(_,y,S,8),n.write(_,y,S,x,52,8),S+8}a.prototype.writeDoubleLE=function(y,S,x){return gt(this,y,S,!0,x)},a.prototype.writeDoubleBE=function(y,S,x){return gt(this,y,S,!1,x)},a.prototype.copy=function(y,S,x,A){if(!a.isBuffer(y))throw new TypeError("argument should be a Buffer");if(x||(x=0),!A&&A!==0&&(A=this.length),S>=y.length&&(S=y.length),S||(S=0),A>0&&A<x&&(A=x),A===x||y.length===0||this.length===0)return 0;if(S<0)throw new RangeError("targetStart out of bounds");if(x<0||x>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),y.length-S<A-x&&(A=y.length-S+x);const j=A-x;return this===y&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(S,x,A):Uint8Array.prototype.set.call(y,this.subarray(x,A),S),j},a.prototype.fill=function(y,S,x,A){if(typeof y=="string"){if(typeof S=="string"?(A=S,S=0,x=this.length):typeof x=="string"&&(A=x,x=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!a.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(y.length===1){const Q=y.charCodeAt(0);(A==="utf8"&&Q<128||A==="latin1")&&(y=Q)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(S<0||this.length<S||this.length<x)throw new RangeError("Out of range index");if(x<=S)return this;S=S>>>0,x=x===void 0?this.length:x>>>0,y||(y=0);let j;if(typeof y=="number")for(j=S;j<x;++j)this[j]=y;else{const Q=a.isBuffer(y)?y:a.from(y,A),Ie=Q.length;if(Ie===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for(j=0;j<x-S;++j)this[j+S]=Q[j%Ie]}return this};const ce={};function Qt(_,y,S){ce[_]=class extends S{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_}]`,this.stack,delete this.name}get code(){return _}set code(A){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:A,writable:!0})}toString(){return`${this.name} [${_}]: ${this.message}`}}}Qt("ERR_BUFFER_OUT_OF_BOUNDS",function(_){return _?`${_} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Qt("ERR_INVALID_ARG_TYPE",function(_,y){return`The "${_}" argument must be of type number. Received type ${typeof y}`},TypeError),Qt("ERR_OUT_OF_RANGE",function(_,y,S){let x=`The value of "${_}" is out of range.`,A=S;return Number.isInteger(S)&&Math.abs(S)>2**32?A=Qn(String(S)):typeof S=="bigint"&&(A=String(S),(S>BigInt(2)**BigInt(32)||S<-(BigInt(2)**BigInt(32)))&&(A=Qn(A)),A+="n"),x+=` It must be ${y}. Received ${A}`,x},RangeError);function Qn(_){let y="",S=_.length;const x=_[0]==="-"?1:0;for(;S>=x+4;S-=3)y=`_${_.slice(S-3,S)}${y}`;return`${_.slice(0,S)}${y}`}function Mt(_,y,S){dn(y,"offset"),(_[y]===void 0||_[y+S]===void 0)&&On(y,_.length-(S+1))}function Zn(_,y,S,x,A,j){if(_>S||_<y){const Q=typeof y=="bigint"?"n":"";let Ie;throw j>3?y===0||y===BigInt(0)?Ie=`>= 0${Q} and < 2${Q} ** ${(j+1)*8}${Q}`:Ie=`>= -(2${Q} ** ${(j+1)*8-1}${Q}) and < 2 ** ${(j+1)*8-1}${Q}`:Ie=`>= ${y}${Q} and <= ${S}${Q}`,new ce.ERR_OUT_OF_RANGE("value",Ie,_)}Mt(x,A,j)}function dn(_,y){if(typeof _!="number")throw new ce.ERR_INVALID_ARG_TYPE(y,"number",_)}function On(_,y,S){throw Math.floor(_)!==_?(dn(_,S),new ce.ERR_OUT_OF_RANGE(S||"offset","an integer",_)):y<0?new ce.ERR_BUFFER_OUT_OF_BOUNDS:new ce.ERR_OUT_OF_RANGE(S||"offset",`>= ${S?1:0} and <= ${y}`,_)}const lr=/[^+/0-9A-Za-z-_]/g;function fc(_){if(_=_.split("=")[0],_=_.trim().replace(lr,""),_.length<2)return"";for(;_.length%4!==0;)_=_+"=";return _}function _i(_,y){y=y||1/0;let S;const x=_.length;let A=null;const j=[];for(let Q=0;Q<x;++Q){if(S=_.charCodeAt(Q),S>55295&&S<57344){if(!A){if(S>56319){(y-=3)>-1&&j.push(239,191,189);continue}else if(Q+1===x){(y-=3)>-1&&j.push(239,191,189);continue}A=S;continue}if(S<56320){(y-=3)>-1&&j.push(239,191,189),A=S;continue}S=(A-55296<<10|S-56320)+65536}else A&&(y-=3)>-1&&j.push(239,191,189);if(A=null,S<128){if((y-=1)<0)break;j.push(S)}else if(S<2048){if((y-=2)<0)break;j.push(S>>6|192,S&63|128)}else if(S<65536){if((y-=3)<0)break;j.push(S>>12|224,S>>6&63|128,S&63|128)}else if(S<1114112){if((y-=4)<0)break;j.push(S>>18|240,S>>12&63|128,S>>6&63|128,S&63|128)}else throw new Error("Invalid code point")}return j}function va(_){const y=[];for(let S=0;S<_.length;++S)y.push(_.charCodeAt(S)&255);return y}function Ce(_,y){let S,x,A;const j=[];for(let Q=0;Q<_.length&&!((y-=2)<0);++Q)S=_.charCodeAt(Q),x=S>>8,A=S%256,j.push(A),j.push(x);return j}function bn(_){return e.toByteArray(fc(_))}function Fe(_,y,S,x){let A;for(A=0;A<x&&!(A+S>=y.length||A>=_.length);++A)y[A+S]=_[A];return A}function We(_,y){return _ instanceof y||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===y.name}function An(_){return _!==_}const Ae=function(){const _="0123456789abcdef",y=new Array(256);for(let S=0;S<16;++S){const x=S*16;for(let A=0;A<16;++A)y[x+A]=_[S]+_[A]}return y}();function Zt(_){return typeof BigInt>"u"?yf:_}function yf(){throw new Error("BigInt not supported")}})(hn);var Nu=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(Nu||{}),Mu=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(Mu||{});class F5{constructor(e){V(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class U5 extends SI{constructor(n){super();V(this,"state");V(this,"buffer");V(this,"subBuffer");V(this,"iacSEBuffer",hn.Buffer.from([255,240]));V(this,"negotiationByte",0);V(this,"stream");this.state=0,this.buffer=hn.Buffer.alloc(0),this.subBuffer=hn.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=hn.Buffer.concat([this.buffer,hn.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=hn.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=hn.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,s]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,s)}sendNegotiation(n,r){this.stream.write(hn.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,s=hn.Buffer.from(i),o=hn.Buffer.concat([hn.Buffer.from([255,250]),hn.Buffer.from([201]),s,this.iacSEBuffer]);this.stream.write(o)}sendTerminalType(n){const r=hn.Buffer.from(n),i=hn.Buffer.concat([hn.Buffer.from([255,250]),hn.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}class ao{constructor(e){V(this,"packageName");V(this,"packageVersion",1);V(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class B5 extends ao{constructor(){super(...arguments);V(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class j5 extends ao{constructor(){super(...arguments);V(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class $5 extends ao{constructor(n){super(n);V(this,"packageName","Client.Keystrokes");V(this,"bindings",[]);document.addEventListener("keyup",this.handleKeyup.bind(this))}handleKeyup(n){const r=this.findBinding(n);if(r){const i=this.client.getInput(),s=this.parseCommand(r.command,i);r.autosend?this.sendCommand(s):this.placeInInputField(s)}}findBinding(n){return this.bindings.find(r=>r.key===n.key&&r.modifiers.every(i=>n[`${i}Key`]))}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(s,o)=>{if(o==="*")return r;const a=parseInt(o,10)-1;return a>=0&&a<i.length?i[a]:s})}sendCommand(n){this.sendData("ExecuteCommand",{command:n})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>r.key!==n.key||!r.modifiers.every(i=>n.modifiers.includes(i)))}unbindAll(){this.bindings=[]}bindAll(n){this.bindings=n.bindings}listBindings(){return this.bindings}}const KE=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),YE=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),py=(t,e)=>({startTime:e,type:"setValue",value:t}),bI=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),EI=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),Bc=t=>t.type==="exponentialRampToValue",op=t=>t.type==="linearRampToValue",_o=t=>Bc(t)||op(t),HS=t=>t.type==="setValue",ps=t=>t.type==="setValueCurve",ap=(t,e,n,r)=>{const i=t[e];return i===void 0?r:_o(i)||HS(i)?i.value:ps(i)?i.values[i.values.length-1]:EI(n,ap(t,e-1,i.startTime,r),i)},XE=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:_o(n)?[n.endTime,n.value]:HS(n)?[n.startTime,n.value]:ps(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,ap(t,e-1,n.startTime,i)],my=t=>t.type==="cancelAndHold",gy=t=>t.type==="cancelScheduledValues",vo=t=>my(t)||gy(t)?t.cancelTime:Bc(t)||op(t)?t.endTime:t.startTime,QE=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,ZE=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),V5=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},z5=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return V5(r,i)},Bf=t=>t.type==="setTarget";class W5{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=vo(e);if(my(e)||gy(e)){const r=this._automationEvents.findIndex(s=>gy(e)&&ps(s)?s.startTime+s.duration>=n:vo(s)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),my(e)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&_o(i)){if(s!==void 0&&Bf(s))throw new Error("The internal list is malformed.");const o=s===void 0?i.insertTime:ps(s)?s.startTime+s.duration:vo(s),a=s===void 0?this._defaultValue:ps(s)?s.values[s.values.length-1]:s.value,c=Bc(i)?QE(n,o,a,i):ZE(n,o,a,i),l=Bc(i)?KE(c,n,this._currenTime):YE(c,n,this._currenTime);this._automationEvents.push(l)}if(s!==void 0&&Bf(s)&&this._automationEvents.push(py(this.getValue(n),n)),s!==void 0&&ps(s)&&s.startTime+s.duration>n){const o=n-s.startTime,a=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(o*a)),l=o/(c-1)*a,u=s.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const f=l*d%1;u[d]=s.values[d-1]*(1-f)+s.values[d]*f}this._automationEvents[this._automationEvents.length-1]=bI(u,s.startTime,o)}}}else{const r=this._automationEvents.findIndex(o=>vo(o)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&ps(i)&&vo(i)+i.duration>n)return!1;const s=Bc(e)?KE(e.value,e.endTime,this._currenTime):op(e)?YE(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(s);else{if(ps(e)&&n+e.duration>vo(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>vo(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];Bf(i)&&r.unshift(py(ap(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(o=>vo(o)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[i];if(s!==void 0&&Bf(s)&&(r===void 0||!_o(r)||r.insertTime>e))return EI(e,ap(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&HS(s)&&(r===void 0||!_o(r)))return s.value;if(s!==void 0&&ps(s)&&(r===void 0||!_o(r)||s.startTime+s.duration>e))return e<s.startTime+s.duration?z5(e,s):s.values[s.values.length-1];if(s!==void 0&&_o(s)&&(r===void 0||!_o(r)))return s.value;if(r!==void 0&&Bc(r)){const[o,a]=XE(this._automationEvents,i,s,r,this._defaultValue);return QE(e,o,a,r)}if(r!==void 0&&op(r)){const[o,a]=XE(this._automationEvents,i,s,r,this._defaultValue);return ZE(e,o,a,r)}return this._defaultValue}}const H5=t=>({cancelTime:t,type:"cancelAndHold"}),G5=t=>({cancelTime:t,type:"cancelScheduledValues"}),q5=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),J5=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),K5=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),Y5=()=>new DOMException("","AbortError"),X5=t=>(e,n,[r,i,s],o)=>{t(e[i],[n,r,s],a=>a[0]===n&&a[1]===r,o)},Q5=t=>(e,n,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},Z5=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},_l=new WeakSet,kI=new WeakMap,TI=new WeakMap,_I=new WeakMap,CI=new WeakMap,II=new WeakMap,RI=new WeakMap,vy=new WeakMap,ek=new WeakMap,PI={construct(){return PI}},eF=t=>{try{const e=new Proxy(t,PI);new e}catch{return!1}return!0},tk=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,nk=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(tk);for(;i!==null;){const s=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(o),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(tk)}return[n.join(";"),r]},rk=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},ik=t=>{if(!eF(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},tF=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>{let h=0;return(p,m,w={credentials:"omit"})=>{const g=u.get(p);if(g!==void 0&&g.has(m))return Promise.resolve();const v=l.get(p);if(v!==void 0){const T=v.get(m);if(T!==void 0)return T}const b=s(p),C=b.audioWorklet===void 0?i(m).then(([T,k])=>{const[I,R]=nk(T,k),N=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${R}
})})(window,'_AWGS')`;return n(N)}).then(()=>{const T=f._AWGS.pop();if(T===void 0)throw new SyntaxError;r(b.currentTime,b.sampleRate,()=>T(class{},void 0,(k,I)=>{if(k.trim()==="")throw e();const R=ek.get(b);if(R!==void 0){if(R.has(k))throw e();ik(I),rk(I.parameterDescriptors),R.set(k,I)}else ik(I),rk(I.parameterDescriptors),ek.set(b,new Map([[k,I]]))},b.sampleRate,void 0,void 0))}):Promise.all([i(m),Promise.resolve(t(d,d))]).then(([[T,k],I])=>{const R=h+1;h=R;const[N,M]=nk(T,k),z=`${N};((AudioWorkletProcessor,registerProcessor)=>{${M}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${R}',class extends AudioWorkletProcessor{process(){return !1}})`,Y=new Blob([z],{type:"application/javascript; charset=utf-8"}),K=URL.createObjectURL(Y);return b.audioWorklet.addModule(K,w).then(()=>{if(a(b))return b;const re=o(b);return re.audioWorklet.addModule(K,w).then(()=>re)}).then(re=>{if(c===null)throw new SyntaxError;try{new c(re,`__sac${R}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(K))});return v===void 0?l.set(p,new Map([[m,C]])):v.set(m,C),C.then(()=>{const T=u.get(p);T===void 0?u.set(p,new Set([m])):T.add(m)}).finally(()=>{const T=l.get(p);T!==void 0&&T.delete(m)}),C}},fa=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},am=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},xI=(t,e,n,r)=>{const i=fa(t,e),s=am(i,o=>o[0]===n&&o[1]===r);return i.size===0&&t.delete(e),s},ef=t=>fa(RI,t),Cl=t=>{if(_l.has(t))throw new Error("The AudioNode is already stored.");_l.add(t),ef(t).forEach(e=>e(!0))},NI=t=>"port"in t,tf=t=>{if(!_l.has(t))throw new Error("The AudioNode is not stored.");_l.delete(t),ef(t).forEach(e=>e(!1))},yy=(t,e)=>{!NI(t)&&e.every(n=>n.size===0)&&tf(t)},nF=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>{const h=new WeakMap;return(p,m,w,g,v)=>{const{activeInputs:b,passiveInputs:C}=s(m),{outputs:T}=s(p),k=a(p),I=R=>{const N=c(m),M=c(p);if(R){const L=xI(C,p,w,g);t(b,p,L,!1),!v&&!d(p)&&n(M,N,w,g),f(m)&&Cl(m)}else{const L=r(b,p,w,g);e(C,g,L,!1),!v&&!d(p)&&i(M,N,w,g);const F=o(m);if(F===0)u(m)&&yy(m,b);else{const W=h.get(m);W!==void 0&&clearTimeout(W),h.set(m,setTimeout(()=>{u(m)&&yy(m,b)},F*1e3))}}};return l(T,[m,w,g],R=>R[0]===m&&R[1]===w&&R[2]===g,!0)?(k.add(I),u(p)?t(b,p,[w,g,I],!0):e(C,g,[p,w,I],!0),!0):!1}},rF=t=>(e,n,[r,i,s],o)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,s]])):t(a,[i,n,s],c=>c[0]===i&&c[1]===n,o)},iF=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},sF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},oF=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...sF,...c},d=r(l,u),f=s(l)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Yn=(t,e)=>t.context===e,aF=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Yn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},Sy=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},nc=()=>new DOMException("","IndexSizeError"),MI=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?nc():r}})(t.getChannelData)},cF={numberOfChannels:1},lF=(t,e,n,r,i,s,o,a)=>{let c=null;return class OI{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...cF,...u};c===null&&(c=new i(1,1,44100));const p=r!==null&&e(s,s)?new r({length:d,numberOfChannels:f,sampleRate:h}):c.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(o(p),MI(p)):e(Sy,()=>Sy(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===OI.prototype||t.has(u)}}},vr=-34028234663852886e22,tr=-vr,Js=t=>_l.has(t),uF={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},dF=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...uF,...u},h=i(d,f),p=o(d),m=p?e():null;super(l,!1,h,m),this._audioBufferSourceNodeRenderer=m,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,tr,vr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){Cl(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Js(this)&&tf(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},fF=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Yn(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,h),o!==null&&d.start(...o),a!==null&&d.stop(a)}return s.set(u,d),f?await t(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},hF=t=>"playbackRate"in t,pF=t=>"frequency"in t&&"gain"in t,mF=t=>"offset"in t,gF=t=>!("frequency"in t)&&"gain"in t,vF=t=>"detune"in t&&"frequency"in t,yF=t=>"pan"in t,wr=t=>fa(kI,t),nf=t=>fa(_I,t),wy=(t,e)=>{const{activeInputs:n}=wr(t);n.forEach(i=>i.forEach(([s])=>{e.includes(t)||wy(s,[...e,t])}));const r=hF(t)?[t.playbackRate]:NI(t)?Array.from(t.parameters.values()):pF(t)?[t.Q,t.detune,t.frequency,t.gain]:mF(t)?[t.offset]:gF(t)?[t.gain]:vF(t)?[t.detune,t.frequency]:yF(t)?[t.pan]:[];for(const i of r){const s=nf(i);s!==void 0&&s.activeInputs.forEach(([o])=>wy(o,e))}Js(t)&&tf(t)},SF=t=>{wy(t.destination,[])},wF=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),bF=(t,e,n,r,i,s,o,a,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!wF(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),SF(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},EF=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f=o(d),h=i(d,u,f),p=f?e(a):null;super(l,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},kF=t=>{const e=new WeakMap,n=async(r,i)=>{const s=i.destination;return e.set(i,s),await t(r,i,s),s};return{render(r,i){const s=e.get(i);return s!==void 0?Promise.resolve(s):n(r,i)}}},TF=(t,e,n,r,i,s,o,a)=>(c,l)=>{const u=l.listener,d=()=>{const T=new Float32Array(1),k=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=o(l);let R=!1,N=[0,0,-1,0,1,0],M=[0,0,0];const L=()=>{if(R)return;R=!0;const Y=r(l,256,9,0);Y.onaudioprocess=({inputBuffer:K})=>{const re=[s(K,T,0),s(K,T,1),s(K,T,2),s(K,T,3),s(K,T,4),s(K,T,5)];re.some((ee,oe)=>ee!==N[oe])&&(u.setOrientation(...re),N=re);const H=[s(K,T,6),s(K,T,7),s(K,T,8)];H.some((ee,oe)=>ee!==M[oe])&&(u.setPosition(...H),M=H)},k.connect(Y)},F=Y=>K=>{K!==N[Y]&&(N[Y]=K,u.setOrientation(...N))},W=Y=>K=>{K!==M[Y]&&(M[Y]=K,u.setPosition(...M))},z=(Y,K,re)=>{const H=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:K});H.connect(k,0,Y),H.start(),Object.defineProperty(H.offset,"defaultValue",{get(){return K}});const ee=t({context:c},I,H.offset,tr,vr);return a(ee,"value",oe=>()=>oe.call(ee),oe=>q=>{try{oe.call(ee,q)}catch(ie){if(ie.code!==9)throw ie}L(),I&&re(q)}),ee.cancelAndHoldAtTime=(oe=>I?()=>{throw i()}:(...q)=>{const ie=oe.apply(ee,q);return L(),ie})(ee.cancelAndHoldAtTime),ee.cancelScheduledValues=(oe=>I?()=>{throw i()}:(...q)=>{const ie=oe.apply(ee,q);return L(),ie})(ee.cancelScheduledValues),ee.exponentialRampToValueAtTime=(oe=>I?()=>{throw i()}:(...q)=>{const ie=oe.apply(ee,q);return L(),ie})(ee.exponentialRampToValueAtTime),ee.linearRampToValueAtTime=(oe=>I?()=>{throw i()}:(...q)=>{const ie=oe.apply(ee,q);return L(),ie})(ee.linearRampToValueAtTime),ee.setTargetAtTime=(oe=>I?()=>{throw i()}:(...q)=>{const ie=oe.apply(ee,q);return L(),ie})(ee.setTargetAtTime),ee.setValueAtTime=(oe=>I?()=>{throw i()}:(...q)=>{const ie=oe.apply(ee,q);return L(),ie})(ee.setValueAtTime),ee.setValueCurveAtTime=(oe=>I?()=>{throw i()}:(...q)=>{const ie=oe.apply(ee,q);return L(),ie})(ee.setValueCurveAtTime),ee};return{forwardX:z(0,0,F(0)),forwardY:z(1,0,F(1)),forwardZ:z(2,-1,F(2)),positionX:z(6,0,W(0)),positionY:z(7,0,W(1)),positionZ:z(8,0,W(2)),upX:z(3,0,F(3)),upY:z(4,1,F(4)),upZ:z(5,0,F(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:m,positionY:w,positionZ:g,upX:v,upY:b,upZ:C}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return m},get positionY(){return w},get positionZ(){return g},get upX(){return v},get upY(){return b},get upZ(){return C}}},cp=t=>"context"in t,rf=t=>cp(t[0]),rc=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},sk=(t,e,[n,r],i)=>{rc(t,[e,n,r],s=>s[0]===e&&s[1]===n,i)},ok=(t,[e,n,r],i)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,r]])):rc(s,[n,r],o=>o[0]===n,i)},Wl=t=>"inputs"in t,lp=(t,e,n,r)=>{if(Wl(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},AI=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},_F=(t,e,n)=>am(t,r=>r[0]===e&&r[1]===n),DI=(t,e)=>{if(!ef(t).delete(e))throw new Error("Missing the expected event listener.")},LI=(t,e,n)=>{const r=fa(t,e),i=am(r,s=>s[0]===n);return r.size===0&&t.delete(e),i},up=(t,e,n,r)=>{Wl(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},Tt=t=>fa(TI,t),Ed=t=>fa(CI,t),za=t=>vy.has(t),gh=t=>!_l.has(t),ak=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),Lg=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const s=n.get(i);n.set(i,s===void 0?1:s+1)}n.forEach((r,i)=>e(i,r))},ck=t=>"context"in t,CF=t=>{const e=new Map;t.connect=(n=>(r,i=0,s=0)=>{const o=ck(r)?n(r,i,s):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:s,output:i}]):a.every(c=>c.input!==s||c.output!==i)&&a.push({input:s,output:i}),o})(t.connect.bind(t)),t.disconnect=(n=>(r,i,s)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[o,a]of e){const c=a.filter(l=>l.output!==r);c.length===0?e.delete(o):e.set(o,c)}else if(e.has(r))if(i===void 0)e.delete(r);else{const o=e.get(r);if(o!==void 0){const a=o.filter(c=>c.output!==i&&(c.input!==s||s===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[o,a]of e)a.forEach(c=>{ck(o)?t.connect(o,c.output,c.input):t.connect(o,c.output)})})(t.disconnect)},IF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=nf(e),{outputs:o}=wr(t),a=ef(t),c=l=>{const u=Tt(t),d=Ed(e);if(l){const f=LI(s,t,n);sk(i,t,f,!1),!r&&!za(t)&&u.connect(d,n)}else{const f=_F(i,t,n);ok(s,f,!1),!r&&!za(t)&&u.disconnect(d,n)}};return rc(o,[e,n],l=>l[0]===e&&l[1]===n,!0)?(a.add(c),Js(t)?sk(i,t,[n,c],!0):ok(s,[t,n,c],!0),!0):!1},RF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=wr(e),o=AI(i[r],t,n);return o===null?[xI(s,t,n,r)[2],!1]:[o[2],!0]},PF=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=nf(e),s=AI(r,t,n);return s===null?[LI(i,t,n)[1],!1]:[s[2],!0]},GS=(t,e,n,r,i)=>{const[s,o]=RF(t,n,r,i);if(s!==null&&(DI(t,s),o&&!e&&!za(t)&&up(Tt(t),Tt(n),r,i)),Js(n)){const{activeInputs:a}=wr(n);yy(n,a)}},qS=(t,e,n,r)=>{const[i,s]=PF(t,n,r);i!==null&&(DI(t,i),s&&!e&&!za(t)&&Tt(t).disconnect(Ed(n),r))},xF=(t,e)=>{const n=wr(t),r=[];for(const i of n.outputs)rf(i)?GS(t,e,...i):qS(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},NF=(t,e,n)=>{const r=wr(t),i=[];for(const s of r.outputs)s[1]===n&&(rf(s)?GS(t,e,...s):qS(t,e,...s),i.push(s[0]),r.outputs.delete(s));return i},MF=(t,e,n,r,i)=>{const s=wr(t);return Array.from(s.outputs).filter(o=>o[0]===n&&(r===void 0||o[1]===r)&&(i===void 0||o[2]===i)).map(o=>(rf(o)?GS(t,e,...o):qS(t,e,...o),s.outputs.delete(o),o[0]))},OF=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,m)=>class extends l{constructor(g,v,b,C){super(b),this._context=g,this._nativeAudioNode=b;const T=u(g);d(T)&&n(ak,()=>ak(T,m))!==!0&&CF(b),TI.set(this,b),RI.set(this,new Set),g.state!=="closed"&&v&&Cl(this),t(this,C,b)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,v=0,b=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const C=u(this._context),T=p(C);if(f(g)||h(g))throw s();if(cp(g)){const R=Tt(g);try{const M=lp(this._nativeAudioNode,R,v,b),L=gh(this);(T||L)&&this._nativeAudioNode.disconnect(...M),this.context.state!=="closed"&&!L&&gh(g)&&Cl(g)}catch(M){throw M.code===12?s():M}if(e(this,g,v,b,T)){const M=c([this],g);Lg(M,r(T))}return g}const k=Ed(g);if(k.name==="playbackRate"&&k.maxValue===1024)throw o();try{this._nativeAudioNode.connect(k,v),(T||gh(this))&&this._nativeAudioNode.disconnect(k,v)}catch(R){throw R.code===12?s():R}if(IF(this,g,v,T)){const R=c([this],g);Lg(R,r(T))}}disconnect(g,v,b){let C;const T=u(this._context),k=p(T);if(g===void 0)C=xF(this,k);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw i();C=NF(this,k,g)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||cp(g)&&b!==void 0&&(b<0||b>=g.numberOfInputs))throw i();if(C=MF(this,k,g,v,b),C.length===0)throw s()}for(const I of C){const R=c([this],I);Lg(R,a)}}},AF=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>(h,p,m,w=null,g=null)=>{const v=m.value,b=new W5(v),C=p?r(b):null,T={get defaultValue(){return v},get maxValue(){return w===null?m.maxValue:w},get minValue(){return g===null?m.minValue:g},get value(){return m.value},set value(k){m.value=k,T.setValueAtTime(k,h.context.currentTime)},cancelAndHoldAtTime(k){if(typeof m.cancelAndHoldAtTime=="function")C===null&&b.flush(h.context.currentTime),b.add(i(k)),m.cancelAndHoldAtTime(k);else{const I=Array.from(b).pop();C===null&&b.flush(h.context.currentTime),b.add(i(k));const R=Array.from(b).pop();m.cancelScheduledValues(k),I!==R&&R!==void 0&&(R.type==="exponentialRampToValue"?m.exponentialRampToValueAtTime(R.value,R.endTime):R.type==="linearRampToValue"?m.linearRampToValueAtTime(R.value,R.endTime):R.type==="setValue"?m.setValueAtTime(R.value,R.startTime):R.type==="setValueCurve"&&m.setValueCurveAtTime(R.values,R.startTime,R.duration))}return T},cancelScheduledValues(k){return C===null&&b.flush(h.context.currentTime),b.add(s(k)),m.cancelScheduledValues(k),T},exponentialRampToValueAtTime(k,I){if(k===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const R=h.context.currentTime;return C===null&&b.flush(R),Array.from(b).length===0&&(b.add(l(v,R)),m.setValueAtTime(v,R)),b.add(o(k,I)),m.exponentialRampToValueAtTime(k,I),T},linearRampToValueAtTime(k,I){const R=h.context.currentTime;return C===null&&b.flush(R),Array.from(b).length===0&&(b.add(l(v,R)),m.setValueAtTime(v,R)),b.add(a(k,I)),m.linearRampToValueAtTime(k,I),T},setTargetAtTime(k,I,R){return C===null&&b.flush(h.context.currentTime),b.add(c(k,I,R)),m.setTargetAtTime(k,I,R),T},setValueAtTime(k,I){return C===null&&b.flush(h.context.currentTime),b.add(l(k,I)),m.setValueAtTime(k,I),T},setValueCurveAtTime(k,I,R){const N=k instanceof Float32Array?k:new Float32Array(k);if(d!==null&&d.name==="webkitAudioContext"){const M=I+R,L=h.context.sampleRate,F=Math.ceil(I*L),W=Math.floor(M*L),z=W-F,Y=new Float32Array(z);for(let re=0;re<z;re+=1){const H=(N.length-1)/R*((F+re)/L-I),ee=Math.floor(H),oe=Math.ceil(H);Y[re]=ee===oe?N[ee]:(1-(H-ee))*N[ee]+(1-(oe-H))*N[oe]}C===null&&b.flush(h.context.currentTime),b.add(u(Y,I,R)),m.setValueCurveAtTime(Y,I,R);const K=W/L;K<M&&f(T,Y[Y.length-1],K),f(T,N[N.length-1],M)}else C===null&&b.flush(h.context.currentTime),b.add(u(N,I,R)),m.setValueCurveAtTime(N,I,R);return T}};return n.set(T,m),e.set(T,h),t(T,C),T},DF=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=n;e.setTargetAtTime(i,r,s)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}}),LF=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,m,w,g,v,b)=>class extends p{constructor(T,k){super(T,k),this._nativeContext=T,this._audioWorklet=t===void 0?void 0:{addModule:(I,R)=>t(this,I,R)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(T,k,I){return new n({length:k,numberOfChannels:T,sampleRate:I})}createBufferSource(){return new r(this)}createChannelMerger(T=6){return new s(this,{numberOfInputs:T})}createChannelSplitter(T=6){return new o(this,{numberOfOutputs:T})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(T=1){return new u(this,{maxDelayTime:T})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(T,k){return new h(this,{feedback:k,feedforward:T})}createOscillator(){return new m(this)}createPanner(){return new w(this)}createPeriodicWave(T,k,I={disableNormalization:!1}){return new g(this,{...I,imag:k,real:T})}createStereoPanner(){return new v(this)}createWaveShaper(){return new b(this)}decodeAudioData(T,k,I){return l(this._nativeContext,T).then(R=>(typeof k=="function"&&k(R),R),R=>{throw typeof I=="function"&&I(R),R})}},FF={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},UF=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...FF,...u},h=i(d,f),p=o(d),m=p?n():null;super(l,!1,h,m),this._Q=e(this,p,h.Q,tr,vr),this._detune=e(this,p,h.detune,1200*Math.log2(tr),-1200*Math.log2(tr)),this._frequency=e(this,p,h.frequency,l.sampleRate/2,0),this._gain=e(this,p,h.gain,40*Math.log10(tr),vr),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(f){throw f.code===11?r():f}if(l.length!==u.length||u.length!==d.length)throw r()}},BF=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Yn(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,d)}return s.set(c,l),u?(await t(c,a.Q,l.Q),await t(c,a.detune,l.detune),await t(c,a.frequency,l.frequency),await t(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},jF=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const s=t.get(n);if(s!==void 0)return s;try{const o=r();return o instanceof Promise?(t.set(n,o),o.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,o),o)}catch{return e.set(n,!1),!1}},$F={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},VF=(t,e,n,r,i)=>class extends t{constructor(o,a){const c=r(o),l={...$F,...a},u=n(c,l),d=i(c)?e():null;super(o,!1,u,d)}},zF=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Yn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},WF={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},HF=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u=s({...WF,...c}),d=n(l,u),f=i(l)?e():null;super(a,!1,d,f)}},GF=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Yn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},qF=t=>(e,n,r)=>t(n,e,r),JF=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},KF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},YF=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...KF,...l},f=r(u,d),h=s(u),p=h?n():null;super(c,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,h,f.offset,tr,vr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){Cl(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Js(this)&&tf(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},XF=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Yn(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,h),o!==null&&d.start(o),a!==null&&d.stop(a)}return s.set(u,d),f?await t(u,l.offset,d.offset):await r(u,l.offset,d.offset),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},QF=t=>e=>(t[0]=e,t[0]),ZF={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},e2=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u={...ZF,...c},d=n(l,u),h=i(l)?e():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},t2=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Yn(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,l)}return r.set(o,a),Wl(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},n2=()=>new DOMException("","DataCloneError"),lk=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},r2=(t,e,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=o(d)?d:s(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(c,()=>c(h))?h.decodeAudioData(f).then(p=>(lk(f).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,m)=>{const w=async()=>{try{await lk(f)}catch{}},g=v=>{m(v),w()};try{h.decodeAudioData(f,v=>{typeof v.copyFromChannel!="function"&&(l(v),MI(v)),t.add(v),w().then(()=>p(v))},v=>{g(v===null?r():v)})}catch(v){g(v)}})},i2=(t,e,n,r,i,s,o,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=s(c.context),f=a(d);if(u===l){if(e.delete(c),!f&&o(c)){const h=r(c),{outputs:p}=n(c);for(const m of p)if(rf(m)){const w=r(m[0]);t(h,w,m[1],m[2])}else{const w=i(m[0]);h.connect(w,m[1])}}}else e.set(c,u-l)},s2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},o2=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...s2,...l},f=r(u,d),h=s(u),p=h?n(d.maxDelayTime):null;super(c,!1,f,p),this._delayTime=e(this,h,f.delayTime),o(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},a2=(t,e,n,r,i)=>s=>{const o=new WeakMap,a=async(c,l)=>{let u=n(c);const d=Yn(u,l);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(l,f)}return o.set(l,u),d?await t(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=o.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},c2=t=>(e,n,r,i)=>t(e[i],s=>s[0]===n&&s[1]===r),l2=t=>"delayTime"in t,u2=(t,e,n)=>function r(i,s){const o=cp(s)?s:n(t,s);if(l2(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(c=>r([...i,o],c[0])).reduce((c,l)=>c.concat(l),[])},d2={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},f2=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...d2,...u},h=r(d,f),p=o(d),m=p?n():null;super(l,!1,h,m),this._attack=e(this,p,h.attack),this._knee=e(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,p,h.ratio),this._release=e(this,p,h.release),this._threshold=e(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},h2=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Yn(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,d)}return s.set(c,l),u?(await t(c,a.attack,l.attack),await t(c,a.knee,l.knee),await t(c,a.ratio,l.ratio),await t(c,a.release,l.release),await t(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},p2=()=>new DOMException("","EncodingError"),m2=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(u,d,f,h,p)=>{if(d===a||d===t.location.href&&f===1&&h===1)return l(),r(p),!1;if(c!==null)return c(u,d,f,h,p)},s.onerror=()=>{l(),r(new SyntaxError)},s.onload=()=>{l(),n()},s.src=a,s.type="module",i.appendChild(s)}}),g2=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=t(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(n,s,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,i)}},v2=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},y2=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},S2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},w2=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...S2,...c},d=r(l,u),f=s(l),h=f?n():null;super(a,!1,d,h),this._gain=e(this,f,d.gain,tr,vr)}get gain(){return this._gain}},b2=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Yn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,d)}return s.set(c,l),u?await t(c,a.gain,l.gain):await r(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},E2=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},k2=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},T2=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},qn=()=>new DOMException("","InvalidStateError"),_2=t=>e=>{const n=t.get(e);if(n===void 0)throw qn();return n},C2=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},cm=()=>new DOMException("","InvalidAccessError"),I2=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw cm();return e.call(t,n,r,i)})(t.getFrequencyResponse)},R2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},P2=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u=i(l),d={...R2,...c},f=e(l,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),I2(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},FI=(t,e,n,r,i,s,o,a,c,l,u)=>{const d=l.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*l[h];for(let m=1;m<i;m+=1){const w=f-m&c-1;p+=n[m]*s[w],p-=t[m]*o[w]}for(let m=i;m<r;m+=1)p+=n[m]*s[f-m&c-1];for(let m=i;m<e;m+=1)p-=t[m]*o[f-m&c-1];s[f]=l[h],o[f]=p,f=f+1&c-1,u[h]=p}return f},x2=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),s=r instanceof Float64Array?r:new Float64Array(r),o=i.length,a=s.length,c=Math.min(o,a);if(i[0]!==1){for(let p=0;p<o;p+=1)s[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const m=t.getChannelData(p),w=f.getChannelData(p);u.fill(0),d.fill(0),FI(i,o,s,a,c,u,d,0,l,m,w)}return f},N2=(t,e,n,r,i)=>(s,o)=>{const a=new WeakMap;let c=null;const l=async(u,d)=>{let f=null,h=e(u);const p=Yn(h,d);if(d.createIIRFilter===void 0?f=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(o,s)),a.set(d,f===null?h:f),f!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const w=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,w,w.destination);const g=await i(w);return x2(g,d,s,o)})()}const m=await c;return f.buffer=m,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},M2=(t,e,n,r,i,s)=>o=>(a,c)=>{const l=t.get(a);if(l===void 0){if(!o&&s(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(rf(f)){const h=r(f[0]);e(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}t.set(a,c)}else t.set(a,l+c)},O2=t=>e=>t!==null&&e instanceof t,A2=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,D2=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,L2=(t,e)=>n=>t(n)||e(n),F2=t=>e=>t!==null&&e instanceof t,U2=t=>t!==null&&t.isSecureContext,B2=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},j2={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},$2=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s);if(r(a))throw new TypeError;const c={...j2,...o},l=e(a,c);super(s,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},V2=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},z2=(t,e,n)=>class extends t{constructor(i,s){const o=n(i),a=e(o,s);super(i,!0,a,null)}},W2=(t,e,n,r,i,s)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,II.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},by=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},H2=(t,e)=>(n,r,i)=>{const s=new Set;return n.connect=(o=>(a,c=0,l=0)=>{const u=s.size===0;if(e(a))return o.call(n,a,c,l),t(s,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;o.call(n,a,c),t(s,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(o=>(a,c,l)=>{const u=s.size>0;if(a===void 0)o.apply(n),s.clear();else if(typeof a=="number"){o.call(n,a);for(const f of s)f[1]===a&&s.delete(f)}else{e(a)?o.call(n,a,c,l):o.call(n,a,c);for(const f of s)f[0]===a&&(c===void 0||f[1]===c)&&(l===void 0||f[2]===l)&&s.delete(f)}const d=s.size===0;u&&d&&i()})(n.disconnect),n},yt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},Xt=(t,e)=>{yt(t,e,"channelCount"),yt(t,e,"channelCountMode"),yt(t,e,"channelInterpretation")},uk=t=>typeof t.getFloatTimeDomainData=="function",G2=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},q2=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(Xt(i,r),!(r.maxDecibels>r.minDecibels))throw e();return yt(i,r,"fftSize"),yt(i,r,"maxDecibels"),yt(i,r,"minDecibels"),yt(i,r,"smoothingTimeConstant"),t(uk,()=>uk(i))||G2(i),i},J2=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Nt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},K2=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,s)=>{if(n)throw qn();e.call(t,r,i,s),n=!0}})(t.start)},JS=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},KS=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},Y2=(t,e,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=d.createBufferSource();return Xt(h,f),Nt(h,f,"playbackRate"),yt(h,f,"buffer"),yt(h,f,"loop"),yt(h,f,"loopEnd"),yt(h,f,"loopStart"),e(n,()=>n(d))||K2(h),e(r,()=>r(d))||c(h),e(i,()=>i(d))||l(h,d),e(s,()=>s(d))||JS(h),e(o,()=>o(d))||u(h,d),e(a,()=>a(d))||KS(h),t(d,h),h},X2=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,Q2=(t,e)=>(n,r,i)=>{const s=n.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const o=t(n,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{s.channelCount=c}catch(l){if(c>s.maxChannelCount)throw l}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelCountMode=c}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},Z2=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,e3=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),UI=(t,e)=>{const n=t.createBiquadFilter();return Xt(n,e),Nt(n,e,"Q"),Nt(n,e,"detune"),Nt(n,e,"frequency"),Nt(n,e,"gain"),yt(n,e,"type"),n},t3=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),Xt(i,r),i},n3=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw qn()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw qn()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw qn()}})},YS=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Xt(n,e),n3(n),n},r3=(t,e,n,r,i)=>(s,o)=>{if(s.createConstantSource===void 0)return n(s,o);const a=s.createConstantSource();return Xt(a,o),Nt(a,o,"offset"),e(r,()=>r(s))||JS(a),e(i,()=>i(s))||KS(a),t(s,a),a},Hl=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),i3=(t,e,n,r)=>(i,{offset:s,...o})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...o,gain:s}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},f=()=>c.connect(l),h=()=>c.disconnect(l);return t(i,c),r(Hl(d,l),f,h)},s3=(t,e)=>(n,r)=>{const i=n.createConvolver();if(Xt(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),yt(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",s=>()=>s.call(i),s=>o=>{if(o>2)throw t();return s.call(i,o)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",s=>()=>s.call(i),s=>o=>{if(o==="max")throw t();return s.call(i,o)}),i},BI=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Xt(n,e),Nt(n,e,"delayTime"),n},o3=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(Xt(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Nt(r,n,"attack"),Nt(r,n,"knee"),Nt(r,n,"ratio"),Nt(r,n,"release"),Nt(r,n,"threshold"),r},bi=(t,e)=>{const n=t.createGain();return Xt(n,e),Nt(n,e,"gain"),n},a3=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return Xt(i,r),i};function c3(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function l3(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function dk(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=l3(n,e),n[0]+=t[r];return n}const u3=(t,e,n,r)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=e3(s,i.sampleRate),f=l instanceof Float64Array?l:new Float64Array(l),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,m=h.length,w=Math.min(p,m);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(m===0||m>20)throw r();if(h[0]===0)throw e();if(f[0]!==1){for(let R=0;R<m;R+=1)h[R]/=f[0];for(let R=1;R<p;R+=1)f[R]/=f[0]}const g=n(i,d,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=c;const v=32,b=[],C=[],T=[];for(let R=0;R<o;R+=1){b.push(0);const N=new Float32Array(v),M=new Float32Array(v);N.fill(0),M.fill(0),C.push(N),T.push(M)}g.onaudioprocess=R=>{const N=R.inputBuffer,M=R.outputBuffer,L=N.numberOfChannels;for(let F=0;F<L;F+=1){const W=N.getChannelData(F),z=M.getChannelData(F);b[F]=FI(f,p,h,m,w,C[F],T[F],b[F],v,W,z)}};const k=i.sampleRate/2;return Hl({get bufferSize(){return d},get channelCount(){return g.channelCount},set channelCount(R){g.channelCount=R},get channelCountMode(){return g.channelCountMode},set channelCountMode(R){g.channelCountMode=R},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(R){g.channelInterpretation=R},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(...R){return g.addEventListener(R[0],R[1],R[2])},dispatchEvent(...R){return g.dispatchEvent(R[0])},getFrequencyResponse(R,N,M){if(R.length!==N.length||N.length!==M.length)throw t();const L=R.length;for(let F=0;F<L;F+=1){const W=-Math.PI*(R[F]/k),z=[Math.cos(W),Math.sin(W)],Y=dk(h,z),K=dk(f,z),re=c3(Y,K);N[F]=Math.sqrt(re[0]*re[0]+re[1]*re[1]),M[F]=Math.atan2(re[1],re[0])}},removeEventListener(...R){return g.removeEventListener(R[0],R[1],R[2])}},g)},d3=(t,e)=>t.createMediaElementSource(e.mediaElement),f3=(t,e)=>{const n=t.createMediaStreamDestination();return Xt(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},h3=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,o)=>s.id<o.id?-1:s.id>o.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},p3=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},m3=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,g3=(t,e,n,r,i,s)=>(o,a)=>{const c=o.createOscillator();return Xt(c,a),Nt(c,a,"detune"),Nt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):yt(c,a,"type"),e(n,()=>n(o))||JS(c),e(r,()=>r(o))||s(c,o),e(i,()=>i(o))||KS(c),t(o,c),c},v3=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(Xt(r,n),Nt(r,n,"orientationX"),Nt(r,n,"orientationY"),Nt(r,n,"orientationZ"),Nt(r,n,"positionX"),Nt(r,n,"positionY"),Nt(r,n,"positionZ"),yt(r,n,"coneInnerAngle"),yt(r,n,"coneOuterAngle"),yt(r,n,"coneOuterGain"),yt(r,n,"distanceModel"),yt(r,n,"maxDistance"),yt(r,n,"panningModel"),yt(r,n,"refDistance"),yt(r,n,"rolloffFactor"),r)},y3=(t,e,n,r,i,s,o,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:m,orientationX:w,orientationY:g,orientationZ:v,panningModel:b,positionX:C,positionY:T,positionZ:k,refDistance:I,rolloffFactor:R,...N})=>{const M=u.createPanner();if(N.channelCount>2||N.channelCountMode==="max")throw o();Xt(M,N);const L={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},F=n(u,{...L,channelInterpretation:"speakers",numberOfInputs:6}),W=r(u,{...N,gain:1}),z=r(u,{...L,gain:1}),Y=r(u,{...L,gain:0}),K=r(u,{...L,gain:0}),re=r(u,{...L,gain:0}),H=r(u,{...L,gain:0}),ee=r(u,{...L,gain:0}),oe=i(u,256,6,1),q=s(u,{...L,curve:new Float32Array([1,1]),oversample:"none"});let ie=[w,g,v],ke=[C,T,k];const _e=new Float32Array(1);oe.onaudioprocess=({inputBuffer:ce})=>{const Qt=[c(ce,_e,0),c(ce,_e,1),c(ce,_e,2)];Qt.some((Mt,Zn)=>Mt!==ie[Zn])&&(M.setOrientation(...Qt),ie=Qt);const Qn=[c(ce,_e,3),c(ce,_e,4),c(ce,_e,5)];Qn.some((Mt,Zn)=>Mt!==ke[Zn])&&(M.setPosition(...Qn),ke=Qn)},Object.defineProperty(Y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(K.gain,"defaultValue",{get:()=>0}),Object.defineProperty(re.gain,"defaultValue",{get:()=>0}),Object.defineProperty(H.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0});const me={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(ce){if(ce>2)throw o();W.channelCount=ce,M.channelCount=ce},get channelCountMode(){return M.channelCountMode},set channelCountMode(ce){if(ce==="max")throw o();W.channelCountMode=ce,M.channelCountMode=ce},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(ce){W.channelInterpretation=ce,M.channelInterpretation=ce},get coneInnerAngle(){return M.coneInnerAngle},set coneInnerAngle(ce){M.coneInnerAngle=ce},get coneOuterAngle(){return M.coneOuterAngle},set coneOuterAngle(ce){M.coneOuterAngle=ce},get coneOuterGain(){return M.coneOuterGain},set coneOuterGain(ce){if(ce<0||ce>1)throw e();M.coneOuterGain=ce},get context(){return M.context},get distanceModel(){return M.distanceModel},set distanceModel(ce){M.distanceModel=ce},get inputs(){return[W]},get maxDistance(){return M.maxDistance},set maxDistance(ce){if(ce<0)throw new RangeError;M.maxDistance=ce},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get orientationX(){return z.gain},get orientationY(){return Y.gain},get orientationZ(){return K.gain},get panningModel(){return M.panningModel},set panningModel(ce){M.panningModel=ce},get positionX(){return re.gain},get positionY(){return H.gain},get positionZ(){return ee.gain},get refDistance(){return M.refDistance},set refDistance(ce){if(ce<0)throw new RangeError;M.refDistance=ce},get rolloffFactor(){return M.rolloffFactor},set rolloffFactor(ce){if(ce<0)throw new RangeError;M.rolloffFactor=ce},addEventListener(...ce){return W.addEventListener(ce[0],ce[1],ce[2])},dispatchEvent(...ce){return W.dispatchEvent(ce[0])},removeEventListener(...ce){return W.removeEventListener(ce[0],ce[1],ce[2])}};d!==me.coneInnerAngle&&(me.coneInnerAngle=d),f!==me.coneOuterAngle&&(me.coneOuterAngle=f),h!==me.coneOuterGain&&(me.coneOuterGain=h),p!==me.distanceModel&&(me.distanceModel=p),m!==me.maxDistance&&(me.maxDistance=m),w!==me.orientationX.value&&(me.orientationX.value=w),g!==me.orientationY.value&&(me.orientationY.value=g),v!==me.orientationZ.value&&(me.orientationZ.value=v),b!==me.panningModel&&(me.panningModel=b),C!==me.positionX.value&&(me.positionX.value=C),T!==me.positionY.value&&(me.positionY.value=T),k!==me.positionZ.value&&(me.positionZ.value=k),I!==me.refDistance&&(me.refDistance=I),R!==me.rolloffFactor&&(me.rolloffFactor=R),(ie[0]!==1||ie[1]!==0||ie[2]!==0)&&M.setOrientation(...ie),(ke[0]!==0||ke[1]!==0||ke[2]!==0)&&M.setPosition(...ke);const nt=()=>{W.connect(M),t(W,q,0,0),q.connect(z).connect(F,0,0),q.connect(Y).connect(F,0,1),q.connect(K).connect(F,0,2),q.connect(re).connect(F,0,3),q.connect(H).connect(F,0,4),q.connect(ee).connect(F,0,5),F.connect(oe).connect(u.destination)},gt=()=>{W.disconnect(M),a(W,q,0,0),q.disconnect(z),z.disconnect(F),q.disconnect(Y),Y.disconnect(F),q.disconnect(K),K.disconnect(F),q.disconnect(re),re.disconnect(F),q.disconnect(H),H.disconnect(F),q.disconnect(ee),ee.disconnect(F),F.disconnect(oe),oe.disconnect(u.destination)};return l(Hl(me,M),nt,gt)},S3=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),o=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},lm=(t,e,n,r)=>t.createScriptProcessor(e,n,r),w3=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const s=n.createStereoPanner();return Xt(s,r),Nt(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:o=>{if(o!==i)throw e()}}),s},b3=(t,e,n,r,i,s)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(p,m,w,g)=>{const v=new Float32Array(16385),b=new Float32Array(16385);for(let N=0;N<16385;N+=1){const M=N/16384*c;v[N]=Math.cos(M),b[N]=Math.sin(M)}const C=n(p,{...l,gain:0}),T=r(p,{...u,curve:v}),k=r(p,{...u,curve:a}),I=n(p,{...l,gain:0}),R=r(p,{...u,curve:b});return{connectGraph(){m.connect(C),m.connect(k.inputs===void 0?k:k.inputs[0]),m.connect(I),k.connect(w),w.connect(T.inputs===void 0?T:T.inputs[0]),w.connect(R.inputs===void 0?R:R.inputs[0]),T.connect(C.gain),R.connect(I.gain),C.connect(g,0,0),I.connect(g,0,1)},disconnectGraph(){m.disconnect(C),m.disconnect(k.inputs===void 0?k:k.inputs[0]),m.disconnect(I),k.disconnect(w),w.disconnect(T.inputs===void 0?T:T.inputs[0]),w.disconnect(R.inputs===void 0?R:R.inputs[0]),T.disconnect(C.gain),R.disconnect(I.gain),C.disconnect(g,0,0),I.disconnect(g,0,1)}}},f=(p,m,w,g)=>{const v=new Float32Array(16385),b=new Float32Array(16385),C=new Float32Array(16385),T=new Float32Array(16385),k=Math.floor(16385/2);for(let re=0;re<16385;re+=1)if(re>k){const H=(re-k)/(16384-k)*c;v[re]=Math.cos(H),b[re]=Math.sin(H),C[re]=0,T[re]=1}else{const H=re/(16384-k)*c;v[re]=1,b[re]=0,C[re]=Math.cos(H),T[re]=Math.sin(H)}const I=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),R=n(p,{...l,gain:0}),N=r(p,{...u,curve:v}),M=n(p,{...l,gain:0}),L=r(p,{...u,curve:b}),F=r(p,{...u,curve:a}),W=n(p,{...l,gain:0}),z=r(p,{...u,curve:C}),Y=n(p,{...l,gain:0}),K=r(p,{...u,curve:T});return{connectGraph(){m.connect(I),m.connect(F.inputs===void 0?F:F.inputs[0]),I.connect(R,0),I.connect(M,0),I.connect(W,1),I.connect(Y,1),F.connect(w),w.connect(N.inputs===void 0?N:N.inputs[0]),w.connect(L.inputs===void 0?L:L.inputs[0]),w.connect(z.inputs===void 0?z:z.inputs[0]),w.connect(K.inputs===void 0?K:K.inputs[0]),N.connect(R.gain),L.connect(M.gain),z.connect(W.gain),K.connect(Y.gain),R.connect(g,0,0),W.connect(g,0,0),M.connect(g,0,1),Y.connect(g,0,1)},disconnectGraph(){m.disconnect(I),m.disconnect(F.inputs===void 0?F:F.inputs[0]),I.disconnect(R,0),I.disconnect(M,0),I.disconnect(W,1),I.disconnect(Y,1),F.disconnect(w),w.disconnect(N.inputs===void 0?N:N.inputs[0]),w.disconnect(L.inputs===void 0?L:L.inputs[0]),w.disconnect(z.inputs===void 0?z:z.inputs[0]),w.disconnect(K.inputs===void 0?K:K.inputs[0]),N.disconnect(R.gain),L.disconnect(M.gain),z.disconnect(W.gain),K.disconnect(Y.gain),R.disconnect(g,0,0),W.disconnect(g,0,0),M.disconnect(g,0,1),Y.disconnect(g,0,1)}}},h=(p,m,w,g,v)=>{if(m===1)return d(p,w,g,v);if(m===2)return f(p,w,g,v);throw i()};return(p,{channelCount:m,channelCountMode:w,pan:g,...v})=>{if(w==="max")throw i();const b=t(p,{...v,channelCount:1,channelCountMode:w,numberOfInputs:2}),C=n(p,{...v,channelCount:m,channelCountMode:w,gain:1}),T=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g});let{connectGraph:k,disconnectGraph:I}=h(p,m,C,T,b);Object.defineProperty(T.gain,"defaultValue",{get:()=>0}),Object.defineProperty(T.gain,"maxValue",{get:()=>1}),Object.defineProperty(T.gain,"minValue",{get:()=>-1});const R={get bufferSize(){},get channelCount(){return C.channelCount},set channelCount(F){C.channelCount!==F&&(N&&I(),{connectGraph:k,disconnectGraph:I}=h(p,F,C,T,b),N&&k()),C.channelCount=F},get channelCountMode(){return C.channelCountMode},set channelCountMode(F){if(F==="clamped-max"||F==="max")throw i();C.channelCountMode=F},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(F){C.channelInterpretation=F},get context(){return C.context},get inputs(){return[C]},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get pan(){return T.gain},addEventListener(...F){return C.addEventListener(F[0],F[1],F[2])},dispatchEvent(...F){return C.dispatchEvent(F[0])},removeEventListener(...F){return C.removeEventListener(F[0],F[1],F[2])}};let N=!1;const M=()=>{k(),N=!0},L=()=>{I(),N=!1};return s(Hl(R,b),M,L)}},E3=(t,e,n,r,i,s,o)=>(a,c)=>{const l=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);Xt(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();yt(l,{curve:u},"curve"),yt(l,c,"oversample");let d=null,f=!1;return o(l,"curve",m=>()=>m.call(l),m=>w=>(m.call(l,w),f&&(r(w)&&d===null?d=t(a,l):!r(w)&&d!==null&&(d(),d=null)),w)),i(l,()=>{f=!0,r(l.curve)&&(d=t(a,l))},()=>{f=!1,d!==null&&(d(),d=null)})},k3=(t,e,n,r,i)=>(s,{curve:o,oversample:a,...c})=>{const l=s.createWaveShaper(),u=s.createWaveShaper();Xt(l,c),Xt(u,c);const d=n(s,{...c,gain:1}),f=n(s,{...c,gain:-1}),h=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let m=null,w=!1,g=null;const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(T){d.channelCount=T,f.channelCount=T,l.channelCount=T,h.channelCount=T,u.channelCount=T,p.channelCount=T},get channelCountMode(){return l.channelCountMode},set channelCountMode(T){d.channelCountMode=T,f.channelCountMode=T,l.channelCountMode=T,h.channelCountMode=T,u.channelCountMode=T,p.channelCountMode=T},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(T){d.channelInterpretation=T,f.channelInterpretation=T,l.channelInterpretation=T,h.channelInterpretation=T,u.channelInterpretation=T,p.channelInterpretation=T},get context(){return l.context},get curve(){return g},set curve(T){if(T!==null&&T.length<2)throw e();if(T===null)l.curve=T,u.curve=T;else{const k=T.length,I=new Float32Array(k+2-k%2),R=new Float32Array(k+2-k%2);I[0]=T[0],R[0]=-T[k-1];const N=Math.ceil((k+1)/2),M=(k+1)/2-1;for(let L=1;L<N;L+=1){const F=L/N*M,W=Math.floor(F),z=Math.ceil(F);I[L]=W===z?T[W]:(1-(F-W))*T[W]+(1-(z-F))*T[z],R[L]=W===z?-T[k-1-W]:-((1-(F-W))*T[k-1-W])-(1-(z-F))*T[k-1-z]}I[N]=k%2===1?T[N-1]:(T[N-2]+T[N-1])/2,l.curve=I,u.curve=R}g=T,w&&(r(g)&&m===null?m=t(s,d):m!==null&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(T){l.oversample=T,u.oversample=T},addEventListener(...T){return d.addEventListener(T[0],T[1],T[2])},dispatchEvent(...T){return d.dispatchEvent(T[0])},removeEventListener(...T){return d.removeEventListener(T[0],T[1],T[2])}};o!==null&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);const b=()=>{d.connect(l).connect(h),d.connect(f).connect(u).connect(p).connect(h),w=!0,r(g)&&(m=t(s,d))},C=()=>{d.disconnect(l),l.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),w=!1,m!==null&&(m(),m=null)};return i(Hl(v,h),b,C)},Wr=()=>new DOMException("","NotSupportedError"),T3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},_3=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...T3,...l},f=n(u,d),h=s(u),p=h?r():null,m=c.sampleRate/2;super(c,!1,f,p),this._detune=e(this,h,f.detune,153600,-153600),this._frequency=e(this,h,f.frequency,m,-m),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){Cl(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Js(this)&&tf(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},C3=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null,c=null;const l=async(u,d)=>{let f=n(u);const h=Yn(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=e(d,p),a!==null&&f.start(a),c!==null&&f.stop(c)}return s.set(d,f),h?(await t(d,u.detune,f.detune),await t(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){c=u},render(u,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},I3={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},R3=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...I3,...l},f=n(u,d),h=s(u),p=h?r():null;super(c,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,h,f.orientationX,tr,vr),this._orientationY=e(this,h,f.orientationY,tr,vr),this._orientationZ=e(this,h,f.orientationZ,tr,vr),this._positionX=e(this,h,f.positionX,tr,vr),this._positionY=e(this,h,f.positionY,tr,vr),this._positionZ=e(this,h,f.positionZ,tr,vr),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},P3=(t,e,n,r,i,s,o,a,c,l)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let m=null,w=s(h);const g={channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation},v={...g,coneInnerAngle:w.coneInnerAngle,coneOuterAngle:w.coneOuterAngle,coneOuterGain:w.coneOuterGain,distanceModel:w.distanceModel,maxDistance:w.maxDistance,panningModel:w.panningModel,refDistance:w.refDistance,rolloffFactor:w.rolloffFactor},b=Yn(w,p);if("bufferSize"in w)m=r(p,{...g,gain:1});else if(!b){const C={...v,orientationX:w.orientationX.value,orientationY:w.orientationY.value,orientationZ:w.orientationZ.value,positionX:w.positionX.value,positionY:w.positionY.value,positionZ:w.positionZ.value};w=i(p,C)}if(u.set(p,m===null?w:m),m!==null){if(d===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const L=new o(6,h.context.length,p.sampleRate),F=e(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});F.connect(L.destination),d=(async()=>{const W=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(z,Y)=>{const K=n(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Y===0?1:0});return await a(L,z,K.offset),K}));for(let z=0;z<6;z+=1)W[z].connect(F,0,z),W[z].start(0);return l(L)})()}const C=await d,T=r(p,{...g,gain:1});await c(h,p,T);const k=[];for(let L=0;L<C.numberOfChannels;L+=1)k.push(C.getChannelData(L));let I=[k[0][0],k[1][0],k[2][0]],R=[k[3][0],k[4][0],k[5][0]],N=r(p,{...g,gain:1}),M=i(p,{...v,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:R[0],positionY:R[1],positionZ:R[2]});T.connect(N).connect(M.inputs[0]),M.connect(m);for(let L=128;L<C.length;L+=128){const F=[k[0][L],k[1][L],k[2][L]],W=[k[3][L],k[4][L],k[5][L]];if(F.some((z,Y)=>z!==I[Y])||W.some((z,Y)=>z!==R[Y])){I=F,R=W;const z=L/p.sampleRate;N.gain.setValueAtTime(0,z),N=r(p,{...g,gain:0}),M=i(p,{...v,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:R[0],positionY:R[1],positionZ:R[2]}),N.gain.setValueAtTime(1,z),T.connect(N).connect(M.inputs[0]),M.connect(m)}}return m}return b?(await t(p,h.orientationX,w.orientationX),await t(p,h.orientationY,w.orientationY),await t(p,h.orientationZ,w.orientationZ),await t(p,h.positionX,w.positionX),await t(p,h.positionY,w.positionY),await t(p,h.positionZ,w.positionZ)):(await a(p,h.orientationX,w.orientationX),await a(p,h.orientationY,w.orientationY),await a(p,h.orientationZ,w.orientationZ),await a(p,h.positionX,w.positionX),await a(p,h.positionY,w.positionY),await a(p,h.positionZ,w.positionZ)),Wl(w)?await c(h,p,w.inputs[0]):await c(h,p,w),w};return{render(h,p){const m=u.get(p);return m!==void 0?Promise.resolve(m):f(h,p)}}},x3={disableNormalization:!1},N3=(t,e,n,r)=>class jI{constructor(s,o){const a=e(s),c=r({...x3,...o}),l=t(a,c);return n.add(l),l}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===jI.prototype||n.has(s)}},M3=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),O3=(t,e,n)=>async(r,i,s)=>{const o=t(r);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const f=await e(l).render(l,i),h=r.context.destination;!n(l)&&(r!==h||!n(r))&&f.connect(s,u,c)})).reduce((a,c)=>[...a,...c],[]))},A3=(t,e,n)=>async(r,i,s)=>{const o=e(r);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const u=await t(a).render(a,i);n(a)||u.connect(s,c)}))},D3=(t,e,n,r)=>i=>t(by,()=>by(i))?Promise.resolve(t(r,r)).then(s=>{if(!s){const o=n(i,512,0,1);i.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>i.currentTime,o.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const o=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{o.disconnect(),s(a.renderedBuffer)},o.connect(i.destination),i.startRendering()}),L3=t=>(e,n)=>t.set(e,n),F3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},U3=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...F3,...c},d=n(l,u),f=s(l),h=f?r():null;super(a,!1,d,h),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},B3=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Yn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,d)}return s.set(c,l),u?await t(c,a.pan,l.pan):await r(c,a.pan,l.pan),Wl(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},j3=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},$3=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let s=!1,o=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return s&&!o},V3=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},z3=()=>new DOMException("","UnknownError"),W3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},H3=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...W3,...l},f=n(u,d),p=s(u)?r():null;super(c,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},G3=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Yn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,l)}return r.set(o,a),Wl(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},q3=()=>typeof window>"u"?null:window,J3=(t,e)=>n=>{n.copyFromChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)r[d]=l[d+o]},n.copyToChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)l[d+o]=r[d]}},K3=t=>e=>{e.copyFromChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyToChannel)},Y3=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const s=i.call(e);return s===r?null:s},i=>s=>i.call(e,s===null?r:s))},X3=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},$I=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),VI=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},sf=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:o}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(s),set:r(o)})},Q3=t=>({...t,channelCount:t.numberOfOutputs}),Z3=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},zI=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;zI(t,e,n+1e-7)}},eU=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},tU=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},nU=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},XS=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},WI=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},QS=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},rU=t=>{t.start=(e=>(n=0,r=0,i)=>{const s=t.buffer,o=s===null?r:Math.min(s.duration,r);s!==null&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,i)})(t.start)},HI=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Hl(t,n),t.stop=(i=>{let s=!1;return(o=0)=>{if(s)try{i.call(t,o)}catch{n.gain.setValueAtTime(0,o)}else i.call(t,o),s=!0}})(t.stop)},of=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},iU=X5(rc),sU=rF(rc),oU=c2(am),GI=new WeakMap,aU=k2(GI),co=jF(new Map,new WeakMap),as=q3(),qI=q2(co,nc),JI=E2(wr),Mn=O3(wr,JI,za),cU=aF(qI,Tt,Mn),mt=_2(II),ic=m3(as),lt=F2(ic),KI=new WeakMap,YI=g2(of),af=X2(as),XI=O2(af),QI=A2(as),lU=D2(as),Ey=Z2(as),jt=OF(Q5(kI),nF(iU,sU,lp,oU,up,wr,aU,ef,Tt,rc,Js,za,gh),co,M2(vy,up,wr,Tt,Ed,Js),nc,cm,Wr,i2(lp,vy,wr,Tt,Ed,mt,Js,lt),u2(KI,wr,fa),YI,mt,XI,QI,lU,lt,Ey),uU=oF(jt,cU,nc,qI,mt,lt),ZI=new WeakSet,fk=J2(as),eR=QF(new Uint32Array(1)),tR=J3(eR,nc),nR=K3(eR),dU=lF(ZI,co,Wr,fk,ic,j3(fk),tR,nR),um=iF(bi),rR=A3(JI,nf,za),lo=qF(rR),cf=Y2(um,co,eU,tU,nU,XS,WI,QS,rU,Y3(sf),HI),uo=M3(T2(nf),rR),fU=fF(lo,cf,Tt,uo,Mn),ls=AF(Z5(_I),KI,CI,DF,H5,G5,q5,J5,K5,py,bI,af,zI),hU=dF(jt,fU,ls,qn,cf,mt,lt,of),pU=EF(jt,kF,nc,qn,Q2(bi,sf),mt,lt,Mn),mU=BF(lo,UI,Tt,uo,Mn),sc=L3(GI),gU=UF(jt,ls,mU,cm,UI,mt,lt,sc),Gl=H2(rc,QI),vU=X3(qn,Gl),ql=t3(af,vU),yU=zF(ql,Tt,Mn),SU=VF(jt,yU,ql,mt,lt),wU=GF(YS,Tt,Mn),bU=HF(jt,wU,YS,mt,lt,Q3),EU=i3(um,cf,bi,Gl),dm=r3(um,co,EU,XS,QS),kU=XF(lo,dm,Tt,uo,Mn),TU=YF(jt,ls,kU,dm,mt,lt,of),iR=s3(Wr,sf),_U=t2(iR,Tt,Mn),CU=e2(jt,_U,iR,mt,lt,sc),IU=a2(lo,BI,Tt,uo,Mn),RU=o2(jt,ls,IU,BI,mt,lt,sc),sR=o3(Wr),PU=h2(lo,sR,Tt,uo,Mn),xU=f2(jt,ls,PU,sR,Wr,mt,lt,sc),NU=b2(lo,bi,Tt,uo,Mn),MU=w2(jt,ls,NU,bi,mt,lt),OU=u3(cm,qn,lm,Wr),oR=D3(co,bi,lm,V3(bi,ic)),AU=N2(cf,Tt,ic,Mn,oR),DU=a3(OU),LU=P2(jt,DU,AU,mt,lt,sc),FU=TF(ls,ql,dm,lm,Wr,$I,lt,sf),UU=new WeakMap,BU=W2(pU,FU,YI,lt,UU,of),aR=g3(um,co,XS,WI,QS,HI),jU=C3(lo,aR,Tt,uo,Mn),$U=_3(jt,ls,aR,jU,mt,lt,of),cR=JF(cf),VU=k3(cR,qn,bi,VI,Gl),fm=E3(cR,qn,VU,VI,Gl,af,sf),zU=y3(lp,qn,ql,bi,lm,fm,Wr,up,$I,Gl),lR=v3(zU),WU=P3(lo,ql,dm,bi,lR,Tt,ic,uo,Mn,oR),HU=R3(jt,ls,lR,WU,mt,lt,sc),GU=S3(nc),qU=N3(GU,mt,new WeakSet,Z3),JU=b3(ql,YS,bi,fm,Wr,Gl),uR=w3(JU,Wr),KU=B3(lo,uR,Tt,uo,Mn),YU=U3(jt,ls,uR,KU,mt,lt),XU=G3(fm,Tt,Mn),QU=H3(jt,qn,fm,XU,mt,lt,sc),ZU=U2(as),eB=v2(as),tB=new WeakMap,nB=C2(tB,ic),rB=ZU?tF(co,Wr,m2(as),eB,y2(Y5),mt,nB,lt,Ey,new WeakMap,new WeakMap,$3(Ey,ic),as):void 0,iB=L2(XI,lt),sB=r2(ZI,co,n2,p2,new WeakSet,mt,iB,Sy,by,tR,nR),oB=LF(rB,uU,dU,hU,gU,SU,bU,TU,CU,sB,RU,xU,MU,LU,BU,$U,HU,qU,YU,QU),aB=B2(jt,d3,mt,lt),cB=$2(jt,f3,mt,lt),lB=V2(jt,h3,mt,lt),uB=p3(qn,lt),dB=z2(jt,uB,mt),fB=bF(oB,qn,Wr,z3,aB,cB,lB,dB,af);var mv;let hB=(mv=class{static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getAudioBufferFromCache(e,n,r){try{const i=await n.match(e);if(i){const s=await i.arrayBuffer();return r.decodeAudioData(s)}return null}catch(i){throw console.error("Failed to get audio data from cache:",i),i}}static async fetchAndCacheAudioBuffer(e,n,r){try{const i=await fetch(e),s=i.clone();n.put(e,s);const o=await i.arrayBuffer();return r.decodeAudioData(o)}catch(i){throw console.error("Failed to fetch and cache audio data:",i),i}}static async getAudioBuffer(e,n){const r=await this.openCache();let i=this.pendingRequests.get(e);return i||await this.getAudioBufferFromCache(e,r,n)||(i=this.fetchAndCacheAudioBuffer(e,r,n),this.pendingRequests.set(e,i),i)}},V(mv,"pendingRequests",new Map),mv);var dR=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t))(dR||{});class pB{constructor(e){V(this,"context");V(this,"globalGainNode");V(this,"listener");V(this,"prevVolume",1);V(this,"finalizationRegistry");this.context=e||new fB,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async createSound(e,n="Buffer"){if(e instanceof AudioBuffer)return Promise.resolve(new jf("",e,this.context,this.globalGainNode,"Buffer"));const r=e;if(n==="HTML"){const i=new Audio;return i.src=r,i.crossOrigin="anonymous",new jf(r,void 0,this.context,this.globalGainNode,"HTML")}return hB.getAudioBuffer(r,this.context).then(i=>new jf(r,i,this.context,this.globalGainNode,n))}async createGroup(e){const n=new hk;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e){const n=new hk;return(await Promise.all(e.map(r=>this.createSound(r)))).forEach(r=>n.addSound(r)),n}async createStream(e){return await SB(e,this.context),new jf(e,void 0,this.context,this.globalGainNode,"Streaming")}createBiquadFilter(e){const n=this.context.createBiquadFilter();return n.type=e,n}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new vB(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,s,o]=n,[a,c,l]=r;this.listener.forwardX.setValueAtTime(i,this.context.currentTime),this.listener.forwardY.setValueAtTime(s,this.context.currentTime),this.listener.forwardZ.setValueAtTime(o,this.context.currentTime),this.listener.upX.setValueAtTime(a,this.context.currentTime),this.listener.upY.setValueAtTime(c,this.context.currentTime),this.listener.upZ.setValueAtTime(l,this.context.currentTime)}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.setValueAtTime(n,this.context.currentTime),this.listener.upY.setValueAtTime(r,this.context.currentTime),this.listener.upZ.setValueAtTime(i,this.context.currentTime)}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.setValueAtTime(n,this.context.currentTime),this.listener.forwardY.setValueAtTime(r,this.context.currentTime),this.listener.forwardZ.setValueAtTime(i,this.context.currentTime)}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e;this.listener.positionX.setValueAtTime(n,this.context.currentTime),this.listener.positionY.setValueAtTime(r,this.context.currentTime),this.listener.positionZ.setValueAtTime(i,this.context.currentTime)}}let hm=class{constructor(){V(this,"filters",[])}addFilter(e){this.filters.push(e)}removeFilter(e){this.filters=this.filters.filter(n=>n!==e)}applyFilters(e){return this.filters.reduce((n,r)=>(n.connect(r),r),e),this.filters.length>0?this.filters[this.filters.length-1]:e}},jf=class extends hm{constructor(n,r,i,s,o="Buffer"){super();V(this,"buffer");V(this,"context");V(this,"playbacks",[]);V(this,"globalGainNode");V(this,"_position",[0,0,0]);V(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});V(this,"loopCount",0);V(this,"_playbackRate",1);V(this,"_volume",1);this.url=n,this.type=o,this.buffer=r,this.context=i,this.globalGainNode=s,this._position=[0,0,0]}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const s=new Audio;s.crossOrigin="anonymous",s.src=this.url,s.preload="auto",n=this.context.createMediaElementSource(s)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new mB(n,r,this.context,this.loopCount);return i.volume=this.volume,i.playbackRate=this.playbackRate,this.filters.forEach(s=>i.addFilter(s)),i.threeDOptions=this.threeDOptions,i.position=this.position,this.playbacks.push(i),[i]}play(){const n=this.preplay();return n.forEach(r=>r.play()),n}stop(){this.playbacks.forEach(n=>n.stop())}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}seek(n){this.playbacks.forEach(r=>r.seek(n))}set position(n){this._threeDOptions.positionX=n[0],this._threeDOptions.positionY=n[1],this._threeDOptions.positionZ=n[2],this.playbacks.forEach(r=>r.position=n)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}get threeDOptions(){return this._threeDOptions}set threeDOptions(n){this._threeDOptions={...this._threeDOptions,...n},this.playbacks.forEach(r=>r.threeDOptions=this._threeDOptions)}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.sourceLoop=!0),this.loopCount)}addFilter(n){super.addFilter(n),this.playbacks.forEach(r=>r.addFilter(n))}removeFilter(n){super.removeFilter(n),this.playbacks.forEach(r=>r.removeFilter(n))}get volume(){return this._volume}set volume(n){this._volume=n,this.playbacks.forEach(r=>r.volume=n)}isPlaying(){return this.playbacks.some(n=>n.isPlaying())}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}},mB=class extends hm{constructor(n,r,i,s=0){super();V(this,"context");V(this,"source");V(this,"gainNode");V(this,"panner");V(this,"loopCount",0);V(this,"currentLoop",0);V(this,"buffer");V(this,"playing",!1);this.loopCount=s,this.source=n,"buffer"in n&&n.buffer&&(this.buffer=n.buffer),"mediaElement"in n&&n.mediaElement?n.mediaElement.onended=this.handleLoop.bind(this):"onended"in n&&(n.onended=this.handleLoop.bind(this)),this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner),this.panner.connect(this.gainNode),this.refreshFilters()}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(n){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n)}handleLoop(){this.buffer?(this.source=this.context.createBufferSource(),this.source.buffer=this.buffer):this.seek(0),this.loopCount==="infinite"||this.currentLoop<this.loopCount?(this.currentLoop++,this.playing&&this.play()):this.playing=!1}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():"start"in this.source&&this.source.start&&this.source.start(),this.playing=!0,[this]}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");return{coneInnerAngle:this.panner.coneInnerAngle,coneOuterAngle:this.panner.coneOuterAngle,coneOuterGain:this.panner.coneOuterGain,distanceModel:this.panner.distanceModel,maxDistance:this.panner.maxDistance,channelCount:this.panner.channelCount,channelCountMode:this.panner.channelCountMode,channelInterpretation:this.panner.channelInterpretation,panningModel:this.panner.panningModel,refDistance:this.panner.refDistance,rolloffFactor:this.panner.rolloffFactor,positionX:this.panner.positionX.value,positionY:this.panner.positionY.value,positionZ:this.panner.positionZ.value,orientationX:this.panner.orientationX.value,orientationY:this.panner.orientationY.value,orientationZ:this.panner.orientationZ.value}}set threeDOptions(n){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");this.panner.coneInnerAngle=n.coneInnerAngle||this.panner.coneInnerAngle,this.panner.coneOuterAngle=n.coneOuterAngle||this.panner.coneOuterAngle,this.panner.coneOuterGain=n.coneOuterGain||this.panner.coneOuterGain,this.panner.distanceModel=n.distanceModel||this.panner.distanceModel,this.panner.maxDistance=n.maxDistance||this.panner.maxDistance,this.panner.channelCount=n.channelCount||this.panner.channelCount,this.panner.channelCountMode=n.channelCountMode||this.panner.channelCountMode,this.panner.channelInterpretation=n.channelInterpretation||this.panner.channelInterpretation,this.panner.panningModel=n.panningModel||this.panner.panningModel,this.panner.refDistance=n.refDistance||this.panner.refDistance,this.panner.rolloffFactor=n.rolloffFactor||this.panner.rolloffFactor,this.panner.positionX.value=n.positionX||this.panner.positionX.value,this.panner.positionY.value=n.positionY||this.panner.positionY.value,this.panner.positionZ.value=n.positionZ||this.panner.positionZ.value,this.panner.orientationX.value=n.orientationX||this.panner.orientationX.value,this.panner.orientationY.value=n.orientationY||this.panner.orientationY.value,this.panner.orientationZ.value=n.orientationZ||this.panner.orientationZ.value}seek(n){if(!this.source||!this.buffer||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const r=this.isPlaying();this.stop(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.refreshFilters(),this.source.connect(this.panner).connect(this.gainNode),r&&this.source.start(0,n)}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}fadeIn(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value;const s=1;switch(this.gainNode.gain.value=0,r){case"exponential":this.gainNode.gain.setValueAtTime(.01,this.context.currentTime),this.gainNode.gain.exponentialRampToValueAtTime(s,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(s,this.context.currentTime+n);break}setTimeout(()=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value=s,i()},n*1e3)})}fadeOut(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade out a sound that has been cleaned up");switch(this.gainNode.gain.value,r){case"exponential":this.gainNode.gain.exponentialRampToValueAtTime(.01,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+n)}setTimeout(()=>i(),n*1e3)})}isPlaying(){if(!this.source)throw new Error("Cannot check if a sound is playing that has been cleaned up");return this.playing}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this.filters.forEach(n=>{n&&n.disconnect()}),this.filters=[]}loop(n){var r;if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(this.source instanceof AudioBufferSourceNode)return n===void 0?this.source.loop===!0?"infinite":0:(this.source.loop=!0,this.source.loopEnd=((r=this.source.buffer)==null?void 0:r.duration)||0,this.source.loopStart=0,this.source.loop===!0?"infinite":0);if("mediaElement"in this.source&&this.source.mediaElement){const i=this.source.mediaElement;return n===void 0||(i.loop=!0),i.loop===!0?"infinite":0}throw new Error("Unsupported source type")}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.isPlaying()&&("stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this.playing=!1)}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");"suspend"in this.source.context&&this.source.context.suspend()}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");"resume"in this.source.context&&this.source.context.resume()}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.setValueAtTime(r,this.context.currentTime),this.panner.positionY.setValueAtTime(i,this.context.currentTime),this.panner.positionZ.setValueAtTime(s,this.context.currentTime)}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}},hk=class{constructor(){V(this,"sounds",[]);V(this,"_position",[0,0,0]);V(this,"loopCount",0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}preplay(){return this.sounds.reduce((e,n)=>(n.loop&&n.loop(this.loopCount),e.concat(n.preplay())),[])}play(){return this.preplay().map(e=>(e.play(),e))}isPlaying(){return this.sounds.some(e=>e.isPlaying())}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}resume(){this.sounds.forEach(e=>e.resume())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop&&n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}},gB=class extends hm{constructor(n,r,i,s=0){super();V(this,"context");V(this,"source");V(this,"gainNode");V(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=s}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}};class vB extends hm{constructor(n){super();V(this,"context");V(this,"_position",[0,0,0]);V(this,"loopCount",0);V(this,"prevVolume",1);V(this,"microphoneGainNode");V(this,"streamPlayback");V(this,"stream");V(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new gB(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}seek(n){}isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}}const yB=(t,e)=>{var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer};function SB(t,e){const n=[];let r=0;fetch(t).then(function(s){if(!s.ok)throw new Error("HTTP error, status = "+s.status);if(!s.body)throw new Error("Missing body");var o=s.body.getReader();let a=new ArrayBuffer(0);function c(){return o.read().then(({value:l,done:u})=>{let d=null;if(l){if(a.byteLength?d=yB(a,l.buffer):(a=l.buffer.slice(0,44),d=l.buffer),e.decodeAudioData(d,function(f){n.push(f),n.length&&i()},function(f){console.log("err(decodeAudioData): "+f)}),u){console.log("done");return}c()}})}c()});function i(){for(;n.length;){let s=n.shift();const o=e.createBufferSource();if(!s)return;o.buffer=s,o.connect(e.destination),r==0&&(r=e.currentTime+.02),o.start(r),r+=o.buffer.duration}}}const wB="https://mongoose.world:9080/?url=";class bB extends ao{constructor(){super(...arguments);V(this,"packageName","Client.Media");V(this,"sounds",{});V(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let o=await this.client.cacophony.createSound(r);o.key=i,this.sounds[i]=o}}async handlePlay(n){let r=(n.url||this.defaultUrl)+n.name;n.key=n.key||r;let i=this.sounds[n.key];if((!i||i.url!==r)&&(n.type==="music"?(r=wB+encodeURIComponent(r),i=await this.client.cacophony.createSound(r,dR.HTML)):i=await this.client.cacophony.createSound(r)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0&&i.loop&&i.loop(n.loops===-1?"infinite":n.loops),n.start&&i.seek(n.start),n.end&&setTimeout(()=>{i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const o=this.sounds[s];o.priority&&o.priority<n.priority&&o.stop()}i.priority=n.priority}if(!i.isPlaying()){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}this.sounds[n.key]=i,i.key=n.key}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>r.stop()),n.type&&this.soundsByType(n.type).forEach(r=>r.stop()),n.tag&&this.soundsByTag(n.tag).forEach(r=>r.stop()),n.key&&this.soundsByKey(n.key).forEach(r=>r.stop()),!n.name&&!n.type&&!n.tag&&!n.key&&this.allSounds.forEach(r=>r.stop())}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class EB extends ao{constructor(){super(...arguments);V(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class kB extends ao{constructor(){super(...arguments);V(this,"packageName","Comm.Channel");V(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class TB extends ao{constructor(){super(...arguments);V(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class _B extends ao{constructor(){super(...arguments);V(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class CB extends ao{constructor(){super(...arguments);V(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}const yc=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,fR=new Set,ky=typeof process=="object"&&process?process:{},hR=(t,e,n,r)=>{typeof ky.emitWarning=="function"?ky.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let dp=globalThis.AbortController,pk=globalThis.AbortSignal;var $_;if(typeof dp>"u"){pk=class{constructor(){V(this,"onabort");V(this,"_onabort",[]);V(this,"reason");V(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},dp=class{constructor(){V(this,"signal",new pk);e()}abort(r){var i,s;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const o of this.signal._onabort)o(r);(s=(i=this.signal).onabort)==null||s.call(i,r)}}};let t=(($_=ky.env)==null?void 0:$_.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,hR("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const IB=t=>!fR.has(t),wo=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),pR=t=>wo(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?vh:null:null;class vh extends Array{constructor(e){super(e),this.fill(0)}}var hl;const Ea=class Ea{constructor(e,n){V(this,"heap");V(this,"length");if(!O(Ea,hl))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=pR(e);if(!n)return[];Se(Ea,hl,!0);const r=new Ea(e,n);return Se(Ea,hl,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};hl=new WeakMap,Re(Ea,hl,!1);let Ty=Ea;var Yr,ur,Xr,Qr,pl,$t,Zr,Ut,ft,Te,Ln,dr,Tn,rn,ei,sn,ti,ni,fr,ri,Mo,Fn,$d,Cy,Pa,Ss,Vd,hr,$p,mR,xa,ml,zd,Ni,bo,Mi,Eo,Wd,Iy,gl,yh,vl,Sh,Ze,dt,Hd,Ry,Na,Ou;const vb=class vb{constructor(e){Re(this,$d);Re(this,$p);Re(this,Ni);Re(this,Mi);Re(this,Wd);Re(this,gl);Re(this,vl);Re(this,Ze);Re(this,Hd);Re(this,Na);Re(this,Yr,void 0);Re(this,ur,void 0);Re(this,Xr,void 0);Re(this,Qr,void 0);Re(this,pl,void 0);V(this,"ttl");V(this,"ttlResolution");V(this,"ttlAutopurge");V(this,"updateAgeOnGet");V(this,"updateAgeOnHas");V(this,"allowStale");V(this,"noDisposeOnSet");V(this,"noUpdateTTL");V(this,"maxEntrySize");V(this,"sizeCalculation");V(this,"noDeleteOnFetchRejection");V(this,"noDeleteOnStaleGet");V(this,"allowStaleOnFetchAbort");V(this,"allowStaleOnFetchRejection");V(this,"ignoreFetchAbort");Re(this,$t,void 0);Re(this,Zr,void 0);Re(this,Ut,void 0);Re(this,ft,void 0);Re(this,Te,void 0);Re(this,Ln,void 0);Re(this,dr,void 0);Re(this,Tn,void 0);Re(this,rn,void 0);Re(this,ei,void 0);Re(this,sn,void 0);Re(this,ti,void 0);Re(this,ni,void 0);Re(this,fr,void 0);Re(this,ri,void 0);Re(this,Mo,void 0);Re(this,Fn,void 0);Re(this,Pa,()=>{});Re(this,Ss,()=>{});Re(this,Vd,()=>{});Re(this,hr,()=>!1);Re(this,xa,e=>{});Re(this,ml,(e,n,r)=>{});Re(this,zd,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:s,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:c,dispose:l,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:m,fetchMethod:w,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:v,allowStaleOnFetchRejection:b,allowStaleOnFetchAbort:C,ignoreFetchAbort:T}=e;if(n!==0&&!wo(n))throw new TypeError("max option must be a nonnegative integer");const k=n?pR(n):Array;if(!k)throw new Error("invalid max value: "+n);if(Se(this,Yr,n),Se(this,ur,h),this.maxEntrySize=p||O(this,ur),this.sizeCalculation=m,this.sizeCalculation){if(!O(this,ur)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(w!==void 0&&typeof w!="function")throw new TypeError("fetchMethod must be a function if specified");if(Se(this,pl,w),Se(this,Mo,!!w),Se(this,Ut,new Map),Se(this,ft,new Array(n).fill(void 0)),Se(this,Te,new Array(n).fill(void 0)),Se(this,Ln,new k(n)),Se(this,dr,new k(n)),Se(this,Tn,0),Se(this,rn,0),Se(this,ei,Ty.create(n)),Se(this,$t,0),Se(this,Zr,0),typeof l=="function"&&Se(this,Xr,l),typeof u=="function"?(Se(this,Qr,u),Se(this,sn,[])):(Se(this,Qr,void 0),Se(this,sn,void 0)),Se(this,ri,!!O(this,Xr)),Se(this,Fn,!!O(this,Qr)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!b,this.allowStaleOnFetchAbort=!!C,this.ignoreFetchAbort=!!T,this.maxEntrySize!==0){if(O(this,ur)!==0&&!wo(O(this,ur)))throw new TypeError("maxSize must be a positive integer if specified");if(!wo(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");ge(this,$p,mR).call(this)}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!v,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=wo(i)||i===0?i:1,this.ttlAutopurge=!!s,this.ttl=r||0,this.ttl){if(!wo(this.ttl))throw new TypeError("ttl must be a positive integer if specified");ge(this,$d,Cy).call(this)}if(O(this,Yr)===0&&this.ttl===0&&O(this,ur)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!O(this,Yr)&&!O(this,ur)){const I="LRU_CACHE_UNBOUNDED";IB(I)&&(fR.add(I),hR("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",I,vb))}}static unsafeExposeInternals(e){return{starts:O(e,ni),ttls:O(e,fr),sizes:O(e,ti),keyMap:O(e,Ut),keyList:O(e,ft),valList:O(e,Te),next:O(e,Ln),prev:O(e,dr),get head(){return O(e,Tn)},get tail(){return O(e,rn)},free:O(e,ei),isBackgroundFetch:n=>{var r;return ge(r=e,Ze,dt).call(r,n)},backgroundFetch:(n,r,i,s)=>{var o;return ge(o=e,vl,Sh).call(o,n,r,i,s)},moveToTail:n=>{var r;return ge(r=e,Na,Ou).call(r,n)},indexes:n=>{var r;return ge(r=e,Ni,bo).call(r,n)},rindexes:n=>{var r;return ge(r=e,Mi,Eo).call(r,n)},isStale:n=>{var r;return O(r=e,hr).call(r,n)}}}get max(){return O(this,Yr)}get maxSize(){return O(this,ur)}get calculatedSize(){return O(this,Zr)}get size(){return O(this,$t)}get fetchMethod(){return O(this,pl)}get dispose(){return O(this,Xr)}get disposeAfter(){return O(this,Qr)}getRemainingTTL(e){return O(this,Ut).has(e)?1/0:0}*entries(){for(const e of ge(this,Ni,bo).call(this))O(this,Te)[e]!==void 0&&O(this,ft)[e]!==void 0&&!ge(this,Ze,dt).call(this,O(this,Te)[e])&&(yield[O(this,ft)[e],O(this,Te)[e]])}*rentries(){for(const e of ge(this,Mi,Eo).call(this))O(this,Te)[e]!==void 0&&O(this,ft)[e]!==void 0&&!ge(this,Ze,dt).call(this,O(this,Te)[e])&&(yield[O(this,ft)[e],O(this,Te)[e]])}*keys(){for(const e of ge(this,Ni,bo).call(this)){const n=O(this,ft)[e];n!==void 0&&!ge(this,Ze,dt).call(this,O(this,Te)[e])&&(yield n)}}*rkeys(){for(const e of ge(this,Mi,Eo).call(this)){const n=O(this,ft)[e];n!==void 0&&!ge(this,Ze,dt).call(this,O(this,Te)[e])&&(yield n)}}*values(){for(const e of ge(this,Ni,bo).call(this))O(this,Te)[e]!==void 0&&!ge(this,Ze,dt).call(this,O(this,Te)[e])&&(yield O(this,Te)[e])}*rvalues(){for(const e of ge(this,Mi,Eo).call(this))O(this,Te)[e]!==void 0&&!ge(this,Ze,dt).call(this,O(this,Te)[e])&&(yield O(this,Te)[e])}[Symbol.iterator](){return this.entries()}find(e,n={}){for(const r of ge(this,Ni,bo).call(this)){const i=O(this,Te)[r],s=ge(this,Ze,dt).call(this,i)?i.__staleWhileFetching:i;if(s!==void 0&&e(s,O(this,ft)[r],this))return this.get(O(this,ft)[r],n)}}forEach(e,n=this){for(const r of ge(this,Ni,bo).call(this)){const i=O(this,Te)[r],s=ge(this,Ze,dt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(n,s,O(this,ft)[r],this)}}rforEach(e,n=this){for(const r of ge(this,Mi,Eo).call(this)){const i=O(this,Te)[r],s=ge(this,Ze,dt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(n,s,O(this,ft)[r],this)}}purgeStale(){let e=!1;for(const n of ge(this,Mi,Eo).call(this,{allowStale:!0}))O(this,hr).call(this,n)&&(this.delete(O(this,ft)[n]),e=!0);return e}info(e){const n=O(this,Ut).get(e);if(n===void 0)return;const r=O(this,Te)[n],i=ge(this,Ze,dt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const s={value:i};if(O(this,fr)&&O(this,ni)){const o=O(this,fr)[n],a=O(this,ni)[n];if(o&&a){const c=o-(yc.now()-a);s.ttl=c,s.start=Date.now()}}return O(this,ti)&&(s.size=O(this,ti)[n]),s}dump(){const e=[];for(const n of ge(this,Ni,bo).call(this,{allowStale:!0})){const r=O(this,ft)[n],i=O(this,Te)[n],s=ge(this,Ze,dt).call(this,i)?i.__staleWhileFetching:i;if(s===void 0||r===void 0)continue;const o={value:s};if(O(this,fr)&&O(this,ni)){o.ttl=O(this,fr)[n];const a=yc.now()-O(this,ni)[n];o.start=Math.floor(Date.now()-a)}O(this,ti)&&(o.size=O(this,ti)[n]),e.unshift([r,o])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=yc.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var f,h,p,m,w;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:s,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:c}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=O(this,zd).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(e),this;let d=O(this,$t)===0?void 0:O(this,Ut).get(e);if(d===void 0)d=O(this,$t)===0?O(this,rn):O(this,ei).length!==0?O(this,ei).pop():O(this,$t)===O(this,Yr)?ge(this,gl,yh).call(this,!1):O(this,$t),O(this,ft)[d]=e,O(this,Te)[d]=n,O(this,Ut).set(e,d),O(this,Ln)[O(this,rn)]=d,O(this,dr)[d]=O(this,rn),Se(this,rn,d),bf(this,$t)._++,O(this,ml).call(this,d,u,c),c&&(c.set="add"),l=!1;else{ge(this,Na,Ou).call(this,d);const g=O(this,Te)[d];if(n!==g){if(O(this,Mo)&&ge(this,Ze,dt).call(this,g)){g.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=g;v!==void 0&&!o&&(O(this,ri)&&((f=O(this,Xr))==null||f.call(this,v,e,"set")),O(this,Fn)&&((h=O(this,sn))==null||h.push([v,e,"set"])))}else o||(O(this,ri)&&((p=O(this,Xr))==null||p.call(this,g,e,"set")),O(this,Fn)&&((m=O(this,sn))==null||m.push([g,e,"set"])));if(O(this,xa).call(this,d),O(this,ml).call(this,d,u,c),O(this,Te)[d]=n,c){c.set="replace";const v=g&&ge(this,Ze,dt).call(this,g)?g.__staleWhileFetching:g;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update")}if(i!==0&&!O(this,fr)&&ge(this,$d,Cy).call(this),O(this,fr)&&(l||O(this,Vd).call(this,d,i,s),c&&O(this,Ss).call(this,c,d)),!o&&O(this,Fn)&&O(this,sn)){const g=O(this,sn);let v;for(;v=g==null?void 0:g.shift();)(w=O(this,Qr))==null||w.call(this,...v)}return this}pop(){var e;try{for(;O(this,$t);){const n=O(this,Te)[O(this,Tn)];if(ge(this,gl,yh).call(this,!0),ge(this,Ze,dt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(O(this,Fn)&&O(this,sn)){const n=O(this,sn);let r;for(;r=n==null?void 0:n.shift();)(e=O(this,Qr))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,s=O(this,Ut).get(e);if(s!==void 0){const o=O(this,Te)[s];if(ge(this,Ze,dt).call(this,o)&&o.__staleWhileFetching===void 0)return!1;if(O(this,hr).call(this,s))i&&(i.has="stale",O(this,Ss).call(this,i,s));else return r&&O(this,Pa).call(this,s),i&&(i.has="hit",O(this,Ss).call(this,i,s)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=O(this,Ut).get(e);if(i===void 0||!r&&O(this,hr).call(this,i))return;const s=O(this,Te)[i];return ge(this,Ze,dt).call(this,s)?s.__staleWhileFetching:s}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:m,forceRefresh:w=!1,status:g,signal:v}=n;if(!O(this,Mo))return g&&(g.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,status:g});const b={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,ttl:o,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:g,signal:v};let C=O(this,Ut).get(e);if(C===void 0){g&&(g.fetch="miss");const T=ge(this,vl,Sh).call(this,e,C,b,m);return T.__returned=T}else{const T=O(this,Te)[C];if(ge(this,Ze,dt).call(this,T)){const M=r&&T.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",M&&(g.returnedStale=!0)),M?T.__staleWhileFetching:T.__returned=T}const k=O(this,hr).call(this,C);if(!w&&!k)return g&&(g.fetch="hit"),ge(this,Na,Ou).call(this,C),i&&O(this,Pa).call(this,C),g&&O(this,Ss).call(this,g,C),T;const I=ge(this,vl,Sh).call(this,e,C,b,m),N=I.__staleWhileFetching!==void 0&&r;return g&&(g.fetch=k?"stale":"refresh",N&&k&&(g.returnedStale=!0)),N?I.__staleWhileFetching:I.__returned=I}}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:o}=n,a=O(this,Ut).get(e);if(a!==void 0){const c=O(this,Te)[a],l=ge(this,Ze,dt).call(this,c);return o&&O(this,Ss).call(this,o,a),O(this,hr).call(this,a)?(o&&(o.get="stale"),l?(o&&r&&c.__staleWhileFetching!==void 0&&(o.returnedStale=!0),r?c.__staleWhileFetching:void 0):(s||this.delete(e),o&&r&&(o.returnedStale=!0),r?c:void 0)):(o&&(o.get="hit"),l?c.__staleWhileFetching:(ge(this,Na,Ou).call(this,a),i&&O(this,Pa).call(this,a),c))}else o&&(o.get="miss")}delete(e){var r,i,s,o;let n=!1;if(O(this,$t)!==0){const a=O(this,Ut).get(e);if(a!==void 0)if(n=!0,O(this,$t)===1)this.clear();else{O(this,xa).call(this,a);const c=O(this,Te)[a];if(ge(this,Ze,dt).call(this,c)?c.__abortController.abort(new Error("deleted")):(O(this,ri)||O(this,Fn))&&(O(this,ri)&&((r=O(this,Xr))==null||r.call(this,c,e,"delete")),O(this,Fn)&&((i=O(this,sn))==null||i.push([c,e,"delete"]))),O(this,Ut).delete(e),O(this,ft)[a]=void 0,O(this,Te)[a]=void 0,a===O(this,rn))Se(this,rn,O(this,dr)[a]);else if(a===O(this,Tn))Se(this,Tn,O(this,Ln)[a]);else{const l=O(this,dr)[a];O(this,Ln)[l]=O(this,Ln)[a];const u=O(this,Ln)[a];O(this,dr)[u]=O(this,dr)[a]}bf(this,$t)._--,O(this,ei).push(a)}}if(O(this,Fn)&&((s=O(this,sn))!=null&&s.length)){const a=O(this,sn);let c;for(;c=a==null?void 0:a.shift();)(o=O(this,Qr))==null||o.call(this,...c)}return n}clear(){var e,n,r;for(const i of ge(this,Mi,Eo).call(this,{allowStale:!0})){const s=O(this,Te)[i];if(ge(this,Ze,dt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const o=O(this,ft)[i];O(this,ri)&&((e=O(this,Xr))==null||e.call(this,s,o,"delete")),O(this,Fn)&&((n=O(this,sn))==null||n.push([s,o,"delete"]))}}if(O(this,Ut).clear(),O(this,Te).fill(void 0),O(this,ft).fill(void 0),O(this,fr)&&O(this,ni)&&(O(this,fr).fill(0),O(this,ni).fill(0)),O(this,ti)&&O(this,ti).fill(0),Se(this,Tn,0),Se(this,rn,0),O(this,ei).length=0,Se(this,Zr,0),Se(this,$t,0),O(this,Fn)&&O(this,sn)){const i=O(this,sn);let s;for(;s=i==null?void 0:i.shift();)(r=O(this,Qr))==null||r.call(this,...s)}}};Yr=new WeakMap,ur=new WeakMap,Xr=new WeakMap,Qr=new WeakMap,pl=new WeakMap,$t=new WeakMap,Zr=new WeakMap,Ut=new WeakMap,ft=new WeakMap,Te=new WeakMap,Ln=new WeakMap,dr=new WeakMap,Tn=new WeakMap,rn=new WeakMap,ei=new WeakMap,sn=new WeakMap,ti=new WeakMap,ni=new WeakMap,fr=new WeakMap,ri=new WeakMap,Mo=new WeakMap,Fn=new WeakMap,$d=new WeakSet,Cy=function(){const e=new vh(O(this,Yr)),n=new vh(O(this,Yr));Se(this,fr,e),Se(this,ni,n),Se(this,Vd,(s,o,a=yc.now())=>{if(n[s]=o!==0?a:0,e[s]=o,o!==0&&this.ttlAutopurge){const c=setTimeout(()=>{O(this,hr).call(this,s)&&this.delete(O(this,ft)[s])},o+1);c.unref&&c.unref()}}),Se(this,Pa,s=>{n[s]=e[s]!==0?yc.now():0}),Se(this,Ss,(s,o)=>{if(e[o]){const a=e[o],c=n[o];if(!a||!c)return;s.ttl=a,s.start=c,s.now=r||i();const l=s.now-c;s.remainingTTL=a-l}});let r=0;const i=()=>{const s=yc.now();if(this.ttlResolution>0){r=s;const o=setTimeout(()=>r=0,this.ttlResolution);o.unref&&o.unref()}return s};this.getRemainingTTL=s=>{const o=O(this,Ut).get(s);if(o===void 0)return 0;const a=e[o],c=n[o];if(!a||!c)return 1/0;const l=(r||i())-c;return a-l},Se(this,hr,s=>{const o=n[s],a=e[s];return!!a&&!!o&&(r||i())-o>a})},Pa=new WeakMap,Ss=new WeakMap,Vd=new WeakMap,hr=new WeakMap,$p=new WeakSet,mR=function(){const e=new vh(O(this,Yr));Se(this,Zr,0),Se(this,ti,e),Se(this,xa,n=>{Se(this,Zr,O(this,Zr)-e[n]),e[n]=0}),Se(this,zd,(n,r,i,s)=>{if(ge(this,Ze,dt).call(this,r))return 0;if(!wo(i))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(i=s(r,n),!wo(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Se(this,ml,(n,r,i)=>{if(e[n]=r,O(this,ur)){const s=O(this,ur)-e[n];for(;O(this,Zr)>s;)ge(this,gl,yh).call(this,!0)}Se(this,Zr,O(this,Zr)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=O(this,Zr))})},xa=new WeakMap,ml=new WeakMap,zd=new WeakMap,Ni=new WeakSet,bo=function*({allowStale:e=this.allowStale}={}){if(O(this,$t))for(let n=O(this,rn);!(!ge(this,Wd,Iy).call(this,n)||((e||!O(this,hr).call(this,n))&&(yield n),n===O(this,Tn)));)n=O(this,dr)[n]},Mi=new WeakSet,Eo=function*({allowStale:e=this.allowStale}={}){if(O(this,$t))for(let n=O(this,Tn);!(!ge(this,Wd,Iy).call(this,n)||((e||!O(this,hr).call(this,n))&&(yield n),n===O(this,rn)));)n=O(this,Ln)[n]},Wd=new WeakSet,Iy=function(e){return e!==void 0&&O(this,Ut).get(O(this,ft)[e])===e},gl=new WeakSet,yh=function(e){var s,o;const n=O(this,Tn),r=O(this,ft)[n],i=O(this,Te)[n];return O(this,Mo)&&ge(this,Ze,dt).call(this,i)?i.__abortController.abort(new Error("evicted")):(O(this,ri)||O(this,Fn))&&(O(this,ri)&&((s=O(this,Xr))==null||s.call(this,i,r,"evict")),O(this,Fn)&&((o=O(this,sn))==null||o.push([i,r,"evict"]))),O(this,xa).call(this,n),e&&(O(this,ft)[n]=void 0,O(this,Te)[n]=void 0,O(this,ei).push(n)),O(this,$t)===1?(Se(this,Tn,Se(this,rn,0)),O(this,ei).length=0):Se(this,Tn,O(this,Ln)[n]),O(this,Ut).delete(r),bf(this,$t)._--,n},vl=new WeakSet,Sh=function(e,n,r,i){const s=n===void 0?void 0:O(this,Te)[n];if(ge(this,Ze,dt).call(this,s))return s;const o=new dp,{signal:a}=r;a==null||a.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});const c={signal:o.signal,options:r,context:i},l=(m,w=!1)=>{const{aborted:g}=o.signal,v=r.ignoreFetchAbort&&m!==void 0;if(r.status&&(g&&!w?(r.status.fetchAborted=!0,r.status.fetchError=o.signal.reason,v&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),g&&!v&&!w)return d(o.signal.reason);const b=h;return O(this,Te)[n]===h&&(m===void 0?b.__staleWhileFetching?O(this,Te)[n]=b.__staleWhileFetching:this.delete(e):(r.status&&(r.status.fetchUpdated=!0),this.set(e,m,c.options))),m},u=m=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=m),d(m)),d=m=>{const{aborted:w}=o.signal,g=w&&r.allowStaleOnFetchAbort,v=g||r.allowStaleOnFetchRejection,b=v||r.noDeleteOnFetchRejection,C=h;if(O(this,Te)[n]===h&&(!b||C.__staleWhileFetching===void 0?this.delete(e):g||(O(this,Te)[n]=C.__staleWhileFetching)),v)return r.status&&C.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),C.__staleWhileFetching;if(C.__returned===C)throw m},f=(m,w)=>{var v;const g=(v=O(this,pl))==null?void 0:v.call(this,e,s,c);g&&g instanceof Promise&&g.then(b=>m(b===void 0?void 0:b),w),o.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(m(void 0),r.allowStaleOnFetchAbort&&(m=b=>l(b,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(l,u),p=Object.assign(h,{__abortController:o,__staleWhileFetching:s,__returned:void 0});return n===void 0?(this.set(e,p,{...c.options,status:void 0}),n=O(this,Ut).get(e)):O(this,Te)[n]=p,p},Ze=new WeakSet,dt=function(e){if(!O(this,Mo))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof dp},Hd=new WeakSet,Ry=function(e,n){O(this,dr)[n]=e,O(this,Ln)[e]=n},Na=new WeakSet,Ou=function(e){e!==O(this,rn)&&(e===O(this,Tn)?Se(this,Tn,O(this,Ln)[e]):ge(this,Hd,Ry).call(this,O(this,dr)[e],O(this,Ln)[e]),ge(this,Hd,Ry).call(this,O(this,rn),e),Se(this,rn,e))};let _y=vb;function RB(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},s=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let o;for(;o=s.exec(e[3]);){const a=o[1]||o[3],c=o[2]||o[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=c}return{name:n,authKey:r,keyvals:i}}function mk(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],s=e[3],o={};return o[i]=s,{name:n,authKey:r,keyvals:o}}function Py(){return(Math.random()+1).toString(36).substring(3,9)}class Jl{constructor(e){V(this,"packageName");V(this,"minVersion",1);V(this,"maxVersion",1);V(this,"packageVersion",0);V(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class PB extends Jl{constructor(){super(...arguments);V(this,"packageName","mcp-negotiate");V(this,"minVersion",2);V(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let s=(n=i.minVersion)==null?void 0:n.toFixed(1),o=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":s,"max-version":o})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class xB extends Jl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class NB extends Jl{constructor(n){super(n);V(this,"packageName","dns-org-mud-moo-simpleedit");V(this,"sessions",{});V(this,"clientId");this.clientId=Py()}handle(n){if(n.name==="dns-org-mud-moo-simpleedit-content"){const r={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]};this.sessions[n.keyvals["_data-tag"]]=r}else console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){"content"in n.keyvals?this.sessions[n.name].contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.client.openEditorWindow(this.sessions[n.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class MB extends Jl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-getset");V(this,"id",1);V(this,"cache",new _y({max:10}));V(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class OB extends Jl{constructor(){super(...arguments);V(this,"packageName","dns-com-vmoo-userlist");V(this,"maxVersion",1.1);V(this,"player");V(this,"fields",["Object","Name","Icon"]);V(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);V(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=Gr(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=Gr(n.keyvals.icons.trim())),"d"in n.keyvals){const s=n.keyvals.d[0];switch(s){case"=":var r=Gr(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(Gr(n.keyvals.d.slice(1))));break;case"-":var i=Gr(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const o=this.playerFromArray(Gr(n.keyvals.d.slice(1)));this.updatePlayer(o);break;case"<":i=Gr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!0,this.players[c]=a)});break;case">":i=Gr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!1,this.players[c]=a)});break;case"[":i=Gr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!0,this.players[c]=a)});break;case"]":i=Gr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!1,this.players[c]=a)});break;default:console.log(`Unknown userlist mode ${s} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,s)=>{r[this.fields[s]]=i}),r.away=!1,r.idle=!1,r}}function Gr(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let s=0;s<t.length;s++){const o=t[s];if(o==="{")r++;else if(o==="}")r--;else if(o===","&&r===0){i(),n="";continue}n+=o}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(Gr(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class AB extends Jl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-ping");V(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}function DB({onlyFirst:t=!1}={}){const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")}const LB=DB();function FB(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(LB,"")}var xy=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(xy||{}),to=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(to||{});class UB{constructor(){V(this,"state");V(this,"listeners",new Set);V(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const Zc=new UB;class BB extends SI{constructor(n,r){super();V(this,"ws");V(this,"decoder",new TextDecoder("utf8"));V(this,"telnet");V(this,"host");V(this,"port");V(this,"telnetNegotiation",!1);V(this,"telnetBuffer","");V(this,"gmcpHandlers",{});V(this,"mcpHandlers",{});V(this,"mcpMultilines",{});V(this,"mcpAuthKey",null);V(this,"mcp_negotiate");V(this,"mcp_getset");V(this,"gmcp_char");V(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});V(this,"cacophony");this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(PB),this.mcp_getset=this.registerMcpPackage(MB),this.gmcp_char=this.registerGMCPPackage(j5),this.cacophony=new pB}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new U5(new F5(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===Mu.WILL&&r===Nu.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Mu.DO,Nu.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===Mu.DO&&r===Nu.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Mu.WILL,Nu.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose React Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r),this.handleGmcpData(n,r)}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}sendCommand(n){Zc.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=mk(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=mk(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=RB(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=Py(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),s=n.substring(0,i),o=n.substring(i+1);console.log("GMCP Message:",s,o,r);const a=this.gmcpHandlers[s];if(!a){console.log("No handler for GMCP package:",s);return}const c=a["handle"+o];c?(console.log("Calling handler:",c),c.call(a,JSON.parse(r))):console.log("No handler for GMCP package:",s)}emitMessage(n){const r=Zc.getState().speech.autoreadMode;r===xy.All&&this.speak(n),r===xy.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let s="";for(const[o,a]of Object.entries(r))s+=` ${o}: ${a||'""'}`;r=s}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpML(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}openEditorWindow(n){console.log(n);const r=new BroadcastChannel("editor"),i=n.reference,s=encodeURIComponent(i);window.open(`/editor?reference=${s}`,"_blank"),r.onmessage=o=>{console.log("editor window message",o),o.data.id===i&&(o.data.type==="ready"?(console.log("sending editor window session",n),r.postMessage({type:"load",session:n})):o.data.type==="save"?(console.log("saving editor window with session",o.data.session),this.saveEditorWindow(o.data.session)):o.data.type==="close"&&(console.log("closing editor window"),r.close(),r.onmessage=null))}}saveEditorWindow(n){const r=Py(),i={};i.reference=n.reference,i.type=n.type,i["content*"]="",i["_data-tag"]=r,this.sendMcp("dns-org-mud-moo-simpleedit-set",i);for(const s of n.contents)this.sendMcpML(r,"content",s);this.closeMcpML(r)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()})}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(FB(n));r.lang="en-US";const{rate:i,pitch:s,voice:o,volume:a}=Zc.getState().speech;r.rate=i,r.pitch=s,r.volume=a;const l=speechSynthesis.getVoices().find(u=>u.name===o);l&&(r.voice=l),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class jB{constructor(){V(this,"history",[]);V(this,"currentIndex",null);V(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&(this.history.push(e.trim()),this.currentIndex=null,this.unsentInput="")}navigateUp(e){return this.currentIndex===null&&(this.unsentInput=e),this.history.length>0&&(this.currentIndex==null||this.currentIndex>0)?(this.currentIndex=this.currentIndex==null?this.history.length-1:this.currentIndex-1,this.history[this.currentIndex]):e}navigateDown(e){return this.currentIndex!==null?this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=null,""):this.unsentInput}getCurrentInput(){return this.currentIndex===null?this.unsentInput:this.history[this.currentIndex]}}const $B=({onSend:t})=>{const[e,n]=E.useState(""),r=E.useRef(new jB),i=s=>{const o=r.current;if(s.key==="Enter"&&!s.shiftKey)s.preventDefault(),t(e),o.addCommand(e),n("");else if(s.key==="ArrowUp"){s.preventDefault();const a=o.navigateUp(e);n(a)}else if(s.key==="ArrowDown"){s.preventDefault();const a=o.navigateDown(e);n(a)}};return X.jsx("textarea",{value:e,onChange:s=>n(s.target.value),onKeyDown:i,autoFocus:!0,id:"command-input"})},ha=()=>{const[,t]=E.useReducer(e=>e+1,0);return E.useEffect(()=>Zc.subscribe(t),[]),[Zc.getState(),Zc.dispatch]},VB=()=>{const[t,e]=E.useState([]);return E.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},zB=({tabs:t})=>{const[e,n]=E.useState(0),r=E.useRef([]);return E.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),E.useEffect(()=>{const i=o=>{switch(o.key){case"ArrowLeft":n(a=>a>0?a-1:t.length-1);break;case"ArrowRight":n(a=>a<t.length-1?a+1:0);break}},s=r.current[e];return s==null||s.addEventListener("keydown",i),()=>{s==null||s.removeEventListener("keydown",i)}},[t.length,e]),E.useEffect(()=>{var i;(i=r.current[e])==null||i.focus()},[e]),X.jsxs("div",{children:[X.jsx("div",{role:"tablist","aria-label":"Tabs",children:t.map((i,s)=>X.jsx("button",{ref:o=>r.current[s]=o,role:"tab","aria-selected":e===s,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(s),tabIndex:e===s?void 0:-1,children:i.label},s))}),t.map((i,s)=>X.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:e!==s,tabIndex:e===s?0:-1,children:i.content},s))]})},WB=()=>{const[t,e]=ha();return X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:to.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},HB=()=>{const[t,e]=ha();return X.jsxs("label",{children:["Auto Read:",X.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:to.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[X.jsx("option",{value:"off",children:"Off"}),X.jsx("option",{value:"unfocused",children:"Unfocused"}),X.jsx("option",{value:"all",children:"Always"})]})]})},GB=()=>{const[t,e]=ha(),n=VB();return X.jsxs("label",{children:["Voice:",X.jsx("select",{value:t.speech.voice,onChange:r=>e({type:to.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>X.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},qB=()=>{const[t,e]=ha();return X.jsxs("label",{children:["Rate (0.1 - 10.0):",X.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:to.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},JB=()=>{const[t,e]=ha();return X.jsxs("label",{children:["Pitch (0 - 2):",X.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:to.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},KB=()=>{const[t,e]=ha();return X.jsxs("label",{children:["Volume (0 - 1):",X.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:to.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},YB=()=>X.jsxs("div",{children:[X.jsx(HB,{}),X.jsx("br",{}),X.jsx(GB,{}),X.jsx("br",{}),X.jsx(qB,{}),X.jsx("br",{}),X.jsx(JB,{}),X.jsx("br",{}),X.jsx(KB,{}),X.jsx("br",{})]}),XB=()=>{const[t,e]=ha(),n=t.editor,r=s=>{e({type:to.SetEditorAutocompleteEnabled,data:s.target.checked})},i=s=>{e({type:to.SetEditorAccessibilityMode,data:s.target.checked})};return X.jsxs("div",{children:[X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),X.jsx("br",{}),X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),X.jsx("br",{})]})},QB=()=>{const t=[{label:"General",content:X.jsx(WB,{})},{label:"Speech",content:X.jsx(YB,{})},{label:"Editor",content:X.jsx(XB,{})}];return X.jsx(zB,{tabs:t})};function ZB(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function kd(){return kd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kd.apply(this,arguments)}var Ny="data-focus-lock",gR="data-focus-lock-disabled",e4="data-no-focus-lock",t4="data-autofocus-inside",n4="data-no-autofocus";function r4(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function i4(t,e){var n=E.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}function s4(t,e){return i4(e||null,function(n){return t.forEach(function(r){return r4(r,n)})})}var Fg={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},My=function(t,e){return My=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},My(t,e)};function Kl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");My(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Oy=function(){return Oy=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Oy.apply(this,arguments)};function o4(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function vR(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],i=0}finally{r=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Il(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fp(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function hp(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}function el(t){return this instanceof el?(this.v=t,this):new el(t)}function a4(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(f){r[f]&&(i[f]=function(h){return new Promise(function(p,m){s.push([f,h,p,m])>1||a(f,h)})})}function a(f,h){try{c(r[f](h))}catch(p){d(s[0][3],p)}}function c(f){f.value instanceof el?Promise.resolve(f.value.v).then(l,u):d(s[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function c4(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Il=="function"?Il(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function yR(t){return t}function SR(t,e){e===void 0&&(e=yR);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var c=function(){var u=o;o=[],u.forEach(s)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){o.push(u),l()},filter:function(u){return o=o.filter(u),n}}}};return i}function ZS(t,e){return e===void 0&&(e=yR),SR(t,e)}function l4(t){t===void 0&&(t={});var e=SR(null);return e.options=Oy({async:!0,ssr:!1},t),e}var wR=ZS({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),bR=ZS(),u4=ZS(),d4=l4({async:!0}),f4=[],ew=E.forwardRef(function(e,n){var r,i=E.useState(),s=i[0],o=i[1],a=E.useRef(),c=E.useRef(!1),l=E.useRef(null),u=e.children,d=e.disabled,f=e.noFocusGuards,h=e.persistentFocus,p=e.crossFrame,m=e.autoFocus;e.allowTextSelection;var w=e.group,g=e.className,v=e.whiteList,b=e.hasPositiveIndices,C=e.shards,T=C===void 0?f4:C,k=e.as,I=k===void 0?"div":k,R=e.lockProps,N=R===void 0?{}:R,M=e.sideCar,L=e.returnFocus,F=e.focusOptions,W=e.onActivation,z=e.onDeactivation,Y=E.useState({}),K=Y[0],re=E.useCallback(function(){l.current=l.current||document&&document.activeElement,a.current&&W&&W(a.current),c.current=!0},[W]),H=E.useCallback(function(){c.current=!1,z&&z(a.current)},[z]);E.useEffect(function(){d||(l.current=null)},[]);var ee=E.useCallback(function(gt){var ce=l.current;if(ce&&ce.focus){var Qt=typeof L=="function"?L(ce):L;if(Qt){var Qn=typeof Qt=="object"?Qt:void 0;l.current=null,gt?Promise.resolve().then(function(){return ce.focus(Qn)}):ce.focus(Qn)}}},[L]),oe=E.useCallback(function(gt){c.current&&wR.useMedium(gt)},[]),q=bR.useMedium,ie=E.useCallback(function(gt){a.current!==gt&&(a.current=gt,o(gt))},[]),ke=kd((r={},r[gR]=d&&"disabled",r[Ny]=w,r),N),_e=f!==!0,me=_e&&f!=="tail",nt=s4([n,ie]);return E.createElement(E.Fragment,null,_e&&[E.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:d?-1:0,style:Fg}),b?E.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:d?-1:1,style:Fg}):null],!d&&E.createElement(M,{id:K,sideCar:d4,observed:s,disabled:d,persistentFocus:h,crossFrame:p,autoFocus:m,whiteList:v,shards:T,onActivation:re,onDeactivation:H,returnFocus:ee,focusOptions:F}),E.createElement(I,kd({ref:nt},ke,{className:g,onBlur:q,onFocus:oe}),u),me&&E.createElement("div",{"data-focus-guard":!0,tabIndex:d?-1:0,style:Fg}))});ew.propTypes={};ew.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};const ER=ew;function Ay(t,e){return Ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Ay(t,e)}function h4(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Ay(t,e)}function Td(t){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Td(t)}function p4(t,e){if(Td(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Td(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m4(t){var e=p4(t,"string");return Td(e)=="symbol"?e:String(e)}function g4(t,e,n){return e=m4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v4(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var s=[],o;function a(){o=t(s.map(function(l){return l.props})),e(o)}var c=function(l){h4(u,l);function u(){return l.apply(this,arguments)||this}u.peek=function(){return o};var d=u.prototype;return d.componentDidMount=function(){s.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=s.indexOf(this);s.splice(h,1),a()},d.render=function(){return pt.createElement(i,this.props)},u}(E.PureComponent);return g4(c,"displayName","SideEffect("+n(i)+")"),c}}var us=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},pp=function(t){return Array.isArray(t)?t:[t]},kR=function(t){return Array.isArray(t)?t[0]:t},y4=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},TR=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},_R=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},S4=function(t,e){return!t||_R(t)||!y4(t)&&e(TR(t))},CR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=S4(e,CR.bind(void 0,t));return t.set(e,r),r},w4=function(t,e){return t&&!_R(t)?k4(t)?e(TR(t)):!1:!0},IR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=w4(e,IR.bind(void 0,t));return t.set(e,r),r},RR=function(t){return t.dataset},b4=function(t){return t.tagName==="BUTTON"},PR=function(t){return t.tagName==="INPUT"},xR=function(t){return PR(t)&&t.type==="radio"},E4=function(t){return!((PR(t)||b4(t))&&(t.type==="hidden"||t.disabled))},k4=function(t){var e=t.getAttribute(n4);return![!0,"true",""].includes(e)},tw=function(t){var e;return!!(t&&(!((e=RR(t))===null||e===void 0)&&e.focusGuard))},mp=function(t){return!tw(t)},T4=function(t){return!!t},_4=function(t,e){var n=t.tabIndex-e.tabIndex,r=t.index-e.index;if(n){if(!t.tabIndex)return 1;if(!e.tabIndex)return-1}return n||r},NR=function(t,e,n){return us(t).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!e||r.tabIndex>=0}).sort(_4)},C4=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],nw=C4.join(","),I4="".concat(nw,", [data-focus-guard]"),MR=function(t,e){return us((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?I4:nw)?[r]:[],MR(r))},[])},R4=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?pm([t.contentDocument.body],e):[t]},pm=function(t,e){return t.reduce(function(n,r){var i,s=MR(r,e),o=(i=[]).concat.apply(i,s.map(function(a){return R4(a,e)}));return n.concat(o,r.parentNode?us(r.parentNode.querySelectorAll(nw)).filter(function(a){return a===r}):[])},[])},P4=function(t){var e=t.querySelectorAll("[".concat(t4,"]"));return us(e).map(function(n){return pm([n])}).reduce(function(n,r){return n.concat(r)},[])},rw=function(t,e){return us(t).filter(function(n){return CR(e,n)}).filter(function(n){return E4(n)})},gk=function(t,e){return e===void 0&&(e=new Map),us(t).filter(function(n){return IR(e,n)})},Dy=function(t,e,n){return NR(rw(pm(t,n),e),!0,n)},vk=function(t,e){return NR(rw(pm(t),e),!1)},x4=function(t,e){return rw(P4(t),e)},tl=function(t,e){return t.shadowRoot?tl(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:us(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?tl(i,e):!1}return tl(n,e)})},N4=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var s=t[r].compareDocumentPosition(t[i]);(s&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(s&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(o,a){return!e.has(a)})},OR=function(t){return t.parentNode?OR(t.parentNode):t},iw=function(t){var e=pp(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(Ny);return n.push.apply(n,i?N4(us(OR(r).querySelectorAll("[".concat(Ny,'="').concat(i,'"]:not([').concat(gR,'="disabled"])')))):[r]),n},[])},M4=function(t){try{return t()}catch{return}},_d=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?_d(e.shadowRoot):e instanceof HTMLIFrameElement&&M4(function(){return e.contentWindow.document})?_d(e.contentWindow.document):e}},O4=function(t,e){return t===e},A4=function(t,e){return!!us(t.querySelectorAll("iframe")).some(function(n){return O4(n,e)})},AR=function(t,e){return e===void 0&&(e=_d(kR(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:iw(t).some(function(n){return tl(n,e)||A4(n,e)})},D4=function(t){t===void 0&&(t=document);var e=_d(t);return e?us(t.querySelectorAll("[".concat(e4,"]"))).some(function(n){return tl(n,e)}):!1},L4=function(t,e){return e.filter(xR).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},sw=function(t,e){return xR(t)&&t.name?L4(t,e):t},F4=function(t){var e=new Set;return t.forEach(function(n){return e.add(sw(n,t))}),t.filter(function(n){return e.has(n)})},yk=function(t){return t[0]&&t.length>1?sw(t[0],t):t[0]},Sk=function(t,e){return t.length>1?t.indexOf(sw(t[e],t)):e},DR="NEW_FOCUS",U4=function(t,e,n,r){var i=t.length,s=t[0],o=t[i-1],a=tw(n);if(!(n&&t.indexOf(n)>=0)){var c=n!==void 0?e.indexOf(n):-1,l=r?e.indexOf(r):c,u=r?t.indexOf(r):-1,d=c-l,f=e.indexOf(s),h=e.indexOf(o),p=F4(e),m=n!==void 0?p.indexOf(n):-1,w=m-(r?p.indexOf(r):c),g=Sk(t,0),v=Sk(t,i-1);if(c===-1||u===-1)return DR;if(!d&&u>=0)return u;if(c<=f&&a&&Math.abs(d)>1)return v;if(c>=h&&a&&Math.abs(d)>1)return g;if(d&&Math.abs(w)>1)return u;if(c<=f)return v;if(c>h)return g;if(d)return Math.abs(d)>1?u:(i+u+d)%i}},B4=function(t){return function(e){var n,r=(n=RR(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},j4=function(t,e,n){var r=t.map(function(s){var o=s.node;return o}),i=gk(r.filter(B4(n)));return i&&i.length?yk(i):yk(gk(e))},Ly=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&Ly(t.parentNode.host||t.parentNode,e),e},Ug=function(t,e){for(var n=Ly(t),r=Ly(e),i=0;i<n.length;i+=1){var s=n[i];if(r.indexOf(s)>=0)return s}return!1},LR=function(t,e,n){var r=pp(t),i=pp(e),s=r[0],o=!1;return i.filter(Boolean).forEach(function(a){o=Ug(o||a,a)||o,n.filter(Boolean).forEach(function(c){var l=Ug(s,c);l&&(!o||tl(l,o)?o=l:o=Ug(l,o))})}),o},$4=function(t,e){return t.reduce(function(n,r){return n.concat(x4(r,e))},[])},V4=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(T4)},z4=function(t,e){var n=_d(pp(t).length>0?document:kR(t).ownerDocument),r=iw(t).filter(mp),i=LR(n||t,t,r),s=new Map,o=vk(r,s),a=Dy(r,s).filter(function(h){var p=h.node;return mp(p)});if(!(!a[0]&&(a=o,!a[0]))){var c=vk([i],s).map(function(h){var p=h.node;return p}),l=V4(c,a),u=l.map(function(h){var p=h.node;return p}),d=U4(u,c,n,e);if(d===DR){var f=j4(o,u,$4(r,s));if(f)return{node:f};console.warn("focus-lock: cannot find any node to move focus into");return}return d===void 0?d:l[d]}},W4=function(t){var e=iw(t).filter(mp),n=LR(t,t,e),r=new Map,i=Dy([n],r,!0),s=Dy(e,r).filter(function(o){var a=o.node;return mp(a)}).map(function(o){var a=o.node;return a});return i.map(function(o){var a=o.node,c=o.index;return{node:a,index:c,lockItem:s.indexOf(a)>=0,guard:tw(a)}})},H4=function(t,e){"focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus()},Bg=0,jg=!1,FR=function(t,e,n){n===void 0&&(n={});var r=z4(t,e);if(!jg&&r){if(Bg>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),jg=!0,setTimeout(function(){jg=!1},1);return}Bg++,H4(r.node,n.focusOptions),Bg--}};function ow(t){setTimeout(t,1)}var G4=function(){return document&&document.activeElement===document.body},q4=function(){return G4()||D4()},nl=null,jc=null,rl=null,Cd=!1,J4=function(){return!0},K4=function(e){return(nl.whiteList||J4)(e)},Y4=function(e,n){rl={observerNode:e,portaledElement:n}},X4=function(e){return rl&&rl.portaledElement===e};function wk(t,e,n,r){var i=null,s=t;do{var o=r[s];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(s!==t)return;i=null}else break}while((s+=n)!==e);i&&(i.node.tabIndex=0)}var Q4=function(e){return e&&"current"in e?e.current:e},Z4=function(e){return e?!!Cd:Cd==="meanwhile"},e6=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},t6=function(e,n){return n.some(function(r){return e6(e,r,r)})},gp=function(){var e=!1;if(nl){var n=nl,r=n.observed,i=n.persistentFocus,s=n.autoFocus,o=n.shards,a=n.crossFrame,c=n.focusOptions,l=r||rl&&rl.portaledElement,u=document&&document.activeElement;if(l){var d=[l].concat(o.map(Q4).filter(Boolean));if((!u||K4(u))&&(i||Z4(a)||!q4()||!jc&&s)&&(l&&!(AR(d)||u&&t6(u,d)||X4(u))&&(document&&!jc&&u&&!s?(u.blur&&u.blur(),document.body.focus()):(e=FR(d,jc,{focusOptions:c}),rl={})),Cd=!1,jc=document&&document.activeElement),document){var f=document&&document.activeElement,h=W4(d),p=h.map(function(m){var w=m.node;return w}).indexOf(f);p>-1&&(h.filter(function(m){var w=m.guard,g=m.node;return w&&g.dataset.focusAutoGuard}).forEach(function(m){var w=m.node;return w.removeAttribute("tabIndex")}),wk(p,h.length,1,h),wk(p,-1,-1,h))}}}return e},UR=function(e){gp()&&e&&(e.stopPropagation(),e.preventDefault())},aw=function(){return ow(gp)},n6=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||Y4(r,n)},r6=function(){return null},BR=function(){Cd="just",ow(function(){Cd="meanwhile"})},i6=function(){document.addEventListener("focusin",UR),document.addEventListener("focusout",aw),window.addEventListener("blur",BR)},s6=function(){document.removeEventListener("focusin",UR),document.removeEventListener("focusout",aw),window.removeEventListener("blur",BR)};function o6(t){return t.filter(function(e){var n=e.disabled;return!n})}function a6(t){var e=t.slice(-1)[0];e&&!nl&&i6();var n=nl,r=n&&e&&e.id===n.id;nl=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var s=i.id;return s===n.id}).length||n.returnFocus(!e)),e?(jc=null,(!r||n.observed!==e.observed)&&e.onActivation(),gp(),ow(gp)):(s6(),jc=null)}wR.assignSyncMedium(n6);bR.assignMedium(aw);u4.assignMedium(function(t){return t({moveFocusInside:FR,focusInside:AR})});const c6=v4(o6,a6)(r6);var jR=E.forwardRef(function(e,n){return E.createElement(ER,kd({sideCar:c6,ref:n},e))}),$R=ER.propTypes||{};$R.sideCar;ZB($R,["sideCar"]);jR.propTypes={};const l6=jR,u6=pt.forwardRef((t,e)=>{const[n,r]=E.useState(!1),i=E.useRef(null);return pt.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),E.useEffect(()=>{var s;n&&((s=i.current)==null||s.focus())},[n]),E.useEffect(()=>{const s=o=>{o.key==="Escape"&&r(!1)};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[]),X.jsx(l6,{disabled:!n,children:X.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[n&&X.jsx(QB,{}),X.jsx("button",{onClick:()=>r(!1),children:"Close"})]})})});var VR={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},bk=pt.createContext&&pt.createContext(VR),Yo=function(){return Yo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Yo.apply(this,arguments)},d6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function zR(t){return t&&t.map(function(e,n){return pt.createElement(e.tag,Yo({key:n},e.attr),zR(e.child))})}function oc(t){return function(e){return pt.createElement(f6,Yo({attr:Yo({},t.attr)},e),zR(t.child))}}function f6(t){var e=function(n){var r=t.attr,i=t.size,s=t.title,o=d6(t,["attr","size","title"]),a=i||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),pt.createElement("svg",Yo({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:Yo(Yo({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&pt.createElement("title",null,s),t.children)};return bk!==void 0?pt.createElement(bk.Consumer,null,function(n){return e(n)}):e(VR)}function h6(t){return oc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(t)}function p6(t){return oc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(t)}function m6(t){return oc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"}}]})(t)}function WR(t){return oc({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(t)}function g6(t){return oc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"}}]})(t)}function v6(t){return oc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"}}]})(t)}function y6(t){return oc({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"}}]})(t)}const S6=({client:t,onClearLog:e,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[s,o]=pt.useState(t.cacophony.muted);return X.jsxs("div",{className:"toolbar",children:[X.jsxs("button",{onClick:n,accessKey:"l",children:[X.jsx(WR,{}),"Save Log"]}),X.jsxs("button",{onClick:e,accessKey:"c",children:[X.jsx(m6,{}),"Clear Log"]}),X.jsxs("button",{onClick:i,accessKey:"p",children:[X.jsx(h6,{}),"Preferences"]}),X.jsxs("button",{onClick:()=>{o(!s),t.cacophony.muted=!s},accessKey:"m",children:[s?X.jsx(y6,{}):X.jsx(v6,{}),s?"Unmute":"Mute"]}),X.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"}),X.jsxs("label",{children:["Volume",X.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]})]})};class w6 extends pt.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return X.jsx("div",{className:"statusbar",children:this.state.statusText})}}const b6=({users:t})=>X.jsxs("div",{className:"sidebar",children:[X.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),X.jsx("div",{className:"sidebar-content",children:X.jsx("ul",{children:t.map(e=>{let n="";return e.away&&(n+=" away"),e.idle&&(n+=" idle"),X.jsx("li",{className:n,children:e.Name},e.Object)})})})]});var Ek={};function E6(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var k6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function T6(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var HR={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(k6,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(m,w){var g=m[w];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?o:console[m]!==void 0?s(console,m):console.log!==void 0?s(console,"log"):e}function c(m,w){for(var g=0;g<i.length;g++){var v=i[g];this[v]=g<m?e:this.methodFactory(v,m,w)}this.log=this.debug}function l(m,w,g){return function(){typeof console!==n&&(c.call(this,w,g),this[m].apply(this,arguments))}}function u(m,w,g){return a(m)||l.apply(this,arguments)}function d(m,w,g){var v=this,b;w=w??"WARN";var C="loglevel";typeof m=="string"?C+=":"+m:typeof m=="symbol"&&(C=void 0);function T(N){var M=(i[N]||"silent").toUpperCase();if(!(typeof window===n||!C)){try{window.localStorage[C]=M;return}catch{}try{window.document.cookie=encodeURIComponent(C)+"="+M+";"}catch{}}}function k(){var N;if(!(typeof window===n||!C)){try{N=window.localStorage[C]}catch{}if(typeof N===n)try{var M=window.document.cookie,L=M.indexOf(encodeURIComponent(C)+"=");L!==-1&&(N=/^([^;]+)/.exec(M.slice(L))[1])}catch{}return v.levels[N]===void 0&&(N=void 0),N}}function I(){if(!(typeof window===n||!C)){try{window.localStorage.removeItem(C);return}catch{}try{window.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=m,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=g||u,v.getLevel=function(){return b},v.setLevel=function(N,M){if(typeof N=="string"&&v.levels[N.toUpperCase()]!==void 0&&(N=v.levels[N.toUpperCase()]),typeof N=="number"&&N>=0&&N<=v.levels.SILENT){if(b=N,M!==!1&&T(N),c.call(v,N,m),typeof console===n&&N<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+N},v.setDefaultLevel=function(N){w=N,k()||v.setLevel(N,!1)},v.resetLevel=function(){v.setLevel(w,!1),I()},v.enableAll=function(N){v.setLevel(v.levels.TRACE,N)},v.disableAll=function(N){v.setLevel(v.levels.SILENT,N)};var R=k();R==null&&(R=w),v.setLevel(R,!1)}var f=new d,h={};f.getLogger=function(w){if(typeof w!="symbol"&&typeof w!="string"||w==="")throw new TypeError("You must supply a name when creating a logger.");var g=h[w];return g||(g=h[w]=new d(w,f.getLevel(),f.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(HR);var GR=HR.exports,Fy;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(Fy||(Fy={}));const D=GR.getLogger("livekit");D.setDefaultLevel(Fy.info);GR.getLogger("lk-e2ee");function nr(t,e){if(!t)throw new Error(e)}const _6=34028234663852886e22,C6=-34028234663852886e22,I6=4294967295,R6=2147483647,P6=-2147483648;function wh(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>R6||t<P6)throw new Error("invalid int 32: "+t)}function Uy(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>I6||t<0)throw new Error("invalid uint 32: "+t)}function qR(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>_6||t<C6))throw new Error("invalid float 32: "+t)}const JR=Symbol("@bufbuild/protobuf/enum-type");function x6(t){const e=t[JR];return nr(e,"missing enum type on enum object"),e}function KR(t,e,n,r){t[JR]=YR(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function YR(t,e,n){const r=Object.create(null),i=Object.create(null),s=[];for(const o of e){const a=XR(o);s.push(a),r[o.name]=a,i[o.no]=a}return{typeName:t,values:s,findName(o){return r[o]},findNumber(o){return i[o]}}}function N6(t,e,n){const r={};for(const i of e){const s=XR(i);r[s.localName]=s.no,r[s.no]=s.localName}return KR(r,t,e),r}function XR(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class fe{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,s=i.makeReadOptions(n);return i.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,s=i.makeReadOptions(n);return i.readMessage(r,e,s,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),s=i.writerFactory();return r.writeMessage(this,s,i),s.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function M6(t,e,n,r){var i;const s=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),o={[s]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[s];return Object.setPrototypeOf(o.prototype,new fe),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new o().fromBinary(a,c)},fromJson(a,c){return new o().fromJson(a,c)},fromJsonString(a,c){return new o().fromJsonString(a,c)},equals(a,c){return t.util.equals(o,a,c)}}),o}function O6(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,s,o){return M6(this,i,s,o)},makeEnum:N6,makeEnumType:YR,getEnumType:x6}}var ne;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(ne||(ne={}));var Wa;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Wa||(Wa={}));function A6(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function $g(t,e,n){for(let s=0;s<28;s=s+7){const o=t>>>s,a=!(!(o>>>7)&&e==0),c=(a?o|128:o)&255;if(n.push(c),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const o=e>>>s,a=!!(o>>>7),c=(a?o|128:o)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const bh=4294967296;function kk(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function s(o,a){const c=Number(t.slice(o,a));i*=n,r=r*n+c,r>=bh&&(i=i+(r/bh|0),r=r%bh)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?ZR(r,i):cw(r,i)}function D6(t,e){let n=cw(t,e);const r=n.hi&2147483648;r&&(n=ZR(n.lo,n.hi));const i=QR(n.lo,n.hi);return r?"-"+i:i}function QR(t,e){if({lo:t,hi:e}=L6(t,e),e<=2097151)return String(bh*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let s=n+r*6777216+i*6710656,o=r+i*8147497,a=i*2;const c=1e7;return s>=c&&(o+=Math.floor(s/c),s%=c),o>=c&&(a+=Math.floor(o/c),o%=c),a.toString()+Tk(o)+Tk(s)}function L6(t,e){return{lo:t>>>0,hi:e>>>0}}function cw(t,e){return{lo:t|0,hi:e|0}}function ZR(t,e){return e=~e,t?t=~t+1:e+=1,cw(t,e)}const Tk=t=>{const e=String(t);return"0000000".slice(e.length)+e};function _k(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function F6(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function U6(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof Ek!="object"||Ek.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>s||l<i)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<o)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}const n=i=>nr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>nr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),kk(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),kk(i)},dec(i,s){return D6(i,s)},uDec(i,s){return QR(i,s)}}}const Pe=U6();var At;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(At||(At={}));class B6{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Uy(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return wh(e),_k(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){qR(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Uy(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){wh(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return wh(e),e=(e<<1^e>>31)>>>0,_k(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Pe.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Pe.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=Pe.enc(e);return $g(n.lo,n.hi,this.buf),this}sint64(e){let n=Pe.enc(e),r=n.hi>>31,i=n.lo<<1^r,s=(n.hi<<1|n.lo>>>31)^r;return $g(i,s,this.buf),this}uint64(e){let n=Pe.uEnc(e);return $g(n.lo,n.hi,this.buf),this}}class j6{constructor(e,n){this.varint64=A6,this.uint32=F6,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case At.Varint:for(;this.buf[this.pos++]&128;);break;case At.Bit64:this.pos+=4;case At.Bit32:this.pos+=4;break;case At.LengthDelimited:let r=this.uint32();this.pos+=r;break;case At.StartGroup:let i;for(;(i=this.tag()[1])!==At.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Pe.dec(...this.varint64())}uint64(){return Pe.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,Pe.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Pe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Pe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function By(t,e){return e instanceof fe||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}ne.DOUBLE,ne.FLOAT,ne.INT64,ne.UINT64,ne.INT32,ne.UINT32,ne.BOOL,ne.STRING,ne.BYTES;function yo(t,e,n){if(e===n)return!0;if(t==ne.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return e==n}return!1}function jy(t,e){switch(t){case ne.BOOL:return!1;case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return e==0?Pe.zero:"0";case ne.DOUBLE:case ne.FLOAT:return 0;case ne.BYTES:return new Uint8Array(0);case ne.STRING:return"";default:return 0}}function eP(t,e){const n=e===void 0;let r=At.Varint,i=e===0;switch(t){case ne.STRING:i=n||!e.length,r=At.LengthDelimited;break;case ne.BOOL:i=e===!1;break;case ne.DOUBLE:r=At.Bit64;break;case ne.FLOAT:r=At.Bit32;break;case ne.INT64:i=n||e==0;break;case ne.UINT64:i=n||e==0;break;case ne.FIXED64:i=n||e==0,r=At.Bit64;break;case ne.BYTES:i=n||!e.byteLength,r=At.LengthDelimited;break;case ne.FIXED32:r=At.Bit32;break;case ne.SFIXED32:r=At.Bit32;break;case ne.SFIXED64:i=n||e==0,r=At.Bit64;break;case ne.SINT64:i=n||e==0;break}const s=ne[t].toLowerCase();return[r,s,n||i]}const Sc=Symbol("@bufbuild/protobuf/unknown-fields"),Ck={readUnknownFields:!0,readerFactory:t=>new j6(t)},Ik={writeUnknownFields:!0,writerFactory:()=>new B6};function $6(t){return t?Object.assign(Object.assign({},Ck),t):Ck}function V6(t){return t?Object.assign(Object.assign({},Ik),t):Ik}function z6(){return{makeReadOptions:$6,makeWriteOptions:V6,listUnknownFields(t){var e;return(e=t[Sc])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Sc]},writeUnknownFields(t,e){const r=t[Sc];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[Sc])||(i[Sc]=[]),i[Sc].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),s=n===void 0?e.len:e.pos+n;for(;e.pos<s;){const[o,a]=e.tag(),c=i.fields.find(o);if(!c){const f=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,o,a,f);continue}let l=t,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":const f=c.kind=="enum"?ne.INT32:c.T;let h=vp;if(c.kind=="scalar"&&c.L>0&&(h=H6),u){let g=l[d];if(a==At.LengthDelimited&&f!=ne.STRING&&f!=ne.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)g.push(h(e,f))}else g.push(h(e,f))}else l[d]=h(e,f);break;case"message":const p=c.T;u?l[d].push(Eh(e,new p,r)):l[d]instanceof fe?Eh(e,l[d],r):(l[d]=Eh(e,new p,r),p.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=p.fieldWrapper.unwrapField(l[d])));break;case"map":let[m,w]=W6(c,e,r);l[d][m]=w;break}}}}}function Eh(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function W6(t,e,n){const r=e.uint32(),i=e.pos+r;let s,o;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:s=vp(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=vp(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=Eh(e,new t.V.T,n);break}break}}if(s===void 0){let a=jy(t.K,Wa.BIGINT);s=t.K==ne.BOOL?a.toString():a}if(typeof s!="string"&&typeof s!="number"&&(s=s.toString()),o===void 0)switch(t.V.kind){case"scalar":o=jy(t.V.T,Wa.BIGINT);break;case"enum":o=0;break;case"message":o=new t.V.T;break}return[s,o]}function H6(t,e){const n=vp(t,e);return typeof n=="bigint"?n.toString():n}function vp(t,e){switch(e){case ne.STRING:return t.string();case ne.BOOL:return t.bool();case ne.DOUBLE:return t.double();case ne.FLOAT:return t.float();case ne.INT32:return t.int32();case ne.INT64:return t.int64();case ne.UINT64:return t.uint64();case ne.FIXED64:return t.fixed64();case ne.BYTES:return t.bytes();case ne.FIXED32:return t.fixed32();case ne.SFIXED32:return t.sfixed32();case ne.SFIXED64:return t.sfixed64();case ne.SINT64:return t.sint64();case ne.UINT32:return t.uint32();case ne.SINT32:return t.sint32()}}function G6(t,e,n,r,i){t.tag(n.no,At.LengthDelimited),t.fork();let s=r;switch(n.K){case ne.INT32:case ne.FIXED32:case ne.UINT32:case ne.SFIXED32:case ne.SINT32:s=Number.parseInt(r);break;case ne.BOOL:nr(r=="true"||r=="false"),s=r=="true";break}switch(Ju(t,n.K,1,s,!0),n.V.kind){case"scalar":Ju(t,n.V.T,2,i,!0);break;case"enum":Ju(t,ne.INT32,2,i,!0);break;case"message":$y(t,e,n.V.T,2,i);break}t.join()}function $y(t,e,n,r,i){if(i!==void 0){const s=By(n,i);t.tag(r,At.LengthDelimited).bytes(s.toBinary(e))}}function Ju(t,e,n,r,i){let[s,o,a]=eP(e,r);(!a||i)&&t.tag(n,s)[o](r)}function q6(t,e,n,r){if(!r.length)return;t.tag(n,At.LengthDelimited).fork();let[,i]=eP(e);for(let s=0;s<r.length;s++)t[i](r[s]);t.join()}function J6(){return Object.assign(Object.assign({},z6()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let s,o=i.repeated,a=i.localName;if(i.oneof){const c=t[i.oneof.localName];if(c.case!==a)continue;s=c.value}else s=t[a];switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?ne.INT32:i.T;if(o)if(i.packed)q6(e,c,i.no,s);else for(const l of s)Ju(e,c,i.no,l,!0);else s!==void 0&&Ju(e,c,i.no,s,!!i.oneof||i.opt);break;case"message":if(o)for(const l of s)$y(e,n,i.T,i.no,l);else $y(e,n,i.T,i.no,s);break;case"map":for(const[l,u]of Object.entries(s))G6(e,n,i,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),mm=[];for(let t=0;t<ws.length;t++)mm[ws[t].charCodeAt(0)]=t;mm[45]=ws.indexOf("+");mm[95]=ws.indexOf("/");const tP={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,s,o=0;for(let a=0;a<t.length;a++){if(s=mm[t.charCodeAt(a)],s===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=s,i=1;break;case 1:n[r++]=o<<2|(s&48)>>4,o=s,i=2;break;case 2:n[r++]=(o&15)<<4|(s&60)>>2,o=s,i=3;break;case 3:n[r++]=(o&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let s=0;s<t.length;s++)switch(r=t[s],n){case 0:e+=ws[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=ws[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=ws[i|r>>6],e+=ws[r&63],n=0;break}return n&&(e+=ws[i],e+="=",n==1&&(e+="=")),e}},Rk={ignoreUnknownFields:!1},Pk={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function K6(t){return t?Object.assign(Object.assign({},Rk),t):Rk}function Y6(t){return t?Object.assign(Object.assign({},Pk),t):Pk}function X6(t){const e=t(Q6,xk);return{makeReadOptions:K6,makeWriteOptions:Y6,readMessage(n,r,i,s){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));s=s??new n;const o={};for(const[a,c]of Object.entries(r)){const l=n.fields.findJsonName(a);if(!l){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=l.localName,d=s;if(l.oneof){if(c===null&&l.kind=="scalar")continue;const f=o[l.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));o[l.oneof.localName]=a,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const h of c){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h)));let p;switch(l.kind){case"message":p=l.T.fromJson(h,i);break;case"enum":if(p=Vg(l.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=yu(l.T,h,l.L)}catch(m){let w="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h));throw m instanceof Error&&m.message.length>0&&(w+=": ".concat(m.message)),new Error(w)}break}f.push(p)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const[h,p]of Object.entries(c)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: map value null"));let m;switch(l.V.kind){case"message":m=l.V.T.fromJson(p,i);break;case"enum":if(m=Vg(l.V.T,p,i.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=yu(l.V.T,p,Wa.BIGINT)}catch(w){let g="cannot decode map value for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw w instanceof Error&&w.message.length>0&&(g+=": ".concat(w.message)),new Error(g)}break}try{f[yu(l.K,l.K==ne.BOOL?h=="true"?!0:h=="false"?!1:h:h,Wa.BIGINT).toString()]=m}catch(w){let g="cannot decode map key for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw w instanceof Error&&w.message.length>0&&(g+=": ".concat(w.message)),new Error(g)}}}else switch(l.kind){case"message":const f=l.T;if(c===null&&f.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof fe?d[u].fromJson(c,i):(d[u]=f.fromJson(c,i),f.fieldWrapper&&!l.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=Vg(l.T,c,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=yu(l.T,c,l.L)}catch(p){let m="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw p instanceof Error&&p.message.length>0&&(m+=": ".concat(p.message)),new Error(m)}break}}return s},writeMessage(n,r){const i=n.getType(),s={};let o;try{for(const a of i.fields.byMember()){let c;if(a.kind=="oneof"){const l=n[a.localName];if(l.value===void 0)continue;if(o=a.findField(l.case),!o)throw"oneof case not found: "+l.case;c=e(o,l.value,r)}else o=a,c=e(o,n[o.localName],r);c!==void 0&&(s[r.useProtoFieldName?o.name:o.jsonName]=c)}}catch(a){const c=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),l=a instanceof Error?a.message:String(a);throw new Error(c+(l.length>0?": ".concat(l):""))}return s},readScalar:yu,writeScalar:xk,debug:nP}}function nP(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function yu(t,e,n){switch(t){case ne.DOUBLE:case ne.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==ne.FLOAT&&qR(r),r;case ne.INT32:case ne.FIXED32:case ne.SFIXED32:case ne.SINT32:case ne.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==ne.UINT32?Uy(i):wh(i),i;case ne.INT64:case ne.SFIXED64:case ne.SINT64:if(e===null)return Pe.zero;if(typeof e!="number"&&typeof e!="string")break;const s=Pe.parse(e);return n?s.toString():s;case ne.FIXED64:case ne.UINT64:if(e===null)return Pe.zero;if(typeof e!="number"&&typeof e!="string")break;const o=Pe.uParse(e);return n?o.toString():o;case ne.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case ne.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case ne.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return tP.dec(e)}throw new Error}function Vg(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(nP(e)))}function Q6(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const s=t.findNumber(e);return(i=s==null?void 0:s.name)!==null&&i!==void 0?i:e}function xk(t,e,n){if(e!==void 0)switch(t){case ne.INT32:case ne.SFIXED32:case ne.SINT32:case ne.FIXED32:case ne.UINT32:return nr(typeof e=="number"),e!=0||n?e:void 0;case ne.FLOAT:case ne.DOUBLE:return nr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case ne.STRING:return nr(typeof e=="string"),e.length>0||n?e:void 0;case ne.BOOL:return nr(typeof e=="boolean"),e||n?e:void 0;case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return nr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case ne.BYTES:return nr(e instanceof Uint8Array),n||e.byteLength>0?tP.enc(e):void 0}}function Z6(){return X6((t,e)=>function(r,i,s){if(r.kind=="map"){const o={};switch(r.V.kind){case"scalar":for(const[c,l]of Object.entries(i)){const u=e(r.V.T,l,!0);nr(u!==void 0),o[c.toString()]=u}break;case"message":for(const[c,l]of Object.entries(i))o[c.toString()]=l.toJson(s);break;case"enum":const a=r.V.T;for(const[c,l]of Object.entries(i)){nr(l===void 0||typeof l=="number");const u=t(a,l,!0,s.enumAsInteger);nr(u!==void 0),o[c.toString()]=u}break}return s.emitDefaultValues||Object.keys(o).length>0?o:void 0}else if(r.repeated){const o=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)o.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)o.push(t(r.T,i[a],!0,s.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)o.push(By(r.T,i[a]).toJson(s));break}return s.emitDefaultValues||o.length>0?o:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues,s.enumAsInteger);case"message":return i!==void 0?By(r.T,i).toJson(s):void 0}})}function e8(){return{setEnumType:KR,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,s=e,o=t;if(o[i]!==void 0)switch(r.kind){case"oneof":const a=o[i].case;if(a===void 0)continue;const c=r.findField(a);let l=o[i].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===ne.BYTES&&(l=Su(l)),s[i]={case:a,value:l};break;case"scalar":case"enum":let u=o[i];r.T===ne.BYTES&&(u=r.repeated?u.map(Su):Su(u)),s[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===ne.BYTES)for(const[h,p]of Object.entries(o[i]))s[i][h]=Su(p);else Object.assign(s[i],o[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(o[i])){let p=o[i][h];f.fieldWrapper||(p=new f(p)),s[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)s[i]=o[i].map(f=>f instanceof d?f:new d(f));else if(o[i]!==void 0){const f=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?s[i]=Su(f):s[i]=f:s[i]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],s=n[r.localName];if(r.repeated){if(i.length!==s.length)return!1;switch(r.kind){case"message":return i.every((o,a)=>r.T.equals(o,s[a]));case"scalar":return i.every((o,a)=>yo(r.T,o,s[a]));case"enum":return i.every((o,a)=>yo(ne.INT32,o,s[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,s);case"enum":return yo(ne.INT32,i,s);case"scalar":return yo(r.T,i,s);case"oneof":if(i.case!==s.case)return!1;const o=r.findField(i.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(i.value,s.value);case"enum":return yo(ne.INT32,i.value,s.value);case"scalar":return yo(o.T,i.value,s.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(s));switch(r.V.kind){case"message":const c=r.V.T;return a.every(u=>c.equals(i[u],s[u]));case"enum":return a.every(u=>yo(ne.INT32,i[u],s[u]));case"scalar":const l=r.V.T;return a.every(u=>yo(l,i[u],s[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const s=t[i.localName];let o;if(i.repeated)o=s.map($f);else if(i.kind=="map"){o=r[i.localName];for(const[a,c]of Object.entries(s))o[a]=$f(c)}else i.kind=="oneof"?o=i.findField(s.case)?{case:s.case,value:$f(s.value)}:{case:void 0}:o=$f(s);r[i.localName]=o}return n}}}function $f(t){if(t===void 0)return t;if(t instanceof fe)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Su(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class t8{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function rP(t,e){const n=iP(t);return e?n:a8(o8(n))}function n8(t){return rP(t,!1)}const r8=iP;function iP(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const i8=new Set(["constructor","toString","toJSON","valueOf"]),s8=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),sP=t=>"".concat(t,"$"),o8=t=>s8.has(t)?sP(t):t,a8=t=>i8.has(t)?sP(t):t;class c8{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=n8(e)}addField(e){nr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const P=O6("proto3",Z6(),J6(),Object.assign(Object.assign({},e8()),{newFieldList(t){return new t8(t,l8)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=jy(e.T,e.L);break}}}}));function l8(t){var e,n,r,i;const s=[];let o;for(const a of typeof t=="function"?t():t){const c=a;if(c.localName=rP(a.name,a.oneof!==void 0),c.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:r8(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(r=a.L)!==null&&r!==void 0?r:Wa.BIGINT),c.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=ne.BYTES&&a.T!=ne.STRING,a.oneof!==void 0){const l=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!o||o.name!=l)&&(o=new c8(l)),c.oneof=o,o.addField(c)}s.push(c)}return s}class an extends fe{constructor(e){super(),this.seconds=Pe.zero,this.nanos=0,P.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(P.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Pe.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return an.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new an({seconds:Pe.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new an().fromBinary(e,n)}static fromJson(e,n){return new an().fromJson(e,n)}static fromJsonString(e,n){return new an().fromJsonString(e,n)}static equals(e,n){return P.util.equals(an,e,n)}}an.runtime=P;an.typeName="google.protobuf.Timestamp";an.fields=P.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var Vy;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(Vy||(Vy={}));P.util.setEnumType(Vy,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var zy;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(zy||(zy={}));P.util.setEnumType(zy,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var Wy;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(Wy||(Wy={}));P.util.setEnumType(Wy,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Cn;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Cn||(Cn={}));P.util.setEnumType(Cn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Dt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Dt||(Dt={}));P.util.setEnumType(Dt,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var Kt;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(Kt||(Kt={}));P.util.setEnumType(Kt,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var ks;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(ks||(ks={}));P.util.setEnumType(ks,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Ei;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(Ei||(Ei={}));P.util.setEnumType(Ei,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var Ks;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(Ks||(Ks={}));P.util.setEnumType(Ks,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var vs;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(vs||(vs={}));P.util.setEnumType(vs,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Id;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Id||(Id={}));P.util.setEnumType(Id,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Yl=class Au extends fe{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Pe.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new Au().fromBinary(e,n)}static fromJson(e,n){return new Au().fromJson(e,n)}static fromJsonString(e,n){return new Au().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Au,e,n)}};Yl.runtime=P;Yl.typeName="livekit.Room";Yl.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:li,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class li extends fe{constructor(e){super(),this.mime="",this.fmtpLine="",P.util.initPartial(e,this)}static fromBinary(e,n){return new li().fromBinary(e,n)}static fromJson(e,n){return new li().fromJson(e,n)}static fromJsonString(e,n){return new li().fromJsonString(e,n)}static equals(e,n){return P.util.equals(li,e,n)}}li.runtime=P;li.typeName="livekit.Codec";li.fields=P.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Do extends fe{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Do().fromBinary(e,n)}static fromJson(e,n){return new Do().fromJson(e,n)}static fromJsonString(e,n){return new Do().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Do,e,n)}}Do.runtime=P;Do.typeName="livekit.PlayoutDelay";Do.fields=P.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class Ts extends fe{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new Ts().fromBinary(e,n)}static fromJson(e,n){return new Ts().fromJson(e,n)}static fromJsonString(e,n){return new Ts().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ts,e,n)}}Ts.runtime=P;Ts.typeName="livekit.ParticipantPermission";Ts.fields=P.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:P.getEnumType(Dt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class br extends fe{constructor(e){super(),this.sid="",this.identity="",this.state=Ha.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Pe.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new br().fromBinary(e,n)}static fromJson(e,n){return new br().fromJson(e,n)}static fromJsonString(e,n){return new br().fromJsonString(e,n)}static equals(e,n){return P.util.equals(br,e,n)}}br.runtime=P;br.typeName="livekit.ParticipantInfo";br.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(Ha)},{no:4,name:"tracks",kind:"message",T:ir,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Ts},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var Ha;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(Ha||(Ha={}));P.util.setEnumType(Ha,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class Lo extends fe{constructor(e){super(),P.util.initPartial(e,this)}static fromBinary(e,n){return new Lo().fromBinary(e,n)}static fromJson(e,n){return new Lo().fromJson(e,n)}static fromJsonString(e,n){return new Lo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Lo,e,n)}}Lo.runtime=P;Lo.typeName="livekit.Encryption";Lo.fields=P.util.newFieldList(()=>[]);var mn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(mn||(mn={}));P.util.setEnumType(mn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class _s extends fe{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new _s().fromBinary(e,n)}static fromJson(e,n){return new _s().fromJson(e,n)}static fromJsonString(e,n){return new _s().fromJsonString(e,n)}static equals(e,n){return P.util.equals(_s,e,n)}}_s.runtime=P;_s.typeName="livekit.SimulcastCodecInfo";_s.fields=P.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Wn,repeated:!0}]);class ir extends fe{constructor(e){super(),this.sid="",this.type=Cn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Dt.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=mn.NONE,this.stream="",P.util.initPartial(e,this)}static fromBinary(e,n){return new ir().fromBinary(e,n)}static fromJson(e,n){return new ir().fromJson(e,n)}static fromJsonString(e,n){return new ir().fromJsonString(e,n)}static equals(e,n){return P.util.equals(ir,e,n)}}ir.runtime=P;ir.typeName="livekit.TrackInfo";ir.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:P.getEnumType(Cn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:P.getEnumType(Dt)},{no:10,name:"layers",kind:"message",T:Wn,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:_s,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:P.getEnumType(mn)},{no:17,name:"stream",kind:"scalar",T:9}]);class Wn extends fe{constructor(e){super(),this.quality=Kt.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Wn().fromBinary(e,n)}static fromJson(e,n){return new Wn().fromJson(e,n)}static fromJsonString(e,n){return new Wn().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Wn,e,n)}}Wn.runtime=P;Wn.typeName="livekit.VideoLayer";Wn.fields=P.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(Kt)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Ui extends fe{constructor(e){super(),this.kind=zt.RELIABLE,this.value={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new Ui().fromBinary(e,n)}static fromJson(e,n){return new Ui().fromJson(e,n)}static fromJsonString(e,n){return new Ui().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ui,e,n)}}Ui.runtime=P;Ui.typeName="livekit.DataPacket";Ui.fields=P.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:P.getEnumType(zt)},{no:2,name:"user",kind:"message",T:ji,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Cs,oneof:"value"}]);var zt;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(zt||(zt={}));P.util.setEnumType(zt,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Cs extends fe{constructor(e){super(),this.speakers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Cs().fromBinary(e,n)}static fromJson(e,n){return new Cs().fromJson(e,n)}static fromJsonString(e,n){return new Cs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Cs,e,n)}}Cs.runtime=P;Cs.typeName="livekit.ActiveSpeakerUpdate";Cs.fields=P.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Bi,repeated:!0}]);class Bi extends fe{constructor(e){super(),this.sid="",this.level=0,this.active=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new Bi().fromBinary(e,n)}static fromJson(e,n){return new Bi().fromJson(e,n)}static fromJsonString(e,n){return new Bi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Bi,e,n)}}Bi.runtime=P;Bi.typeName="livekit.SpeakerInfo";Bi.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class ji extends fe{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new ji().fromBinary(e,n)}static fromJson(e,n){return new ji().fromJson(e,n)}static fromJsonString(e,n){return new ji().fromJsonString(e,n)}static equals(e,n){return P.util.equals(ji,e,n)}}ji.runtime=P;ji.typeName="livekit.UserPacket";ji.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class $i extends fe{constructor(e){super(),this.participantSid="",this.trackSids=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new $i().fromBinary(e,n)}static fromJson(e,n){return new $i().fromJson(e,n)}static fromJsonString(e,n){return new $i().fromJsonString(e,n)}static equals(e,n){return P.util.equals($i,e,n)}}$i.runtime=P;$i.typeName="livekit.ParticipantTracks";$i.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class Is extends fe{constructor(e){super(),this.edition=Rl.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Is().fromBinary(e,n)}static fromJson(e,n){return new Is().fromJson(e,n)}static fromJsonString(e,n){return new Is().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Is,e,n)}}Is.runtime=P;Is.typeName="livekit.ServerInfo";Is.fields=P.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:P.getEnumType(Rl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Rl;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(Rl||(Rl={}));P.util.setEnumType(Rl,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Rs extends fe{constructor(e){super(),this.sdk=Pl.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Rs().fromBinary(e,n)}static fromJson(e,n){return new Rs().fromJson(e,n)}static fromJsonString(e,n){return new Rs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Rs,e,n)}}Rs.runtime=P;Rs.typeName="livekit.ClientInfo";Rs.fields=P.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:P.getEnumType(Pl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Pl;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(Pl||(Pl={}));P.util.setEnumType(Pl,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class Vi extends fe{constructor(e){super(),this.resumeConnection=Ei.UNSET,this.forceRelay=Ei.UNSET,P.util.initPartial(e,this)}static fromBinary(e,n){return new Vi().fromBinary(e,n)}static fromJson(e,n){return new Vi().fromJson(e,n)}static fromJsonString(e,n){return new Vi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Vi,e,n)}}Vi.runtime=P;Vi.typeName="livekit.ClientConfiguration";Vi.fields=P.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:zi},{no:2,name:"screen",kind:"message",T:zi},{no:3,name:"resume_connection",kind:"enum",T:P.getEnumType(Ei)},{no:4,name:"disabled_codecs",kind:"message",T:Ps},{no:5,name:"force_relay",kind:"enum",T:P.getEnumType(Ei)}]);class zi extends fe{constructor(e){super(),this.hardwareEncoder=Ei.UNSET,P.util.initPartial(e,this)}static fromBinary(e,n){return new zi().fromBinary(e,n)}static fromJson(e,n){return new zi().fromJson(e,n)}static fromJsonString(e,n){return new zi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(zi,e,n)}}zi.runtime=P;zi.typeName="livekit.VideoConfiguration";zi.fields=P.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:P.getEnumType(Ei)}]);class Ps extends fe{constructor(e){super(),this.codecs=[],this.publish=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Ps().fromBinary(e,n)}static fromJson(e,n){return new Ps().fromJson(e,n)}static fromJsonString(e,n){return new Ps().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ps,e,n)}}Ps.runtime=P;Ps.typeName="livekit.DisabledCodecs";Ps.fields=P.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:li,repeated:!0},{no:2,name:"publish",kind:"message",T:li,repeated:!0}]);class Wi extends fe{constructor(e){super(),this.duration=0,this.startTimestamp=Pe.zero,this.endTimestamp=Pe.zero,this.rtpClockTicks=Pe.zero,this.driftSamples=Pe.zero,this.driftMs=0,this.clockRate=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Wi().fromBinary(e,n)}static fromJson(e,n){return new Wi().fromJson(e,n)}static fromJsonString(e,n){return new Wi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Wi,e,n)}}Wi.runtime=P;Wi.typeName="livekit.RTPDrift";Wi.fields=P.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:an},{no:2,name:"end_time",kind:"message",T:an},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Fo extends fe{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Pe.zero,this.headerBytes=Pe.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Pe.zero,this.headerBytesDuplicate=Pe.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Pe.zero,this.headerBytesPadding=Pe.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Fo().fromBinary(e,n)}static fromJson(e,n){return new Fo().fromJson(e,n)}static fromJsonString(e,n){return new Fo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Fo,e,n)}}Fo.runtime=P;Fo.typeName="livekit.RTPStats";Fo.fields=P.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:an},{no:2,name:"end_time",kind:"message",T:an},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:an},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:an},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:an},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:an},{no:44,name:"packet_drift",kind:"message",T:Wi},{no:45,name:"report_drift",kind:"message",T:Wi}]);class Uo extends fe{constructor(e){super(),this.unixMicro=Pe.zero,this.ticks=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Uo().fromBinary(e,n)}static fromJson(e,n){return new Uo().fromJson(e,n)}static fromJsonString(e,n){return new Uo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Uo,e,n)}}Uo.runtime=P;Uo.typeName="livekit.TimedVersion";Uo.fields=P.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const wu=7e3,u8=[0,300,2*2*300,3*3*300,4*4*300,wu,wu,wu,wu,wu];class d8{constructor(e){this._retryDelays=e!==void 0?[...e]:u8}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function B(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function Nk(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ec(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Nk=="function"?Nk(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var lw={exports:{}},il=typeof Reflect=="object"?Reflect:null,Mk=il&&typeof il.apply=="function"?il.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},kh;il&&typeof il.ownKeys=="function"?kh=il.ownKeys:Object.getOwnPropertySymbols?kh=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:kh=function(e){return Object.getOwnPropertyNames(e)};function f8(t){console&&console.warn&&console.warn(t)}var oP=Number.isNaN||function(e){return e!==e};function Ke(){Ke.init.call(this)}lw.exports=Ke;lw.exports.once=g8;Ke.EventEmitter=Ke;Ke.prototype._events=void 0;Ke.prototype._eventsCount=0;Ke.prototype._maxListeners=void 0;var Ok=10;function gm(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ke,"defaultMaxListeners",{enumerable:!0,get:function(){return Ok},set:function(t){if(typeof t!="number"||t<0||oP(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Ok=t}});Ke.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ke.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||oP(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function aP(t){return t._maxListeners===void 0?Ke.defaultMaxListeners:t._maxListeners}Ke.prototype.getMaxListeners=function(){return aP(this)};Ke.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Mk(c,this,n);else for(var l=c.length,u=fP(c,l),r=0;r<l;++r)Mk(u[r],this,n);return!0};function cP(t,e,n,r){var i,s,o;if(gm(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=aP(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,f8(a)}return t}Ke.prototype.addListener=function(e,n){return cP(this,e,n,!1)};Ke.prototype.on=Ke.prototype.addListener;Ke.prototype.prependListener=function(e,n){return cP(this,e,n,!0)};function h8(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function lP(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=h8.bind(r);return i.listener=n,r.wrapFn=i,i}Ke.prototype.once=function(e,n){return gm(n),this.on(e,lP(this,e,n)),this};Ke.prototype.prependOnceListener=function(e,n){return gm(n),this.prependListener(e,lP(this,e,n)),this};Ke.prototype.removeListener=function(e,n){var r,i,s,o,a;if(gm(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():p8(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};Ke.prototype.off=Ke.prototype.removeListener;Ke.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function uP(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?m8(i):fP(i,i.length)}Ke.prototype.listeners=function(e){return uP(this,e,!0)};Ke.prototype.rawListeners=function(e){return uP(this,e,!1)};Ke.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):dP.call(t,e)};Ke.prototype.listenerCount=dP;function dP(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Ke.prototype.eventNames=function(){return this._eventsCount>0?kh(this._events):[]};function fP(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function p8(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function m8(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function g8(t,e){return new Promise(function(n,r){function i(o){t.removeListener(e,s),r(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}hP(t,e,s,{once:!0}),e!=="error"&&v8(t,i,{once:!0})})}function v8(t,e,n){typeof t.on=="function"&&hP(t,"error",e,n)}function hP(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var ds=lw.exports;let pP=!0,mP=!0;function Th(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function ac(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,a){if(o!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),i.apply(this,[o,c])};const s=r.removeEventListener;r.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function y8(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(pP=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function S8(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(mP=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function gP(){if(typeof window=="object"){if(pP)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function uw(t,e){mP&&console.warn(t+" is deprecated, please use "+e+" instead.")}function w8(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=Th(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Th(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Th(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Ak(t){return Object.prototype.toString.call(t)==="[object Object]"}function vP(t){return Ak(t)?Object.keys(t).reduce(function(e,n){const r=Ak(t[n]),i=r?vP(t[n]):t[n],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[n]:i})},{}):t}function Hy(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Hy(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{Hy(t,t.get(i),n)})}))}function Dk(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&s.push(o)}),s.forEach(o=>{t.forEach(a=>{a.type===r&&a.trackId===o.id&&Hy(t,a,i)})}),i}const Lk=gP;function yP(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",l)]=u.ideal,c.optional.push(f),f={},f[d("max",l)]=u.ideal,c.optional.push(f)):(f[d("",l)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(f,l)]=u[f])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(m=>p.label.toLowerCase().includes(m)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=l.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),Lk("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return Lk("chrome: "+JSON.stringify(a)),c(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,c,l){i(a,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(s(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function b8(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const s=r.video&&r.video.width,o=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},s&&(r.video.mandatory.maxWidth=s),o&&(r.video.mandatory.maxHeight=o),t.navigator.mediaDevices.getUserMedia(r)})}}}function SP(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function wP(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):s={track:i.track};const o=new Event("track");o.track=i.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.id):s={track:i};const o=new Event("track");o.track=i,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else ac(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function bP(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(c=>c.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function EP(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,s]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const o=function(c){const l={};return c.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),l[f.id]=f}),l},a=function(c){return new Map(Object.keys(c).map(l=>[l,c[l]]))};if(arguments.length>=2){const c=function(l){i(a(o(l)))};return e.apply(this,[c,r])}return new Promise((c,l)=>{e.apply(this,[function(u){c(a(o(u)))},l])}).then(i,s)}}function kP(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(o=>o._pc=this),s});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>Dk(o,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(s=>s._pc=this),i}),ac(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>Dk(s,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,s,o;return this.getSenders().forEach(a=>{a.track===r&&(i?o=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(s?o=!0:s=a),a.track===r)),o||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function TP(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(o);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function _P(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return TP(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(m=>m===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([u]);this._streams[d.id]=m,this._reverseStreams[m.id]=d,this.addStream(m)}return this.getSenders().find(m=>m.track===u)};function s(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const m=s(this,p);f[0].apply(null,[m])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};t.RTCPeerConnection.prototype[l]=d[l]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(m=>u.track===m)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Gy(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function CP(t,e){ac(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var Fk=Object.freeze({__proto__:null,fixNegotiationNeeded:CP,shimAddTrackRemoveTrack:_P,shimAddTrackRemoveTrackWithNative:TP,shimGetDisplayMedia:b8,shimGetSendersWithDtmf:bP,shimGetStats:EP,shimGetUserMedia:yP,shimMediaStream:SP,shimOnTrack:wP,shimPeerConnection:Gy,shimSenderReceiverGetStats:kP});function IP(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,s,o){uw("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(s,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,a,c){a in o&&!(c in o)&&(o[c]=o[a],delete o[a])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const a=o.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function E8(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function RP(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function qy(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=t.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return r.apply(this,[s||null]).then(c=>{if(e.version<53&&!o)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,d)=>{c.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(o,a)}}function PP(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function xP(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),ac(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function NP(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){uw("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function MP(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function OP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function AP(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function DP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function LP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Uk=Object.freeze({__proto__:null,shimAddTransceiver:OP,shimCreateAnswer:LP,shimCreateOffer:DP,shimGetDisplayMedia:E8,shimGetParameters:AP,shimGetUserMedia:IP,shimOnTrack:RP,shimPeerConnection:qy,shimRTCDataChannel:MP,shimReceiverGetStats:xP,shimRemoveStream:NP,shimSenderGetStats:PP});function FP(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function UP(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function BP(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f},e.createAnswer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f};let a=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(c,l,u){const d=s.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=a}function jP(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r($P(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function $P(t){return t&&t.video!==void 0?Object.assign({},t,{video:vP(t.video)}):t}function VP(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let o=0;o<r.iceServers.length;o++){let a=r.iceServers[o];a.urls===void 0&&a.url?(uw("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(r.iceServers[o])}r.iceServers=s}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function zP(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function WP(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function HP(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var Bk=Object.freeze({__proto__:null,shimAudioContext:HP,shimCallbacksAPI:BP,shimConstraints:$P,shimCreateOfferLegacy:WP,shimGetUserMedia:jP,shimLocalStreamsAPI:FP,shimRTCIceServerUrls:VP,shimRemoteStreamsAPI:UP,shimTrackEventTransceiver:zP}),GP={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const s=n.type;return r.push("typ"),r.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const s=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)i=s[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?s.push(o+"="+n.parameters[o]):s.push(o)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},s=n.indexOf(":",r);return s>-1?(i.attribute=n.substring(r+1,s),i.value=n.substring(s+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],s=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");r.profile=s[2];for(let a=3;a<s.length;a++){const c=s[a],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),d=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{o.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let s=0;return r.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),s=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(h.rtx={ssrc:l}),r.push(h),s&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let s;const o=r!==void 0?r:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(GP);var qP=GP.exports,sl=T6(qP),k8=E6({__proto__:null,default:sl},[qP]);function _h(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=sl.parseCandidate(r.candidate);for(const o in s)o in i||Object.defineProperty(i,o,{value:s[o]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,ac(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Jy(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||ac(t,"icecandidate",e=>{if(e.candidate){const n=sl.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Ch(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=sl.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=sl.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=sl.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),l=i(c),u=s(arguments[0],c);let d;l===0&&u===0?d=Number.POSITIVE_INFINITY:l===0||u===0?d=Math.max(l,u):d=Math.min(l,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return o.apply(this,arguments)}}function Ih(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},ac(t,"datachannel",r=>(e(r.channel,r.target),r))}function Ky(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",i);s.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Yy(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return n.apply(this,arguments)}}function Rh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ph(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}var T8=Object.freeze({__proto__:null,removeExtmapAllowMixed:Yy,shimAddIceCandidateNullOrEmpty:Rh,shimConnectionState:Ky,shimMaxMessageSize:Ch,shimParameterlessSetLocalDescription:Ph,shimRTCIceCandidate:_h,shimRTCIceCandidateRelayProtocol:Jy,shimSendThrowTypeError:Ih});function _8(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=gP,r=w8(t),i={browserDetails:r,commonShim:T8,extractVersion:Th,disableLog:y8,disableWarnings:S8,sdp:k8};switch(r.browser){case"chrome":if(!Fk||!Gy||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Fk,Rh(t,r),Ph(t),yP(t,r),SP(t),Gy(t,r),wP(t),_P(t,r),bP(t),EP(t),kP(t),CP(t,r),_h(t),Jy(t),Ky(t),Ch(t,r),Ih(t),Yy(t,r);break;case"firefox":if(!Uk||!qy||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Uk,Rh(t,r),Ph(t),IP(t,r),qy(t,r),RP(t),NP(t),PP(t),xP(t),MP(t),OP(t),AP(t),DP(t),LP(t),_h(t),Ky(t),Ch(t,r),Ih(t);break;case"safari":if(!Bk||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=Bk,Rh(t,r),Ph(t),VP(t),WP(t),BP(t),FP(t),UP(t),zP(t),jP(t),HP(t),_h(t),Jy(t),Ch(t,r),Ih(t),Yy(t,r);break;default:n("Unsupported browser!");break}return i}_8({window:typeof window>"u"?void 0:window});const C8=10,Vf="lk_e2ee",I8="LKFrameEncryptionKey",R8={sharedKey:!1,ratchetSalt:I8,ratchetWindowSize:8,failureTolerance:C8};var Xo;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(Xo||(Xo={}));var jk;(function(t){t.KeyRatcheted="keyRatcheted"})(jk||(jk={}));var Bo;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Bo||(Bo={}));var $k;(function(t){t.Error="cryptorError"})($k||($k={}));function P8(){return x8()||Xy()}function Xy(){return typeof window.RTCRtpScriptTransform<"u"}function x8(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class XQ extends ds.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{D.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},R8),e),this.on(Xo.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(Xo.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(Xo.RatchetRequest,e,n)}}class Xl extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class Et extends Xl{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class dw extends Xl{constructor(e){super(21,e??"device is unsupported")}}class Oi extends Xl{constructor(e){super(20,e??"track is invalid")}}class N8 extends Xl{constructor(e){super(10,e??"unsupported server")}}class Vt extends Xl{constructor(e){super(12,e??"unexpected connection state")}}class Qy extends Xl{constructor(e){super(13,e??"unable to negotiate")}}var Rd;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(Rd||(Rd={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(Rd||(Rd={}));var te;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(te||(te={}));var se;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(se||(se={}));var he;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(he||(he={}));var ue;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(ue||(ue={}));function fw(t,e,n){var r,i,s;e===void 0&&(e=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var h=Date.now()-l;if(h+e>=c)return c-h}return e}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(m,w){var g=o&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,l=Date.now(),!o){var b=t.apply(p,h);a&&a(b),u.forEach(function(C){return(0,C.resolve)(b)}),u=[]}},d()),g){var v=t.apply(p,h);return a&&a(v),m(v)}u.push({resolve:m,reject:w})})};return f.cancel=function(h){s!==void 0&&clearTimeout(s),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const M8=/version\/(\d+(\.?_?\d+)+)/i;let zg;function ia(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof t>"u"&&typeof navigator>"u")return;const n=(t??navigator.userAgent).toLowerCase();if(zg===void 0||e){const r=O8.find(i=>{let{test:s}=i;return s.test(n)});zg=r==null?void 0:r.describe(n)}return zg}const O8=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Wg(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Wg(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Wg(M8,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function Wg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var A8="1.15.5";const D8=A8,L8=11;class gn{}gn.setTimeout=function(){return setTimeout(...arguments)};gn.setInterval=function(){return setInterval(...arguments)};gn.clearTimeout=function(){return clearTimeout(...arguments)};gn.clearInterval=function(){return clearInterval(...arguments)};class at{constructor(e,n,r,i,s){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:s}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const F8=["vp8","h264"],JP=["vp8","h264","vp9","av1"];function U8(t){return!!F8.find(e=>e===t)}var yp;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(yp||(yp={}));const Pd={h90:new at(160,90,9e4,20),h180:new at(320,180,16e4,20),h216:new at(384,216,18e4,20),h360:new at(640,360,45e4,20),h540:new at(960,540,8e5,25),h720:new at(1280,720,17e5,30),h1080:new at(1920,1080,3e6,30),h1440:new at(2560,1440,5e6,30),h2160:new at(3840,2160,8e6,30)},Zy={h120:new at(160,120,7e4,20),h180:new at(240,180,125e3,20),h240:new at(320,240,14e4,20),h360:new at(480,360,33e4,20),h480:new at(640,480,5e5,20),h540:new at(720,540,6e5,25),h720:new at(960,720,13e5,30),h1080:new at(1440,1080,23e5,30),h1440:new at(1920,1440,38e5,30)},KP={h360fps3:new at(640,360,2e5,3,"medium"),h720fps5:new at(1280,720,4e5,5,"medium"),h720fps15:new at(1280,720,15e5,15,"medium"),h720fps30:new at(1280,720,2e6,30,"medium"),h1080fps15:new at(1920,1080,25e5,15,"medium"),h1080fps30:new at(1920,1080,4e6,30,"medium")};var In;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(In||(In={}));P.util.setEnumType(In,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var Ga;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(Ga||(Ga={}));P.util.setEnumType(Ga,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var Sp;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(Sp||(Sp={}));P.util.setEnumType(Sp,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class xs extends fe{constructor(e){super(),this.message={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new xs().fromBinary(e,n)}static fromJson(e,n){return new xs().fromJson(e,n)}static fromJsonString(e,n){return new xs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(xs,e,n)}}xs.runtime=P;xs.typeName="livekit.SignalRequest";xs.fields=P.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:Hn,oneof:"message"},{no:2,name:"answer",kind:"message",T:Hn,oneof:"message"},{no:3,name:"trickle",kind:"message",T:fi,oneof:"message"},{no:4,name:"add_track",kind:"message",T:di,oneof:"message"},{no:5,name:"mute",kind:"message",T:hi,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Lr,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Gi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Fr,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:qi,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Xi,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Qi,oneof:"message"},{no:13,name:"simulate",kind:"message",T:$n,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Ji,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:es,oneof:"message"}]);class Hi extends fe{constructor(e){super(),this.message={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new Hi().fromBinary(e,n)}static fromJson(e,n){return new Hi().fromJson(e,n)}static fromJsonString(e,n){return new Hi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Hi,e,n)}}Hi.runtime=P;Hi.typeName="livekit.SignalResponse";Hi.fields=P.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:Ns,oneof:"message"},{no:2,name:"answer",kind:"message",T:Hn,oneof:"message"},{no:3,name:"offer",kind:"message",T:Hn,oneof:"message"},{no:4,name:"trickle",kind:"message",T:fi,oneof:"message"},{no:5,name:"update",kind:"message",T:As,oneof:"message"},{no:6,name:"track_published",kind:"message",T:pi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Fr,oneof:"message"},{no:9,name:"mute",kind:"message",T:hi,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Ds,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Ls,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Us,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:js,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Vs,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:zs,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Os,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Ms,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Ws,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Gs,oneof:"message"}]);class ui extends fe{constructor(e){super(),this.codec="",this.cid="",P.util.initPartial(e,this)}static fromBinary(e,n){return new ui().fromBinary(e,n)}static fromJson(e,n){return new ui().fromJson(e,n)}static fromJsonString(e,n){return new ui().fromJsonString(e,n)}static equals(e,n){return P.util.equals(ui,e,n)}}ui.runtime=P;ui.typeName="livekit.SimulcastCodec";ui.fields=P.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class di extends fe{constructor(e){super(),this.cid="",this.name="",this.type=Cn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Dt.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=mn.NONE,this.stream="",P.util.initPartial(e,this)}static fromBinary(e,n){return new di().fromBinary(e,n)}static fromJson(e,n){return new di().fromJson(e,n)}static fromJsonString(e,n){return new di().fromJsonString(e,n)}static equals(e,n){return P.util.equals(di,e,n)}}di.runtime=P;di.typeName="livekit.AddTrackRequest";di.fields=P.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:P.getEnumType(Cn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:P.getEnumType(Dt)},{no:9,name:"layers",kind:"message",T:Wn,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:ui,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:P.getEnumType(mn)},{no:15,name:"stream",kind:"scalar",T:9}]);class fi extends fe{constructor(e){super(),this.candidateInit="",this.target=In.PUBLISHER,P.util.initPartial(e,this)}static fromBinary(e,n){return new fi().fromBinary(e,n)}static fromJson(e,n){return new fi().fromJson(e,n)}static fromJsonString(e,n){return new fi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(fi,e,n)}}fi.runtime=P;fi.typeName="livekit.TrickleRequest";fi.fields=P.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:P.getEnumType(In)}]);class hi extends fe{constructor(e){super(),this.sid="",this.muted=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new hi().fromBinary(e,n)}static fromJson(e,n){return new hi().fromJson(e,n)}static fromJsonString(e,n){return new hi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(hi,e,n)}}hi.runtime=P;hi.typeName="livekit.MuteTrackRequest";hi.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class Ns extends fe{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),P.util.initPartial(e,this)}static fromBinary(e,n){return new Ns().fromBinary(e,n)}static fromJson(e,n){return new Ns().fromJson(e,n)}static fromJsonString(e,n){return new Ns().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ns,e,n)}}Ns.runtime=P;Ns.typeName="livekit.JoinResponse";Ns.fields=P.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Yl},{no:2,name:"participant",kind:"message",T:br},{no:3,name:"other_participants",kind:"message",T:br,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Ki,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Vi},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Is},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class Ms extends fe{constructor(e){super(),this.iceServers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Ms().fromBinary(e,n)}static fromJson(e,n){return new Ms().fromJson(e,n)}static fromJsonString(e,n){return new Ms().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ms,e,n)}}Ms.runtime=P;Ms.typeName="livekit.ReconnectResponse";Ms.fields=P.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:Ki,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Vi}]);class pi extends fe{constructor(e){super(),this.cid="",P.util.initPartial(e,this)}static fromBinary(e,n){return new pi().fromBinary(e,n)}static fromJson(e,n){return new pi().fromJson(e,n)}static fromJsonString(e,n){return new pi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(pi,e,n)}}pi.runtime=P;pi.typeName="livekit.TrackPublishedResponse";pi.fields=P.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ir}]);class Os extends fe{constructor(e){super(),this.trackSid="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Os().fromBinary(e,n)}static fromJson(e,n){return new Os().fromJson(e,n)}static fromJsonString(e,n){return new Os().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Os,e,n)}}Os.runtime=P;Os.typeName="livekit.TrackUnpublishedResponse";Os.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class Hn extends fe{constructor(e){super(),this.type="",this.sdp="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Hn().fromBinary(e,n)}static fromJson(e,n){return new Hn().fromJson(e,n)}static fromJsonString(e,n){return new Hn().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Hn,e,n)}}Hn.runtime=P;Hn.typeName="livekit.SessionDescription";Hn.fields=P.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class As extends fe{constructor(e){super(),this.participants=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new As().fromBinary(e,n)}static fromJson(e,n){return new As().fromJson(e,n)}static fromJsonString(e,n){return new As().fromJsonString(e,n)}static equals(e,n){return P.util.equals(As,e,n)}}As.runtime=P;As.typeName="livekit.ParticipantUpdate";As.fields=P.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:br,repeated:!0}]);class Lr extends fe{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Lr().fromBinary(e,n)}static fromJson(e,n){return new Lr().fromJson(e,n)}static fromJsonString(e,n){return new Lr().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Lr,e,n)}}Lr.runtime=P;Lr.typeName="livekit.UpdateSubscription";Lr.fields=P.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:$i,repeated:!0}]);class Gi extends fe{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=Kt.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Gi().fromBinary(e,n)}static fromJson(e,n){return new Gi().fromJson(e,n)}static fromJsonString(e,n){return new Gi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Gi,e,n)}}Gi.runtime=P;Gi.typeName="livekit.UpdateTrackSettings";Gi.fields=P.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:P.getEnumType(Kt)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class Fr extends fe{constructor(e){super(),this.canReconnect=!1,this.reason=Ks.UNKNOWN_REASON,P.util.initPartial(e,this)}static fromBinary(e,n){return new Fr().fromBinary(e,n)}static fromJson(e,n){return new Fr().fromJson(e,n)}static fromJsonString(e,n){return new Fr().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Fr,e,n)}}Fr.runtime=P;Fr.typeName="livekit.LeaveRequest";Fr.fields=P.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:P.getEnumType(Ks)}]);class qi extends fe{constructor(e){super(),this.trackSid="",this.layers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new qi().fromBinary(e,n)}static fromJson(e,n){return new qi().fromJson(e,n)}static fromJsonString(e,n){return new qi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(qi,e,n)}}qi.runtime=P;qi.typeName="livekit.UpdateVideoLayers";qi.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Wn,repeated:!0}]);class Ji extends fe{constructor(e){super(),this.metadata="",this.name="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Ji().fromBinary(e,n)}static fromJson(e,n){return new Ji().fromJson(e,n)}static fromJsonString(e,n){return new Ji().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ji,e,n)}}Ji.runtime=P;Ji.typeName="livekit.UpdateParticipantMetadata";Ji.fields=P.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class Ki extends fe{constructor(e){super(),this.urls=[],this.username="",this.credential="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Ki().fromBinary(e,n)}static fromJson(e,n){return new Ki().fromJson(e,n)}static fromJsonString(e,n){return new Ki().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ki,e,n)}}Ki.runtime=P;Ki.typeName="livekit.ICEServer";Ki.fields=P.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Ds extends fe{constructor(e){super(),this.speakers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Ds().fromBinary(e,n)}static fromJson(e,n){return new Ds().fromJson(e,n)}static fromJsonString(e,n){return new Ds().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ds,e,n)}}Ds.runtime=P;Ds.typeName="livekit.SpeakersChanged";Ds.fields=P.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Bi,repeated:!0}]);class Ls extends fe{constructor(e){super(),P.util.initPartial(e,this)}static fromBinary(e,n){return new Ls().fromBinary(e,n)}static fromJson(e,n){return new Ls().fromJson(e,n)}static fromJsonString(e,n){return new Ls().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ls,e,n)}}Ls.runtime=P;Ls.typeName="livekit.RoomUpdate";Ls.fields=P.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Yl}]);class Fs extends fe{constructor(e){super(),this.participantSid="",this.quality=ks.POOR,this.score=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Fs().fromBinary(e,n)}static fromJson(e,n){return new Fs().fromJson(e,n)}static fromJsonString(e,n){return new Fs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Fs,e,n)}}Fs.runtime=P;Fs.typeName="livekit.ConnectionQualityInfo";Fs.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:P.getEnumType(ks)},{no:3,name:"score",kind:"scalar",T:2}]);class Us extends fe{constructor(e){super(),this.updates=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Us().fromBinary(e,n)}static fromJson(e,n){return new Us().fromJson(e,n)}static fromJsonString(e,n){return new Us().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Us,e,n)}}Us.runtime=P;Us.typeName="livekit.ConnectionQualityUpdate";Us.fields=P.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:Fs,repeated:!0}]);class Bs extends fe{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=Ga.ACTIVE,P.util.initPartial(e,this)}static fromBinary(e,n){return new Bs().fromBinary(e,n)}static fromJson(e,n){return new Bs().fromJson(e,n)}static fromJsonString(e,n){return new Bs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Bs,e,n)}}Bs.runtime=P;Bs.typeName="livekit.StreamStateInfo";Bs.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(Ga)}]);class js extends fe{constructor(e){super(),this.streamStates=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new js().fromBinary(e,n)}static fromJson(e,n){return new js().fromJson(e,n)}static fromJsonString(e,n){return new js().fromJsonString(e,n)}static equals(e,n){return P.util.equals(js,e,n)}}js.runtime=P;js.typeName="livekit.StreamStateUpdate";js.fields=P.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:Bs,repeated:!0}]);class mi extends fe{constructor(e){super(),this.quality=Kt.LOW,this.enabled=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new mi().fromBinary(e,n)}static fromJson(e,n){return new mi().fromJson(e,n)}static fromJsonString(e,n){return new mi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(mi,e,n)}}mi.runtime=P;mi.typeName="livekit.SubscribedQuality";mi.fields=P.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(Kt)},{no:2,name:"enabled",kind:"scalar",T:8}]);class $s extends fe{constructor(e){super(),this.codec="",this.qualities=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new $s().fromBinary(e,n)}static fromJson(e,n){return new $s().fromJson(e,n)}static fromJsonString(e,n){return new $s().fromJsonString(e,n)}static equals(e,n){return P.util.equals($s,e,n)}}$s.runtime=P;$s.typeName="livekit.SubscribedCodec";$s.fields=P.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:mi,repeated:!0}]);class Vs extends fe{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Vs().fromBinary(e,n)}static fromJson(e,n){return new Vs().fromJson(e,n)}static fromJsonString(e,n){return new Vs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Vs,e,n)}}Vs.runtime=P;Vs.typeName="livekit.SubscribedQualityUpdate";Vs.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:mi,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:$s,repeated:!0}]);class Yi extends fe{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Yi().fromBinary(e,n)}static fromJson(e,n){return new Yi().fromJson(e,n)}static fromJsonString(e,n){return new Yi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Yi,e,n)}}Yi.runtime=P;Yi.typeName="livekit.TrackPermission";Yi.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class Xi extends fe{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Xi().fromBinary(e,n)}static fromJson(e,n){return new Xi().fromJson(e,n)}static fromJsonString(e,n){return new Xi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Xi,e,n)}}Xi.runtime=P;Xi.typeName="livekit.SubscriptionPermission";Xi.fields=P.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Yi,repeated:!0}]);class zs extends fe{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new zs().fromBinary(e,n)}static fromJson(e,n){return new zs().fromJson(e,n)}static fromJsonString(e,n){return new zs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(zs,e,n)}}zs.runtime=P;zs.typeName="livekit.SubscriptionPermissionUpdate";zs.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class Qi extends fe{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Qi().fromBinary(e,n)}static fromJson(e,n){return new Qi().fromJson(e,n)}static fromJsonString(e,n){return new Qi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Qi,e,n)}}Qi.runtime=P;Qi.typeName="livekit.SyncState";Qi.fields=P.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:Hn},{no:2,name:"subscription",kind:"message",T:Lr},{no:3,name:"publish_tracks",kind:"message",T:pi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Zi,repeated:!0},{no:5,name:"offer",kind:"message",T:Hn}]);class Zi extends fe{constructor(e){super(),this.label="",this.id=0,this.target=In.PUBLISHER,P.util.initPartial(e,this)}static fromBinary(e,n){return new Zi().fromBinary(e,n)}static fromJson(e,n){return new Zi().fromJson(e,n)}static fromJsonString(e,n){return new Zi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Zi,e,n)}}Zi.runtime=P;Zi.typeName="livekit.DataChannelInfo";Zi.fields=P.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:P.getEnumType(In)}]);class $n extends fe{constructor(e){super(),this.scenario={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new $n().fromBinary(e,n)}static fromJson(e,n){return new $n().fromJson(e,n)}static fromJsonString(e,n){return new $n().fromJsonString(e,n)}static equals(e,n){return P.util.equals($n,e,n)}}$n.runtime=P;$n.typeName="livekit.SimulateScenario";$n.fields=P.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:P.getEnumType(Sp),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"}]);class es extends fe{constructor(e){super(),this.timestamp=Pe.zero,this.rtt=Pe.zero,P.util.initPartial(e,this)}static fromBinary(e,n){return new es().fromBinary(e,n)}static fromJson(e,n){return new es().fromJson(e,n)}static fromJsonString(e,n){return new es().fromJsonString(e,n)}static equals(e,n){return P.util.equals(es,e,n)}}es.runtime=P;es.typeName="livekit.Ping";es.fields=P.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class Ws extends fe{constructor(e){super(),this.lastPingTimestamp=Pe.zero,this.timestamp=Pe.zero,P.util.initPartial(e,this)}static fromBinary(e,n){return new Ws().fromBinary(e,n)}static fromJson(e,n){return new Ws().fromJson(e,n)}static fromJsonString(e,n){return new Ws().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ws,e,n)}}Ws.runtime=P;Ws.typeName="livekit.Pong";Ws.fields=P.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class jo extends fe{constructor(e){super(),this.regions=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new jo().fromBinary(e,n)}static fromJson(e,n){return new jo().fromJson(e,n)}static fromJsonString(e,n){return new jo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(jo,e,n)}}jo.runtime=P;jo.typeName="livekit.RegionSettings";jo.fields=P.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Hs,repeated:!0}]);class Hs extends fe{constructor(e){super(),this.region="",this.url="",this.distance=Pe.zero,P.util.initPartial(e,this)}static fromBinary(e,n){return new Hs().fromBinary(e,n)}static fromJson(e,n){return new Hs().fromJson(e,n)}static fromJsonString(e,n){return new Hs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Hs,e,n)}}Hs.runtime=P;Hs.typeName="livekit.RegionInfo";Hs.fields=P.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class Gs extends fe{constructor(e){super(),this.trackSid="",this.err=Id.SE_UNKNOWN,P.util.initPartial(e,this)}static fromBinary(e,n){return new Gs().fromBinary(e,n)}static fromJson(e,n){return new Gs().fromJson(e,n)}static fromJsonString(e,n){return new Gs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Gs,e,n)}}Gs.runtime=P;Gs.typeName="livekit.SubscriptionResponse";Gs.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:P.getEnumType(Id)}]);function B8(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const j8=5e3,bu=[];class J extends ds.EventEmitter{constructor(e,n){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=J.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),j8):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=J.Source.Unknown}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===J.Kind.Video&&(n="video"),this.attachedElements.length===0&&J.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(bu.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&bu.splice(bu.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),$c(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(i?ue.AudioPlaybackStarted:ue.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(i?ue.AudioPlaybackFailed:ue.VideoPlaybackFailed,s):s.name==="AbortError"?D.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):D.warn("could not playback ".concat(i?"audio":"video"),s),i&&e&&r.some(o=>o.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ue.ElementAttached,e),e}detach(e){try{if(e){ol(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ue.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{ol(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(ue.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),bu.forEach(r=>{r.parentElement||(n=!1)}),n&&bu.push(e)}}handleAppVisibilityChanged(){return B(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){cr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){cr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function $c(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!qa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(qa()||xl())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function ol(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return Cn.AUDIO;case e.Video:return Cn.VIDEO;default:return Cn.DATA}}t.kindToProto=i;function s(l){switch(l){case Cn.AUDIO:return e.Audio;case Cn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=s;function o(l){switch(l){case n.Camera:return Dt.CAMERA;case n.Microphone:return Dt.MICROPHONE;case n.ScreenShare:return Dt.SCREEN_SHARE;case n.ScreenShareAudio:return Dt.SCREEN_SHARE_AUDIO;default:return Dt.UNKNOWN}}t.sourceToProto=o;function a(l){switch(l){case Dt.CAMERA:return n.Camera;case Dt.MICROPHONE:return n.Microphone;case Dt.SCREEN_SHARE:return n.ScreenShare;case Dt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function c(l){switch(l){case Ga.ACTIVE:return r.Active;case Ga.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(J||(J={}));function YP(t,e,n){var r;const i=(r=B8(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&e0(i.audio,e),i.video&&e0(i.video,n),i}function e0(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function vm(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(s=>{switch(s){case"resolution":e0(r,i.resolution);break;default:r[s]=i[s]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function $8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return B(this,void 0,void 0,function*(){const n=hw();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,s=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield Ys(e),r.getByteTimeDomainData(s);const a=s.some(c=>c!==128&&c!==0);return n.close(),!a}return!1})}function hw(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function V8(t){return t===J.Source.Microphone?"audioinput":t===J.Source.Camera?"videoinput":void 0}function z8(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&(r=typeof r=="boolean"?{}:r,qa()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function XP(t){const e=t.split("/")[1].toLowerCase();if(!JP.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function W8(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new pi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}const H8="|",Vk="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function G8(t){const e=t.split(H8);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function Ys(t){return B(this,void 0,void 0,function*(){return new Promise(e=>gn.setTimeout(e,t))})}function zk(){return"addTransceiver"in RTCPeerConnection.prototype}function Wk(){return"addTrack"in RTCPeerConnection.prototype}function q8(){if(!("getCapabilities"in RTCRtpSender)||qa())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function J8(){if(!("getCapabilities"in RTCRtpSender)||xl())return!1;if(qa()){const n=ia();if(n!=null&&n.version&&pw(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Ku(t){return t==="av1"||t==="vp9"}function t0(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const K8={Chrome:"100",Safari:"15",Firefox:"100"};function Y8(t){if(!cr()||!("setCodecPreferences"in t))return!1;const e=ia();if(!(e!=null&&e.name)||!e.version)return!1;const n=K8[e.name];return n?pw(e.version,n)>=0:!1}function xl(){var t;return((t=ia())===null||t===void 0?void 0:t.name)==="Firefox"}function X8(){var t;return((t=ia())===null||t===void 0?void 0:t.name)==="Chrome"}function qa(){var t;return((t=ia())===null||t===void 0?void 0:t.name)==="Safari"}function QP(){return cr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function cr(){return typeof document<"u"}function Ja(){return navigator.product=="ReactNative"}function n0(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function ZP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function ex(){if(!Ja())return;let t=ZP();if(t)return t.platform}function Hk(){if(cr())return window.devicePixelRatio;if(Ja()){let t=ZP();if(t)return t.devicePixelRatio}return 1}function pw(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let s=0;s<i;++s){const o=parseInt(n[s],10),a=parseInt(r[s],10);if(o>a)return 1;if(o<a)return-1;if(s===i-1&&o===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function Q8(t){for(const e of t)e.target.handleResize(e)}function Z8(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Hg=null;const Gk=()=>(Hg||(Hg=new ResizeObserver(Q8)),Hg);let Gg=null;const qk=()=>(Gg||(Gg=new IntersectionObserver(Z8,{root:null,rootMargin:"0px"})),Gg);function ej(){var t;const e=new Rs({sdk:Pl.JS,protocol:L8,version:D8});return Ja()&&(e.os=(t=ex())!==null&&t!==void 0?t:""),e}function Jk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const s=i.getContext("2d");s==null||s.fillRect(0,0,i.width,i.height),r&&s&&(s.beginPath(),s.arc(t/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const o=i.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Eu;function qg(){if(!Eu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Eu]=r.stream.getAudioTracks(),!Eu)throw Error("Could not get empty media stream audio track");Eu.enabled=!1}return Eu.clone()}class tx{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>B(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function tj(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=hw();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,s=r.createMediaStreamSource(new MediaStream([i])),o=r.createAnalyser();o.minDecibels=n.minDecibels,o.maxDecibels=n.maxDecibels,o.fftSize=n.fftSize,o.smoothingTimeConstant=n.smoothingTimeConstant,s.connect(o);const a=new Uint8Array(o.frequencyBinCount);return{calculateVolume:()=>{o.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:o,cleanup:()=>B(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class yi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function nj(t){return JP.includes(t)}function Da(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function rj(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function Kk(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const Yk="default";class Vn{static getInstance(){return this.instance===void 0&&(this.instance=new Vn),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return B(this,void 0,void 0,function*(){if(((r=Vn.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){D.debug("awaiting getUserMedia promise");try{e?yield Vn.userMediaPromiseMap.get(e):yield Promise.all(Vn.userMediaPromiseMap.values())}catch{D.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(qa()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(o=>{const a=o.label==="",c=e?o.kind===e:!0;return a&&c}))){const o={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(o);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(c=>{c.stop()})}return e&&(i=i.filter(s=>s.kind===e)),i})}normalizeDeviceId(e,n,r){return B(this,void 0,void 0,function*(){if(n!==Yk)return n;const s=(yield this.getDevices(e)).find(o=>o.groupId===r&&o.deviceId!==Yk);return s==null?void 0:s.deviceId})}hasDeviceInUse(e){return e?Vn.userMediaPromiseMap.has(e):Vn.userMediaPromiseMap.size>0}}Vn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Vn.userMediaPromiseMap=new Map;const ij=1e3;class Nl extends J{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;super(e,n),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>D.debug("track mute bounce got cancelled by an unmute event")),this.debouncedTrackMuteHandler=fw(()=>B(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>B(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ue.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new yi,this.pauseUpstreamLock=new yi,this.processorLock=new yi,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==J.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return B(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{ol(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop()),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(D.debug("restarting processor"),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");$c(e,this.processorElement),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{$c(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ij;var n;return B(this,void 0,void 0,function*(){if(this.kind===J.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=ia())===null||n===void 0?void 0:n.os)==="iOS"&&(yield Ys(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield Ys(50)}throw new Oi("unable to get track dimensions after timeout")})}getDeviceId(){return B(this,void 0,void 0,function*(){if(this.source===J.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===J.Kind.Audio?"audioinput":"videoinput";return Vn.getInstance().normalizeDeviceId(r,e,n)})}mute(){return B(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return B(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return B(this,void 0,void 0,function*(){if(!this.sender)throw new Oi("unable to replace an unpublished track");return D.debug("replace MediaStreamTrack"),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return B(this,void 0,void 0,function*(){e||(e=this._constraints),D.debug("restarting track with constraints",e);const n={audio:!1,video:!1};this.kind===J.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(s=>{ol(this.mediaStreamTrack,s)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),D.debug("re-acquired MediaStreamTrack"),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(ue.Restarted,this),this})}setTrackMuted(e){D.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ue.Muted:ue.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return B(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),QP()&&(D.debug("visibility changed, is in Background: ".concat(this.isInBackground)),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(D.debug("track needs to be reacquired, restarting ".concat(this.source)),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return B(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){D.warn("unable to pause upstream for an unpublished track");return}this._isUpstreamPaused=!0,this.emit(ue.UpstreamPaused,this);const n=ia();if((n==null?void 0:n.name)==="Safari"&&pw(n.version,"12.0")<0)throw new dw("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return B(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){D.warn("unable to resume upstream for an unpublished track");return}this._isUpstreamPaused=!1,this.emit(ue.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return B(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return B(this,void 0,void 0,function*(){const s=yield this.processorLock.lock();try{if(D.debug("setting up processor"),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),this.processorElement.muted=!0,$c(this._mediaStreamTrack,this.processorElement),this.processorElement.play().catch(a=>D.error("failed to play processor element",{error:a}));const o={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(o),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(ol(this._mediaStreamTrack,a),$c(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{s()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return B(this,void 0,void 0,function*(){this.processor&&(D.debug("stopping processor"),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class sj extends ds.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:s,data:o}=n.data;switch(s){case"error":D.error(o.error.message),this.emit(Bo.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==o.enabled&&o.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Bo.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(o.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(Bo.ParticipantEncryptionStatusChanged,o.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(Xo.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{D.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Bo.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!P8())throw new dw("tried to setup end-to-end encryption on an unsupported browser");if(D.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(D.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){D.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?D.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(he.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(te.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==mn.NONE,i.identity)),e.on(te.ConnectionStateChanged,r=>{r===Ve.Connected&&e.participants.forEach(i=>{i.tracks.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==mn.NONE,i.identity)})})}).on(te.TrackUnsubscribed,(r,i,s)=>{var o;const a={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(a)}).on(te.TrackSubscribed,(r,i,s)=>{this.setupE2EEReceiver(r,s.identity,i.trackInfo)}).on(te.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(se.LocalTrackPublished,r=>B(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(Xo.SetKey,r=>this.postKey(r)).on(Xo.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?XP(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Nl)||!n){n||D.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return B(this,void 0,void 0,function*(){if(this.worker){if(Xy()){const s={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(Vf in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let s=e.writableStream,o=e.readableStream;if(!s||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,s=c.writable,e.readableStream=c.readable,o=c.readable}const a={kind:"decode",data:{readableStream:o,writableStream:s,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[o,s])}e[Vf]=!0}})}handleSender(e,n,r){var i;if(!(Vf in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Xy()){D.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{D.info("initialize encoded streams");const s=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[s.readable,s.writable])}e[Vf]=!0}}}var Yu;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Yu||(Yu={}));class oj{constructor(){this.pendingTasks=new Map,this.taskMutex=new yi,this.nextTaskIndex=0}run(e){return B(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Yu.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Yu.RUNNING,yield e()}finally{n.status=Yu.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return B(this,void 0,void 0,function*(){return this.run(()=>B(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const aj=["syncState","trickle","offer","answer","simulate","leave"];function cj(t){const e=aj.indexOf(t.case)>=0;return D.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var nn;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(nn||(nn={}));class mw{get currentState(){return this.state}get isDisconnected(){return this.state===nn.DISCONNECTING||this.state===nn.DISCONNECTED}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.rtt=0,this.state=nn.DISCONNECTED,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.useJSON=e,this.requestQueue=new oj,this.queuedRequests=[],this.closingLock=new yi,this.connectionLock=new yi,this.state=nn.DISCONNECTED}join(e,n,r,i){return B(this,void 0,void 0,function*(){return this.state=nn.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return B(this,void 0,void 0,function*(){if(!this.options){D.warn("attempted to reconnect without signal options being set, ignoring");return}return this.state=nn.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=rj(e),e=e.replace(/\/$/,""),e+="/rtc";const s=ej(),o=lj(n,s,r);return new Promise((a,c)=>B(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>B(this,void 0,void 0,function*(){this.close(),clearTimeout(d),c(new Et("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),c(new Et("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),D.debug("connecting to ".concat(e+o)),this.ws&&(yield this.close()),this.ws=new WebSocket(e+o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>B(this,void 0,void 0,function*(){if(this.state!==nn.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(e.substring(2),"/validate").concat(o));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();c(new Et(p,0,h.status))}else c(new Et("Internal error",2,h.status))}catch{c(new Et("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>B(this,void 0,void 0,function*(){var h,p,m,w;let g;if(typeof f.data=="string"){const v=JSON.parse(f.data);g=Hi.fromJson(v)}else if(f.data instanceof ArrayBuffer)g=Hi.fromBinary(new Uint8Array(f.data));else{D.error("could not decode websocket message: ".concat(typeof f.data));return}if(this.state!==nn.CONNECTED){let v=!1;if(((h=g.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=nn.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=g.message.value.pingTimeout,this.pingIntervalDuration=g.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(D.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),a(g.message.value)):this.state===nn.RECONNECTING?(this.state=nn.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=g.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((m=g.message)===null||m===void 0?void 0:m.value):(a(),v=!0)):r.reconnect||c(new Et("did not receive join response, got ".concat((w=g.message)===null||w===void 0?void 0:w.case," instead"))),!v)return}this.signalLatency&&(yield Ys(this.signalLatency)),this.handleSignalResponse(g)}),this.ws.onclose=f=>{D.warn("websocket closed",{ev:f}),this.handleOnClose(f.reason)}}finally{l()}}))}close(){return B(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();try{if(this.state=nn.DISCONNECTING,this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const n=new Promise(r=>{this.ws?this.ws.onclose=()=>{r()}:r()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([n,Ys(250)])),this.ws=void 0}}finally{this.state=nn.DISCONNECTED,this.clearPingInterval(),e()}})}sendOffer(e){D.debug("sending offer",e),this.sendRequest({case:"offer",value:wp(e)})}sendAnswer(e){return D.debug("sending answer"),this.sendRequest({case:"answer",value:wp(e)})}sendIceCandidate(e,n){return D.trace("sending ice candidate",e),this.sendRequest({case:"trickle",value:new fi({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new hi({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new Ji({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new qi({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new Xi({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Pe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new es({timestamp:Pe.parse(Date.now()),rtt:Pe.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new Fr({canReconnect:!1,reason:Ks.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return B(this,void 0,void 0,function*(){if(!n&&!cj(e)&&this.state===nn.RECONNECTING){this.queuedRequests.push(()=>B(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield Ys(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){D.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case));return}const i=new xs({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(s){D.error("error sending signal message",{error:s})}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){D.debug("received unsupported message");return}let s=!1;if(i.case==="answer"){const o=Xk(i.value);this.onAnswer&&this.onAnswer(o)}else if(i.case==="offer"){const o=Xk(i.value);this.onOffer&&this.onOffer(o)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):D.debug("unsupported message",i));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return B(this,void 0,void 0,function*(){if(this.state===nn.DISCONNECTED)return;const n=this.onClose;yield this.close(),D.debug("websocket connection closed: ".concat(e)),n&&n(e)})}handleWSError(e){D.error("websocket error",e)}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){D.warn("ping timeout duration not set");return}this.pingTimeout=gn.setTimeout(()=>{D.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString())),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&gn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){D.warn("ping interval duration not set");return}D.debug("start ping interval"),this.pingInterval=gn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){D.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&gn.clearInterval(this.pingInterval)}}function Xk(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function wp(t){return new Hn({sdp:t.sdp,type:t.type})}function lj(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Ja()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var nx={},rx={exports:{}},Qk=rx.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Qk).forEach(function(t){var e=Qk[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var ix=rx.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=e(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=e(a[d+1]))},r=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},i=ix,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var m=i[f][p];if(m.reg.test(h))return r(m,u,h)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(nx);var Jg=ix,uj=/%[sdv%]/g,dj=function(t){var e=1,n=arguments,r=n.length;return t.replace(uj,function(i){if(e>=r)return i;var s=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},ku=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var s=0;s<e.names.length;s+=1){var o=e.names[s];e.name?i.push(n[e.name][o]):i.push(n[e.names[s]])}else i.push(n[e.name]);return dj.apply(null,i)},fj=["v","o","s","i","u","e","p","c","b","t","r","z","a"],hj=["i","c","b","a"],pj=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var n=e.outerOrder||fj,r=e.innerOrder||hj,i=[];return n.forEach(function(s){Jg[s].forEach(function(o){o.name in t&&t[o.name]!=null?i.push(ku(s,o,t)):o.push in t&&t[o.push]!=null&&t[o.push].forEach(function(a){i.push(ku(s,o,a))})})}),t.media.forEach(function(s){i.push(ku("m",Jg.m[0],s)),r.forEach(function(o){Jg[o].forEach(function(a){a.name in s&&s[a.name]!=null?i.push(ku(o,a,s)):a.push in s&&s[a.push]!=null&&s[a.push].forEach(function(c){i.push(ku(o,a,c))})})})}),i.join(`\r
`)+`\r
`},mj=nx,gj=pj,Kg=gj,Du=mj.parse;const Zk=.7,al={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class eT extends ds.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=fw(r=>B(this,void 0,void 0,function*(){this.emit(al.NegotiationStarted);try{yield this.createAndSendOffer()}catch(i){if(r)r(i);else throw i}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=X8()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return B(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return B(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:s}=yj(e);this.remoteStereoMids=i,this.remoteNackMids=s}else if(e.type==="answer"){const i=Du((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||s.mid!=o.transceiver.mid)return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),c=!0;break}return c||o.maxbr>0&&s.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),r=Kg(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(al.NegotiationComplete),e.sdp&&Du(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(al.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){var n;return B(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(D.debug("restarting ICE"),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){D.warn("could not createOffer with closed peer connection");return}D.debug("starting to negotiate");const r=yield this.pc.createOffer(e),i=Du((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"?tT(s,[],[]):s.type==="video"&&(vj(s),this.trackBitrates.some(o=>{if(!s.msid||!o.cid||!s.msid.includes(o.cid))return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(Math.round(o.maxbr*Zk))),l.config.includes("x-google-max-bitrate")||(l.config+=";x-google-max-bitrate=".concat(o.maxbr)),c=!0;break}return c||s.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(o.maxbr*Zk),";x-google-max-bitrate=").concat(o.maxbr)}),!0}))}),yield this.setMungedSDP(r,Kg(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return B(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=Du((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&tT(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Kg(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Vt("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Vt("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return B(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const o=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(o!==void 0)return i.get(o)})}setMungedSDP(e,n,r){return B(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{D.debug("setting munged ".concat(r?"remote":"local"," description")),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){D.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),{error:s,sdp:n}),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let s="unknown error";i instanceof Error?s=i.message:typeof i=="string"&&(s=i);const o={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),D.error("unable to set ".concat(e.type),o),new Qy(s)}})}}function tT(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function vj(t){var e,n,r,i;const s=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!Ku(s))return;let o=0;((r=t.ext)===null||r===void 0?void 0:r.some(c=>c.uri===Vk?!0:(c.value>o&&(o=c.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:o+1,uri:Vk})}function yj(t){var e;const n=[],r=[],i=Du((e=t.sdp)!==null&&e!==void 0?e:"");let s=0;return i.media.forEach(o=>{var a;o.type==="audio"&&(o.rtp.some(c=>c.codec==="opus"?(s=c.payload,!0):!1),!((a=o.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===s&&c.type==="nack")&&r.push(o.mid),o.fmtp.some(c=>c.payload===s?(c.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const r0="vp8",Sj={audioBitrate:yp.music.maxBitrate,audioPreset:yp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:KP.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:r0,backupCodec:!0},sx={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},ox={resolution:Pd.h720.resolution},wj={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new d8,disconnectOnPageLeave:!0,expWebAudioMix:!1},gw={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Wt;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(Wt||(Wt={}));class bj{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n){this.peerConnectionTimeout=gw.peerConnectionTimeout,this.updateState=()=>{var i;const s=this.state,o=this.requiredTransports.map(a=>a.getConnectionState());o.every(a=>a==="connected")?this.state=Wt.CONNECTED:o.some(a=>a==="failed")?this.state=Wt.FAILED:o.some(a=>a==="connecting")?this.state=Wt.CONNECTING:o.every(a=>a==="closed")?this.state=Wt.CLOSED:o.some(a=>a==="closed")?this.state=Wt.CLOSING:o.every(a=>a==="new")&&(this.state=Wt.NEW),s!==this.state&&(D.debug("pc state change: from ".concat(Wt[s]," to ").concat(Wt[this.state])),(i=this.onStateChange)===null||i===void 0||i.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const r={optional:[{googDscp:!0}]};this.publisher=new eT(e,r),this.subscriber=new eT(e),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=i=>{var s;(s=this.onIceCandidate)===null||s===void 0||s.call(this,i,In.PUBLISHER)},this.subscriber.onIceCandidate=i=>{var s;(s=this.onIceCandidate)===null||s===void 0||s.call(this,i,In.SUBSCRIBER)},this.subscriber.onDataChannel=i=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,i)},this.subscriber.onTrack=i=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,i)},this.publisher.onOffer=i=>{var s;(s=this.onPublisherOffer)===null||s===void 0||s.call(this,i)},this.state=Wt.NEW,this.connectionLock=new yi}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return B(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){D.warn("could not removeTrack",{error:r})}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return B(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return B(this,void 0,void 0,function*(){n===In.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return B(this,void 0,void 0,function*(){return D.debug("received server offer",{RTCSdpType:e.type,signalingState:this.subscriber.getSignallingState().toString()}),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return B(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(D.debug("negotiation required, start negotiating"),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,n)))}finally{i()}})}negotiate(e){return B(this,void 0,void 0,function*(){return new Promise((n,r)=>B(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(al.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(al.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===In.PUBLISHER?this.publisher.getConnectedAddress():e===In.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return B(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((s,o)=>B(this,void 0,void 0,function*(){const a=()=>{D.warn("abort transport connection"),gn.clearTimeout(c),o(new Et("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const c=gn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),o(new Et("could not establish pc connection"))},r);for(;this.state!==Wt.CONNECTED;)if(yield Ys(50),n!=null&&n.signal.aborted){o(new Et("room connection has been cancelled",3));return}gn.clearTimeout(c),n==null||n.signal.removeEventListener("abort",a),s()}))})}}const nT="_lossy",rT="_reliable",Ej=2*1e3,iT="leave-reconnect";var qr;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(qr||(qr={}));class kj extends ds.EventEmitter{get isClosed(){return this._isClosed}constructor(e){super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=gw.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=qr.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=n=>{let{channel:r}=n;return B(this,void 0,void 0,function*(){if(r){if(r.label===rT)this.reliableDCSub=r;else if(r.label===nT)this.lossyDCSub=r;else return;D.debug("on data channel ".concat(r.id,", ").concat(r.label)),r.onmessage=this.handleDataMessage}})},this.handleDataMessage=n=>B(this,void 0,void 0,function*(){var r,i;const s=yield this.dataProcessLock.lock();try{let o;if(n.data instanceof ArrayBuffer)o=n.data;else if(n.data instanceof Blob)o=yield n.data.arrayBuffer();else{D.error("unsupported data type",n.data);return}const a=Ui.fromBinary(new Uint8Array(o));((r=a.value)===null||r===void 0?void 0:r.case)==="speaker"?this.emit(he.ActiveSpeakersUpdate,a.value.value.speakers):((i=a.value)===null||i===void 0?void 0:i.case)==="user"&&this.emit(he.DataPacketReceived,a.value.value,a.kind)}finally{s()}}),this.handleDataError=n=>{const i=n.currentTarget.maxRetransmits===0?"lossy":"reliable";if(n instanceof ErrorEvent&&n.error){const{error:s}=n.error;D.error("DataChannel error on ".concat(i,": ").concat(n.message),s)}else D.error("Unknown DataChannel error on ".concat(i),n)},this.handleBufferedAmountLow=n=>{const i=n.currentTarget.maxRetransmits===0?zt.LOSSY:zt.RELIABLE;this.updateAndEmitDCBufferStatus(i)},this.handleDisconnect=(n,r)=>{if(this._isClosed)return;D.warn("".concat(n," disconnected")),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const i=a=>{D.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(a,"ms. giving up")),this.emit(he.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let o=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(o===null){i(s);return}n===iT&&(o=0),D.debug("reconnecting in ".concat(o,"ms")),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=gn.setTimeout(()=>this.attemptReconnect(r),o)},this.waitForRestarted=()=>new Promise((n,r)=>{this.pcState===qr.Connected&&n();const i=()=>{this.off(he.Disconnected,s),n()},s=()=>{this.off(he.Restarted,i),r()};this.once(he.Restarted,i),this.once(he.Disconnected,s)}),this.updateAndEmitDCBufferStatus=n=>{const r=this.isBufferStatusLow(n);typeof r<"u"&&r!==this.dcBufferStatus.get(n)&&(this.dcBufferStatus.set(n,r),this.emit(he.DCBufferStatusChanged,r,n))},this.isBufferStatusLow=n=>{const r=this.dataChannelForKind(n);if(r)return r.bufferedAmount<=r.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===nn.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(vs.RR_SIGNAL_DISCONNECTED))},this.client=new mw,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new yi,this.dataProcessLock=new yi,this.dcBufferStatus=new Map([[zt.LOSSY,!0],[zt.RELIABLE,!0]]),this.client.onParticipantUpdate=n=>this.emit(he.ParticipantUpdate,n),this.client.onConnectionQuality=n=>this.emit(he.ConnectionQualityUpdate,n),this.client.onRoomUpdate=n=>this.emit(he.RoomUpdate,n),this.client.onSubscriptionError=n=>this.emit(he.SubscriptionError,n),this.client.onSubscriptionPermissionUpdate=n=>this.emit(he.SubscriptionPermissionUpdate,n),this.client.onSpeakersChanged=n=>this.emit(he.SpeakersChanged,n),this.client.onStreamStateUpdate=n=>this.emit(he.StreamStateChanged,n)}join(e,n,r,i){return B(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof Et&&s.reason===1&&(D.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw s}})}close(){return B(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(he.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return B(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return B(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Oi("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Et("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(i),n(s)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){D.warn("failed to remove track",{error:n,method:"removeTrack"})}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return B(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return B(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==Wt.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new bj(r,e.subscriberPrimary),this.emit(he.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,s)=>{this.client.sendIceCandidate(i,s)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,s,o)=>B(this,void 0,void 0,function*(){if(D.debug("primary PC state changed ".concat(i)),i===Wt.CONNECTED){const a=this.pcState===qr.New;this.pcState=qr.Connected,a&&this.emit(he.Connected,e)}else i===Wt.FAILED&&this.pcState===qr.Connected&&(this.pcState=qr.Disconnected,this.handleDisconnect("peerconnection failed",o==="failed"?vs.RR_SUBSCRIBER_FAILED:vs.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(he.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>B(this,void 0,void 0,function*(){this.pcManager&&(D.debug("received server answer",{RTCSdpType:e.type}),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(D.trace("got ICE candidate from peer",{candidate:e,target:n}),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>B(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{if(D.debug("received trackPublishedResponse",e),!this.pendingTrackResolvers[e.cid]){D.error("missing track resolver for ".concat(e.cid));return}const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(he.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(he.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",vs.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(iT)):(this.emit(he.Disconnected,e==null?void 0:e.reason),this.close()),D.trace("leave request",{leave:e})}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(D.debug("E2EE - setting up transports with insertable streams"),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(s=>{const o={urls:s.urls};s.username&&(o.username=s.username),s.credential&&(o.credential=s.credential),i.push(o)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Ei.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(nT,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(rT,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpSender))return;const i=RTCRtpSender.getCapabilities(n);if(!i)return;D.debug("get capabilities",i);const s=[],o=[],a=[];i.codecs.forEach(c=>{const l=c.mimeType.toLowerCase();if(l==="audio/opus"){s.push(c);return}if(!(l==="video/".concat(r))){a.push(c);return}if(r==="h264"){c.sdpFmtpLine&&c.sdpFmtpLine.includes("profile-level-id=42e01f")?s.push(c):o.push(c);return}s.push(c)}),Y8(e)&&e.setCodecPreferences(s.concat(o,a))}createSender(e,n,r){return B(this,void 0,void 0,function*(){if(zk())return yield this.createTransceiverRTCRtpSender(e,n,r);if(Wk())return D.warn("using add-track fallback"),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Vt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return B(this,void 0,void 0,function*(){if(zk())return this.createSimulcastTransceiverSender(e,n,r,i);if(Wk())return D.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new Vt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return B(this,void 0,void 0,function*(){if(!this.pcManager)throw new Vt("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const s={direction:"sendonly",streams:i};r&&(s.sendEncodings=r);const o=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s);return e.kind===J.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(o,e.kind,n.videoCodec),e.codec=n.videoCodec),o.sender})}createSimulcastTransceiverSender(e,n,r,i){return B(this,void 0,void 0,function*(){if(!this.pcManager)throw new Vt("publisher is closed");const s={direction:"sendonly"};i&&(s.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,s);if(r.videoCodec)return this.setPreferredCodec(o,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return B(this,void 0,void 0,function*(){if(!this.pcManager)throw new Vt("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return B(this,void 0,void 0,function*(){if(!this._isClosed&&!this.attemptingReconnect){(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Ei.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:Wt.NEW)===Wt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let o=!0;s instanceof Vt?(D.debug("received unrecoverable error",{error:s}),o=!1):s instanceof zf||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",vs.RR_UNKNOWN):(D.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(he.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){D.warn("encountered error in reconnect policy",{error:n})}return null}restartConnection(e){var n,r,i;return B(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new Vt("could not reconnect, url or token not saved");D.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(he.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw D.warn("attempted connection restart, without signal options present"),new zf;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof Et&&o.reason===0?new Vt("could not reconnect, token might be expired"):new zf}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.client.setReconnected(),this.emit(he.SignalRestarted,s),yield this.waitForPCReconnected(),(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(he.Restarted)}catch(s){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),s}})}resumeConnection(e){var n;return B(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new Vt("could not reconnect, url or token not saved");if(!this.pcManager)throw new Vt("publisher and subscriber connections unset");D.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(he.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,D.error(r.message)),r instanceof Et&&r.reason===0?new Vt("could not reconnect, token might be expired"):new zf(i)}if(this.emit(he.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(he.Resumed)})}waitForPCInitialConnection(e,n){return B(this,void 0,void 0,function*(){if(!this.pcManager)throw new Vt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return B(this,void 0,void 0,function*(){this.pcState=qr.Reconnecting,D.debug("waiting for peer connection to reconnect");try{if(yield Ys(Ej),!this.pcManager)throw new Vt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=qr.Connected}catch(e){throw this.pcState=qr.Disconnected,new Et("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return B(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return B(this,void 0,void 0,function*(){if(!this.pcManager)throw new Vt("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,s=n?"Subscriber":"Publisher";if(!i)throw new Et("".concat(s," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const o=this.dataChannelForKind(e,n);if((o==null?void 0:o.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield Ys(50)}throw new Et("could not establish ".concat(s," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return B(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Wt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return B(this,void 0,void 0,function*(){return new Promise((e,n)=>B(this,void 0,void 0,function*(){if(!this.pcManager){n(new Qy("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),D.debug("engine disconnected while negotiation was ongoing"),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(he.Closing,i),this.pcManager.publisher.once(al.RTPVideoPayloadTypes,s=>{const o=new Map;s.forEach(a=>{const c=a.codec.toLowerCase();nj(c)&&o.set(a.payload,c)}),this.emit(he.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof Qy&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",vs.RR_UNKNOWN),n(s)}finally{this.off(he.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===zt.LOSSY)return this.lossyDCSub;if(e===zt.RELIABLE)return this.reliableDCSub}else{if(e===zt.LOSSY)return this.lossyDC;if(e===zt.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){D.warn("sync state cannot be sent without peer connection setup");return}const s=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array;e.forEach(l=>{l.isDesired!==a&&c.push(l.trackSid)}),this.client.sendSyncState(new Qi({answer:s?wp({sdp:s.sdp,type:s.type}):void 0,offer:o?wp({sdp:o.sdp,type:o.type}):void 0,subscription:new Lr({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:W8(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new Zi({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(zt.LOSSY),In.PUBLISHER),n(this.dataChannelForKind(zt.RELIABLE),In.PUBLISHER),n(this.dataChannelForKind(zt.LOSSY,!0),In.SUBSCRIBER),n(this.dataChannelForKind(zt.RELIABLE,!0),In.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&gn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){cr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){cr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class zf extends Error{}class sT{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return n0(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return B(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),D.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return B(this,void 0,void 0,function*(){const n=yield fetch("".concat(Tj(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Et("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function Tj(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const vw=2e3;function ym(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class Bn extends Nl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,J.Kind.Audio,n,r),this.stopOnMute=!1,this.monitorSender=()=>B(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(o){D.error("could not get audio sender stats",{error:o});return}s&&this.prevStats&&(this._currentBitrate=ym(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return B(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Da(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return B(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===J.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(D.debug("stopping mic track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return B(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Da(this._constraints.deviceId);return this.source===J.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(D.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return B(this,void 0,void 0,function*(){let n;if(e){const r=vm({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return B(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){cr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},vw)))}setProcessor(e){var n;return B(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};D.debug("setting up audio processor ".concat(e.name)),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return B(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return B(this,void 0,void 0,function*(){const e=yield $8(this);return e&&(this.isMuted||D.warn("silence detected on local audio track"),this.emit(ue.AudioSilenceDetected)),e})}}function ax(t,e){switch(t.kind){case"audio":return new Bn(t,e,!1);case"video":return new pr(t,e,!1);default:throw new Oi("unsupported track type: ".concat(t.kind))}}const _j=Object.values(Pd),Cj=Object.values(Zy),Ij=Object.values(KP),Rj=[Pd.h180,Pd.h360],Pj=[Zy.h180,Zy.h360],xj=t=>[{scaleResolutionDownBy:2,fps:3}].map(n=>{var r;return new at(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/n.fps)))),n.fps,t.encoding.priority)}),i0=["q","h","f"];function s0(t,e,n,r){var i,s;let o=r==null?void 0:r.videoEncoding;t&&(o=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!o&&!a&&!c||!e||!n)return[{}];o||(o=Mj(t,e,n,l),D.debug("using video encoding",o));const u=new at(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&Ku(l)){D.debug("using svc with scalabilityMode ".concat(c));const h=new cx(c),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let m=0;m<h.spatial;m+=1)p.push({rid:i0[2-m],maxBitrate:o.maxBitrate/Math.pow(3,m),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=c,D.debug("encodings",p),p}if(!a)return[o];let d=[];t?d=(i=aT(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:oT(t,u):d=(s=aT(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:oT(t,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(e,n);if(p>=960&&f)return Yg(e,n,[h,f,u]);if(p>=480)return Yg(e,n,[h,u])}return Yg(e,n,[u])}function Nj(t,e,n){var r,i,s,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&D.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),c=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(s=a.height)!==null&&s!==void 0?s:(o=t.dimensions)===null||o===void 0?void 0:o.height;return s0(t.source===J.Source.ScreenShare,c,l,n)}function Mj(t,e,n,r){const i=Oj(t,e,n);let{encoding:s}=i[0];const o=Math.max(e,n);for(let a=0;a<i.length;a+=1){const c=i[a];if(s=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function Oj(t,e,n){if(t)return Ij;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?_j:Cj}function oT(t,e){if(t)return xj(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?Rj:Pj}function Yg(t,e,n){const r=[];if(n.forEach((i,s)=>{if(s>=i0.length)return;const o=Math.min(t,e),c={rid:i0[s],scaleResolutionDownBy:Math.max(1,o/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(c.maxFramerate=i.encoding.maxFramerate);const l=xl()||s===0;i.encoding.priority&&l&&(c.priority=i.encoding.priority,c.networkPriority=i.encoding.priority),r.push(c)}),Ja()&&ex()==="ios"){let i;r.forEach(o=>{i?o.maxFramerate&&o.maxFramerate>i&&(i=o.maxFramerate):i=o.maxFramerate});let s=!0;r.forEach(o=>{var a;o.maxFramerate!=i&&(s&&(s=!1,D.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),D.info('Setting framerate of encoding "'.concat((a=o.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),o.maxFramerate=i)})}return r}function aT(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class cx{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const Aj=5e3;class pr extends Nl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(e,J.Kind.Video,n,r),this.simulcastCodecs=new Map,this.monitorSender=()=>B(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let i;try{i=yield this.getSenderStats()}catch(o){D.error("could not get audio sender stats",{error:o});return}const s=new Map(i.map(o=>[o.rid,o]));if(this.prevStats){let o=0;s.forEach((a,c)=>{var l;const u=(l=this.prevStats)===null||l===void 0?void 0:l.get(c);o+=ym(a,u)}),this._currentBitrate=o}this.prevStats=s}),this.senderLock=new yi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!cr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},vw))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,s,o;return B(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,c=Ec(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)s=l.value,a=!1,yield(o=s.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,s,o;return B(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,c=Ec(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;yield(o=u.sender)===null||o===void 0?void 0:o.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return B(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===J.Source.Camera&&!this.isUserProvided&&(D.debug("stopping camera track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return B(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===J.Source.Camera&&!this.isUserProvided&&(D.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return B(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var s;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(s=i.rid)!==null&&s!==void 0?s:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),n.push(o)}}),n})}setPublishingQuality(e){const n=[];for(let r=Kt.LOW;r<=Kt.HIGH;r+=1)n.push(new mi({quality:r,enabled:r<=e}));D.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(n)}setDeviceId(e){return B(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Da(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Da(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,s;return B(this,void 0,void 0,function*(){let o;if(e){const u=vm({video:e});typeof u.video!="boolean"&&(o=u.video)}yield this.restart(o);try{for(var a=!0,c=Ec(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,s,o,a,c,l;return B(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((c=this.processor)===null||c===void 0)&&c.processedTrack)try{for(var u=!0,d=Ec(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(this.processor.processedTrack)}catch(h){s={error:h}}finally{try{!u&&!i&&(o=d.return)&&(yield o.call(d))}finally{if(s)throw s.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Aj))}setPublishingCodecs(e){var n,r,i,s,o,a,c;return B(this,void 0,void 0,function*(){if(D.debug("setting publishing codecs",{codecs:e,currentCodec:this.codec}),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=Ec(e);i=yield r.next(),s=i.done,!s;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(D.debug("try setPublishingCodec for ".concat(u.codec),d),!d||!d.sender){for(const f of u.qualities)if(f.enabled){l.push(u.codec);break}}else d.encodings&&(D.debug("try setPublishingLayersForSender ".concat(u.codec)),yield cT(d.sender,d.encodings,u.qualities,this.senderLock))}}}catch(u){o={error:u}}finally{try{!n&&!s&&(a=r.return)&&(yield a.call(r))}finally{if(o)throw o.error}}return l})}setPublishingLayers(e){return B(this,void 0,void 0,function*(){D.debug("setting publishing layers",e),!(!this.sender||!this.encodings)&&(yield cT(this.sender,this.encodings,e,this.senderLock))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return B(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),QP()&&this.isInBackground&&this.source===J.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function cT(t,e,n,r){return B(this,void 0,void 0,function*(){const i=yield r.lock();D.debug("setPublishingLayersForSender",{sender:t,qualities:n,senderEncodings:e});try{const s=t.getParameters(),{encodings:o}=s;if(!o)return;if(o.length!==e.length){D.warn("cannot set publishing layers, encodings mismatch");return}let a=!1;!1&&o[0].scalabilityMode||o.forEach((l,u)=>{var d;let f=(d=l.rid)!==null&&d!==void 0?d:"";f===""&&(f="q");const h=lx(f),p=n.find(m=>m.quality===h);p&&l.active!==p.enabled&&(a=!0,l.active=p.enabled,D.debug("setting layer ".concat(p.quality," to ").concat(l.active?"enabled":"disabled")),xl()&&(p.enabled?(l.scaleResolutionDownBy=e[u].scaleResolutionDownBy,l.maxBitrate=e[u].maxBitrate,l.maxFrameRate=e[u].maxFrameRate):(l.scaleResolutionDownBy=4,l.maxBitrate=10,l.maxFrameRate=2)))}),a&&(s.encodings=o,D.debug("setting encodings",s.encodings),yield t.setParameters(s))}finally{i()}})}function lx(t){switch(t){case"f":return Kt.HIGH;case"h":return Kt.MEDIUM;case"q":return Kt.LOW;default:return Kt.HIGH}}function lT(t,e,n,r){if(!n)return[new Wn({quality:Kt.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,s=new cx(i),o=[];for(let a=0;a<s.spatial;a+=1)o.push(new Wn({quality:Kt.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return o}return n.map(i=>{var s,o,a;const c=(s=i.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let l=lx((o=i.rid)!==null&&o!==void 0?o:"");return new Wn({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class ux extends J{constructor(e,n,r,i){super(e,r),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ue.Muted:ue.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(ue.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return B(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),vw))}}class La extends ux{constructor(e,n,r,i,s){super(e,n,J.Kind.Audio,r),this.monitorReceiver=()=>B(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=ym(o,this.prevStats)),this.prevStats=o}),this.audioContext=i,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Ja()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Ja())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return B(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(t0(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&t0(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(D.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ue.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(ue.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return B(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Xg=100;class Xu extends ux{constructor(e,n,r,i){super(e,n,J.Kind.Video,r),this.elementInfos=[],this.monitorReceiver=()=>B(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=ym(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=fw(()=>{this.updateDimensions()},Xg),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?ol(this._mediaStreamTrack,n):$c(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new Dj(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):D.warn("visibility resize observer not triggered")}stopObservingElementInfo(e){if(!this.isAdaptiveStream){D.warn("stopObservingElementInfo ignored");return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return B(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,n={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&i.set(s.id,s)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return B(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,s=this.elementInfos.some(a=>a.pictureInPicture),o=this.elementInfos.some(a=>a.visible)&&!i||s;if(this.lastVisible!==o){if(!o&&Date.now()-r<Xg){gn.setTimeout(()=>{this.updateVisibility()},Xg);return}this.lastVisible=o,this.emit(ue.VisibilityChanged,o,this)}}updateDimensions(){var e,n;let r=0,i=0;const s=this.getPixelDensity();for(const o of this.elementInfos){const a=o.width()*s,c=o.height()*s;a+c>r+i&&(r=a,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(ue.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?Hk():n||(Hk()>2?2:1)}}class Dj{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:s,isIntersecting:o}=r;s===this.element&&(this.isIntersecting=o,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??uT(e),this.isPiP=cr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=uT(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,qk().observe(this.element),Gk().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=qk())===null||e===void 0||e.unobserve(this.element),(n=Gk())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function uT(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:s}=t,{opacity:o,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!s&&(o!==""?parseFloat(o)>0:!0)&&a!=="none"}class ys extends ds.EventEmitter{constructor(e,n,r){super(),this.metadataMuted=!1,this.encryption=mn.NONE,this.handleMuted=()=>{this.emit(ue.Muted)},this.handleUnmuted=()=>{this.emit(ue.Unmuted)},this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=J.Source.Unknown}setTrack(e){this.track&&(this.track.off(ue.Muted,this.handleMuted),this.track.off(ue.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ue.Muted,this.handleMuted),e.on(ue.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==mn.NONE}get audioTrack(){if(this.track instanceof Bn||this.track instanceof La)return this.track}get videoTrack(){if(this.track instanceof pr||this.track instanceof Xu)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=J.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===J.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,D.debug("update publication info",{info:e})}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(ys||(ys={}));class xd extends ys{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r){super(e,n.sid,n.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ue.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(ue.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(ue.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return B(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return B(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return B(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return B(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var Ar;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Ar||(Ar={}));function Lj(t){switch(t){case ks.EXCELLENT:return Ar.Excellent;case ks.GOOD:return Ar.Good;case ks.POOR:return Ar.Poor;case ks.LOST:return Ar.Lost;default:return Ar.Unknown}}class dx extends ds.EventEmitter{get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ar.Unknown,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(J.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(J.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(J.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,D.trace("update participant info",{info:e}),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(se.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(se.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,s,o;const a=this.permissions,c=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((l,u)=>{var d;return l!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,c&&this.emit(se.ParticipantPermissionsChanged,a),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(se.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=Lj(e),n!==this._connectionQuality&&this.emit(se.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof La||n.track instanceof Bn)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ue.Muted,()=>{this.emit(se.TrackMuted,e)}),e.on(ue.Unmuted,()=>{this.emit(se.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case J.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case J.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function Fj(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Yi({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class yw extends ys{constructor(e,n,r){super(e,n.sid,n.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Kt.HIGH,this.handleEnded=i=>{this.setTrack(void 0),this.emit(ue.Ended,i)},this.handleVisibilityChange=i=>{D.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(i),{trackSid:this.trackSid}),this.disabled=!i,this.emitTrackUpdate()},this.handleVideoDimensionsChange=i=>{D.debug("adaptivestream video dimensions ".concat(i.width,"x").concat(i.height),{trackSid:this.trackSid}),this.videoDimensions=i,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Lr({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new $i({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ue.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?ys.SubscriptionStatus.Unsubscribed:super.isSubscribed?ys.SubscriptionStatus.Subscribed:ys.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?ys.PermissionStatus.Allowed:ys.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof Xu&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Xu&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(ue.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(ue.VisibilityChanged,this.handleVisibilityChange),i.off(ue.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(ue.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ue.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ue.VisibilityChanged,this.handleVisibilityChange),e.on(ue.Ended,this.handleEnded),this.emit(ue.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ue.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ue.Muted:ue.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ue.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ue.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===J.Kind.Video&&this.isAdaptiveStream?(D.warn("adaptive stream is enabled, cannot change video track settings",{trackSid:this.trackSid}),!1):this.isDesired?!0:(D.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof Xu&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Gi({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=Kt.HIGH,this.emit(ue.UpdateSettings,e)}}class Nd extends dx{static fromParticipantInfo(e,n){return new Nd(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,s){super(n,r||"",i,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ue.UpdateSettings,n=>{D.debug("send update settings",n),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ue.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ue.SubscriptionPermissionChanged,n=>{this.emit(se.TrackSubscriptionPermissionChanged,e,n)}),e.on(ue.SubscriptionStatusChanged,n=>{this.emit(se.TrackSubscriptionStatusChanged,e,n)}),e.on(ue.Subscribed,n=>{this.emit(se.TrackSubscribed,n,e)}),e.on(ue.Unsubscribed,n=>{this.emit(se.TrackUnsubscribed,n,e)}),e.on(ue.SubscriptionFailed,n=>{this.emit(se.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,s,o){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(o===0){D.error("could not find published track",{participant:this.sid,trackSid:n}),this.emit(se.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,s,o-1)},150);return}if(e.readyState==="ended"){D.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:n}),this.emit(se.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new Xu(e,n,i,s):l=new La(e,n,i,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(r),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof La&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var s;let o=this.getTrackPublication(i.sid);if(o)o.updateInfo(i);else{const a=J.kindFromProto(i.type);if(!a)return;o=new yw(a,i,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe),o.updateInfo(i),r.set(i.sid,o);const c=Array.from(this.tracks.values()).find(l=>l.source===(o==null?void 0:o.source));c&&o.source!==J.Source.Unknown&&D.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),{oldTrack:c,newTrack:o,participant:this,participantInfo:e}),this.addTrackPublication(o)}n.set(i.sid,o)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(D.trace("detected removed track on remote participant, unpublishing",{publication:i,participantSid:this.sid}),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(se.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case J.Kind.Audio:this.audioTracks.delete(e);break;case J.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(se.TrackUnpublished,r)}setAudioOutput(e){return B(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof La&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return D.trace("participant event",{participant:this.sid,event:e,args:r}),super.emit(e,...r)}}class o0 extends dx{constructor(e,n,r,i){super(e,n),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=mn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new tx)},this.handleReconnected=()=>{var s,o;(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||o===void 0||o.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>D.warn(a)),(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||o===void 0||o.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{D.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>Fj(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,o)=>{if(o===void 0&&(o=!0),!s.sid){D.error("could not update mute status for unpublished track",s);return}this.engine.updateMuteStatus(s.sid,o)},this.onTrackUpstreamPaused=s=>{D.debug("upstream paused"),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{D.debug("upstream resumed"),this.onTrackMuted(s,s.isMuted)},this.handleSubscribedQualityUpdate=s=>B(this,void 0,void 0,function*(){var o,a,c,l,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(s.trackSid);if(!f){D.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:s.trackSid});return}if(s.subscribedCodecs.length>0){if(!f.videoTrack)return;const w=yield f.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var h=!0,p=Ec(w),m;m=yield p.next(),o=m.done,!o;h=!0){l=m.value,h=!1;const g=l;U8(g)&&(D.debug("publish ".concat(g," for ").concat(f.videoTrack.sid)),yield this.publishAdditionalCodecForTrack(f.videoTrack,g,f.options))}}catch(g){a={error:g}}finally{try{!h&&!o&&(c=p.return)&&(yield c.call(p))}finally{if(a)throw a.error}}}else s.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const o=this.tracks.get(s.trackSid);if(!o){D.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:s.trackSid});return}this.unpublishTrack(o.track)},this.handleTrackEnded=s=>B(this,void 0,void 0,function*(){if(s.source===J.Source.ScreenShare||s.source===J.Source.ScreenShareAudio)D.debug("unpublishing local track due to TrackEnded",{track:s.sid}),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof Bn||s instanceof pr)try{if(cr())try{const o=yield navigator==null?void 0:navigator.permissions.query({name:s.source===J.Source.Camera?"camera":"microphone"});if(o&&o.state==="denied")throw D.warn("user has revoked access to ".concat(s.source)),o.onchange=()=>{o.state!=="denied"&&(s.isMuted||s.restartTrack(),o.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(D.debug("track ended, attempting to use a different device"),yield s.restartTrack())}catch{D.warn("could not restart track, muting instead"),yield s.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==mn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(he.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(he.Connected,this.handleReconnected).on(he.SignalRestarted,this.handleReconnected).on(he.SignalResumed,this.handleReconnected).on(he.Restarting,this.handleReconnecting).on(he.Resuming,this.handleReconnecting).on(he.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(he.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(he.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(J.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(J.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(J.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(se.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return B(this,void 0,void 0,function*(){this.encryptionType=e?mn.GCM:mn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var s,o;return B(this,void 0,void 0,function*(){D.debug("setTrackEnabled",{source:e,enabled:n});let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){D.info("skipping duplicate published source",{source:e});return}this.pendingPublishing.add(e);try{switch(e){case J.Source.Camera:c=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case J.Source.Microphone:c=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case J.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Oi(e)}const l=[];for(const d of c)D.info("publishing track",{localTrack:d}),l.push(this.publishTrack(d,i));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&!(l instanceof Oi)&&this.emit(se.MediaDevicesError,l),l}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===J.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrack(J.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return B(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(J.Source.Camera)||this.pendingPublishing.has(J.Source.Microphone))){this.pendingPublishing.add(J.Source.Camera),this.pendingPublishing.add(J.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(J.Source.Camera),this.pendingPublishing.delete(J.Source.Microphone)}}})}createTracks(e){var n,r;return B(this,void 0,void 0,function*(){const i=YP(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),s=vm(i);let o;try{o=yield navigator.mediaDevices.getUserMedia(s)}catch(a){throw a instanceof Error&&(s.audio&&(this.microphoneError=a),s.video&&(this.cameraError=a)),a}return s.audio&&(this.microphoneError=void 0,this.emit(se.AudioStreamAcquired)),s.video&&(this.cameraError=void 0),o.getTracks().map(a=>{const c=a.kind==="audio";c?e.audio:e.video;let l;const u=c?s.audio:s.video;typeof u!="boolean"&&(l=u);const d=ax(a,l);return d.kind===J.Kind.Video?d.source=J.Source.Camera:d.kind===J.Kind.Audio&&(d.source=J.Source.Microphone),d.mediaStream=o,d})})}createScreenTracks(e){return B(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new dw("getDisplayMedia not supported");const n=z8(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new Oi("no video track found");const s=new pr(i[0],void 0,!1);s.source=J.Source.ScreenShare;const o=[s];if(r.getAudioTracks().length>0){this.emit(se.AudioStreamAcquired);const a=new Bn(r.getAudioTracks()[0],void 0,!1,this.audioContext);a.source=J.Source.ScreenShareAudio,o.push(a)}return o})}publishTrack(e,n){var r,i,s,o;return B(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Nl&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case J.Source.Microphone:h="audioinput";break;case J.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Bn(e,a,!0,this.audioContext);break;case"video":e=new pr(e,a,!0);break;default:throw new Oi("unsupported MediaStreamTrack kind ".concat(e.kind))}e instanceof Bn&&e.setAudioContext(this.audioContext);let c;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(c=h)}),c)return D.warn("track has already been published, skipping"),c;const l="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:l;u&&(n||(n={}),n.dtx===void 0&&D.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),n.red===void 0&&D.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=n.dtx)!==null&&s!==void 0||(n.dtx=!1),(o=n.red)!==null&&o!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);qa()&&this.roomOptions.e2ee&&(D.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari"),d.simulcast=!1),d.source&&(e.source=d.source);const f=this.publish(e,d,u);this.pendingPublishPromises.set(e,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,s,o,a,c,l,u,d,f,h,p,m,w;return B(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(R=>e instanceof Nl&&R.source===e.source)&&e.source!==J.Source.Unknown&&D.info("publishing a second track with the same source: ".concat(e.source)),n.stopMicTrackOnMute&&e instanceof Bn&&(e.stopOnMute=!0),e.source===J.Source.ScreenShare&&xl()&&(n.simulcast=!1),n.videoCodec==="av1"&&!q8()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!J8()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=r0);const v=n.videoCodec;e.on(ue.Muted,this.onTrackMuted),e.on(ue.Unmuted,this.onTrackUnmuted),e.on(ue.Ended,this.handleTrackEnded),e.on(ue.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ue.UpstreamResumed,this.onTrackUpstreamResumed);const b=new di({cid:e.mediaStreamTrack.id,name:n.name,type:J.kindToProto(e.kind),muted:e.isMuted,source:J.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=n.red)!==null&&s!==void 0)||s),stream:n==null?void 0:n.stream});let C;if(e.kind===J.Kind.Video){let R={width:0,height:0};try{R=yield e.waitForDimensions()}catch{const M=(a=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&a!==void 0?a:Pd.h720.resolution;R={width:M.width,height:M.height},D.error("could not determine track dimensions, using defaults",R)}b.width=R.width,b.height=R.height,e instanceof pr&&(Ku(v)&&(e.source===J.Source.ScreenShare&&v==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),b.simulcastCodecs=[new ui({codec:v,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:r0}),n.backupCodec&&v!==n.backupCodec.codec&&b.encryption===mn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),b.simulcastCodecs.push(new ui({codec:n.backupCodec.codec,cid:""})))),C=s0(e.source===J.Source.ScreenShare,b.width,b.height,n),b.layers=lT(b.width,b.height,C,Ku(n.videoCodec))}else e.kind===J.Kind.Audio&&(C=[{maxBitrate:(u=(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Vt("cannot publish track when not connected");const T=yield this.engine.addTrack(b);let k;if(T.codecs.forEach(R=>{k===void 0&&(k=R.mimeType)}),k&&e.kind===J.Kind.Video){const R=XP(k);R!==v&&(D.debug("falling back to server selected codec",{codec:R}),n.videoCodec=R,C=s0(e.source===J.Source.ScreenShare,b.width,b.height,n))}const I=new xd(e.kind,T,e);if(I.options=n,e.sid=T.sid,!this.engine.pcManager)throw new Vt("pcManager is not ready");if(D.debug("publishing ".concat(e.kind," with encodings"),{encodings:C,trackInfo:T}),e.sender=yield this.engine.createSender(e,n,C),C)if(xl()&&e.kind===J.Kind.Audio){let R;for(const N of this.engine.pcManager.publisher.getTransceivers())if(N.sender===e.sender){R=N;break}R&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:R,codec:"opus",maxbr:!((m=C[0])===null||m===void 0)&&m.maxBitrate?C[0].maxBitrate/1e3:0})}else e.codec&&Ku(e.codec)&&(!((w=C[0])===null||w===void 0)&&w.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:b.cid,codec:e.codec,maxbr:C[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof pr?e.startMonitor(this.engine.client):e instanceof Bn&&e.startMonitor(),this.addTrackPublication(I),this.emit(se.LocalTrackPublished,I),I})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return B(this,void 0,void 0,function*(){if(this.encryptionType!==mn.NONE)return;let s;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(s=d)}),!s)throw new Oi("track is not published");if(!(e instanceof pr))throw new Oi("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=Nj(e,n,o);if(!a){D.info("backup codec has been disabled, ignoring request to add additional codec for track");return}const c=e.addSimulcastTrack(n,a),l=new di({cid:c.mediaStreamTrack.id,type:J.kindToProto(e.kind),muted:e.isMuted,source:J.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=lT(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new Vt("cannot publish track when not connected");const u=yield this.engine.addTrack(l);yield this.engine.createSimulcastSender(e,c,o,a),yield this.engine.negotiate(),D.debug("published ".concat(n," for track ").concat(e.sid),{encodings:a,trackInfo:u})})}unpublishTrack(e,n){var r,i;return B(this,void 0,void 0,function*(){const s=this.getPublicationForTrack(e);if(D.debug("unpublishing track",{track:e,method:"unpublishTrack"}),!s||!s.track){D.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"});return}e=s.track,e.off(ue.Muted,this.onTrackMuted),e.off(ue.Unmuted,this.onTrackUnmuted),e.off(ue.Ended,this.handleTrackEnded),e.off(ue.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ue.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let o=!1;const a=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Wt.FAILED&&a)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===a&&(c.direction="inactive",o=!0);if(this.engine.removeTrack(a)&&(o=!0),e instanceof pr){for(const[,c]of e.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(o=!0),c.sender=void 0);e.simulcastCodecs.clear()}}catch(c){D.warn("failed to unpublish track",{error:c,method:"unpublishTrack"})}switch(this.tracks.delete(s.trackSid),s.kind){case J.Kind.Audio:this.audioTracks.delete(s.trackSid);break;case J.Kind.Video:this.videoTracks.delete(s.trackSid);break}return this.emit(se.LocalTrackUnpublished,s),s.setTrack(void 0),o&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return B(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof xd)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return B(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>B(this,void 0,void 0,function*(){const s=i.track;yield this.unpublishTrack(s,!1),n&&!s.isMuted&&(s instanceof Bn||s instanceof pr)&&!s.isUserProvided&&(D.debug("restarting existing track",{track:i.trackSid}),yield s.restartTrack()),yield this.publishTrack(s,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return B(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,s=[],o=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(c=>{c instanceof Nd?s.push(c.sid):s.push(c)});const a=new Ui({kind:n,value:{case:"user",value:new ji({participantSid:this.sid,payload:e,destinationSids:s,topic:o})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const s=this.tracks.get(n.sid);if(s){const o=s.isMuted||((i=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(D.debug("updating server mute state after reconcile",{sid:n.sid,muted:o}),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof Bn||i instanceof pr)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var Ve;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(Ve||(Ve={}));const Uj=2*1e3;class bp extends ds.EventEmitter{constructor(e){var n,r;super(),n=this,this.state=Ve.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.connect=(i,s,o)=>B(this,void 0,void 0,function*(){var a;const c=yield this.disconnectLock.lock();if(this.state===Ve.Connected)return D.info("already connected to room ".concat(this.name)),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(Ve.Connecting),((a=this.regionUrlProvider)===null||a===void 0?void 0:a.getServerUrl().toString())!==i&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),n0(new URL(i))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new sT(i,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(d=>{D.warn("could not fetch region settings",{error:d})}));const l=(d,f,h)=>B(this,void 0,void 0,function*(){var p;this.abortController&&this.abortController.abort();const m=new AbortController;this.abortController=m,c==null||c();try{yield this.attemptConnection(h??i,s,o,m),this.abortController=void 0,d()}catch(w){if(this.regionUrlProvider&&w instanceof Et&&w.reason!==3&&w.reason!==0){let g=null;try{g=yield this.regionUrlProvider.getNextBestRegionUrl((p=this.abortController)===null||p===void 0?void 0:p.signal)}catch(v){if(v instanceof Et&&(v.status===401||v.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(v);return}}g?(D.info("Initial connection failed with ConnectionError: ".concat(w.message,". Retrying with another region: ").concat(g)),yield l(d,f,g)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(w))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(w)}}),u=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new tx((d,f)=>{l(d,f,u)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(i,s,o,a,c,l)=>B(this,void 0,void 0,function*(){const u=yield o.join(i,s,{autoSubscribe:a.autoSubscribe,publishOnly:a.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:a.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:a.websocketTimeout},l.signal);let d=u.serverInfo;if(d||(d={version:u.serverVersion,region:u.serverRegion}),D.debug("connected to Livekit Server ".concat(Object.entries(d).map(f=>{let[h,p]=f;return"".concat(h,": ").concat(p)}).join(", "))),!u.serverVersion)throw new N8("unknown server version");return u.serverVersion==="0.15.1"&&this.options.dynacast&&(D.debug("disabling dynacast due to server version"),c.dynacast=!1),u}),this.applyJoinResponse=i=>{const s=i.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...i.otherParticipants]),i.room&&this.handleRoomUpdate(i.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(i.sifTrailer)},this.attemptConnection=(i,s,o,a)=>B(this,void 0,void 0,function*(){var c,l;this.state===Ve.Reconnecting?(D.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},gw),o),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const u=yield this.connectSignal(i,s,this.engine,this.connOptions,this.options,a);this.applyJoinResponse(u),this.setupLocalParticipantEvents(),this.emit(te.SignalConnected)}catch(u){yield this.engine.close(),this.recreateEngine();const d=new Et("could not establish signal connection");throw u instanceof Error&&(d.message="".concat(d.message,": ").concat(u.message)),u instanceof Et&&(d.reason=u.reason,d.status=u.status),D.debug("error trying to establish signal connection",{error:u}),d}if(a.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Et("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,a)}catch(u){throw yield this.engine.close(),this.recreateEngine(),u}cr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),cr()&&(document.addEventListener("freeze",this.onPageLeave),(l=navigator.mediaDevices)===null||l===void 0||l.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Ve.Connected),this.emit(te.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return B(n,void 0,void 0,function*(){var s,o,a,c;const l=yield this.disconnectLock.lock();try{if(this.state===Ve.Disconnected){D.debug("already disconnected");return}D.info("disconnect from room",{identity:this.localParticipant.identity}),(this.state===Ve.Connecting||this.state===Ve.Reconnecting)&&(D.warn("abort connection attempt"),(s=this.abortController)===null||s===void 0||s.abort(),(a=(o=this.connectFuture)===null||o===void 0?void 0:o.reject)===null||a===void 0||a.call(o,new Et("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(i,Ks.CLIENT_INITIATED),this.engine=void 0}finally{l()}})},this.onPageLeave=()=>B(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>B(this,void 0,void 0,function*(){const i=[],s=ia();if(s&&s.os==="iOS"){const o="livekit-dummy-audio-el";let a=document.getElementById(o);if(!a){a=document.createElement("audio"),a.id=o,a.autoplay=!0,a.hidden=!0;const c=qg();c.enabled=!0;const l=new MediaStream([c]);a.srcObject=l,document.addEventListener("visibilitychange",()=>{a&&(a.srcObject=document.hidden?null:l)}),document.body.append(a),this.once(te.Disconnected,()=>{a==null||a.remove()})}i.push(a)}this.participants.forEach(o=>{o.audioTracks.forEach(a=>{a.track&&a.track.attachedElements.forEach(c=>{i.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...i.map(o=>(o.muted=!1,o.play()))]),this.handleAudioPlaybackStarted()}catch(o){throw this.handleAudioPlaybackFailed(o),o}}),this.startVideo=()=>B(this,void 0,void 0,function*(){const i=[];for(const s of this.participants.values())s.videoTracks.forEach(o=>{var a;(a=o.track)===null||a===void 0||a.attachedElements.forEach(c=>{i.includes(c)||i.push(c)})});yield Promise.all(i.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():D.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler")})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const i of this.participants.values())this.handleParticipantDisconnected(i.sid,i);this.setAndEmitConnectionState(Ve.Reconnecting)&&this.emit(te.Reconnecting)},this.handleSignalRestarted=i=>B(this,void 0,void 0,function*(){D.debug("signal reconnected to server",{region:i.serverRegion}),this.cachedParticipantSids=[],this.applyJoinResponse(i);try{const s=[];this.localParticipant.tracks.forEach(o=>{o.track&&s.push(o)}),yield Promise.all(s.map(o=>B(this,void 0,void 0,function*(){const a=o.track;this.localParticipant.unpublishTrack(a,!1),a.isMuted||((a instanceof Bn||a instanceof pr)&&a.source!==J.Source.ScreenShare&&a.source!==J.Source.ScreenShareAudio&&!a.isUserProvided&&(D.debug("restarting existing track",{track:o.trackSid}),yield a.restartTrack()),D.debug("publishing new track",{track:o.trackSid}),yield this.localParticipant.publishTrack(a,o.options))})))}catch(s){D.error("error trying to re-publish tracks after reconnection",{error:s})}try{yield this.engine.waitForRestarted(),D.debug("fully reconnected to server",{region:i.serverRegion})}catch{return}this.setAndEmitConnectionState(Ve.Connected),this.emit(te.Reconnected),this.registerConnectionReconcile(),this.participants.forEach(s=>{this.emit(te.ParticipantConnected,s)})}),this.handleParticipantUpdates=i=>{i.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const o=this.identityToSid.get(s.identity);o&&o!==s.sid&&this.handleParticipantDisconnected(o,this.participants.get(o));let a=this.participants.get(s.sid);const c=!a;s.state===Ha.DISCONNECTED?this.handleParticipantDisconnected(s.sid,a):(a=this.getOrCreateParticipant(s.sid,s),c||a.updateInfo(s))})},this.handleActiveSpeakersUpdate=i=>{const s=[],o={};i.forEach(a=>{if(o[a.sid]=!0,a.sid===this.localParticipant.sid)this.localParticipant.audioLevel=a.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const c=this.participants.get(a.sid);c&&(c.audioLevel=a.level,c.setIsSpeaking(!0),s.push(c))}}),o[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(a=>{o[a.sid]||(a.audioLevel=0,a.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(te.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=i=>{const s=new Map;this.activeSpeakers.forEach(a=>{s.set(a.sid,a)}),i.forEach(a=>{let c=this.participants.get(a.sid);a.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=a.level,c.setIsSpeaking(a.active),a.active?s.set(a.sid,c):s.delete(a.sid))});const o=Array.from(s.values());o.sort((a,c)=>c.audioLevel-a.audioLevel),this.activeSpeakers=o,this.emitWhenConnected(te.ActiveSpeakersChanged,o)},this.handleStreamStateUpdate=i=>{i.streamStates.forEach(s=>{const o=this.participants.get(s.participantSid);if(!o)return;const a=o.getTrackPublication(s.trackSid);!a||!a.track||(a.track.streamState=J.streamStateFromProto(s.state),o.emit(se.TrackStreamStateChanged,a,a.track.streamState),this.emitWhenConnected(te.TrackStreamStateChanged,a,a.track.streamState,o))})},this.handleSubscriptionPermissionUpdate=i=>{const s=this.participants.get(i.participantSid);if(!s)return;const o=s.getTrackPublication(i.trackSid);o&&o.setAllowed(i.allowed)},this.handleSubscriptionError=i=>{const s=Array.from(this.participants.values()).find(a=>a.tracks.has(i.trackSid));if(!s)return;const o=s.getTrackPublication(i.trackSid);o&&o.setSubscriptionError(i.err)},this.handleDataPacket=(i,s)=>{const o=this.participants.get(i.participantSid);this.emit(te.DataReceived,i.payload,o,s,i.topic),o==null||o.emit(se.DataReceived,i.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(te.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=i=>{D.warn("could not playback audio",i),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(te.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(te.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(te.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>B(this,void 0,void 0,function*(){this.emit(te.MediaDevicesChanged)}),this.handleRoomUpdate=i=>{const s=this.roomInfo;this.roomInfo=i,s&&s.metadata!==i.metadata&&this.emitWhenConnected(te.RoomMetadataChanged,i.metadata),(s==null?void 0:s.activeRecording)!==i.activeRecording&&this.emitWhenConnected(te.RecordingStatusChanged,i.activeRecording)},this.handleConnectionQualityUpdate=i=>{i.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const o=this.participants.get(s.participantSid);o&&o.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=i=>{this.emit(te.ParticipantMetadataChanged,i,this.localParticipant)},this.onLocalParticipantNameChanged=i=>{this.emit(te.ParticipantNameChanged,i,this.localParticipant)},this.onLocalTrackMuted=i=>{this.emit(te.TrackMuted,i,this.localParticipant)},this.onLocalTrackUnmuted=i=>{this.emit(te.TrackUnmuted,i,this.localParticipant)},this.onLocalTrackPublished=i=>B(this,void 0,void 0,function*(){var s;this.emit(te.LocalTrackPublished,i,this.localParticipant),i.track instanceof Bn&&(yield i.track.checkForSilence())&&this.emit(te.LocalAudioSilenceDetected,i);const o=yield(s=i.track)===null||s===void 0?void 0:s.getDeviceId(),a=V8(i.source);a&&o&&o!==this.localParticipant.activeDeviceMap.get(a)&&(this.localParticipant.activeDeviceMap.set(a,o),this.emit(te.ActiveDeviceChanged,a,o))}),this.onLocalTrackUnpublished=i=>{this.emit(te.LocalTrackUnpublished,i,this.localParticipant)},this.onLocalConnectionQualityChanged=i=>{this.emit(te.ConnectionQualityChanged,i,this.localParticipant)},this.onMediaDevicesError=i=>{this.emit(te.MediaDevicesError,i)},this.onLocalParticipantPermissionsChanged=i=>{this.emit(te.ParticipantPermissionsChanged,i,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.cachedParticipantSids=[],this.identityToSid=new Map,this.options=Object.assign(Object.assign({},wj),e),this.options.audioCaptureDefaults=Object.assign(Object.assign({},sx),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},ox),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Sj),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new yi,this.localParticipant=new o0("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Da(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Da(this.options.audioCaptureDefaults.deviceId)),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&this.switchActiveDevice("audiooutput",Da(this.options.audioOutput.deviceId)).catch(i=>D.warn("Could not set audio output: ".concat(i.message))),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return B(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new sj(this.options.e2ee),this.e2eeManager.on(Bo.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof o0&&(this.isE2EEEnabled=n),this.emit(te.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Bo.EncryptionError,n=>this.emit(te.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new kj(this.options),this.engine.on(he.ParticipantUpdate,this.handleParticipantUpdates).on(he.RoomUpdate,this.handleRoomUpdate).on(he.SpeakersChanged,this.handleSpeakersChanged).on(he.StreamStateChanged,this.handleStreamStateUpdate).on(he.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(he.SubscriptionError,this.handleSubscriptionError).on(he.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(he.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(he.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(he.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(he.DataPacketReceived,this.handleDataPacket).on(he.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(Ve.Reconnecting)&&this.emit(te.Reconnecting),this.cachedParticipantSids=Array.from(this.participants.keys())}).on(he.Resumed,()=>{this.setAndEmitConnectionState(Ve.Connected),this.emit(te.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),Array.from(this.participants.values()).filter(n=>!this.cachedParticipantSids.includes(n.sid)).forEach(n=>this.emit(te.ParticipantConnected,n)),this.cachedParticipantSids=[]}).on(he.SignalResumed,()=>{this.state===Ve.Reconnecting&&this.sendSyncState()}).on(he.Restarting,this.handleRestarting).on(he.SignalRestarted,this.handleSignalRestarted).on(he.DCBufferStatusChanged,(e,n)=>{this.emit(te.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Vn.getInstance().getDevices(e,n)}prepareConnection(e,n){return B(this,void 0,void 0,function*(){if(this.state===Ve.Disconnected){D.debug("prepareConnection to ".concat(e));try{if(n0(new URL(e))&&n){this.regionUrlProvider=new sT(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Ve.Disconnected&&(this.regionUrl=r,yield fetch(Kk(r),{method:"HEAD"}),D.debug("prepared connection to ".concat(r)))}else yield fetch(Kk(e),{method:"HEAD"})}catch(r){D.warn("could not prepare connection",{error:r})}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return B(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new $n({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new $n({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new $n({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new $n({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new $n({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>B(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new Fr({reason:Ks.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new $n({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(this.engine.client.sendSimulateScenario(i),r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,s,o;return B(this,void 0,void 0,function*(){let a=!1,c=!0;const l=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===J.Source.Microphone);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===J.Source.Camera);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(e==="audiooutput"){if(!t0()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(o=this.options).audioOutput)!==null&&i!==void 0||(o.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==l;try{this.options.expWebAudioMix?(s=this.audioContext)===null||s===void 0||s.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&c&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(te.ActiveDeviceChanged,e,n)),c})}setupLocalParticipantEvents(){this.localParticipant.on(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(se.TrackMuted,this.onLocalTrackMuted).on(se.TrackUnmuted,this.onLocalTrackUnmuted).on(se.LocalTrackPublished,this.onLocalTrackPublished).on(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(se.MediaDevicesError,this.onMediaDevicesError).on(se.AudioStreamAcquired,this.startAudio).on(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===Ve.Connecting||this.state===Ve.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(te.Reconnected,u),this.off(te.Connected,u),this.off(te.Disconnected,d)};this.once(te.Reconnected,u),this.once(te.Connected,u),this.once(te.Disconnected,d);return}if(this.state===Ve.Disconnected){D.warn("skipping incoming track after Room disconnected");return}const i=G8(n.id),s=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),s===this.localParticipant.sid){D.warn("tried to create RemoteParticipant for local participant");return}const c=this.participants.get(s);if(!c){D.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s));return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,a,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.state!==Ve.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(s=>{i.unpublishTrack(s.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var s,o;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((s=i.track)===null||s===void 0||s.detach(),(o=i.track)===null||o===void 0||o.stop())}),this.localParticipant.off(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(se.TrackMuted,this.onLocalTrackMuted).off(se.TrackUnmuted,this.onLocalTrackUnmuted).off(se.LocalTrackPublished,this.onLocalTrackPublished).off(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(se.MediaDevicesError,this.onMediaDevicesError).off(se.AudioStreamAcquired,this.startAudio).off(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),cr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ve.Disconnected),this.emit(te.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(te.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return B(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=hw())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){D.warn(i)}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(te.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=Nd.fromParticipantInfo(this.engine.client,n):i=new Nd(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(s=>D.warn("Could not set audio output: ".concat(s.message))),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(te.ParticipantConnected,r),r.on(se.TrackPublished,i=>{this.emitWhenConnected(te.TrackPublished,i,r)}).on(se.TrackSubscribed,(i,s)=>{i.kind===J.Kind.Audio?(i.on(ue.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(ue.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===J.Kind.Video&&(i.on(ue.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(ue.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(te.TrackSubscribed,i,s,r)}).on(se.TrackUnpublished,i=>{this.emit(te.TrackUnpublished,i,r)}).on(se.TrackUnsubscribed,(i,s)=>{this.emit(te.TrackUnsubscribed,i,s,r)}).on(se.TrackSubscriptionFailed,i=>{this.emit(te.TrackSubscriptionFailed,i,r)}).on(se.TrackMuted,i=>{this.emitWhenConnected(te.TrackMuted,i,r)}).on(se.TrackUnmuted,i=>{this.emitWhenConnected(te.TrackUnmuted,i,r)}).on(se.ParticipantMetadataChanged,i=>{this.emitWhenConnected(te.ParticipantMetadataChanged,i,r)}).on(se.ParticipantNameChanged,i=>{this.emitWhenConnected(te.ParticipantNameChanged,i,r)}).on(se.ConnectionQualityChanged,i=>{this.emitWhenConnected(te.ConnectionQualityChanged,i,r)}).on(se.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(te.ParticipantPermissionsChanged,i,r)}).on(se.TrackSubscriptionStatusChanged,(i,s)=>{this.emitWhenConnected(te.TrackSubscriptionStatusChanged,i,s,r)}).on(se.TrackSubscriptionFailed,(i,s)=>{this.emit(te.TrackSubscriptionFailed,i,r,s)}).on(se.TrackSubscriptionPermissionChanged,(i,s)=>{this.emitWhenConnected(te.TrackSubscriptionPermissionChanged,i,s,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof yw&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=gn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,D.warn("detected connection state mismatch",{numFailures:e}),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ks.STATE_MISMATCH))):e=0},Uj)}clearConnectionReconcile(){this.connectionReconcileInterval&&gn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(te.ConnectionStateChanged,this.state),!0)}emitWhenConnected(e){if(this.state===Ve.Connected){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.emit(e,...r)}return!1}simulateParticipants(e){var n,r;return B(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Yl({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Pe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new br({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(te.SignalConnected),this.emit(te.Connected),this.setAndEmitConnectionState(Ve.Connected),i.video){const o=new xd(J.Kind.Video,new ir({source:Dt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Cn.AUDIO,name:"video-dummy"}),new pr(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Jk((n=160*s.aspectRatios[0])!==null&&n!==void 0?n:1,160,!0,!0)));this.localParticipant.addTrackPublication(o),this.localParticipant.emit(se.LocalTrackPublished,o)}if(i.audio){const o=new xd(J.Kind.Audio,new ir({source:Dt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Cn.AUDIO}),new Bn(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:qg()));this.localParticipant.addTrackPublication(o),this.localParticipant.emit(se.LocalTrackPublished,o)}for(let o=0;o<s.count-1;o+=1){let a=new br({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:Ha.ACTIVE,tracks:[],joinedAt:Pe.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(s.video){const l=Jk((r=160*s.aspectRatios[o%s.aspectRatios.length])!==null&&r!==void 0?r:1,160,!1,!0),u=new ir({source:Dt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Cn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}if(s.audio){const l=qg(),u=new ir({source:Dt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Cn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e!==te.ActiveSpeakersChanged&&D.debug("room event ".concat(e),{event:e,args:r}),super.emit(e,...r)}}var oi;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(oi||(oi={}));class Ql extends ds.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=oi.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new bp(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return B(this,void 0,void 0,function*(){if(this.status!==oi.IDLE)throw Error("check is running already");this.setStatus(oi.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==oi.SKIPPED&&this.setStatus(this.isSuccess()?oi.SUCCESS:oi.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return B(this,void 0,void 0,function*(){return this.room.state===Ve.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return B(this,void 0,void 0,function*(){this.room&&this.room.state!==Ve.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(oi.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function fx(t){var e,n;return B(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=YP(t,sx,ox),i=vm(r),s=navigator.mediaDevices.getUserMedia(i);t.audio&&(Vn.userMediaPromiseMap.set("audioinput",s),s.catch(()=>Vn.userMediaPromiseMap.delete("audioinput"))),t.video&&(Vn.userMediaPromiseMap.set("videoinput",s),s.catch(()=>Vn.userMediaPromiseMap.delete("videoinput")));const o=yield s;return o.getTracks().map(a=>{const c=a.kind==="audio";c?t.audio:t.video;let l;const u=c?i.audio:i.video;typeof u!="boolean"&&(l=u),l?l.deviceId=a.getSettings().deviceId:l={deviceId:a.getSettings().deviceId};const d=ax(a,l);return d.kind===J.Kind.Video?d.source=J.Source.Camera:d.kind===J.Kind.Audio&&(d.source=J.Source.Microphone),d.mediaStream=o,d})})}function Bj(t){return B(this,void 0,void 0,function*(){return(yield fx({audio:!1,video:t}))[0]})}function jj(t){return B(this,void 0,void 0,function*(){return(yield fx({audio:t,video:!1}))[0]})}class $j extends Ql{get description(){return"Can publish audio"}perform(){var e;return B(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield jj();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="audio"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class Vj extends Ql{get description(){return"Can publish video"}perform(){var e;return B(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield Bj();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="video"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class zj extends Ql{get description(){return"Resuming connection after interruption"}perform(){var e;return B(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,s;const o=new Promise(c=>{setTimeout(c,5e3),s=c});n.on(te.Reconnecting,()=>{r=!0}).on(te.Reconnected,()=>{i=!0,s(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield o,r){if(!i||n.state!==Ve.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Wj extends Ql{get description(){return"Can connect via TURN"}perform(){var e,n;return B(this,void 0,void 0,function*(){const r=new mw,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,o=!1,a=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(o=!0,a=!0):l.startsWith("turns:")&&(o=!0,a=!0,s=!0),l.startsWith("stun:")&&(a=!0);a?o&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class Hj extends Ql{get description(){return"Establishing WebRTC connection"}perform(){return B(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(te.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,s)=>{if(i.candidate){const o=new RTCIceCandidate(i);let a="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(Gj(o.address)?a+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,a+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),D.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Gj(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class qj extends Ql{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return B(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new mw;const s=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===Rl.Cloud&&(!((n=s.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class QQ extends ds.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:oi.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==oi.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return B(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=o=>{this.updateCheck(n,o)};r.on("update",i);const s=yield r.run();return r.off("update",i),s})}checkWebsocket(){return B(this,void 0,void 0,function*(){return this.createAndRunCheck(qj)})}checkWebRTC(){return B(this,void 0,void 0,function*(){return this.createAndRunCheck(Hj)})}checkTURN(){return B(this,void 0,void 0,function*(){return this.createAndRunCheck(Wj)})}checkReconnect(){return B(this,void 0,void 0,function*(){return this.createAndRunCheck(zj)})}checkPublishAudio(){return B(this,void 0,void 0,function*(){return this.createAndRunCheck($j)})}checkPublishVideo(){return B(this,void 0,void 0,function*(){return this.createAndRunCheck(Vj)})}}function Jj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof Nl?t.mediaStreamTrack:t,i=r.getSettings();let s={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const o=i.facingMode;D.debug("rawFacingMode",{rawFacingMode:o}),o&&typeof o=="string"&&Xj(o)&&(s={facingMode:o,confidence:"high"})}if(["low","medium"].includes(s.confidence)){D.debug("Try to get facing mode from device label: (".concat(r.label,")"));const o=Yj(r.label);o!==void 0&&(s=o)}return s}const dT=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),Kj=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function Yj(t){var e;const n=t.trim().toLowerCase();if(n!=="")return dT.has(n)?dT.get(n):(e=Array.from(Kj.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function Xj(t){return t===void 0||["user","environment","left","right"].includes(t)}const a0=Math.min,cl=Math.max,Ep=Math.round,sa=t=>({x:t,y:t}),Qj={left:"right",right:"left",bottom:"top",top:"bottom"},Zj={start:"end",end:"start"};function fT(t,e,n){return cl(t,a0(e,n))}function Sm(t,e){return typeof t=="function"?t(e):t}function Ka(t){return t.split("-")[0]}function wm(t){return t.split("-")[1]}function hx(t){return t==="x"?"y":"x"}function px(t){return t==="y"?"height":"width"}function bm(t){return["top","bottom"].includes(Ka(t))?"y":"x"}function mx(t){return hx(bm(t))}function e7(t,e,n){n===void 0&&(n=!1);const r=wm(t),i=mx(t),s=px(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=kp(o)),[o,kp(o)]}function t7(t){const e=kp(t);return[c0(t),e,c0(e)]}function c0(t){return t.replace(/start|end/g,e=>Zj[e])}function n7(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function r7(t,e,n,r){const i=wm(t);let s=n7(Ka(t),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(c0)))),s}function kp(t){return t.replace(/left|right|bottom|top/g,e=>Qj[e])}function i7(t){return{top:0,right:0,bottom:0,left:0,...t}}function s7(t){return typeof t!="number"?i7(t):{top:t,right:t,bottom:t,left:t}}function Tp(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function hT(t,e,n){let{reference:r,floating:i}=t;const s=bm(e),o=mx(e),a=px(o),c=Ka(e),l=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(c){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(wm(e)){case"start":h[o]-=f*(n&&l?-1:1);break;case"end":h[o]+=f*(n&&l?-1:1);break}return h}const o7=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=hT(l,r,c),f=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:w,fn:g}=a[m],{x:v,y:b,data:C,reset:T}=await g({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:l,platform:o,elements:{reference:t,floating:e}});if(u=v??u,d=b??d,h={...h,[w]:{...h[w],...C}},T&&p<=50){p++,typeof T=="object"&&(T.placement&&(f=T.placement),T.rects&&(l=T.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):T.rects),{x:u,y:d}=hT(l,f,c)),m=-1;continue}}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function gx(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Sm(e,t),p=s7(h),w=a[f?d==="floating"?"reference":"floating":d],g=Tp(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(w)))==null||n?w:w.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v=d==="floating"?{...o.floating,x:r,y:i}:o.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),C=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},T=Tp(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:v,offsetParent:b,strategy:c}):v);return{top:(g.top-T.top+p.top)/C.y,bottom:(T.bottom-g.bottom+p.bottom)/C.y,left:(g.left-T.left+p.left)/C.x,right:(T.right-g.right+p.right)/C.x}}const a7=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...w}=Sm(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const g=Ka(i),v=Ka(a)===a,b=await(c.isRTL==null?void 0:c.isRTL(l.floating)),C=f||(v||!m?[kp(a)]:t7(a));!f&&p!=="none"&&C.push(...r7(a,m,p,b));const T=[a,...C],k=await gx(e,w),I=[];let R=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&I.push(k[g]),d){const F=e7(i,o,b);I.push(k[F[0]],k[F[1]])}if(R=[...R,{placement:i,overflows:I}],!I.every(F=>F<=0)){var N,M;const F=(((N=s.flip)==null?void 0:N.index)||0)+1,W=T[F];if(W)return{data:{index:F,overflows:R},reset:{placement:W}};let z=(M=R.filter(Y=>Y.overflows[0]<=0).sort((Y,K)=>Y.overflows[1]-K.overflows[1])[0])==null?void 0:M.placement;if(!z)switch(h){case"bestFit":{var L;const Y=(L=R.map(K=>[K.placement,K.overflows.filter(re=>re>0).reduce((re,H)=>re+H,0)]).sort((K,re)=>K[1]-re[1])[0])==null?void 0:L[0];Y&&(z=Y);break}case"initialPlacement":z=a;break}if(i!==z)return{reset:{placement:z}}}return{}}}};async function c7(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=Ka(n),a=wm(n),c=bm(n)==="y",l=["left","top"].includes(o)?-1:1,u=s&&c?-1:1,d=Sm(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),c?{x:h*u,y:f*l}:{x:f*l,y:h*u}}const l7=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:o,middlewareData:a}=e,c=await c7(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:s+c.y,data:{...c,placement:o}}}}},u7=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:w=>{let{x:g,y:v}=w;return{x:g,y:v}}},...c}=Sm(t,e),l={x:n,y:r},u=await gx(e,c),d=bm(Ka(i)),f=hx(d);let h=l[f],p=l[d];if(s){const w=f==="y"?"top":"left",g=f==="y"?"bottom":"right",v=h+u[w],b=h-u[g];h=fT(v,h,b)}if(o){const w=d==="y"?"top":"left",g=d==="y"?"bottom":"right",v=p+u[w],b=p-u[g];p=fT(v,p,b)}const m=a.fn({...e,[f]:h,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r}}}}};function oa(t){return vx(t)?(t.nodeName||"").toLowerCase():"#document"}function kr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function pa(t){var e;return(e=(vx(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function vx(t){return t instanceof Node||t instanceof kr(t).Node}function no(t){return t instanceof Element||t instanceof kr(t).Element}function cs(t){return t instanceof HTMLElement||t instanceof kr(t).HTMLElement}function pT(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof kr(t).ShadowRoot}function lf(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Vr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function d7(t){return["table","td","th"].includes(oa(t))}function Sw(t){const e=ww(),n=Vr(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function f7(t){let e=Ml(t);for(;cs(e)&&!Em(e);){if(Sw(e))return e;e=Ml(e)}return null}function ww(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Em(t){return["html","body","#document"].includes(oa(t))}function Vr(t){return kr(t).getComputedStyle(t)}function km(t){return no(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Ml(t){if(oa(t)==="html")return t;const e=t.assignedSlot||t.parentNode||pT(t)&&t.host||pa(t);return pT(e)?e.host:e}function yx(t){const e=Ml(t);return Em(e)?t.ownerDocument?t.ownerDocument.body:t.body:cs(e)&&lf(e)?e:yx(e)}function l0(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=yx(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),o=kr(i);return s?e.concat(o,o.visualViewport||[],lf(i)?i:[],o.frameElement&&n?l0(o.frameElement):[]):e.concat(i,l0(i,[],n))}function Sx(t){const e=Vr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=cs(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=Ep(n)!==s||Ep(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function wx(t){return no(t)?t:t.contextElement}function ll(t){const e=wx(t);if(!cs(e))return sa(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=Sx(e);let o=(s?Ep(n.width):n.width)/r,a=(s?Ep(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const h7=sa(0);function bx(t){const e=kr(t);return!ww()||!e.visualViewport?h7:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function p7(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==kr(t)?!1:e}function Md(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=wx(t);let o=sa(1);e&&(r?no(r)&&(o=ll(r)):o=ll(t));const a=p7(s,n,r)?bx(s):sa(0);let c=(i.left+a.x)/o.x,l=(i.top+a.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(s){const f=kr(s),h=r&&no(r)?kr(r):r;let p=f.frameElement;for(;p&&r&&h!==f;){const m=ll(p),w=p.getBoundingClientRect(),g=Vr(p),v=w.left+(p.clientLeft+parseFloat(g.paddingLeft))*m.x,b=w.top+(p.clientTop+parseFloat(g.paddingTop))*m.y;c*=m.x,l*=m.y,u*=m.x,d*=m.y,c+=v,l+=b,p=kr(p).frameElement}}return Tp({width:u,height:d,x:c,y:l})}function m7(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=cs(n),s=pa(n);if(n===s)return e;let o={scrollLeft:0,scrollTop:0},a=sa(1);const c=sa(0);if((i||!i&&r!=="fixed")&&((oa(n)!=="body"||lf(s))&&(o=km(n)),cs(n))){const l=Md(n);a=ll(n),c.x=l.x+n.clientLeft,c.y=l.y+n.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-o.scrollLeft*a.x+c.x,y:e.y*a.y-o.scrollTop*a.y+c.y}}function g7(t){return Array.from(t.getClientRects())}function Ex(t){return Md(pa(t)).left+km(t).scrollLeft}function v7(t){const e=pa(t),n=km(t),r=t.ownerDocument.body,i=cl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=cl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+Ex(t);const a=-n.scrollTop;return Vr(r).direction==="rtl"&&(o+=cl(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function y7(t,e){const n=kr(t),r=pa(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,c=0;if(i){s=i.width,o=i.height;const l=ww();(!l||l&&e==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:s,height:o,x:a,y:c}}function S7(t,e){const n=Md(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=cs(t)?ll(t):sa(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,c=i*s.x,l=r*s.y;return{width:o,height:a,x:c,y:l}}function mT(t,e,n){let r;if(e==="viewport")r=y7(t,n);else if(e==="document")r=v7(pa(t));else if(no(e))r=S7(e,n);else{const i=bx(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Tp(r)}function kx(t,e){const n=Ml(t);return n===e||!no(n)||Em(n)?!1:Vr(n).position==="fixed"||kx(n,e)}function w7(t,e){const n=e.get(t);if(n)return n;let r=l0(t,[],!1).filter(a=>no(a)&&oa(a)!=="body"),i=null;const s=Vr(t).position==="fixed";let o=s?Ml(t):t;for(;no(o)&&!Em(o);){const a=Vr(o),c=Sw(o);!c&&a.position==="fixed"&&(i=null),(s?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||lf(o)&&!c&&kx(t,o))?r=r.filter(u=>u!==o):i=a,o=Ml(o)}return e.set(t,r),r}function b7(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const o=[...n==="clippingAncestors"?w7(e,this._c):[].concat(n),r],a=o[0],c=o.reduce((l,u)=>{const d=mT(e,u,i);return l.top=cl(d.top,l.top),l.right=a0(d.right,l.right),l.bottom=a0(d.bottom,l.bottom),l.left=cl(d.left,l.left),l},mT(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function E7(t){return Sx(t)}function k7(t,e,n){const r=cs(e),i=pa(e),s=n==="fixed",o=Md(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const c=sa(0);if(r||!r&&!s)if((oa(e)!=="body"||lf(i))&&(a=km(e)),r){const l=Md(e,!0,s,e);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else i&&(c.x=Ex(i));return{x:o.left+a.scrollLeft-c.x,y:o.top+a.scrollTop-c.y,width:o.width,height:o.height}}function gT(t,e){return!cs(t)||Vr(t).position==="fixed"?null:e?e(t):t.offsetParent}function Tx(t,e){const n=kr(t);if(!cs(t))return n;let r=gT(t,e);for(;r&&d7(r)&&Vr(r).position==="static";)r=gT(r,e);return r&&(oa(r)==="html"||oa(r)==="body"&&Vr(r).position==="static"&&!Sw(r))?n:r||f7(t)||n}const T7=async function(t){let{reference:e,floating:n,strategy:r}=t;const i=this.getOffsetParent||Tx,s=this.getDimensions;return{reference:k7(e,await i(n),r),floating:{x:0,y:0,...await s(n)}}};function _7(t){return Vr(t).direction==="rtl"}const C7={convertOffsetParentRelativeRectToViewportRelativeRect:m7,getDocumentElement:pa,getClippingRect:b7,getOffsetParent:Tx,getElementRects:T7,getClientRects:g7,getDimensions:E7,getScale:ll,isElement:no,isRTL:_7},I7=(t,e,n)=>{const r=new Map,i={platform:C7,...n},s={...i.platform,_c:r};return o7(t,e,{...i,platform:s})};var _x={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(CO,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(m,w){var g=m[w];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?o:console[m]!==void 0?s(console,m):console.log!==void 0?s(console,"log"):e}function c(m,w){for(var g=0;g<i.length;g++){var v=i[g];this[v]=g<m?e:this.methodFactory(v,m,w)}this.log=this.debug}function l(m,w,g){return function(){typeof console!==n&&(c.call(this,w,g),this[m].apply(this,arguments))}}function u(m,w,g){return a(m)||l.apply(this,arguments)}function d(m,w,g){var v=this,b;w=w??"WARN";var C="loglevel";typeof m=="string"?C+=":"+m:typeof m=="symbol"&&(C=void 0);function T(N){var M=(i[N]||"silent").toUpperCase();if(!(typeof window===n||!C)){try{window.localStorage[C]=M;return}catch{}try{window.document.cookie=encodeURIComponent(C)+"="+M+";"}catch{}}}function k(){var N;if(!(typeof window===n||!C)){try{N=window.localStorage[C]}catch{}if(typeof N===n)try{var M=window.document.cookie,L=M.indexOf(encodeURIComponent(C)+"=");L!==-1&&(N=/^([^;]+)/.exec(M.slice(L))[1])}catch{}return v.levels[N]===void 0&&(N=void 0),N}}function I(){if(!(typeof window===n||!C)){try{window.localStorage.removeItem(C);return}catch{}try{window.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=m,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=g||u,v.getLevel=function(){return b},v.setLevel=function(N,M){if(typeof N=="string"&&v.levels[N.toUpperCase()]!==void 0&&(N=v.levels[N.toUpperCase()]),typeof N=="number"&&N>=0&&N<=v.levels.SILENT){if(b=N,M!==!1&&T(N),c.call(v,N,m),typeof console===n&&N<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+N},v.setDefaultLevel=function(N){w=N,k()||v.setLevel(N,!1)},v.resetLevel=function(){v.setLevel(w,!1),I()},v.enableAll=function(N){v.setLevel(v.levels.TRACE,N)},v.disableAll=function(N){v.setLevel(v.levels.SILENT,N)};var R=k();R==null&&(R=w),v.setLevel(R,!1)}var f=new d,h={};f.getLogger=function(w){if(typeof w!="symbol"&&typeof w!="string"||w==="")throw new TypeError("You must supply a name when creating a logger.");var g=h[w];return g||(g=h[w]=new d(w,f.getLevel(),f.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(_x);var R7=_x.exports;const P7=Gd(R7);function Yt(t){return typeof t=="function"}function Cx(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Qg=Cx(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function u0(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Tm=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Il(o),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(m){e={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(Yt(u))try{u()}catch(m){s=m instanceof Qg?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Il(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{vT(p)}catch(m){s=s??[],m instanceof Qg?s=hp(hp([],fp(s)),fp(m.errors)):s.push(m)}}}catch(m){r={error:m}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(s)throw new Qg(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)vT(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&u0(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&u0(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Ix=Tm.EMPTY;function Rx(t){return t instanceof Tm||t&&"closed"in t&&Yt(t.remove)&&Yt(t.add)&&Yt(t.unsubscribe)}function vT(t){Yt(t)?t():t.unsubscribe()}var Px={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d0={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=d0.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,hp([t,e],fp(n))):setTimeout.apply(void 0,hp([t,e],fp(n)))},clearTimeout:function(t){var e=d0.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function xx(t){d0.setTimeout(function(){throw t})}function f0(){}function xh(t){t()}var bw=function(t){Kl(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Rx(n)&&n.add(r)):r.destination=O7,r}return e.create=function(n,r,i){return new h0(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Tm),x7=Function.prototype.bind;function Zg(t,e){return x7.call(t,e)}var N7=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Wf(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Wf(r)}else Wf(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Wf(n)}},t}(),h0=function(t){Kl(e,t);function e(n,r,i){var s=t.call(this)||this,o;if(Yt(n)||!n)o={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;s&&Px.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return s.unsubscribe()},o={next:n.next&&Zg(n.next,a),error:n.error&&Zg(n.error,a),complete:n.complete&&Zg(n.complete,a)}):o=n}return s.destination=new N7(o),s}return e}(bw);function Wf(t){xx(t)}function M7(t){throw t}var O7={closed:!0,next:f0,error:M7,complete:f0},Ew=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Nx(t){return t}function A7(t){return t.length===0?Nx:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Sn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,s=L7(e)?e:new h0(e,n,r);return xh(function(){var o=i,a=o.operator,c=o.source;s.add(a?a.call(s,c):c?i._subscribe(s):i._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=yT(n),new n(function(i,s){var o=new h0({next:function(a){try{e(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Ew]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return A7(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=yT(e),new e(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},t.create=function(e){return new t(e)},t}();function yT(t){var e;return(e=t??Px.Promise)!==null&&e!==void 0?e:Promise}function D7(t){return t&&Yt(t.next)&&Yt(t.error)&&Yt(t.complete)}function L7(t){return t&&t instanceof bw||D7(t)&&Rx(t)}function F7(t){return Yt(t==null?void 0:t.lift)}function fo(t){return function(e){if(F7(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ya(t,e,n,r,i){return new U7(t,e,n,r,i)}var U7=function(t){Kl(e,t);function e(n,r,i,s,o,a){var c=t.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){n.error(u)}}:t.prototype._next,c._error=s?function(l){try{s(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(bw),B7=Cx(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),aa=function(t){Kl(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new ST(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new B7},e.prototype.next=function(n){var r=this;xh(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=Il(r.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(n)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;xh(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;xh(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,s=i.hasError,o=i.isStopped,a=i.observers;return s||o?Ix:(this.currentObservers=null,a.push(n),new Tm(function(){r.currentObservers=null,u0(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,s=r.thrownError,o=r.isStopped;i?n.error(s):o&&n.complete()},e.prototype.asObservable=function(){var n=new Sn;return n.source=this,n},e.create=function(n,r){return new ST(n,r)},e}(Sn),ST=function(t){Kl(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:Ix},e}(aa),Mx=function(t){Kl(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,s=n._value;if(r)throw i;return this._throwIfClosed(),s},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(aa);function j7(t){return t&&Yt(t.schedule)}function $7(t){return t[t.length-1]}function Ox(t){return j7($7(t))?t.pop():void 0}var Ax=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function Dx(t){return Yt(t==null?void 0:t.then)}function Lx(t){return Yt(t[Ew])}function Fx(t){return Symbol.asyncIterator&&Yt(t==null?void 0:t[Symbol.asyncIterator])}function Ux(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function V7(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Bx=V7();function jx(t){return Yt(t==null?void 0:t[Bx])}function $x(t){return a4(this,arguments,function(){var n,r,i,s;return vR(this,function(o){switch(o.label){case 0:n=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,el(n.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,el(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,el(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Vx(t){return Yt(t==null?void 0:t.getReader)}function Zl(t){if(t instanceof Sn)return t;if(t!=null){if(Lx(t))return z7(t);if(Ax(t))return W7(t);if(Dx(t))return H7(t);if(Fx(t))return zx(t);if(jx(t))return G7(t);if(Vx(t))return q7(t)}throw Ux(t)}function z7(t){return new Sn(function(e){var n=t[Ew]();if(Yt(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function W7(t){return new Sn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function H7(t){return new Sn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,xx)})}function G7(t){return new Sn(function(e){var n,r;try{for(var i=Il(t),s=i.next();!s.done;s=i.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function zx(t){return new Sn(function(e){J7(t,e).catch(function(n){return e.error(n)})})}function q7(t){return zx($x(t))}function J7(t,e){var n,r,i,s;return o4(this,void 0,void 0,function(){var o,a;return vR(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=c4(t),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Qo(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Wx(t,e){return e===void 0&&(e=0),fo(function(n,r){n.subscribe(Ya(r,function(i){return Qo(r,t,function(){return r.next(i)},e)},function(){return Qo(r,t,function(){return r.complete()},e)},function(i){return Qo(r,t,function(){return r.error(i)},e)}))})}function Hx(t,e){return e===void 0&&(e=0),fo(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function K7(t,e){return Zl(t).pipe(Hx(e),Wx(e))}function Y7(t,e){return Zl(t).pipe(Hx(e),Wx(e))}function X7(t,e){return new Sn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Q7(t,e){return new Sn(function(n){var r;return Qo(n,e,function(){r=t[Bx](),Qo(n,e,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return Yt(r==null?void 0:r.return)&&r.return()}})}function Gx(t,e){if(!t)throw new Error("Iterable cannot be null");return new Sn(function(n){Qo(n,e,function(){var r=t[Symbol.asyncIterator]();Qo(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function Z7(t,e){return Gx($x(t),e)}function e$(t,e){if(t!=null){if(Lx(t))return K7(t,e);if(Ax(t))return X7(t,e);if(Dx(t))return Y7(t,e);if(Fx(t))return Gx(t,e);if(jx(t))return Q7(t,e);if(Vx(t))return Z7(t,e)}throw Ux(t)}function t$(t,e){return e?e$(t,e):Zl(t)}function Xn(t,e){return fo(function(n,r){var i=0;n.subscribe(Ya(r,function(s){r.next(t.call(e,s,i++))}))})}function n$(t,e,n,r,i,s,o,a){var c=[],l=0,u=0,d=!1,f=function(){d&&!c.length&&!l&&e.complete()},h=function(m){return l<r?p(m):c.push(m)},p=function(m){s&&e.next(m),l++;var w=!1;Zl(n(m,u++)).subscribe(Ya(e,function(g){i==null||i(g),s?h(g):e.next(g)},function(){w=!0},void 0,function(){if(w)try{l--;for(var g=function(){var v=c.shift();o?Qo(e,o,function(){return p(v)}):p(v)};c.length&&l<r;)g();f()}catch(v){e.error(v)}}))};return t.subscribe(Ya(e,h,function(){d=!0,f()})),function(){a==null||a()}}function qx(t,e,n){return n===void 0&&(n=1/0),Yt(e)?qx(function(r,i){return Xn(function(s,o){return e(r,s,i,o)})(Zl(t(r,i)))},n):(typeof e=="number"&&(n=e),fo(function(r,i){return n$(r,i,t,n)}))}function r$(t){return t===void 0&&(t=1/0),qx(Nx,t)}function i$(){return r$(1)}function p0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return i$()(t$(t,Ox(t)))}function Jx(t,e){return fo(function(n,r){var i=0;n.subscribe(Ya(r,function(s){return t.call(e,s,i++)&&r.next(s)}))})}function s$(t,e,n,r,i){return function(s,o){var a=n,c=e,l=0;s.subscribe(Ya(o,function(u){var d=l++;c=a?t(c,u,d):(a=!0,u),r&&o.next(c)},i&&function(){a&&o.next(c),o.complete()}))}}function o$(t){return fo(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function a$(t,e){return fo(s$(t,e,arguments.length>=2,!0))}function Ti(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Ox(t);return fo(function(r,i){(n?p0(t,r,n):p0(t,r)).subscribe(i)})}function wT(t){return fo(function(e,n){Zl(t).subscribe(Ya(n,function(){return n.complete()},f0)),!n.closed&&e.subscribe(n)})}var c$=Object.defineProperty,l$=Object.defineProperties,u$=Object.getOwnPropertyDescriptors,_p=Object.getOwnPropertySymbols,Kx=Object.prototype.hasOwnProperty,Yx=Object.prototype.propertyIsEnumerable,bT=(t,e,n)=>e in t?c$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,m0=(t,e)=>{for(var n in e||(e={}))Kx.call(e,n)&&bT(t,n,e[n]);if(_p)for(var n of _p(e))Yx.call(e,n)&&bT(t,n,e[n]);return t},d$=(t,e)=>l$(t,u$(e)),f$=(t,e)=>{var n={};for(var r in t)Kx.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&_p)for(var r of _p(t))e.indexOf(r)<0&&Yx.call(t,r)&&(n[r]=t[r]);return n},ho=(t,e,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())}),Xx="lk";function kw(t){return typeof t>"u"?!1:h$(t)||p$(t)}function h$(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function p$(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function m$(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function Qx(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(m$(t))return`${t.participant.identity}_${t.source}_placeholder`;if(kw(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function g$(t){return t instanceof o0}function v$(t,e){return ho(this,null,function*(){const{x:n,y:r}=yield I7(t,e,{placement:"top",middleware:[l7(6),a7(),u7({padding:5})]});return{x:n,y:r}})}function y$(t,e){return!t.contains(e.target)}var S$=[te.ConnectionStateChanged,te.RoomMetadataChanged,te.ActiveSpeakersChanged,te.ConnectionQualityChanged,te.ParticipantConnected,te.ParticipantDisconnected,te.ParticipantPermissionsChanged,te.ParticipantMetadataChanged,te.TrackMuted,te.TrackUnmuted,te.TrackPublished,te.TrackUnpublished,te.TrackStreamStateChanged,te.TrackSubscriptionFailed,te.TrackSubscriptionPermissionChanged,te.TrackSubscriptionStatusChanged],w$=[...S$,te.LocalTrackPublished,te.LocalTrackUnpublished],b$=[se.ConnectionQualityChanged,se.IsSpeakingChanged,se.ParticipantMetadataChanged,se.ParticipantPermissionsChanged,se.TrackMuted,se.TrackUnmuted,se.TrackPublished,se.TrackUnpublished,se.TrackStreamStateChanged,se.TrackSubscriptionFailed,se.TrackSubscriptionPermissionChanged,se.TrackSubscriptionStatusChanged];[...b$,se.LocalTrackPublished,se.LocalTrackUnpublished];var Ge=P7.getLogger("lk-components-js");Ge.setDefaultLevel("WARN");function E$(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var k$=[],T$={showChat:!1,unreadMessages:0};function Tw(t,...e){return new Sn(r=>{const i=()=>{r.next(t)};return e.forEach(o=>{t.on(o,i)}),()=>{e.forEach(o=>{t.off(o,i)})}}).pipe(Ti(t))}function _w(t,e){return new Sn(r=>{const i=(...o)=>{r.next(o)};return t.on(e,i),()=>{t.off(e,i)}})}function _$(t){return _w(t,te.ConnectionStateChanged).pipe(Xn(([e])=>e),Ti(t.state))}function C$(t,e,n=!0){var r;const i=()=>ho(this,null,function*(){try{const a=yield bp.getLocalDevices(t,n);s.next(a)}catch(a){e==null||e(a)}}),s=new aa,o=s.pipe(o$(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return p0(bp.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),o)}function I$(t){return _w(t,te.DataReceived)}function R$(t){return Tw(t,te.AudioPlaybackStatusChanged).pipe(Xn(n=>({canPlayAudio:n.canPlaybackAudio})))}function P$(t){return Tw(t,te.VideoPlaybackStatusChanged).pipe(Xn(n=>({canPlayVideo:n.canPlaybackVideo})))}function x$(t,e){return _w(t,te.ActiveDeviceChanged).pipe(Jx(([n])=>n===e),Xn(([n,r])=>(Ge.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),Ti(t.getActiveDevice(e)))}function zr(t){return`${Xx}-${t}`}function N$(t){const e=g0(t),n=Iw(t.participant).pipe(Xn(()=>g0(t)),Ti(e));return{className:zr(t.source===J.Source.Camera||t.source===J.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function g0(t){if(kw(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function Cw(t,...e){return new Sn(r=>{const i=()=>{r.next(t)};return e.forEach(o=>{t.on(o,i)}),()=>{e.forEach(o=>{t.off(o,i)})}}).pipe(Ti(t))}function Iw(t){return Cw(t,se.TrackMuted,se.TrackUnmuted,se.ParticipantPermissionsChanged,se.TrackPublished,se.TrackUnpublished,se.LocalTrackPublished,se.LocalTrackUnpublished,se.MediaDevicesError,se.TrackSubscriptionStatusChanged).pipe(Xn(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:s}=n,o=n.getTrack(J.Source.Microphone),a=n.getTrack(J.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:s,cameraTrack:a,microphoneTrack:o,participant:n}}))}function M$(t){return Cw(t,se.ParticipantMetadataChanged).pipe(Xn(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),Ti({name:t.name,identity:t.identity,metadata:t.metadata}))}function O$(t){return Rw(t,se.ConnectionQualityChanged).pipe(Xn(([n])=>n),Ti(t.connectionQuality))}function Rw(t,e){return new Sn(r=>{const i=(...o)=>{r.next(o)};return t.on(e,i),()=>{t.off(e,i)}})}function Zx(t){var e,n,r,i;return Cw(t.participant,se.TrackMuted,se.TrackUnmuted,se.TrackSubscribed,se.TrackUnsubscribed,se.LocalTrackPublished,se.LocalTrackUnpublished).pipe(Xn(s=>{var o,a;const c=(o=t.publication)!=null?o:s.getTrack(t.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),Ti((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function A$(t){return Rw(t,se.IsSpeakingChanged).pipe(Xn(([e])=>e))}function D$(t,e={}){var n;let r;const i=new Sn(c=>(r=c,()=>a.unsubscribe())).pipe(Ti(Array.from(t.participants.values()))),s=(n=e.additionalRoomEvents)!=null?n:w$,o=Array.from(new Set([te.ParticipantConnected,te.ParticipantDisconnected,te.ConnectionStateChanged,...s])),a=Tw(t,...o).subscribe(c=>r==null?void 0:r.next(Array.from(c.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function L$(t){return Rw(t,se.ParticipantPermissionsChanged).pipe(Xn(()=>t.permissions),Ti(t.permissions))}function F$(t,e,n){const{localParticipant:r}=e,i=(l,u)=>{let d=!1;switch(l){case J.Source.Camera:d=u.isCameraEnabled;break;case J.Source.Microphone:d=u.isMicrophoneEnabled;break;case J.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},s=Iw(r).pipe(Xn(l=>i(t,l.participant)),Ti(i(t,r))),o=new aa,a=(l,u)=>ho(this,null,function*(){try{switch(u??(u=n),o.next(!0),t){case J.Source.Camera:yield r.setCameraEnabled(l??!r.isCameraEnabled,u);break;case J.Source.Microphone:yield r.setMicrophoneEnabled(l??!r.isMicrophoneEnabled,u);break;case J.Source.ScreenShare:yield r.setScreenShareEnabled(l??!r.isScreenShareEnabled,u);break;default:break}}finally{o.next(!1)}});return{className:zr("button"),toggle:a,enabledObserver:s,pendingObserver:o.asObservable()}}function U$(){let t=!1;const e=new aa,n=new aa,r=s=>{n.next(!0),t=s??!t,e.next(t),n.next(!1)};return{className:zr("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function B$(t,e,n){const r=new Mx(void 0),i=e?x$(e,t):r.asObservable(),s=(a,...c)=>ho(this,[a,...c],function*(l,u={}){var d,f,h;if(e){Ge.debug(`Switching active device of kind "${t}" with id ${l}.`),yield e.switchActiveDevice(t,l,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:l;p!==l&&l!=="default"&&Ge.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let m;t==="audioinput"?m=(f=e.localParticipant.getTrack(J.Source.Microphone))==null?void 0:f.track:t==="videoinput"&&(m=(h=e.localParticipant.getTrack(J.Source.Camera))==null?void 0:h.track);const w=l==="default"&&!m||l==="default"&&(m==null?void 0:m.mediaStreamTrack.label.startsWith("Default"));r.next(w?l:p)}else if(n){yield n.setDeviceId(u.exact?{exact:l}:l);const p=yield n.getDeviceId();r.next(l==="default"&&n.mediaStreamTrack.label.startsWith("Default")?l:p)}else r.value!==l&&(Ge.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(l))});return{className:zr("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:s}}function j$(t){const e=r=>{t.disconnect(r)};return{className:zr("disconnect-button"),disconnect:e}}function $$(t){const e=zr("connection-quality"),n=O$(t);return{className:e,connectionQualityObserver:n}}function V$(t){let e="track-muted-indicator-camera";switch(t.source){case J.Source.Camera:e="track-muted-indicator-camera";break;case J.Source.Microphone:e="track-muted-indicator-microphone";break}const n=zr(e),r=Zx(t);return{className:n,mediaMutedObserver:r}}function z$(t){return{className:"lk-participant-name",infoObserver:M$(t)}}function W$(){return{className:zr("participant-tile")}}var H$={CHAT:"lk-chat-topic"};function eN(t,e,n){return ho(this,arguments,function*(r,i,s,o={}){const{kind:a,destination:c}=o;yield r.publishData(i,a??zt.RELIABLE,{destination:c,topic:s})})}function G$(t,e,n){const r=I$(t).pipe(Jx(([,,,a])=>e===void 0||a===e),Xn(([a,c,,l])=>{const u={payload:a,topic:l,from:c};return n==null||n(u),u}));let i;const s=new Sn(a=>{i=a});return{messageObservable:r,isSendingObservable:s,send:(a,...c)=>ho(this,[a,...c],function*(l,u={}){i.next(!0);try{yield eN(t.localParticipant,l,e,u)}finally{i.next(!1)}})}}var q$=new TextEncoder,J$=new TextDecoder,Hf=new Map,K$=t=>q$.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),Y$=t=>JSON.parse(J$.decode(t));function X$(t,e){var n,r;const i=new aa,{messageDecoder:s,messageEncoder:o,channelTopic:a}=e??{},c=a??H$.CHAT;let l=!1;Hf.has(t)||(l=!0);const u=(n=Hf.get(t))!=null?n:new Map,d=(r=u.get(c))!=null?r:new aa;if(u.set(c,d),Hf.set(t,u),l){const{messageObservable:v}=G$(t,c);v.pipe(wT(i)).subscribe(d)}const f=s??Y$,h=d.pipe(Xn(v=>{const b=f(v.payload);return d$(m0({},b),{from:v.from})}),a$((v,b)=>[...v,b],[]),wT(i)),p=new Mx(!1),m=o??K$,w=v=>ho(this,null,function*(){const b=Date.now(),C=m({message:v,timestamp:b});p.next(!0);try{yield eN(t.localParticipant,C,c,{kind:zt.RELIABLE}),d.next({payload:C,topic:c,from:t.localParticipant})}finally{p.next(!1)}});function g(){i.next(),i.complete(),Hf.clear()}return t.once(te.Disconnected,g),{messageObservable:h,isSendingObservable:p,send:w}}function Q$(){const t=n=>ho(this,null,function*(){Ge.info("Start Audio for room: ",n),yield n.startAudio()});return{className:zr("start-audio-button"),roomAudioPlaybackAllowedObservable:R$,handleStartAudioPlayback:t}}function Z$(){const t=n=>ho(this,null,function*(){Ge.info("Start Video for room: ",n),yield n.startVideo()});return{className:zr("start-audio-button"),roomVideoPlaybackAllowedObservable:P$,handleStartVideoPlayback:t}}function eV(){return{className:[zr("button"),zr("chat-toggle")].join(" ")}}function tV(){return{className:"lk-room-container"}}function nV(t,e){if(typeof localStorage>"u"){Ge.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){Ge.error(`Error setting item to local storage: ${n}`)}}function rV(t){if(typeof localStorage>"u"){Ge.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){Ge.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Ge.error(`Error getting item from local storage: ${e}`);return}}function iV(t){return{load:()=>rV(t),save:e=>nV(t,e)}}var sV=`${Xx}-user-choices`,Sa={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:oV,save:aV}=iV(sV);function cV(t,e=!1){if(e===!0)return;const n=t,r=f$(n,["e2ee","sharedPassphrase"]);aV(r)}function lV(t,e=!1){var n,r,i,s,o,a,c;const l={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:Sa.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:Sa.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:Sa.videoDeviceId,audioDeviceId:(s=t==null?void 0:t.audioDeviceId)!=null?s:Sa.audioDeviceId,username:(o=t==null?void 0:t.username)!=null?o:Sa.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:Sa.e2ee,sharedPassphrase:(c=t==null?void 0:t.sharedPassphrase)!=null?c:Sa.sharedPassphrase};if(e)return l;{const u=oV();return m0(m0({},l),u??{})}}function tN(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=tN(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function uV(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=tN(t))&&(r&&(r+=" "),r+=e);return r}var dV=Object.defineProperty,fV=Object.defineProperties,hV=Object.getOwnPropertyDescriptors,Cp=Object.getOwnPropertySymbols,nN=Object.prototype.hasOwnProperty,rN=Object.prototype.propertyIsEnumerable,ET=(t,e,n)=>e in t?dV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,we=(t,e)=>{for(var n in e||(e={}))nN.call(e,n)&&ET(t,n,e[n]);if(Cp)for(var n of Cp(e))rN.call(e,n)&&ET(t,n,e[n]);return t},Rn=(t,e)=>fV(t,hV(e)),wn=(t,e)=>{var n={};for(var r in t)nN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Cp)for(var r of Cp(t))e.indexOf(r)<0&&rN.call(t,r)&&(n[r]=t[r]);return n},iN=(t,e,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())});function _r(t,e){const[n,r]=E.useState(e);return E.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function pV(t){const e=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,r]=E.useState(e(t));function i(){r(e(t))}return E.useEffect(()=>{const s=window.matchMedia(t);return i(),s.addListener?s.addListener(i):s.addEventListener("change",i),()=>{s.removeListener?s.removeListener(i):s.removeEventListener("change",i)}},[t]),n}function mV(t,e){if(e.msg==="show_chat")return Rn(we({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Rn(we({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Rn(we({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Rn(we({},t),{unreadMessages:e.count}):we({},t)}function gV(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:we({},t)}var Pw=E.createContext(void 0);function vV(){const t=E.useContext(Pw);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function yV(t){const[e,n]=E.useReducer(gV,k$),[r,i]=E.useReducer(mV,T$);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function sN(){return E.useContext(Pw)}var SV=E.createContext(void 0);function uf(){return E.useContext(SV)}var xw=E.createContext(void 0);function _m(){return E.useContext(xw)}function cc(t){var e;const n=_m(),r=uf(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var Nw=E.createContext(void 0);function Cm(){const t=E.useContext(Nw);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function Im(){return E.useContext(Nw)}function df(t){const e=Im(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var wV=E.createContext(void 0);function bV(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function ma(...t){const e=we({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const s=e[i],o=r[i];typeof s=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=bV(s,o):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof o=="string"?e[i]=uV(s,o):e[i]=o!==void 0?o:s}}return e}function EV(t={}){const e=cc(t.participant),{className:n,connectionQualityObserver:r}=E.useMemo(()=>$$(e),[e]),i=_r(r,Ar.Unknown);return{className:n,quality:i}}function kV(t){const e=df(t),n=E.useMemo(()=>_$(e),[e]);return _r(n,e.state)}function TV(t){const e=Cm(),n=kV(e);return{buttonProps:E.useMemo(()=>{const{className:i,disconnect:s}=j$(e);return ma(t,{className:i,onClick:()=>{var a;return s((a=t.stopTracks)!=null?a:!0)},disabled:n===Ve.Disconnected})},[e,t,n])}}function _V(t){if(t.publication instanceof xd){const e=t.publication.track;if(e){const{facingMode:n}=Jj(e);return n}}return"undefined"}function kT(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,s=cc(i),o=typeof t=="string"?{participant:s,source:t}:t,[a,c]=E.useState(!!((n=o.publication)!=null&&n.isMuted||(r=s.getTrack(o.source))!=null&&r.isMuted));return E.useEffect(()=>{const l=Zx(o).subscribe(c);return()=>l.unsubscribe()},[Qx(o)]),a}function CV(t){const e=cc(t),n=E.useMemo(()=>A$(e),[e]);return _r(n,e.isSpeaking)}var IV={connect:!0,audio:!1,video:!1};function RV(t){const e=we(we({},IV),t),{token:n,serverUrl:r,options:i,room:s,connectOptions:o,connect:a,audio:c,video:l,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:m,simulateParticipants:w}=e,g=wn(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&s&&Ge.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,b]=E.useState();E.useEffect(()=>{b(s??new bp(i))},[s]);const C=E.useMemo(()=>{const{className:T}=tV();return ma(g,{className:T})},[g]);return E.useEffect(()=>{if(!v)return;const T=()=>{const R=v.localParticipant;Ge.debug("trying to publish local tracks"),Promise.all([R.setMicrophoneEnabled(!!c,typeof c!="boolean"?c:void 0),R.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),R.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(N=>{Ge.warn(N),h==null||h(N)})},k=R=>{const N=Rd.getFailure(R);p==null||p(N)},I=R=>{m==null||m(R)};return v.on(te.SignalConnected,T).on(te.MediaDevicesError,k).on(te.EncryptionError,I),()=>{v.off(te.SignalConnected,T).off(te.MediaDevicesError,k).off(te.EncryptionError,I)}},[v,c,l,u,h,m,p]),E.useEffect(()=>{if(v){if(w){v.simulateParticipants({participants:{count:w},publish:{audio:!0,useRealTracks:!0}});return}if(!n){Ge.debug("no token yet");return}if(!r){Ge.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(Ge.debug("connecting"),v.connect(r,n,o).catch(T=>{Ge.warn(T),h==null||h(T)})):(Ge.debug("disconnecting because connect is false"),v.disconnect())}},[a,n,JSON.stringify(o),v,h,r,w]),E.useEffect(()=>{if(!v)return;const T=k=>{switch(k){case Ve.Disconnected:f&&f();break;case Ve.Connected:d&&d();break}};return v.on(te.ConnectionStateChanged,T),()=>{v.off(te.ConnectionStateChanged,T)}},[n,d,f,v]),E.useEffect(()=>{if(v)return()=>{Ge.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:C}}function PV(t={}){const e=df(t.room),[n,r]=E.useState(e.localParticipant),[i,s]=E.useState(n.isMicrophoneEnabled),[o,a]=E.useState(n.isMicrophoneEnabled),[c,l]=E.useState(n.lastMicrophoneError),[u,d]=E.useState(n.lastCameraError),[f,h]=E.useState(n.isMicrophoneEnabled),[p,m]=E.useState(void 0),[w,g]=E.useState(void 0),v=b=>{a(b.isCameraEnabled),s(b.isMicrophoneEnabled),h(b.isScreenShareEnabled),g(b.cameraTrack),m(b.microphoneTrack),l(b.participant.lastMicrophoneError),d(b.participant.lastCameraError),r(b.participant)};return E.useEffect(()=>{const b=Iw(n).subscribe(v);return()=>b.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:o,microphoneTrack:p,cameraTrack:w,lastMicrophoneError:c,lastCameraError:u,localParticipant:n}}function xV(){const t=Cm(),e=E.useMemo(()=>L$(t.localParticipant),[t]);return _r(e,t.localParticipant.permissions)}function NV({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const s=Im(),o=E.useMemo(()=>C$(t,i,r),[t,r,i]),a=_r(o,[]),[c,l]=E.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=E.useMemo(()=>B$(t,e??s,n),[t,e,s,n]);return E.useEffect(()=>{const h=d.subscribe(p=>{Ge.info("setCurrentDeviceId",p),p&&l(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:f}}function MV(t){return t!==void 0}function eu(...t){return ma(...t.filter(MV))}function oN(t,e,n){return E.Children.map(t,r=>E.isValidElement(r)&&E.Children.only(t)?E.cloneElement(r,Rn(we({},e),{key:n})):r)}function aN(t,e={}){var n;const[r,i]=E.useState(g0(t)),[s,o]=E.useState(r==null?void 0:r.isMuted),[a,c]=E.useState(r==null?void 0:r.isSubscribed),[l,u]=E.useState(r==null?void 0:r.track),[d,f]=E.useState("landscape"),h=E.useRef(),{className:p,trackObserver:m}=E.useMemo(()=>N$(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,kw(t)&&t.publication.trackSid]);return E.useEffect(()=>{const w=m.subscribe(g=>{Ge.debug("update track",g),i(g),o(g==null?void 0:g.isMuted),c(g==null?void 0:g.isSubscribed),u(g==null?void 0:g.track)});return()=>w==null?void 0:w.unsubscribe()},[m]),E.useEffect(()=>{var w,g;return l&&(h.current&&l.detach(h.current),(w=e.element)!=null&&w.current&&!(g$(t.participant)&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),h.current=(g=e.element)==null?void 0:g.current,()=>{h.current&&(l==null||l.detach(h.current))}},[l,e.element]),E.useEffect(()=>{var w,g;if(typeof((w=r==null?void 0:r.dimensions)==null?void 0:w.width)=="number"&&typeof((g=r==null?void 0:r.dimensions)==null?void 0:g.height)=="number"){const v=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(v)}},[r]),{publication:r,isMuted:s,isSubscribed:a,track:l,elementProps:eu(e.props,we({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function OV({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:s,htmlProps:o}){const a=uf(),c=cc(e),l=E.useMemo(()=>{var m,w,g,v,b,C;const T=(w=(m=t==null?void 0:t.source)!=null?m:a==null?void 0:a.source)!=null?w:n;if(T===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(v=(g=t==null?void 0:t.participant)!=null?g:a==null?void 0:a.participant)!=null?v:c,publication:(C=(b=t==null?void 0:t.publication)!=null?b:a==null?void 0:a.publication)!=null?C:r,source:T}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,c,n,r]),u=E.useMemo(()=>{const{className:m}=W$();return ma(o,{className:m,onClick:w=>{var g,v;if((g=o.onClick)==null||g.call(o,w),typeof i=="function"){const b=(v=l.publication)!=null?v:l.participant.getTrack(l.source);i({participant:l.participant,track:b})}}})},[o,i,l.publication,l.source,l.participant]),d=kT(J.Source.Camera,{participant:l.participant}),f=kT(J.Source.Microphone,{participant:l.participant}),h=CV(l.participant),p=_V(l);return{elementProps:we({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":s===!0?!1:h,"data-lk-local-participant":l.participant.isLocal,"data-lk-source":l.source,"data-lk-facing-mode":p},u)}}function AV(t={}){const e=df(t.room),[n,r]=E.useState([]);return E.useEffect(()=>{const i=D$(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function DV(t={}){const e=AV(t),{localParticipant:n}=PV(t);return[n,...e]}function LV({room:t,props:e}){const n=df(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:s}=E.useMemo(()=>Q$(),[]),o=E.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=_r(o,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:E.useMemo(()=>ma(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayAudio:a}}function FV({room:t,props:e}){const n=df(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:s}=E.useMemo(()=>Z$(),[]),o=E.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=_r(o,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:E.useMemo(()=>ma(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayVideo:a}}function UV({props:t}){const{dispatch:e,state:n}=vV().widget,{className:r}=E.useMemo(()=>eV(),[]);return{mergedProps:E.useMemo(()=>ma(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function BV(t,e={}){var n,r,i,s;let o=uf();const a=(r=(n=_m())!=null?n:e.participant)!=null?r:o==null?void 0:o.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");o={participant:a,source:t}}else if(t)o=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:c,mediaMutedObserver:l}=E.useMemo(()=>V$(o),[Qx(o)]);return{isMuted:_r(l,!!((i=o.publication)!=null&&i.isMuted||(s=o.participant.getTrack(o.source))!=null&&s.isMuted)),className:c}}function jV(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:s}=e,o=wn(e,["source","onChange","initialState","captureOptions"]),a;const c=Im(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=E.useMemo(()=>c?F$(n,c,s):U$(),[c,n,JSON.stringify(s)]),p=_r(f,!1),m=_r(h,i??!!(l!=null&&l.isEnabled));E.useEffect(()=>{r==null||r(m)},[m,r]),E.useEffect(()=>{i!==void 0&&(Ge.debug("forcing initial toggle state",n,i),u(i))},[]);const w=E.useMemo(()=>ma(o,{className:d}),[o,d]),g=E.useCallback(v=>{var b;u(),(b=o.onClick)==null||b.call(o,v)},[o,u]);return{toggle:u,enabled:m,pending:p,track:l,buttonProps:Rn(we({},w),{"aria-pressed":m,"data-lk-source":n,"data-lk-enabled":m,disabled:p,onClick:g})}}function $V(t,e={}){return aN(t,e)}function VV(t){const e=Cm(),[n,r]=E.useState(),i=_r(n==null?void 0:n.isSendingObservable,!1),s=_r(n==null?void 0:n.messageObservable,[]);return E.useEffect(()=>{const o=X$(e,t);r(o)},[e,t]),{send:n==null?void 0:n.send,chatMessages:s,isSending:i}}function zV(t={}){var e;const[n,r]=E.useState(lV(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=E.useCallback(l=>{r(u=>Rn(we({},u),{audioEnabled:l}))},[]),s=E.useCallback(l=>{r(u=>Rn(we({},u),{videoEnabled:l}))},[]),o=E.useCallback(l=>{r(u=>Rn(we({},u),{audioDeviceId:l}))},[]),a=E.useCallback(l=>{r(u=>Rn(we({},u),{videoDeviceId:l}))},[]),c=E.useCallback(l=>{r(u=>Rn(we({},u),{username:l}))},[]);return E.useEffect(()=>{var l;cV(n,(l=t.preventSave)!=null?l:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:s,saveAudioInputDeviceId:o,saveVideoInputDeviceId:a,saveUsername:c}}function WV(t){const{mergedProps:e}=UV({props:t});return E.createElement("button",we({},e),t.children)}function HV(t){const{buttonProps:e}=TV(t);return E.createElement("button",we({},e),t.children)}var GV=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),E.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),qV=GV,JV=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),KV=JV,YV=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),XV=YV,QV=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),ZV=QV,ez=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),E.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),tz=ez,nz=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),E.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),rz=nz,iz=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),sz=iz,oz=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("g",{opacity:.25},E.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),az=oz,cz=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("g",{opacity:.25},E.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),lz=cz,uz=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("g",{opacity:.25},E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),dz=uz,fz=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),hz=fz,pz=t=>E.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),E.createElement("g",{fill:"currentColor"},E.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),E.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),mz=pz;function ev(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:s,onDeviceSelectError:o,exactMatch:a,track:c,requestPermissions:l,onError:u}=e,d=wn(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=Im(),h=E.useCallback(T=>{f&&f.emit(te.MediaDevicesError,T),u==null||u(T)},[f,u]),{devices:p,activeDeviceId:m,setActiveMediaDevice:w,className:g}=NV({kind:n,room:f,track:c,requestPermissions:l,onError:h});E.useEffect(()=>{r!==void 0&&w(r)},[w]),E.useEffect(()=>{typeof s=="function"&&s(p)},[s,p]),E.useEffect(()=>{m&&m!==""&&(i==null||i(m))},[m]);const v=T=>iN(this,null,function*(){try{yield w(T,{exact:a})}catch(k){if(k instanceof Error)o==null||o(k);else throw k}}),b=E.useMemo(()=>eu(d,{className:g},{className:"lk-list"}),[g,d]);function C(T,k,I){return T===k||I===0&&k==="default"}return E.createElement("ul",we({},b),p.map((T,k)=>E.createElement("li",{key:T.deviceId,id:T.deviceId,"data-lk-active":C(T.deviceId,m,k),"aria-selected":C(T.deviceId,m,k),role:"option"},E.createElement("button",{className:"lk-button",onClick:()=>v(T.deviceId)},T.label))))}function cN(t,e){switch(t){case J.Source.Microphone:return e?E.createElement(rz,null):E.createElement(tz,null);case J.Source.Camera:return e?E.createElement(KV,null):E.createElement(qV,null);case J.Source.ScreenShare:return e?E.createElement(mz,null):E.createElement(hz,null);default:return}}function gz(t){switch(t){case Ar.Excellent:return E.createElement(sz,null);case Ar.Good:return E.createElement(az,null);case Ar.Poor:return E.createElement(lz,null);default:return E.createElement(dz,null)}}function tv(t){var e=t,{showIcon:n}=e,r=wn(e,["showIcon"]);const{buttonProps:i,enabled:s}=jV(r);return E.createElement("button",we({},i),(n??!0)&&cN(r.source,s),r.children)}function vz(t){var e;const{className:n,quality:r}=EV(t),i=E.useMemo(()=>Rn(we({},eu(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return E.createElement("div",we({},i),(e=t.children)!=null?e:gz(r))}function yz(t){var e=t,{participant:n}=e,r=wn(e,["participant"]);const i=cc(n),{className:s,infoObserver:o}=E.useMemo(()=>z$(i),[i]),{identity:a,name:c}=_r(o,{name:i.name,identity:i.identity,metadata:i.metadata}),l=E.useMemo(()=>eu(r,{className:s,"data-lk-participant-name":c}),[r,s,c]);return E.createElement("span",we({},l),c!==""?c:a,r.children)}function Sz(t){var e=t,{source:n,participant:r,trackRef:i,show:s="always"}=e,o=wn(e,["source","participant","trackRef","show"]),a,c;const{className:l,isMuted:u}=BV(i??n,{participant:r}),d=s==="always"||s==="muted"&&u||s==="unmuted"&&!u,f=E.useMemo(()=>eu(o,{className:l}),[l,o]);return d?E.createElement("div",Rn(we({},f),{"data-lk-muted":u}),(c=o.children)!=null?c:cN((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function wz(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:s,name:o,publication:a,participant:c}=e,l=wn(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,m,w,g,v,b;const C=uf(),T=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=C==null?void 0:C.publication)==null?void 0:d.trackName)!=null?h:o,k=(m=(p=n==null?void 0:n.source)!=null?p:C==null?void 0:C.source)!=null?m:s,I=(g=(w=n==null?void 0:n.publication)!=null?w:C==null?void 0:C.publication)!=null?g:a,R=(b=(v=n==null?void 0:n.participant)!=null?v:C==null?void 0:C.participant)!=null?b:c;if(k===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const N=E.useRef(null),M=cc(R),{elementProps:L,isSubscribed:F,track:W,publication:z}=aN({source:k,name:T,participant:M,publication:I},{element:N,props:l});return E.useEffect(()=>{r==null||r(!!F)},[F,r]),E.useEffect(()=>{W===void 0||i===void 0||(W instanceof La?W.setVolume(i):Ge.warn("Volume can only be set on remote audio tracks."))},[i,W]),E.useEffect(()=>{z===void 0||l.muted===void 0||(z instanceof yw?z.setEnabled(!l.muted):Ge.warn("Can only call setEnabled on remote track publications."))},[l.muted,z,W]),E.createElement("audio",we({ref:N},L))}function bz(t){const e=!!_m();return t.participant&&!e?E.createElement(xw.Provider,{value:t.participant},t.children):E.createElement(E.Fragment,null,t.children)}function Ez({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=yV(t);return E.useEffect(()=>{Ge.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),E.useEffect(()=>{Ge.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),E.createElement(Pw.Provider,{value:i},r)}function kz(t){const{room:e,htmlProps:n}=RV(t);return E.createElement("div",we({},n),e&&E.createElement(Nw.Provider,{value:e},E.createElement(wV.Provider,{value:t.featureFlags},t.children)))}function Tz(t){var e=t,{participant:n,trackRef:r}=e,i=wn(e,["participant","trackRef"]),s,o;const[a,c]=E.useState([]),l=200,u=90,d=6,f=4,h=50,p=7,m=(s=_m())!=null?s:n;let w=(o=uf())!=null?o:r;if(!w){if(!m)throw Error("Participant missing, provide it directly or within a context");w={participant:m,source:J.Source.Microphone}}const{track:g}=$V(w);return E.useEffect(()=>{if(!g||!(g instanceof Bn||g instanceof La))return;const{analyser:v,cleanup:b}=tj(g,{smoothingTimeConstant:.8,fftSize:64}),C=new Uint8Array(v.frequencyBinCount),T=()=>{v.getByteFrequencyData(C);const I=new Array(p).fill(0);C.slice(1);const R=6;for(let N=0;N<p/2;N+=1){const M=Math.floor(p/2-N);for(let L=0;L<R;L+=1)I[M]+=Math.pow(C[N*R+L]/255,2);I[M]/=R}for(let N=0;N<p/2;N+=1){const M=Math.floor(p/2+N);if(I[M]===0){for(let L=0;L<R;L+=1)I[M]+=Math.pow(C[N*R+L]/255,2);I[M]/=R}}return I.map(N=>N*h)},k=setInterval(()=>{const I=T();c(I)},100);return()=>{clearInterval(k),b()}},[g]),E.createElement("svg",Rn(we({width:"100%",height:"100%",viewBox:`0 0 ${l} ${u}`},i),{className:"lk-audio-visualizer"}),E.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),E.createElement("g",{style:{transform:`translate(${(l-p*(d+f))/2}px, 0)`}},a.map((v,b)=>E.createElement("rect",{key:b,x:b*(d+f),y:u/2-v/2,width:d,height:v}))))}function _z(t){var e=t,{participants:n}=e,r=wn(e,["participants"]);return E.createElement(E.Fragment,null,n.map(i=>E.createElement(xw.Provider,{value:i,key:i.identity},oN(r.children))))}function Cz(t){var e=t,{participant:n,children:r,source:i,publication:s,disableSpeakingIndicator:o,onParticipantClick:a}=e,c=wn(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const l=cc(n),{elementProps:u}=OV({participant:l,htmlProps:c,disableSpeakingIndicator:o,source:J.Source.Microphone,publication:s,onParticipantClick:a});return E.createElement("div",we({style:{position:"relative"}},u),E.createElement(bz,{participant:l},r??E.createElement(E.Fragment,null,E.createElement(wz,{source:i??J.Source.Microphone}),E.createElement(Tz,null),E.createElement("div",{className:"lk-participant-metadata"},E.createElement("div",{className:"lk-participant-metadata-item"},E.createElement(Sz,{source:J.Source.Microphone}),E.createElement(yz,null)),E.createElement(vz,{className:"lk-participant-metadata-item"})))))}function Iz(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:s}=e,o=wn(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,c,l,u;const d=E.useMemo(()=>s?s(n.message):n.message,[n.message,s]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return E.createElement("li",we({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},o),(!i||!r)&&E.createElement("span",{className:"lk-meta-data"},!r&&E.createElement("strong",{className:"lk-participant-name"},(u=(c=n.from)==null?void 0:c.name)!=null?u:(l=n.from)==null?void 0:l.identity),!i&&E.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),E.createElement("span",{className:"lk-message-body"},d))}function Rz(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:s}=e,o=wn(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=E.useRef(null),c=E.useRef(null),l=E.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:s}),[r,i,s]),{send:u,chatMessages:d,isSending:f}=VV(l),h=sN(),p=E.useRef(0);function m(w){return iN(this,null,function*(){w.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return E.useEffect(()=>{var w;c&&((w=c.current)==null||w.scrollTo({top:c.current.scrollHeight}))},[c,d]),E.useEffect(()=>{var w,g,v,b,C;if(!h||d.length===0)return;if((w=h.widget.state)!=null&&w.showChat&&d.length>0&&p.current!==((g=d[d.length-1])==null?void 0:g.timestamp)){p.current=(v=d[d.length-1])==null?void 0:v.timestamp;return}const T=d.filter(I=>!p.current||I.timestamp>p.current).length,{widget:k}=h;T>0&&((b=k.state)==null?void 0:b.unreadMessages)!==T&&((C=k.dispatch)==null||C.call(k,{msg:"unread_msg",count:T}))},[d,h==null?void 0:h.widget]),E.createElement("div",Rn(we({},o),{className:"lk-chat"}),E.createElement("ul",{className:"lk-list lk-chat-messages",ref:c},o.children?d.map((w,g)=>oN(o.children,{entry:w,key:g,messageFormatter:n})):d.map((w,g,v)=>{const b=g>=1&&v[g-1].from===w.from,C=g>=1&&w.timestamp-v[g-1].timestamp<6e4;return E.createElement(Iz,{key:g,hideName:b,hideTimestamp:b===!1?!1:C,entry:w,messageFormatter:n})})),E.createElement("form",{className:"lk-chat-form",onSubmit:m},E.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),E.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function TT(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:s,requestPermissions:o=!1}=e,a=wn(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[c,l]=E.useState(!1),[u,d]=E.useState([]),[f,h]=E.useState(!0),p=(v,b)=>{Ge.debug("handle device change"),l(!1),i==null||i(v,b)},m=E.useRef(null),w=E.useRef(null);E.useLayoutEffect(()=>{m.current&&w.current&&(u||f)&&v$(m.current,w.current).then(({x:v,y:b})=>{w.current&&Object.assign(w.current.style,{left:`${v}px`,top:`${b}px`})}),h(!1)},[m,w,u,f]);const g=E.useCallback(v=>{w.current&&v.target!==m.current&&c&&y$(w.current,v)&&l(!1)},[c,w,m]);return E.useEffect(()=>(document.addEventListener("click",g),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",g),window.removeEventListener("resize",()=>h(!0))}),[g,h]),E.createElement(E.Fragment,null,E.createElement("button",Rn(we({className:"lk-button lk-button-menu","aria-pressed":c},a),{onClick:()=>l(!c),ref:m}),a.children),!a.disabled&&E.createElement("div",{className:"lk-device-menu",ref:w,style:{visibility:c?"visible":"hidden"}},n?E.createElement(ev,{initialSelection:r,onActiveDeviceChange:v=>p(n,v),onDeviceListChange:d,kind:n,track:s==null?void 0:s[n],requestPermissions:o}):E.createElement(E.Fragment,null,E.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),E.createElement(ev,{kind:"audioinput",onActiveDeviceChange:v=>p("audioinput",v),onDeviceListChange:d,track:s==null?void 0:s.audioinput,requestPermissions:o}),E.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),E.createElement(ev,{kind:"videoinput",onActiveDeviceChange:v=>p("videoinput",v),onDeviceListChange:d,track:s==null?void 0:s.videoinput,requestPermissions:o}))))}function Pz(t){var e=t,{label:n}=e,r=wn(e,["label"]);const i=Cm(),{mergedProps:s,canPlayAudio:o}=LV({room:i,props:r}),{mergedProps:a,canPlayVideo:c}=FV({room:i,props:s}),l=a,{style:u}=l,d=wn(l,["style"]);return u.display=o&&c?"none":"block",E.createElement("button",we({style:u},d),n??`Start ${o?"Video":"Audio"}`)}function xz(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,s=wn(e,["variation","controls","saveUserChoices"]),o,a,c,l,u;const[d,f]=E.useState(!1),h=sN();E.useEffect(()=>{var W,z;((W=h==null?void 0:h.widget.state)==null?void 0:W.showChat)!==void 0&&f((z=h==null?void 0:h.widget.state)==null?void 0:z.showChat)},[(o=h==null?void 0:h.widget.state)==null?void 0:o.showChat]);const m=pV(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=m);const w=we({leave:!0},r),g=xV();g?((a=w.camera)!=null||(w.camera=g.canPublish),(c=w.microphone)!=null||(w.microphone=g.canPublish),(l=w.screenShare)!=null||(w.screenShare=g.canPublish),(u=w.chat)!=null||(w.chat=g.canPublishData&&(r==null?void 0:r.chat))):(w.camera=!1,w.chat=!1,w.microphone=!1,w.screenShare=!1);const v=E.useMemo(()=>n==="minimal"||n==="verbose",[n]),b=E.useMemo(()=>n==="textOnly"||n==="verbose",[n]),C=E$(),[T,k]=E.useState(!1),I=W=>{k(W)},R=eu({className:"lk-control-bar"},s),{saveAudioInputEnabled:N,saveVideoInputEnabled:M,saveAudioInputDeviceId:L,saveVideoInputDeviceId:F}=zV({preventSave:!i});return E.createElement("div",we({},R),w.microphone&&E.createElement("div",{className:"lk-button-group"},E.createElement(tv,{source:J.Source.Microphone,showIcon:v,onChange:N},b&&"Microphone"),E.createElement("div",{className:"lk-button-group-menu"},E.createElement(TT,{kind:"audioinput",onActiveDeviceChange:(W,z)=>L(z??"")}))),w.camera&&E.createElement("div",{className:"lk-button-group"},E.createElement(tv,{source:J.Source.Camera,showIcon:v,onChange:M},b&&"Camera"),E.createElement("div",{className:"lk-button-group-menu"},E.createElement(TT,{kind:"videoinput",onActiveDeviceChange:(W,z)=>F(z??"")}))),w.screenShare&&C&&E.createElement(tv,{source:J.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:v,onChange:I},b&&(T?"Stop screen share":"Share screen")),w.chat&&E.createElement(WV,null,v&&E.createElement(XV,null),b&&"Chat"),w.leave&&E.createElement(HV,null,v&&E.createElement(ZV,null),b&&"Leave"),E.createElement(Pz,null))}function Nz(t){var e=wn(t,[]);const[n,r]=E.useState({showChat:!1,unreadMessages:0}),i=DV();return E.createElement(Ez,{onWidgetChange:r},E.createElement("div",we({className:"lk-audio-conference"},e),E.createElement("div",{className:"lk-audio-conference-stage"},E.createElement(_z,{participants:i},E.createElement(Cz,null))),E.createElement(xz,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&E.createElement(Rz,null)))}const Mz="wss://mongoose-67t79p35.livekit.cloud",Oz=({client:t})=>{const[e,n]=E.useState([]),[r,i]=E.useState(!1);return E.useEffect(()=>{const s=a=>{n(c=>[...c,a]),i(!0)},o=a=>{n(c=>{const l=c.filter(u=>u!==a);return l.length===0&&i(!1),l})};return t.on("livekitToken",s),t.on("livekitLeave",o),()=>{t.off("livekitToken",s),t.off("livekitLeave",o)}},[t]),e.length?X.jsxs("div",{"data-lk-theme":"default",children:[e.map((s,o)=>X.jsx(kz,{video:!1,audio:!0,token:s,serverUrl:Mz,connect:!0,onDisconnected:()=>t.emit("livekitLeave",s),children:X.jsx(Nz,{})},o)),X.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},lN=Object.prototype.toString;function Mw(t){switch(lN.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return ro(t,Error)}}function tu(t,e){return lN.call(t)===`[object ${e}]`}function Ow(t){return tu(t,"ErrorEvent")}function _T(t){return tu(t,"DOMError")}function Az(t){return tu(t,"DOMException")}function ss(t){return tu(t,"String")}function Aw(t){return t===null||typeof t!="object"&&typeof t!="function"}function Ol(t){return tu(t,"Object")}function Rm(t){return typeof Event<"u"&&ro(t,Event)}function Dz(t){return typeof Element<"u"&&ro(t,Element)}function Lz(t){return tu(t,"RegExp")}function Dw(t){return!!(t&&t.then&&typeof t.then=="function")}function Fz(t){return Ol(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function uN(t){return typeof t=="number"&&t!==t}function ro(t,e){try{return t instanceof e}catch{return!1}}function dN(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function ul(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function CT(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const i=t[r];try{dN(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function Uz(t,e,n=!1){return ss(t)?Lz(e)?e.test(t):ss(e)?n?t===e:t.includes(e):!1:!1}function nu(t,e=[],n=!1){return e.some(r=>Uz(t,r,n))}function Bz(t,e,n=250,r,i,s,o){if(!s.exception||!s.exception.values||!o||!ro(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=jz(v0(t,e,i,o.originalException,r,s.exception.values,a,0),n))}function v0(t,e,n,r,i,s,o,a){if(s.length>=n+1)return s;let c=[...s];if(ro(r[i],Error)){IT(o,a);const l=t(e,r[i]),u=c.length;RT(l,i,u,a),c=v0(t,e,n,r[i],i,[l,...c],l,u)}return Array.isArray(r.errors)&&r.errors.forEach((l,u)=>{if(ro(l,Error)){IT(o,a);const d=t(e,l),f=c.length;RT(d,`errors[${u}]`,f,a),c=v0(t,e,n,l,i,[d,...c],d,f)}}),c}function IT(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function RT(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function jz(t,e){return t.map(n=>(n.value&&(n.value=ul(n.value,e)),n))}function Gf(t){return t&&t.Math==Math?t:void 0}const ze=typeof globalThis=="object"&&Gf(globalThis)||typeof window=="object"&&Gf(window)||typeof self=="object"&&Gf(self)||typeof global=="object"&&Gf(global)||function(){return this}()||{};function Pm(){return ze}function fN(t,e,n){const r=n||ze,i=r.__SENTRY__=r.__SENTRY__||{};return i[t]||(i[t]=e())}const dl=Pm(),$z=80;function Xa(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,i=[];let s=0,o=0;const a=" > ",c=a.length;let l;const u=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||$z;for(;n&&s++<r&&(l=Vz(n,u),!(l==="html"||s>1&&o+i.length*c+l.length>=d));)i.push(l),o+=l.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}function Vz(t,e){const n=t,r=[];let i,s,o,a,c;if(!n||!n.tagName)return"";if(dl.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const l=e&&e.length?e.filter(d=>n.getAttribute(d)).map(d=>[d,n.getAttribute(d)]):null;if(l&&l.length)l.forEach(d=>{r.push(`[${d[0]}="${d[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),i=n.className,i&&ss(i))for(s=i.split(/\s+/),c=0;c<s.length;c++)r.push(`.${s[c]}`);const u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)o=u[c],a=n.getAttribute(o),a&&r.push(`[${o}="${a}"]`);return r.join("")}function zz(){try{return dl.document.location.href}catch{return""}}function Wz(t){return dl.document&&dl.document.querySelector?dl.document.querySelector(t):null}function hN(t){if(!dl.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement&&e.dataset.sentryComponent)return e.dataset.sentryComponent;e=e.parentNode}return null}const ru=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Hz="Sentry Logger ",y0=["debug","info","warn","error","log","assert","trace"],Ip={};function Qa(t){if(!("console"in ze))return t();const e=ze.console,n={},r=Object.keys(Ip);r.forEach(i=>{const s=Ip[i];n[i]=e[i],e[i]=s});try{return t()}finally{r.forEach(i=>{e[i]=n[i]})}}function Gz(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return ru?y0.forEach(n=>{e[n]=(...r)=>{t&&Qa(()=>{ze.console[n](`${Hz}[${n}]:`,...r)})}}):y0.forEach(n=>{e[n]=()=>{}}),e}const G=Gz(),qz=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Jz(t){return t==="http"||t==="https"}function iu(t,e=!1){const{host:n,path:r,pass:i,port:s,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${o}`}function Kz(t){const e=qz.exec(t);if(!e){Qa(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,i="",s,o="",a]=e.slice(1);let c="",l=a;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const d=l.match(/^\d+/);d&&(l=d[0])}return pN({host:s,pass:i,path:c,projectId:l,port:o,protocol:n,publicKey:r})}function pN(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Yz(t){if(!ru)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(G.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Jz(r)?e&&isNaN(parseInt(e,10))?(G.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(G.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(G.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function mN(t){const e=typeof t=="string"?Kz(t):pN(t);if(!(!e||!Yz(e)))return e}class Fi extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function cn(t,e,n){if(!(e in t))return;const r=t[e],i=n(r);typeof i=="function"&&gN(i,r),t[e]=i}function Od(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{ru&&G.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function gN(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,Od(t,"__sentry_original__",e)}catch{}}function Lw(t){return t.__sentry_original__}function Xz(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function vN(t){if(Mw(t))return{message:t.message,name:t.name,stack:t.stack,...xT(t)};if(Rm(t)){const e={type:t.type,target:PT(t.target),currentTarget:PT(t.currentTarget),...xT(t)};return typeof CustomEvent<"u"&&ro(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function PT(t){try{return Dz(t)?Xa(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function xT(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function Qz(t,e=40){const n=Object.keys(vN(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return ul(n[0],e);for(let r=n.length;r>0;r--){const i=n.slice(0,r).join(", ");if(!(i.length>e))return r===n.length?i:ul(i,e)}return""}function os(t){return S0(t,new Map)}function S0(t,e){if(Ol(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const i of Object.keys(t))typeof t[i]<"u"&&(r[i]=S0(t[i],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(i=>{r.push(S0(i,e))}),r}return t}const yN=50,NT=/\(error: (.*)\)/,MT=/captureMessage|captureException/;function SN(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0)=>{const i=[],s=n.split(`
`);for(let o=r;o<s.length;o++){const a=s[o];if(a.length>1024)continue;const c=NT.test(a)?a.replace(NT,"$1"):a;if(!c.match(/\S*Error: /)){for(const l of e){const u=l(c);if(u){i.push(u);break}}if(i.length>=yN)break}}return eW(i)}}function Zz(t){return Array.isArray(t)?SN(...t):t}function eW(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),MT.test(e[e.length-1].function||"")&&(e.pop(),MT.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,yN).map(n=>({...n,filename:n.filename||e[e.length-1].filename,function:n.function||"?"}))}const nv="<anonymous>";function io(t){try{return!t||typeof t!="function"?nv:t.name||nv}catch{return nv}}const Nh={},OT={};function lc(t,e){Nh[t]=Nh[t]||[],Nh[t].push(e)}function uc(t,e){OT[t]||(e(),OT[t]=!0)}function Si(t,e){const n=t&&Nh[t];if(n)for(const r of n)try{r(e)}catch(i){ru&&G.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${io(r)}
Error:`,i)}}function tW(t){const e="console";lc(e,t),uc(e,nW)}function nW(){"console"in ze&&y0.forEach(function(t){t in ze.console&&cn(ze.console,t,function(e){return Ip[t]=e,function(...n){Si("console",{args:n,level:t});const i=Ip[t];i&&i.apply(ze.console,n)}})})}function Pn(){const t=ze,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function wN(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function No(t){const{message:e,event_id:n}=t;if(e)return e;const r=wN(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function w0(t,e,n){const r=t.exception=t.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type=n||"Error")}function Ad(t,e){const n=wN(t);if(!n)return;const r={type:"generic",handled:!0},i=n.mechanism;if(n.mechanism={...r,...i,...e},e&&"data"in e){const s={...i&&i.data,...e.data};n.mechanism.data=s}}function AT(t){if(t&&t.__sentry_captured__)return!0;try{Od(t,"__sentry_captured__",!0)}catch{}return!1}function bN(t){return Array.isArray(t)?t:[t]}const kc=ze,rW=1e3;let DT,b0,E0;function EN(t){const e="dom";lc(e,t),uc(e,iW)}function iW(){if(!kc.document)return;const t=Si.bind(null,"dom"),e=LT(t,!0);kc.document.addEventListener("click",e,!1),kc.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=kc[n]&&kc[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(cn(r,"addEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},u=l[s]=l[s]||{refCount:0};if(!u.handler){const d=LT(t);u.handler=d,i.call(this,s,d,a)}u.refCount++}catch{}return i.call(this,s,o,a)}}),cn(r,"removeEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__||{},u=l[s];u&&(u.refCount--,u.refCount<=0&&(i.call(this,s,u.handler,a),u.handler=void 0,delete l[s]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return i.call(this,s,o,a)}}))})}function sW(t){if(t.type!==b0)return!1;try{if(!t.target||t.target._sentryId!==E0)return!1}catch{}return!0}function oW(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function LT(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=aW(n);if(oW(n.type,r))return;Od(n,"_sentryCaptured",!0),r&&!r._sentryId&&Od(r,"_sentryId",Pn());const i=n.type==="keypress"?"input":n.type;sW(n)||(t({event:n,name:i,global:e}),b0=n.type,E0=r?r._sentryId:void 0),clearTimeout(DT),DT=kc.setTimeout(()=>{E0=void 0,b0=void 0},rW)}}function aW(t){try{return t.target}catch{return null}}const k0=Pm();function kN(){if(!("fetch"in k0))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function T0(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function cW(){if(typeof EdgeRuntime=="string")return!0;if(!kN())return!1;if(T0(k0.fetch))return!0;let t=!1;const e=k0.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=T0(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){ru&&G.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function Fw(t){const e="fetch";lc(e,t),uc(e,lW)}function lW(){cW()&&cn(ze,"fetch",function(t){return function(...e){const{method:n,url:r}=uW(e),i={args:e,fetchData:{method:n,url:r},startTimestamp:Date.now()};return Si("fetch",{...i}),t.apply(ze,e).then(s=>{const o={...i,endTimestamp:Date.now(),response:s};return Si("fetch",o),s},s=>{const o={...i,endTimestamp:Date.now(),error:s};throw Si("fetch",o),s})}})}function _0(t,e){return!!t&&typeof t=="object"&&!!t[e]}function FT(t){return typeof t=="string"?t:t?_0(t,"url")?t.url:t.toString?t.toString():"":""}function uW(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:FT(n),method:_0(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:FT(e),method:_0(e,"method")?String(e.method).toUpperCase():"GET"}}let qf=null;function TN(t){const e="error";lc(e,t),uc(e,dW)}function dW(){qf=ze.onerror,ze.onerror=function(t,e,n,r,i){return Si("error",{column:r,error:i,line:n,msg:t,url:e}),qf&&!qf.__SENTRY_LOADER__?qf.apply(this,arguments):!1},ze.onerror.__SENTRY_INSTRUMENTED__=!0}let Jf=null;function _N(t){const e="unhandledrejection";lc(e,t),uc(e,fW)}function fW(){Jf=ze.onunhandledrejection,ze.onunhandledrejection=function(t){return Si("unhandledrejection",t),Jf&&!Jf.__SENTRY_LOADER__?Jf.apply(this,arguments):!0},ze.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Kf=Pm();function hW(){const t=Kf.chrome,e=t&&t.app&&t.app.runtime,n="history"in Kf&&!!Kf.history.pushState&&!!Kf.history.replaceState;return!e&&n}const Tu=ze;let Yf;function xm(t){const e="history";lc(e,t),uc(e,pW)}function pW(){if(!hW())return;const t=Tu.onpopstate;Tu.onpopstate=function(...n){const r=Tu.location.href,i=Yf;if(Yf=r,Si("history",{from:i,to:r}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const s=Yf,o=String(i);Yf=o,Si("history",{from:s,to:o})}return n.apply(this,r)}}cn(Tu.history,"pushState",e),cn(Tu.history,"replaceState",e)}const mW=ze,$o="__sentry_xhr_v3__";function Uw(t){const e="xhr";lc(e,t),uc(e,gW)}function gW(){if(!mW.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;cn(t,"open",function(e){return function(...n){const r=Date.now(),i=ss(n[0])?n[0].toUpperCase():void 0,s=vW(n[1]);if(!i||!s)return e.apply(this,n);this[$o]={method:i,url:s,request_headers:{}},i==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const o=()=>{const a=this[$o];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}const c={args:[i,s],endTimestamp:Date.now(),startTimestamp:r,xhr:this};Si("xhr",c)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?cn(this,"onreadystatechange",function(a){return function(...c){return o(),a.apply(this,c)}}):this.addEventListener("readystatechange",o),cn(this,"setRequestHeader",function(a){return function(...c){const[l,u]=c,d=this[$o];return d&&ss(l)&&ss(u)&&(d.request_headers[l.toLowerCase()]=u),a.apply(this,c)}}),e.apply(this,n)}}),cn(t,"send",function(e){return function(...n){const r=this[$o];if(!r)return e.apply(this,n);n[0]!==void 0&&(r.body=n[0]);const i={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return Si("xhr",i),e.apply(this,n)}})}function vW(t){if(ss(t))return t;try{return t.toString()}catch{}}function yW(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function SW(){return"npm"}function CN(){return!yW()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function wW(t,e){return t.require(e)}function UT(){return typeof window<"u"&&(!CN()||bW())}function bW(){return ze.process!==void 0&&ze.process.type==="renderer"}function EW(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(i){if(t)return e.has(i)?!0:(e.add(i),!1);for(let s=0;s<e.length;s++)if(e[s]===i)return!0;return e.push(i),!1}function r(i){if(t)e.delete(i);else for(let s=0;s<e.length;s++)if(e[s]===i){e.splice(s,1);break}}return[n,r]}function Ai(t,e=100,n=1/0){try{return C0("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function IN(t,e=3,n=100*1024){const r=Ai(t,e);return CW(r)>n?IN(t,e-1,n):r}function C0(t,e,n=1/0,r=1/0,i=EW()){const[s,o]=i;if(e==null||["number","boolean","string"].includes(typeof e)&&!uN(e))return e;const a=kW(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(s(e))return"[Circular ~]";const l=e;if(l&&typeof l.toJSON=="function")try{const h=l.toJSON();return C0("",h,c-1,r,i)}catch{}const u=Array.isArray(e)?[]:{};let d=0;const f=vN(e);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(d>=r){u[h]="[MaxProperties ~]";break}const p=f[h];u[h]=C0(h,p,c-1,r,i),d++}return o(e),u}function kW(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(dN(e))return"[VueViewModel]";if(Fz(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${io(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=TW(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function TW(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function _W(t){return~-encodeURI(t).split(/%..|./).length}function CW(t){return _W(JSON.stringify(t))}var ms;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const r=2;t[t.REJECTED=r]="REJECTED"})(ms||(ms={}));function Al(t){return new yr(e=>{e(t)})}function Bw(t){return new yr((e,n)=>{n(t)})}class yr{constructor(e){yr.prototype.__init.call(this),yr.prototype.__init2.call(this),yr.prototype.__init3.call(this),yr.prototype.__init4.call(this),this._state=ms.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new yr((r,i)=>{this._handlers.push([!1,s=>{if(!e)r(s);else try{r(e(s))}catch(o){i(o)}},s=>{if(!n)i(s);else try{r(n(s))}catch(o){i(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new yr((n,r)=>{let i,s;return this.then(o=>{s=!1,i=o,e&&e()},o=>{s=!0,i=o,e&&e()}).then(()=>{if(s){r(i);return}n(i)})})}__init(){this._resolve=e=>{this._setResult(ms.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(ms.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===ms.PENDING){if(Dw(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===ms.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===ms.RESOLVED&&n[1](this._value),this._state===ms.REJECTED&&n[2](this._value),n[0]=!0)})}}}function IW(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]}function i(o){if(!n())return Bw(new Fi("Not adding Promise because buffer limit was reached."));const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function s(o){return new yr((a,c)=>{let l=e.length;if(!l)return a(!0);const u=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(d=>{Al(d).then(()=>{--l||(clearTimeout(u),a(!0))},c)})})}return{$:e,add:i,drain:s}}function rv(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const RW=["fatal","error","warning","log","info","debug"];function PW(t){return t==="warn"?"warning":RW.includes(t)?t:"log"}const RN=Pm(),I0={nowSeconds:()=>Date.now()/1e3};function xW(){const{performance:t}=RN;if(!t||!t.now)return;const e=Date.now()-t.now();return{now:()=>t.now(),timeOrigin:e}}function NW(){try{return wW(SO,"perf_hooks").performance}catch{return}}const iv=CN()?NW():xW(),BT=iv===void 0?I0:{nowSeconds:()=>(iv.timeOrigin+iv.now())/1e3},Nm=I0.nowSeconds.bind(I0),Za=BT.nowSeconds.bind(BT),ki=(()=>{const{performance:t}=RN;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),i=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,s=i<e,o=t.timing&&t.timing.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,l=c<e;return s||l?i<=c?t.timeOrigin:o:r})(),R0="baggage",PN="sentry-",MW=/^sentry-/,OW=8192;function AW(t){if(!ss(t)&&!Array.isArray(t))return;let e={};if(Array.isArray(t))e=t.reduce((r,i)=>{const s=jT(i);return{...r,...s}},{});else{if(!t)return;e=jT(t)}const n=Object.entries(e).reduce((r,[i,s])=>{if(i.match(MW)){const o=i.slice(PN.length);r[o]=s}return r},{});if(Object.keys(n).length>0)return n}function P0(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,i])=>(i&&(n[`${PN}${r}`]=i),n),{});return DW(e)}function jT(t){return t.split(",").map(e=>e.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((e,[n,r])=>(e[n]=r,e),{})}function DW(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],i)=>{const s=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=i===0?s:`${e},${s}`;return o.length>OW?(ru&&G.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):o},"")}const LW=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function FW(t){if(!t)return;const e=t.match(LW);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function UW(t,e){const n=FW(t),r=AW(e),{traceId:i,parentSpanId:s,parentSampled:o}=n||{},a={traceId:i||Pn(),spanId:Pn().substring(16),sampled:o};return s&&(a.parentSpanId=s),r&&(a.dsc=r),{traceparentData:n,dynamicSamplingContext:r,propagationContext:a}}function jw(t=Pn(),e=Pn().substring(16),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}function dc(t,e=[]){return[t,e]}function BW(t,e){const[n,r]=t;return[n,[...r,e]]}function $T(t,e){const n=t[1];for(const r of n){const i=r[0].type;if(e(r,i))return!0}return!1}function x0(t,e){return(e||new TextEncoder).encode(t)}function jW(t,e){const[n,r]=t;let i=JSON.stringify(n);function s(o){typeof i=="string"?i=typeof o=="string"?i+o:[x0(i,e),o]:i.push(typeof o=="string"?x0(o,e):o)}for(const o of r){const[a,c]=o;if(s(`
${JSON.stringify(a)}
`),typeof c=="string"||c instanceof Uint8Array)s(c);else{let l;try{l=JSON.stringify(c)}catch{l=JSON.stringify(Ai(c))}s(l)}}return typeof i=="string"?i:$W(i)}function $W(t){const e=t.reduce((i,s)=>i+s.length,0),n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}function VW(t,e){const n=typeof t.data=="string"?x0(t.data,e):t.data;return[os({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const zW={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function VT(t){return zW[t]}function $w(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function xN(t,e,n,r){const i=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:iu(r)},...i&&{trace:os({...i})}}}function WW(t,e,n){const r=[{type:"client_report"},{timestamp:n||Nm(),discarded_events:t}];return dc(e?{dsn:e}:{},[r])}const HW=60*1e3;function GW(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?HW:r-e}function qW(t,e){return t[e]||t.all||0}function NN(t,e,n=Date.now()){return qW(t,e)>n}function MN(t,{statusCode:e,headers:n},r=Date.now()){const i={...t},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const a of s.trim().split(",")){const[c,l]=a.split(":",2),u=parseInt(c,10),d=(isNaN(u)?60:u)*1e3;if(!l)i.all=r+d;else for(const f of l.split(";"))i[f]=r+d}else o?i.all=r+GW(o,r):e===429&&(i.all=r+60*1e3);return i}const ye=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Vw="production";function zw(){return fN("globalEventProcessors",()=>[])}function JW(t){zw().push(t)}function Rp(t,e,n,r=0){return new yr((i,s)=>{const o=t[r];if(e===null||typeof o!="function")i(e);else{const a=o({...e},n);ye&&o.id&&a===null&&G.log(`Event processor "${o.id}" dropped event`),Dw(a)?a.then(c=>Rp(t,c,n,r+1).then(i)).then(null,s):Rp(t,a,n,r+1).then(i).then(null,s)}})}function KW(t){const e=Za(),n={sid:Pn(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>XW(n)};return t&&Dl(n,t),n}function Dl(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Za(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Pn()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function YW(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),Dl(t,n)}function XW(t){return os({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}function ON(t,e){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s,propagationContext:o}=e;QW(t,e),r&&tH(t,r),nH(t,n),ZW(t,i),eH(t,s,o)}function zT(t,e){const{extra:n,tags:r,user:i,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:f,transactionName:h,span:p}=e;_u(t,"extra",n),_u(t,"tags",r),_u(t,"user",i),_u(t,"contexts",s),_u(t,"sdkProcessingMetadata",a),o&&(t.level=o),h&&(t.transactionName=h),p&&(t.span=p),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),l.length&&(t.fingerprint=[...t.fingerprint,...l]),u.length&&(t.eventProcessors=[...t.eventProcessors,...u]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...f}}function _u(t,e,n){n&&Object.keys(n).length&&(t[e]={...t[e],...n})}function QW(t,e){const{extra:n,tags:r,user:i,contexts:s,level:o,transactionName:a}=e;n&&Object.keys(n).length&&(t.extra={...n,...t.extra}),r&&Object.keys(r).length&&(t.tags={...r,...t.tags}),i&&Object.keys(i).length&&(t.user={...i,...t.user}),s&&Object.keys(s).length&&(t.contexts={...s,...t.contexts}),o&&(t.level=o),a&&(t.transaction=a)}function ZW(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function eH(t,e,n){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e,propagationContext:n}}function tH(t,e){t.contexts={trace:e.getTraceContext(),...t.contexts};const n=e.transaction;if(n){t.sdkProcessingMetadata={dynamicSamplingContext:n.getDynamicSamplingContext(),...t.sdkProcessingMetadata};const r=n.name;r&&(t.tags={transaction:r,...t.tags})}}function nH(t,e){t.fingerprint=t.fingerprint?bN(t.fingerprint):[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}const rH=100;let sv;class ts{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=WT()}static clone(e){return e?e.clone():new ts}clone(){const e=new ts;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&Dl(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){const n=e(this);return n instanceof ts?n:this}return e instanceof ts?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Ol(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=WT(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:rH;if(r<=0)return this;const i={timestamp:Nm(),...e},s=this._breadcrumbs;return s.push(i),this._breadcrumbs=s.length>r?s.slice(-r):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:n,_contexts:r,_tags:i,_extra:s,_user:o,_level:a,_fingerprint:c,_eventProcessors:l,_propagationContext:u,_sdkProcessingMetadata:d,_transactionName:f,_span:h}=this;return{breadcrumbs:e,attachments:n,contexts:r,tags:i,extra:s,user:o,level:a,fingerprint:c||[],eventProcessors:l,propagationContext:u,sdkProcessingMetadata:d,transactionName:f,span:h}}applyToEvent(e,n={},r=[]){ON(e,this.getScopeData());const i=[...r,...zw(),...this._eventProcessors];return Rp(i,e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function iH(){return sv||(sv=new ts),sv}function WT(){return{traceId:Pn(),spanId:Pn().substring(16)}}const Dd="7.91.0",AN=parseFloat(Dd),sH=100;class DN{constructor(e,n=new ts,r=new ts,i=AN){this._version=i,this._stack=[{scope:n}],e&&this.bindClient(e),this._isolationScope=r}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();try{return e(n)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Pn(),i=new Error("Sentry syntheticException");return this._withClient((s,o)=>{s.captureException(e,{originalException:e,syntheticException:i,...n,event_id:r},o)}),r}captureMessage(e,n,r){const i=this._lastEventId=r&&r.event_id?r.event_id:Pn(),s=new Error(e);return this._withClient((o,a)=>{o.captureMessage(e,n,{originalException:e,syntheticException:s,...r,event_id:i},a)}),i}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Pn();return e.type||(this._lastEventId=r),this._withClient((i,s)=>{i.captureEvent(e,{...n,event_id:r},s)}),r}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:r,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=sH}=i.getOptions&&i.getOptions()||{};if(o<=0)return;const c={timestamp:Nm(),...e},l=s?Qa(()=>s(c,n)):c;l!==null&&(i.emit&&i.emit("beforeAddBreadcrumb",l,n),r.addBreadcrumb(l,o))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n)}configureScope(e){const{scope:n,client:r}=this.getStackTop();r&&e(n)}run(e){const n=HT(this);try{e(this)}finally{HT(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return ye&&G.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const r=this._callExtensionMethod("startTransaction",e,n);return ye&&!r&&(this.getClient()?G.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):G.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&YW(r),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:r}=this.getStackTop(),{release:i,environment:s=Vw}=r&&r.getOptions()||{},{userAgent:o}=ze.navigator||{},a=KW({release:i,environment:s,user:n.getUser(),...o&&{userAgent:o},...e}),c=n.getSession&&n.getSession();return c&&c.status==="ok"&&Dl(c,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),r=e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_withClient(e){const{scope:n,client:r}=this.getStackTop();r&&e(r,n)}_callExtensionMethod(e,...n){const i=ff().__SENTRY__;if(i&&i.extensions&&typeof i.extensions[e]=="function")return i.extensions[e].apply(this,n);ye&&G.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function ff(){return ze.__SENTRY__=ze.__SENTRY__||{extensions:{},hub:void 0},ze}function HT(t){const e=ff(),n=N0(e);return FN(e,t),n}function Nn(){const t=ff();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return oH(t)}function LN(){return Nn().getIsolationScope()}function oH(t=ff()){return(!aH(t)||N0(t).isOlderThan(AN))&&FN(t,new DN),N0(t)}function aH(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function N0(t){return fN("hub",()=>new DN,t)}function FN(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function hf(t){return(t||Nn()).getScope().getTransaction()}function Ww(t){return t>9999999999?t/1e3:t}let GT=!1;function cH(){GT||(GT=!0,TN(M0),_N(M0))}function M0(){const t=hf();if(t){const e="internal_error";ye&&G.log(`[Tracing] Transaction: ${e} -> Global error occured`),t.setStatus(e)}}M0.tag="sentry_tracingErrorCallback";class UN{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class Hw{constructor(e={}){this.traceId=e.traceId||Pn(),this.spanId=e.spanId||Pn().substring(16),this.startTimestamp=e.startTimestamp||Za(),this.tags=e.tags||{},this.data=e.data||{},this.instrumenter=e.instrumenter||"sentry",this.origin=e.origin||"manual",e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.name&&(this.description=e.name),e.status&&(this.status=e.status),e.endTimestamp&&(this.endTimestamp=e.endTimestamp)}get name(){return this.description||""}set name(e){this.setName(e)}startChild(e){const n=new Hw({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n),n.transaction=this.transaction,ye&&n.transaction){const r=e&&e.op||"< unknown op >",i=n.transaction.name||"< unknown name >",s=n.transaction.spanId,o=`[Tracing] Starting '${r}' span on transaction '${i}' (${s}).`;n.transaction.metadata.spanMetadata[n.spanId]={logMessage:o},G.log(o)}return n}setTag(e,n){return this.tags={...this.tags,[e]:n},this}setData(e,n){return this.data={...this.data,[e]:n},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e)),this.setData("http.response.status_code",e);const n=lH(e);return n!=="unknown_error"&&this.setStatus(n),this}setName(e){this.description=e}isSuccess(){return this.status==="ok"}finish(e){return this.end(e)}end(e){if(ye&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:n}=this.transaction.metadata.spanMetadata[this.spanId];n&&G.log(n.replace("Starting","Finishing"))}this.endTimestamp=typeof e=="number"?Ww(e):Za()}toTraceparent(){return jw(this.traceId,this.spanId,this.sampled)}toContext(){return os({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return os({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId,origin:this.origin})}toJSON(){return os({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId,origin:this.origin})}}function lH(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}function Mm(t,e,n){const r=e.getOptions(),{publicKey:i}=e.getDsn()||{},{segment:s}=n&&n.getUser()||{},o=os({environment:r.environment||Vw,release:r.release,user_segment:s,public_key:i,trace_id:t});return e.emit&&e.emit("createDsc",o),o}class BN extends Hw{constructor(e,n){super(e),delete this.description,this._measurements={},this._contexts={},this._hub=n||Nn(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;const r=this.metadata.dynamicSamplingContext;r&&(this._frozenDynamicSamplingContext={...r})}get name(){return this._name}set name(e){this.setName(e)}setName(e,n="custom"){this._name=e,this.metadata.source=n}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new UN(e)),this.spanRecorder.add(this)}setContext(e,n){n===null?delete this._contexts[e]:this._contexts[e]=n}setMeasurement(e,n,r=""){this._measurements[e]={value:n,unit:r}}setMetadata(e){this.metadata={...this.metadata,...e}}end(e){const n=typeof e=="number"?Ww(e):Za(),r=this._finishTransaction(n);if(r)return this._hub.captureEvent(r)}toContext(){const e=super.toContext();return os({...e,name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const e=this._hub||Nn(),n=e.getClient();if(!n)return{};const r=e.getScope(),i=Mm(this.traceId,n,r),s=this.metadata.sampleRate;s!==void 0&&(i.sample_rate=`${s}`);const o=this.metadata.source;return o&&o!=="url"&&(i.transaction=this.name),this.sampled!==void 0&&(i.sampled=String(this.sampled)),i}setHub(e){this._hub=e}_finishTransaction(e){if(this.endTimestamp!==void 0)return;this.name||(ye&&G.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.end(e);const n=this._hub.getClient();if(n&&n.emit&&n.emit("finishTransaction",this),this.sampled!==!0){ye&&G.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),n&&n.recordDroppedEvent("sample_rate","transaction");return}const r=this.spanRecorder?this.spanRecorder.spans.filter(a=>a!==this&&a.endTimestamp):[];this._trimEnd&&r.length>0&&(this.endTimestamp=r.reduce((a,c)=>a.endTimestamp&&c.endTimestamp?a.endTimestamp>c.endTimestamp?a:c:a).endTimestamp);const i=this.metadata,s={contexts:{...this._contexts,trace:this.getTraceContext()},spans:r,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...i,dynamicSamplingContext:this.getDynamicSamplingContext()},...i.source&&{transaction_info:{source:i.source}}};return Object.keys(this._measurements).length>0&&(ye&&G.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),s.measurements=this._measurements),ye&&G.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),s}}const Mh={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},uH="finishReason",wc=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class dH extends UN{constructor(e,n,r,i){super(i),this._pushActivity=e,this._popActivity=n,this.transactionSpanId=r}add(e){if(e.spanId!==this.transactionSpanId){const n=e.end;e.end=(...r)=>(this._popActivity(e.spanId),n.apply(e,r)),e.endTimestamp===void 0&&this._pushActivity(e.spanId)}super.add(e)}}class fH extends BN{constructor(e,n,r=Mh.idleTimeout,i=Mh.finalTimeout,s=Mh.heartbeatInterval,o=!1){super(e,n),this._idleHub=n,this._idleTimeout=r,this._finalTimeout=i,this._heartbeatInterval=s,this._onScope=o,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=wc[4],o&&(ye&&G.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),n.getScope().setSpan(this)),this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=wc[3],this.end())},this._finalTimeout)}end(e=Za()){const n=Ww(e);if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setTag(uH,this._finishReason),this.spanRecorder){ye&&G.log("[Tracing] finishing IdleTransaction",new Date(n*1e3).toISOString(),this.op);for(const r of this._beforeFinishCallbacks)r(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter(r=>{if(r.spanId===this.spanId)return!0;r.endTimestamp||(r.endTimestamp=n,r.setStatus("cancelled"),ye&&G.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(r,void 0,2)));const i=r.startTimestamp<n,s=(this._finalTimeout+this._idleTimeout)/1e3,o=r.endTimestamp-this.startTimestamp<s;if(ye){const a=JSON.stringify(r,void 0,2);i?o||G.log("[Tracing] discarding Span since it finished after Transaction final timeout",a):G.log("[Tracing] discarding Span since it happened after Transaction was finished",a)}return i&&o}),ye&&G.log("[Tracing] flushing IdleTransaction")}else ye&&G.log("[Tracing] No active IdleTransaction");if(this._onScope){const r=this._idleHub.getScope();r.getTransaction()===this&&r.setSpan(void 0)}return super.end(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const n=i=>{this._finished||this._pushActivity(i)},r=i=>{this._finished||this._popActivity(i)};this.spanRecorder=new dH(n,r,this.spanId,e),ye&&G.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:n}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=n===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=wc[5],this.end(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=wc[1],this.end(e))},this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),ye&&G.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,ye&&G.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(ye&&G.log(`[Tracing] popActivity ${e}`),delete this.activities[e],ye&&G.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){const n=Za();this._idleTimeoutCanceledPermanently?(this._finishReason=wc[5],this.end(n)):this._restartIdleTimeout(n+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(ye&&G.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=wc[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){ye&&G.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function jN(t,e,n,r,i,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c={...e,event_id:e.event_id||n.event_id||Pn(),timestamp:e.timestamp||Nm()},l=n.integrations||t.integrations.map(w=>w.name);hH(c,t),gH(c,l),e.type===void 0&&pH(c,t.stackParser);const u=yH(r,n.captureContext);n.mechanism&&Ad(c,n.mechanism);const d=i&&i.getEventProcessors?i.getEventProcessors():[],f=iH().getScopeData();if(s){const w=s.getScopeData();zT(f,w)}if(u){const w=u.getScopeData();zT(f,w)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),ON(c,f);const p=[...d,...zw(),...f.eventProcessors];return Rp(p,c,n).then(w=>(w&&mH(w),typeof o=="number"&&o>0?vH(w,o,a):w))}function hH(t,e){const{environment:n,release:r,dist:i,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?n:Vw),t.release===void 0&&r!==void 0&&(t.release=r),t.dist===void 0&&i!==void 0&&(t.dist=i),t.message&&(t.message=ul(t.message,s));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=ul(o.value,s));const a=t.request;a&&a.url&&(a.url=ul(a.url,s))}const qT=new WeakMap;function pH(t,e){const n=ze._sentryDebugIds;if(!n)return;let r;const i=qT.get(e);i?r=i:(r=new Map,qT.set(e,r));const s=Object.keys(n).reduce((o,a)=>{let c;const l=r.get(a);l?c=l:(c=e(a),r.set(a,c));for(let u=c.length-1;u>=0;u--){const d=c[u];if(d.filename){o[d.filename]=n[a];break}}return o},{});try{t.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=s[a.filename])})})}catch{}}function mH(t){const e={};try{t.exception.values.forEach(r=>{r.stacktrace.frames.forEach(i=>{i.debug_id&&(i.abs_path?e[i.abs_path]=i.debug_id:i.filename&&(e[i.filename]=i.debug_id),delete i.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.keys(e).forEach(r=>{n.push({type:"sourcemap",code_file:r,debug_id:e[r]})})}function gH(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function vH(t,e,n){if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(i=>({...i,...i.data&&{data:Ai(i.data,e,n)}}))},...t.user&&{user:Ai(t.user,e,n)},...t.contexts&&{contexts:Ai(t.contexts,e,n)},...t.extra&&{extra:Ai(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=Ai(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(i=>(i.data&&(i.data=Ai(i.data,e,n)),i))),r}function yH(t,e){if(!e)return t;const n=t?t.clone():new ts;return n.update(e),n}function SH(t){if(t)return wH(t)?{captureContext:t}:EH(t)?{captureContext:t}:t}function wH(t){return t instanceof ts||typeof t=="function"}const bH=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function EH(t){return Object.keys(t).some(e=>bH.includes(e))}function Om(t,e){return Nn().captureException(t,SH(e))}function $N(t,e){return Nn().captureEvent(t,e)}function ca(t,e){Nn().addBreadcrumb(t,e)}function kH(t,e){Nn().setContext(t,e)}function VN(t){return Nn().withScope(t)}function Ct(){return Nn().getClient()}function pf(){return Nn().getScope()}function Gw(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=Ct(),n=t||e&&e.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function zN(t,e,n){if(!Gw(e))return t.sampled=!1,t;if(t.sampled!==void 0)return t.setMetadata({sampleRate:Number(t.sampled)}),t;let r;return typeof e.tracesSampler=="function"?(r=e.tracesSampler(n),t.setMetadata({sampleRate:Number(r)})):n.parentSampled!==void 0?r=n.parentSampled:typeof e.tracesSampleRate<"u"?(r=e.tracesSampleRate,t.setMetadata({sampleRate:Number(r)})):(r=1,t.setMetadata({sampleRate:r})),TH(r)?r?(t.sampled=Math.random()<r,t.sampled?(ye&&G.log(`[Tracing] starting ${t.op} transaction - ${t.name}`),t):(ye&&G.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),t)):(ye&&G.log(`[Tracing] Discarding transaction because ${typeof e.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),t.sampled=!1,t):(ye&&G.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1,t)}function TH(t){return uN(t)||!(typeof t=="number"||typeof t=="boolean")?(ye&&G.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(t)} of type ${JSON.stringify(typeof t)}.`),!1):t<0||t>1?(ye&&G.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${t}.`),!1):!0}function _H(){const e=this.getScope().getSpan();return e?{"sentry-trace":e.toTraceparent()}:{}}function CH(t,e){const n=this.getClient(),r=n&&n.getOptions()||{},i=r.instrumenter||"sentry",s=t.instrumenter||"sentry";i!==s&&(ye&&G.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${i}\` instrumenter.
The transaction will not be sampled. Please use the ${i} instrumentation to start transactions.`),t.sampled=!1);let o=new BN(t,this);return o=zN(o,r,{parentSampled:t.parentSampled,transactionContext:t,...e}),o.sampled&&o.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",o),o}function JT(t,e,n,r,i,s,o){const a=t.getClient(),c=a&&a.getOptions()||{};let l=new fH(e,t,n,r,o,i);return l=zN(l,c,{parentSampled:e.parentSampled,transactionContext:e,...s}),l.sampled&&l.initSpanRecorder(c._experiments&&c._experiments.maxSpans),a&&a.emit&&a.emit("startTransaction",l),l}function IH(){const t=ff();t.__SENTRY__&&(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction||(t.__SENTRY__.extensions.startTransaction=CH),t.__SENTRY__.extensions.traceHeaders||(t.__SENTRY__.extensions.traceHeaders=_H),cH())}function RH(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function PH(t,e,n,r){const i=$w(n),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!r&&e&&{dsn:iu(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return dc(s,[o])}function xH(t,e,n,r){const i=$w(n),s=t.type&&t.type!=="replay_event"?t.type:"event";RH(t,n&&n.sdk);const o=xN(t,i,r,e);return delete t.sdkProcessingMetadata,dc(o,[[{type:s},t]])}const NH="7";function WN(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function MH(t){return`${WN(t)}${t.projectId}/envelope/`}function OH(t,e){return Xz({sentry_key:t.publicKey,sentry_version:NH,...e&&{sentry_client:`${e.name}/${e.version}`}})}function AH(t,e={}){const n=typeof e=="string"?e:e.tunnel,r=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return n||`${MH(t)}?${OH(t,r)}`}function DH(t,e){const n=mN(t);if(!n)return"";const r=`${WN(n)}embed/error-page/`;let i=`dsn=${iu(n)}`;for(const s in e)if(s!=="dsn"&&s!=="onClose")if(s==="user"){const o=e.user;if(!o)continue;o.name&&(i+=`&name=${encodeURIComponent(o.name)}`),o.email&&(i+=`&email=${encodeURIComponent(o.email)}`)}else i+=`&${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`;return`${r}?${i}`}const KT=[];function LH(t){const e={};return t.forEach(n=>{const{name:r}=n,i=e[r];i&&!i.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.keys(e).map(n=>e[n])}function FH(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let r;Array.isArray(n)?r=[...e,...n]:typeof n=="function"?r=bN(n(e)):r=e;const i=LH(r),s=BH(i,o=>o.name==="Debug");if(s!==-1){const[o]=i.splice(s,1);i.push(o)}return i}function UH(t,e){const n={};return e.forEach(r=>{r&&HN(t,r,n)}),n}function HN(t,e,n){if(n[e.name]=e,KT.indexOf(e.name)===-1&&(e.setupOnce(JW,Nn),KT.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),t.on&&typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>r(i,s,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){const r=e.processEvent.bind(e),i=Object.assign((s,o)=>r(s,o,t),{id:e.name});t.addEventProcessor(i)}ye&&G.log(`Integration installed: ${e.name}`)}function BH(t,e){for(let n=0;n<t.length;n++)if(e(t[n])===!0)return n;return-1}function ga(t,e){return Object.assign(function(...r){return{setupOnce:()=>{},...e(...r)}},{id:t})}function jH(t){let e="";for(const n of t){const r=Object.entries(n.tags),i=r.length>0?`|#${r.map(([s,o])=>`${s}:${o}`).join(",")}`:"";e+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${i}|T${n.timestamp}
`}return e}function $H(t,e,n,r){const i={sent_at:new Date().toISOString()};n&&n.sdk&&(i.sdk={name:n.sdk.name,version:n.sdk.version}),r&&e&&(i.dsn=iu(e));const s=VH(t);return dc(i,[s])}function VH(t){const e=jH(t);return[{type:"statsd",length:e.length},e]}const YT="Not capturing exception because it's already been captured.";class zH{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=mN(e.dsn):ye&&G.warn("No DSN provided, client will not send events."),this._dsn){const n=AH(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){if(AT(e)){ye&&G.log(YT);return}let i=n&&n.event_id;return this._process(this.eventFromException(e,n).then(s=>this._captureEvent(s,n,r)).then(s=>{i=s})),i}captureMessage(e,n,r,i){let s=r&&r.event_id;const o=Aw(e)?this.eventFromMessage(String(e),n,r):this.eventFromException(e,r);return this._process(o.then(a=>this._captureEvent(a,r,i)).then(a=>{s=a})),s}captureEvent(e,n,r){if(n&&n.originalException&&AT(n.originalException)){ye&&G.log(YT);return}let i=n&&n.event_id;return this._process(this._captureEvent(e,n,r).then(s=>{i=s})),i}captureSession(e){typeof e.release!="string"?ye&&G.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Dl(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(i=>r&&i))):Al(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&(this._integrations=UH(this,this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return ye&&G.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){HN(this,e,this._integrations)}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=xH(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=BW(r,VW(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(r);i&&i.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=PH(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const i=`${e}:${n}`;ye&&G.log(`Adding outcome: "${i}"`),this._outcomes[i]=this._outcomes[i]+1||1}}captureAggregateMetrics(e){ye&&G.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const n=$H(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}emit(e,...n){this._hooks[e]&&this._hooks[e].forEach(r=>r(...n))}_updateSessionFromEvent(e,n){let r=!1,i=!1;const s=n.exception&&n.exception.values;if(s){i=!0;for(const c of s){const l=c.mechanism;if(l&&l.handled===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(Dl(e,{...r&&{status:"crashed"},errors:e.errors||Number(i||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new yr(n=>{let r=0;const i=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(r+=i,e&&r>=e&&(clearInterval(s),n(!1)))},i)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,i=LN()){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),jN(s,e,n,r,this,i).then(a=>{if(a===null)return a;const{propagationContext:c}=a.sdkProcessingMetadata||{};if(!(a.contexts&&a.contexts.trace)&&c){const{traceId:u,spanId:d,parentSpanId:f,dsc:h}=c;a.contexts={trace:{trace_id:u,span_id:d,parent_span_id:f},...a.contexts};const p=h||Mm(u,this,r);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(i=>i.event_id,i=>{if(ye){const s=i;s.logLevel==="log"?G.log(s.message):G.warn(s)}})}_processEvent(e,n,r){const i=this.getOptions(),{sampleRate:s}=i,o=qN(e),a=GN(e),c=e.type||"error",l=`before send for type \`${c}\``;if(a&&typeof s=="number"&&Math.random()>s)return this.recordDroppedEvent("sample_rate","error",e),Bw(new Fi(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const u=c==="replay_event"?"replay":c;return this._prepareEvent(e,n,r).then(d=>{if(d===null)throw this.recordDroppedEvent("event_processor",u,e),new Fi("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return d;const h=HH(i,d,n);return WH(h,l)}).then(d=>{if(d===null)throw this.recordDroppedEvent("before_send",u,e),new Fi(`${l} returned \`null\`, will not send event.`,"log");const f=r&&r.getSession();!o&&f&&this._updateSessionFromEvent(f,d);const h=d.transaction_info;if(o&&h&&d.transaction!==e.transaction){const p="custom";d.transaction_info={...h,source:p}}return this.sendEvent(d,n),d}).then(null,d=>{throw d instanceof Fi?d:(this.captureException(d,{data:{__sentry__:!0},originalException:d}),new Fi(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${d}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,n=>{ye&&G.error("Error while sending event:",n)});ye&&G.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map(n=>{const[r,i]=n.split(":");return{reason:r,category:i,quantity:e[n]}})}}function WH(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Dw(t))return t.then(r=>{if(!Ol(r)&&r!==null)throw new Fi(n);return r},r=>{throw new Fi(`${e} rejected with ${r}`)});if(!Ol(t)&&t!==null)throw new Fi(n);return t}function HH(t,e,n){const{beforeSend:r,beforeSendTransaction:i}=t;return GN(e)&&r?r(e,n):qN(e)&&i?i(e,n):e}function GN(t){return t.type===void 0}function qN(t){return t.type==="transaction"}function GH(t){const e=Ct();!e||!e.addEventProcessor||e.addEventProcessor(t)}function qH(t,e){e.debug===!0&&(ye?G.enable():Qa(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}));const n=Nn();n.getScope().update(e.initialScope);const i=new t(e);n.bindClient(i)}const JH=30;function JN(t,e,n=IW(t.bufferSize||JH)){let r={};const i=o=>n.drain(o);function s(o){const a=[];if($T(o,(d,f)=>{const h=VT(f);if(NN(r,h)){const p=XT(d,f);t.recordDroppedEvent("ratelimit_backoff",h,p)}else a.push(d)}),a.length===0)return Al();const c=dc(o[0],a),l=d=>{$T(c,(f,h)=>{const p=XT(f,h);t.recordDroppedEvent(d,VT(h),p)})},u=()=>e({body:jW(c,t.textEncoder)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&ye&&G.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=MN(r,d),d),d=>{throw l("network_error"),d});return n.add(u).then(d=>d,d=>{if(d instanceof Fi)return ye&&G.error("Skipped sending event because buffer is full."),l("queue_overflow"),Al();throw d})}return s.__sentry__baseTransport__=!0,{send:s,flush:i}}function XT(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}let QT;const KN="FunctionToString",KH=()=>({name:KN,setupOnce(){QT=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=Lw(this)||this;return QT.apply(e,t)}}catch{}}}),YH=ga(KN,KH),XH=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],QH=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],YN="InboundFilters",ZH=t=>({name:YN,processEvent(e,n,r){const i=r.getOptions(),s=t9(t,i);return n9(e,s)?null:e}}),e9=ga(YN,ZH);function t9(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:XH],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:QH],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function n9(t,e){return e.ignoreInternal&&c9(t)?(ye&&G.warn(`Event dropped due to being internal Sentry Error.
Event: ${No(t)}`),!0):r9(t,e.ignoreErrors)?(ye&&G.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${No(t)}`),!0):i9(t,e.ignoreTransactions)?(ye&&G.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${No(t)}`),!0):s9(t,e.denyUrls)?(ye&&G.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${No(t)}.
Url: ${Pp(t)}`),!0):o9(t,e.allowUrls)?!1:(ye&&G.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${No(t)}.
Url: ${Pp(t)}`),!0)}function r9(t,e){return t.type||!e||!e.length?!1:a9(t).some(n=>nu(n,e))}function i9(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?nu(n,e):!1}function s9(t,e){if(!e||!e.length)return!1;const n=Pp(t);return n?nu(n,e):!1}function o9(t,e){if(!e||!e.length)return!0;const n=Pp(t);return n?nu(n,e):!0}function a9(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),ye&&e.length===0&&G.error(`Could not extract message for event ${No(t)}`),e}function c9(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function l9(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Pp(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?l9(e):null}catch{return ye&&G.error(`Cannot extract url for event ${No(t)}`),null}}function u9(t,e){const n=e&&h9(e)?e.getClient():e,r=n&&n.getDsn(),i=n&&n.getOptions().tunnel;return f9(t,r)||d9(t,i)}function d9(t,e){return e?ZT(t)===ZT(e):!1}function f9(t,e){return e?t.includes(e.host):!1}function ZT(t){return t[t.length-1]==="/"?t.slice(0,-1):t}function h9(t){return t.getClient!==void 0}const je=ze;let O0=0;function XN(){return O0>0}function p9(){O0++,setTimeout(()=>{O0--})}function Ll(t,e={},n){if(typeof t!="function")return t;try{const i=t.__sentry_wrapped__;if(i)return i;if(Lw(t))return t}catch{return t}const r=function(){const i=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=i.map(o=>Ll(o,e));return t.apply(this,s)}catch(s){throw p9(),VN(o=>{o.addEventProcessor(a=>(e.mechanism&&(w0(a,void 0,void 0),Ad(a,e.mechanism)),a.extra={...a.extra,arguments:i},a)),Om(s)}),s}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}catch{}gN(r,t),Od(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}const Ur=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function QN(t,e){const n=qw(t,e),r={type:e&&e.name,value:y9(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function m9(t,e,n,r){const i=Ct(),s=i&&i.getOptions().normalizeDepth,o={exception:{values:[{type:Rm(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:b9(e,{isUnhandledRejection:r})}]},extra:{__serialized__:IN(e,s)}};if(n){const a=qw(t,n);a.length&&(o.exception.values[0].stacktrace={frames:a})}return o}function ov(t,e){return{exception:{values:[QN(t,e)]}}}function qw(t,e){const n=e.stacktrace||e.stack||"",r=v9(e);try{return t(n,r)}catch{}return[]}const g9=/Minified React error #\d+;/i;function v9(t){if(t){if(typeof t.framesToPop=="number")return t.framesToPop;if(g9.test(t.message))return 1}return 0}function y9(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function S9(t,e,n,r){const i=n&&n.syntheticException||void 0,s=Jw(t,e,i,r);return Ad(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),Al(s)}function w9(t,e,n="info",r,i){const s=r&&r.syntheticException||void 0,o=A0(t,e,s,i);return o.level=n,r&&r.event_id&&(o.event_id=r.event_id),Al(o)}function Jw(t,e,n,r,i){let s;if(Ow(e)&&e.error)return ov(t,e.error);if(_T(e)||Az(e)){const o=e;if("stack"in e)s=ov(t,e);else{const a=o.name||(_T(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;s=A0(t,c,n,r),w0(s,c)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return Mw(e)?ov(t,e):Ol(e)||Rm(e)?(s=m9(t,e,n,i),Ad(s,{synthetic:!0}),s):(s=A0(t,e,n,r),w0(s,`${e}`,void 0),Ad(s,{synthetic:!0}),s)}function A0(t,e,n,r){const i={message:e};if(r&&n){const s=qw(t,n);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]})}return i}function b9(t,{isUnhandledRejection:e}){const n=Qz(t),r=e?"promise rejection":"exception";return Ow(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Rm(t)?`Event \`${E9(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function E9(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function k9(t,{metadata:e,tunnel:n,dsn:r}){const i={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!r&&{dsn:iu(r)}},s=T9(t);return dc(i,[s])}function T9(t){return[{type:"user_report"},t]}class _9 extends zH{constructor(e){const n=je.SENTRY_SDK_SOURCE||SW();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${n}:@sentry/browser`,version:Dd}],version:Dd},super(e),e.sendClientReports&&je.document&&je.document.addEventListener("visibilitychange",()=>{je.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return S9(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return w9(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){Ur&&G.warn("SDK not enabled, will not capture user feedback.");return}const n=k9(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}_flushOutcomes(){const e=this._clearOutcomes();if(e.length===0){Ur&&G.log("No outcomes to send");return}if(!this._dsn){Ur&&G.log("No dsn provided, will not send outcomes");return}Ur&&G.log("Sending outcomes:",e);const n=WW(e,this._options.tunnel&&iu(this._dsn));this._sendEnvelope(n)}}let Lu;function C9(){if(Lu)return Lu;if(T0(je.fetch))return Lu=je.fetch.bind(je);const t=je.document;let e=je.fetch;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(e=r.fetch),t.head.removeChild(n)}catch(n){Ur&&G.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return Lu=e.bind(je)}function I9(){Lu=void 0}function R9(t,e=C9()){let n=0,r=0;function i(s){const o=s.body.length;n+=o,r++;const a={body:s.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};try{return e(t.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return I9(),n-=o,r--,Bw(c)}}return JN(t,i)}const P9=4;function x9(t){function e(n){return new yr((r,i)=>{const s=new XMLHttpRequest;s.onerror=i,s.onreadystatechange=()=>{s.readyState===P9&&r({statusCode:s.status,headers:{"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")}})},s.open("POST",t.url);for(const o in t.headers)Object.prototype.hasOwnProperty.call(t.headers,o)&&s.setRequestHeader(o,t.headers[o]);s.send(n.body)})}return JN(t,e)}const Am="?",N9=30,M9=40,O9=50;function Kw(t,e,n,r){const i={filename:t,function:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const A9=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,D9=/\((\S*)(?::(\d+))(?::(\d+))\)/,L9=t=>{const e=A9.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){const s=D9.exec(e[2]);s&&(e[2]=s[1],e[3]=s[2],e[4]=s[3])}const[r,i]=ZN(e[1]||Am,e[2]);return Kw(i,r,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}},F9=[N9,L9],U9=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,B9=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,j9=t=>{const e=U9.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=B9.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let r=e[3],i=e[1]||Am;return[i,r]=ZN(i,r),Kw(r,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},$9=[O9,j9],V9=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,z9=t=>{const e=V9.exec(t);return e?Kw(e[2],e[1]||Am,+e[3],e[4]?+e[4]:void 0):void 0},W9=[M9,z9],H9=[F9,$9,W9],G9=SN(...H9),ZN=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Am,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},eM="GlobalHandlers",q9=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:eM,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(K9(n),e_("onerror")),e.onunhandledrejection&&(Y9(n),e_("onunhandledrejection"))}}},J9=ga(eM,q9);function K9(t){TN(e=>{const{stackParser:n,attachStacktrace:r}=nM();if(Ct()!==t||XN())return;const{msg:i,url:s,line:o,column:a,error:c}=e,l=c===void 0&&ss(i)?Z9(i,s,o,a):tM(Jw(n,c||i,void 0,r,!1),s,o,a);l.level="error",$N(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function Y9(t){_N(e=>{const{stackParser:n,attachStacktrace:r}=nM();if(Ct()!==t||XN())return;const i=X9(e),s=Aw(i)?Q9(i):Jw(n,i,void 0,r,!0);s.level="error",$N(s,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function X9(t){if(Aw(t))return t;const e=t;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return t}function Q9(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function Z9(t,e,n,r){const i=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=Ow(t)?t.message:t,o="Error";const a=s.match(i);return a&&(o=a[1],s=a[2]),tM({exception:{values:[{type:o,value:s}]}},e,n,r)}function tM(t,e,n,r){const i=t.exception=t.exception||{},s=i.values=i.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,u=isNaN(parseInt(n,10))?void 0:n,d=ss(e)&&e.length>0?e:zz();return c.length===0&&c.push({colno:l,filename:d,function:"?",in_app:!0,lineno:u}),t}function e_(t){Ur&&G.log(`Global Handler attached: ${t}`)}function nM(){const t=Ct();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const eG=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],rM="TryCatch",tG=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:rM,setupOnce(){e.setTimeout&&cn(je,"setTimeout",t_),e.setInterval&&cn(je,"setInterval",t_),e.requestAnimationFrame&&cn(je,"requestAnimationFrame",rG),e.XMLHttpRequest&&"XMLHttpRequest"in je&&cn(XMLHttpRequest.prototype,"send",iG);const n=e.eventTarget;n&&(Array.isArray(n)?n:eG).forEach(sG)}}},nG=ga(rM,tG);function t_(t){return function(...e){const n=e[0];return e[0]=Ll(n,{mechanism:{data:{function:io(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function rG(t){return function(e){return t.apply(this,[Ll(e,{mechanism:{data:{function:"requestAnimationFrame",handler:io(t)},handled:!1,type:"instrument"}})])}}function iG(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in n&&typeof n[i]=="function"&&cn(n,i,function(s){const o={mechanism:{data:{function:i,handler:io(s)},handled:!1,type:"instrument"}},a=Lw(s);return a&&(o.mechanism.data.handler=io(a)),Ll(s,o)})}),t.apply(this,e)}}function sG(t){const e=je,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(cn(n,"addEventListener",function(r){return function(i,s,o){try{typeof s.handleEvent=="function"&&(s.handleEvent=Ll(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:io(s),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,Ll(s,{mechanism:{data:{function:"addEventListener",handler:io(s),target:t},handled:!1,type:"instrument"}}),o])}}),cn(n,"removeEventListener",function(r){return function(i,s,o){const a=s;try{const c=a&&a.__sentry_wrapped__;c&&r.call(this,i,c,o)}catch{}return r.call(this,i,a,o)}}))}const Xf=1024,iM="Breadcrumbs",oG=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:iM,setup(n){e.console&&tW(uG(n)),e.dom&&EN(lG(n,e.dom)),e.xhr&&Uw(dG(n)),e.fetch&&Fw(fG(n)),e.history&&xm(hG(n)),e.sentry&&n.on&&n.on("beforeSendEvent",cG(n))}}},aG=ga(iM,oG);function cG(t){return function(n){Ct()===t&&ca({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:No(n)},{event:n})}}function lG(t,e){return function(r){if(Ct()!==t)return;let i,s,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>Xf&&(Ur&&G.warn(`\`dom.maxStringLength\` cannot exceed ${Xf}, but a value of ${a} was configured. Sentry will use ${Xf} instead.`),a=Xf),typeof o=="string"&&(o=[o]);try{const l=r.event,u=pG(l)?l.target:l;i=Xa(u,{keyAttrs:o,maxStringLength:a}),s=hN(u)}catch{i="<unknown>"}if(i.length===0)return;const c={category:`ui.${r.name}`,message:i};s&&(c.data={"ui.component_name":s}),ca(c,{event:r.event,name:r.name,global:r.global})}}function uG(t){return function(n){if(Ct()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:PW(n.level),message:CT(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${CT(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;ca(r,{input:n.args,level:n.level})}}function dG(t){return function(n){if(Ct()!==t)return;const{startTimestamp:r,endTimestamp:i}=n,s=n.xhr[$o];if(!r||!i||!s)return;const{method:o,url:a,status_code:c,body:l}=s,u={method:o,url:a,status_code:c},d={xhr:n.xhr,input:l,startTimestamp:r,endTimestamp:i};ca({category:"xhr",data:u,type:"http"},d)}}function fG(t){return function(n){if(Ct()!==t)return;const{startTimestamp:r,endTimestamp:i}=n;if(i&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const s=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:i};ca({category:"fetch",data:s,level:"error",type:"http"},o)}else{const s=n.response,o={...n.fetchData,status_code:s&&s.status},a={input:n.args,response:s,startTimestamp:r,endTimestamp:i};ca({category:"fetch",data:o,type:"http"},a)}}}function hG(t){return function(n){if(Ct()!==t)return;let r=n.from,i=n.to;const s=rv(je.location.href);let o=r?rv(r):void 0;const a=rv(i);(!o||!o.path)&&(o=s),s.protocol===a.protocol&&s.host===a.host&&(i=a.relative),s.protocol===o.protocol&&s.host===o.host&&(r=o.relative),ca({category:"navigation",data:{from:r,to:i}})}}function pG(t){return!!t&&!!t.target}const mG="cause",gG=5,sM="LinkedErrors",vG=(t={})=>{const e=t.limit||gG,n=t.key||mG;return{name:sM,preprocessEvent(r,i,s){const o=s.getOptions();Bz(QN,o.stackParser,o.maxValueLength,n,e,r,i)}}},yG=ga(sM,vG),oM="HttpContext",SG=()=>({name:oM,preprocessEvent(t){if(!je.navigator&&!je.location&&!je.document)return;const e=t.request&&t.request.url||je.location&&je.location.href,{referrer:n}=je.document||{},{userAgent:r}=je.navigator||{},i={...t.request&&t.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...t.request,...e&&{url:e},headers:i};t.request=s}}),wG=ga(oM,SG),aM="Dedupe",bG=()=>{let t;return{name:aM,processEvent(e){if(e.type)return e;try{if(kG(e,t))return Ur&&G.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},EG=ga(aM,bG);function kG(t,e){return e?!!(TG(t,e)||_G(t,e)):!1}function TG(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!lM(t,e)||!cM(t,e))}function _G(t,e){const n=n_(e),r=n_(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!lM(t,e)||!cM(t,e))}function cM(t,e){let n=r_(t),r=r_(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let i=0;i<r.length;i++){const s=r[i],o=n[i];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function lM(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function n_(t){return t.exception&&t.exception.values&&t.exception.values[0]}function r_(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch{return}}const CG=[new e9,new YH,new nG,new aG,new J9,new yG,new EG,new wG];function IG(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=CG),t.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(t.release=__SENTRY_RELEASE__),je.SENTRY_RELEASE&&je.SENTRY_RELEASE.id&&(t.release=je.SENTRY_RELEASE.id)),t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),t.sendClientReports===void 0&&(t.sendClientReports=!0);const e={...t,stackParser:Zz(t.stackParser||G9),integrations:FH(t),transport:t.transport||(kN()?R9:x9)};qH(_9,e),t.autoSessionTracking&&RG()}function i_(t={},e=Nn()){if(!je.document){Ur&&G.error("Global document not defined in showReportDialog call");return}const{client:n,scope:r}=e.getStackTop(),i=t.dsn||n&&n.getDsn();if(!i){Ur&&G.error("DSN not configured for showReportDialog call");return}r&&(t.user={...r.getUser(),...t.user}),t.eventId||(t.eventId=e.lastEventId());const s=je.document.createElement("script");s.async=!0,s.crossOrigin="anonymous",s.src=DH(i,t),t.onLoad&&(s.onload=t.onLoad);const{onClose:o}=t;if(o){const c=l=>{if(l.data==="__sentry_reportdialog_closed__")try{o()}finally{je.removeEventListener("message",c)}};je.addEventListener("message",c)}const a=je.document.head||je.document.body;a?a.appendChild(s):Ur&&G.error("Not injecting report dialog. No injection point found in HTML")}function s_(t){t.startSession({ignoreDuration:!0}),t.captureSession()}function RG(){if(typeof je.document>"u"){Ur&&G.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}const t=Nn();t.captureSession&&(s_(t),xm(({from:e,to:n})=>{e!==void 0&&e!==n&&s_(Nn())}))}const bt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,et=ze;function PG(){et&&et.document?et.document.addEventListener("visibilitychange",()=>{const t=hf();if(et.document.hidden&&t){const e="cancelled";bt&&G.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${t.op}`),t.status||t.setStatus(e),t.setTag("visibilitychange","document.hidden"),t.end()}}):bt&&G.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const Yw=(t,e,n)=>{let r,i;return s=>{e.value>=0&&(s||n)&&(i=e.value-(r||0),(i||r===void 0)&&(r=e.value,e.delta=i,t(e)))}},xG=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,NG=()=>{const t=et.performance.timing,e=et.performance.navigation.type,n={entryType:"navigation",startTime:0,type:e==2?"back_forward":e===1?"reload":"navigate"};for(const r in t)r!=="navigationStart"&&r!=="toJSON"&&(n[r]=Math.max(t[r]-t.navigationStart,0));return n},uM=()=>et.__WEB_VITALS_POLYFILL__?et.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||NG()):et.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],dM=()=>{const t=uM();return t&&t.activationStart||0},Xw=(t,e)=>{const n=uM();let r="navigate";return n&&(et.document.prerendering||dM()>0?r="prerender":r=n.type.replace(/_/g,"-")),{name:t,value:typeof e>"u"?-1:e,rating:"good",delta:0,entries:[],id:xG(),navigationType:r}},Dm=(t,e,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(i=>{e(i.getEntries())});return r.observe(Object.assign({type:t,buffered:!0},n||{})),r}}catch{}},Lm=(t,e)=>{const n=r=>{(r.type==="pagehide"||et.document.visibilityState==="hidden")&&(t(r),e&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},MG=t=>{const e=Xw("CLS",0);let n,r=0,i=[];const s=a=>{a.forEach(c=>{if(!c.hadRecentInput){const l=i[0],u=i[i.length-1];r&&i.length!==0&&c.startTime-u.startTime<1e3&&c.startTime-l.startTime<5e3?(r+=c.value,i.push(c)):(r=c.value,i=[c]),r>e.value&&(e.value=r,e.entries=i,n&&n())}})},o=Dm("layout-shift",s);if(o){n=Yw(t,e);const a=()=>{s(o.takeRecords()),n(!0)};return Lm(a),a}};let Oh=-1;const OG=()=>et.document.visibilityState==="hidden"&&!et.document.prerendering?0:1/0,AG=()=>{Lm(({timeStamp:t})=>{Oh=t},!0)},Qw=()=>(Oh<0&&(Oh=OG(),AG()),{get firstHiddenTime(){return Oh}}),DG=t=>{const e=Qw(),n=Xw("FID");let r;const i=a=>{a.startTime<e.firstHiddenTime&&(n.value=a.processingStart-a.startTime,n.entries.push(a),r(!0))},s=a=>{a.forEach(i)},o=Dm("first-input",s);r=Yw(t,n),o&&Lm(()=>{s(o.takeRecords()),o.disconnect()},!0)},o_={},LG=t=>{const e=Qw(),n=Xw("LCP");let r;const i=o=>{const a=o[o.length-1];if(a){const c=Math.max(a.startTime-dM(),0);c<e.firstHiddenTime&&(n.value=c,n.entries=[a],r())}},s=Dm("largest-contentful-paint",i);if(s){r=Yw(t,n);const o=()=>{o_[n.id]||(i(s.takeRecords()),s.disconnect(),o_[n.id]=!0,r(!0))};return["keydown","click"].forEach(a=>{addEventListener(a,o,{once:!0,capture:!0})}),Lm(o,!0),o}},Qu={},xp={};let fM,hM,pM;function FG(t){return Zw("cls",t,BG,fM)}function mM(t){return Zw("lcp",t,$G,pM)}function UG(t){return Zw("fid",t,jG,hM)}function Fm(t,e){return gM(t,e),xp[t]||(VG(t),xp[t]=!0),vM(t,e)}function Um(t,e){const n=Qu[t];if(!(!n||!n.length))for(const r of n)try{r(e)}catch(i){bt&&G.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${io(r)}
Error:`,i)}}function BG(){MG(t=>{Um("cls",{metric:t}),fM=t})}function jG(){DG(t=>{Um("fid",{metric:t}),hM=t})}function $G(){LG(t=>{Um("lcp",{metric:t}),pM=t})}function Zw(t,e,n,r){return gM(t,e),xp[t]||(n(),xp[t]=!0),r&&e({metric:r}),vM(t,e)}function VG(t){const e={};t==="event"&&(e.durationThreshold=0),Dm(t,n=>{Um(t,{entries:n})},e)}function gM(t,e){Qu[t]=Qu[t]||[],Qu[t].push(e)}function vM(t,e){return()=>{const n=Qu[t];if(!n)return;const r=n.indexOf(e);r!==-1&&n.splice(r,1)}}function av(t){return typeof t=="number"&&isFinite(t)}function Fl(t,{startTimestamp:e,...n}){return e&&t.startTimestamp>e&&(t.startTimestamp=e),t.startChild({startTimestamp:e,...n})}const zG=2147483647;function Gt(t){return t/1e3}function yM(){return et&&et.addEventListener&&et.performance}let a_=0,It={},xi,Zu;function WG(){const t=yM();if(t&&ki){t.mark&&et.performance.mark("sentry-tracing-init");const e=KG(),n=qG(),r=JG();return()=>{e(),n(),r()}}return()=>{}}function HG(){Fm("longtask",({entries:t})=>{for(const e of t){const n=hf();if(!n)return;const r=Gt(ki+e.startTime),i=Gt(e.duration);n.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i})}})}function GG(){Fm("event",({entries:t})=>{for(const e of t){const n=hf();if(!n)return;if(e.name==="click"){const r=Gt(ki+e.startTime),i=Gt(e.duration),s={description:Xa(e.target),op:`ui.interaction.${e.name}`,origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i},o=hN(e.target);o&&(s.data={"ui.component_name":o}),n.startChild(s)}}})}function qG(){return FG(({metric:t})=>{const e=t.entries.pop();e&&(bt&&G.log("[Measurements] Adding CLS"),It.cls={value:t.value,unit:""},Zu=e)})}function JG(){return mM(({metric:t})=>{const e=t.entries.pop();e&&(bt&&G.log("[Measurements] Adding LCP"),It.lcp={value:t.value,unit:"millisecond"},xi=e)})}function KG(){return UG(({metric:t})=>{const e=t.entries.pop();if(!e)return;const n=Gt(ki),r=Gt(e.startTime);bt&&G.log("[Measurements] Adding FID"),It.fid={value:t.value,unit:"millisecond"},It["mark.fid"]={value:n+r,unit:"second"}})}function YG(t){const e=yM();if(!e||!et.performance.getEntries||!ki)return;bt&&G.log("[Tracing] Adding & adjusting spans using Performance API");const n=Gt(ki),r=e.getEntries();let i,s;if(r.slice(a_).forEach(o=>{const a=Gt(o.startTime),c=Gt(o.duration);if(!(t.op==="navigation"&&n+a<t.startTimestamp))switch(o.entryType){case"navigation":{QG(t,o,n),i=n+Gt(o.responseStart),s=n+Gt(o.requestStart);break}case"mark":case"paint":case"measure":{XG(t,o,a,c,n);const l=Qw(),u=o.startTime<l.firstHiddenTime;o.name==="first-paint"&&u&&(bt&&G.log("[Measurements] Adding FP"),It.fp={value:o.startTime,unit:"millisecond"}),o.name==="first-contentful-paint"&&u&&(bt&&G.log("[Measurements] Adding FCP"),It.fcp={value:o.startTime,unit:"millisecond"});break}case"resource":{const l=o.name.replace(et.location.origin,"");eq(t,o,l,a,c,n);break}}}),a_=Math.max(r.length-1,0),tq(t),t.op==="pageload"){typeof i=="number"&&(bt&&G.log("[Measurements] Adding TTFB"),It.ttfb={value:(i-t.startTimestamp)*1e3,unit:"millisecond"},typeof s=="number"&&s<=i&&(It["ttfb.requestTime"]={value:(i-s)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(a=>{if(!It[a]||n>=t.startTimestamp)return;const c=It[a].value,l=n+Gt(c),u=Math.abs((l-t.startTimestamp)*1e3),d=u-c;bt&&G.log(`[Measurements] Normalized ${a} from ${c} to ${u} (${d})`),It[a].value=u});const o=It["mark.fid"];o&&It.fid&&(Fl(t,{description:"first input delay",endTimestamp:o.value+Gt(It.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:o.value}),delete It["mark.fid"]),"fcp"in It||delete It.cls,Object.keys(It).forEach(a=>{t.setMeasurement(a,It[a].value,It[a].unit)}),nq(t)}xi=void 0,Zu=void 0,It={}}function XG(t,e,n,r,i){const s=i+n,o=s+r;return Fl(t,{description:e.name,endTimestamp:o,op:e.entryType,origin:"auto.resource.browser.metrics",startTimestamp:s}),s}function QG(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{Qf(t,e,r,n)}),Qf(t,e,"secureConnection",n,"TLS/SSL","connectEnd"),Qf(t,e,"fetch",n,"cache","domainLookupStart"),Qf(t,e,"domainLookup",n,"DNS"),ZG(t,e,n)}function Qf(t,e,n,r,i,s){const o=s?e[s]:e[`${n}End`],a=e[`${n}Start`];!a||!o||Fl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:i||n,startTimestamp:r+Gt(a),endTimestamp:r+Gt(o)})}function ZG(t,e,n){Fl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+Gt(e.requestStart),endTimestamp:n+Gt(e.responseEnd)}),Fl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+Gt(e.responseStart),endTimestamp:n+Gt(e.responseEnd)})}function eq(t,e,n,r,i,s){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const o={};cv(o,e,"transferSize","http.response_transfer_size"),cv(o,e,"encodedBodySize","http.response_content_length"),cv(o,e,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in e&&(o["resource.render_blocking_status"]=e.renderBlockingStatus);const a=s+r,c=a+i;Fl(t,{description:n,endTimestamp:c,op:e.initiatorType?`resource.${e.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:a,data:o})}function tq(t){const e=et.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setTag("effectiveConnectionType",n.effectiveType),n.type&&t.setTag("connectionType",n.type),av(n.rtt)&&(It["connection.rtt"]={value:n.rtt,unit:"millisecond"})),av(e.deviceMemory)&&t.setTag("deviceMemory",`${e.deviceMemory} GB`),av(e.hardwareConcurrency)&&t.setTag("hardwareConcurrency",String(e.hardwareConcurrency))}function nq(t){xi&&(bt&&G.log("[Measurements] Adding LCP Data"),xi.element&&t.setTag("lcp.element",Xa(xi.element)),xi.id&&t.setTag("lcp.id",xi.id),xi.url&&t.setTag("lcp.url",xi.url.trim().slice(0,200)),t.setTag("lcp.size",xi.size)),Zu&&Zu.sources&&(bt&&G.log("[Measurements] Adding CLS Data"),Zu.sources.forEach((e,n)=>t.setTag(`cls.source.${n+1}`,Xa(e.node))))}function cv(t,e,n,r){const i=e[n];i!=null&&i<zG&&(t[r]=i)}function rq(t,e,n,r,i="auto.http.browser"){if(!Gw()||!t.fetchData)return;const s=e(t.fetchData.url);if(t.endTimestamp&&s){const f=t.fetchData.__span;if(!f)return;const h=r[f];if(h){if(t.response){h.setHttpStatus(t.response.status);const p=t.response&&t.response.headers&&t.response.headers.get("content-length");if(p){const m=parseInt(p);m>0&&h.setData("http.response_content_length",m)}}else t.error&&h.setStatus("internal_error");h.end(),delete r[f]}return}const o=pf(),a=Ct(),c=o.getSpan(),{method:l,url:u}=t.fetchData,d=s&&c?c.startChild({data:{url:u,type:"fetch","http.method":l},description:`${l} ${u}`,op:"http.client",origin:i}):void 0;if(d&&(t.fetchData.__span=d.spanId,r[d.spanId]=d),n(t.fetchData.url)&&a){const f=t.args[0];t.args[1]=t.args[1]||{};const h=t.args[1];h.headers=iq(f,a,o,h,d)}return d}function iq(t,e,n,r,i){const s=i||n.getSpan(),o=s&&s.transaction,{traceId:a,sampled:c,dsc:l}=n.getPropagationContext(),u=s?s.toTraceparent():jw(a,void 0,c),d=o?o.getDynamicSamplingContext():l||Mm(a,e,n),f=P0(d),h=typeof Request<"u"&&ro(t,Request)?t.headers:r.headers;if(h)if(typeof Headers<"u"&&ro(h,Headers)){const p=new Headers(h);return p.append("sentry-trace",u),f&&p.append(R0,f),p}else if(Array.isArray(h)){const p=[...h,["sentry-trace",u]];return f&&p.push([R0,f]),p}else{const p="baggage"in h?h.baggage:void 0,m=[];return Array.isArray(p)?m.push(...p):p&&m.push(p),f&&m.push(f),{...h,"sentry-trace":u,baggage:m.length>0?m.join(","):void 0}}else return{"sentry-trace":u,baggage:f}}const D0=["localhost",/^\/(?!\/)/],L0={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:D0,tracePropagationTargets:D0};function sq(t){const{traceFetch:e,traceXHR:n,tracePropagationTargets:r,tracingOrigins:i,shouldCreateSpanForRequest:s,enableHTTPTimings:o}={traceFetch:L0.traceFetch,traceXHR:L0.traceXHR,...t},a=typeof s=="function"?s:u=>!0,c=u=>lq(u,r||i),l={};e&&Fw(u=>{const d=rq(u,a,c,l);o&&d&&c_(d)}),n&&Uw(u=>{const d=uq(u,a,c,l);o&&d&&c_(d)})}function oq(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function c_(t){const e=t.data.url;if(!e)return;const n=Fm("resource",({entries:r})=>{r.forEach(i=>{oq(i)&&i.name.endsWith(e)&&(cq(i).forEach(o=>t.setData(...o)),setTimeout(n))})})}function aq(t){let e="unknown",n="unknown",r="";for(const i of t){if(i==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(i))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=i}return r===t&&(e=r),{name:e,version:n}}function Ri(t=0){return((ki||performance.timeOrigin)+t)/1e3}function cq(t){const{name:e,version:n}=aq(t.nextHopProtocol),r=[];return r.push(["network.protocol.version",n],["network.protocol.name",e]),ki?[...r,["http.request.redirect_start",Ri(t.redirectStart)],["http.request.fetch_start",Ri(t.fetchStart)],["http.request.domain_lookup_start",Ri(t.domainLookupStart)],["http.request.domain_lookup_end",Ri(t.domainLookupEnd)],["http.request.connect_start",Ri(t.connectStart)],["http.request.secure_connection_start",Ri(t.secureConnectionStart)],["http.request.connection_end",Ri(t.connectEnd)],["http.request.request_start",Ri(t.requestStart)],["http.request.response_start",Ri(t.responseStart)],["http.request.response_end",Ri(t.responseEnd)]]:r}function lq(t,e){return nu(t,e||D0)}function uq(t,e,n,r){const i=t.xhr,s=i&&i[$o];if(!Gw()||!i||i.__sentry_own_request__||!s)return;const o=e(s.url);if(t.endTimestamp&&o){const u=i.__sentry_xhr_span_id__;if(!u)return;const d=r[u];d&&s.status_code!==void 0&&(d.setHttpStatus(s.status_code),d.end(),delete r[u]);return}const a=pf(),c=a.getSpan(),l=o&&c?c.startChild({data:{type:"xhr","http.method":s.method,url:s.url},description:`${s.method} ${s.url}`,op:"http.client",origin:"auto.http.browser"}):void 0;if(l&&(i.__sentry_xhr_span_id__=l.spanId,r[i.__sentry_xhr_span_id__]=l),i.setRequestHeader&&n(s.url))if(l){const u=l&&l.transaction,d=u&&u.getDynamicSamplingContext(),f=P0(d);l_(i,l.toTraceparent(),f)}else{const u=Ct(),{traceId:d,sampled:f,dsc:h}=a.getPropagationContext(),p=jw(d,void 0,f),m=h||(u?Mm(d,u,a):void 0),w=P0(m);l_(i,p,w)}return l}function l_(t,e,n){try{t.setRequestHeader("sentry-trace",e),n&&t.setRequestHeader(R0,n)}catch{}}function dq(t,e=!0,n=!0){if(!et||!et.location){bt&&G.warn("Could not initialize routing instrumentation due to invalid location");return}let r=et.location.href,i;e&&(i=t({name:et.location.pathname,startTimestamp:ki?ki/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&xm(({to:s,from:o})=>{if(o===void 0&&r&&r.indexOf(s)!==-1){r=void 0;return}o!==s&&(r=void 0,i&&(bt&&G.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.end()),i=t({name:et.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})}const fq="BrowserTracing",hq={...Mh,markBackgroundTransactions:!0,routingInstrumentation:dq,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...L0};class pq{constructor(e){this.name=fq,this._hasSetTracePropagationTargets=!1,IH(),bt&&(this._hasSetTracePropagationTargets=!!(e&&(e.tracePropagationTargets||e.tracingOrigins))),this.options={...hq,...e},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=WG(),this.options.enableLongTask&&HG(),this.options._experiments.enableInteractions&&GG()}setupOnce(e,n){this._getCurrentHub=n;const i=n().getClient(),s=i&&i.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:a,startTransactionOnPageLoad:c,markBackgroundTransactions:l,traceFetch:u,traceXHR:d,shouldCreateSpanForRequest:f,enableHTTPTimings:h,_experiments:p}=this.options,m=s&&s.tracePropagationTargets,w=m||this.options.tracePropagationTargets;bt&&this._hasSetTracePropagationTargets&&m&&G.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o(g=>{const v=this._createRouteTransaction(g);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(v,g,n),v},c,a),l&&PG(),p.enableInteractions&&this._registerInteractionListener(),sq({traceFetch:u,traceXHR:d,tracePropagationTargets:w,shouldCreateSpanForRequest:f,enableHTTPTimings:h})}_createRouteTransaction(e){if(!this._getCurrentHub){bt&&G.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`);return}const n=this._getCurrentHub(),{beforeNavigate:r,idleTimeout:i,finalTimeout:s,heartbeatInterval:o}=this.options,a=e.op==="pageload",c=a?u_("sentry-trace"):"",l=a?u_("baggage"):"",{traceparentData:u,dynamicSamplingContext:d,propagationContext:f}=UW(c,l),h={...e,...u,metadata:{...e.metadata,dynamicSamplingContext:u&&!d?{}:d},trimEnd:!0},p=typeof r=="function"?r(h):h,m=p===void 0?{...h,sampled:!1}:p;m.metadata=m.name!==h.name?{...m.metadata,source:"custom"}:m.metadata,this._latestRouteName=m.name,this._latestRouteSource=m.metadata&&m.metadata.source,m.sampled===!1&&bt&&G.log(`[Tracing] Will not send ${m.op} transaction because of beforeNavigate.`),bt&&G.log(`[Tracing] Starting ${m.op} transaction on scope`);const{location:w}=et,g=JT(n,m,i,s,!0,{location:w},o),v=n.getScope();return a&&u?v.setPropagationContext(f):v.setPropagationContext({traceId:g.traceId,spanId:g.spanId,parentSpanId:g.parentSpanId,sampled:g.sampled}),g.registerBeforeFinishCallback(b=>{this._collectWebVitals(),YG(b)}),g}_registerInteractionListener(){let e;const n=()=>{const{idleTimeout:r,finalTimeout:i,heartbeatInterval:s}=this.options,o="ui.action.click",a=hf();if(a&&a.op&&["navigation","pageload"].includes(a.op)){bt&&G.warn(`[Tracing] Did not create ${o} transaction because a pageload or navigation transaction is in progress.`);return}if(e&&(e.setFinishReason("interactionInterrupted"),e.end(),e=void 0),!this._getCurrentHub){bt&&G.warn(`[Tracing] Did not create ${o} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){bt&&G.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`);return}const c=this._getCurrentHub(),{location:l}=et,u={name:this._latestRouteName,op:o,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=JT(c,u,r,i,!0,{location:l},s)};["click"].forEach(r=>{addEventListener(r,n,{once:!1,capture:!0})})}}function u_(t){const e=Wz(`meta[name=${t}]`);return e?e.getAttribute("content"):void 0}const ot=ze,eb="sentryReplaySession",mq="replay_event",tb="Unable to send Replay",gq=3e5,vq=9e5,yq=5e3,Sq=5500,wq=6e4,bq=5e3,Eq=3,d_=15e4,Zf=5e3,kq=3e3,Tq=300,nb=2e7,_q=4999,Cq=15e3,f_=36e5,h_={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}};var qt;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(qt||(qt={}));function Iq(t){return t.nodeType===t.ELEMENT_NODE}function ed(t){const e=t==null?void 0:t.host;return(e==null?void 0:e.shadowRoot)===t}function td(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function Rq(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t}function Pq(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return t.layerName===""?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}function Np(t){try{const e=t.rules||t.cssRules;return e?Rq(Array.from(e,SM).join("")):null}catch{return null}}function SM(t){let e;if(Nq(t))try{e=Np(t.styleSheet)||Pq(t)}catch{}else if(Mq(t)&&t.selectorText.includes(":"))return xq(t.cssText);return e||t.cssText}function xq(t){const e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}function Nq(t){return"styleSheet"in t}function Mq(t){return"selectorText"in t}class wM{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const r=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return r??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const r=n.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,n)}replace(e,n){const r=this.getNode(e);if(r){const i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Oq(){return new wM}function Bm({maskInputOptions:t,tagName:e,type:n}){return e==="OPTION"&&(e="SELECT"),!!(t[e.toLowerCase()]||n&&t[n]||n==="password"||e==="INPUT"&&!n&&t.text)}function Ld({isMasked:t,element:e,value:n,maskInputFn:r}){let i=n||"";return t?(r&&(i=r(i,e)),"*".repeat(i.length)):i}function Ul(t){return t.toLowerCase()}function F0(t){return t.toUpperCase()}const p_="__rrweb_original__";function Aq(t){const e=t.getContext("2d");if(!e)return!0;const n=50;for(let r=0;r<t.width;r+=n)for(let i=0;i<t.height;i+=n){const s=e.getImageData,o=p_ in s?s[p_]:s;if(new Uint32Array(o.call(e,r,i,Math.min(n,t.width-r),Math.min(n,t.height-i)).data.buffer).some(c=>c!==0))return!1}return!0}function rb(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?Ul(e):null}function Mp(t,e,n){return e==="INPUT"&&(n==="radio"||n==="checkbox")?t.getAttribute("value")||"":t.value}let Dq=1;const Lq=new RegExp("[^a-z0-9-_:]"),Fd=-2;function ib(){return Dq++}function Fq(t){if(t instanceof HTMLFormElement)return"form";const e=Ul(t.tagName);return Lq.test(e)?"div":e}function Uq(t){let e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}let bc,m_;const Bq=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,jq=/^(?:[a-z+]+:)?\/\//i,$q=/^www\..*/i,Vq=/^(data:)([^,]*),(.*)/i;function Op(t,e){return(t||"").replace(Bq,(n,r,i,s,o,a)=>{const c=i||o||a,l=r||s||"";if(!c)return n;if(jq.test(c)||$q.test(c))return`url(${l}${c}${l})`;if(Vq.test(c))return`url(${l}${c}${l})`;if(c[0]==="/")return`url(${l}${Uq(e)+c}${l})`;const u=e.split("/"),d=c.split("/");u.pop();for(const f of d)f!=="."&&(f===".."?u.pop():u.push(f));return`url(${l}${u.join("/")}${l})`})}const zq=/^[^ \t\n\r\u000c]+/,Wq=/^[, \t\n\r\u000c]+/;function Hq(t,e){if(e.trim()==="")return e;let n=0;function r(s){let o;const a=s.exec(e.substring(n));return a?(o=a[0],n+=o.length,o):""}const i=[];for(;r(Wq),!(n>=e.length);){let s=r(zq);if(s.slice(-1)===",")s=Vc(t,s.substring(0,s.length-1)),i.push(s);else{let o="";s=Vc(t,s);let a=!1;for(;;){const c=e.charAt(n);if(c===""){i.push((s+o).trim());break}else if(a)c===")"&&(a=!1);else if(c===","){n+=1,i.push((s+o).trim());break}else c==="("&&(a=!0);o+=c,n+=1}}}return i.join(", ")}function Vc(t,e){if(!e||e.trim()==="")return e;const n=t.createElement("a");return n.href=e,n.href}function Gq(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}function sb(){const t=document.createElement("a");return t.href="",t.href}function bM(t,e,n,r,i,s){return r&&(n==="src"||n==="href"&&!(e==="use"&&r[0]==="#")||n==="xlink:href"&&r[0]!=="#"||n==="background"&&(e==="table"||e==="td"||e==="th")?Vc(t,r):n==="srcset"?Hq(t,r):n==="style"?Op(r,sb()):e==="object"&&n==="data"?Vc(t,r):typeof s=="function"?s(n,r,i):r)}function EM(t,e,n){return(t==="video"||t==="audio")&&e==="autoplay"}function qq(t,e,n,r){try{if(r&&t.matches(r))return!1;if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(let i=t.classList.length;i--;){const s=t.classList[i];if(e.test(s))return!0}if(n)return t.matches(n)}catch{}return!1}function Jq(t,e){for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!1}function Ra(t,e,n=1/0,r=0){return!t||t.nodeType!==t.ELEMENT_NODE||r>n?-1:e(t)?r:Ra(t.parentNode,e,n,r+1)}function zc(t,e){return n=>{const r=n;if(r===null)return!1;if(t){if(typeof t=="string"){if(r.matches(`.${t}`))return!0}else if(Jq(r,t))return!0}return!!(e&&r.matches(e))}}function Bl(t,e,n,r,i,s){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(o===null)return!1;let a=-1,c=-1;if(s){if(c=Ra(o,zc(r,i)),c<0)return!0;a=Ra(o,zc(e,n),c>=0?c:1/0)}else{if(a=Ra(o,zc(e,n)),a<0)return!1;c=Ra(o,zc(r,i),a>=0?a:1/0)}return a>=0?c>=0?a<=c:!0:c>=0?!1:!!s}catch{}return!!s}function Kq(t,e,n){const r=t.contentWindow;if(!r)return;let i=!1,s;try{s=r.document.readyState}catch{return}if(s!=="complete"){const a=setTimeout(()=>{i||(e(),i=!0)},n);t.addEventListener("load",()=>{clearTimeout(a),i=!0,e()});return}const o="about:blank";if(r.location.href!==o||t.src===o||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}function Yq(t,e,n){let r=!1,i;try{i=t.sheet}catch{return}if(i)return;const s=setTimeout(()=>{r||(e(),r=!0)},n);t.addEventListener("load",()=>{clearTimeout(s),r=!0,e()})}function Xq(t,e){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,inlineStylesheet:h,maskInputOptions:p={},maskTextFn:m,maskInputFn:w,dataURLOptions:g={},inlineImages:v,recordCanvas:b,keepIframeSrcFn:C,newlyAddedElement:T=!1}=e,k=Qq(n,r);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:qt.Document,childNodes:[],compatMode:t.compatMode}:{type:qt.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:qt.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:k};case t.ELEMENT_NODE:return eJ(t,{doc:n,blockClass:i,blockSelector:s,unblockSelector:o,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:p,maskInputFn:w,dataURLOptions:g,inlineImages:v,recordCanvas:b,keepIframeSrcFn:C,newlyAddedElement:T,rootId:k,maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f});case t.TEXT_NODE:return Zq(t,{maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,maskTextFn:m,maskInputOptions:p,maskInputFn:w,rootId:k});case t.CDATA_SECTION_NODE:return{type:qt.CDATA,textContent:"",rootId:k};case t.COMMENT_NODE:return{type:qt.Comment,textContent:t.textContent||"",rootId:k};default:return!1}}function Qq(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return n===1?void 0:n}function Zq(t,e){var n;const{maskAllText:r,maskTextClass:i,unmaskTextClass:s,maskTextSelector:o,unmaskTextSelector:a,maskTextFn:c,maskInputOptions:l,maskInputFn:u,rootId:d}=e,f=t.parentNode&&t.parentNode.tagName;let h=t.textContent;const p=f==="STYLE"?!0:void 0,m=f==="SCRIPT"?!0:void 0,w=f==="TEXTAREA"?!0:void 0;if(p&&h){try{t.nextSibling||t.previousSibling||!((n=t.parentNode.sheet)===null||n===void 0)&&n.cssRules&&(h=Np(t.parentNode.sheet))}catch(v){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${v}`,t)}h=Op(h,sb())}m&&(h="SCRIPT_PLACEHOLDER");const g=Bl(t,i,o,s,a,r);if(!p&&!m&&!w&&h&&g&&(h=c?c(h):h.replace(/[\S]/g,"*")),w&&h&&(l.textarea||g)&&(h=u?u(h,t.parentNode):h.replace(/[\S]/g,"*")),f==="OPTION"&&h){const v=Bm({type:null,tagName:f,maskInputOptions:l});h=Ld({isMasked:Bl(t,i,o,s,a,v),element:t,value:h,maskInputFn:u})}return{type:qt.Text,textContent:h||"",isStyle:p,rootId:d}}function eJ(t,e){const{doc:n,blockClass:r,blockSelector:i,unblockSelector:s,inlineStylesheet:o,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:m,maskAllText:w,maskTextClass:g,unmaskTextClass:v,maskTextSelector:b,unmaskTextSelector:C}=e,T=qq(t,r,i,s),k=Fq(t);let I={};const R=t.attributes.length;for(let M=0;M<R;M++){const L=t.attributes[M];EM(k,L.name,L.value)||(I[L.name]=bM(n,k,Ul(L.name),L.value,t,c))}if(k==="link"&&o){const M=Array.from(n.styleSheets).find(F=>F.href===t.href);let L=null;M&&(L=Np(M)),L&&(delete I.rel,delete I.href,I._cssText=Op(L,M.href))}if(k==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const M=Np(t.sheet);M&&(I._cssText=Op(M,sb()))}if(k==="input"||k==="textarea"||k==="select"||k==="option"){const M=t,L=rb(M),F=Mp(M,F0(k),L),W=M.checked;if(L!=="submit"&&L!=="button"&&F){const z=Bl(M,g,b,v,C,Bm({type:L,tagName:F0(k),maskInputOptions:a}));I.value=Ld({isMasked:z,element:M,value:F,maskInputFn:l})}W&&(I.checked=W)}if(k==="option"&&(t.selected&&!a.select?I.selected=!0:delete I.selected),k==="canvas"&&f){if(t.__context==="2d")Aq(t)||(I.rr_dataURL=t.toDataURL(u.type,u.quality));else if(!("__context"in t)){const M=t.toDataURL(u.type,u.quality),L=document.createElement("canvas");L.width=t.width,L.height=t.height;const F=L.toDataURL(u.type,u.quality);M!==F&&(I.rr_dataURL=M)}}if(k==="img"&&d){bc||(bc=n.createElement("canvas"),m_=bc.getContext("2d"));const M=t,L=M.crossOrigin;M.crossOrigin="anonymous";const F=()=>{M.removeEventListener("load",F);try{bc.width=M.naturalWidth,bc.height=M.naturalHeight,m_.drawImage(M,0,0),I.rr_dataURL=bc.toDataURL(u.type,u.quality)}catch(W){console.warn(`Cannot inline img src=${M.currentSrc}! Error: ${W}`)}L?I.crossOrigin=L:M.removeAttribute("crossorigin")};M.complete&&M.naturalWidth!==0?F():M.addEventListener("load",F)}if((k==="audio"||k==="video")&&(I.rr_mediaState=t.paused?"paused":"played",I.rr_mediaCurrentTime=t.currentTime),p||(t.scrollLeft&&(I.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(I.rr_scrollTop=t.scrollTop)),T){const{width:M,height:L}=t.getBoundingClientRect();I={class:I.class,rr_width:`${M}px`,rr_height:`${L}px`}}k==="iframe"&&!h(I.src)&&(t.contentDocument||(I.rr_src=I.src),delete I.src);let N;try{customElements.get(k)&&(N=!0)}catch{}return{type:qt.Element,tagName:k,attributes:I,childNodes:[],isSVG:Gq(t)||void 0,needBlock:T,rootId:m,isCustom:N}}function st(t){return t==null?"":t.toLowerCase()}function tJ(t,e){if(e.comment&&t.type===qt.Comment)return!0;if(t.type===qt.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(st(t.attributes.name).match(/^msapplication-tile(image|color)$/)||st(t.attributes.name)==="application-name"||st(t.attributes.rel)==="icon"||st(t.attributes.rel)==="apple-touch-icon"||st(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&st(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(st(t.attributes.property).match(/^(og|twitter|fb):/)||st(t.attributes.name).match(/^(og|twitter):/)||st(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(st(t.attributes.name)==="robots"||st(t.attributes.name)==="googlebot"||st(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(st(t.attributes.name)==="author"||st(t.attributes.name)==="generator"||st(t.attributes.name)==="framework"||st(t.attributes.name)==="publisher"||st(t.attributes.name)==="progid"||st(t.attributes.property).match(/^article:/)||st(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(st(t.attributes.name)==="google-site-verification"||st(t.attributes.name)==="yandex-verification"||st(t.attributes.name)==="csrf-token"||st(t.attributes.name)==="p:domain_verify"||st(t.attributes.name)==="verify-v1"||st(t.attributes.name)==="verification"||st(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Wc(t,e){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f=!1,inlineStylesheet:h=!0,maskInputOptions:p={},maskAttributeFn:m,maskTextFn:w,maskInputFn:g,slimDOMOptions:v,dataURLOptions:b={},inlineImages:C=!1,recordCanvas:T=!1,onSerialize:k,onIframeLoad:I,iframeLoadTimeout:R=5e3,onStylesheetLoad:N,stylesheetLoadTimeout:M=5e3,keepIframeSrcFn:L=()=>!1,newlyAddedElement:F=!1}=e;let{preserveWhiteSpace:W=!0}=e;const z=Xq(t,{doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:w,maskInputFn:g,dataURLOptions:b,inlineImages:C,recordCanvas:T,keepIframeSrcFn:L,newlyAddedElement:F});if(!z)return console.warn(t,"not serialized"),null;let Y;r.hasNode(t)?Y=r.getId(t):tJ(z,v)||!W&&z.type===qt.Text&&!z.isStyle&&!z.textContent.replace(/^\s+|\s+$/gm,"").length?Y=Fd:Y=ib();const K=Object.assign(z,{id:Y});if(r.add(t,K),Y===Fd)return null;k&&k(t);let re=!f;if(K.type===qt.Element){re=re&&!K.needBlock,delete K.needBlock;const H=t.shadowRoot;H&&td(H)&&(K.isShadowHost=!0)}if((K.type===qt.Document||K.type===qt.Element)&&re){v.headWhitespace&&K.type===qt.Element&&K.tagName==="head"&&(W=!1);const H={doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:w,maskInputFn:g,slimDOMOptions:v,dataURLOptions:b,inlineImages:C,recordCanvas:T,preserveWhiteSpace:W,onSerialize:k,onIframeLoad:I,iframeLoadTimeout:R,onStylesheetLoad:N,stylesheetLoadTimeout:M,keepIframeSrcFn:L};for(const ee of Array.from(t.childNodes)){const oe=Wc(ee,H);oe&&K.childNodes.push(oe)}if(Iq(t)&&t.shadowRoot)for(const ee of Array.from(t.shadowRoot.childNodes)){const oe=Wc(ee,H);oe&&(td(t.shadowRoot)&&(oe.isShadow=!0),K.childNodes.push(oe))}}return t.parentNode&&ed(t.parentNode)&&td(t.parentNode)&&(K.isShadow=!0),K.type===qt.Element&&K.tagName==="iframe"&&Kq(t,()=>{const H=t.contentDocument;if(H&&I){const ee=Wc(H,{doc:H,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:w,maskInputFn:g,slimDOMOptions:v,dataURLOptions:b,inlineImages:C,recordCanvas:T,preserveWhiteSpace:W,onSerialize:k,onIframeLoad:I,iframeLoadTimeout:R,onStylesheetLoad:N,stylesheetLoadTimeout:M,keepIframeSrcFn:L});ee&&I(t,ee)}},R),K.type===qt.Element&&K.tagName==="link"&&K.attributes.rel==="stylesheet"&&Yq(t,()=>{if(N){const H=Wc(t,{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:w,maskInputFn:g,slimDOMOptions:v,dataURLOptions:b,inlineImages:C,recordCanvas:T,preserveWhiteSpace:W,onSerialize:k,onIframeLoad:I,iframeLoadTimeout:R,onStylesheetLoad:N,stylesheetLoadTimeout:M,keepIframeSrcFn:L});H&&N(t,H)}},M),K}function nJ(t,e){const{mirror:n=new wM,blockClass:r="rr-block",blockSelector:i=null,unblockSelector:s=null,maskAllText:o=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:f=!1,recordCanvas:h=!1,maskAllInputs:p=!1,maskAttributeFn:m,maskTextFn:w,maskInputFn:g,slimDOM:v=!1,dataURLOptions:b,preserveWhiteSpace:C,onSerialize:T,onIframeLoad:k,iframeLoadTimeout:I,onStylesheetLoad:R,stylesheetLoadTimeout:N,keepIframeSrcFn:M=()=>!1}=e||{};return Wc(t,{doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,maskAllText:o,maskTextClass:a,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:p===!1?{}:p,maskAttributeFn:m,maskTextFn:w,maskInputFn:g,slimDOMOptions:v===!0||v==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:v==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:v===!1?{}:v,dataURLOptions:b,inlineImages:f,recordCanvas:h,preserveWhiteSpace:C,onSerialize:T,onIframeLoad:k,iframeLoadTimeout:I,onStylesheetLoad:R,stylesheetLoadTimeout:N,keepIframeSrcFn:M,newlyAddedElement:!1})}function zn(t,e,n=document){const r={capture:!0,passive:!0};return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)}const Tc=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let g_={map:{},getId(){return console.error(Tc),-1},getNode(){return console.error(Tc),null},removeNodeFromMap(){console.error(Tc)},has(){return console.error(Tc),!1},reset(){console.error(Tc)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(g_=new Proxy(g_,{get(t,e,n){return e==="map"&&console.error(Tc),Reflect.get(t,e,n)}}));function Ud(t,e,n={}){let r=null,i=0;return function(...s){const o=Date.now();!i&&n.leading===!1&&(i=o);const a=e-(o-i),c=this;a<=0||a>e?(r&&(clearTimeout(r),r=null),i=o,t.apply(c,s)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{i=n.leading===!1?0:Date.now(),r=null,t.apply(c,s)},a))}}function kM(t,e,n,r,i=window){const s=i.Object.getOwnPropertyDescriptor(t,e);return i.Object.defineProperty(t,e,r?n:{set(o){setTimeout(()=>{n.set.call(this,o)},0),s&&s.set&&s.set.call(this,o)}}),()=>kM(t,e,s||{},!0)}function ob(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],i=n(r);return typeof i=="function"&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=i,()=>{t[e]=r}}catch{return()=>{}}}let Ap=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Ap=()=>new Date().getTime());function TM(t){var e,n,r,i,s,o;const a=t.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:(a==null?void 0:a.documentElement.scrollLeft)||((n=(e=a==null?void 0:a.body)===null||e===void 0?void 0:e.parentElement)===null||n===void 0?void 0:n.scrollLeft)||((r=a==null?void 0:a.body)===null||r===void 0?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:(a==null?void 0:a.documentElement.scrollTop)||((s=(i=a==null?void 0:a.body)===null||i===void 0?void 0:i.parentElement)===null||s===void 0?void 0:s.scrollTop)||((o=a==null?void 0:a.body)===null||o===void 0?void 0:o.scrollTop)||0}}function _M(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function CM(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function ci(t,e,n,r,i){if(!t)return!1;const s=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(!s)return!1;const o=zc(e,n);if(!i){const l=r&&s.matches(r);return o(s)&&!l}const a=Ra(s,o);let c=-1;return a<0?!1:(r&&(c=Ra(s,zc(null,r))),a>-1&&c<0?!0:a<c)}function rJ(t,e){return e.getId(t)!==-1}function lv(t,e){return e.getId(t)===Fd}function IM(t,e){if(ed(t))return!1;const n=e.getId(t);return e.has(n)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?IM(t.parentNode,e):!0:!0}function U0(t){return!!t.changedTouches}function iJ(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let n=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function RM(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function PM(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function B0(t){return!!(t!=null&&t.shadowRoot)}class sJ{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var n;return(n=this.styleIDMap.get(e))!==null&&n!==void 0?n:-1}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function xM(t){var e,n;let r=null;return((n=(e=t.getRootNode)===null||e===void 0?void 0:e.call(t))===null||n===void 0?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(r=t.getRootNode().host),r}function oJ(t){let e=t,n;for(;n=xM(e);)e=n;return e}function aJ(t){const e=t.ownerDocument;if(!e)return!1;const n=oJ(t);return e.contains(n)}function NM(t){const e=t.ownerDocument;return e?e.contains(t)||aJ(t):!1}var Ne=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(Ne||{}),Me=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(Me||{}),Dn=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(Dn||{}),fs=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(fs||{});function v_(t){return"__ln"in t}class cJ{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<e;r++)n=(n==null?void 0:n.next)||null;return n}addNode(e){const n={value:e,previous:null,next:null};if(e.__ln=n,e.previousSibling&&v_(e.previousSibling)){const r=e.previousSibling.__ln.next;n.next=r,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(e.nextSibling&&v_(e.nextSibling)&&e.nextSibling.__ln.previous){const r=e.nextSibling.__ln.previous;n.previous=r,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(e){const n=e.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const y_=(t,e)=>`${t}@${e}`;class lJ{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],n=new Set,r=new cJ,i=c=>{let l=c,u=Fd;for(;u===Fd;)l=l&&l.nextSibling,u=l&&this.mirror.getId(l);return u},s=c=>{if(!c.parentNode||!NM(c))return;const l=ed(c.parentNode)?this.mirror.getId(xM(c)):this.mirror.getId(c.parentNode),u=i(c);if(l===-1||u===-1)return r.addNode(c);const d=Wc(c,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{RM(f,this.mirror)&&this.iframeManager.addIframe(f),PM(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),B0(c)&&this.shadowDomManager.addShadowRoot(c.shadowRoot,this.doc)},onIframeLoad:(f,h)=>{this.iframeManager.attachIframe(f,h),this.shadowDomManager.observeAttachShadow(f)},onStylesheetLoad:(f,h)=>{this.stylesheetManager.attachLinkElement(f,h)}});d&&(e.push({parentId:l,nextId:u,node:d}),n.add(d.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const c of this.movedSet)S_(this.removes,c,this.mirror)&&!this.movedSet.has(c.parentNode)||s(c);for(const c of this.addedSet)!w_(this.droppedSet,c)&&!S_(this.removes,c,this.mirror)||w_(this.movedSet,c)?s(c):this.droppedSet.add(c);let o=null;for(;r.length;){let c=null;if(o){const l=this.mirror.getId(o.value.parentNode),u=i(o.value);l!==-1&&u!==-1&&(c=o)}if(!c){let l=r.tail;for(;l;){const u=l;if(l=l.previous,u){const d=this.mirror.getId(u.value.parentNode);if(i(u.value)===-1)continue;if(d!==-1){c=u;break}else{const h=u.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const p=h.parentNode.host;if(this.mirror.getId(p)!==-1){c=u;break}}}}}}if(!c){for(;r.head;)r.removeNode(r.head.value);break}o=c.previous,r.removeNode(c.value),s(c.value)}const a={texts:this.texts.map(c=>({id:this.mirror.getId(c.node),value:c.value})).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),attributes:this.attributes.map(c=>{const{attributes:l}=c;if(typeof l.style=="string"){const u=JSON.stringify(c.styleDiff),d=JSON.stringify(c._unchangedStyles);u.length<l.style.length&&(u+d).split("var(").length===l.style.split("var(").length&&(l.style=c.styleDiff)}return{id:this.mirror.getId(c.node),attributes:l}}).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),removes:this.removes,adds:e};!a.texts.length&&!a.attributes.length&&!a.removes.length&&!a.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(a))},this.processMutation=e=>{if(lv(e.target,this.mirror))return;let n;try{n=document.implementation.createHTMLDocument()}catch{n=this.doc}switch(e.type){case"characterData":{const r=e.target.textContent;!ci(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&r!==e.oldValue&&this.texts.push({value:Bl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&r?this.maskTextFn?this.maskTextFn(r):r.replace(/[\S]/g,"*"):r,node:e.target});break}case"attributes":{const r=e.target;let i=e.attributeName,s=e.target.getAttribute(i);if(i==="value"){const a=rb(r),c=r.tagName;s=Mp(r,c,a);const l=Bm({maskInputOptions:this.maskInputOptions,tagName:c,type:a}),u=Bl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,l);s=Ld({isMasked:u,element:r,value:s,maskInputFn:this.maskInputFn})}if(ci(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||s===e.oldValue)return;let o=this.attributes.find(a=>a.node===e.target);if(r.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(s))if(!r.contentDocument)i="rr_src";else return;if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o)),i==="type"&&r.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!EM(r.tagName,i)&&(o.attributes[i]=bM(this.doc,Ul(r.tagName),Ul(i),s,r,this.maskAttributeFn),i==="style")){const a=n.createElement("span");e.oldValue&&a.setAttribute("style",e.oldValue);for(const c of Array.from(r.style)){const l=r.style.getPropertyValue(c),u=r.style.getPropertyPriority(c);l!==a.style.getPropertyValue(c)||u!==a.style.getPropertyPriority(c)?u===""?o.styleDiff[c]=l:o.styleDiff[c]=[l,u]:o._unchangedStyles[c]=[l,u]}for(const c of Array.from(a.style))r.style.getPropertyValue(c)===""&&(o.styleDiff[c]=!1)}break}case"childList":{if(ci(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach(r=>this.genAdds(r,e.target)),e.removedNodes.forEach(r=>{const i=this.mirror.getId(r),s=ed(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);ci(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||lv(r,this.mirror)||!rJ(r,this.mirror)||(this.addedSet.has(r)?(j0(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(e.target)&&i===-1||IM(e.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[y_(i,s)]?j0(this.movedSet,r):this.removes.push({parentId:s,id:i,isShadow:ed(e.target)&&td(e.target)?!0:void 0})),this.mapRemoves.push(r))});break}}},this.genAdds=(e,n)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(lv(e,this.mirror))return;this.movedSet.add(e);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[y_(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);ci(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach(r=>this.genAdds(r)),B0(e)&&e.shadowRoot.childNodes.forEach(r=>{this.processedNodeManager.add(r,this),this.genAdds(r,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=e[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function j0(t,e){t.delete(e),e.childNodes.forEach(n=>j0(t,n))}function S_(t,e,n){return t.length===0?!1:MM(t,e,n)}function MM(t,e,n){const{parentNode:r}=e;if(!r)return!1;const i=n.getId(r);return t.some(s=>s.id===i)?!0:MM(t,r,n)}function w_(t,e){return t.size===0?!1:OM(t,e)}function OM(t,e){const{parentNode:n}=e;return n?t.has(n)?!0:OM(t,n):!1}let nd;function uJ(t){nd=t}function dJ(){nd=void 0}const Be=t=>nd?(...n)=>{try{return t(...n)}catch(r){if(nd&&nd(r)===!0)return()=>{};throw r}}:t,Hc=[];function mf(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function AM(t,e){var n,r;const i=new lJ;Hc.push(i),i.init(t);let s=window.MutationObserver||window.__rrMutationObserver;const o=(r=(n=window==null?void 0:window.Zone)===null||n===void 0?void 0:n.__symbol__)===null||r===void 0?void 0:r.call(n,"MutationObserver");o&&window[o]&&(s=window[o]);const a=new s(Be(c=>{t.onMutation&&t.onMutation(c)===!1||i.processMutations.bind(i)(c)}));return a.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function fJ({mousemoveCb:t,sampling:e,doc:n,mirror:r}){if(e.mousemove===!1)return()=>{};const i=typeof e.mousemove=="number"?e.mousemove:50,s=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500;let o=[],a;const c=Ud(Be(d=>{const f=Date.now()-a;t(o.map(h=>(h.timeOffset-=f,h)),d),o=[],a=null}),s),l=Be(Ud(Be(d=>{const f=mf(d),{clientX:h,clientY:p}=U0(d)?d.changedTouches[0]:d;a||(a=Ap()),o.push({x:h,y:p,id:r.getId(f),timeOffset:Ap()-a}),c(typeof DragEvent<"u"&&d instanceof DragEvent?Me.Drag:d instanceof MouseEvent?Me.MouseMove:Me.TouchMove)}),i,{trailing:!1})),u=[zn("mousemove",l,n),zn("touchmove",l,n),zn("drag",l,n)];return Be(()=>{u.forEach(d=>d())})}function hJ({mouseInteractionCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){if(o.mouseInteraction===!1)return()=>{};const a=o.mouseInteraction===!0||o.mouseInteraction===void 0?{}:o.mouseInteraction,c=[];let l=null;const u=d=>f=>{const h=mf(f);if(ci(h,r,i,s,!0))return;let p=null,m=d;if("pointerType"in f){switch(f.pointerType){case"mouse":p=fs.Mouse;break;case"touch":p=fs.Touch;break;case"pen":p=fs.Pen;break}p===fs.Touch?Dn[d]===Dn.MouseDown?m="TouchStart":Dn[d]===Dn.MouseUp&&(m="TouchEnd"):fs.Pen}else U0(f)&&(p=fs.Touch);p!==null?(l=p,(m.startsWith("Touch")&&p===fs.Touch||m.startsWith("Mouse")&&p===fs.Mouse)&&(p=null)):Dn[d]===Dn.Click&&(p=l,l=null);const w=U0(f)?f.changedTouches[0]:f;if(!w)return;const g=n.getId(h),{clientX:v,clientY:b}=w;Be(t)(Object.assign({type:Dn[m],id:g,x:v,y:b},p!==null&&{pointerType:p}))};return Object.keys(Dn).filter(d=>Number.isNaN(Number(d))&&!d.endsWith("_Departed")&&a[d]!==!1).forEach(d=>{let f=Ul(d);const h=u(d);if(window.PointerEvent)switch(Dn[d]){case Dn.MouseDown:case Dn.MouseUp:f=f.replace("mouse","pointer");break;case Dn.TouchStart:case Dn.TouchEnd:return}c.push(zn(f,h,e))}),Be(()=>{c.forEach(d=>d())})}function DM({scrollCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){const a=Be(Ud(Be(c=>{const l=mf(c);if(!l||ci(l,r,i,s,!0))return;const u=n.getId(l);if(l===e&&e.defaultView){const d=TM(e.defaultView);t({id:u,x:d.left,y:d.top})}else t({id:u,x:l.scrollLeft,y:l.scrollTop})}),o.scroll||100));return zn("scroll",a,e)}function pJ({viewportResizeCb:t},{win:e}){let n=-1,r=-1;const i=Be(Ud(Be(()=>{const s=_M(),o=CM();(n!==s||r!==o)&&(t({width:Number(o),height:Number(s)}),n=s,r=o)}),200));return zn("resize",i,e)}const mJ=["INPUT","TEXTAREA","SELECT"],b_=new WeakMap;function gJ({inputCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,ignoreClass:o,ignoreSelector:a,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:f,unmaskTextClass:h,maskTextSelector:p,unmaskTextSelector:m}){function w(I){let R=mf(I);const N=I.isTrusted,M=R&&F0(R.tagName);if(M==="OPTION"&&(R=R.parentElement),!R||!M||mJ.indexOf(M)<0||ci(R,r,i,s,!0))return;const L=R;if(L.classList.contains(o)||a&&L.matches(a))return;const F=rb(R);let W=Mp(L,M,F),z=!1;const Y=Bm({maskInputOptions:c,tagName:M,type:F}),K=Bl(R,f,p,h,m,Y);(F==="radio"||F==="checkbox")&&(z=R.checked),W=Ld({isMasked:K,element:R,value:W,maskInputFn:l}),g(R,d?{text:W,isChecked:z,userTriggered:N}:{text:W,isChecked:z});const re=R.name;F==="radio"&&re&&z&&e.querySelectorAll(`input[type="radio"][name="${re}"]`).forEach(H=>{if(H!==R){const ee=Ld({isMasked:K,element:H,value:Mp(H,M,F),maskInputFn:l});g(H,d?{text:ee,isChecked:!z,userTriggered:!1}:{text:ee,isChecked:!z})}})}function g(I,R){const N=b_.get(I);if(!N||N.text!==R.text||N.isChecked!==R.isChecked){b_.set(I,R);const M=n.getId(I);Be(t)(Object.assign(Object.assign({},R),{id:M}))}}const b=(u.input==="last"?["change"]:["input","change"]).map(I=>zn(I,Be(w),e)),C=e.defaultView;if(!C)return()=>{b.forEach(I=>I())};const T=C.Object.getOwnPropertyDescriptor(C.HTMLInputElement.prototype,"value"),k=[[C.HTMLInputElement.prototype,"value"],[C.HTMLInputElement.prototype,"checked"],[C.HTMLSelectElement.prototype,"value"],[C.HTMLTextAreaElement.prototype,"value"],[C.HTMLSelectElement.prototype,"selectedIndex"],[C.HTMLOptionElement.prototype,"selected"]];return T&&T.set&&b.push(...k.map(I=>kM(I[0],I[1],{set(){Be(w)({target:this,isTrusted:!1})}},!1,C))),Be(()=>{b.forEach(I=>I())})}function Dp(t){const e=[];function n(r,i){if(eh("CSSGroupingRule")&&r.parentRule instanceof CSSGroupingRule||eh("CSSMediaRule")&&r.parentRule instanceof CSSMediaRule||eh("CSSSupportsRule")&&r.parentRule instanceof CSSSupportsRule||eh("CSSConditionRule")&&r.parentRule instanceof CSSConditionRule){const o=Array.from(r.parentRule.cssRules).indexOf(r);i.unshift(o)}else if(r.parentStyleSheet){const o=Array.from(r.parentStyleSheet.cssRules).indexOf(r);i.unshift(o)}return i}return n(t,e)}function Co(t,e,n){let r,i;return t?(t.ownerNode?r=e.getId(t.ownerNode):i=n.getId(t),{styleId:i,id:r}):{}}function vJ({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const i=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:Be((u,d,f)=>{const[h,p]=f,{id:m,styleId:w}=Co(d,e,n.styleMirror);return(m&&m!==-1||w&&w!==-1)&&t({id:m,styleId:w,adds:[{rule:h,index:p}]}),u.apply(d,f)})});const s=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:Be((u,d,f)=>{const[h]=f,{id:p,styleId:m}=Co(d,e,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,removes:[{index:h}]}),u.apply(d,f)})});let o;r.CSSStyleSheet.prototype.replace&&(o=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:Be((u,d,f)=>{const[h]=f,{id:p,styleId:m}=Co(d,e,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,replace:h}),u.apply(d,f)})}));let a;r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:Be((u,d,f)=>{const[h]=f,{id:p,styleId:m}=Co(d,e,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,replaceSync:h}),u.apply(d,f)})}));const c={};th("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(th("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),th("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),th("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach(([u,d])=>{l[u]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(l[u].insertRule,{apply:Be((f,h,p)=>{const[m,w]=p,{id:g,styleId:v}=Co(h.parentStyleSheet,e,n.styleMirror);return(g&&g!==-1||v&&v!==-1)&&t({id:g,styleId:v,adds:[{rule:m,index:[...Dp(h),w||0]}]}),f.apply(h,p)})}),d.prototype.deleteRule=new Proxy(l[u].deleteRule,{apply:Be((f,h,p)=>{const[m]=p,{id:w,styleId:g}=Co(h.parentStyleSheet,e,n.styleMirror);return(w&&w!==-1||g&&g!==-1)&&t({id:w,styleId:g,removes:[{index:[...Dp(h),m]}]}),f.apply(h,p)})})}),Be(()=>{r.CSSStyleSheet.prototype.insertRule=i,r.CSSStyleSheet.prototype.deleteRule=s,o&&(r.CSSStyleSheet.prototype.replace=o),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach(([u,d])=>{d.prototype.insertRule=l[u].insertRule,d.prototype.deleteRule=l[u].deleteRule})})}function LM({mirror:t,stylesheetManager:e},n){var r,i,s;let o=null;n.nodeName==="#document"?o=t.getId(n):o=t.getId(n.host);const a=n.nodeName==="#document"?(r=n.defaultView)===null||r===void 0?void 0:r.Document:(s=(i=n.ownerDocument)===null||i===void 0?void 0:i.defaultView)===null||s===void 0?void 0:s.ShadowRoot,c=a!=null&&a.prototype?Object.getOwnPropertyDescriptor(a==null?void 0:a.prototype,"adoptedStyleSheets"):void 0;return o===null||o===-1||!a||!c?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get(){var l;return(l=c.get)===null||l===void 0?void 0:l.call(this)},set(l){var u;const d=(u=c.set)===null||u===void 0?void 0:u.call(this,l);if(o!==null&&o!==-1)try{e.adoptStyleSheets(l,o)}catch{}return d}}),Be(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}))}function yJ({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){const s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:Be((a,c,l)=>{var u;const[d,f,h]=l;if(n.has(d))return s.apply(c,[d,f,h]);const{id:p,styleId:m}=Co((u=c.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,r.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,set:{property:d,value:f,priority:h},index:Dp(c.parentRule)}),a.apply(c,l)})});const o=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:Be((a,c,l)=>{var u;const[d]=l;if(n.has(d))return o.apply(c,[d]);const{id:f,styleId:h}=Co((u=c.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,r.styleMirror);return(f&&f!==-1||h&&h!==-1)&&t({id:f,styleId:h,remove:{property:d},index:Dp(c.parentRule)}),a.apply(c,l)})}),Be(()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=o})}function SJ({mediaInteractionCb:t,blockClass:e,blockSelector:n,unblockSelector:r,mirror:i,sampling:s,doc:o}){const a=Be(l=>Ud(Be(u=>{const d=mf(u);if(!d||ci(d,e,n,r,!0))return;const{currentTime:f,volume:h,muted:p,playbackRate:m}=d;t({type:l,id:i.getId(d),currentTime:f,volume:h,muted:p,playbackRate:m})}),s.media||500)),c=[zn("play",a(0),o),zn("pause",a(1),o),zn("seeked",a(2),o),zn("volumechange",a(3),o),zn("ratechange",a(4),o)];return Be(()=>{c.forEach(l=>l())})}function wJ({fontCb:t,doc:e}){const n=e.defaultView;if(!n)return()=>{};const r=[],i=new WeakMap,s=n.FontFace;n.FontFace=function(c,l,u){const d=new s(c,l,u);return i.set(d,{family:c,buffer:typeof l!="string",descriptors:u,fontSource:typeof l=="string"?l:JSON.stringify(Array.from(new Uint8Array(l)))}),d};const o=ob(e.fonts,"add",function(a){return function(c){return setTimeout(Be(()=>{const l=i.get(c);l&&(t(l),i.delete(c))}),0),a.apply(this,[c])}});return r.push(()=>{n.FontFace=s}),r.push(o),Be(()=>{r.forEach(a=>a())})}function bJ(t){const{doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,selectionCb:o}=t;let a=!0;const c=Be(()=>{const l=e.getSelection();if(!l||a&&(l!=null&&l.isCollapsed))return;a=l.isCollapsed||!1;const u=[],d=l.rangeCount||0;for(let f=0;f<d;f++){const h=l.getRangeAt(f),{startContainer:p,startOffset:m,endContainer:w,endOffset:g}=h;ci(p,r,i,s,!0)||ci(w,r,i,s,!0)||u.push({start:n.getId(p),startOffset:m,end:n.getId(w),endOffset:g})}o({ranges:u})});return c(),zn("selectionchange",c)}function EJ({doc:t,customElementCb:e}){const n=t.defaultView;return!n||!n.customElements?()=>{}:ob(n.customElements,"define",function(i){return function(s,o,a){try{e({define:{name:s}})}catch{}return i.apply(this,[s,o,a])}})}function kJ(t,e={}){const n=t.doc.defaultView;if(!n)return()=>{};const r=AM(t,t.doc),i=fJ(t),s=hJ(t),o=DM(t),a=pJ(t,{win:n}),c=gJ(t),l=SJ(t),u=vJ(t,{win:n}),d=LM(t,t.doc),f=yJ(t,{win:n}),h=t.collectFonts?wJ(t):()=>{},p=bJ(t),m=EJ(t),w=[];for(const g of t.plugins)w.push(g.observer(g.callback,n,g.options));return Be(()=>{Hc.forEach(g=>g.reset()),r.disconnect(),i(),s(),o(),a(),c(),l(),u(),d(),f(),h(),p(),m(),w.forEach(g=>g())})}function eh(t){return typeof window[t]<"u"}function th(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class $0{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,n,r,i){const s=r||this.getIdToRemoteIdMap(e),o=i||this.getRemoteIdToIdMap(e);let a=s.get(n);return a||(a=this.generateIdFn(),s.set(n,a),o.set(a,n)),a}getIds(e,n){const r=this.getIdToRemoteIdMap(e),i=this.getRemoteIdToIdMap(e);return n.map(s=>this.getId(e,s,r,i))}getRemoteId(e,n,r){const i=r||this.getRemoteIdToIdMap(e);if(typeof n!="number")return n;const s=i.get(n);return s||-1}getRemoteIds(e,n){const r=this.getRemoteIdToIdMap(e);return n.map(i=>this.getRemoteId(e,i,r))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let n=this.iframeIdToRemoteIdMap.get(e);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(e,n)),n}getRemoteIdToIdMap(e){let n=this.iframeRemoteIdToIdMap.get(e);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(e,n)),n}}class TJ{constructor(){this.crossOriginIframeMirror=new $0(ib),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class _J{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new $0(ib),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new $0(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,n){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(r=this.loadListener)===null||r===void 0||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const n=e;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!e.source)return;const i=this.crossOriginIframeMap.get(e.source);if(!i)return;const s=this.transformCrossOriginEvent(i,n.data.event);s&&this.wrappedEmit(s,n.data.isCheckout)}transformCrossOriginEvent(e,n){var r;switch(n.type){case Ne.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(n.data.node,e);const i=n.data.node.id;return this.crossOriginIframeRootIdMap.set(e,i),this.patchRootIdOnNode(n.data.node,i),{timestamp:n.timestamp,type:Ne.IncrementalSnapshot,data:{source:Me.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Ne.Meta:case Ne.Load:case Ne.DomContentLoaded:return!1;case Ne.Plugin:return n;case Ne.Custom:return this.replaceIds(n.data.payload,e,["id","parentId","previousId","nextId"]),n;case Ne.IncrementalSnapshot:switch(n.data.source){case Me.Mutation:return n.data.adds.forEach(i=>{this.replaceIds(i,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(i.node,e);const s=this.crossOriginIframeRootIdMap.get(e);s&&this.patchRootIdOnNode(i.node,s)}),n.data.removes.forEach(i=>{this.replaceIds(i,e,["parentId","id"])}),n.data.attributes.forEach(i=>{this.replaceIds(i,e,["id"])}),n.data.texts.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case Me.Drag:case Me.TouchMove:case Me.MouseMove:return n.data.positions.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case Me.ViewportResize:return!1;case Me.MediaInteraction:case Me.MouseInteraction:case Me.Scroll:case Me.CanvasMutation:case Me.Input:return this.replaceIds(n.data,e,["id"]),n;case Me.StyleSheetRule:case Me.StyleDeclaration:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleId"]),n;case Me.Font:return n;case Me.Selection:return n.data.ranges.forEach(i=>{this.replaceIds(i,e,["start","end"])}),n;case Me.AdoptedStyleSheet:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleIds"]),(r=n.data.styles)===null||r===void 0||r.forEach(i=>{this.replaceStyleIds(i,e,["styleId"])}),n}}return!1}replace(e,n,r,i){for(const s of i)!Array.isArray(n[s])&&typeof n[s]!="number"||(Array.isArray(n[s])?n[s]=e.getIds(r,n[s]):n[s]=e.getId(r,n[s]));return n}replaceIds(e,n,r){return this.replace(this.crossOriginIframeMirror,e,n,r)}replaceStyleIds(e,n,r){return this.replace(this.crossOriginIframeStyleMirror,e,n,r)}replaceIdOnNode(e,n){this.replaceIds(e,n,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(r=>{this.replaceIdOnNode(r,n)})}patchRootIdOnNode(e,n){e.type!==qt.Document&&!e.rootId&&(e.rootId=n),"childNodes"in e&&e.childNodes.forEach(r=>{this.patchRootIdOnNode(r,n)})}}class CJ{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class IJ{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,n){if(!td(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);const r=AM(Object.assign(Object.assign({},this.bypassOptions),{doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(DM(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(LM({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,n){const r=this;this.restoreHandlers.push(ob(e.prototype,"attachShadow",function(i){return function(s){const o=i.call(this,s);return this.shadowRoot&&NM(this)&&r.addShadowRoot(this.shadowRoot,n),o}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class RJ{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}}class PJ{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new sJ,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,n){if(e.length===0)return;const r={id:n,styleIds:[]},i=[];for(const s of e){let o;this.styleMirror.has(s)?o=this.styleMirror.getId(s):(o=this.styleMirror.add(s),i.push({styleId:o,rules:Array.from(s.rules||CSSRule,(a,c)=>({rule:SM(a),index:c}))})),r.styleIds.push(o)}i.length>0&&(r.styles=i),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class xJ{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,n){const r=this.nodeMap.get(e);return r&&Array.from(r).some(i=>i!==n)}add(e,n){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(n))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function Ft(t){const e=t;return e.timestamp=Ap(),e}let V0,Lp;const Jr=Oq();function Zo(t={}){const{emit:e,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:i="rr-block",blockSelector:s=null,unblockSelector:o=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:f=null,unmaskTextSelector:h=null,inlineStylesheet:p=!0,maskAllInputs:m,maskInputOptions:w,slimDOMOptions:g,maskAttributeFn:v,maskInputFn:b,maskTextFn:C,packFn:T,sampling:k={},dataURLOptions:I={},mousemoveWait:R,recordCanvas:N=!1,recordCrossOriginIframes:M=!1,recordAfter:L=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:F=!1,collectFonts:W=!1,inlineImages:z=!1,plugins:Y,keepIframeSrcFn:K=()=>!1,ignoreCSSAttributes:re=new Set([]),errorHandler:H,onMutation:ee,getCanvasManager:oe}=t;uJ(H);const q=M?window.parent===window:!0;let ie=!1;if(!q)try{window.parent.document&&(ie=!1)}catch{ie=!0}if(q&&!e)throw new Error("emit function is required");R!==void 0&&k.mousemove===void 0&&(k.mousemove=R),Jr.reset();const ke=m===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:w!==void 0?w:{},_e=g===!0||g==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:g==="all",headMetaDescKeywords:g==="all"}:g||{};iJ();let me,nt=0;const gt=Ce=>{for(const bn of Y||[])bn.eventProcessor&&(Ce=bn.eventProcessor(Ce));return T&&!ie&&(Ce=T(Ce)),Ce},ce=(Ce,bn)=>{var Fe;if(!((Fe=Hc[0])===null||Fe===void 0)&&Fe.isFrozen()&&Ce.type!==Ne.FullSnapshot&&!(Ce.type===Ne.IncrementalSnapshot&&Ce.data.source===Me.Mutation)&&Hc.forEach(We=>We.unfreeze()),q)e==null||e(gt(Ce),bn);else if(ie){const We={type:"rrweb",event:gt(Ce),origin:window.location.origin,isCheckout:bn};window.parent.postMessage(We,"*")}if(Ce.type===Ne.FullSnapshot)me=Ce,nt=0;else if(Ce.type===Ne.IncrementalSnapshot){if(Ce.data.source===Me.Mutation&&Ce.data.isAttachIframe)return;nt++;const We=r&&nt>=r,An=n&&Ce.timestamp-me.timestamp>n;(We||An)&&va(!0)}};V0=ce;const Qt=Ce=>{ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.Mutation},Ce)}))},Qn=Ce=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.Scroll},Ce)})),Mt=Ce=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.CanvasMutation},Ce)})),Zn=Ce=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.AdoptedStyleSheet},Ce)})),dn=new PJ({mutationCb:Qt,adoptedStyleSheetCb:Zn}),On=typeof __RRWEB_EXCLUDE_IFRAME__=="boolean"&&__RRWEB_EXCLUDE_IFRAME__?new TJ:new _J({mirror:Jr,mutationCb:Qt,stylesheetManager:dn,recordCrossOriginIframes:M,wrappedEmit:ce});for(const Ce of Y||[])Ce.getMirror&&Ce.getMirror({nodeMirror:Jr,crossOriginIframeMirror:On.crossOriginIframeMirror,crossOriginIframeStyleMirror:On.crossOriginIframeStyleMirror});const lr=new xJ,fc=OJ(oe,{recordCanvas:N,blockClass:i,blockSelector:s,unblockSelector:o,sampling:k.canvas,dataURLOptions:I}),_i=typeof __RRWEB_EXCLUDE_SHADOW_DOM__=="boolean"&&__RRWEB_EXCLUDE_SHADOW_DOM__?new CJ:new IJ({mutationCb:Qt,scrollCb:Qn,bypassOptions:{onMutation:ee,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskInputOptions:ke,dataURLOptions:I,maskAttributeFn:v,maskTextFn:C,maskInputFn:b,recordCanvas:N,inlineImages:z,sampling:k,slimDOMOptions:_e,iframeManager:On,stylesheetManager:dn,canvasManager:fc,keepIframeSrcFn:K,processedNodeManager:lr},mirror:Jr}),va=(Ce=!1)=>{ce(Ft({type:Ne.Meta,data:{href:window.location.href,width:CM(),height:_M()}}),Ce),dn.reset(),_i.init(),Hc.forEach(Fe=>Fe.lock());const bn=nJ(document,{mirror:Jr,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskAllInputs:ke,maskAttributeFn:v,maskInputFn:b,maskTextFn:C,slimDOM:_e,dataURLOptions:I,recordCanvas:N,inlineImages:z,onSerialize:Fe=>{RM(Fe,Jr)&&On.addIframe(Fe),PM(Fe,Jr)&&dn.trackLinkElement(Fe),B0(Fe)&&_i.addShadowRoot(Fe.shadowRoot,document)},onIframeLoad:(Fe,We)=>{On.attachIframe(Fe,We),_i.observeAttachShadow(Fe)},onStylesheetLoad:(Fe,We)=>{dn.attachLinkElement(Fe,We)},keepIframeSrcFn:K});if(!bn)return console.warn("Failed to snapshot the document");ce(Ft({type:Ne.FullSnapshot,data:{node:bn,initialOffset:TM(window)}})),Hc.forEach(Fe=>Fe.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&dn.adoptStyleSheets(document.adoptedStyleSheets,Jr.getId(document))};Lp=va;try{const Ce=[],bn=We=>{var An;return Be(kJ)({onMutation:ee,mutationCb:Qt,mousemoveCb:(Ae,Zt)=>ce(Ft({type:Ne.IncrementalSnapshot,data:{source:Zt,positions:Ae}})),mouseInteractionCb:Ae=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.MouseInteraction},Ae)})),scrollCb:Qn,viewportResizeCb:Ae=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.ViewportResize},Ae)})),inputCb:Ae=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.Input},Ae)})),mediaInteractionCb:Ae=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.MediaInteraction},Ae)})),styleSheetRuleCb:Ae=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.StyleSheetRule},Ae)})),styleDeclarationCb:Ae=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.StyleDeclaration},Ae)})),canvasMutationCb:Mt,fontCb:Ae=>ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.Font},Ae)})),selectionCb:Ae=>{ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.Selection},Ae)}))},customElementCb:Ae=>{ce(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.CustomElement},Ae)}))},blockClass:i,ignoreClass:a,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,maskInputOptions:ke,inlineStylesheet:p,sampling:k,recordCanvas:N,inlineImages:z,userTriggeredOnInput:F,collectFonts:W,doc:We,maskAttributeFn:v,maskInputFn:b,maskTextFn:C,keepIframeSrcFn:K,blockSelector:s,unblockSelector:o,slimDOMOptions:_e,dataURLOptions:I,mirror:Jr,iframeManager:On,stylesheetManager:dn,shadowDomManager:_i,processedNodeManager:lr,canvasManager:fc,ignoreCSSAttributes:re,plugins:((An=Y==null?void 0:Y.filter(Ae=>Ae.observer))===null||An===void 0?void 0:An.map(Ae=>({observer:Ae.observer,options:Ae.options,callback:Zt=>ce(Ft({type:Ne.Plugin,data:{plugin:Ae.name,payload:Zt}}))})))||[]},{})};On.addLoadListener(We=>{try{Ce.push(bn(We.contentDocument))}catch(An){console.warn(An)}});const Fe=()=>{va(),Ce.push(bn(document))};return document.readyState==="interactive"||document.readyState==="complete"?Fe():(Ce.push(zn("DOMContentLoaded",()=>{ce(Ft({type:Ne.DomContentLoaded,data:{}})),L==="DOMContentLoaded"&&Fe()})),Ce.push(zn("load",()=>{ce(Ft({type:Ne.Load,data:{}})),L==="load"&&Fe()},window))),()=>{Ce.forEach(We=>We()),lr.destroy(),Lp=void 0,dJ()}}catch(Ce){console.warn(Ce)}}function NJ(t){if(!Lp)throw new Error("please take full snapshot after start recording");Lp(t)}function MJ(t){V0&&V0(t)}Zo.mirror=Jr;Zo.takeFullSnapshot=NJ;function OJ(t,e){return t?t(Object.assign(Object.assign({},e),{mirror:Jr,win:window,mutationCb:n=>MJ(Ft({type:Ne.IncrementalSnapshot,data:Object.assign({source:Me.CanvasMutation},n)}))})):new RJ}const AJ=3,DJ=5;function ab(t){return t>9999999999?t:t*1e3}function uv(t){return t>9999999999?t/1e3:t}function gf(t,e){e.category!=="sentry.transaction"&&(["ui.click","ui.input"].includes(e.category)?t.triggerUserActivity():t.checkAndHandleExpiredSession(),t.addUpdate(()=>(t.throttledAddEvent({type:Ne.Custom,timestamp:(e.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:Ai(e,10,1e3)}}),e.category==="console")))}const LJ="button,a";function FM(t){return t.closest(LJ)||t}function UM(t){const e=BM(t);return!e||!(e instanceof Element)?e:FM(e)}function BM(t){return FJ(t)?t.target:t}function FJ(t){return typeof t=="object"&&!!t&&"target"in t}let Io;function UJ(t){return Io||(Io=[],BJ()),Io.push(t),()=>{const e=Io?Io.indexOf(t):-1;e>-1&&Io.splice(e,1)}}function BJ(){cn(ot,"open",function(t){return function(...e){if(Io)try{Io.forEach(n=>n())}catch{}return t.apply(ot,e)}})}function jJ(t,e,n){t.handleClick(e,n)}class $J{constructor(e,n,r=gf){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=n.timeout/1e3,this._threshold=n.threshold/1e3,this._scollTimeout=n.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=n.ignoreSelector,this._addBreadcrumbEvent=r}addListeners(){const e=UJ(()=>{this._lastMutation=E_()});this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,n){if(zJ(n,this._ignoreSelector)||!WJ(e))return;const r={timestamp:uv(e.timestamp),clickBreadcrumb:e,clickCount:0,node:n};this._clicks.some(i=>i.node===r.node&&Math.abs(i.timestamp-r.timestamp)<1)||(this._clicks.push(r),this._clicks.length===1&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=uv(e)}registerScroll(e=Date.now()){this._lastScroll=uv(e)}registerClick(e){const n=FM(e);this._handleMultiClick(n)}_handleMultiClick(e){this._getClicks(e).forEach(n=>{n.clickCount++})}_getClicks(e){return this._clicks.filter(n=>n.node===e)}_checkClicks(){const e=[],n=E_();this._clicks.forEach(r=>{!r.mutationAfter&&this._lastMutation&&(r.mutationAfter=r.timestamp<=this._lastMutation?this._lastMutation-r.timestamp:void 0),!r.scrollAfter&&this._lastScroll&&(r.scrollAfter=r.timestamp<=this._lastScroll?this._lastScroll-r.timestamp:void 0),r.timestamp+this._timeout<=n&&e.push(r)});for(const r of e){const i=this._clicks.indexOf(r);i>-1&&(this._generateBreadcrumbs(r),this._clicks.splice(i,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const n=this._replay,r=e.scrollAfter&&e.scrollAfter<=this._scollTimeout,i=e.mutationAfter&&e.mutationAfter<=this._threshold,s=!r&&!i,{clickCount:o,clickBreadcrumb:a}=e;if(s){const c=Math.min(e.mutationAfter||this._timeout,this._timeout)*1e3,l=c<this._timeout*1e3?"mutation":"timeout",u={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.slowClickDetected",data:{...a.data,url:ot.location.href,route:n.getCurrentRoute(),timeAfterClickMs:c,endReason:l,clickCount:o||1}};this._addBreadcrumbEvent(n,u);return}if(o>1){const c={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.multiClick",data:{...a.data,url:ot.location.href,route:n.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(n,c)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout(()=>this._checkClicks(),1e3)}}const VJ=["A","BUTTON","INPUT"];function zJ(t,e){return!!(!VJ.includes(t.tagName)||t.tagName==="INPUT"&&!["submit","button"].includes(t.getAttribute("type")||"")||t.tagName==="A"&&(t.hasAttribute("download")||t.hasAttribute("target")&&t.getAttribute("target")!=="_self")||e&&t.matches(e))}function WJ(t){return!!(t.data&&typeof t.data.nodeId=="number"&&t.timestamp)}function E_(){return Date.now()/1e3}function HJ(t,e){try{if(!GJ(e))return;const{source:n}=e.data;if(n===Me.Mutation&&t.registerMutation(e.timestamp),n===Me.Scroll&&t.registerScroll(e.timestamp),qJ(e)){const{type:r,id:i}=e.data,s=Zo.mirror.getNode(i);s instanceof HTMLElement&&r===Dn.Click&&t.registerClick(s)}}catch{}}function GJ(t){return t.type===AJ}function qJ(t){return t.data.source===Me.MouseInteraction}function ns(t){return{timestamp:Date.now()/1e3,type:"default",...t}}var Fp;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(Fp||(Fp={}));const JJ=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function KJ(t){const e={};for(const n in t)if(JJ.has(n)){let r=n;(n==="data-testid"||n==="data-test-id")&&(r="testId"),e[r]=t[n]}return e}const YJ=t=>e=>{if(!t.isEnabled())return;const n=XJ(e);if(!n)return;const r=e.name==="click",i=r?e.event:void 0;r&&t.clickDetector&&i&&i.target&&!i.altKey&&!i.metaKey&&!i.ctrlKey&&!i.shiftKey&&jJ(t.clickDetector,n,UM(e.event)),gf(t,n)};function jM(t,e){const n=Zo.mirror.getId(t),r=n&&Zo.mirror.getNode(n),i=r&&Zo.mirror.getMeta(r),s=i&&ZJ(i)?i:null;return{message:e,data:s?{nodeId:n,node:{id:n,tagName:s.tagName,textContent:Array.from(s.childNodes).map(o=>o.type===Fp.Text&&o.textContent).filter(Boolean).map(o=>o.trim()).join(""),attributes:KJ(s.attributes)}}:{}}}function XJ(t){const{target:e,message:n}=QJ(t);return ns({category:`ui.${t.name}`,...jM(e,n)})}function QJ(t){const e=t.name==="click";let n,r=null;try{r=e?UM(t.event):BM(t.event),n=Xa(r,{maxStringLength:200})||"<unknown>"}catch{n="<unknown>"}return{target:r,message:n}}function ZJ(t){return t.type===Fp.Element}function eK(t,e){if(!t.isEnabled())return;t.updateUserActivity();const n=tK(e);n&&gf(t,n)}function tK(t){const{metaKey:e,shiftKey:n,ctrlKey:r,altKey:i,key:s,target:o}=t;if(!o||nK(o)||!s)return null;const a=e||r||i,c=s.length===1;if(!a&&c)return null;const l=Xa(o,{maxStringLength:200})||"<unknown>",u=jM(o,l);return ns({category:"ui.keyDown",message:l,data:{...u.data,metaKey:e,shiftKey:n,ctrlKey:r,altKey:i,key:s}})}function nK(t){return t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable}const k_={resource:aK,paint:sK,navigation:oK};function rK(t){return t.map(iK).filter(Boolean)}function iK(t){return k_[t.entryType]?k_[t.entryType](t):null}function jl(t){return((ki||ot.performance.timeOrigin)+t)/1e3}function sK(t){const{duration:e,entryType:n,name:r,startTime:i}=t,s=jl(i);return{type:n,name:r,start:s,end:s+e,data:void 0}}function oK(t){const{entryType:e,name:n,decodedBodySize:r,duration:i,domComplete:s,encodedBodySize:o,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:f,startTime:h,transferSize:p,type:m}=t;return i===0?null:{type:`${e}.${m}`,start:jl(h),end:jl(s),name:n,data:{size:p,decodedBodySize:r,encodedBodySize:o,duration:i,domInteractive:l,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:s,redirectCount:f}}}function aK(t){const{entryType:e,initiatorType:n,name:r,responseEnd:i,startTime:s,decodedBodySize:o,encodedBodySize:a,responseStatus:c,transferSize:l}=t;return["fetch","xmlhttprequest"].includes(n)?null:{type:`${e}.${n}`,start:jl(s),end:jl(i),name:r,data:{size:l,statusCode:c,decodedBodySize:o,encodedBodySize:a}}}function cK(t){const e=t.entries,n=e[e.length-1],r=n?n.element:void 0,i=t.value,s=jl(i);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:s,end:s,data:{value:i,size:i,nodeId:r?Zo.mirror.getId(r):void 0}}}function lK(t){function e(i){t.performanceEntries.includes(i)||t.performanceEntries.push(i)}function n({entries:i}){i.forEach(e)}const r=[];return["navigation","paint","resource"].forEach(i=>{r.push(Fm(i,n))}),r.push(mM(({metric:i})=>{t.replayPerformanceEntries.push(cK(i))})),()=>{r.forEach(i=>i())}}const tt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,uK='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function dK(){const t=new Blob([uK]);return URL.createObjectURL(t)}function jn(t,e){tt&&(G.info(t),e&&$M(t))}function fl(t,e){tt&&(G.info(t),e&&setTimeout(()=>{$M(t)},0))}function $M(t){ca({category:"console",data:{logger:"replay"},level:"info",message:t},{level:"info"})}class cb extends Error{constructor(){super(`Event buffer exceeded maximum size of ${nb}.`)}}class VM{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const n=JSON.stringify(e).length;if(this._totalSize+=n,this._totalSize>nb)throw new cb;this.events.push(e)}finish(){return new Promise(e=>{const n=this.events;this.clear(),e(JSON.stringify(n))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map(n=>n.timestamp).sort()[0];return e?ab(e):null}}class fK{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise?this._ensureReadyPromise:(this._ensureReadyPromise=new Promise((e,n)=>{this._worker.addEventListener("message",({data:r})=>{r.success?e():n()},{once:!0}),this._worker.addEventListener("error",r=>{n(r)},{once:!0})}),this._ensureReadyPromise)}destroy(){jn("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(e,n){const r=this._getAndIncrementId();return new Promise((i,s)=>{const o=({data:a})=>{const c=a;if(c.method===e&&c.id===r){if(this._worker.removeEventListener("message",o),!c.success){tt&&G.error("[Replay]",c.response),s(new Error("Error in compression worker"));return}i(c.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:r,method:e,arg:n})})}_getAndIncrementId(){return this._id++}}class hK{constructor(e){this._worker=new fK(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const n=ab(e.timestamp);(!this._earliestTimestamp||n<this._earliestTimestamp)&&(this._earliestTimestamp=n);const r=JSON.stringify(e);return this._totalSize+=r.length,this._totalSize>nb?Promise.reject(new cb):this._sendEventToWorker(r)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,e=>{tt&&G.warn('[Replay] Sending "clear" message to worker failed',e)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class pK{constructor(e){this._fallback=new VM,this._compression=new hK(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch{jn("[Replay] Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:n}=this._fallback,r=[];for(const i of e)r.push(this._compression.addEvent(i));this._compression.hasCheckout=n,this._used=this._compression;try{await Promise.all(r)}catch(i){tt&&G.warn("[Replay] Failed to add events when switching buffers.",i)}}}function mK({useCompression:t,workerUrl:e}){if(t&&window.Worker){const n=gK(e);if(n)return n}return jn("[Replay] Using simple buffer"),new VM}function gK(t){try{const e=t||vK();if(!e)return;jn(`[Replay] Using compression worker${t?` from ${t}`:""}`);const n=new Worker(e);return new pK(n)}catch{jn("[Replay] Failed to create compression worker")}}function vK(){return typeof __SENTRY_EXCLUDE_REPLAY_WORKER__>"u"||!__SENTRY_EXCLUDE_REPLAY_WORKER__?dK():""}function lb(){try{return"sessionStorage"in ot&&!!ot.sessionStorage}catch{return!1}}function yK(t){SK(),t.session=void 0}function SK(){if(lb())try{ot.sessionStorage.removeItem(eb)}catch{}}function zM(t){return t===void 0?!1:Math.random()<t}function WM(t){const e=Date.now(),n=t.id||Pn(),r=t.started||e,i=t.lastActivity||e,s=t.segmentId||0,o=t.sampled,a=t.previousSessionId;return{id:n,started:r,lastActivity:i,segmentId:s,sampled:o,previousSessionId:a}}function ub(t){if(lb())try{ot.sessionStorage.setItem(eb,JSON.stringify(t))}catch{}}function wK(t,e){return zM(t)?"session":e?"buffer":!1}function T_({sessionSampleRate:t,allowBuffering:e,stickySession:n=!1},{previousSessionId:r}={}){const i=wK(t,e),s=WM({sampled:i,previousSessionId:r});return n&&ub(s),s}function bK(t){if(!lb())return null;try{const e=ot.sessionStorage.getItem(eb);if(!e)return null;const n=JSON.parse(e);return fl("[Replay] Loading existing session",t),WM(n)}catch{return null}}function z0(t,e,n=+new Date){return t===null||e===void 0||e<0?!0:e===0?!1:t+e<=n}function HM(t,{maxReplayDuration:e,sessionIdleExpire:n,targetTime:r=Date.now()}){return z0(t.started,e,r)||z0(t.lastActivity,n,r)}function GM(t,{sessionIdleExpire:e,maxReplayDuration:n}){return!(!HM(t,{sessionIdleExpire:e,maxReplayDuration:n})||t.sampled==="buffer"&&t.segmentId===0)}function dv({traceInternals:t,sessionIdleExpire:e,maxReplayDuration:n,previousSessionId:r},i){const s=i.stickySession&&bK(t);return s?GM(s,{sessionIdleExpire:e,maxReplayDuration:n})?(fl("[Replay] Session in sessionStorage is expired, creating new one..."),T_(i,{previousSessionId:s.id})):s:(fl("[Replay] Creating new session",t),T_(i,{previousSessionId:r}))}function EK(t){return t.type===Ne.Custom}function db(t,e,n){return JM(t,e)?(qM(t,e,n),!0):!1}function kK(t,e,n){return JM(t,e)?qM(t,e,n):Promise.resolve(null)}async function qM(t,e,n){if(!t.eventBuffer)return null;try{n&&t.recordingMode==="buffer"&&t.eventBuffer.clear(),n&&(t.eventBuffer.hasCheckout=!0);const r=t.getOptions(),i=TK(e,r.beforeAddRecordingEvent);return i?await t.eventBuffer.addEvent(i):void 0}catch(r){const i=r&&r instanceof cb?"addEventSizeExceeded":"addEvent";tt&&G.error(r),await t.stop({reason:i});const s=Ct();s&&s.recordDroppedEvent("internal_sdk_error","replay")}}function JM(t,e){if(!t.eventBuffer||t.isPaused()||!t.isEnabled())return!1;const n=ab(e.timestamp);return n+t.timeouts.sessionIdlePause<Date.now()?!1:n>t.getContext().initialTimestamp+t.getOptions().maxReplayDuration?(jn(`[Replay] Skipping event with timestamp ${n} because it is after maxReplayDuration`,t.getOptions()._experiments.traceInternals),!1):!0}function TK(t,e){try{if(typeof e=="function"&&EK(t))return e(t)}catch(n){return tt&&G.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",n),null}return t}function fb(t){return!t.type}function W0(t){return t.type==="transaction"}function _K(t){return t.type==="replay_event"}function __(t){return t.type==="feedback"}function KM(t){const e=RK();return(n,r)=>{if(!t.isEnabled()||!fb(n)&&!W0(n))return;const i=r&&r.statusCode;if(!(e&&(!i||i<200||i>=300))){if(W0(n)){CK(t,n);return}IK(t,n)}}}function CK(t,e){const n=t.getContext();e.contexts&&e.contexts.trace&&e.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(e.contexts.trace.trace_id)}function IK(t,e){const n=t.getContext();if(e.event_id&&n.errorIds.size<100&&n.errorIds.add(e.event_id),t.recordingMode!=="buffer"||!e.tags||!e.tags.replayId)return;const{beforeErrorSampling:r}=t.getOptions();typeof r=="function"&&!r(e)||setTimeout(()=>{t.sendBufferedReplayOrFlush()})}function RK(){const t=Ct();if(!t)return!1;const e=t.getTransport();return e&&e.send.__sentry__baseTransport__||!1}function PK(t){return e=>{!t.isEnabled()||!fb(e)||xK(t,e)}}function xK(t,e){const n=e.exception&&e.exception.values&&e.exception.values[0].value;if(typeof n=="string"&&(n.match(/reactjs\.org\/docs\/error-decoder\.html\?invariant=(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i))){const r=ns({category:"replay.hydrate-error"});gf(t,r)}}function NK(t,e){return t.type||!t.exception||!t.exception.values||!t.exception.values.length?!1:!!(e.originalException&&e.originalException.__rrweb__)}function MK(t,e){t.triggerUserActivity(),t.addUpdate(()=>e.timestamp?(t.throttledAddEvent({type:Ne.Custom,timestamp:e.timestamp*1e3,data:{timestamp:e.timestamp,tag:"breadcrumb",payload:{category:"sentry.feedback",data:{feedbackId:e.event_id}}}}),!1):!0)}function OK(t,e){return t.recordingMode!=="buffer"||e.message===tb||!e.exception||e.type?!1:zM(t.getOptions().errorSampleRate)}function AK(t,e=!1){const n=e?KM(t):void 0;return Object.assign((r,i)=>t.isEnabled()?_K(r)?(delete r.breadcrumbs,r):!fb(r)&&!W0(r)&&!__(r)||!t.checkAndHandleExpiredSession()?r:__(r)?(t.flush(),r.contexts.feedback.replay_id=t.getSessionId(),MK(t,r),r):NK(r,i)&&!t.getOptions()._experiments.captureExceptions?(tt&&G.log("[Replay] Ignoring error from rrweb internals",r),null):((OK(t,r)||t.recordingMode==="session")&&(r.tags={...r.tags,replayId:t.getSessionId()}),n&&n(r,{statusCode:200}),r):r,{id:"Replay"})}function jm(t,e){return e.map(({type:n,start:r,end:i,name:s,data:o})=>{const a=t.throttledAddEvent({type:Ne.Custom,timestamp:r,data:{tag:"performanceSpan",payload:{op:n,description:s,startTimestamp:r,endTimestamp:i,data:o}}});return typeof a=="string"?Promise.resolve(null):a})}function DK(t){const{from:e,to:n}=t,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:e}}}function LK(t){return e=>{if(!t.isEnabled())return;const n=DK(e);n!==null&&(t.getContext().urls.push(n.name),t.triggerUserActivity(),t.addUpdate(()=>(jm(t,[n]),!1)))}}function FK(t,e){return tt&&t.getOptions()._experiments.traceInternals?!1:u9(e,Ct())}function $m(t,e){t.isEnabled()&&e!==null&&(FK(t,e.name)||t.addUpdate(()=>(jm(t,[e]),!0)))}function UK(t){const{startTimestamp:e,endTimestamp:n,fetchData:r,response:i}=t;if(!n)return null;const{method:s,url:o}=r;return{type:"resource.fetch",start:e/1e3,end:n/1e3,name:o,data:{method:s,statusCode:i?i.status:void 0}}}function BK(t){return e=>{if(!t.isEnabled())return;const n=UK(e);$m(t,n)}}function jK(t){const{startTimestamp:e,endTimestamp:n,xhr:r}=t,i=r[$o];if(!e||!n||!i)return null;const{method:s,url:o,status_code:a}=i;return o===void 0?null:{type:"resource.xhr",name:o,start:e/1e3,end:n/1e3,data:{method:s,statusCode:a}}}function $K(t){return e=>{if(!t.isEnabled())return;const n=jK(e);$m(t,n)}}function Vm(t,e){if(t)try{if(typeof t=="string")return e.encode(t).length;if(t instanceof URLSearchParams)return e.encode(t.toString()).length;if(t instanceof FormData){const n=ZM(t);return e.encode(n).length}if(t instanceof Blob)return t.size;if(t instanceof ArrayBuffer)return t.byteLength}catch{}}function YM(t){if(!t)return;const e=parseInt(t,10);return isNaN(e)?void 0:e}function XM(t){try{if(typeof t=="string")return[t];if(t instanceof URLSearchParams)return[t.toString()];if(t instanceof FormData)return[ZM(t)];if(!t)return[void 0]}catch{return tt&&G.warn("[Replay] Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return tt&&G.info("[Replay] Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function Up(t,e){if(!t)return{headers:{},size:void 0,_meta:{warnings:[e]}};const n={...t._meta},r=n.warnings||[];return n.warnings=[...r,e],t._meta=n,t}function QM(t,e){if(!e)return null;const{startTimestamp:n,endTimestamp:r,url:i,method:s,statusCode:o,request:a,response:c}=e;return{type:t,start:n/1e3,end:r/1e3,name:i,data:os({method:s,statusCode:o,request:a,response:c})}}function Bd(t){return{headers:{},size:t,_meta:{warnings:["URL_SKIPPED"]}}}function ea(t,e,n){if(!e&&Object.keys(t).length===0)return;if(!e)return{headers:t};if(!n)return{headers:t,size:e};const r={headers:t,size:e},{body:i,warnings:s}=VK(n);return r.body=i,s&&s.length>0&&(r._meta={warnings:s}),r}function H0(t,e){return Object.keys(t).reduce((n,r)=>{const i=r.toLowerCase();return e.includes(i)&&t[r]&&(n[i]=t[r]),n},{})}function ZM(t){return new URLSearchParams(t).toString()}function VK(t){if(!t||typeof t!="string")return{body:t};const e=t.length>d_,n=zK(t);if(e){const r=t.slice(0,d_);return n?{body:r,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${r}`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(t)}}catch{}return{body:t}}function zK(t){const e=t[0],n=t[t.length-1];return e==="["&&n==="]"||e==="{"&&n==="}"}function Bp(t,e){const n=WK(t);return nu(n,e)}function WK(t,e=ot.document.baseURI){if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith(ot.location.origin))return t;const n=new URL(t,e);if(n.origin!==new URL(e).origin)return t;const r=n.href;return!t.endsWith("/")&&r.endsWith("/")?r.slice(0,-1):r}async function HK(t,e,n){try{const r=await qK(t,e,n),i=QM("resource.fetch",r);$m(n.replay,i)}catch(r){tt&&G.error("[Replay] Failed to capture fetch breadcrumb",r)}}function GK(t,e,n){const{input:r,response:i}=e,s=r?eO(r):void 0,o=Vm(s,n.textEncoder),a=i?YM(i.headers.get("content-length")):void 0;o!==void 0&&(t.data.request_body_size=o),a!==void 0&&(t.data.response_body_size=a)}async function qK(t,e,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r}=e,{url:o,method:a,status_code:c=0,request_body_size:l,response_body_size:u}=t.data,d=Bp(o,n.networkDetailAllowUrls)&&!Bp(o,n.networkDetailDenyUrls),f=d?JK(n,e.input,l):Bd(l),h=await KK(d,n,e.response,u);return{startTimestamp:i,endTimestamp:s,url:o,method:a,statusCode:c,request:f,response:h}}function JK({networkCaptureBodies:t,networkRequestHeaders:e},n,r){const i=n?QK(n,e):{};if(!t)return ea(i,r,void 0);const s=eO(n),[o,a]=XM(s),c=ea(i,r,o);return a?Up(c,a):c}async function KK(t,{networkCaptureBodies:e,textEncoder:n,networkResponseHeaders:r},i,s){if(!t&&s!==void 0)return Bd(s);const o=i?tO(i.headers,r):{};if(!i||!e&&s!==void 0)return ea(o,s,void 0);const[a,c]=await XK(i),l=YK(a,{networkCaptureBodies:e,textEncoder:n,responseBodySize:s,captureDetails:t,headers:o});return c?Up(l,c):l}function YK(t,{networkCaptureBodies:e,textEncoder:n,responseBodySize:r,captureDetails:i,headers:s}){try{const o=t&&t.length&&r===void 0?Vm(t,n):r;return i?e?ea(s,o,t):ea(s,o,void 0):Bd(o)}catch(o){return tt&&G.warn("[Replay] Failed to serialize response body",o),ea(s,r,void 0)}}async function XK(t){const e=ZK(t);if(!e)return[void 0,"BODY_PARSE_ERROR"];try{return[await eY(e)]}catch(n){return tt&&G.warn("[Replay] Failed to get text body from response",n),[void 0,"BODY_PARSE_ERROR"]}}function eO(t=[]){if(!(t.length!==2||typeof t[1]!="object"))return t[1].body}function tO(t,e){const n={};return e.forEach(r=>{t.get(r)&&(n[r]=t.get(r))}),n}function QK(t,e){return t.length===1&&typeof t[0]!="string"?C_(t[0],e):t.length===2?C_(t[1],e):{}}function C_(t,e){if(!t)return{};const n=t.headers;return n?n instanceof Headers?tO(n,e):Array.isArray(n)?{}:H0(n,e):{}}function ZK(t){try{return t.clone()}catch(e){tt&&G.warn("[Replay] Failed to clone response body",e)}}function eY(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error("Timeout while trying to read response body")),500);tY(t).then(i=>e(i),i=>n(i)).finally(()=>clearTimeout(r))})}async function tY(t){return await t.text()}async function nY(t,e,n){try{const r=iY(t,e,n),i=QM("resource.xhr",r);$m(n.replay,i)}catch(r){tt&&G.error("[Replay] Failed to capture xhr breadcrumb",r)}}function rY(t,e,n){const{xhr:r,input:i}=e;if(!r)return;const s=Vm(i,n.textEncoder),o=r.getResponseHeader("content-length")?YM(r.getResponseHeader("content-length")):cY(r.response,r.responseType,n.textEncoder);s!==void 0&&(t.data.request_body_size=s),o!==void 0&&(t.data.response_body_size=o)}function iY(t,e,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r,input:o,xhr:a}=e,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:f}=t.data;if(!c)return null;if(!a||!Bp(c,n.networkDetailAllowUrls)||Bp(c,n.networkDetailDenyUrls)){const k=Bd(d),I=Bd(f);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:k,response:I}}const h=a[$o],p=h?H0(h.request_headers,n.networkRequestHeaders):{},m=H0(sY(a),n.networkResponseHeaders),[w,g]=n.networkCaptureBodies?XM(o):[void 0],[v,b]=n.networkCaptureBodies?oY(a):[void 0],C=ea(p,d,w),T=ea(m,f,v);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:g?Up(C,g):C,response:b?Up(T,b):T}}function sY(t){const e=t.getAllResponseHeaders();return e?e.split(`\r
`).reduce((n,r)=>{const[i,s]=r.split(": ");return n[i.toLowerCase()]=s,n},{}):{}}function oY(t){const e=[];try{return[t.responseText]}catch(n){e.push(n)}try{return aY(t.response,t.responseType)}catch(n){e.push(n)}return tt&&G.warn("[Replay] Failed to get xhr response body",...e),[void 0]}function aY(t,e){try{if(typeof t=="string")return[t];if(t instanceof Document)return[t.body.outerHTML];if(e==="json"&&t&&typeof t=="object")return[JSON.stringify(t)];if(!t)return[void 0]}catch{return tt&&G.warn("[Replay] Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return tt&&G.info("[Replay] Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function cY(t,e,n){try{const r=e==="json"&&t&&typeof t=="object"?JSON.stringify(t):t;return Vm(r,n)}catch{return}}function lY(t){const e=Ct();try{const n=new TextEncoder,{networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a}=t.getOptions(),c={replay:t,textEncoder:n,networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a};e&&e.on?e.on("beforeAddBreadcrumb",(l,u)=>uY(c,l,u)):(Fw(BK(t)),Uw($K(t)))}catch{}}function uY(t,e,n){if(e.data)try{dY(e)&&hY(n)&&(rY(e,n,t),nY(e,n,t)),fY(e)&&pY(n)&&(GK(e,n,t),HK(e,n,t))}catch{tt&&G.warn("Error when enriching network breadcrumb")}}function dY(t){return t.category==="xhr"}function fY(t){return t.category==="fetch"}function hY(t){return t&&t.xhr}function pY(t){return t&&t.response}let I_=null;function mY(t){return!!t.category}const gY=t=>e=>{if(!t.isEnabled())return;const n=vY(e);n&&gf(t,n)};function vY(t){const e=t.getLastBreadcrumb&&t.getLastBreadcrumb();return I_===e||!e||(I_=e,!mY(e)||["fetch","xhr","sentry.event","sentry.transaction"].includes(e.category)||e.category.startsWith("ui."))?null:e.category==="console"?yY(e):ns(e)}function yY(t){const e=t.data&&t.data.arguments;if(!Array.isArray(e)||e.length===0)return ns(t);let n=!1;const r=e.map(i=>{if(!i)return i;if(typeof i=="string")return i.length>Zf?(n=!0,`${i.slice(0,Zf)}`):i;if(typeof i=="object")try{const s=Ai(i,7);return JSON.stringify(s).length>Zf?(n=!0,`${JSON.stringify(s,null,2).slice(0,Zf)}`):s}catch{}return i});return ns({...t,data:{...t.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function SY(t){const e=pf(),n=Ct();e.addScopeListener(gY(t)),EN(YJ(t)),xm(LK(t)),lY(t);const r=AK(t,!R_(n));n&&n.addEventProcessor?n.addEventProcessor(r):GH(r),R_(n)&&(n.on("beforeSendEvent",PK(t)),n.on("afterSendEvent",KM(t)),n.on("createDsc",i=>{const s=t.getSessionId();s&&t.isEnabled()&&t.recordingMode==="session"&&t.checkAndHandleExpiredSession()&&(i.replay_id=s)}),n.on("startTransaction",i=>{t.lastTransaction=i}),n.on("finishTransaction",i=>{t.lastTransaction=i}),n.on("beforeSendFeedback",(i,s)=>{const o=t.getSessionId();s&&s.includeReplay&&t.isEnabled()&&o&&(t.flush(),i.contexts&&i.contexts.feedback&&(i.contexts.feedback.replay_id=o))}))}function R_(t){return!!(t&&t.on)}async function wY(t){try{return Promise.all(jm(t,[bY(ot.performance.memory)]))}catch{return[]}}function bY(t){const{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}=t,i=Date.now()/1e3;return{type:"memory",name:"memory",start:i,end:i,data:{memory:{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}}}}function EY(t,e,n){let r,i,s;const o=n&&n.maxWait?Math.max(n.maxWait,e):0;function a(){return c(),r=t(),r}function c(){i!==void 0&&clearTimeout(i),s!==void 0&&clearTimeout(s),i=s=void 0}function l(){return i!==void 0||s!==void 0?a():r}function u(){return i&&clearTimeout(i),i=setTimeout(a,e),o&&s===void 0&&(s=setTimeout(a,o)),r}return u.cancel=c,u.flush=l,u}function kY(t){let e=!1;return(n,r)=>{if(!t.checkAndHandleExpiredSession()){tt&&G.warn("[Replay] Received replay event after session expired.");return}const i=r||!e;e=!0,t.clickDetector&&HJ(t.clickDetector,n),t.addUpdate(()=>{if(t.recordingMode==="buffer"&&i&&t.setInitialState(),!db(t,n,i))return!0;if(!i)return!1;if(_Y(t,i),t.session&&t.session.previousSessionId)return!0;if(t.recordingMode==="buffer"&&t.session&&t.eventBuffer){const s=t.eventBuffer.getEarliestTimestamp();s&&(jn(`[Replay] Updating session start time to earliest event in buffer to ${new Date(s)}`,t.getOptions()._experiments.traceInternals),t.session.started=s,t.getOptions().stickySession&&ub(t.session))}return t.recordingMode==="session"&&t.flush(),!0})}}function TY(t){const e=t.getOptions();return{type:Ne.Custom,timestamp:Date.now(),data:{tag:"options",payload:{sessionSampleRate:e.sessionSampleRate,errorSampleRate:e.errorSampleRate,useCompressionOption:e.useCompression,blockAllMedia:e.blockAllMedia,maskAllText:e.maskAllText,maskAllInputs:e.maskAllInputs,useCompression:t.eventBuffer?t.eventBuffer.type==="worker":!1,networkDetailHasUrls:e.networkDetailAllowUrls.length>0,networkCaptureBodies:e.networkCaptureBodies,networkRequestHasHeaders:e.networkRequestHeaders.length>0,networkResponseHasHeaders:e.networkResponseHeaders.length>0}}}}function _Y(t,e){!e||!t.session||t.session.segmentId!==0||db(t,TY(t),!1)}function CY(t,e,n,r){return dc(xN(t,$w(t),r,n),[[{type:"replay_event"},t],[{type:"replay_recording",length:typeof e=="string"?new TextEncoder().encode(e).length:e.length},e]])}function IY({recordingData:t,headers:e}){let n;const r=`${JSON.stringify(e)}
`;if(typeof t=="string")n=`${r}${t}`;else{const s=new TextEncoder().encode(r);n=new Uint8Array(s.length+t.length),n.set(s),n.set(t,s.length)}return n}async function RY({client:t,scope:e,replayId:n,event:r}){const i=typeof t._integrations=="object"&&t._integrations!==null&&!Array.isArray(t._integrations)?Object.keys(t._integrations):void 0,s={event_id:n,integrations:i};t.emit&&t.emit("preprocessEvent",r,s);const o=await jN(t.getOptions(),r,s,e,t,LN());if(!o)return null;o.platform=o.platform||"javascript";const a=t.getSdkMetadata&&t.getSdkMetadata(),{name:c,version:l}=a&&a.sdk||{};return o.sdk={...o.sdk,name:c||"sentry.javascript.unknown",version:l||"0.0.0"},o}async function PY({recordingData:t,replayId:e,segmentId:n,eventContext:r,timestamp:i,session:s}){const o=IY({recordingData:t,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=Ct(),f=pf(),h=d&&d.getTransport(),p=d&&d.getDsn();if(!d||!h||!p||!s.sampled)return;const m={type:mq,replay_start_timestamp:u/1e3,timestamp:i/1e3,error_ids:c,trace_ids:l,urls:a,replay_id:e,segment_id:n,replay_type:s.sampled},w=await RY({scope:f,client:d,replayId:e,event:m});if(!w){d.recordDroppedEvent("event_processor","replay",m),jn("An event processor returned `null`, will not send event.");return}delete w.sdkProcessingMetadata;const g=CY(w,o,p,d.getOptions().tunnel);let v;try{v=await h.send(g)}catch(C){const T=new Error(tb);try{T.cause=C}catch{}throw T}if(!v)return v;if(typeof v.statusCode=="number"&&(v.statusCode<200||v.statusCode>=300))throw new nO(v.statusCode);const b=MN({},v);if(NN(b,"replay"))throw new rO(b);return v}class nO extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class rO extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function iO(t,e={count:0,interval:bq}){const{recordingData:n,options:r}=t;if(n.length)try{return await PY(t),!0}catch(i){if(i instanceof nO||i instanceof rO)throw i;if(kH("Replays",{_retryCount:e.count}),tt&&r._experiments&&r._experiments.captureExceptions&&Om(i),e.count>=Eq){const s=new Error(`${tb} - max retries exceeded`);try{s.cause=i}catch{}throw s}return e.interval*=++e.count,new Promise((s,o)=>{setTimeout(async()=>{try{await iO(t,e),s(!0)}catch(a){o(a)}},e.interval)})}}const sO="__THROTTLED",xY="__SKIPPED";function NY(t,e,n){const r=new Map,i=a=>{const c=a-n;r.forEach((l,u)=>{u<c&&r.delete(u)})},s=()=>[...r.values()].reduce((a,c)=>a+c,0);let o=!1;return(...a)=>{const c=Math.floor(Date.now()/1e3);if(i(c),s()>=e){const u=o;return o=!0,u?xY:sO}o=!1;const l=r.get(c)||0;return r.set(c,l+1),t(...a)}}class Ro{constructor({options:e,recordingOptions:n}){Ro.prototype.__init.call(this),Ro.prototype.__init2.call(this),Ro.prototype.__init3.call(this),Ro.prototype.__init4.call(this),Ro.prototype.__init5.call(this),Ro.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:gq,sessionIdleExpire:vq},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=n,this._options=e,this._debouncedFlush=EY(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=NY((o,a)=>kK(this,o,a),300,5);const{slowClickTimeout:r,slowClickIgnoreSelectors:i}=this.getOptions(),s=r?{threshold:Math.min(kq,r),timeout:r,scrollTimeout:Tq,ignoreSelector:i?i.join(","):""}:void 0;s&&(this.clickDetector=new $J(this,s))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}getOptions(){return this._options}initializeSampling(e){const{errorSampleRate:n,sessionSampleRate:r}=this._options;if(!(n<=0&&r<=0)){if(this._initializeSessionForSampling(e),!this.session){this._handleException(new Error("Unable to initialize and create session"));return}this.session.sampled!==!1&&(this.recordingMode=this.session.sampled==="buffer"&&this.session.segmentId===0?"buffer":"session",fl(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording())}}start(){if(this._isEnabled&&this.recordingMode==="session")throw new Error("Replay recording is already in progress");if(this._isEnabled&&this.recordingMode==="buffer")throw new Error("Replay buffering is in progress, call `flush()` to save the replay");fl("[Replay] Starting replay in session mode",this._options._experiments.traceInternals);const e=dv({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");fl("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const e=dv({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._options._experiments.canvas;this._stopRecording=Zo({...this._recordingOptions,...this.recordingMode==="buffer"&&{checkoutEveryNms:wq},emit:kY(this),onMutation:this._onMutationHandler,...e&&e.manager&&{recordCanvas:!0,getCanvasManager:e.manager,...h_[e.quality||"medium"]||h_.medium}})}catch(e){this._handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this._handleException(e),!1}}async stop({forceFlush:e=!1,reason:n}={}){if(this._isEnabled){this._isEnabled=!1;try{jn(`[Replay] Stopping Replay${n?` triggered by ${n}`:""}`,this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,yK(this)}catch(r){this._handleException(r)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),jn("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){!this._isPaused||!this._checkSession()||(this._isPaused=!1,this.startRecording(),jn("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if(this.recordingMode==="session")return this.flushImmediate();const n=Date.now();jn("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const r=this.stopRecording();!e||!r||this.recordingMode!=="session"&&(this.recordingMode="session",this.session&&(this._updateUserActivity(n),this._updateSessionActivity(n),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const n=e();this.recordingMode!=="buffer"&&n!==!0&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),!this._stopRecording){if(!this._checkSession())return;this.resume();return}this.checkAndHandleExpiredSession(),this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return this.recordingMode==="buffer"?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(this._lastActivity&&z0(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}return!!this._checkSession()}setInitialState(){const e=`${ot.location.pathname}${ot.location.hash}${ot.location.search}`,n=`${ot.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=n,this._context.initialTimestamp=Date.now(),this._context.urls.push(n)}throttledAddEvent(e,n){const r=this._throttledAddEvent(e,n);if(r===sO){const i=ns({category:"replay.throttled"});this.addUpdate(()=>!db(this,{type:DJ,timestamp:i.timestamp||0,data:{tag:"breadcrumb",payload:i,metric:!0}}))}return r}getCurrentRoute(){const e=this.lastTransaction||pf().getTransaction();if(!(!e||!["route","custom"].includes(e.metadata.source)))return e.name}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=mK({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(e){tt&&G.error("[Replay]",e),tt&&this._options._experiments&&this._options._experiments.captureExceptions&&Om(e)}_initializeSessionForSampling(e){const n=this._options.errorSampleRate>0,r=dv({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:n});this.session=r}_checkSession(){if(!this.session)return!1;const e=this.session;return GM(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})?(this._refreshSession(e),!1):!0}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{ot.document.addEventListener("visibilitychange",this._handleVisibilityChange),ot.addEventListener("blur",this._handleWindowBlur),ot.addEventListener("focus",this._handleWindowFocus),ot.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(SY(this),this._hasInitializedCoreListeners=!0)}catch(e){this._handleException(e)}this._performanceCleanupCallback=lK(this)}_removeListeners(){try{ot.document.removeEventListener("visibilitychange",this._handleVisibilityChange),ot.removeEventListener("blur",this._handleWindowBlur),ot.removeEventListener("focus",this._handleWindowFocus),ot.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this._handleException(e)}}__init(){this._handleVisibilityChange=()=>{ot.document.visibilityState==="visible"?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=ns({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=ns({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{eK(this,e)}}_doChangeToBackgroundTasks(e){!this.session||HM(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;if(!this.checkAndHandleExpiredSession()){jn("[Replay] Document has become active, but session has expired");return}e&&this._createCustomBreadcrumb(e)}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate(()=>{this.throttledAddEvent({type:Ne.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})})}_addPerformanceEntries(){const e=rK(this.performanceEntries).concat(this.replayPerformanceEntries);return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(jm(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:n}=this;if(!e||!n||e.segmentId)return;const r=n.getEarliestTimestamp();r&&r<this._context.initialTimestamp&&(this._context.initialTimestamp=r)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(!this.session||!this.eventBuffer||!e){tt&&G.error("[Replay] No session or eventBuffer found to flush.");return}if(await this._addPerformanceEntries(),!(!this.eventBuffer||!this.eventBuffer.hasEvents)&&(await wY(this),!!this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const n=Date.now();if(n-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const r=this._popEventContext(),i=this.session.segmentId++;this._maybeSaveSession();const s=await this.eventBuffer.finish();await iO({replayId:e,recordingData:s,segmentId:i,eventContext:r,session:this.session,options:this.getOptions(),timestamp:n})}catch(n){this._handleException(n),this.stop({reason:"sendReplay"});const r=Ct();r&&r.recordDroppedEvent("send_error","replay")}}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession()){tt&&G.error("[Replay] Attempting to finish replay event after session expired.");return}if(!this.session)return;const n=this.session.started,i=Date.now()-n;this._debouncedFlush.cancel();const s=i<this._options.minReplayDuration,o=i>this._options.maxReplayDuration+5e3;if(s||o){jn(`[Replay] Session duration (${Math.floor(i/1e3)}s) is too ${s?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),s&&this._debouncedFlush();return}const a=this.eventBuffer;if(a&&this.session.segmentId===0&&!a.hasCheckout&&jn("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock){this._flushLock=this._runFlush(),await this._flushLock,this._flushLock=void 0;return}try{await this._flushLock}catch(c){tt&&G.error(c)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&ub(this.session)}__init6(){this._onMutationHandler=e=>{const n=e.length,r=this._options.mutationLimit,i=this._options.mutationBreadcrumbLimit,s=r&&n>r;if(n>i||s){const o=ns({category:"replay.mutations",data:{count:n,limit:s}});this._createCustomBreadcrumb(o)}return s?(this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"}),!1):!0}}}function Cu(t,e,n,r){const i=typeof r=="string"?r.split(","):[],s=[...t,...i,...e];return typeof n<"u"&&(typeof n=="string"&&s.push(`.${n}`),Qa(()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")})),s.join(",")}function MY({mask:t,unmask:e,block:n,unblock:r,ignore:i,blockClass:s,blockSelector:o,maskTextClass:a,maskTextSelector:c,ignoreClass:l}){const u=['base[href="/"]'],d=Cu(t,[".sentry-mask","[data-sentry-mask]"],a,c),f=Cu(e,[".sentry-unmask","[data-sentry-unmask]"]),h={maskTextSelector:d,unmaskTextSelector:f,blockSelector:Cu(n,[".sentry-block","[data-sentry-block]",...u],s,o),unblockSelector:Cu(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:Cu(i,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],l)};return s instanceof RegExp&&(h.blockClass=s),a instanceof RegExp&&(h.maskTextClass=a),h}function OY({el:t,key:e,maskAttributes:n,maskAllText:r,privacyOptions:i,value:s}){return!r||i.unmaskTextSelector&&t.matches(i.unmaskTextSelector)?s:n.includes(e)||e==="value"&&t.tagName==="INPUT"&&["submit","button"].includes(t.getAttribute("type")||"")?s.replace(/[\S]/g,"*"):s}const P_='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',AY=["content-length","content-type","accept"];let x_=!1;class zm{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=yq,flushMaxDelay:n=Sq,minReplayDuration:r=_q,maxReplayDuration:i=f_,stickySession:s=!0,useCompression:o=!0,workerUrl:a,_experiments:c={},sessionSampleRate:l,errorSampleRate:u,maskAllText:d=!0,maskAllInputs:f=!0,blockAllMedia:h=!0,mutationBreadcrumbLimit:p=750,mutationLimit:m=1e4,slowClickTimeout:w=7e3,slowClickIgnoreSelectors:g=[],networkDetailAllowUrls:v=[],networkDetailDenyUrls:b=[],networkCaptureBodies:C=!0,networkRequestHeaders:T=[],networkResponseHeaders:k=[],mask:I=[],maskAttributes:R=["title","placeholder"],unmask:N=[],block:M=[],unblock:L=[],ignore:F=[],maskFn:W,beforeAddRecordingEvent:z,beforeErrorSampling:Y,blockClass:K,blockSelector:re,maskInputOptions:H,maskTextClass:ee,maskTextSelector:oe,ignoreClass:q}={}){this.name=zm.id;const ie=MY({mask:I,unmask:N,block:M,unblock:L,ignore:F,blockClass:K,blockSelector:re,maskTextClass:ee,maskTextSelector:oe,ignoreClass:q});if(this._recordingOptions={maskAllInputs:f,maskAllText:d,maskInputOptions:{...H||{},password:!0},maskTextFn:W,maskInputFn:W,maskAttributeFn:(ke,_e,me)=>OY({maskAttributes:R,maskAllText:d,privacyOptions:ie,key:ke,value:_e,el:me}),...ie,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:ke=>{try{ke.__rrweb__=!0}catch{}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:n,minReplayDuration:Math.min(r,Cq),maxReplayDuration:Math.min(i,f_),stickySession:s,sessionSampleRate:l,errorSampleRate:u,useCompression:o,workerUrl:a,blockAllMedia:h,maskAllInputs:f,maskAllText:d,mutationBreadcrumbLimit:p,mutationLimit:m,slowClickTimeout:w,slowClickIgnoreSelectors:g,networkDetailAllowUrls:v,networkDetailDenyUrls:b,networkCaptureBodies:C,networkRequestHeaders:N_(T),networkResponseHeaders:N_(k),beforeAddRecordingEvent:z,beforeErrorSampling:Y,_experiments:c},typeof l=="number"&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysSessionSampleRate: ${l} })`),this._initialOptions.sessionSampleRate=l),typeof u=="number"&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysOnErrorSampleRate: ${u} })`),this._initialOptions.errorSampleRate=u),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${P_}`:P_),this._isInitialized&&UT())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return x_}set _isInitialized(e){x_=e}setupOnce(){UT()&&(this._setup(),setTimeout(()=>this._initialize()))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:this._replay.recordingMode==="session"}):Promise.resolve()}flush(e){return!this._replay||!this._replay.isEnabled()?Promise.resolve():this._replay.sendBufferedReplayOrFlush(e)}getReplayId(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.getSessionId()}_initialize(){this._replay&&this._replay.initializeSampling()}_setup(){const e=DY(this._initialOptions);this._replay=new Ro({options:e,recordingOptions:this._recordingOptions})}}zm.__initStatic();function DY(t){const e=Ct(),n=e&&e.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...os(t)};return n?(t.sessionSampleRate==null&&t.errorSampleRate==null&&n.replaysSessionSampleRate==null&&n.replaysOnErrorSampleRate==null&&Qa(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}),typeof n.replaysSessionSampleRate=="number"&&(r.sessionSampleRate=n.replaysSessionSampleRate),typeof n.replaysOnErrorSampleRate=="number"&&(r.errorSampleRate=n.replaysOnErrorSampleRate),r):(Qa(()=>{console.warn("SDK client is not available.")}),r)}function N_(t){return[...AY,...t.map(e=>e.toLowerCase())]}function LY(t){const e={_metadata:{},...t};e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.react",packages:[{name:"npm:@sentry/react",version:Dd}],version:Dd},IG(e)}var oO={exports:{}},Je={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var un=typeof Symbol=="function"&&Symbol.for,hb=un?Symbol.for("react.element"):60103,pb=un?Symbol.for("react.portal"):60106,Wm=un?Symbol.for("react.fragment"):60107,Hm=un?Symbol.for("react.strict_mode"):60108,Gm=un?Symbol.for("react.profiler"):60114,qm=un?Symbol.for("react.provider"):60109,Jm=un?Symbol.for("react.context"):60110,mb=un?Symbol.for("react.async_mode"):60111,Km=un?Symbol.for("react.concurrent_mode"):60111,Ym=un?Symbol.for("react.forward_ref"):60112,Xm=un?Symbol.for("react.suspense"):60113,FY=un?Symbol.for("react.suspense_list"):60120,Qm=un?Symbol.for("react.memo"):60115,Zm=un?Symbol.for("react.lazy"):60116,UY=un?Symbol.for("react.block"):60121,BY=un?Symbol.for("react.fundamental"):60117,jY=un?Symbol.for("react.responder"):60118,$Y=un?Symbol.for("react.scope"):60119;function Rr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case hb:switch(t=t.type,t){case mb:case Km:case Wm:case Gm:case Hm:case Xm:return t;default:switch(t=t&&t.$$typeof,t){case Jm:case Ym:case Zm:case Qm:case qm:return t;default:return e}}case pb:return e}}}function aO(t){return Rr(t)===Km}Je.AsyncMode=mb;Je.ConcurrentMode=Km;Je.ContextConsumer=Jm;Je.ContextProvider=qm;Je.Element=hb;Je.ForwardRef=Ym;Je.Fragment=Wm;Je.Lazy=Zm;Je.Memo=Qm;Je.Portal=pb;Je.Profiler=Gm;Je.StrictMode=Hm;Je.Suspense=Xm;Je.isAsyncMode=function(t){return aO(t)||Rr(t)===mb};Je.isConcurrentMode=aO;Je.isContextConsumer=function(t){return Rr(t)===Jm};Je.isContextProvider=function(t){return Rr(t)===qm};Je.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===hb};Je.isForwardRef=function(t){return Rr(t)===Ym};Je.isFragment=function(t){return Rr(t)===Wm};Je.isLazy=function(t){return Rr(t)===Zm};Je.isMemo=function(t){return Rr(t)===Qm};Je.isPortal=function(t){return Rr(t)===pb};Je.isProfiler=function(t){return Rr(t)===Gm};Je.isStrictMode=function(t){return Rr(t)===Hm};Je.isSuspense=function(t){return Rr(t)===Xm};Je.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Wm||t===Km||t===Gm||t===Hm||t===Xm||t===FY||typeof t=="object"&&t!==null&&(t.$$typeof===Zm||t.$$typeof===Qm||t.$$typeof===qm||t.$$typeof===Jm||t.$$typeof===Ym||t.$$typeof===BY||t.$$typeof===jY||t.$$typeof===$Y||t.$$typeof===UY)};Je.typeOf=Rr;oO.exports=Je;var VY=oO.exports,cO=VY,zY={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},WY={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},lO={};lO[cO.ForwardRef]=zY;lO[cO.Memo]=WY;const HY=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function GY(t){const e=t.match(/^([^.]+)/);return e!==null&&parseInt(e[0])>=17}const M_={componentStack:null,error:null,eventId:null};function qY(t,e){const n=new WeakMap;function r(i,s){if(!n.has(i)){if(i.cause)return n.set(i,!0),r(i.cause,s);i.cause=s}}r(t,e)}class gb extends E.Component{constructor(e){super(e),gb.prototype.__init.call(this),this.state=M_,this._openFallbackReportDialog=!0;const n=Ct();n&&n.on&&e.showDialog&&(this._openFallbackReportDialog=!1,n.on("afterSendEvent",r=>{!r.type&&r.event_id===this._lastEventId&&i_({...e.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(e,{componentStack:n}){const{beforeCapture:r,onError:i,showDialog:s,dialogOptions:o}=this.props;VN(a=>{if(GY(E.version)&&Mw(e)){const l=new Error(e.message);l.name=`React ErrorBoundary ${e.name}`,l.stack=n,qY(e,l)}r&&r(a,e,n);const c=Om(e,{captureContext:{contexts:{react:{componentStack:n}}},mechanism:{handled:!1}});i&&i(e,n,c),s&&(this._lastEventId=c,this._openFallbackReportDialog&&i_({...o,eventId:c})),this.setState({error:e,componentStack:n,eventId:c})})}componentDidMount(){const{onMount:e}=this.props;e&&e()}componentWillUnmount(){const{error:e,componentStack:n,eventId:r}=this.state,{onUnmount:i}=this.props;i&&i(e,n,r)}__init(){this.resetErrorBoundary=()=>{const{onReset:e}=this.props,{error:n,componentStack:r,eventId:i}=this.state;e&&e(n,r,i),this.setState(M_)}}render(){const{fallback:e,children:n}=this.props,r=this.state;if(r.error){let i;return typeof e=="function"?i=e({error:r.error,componentStack:r.componentStack,resetError:this.resetErrorBoundary,eventId:r.eventId}):i=e,E.isValidElement(i)?i:(e&&HY&&G.warn("fallback did not produce a valid ReactElement"),null)}return typeof n=="function"?n():n}}function JY(){const[t,e]=E.useState(null),[n,r]=E.useState(!1),[i,s]=E.useState([]),o=pt.useRef(null),a=pt.useRef(null),c=E.useRef(!1),l=()=>{o.current&&o.current.saveLog()},u=()=>{o.current&&o.current.clearLog()},d=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return E.useEffect(()=>{if(c.current)return;const f=new BB("mongoose.moo.mud.org",8765);f.registerGMCPPackage(_B),f.registerGMCPPackage(bB),f.registerGMCPPackage(EB),f.registerGMCPPackage(CB),f.registerGMCPPackage(kB),f.registerGMCPPackage(TB),f.registerGMCPPackage(B5),f.registerGMCPPackage($5),f.registerMcpPackage(xB),f.registerMcpPackage(NB),f.registerMcpPackage(OB),f.registerMcpPackage(AB),f.connect(),f.requestNotificationPermission(),e(f),r(!d),window.mudClient=f,c.current=!0;const h=p=>{f&&(p.key==="Control"&&f.cancelSpeech(),p.key==="Escape"&&f.stopAllSounds())};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[d]),E.useEffect(()=>{if(t){const f=p=>{s(p)},h=()=>{s([])};return t.on("userlist",f),t.on("disconnect",h),()=>{t.off("userlist",f),t.off("disconnect",h)}}},[t]),vI(f=>{t&&t.shutdown()}),t?X.jsx(gb,{fallback:X.jsx("p",{children:"An error has occurred"}),children:X.jsxs("div",{className:"App",children:[X.jsx("header",{className:"App-header"}),X.jsx(S6,{client:t,onSaveLog:l,onClearLog:u,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var f;return(f=a.current)==null?void 0:f.open()}}),X.jsxs("div",{children:[X.jsx(I5,{client:t,ref:o}),n&&X.jsx(b6,{users:i}),X.jsx(Oz,{client:t})]}),X.jsx($B,{onSend:f=>t.sendCommand(f)}),X.jsx(w6,{client:t}),X.jsx(u6,{ref:a})]})}):null}function KY(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function A_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?O_(Object(n),!0).forEach(function(r){KY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function YY(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function XY(t,e){if(t==null)return{};var n=YY(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function QY(t,e){return ZY(t)||eX(t,e)||tX(t,e)||nX()}function ZY(t){if(Array.isArray(t))return t}function eX(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,s=void 0;try{for(var o=t[Symbol.iterator](),a;!(r=(a=o.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(c){i=!0,s=c}finally{try{!r&&o.return!=null&&o.return()}finally{if(i)throw s}}return n}}function tX(t,e){if(t){if(typeof t=="string")return D_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D_(t,e)}}function D_(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rX(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function F_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?L_(Object(n),!0).forEach(function(r){rX(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function iX(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,s){return s(i)},r)}}function Fu(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function jp(t){return{}.toString.call(t).includes("Object")}function sX(t){return!Object.keys(t).length}function jd(t){return typeof t=="function"}function oX(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function aX(t,e){return jp(e)||ta("changeType"),Object.keys(e).some(function(n){return!oX(t,n)})&&ta("changeField"),e}function cX(t){jd(t)||ta("selectorType")}function lX(t){jd(t)||jp(t)||ta("handlerType"),jp(t)&&Object.values(t).some(function(e){return!jd(e)})&&ta("handlersType")}function uX(t){t||ta("initialIsRequired"),jp(t)||ta("initialType"),sX(t)&&ta("initialContent")}function dX(t,e){throw new Error(t[e]||t.default)}var fX={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},ta=Fu(dX)(fX),nh={changes:aX,selector:cX,handler:lX,initial:uX};function hX(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};nh.initial(t),nh.handler(e);var n={current:t},r=Fu(gX)(n,e),i=Fu(mX)(n),s=Fu(nh.changes)(t),o=Fu(pX)(n);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return nh.selector(l),l(n.current)}function c(l){iX(r,i,s,o)(l)}return[a,c]}function pX(t,e){return jd(e)?e(t.current):e}function mX(t,e){return t.current=F_(F_({},t.current),e),e}function gX(t,e,n){return jd(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var vX={create:hX},yX={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function SX(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function wX(t){return{}.toString.call(t).includes("Object")}function bX(t){return t||U_("configIsRequired"),wX(t)||U_("configType"),t.urls?(EX(),{paths:{vs:t.urls.monacoBase}}):t}function EX(){console.warn(uO.deprecation)}function kX(t,e){throw new Error(t[e]||t.default)}var uO={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},U_=SX(kX)(uO),TX={config:bX},_X=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(s,o){return o(s)},i)}};function dO(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],dO(t[n],e[n]))}),A_(A_({},t),e)}var CX={type:"cancelation",msg:"operation is manually canceled"};function fv(t){var e=!1,n=new Promise(function(r,i){t.then(function(s){return e?i(CX):r(s)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var IX=vX.create({config:yX,isInitialized:!1,resolve:null,reject:null,monaco:null}),fO=QY(IX,2),vf=fO[0],eg=fO[1];function RX(t){var e=TX.config(t),n=e.monaco,r=XY(e,["monaco"]);eg(function(i){return{config:dO(i.config,r),monaco:n}})}function PX(){var t=vf(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(eg({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),fv(hv);if(window.monaco&&window.monaco.editor)return hO(window.monaco),t.resolve(window.monaco),fv(hv);_X(xX,MX)(OX)}return fv(hv)}function xX(t){return document.body.appendChild(t)}function NX(t){var e=document.createElement("script");return t&&(e.src=t),e}function MX(t){var e=vf(function(r){var i=r.config,s=r.reject;return{config:i,reject:s}}),n=NX("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function OX(){var t=vf(function(n){var r=n.config,i=n.resolve,s=n.reject;return{config:r,resolve:i,reject:s}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){hO(n),t.resolve(n)},function(n){t.reject(n)})}function hO(t){vf().monaco||eg({monaco:t})}function AX(){return vf(function(t){var e=t.monaco;return e})}var hv=new Promise(function(t,e){return eg({resolve:t,reject:e})}),pO={config:RX,init:PX,__getMonacoInstance:AX},DX={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},pv=DX,LX={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},FX=LX;function UX({children:t}){return pt.createElement("div",{style:FX.container},t)}var BX=UX,jX=BX;function $X({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:s,wrapperProps:o}){return pt.createElement("section",{style:{...pv.wrapper,width:t,height:e},...o},!n&&pt.createElement(jX,null,r),pt.createElement("div",{ref:i,style:{...pv.fullWidth,...!n&&pv.hide},className:s}))}var VX=$X,mO=E.memo(VX);function zX(t){E.useEffect(t,[])}var gO=zX;function WX(t,e,n=!0){let r=E.useRef(!0);E.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var gr=WX;function rd(){}function Gc(t,e,n,r){return HX(t,r)||GX(t,e,n,r)}function HX(t,e){return t.editor.getModel(vO(t,e))}function GX(t,e,n,r){return t.editor.createModel(e,n,r?vO(t,r):void 0)}function vO(t,e){return t.Uri.parse(e)}function qX({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:c=!1,theme:l="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:m={},beforeMount:w=rd,onMount:g=rd}){let[v,b]=E.useState(!1),[C,T]=E.useState(!0),k=E.useRef(null),I=E.useRef(null),R=E.useRef(null),N=E.useRef(g),M=E.useRef(w),L=E.useRef(!1);gO(()=>{let Y=pO.init();return Y.then(K=>(I.current=K)&&T(!1)).catch(K=>(K==null?void 0:K.type)!=="cancelation"&&console.error("Monaco initialization: error:",K)),()=>k.current?z():Y.cancel()}),gr(()=>{if(k.current&&I.current){let Y=k.current.getOriginalEditor(),K=Gc(I.current,t||"",r||n||"text",s||"");K!==Y.getModel()&&Y.setModel(K)}},[s],v),gr(()=>{if(k.current&&I.current){let Y=k.current.getModifiedEditor(),K=Gc(I.current,e||"",i||n||"text",o||"");K!==Y.getModel()&&Y.setModel(K)}},[o],v),gr(()=>{let Y=k.current.getModifiedEditor();Y.getOption(I.current.editor.EditorOption.readOnly)?Y.setValue(e||""):e!==Y.getValue()&&(Y.executeEdits("",[{range:Y.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),Y.pushUndoStop())},[e],v),gr(()=>{var Y,K;(K=(Y=k.current)==null?void 0:Y.getModel())==null||K.original.setValue(t||"")},[t],v),gr(()=>{let{original:Y,modified:K}=k.current.getModel();I.current.editor.setModelLanguage(Y,r||n||"text"),I.current.editor.setModelLanguage(K,i||n||"text")},[n,r,i],v),gr(()=>{var Y;(Y=I.current)==null||Y.editor.setTheme(l)},[l],v),gr(()=>{var Y;(Y=k.current)==null||Y.updateOptions(d)},[d],v);let F=E.useCallback(()=>{var re;if(!I.current)return;M.current(I.current);let Y=Gc(I.current,t||"",r||n||"text",s||""),K=Gc(I.current,e||"",i||n||"text",o||"");(re=k.current)==null||re.setModel({original:Y,modified:K})},[n,e,i,t,r,s,o]),W=E.useCallback(()=>{var Y;!L.current&&R.current&&(k.current=I.current.editor.createDiffEditor(R.current,{automaticLayout:!0,...d}),F(),(Y=I.current)==null||Y.editor.setTheme(l),b(!0),L.current=!0)},[d,l,F]);E.useEffect(()=>{v&&N.current(k.current,I.current)},[v]),E.useEffect(()=>{!C&&!v&&W()},[C,v,W]);function z(){var K,re,H,ee;let Y=(K=k.current)==null?void 0:K.getModel();a||((re=Y==null?void 0:Y.original)==null||re.dispose()),c||((H=Y==null?void 0:Y.modified)==null||H.dispose()),(ee=k.current)==null||ee.dispose()}return pt.createElement(mO,{width:h,height:f,isEditorReady:v,loading:u,_ref:R,className:p,wrapperProps:m})}var JX=qX;E.memo(JX);function KX(t){let e=E.useRef();return E.useEffect(()=>{e.current=t},[t]),e.current}var YX=KX,rh=new Map;function XX({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:s,theme:o="light",line:a,loading:c="Loading...",options:l={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:m,wrapperProps:w={},beforeMount:g=rd,onMount:v=rd,onChange:b,onValidate:C=rd}){let[T,k]=E.useState(!1),[I,R]=E.useState(!0),N=E.useRef(null),M=E.useRef(null),L=E.useRef(null),F=E.useRef(v),W=E.useRef(g),z=E.useRef(),Y=E.useRef(r),K=YX(s),re=E.useRef(!1),H=E.useRef(!1);gO(()=>{let q=pO.init();return q.then(ie=>(N.current=ie)&&R(!1)).catch(ie=>(ie==null?void 0:ie.type)!=="cancelation"&&console.error("Monaco initialization: error:",ie)),()=>M.current?oe():q.cancel()}),gr(()=>{var ie,ke,_e,me;let q=Gc(N.current,t||r||"",e||i||"",s||n||"");q!==((ie=M.current)==null?void 0:ie.getModel())&&(d&&rh.set(K,(ke=M.current)==null?void 0:ke.saveViewState()),(_e=M.current)==null||_e.setModel(q),d&&((me=M.current)==null||me.restoreViewState(rh.get(s))))},[s],T),gr(()=>{var q;(q=M.current)==null||q.updateOptions(l)},[l],T),gr(()=>{!M.current||r===void 0||(M.current.getOption(N.current.editor.EditorOption.readOnly)?M.current.setValue(r):r!==M.current.getValue()&&(H.current=!0,M.current.executeEdits("",[{range:M.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),M.current.pushUndoStop(),H.current=!1))},[r],T),gr(()=>{var ie,ke;let q=(ie=M.current)==null?void 0:ie.getModel();q&&i&&((ke=N.current)==null||ke.editor.setModelLanguage(q,i))},[i],T),gr(()=>{var q;a!==void 0&&((q=M.current)==null||q.revealLine(a))},[a],T),gr(()=>{var q;(q=N.current)==null||q.editor.setTheme(o)},[o],T);let ee=E.useCallback(()=>{var q;if(!(!L.current||!N.current)&&!re.current){W.current(N.current);let ie=s||n,ke=Gc(N.current,r||t||"",e||i||"",ie||"");M.current=(q=N.current)==null?void 0:q.editor.create(L.current,{model:ke,automaticLayout:!0,...l},u),d&&M.current.restoreViewState(rh.get(ie)),N.current.editor.setTheme(o),a!==void 0&&M.current.revealLine(a),k(!0),re.current=!0}},[t,e,n,r,i,s,l,u,d,o,a]);E.useEffect(()=>{T&&F.current(M.current,N.current)},[T]),E.useEffect(()=>{!I&&!T&&ee()},[I,T,ee]),Y.current=r,E.useEffect(()=>{var q,ie;T&&b&&((q=z.current)==null||q.dispose(),z.current=(ie=M.current)==null?void 0:ie.onDidChangeModelContent(ke=>{H.current||b(M.current.getValue(),ke)}))},[T,b]),E.useEffect(()=>{if(T){let q=N.current.editor.onDidChangeMarkers(ie=>{var _e;let ke=(_e=M.current.getModel())==null?void 0:_e.uri;if(ke&&ie.find(me=>me.path===ke.path)){let me=N.current.editor.getModelMarkers({resource:ke});C==null||C(me)}});return()=>{q==null||q.dispose()}}return()=>{}},[T,C]);function oe(){var q,ie;(q=z.current)==null||q.dispose(),f?d&&rh.set(s,M.current.saveViewState()):(ie=M.current.getModel())==null||ie.dispose(),M.current.dispose()}return pt.createElement(mO,{width:h,height:p,isEditorReady:T,loading:c,_ref:L,className:m,wrapperProps:w})}var QX=XX,ZX=E.memo(QX),eQ=ZX,tQ={restoreOnUnmount:!1};function nQ(t,e){e===void 0&&(e=tQ);var n=E.useRef(document.title);document.title!==t&&(document.title=t),E.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const rQ=typeof document<"u"?nQ:function(t){};function iQ(){const t=gI(),e=pt.useRef(null),[n,r]=E.useState(""),[i,s]=E.useState(""),[o,a]=E.useState(""),[c,l]=E.useState(0),[u,d]=E.useState({name:"none",contents:[],reference:"",type:""}),f=(F,W)=>{e.current=F,e.current=F},[h,p]=ha();console.log(h);const m=h.editor.accessibilityMode,w=h.editor.autocompleteEnabled;vI(F=>{T.postMessage({type:"close",id:I}),c===1&&F.preventDefault()});const[g,v]=E.useState(!1),b=g?`${u.name} - Mongoose Editor`:"Mongoose Editor";rQ(b);const C=E.useMemo(()=>{switch(c){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[c]),T=E.useMemo(()=>new BroadcastChannel("editor"),[]),k=new URLSearchParams(t.search),I=decodeURIComponent(k.get("reference")||"");E.useEffect(()=>{if(!I)return;console.log("ID: "+I),console.log("Sending ready message"),T.postMessage({type:"ready",id:I});const F=W=>{if(console.log(W.data),W.data.type==="load"){if(n!=="")return;const z=W.data.session.contents.join(`
`);s(z),a(z),d(W.data.session),l(0),r(W.data.clientId)}else if(W.data.type==="shutdown"){if(W.data.clientId!==n)return;T.close(),window.close()}};return T.addEventListener("message",F),()=>T.removeEventListener("message",F)},[T,n,I]);const R=()=>{s(o),l(0)},N=F=>{const W=i.split(/\r\n|\r|\n/),z={...u,contents:W};T.postMessage({type:"save",session:z,id:I}),l(2),e.current!==null&&e.current.focus(),F.preventDefault()},M=F=>{F!==void 0&&(console.log("Original: "+o),console.log("New: "+F),s(F),F.split(/\r\n|\r|\n/).join(`
`)!==o?l(1):l(0),g||v(!0))},L=()=>{const F=new Blob([i],{type:"text/plain"}),W=URL.createObjectURL(F),z=document.createElement("a"),Y=new Date,K=Y.toLocaleDateString().replace(/\//g,"-"),re=Y.toLocaleTimeString().replace(/:/g,"-"),H=`${u.name}-${K}-${re}.txt`;z.download=H,z.href=W,z.click(),URL.revokeObjectURL(W),z.remove()};return X.jsxs(X.Fragment,{children:[X.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:X.jsxs("form",{onSubmit:F=>F.preventDefault(),children:[X.jsxs("button",{onClick:N,accessKey:"s",children:[X.jsx(WR,{}),"Save"]}),X.jsxs("button",{onClick:R,accessKey:"r",children:[X.jsx(g6,{}),"Revert"]}),X.jsxs("button",{onClick:L,accessKey:"d",children:[X.jsx(p6,{}),"Download"]})]})}),X.jsx(eQ,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:M,options:{wordWrap:"on",accessibilitySupport:m?"on":"off",quickSuggestions:w},onMount:f}),X.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[X.jsx("span",{children:C}),X.jsx("span",{children:"|"}),X.jsx("span",{children:u.reference}),X.jsx("span",{children:"|"}),X.jsx("span",{children:u.type})]})]})}const sQ="modulepreload",oQ=function(t){return"/"+t},B_={},aQ=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link");i=Promise.all(n.map(o=>{if(o=oQ(o),o in B_)return;B_[o]=!0;const a=o.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":sQ,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}return i.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},cQ=t=>{t&&t instanceof Function&&aQ(()=>import("./web-vitals-GXdahIIP.js"),__vite__mapDeps([])).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:s})=>{e(t),n(t),r(t),i(t),s(t)})};var j_={};const lQ=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function uQ(t){if("serviceWorker"in navigator){if(new URL(j_.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${j_.PUBLIC_URL}/service-worker.js`;lQ?(dQ(n,t),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):yO(n,t)})}}function yO(t,e){navigator.serviceWorker.register(t).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(n)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(n)))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function dQ(t,e){fetch(t).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):yO(t,e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}LY({dsn:"https://2356c3ef12dad1afcb30defd749d96f1@new.q-continuum.net/2",integrations:[new pq({tracePropagationTargets:["localhost",/^https:\/\/client\.rustytelephone\.net\//]}),new zm],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});const fQ=o5([{path:"/",element:X.jsx(JY,{})},{path:"/editor",element:X.jsx(iQ,{})}]),hQ=gv.createRoot(document.getElementById("root"));hQ.render(X.jsx(pt.StrictMode,{children:X.jsx(m5,{router:fQ})}));cQ(console.log);uQ()});export default pQ();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
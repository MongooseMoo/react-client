var l_=Object.defineProperty;var hI=n=>{throw TypeError(n)};var c_=(n,e,t)=>e in n?l_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ee=(n,e,t)=>c_(n,typeof e!="symbol"?e+"":e,t),Bm=(n,e,t)=>e.has(n)||hI("Cannot "+t);var Q=(n,e,t)=>(Bm(n,e,"read from private field"),t?t.call(n):e.get(n)),un=(n,e,t)=>e.has(n)?hI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Tt=(n,e,t,r)=>(Bm(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),ut=(n,e,t)=>(Bm(n,e,"access private method"),t);var Kh=(n,e,t,r)=>({set _(i){Tt(n,e,i,t)},get _(){return Q(n,e,r)}});function qw(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(n,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var Om=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dl(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function u_(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var Fm={exports:{}},Nd={},Mm={exports:{}},qt={},pI;function d_(){if(pI)return qt;pI=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function g(L){return L===null||typeof L!="object"?null:(L=p&&L[p]||L["@@iterator"],typeof L=="function"?L:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,y={};function x(L,K,ue){this.props=L,this.context=K,this.refs=y,this.updater=ue||v}x.prototype.isReactComponent={},x.prototype.setState=function(L,K){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,K,"setState")},x.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function I(){}I.prototype=x.prototype;function b(L,K,ue){this.props=L,this.context=K,this.refs=y,this.updater=ue||v}var T=b.prototype=new I;T.constructor=b,C(T,x.prototype),T.isPureReactComponent=!0;var R=Array.isArray,P=Object.prototype.hasOwnProperty,B={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function M(L,K,ue){var he,Ee={},Fe=null,Je=null;if(K!=null)for(he in K.ref!==void 0&&(Je=K.ref),K.key!==void 0&&(Fe=""+K.key),K)P.call(K,he)&&!_.hasOwnProperty(he)&&(Ee[he]=K[he]);var Te=arguments.length-2;if(Te===1)Ee.children=ue;else if(1<Te){for(var ft=Array(Te),Nt=0;Nt<Te;Nt++)ft[Nt]=arguments[Nt+2];Ee.children=ft}if(L&&L.defaultProps)for(he in Te=L.defaultProps,Te)Ee[he]===void 0&&(Ee[he]=Te[he]);return{$$typeof:n,type:L,key:Fe,ref:Je,props:Ee,_owner:B.current}}function H(L,K){return{$$typeof:n,type:L.type,key:K,ref:L.ref,props:L.props,_owner:L._owner}}function V(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function U(L){var K={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ue){return K[ue]})}var Z=/\/+/g;function q(L,K){return typeof L=="object"&&L!==null&&L.key!=null?U(""+L.key):K.toString(36)}function ie(L,K,ue,he,Ee){var Fe=typeof L;(Fe==="undefined"||Fe==="boolean")&&(L=null);var Je=!1;if(L===null)Je=!0;else switch(Fe){case"string":case"number":Je=!0;break;case"object":switch(L.$$typeof){case n:case e:Je=!0}}if(Je)return Je=L,Ee=Ee(Je),L=he===""?"."+q(Je,0):he,R(Ee)?(ue="",L!=null&&(ue=L.replace(Z,"$&/")+"/"),ie(Ee,K,ue,"",function(Nt){return Nt})):Ee!=null&&(V(Ee)&&(Ee=H(Ee,ue+(!Ee.key||Je&&Je.key===Ee.key?"":(""+Ee.key).replace(Z,"$&/")+"/")+L)),K.push(Ee)),1;if(Je=0,he=he===""?".":he+":",R(L))for(var Te=0;Te<L.length;Te++){Fe=L[Te];var ft=he+q(Fe,Te);Je+=ie(Fe,K,ue,ft,Ee)}else if(ft=g(L),typeof ft=="function")for(L=ft.call(L),Te=0;!(Fe=L.next()).done;)Fe=Fe.value,ft=he+q(Fe,Te++),Je+=ie(Fe,K,ue,ft,Ee);else if(Fe==="object")throw K=String(L),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Je}function le(L,K,ue){if(L==null)return L;var he=[],Ee=0;return ie(L,he,"","",function(Fe){return K.call(ue,Fe,Ee++)}),he}function Ce(L){if(L._status===-1){var K=L._result;K=K(),K.then(function(ue){(L._status===0||L._status===-1)&&(L._status=1,L._result=ue)},function(ue){(L._status===0||L._status===-1)&&(L._status=2,L._result=ue)}),L._status===-1&&(L._status=0,L._result=K)}if(L._status===1)return L._result.default;throw L._result}var Re={current:null},de={transition:null},pe={ReactCurrentDispatcher:Re,ReactCurrentBatchConfig:de,ReactCurrentOwner:B};function be(){throw Error("act(...) is not supported in production builds of React.")}return qt.Children={map:le,forEach:function(L,K,ue){le(L,function(){K.apply(this,arguments)},ue)},count:function(L){var K=0;return le(L,function(){K++}),K},toArray:function(L){return le(L,function(K){return K})||[]},only:function(L){if(!V(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},qt.Component=x,qt.Fragment=t,qt.Profiler=i,qt.PureComponent=b,qt.StrictMode=r,qt.Suspense=u,qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pe,qt.act=be,qt.cloneElement=function(L,K,ue){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var he=C({},L.props),Ee=L.key,Fe=L.ref,Je=L._owner;if(K!=null){if(K.ref!==void 0&&(Fe=K.ref,Je=B.current),K.key!==void 0&&(Ee=""+K.key),L.type&&L.type.defaultProps)var Te=L.type.defaultProps;for(ft in K)P.call(K,ft)&&!_.hasOwnProperty(ft)&&(he[ft]=K[ft]===void 0&&Te!==void 0?Te[ft]:K[ft])}var ft=arguments.length-2;if(ft===1)he.children=ue;else if(1<ft){Te=Array(ft);for(var Nt=0;Nt<ft;Nt++)Te[Nt]=arguments[Nt+2];he.children=Te}return{$$typeof:n,type:L.type,key:Ee,ref:Fe,props:he,_owner:Je}},qt.createContext=function(L){return L={$$typeof:a,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:o,_context:L},L.Consumer=L},qt.createElement=M,qt.createFactory=function(L){var K=M.bind(null,L);return K.type=L,K},qt.createRef=function(){return{current:null}},qt.forwardRef=function(L){return{$$typeof:l,render:L}},qt.isValidElement=V,qt.lazy=function(L){return{$$typeof:f,_payload:{_status:-1,_result:L},_init:Ce}},qt.memo=function(L,K){return{$$typeof:d,type:L,compare:K===void 0?null:K}},qt.startTransition=function(L){var K=de.transition;de.transition={};try{L()}finally{de.transition=K}},qt.unstable_act=be,qt.useCallback=function(L,K){return Re.current.useCallback(L,K)},qt.useContext=function(L){return Re.current.useContext(L)},qt.useDebugValue=function(){},qt.useDeferredValue=function(L){return Re.current.useDeferredValue(L)},qt.useEffect=function(L,K){return Re.current.useEffect(L,K)},qt.useId=function(){return Re.current.useId()},qt.useImperativeHandle=function(L,K,ue){return Re.current.useImperativeHandle(L,K,ue)},qt.useInsertionEffect=function(L,K){return Re.current.useInsertionEffect(L,K)},qt.useLayoutEffect=function(L,K){return Re.current.useLayoutEffect(L,K)},qt.useMemo=function(L,K){return Re.current.useMemo(L,K)},qt.useReducer=function(L,K,ue){return Re.current.useReducer(L,K,ue)},qt.useRef=function(L){return Re.current.useRef(L)},qt.useState=function(L){return Re.current.useState(L)},qt.useSyncExternalStore=function(L,K,ue){return Re.current.useSyncExternalStore(L,K,ue)},qt.useTransition=function(){return Re.current.useTransition()},qt.version="18.3.1",qt}var gI;function Df(){return gI||(gI=1,Mm.exports=d_()),Mm.exports}var mI;function f_(){if(mI)return Nd;mI=1;var n=Df(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(l,u,d){var f,p={},g=null,v=null;d!==void 0&&(g=""+d),u.key!==void 0&&(g=""+u.key),u.ref!==void 0&&(v=u.ref);for(f in u)r.call(u,f)&&!o.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:g,ref:v,props:p,_owner:i.current}}return Nd.Fragment=t,Nd.jsx=a,Nd.jsxs=a,Nd}var vI;function h_(){return vI||(vI=1,Fm.exports=f_()),Fm.exports}var oe=h_(),N=Df();const Lt=Dl(N),p_=qw({__proto__:null,default:Lt},[N]);var $h={},Lm={exports:{}},_i={},Um={exports:{}},Vm={},CI;function g_(){return CI||(CI=1,function(n){function e(de,pe){var be=de.length;de.push(pe);e:for(;0<be;){var L=be-1>>>1,K=de[L];if(0<i(K,pe))de[L]=pe,de[be]=K,be=L;else break e}}function t(de){return de.length===0?null:de[0]}function r(de){if(de.length===0)return null;var pe=de[0],be=de.pop();if(be!==pe){de[0]=be;e:for(var L=0,K=de.length,ue=K>>>1;L<ue;){var he=2*(L+1)-1,Ee=de[he],Fe=he+1,Je=de[Fe];if(0>i(Ee,be))Fe<K&&0>i(Je,Ee)?(de[L]=Je,de[Fe]=be,L=Fe):(de[L]=Ee,de[he]=be,L=he);else if(Fe<K&&0>i(Je,be))de[L]=Je,de[Fe]=be,L=Fe;else break e}}return pe}function i(de,pe){var be=de.sortIndex-pe.sortIndex;return be!==0?be:de.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var u=[],d=[],f=1,p=null,g=3,v=!1,C=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(de){for(var pe=t(d);pe!==null;){if(pe.callback===null)r(d);else if(pe.startTime<=de)r(d),pe.sortIndex=pe.expirationTime,e(u,pe);else break;pe=t(d)}}function R(de){if(y=!1,T(de),!C)if(t(u)!==null)C=!0,Ce(P);else{var pe=t(d);pe!==null&&Re(R,pe.startTime-de)}}function P(de,pe){C=!1,y&&(y=!1,I(M),M=-1),v=!0;var be=g;try{for(T(pe),p=t(u);p!==null&&(!(p.expirationTime>pe)||de&&!U());){var L=p.callback;if(typeof L=="function"){p.callback=null,g=p.priorityLevel;var K=L(p.expirationTime<=pe);pe=n.unstable_now(),typeof K=="function"?p.callback=K:p===t(u)&&r(u),T(pe)}else r(u);p=t(u)}if(p!==null)var ue=!0;else{var he=t(d);he!==null&&Re(R,he.startTime-pe),ue=!1}return ue}finally{p=null,g=be,v=!1}}var B=!1,_=null,M=-1,H=5,V=-1;function U(){return!(n.unstable_now()-V<H)}function Z(){if(_!==null){var de=n.unstable_now();V=de;var pe=!0;try{pe=_(!0,de)}finally{pe?q():(B=!1,_=null)}}else B=!1}var q;if(typeof b=="function")q=function(){b(Z)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,le=ie.port2;ie.port1.onmessage=Z,q=function(){le.postMessage(null)}}else q=function(){x(Z,0)};function Ce(de){_=de,B||(B=!0,q())}function Re(de,pe){M=x(function(){de(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(de){de.callback=null},n.unstable_continueExecution=function(){C||v||(C=!0,Ce(P))},n.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<de?Math.floor(1e3/de):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(de){switch(g){case 1:case 2:case 3:var pe=3;break;default:pe=g}var be=g;g=pe;try{return de()}finally{g=be}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(de,pe){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var be=g;g=de;try{return pe()}finally{g=be}},n.unstable_scheduleCallback=function(de,pe,be){var L=n.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?L+be:L):be=L,de){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=be+K,de={id:f++,callback:pe,priorityLevel:de,startTime:be,expirationTime:K,sortIndex:-1},be>L?(de.sortIndex=be,e(d,de),t(u)===null&&de===t(d)&&(y?(I(M),M=-1):y=!0,Re(R,be-L))):(de.sortIndex=K,e(u,de),C||v||(C=!0,Ce(P))),de},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(de){var pe=g;return function(){var be=g;g=pe;try{return de.apply(this,arguments)}finally{g=be}}}}(Vm)),Vm}var yI;function m_(){return yI||(yI=1,Um.exports=g_()),Um.exports}var xI;function v_(){if(xI)return _i;xI=1;var n=Df(),e=m_();function t(s){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+s,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(s,c){a(s,c),a(s+"Capture",c)}function a(s,c){for(i[s]=c,s=0;s<c.length;s++)r.add(c[s])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(s){return u.call(p,s)?!0:u.call(f,s)?!1:d.test(s)?p[s]=!0:(f[s]=!0,!1)}function v(s,c,h,m){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:h!==null?!h.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function C(s,c,h,m){if(c===null||typeof c>"u"||v(s,c,h,m))return!0;if(m)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function y(s,c,h,m,A,E,G){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=A,this.mustUseProperty=h,this.propertyName=s,this.type=c,this.sanitizeURL=E,this.removeEmptyString=G}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){x[s]=new y(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var c=s[0];x[c]=new y(c,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){x[s]=new y(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){x[s]=new y(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){x[s]=new y(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){x[s]=new y(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){x[s]=new y(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){x[s]=new y(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){x[s]=new y(s,5,!1,s.toLowerCase(),null,!1,!1)});var I=/[\-:]([a-z])/g;function b(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var c=s.replace(I,b);x[c]=new y(c,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var c=s.replace(I,b);x[c]=new y(c,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var c=s.replace(I,b);x[c]=new y(c,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){x[s]=new y(s,1,!1,s.toLowerCase(),null,!1,!1)}),x.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){x[s]=new y(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,c,h,m){var A=x.hasOwnProperty(c)?x[c]:null;(A!==null?A.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(C(c,h,A,m)&&(h=null),m||A===null?g(c)&&(h===null?s.removeAttribute(c):s.setAttribute(c,""+h)):A.mustUseProperty?s[A.propertyName]=h===null?A.type===3?!1:"":h:(c=A.attributeName,m=A.attributeNamespace,h===null?s.removeAttribute(c):(A=A.type,h=A===3||A===4&&h===!0?"":""+h,m?s.setAttributeNS(m,c,h):s.setAttribute(c,h))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),B=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),U=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),ie=Symbol.for("react.suspense_list"),le=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),Re=Symbol.for("react.offscreen"),de=Symbol.iterator;function pe(s){return s===null||typeof s!="object"?null:(s=de&&s[de]||s["@@iterator"],typeof s=="function"?s:null)}var be=Object.assign,L;function K(s){if(L===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);L=c&&c[1]||""}return`
`+L+s}var ue=!1;function he(s,c){if(!s||ue)return"";ue=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ke){var m=ke}Reflect.construct(s,[],c)}else{try{c.call()}catch(ke){m=ke}s.call(c.prototype)}else{try{throw Error()}catch(ke){m=ke}s()}}catch(ke){if(ke&&m&&typeof ke.stack=="string"){for(var A=ke.stack.split(`
`),E=m.stack.split(`
`),G=A.length-1,te=E.length-1;1<=G&&0<=te&&A[G]!==E[te];)te--;for(;1<=G&&0<=te;G--,te--)if(A[G]!==E[te]){if(G!==1||te!==1)do if(G--,te--,0>te||A[G]!==E[te]){var ae=`
`+A[G].replace(" at new "," at ");return s.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",s.displayName)),ae}while(1<=G&&0<=te);break}}}finally{ue=!1,Error.prepareStackTrace=h}return(s=s?s.displayName||s.name:"")?K(s):""}function Ee(s){switch(s.tag){case 5:return K(s.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return s=he(s.type,!1),s;case 11:return s=he(s.type.render,!1),s;case 1:return s=he(s.type,!0),s;default:return""}}function Fe(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case _:return"Fragment";case B:return"Portal";case H:return"Profiler";case M:return"StrictMode";case q:return"Suspense";case ie:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case U:return(s.displayName||"Context")+".Consumer";case V:return(s._context.displayName||"Context")+".Provider";case Z:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case le:return c=s.displayName||null,c!==null?c:Fe(s.type)||"Memo";case Ce:c=s._payload,s=s._init;try{return Fe(s(c))}catch{}}return null}function Je(s){var c=s.type;switch(s.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=c.render,s=s.displayName||s.name||"",c.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fe(c);case 8:return c===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Te(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ft(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Nt(s){var c=ft(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),m=""+s[c];if(!s.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var A=h.get,E=h.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return A.call(this)},set:function(G){m=""+G,E.call(this,G)}}),Object.defineProperty(s,c,{enumerable:h.enumerable}),{getValue:function(){return m},setValue:function(G){m=""+G},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function rn(s){s._valueTracker||(s._valueTracker=Nt(s))}function Rt(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var h=c.getValue(),m="";return s&&(m=ft(s)?s.checked?"true":"false":s.value),s=m,s!==h?(c.setValue(s),!0):!1}function yt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Pt(s,c){var h=c.checked;return be({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??s._wrapperState.initialChecked})}function He(s,c){var h=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;h=Te(c.value!=null?c.value:h),s._wrapperState={initialChecked:m,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function $e(s,c){c=c.checked,c!=null&&T(s,"checked",c,!1)}function bt(s,c){$e(s,c);var h=Te(c.value),m=c.type;if(h!=null)m==="number"?(h===0&&s.value===""||s.value!=h)&&(s.value=""+h):s.value!==""+h&&(s.value=""+h);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}c.hasOwnProperty("value")?ct(s,c.type,h):c.hasOwnProperty("defaultValue")&&ct(s,c.type,Te(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(s.defaultChecked=!!c.defaultChecked)}function xt(s,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+s._wrapperState.initialValue,h||c===s.value||(s.value=c),s.defaultValue=c}h=s.name,h!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,h!==""&&(s.name=h)}function ct(s,c,h){(c!=="number"||yt(s.ownerDocument)!==s)&&(h==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+h&&(s.defaultValue=""+h))}var At=Array.isArray;function Ut(s,c,h,m){if(s=s.options,c){c={};for(var A=0;A<h.length;A++)c["$"+h[A]]=!0;for(h=0;h<s.length;h++)A=c.hasOwnProperty("$"+s[h].value),s[h].selected!==A&&(s[h].selected=A),A&&m&&(s[h].defaultSelected=!0)}else{for(h=""+Te(h),c=null,A=0;A<s.length;A++){if(s[A].value===h){s[A].selected=!0,m&&(s[A].defaultSelected=!0);return}c!==null||s[A].disabled||(c=s[A])}c!==null&&(c.selected=!0)}}function kt(s,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return be({},c,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function jt(s,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(t(92));if(At(h)){if(1<h.length)throw Error(t(93));h=h[0]}c=h}c==null&&(c=""),h=c}s._wrapperState={initialValue:Te(h)}}function fn(s,c){var h=Te(c.value),m=Te(c.defaultValue);h!=null&&(h=""+h,h!==s.value&&(s.value=h),c.defaultValue==null&&s.defaultValue!==h&&(s.defaultValue=h)),m!=null&&(s.defaultValue=""+m)}function sn(s){var c=s.textContent;c===s._wrapperState.initialValue&&c!==""&&c!==null&&(s.value=c)}function yn(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function W(s,c){return s==null||s==="http://www.w3.org/1999/xhtml"?yn(c):s==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var k,D=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,m,A){MSApp.execUnsafeLocalFunction(function(){return s(c,h,m,A)})}:s}(function(s,c){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=c;else{for(k=k||document.createElement("div"),k.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=k.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;c.firstChild;)s.appendChild(c.firstChild)}});function X(s,c){if(c){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=c;return}}s.textContent=c}var se={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xe=["Webkit","ms","Moz","O"];Object.keys(se).forEach(function(s){xe.forEach(function(c){c=c+s.charAt(0).toUpperCase()+s.substring(1),se[c]=se[s]})});function _e(s,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||se.hasOwnProperty(s)&&se[s]?(""+c).trim():c+"px"}function mt(s,c){s=s.style;for(var h in c)if(c.hasOwnProperty(h)){var m=h.indexOf("--")===0,A=_e(h,c[h],m);h==="float"&&(h="cssFloat"),m?s.setProperty(h,A):s[h]=A}}var Zt=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xt(s,c){if(c){if(Zt[s]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Yt(s,c){if(s.indexOf("-")===-1)return typeof c.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zt=null;function xn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ir=null,qn=null,Bt=null;function Mr(s){if(s=Cd(s)){if(typeof ir!="function")throw Error(t(280));var c=s.stateNode;c&&(c=ch(c),ir(s.stateNode,s.type,c))}}function Lr(s){qn?Bt?Bt.push(s):Bt=[s]:qn=s}function an(){if(qn){var s=qn,c=Bt;if(Bt=qn=null,Mr(s),c)for(s=0;s<c.length;s++)Mr(c[s])}}function Rn(s,c){return s(c)}function Cr(){}var zn=!1;function Ur(s,c,h){if(zn)return s(c,h);zn=!0;try{return Rn(s,c,h)}finally{zn=!1,(qn!==null||Bt!==null)&&(Cr(),an())}}function yr(s,c){var h=s.stateNode;if(h===null)return null;var m=ch(h);if(m===null)return null;h=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(t(231,c,typeof h));return h}var re=!1;if(l)try{var ce={};Object.defineProperty(ce,"passive",{get:function(){re=!0}}),window.addEventListener("test",ce,ce),window.removeEventListener("test",ce,ce)}catch{re=!1}function ve(s,c,h,m,A,E,G,te,ae){var ke=Array.prototype.slice.call(arguments,3);try{c.apply(h,ke)}catch(Ve){this.onError(Ve)}}var Oe=!1,Ze=null,st=!1,gt=null,nt={onError:function(s){Oe=!0,Ze=s}};function Ye(s,c,h,m,A,E,G,te,ae){Oe=!1,Ze=null,ve.apply(nt,arguments)}function et(s,c,h,m,A,E,G,te,ae){if(Ye.apply(this,arguments),Oe){if(Oe){var ke=Ze;Oe=!1,Ze=null}else throw Error(t(198));st||(st=!0,gt=ke)}}function rt(s){var c=s,h=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(h=c.return),s=c.return;while(s)}return c.tag===3?h:null}function It(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function Gt(s){if(rt(s)!==s)throw Error(t(188))}function kn(s){var c=s.alternate;if(!c){if(c=rt(s),c===null)throw Error(t(188));return c!==s?null:s}for(var h=s,m=c;;){var A=h.return;if(A===null)break;var E=A.alternate;if(E===null){if(m=A.return,m!==null){h=m;continue}break}if(A.child===E.child){for(E=A.child;E;){if(E===h)return Gt(A),s;if(E===m)return Gt(A),c;E=E.sibling}throw Error(t(188))}if(h.return!==m.return)h=A,m=E;else{for(var G=!1,te=A.child;te;){if(te===h){G=!0,h=A,m=E;break}if(te===m){G=!0,m=A,h=E;break}te=te.sibling}if(!G){for(te=E.child;te;){if(te===h){G=!0,h=E,m=A;break}if(te===m){G=!0,m=E,h=A;break}te=te.sibling}if(!G)throw Error(t(189))}}if(h.alternate!==m)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?s:c}function je(s){return s=kn(s),s!==null?ne(s):null}function ne(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var c=ne(s);if(c!==null)return c;s=s.sibling}return null}var De=e.unstable_scheduleCallback,tt=e.unstable_cancelCallback,Qt=e.unstable_shouldYield,ln=e.unstable_requestPaint,Ct=e.unstable_now,tn=e.unstable_getCurrentPriorityLevel,Vn=e.unstable_ImmediatePriority,Xn=e.unstable_UserBlockingPriority,lr=e.unstable_NormalPriority,In=e.unstable_LowPriority,Ot=e.unstable_IdlePriority,Jt=null,Kn=null;function ei(s){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(Jt,s,void 0,(s.current.flags&128)===128)}catch{}}var $t=Math.clz32?Math.clz32:Hs,vi=Math.log,ns=Math.LN2;function Hs(s){return s>>>=0,s===0?32:31-(vi(s)/ns|0)|0}var mo=64,Zs=4194304;function rs(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function is(s,c){var h=s.pendingLanes;if(h===0)return 0;var m=0,A=s.suspendedLanes,E=s.pingedLanes,G=h&268435455;if(G!==0){var te=G&~A;te!==0?m=rs(te):(E&=G,E!==0&&(m=rs(E)))}else G=h&~A,G!==0?m=rs(G):E!==0&&(m=rs(E));if(m===0)return 0;if(c!==0&&c!==m&&(c&A)===0&&(A=m&-m,E=c&-c,A>=E||A===16&&(E&4194240)!==0))return c;if((m&4)!==0&&(m|=h&16),c=s.entangledLanes,c!==0)for(s=s.entanglements,c&=m;0<c;)h=31-$t(c),A=1<<h,m|=s[h],c&=~A;return m}function w(s,c){switch(s){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F(s,c){for(var h=s.suspendedLanes,m=s.pingedLanes,A=s.expirationTimes,E=s.pendingLanes;0<E;){var G=31-$t(E),te=1<<G,ae=A[G];ae===-1?((te&h)===0||(te&m)!==0)&&(A[G]=w(te,c)):ae<=c&&(s.expiredLanes|=te),E&=~te}}function z(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Y(){var s=mo;return mo<<=1,(mo&4194240)===0&&(mo=64),s}function Ae(s){for(var c=[],h=0;31>h;h++)c.push(s);return c}function me(s,c,h){s.pendingLanes|=c,c!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,c=31-$t(c),s[c]=h}function Pe(s,c){var h=s.pendingLanes&~c;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=c,s.mutableReadLanes&=c,s.entangledLanes&=c,c=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<h;){var A=31-$t(h),E=1<<A;c[A]=0,m[A]=-1,s[A]=-1,h&=~E}}function Ke(s,c){var h=s.entangledLanes|=c;for(s=s.entanglements;h;){var m=31-$t(h),A=1<<m;A&c|s[m]&c&&(s[m]|=c),h&=~A}}var qe=0;function _t(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Vt,bn,Ci,yi,Vr,vo=!1,xi=[],Ii=null,Gr=null,Vi=null,bi=new Map,os=new Map,ss=[],fg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kf(s,c){switch(s){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":Vi=null;break;case"pointerover":case"pointerout":bi.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":os.delete(c.pointerId)}}function Ul(s,c,h,m,A,E){return s===null||s.nativeEvent!==E?(s={blockedOn:c,domEventName:h,eventSystemFlags:m,nativeEvent:E,targetContainers:[A]},c!==null&&(c=Cd(c),c!==null&&bn(c)),s):(s.eventSystemFlags|=m,c=s.targetContainers,A!==null&&c.indexOf(A)===-1&&c.push(A),s)}function hg(s,c,h,m,A){switch(c){case"focusin":return Ii=Ul(Ii,s,c,h,m,A),!0;case"dragenter":return Gr=Ul(Gr,s,c,h,m,A),!0;case"mouseover":return Vi=Ul(Vi,s,c,h,m,A),!0;case"pointerover":var E=A.pointerId;return bi.set(E,Ul(bi.get(E)||null,s,c,h,m,A)),!0;case"gotpointercapture":return E=A.pointerId,os.set(E,Ul(os.get(E)||null,s,c,h,m,A)),!0}return!1}function eo(s){var c=Xl(s.target);if(c!==null){var h=rt(c);if(h!==null){if(c=h.tag,c===13){if(c=It(h),c!==null){s.blockedOn=c,Vr(s.priority,function(){Ci(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Za(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var h=Gl(s.domEventName,s.eventSystemFlags,c[0],s.nativeEvent);if(h===null){h=s.nativeEvent;var m=new h.constructor(h.type,h);zt=m,h.target.dispatchEvent(m),zt=null}else return c=Cd(h),c!==null&&bn(c),s.blockedOn=h,!1;c.shift()}return!0}function Vl(s,c,h){Za(s)&&h.delete(c)}function An(){vo=!1,Ii!==null&&Za(Ii)&&(Ii=null),Gr!==null&&Za(Gr)&&(Gr=null),Vi!==null&&Za(Vi)&&(Vi=null),bi.forEach(Vl),os.forEach(Vl)}function Co(s,c){s.blockedOn===c&&(s.blockedOn=null,vo||(vo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,An)))}function as(s){function c(A){return Co(A,s)}if(0<xi.length){Co(xi[0],s);for(var h=1;h<xi.length;h++){var m=xi[h];m.blockedOn===s&&(m.blockedOn=null)}}for(Ii!==null&&Co(Ii,s),Gr!==null&&Co(Gr,s),Vi!==null&&Co(Vi,s),bi.forEach(c),os.forEach(c),h=0;h<ss.length;h++)m=ss[h],m.blockedOn===s&&(m.blockedOn=null);for(;0<ss.length&&(h=ss[0],h.blockedOn===null);)eo(h),h.blockedOn===null&&ss.shift()}var to=R.ReactCurrentBatchConfig,Gi=!0;function Fc(s,c,h,m){var A=qe,E=to.transition;to.transition=null;try{qe=1,Mc(s,c,h,m)}finally{qe=A,to.transition=E}}function Xs(s,c,h,m){var A=qe,E=to.transition;to.transition=null;try{qe=4,Mc(s,c,h,m)}finally{qe=A,to.transition=E}}function Mc(s,c,h,m){if(Gi){var A=Gl(s,c,h,m);if(A===null)wg(s,c,m,Xa,h),Kf(s,m);else if(hg(A,s,c,h,m))m.stopPropagation();else if(Kf(s,m),c&4&&-1<fg.indexOf(s)){for(;A!==null;){var E=Cd(A);if(E!==null&&Vt(E),E=Gl(s,c,h,m),E===null&&wg(s,c,m,Xa,h),E===A)break;A=E}A!==null&&m.stopPropagation()}else wg(s,c,m,null,h)}}var Xa=null;function Gl(s,c,h,m){if(Xa=null,s=xn(m),s=Xl(s),s!==null)if(c=rt(s),c===null)s=null;else if(h=c.tag,h===13){if(s=It(c),s!==null)return s;s=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null);return Xa=s,null}function nd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tn()){case Vn:return 1;case Xn:return 4;case lr:case In:return 16;case Ot:return 536870912;default:return 16}default:return 16}}var yo=null,Lc=null,Uc=null;function $f(){if(Uc)return Uc;var s,c=Lc,h=c.length,m,A="value"in yo?yo.value:yo.textContent,E=A.length;for(s=0;s<h&&c[s]===A[s];s++);var G=h-s;for(m=1;m<=G&&c[h-m]===A[E-m];m++);return Uc=A.slice(s,1<m?1-m:void 0)}function Ks(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function Wl(){return!0}function jl(){return!1}function Er(s){function c(h,m,A,E,G){this._reactName=h,this._targetInst=A,this.type=m,this.nativeEvent=E,this.target=G,this.currentTarget=null;for(var te in s)s.hasOwnProperty(te)&&(h=s[te],this[te]=h?h(E):E[te]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Wl:jl,this.isPropagationStopped=jl,this}return be(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Wl)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Wl)},persist:function(){},isPersistent:Wl}),c}var Ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$s=Er(Ka),zl=be({},Ka,{view:0,detail:0}),rd=Er(zl),$a,Js,ls,Hl=be({},zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zc,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ls&&(ls&&s.type==="mousemove"?($a=s.screenX-ls.screenX,Js=s.screenY-ls.screenY):Js=$a=0,ls=s),$a)},movementY:function(s){return"movementY"in s?s.movementY:Js}}),id=Er(Hl),Jf=be({},Hl,{dataTransfer:0}),od=Er(Jf),ti=be({},zl,{relatedTarget:0}),Vc=Er(ti),sd=be({},Ka,{animationName:0,elapsedTime:0,pseudoElement:0}),pg=Er(sd),Yf=be({},Ka,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Gc=Er(Yf),qf=be({},Ka,{data:0}),ad=Er(qf),Wc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eh(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Qf[s])?!!c[s]:!1}function zc(){return eh}var ld=be({},zl,{key:function(s){if(s.key){var c=Wc[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=Ks(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?jc[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zc,charCode:function(s){return s.type==="keypress"?Ks(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ks(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),th=Er(ld),S=be({},Hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O=Er(S),j=be({},zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zc}),J=Er(j),Se=be({},Ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ie=Er(Se),Be=be({},Hl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ze=Er(Be),Et=[9,13,27,32],Ht=l&&"CompositionEvent"in window,Ft=null;l&&"documentMode"in document&&(Ft=document.documentMode);var En=l&&"TextEvent"in window&&!Ft,Wr=l&&(!Ht||Ft&&8<Ft&&11>=Ft),Ai=" ",wi=!1;function Zl(s,c){switch(s){case"keyup":return Et.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cd(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var cs=!1;function oR(s,c){switch(s){case"compositionend":return cd(c);case"keypress":return c.which!==32?null:(wi=!0,Ai);case"textInput":return s=c.data,s===Ai&&wi?null:s;default:return null}}function sR(s,c){if(cs)return s==="compositionend"||!Ht&&Zl(s,c)?(s=$f(),Uc=Lc=yo=null,cs=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Wr&&c.locale!=="ko"?null:c.data;default:return null}}var aR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u1(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!aR[s.type]:c==="textarea"}function d1(s,c,h,m){Lr(m),c=sh(c,"onChange"),0<c.length&&(h=new $s("onChange","change",null,h,m),s.push({event:h,listeners:c}))}var ud=null,dd=null;function lR(s){R1(s,0)}function nh(s){var c=$c(s);if(Rt(c))return s}function cR(s,c){if(s==="change")return c}var f1=!1;if(l){var gg;if(l){var mg="oninput"in document;if(!mg){var h1=document.createElement("div");h1.setAttribute("oninput","return;"),mg=typeof h1.oninput=="function"}gg=mg}else gg=!1;f1=gg&&(!document.documentMode||9<document.documentMode)}function p1(){ud&&(ud.detachEvent("onpropertychange",g1),dd=ud=null)}function g1(s){if(s.propertyName==="value"&&nh(dd)){var c=[];d1(c,dd,s,xn(s)),Ur(lR,c)}}function uR(s,c,h){s==="focusin"?(p1(),ud=c,dd=h,ud.attachEvent("onpropertychange",g1)):s==="focusout"&&p1()}function dR(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return nh(dd)}function fR(s,c){if(s==="click")return nh(c)}function hR(s,c){if(s==="input"||s==="change")return nh(c)}function pR(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var xo=typeof Object.is=="function"?Object.is:pR;function fd(s,c){if(xo(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var h=Object.keys(s),m=Object.keys(c);if(h.length!==m.length)return!1;for(m=0;m<h.length;m++){var A=h[m];if(!u.call(c,A)||!xo(s[A],c[A]))return!1}return!0}function m1(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function v1(s,c){var h=m1(s);s=0;for(var m;h;){if(h.nodeType===3){if(m=s+h.textContent.length,s<=c&&m>=c)return{node:h,offset:c-s};s=m}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=m1(h)}}function C1(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?C1(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function y1(){for(var s=window,c=yt();c instanceof s.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)s=c.contentWindow;else break;c=yt(s.document)}return c}function vg(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}function gR(s){var c=y1(),h=s.focusedElem,m=s.selectionRange;if(c!==h&&h&&h.ownerDocument&&C1(h.ownerDocument.documentElement,h)){if(m!==null&&vg(h)){if(c=m.start,s=m.end,s===void 0&&(s=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(s,h.value.length);else if(s=(c=h.ownerDocument||document)&&c.defaultView||window,s.getSelection){s=s.getSelection();var A=h.textContent.length,E=Math.min(m.start,A);m=m.end===void 0?E:Math.min(m.end,A),!s.extend&&E>m&&(A=m,m=E,E=A),A=v1(h,E);var G=v1(h,m);A&&G&&(s.rangeCount!==1||s.anchorNode!==A.node||s.anchorOffset!==A.offset||s.focusNode!==G.node||s.focusOffset!==G.offset)&&(c=c.createRange(),c.setStart(A.node,A.offset),s.removeAllRanges(),E>m?(s.addRange(c),s.extend(G.node,G.offset)):(c.setEnd(G.node,G.offset),s.addRange(c)))}}for(c=[],s=h;s=s.parentNode;)s.nodeType===1&&c.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)s=c[h],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var mR=l&&"documentMode"in document&&11>=document.documentMode,Hc=null,Cg=null,hd=null,yg=!1;function x1(s,c,h){var m=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;yg||Hc==null||Hc!==yt(m)||(m=Hc,"selectionStart"in m&&vg(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),hd&&fd(hd,m)||(hd=m,m=sh(Cg,"onSelect"),0<m.length&&(c=new $s("onSelect","select",null,c,h),s.push({event:c,listeners:m}),c.target=Hc)))}function rh(s,c){var h={};return h[s.toLowerCase()]=c.toLowerCase(),h["Webkit"+s]="webkit"+c,h["Moz"+s]="moz"+c,h}var Zc={animationend:rh("Animation","AnimationEnd"),animationiteration:rh("Animation","AnimationIteration"),animationstart:rh("Animation","AnimationStart"),transitionend:rh("Transition","TransitionEnd")},xg={},I1={};l&&(I1=document.createElement("div").style,"AnimationEvent"in window||(delete Zc.animationend.animation,delete Zc.animationiteration.animation,delete Zc.animationstart.animation),"TransitionEvent"in window||delete Zc.transitionend.transition);function ih(s){if(xg[s])return xg[s];if(!Zc[s])return s;var c=Zc[s],h;for(h in c)if(c.hasOwnProperty(h)&&h in I1)return xg[s]=c[h];return s}var b1=ih("animationend"),A1=ih("animationiteration"),w1=ih("animationstart"),S1=ih("transitionend"),k1=new Map,E1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ja(s,c){k1.set(s,c),o(c,[s])}for(var Ig=0;Ig<E1.length;Ig++){var bg=E1[Ig],vR=bg.toLowerCase(),CR=bg[0].toUpperCase()+bg.slice(1);Ja(vR,"on"+CR)}Ja(b1,"onAnimationEnd"),Ja(A1,"onAnimationIteration"),Ja(w1,"onAnimationStart"),Ja("dblclick","onDoubleClick"),Ja("focusin","onFocus"),Ja("focusout","onBlur"),Ja(S1,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yR=new Set("cancel close invalid load scroll toggle".split(" ").concat(pd));function T1(s,c,h){var m=s.type||"unknown-event";s.currentTarget=h,et(m,c,void 0,s),s.currentTarget=null}function R1(s,c){c=(c&4)!==0;for(var h=0;h<s.length;h++){var m=s[h],A=m.event;m=m.listeners;e:{var E=void 0;if(c)for(var G=m.length-1;0<=G;G--){var te=m[G],ae=te.instance,ke=te.currentTarget;if(te=te.listener,ae!==E&&A.isPropagationStopped())break e;T1(A,te,ke),E=ae}else for(G=0;G<m.length;G++){if(te=m[G],ae=te.instance,ke=te.currentTarget,te=te.listener,ae!==E&&A.isPropagationStopped())break e;T1(A,te,ke),E=ae}}}if(st)throw s=gt,st=!1,gt=null,s}function Nn(s,c){var h=c[_g];h===void 0&&(h=c[_g]=new Set);var m=s+"__bubble";h.has(m)||(_1(c,s,2,!1),h.add(m))}function Ag(s,c,h){var m=0;c&&(m|=4),_1(h,s,m,c)}var oh="_reactListening"+Math.random().toString(36).slice(2);function gd(s){if(!s[oh]){s[oh]=!0,r.forEach(function(h){h!=="selectionchange"&&(yR.has(h)||Ag(h,!1,s),Ag(h,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[oh]||(c[oh]=!0,Ag("selectionchange",!1,c))}}function _1(s,c,h,m){switch(nd(c)){case 1:var A=Fc;break;case 4:A=Xs;break;default:A=Mc}h=A.bind(null,c,h,s),A=void 0,!re||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(A=!0),m?A!==void 0?s.addEventListener(c,h,{capture:!0,passive:A}):s.addEventListener(c,h,!0):A!==void 0?s.addEventListener(c,h,{passive:A}):s.addEventListener(c,h,!1)}function wg(s,c,h,m,A){var E=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var G=m.tag;if(G===3||G===4){var te=m.stateNode.containerInfo;if(te===A||te.nodeType===8&&te.parentNode===A)break;if(G===4)for(G=m.return;G!==null;){var ae=G.tag;if((ae===3||ae===4)&&(ae=G.stateNode.containerInfo,ae===A||ae.nodeType===8&&ae.parentNode===A))return;G=G.return}for(;te!==null;){if(G=Xl(te),G===null)return;if(ae=G.tag,ae===5||ae===6){m=E=G;continue e}te=te.parentNode}}m=m.return}Ur(function(){var ke=E,Ve=xn(h),Ge=[];e:{var Ue=k1.get(s);if(Ue!==void 0){var ot=$s,dt=s;switch(s){case"keypress":if(Ks(h)===0)break e;case"keydown":case"keyup":ot=th;break;case"focusin":dt="focus",ot=Vc;break;case"focusout":dt="blur",ot=Vc;break;case"beforeblur":case"afterblur":ot=Vc;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=id;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=od;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=J;break;case b1:case A1:case w1:ot=pg;break;case S1:ot=Ie;break;case"scroll":ot=rd;break;case"wheel":ot=ze;break;case"copy":case"cut":case"paste":ot=Gc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=O}var ht=(c&4)!==0,Qn=!ht&&s==="scroll",ye=ht?Ue!==null?Ue+"Capture":null:Ue;ht=[];for(var fe=ke,we;fe!==null;){we=fe;var Xe=we.stateNode;if(we.tag===5&&Xe!==null&&(we=Xe,ye!==null&&(Xe=yr(fe,ye),Xe!=null&&ht.push(md(fe,Xe,we)))),Qn)break;fe=fe.return}0<ht.length&&(Ue=new ot(Ue,dt,null,h,Ve),Ge.push({event:Ue,listeners:ht}))}}if((c&7)===0){e:{if(Ue=s==="mouseover"||s==="pointerover",ot=s==="mouseout"||s==="pointerout",Ue&&h!==zt&&(dt=h.relatedTarget||h.fromElement)&&(Xl(dt)||dt[Ys]))break e;if((ot||Ue)&&(Ue=Ve.window===Ve?Ve:(Ue=Ve.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,ot?(dt=h.relatedTarget||h.toElement,ot=ke,dt=dt?Xl(dt):null,dt!==null&&(Qn=rt(dt),dt!==Qn||dt.tag!==5&&dt.tag!==6)&&(dt=null)):(ot=null,dt=ke),ot!==dt)){if(ht=id,Xe="onMouseLeave",ye="onMouseEnter",fe="mouse",(s==="pointerout"||s==="pointerover")&&(ht=O,Xe="onPointerLeave",ye="onPointerEnter",fe="pointer"),Qn=ot==null?Ue:$c(ot),we=dt==null?Ue:$c(dt),Ue=new ht(Xe,fe+"leave",ot,h,Ve),Ue.target=Qn,Ue.relatedTarget=we,Xe=null,Xl(Ve)===ke&&(ht=new ht(ye,fe+"enter",dt,h,Ve),ht.target=we,ht.relatedTarget=Qn,Xe=ht),Qn=Xe,ot&&dt)t:{for(ht=ot,ye=dt,fe=0,we=ht;we;we=Xc(we))fe++;for(we=0,Xe=ye;Xe;Xe=Xc(Xe))we++;for(;0<fe-we;)ht=Xc(ht),fe--;for(;0<we-fe;)ye=Xc(ye),we--;for(;fe--;){if(ht===ye||ye!==null&&ht===ye.alternate)break t;ht=Xc(ht),ye=Xc(ye)}ht=null}else ht=null;ot!==null&&P1(Ge,Ue,ot,ht,!1),dt!==null&&Qn!==null&&P1(Ge,Qn,dt,ht,!0)}}e:{if(Ue=ke?$c(ke):window,ot=Ue.nodeName&&Ue.nodeName.toLowerCase(),ot==="select"||ot==="input"&&Ue.type==="file")var vt=cR;else if(u1(Ue))if(f1)vt=hR;else{vt=dR;var wt=uR}else(ot=Ue.nodeName)&&ot.toLowerCase()==="input"&&(Ue.type==="checkbox"||Ue.type==="radio")&&(vt=fR);if(vt&&(vt=vt(s,ke))){d1(Ge,vt,h,Ve);break e}wt&&wt(s,Ue,ke),s==="focusout"&&(wt=Ue._wrapperState)&&wt.controlled&&Ue.type==="number"&&ct(Ue,"number",Ue.value)}switch(wt=ke?$c(ke):window,s){case"focusin":(u1(wt)||wt.contentEditable==="true")&&(Hc=wt,Cg=ke,hd=null);break;case"focusout":hd=Cg=Hc=null;break;case"mousedown":yg=!0;break;case"contextmenu":case"mouseup":case"dragend":yg=!1,x1(Ge,h,Ve);break;case"selectionchange":if(mR)break;case"keydown":case"keyup":x1(Ge,h,Ve)}var St;if(Ht)e:{switch(s){case"compositionstart":var Mt="onCompositionStart";break e;case"compositionend":Mt="onCompositionEnd";break e;case"compositionupdate":Mt="onCompositionUpdate";break e}Mt=void 0}else cs?Zl(s,h)&&(Mt="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Mt="onCompositionStart");Mt&&(Wr&&h.locale!=="ko"&&(cs||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&cs&&(St=$f()):(yo=Ve,Lc="value"in yo?yo.value:yo.textContent,cs=!0)),wt=sh(ke,Mt),0<wt.length&&(Mt=new ad(Mt,s,null,h,Ve),Ge.push({event:Mt,listeners:wt}),St?Mt.data=St:(St=cd(h),St!==null&&(Mt.data=St)))),(St=En?oR(s,h):sR(s,h))&&(ke=sh(ke,"onBeforeInput"),0<ke.length&&(Ve=new ad("onBeforeInput","beforeinput",null,h,Ve),Ge.push({event:Ve,listeners:ke}),Ve.data=St))}R1(Ge,c)})}function md(s,c,h){return{instance:s,listener:c,currentTarget:h}}function sh(s,c){for(var h=c+"Capture",m=[];s!==null;){var A=s,E=A.stateNode;A.tag===5&&E!==null&&(A=E,E=yr(s,h),E!=null&&m.unshift(md(s,E,A)),E=yr(s,c),E!=null&&m.push(md(s,E,A))),s=s.return}return m}function Xc(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function P1(s,c,h,m,A){for(var E=c._reactName,G=[];h!==null&&h!==m;){var te=h,ae=te.alternate,ke=te.stateNode;if(ae!==null&&ae===m)break;te.tag===5&&ke!==null&&(te=ke,A?(ae=yr(h,E),ae!=null&&G.unshift(md(h,ae,te))):A||(ae=yr(h,E),ae!=null&&G.push(md(h,ae,te)))),h=h.return}G.length!==0&&s.push({event:c,listeners:G})}var xR=/\r\n?/g,IR=/\u0000|\uFFFD/g;function D1(s){return(typeof s=="string"?s:""+s).replace(xR,`
`).replace(IR,"")}function ah(s,c,h){if(c=D1(c),D1(s)!==c&&h)throw Error(t(425))}function lh(){}var Sg=null,kg=null;function Eg(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Tg=typeof setTimeout=="function"?setTimeout:void 0,bR=typeof clearTimeout=="function"?clearTimeout:void 0,N1=typeof Promise=="function"?Promise:void 0,AR=typeof queueMicrotask=="function"?queueMicrotask:typeof N1<"u"?function(s){return N1.resolve(null).then(s).catch(wR)}:Tg;function wR(s){setTimeout(function(){throw s})}function Rg(s,c){var h=c,m=0;do{var A=h.nextSibling;if(s.removeChild(h),A&&A.nodeType===8)if(h=A.data,h==="/$"){if(m===0){s.removeChild(A),as(c);return}m--}else h!=="$"&&h!=="$?"&&h!=="$!"||m++;h=A}while(h);as(c)}function Ya(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return s}function B1(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return s;c--}else h==="/$"&&c++}s=s.previousSibling}return null}var Kc=Math.random().toString(36).slice(2),us="__reactFiber$"+Kc,vd="__reactProps$"+Kc,Ys="__reactContainer$"+Kc,_g="__reactEvents$"+Kc,SR="__reactListeners$"+Kc,kR="__reactHandles$"+Kc;function Xl(s){var c=s[us];if(c)return c;for(var h=s.parentNode;h;){if(c=h[Ys]||h[us]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(s=B1(s);s!==null;){if(h=s[us])return h;s=B1(s)}return c}s=h,h=s.parentNode}return null}function Cd(s){return s=s[us]||s[Ys],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function $c(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function ch(s){return s[vd]||null}var Pg=[],Jc=-1;function qa(s){return{current:s}}function Bn(s){0>Jc||(s.current=Pg[Jc],Pg[Jc]=null,Jc--)}function _n(s,c){Jc++,Pg[Jc]=s.current,s.current=c}var Qa={},jr=qa(Qa),Si=qa(!1),Kl=Qa;function Yc(s,c){var h=s.type.contextTypes;if(!h)return Qa;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var A={},E;for(E in h)A[E]=c[E];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=c,s.__reactInternalMemoizedMaskedChildContext=A),A}function ki(s){return s=s.childContextTypes,s!=null}function uh(){Bn(Si),Bn(jr)}function O1(s,c,h){if(jr.current!==Qa)throw Error(t(168));_n(jr,c),_n(Si,h)}function F1(s,c,h){var m=s.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return h;m=m.getChildContext();for(var A in m)if(!(A in c))throw Error(t(108,Je(s)||"Unknown",A));return be({},h,m)}function dh(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Qa,Kl=jr.current,_n(jr,s),_n(Si,Si.current),!0}function M1(s,c,h){var m=s.stateNode;if(!m)throw Error(t(169));h?(s=F1(s,c,Kl),m.__reactInternalMemoizedMergedChildContext=s,Bn(Si),Bn(jr),_n(jr,s)):Bn(Si),_n(Si,h)}var qs=null,fh=!1,Dg=!1;function L1(s){qs===null?qs=[s]:qs.push(s)}function ER(s){fh=!0,L1(s)}function el(){if(!Dg&&qs!==null){Dg=!0;var s=0,c=qe;try{var h=qs;for(qe=1;s<h.length;s++){var m=h[s];do m=m(!0);while(m!==null)}qs=null,fh=!1}catch(A){throw qs!==null&&(qs=qs.slice(s+1)),De(Vn,el),A}finally{qe=c,Dg=!1}}return null}var qc=[],Qc=0,hh=null,ph=0,no=[],ro=0,$l=null,Qs=1,ea="";function Jl(s,c){qc[Qc++]=ph,qc[Qc++]=hh,hh=s,ph=c}function U1(s,c,h){no[ro++]=Qs,no[ro++]=ea,no[ro++]=$l,$l=s;var m=Qs;s=ea;var A=32-$t(m)-1;m&=~(1<<A),h+=1;var E=32-$t(c)+A;if(30<E){var G=A-A%5;E=(m&(1<<G)-1).toString(32),m>>=G,A-=G,Qs=1<<32-$t(c)+A|h<<A|m,ea=E+s}else Qs=1<<E|h<<A|m,ea=s}function Ng(s){s.return!==null&&(Jl(s,1),U1(s,1,0))}function Bg(s){for(;s===hh;)hh=qc[--Qc],qc[Qc]=null,ph=qc[--Qc],qc[Qc]=null;for(;s===$l;)$l=no[--ro],no[ro]=null,ea=no[--ro],no[ro]=null,Qs=no[--ro],no[ro]=null}var Wi=null,ji=null,Gn=!1,Io=null;function V1(s,c){var h=ao(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=s,c=s.deletions,c===null?(s.deletions=[h],s.flags|=16):c.push(h)}function G1(s,c){switch(s.tag){case 5:var h=s.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(s.stateNode=c,Wi=s,ji=Ya(c.firstChild),!0):!1;case 6:return c=s.pendingProps===""||c.nodeType!==3?null:c,c!==null?(s.stateNode=c,Wi=s,ji=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=$l!==null?{id:Qs,overflow:ea}:null,s.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=ao(18,null,null,0),h.stateNode=c,h.return=s,s.child=h,Wi=s,ji=null,!0):!1;default:return!1}}function Og(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Fg(s){if(Gn){var c=ji;if(c){var h=c;if(!G1(s,c)){if(Og(s))throw Error(t(418));c=Ya(h.nextSibling);var m=Wi;c&&G1(s,c)?V1(m,h):(s.flags=s.flags&-4097|2,Gn=!1,Wi=s)}}else{if(Og(s))throw Error(t(418));s.flags=s.flags&-4097|2,Gn=!1,Wi=s}}}function W1(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Wi=s}function gh(s){if(s!==Wi)return!1;if(!Gn)return W1(s),Gn=!0,!1;var c;if((c=s.tag!==3)&&!(c=s.tag!==5)&&(c=s.type,c=c!=="head"&&c!=="body"&&!Eg(s.type,s.memoizedProps)),c&&(c=ji)){if(Og(s))throw j1(),Error(t(418));for(;c;)V1(s,c),c=Ya(c.nextSibling)}if(W1(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8){var h=s.data;if(h==="/$"){if(c===0){ji=Ya(s.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}s=s.nextSibling}ji=null}}else ji=Wi?Ya(s.stateNode.nextSibling):null;return!0}function j1(){for(var s=ji;s;)s=Ya(s.nextSibling)}function eu(){ji=Wi=null,Gn=!1}function Mg(s){Io===null?Io=[s]:Io.push(s)}var TR=R.ReactCurrentBatchConfig;function yd(s,c,h){if(s=h.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var m=h.stateNode}if(!m)throw Error(t(147,s));var A=m,E=""+s;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===E?c.ref:(c=function(G){var te=A.refs;G===null?delete te[E]:te[E]=G},c._stringRef=E,c)}if(typeof s!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,s))}return s}function mh(s,c){throw s=Object.prototype.toString.call(c),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s))}function z1(s){var c=s._init;return c(s._payload)}function H1(s){function c(ye,fe){if(s){var we=ye.deletions;we===null?(ye.deletions=[fe],ye.flags|=16):we.push(fe)}}function h(ye,fe){if(!s)return null;for(;fe!==null;)c(ye,fe),fe=fe.sibling;return null}function m(ye,fe){for(ye=new Map;fe!==null;)fe.key!==null?ye.set(fe.key,fe):ye.set(fe.index,fe),fe=fe.sibling;return ye}function A(ye,fe){return ye=ll(ye,fe),ye.index=0,ye.sibling=null,ye}function E(ye,fe,we){return ye.index=we,s?(we=ye.alternate,we!==null?(we=we.index,we<fe?(ye.flags|=2,fe):we):(ye.flags|=2,fe)):(ye.flags|=1048576,fe)}function G(ye){return s&&ye.alternate===null&&(ye.flags|=2),ye}function te(ye,fe,we,Xe){return fe===null||fe.tag!==6?(fe=Tm(we,ye.mode,Xe),fe.return=ye,fe):(fe=A(fe,we),fe.return=ye,fe)}function ae(ye,fe,we,Xe){var vt=we.type;return vt===_?Ve(ye,fe,we.props.children,Xe,we.key):fe!==null&&(fe.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===Ce&&z1(vt)===fe.type)?(Xe=A(fe,we.props),Xe.ref=yd(ye,fe,we),Xe.return=ye,Xe):(Xe=Vh(we.type,we.key,we.props,null,ye.mode,Xe),Xe.ref=yd(ye,fe,we),Xe.return=ye,Xe)}function ke(ye,fe,we,Xe){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==we.containerInfo||fe.stateNode.implementation!==we.implementation?(fe=Rm(we,ye.mode,Xe),fe.return=ye,fe):(fe=A(fe,we.children||[]),fe.return=ye,fe)}function Ve(ye,fe,we,Xe,vt){return fe===null||fe.tag!==7?(fe=ic(we,ye.mode,Xe,vt),fe.return=ye,fe):(fe=A(fe,we),fe.return=ye,fe)}function Ge(ye,fe,we){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return fe=Tm(""+fe,ye.mode,we),fe.return=ye,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case P:return we=Vh(fe.type,fe.key,fe.props,null,ye.mode,we),we.ref=yd(ye,null,fe),we.return=ye,we;case B:return fe=Rm(fe,ye.mode,we),fe.return=ye,fe;case Ce:var Xe=fe._init;return Ge(ye,Xe(fe._payload),we)}if(At(fe)||pe(fe))return fe=ic(fe,ye.mode,we,null),fe.return=ye,fe;mh(ye,fe)}return null}function Ue(ye,fe,we,Xe){var vt=fe!==null?fe.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return vt!==null?null:te(ye,fe,""+we,Xe);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case P:return we.key===vt?ae(ye,fe,we,Xe):null;case B:return we.key===vt?ke(ye,fe,we,Xe):null;case Ce:return vt=we._init,Ue(ye,fe,vt(we._payload),Xe)}if(At(we)||pe(we))return vt!==null?null:Ve(ye,fe,we,Xe,null);mh(ye,we)}return null}function ot(ye,fe,we,Xe,vt){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number")return ye=ye.get(we)||null,te(fe,ye,""+Xe,vt);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case P:return ye=ye.get(Xe.key===null?we:Xe.key)||null,ae(fe,ye,Xe,vt);case B:return ye=ye.get(Xe.key===null?we:Xe.key)||null,ke(fe,ye,Xe,vt);case Ce:var wt=Xe._init;return ot(ye,fe,we,wt(Xe._payload),vt)}if(At(Xe)||pe(Xe))return ye=ye.get(we)||null,Ve(fe,ye,Xe,vt,null);mh(fe,Xe)}return null}function dt(ye,fe,we,Xe){for(var vt=null,wt=null,St=fe,Mt=fe=0,br=null;St!==null&&Mt<we.length;Mt++){St.index>Mt?(br=St,St=null):br=St.sibling;var hn=Ue(ye,St,we[Mt],Xe);if(hn===null){St===null&&(St=br);break}s&&St&&hn.alternate===null&&c(ye,St),fe=E(hn,fe,Mt),wt===null?vt=hn:wt.sibling=hn,wt=hn,St=br}if(Mt===we.length)return h(ye,St),Gn&&Jl(ye,Mt),vt;if(St===null){for(;Mt<we.length;Mt++)St=Ge(ye,we[Mt],Xe),St!==null&&(fe=E(St,fe,Mt),wt===null?vt=St:wt.sibling=St,wt=St);return Gn&&Jl(ye,Mt),vt}for(St=m(ye,St);Mt<we.length;Mt++)br=ot(St,ye,Mt,we[Mt],Xe),br!==null&&(s&&br.alternate!==null&&St.delete(br.key===null?Mt:br.key),fe=E(br,fe,Mt),wt===null?vt=br:wt.sibling=br,wt=br);return s&&St.forEach(function(cl){return c(ye,cl)}),Gn&&Jl(ye,Mt),vt}function ht(ye,fe,we,Xe){var vt=pe(we);if(typeof vt!="function")throw Error(t(150));if(we=vt.call(we),we==null)throw Error(t(151));for(var wt=vt=null,St=fe,Mt=fe=0,br=null,hn=we.next();St!==null&&!hn.done;Mt++,hn=we.next()){St.index>Mt?(br=St,St=null):br=St.sibling;var cl=Ue(ye,St,hn.value,Xe);if(cl===null){St===null&&(St=br);break}s&&St&&cl.alternate===null&&c(ye,St),fe=E(cl,fe,Mt),wt===null?vt=cl:wt.sibling=cl,wt=cl,St=br}if(hn.done)return h(ye,St),Gn&&Jl(ye,Mt),vt;if(St===null){for(;!hn.done;Mt++,hn=we.next())hn=Ge(ye,hn.value,Xe),hn!==null&&(fe=E(hn,fe,Mt),wt===null?vt=hn:wt.sibling=hn,wt=hn);return Gn&&Jl(ye,Mt),vt}for(St=m(ye,St);!hn.done;Mt++,hn=we.next())hn=ot(St,ye,Mt,hn.value,Xe),hn!==null&&(s&&hn.alternate!==null&&St.delete(hn.key===null?Mt:hn.key),fe=E(hn,fe,Mt),wt===null?vt=hn:wt.sibling=hn,wt=hn);return s&&St.forEach(function(a_){return c(ye,a_)}),Gn&&Jl(ye,Mt),vt}function Qn(ye,fe,we,Xe){if(typeof we=="object"&&we!==null&&we.type===_&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case P:e:{for(var vt=we.key,wt=fe;wt!==null;){if(wt.key===vt){if(vt=we.type,vt===_){if(wt.tag===7){h(ye,wt.sibling),fe=A(wt,we.props.children),fe.return=ye,ye=fe;break e}}else if(wt.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===Ce&&z1(vt)===wt.type){h(ye,wt.sibling),fe=A(wt,we.props),fe.ref=yd(ye,wt,we),fe.return=ye,ye=fe;break e}h(ye,wt);break}else c(ye,wt);wt=wt.sibling}we.type===_?(fe=ic(we.props.children,ye.mode,Xe,we.key),fe.return=ye,ye=fe):(Xe=Vh(we.type,we.key,we.props,null,ye.mode,Xe),Xe.ref=yd(ye,fe,we),Xe.return=ye,ye=Xe)}return G(ye);case B:e:{for(wt=we.key;fe!==null;){if(fe.key===wt)if(fe.tag===4&&fe.stateNode.containerInfo===we.containerInfo&&fe.stateNode.implementation===we.implementation){h(ye,fe.sibling),fe=A(fe,we.children||[]),fe.return=ye,ye=fe;break e}else{h(ye,fe);break}else c(ye,fe);fe=fe.sibling}fe=Rm(we,ye.mode,Xe),fe.return=ye,ye=fe}return G(ye);case Ce:return wt=we._init,Qn(ye,fe,wt(we._payload),Xe)}if(At(we))return dt(ye,fe,we,Xe);if(pe(we))return ht(ye,fe,we,Xe);mh(ye,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,fe!==null&&fe.tag===6?(h(ye,fe.sibling),fe=A(fe,we),fe.return=ye,ye=fe):(h(ye,fe),fe=Tm(we,ye.mode,Xe),fe.return=ye,ye=fe),G(ye)):h(ye,fe)}return Qn}var tu=H1(!0),Z1=H1(!1),vh=qa(null),Ch=null,nu=null,Lg=null;function Ug(){Lg=nu=Ch=null}function Vg(s){var c=vh.current;Bn(vh),s._currentValue=c}function Gg(s,c,h){for(;s!==null;){var m=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),s===h)break;s=s.return}}function ru(s,c){Ch=s,Lg=nu=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&c)!==0&&(Ei=!0),s.firstContext=null)}function io(s){var c=s._currentValue;if(Lg!==s)if(s={context:s,memoizedValue:c,next:null},nu===null){if(Ch===null)throw Error(t(308));nu=s,Ch.dependencies={lanes:0,firstContext:s}}else nu=nu.next=s;return c}var Yl=null;function Wg(s){Yl===null?Yl=[s]:Yl.push(s)}function X1(s,c,h,m){var A=c.interleaved;return A===null?(h.next=h,Wg(c)):(h.next=A.next,A.next=h),c.interleaved=h,ta(s,m)}function ta(s,c){s.lanes|=c;var h=s.alternate;for(h!==null&&(h.lanes|=c),h=s,s=s.return;s!==null;)s.childLanes|=c,h=s.alternate,h!==null&&(h.childLanes|=c),h=s,s=s.return;return h.tag===3?h.stateNode:null}var tl=!1;function jg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K1(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function na(s,c){return{eventTime:s,lane:c,tag:0,payload:null,callback:null,next:null}}function nl(s,c,h){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(cn&2)!==0){var A=m.pending;return A===null?c.next=c:(c.next=A.next,A.next=c),m.pending=c,ta(s,h)}return A=m.interleaved,A===null?(c.next=c,Wg(m)):(c.next=A.next,A.next=c),m.interleaved=c,ta(s,h)}function yh(s,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var m=c.lanes;m&=s.pendingLanes,h|=m,c.lanes=h,Ke(s,h)}}function $1(s,c){var h=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,h===m)){var A=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var G={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};E===null?A=E=G:E=E.next=G,h=h.next}while(h!==null);E===null?A=E=c:E=E.next=c}else A=E=c;h={baseState:m.baseState,firstBaseUpdate:A,lastBaseUpdate:E,shared:m.shared,effects:m.effects},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=c:s.next=c,h.lastBaseUpdate=c}function xh(s,c,h,m){var A=s.updateQueue;tl=!1;var E=A.firstBaseUpdate,G=A.lastBaseUpdate,te=A.shared.pending;if(te!==null){A.shared.pending=null;var ae=te,ke=ae.next;ae.next=null,G===null?E=ke:G.next=ke,G=ae;var Ve=s.alternate;Ve!==null&&(Ve=Ve.updateQueue,te=Ve.lastBaseUpdate,te!==G&&(te===null?Ve.firstBaseUpdate=ke:te.next=ke,Ve.lastBaseUpdate=ae))}if(E!==null){var Ge=A.baseState;G=0,Ve=ke=ae=null,te=E;do{var Ue=te.lane,ot=te.eventTime;if((m&Ue)===Ue){Ve!==null&&(Ve=Ve.next={eventTime:ot,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var dt=s,ht=te;switch(Ue=c,ot=h,ht.tag){case 1:if(dt=ht.payload,typeof dt=="function"){Ge=dt.call(ot,Ge,Ue);break e}Ge=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=ht.payload,Ue=typeof dt=="function"?dt.call(ot,Ge,Ue):dt,Ue==null)break e;Ge=be({},Ge,Ue);break e;case 2:tl=!0}}te.callback!==null&&te.lane!==0&&(s.flags|=64,Ue=A.effects,Ue===null?A.effects=[te]:Ue.push(te))}else ot={eventTime:ot,lane:Ue,tag:te.tag,payload:te.payload,callback:te.callback,next:null},Ve===null?(ke=Ve=ot,ae=Ge):Ve=Ve.next=ot,G|=Ue;if(te=te.next,te===null){if(te=A.shared.pending,te===null)break;Ue=te,te=Ue.next,Ue.next=null,A.lastBaseUpdate=Ue,A.shared.pending=null}}while(!0);if(Ve===null&&(ae=Ge),A.baseState=ae,A.firstBaseUpdate=ke,A.lastBaseUpdate=Ve,c=A.shared.interleaved,c!==null){A=c;do G|=A.lane,A=A.next;while(A!==c)}else E===null&&(A.shared.lanes=0);ec|=G,s.lanes=G,s.memoizedState=Ge}}function J1(s,c,h){if(s=c.effects,c.effects=null,s!==null)for(c=0;c<s.length;c++){var m=s[c],A=m.callback;if(A!==null){if(m.callback=null,m=h,typeof A!="function")throw Error(t(191,A));A.call(m)}}}var xd={},ds=qa(xd),Id=qa(xd),bd=qa(xd);function ql(s){if(s===xd)throw Error(t(174));return s}function zg(s,c){switch(_n(bd,c),_n(Id,s),_n(ds,xd),s=c.nodeType,s){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:W(null,"");break;default:s=s===8?c.parentNode:c,c=s.namespaceURI||null,s=s.tagName,c=W(c,s)}Bn(ds),_n(ds,c)}function iu(){Bn(ds),Bn(Id),Bn(bd)}function Y1(s){ql(bd.current);var c=ql(ds.current),h=W(c,s.type);c!==h&&(_n(Id,s),_n(ds,h))}function Hg(s){Id.current===s&&(Bn(ds),Bn(Id))}var Hn=qa(0);function Ih(s){for(var c=s;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Zg=[];function Xg(){for(var s=0;s<Zg.length;s++)Zg[s]._workInProgressVersionPrimary=null;Zg.length=0}var bh=R.ReactCurrentDispatcher,Kg=R.ReactCurrentBatchConfig,Ql=0,Zn=null,cr=null,xr=null,Ah=!1,Ad=!1,wd=0,RR=0;function zr(){throw Error(t(321))}function $g(s,c){if(c===null)return!1;for(var h=0;h<c.length&&h<s.length;h++)if(!xo(s[h],c[h]))return!1;return!0}function Jg(s,c,h,m,A,E){if(Ql=E,Zn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,bh.current=s===null||s.memoizedState===null?NR:BR,s=h(m,A),Ad){E=0;do{if(Ad=!1,wd=0,25<=E)throw Error(t(301));E+=1,xr=cr=null,c.updateQueue=null,bh.current=OR,s=h(m,A)}while(Ad)}if(bh.current=kh,c=cr!==null&&cr.next!==null,Ql=0,xr=cr=Zn=null,Ah=!1,c)throw Error(t(300));return s}function Yg(){var s=wd!==0;return wd=0,s}function fs(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?Zn.memoizedState=xr=s:xr=xr.next=s,xr}function oo(){if(cr===null){var s=Zn.alternate;s=s!==null?s.memoizedState:null}else s=cr.next;var c=xr===null?Zn.memoizedState:xr.next;if(c!==null)xr=c,cr=s;else{if(s===null)throw Error(t(310));cr=s,s={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},xr===null?Zn.memoizedState=xr=s:xr=xr.next=s}return xr}function Sd(s,c){return typeof c=="function"?c(s):c}function qg(s){var c=oo(),h=c.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=s;var m=cr,A=m.baseQueue,E=h.pending;if(E!==null){if(A!==null){var G=A.next;A.next=E.next,E.next=G}m.baseQueue=A=E,h.pending=null}if(A!==null){E=A.next,m=m.baseState;var te=G=null,ae=null,ke=E;do{var Ve=ke.lane;if((Ql&Ve)===Ve)ae!==null&&(ae=ae.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),m=ke.hasEagerState?ke.eagerState:s(m,ke.action);else{var Ge={lane:Ve,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};ae===null?(te=ae=Ge,G=m):ae=ae.next=Ge,Zn.lanes|=Ve,ec|=Ve}ke=ke.next}while(ke!==null&&ke!==E);ae===null?G=m:ae.next=te,xo(m,c.memoizedState)||(Ei=!0),c.memoizedState=m,c.baseState=G,c.baseQueue=ae,h.lastRenderedState=m}if(s=h.interleaved,s!==null){A=s;do E=A.lane,Zn.lanes|=E,ec|=E,A=A.next;while(A!==s)}else A===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function Qg(s){var c=oo(),h=c.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=s;var m=h.dispatch,A=h.pending,E=c.memoizedState;if(A!==null){h.pending=null;var G=A=A.next;do E=s(E,G.action),G=G.next;while(G!==A);xo(E,c.memoizedState)||(Ei=!0),c.memoizedState=E,c.baseQueue===null&&(c.baseState=E),h.lastRenderedState=E}return[E,m]}function q1(){}function Q1(s,c){var h=Zn,m=oo(),A=c(),E=!xo(m.memoizedState,A);if(E&&(m.memoizedState=A,Ei=!0),m=m.queue,em(nx.bind(null,h,m,s),[s]),m.getSnapshot!==c||E||xr!==null&&xr.memoizedState.tag&1){if(h.flags|=2048,kd(9,tx.bind(null,h,m,A,c),void 0,null),Ir===null)throw Error(t(349));(Ql&30)!==0||ex(h,c,A)}return A}function ex(s,c,h){s.flags|=16384,s={getSnapshot:c,value:h},c=Zn.updateQueue,c===null?(c={lastEffect:null,stores:null},Zn.updateQueue=c,c.stores=[s]):(h=c.stores,h===null?c.stores=[s]:h.push(s))}function tx(s,c,h,m){c.value=h,c.getSnapshot=m,rx(c)&&ix(s)}function nx(s,c,h){return h(function(){rx(c)&&ix(s)})}function rx(s){var c=s.getSnapshot;s=s.value;try{var h=c();return!xo(s,h)}catch{return!0}}function ix(s){var c=ta(s,1);c!==null&&So(c,s,1,-1)}function ox(s){var c=fs();return typeof s=="function"&&(s=s()),c.memoizedState=c.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sd,lastRenderedState:s},c.queue=s,s=s.dispatch=DR.bind(null,Zn,s),[c.memoizedState,s]}function kd(s,c,h,m){return s={tag:s,create:c,destroy:h,deps:m,next:null},c=Zn.updateQueue,c===null?(c={lastEffect:null,stores:null},Zn.updateQueue=c,c.lastEffect=s.next=s):(h=c.lastEffect,h===null?c.lastEffect=s.next=s:(m=h.next,h.next=s,s.next=m,c.lastEffect=s)),s}function sx(){return oo().memoizedState}function wh(s,c,h,m){var A=fs();Zn.flags|=s,A.memoizedState=kd(1|c,h,void 0,m===void 0?null:m)}function Sh(s,c,h,m){var A=oo();m=m===void 0?null:m;var E=void 0;if(cr!==null){var G=cr.memoizedState;if(E=G.destroy,m!==null&&$g(m,G.deps)){A.memoizedState=kd(c,h,E,m);return}}Zn.flags|=s,A.memoizedState=kd(1|c,h,E,m)}function ax(s,c){return wh(8390656,8,s,c)}function em(s,c){return Sh(2048,8,s,c)}function lx(s,c){return Sh(4,2,s,c)}function cx(s,c){return Sh(4,4,s,c)}function ux(s,c){if(typeof c=="function")return s=s(),c(s),function(){c(null)};if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function dx(s,c,h){return h=h!=null?h.concat([s]):null,Sh(4,4,ux.bind(null,c,s),h)}function tm(){}function fx(s,c){var h=oo();c=c===void 0?null:c;var m=h.memoizedState;return m!==null&&c!==null&&$g(c,m[1])?m[0]:(h.memoizedState=[s,c],s)}function hx(s,c){var h=oo();c=c===void 0?null:c;var m=h.memoizedState;return m!==null&&c!==null&&$g(c,m[1])?m[0]:(s=s(),h.memoizedState=[s,c],s)}function px(s,c,h){return(Ql&21)===0?(s.baseState&&(s.baseState=!1,Ei=!0),s.memoizedState=h):(xo(h,c)||(h=Y(),Zn.lanes|=h,ec|=h,s.baseState=!0),c)}function _R(s,c){var h=qe;qe=h!==0&&4>h?h:4,s(!0);var m=Kg.transition;Kg.transition={};try{s(!1),c()}finally{qe=h,Kg.transition=m}}function gx(){return oo().memoizedState}function PR(s,c,h){var m=sl(s);if(h={lane:m,action:h,hasEagerState:!1,eagerState:null,next:null},mx(s))vx(c,h);else if(h=X1(s,c,h,m),h!==null){var A=ri();So(h,s,m,A),Cx(h,c,m)}}function DR(s,c,h){var m=sl(s),A={lane:m,action:h,hasEagerState:!1,eagerState:null,next:null};if(mx(s))vx(c,A);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=c.lastRenderedReducer,E!==null))try{var G=c.lastRenderedState,te=E(G,h);if(A.hasEagerState=!0,A.eagerState=te,xo(te,G)){var ae=c.interleaved;ae===null?(A.next=A,Wg(c)):(A.next=ae.next,ae.next=A),c.interleaved=A;return}}catch{}finally{}h=X1(s,c,A,m),h!==null&&(A=ri(),So(h,s,m,A),Cx(h,c,m))}}function mx(s){var c=s.alternate;return s===Zn||c!==null&&c===Zn}function vx(s,c){Ad=Ah=!0;var h=s.pending;h===null?c.next=c:(c.next=h.next,h.next=c),s.pending=c}function Cx(s,c,h){if((h&4194240)!==0){var m=c.lanes;m&=s.pendingLanes,h|=m,c.lanes=h,Ke(s,h)}}var kh={readContext:io,useCallback:zr,useContext:zr,useEffect:zr,useImperativeHandle:zr,useInsertionEffect:zr,useLayoutEffect:zr,useMemo:zr,useReducer:zr,useRef:zr,useState:zr,useDebugValue:zr,useDeferredValue:zr,useTransition:zr,useMutableSource:zr,useSyncExternalStore:zr,useId:zr,unstable_isNewReconciler:!1},NR={readContext:io,useCallback:function(s,c){return fs().memoizedState=[s,c===void 0?null:c],s},useContext:io,useEffect:ax,useImperativeHandle:function(s,c,h){return h=h!=null?h.concat([s]):null,wh(4194308,4,ux.bind(null,c,s),h)},useLayoutEffect:function(s,c){return wh(4194308,4,s,c)},useInsertionEffect:function(s,c){return wh(4,2,s,c)},useMemo:function(s,c){var h=fs();return c=c===void 0?null:c,s=s(),h.memoizedState=[s,c],s},useReducer:function(s,c,h){var m=fs();return c=h!==void 0?h(c):c,m.memoizedState=m.baseState=c,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:c},m.queue=s,s=s.dispatch=PR.bind(null,Zn,s),[m.memoizedState,s]},useRef:function(s){var c=fs();return s={current:s},c.memoizedState=s},useState:ox,useDebugValue:tm,useDeferredValue:function(s){return fs().memoizedState=s},useTransition:function(){var s=ox(!1),c=s[0];return s=_R.bind(null,s[1]),fs().memoizedState=s,[c,s]},useMutableSource:function(){},useSyncExternalStore:function(s,c,h){var m=Zn,A=fs();if(Gn){if(h===void 0)throw Error(t(407));h=h()}else{if(h=c(),Ir===null)throw Error(t(349));(Ql&30)!==0||ex(m,c,h)}A.memoizedState=h;var E={value:h,getSnapshot:c};return A.queue=E,ax(nx.bind(null,m,E,s),[s]),m.flags|=2048,kd(9,tx.bind(null,m,E,h,c),void 0,null),h},useId:function(){var s=fs(),c=Ir.identifierPrefix;if(Gn){var h=ea,m=Qs;h=(m&~(1<<32-$t(m)-1)).toString(32)+h,c=":"+c+"R"+h,h=wd++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=RR++,c=":"+c+"r"+h.toString(32)+":";return s.memoizedState=c},unstable_isNewReconciler:!1},BR={readContext:io,useCallback:fx,useContext:io,useEffect:em,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:hx,useReducer:qg,useRef:sx,useState:function(){return qg(Sd)},useDebugValue:tm,useDeferredValue:function(s){var c=oo();return px(c,cr.memoizedState,s)},useTransition:function(){var s=qg(Sd)[0],c=oo().memoizedState;return[s,c]},useMutableSource:q1,useSyncExternalStore:Q1,useId:gx,unstable_isNewReconciler:!1},OR={readContext:io,useCallback:fx,useContext:io,useEffect:em,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:hx,useReducer:Qg,useRef:sx,useState:function(){return Qg(Sd)},useDebugValue:tm,useDeferredValue:function(s){var c=oo();return cr===null?c.memoizedState=s:px(c,cr.memoizedState,s)},useTransition:function(){var s=Qg(Sd)[0],c=oo().memoizedState;return[s,c]},useMutableSource:q1,useSyncExternalStore:Q1,useId:gx,unstable_isNewReconciler:!1};function bo(s,c){if(s&&s.defaultProps){c=be({},c),s=s.defaultProps;for(var h in s)c[h]===void 0&&(c[h]=s[h]);return c}return c}function nm(s,c,h,m){c=s.memoizedState,h=h(m,c),h=h==null?c:be({},c,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Eh={isMounted:function(s){return(s=s._reactInternals)?rt(s)===s:!1},enqueueSetState:function(s,c,h){s=s._reactInternals;var m=ri(),A=sl(s),E=na(m,A);E.payload=c,h!=null&&(E.callback=h),c=nl(s,E,A),c!==null&&(So(c,s,A,m),yh(c,s,A))},enqueueReplaceState:function(s,c,h){s=s._reactInternals;var m=ri(),A=sl(s),E=na(m,A);E.tag=1,E.payload=c,h!=null&&(E.callback=h),c=nl(s,E,A),c!==null&&(So(c,s,A,m),yh(c,s,A))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var h=ri(),m=sl(s),A=na(h,m);A.tag=2,c!=null&&(A.callback=c),c=nl(s,A,m),c!==null&&(So(c,s,m,h),yh(c,s,m))}};function yx(s,c,h,m,A,E,G){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,E,G):c.prototype&&c.prototype.isPureReactComponent?!fd(h,m)||!fd(A,E):!0}function xx(s,c,h){var m=!1,A=Qa,E=c.contextType;return typeof E=="object"&&E!==null?E=io(E):(A=ki(c)?Kl:jr.current,m=c.contextTypes,E=(m=m!=null)?Yc(s,A):Qa),c=new c(h,E),s.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Eh,s.stateNode=c,c._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=A,s.__reactInternalMemoizedMaskedChildContext=E),c}function Ix(s,c,h,m){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,m),c.state!==s&&Eh.enqueueReplaceState(c,c.state,null)}function rm(s,c,h,m){var A=s.stateNode;A.props=h,A.state=s.memoizedState,A.refs={},jg(s);var E=c.contextType;typeof E=="object"&&E!==null?A.context=io(E):(E=ki(c)?Kl:jr.current,A.context=Yc(s,E)),A.state=s.memoizedState,E=c.getDerivedStateFromProps,typeof E=="function"&&(nm(s,c,E,h),A.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(c=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),c!==A.state&&Eh.enqueueReplaceState(A,A.state,null),xh(s,h,A,m),A.state=s.memoizedState),typeof A.componentDidMount=="function"&&(s.flags|=4194308)}function ou(s,c){try{var h="",m=c;do h+=Ee(m),m=m.return;while(m);var A=h}catch(E){A=`
Error generating stack: `+E.message+`
`+E.stack}return{value:s,source:c,stack:A,digest:null}}function im(s,c,h){return{value:s,source:null,stack:h??null,digest:c??null}}function om(s,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var FR=typeof WeakMap=="function"?WeakMap:Map;function bx(s,c,h){h=na(-1,h),h.tag=3,h.payload={element:null};var m=c.value;return h.callback=function(){Bh||(Bh=!0,xm=m),om(s,c)},h}function Ax(s,c,h){h=na(-1,h),h.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var A=c.value;h.payload=function(){return m(A)},h.callback=function(){om(s,c)}}var E=s.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(h.callback=function(){om(s,c),typeof m!="function"&&(il===null?il=new Set([this]):il.add(this));var G=c.stack;this.componentDidCatch(c.value,{componentStack:G!==null?G:""})}),h}function wx(s,c,h){var m=s.pingCache;if(m===null){m=s.pingCache=new FR;var A=new Set;m.set(c,A)}else A=m.get(c),A===void 0&&(A=new Set,m.set(c,A));A.has(h)||(A.add(h),s=JR.bind(null,s,c,h),c.then(s,s))}function Sx(s){do{var c;if((c=s.tag===13)&&(c=s.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return s;s=s.return}while(s!==null);return null}function kx(s,c,h,m,A){return(s.mode&1)===0?(s===c?s.flags|=65536:(s.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=na(-1,1),c.tag=2,nl(h,c,1))),h.lanes|=1),s):(s.flags|=65536,s.lanes=A,s)}var MR=R.ReactCurrentOwner,Ei=!1;function ni(s,c,h,m){c.child=s===null?Z1(c,null,h,m):tu(c,s.child,h,m)}function Ex(s,c,h,m,A){h=h.render;var E=c.ref;return ru(c,A),m=Jg(s,c,h,m,E,A),h=Yg(),s!==null&&!Ei?(c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~A,ra(s,c,A)):(Gn&&h&&Ng(c),c.flags|=1,ni(s,c,m,A),c.child)}function Tx(s,c,h,m,A){if(s===null){var E=h.type;return typeof E=="function"&&!Em(E)&&E.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=E,Rx(s,c,E,m,A)):(s=Vh(h.type,null,m,c,c.mode,A),s.ref=c.ref,s.return=c,c.child=s)}if(E=s.child,(s.lanes&A)===0){var G=E.memoizedProps;if(h=h.compare,h=h!==null?h:fd,h(G,m)&&s.ref===c.ref)return ra(s,c,A)}return c.flags|=1,s=ll(E,m),s.ref=c.ref,s.return=c,c.child=s}function Rx(s,c,h,m,A){if(s!==null){var E=s.memoizedProps;if(fd(E,m)&&s.ref===c.ref)if(Ei=!1,c.pendingProps=m=E,(s.lanes&A)!==0)(s.flags&131072)!==0&&(Ei=!0);else return c.lanes=s.lanes,ra(s,c,A)}return sm(s,c,h,m,A)}function _x(s,c,h){var m=c.pendingProps,A=m.children,E=s!==null?s.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_n(au,zi),zi|=h;else{if((h&1073741824)===0)return s=E!==null?E.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:s,cachePool:null,transitions:null},c.updateQueue=null,_n(au,zi),zi|=s,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=E!==null?E.baseLanes:h,_n(au,zi),zi|=m}else E!==null?(m=E.baseLanes|h,c.memoizedState=null):m=h,_n(au,zi),zi|=m;return ni(s,c,A,h),c.child}function Px(s,c){var h=c.ref;(s===null&&h!==null||s!==null&&s.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function sm(s,c,h,m,A){var E=ki(h)?Kl:jr.current;return E=Yc(c,E),ru(c,A),h=Jg(s,c,h,m,E,A),m=Yg(),s!==null&&!Ei?(c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~A,ra(s,c,A)):(Gn&&m&&Ng(c),c.flags|=1,ni(s,c,h,A),c.child)}function Dx(s,c,h,m,A){if(ki(h)){var E=!0;dh(c)}else E=!1;if(ru(c,A),c.stateNode===null)Rh(s,c),xx(c,h,m),rm(c,h,m,A),m=!0;else if(s===null){var G=c.stateNode,te=c.memoizedProps;G.props=te;var ae=G.context,ke=h.contextType;typeof ke=="object"&&ke!==null?ke=io(ke):(ke=ki(h)?Kl:jr.current,ke=Yc(c,ke));var Ve=h.getDerivedStateFromProps,Ge=typeof Ve=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ge||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(te!==m||ae!==ke)&&Ix(c,G,m,ke),tl=!1;var Ue=c.memoizedState;G.state=Ue,xh(c,m,G,A),ae=c.memoizedState,te!==m||Ue!==ae||Si.current||tl?(typeof Ve=="function"&&(nm(c,h,Ve,m),ae=c.memoizedState),(te=tl||yx(c,h,te,m,Ue,ae,ke))?(Ge||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(c.flags|=4194308)):(typeof G.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=ae),G.props=m,G.state=ae,G.context=ke,m=te):(typeof G.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{G=c.stateNode,K1(s,c),te=c.memoizedProps,ke=c.type===c.elementType?te:bo(c.type,te),G.props=ke,Ge=c.pendingProps,Ue=G.context,ae=h.contextType,typeof ae=="object"&&ae!==null?ae=io(ae):(ae=ki(h)?Kl:jr.current,ae=Yc(c,ae));var ot=h.getDerivedStateFromProps;(Ve=typeof ot=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(te!==Ge||Ue!==ae)&&Ix(c,G,m,ae),tl=!1,Ue=c.memoizedState,G.state=Ue,xh(c,m,G,A);var dt=c.memoizedState;te!==Ge||Ue!==dt||Si.current||tl?(typeof ot=="function"&&(nm(c,h,ot,m),dt=c.memoizedState),(ke=tl||yx(c,h,ke,m,Ue,dt,ae)||!1)?(Ve||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(m,dt,ae),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(m,dt,ae)),typeof G.componentDidUpdate=="function"&&(c.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof G.componentDidUpdate!="function"||te===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||te===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=dt),G.props=m,G.state=dt,G.context=ae,m=ke):(typeof G.componentDidUpdate!="function"||te===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||te===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=1024),m=!1)}return am(s,c,h,m,E,A)}function am(s,c,h,m,A,E){Px(s,c);var G=(c.flags&128)!==0;if(!m&&!G)return A&&M1(c,h,!1),ra(s,c,E);m=c.stateNode,MR.current=c;var te=G&&typeof h.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,s!==null&&G?(c.child=tu(c,s.child,null,E),c.child=tu(c,null,te,E)):ni(s,c,te,E),c.memoizedState=m.state,A&&M1(c,h,!0),c.child}function Nx(s){var c=s.stateNode;c.pendingContext?O1(s,c.pendingContext,c.pendingContext!==c.context):c.context&&O1(s,c.context,!1),zg(s,c.containerInfo)}function Bx(s,c,h,m,A){return eu(),Mg(A),c.flags|=256,ni(s,c,h,m),c.child}var lm={dehydrated:null,treeContext:null,retryLane:0};function cm(s){return{baseLanes:s,cachePool:null,transitions:null}}function Ox(s,c,h){var m=c.pendingProps,A=Hn.current,E=!1,G=(c.flags&128)!==0,te;if((te=G)||(te=s!==null&&s.memoizedState===null?!1:(A&2)!==0),te?(E=!0,c.flags&=-129):(s===null||s.memoizedState!==null)&&(A|=1),_n(Hn,A&1),s===null)return Fg(c),s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((c.mode&1)===0?c.lanes=1:s.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(G=m.children,s=m.fallback,E?(m=c.mode,E=c.child,G={mode:"hidden",children:G},(m&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=G):E=Gh(G,m,0,null),s=ic(s,m,h,null),E.return=c,s.return=c,E.sibling=s,c.child=E,c.child.memoizedState=cm(h),c.memoizedState=lm,s):um(c,G));if(A=s.memoizedState,A!==null&&(te=A.dehydrated,te!==null))return LR(s,c,G,m,te,A,h);if(E){E=m.fallback,G=c.mode,A=s.child,te=A.sibling;var ae={mode:"hidden",children:m.children};return(G&1)===0&&c.child!==A?(m=c.child,m.childLanes=0,m.pendingProps=ae,c.deletions=null):(m=ll(A,ae),m.subtreeFlags=A.subtreeFlags&14680064),te!==null?E=ll(te,E):(E=ic(E,G,h,null),E.flags|=2),E.return=c,m.return=c,m.sibling=E,c.child=m,m=E,E=c.child,G=s.child.memoizedState,G=G===null?cm(h):{baseLanes:G.baseLanes|h,cachePool:null,transitions:G.transitions},E.memoizedState=G,E.childLanes=s.childLanes&~h,c.memoizedState=lm,m}return E=s.child,s=E.sibling,m=ll(E,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=h),m.return=c,m.sibling=null,s!==null&&(h=c.deletions,h===null?(c.deletions=[s],c.flags|=16):h.push(s)),c.child=m,c.memoizedState=null,m}function um(s,c){return c=Gh({mode:"visible",children:c},s.mode,0,null),c.return=s,s.child=c}function Th(s,c,h,m){return m!==null&&Mg(m),tu(c,s.child,null,h),s=um(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function LR(s,c,h,m,A,E,G){if(h)return c.flags&256?(c.flags&=-257,m=im(Error(t(422))),Th(s,c,G,m)):c.memoizedState!==null?(c.child=s.child,c.flags|=128,null):(E=m.fallback,A=c.mode,m=Gh({mode:"visible",children:m.children},A,0,null),E=ic(E,A,G,null),E.flags|=2,m.return=c,E.return=c,m.sibling=E,c.child=m,(c.mode&1)!==0&&tu(c,s.child,null,G),c.child.memoizedState=cm(G),c.memoizedState=lm,E);if((c.mode&1)===0)return Th(s,c,G,null);if(A.data==="$!"){if(m=A.nextSibling&&A.nextSibling.dataset,m)var te=m.dgst;return m=te,E=Error(t(419)),m=im(E,m,void 0),Th(s,c,G,m)}if(te=(G&s.childLanes)!==0,Ei||te){if(m=Ir,m!==null){switch(G&-G){case 4:A=2;break;case 16:A=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:A=32;break;case 536870912:A=268435456;break;default:A=0}A=(A&(m.suspendedLanes|G))!==0?0:A,A!==0&&A!==E.retryLane&&(E.retryLane=A,ta(s,A),So(m,s,A,-1))}return km(),m=im(Error(t(421))),Th(s,c,G,m)}return A.data==="$?"?(c.flags|=128,c.child=s.child,c=YR.bind(null,s),A._reactRetry=c,null):(s=E.treeContext,ji=Ya(A.nextSibling),Wi=c,Gn=!0,Io=null,s!==null&&(no[ro++]=Qs,no[ro++]=ea,no[ro++]=$l,Qs=s.id,ea=s.overflow,$l=c),c=um(c,m.children),c.flags|=4096,c)}function Fx(s,c,h){s.lanes|=c;var m=s.alternate;m!==null&&(m.lanes|=c),Gg(s.return,c,h)}function dm(s,c,h,m,A){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:h,tailMode:A}:(E.isBackwards=c,E.rendering=null,E.renderingStartTime=0,E.last=m,E.tail=h,E.tailMode=A)}function Mx(s,c,h){var m=c.pendingProps,A=m.revealOrder,E=m.tail;if(ni(s,c,m.children,h),m=Hn.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Fx(s,h,c);else if(s.tag===19)Fx(s,h,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(_n(Hn,m),(c.mode&1)===0)c.memoizedState=null;else switch(A){case"forwards":for(h=c.child,A=null;h!==null;)s=h.alternate,s!==null&&Ih(s)===null&&(A=h),h=h.sibling;h=A,h===null?(A=c.child,c.child=null):(A=h.sibling,h.sibling=null),dm(c,!1,A,h,E);break;case"backwards":for(h=null,A=c.child,c.child=null;A!==null;){if(s=A.alternate,s!==null&&Ih(s)===null){c.child=A;break}s=A.sibling,A.sibling=h,h=A,A=s}dm(c,!0,h,null,E);break;case"together":dm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Rh(s,c){(c.mode&1)===0&&s!==null&&(s.alternate=null,c.alternate=null,c.flags|=2)}function ra(s,c,h){if(s!==null&&(c.dependencies=s.dependencies),ec|=c.lanes,(h&c.childLanes)===0)return null;if(s!==null&&c.child!==s.child)throw Error(t(153));if(c.child!==null){for(s=c.child,h=ll(s,s.pendingProps),c.child=h,h.return=c;s.sibling!==null;)s=s.sibling,h=h.sibling=ll(s,s.pendingProps),h.return=c;h.sibling=null}return c.child}function UR(s,c,h){switch(c.tag){case 3:Nx(c),eu();break;case 5:Y1(c);break;case 1:ki(c.type)&&dh(c);break;case 4:zg(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,A=c.memoizedProps.value;_n(vh,m._currentValue),m._currentValue=A;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(_n(Hn,Hn.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?Ox(s,c,h):(_n(Hn,Hn.current&1),s=ra(s,c,h),s!==null?s.sibling:null);_n(Hn,Hn.current&1);break;case 19:if(m=(h&c.childLanes)!==0,(s.flags&128)!==0){if(m)return Mx(s,c,h);c.flags|=128}if(A=c.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),_n(Hn,Hn.current),m)break;return null;case 22:case 23:return c.lanes=0,_x(s,c,h)}return ra(s,c,h)}var Lx,fm,Ux,Vx;Lx=function(s,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)s.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},fm=function(){},Ux=function(s,c,h,m){var A=s.memoizedProps;if(A!==m){s=c.stateNode,ql(ds.current);var E=null;switch(h){case"input":A=Pt(s,A),m=Pt(s,m),E=[];break;case"select":A=be({},A,{value:void 0}),m=be({},m,{value:void 0}),E=[];break;case"textarea":A=kt(s,A),m=kt(s,m),E=[];break;default:typeof A.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=lh)}Xt(h,m);var G;h=null;for(ke in A)if(!m.hasOwnProperty(ke)&&A.hasOwnProperty(ke)&&A[ke]!=null)if(ke==="style"){var te=A[ke];for(G in te)te.hasOwnProperty(G)&&(h||(h={}),h[G]="")}else ke!=="dangerouslySetInnerHTML"&&ke!=="children"&&ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&ke!=="autoFocus"&&(i.hasOwnProperty(ke)?E||(E=[]):(E=E||[]).push(ke,null));for(ke in m){var ae=m[ke];if(te=A!=null?A[ke]:void 0,m.hasOwnProperty(ke)&&ae!==te&&(ae!=null||te!=null))if(ke==="style")if(te){for(G in te)!te.hasOwnProperty(G)||ae&&ae.hasOwnProperty(G)||(h||(h={}),h[G]="");for(G in ae)ae.hasOwnProperty(G)&&te[G]!==ae[G]&&(h||(h={}),h[G]=ae[G])}else h||(E||(E=[]),E.push(ke,h)),h=ae;else ke==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,te=te?te.__html:void 0,ae!=null&&te!==ae&&(E=E||[]).push(ke,ae)):ke==="children"?typeof ae!="string"&&typeof ae!="number"||(E=E||[]).push(ke,""+ae):ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&(i.hasOwnProperty(ke)?(ae!=null&&ke==="onScroll"&&Nn("scroll",s),E||te===ae||(E=[])):(E=E||[]).push(ke,ae))}h&&(E=E||[]).push("style",h);var ke=E;(c.updateQueue=ke)&&(c.flags|=4)}},Vx=function(s,c,h,m){h!==m&&(c.flags|=4)};function Ed(s,c){if(!Gn)switch(s.tailMode){case"hidden":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Hr(s){var c=s.alternate!==null&&s.alternate.child===s.child,h=0,m=0;if(c)for(var A=s.child;A!==null;)h|=A.lanes|A.childLanes,m|=A.subtreeFlags&14680064,m|=A.flags&14680064,A.return=s,A=A.sibling;else for(A=s.child;A!==null;)h|=A.lanes|A.childLanes,m|=A.subtreeFlags,m|=A.flags,A.return=s,A=A.sibling;return s.subtreeFlags|=m,s.childLanes=h,c}function VR(s,c,h){var m=c.pendingProps;switch(Bg(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(c),null;case 1:return ki(c.type)&&uh(),Hr(c),null;case 3:return m=c.stateNode,iu(),Bn(Si),Bn(jr),Xg(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(gh(c)?c.flags|=4:s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Io!==null&&(Am(Io),Io=null))),fm(s,c),Hr(c),null;case 5:Hg(c);var A=ql(bd.current);if(h=c.type,s!==null&&c.stateNode!=null)Ux(s,c,h,m,A),s.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return Hr(c),null}if(s=ql(ds.current),gh(c)){m=c.stateNode,h=c.type;var E=c.memoizedProps;switch(m[us]=c,m[vd]=E,s=(c.mode&1)!==0,h){case"dialog":Nn("cancel",m),Nn("close",m);break;case"iframe":case"object":case"embed":Nn("load",m);break;case"video":case"audio":for(A=0;A<pd.length;A++)Nn(pd[A],m);break;case"source":Nn("error",m);break;case"img":case"image":case"link":Nn("error",m),Nn("load",m);break;case"details":Nn("toggle",m);break;case"input":He(m,E),Nn("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!E.multiple},Nn("invalid",m);break;case"textarea":jt(m,E),Nn("invalid",m)}Xt(h,E),A=null;for(var G in E)if(E.hasOwnProperty(G)){var te=E[G];G==="children"?typeof te=="string"?m.textContent!==te&&(E.suppressHydrationWarning!==!0&&ah(m.textContent,te,s),A=["children",te]):typeof te=="number"&&m.textContent!==""+te&&(E.suppressHydrationWarning!==!0&&ah(m.textContent,te,s),A=["children",""+te]):i.hasOwnProperty(G)&&te!=null&&G==="onScroll"&&Nn("scroll",m)}switch(h){case"input":rn(m),xt(m,E,!0);break;case"textarea":rn(m),sn(m);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(m.onclick=lh)}m=A,c.updateQueue=m,m!==null&&(c.flags|=4)}else{G=A.nodeType===9?A:A.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=yn(h)),s==="http://www.w3.org/1999/xhtml"?h==="script"?(s=G.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=G.createElement(h,{is:m.is}):(s=G.createElement(h),h==="select"&&(G=s,m.multiple?G.multiple=!0:m.size&&(G.size=m.size))):s=G.createElementNS(s,h),s[us]=c,s[vd]=m,Lx(s,c,!1,!1),c.stateNode=s;e:{switch(G=Yt(h,m),h){case"dialog":Nn("cancel",s),Nn("close",s),A=m;break;case"iframe":case"object":case"embed":Nn("load",s),A=m;break;case"video":case"audio":for(A=0;A<pd.length;A++)Nn(pd[A],s);A=m;break;case"source":Nn("error",s),A=m;break;case"img":case"image":case"link":Nn("error",s),Nn("load",s),A=m;break;case"details":Nn("toggle",s),A=m;break;case"input":He(s,m),A=Pt(s,m),Nn("invalid",s);break;case"option":A=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},A=be({},m,{value:void 0}),Nn("invalid",s);break;case"textarea":jt(s,m),A=kt(s,m),Nn("invalid",s);break;default:A=m}Xt(h,A),te=A;for(E in te)if(te.hasOwnProperty(E)){var ae=te[E];E==="style"?mt(s,ae):E==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&D(s,ae)):E==="children"?typeof ae=="string"?(h!=="textarea"||ae!=="")&&X(s,ae):typeof ae=="number"&&X(s,""+ae):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(i.hasOwnProperty(E)?ae!=null&&E==="onScroll"&&Nn("scroll",s):ae!=null&&T(s,E,ae,G))}switch(h){case"input":rn(s),xt(s,m,!1);break;case"textarea":rn(s),sn(s);break;case"option":m.value!=null&&s.setAttribute("value",""+Te(m.value));break;case"select":s.multiple=!!m.multiple,E=m.value,E!=null?Ut(s,!!m.multiple,E,!1):m.defaultValue!=null&&Ut(s,!!m.multiple,m.defaultValue,!0);break;default:typeof A.onClick=="function"&&(s.onclick=lh)}switch(h){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Hr(c),null;case 6:if(s&&c.stateNode!=null)Vx(s,c,s.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(h=ql(bd.current),ql(ds.current),gh(c)){if(m=c.stateNode,h=c.memoizedProps,m[us]=c,(E=m.nodeValue!==h)&&(s=Wi,s!==null))switch(s.tag){case 3:ah(m.nodeValue,h,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ah(m.nodeValue,h,(s.mode&1)!==0)}E&&(c.flags|=4)}else m=(h.nodeType===9?h:h.ownerDocument).createTextNode(m),m[us]=c,c.stateNode=m}return Hr(c),null;case 13:if(Bn(Hn),m=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Gn&&ji!==null&&(c.mode&1)!==0&&(c.flags&128)===0)j1(),eu(),c.flags|=98560,E=!1;else if(E=gh(c),m!==null&&m.dehydrated!==null){if(s===null){if(!E)throw Error(t(318));if(E=c.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[us]=c}else eu(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Hr(c),E=!1}else Io!==null&&(Am(Io),Io=null),E=!0;if(!E)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(s===null||(Hn.current&1)!==0?ur===0&&(ur=3):km())),c.updateQueue!==null&&(c.flags|=4),Hr(c),null);case 4:return iu(),fm(s,c),s===null&&gd(c.stateNode.containerInfo),Hr(c),null;case 10:return Vg(c.type._context),Hr(c),null;case 17:return ki(c.type)&&uh(),Hr(c),null;case 19:if(Bn(Hn),E=c.memoizedState,E===null)return Hr(c),null;if(m=(c.flags&128)!==0,G=E.rendering,G===null)if(m)Ed(E,!1);else{if(ur!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(G=Ih(s),G!==null){for(c.flags|=128,Ed(E,!1),m=G.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=h,h=c.child;h!==null;)E=h,s=m,E.flags&=14680066,G=E.alternate,G===null?(E.childLanes=0,E.lanes=s,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=G.childLanes,E.lanes=G.lanes,E.child=G.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=G.memoizedProps,E.memoizedState=G.memoizedState,E.updateQueue=G.updateQueue,E.type=G.type,s=G.dependencies,E.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),h=h.sibling;return _n(Hn,Hn.current&1|2),c.child}s=s.sibling}E.tail!==null&&Ct()>lu&&(c.flags|=128,m=!0,Ed(E,!1),c.lanes=4194304)}else{if(!m)if(s=Ih(G),s!==null){if(c.flags|=128,m=!0,h=s.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),Ed(E,!0),E.tail===null&&E.tailMode==="hidden"&&!G.alternate&&!Gn)return Hr(c),null}else 2*Ct()-E.renderingStartTime>lu&&h!==1073741824&&(c.flags|=128,m=!0,Ed(E,!1),c.lanes=4194304);E.isBackwards?(G.sibling=c.child,c.child=G):(h=E.last,h!==null?h.sibling=G:c.child=G,E.last=G)}return E.tail!==null?(c=E.tail,E.rendering=c,E.tail=c.sibling,E.renderingStartTime=Ct(),c.sibling=null,h=Hn.current,_n(Hn,m?h&1|2:h&1),c):(Hr(c),null);case 22:case 23:return Sm(),m=c.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(zi&1073741824)!==0&&(Hr(c),c.subtreeFlags&6&&(c.flags|=8192)):Hr(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function GR(s,c){switch(Bg(c),c.tag){case 1:return ki(c.type)&&uh(),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return iu(),Bn(Si),Bn(jr),Xg(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 5:return Hg(c),null;case 13:if(Bn(Hn),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(t(340));eu()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return Bn(Hn),null;case 4:return iu(),null;case 10:return Vg(c.type._context),null;case 22:case 23:return Sm(),null;case 24:return null;default:return null}}var _h=!1,Zr=!1,WR=typeof WeakSet=="function"?WeakSet:Set,at=null;function su(s,c){var h=s.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(m){$n(s,c,m)}else h.current=null}function hm(s,c,h){try{h()}catch(m){$n(s,c,m)}}var Gx=!1;function jR(s,c){if(Sg=Gi,s=y1(),vg(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&m.rangeCount!==0){h=m.anchorNode;var A=m.anchorOffset,E=m.focusNode;m=m.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var G=0,te=-1,ae=-1,ke=0,Ve=0,Ge=s,Ue=null;t:for(;;){for(var ot;Ge!==h||A!==0&&Ge.nodeType!==3||(te=G+A),Ge!==E||m!==0&&Ge.nodeType!==3||(ae=G+m),Ge.nodeType===3&&(G+=Ge.nodeValue.length),(ot=Ge.firstChild)!==null;)Ue=Ge,Ge=ot;for(;;){if(Ge===s)break t;if(Ue===h&&++ke===A&&(te=G),Ue===E&&++Ve===m&&(ae=G),(ot=Ge.nextSibling)!==null)break;Ge=Ue,Ue=Ge.parentNode}Ge=ot}h=te===-1||ae===-1?null:{start:te,end:ae}}else h=null}h=h||{start:0,end:0}}else h=null;for(kg={focusedElem:s,selectionRange:h},Gi=!1,at=c;at!==null;)if(c=at,s=c.child,(c.subtreeFlags&1028)!==0&&s!==null)s.return=c,at=s;else for(;at!==null;){c=at;try{var dt=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(dt!==null){var ht=dt.memoizedProps,Qn=dt.memoizedState,ye=c.stateNode,fe=ye.getSnapshotBeforeUpdate(c.elementType===c.type?ht:bo(c.type,ht),Qn);ye.__reactInternalSnapshotBeforeUpdate=fe}break;case 3:var we=c.stateNode.containerInfo;we.nodeType===1?we.textContent="":we.nodeType===9&&we.documentElement&&we.removeChild(we.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Xe){$n(c,c.return,Xe)}if(s=c.sibling,s!==null){s.return=c.return,at=s;break}at=c.return}return dt=Gx,Gx=!1,dt}function Td(s,c,h){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var A=m=m.next;do{if((A.tag&s)===s){var E=A.destroy;A.destroy=void 0,E!==void 0&&hm(c,h,E)}A=A.next}while(A!==m)}}function Ph(s,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&s)===s){var m=h.create;h.destroy=m()}h=h.next}while(h!==c)}}function pm(s){var c=s.ref;if(c!==null){var h=s.stateNode;switch(s.tag){case 5:s=h;break;default:s=h}typeof c=="function"?c(s):c.current=s}}function Wx(s){var c=s.alternate;c!==null&&(s.alternate=null,Wx(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&(delete c[us],delete c[vd],delete c[_g],delete c[SR],delete c[kR])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function jx(s){return s.tag===5||s.tag===3||s.tag===4}function zx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function gm(s,c,h){var m=s.tag;if(m===5||m===6)s=s.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(s,c):h.insertBefore(s,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(s,h)):(c=h,c.appendChild(s)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=lh));else if(m!==4&&(s=s.child,s!==null))for(gm(s,c,h),s=s.sibling;s!==null;)gm(s,c,h),s=s.sibling}function mm(s,c,h){var m=s.tag;if(m===5||m===6)s=s.stateNode,c?h.insertBefore(s,c):h.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(mm(s,c,h),s=s.sibling;s!==null;)mm(s,c,h),s=s.sibling}var Tr=null,Ao=!1;function rl(s,c,h){for(h=h.child;h!==null;)Hx(s,c,h),h=h.sibling}function Hx(s,c,h){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(Jt,h)}catch{}switch(h.tag){case 5:Zr||su(h,c);case 6:var m=Tr,A=Ao;Tr=null,rl(s,c,h),Tr=m,Ao=A,Tr!==null&&(Ao?(s=Tr,h=h.stateNode,s.nodeType===8?s.parentNode.removeChild(h):s.removeChild(h)):Tr.removeChild(h.stateNode));break;case 18:Tr!==null&&(Ao?(s=Tr,h=h.stateNode,s.nodeType===8?Rg(s.parentNode,h):s.nodeType===1&&Rg(s,h),as(s)):Rg(Tr,h.stateNode));break;case 4:m=Tr,A=Ao,Tr=h.stateNode.containerInfo,Ao=!0,rl(s,c,h),Tr=m,Ao=A;break;case 0:case 11:case 14:case 15:if(!Zr&&(m=h.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){A=m=m.next;do{var E=A,G=E.destroy;E=E.tag,G!==void 0&&((E&2)!==0||(E&4)!==0)&&hm(h,c,G),A=A.next}while(A!==m)}rl(s,c,h);break;case 1:if(!Zr&&(su(h,c),m=h.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=h.memoizedProps,m.state=h.memoizedState,m.componentWillUnmount()}catch(te){$n(h,c,te)}rl(s,c,h);break;case 21:rl(s,c,h);break;case 22:h.mode&1?(Zr=(m=Zr)||h.memoizedState!==null,rl(s,c,h),Zr=m):rl(s,c,h);break;default:rl(s,c,h)}}function Zx(s){var c=s.updateQueue;if(c!==null){s.updateQueue=null;var h=s.stateNode;h===null&&(h=s.stateNode=new WR),c.forEach(function(m){var A=qR.bind(null,s,m);h.has(m)||(h.add(m),m.then(A,A))})}}function wo(s,c){var h=c.deletions;if(h!==null)for(var m=0;m<h.length;m++){var A=h[m];try{var E=s,G=c,te=G;e:for(;te!==null;){switch(te.tag){case 5:Tr=te.stateNode,Ao=!1;break e;case 3:Tr=te.stateNode.containerInfo,Ao=!0;break e;case 4:Tr=te.stateNode.containerInfo,Ao=!0;break e}te=te.return}if(Tr===null)throw Error(t(160));Hx(E,G,A),Tr=null,Ao=!1;var ae=A.alternate;ae!==null&&(ae.return=null),A.return=null}catch(ke){$n(A,c,ke)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Xx(c,s),c=c.sibling}function Xx(s,c){var h=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(wo(c,s),hs(s),m&4){try{Td(3,s,s.return),Ph(3,s)}catch(ht){$n(s,s.return,ht)}try{Td(5,s,s.return)}catch(ht){$n(s,s.return,ht)}}break;case 1:wo(c,s),hs(s),m&512&&h!==null&&su(h,h.return);break;case 5:if(wo(c,s),hs(s),m&512&&h!==null&&su(h,h.return),s.flags&32){var A=s.stateNode;try{X(A,"")}catch(ht){$n(s,s.return,ht)}}if(m&4&&(A=s.stateNode,A!=null)){var E=s.memoizedProps,G=h!==null?h.memoizedProps:E,te=s.type,ae=s.updateQueue;if(s.updateQueue=null,ae!==null)try{te==="input"&&E.type==="radio"&&E.name!=null&&$e(A,E),Yt(te,G);var ke=Yt(te,E);for(G=0;G<ae.length;G+=2){var Ve=ae[G],Ge=ae[G+1];Ve==="style"?mt(A,Ge):Ve==="dangerouslySetInnerHTML"?D(A,Ge):Ve==="children"?X(A,Ge):T(A,Ve,Ge,ke)}switch(te){case"input":bt(A,E);break;case"textarea":fn(A,E);break;case"select":var Ue=A._wrapperState.wasMultiple;A._wrapperState.wasMultiple=!!E.multiple;var ot=E.value;ot!=null?Ut(A,!!E.multiple,ot,!1):Ue!==!!E.multiple&&(E.defaultValue!=null?Ut(A,!!E.multiple,E.defaultValue,!0):Ut(A,!!E.multiple,E.multiple?[]:"",!1))}A[vd]=E}catch(ht){$n(s,s.return,ht)}}break;case 6:if(wo(c,s),hs(s),m&4){if(s.stateNode===null)throw Error(t(162));A=s.stateNode,E=s.memoizedProps;try{A.nodeValue=E}catch(ht){$n(s,s.return,ht)}}break;case 3:if(wo(c,s),hs(s),m&4&&h!==null&&h.memoizedState.isDehydrated)try{as(c.containerInfo)}catch(ht){$n(s,s.return,ht)}break;case 4:wo(c,s),hs(s);break;case 13:wo(c,s),hs(s),A=s.child,A.flags&8192&&(E=A.memoizedState!==null,A.stateNode.isHidden=E,!E||A.alternate!==null&&A.alternate.memoizedState!==null||(ym=Ct())),m&4&&Zx(s);break;case 22:if(Ve=h!==null&&h.memoizedState!==null,s.mode&1?(Zr=(ke=Zr)||Ve,wo(c,s),Zr=ke):wo(c,s),hs(s),m&8192){if(ke=s.memoizedState!==null,(s.stateNode.isHidden=ke)&&!Ve&&(s.mode&1)!==0)for(at=s,Ve=s.child;Ve!==null;){for(Ge=at=Ve;at!==null;){switch(Ue=at,ot=Ue.child,Ue.tag){case 0:case 11:case 14:case 15:Td(4,Ue,Ue.return);break;case 1:su(Ue,Ue.return);var dt=Ue.stateNode;if(typeof dt.componentWillUnmount=="function"){m=Ue,h=Ue.return;try{c=m,dt.props=c.memoizedProps,dt.state=c.memoizedState,dt.componentWillUnmount()}catch(ht){$n(m,h,ht)}}break;case 5:su(Ue,Ue.return);break;case 22:if(Ue.memoizedState!==null){Jx(Ge);continue}}ot!==null?(ot.return=Ue,at=ot):Jx(Ge)}Ve=Ve.sibling}e:for(Ve=null,Ge=s;;){if(Ge.tag===5){if(Ve===null){Ve=Ge;try{A=Ge.stateNode,ke?(E=A.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(te=Ge.stateNode,ae=Ge.memoizedProps.style,G=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,te.style.display=_e("display",G))}catch(ht){$n(s,s.return,ht)}}}else if(Ge.tag===6){if(Ve===null)try{Ge.stateNode.nodeValue=ke?"":Ge.memoizedProps}catch(ht){$n(s,s.return,ht)}}else if((Ge.tag!==22&&Ge.tag!==23||Ge.memoizedState===null||Ge===s)&&Ge.child!==null){Ge.child.return=Ge,Ge=Ge.child;continue}if(Ge===s)break e;for(;Ge.sibling===null;){if(Ge.return===null||Ge.return===s)break e;Ve===Ge&&(Ve=null),Ge=Ge.return}Ve===Ge&&(Ve=null),Ge.sibling.return=Ge.return,Ge=Ge.sibling}}break;case 19:wo(c,s),hs(s),m&4&&Zx(s);break;case 21:break;default:wo(c,s),hs(s)}}function hs(s){var c=s.flags;if(c&2){try{e:{for(var h=s.return;h!==null;){if(jx(h)){var m=h;break e}h=h.return}throw Error(t(160))}switch(m.tag){case 5:var A=m.stateNode;m.flags&32&&(X(A,""),m.flags&=-33);var E=zx(s);mm(s,E,A);break;case 3:case 4:var G=m.stateNode.containerInfo,te=zx(s);gm(s,te,G);break;default:throw Error(t(161))}}catch(ae){$n(s,s.return,ae)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function zR(s,c,h){at=s,Kx(s)}function Kx(s,c,h){for(var m=(s.mode&1)!==0;at!==null;){var A=at,E=A.child;if(A.tag===22&&m){var G=A.memoizedState!==null||_h;if(!G){var te=A.alternate,ae=te!==null&&te.memoizedState!==null||Zr;te=_h;var ke=Zr;if(_h=G,(Zr=ae)&&!ke)for(at=A;at!==null;)G=at,ae=G.child,G.tag===22&&G.memoizedState!==null?Yx(A):ae!==null?(ae.return=G,at=ae):Yx(A);for(;E!==null;)at=E,Kx(E),E=E.sibling;at=A,_h=te,Zr=ke}$x(s)}else(A.subtreeFlags&8772)!==0&&E!==null?(E.return=A,at=E):$x(s)}}function $x(s){for(;at!==null;){var c=at;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Zr||Ph(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!Zr)if(h===null)m.componentDidMount();else{var A=c.elementType===c.type?h.memoizedProps:bo(c.type,h.memoizedProps);m.componentDidUpdate(A,h.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var E=c.updateQueue;E!==null&&J1(c,E,m);break;case 3:var G=c.updateQueue;if(G!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}J1(c,G,h)}break;case 5:var te=c.stateNode;if(h===null&&c.flags&4){h=te;var ae=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&h.focus();break;case"img":ae.src&&(h.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ke=c.alternate;if(ke!==null){var Ve=ke.memoizedState;if(Ve!==null){var Ge=Ve.dehydrated;Ge!==null&&as(Ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Zr||c.flags&512&&pm(c)}catch(Ue){$n(c,c.return,Ue)}}if(c===s){at=null;break}if(h=c.sibling,h!==null){h.return=c.return,at=h;break}at=c.return}}function Jx(s){for(;at!==null;){var c=at;if(c===s){at=null;break}var h=c.sibling;if(h!==null){h.return=c.return,at=h;break}at=c.return}}function Yx(s){for(;at!==null;){var c=at;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{Ph(4,c)}catch(ae){$n(c,h,ae)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var A=c.return;try{m.componentDidMount()}catch(ae){$n(c,A,ae)}}var E=c.return;try{pm(c)}catch(ae){$n(c,E,ae)}break;case 5:var G=c.return;try{pm(c)}catch(ae){$n(c,G,ae)}}}catch(ae){$n(c,c.return,ae)}if(c===s){at=null;break}var te=c.sibling;if(te!==null){te.return=c.return,at=te;break}at=c.return}}var HR=Math.ceil,Dh=R.ReactCurrentDispatcher,vm=R.ReactCurrentOwner,so=R.ReactCurrentBatchConfig,cn=0,Ir=null,or=null,Rr=0,zi=0,au=qa(0),ur=0,Rd=null,ec=0,Nh=0,Cm=0,_d=null,Ti=null,ym=0,lu=1/0,ia=null,Bh=!1,xm=null,il=null,Oh=!1,ol=null,Fh=0,Pd=0,Im=null,Mh=-1,Lh=0;function ri(){return(cn&6)!==0?Ct():Mh!==-1?Mh:Mh=Ct()}function sl(s){return(s.mode&1)===0?1:(cn&2)!==0&&Rr!==0?Rr&-Rr:TR.transition!==null?(Lh===0&&(Lh=Y()),Lh):(s=qe,s!==0||(s=window.event,s=s===void 0?16:nd(s.type)),s)}function So(s,c,h,m){if(50<Pd)throw Pd=0,Im=null,Error(t(185));me(s,h,m),((cn&2)===0||s!==Ir)&&(s===Ir&&((cn&2)===0&&(Nh|=h),ur===4&&al(s,Rr)),Ri(s,m),h===1&&cn===0&&(c.mode&1)===0&&(lu=Ct()+500,fh&&el()))}function Ri(s,c){var h=s.callbackNode;F(s,c);var m=is(s,s===Ir?Rr:0);if(m===0)h!==null&&tt(h),s.callbackNode=null,s.callbackPriority=0;else if(c=m&-m,s.callbackPriority!==c){if(h!=null&&tt(h),c===1)s.tag===0?ER(Qx.bind(null,s)):L1(Qx.bind(null,s)),AR(function(){(cn&6)===0&&el()}),h=null;else{switch(_t(m)){case 1:h=Vn;break;case 4:h=Xn;break;case 16:h=lr;break;case 536870912:h=Ot;break;default:h=lr}h=aI(h,qx.bind(null,s))}s.callbackPriority=c,s.callbackNode=h}}function qx(s,c){if(Mh=-1,Lh=0,(cn&6)!==0)throw Error(t(327));var h=s.callbackNode;if(cu()&&s.callbackNode!==h)return null;var m=is(s,s===Ir?Rr:0);if(m===0)return null;if((m&30)!==0||(m&s.expiredLanes)!==0||c)c=Uh(s,m);else{c=m;var A=cn;cn|=2;var E=tI();(Ir!==s||Rr!==c)&&(ia=null,lu=Ct()+500,nc(s,c));do try{KR();break}catch(te){eI(s,te)}while(!0);Ug(),Dh.current=E,cn=A,or!==null?c=0:(Ir=null,Rr=0,c=ur)}if(c!==0){if(c===2&&(A=z(s),A!==0&&(m=A,c=bm(s,A))),c===1)throw h=Rd,nc(s,0),al(s,m),Ri(s,Ct()),h;if(c===6)al(s,m);else{if(A=s.current.alternate,(m&30)===0&&!ZR(A)&&(c=Uh(s,m),c===2&&(E=z(s),E!==0&&(m=E,c=bm(s,E))),c===1))throw h=Rd,nc(s,0),al(s,m),Ri(s,Ct()),h;switch(s.finishedWork=A,s.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:rc(s,Ti,ia);break;case 3:if(al(s,m),(m&130023424)===m&&(c=ym+500-Ct(),10<c)){if(is(s,0)!==0)break;if(A=s.suspendedLanes,(A&m)!==m){ri(),s.pingedLanes|=s.suspendedLanes&A;break}s.timeoutHandle=Tg(rc.bind(null,s,Ti,ia),c);break}rc(s,Ti,ia);break;case 4:if(al(s,m),(m&4194240)===m)break;for(c=s.eventTimes,A=-1;0<m;){var G=31-$t(m);E=1<<G,G=c[G],G>A&&(A=G),m&=~E}if(m=A,m=Ct()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*HR(m/1960))-m,10<m){s.timeoutHandle=Tg(rc.bind(null,s,Ti,ia),m);break}rc(s,Ti,ia);break;case 5:rc(s,Ti,ia);break;default:throw Error(t(329))}}}return Ri(s,Ct()),s.callbackNode===h?qx.bind(null,s):null}function bm(s,c){var h=_d;return s.current.memoizedState.isDehydrated&&(nc(s,c).flags|=256),s=Uh(s,c),s!==2&&(c=Ti,Ti=h,c!==null&&Am(c)),s}function Am(s){Ti===null?Ti=s:Ti.push.apply(Ti,s)}function ZR(s){for(var c=s;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var m=0;m<h.length;m++){var A=h[m],E=A.getSnapshot;A=A.value;try{if(!xo(E(),A))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function al(s,c){for(c&=~Cm,c&=~Nh,s.suspendedLanes|=c,s.pingedLanes&=~c,s=s.expirationTimes;0<c;){var h=31-$t(c),m=1<<h;s[h]=-1,c&=~m}}function Qx(s){if((cn&6)!==0)throw Error(t(327));cu();var c=is(s,0);if((c&1)===0)return Ri(s,Ct()),null;var h=Uh(s,c);if(s.tag!==0&&h===2){var m=z(s);m!==0&&(c=m,h=bm(s,m))}if(h===1)throw h=Rd,nc(s,0),al(s,c),Ri(s,Ct()),h;if(h===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=c,rc(s,Ti,ia),Ri(s,Ct()),null}function wm(s,c){var h=cn;cn|=1;try{return s(c)}finally{cn=h,cn===0&&(lu=Ct()+500,fh&&el())}}function tc(s){ol!==null&&ol.tag===0&&(cn&6)===0&&cu();var c=cn;cn|=1;var h=so.transition,m=qe;try{if(so.transition=null,qe=1,s)return s()}finally{qe=m,so.transition=h,cn=c,(cn&6)===0&&el()}}function Sm(){zi=au.current,Bn(au)}function nc(s,c){s.finishedWork=null,s.finishedLanes=0;var h=s.timeoutHandle;if(h!==-1&&(s.timeoutHandle=-1,bR(h)),or!==null)for(h=or.return;h!==null;){var m=h;switch(Bg(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&uh();break;case 3:iu(),Bn(Si),Bn(jr),Xg();break;case 5:Hg(m);break;case 4:iu();break;case 13:Bn(Hn);break;case 19:Bn(Hn);break;case 10:Vg(m.type._context);break;case 22:case 23:Sm()}h=h.return}if(Ir=s,or=s=ll(s.current,null),Rr=zi=c,ur=0,Rd=null,Cm=Nh=ec=0,Ti=_d=null,Yl!==null){for(c=0;c<Yl.length;c++)if(h=Yl[c],m=h.interleaved,m!==null){h.interleaved=null;var A=m.next,E=h.pending;if(E!==null){var G=E.next;E.next=A,m.next=G}h.pending=m}Yl=null}return s}function eI(s,c){do{var h=or;try{if(Ug(),bh.current=kh,Ah){for(var m=Zn.memoizedState;m!==null;){var A=m.queue;A!==null&&(A.pending=null),m=m.next}Ah=!1}if(Ql=0,xr=cr=Zn=null,Ad=!1,wd=0,vm.current=null,h===null||h.return===null){ur=1,Rd=c,or=null;break}e:{var E=s,G=h.return,te=h,ae=c;if(c=Rr,te.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var ke=ae,Ve=te,Ge=Ve.tag;if((Ve.mode&1)===0&&(Ge===0||Ge===11||Ge===15)){var Ue=Ve.alternate;Ue?(Ve.updateQueue=Ue.updateQueue,Ve.memoizedState=Ue.memoizedState,Ve.lanes=Ue.lanes):(Ve.updateQueue=null,Ve.memoizedState=null)}var ot=Sx(G);if(ot!==null){ot.flags&=-257,kx(ot,G,te,E,c),ot.mode&1&&wx(E,ke,c),c=ot,ae=ke;var dt=c.updateQueue;if(dt===null){var ht=new Set;ht.add(ae),c.updateQueue=ht}else dt.add(ae);break e}else{if((c&1)===0){wx(E,ke,c),km();break e}ae=Error(t(426))}}else if(Gn&&te.mode&1){var Qn=Sx(G);if(Qn!==null){(Qn.flags&65536)===0&&(Qn.flags|=256),kx(Qn,G,te,E,c),Mg(ou(ae,te));break e}}E=ae=ou(ae,te),ur!==4&&(ur=2),_d===null?_d=[E]:_d.push(E),E=G;do{switch(E.tag){case 3:E.flags|=65536,c&=-c,E.lanes|=c;var ye=bx(E,ae,c);$1(E,ye);break e;case 1:te=ae;var fe=E.type,we=E.stateNode;if((E.flags&128)===0&&(typeof fe.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(il===null||!il.has(we)))){E.flags|=65536,c&=-c,E.lanes|=c;var Xe=Ax(E,te,c);$1(E,Xe);break e}}E=E.return}while(E!==null)}rI(h)}catch(vt){c=vt,or===h&&h!==null&&(or=h=h.return);continue}break}while(!0)}function tI(){var s=Dh.current;return Dh.current=kh,s===null?kh:s}function km(){(ur===0||ur===3||ur===2)&&(ur=4),Ir===null||(ec&268435455)===0&&(Nh&268435455)===0||al(Ir,Rr)}function Uh(s,c){var h=cn;cn|=2;var m=tI();(Ir!==s||Rr!==c)&&(ia=null,nc(s,c));do try{XR();break}catch(A){eI(s,A)}while(!0);if(Ug(),cn=h,Dh.current=m,or!==null)throw Error(t(261));return Ir=null,Rr=0,ur}function XR(){for(;or!==null;)nI(or)}function KR(){for(;or!==null&&!Qt();)nI(or)}function nI(s){var c=sI(s.alternate,s,zi);s.memoizedProps=s.pendingProps,c===null?rI(s):or=c,vm.current=null}function rI(s){var c=s;do{var h=c.alternate;if(s=c.return,(c.flags&32768)===0){if(h=VR(h,c,zi),h!==null){or=h;return}}else{if(h=GR(h,c),h!==null){h.flags&=32767,or=h;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{ur=6,or=null;return}}if(c=c.sibling,c!==null){or=c;return}or=c=s}while(c!==null);ur===0&&(ur=5)}function rc(s,c,h){var m=qe,A=so.transition;try{so.transition=null,qe=1,$R(s,c,h,m)}finally{so.transition=A,qe=m}return null}function $R(s,c,h,m){do cu();while(ol!==null);if((cn&6)!==0)throw Error(t(327));h=s.finishedWork;var A=s.finishedLanes;if(h===null)return null;if(s.finishedWork=null,s.finishedLanes=0,h===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var E=h.lanes|h.childLanes;if(Pe(s,E),s===Ir&&(or=Ir=null,Rr=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Oh||(Oh=!0,aI(lr,function(){return cu(),null})),E=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||E){E=so.transition,so.transition=null;var G=qe;qe=1;var te=cn;cn|=4,vm.current=null,jR(s,h),Xx(h,s),gR(kg),Gi=!!Sg,kg=Sg=null,s.current=h,zR(h),ln(),cn=te,qe=G,so.transition=E}else s.current=h;if(Oh&&(Oh=!1,ol=s,Fh=A),E=s.pendingLanes,E===0&&(il=null),ei(h.stateNode),Ri(s,Ct()),c!==null)for(m=s.onRecoverableError,h=0;h<c.length;h++)A=c[h],m(A.value,{componentStack:A.stack,digest:A.digest});if(Bh)throw Bh=!1,s=xm,xm=null,s;return(Fh&1)!==0&&s.tag!==0&&cu(),E=s.pendingLanes,(E&1)!==0?s===Im?Pd++:(Pd=0,Im=s):Pd=0,el(),null}function cu(){if(ol!==null){var s=_t(Fh),c=so.transition,h=qe;try{if(so.transition=null,qe=16>s?16:s,ol===null)var m=!1;else{if(s=ol,ol=null,Fh=0,(cn&6)!==0)throw Error(t(331));var A=cn;for(cn|=4,at=s.current;at!==null;){var E=at,G=E.child;if((at.flags&16)!==0){var te=E.deletions;if(te!==null){for(var ae=0;ae<te.length;ae++){var ke=te[ae];for(at=ke;at!==null;){var Ve=at;switch(Ve.tag){case 0:case 11:case 15:Td(8,Ve,E)}var Ge=Ve.child;if(Ge!==null)Ge.return=Ve,at=Ge;else for(;at!==null;){Ve=at;var Ue=Ve.sibling,ot=Ve.return;if(Wx(Ve),Ve===ke){at=null;break}if(Ue!==null){Ue.return=ot,at=Ue;break}at=ot}}}var dt=E.alternate;if(dt!==null){var ht=dt.child;if(ht!==null){dt.child=null;do{var Qn=ht.sibling;ht.sibling=null,ht=Qn}while(ht!==null)}}at=E}}if((E.subtreeFlags&2064)!==0&&G!==null)G.return=E,at=G;else e:for(;at!==null;){if(E=at,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:Td(9,E,E.return)}var ye=E.sibling;if(ye!==null){ye.return=E.return,at=ye;break e}at=E.return}}var fe=s.current;for(at=fe;at!==null;){G=at;var we=G.child;if((G.subtreeFlags&2064)!==0&&we!==null)we.return=G,at=we;else e:for(G=fe;at!==null;){if(te=at,(te.flags&2048)!==0)try{switch(te.tag){case 0:case 11:case 15:Ph(9,te)}}catch(vt){$n(te,te.return,vt)}if(te===G){at=null;break e}var Xe=te.sibling;if(Xe!==null){Xe.return=te.return,at=Xe;break e}at=te.return}}if(cn=A,el(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(Jt,s)}catch{}m=!0}return m}finally{qe=h,so.transition=c}}return!1}function iI(s,c,h){c=ou(h,c),c=bx(s,c,1),s=nl(s,c,1),c=ri(),s!==null&&(me(s,1,c),Ri(s,c))}function $n(s,c,h){if(s.tag===3)iI(s,s,h);else for(;c!==null;){if(c.tag===3){iI(c,s,h);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(il===null||!il.has(m))){s=ou(h,s),s=Ax(c,s,1),c=nl(c,s,1),s=ri(),c!==null&&(me(c,1,s),Ri(c,s));break}}c=c.return}}function JR(s,c,h){var m=s.pingCache;m!==null&&m.delete(c),c=ri(),s.pingedLanes|=s.suspendedLanes&h,Ir===s&&(Rr&h)===h&&(ur===4||ur===3&&(Rr&130023424)===Rr&&500>Ct()-ym?nc(s,0):Cm|=h),Ri(s,c)}function oI(s,c){c===0&&((s.mode&1)===0?c=1:(c=Zs,Zs<<=1,(Zs&130023424)===0&&(Zs=4194304)));var h=ri();s=ta(s,c),s!==null&&(me(s,c,h),Ri(s,h))}function YR(s){var c=s.memoizedState,h=0;c!==null&&(h=c.retryLane),oI(s,h)}function qR(s,c){var h=0;switch(s.tag){case 13:var m=s.stateNode,A=s.memoizedState;A!==null&&(h=A.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),oI(s,h)}var sI;sI=function(s,c,h){if(s!==null)if(s.memoizedProps!==c.pendingProps||Si.current)Ei=!0;else{if((s.lanes&h)===0&&(c.flags&128)===0)return Ei=!1,UR(s,c,h);Ei=(s.flags&131072)!==0}else Ei=!1,Gn&&(c.flags&1048576)!==0&&U1(c,ph,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;Rh(s,c),s=c.pendingProps;var A=Yc(c,jr.current);ru(c,h),A=Jg(null,c,m,s,A,h);var E=Yg();return c.flags|=1,typeof A=="object"&&A!==null&&typeof A.render=="function"&&A.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,ki(m)?(E=!0,dh(c)):E=!1,c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,jg(c),A.updater=Eh,c.stateNode=A,A._reactInternals=c,rm(c,m,s,h),c=am(null,c,m,!0,E,h)):(c.tag=0,Gn&&E&&Ng(c),ni(null,c,A,h),c=c.child),c;case 16:m=c.elementType;e:{switch(Rh(s,c),s=c.pendingProps,A=m._init,m=A(m._payload),c.type=m,A=c.tag=e_(m),s=bo(m,s),A){case 0:c=sm(null,c,m,s,h);break e;case 1:c=Dx(null,c,m,s,h);break e;case 11:c=Ex(null,c,m,s,h);break e;case 14:c=Tx(null,c,m,bo(m.type,s),h);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,A=c.pendingProps,A=c.elementType===m?A:bo(m,A),sm(s,c,m,A,h);case 1:return m=c.type,A=c.pendingProps,A=c.elementType===m?A:bo(m,A),Dx(s,c,m,A,h);case 3:e:{if(Nx(c),s===null)throw Error(t(387));m=c.pendingProps,E=c.memoizedState,A=E.element,K1(s,c),xh(c,m,null,h);var G=c.memoizedState;if(m=G.element,E.isDehydrated)if(E={element:m,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},c.updateQueue.baseState=E,c.memoizedState=E,c.flags&256){A=ou(Error(t(423)),c),c=Bx(s,c,m,h,A);break e}else if(m!==A){A=ou(Error(t(424)),c),c=Bx(s,c,m,h,A);break e}else for(ji=Ya(c.stateNode.containerInfo.firstChild),Wi=c,Gn=!0,Io=null,h=Z1(c,null,m,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(eu(),m===A){c=ra(s,c,h);break e}ni(s,c,m,h)}c=c.child}return c;case 5:return Y1(c),s===null&&Fg(c),m=c.type,A=c.pendingProps,E=s!==null?s.memoizedProps:null,G=A.children,Eg(m,A)?G=null:E!==null&&Eg(m,E)&&(c.flags|=32),Px(s,c),ni(s,c,G,h),c.child;case 6:return s===null&&Fg(c),null;case 13:return Ox(s,c,h);case 4:return zg(c,c.stateNode.containerInfo),m=c.pendingProps,s===null?c.child=tu(c,null,m,h):ni(s,c,m,h),c.child;case 11:return m=c.type,A=c.pendingProps,A=c.elementType===m?A:bo(m,A),Ex(s,c,m,A,h);case 7:return ni(s,c,c.pendingProps,h),c.child;case 8:return ni(s,c,c.pendingProps.children,h),c.child;case 12:return ni(s,c,c.pendingProps.children,h),c.child;case 10:e:{if(m=c.type._context,A=c.pendingProps,E=c.memoizedProps,G=A.value,_n(vh,m._currentValue),m._currentValue=G,E!==null)if(xo(E.value,G)){if(E.children===A.children&&!Si.current){c=ra(s,c,h);break e}}else for(E=c.child,E!==null&&(E.return=c);E!==null;){var te=E.dependencies;if(te!==null){G=E.child;for(var ae=te.firstContext;ae!==null;){if(ae.context===m){if(E.tag===1){ae=na(-1,h&-h),ae.tag=2;var ke=E.updateQueue;if(ke!==null){ke=ke.shared;var Ve=ke.pending;Ve===null?ae.next=ae:(ae.next=Ve.next,Ve.next=ae),ke.pending=ae}}E.lanes|=h,ae=E.alternate,ae!==null&&(ae.lanes|=h),Gg(E.return,h,c),te.lanes|=h;break}ae=ae.next}}else if(E.tag===10)G=E.type===c.type?null:E.child;else if(E.tag===18){if(G=E.return,G===null)throw Error(t(341));G.lanes|=h,te=G.alternate,te!==null&&(te.lanes|=h),Gg(G,h,c),G=E.sibling}else G=E.child;if(G!==null)G.return=E;else for(G=E;G!==null;){if(G===c){G=null;break}if(E=G.sibling,E!==null){E.return=G.return,G=E;break}G=G.return}E=G}ni(s,c,A.children,h),c=c.child}return c;case 9:return A=c.type,m=c.pendingProps.children,ru(c,h),A=io(A),m=m(A),c.flags|=1,ni(s,c,m,h),c.child;case 14:return m=c.type,A=bo(m,c.pendingProps),A=bo(m.type,A),Tx(s,c,m,A,h);case 15:return Rx(s,c,c.type,c.pendingProps,h);case 17:return m=c.type,A=c.pendingProps,A=c.elementType===m?A:bo(m,A),Rh(s,c),c.tag=1,ki(m)?(s=!0,dh(c)):s=!1,ru(c,h),xx(c,m,A),rm(c,m,A,h),am(null,c,m,!0,s,h);case 19:return Mx(s,c,h);case 22:return _x(s,c,h)}throw Error(t(156,c.tag))};function aI(s,c){return De(s,c)}function QR(s,c,h,m){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ao(s,c,h,m){return new QR(s,c,h,m)}function Em(s){return s=s.prototype,!(!s||!s.isReactComponent)}function e_(s){if(typeof s=="function")return Em(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Z)return 11;if(s===le)return 14}return 2}function ll(s,c){var h=s.alternate;return h===null?(h=ao(s.tag,c,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=c,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&14680064,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,c=s.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h}function Vh(s,c,h,m,A,E){var G=2;if(m=s,typeof s=="function")Em(s)&&(G=1);else if(typeof s=="string")G=5;else e:switch(s){case _:return ic(h.children,A,E,c);case M:G=8,A|=8;break;case H:return s=ao(12,h,c,A|2),s.elementType=H,s.lanes=E,s;case q:return s=ao(13,h,c,A),s.elementType=q,s.lanes=E,s;case ie:return s=ao(19,h,c,A),s.elementType=ie,s.lanes=E,s;case Re:return Gh(h,A,E,c);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case V:G=10;break e;case U:G=9;break e;case Z:G=11;break e;case le:G=14;break e;case Ce:G=16,m=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return c=ao(G,h,c,A),c.elementType=s,c.type=m,c.lanes=E,c}function ic(s,c,h,m){return s=ao(7,s,m,c),s.lanes=h,s}function Gh(s,c,h,m){return s=ao(22,s,m,c),s.elementType=Re,s.lanes=h,s.stateNode={isHidden:!1},s}function Tm(s,c,h){return s=ao(6,s,null,c),s.lanes=h,s}function Rm(s,c,h){return c=ao(4,s.children!==null?s.children:[],s.key,c),c.lanes=h,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}function t_(s,c,h,m,A){this.tag=c,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ae(0),this.expirationTimes=Ae(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.identifierPrefix=m,this.onRecoverableError=A,this.mutableSourceEagerHydrationData=null}function _m(s,c,h,m,A,E,G,te,ae){return s=new t_(s,c,h,te,ae),c===1?(c=1,E===!0&&(c|=8)):c=0,E=ao(3,null,null,c),s.current=E,E.stateNode=s,E.memoizedState={element:m,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},jg(E),s}function n_(s,c,h){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:m==null?null:""+m,children:s,containerInfo:c,implementation:h}}function lI(s){if(!s)return Qa;s=s._reactInternals;e:{if(rt(s)!==s||s.tag!==1)throw Error(t(170));var c=s;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(ki(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(s.tag===1){var h=s.type;if(ki(h))return F1(s,h,c)}return c}function cI(s,c,h,m,A,E,G,te,ae){return s=_m(h,m,!0,s,A,E,G,te,ae),s.context=lI(null),h=s.current,m=ri(),A=sl(h),E=na(m,A),E.callback=c??null,nl(h,E,A),s.current.lanes=A,me(s,A,m),Ri(s,m),s}function Wh(s,c,h,m){var A=c.current,E=ri(),G=sl(A);return h=lI(h),c.context===null?c.context=h:c.pendingContext=h,c=na(E,G),c.payload={element:s},m=m===void 0?null:m,m!==null&&(c.callback=m),s=nl(A,c,G),s!==null&&(So(s,A,G,E),yh(s,A,G)),G}function jh(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function uI(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<c?h:c}}function Pm(s,c){uI(s,c),(s=s.alternate)&&uI(s,c)}function r_(){return null}var dI=typeof reportError=="function"?reportError:function(s){console.error(s)};function Dm(s){this._internalRoot=s}zh.prototype.render=Dm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(t(409));Wh(s,c,null,null)},zh.prototype.unmount=Dm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;tc(function(){Wh(null,s,null,null)}),c[Ys]=null}};function zh(s){this._internalRoot=s}zh.prototype.unstable_scheduleHydration=function(s){if(s){var c=yi();s={blockedOn:null,target:s,priority:c};for(var h=0;h<ss.length&&c!==0&&c<ss[h].priority;h++);ss.splice(h,0,s),h===0&&eo(s)}};function Nm(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Hh(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function fI(){}function i_(s,c,h,m,A){if(A){if(typeof m=="function"){var E=m;m=function(){var ke=jh(G);E.call(ke)}}var G=cI(c,m,s,0,null,!1,!1,"",fI);return s._reactRootContainer=G,s[Ys]=G.current,gd(s.nodeType===8?s.parentNode:s),tc(),G}for(;A=s.lastChild;)s.removeChild(A);if(typeof m=="function"){var te=m;m=function(){var ke=jh(ae);te.call(ke)}}var ae=_m(s,0,!1,null,null,!1,!1,"",fI);return s._reactRootContainer=ae,s[Ys]=ae.current,gd(s.nodeType===8?s.parentNode:s),tc(function(){Wh(c,ae,h,m)}),ae}function Zh(s,c,h,m,A){var E=h._reactRootContainer;if(E){var G=E;if(typeof A=="function"){var te=A;A=function(){var ae=jh(G);te.call(ae)}}Wh(c,G,s,A)}else G=i_(h,c,s,A,m);return jh(G)}Vt=function(s){switch(s.tag){case 3:var c=s.stateNode;if(c.current.memoizedState.isDehydrated){var h=rs(c.pendingLanes);h!==0&&(Ke(c,h|1),Ri(c,Ct()),(cn&6)===0&&(lu=Ct()+500,el()))}break;case 13:tc(function(){var m=ta(s,1);if(m!==null){var A=ri();So(m,s,1,A)}}),Pm(s,1)}},bn=function(s){if(s.tag===13){var c=ta(s,134217728);if(c!==null){var h=ri();So(c,s,134217728,h)}Pm(s,134217728)}},Ci=function(s){if(s.tag===13){var c=sl(s),h=ta(s,c);if(h!==null){var m=ri();So(h,s,c,m)}Pm(s,c)}},yi=function(){return qe},Vr=function(s,c){var h=qe;try{return qe=s,c()}finally{qe=h}},ir=function(s,c,h){switch(c){case"input":if(bt(s,h),c=h.name,h.type==="radio"&&c!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var m=h[c];if(m!==s&&m.form===s.form){var A=ch(m);if(!A)throw Error(t(90));Rt(m),bt(m,A)}}}break;case"textarea":fn(s,h);break;case"select":c=h.value,c!=null&&Ut(s,!!h.multiple,c,!1)}},Rn=wm,Cr=tc;var o_={usingClientEntryPoint:!1,Events:[Cd,$c,ch,Lr,an,wm]},Dd={findFiberByHostInstance:Xl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},s_={bundleType:Dd.bundleType,version:Dd.version,rendererPackageName:Dd.rendererPackageName,rendererConfig:Dd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=je(s),s===null?null:s.stateNode},findFiberByHostInstance:Dd.findFiberByHostInstance||r_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xh.isDisabled&&Xh.supportsFiber)try{Jt=Xh.inject(s_),Kn=Xh}catch{}}return _i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o_,_i.createPortal=function(s,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nm(c))throw Error(t(200));return n_(s,c,null,h)},_i.createRoot=function(s,c){if(!Nm(s))throw Error(t(299));var h=!1,m="",A=dI;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(A=c.onRecoverableError)),c=_m(s,1,!1,null,null,h,!1,m,A),s[Ys]=c.current,gd(s.nodeType===8?s.parentNode:s),new Dm(c)},_i.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=je(c),s=s===null?null:s.stateNode,s},_i.flushSync=function(s){return tc(s)},_i.hydrate=function(s,c,h){if(!Hh(c))throw Error(t(200));return Zh(null,s,c,!0,h)},_i.hydrateRoot=function(s,c,h){if(!Nm(s))throw Error(t(405));var m=h!=null&&h.hydratedSources||null,A=!1,E="",G=dI;if(h!=null&&(h.unstable_strictMode===!0&&(A=!0),h.identifierPrefix!==void 0&&(E=h.identifierPrefix),h.onRecoverableError!==void 0&&(G=h.onRecoverableError)),c=cI(c,null,s,1,h??null,A,!1,E,G),s[Ys]=c.current,gd(s),m)for(s=0;s<m.length;s++)h=m[s],A=h._getVersion,A=A(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,A]:c.mutableSourceEagerHydrationData.push(h,A);return new zh(c)},_i.render=function(s,c,h){if(!Hh(c))throw Error(t(200));return Zh(null,s,c,!1,h)},_i.unmountComponentAtNode=function(s){if(!Hh(s))throw Error(t(40));return s._reactRootContainer?(tc(function(){Zh(null,null,s,!1,function(){s._reactRootContainer=null,s[Ys]=null})}),!0):!1},_i.unstable_batchedUpdates=wm,_i.unstable_renderSubtreeIntoContainer=function(s,c,h,m){if(!Hh(h))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Zh(s,c,h,!1,m)},_i.version="18.3.1-next-f1338f8080-20240426",_i}var II;function Qw(){if(II)return Lm.exports;II=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Lm.exports=v_(),Lm.exports}var bI;function C_(){if(bI)return $h;bI=1;var n=Qw();return $h.createRoot=n.createRoot,$h.hydrateRoot=n.hydrateRoot,$h}var y_=C_();const x_=Dl(y_);var eS=Qw();const I_=Dl(eS),b_=qw({__proto__:null,default:I_},[eS]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wn(){return Wn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Wn.apply(this,arguments)}var ar;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ar||(ar={}));const AI="popstate";function A_(n){n===void 0&&(n={});function e(r,i){let{pathname:o,search:a,hash:l}=r.location;return ff("",{pathname:o,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:Nf(i)}return S_(e,t,null,n)}function dn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Du(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function w_(){return Math.random().toString(36).substr(2,8)}function wI(n,e){return{usr:n.state,key:n.key,idx:e}}function ff(n,e,t,r){return t===void 0&&(t=null),Wn({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Nl(e):e,{state:t,key:e&&e.key||r||w_()})}function Nf(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Nl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function S_(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,l=ar.Pop,u=null,d=f();d==null&&(d=0,a.replaceState(Wn({},a.state,{idx:d}),""));function f(){return(a.state||{idx:null}).idx}function p(){l=ar.Pop;let x=f(),I=x==null?null:x-d;d=x,u&&u({action:l,location:y.location,delta:I})}function g(x,I){l=ar.Push;let b=ff(y.location,x,I);d=f()+1;let T=wI(b,d),R=y.createHref(b);try{a.pushState(T,"",R)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(R)}o&&u&&u({action:l,location:y.location,delta:1})}function v(x,I){l=ar.Replace;let b=ff(y.location,x,I);d=f();let T=wI(b,d),R=y.createHref(b);a.replaceState(T,"",R),o&&u&&u({action:l,location:y.location,delta:0})}function C(x){let I=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof x=="string"?x:Nf(x);return b=b.replace(/ $/,"%20"),dn(I,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,I)}let y={get action(){return l},get location(){return n(i,a)},listen(x){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(AI,p),u=x,()=>{i.removeEventListener(AI,p),u=null}},createHref(x){return e(i,x)},createURL:C,encodeLocation(x){let I=C(x);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:g,replace:v,go(x){return a.go(x)}};return y}var mn;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(mn||(mn={}));const k_=new Set(["lazy","caseSensitive","path","id","index","children"]);function E_(n){return n.index===!0}function f0(n,e,t,r){return t===void 0&&(t=[]),r===void 0&&(r={}),n.map((i,o)=>{let a=[...t,String(o)],l=typeof i.id=="string"?i.id:a.join("-");if(dn(i.index!==!0||!i.children,"Cannot specify children on an index route"),dn(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),E_(i)){let u=Wn({},i,e(i),{id:l});return r[l]=u,u}else{let u=Wn({},i,e(i),{id:l,children:void 0});return r[l]=u,i.children&&(u.children=f0(i.children,e,a,r)),u}})}function ac(n,e,t){return t===void 0&&(t="/"),dp(n,e,t,!1)}function dp(n,e,t,r){let i=typeof e=="string"?Nl(e):e,o=Bf(i.pathname||"/",t);if(o==null)return null;let a=tS(n);R_(a);let l=null;for(let u=0;l==null&&u<a.length;++u){let d=V_(o);l=L_(a[u],d,r)}return l}function T_(n,e){let{route:t,pathname:r,params:i}=n;return{id:t.id,pathname:r,params:i,data:e[t.id],handle:t.handle}}function tS(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(o,a,l)=>{let u={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};u.relativePath.startsWith("/")&&(dn(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=pc([r,u.relativePath]),f=t.concat(u);o.children&&o.children.length>0&&(dn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),tS(o.children,e,f,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:F_(d,o.index),routesMeta:f})};return n.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let u of nS(o.path))i(o,a,u)}),e}function nS(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let a=nS(r.join("/")),l=[];return l.push(...a.map(u=>u===""?o:[o,u].join("/"))),i&&l.push(...a),l.map(u=>n.startsWith("/")&&u===""?"/":u)}function R_(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:M_(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const __=/^:[\w-]+$/,P_=3,D_=2,N_=1,B_=10,O_=-2,SI=n=>n==="*";function F_(n,e){let t=n.split("/"),r=t.length;return t.some(SI)&&(r+=O_),e&&(r+=D_),t.filter(i=>!SI(i)).reduce((i,o)=>i+(__.test(o)?P_:o===""?N_:B_),r)}function M_(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function L_(n,e,t){t===void 0&&(t=!1);let{routesMeta:r}=n,i={},o="/",a=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,f=o==="/"?e:e.slice(o.length)||"/",p=kI({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),g=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=kI({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},f)),!p)return null;Object.assign(i,p.params),a.push({params:i,pathname:pc([o,p.pathname]),pathnameBase:H_(pc([o,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(o=pc([o,p.pathnameBase]))}return a}function kI(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=U_(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((d,f,p)=>{let{paramName:g,isOptional:v}=f;if(g==="*"){let y=l[p]||"";a=o.slice(0,o.length-y.length).replace(/(.)\/+$/,"$1")}const C=l[p];return v&&!C?d[g]=void 0:d[g]=(C||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:a,pattern:n}}function U_(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Du(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function V_(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Du(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Bf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function G_(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Nl(n):n;return{pathname:t?t.startsWith("/")?t:W_(t,e):e,search:Z_(r),hash:X_(i)}}function W_(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Gm(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rS(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function j_(n,e){let t=rS(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function z_(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Nl(n):(i=Wn({},n),dn(!i.pathname||!i.pathname.includes("?"),Gm("?","pathname","search",i)),dn(!i.pathname||!i.pathname.includes("#"),Gm("#","pathname","hash",i)),dn(!i.search||!i.search.includes("#"),Gm("#","search","hash",i)));let o=n===""||i.pathname==="",a=o?"/":i.pathname,l;if(a==null)l=t;else{let p=e.length-1;if(!r&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}l=p>=0?e[p]:"/"}let u=G_(i,l),d=a&&a!=="/"&&a.endsWith("/"),f=(o||a===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}const pc=n=>n.join("/").replace(/\/\/+/g,"/"),H_=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Z_=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,X_=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class h0{constructor(e,t,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=t||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function hf(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const iS=["post","put","patch","delete"],K_=new Set(iS),$_=["get",...iS],J_=new Set($_),Y_=new Set([301,302,303,307,308]),q_=new Set([307,308]),Wm={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Q_={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Bd={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ZC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eP=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),oS="remix-router-transitions";function tP(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!t;dn(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(n.mapRouteProperties)i=n.mapRouteProperties;else if(n.detectErrorBoundary){let re=n.detectErrorBoundary;i=ce=>({hasErrorBoundary:re(ce)})}else i=eP;let o={},a=f0(n.routes,i,void 0,o),l,u=n.basename||"/",d=n.dataStrategy||oP,f=n.patchRoutesOnNavigation,p=Wn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},n.future),g=null,v=new Set,C=null,y=null,x=null,I=n.hydrationData!=null,b=ac(a,n.history.location,u),T=!1,R=null;if(b==null&&!f){let re=Di(404,{pathname:n.history.location.pathname}),{matches:ce,route:ve}=MI(a);b=ce,R={[ve.id]:re}}b&&!n.hydrationData&&Cr(b,a,n.history.location.pathname).active&&(b=null);let P;if(b)if(b.some(re=>re.route.lazy))P=!1;else if(!b.some(re=>re.route.loader))P=!0;else if(p.v7_partialHydration){let re=n.hydrationData?n.hydrationData.loaderData:null,ce=n.hydrationData?n.hydrationData.errors:null;if(ce){let ve=b.findIndex(Oe=>ce[Oe.route.id]!==void 0);P=b.slice(0,ve+1).every(Oe=>!Rv(Oe.route,re,ce))}else P=b.every(ve=>!Rv(ve.route,re,ce))}else P=n.hydrationData!=null;else if(P=!1,b=[],p.v7_partialHydration){let re=Cr(null,a,n.history.location.pathname);re.active&&re.matches&&(T=!0,b=re.matches)}let B,_={historyAction:n.history.action,location:n.history.location,matches:b,initialized:P,navigation:Wm,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||R,fetchers:new Map,blockers:new Map},M=ar.Pop,H=!1,V,U=!1,Z=new Map,q=null,ie=!1,le=!1,Ce=[],Re=new Set,de=new Map,pe=0,be=-1,L=new Map,K=new Set,ue=new Map,he=new Map,Ee=new Set,Fe=new Map,Je=new Map,Te;function ft(){if(g=n.history.listen(re=>{let{action:ce,location:ve,delta:Oe}=re;if(Te){Te(),Te=void 0;return}Du(Je.size===0||Oe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ze=ir({currentLocation:_.location,nextLocation:ve,historyAction:ce});if(Ze&&Oe!=null){let st=new Promise(gt=>{Te=gt});n.history.go(Oe*-1),xn(Ze,{state:"blocked",location:ve,proceed(){xn(Ze,{state:"proceeding",proceed:void 0,reset:void 0,location:ve}),st.then(()=>n.history.go(Oe))},reset(){let gt=new Map(_.blockers);gt.set(Ze,Bd),Rt({blockers:gt})}});return}return $e(ce,ve)}),t){yP(e,Z);let re=()=>xP(e,Z);e.addEventListener("pagehide",re),q=()=>e.removeEventListener("pagehide",re)}return _.initialized||$e(ar.Pop,_.location,{initialHydration:!0}),B}function Nt(){g&&g(),q&&q(),v.clear(),V&&V.abort(),_.fetchers.forEach((re,ce)=>se(ce)),_.blockers.forEach((re,ce)=>zt(ce))}function rn(re){return v.add(re),()=>v.delete(re)}function Rt(re,ce){ce===void 0&&(ce={}),_=Wn({},_,re);let ve=[],Oe=[];p.v7_fetcherPersist&&_.fetchers.forEach((Ze,st)=>{Ze.state==="idle"&&(Ee.has(st)?Oe.push(st):ve.push(st))}),Ee.forEach(Ze=>{!_.fetchers.has(Ze)&&!de.has(Ze)&&Oe.push(Ze)}),[...v].forEach(Ze=>Ze(_,{deletedFetchers:Oe,viewTransitionOpts:ce.viewTransitionOpts,flushSync:ce.flushSync===!0})),p.v7_fetcherPersist?(ve.forEach(Ze=>_.fetchers.delete(Ze)),Oe.forEach(Ze=>se(Ze))):Oe.forEach(Ze=>Ee.delete(Ze))}function yt(re,ce,ve){var Oe,Ze;let{flushSync:st}=ve===void 0?{}:ve,gt=_.actionData!=null&&_.navigation.formMethod!=null&&Lo(_.navigation.formMethod)&&_.navigation.state==="loading"&&((Oe=re.state)==null?void 0:Oe._isRedirect)!==!0,nt;ce.actionData?Object.keys(ce.actionData).length>0?nt=ce.actionData:nt=null:gt?nt=_.actionData:nt=null;let Ye=ce.loaderData?OI(_.loaderData,ce.loaderData,ce.matches||[],ce.errors):_.loaderData,et=_.blockers;et.size>0&&(et=new Map(et),et.forEach((Gt,kn)=>et.set(kn,Bd)));let rt=H===!0||_.navigation.formMethod!=null&&Lo(_.navigation.formMethod)&&((Ze=re.state)==null?void 0:Ze._isRedirect)!==!0;l&&(a=l,l=void 0),ie||M===ar.Pop||(M===ar.Push?n.history.push(re,re.state):M===ar.Replace&&n.history.replace(re,re.state));let It;if(M===ar.Pop){let Gt=Z.get(_.location.pathname);Gt&&Gt.has(re.pathname)?It={currentLocation:_.location,nextLocation:re}:Z.has(re.pathname)&&(It={currentLocation:re,nextLocation:_.location})}else if(U){let Gt=Z.get(_.location.pathname);Gt?Gt.add(re.pathname):(Gt=new Set([re.pathname]),Z.set(_.location.pathname,Gt)),It={currentLocation:_.location,nextLocation:re}}Rt(Wn({},ce,{actionData:nt,loaderData:Ye,historyAction:M,location:re,initialized:!0,navigation:Wm,revalidation:"idle",restoreScrollPosition:Rn(re,ce.matches||_.matches),preventScrollReset:rt,blockers:et}),{viewTransitionOpts:It,flushSync:st===!0}),M=ar.Pop,H=!1,U=!1,ie=!1,le=!1,Ce=[]}async function Pt(re,ce){if(typeof re=="number"){n.history.go(re);return}let ve=Tv(_.location,_.matches,u,p.v7_prependBasename,re,p.v7_relativeSplatPath,ce==null?void 0:ce.fromRouteId,ce==null?void 0:ce.relative),{path:Oe,submission:Ze,error:st}=EI(p.v7_normalizeFormMethod,!1,ve,ce),gt=_.location,nt=ff(_.location,Oe,ce&&ce.state);nt=Wn({},nt,n.history.encodeLocation(nt));let Ye=ce&&ce.replace!=null?ce.replace:void 0,et=ar.Push;Ye===!0?et=ar.Replace:Ye===!1||Ze!=null&&Lo(Ze.formMethod)&&Ze.formAction===_.location.pathname+_.location.search&&(et=ar.Replace);let rt=ce&&"preventScrollReset"in ce?ce.preventScrollReset===!0:void 0,It=(ce&&ce.flushSync)===!0,Gt=ir({currentLocation:gt,nextLocation:nt,historyAction:et});if(Gt){xn(Gt,{state:"blocked",location:nt,proceed(){xn(Gt,{state:"proceeding",proceed:void 0,reset:void 0,location:nt}),Pt(re,ce)},reset(){let kn=new Map(_.blockers);kn.set(Gt,Bd),Rt({blockers:kn})}});return}return await $e(et,nt,{submission:Ze,pendingError:st,preventScrollReset:rt,replace:ce&&ce.replace,enableViewTransition:ce&&ce.viewTransition,flushSync:It})}function He(){if(W(),Rt({revalidation:"loading"}),_.navigation.state!=="submitting"){if(_.navigation.state==="idle"){$e(_.historyAction,_.location,{startUninterruptedRevalidation:!0});return}$e(M||_.historyAction,_.navigation.location,{overrideNavigation:_.navigation,enableViewTransition:U===!0})}}async function $e(re,ce,ve){V&&V.abort(),V=null,M=re,ie=(ve&&ve.startUninterruptedRevalidation)===!0,an(_.location,_.matches),H=(ve&&ve.preventScrollReset)===!0,U=(ve&&ve.enableViewTransition)===!0;let Oe=l||a,Ze=ve&&ve.overrideNavigation,st=ve!=null&&ve.initialHydration&&_.matches&&_.matches.length>0&&!T?_.matches:ac(Oe,ce,u),gt=(ve&&ve.flushSync)===!0;if(st&&_.initialized&&!le&&dP(_.location,ce)&&!(ve&&ve.submission&&Lo(ve.submission.formMethod))){yt(ce,{matches:st},{flushSync:gt});return}let nt=Cr(st,Oe,ce.pathname);if(nt.active&&nt.matches&&(st=nt.matches),!st){let{error:je,notFoundMatches:ne,route:De}=qn(ce.pathname);yt(ce,{matches:ne,loaderData:{},errors:{[De.id]:je}},{flushSync:gt});return}V=new AbortController;let Ye=uu(n.history,ce,V.signal,ve&&ve.submission),et;if(ve&&ve.pendingError)et=[lc(st).route.id,{type:mn.error,error:ve.pendingError}];else if(ve&&ve.submission&&Lo(ve.submission.formMethod)){let je=await bt(Ye,ce,ve.submission,st,nt.active,{replace:ve.replace,flushSync:gt});if(je.shortCircuited)return;if(je.pendingActionResult){let[ne,De]=je.pendingActionResult;if($i(De)&&hf(De.error)&&De.error.status===404){V=null,yt(ce,{matches:je.matches,loaderData:{},errors:{[ne]:De.error}});return}}st=je.matches||st,et=je.pendingActionResult,Ze=jm(ce,ve.submission),gt=!1,nt.active=!1,Ye=uu(n.history,Ye.url,Ye.signal)}let{shortCircuited:rt,matches:It,loaderData:Gt,errors:kn}=await xt(Ye,ce,st,nt.active,Ze,ve&&ve.submission,ve&&ve.fetcherSubmission,ve&&ve.replace,ve&&ve.initialHydration===!0,gt,et);rt||(V=null,yt(ce,Wn({matches:It||st},FI(et),{loaderData:Gt,errors:kn})))}async function bt(re,ce,ve,Oe,Ze,st){st===void 0&&(st={}),W();let gt=vP(ce,ve);if(Rt({navigation:gt},{flushSync:st.flushSync===!0}),Ze){let et=await zn(Oe,ce.pathname,re.signal);if(et.type==="aborted")return{shortCircuited:!0};if(et.type==="error"){let rt=lc(et.partialMatches).route.id;return{matches:et.partialMatches,pendingActionResult:[rt,{type:mn.error,error:et.error}]}}else if(et.matches)Oe=et.matches;else{let{notFoundMatches:rt,error:It,route:Gt}=qn(ce.pathname);return{matches:rt,pendingActionResult:[Gt.id,{type:mn.error,error:It}]}}}let nt,Ye=qd(Oe,ce);if(!Ye.route.action&&!Ye.route.lazy)nt={type:mn.error,error:Di(405,{method:re.method,pathname:ce.pathname,routeId:Ye.route.id})};else if(nt=(await sn("action",_,re,[Ye],Oe,null))[Ye.route.id],re.signal.aborted)return{shortCircuited:!0};if(dc(nt)){let et;return st&&st.replace!=null?et=st.replace:et=DI(nt.response.headers.get("Location"),new URL(re.url),u)===_.location.pathname+_.location.search,await fn(re,nt,!0,{submission:ve,replace:et}),{shortCircuited:!0}}if(xl(nt))throw Di(400,{type:"defer-action"});if($i(nt)){let et=lc(Oe,Ye.route.id);return(st&&st.replace)!==!0&&(M=ar.Push),{matches:Oe,pendingActionResult:[et.route.id,nt]}}return{matches:Oe,pendingActionResult:[Ye.route.id,nt]}}async function xt(re,ce,ve,Oe,Ze,st,gt,nt,Ye,et,rt){let It=Ze||jm(ce,st),Gt=st||gt||UI(It),kn=!ie&&(!p.v7_partialHydration||!Ye);if(Oe){if(kn){let Jt=ct(rt);Rt(Wn({navigation:It},Jt!==void 0?{actionData:Jt}:{}),{flushSync:et})}let Ot=await zn(ve,ce.pathname,re.signal);if(Ot.type==="aborted")return{shortCircuited:!0};if(Ot.type==="error"){let Jt=lc(Ot.partialMatches).route.id;return{matches:Ot.partialMatches,loaderData:{},errors:{[Jt]:Ot.error}}}else if(Ot.matches)ve=Ot.matches;else{let{error:Jt,notFoundMatches:Kn,route:ei}=qn(ce.pathname);return{matches:Kn,loaderData:{},errors:{[ei.id]:Jt}}}}let je=l||a,[ne,De]=RI(n.history,_,ve,Gt,ce,p.v7_partialHydration&&Ye===!0,p.v7_skipActionErrorRevalidation,le,Ce,Re,Ee,ue,K,je,u,rt);if(Bt(Ot=>!(ve&&ve.some(Jt=>Jt.route.id===Ot))||ne&&ne.some(Jt=>Jt.route.id===Ot)),be=++pe,ne.length===0&&De.length===0){let Ot=Zt();return yt(ce,Wn({matches:ve,loaderData:{},errors:rt&&$i(rt[1])?{[rt[0]]:rt[1].error}:null},FI(rt),Ot?{fetchers:new Map(_.fetchers)}:{}),{flushSync:et}),{shortCircuited:!0}}if(kn){let Ot={};if(!Oe){Ot.navigation=It;let Jt=ct(rt);Jt!==void 0&&(Ot.actionData=Jt)}De.length>0&&(Ot.fetchers=At(De)),Rt(Ot,{flushSync:et})}De.forEach(Ot=>{_e(Ot.key),Ot.controller&&de.set(Ot.key,Ot.controller)});let tt=()=>De.forEach(Ot=>_e(Ot.key));V&&V.signal.addEventListener("abort",tt);let{loaderResults:Qt,fetcherResults:ln}=await yn(_,ve,ne,De,re);if(re.signal.aborted)return{shortCircuited:!0};V&&V.signal.removeEventListener("abort",tt),De.forEach(Ot=>de.delete(Ot.key));let Ct=Jh(Qt);if(Ct)return await fn(re,Ct.result,!0,{replace:nt}),{shortCircuited:!0};if(Ct=Jh(ln),Ct)return K.add(Ct.key),await fn(re,Ct.result,!0,{replace:nt}),{shortCircuited:!0};let{loaderData:tn,errors:Vn}=BI(_,ve,Qt,rt,De,ln,Fe);Fe.forEach((Ot,Jt)=>{Ot.subscribe(Kn=>{(Kn||Ot.done)&&Fe.delete(Jt)})}),p.v7_partialHydration&&Ye&&_.errors&&(Vn=Wn({},_.errors,Vn));let Xn=Zt(),lr=Xt(be),In=Xn||lr||De.length>0;return Wn({matches:ve,loaderData:tn,errors:Vn},In?{fetchers:new Map(_.fetchers)}:{})}function ct(re){if(re&&!$i(re[1]))return{[re[0]]:re[1].data};if(_.actionData)return Object.keys(_.actionData).length===0?null:_.actionData}function At(re){return re.forEach(ce=>{let ve=_.fetchers.get(ce.key),Oe=Od(void 0,ve?ve.data:void 0);_.fetchers.set(ce.key,Oe)}),new Map(_.fetchers)}function Ut(re,ce,ve,Oe){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");_e(re);let Ze=(Oe&&Oe.flushSync)===!0,st=l||a,gt=Tv(_.location,_.matches,u,p.v7_prependBasename,ve,p.v7_relativeSplatPath,ce,Oe==null?void 0:Oe.relative),nt=ac(st,gt,u),Ye=Cr(nt,st,gt);if(Ye.active&&Ye.matches&&(nt=Ye.matches),!nt){D(re,ce,Di(404,{pathname:gt}),{flushSync:Ze});return}let{path:et,submission:rt,error:It}=EI(p.v7_normalizeFormMethod,!0,gt,Oe);if(It){D(re,ce,It,{flushSync:Ze});return}let Gt=qd(nt,et),kn=(Oe&&Oe.preventScrollReset)===!0;if(rt&&Lo(rt.formMethod)){kt(re,ce,et,Gt,nt,Ye.active,Ze,kn,rt);return}ue.set(re,{routeId:ce,path:et}),jt(re,ce,et,Gt,nt,Ye.active,Ze,kn,rt)}async function kt(re,ce,ve,Oe,Ze,st,gt,nt,Ye){W(),ue.delete(re);function et($t){if(!$t.route.action&&!$t.route.lazy){let vi=Di(405,{method:Ye.formMethod,pathname:ve,routeId:ce});return D(re,ce,vi,{flushSync:gt}),!0}return!1}if(!st&&et(Oe))return;let rt=_.fetchers.get(re);k(re,CP(Ye,rt),{flushSync:gt});let It=new AbortController,Gt=uu(n.history,ve,It.signal,Ye);if(st){let $t=await zn(Ze,new URL(Gt.url).pathname,Gt.signal,re);if($t.type==="aborted")return;if($t.type==="error"){D(re,ce,$t.error,{flushSync:gt});return}else if($t.matches){if(Ze=$t.matches,Oe=qd(Ze,ve),et(Oe))return}else{D(re,ce,Di(404,{pathname:ve}),{flushSync:gt});return}}de.set(re,It);let kn=pe,ne=(await sn("action",_,Gt,[Oe],Ze,re))[Oe.route.id];if(Gt.signal.aborted){de.get(re)===It&&de.delete(re);return}if(p.v7_fetcherPersist&&Ee.has(re)){if(dc(ne)||$i(ne)){k(re,hl(void 0));return}}else{if(dc(ne))if(de.delete(re),be>kn){k(re,hl(void 0));return}else return K.add(re),k(re,Od(Ye)),fn(Gt,ne,!1,{fetcherSubmission:Ye,preventScrollReset:nt});if($i(ne)){D(re,ce,ne.error);return}}if(xl(ne))throw Di(400,{type:"defer-action"});let De=_.navigation.location||_.location,tt=uu(n.history,De,It.signal),Qt=l||a,ln=_.navigation.state!=="idle"?ac(Qt,_.navigation.location,u):_.matches;dn(ln,"Didn't find any matches after fetcher action");let Ct=++pe;L.set(re,Ct);let tn=Od(Ye,ne.data);_.fetchers.set(re,tn);let[Vn,Xn]=RI(n.history,_,ln,Ye,De,!1,p.v7_skipActionErrorRevalidation,le,Ce,Re,Ee,ue,K,Qt,u,[Oe.route.id,ne]);Xn.filter($t=>$t.key!==re).forEach($t=>{let vi=$t.key,ns=_.fetchers.get(vi),Hs=Od(void 0,ns?ns.data:void 0);_.fetchers.set(vi,Hs),_e(vi),$t.controller&&de.set(vi,$t.controller)}),Rt({fetchers:new Map(_.fetchers)});let lr=()=>Xn.forEach($t=>_e($t.key));It.signal.addEventListener("abort",lr);let{loaderResults:In,fetcherResults:Ot}=await yn(_,ln,Vn,Xn,tt);if(It.signal.aborted)return;It.signal.removeEventListener("abort",lr),L.delete(re),de.delete(re),Xn.forEach($t=>de.delete($t.key));let Jt=Jh(In);if(Jt)return fn(tt,Jt.result,!1,{preventScrollReset:nt});if(Jt=Jh(Ot),Jt)return K.add(Jt.key),fn(tt,Jt.result,!1,{preventScrollReset:nt});let{loaderData:Kn,errors:ei}=BI(_,ln,In,void 0,Xn,Ot,Fe);if(_.fetchers.has(re)){let $t=hl(ne.data);_.fetchers.set(re,$t)}Xt(Ct),_.navigation.state==="loading"&&Ct>be?(dn(M,"Expected pending action"),V&&V.abort(),yt(_.navigation.location,{matches:ln,loaderData:Kn,errors:ei,fetchers:new Map(_.fetchers)})):(Rt({errors:ei,loaderData:OI(_.loaderData,Kn,ln,ei),fetchers:new Map(_.fetchers)}),le=!1)}async function jt(re,ce,ve,Oe,Ze,st,gt,nt,Ye){let et=_.fetchers.get(re);k(re,Od(Ye,et?et.data:void 0),{flushSync:gt});let rt=new AbortController,It=uu(n.history,ve,rt.signal);if(st){let ne=await zn(Ze,new URL(It.url).pathname,It.signal,re);if(ne.type==="aborted")return;if(ne.type==="error"){D(re,ce,ne.error,{flushSync:gt});return}else if(ne.matches)Ze=ne.matches,Oe=qd(Ze,ve);else{D(re,ce,Di(404,{pathname:ve}),{flushSync:gt});return}}de.set(re,rt);let Gt=pe,je=(await sn("loader",_,It,[Oe],Ze,re))[Oe.route.id];if(xl(je)&&(je=await XC(je,It.signal,!0)||je),de.get(re)===rt&&de.delete(re),!It.signal.aborted){if(Ee.has(re)){k(re,hl(void 0));return}if(dc(je))if(be>Gt){k(re,hl(void 0));return}else{K.add(re),await fn(It,je,!1,{preventScrollReset:nt});return}if($i(je)){D(re,ce,je.error);return}dn(!xl(je),"Unhandled fetcher deferred data"),k(re,hl(je.data))}}async function fn(re,ce,ve,Oe){let{submission:Ze,fetcherSubmission:st,preventScrollReset:gt,replace:nt}=Oe===void 0?{}:Oe;ce.response.headers.has("X-Remix-Revalidate")&&(le=!0);let Ye=ce.response.headers.get("Location");dn(Ye,"Expected a Location header on the redirect Response"),Ye=DI(Ye,new URL(re.url),u);let et=ff(_.location,Ye,{_isRedirect:!0});if(t){let ne=!1;if(ce.response.headers.has("X-Remix-Reload-Document"))ne=!0;else if(ZC.test(Ye)){const De=n.history.createURL(Ye);ne=De.origin!==e.location.origin||Bf(De.pathname,u)==null}if(ne){nt?e.location.replace(Ye):e.location.assign(Ye);return}}V=null;let rt=nt===!0||ce.response.headers.has("X-Remix-Replace")?ar.Replace:ar.Push,{formMethod:It,formAction:Gt,formEncType:kn}=_.navigation;!Ze&&!st&&It&&Gt&&kn&&(Ze=UI(_.navigation));let je=Ze||st;if(q_.has(ce.response.status)&&je&&Lo(je.formMethod))await $e(rt,et,{submission:Wn({},je,{formAction:Ye}),preventScrollReset:gt||H,enableViewTransition:ve?U:void 0});else{let ne=jm(et,Ze);await $e(rt,et,{overrideNavigation:ne,fetcherSubmission:st,preventScrollReset:gt||H,enableViewTransition:ve?U:void 0})}}async function sn(re,ce,ve,Oe,Ze,st){let gt,nt={};try{gt=await sP(d,re,ce,ve,Oe,Ze,st,o,i)}catch(Ye){return Oe.forEach(et=>{nt[et.route.id]={type:mn.error,error:Ye}}),nt}for(let[Ye,et]of Object.entries(gt))if(fP(et)){let rt=et.result;nt[Ye]={type:mn.redirect,response:cP(rt,ve,Ye,Ze,u,p.v7_relativeSplatPath)}}else nt[Ye]=await lP(et);return nt}async function yn(re,ce,ve,Oe,Ze){let st=re.matches,gt=sn("loader",re,Ze,ve,ce,null),nt=Promise.all(Oe.map(async rt=>{if(rt.matches&&rt.match&&rt.controller){let Gt=(await sn("loader",re,uu(n.history,rt.path,rt.controller.signal),[rt.match],rt.matches,rt.key))[rt.match.route.id];return{[rt.key]:Gt}}else return Promise.resolve({[rt.key]:{type:mn.error,error:Di(404,{pathname:rt.path})}})})),Ye=await gt,et=(await nt).reduce((rt,It)=>Object.assign(rt,It),{});return await Promise.all([gP(ce,Ye,Ze.signal,st,re.loaderData),mP(ce,et,Oe)]),{loaderResults:Ye,fetcherResults:et}}function W(){le=!0,Ce.push(...Bt()),ue.forEach((re,ce)=>{de.has(ce)&&Re.add(ce),_e(ce)})}function k(re,ce,ve){ve===void 0&&(ve={}),_.fetchers.set(re,ce),Rt({fetchers:new Map(_.fetchers)},{flushSync:(ve&&ve.flushSync)===!0})}function D(re,ce,ve,Oe){Oe===void 0&&(Oe={});let Ze=lc(_.matches,ce);se(re),Rt({errors:{[Ze.route.id]:ve},fetchers:new Map(_.fetchers)},{flushSync:(Oe&&Oe.flushSync)===!0})}function X(re){return he.set(re,(he.get(re)||0)+1),Ee.has(re)&&Ee.delete(re),_.fetchers.get(re)||Q_}function se(re){let ce=_.fetchers.get(re);de.has(re)&&!(ce&&ce.state==="loading"&&L.has(re))&&_e(re),ue.delete(re),L.delete(re),K.delete(re),p.v7_fetcherPersist&&Ee.delete(re),Re.delete(re),_.fetchers.delete(re)}function xe(re){let ce=(he.get(re)||0)-1;ce<=0?(he.delete(re),Ee.add(re),p.v7_fetcherPersist||se(re)):he.set(re,ce),Rt({fetchers:new Map(_.fetchers)})}function _e(re){let ce=de.get(re);ce&&(ce.abort(),de.delete(re))}function mt(re){for(let ce of re){let ve=X(ce),Oe=hl(ve.data);_.fetchers.set(ce,Oe)}}function Zt(){let re=[],ce=!1;for(let ve of K){let Oe=_.fetchers.get(ve);dn(Oe,"Expected fetcher: "+ve),Oe.state==="loading"&&(K.delete(ve),re.push(ve),ce=!0)}return mt(re),ce}function Xt(re){let ce=[];for(let[ve,Oe]of L)if(Oe<re){let Ze=_.fetchers.get(ve);dn(Ze,"Expected fetcher: "+ve),Ze.state==="loading"&&(_e(ve),L.delete(ve),ce.push(ve))}return mt(ce),ce.length>0}function Yt(re,ce){let ve=_.blockers.get(re)||Bd;return Je.get(re)!==ce&&Je.set(re,ce),ve}function zt(re){_.blockers.delete(re),Je.delete(re)}function xn(re,ce){let ve=_.blockers.get(re)||Bd;dn(ve.state==="unblocked"&&ce.state==="blocked"||ve.state==="blocked"&&ce.state==="blocked"||ve.state==="blocked"&&ce.state==="proceeding"||ve.state==="blocked"&&ce.state==="unblocked"||ve.state==="proceeding"&&ce.state==="unblocked","Invalid blocker state transition: "+ve.state+" -> "+ce.state);let Oe=new Map(_.blockers);Oe.set(re,ce),Rt({blockers:Oe})}function ir(re){let{currentLocation:ce,nextLocation:ve,historyAction:Oe}=re;if(Je.size===0)return;Je.size>1&&Du(!1,"A router only supports one blocker at a time");let Ze=Array.from(Je.entries()),[st,gt]=Ze[Ze.length-1],nt=_.blockers.get(st);if(!(nt&&nt.state==="proceeding")&&gt({currentLocation:ce,nextLocation:ve,historyAction:Oe}))return st}function qn(re){let ce=Di(404,{pathname:re}),ve=l||a,{matches:Oe,route:Ze}=MI(ve);return Bt(),{notFoundMatches:Oe,route:Ze,error:ce}}function Bt(re){let ce=[];return Fe.forEach((ve,Oe)=>{(!re||re(Oe))&&(ve.cancel(),ce.push(Oe),Fe.delete(Oe))}),ce}function Mr(re,ce,ve){if(C=re,x=ce,y=ve||null,!I&&_.navigation===Wm){I=!0;let Oe=Rn(_.location,_.matches);Oe!=null&&Rt({restoreScrollPosition:Oe})}return()=>{C=null,x=null,y=null}}function Lr(re,ce){return y&&y(re,ce.map(Oe=>T_(Oe,_.loaderData)))||re.key}function an(re,ce){if(C&&x){let ve=Lr(re,ce);C[ve]=x()}}function Rn(re,ce){if(C){let ve=Lr(re,ce),Oe=C[ve];if(typeof Oe=="number")return Oe}return null}function Cr(re,ce,ve){if(f)if(re){if(Object.keys(re[0].params).length>0)return{active:!0,matches:dp(ce,ve,u,!0)}}else return{active:!0,matches:dp(ce,ve,u,!0)||[]};return{active:!1,matches:null}}async function zn(re,ce,ve,Oe){if(!f)return{type:"success",matches:re};let Ze=re;for(;;){let st=l==null,gt=l||a,nt=o;try{await f({signal:ve,path:ce,matches:Ze,fetcherKey:Oe,patch:(rt,It)=>{ve.aborted||PI(rt,It,gt,nt,i)}})}catch(rt){return{type:"error",error:rt,partialMatches:Ze}}finally{st&&!ve.aborted&&(a=[...a])}if(ve.aborted)return{type:"aborted"};let Ye=ac(gt,ce,u);if(Ye)return{type:"success",matches:Ye};let et=dp(gt,ce,u,!0);if(!et||Ze.length===et.length&&Ze.every((rt,It)=>rt.route.id===et[It].route.id))return{type:"success",matches:null};Ze=et}}function Ur(re){o={},l=f0(re,i,void 0,o)}function yr(re,ce){let ve=l==null;PI(re,ce,l||a,o,i),ve&&(a=[...a],Rt({}))}return B={get basename(){return u},get future(){return p},get state(){return _},get routes(){return a},get window(){return e},initialize:ft,subscribe:rn,enableScrollRestoration:Mr,navigate:Pt,fetch:Ut,revalidate:He,createHref:re=>n.history.createHref(re),encodeLocation:re=>n.history.encodeLocation(re),getFetcher:X,deleteFetcher:xe,dispose:Nt,getBlocker:Yt,deleteBlocker:zt,patchRoutes:yr,_internalFetchControllers:de,_internalActiveDeferreds:Fe,_internalSetRoutes:Ur},B}function nP(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function Tv(n,e,t,r,i,o,a,l){let u,d;if(a){u=[];for(let p of e)if(u.push(p),p.route.id===a){d=p;break}}else u=e,d=e[e.length-1];let f=z_(i||".",j_(u,o),Bf(n.pathname,t)||n.pathname,l==="path");if(i==null&&(f.search=n.search,f.hash=n.hash),(i==null||i===""||i===".")&&d){let p=KC(f.search);if(d.route.index&&!p)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!d.route.index&&p){let g=new URLSearchParams(f.search),v=g.getAll("index");g.delete("index"),v.filter(y=>y).forEach(y=>g.append("index",y));let C=g.toString();f.search=C?"?"+C:""}}return r&&t!=="/"&&(f.pathname=f.pathname==="/"?t:pc([t,f.pathname])),Nf(f)}function EI(n,e,t,r){if(!r||!nP(r))return{path:t};if(r.formMethod&&!pP(r.formMethod))return{path:t,error:Di(405,{method:r.formMethod})};let i=()=>({path:t,error:Di(400,{type:"invalid-body"})}),o=r.formMethod||"get",a=n?o.toUpperCase():o.toLowerCase(),l=lS(t);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Lo(a))return i();let g=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((v,C)=>{let[y,x]=C;return""+v+y+"="+x+`
`},""):String(r.body);return{path:t,submission:{formMethod:a,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:g}}}else if(r.formEncType==="application/json"){if(!Lo(a))return i();try{let g=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:t,submission:{formMethod:a,formAction:l,formEncType:r.formEncType,formData:void 0,json:g,text:void 0}}}catch{return i()}}}dn(typeof FormData=="function","FormData is not available in this environment");let u,d;if(r.formData)u=_v(r.formData),d=r.formData;else if(r.body instanceof FormData)u=_v(r.body),d=r.body;else if(r.body instanceof URLSearchParams)u=r.body,d=NI(u);else if(r.body==null)u=new URLSearchParams,d=new FormData;else try{u=new URLSearchParams(r.body),d=NI(u)}catch{return i()}let f={formMethod:a,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:d,json:void 0,text:void 0};if(Lo(f.formMethod))return{path:t,submission:f};let p=Nl(t);return e&&p.search&&KC(p.search)&&u.append("index",""),p.search="?"+u,{path:Nf(p),submission:f}}function TI(n,e,t){t===void 0&&(t=!1);let r=n.findIndex(i=>i.route.id===e);return r>=0?n.slice(0,t?r+1:r):n}function RI(n,e,t,r,i,o,a,l,u,d,f,p,g,v,C,y){let x=y?$i(y[1])?y[1].error:y[1].data:void 0,I=n.createURL(e.location),b=n.createURL(i),T=t;o&&e.errors?T=TI(t,Object.keys(e.errors)[0],!0):y&&$i(y[1])&&(T=TI(t,y[0]));let R=y?y[1].statusCode:void 0,P=a&&R&&R>=400,B=T.filter((M,H)=>{let{route:V}=M;if(V.lazy)return!0;if(V.loader==null)return!1;if(o)return Rv(V,e.loaderData,e.errors);if(rP(e.loaderData,e.matches[H],M)||u.some(q=>q===M.route.id))return!0;let U=e.matches[H],Z=M;return _I(M,Wn({currentUrl:I,currentParams:U.params,nextUrl:b,nextParams:Z.params},r,{actionResult:x,actionStatus:R,defaultShouldRevalidate:P?!1:l||I.pathname+I.search===b.pathname+b.search||I.search!==b.search||sS(U,Z)}))}),_=[];return p.forEach((M,H)=>{if(o||!t.some(ie=>ie.route.id===M.routeId)||f.has(H))return;let V=ac(v,M.path,C);if(!V){_.push({key:H,routeId:M.routeId,path:M.path,matches:null,match:null,controller:null});return}let U=e.fetchers.get(H),Z=qd(V,M.path),q=!1;g.has(H)?q=!1:d.has(H)?(d.delete(H),q=!0):U&&U.state!=="idle"&&U.data===void 0?q=l:q=_I(Z,Wn({currentUrl:I,currentParams:e.matches[e.matches.length-1].params,nextUrl:b,nextParams:t[t.length-1].params},r,{actionResult:x,actionStatus:R,defaultShouldRevalidate:P?!1:l})),q&&_.push({key:H,routeId:M.routeId,path:M.path,matches:V,match:Z,controller:new AbortController})}),[B,_]}function Rv(n,e,t){if(n.lazy)return!0;if(!n.loader)return!1;let r=e!=null&&e[n.id]!==void 0,i=t!=null&&t[n.id]!==void 0;return!r&&i?!1:typeof n.loader=="function"&&n.loader.hydrate===!0?!0:!r&&!i}function rP(n,e,t){let r=!e||t.route.id!==e.route.id,i=n[t.route.id]===void 0;return r||i}function sS(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function _I(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function PI(n,e,t,r,i){var o;let a;if(n){let d=r[n];dn(d,"No route found to patch children into: routeId = "+n),d.children||(d.children=[]),a=d.children}else a=t;let l=e.filter(d=>!a.some(f=>aS(d,f))),u=f0(l,i,[n||"_","patch",String(((o=a)==null?void 0:o.length)||"0")],r);a.push(...u)}function aS(n,e){return"id"in n&&"id"in e&&n.id===e.id?!0:n.index===e.index&&n.path===e.path&&n.caseSensitive===e.caseSensitive?(!n.children||n.children.length===0)&&(!e.children||e.children.length===0)?!0:n.children.every((t,r)=>{var i;return(i=e.children)==null?void 0:i.some(o=>aS(t,o))}):!1}async function iP(n,e,t){if(!n.lazy)return;let r=await n.lazy();if(!n.lazy)return;let i=t[n.id];dn(i,"No route found in manifest");let o={};for(let a in r){let u=i[a]!==void 0&&a!=="hasErrorBoundary";Du(!u,'Route "'+i.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!u&&!k_.has(a)&&(o[a]=r[a])}Object.assign(i,o),Object.assign(i,Wn({},e(i),{lazy:void 0}))}async function oP(n){let{matches:e}=n,t=e.filter(i=>i.shouldLoad);return(await Promise.all(t.map(i=>i.resolve()))).reduce((i,o,a)=>Object.assign(i,{[t[a].route.id]:o}),{})}async function sP(n,e,t,r,i,o,a,l,u,d){let f=o.map(v=>v.route.lazy?iP(v.route,u,l):void 0),p=o.map((v,C)=>{let y=f[C],x=i.some(b=>b.route.id===v.route.id);return Wn({},v,{shouldLoad:x,resolve:async b=>(b&&r.method==="GET"&&(v.route.lazy||v.route.loader)&&(x=!0),x?aP(e,r,v,y,b,d):Promise.resolve({type:mn.data,result:void 0}))})}),g=await n({matches:p,request:r,params:o[0].params,fetcherKey:a,context:d});try{await Promise.all(f)}catch{}return g}async function aP(n,e,t,r,i,o){let a,l,u=d=>{let f,p=new Promise((C,y)=>f=y);l=()=>f(),e.signal.addEventListener("abort",l);let g=C=>typeof d!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+n+'" [routeId: '+t.route.id+"]"))):d({request:e,params:t.params,context:o},...C!==void 0?[C]:[]),v=(async()=>{try{return{type:"data",result:await(i?i(y=>g(y)):g())}}catch(C){return{type:"error",result:C}}})();return Promise.race([v,p])};try{let d=t.route[n];if(r)if(d){let f,[p]=await Promise.all([u(d).catch(g=>{f=g}),r]);if(f!==void 0)throw f;a=p}else if(await r,d=t.route[n],d)a=await u(d);else if(n==="action"){let f=new URL(e.url),p=f.pathname+f.search;throw Di(405,{method:e.method,pathname:p,routeId:t.route.id})}else return{type:mn.data,result:void 0};else if(d)a=await u(d);else{let f=new URL(e.url),p=f.pathname+f.search;throw Di(404,{pathname:p})}dn(a.result!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+t.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(d){return{type:mn.error,result:d}}finally{l&&e.signal.removeEventListener("abort",l)}return a}async function lP(n){let{result:e,type:t}=n;if(cS(e)){let p;try{let g=e.headers.get("Content-Type");g&&/\bapplication\/json\b/.test(g)?e.body==null?p=null:p=await e.json():p=await e.text()}catch(g){return{type:mn.error,error:g}}return t===mn.error?{type:mn.error,error:new h0(e.status,e.statusText,p),statusCode:e.status,headers:e.headers}:{type:mn.data,data:p,statusCode:e.status,headers:e.headers}}if(t===mn.error){if(LI(e)){var r,i;if(e.data instanceof Error){var o,a;return{type:mn.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:mn.error,error:new h0(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:hf(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:mn.error,error:e,statusCode:hf(e)?e.status:void 0}}if(hP(e)){var l,u;return{type:mn.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((u=e.init)==null?void 0:u.headers)&&new Headers(e.init.headers)}}if(LI(e)){var d,f;return{type:mn.data,data:e.data,statusCode:(d=e.init)==null?void 0:d.status,headers:(f=e.init)!=null&&f.headers?new Headers(e.init.headers):void 0}}return{type:mn.data,data:e}}function cP(n,e,t,r,i,o){let a=n.headers.get("Location");if(dn(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!ZC.test(a)){let l=r.slice(0,r.findIndex(u=>u.route.id===t)+1);a=Tv(new URL(e.url),l,i,!0,a,o),n.headers.set("Location",a)}return n}function DI(n,e,t){if(ZC.test(n)){let r=n,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=Bf(i.pathname,t)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return n}function uu(n,e,t,r){let i=n.createURL(lS(e)).toString(),o={signal:t};if(r&&Lo(r.formMethod)){let{formMethod:a,formEncType:l}=r;o.method=a.toUpperCase(),l==="application/json"?(o.headers=new Headers({"Content-Type":l}),o.body=JSON.stringify(r.json)):l==="text/plain"?o.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?o.body=_v(r.formData):o.body=r.formData}return new Request(i,o)}function _v(n){let e=new URLSearchParams;for(let[t,r]of n.entries())e.append(t,typeof r=="string"?r:r.name);return e}function NI(n){let e=new FormData;for(let[t,r]of n.entries())e.append(t,r);return e}function uP(n,e,t,r,i){let o={},a=null,l,u=!1,d={},f=t&&$i(t[1])?t[1].error:void 0;return n.forEach(p=>{if(!(p.route.id in e))return;let g=p.route.id,v=e[g];if(dn(!dc(v),"Cannot handle redirect results in processLoaderData"),$i(v)){let C=v.error;f!==void 0&&(C=f,f=void 0),a=a||{};{let y=lc(n,g);a[y.route.id]==null&&(a[y.route.id]=C)}o[g]=void 0,u||(u=!0,l=hf(v.error)?v.error.status:500),v.headers&&(d[g]=v.headers)}else xl(v)?(r.set(g,v.deferredData),o[g]=v.deferredData.data,v.statusCode!=null&&v.statusCode!==200&&!u&&(l=v.statusCode),v.headers&&(d[g]=v.headers)):(o[g]=v.data,v.statusCode&&v.statusCode!==200&&!u&&(l=v.statusCode),v.headers&&(d[g]=v.headers))}),f!==void 0&&t&&(a={[t[0]]:f},o[t[0]]=void 0),{loaderData:o,errors:a,statusCode:l||200,loaderHeaders:d}}function BI(n,e,t,r,i,o,a){let{loaderData:l,errors:u}=uP(e,t,r,a);return i.forEach(d=>{let{key:f,match:p,controller:g}=d,v=o[f];if(dn(v,"Did not find corresponding fetcher result"),!(g&&g.signal.aborted))if($i(v)){let C=lc(n.matches,p==null?void 0:p.route.id);u&&u[C.route.id]||(u=Wn({},u,{[C.route.id]:v.error})),n.fetchers.delete(f)}else if(dc(v))dn(!1,"Unhandled fetcher revalidation redirect");else if(xl(v))dn(!1,"Unhandled fetcher deferred data");else{let C=hl(v.data);n.fetchers.set(f,C)}}),{loaderData:l,errors:u}}function OI(n,e,t,r){let i=Wn({},e);for(let o of t){let a=o.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(i[a]=e[a]):n[a]!==void 0&&o.route.loader&&(i[a]=n[a]),r&&r.hasOwnProperty(a))break}return i}function FI(n){return n?$i(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function lc(n,e){return(e?n.slice(0,n.findIndex(r=>r.route.id===e)+1):[...n]).reverse().find(r=>r.route.hasErrorBoundary===!0)||n[0]}function MI(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Di(n,e){let{pathname:t,routeId:r,method:i,type:o,message:a}=e===void 0?{}:e,l="Unknown Server Error",u="Unknown @remix-run/router error";return n===400?(l="Bad Request",i&&t&&r?u="You made a "+i+' request to "'+t+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?u="defer() is not supported in actions":o==="invalid-body"&&(u="Unable to encode submission body")):n===403?(l="Forbidden",u='Route "'+r+'" does not match URL "'+t+'"'):n===404?(l="Not Found",u='No route matches URL "'+t+'"'):n===405&&(l="Method Not Allowed",i&&t&&r?u="You made a "+i.toUpperCase()+' request to "'+t+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(u='Invalid request method "'+i.toUpperCase()+'"')),new h0(n||500,l,new Error(u),!0)}function Jh(n){let e=Object.entries(n);for(let t=e.length-1;t>=0;t--){let[r,i]=e[t];if(dc(i))return{key:r,result:i}}}function lS(n){let e=typeof n=="string"?Nl(n):n;return Nf(Wn({},e,{hash:""}))}function dP(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function fP(n){return cS(n.result)&&Y_.has(n.result.status)}function xl(n){return n.type===mn.deferred}function $i(n){return n.type===mn.error}function dc(n){return(n&&n.type)===mn.redirect}function LI(n){return typeof n=="object"&&n!=null&&"type"in n&&"data"in n&&"init"in n&&n.type==="DataWithResponseInit"}function hP(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function cS(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function pP(n){return J_.has(n.toLowerCase())}function Lo(n){return K_.has(n.toLowerCase())}async function gP(n,e,t,r,i){let o=Object.entries(e);for(let a=0;a<o.length;a++){let[l,u]=o[a],d=n.find(g=>(g==null?void 0:g.route.id)===l);if(!d)continue;let f=r.find(g=>g.route.id===d.route.id),p=f!=null&&!sS(f,d)&&(i&&i[d.route.id])!==void 0;xl(u)&&p&&await XC(u,t,!1).then(g=>{g&&(e[l]=g)})}}async function mP(n,e,t){for(let r=0;r<t.length;r++){let{key:i,routeId:o,controller:a}=t[r],l=e[i];n.find(d=>(d==null?void 0:d.route.id)===o)&&xl(l)&&(dn(a,"Expected an AbortController for revalidating fetcher deferred result"),await XC(l,a.signal,!0).then(d=>{d&&(e[i]=d)}))}}async function XC(n,e,t){if(t===void 0&&(t=!1),!await n.deferredData.resolveData(e)){if(t)try{return{type:mn.data,data:n.deferredData.unwrappedData}}catch(i){return{type:mn.error,error:i}}return{type:mn.data,data:n.deferredData.data}}}function KC(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function qd(n,e){let t=typeof e=="string"?Nl(e).search:e.search;if(n[n.length-1].route.index&&KC(t||""))return n[n.length-1];let r=rS(n);return r[r.length-1]}function UI(n){let{formMethod:e,formAction:t,formEncType:r,text:i,formData:o,json:a}=n;if(!(!e||!t||!r)){if(i!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:t,formEncType:r,formData:o,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:a,text:void 0}}}function jm(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function vP(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Od(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function CP(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function hl(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function yP(n,e){try{let t=n.sessionStorage.getItem(oS);if(t){let r=JSON.parse(t);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function xP(n,e){if(e.size>0){let t={};for(let[r,i]of e)t[r]=[...i];try{n.sessionStorage.setItem(oS,JSON.stringify(t))}catch(r){Du(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pv(){return Pv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Pv.apply(this,arguments)}const uS=N.createContext(null),dS=N.createContext(null),fS=N.createContext(null),$C=N.createContext(null),j0=N.createContext({outlet:null,matches:[],isDataRoute:!1}),hS=N.createContext(null);function JC(){return N.useContext($C)!=null}function pS(){return JC()||dn(!1),N.useContext($C).location}function IP(n,e,t,r){JC()||dn(!1);let{navigator:i}=N.useContext(fS),{matches:o}=N.useContext(j0),a=o[o.length-1],l=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=pS(),f;f=d;let p=f.pathname||"/",g=p;if(u!=="/"){let y=u.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=ac(n,{pathname:g});return kP(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:pc([u,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:pc([u,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,t,r)}function bP(){let n=_P(),e=hf(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),t?N.createElement("pre",{style:i},t):null,null)}const AP=N.createElement(bP,null);class wP extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?N.createElement(j0.Provider,{value:this.props.routeContext},N.createElement(hS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function SP(n){let{routeContext:e,match:t,children:r}=n,i=N.useContext(uS);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),N.createElement(j0.Provider,{value:e},r)}function kP(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var o;if(!t)return null;if(t.errors)n=t.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,l=(i=t)==null?void 0:i.errors;if(l!=null){let f=a.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);f>=0||dn(!1),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:g,errors:v}=t,C=p.route.loader&&g[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||C){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,p,g)=>{let v,C=!1,y=null,x=null;t&&(v=l&&p.route.id?l[p.route.id]:void 0,y=p.route.errorElement||AP,u&&(d<0&&g===0?(PP("route-fallback"),C=!0,x=null):d===g&&(C=!0,x=p.route.hydrateFallbackElement||null)));let I=e.concat(a.slice(0,g+1)),b=()=>{let T;return v?T=y:C?T=x:p.route.Component?T=N.createElement(p.route.Component,null):p.route.element?T=p.route.element:T=f,N.createElement(SP,{match:p,routeContext:{outlet:f,matches:I,isDataRoute:t!=null},children:T})};return t&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?N.createElement(wP,{location:t.location,revalidation:t.revalidation,component:y,error:v,children:b(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):b()},null)}var gS=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(gS||{});function EP(n){let e=N.useContext(dS);return e||dn(!1),e}function TP(n){let e=N.useContext(j0);return e||dn(!1),e}function RP(n){let e=TP(),t=e.matches[e.matches.length-1];return t.route.id||dn(!1),t.route.id}function _P(){var n;let e=N.useContext(hS),t=EP(gS.UseRouteError),r=RP();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}const VI={};function PP(n,e,t){VI[n]||(VI[n]=!0)}function DP(n,e){n==null||n.v7_startTransition,(n==null?void 0:n.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function NP(n){let{basename:e="/",children:t=null,location:r,navigationType:i=ar.Pop,navigator:o,static:a=!1,future:l}=n;JC()&&dn(!1);let u=e.replace(/^\/*/,"/"),d=N.useMemo(()=>({basename:u,navigator:o,static:a,future:Pv({v7_relativeSplatPath:!1},l)}),[u,l,o,a]);typeof r=="string"&&(r=Nl(r));let{pathname:f="/",search:p="",hash:g="",state:v=null,key:C="default"}=r,y=N.useMemo(()=>{let x=Bf(f,u);return x==null?null:{location:{pathname:x,search:p,hash:g,state:v,key:C},navigationType:i}},[u,f,p,g,v,C,i]);return y==null?null:N.createElement(fS.Provider,{value:d},N.createElement($C.Provider,{children:t,value:y}))}new Promise(()=>{});function BP(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:N.createElement(n.Component),Component:void 0}),n.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:N.createElement(n.HydrateFallback),HydrateFallback:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:N.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function p0(){return p0=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},p0.apply(this,arguments)}const OP="6";try{window.__reactRouterVersion=OP}catch{}function FP(n,e){return tP({basename:void 0,future:p0({},void 0,{v7_prependBasename:!0}),history:A_({window:void 0}),hydrationData:MP(),routes:n,mapRouteProperties:BP,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function MP(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=p0({},e,{errors:LP(e.errors)})),e}function LP(n){if(!n)return null;let e=Object.entries(n),t={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")t[r]=new h0(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let a=new o(i.message);a.stack="",t[r]=a}catch{}}if(t[r]==null){let o=new Error(i.message);o.stack="",t[r]=o}}else t[r]=i;return t}const UP=N.createContext({isTransitioning:!1}),VP=N.createContext(new Map),GP="startTransition",GI=p_[GP],WP="flushSync",WI=b_[WP];function jP(n){GI?GI(n):n()}function Fd(n){WI?WI(n):n()}class zP{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}}function HP(n){let{fallbackElement:e,router:t,future:r}=n,[i,o]=N.useState(t.state),[a,l]=N.useState(),[u,d]=N.useState({isTransitioning:!1}),[f,p]=N.useState(),[g,v]=N.useState(),[C,y]=N.useState(),x=N.useRef(new Map),{v7_startTransition:I}=r||{},b=N.useCallback(M=>{I?jP(M):M()},[I]),T=N.useCallback((M,H)=>{let{deletedFetchers:V,flushSync:U,viewTransitionOpts:Z}=H;M.fetchers.forEach((ie,le)=>{ie.data!==void 0&&x.current.set(le,ie.data)}),V.forEach(ie=>x.current.delete(ie));let q=t.window==null||t.window.document==null||typeof t.window.document.startViewTransition!="function";if(!Z||q){U?Fd(()=>o(M)):b(()=>o(M));return}if(U){Fd(()=>{g&&(f&&f.resolve(),g.skipTransition()),d({isTransitioning:!0,flushSync:!0,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})});let ie=t.window.document.startViewTransition(()=>{Fd(()=>o(M))});ie.finished.finally(()=>{Fd(()=>{p(void 0),v(void 0),l(void 0),d({isTransitioning:!1})})}),Fd(()=>v(ie));return}g?(f&&f.resolve(),g.skipTransition(),y({state:M,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})):(l(M),d({isTransitioning:!0,flushSync:!1,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation}))},[t.window,g,f,x,b]);N.useLayoutEffect(()=>t.subscribe(T),[t,T]),N.useEffect(()=>{u.isTransitioning&&!u.flushSync&&p(new zP)},[u]),N.useEffect(()=>{if(f&&a&&t.window){let M=a,H=f.promise,V=t.window.document.startViewTransition(async()=>{b(()=>o(M)),await H});V.finished.finally(()=>{p(void 0),v(void 0),l(void 0),d({isTransitioning:!1})}),v(V)}},[b,a,f,t.window]),N.useEffect(()=>{f&&a&&i.location.key===a.location.key&&f.resolve()},[f,g,i.location,a]),N.useEffect(()=>{!u.isTransitioning&&C&&(l(C.state),d({isTransitioning:!0,flushSync:!1,currentLocation:C.currentLocation,nextLocation:C.nextLocation}),y(void 0))},[u.isTransitioning,C]),N.useEffect(()=>{},[]);let R=N.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:M=>t.navigate(M),push:(M,H,V)=>t.navigate(M,{state:H,preventScrollReset:V==null?void 0:V.preventScrollReset}),replace:(M,H,V)=>t.navigate(M,{replace:!0,state:H,preventScrollReset:V==null?void 0:V.preventScrollReset})}),[t]),P=t.basename||"/",B=N.useMemo(()=>({router:t,navigator:R,static:!1,basename:P}),[t,R,P]),_=N.useMemo(()=>({v7_relativeSplatPath:t.future.v7_relativeSplatPath}),[t.future.v7_relativeSplatPath]);return N.useEffect(()=>DP(r,t.future),[r,t.future]),N.createElement(N.Fragment,null,N.createElement(uS.Provider,{value:B},N.createElement(dS.Provider,{value:i},N.createElement(VP.Provider,{value:x.current},N.createElement(UP.Provider,{value:u},N.createElement(NP,{basename:P,location:i.location,navigationType:i.historyAction,navigator:R,future:_},i.initialized||t.future.v7_partialHydration?N.createElement(ZP,{routes:t.routes,future:t.future,state:i}):e))))),null)}const ZP=N.memo(XP);function XP(n){let{routes:e,future:t,state:r}=n;return IP(e,void 0,r,t)}var jI;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(jI||(jI={}));var zI;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(zI||(zI={}));const mS=n=>{const e=typeof n=="function",t=N.useRef(n);N.useEffect(()=>{t.current=n}),N.useEffect(()=>{if(e){const r=i=>{const o=t.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var zm={exports:{}},HI;function KP(){return HI||(HI=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function o(u,d,f,p,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new i(f,p||u,g),C=t?t+d:d;return u._events[C]?u._events[C].fn?u._events[C]=[u._events[C],v]:u._events[C].push(v):(u._events[C]=v,u._eventsCount++),u}function a(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,p;if(this._eventsCount===0)return d;for(p in f=this._events)e.call(f,p)&&d.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=t?t+d:d,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,v=p.length,C=new Array(v);g<v;g++)C[g]=p[g].fn;return C},l.prototype.listenerCount=function(d){var f=t?t+d:d,p=this._events[f];return p?p.fn?1:p.length:0},l.prototype.emit=function(d,f,p,g,v,C){var y=t?t+d:d;if(!this._events[y])return!1;var x=this._events[y],I=arguments.length,b,T;if(x.fn){switch(x.once&&this.removeListener(d,x.fn,void 0,!0),I){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,f),!0;case 3:return x.fn.call(x.context,f,p),!0;case 4:return x.fn.call(x.context,f,p,g),!0;case 5:return x.fn.call(x.context,f,p,g,v),!0;case 6:return x.fn.call(x.context,f,p,g,v,C),!0}for(T=1,b=new Array(I-1);T<I;T++)b[T-1]=arguments[T];x.fn.apply(x.context,b)}else{var R=x.length,P;for(T=0;T<R;T++)switch(x[T].once&&this.removeListener(d,x[T].fn,void 0,!0),I){case 1:x[T].fn.call(x[T].context);break;case 2:x[T].fn.call(x[T].context,f);break;case 3:x[T].fn.call(x[T].context,f,p);break;case 4:x[T].fn.call(x[T].context,f,p,g);break;default:if(!b)for(P=1,b=new Array(I-1);P<I;P++)b[P-1]=arguments[P];x[T].fn.apply(x[T].context,b)}}return!0},l.prototype.on=function(d,f,p){return o(this,d,f,p,!1)},l.prototype.once=function(d,f,p){return o(this,d,f,p,!0)},l.prototype.removeListener=function(d,f,p,g){var v=t?t+d:d;if(!this._events[v])return this;if(!f)return a(this,v),this;var C=this._events[v];if(C.fn)C.fn===f&&(!g||C.once)&&(!p||C.context===p)&&a(this,v);else{for(var y=0,x=[],I=C.length;y<I;y++)(C[y].fn!==f||g&&!C[y].once||p&&C[y].context!==p)&&x.push(C[y]);x.length?this._events[v]=x.length===1?x[0]:x:a(this,v)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=t?t+d:d,this._events[f]&&a(this,f)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,n.exports=l}(zm)),zm.exports}var $P=KP();const z0=Dl($P);var Hm={},Md={},ZI;function JP(){if(ZI)return Md;ZI=1,Md.byteLength=l,Md.toByteArray=d,Md.fromByteArray=g;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=r.length;i<o;++i)n[i]=r[i],e[r.charCodeAt(i)]=i;e[45]=62,e[95]=63;function a(v){var C=v.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=v.indexOf("=");y===-1&&(y=C);var x=y===C?0:4-y%4;return[y,x]}function l(v){var C=a(v),y=C[0],x=C[1];return(y+x)*3/4-x}function u(v,C,y){return(C+y)*3/4-y}function d(v){var C,y=a(v),x=y[0],I=y[1],b=new t(u(v,x,I)),T=0,R=I>0?x-4:x,P;for(P=0;P<R;P+=4)C=e[v.charCodeAt(P)]<<18|e[v.charCodeAt(P+1)]<<12|e[v.charCodeAt(P+2)]<<6|e[v.charCodeAt(P+3)],b[T++]=C>>16&255,b[T++]=C>>8&255,b[T++]=C&255;return I===2&&(C=e[v.charCodeAt(P)]<<2|e[v.charCodeAt(P+1)]>>4,b[T++]=C&255),I===1&&(C=e[v.charCodeAt(P)]<<10|e[v.charCodeAt(P+1)]<<4|e[v.charCodeAt(P+2)]>>2,b[T++]=C>>8&255,b[T++]=C&255),b}function f(v){return n[v>>18&63]+n[v>>12&63]+n[v>>6&63]+n[v&63]}function p(v,C,y){for(var x,I=[],b=C;b<y;b+=3)x=(v[b]<<16&16711680)+(v[b+1]<<8&65280)+(v[b+2]&255),I.push(f(x));return I.join("")}function g(v){for(var C,y=v.length,x=y%3,I=[],b=16383,T=0,R=y-x;T<R;T+=b)I.push(p(v,T,T+b>R?R:T+b));return x===1?(C=v[y-1],I.push(n[C>>2]+n[C<<4&63]+"==")):x===2&&(C=(v[y-2]<<8)+v[y-1],I.push(n[C>>10]+n[C>>4&63]+n[C<<2&63]+"=")),I.join("")}return Md}var Yh={},XI;function YP(){if(XI)return Yh;XI=1;/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */return Yh.read=function(n,e,t,r,i){var o,a,l=i*8-r-1,u=(1<<l)-1,d=u>>1,f=-7,p=t?i-1:0,g=t?-1:1,v=n[e+p];for(p+=g,o=v&(1<<-f)-1,v>>=-f,f+=l;f>0;o=o*256+n[e+p],p+=g,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=r;f>0;a=a*256+n[e+p],p+=g,f-=8);if(o===0)o=1-d;else{if(o===u)return a?NaN:(v?-1:1)*(1/0);a=a+Math.pow(2,r),o=o-d}return(v?-1:1)*a*Math.pow(2,o-r)},Yh.write=function(n,e,t,r,i,o){var a,l,u,d=o*8-i-1,f=(1<<d)-1,p=f>>1,g=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=r?0:o-1,C=r?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),a+p>=1?e+=g/u:e+=g*Math.pow(2,1-p),e*u>=2&&(a++,u/=2),a+p>=f?(l=0,a=f):a+p>=1?(l=(e*u-1)*Math.pow(2,i),a=a+p):(l=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;n[t+v]=l&255,v+=C,l/=256,i-=8);for(a=a<<i|l,d+=i;d>0;n[t+v]=a&255,v+=C,a/=256,d-=8);n[t+v-C]|=y*128},Yh}var KI;function qP(){return KI||(KI=1,function(n){const e=JP(),t=YP(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=l,n.SlowBuffer=b,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i,l.TYPED_ARRAY_SUPPORT=o(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const W=new Uint8Array(1),k={foo:function(){return 42}};return Object.setPrototypeOf(k,Uint8Array.prototype),Object.setPrototypeOf(W,k),W.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function a(W){if(W>i)throw new RangeError('The value "'+W+'" is invalid for option "size"');const k=new Uint8Array(W);return Object.setPrototypeOf(k,l.prototype),k}function l(W,k,D){if(typeof W=="number"){if(typeof k=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(W)}return u(W,k,D)}l.poolSize=8192;function u(W,k,D){if(typeof W=="string")return g(W,k);if(ArrayBuffer.isView(W))return C(W);if(W==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof W);if(kt(W,ArrayBuffer)||W&&kt(W.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(kt(W,SharedArrayBuffer)||W&&kt(W.buffer,SharedArrayBuffer)))return y(W,k,D);if(typeof W=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const X=W.valueOf&&W.valueOf();if(X!=null&&X!==W)return l.from(X,k,D);const se=x(W);if(se)return se;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof W[Symbol.toPrimitive]=="function")return l.from(W[Symbol.toPrimitive]("string"),k,D);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof W)}l.from=function(W,k,D){return u(W,k,D)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function d(W){if(typeof W!="number")throw new TypeError('"size" argument must be of type number');if(W<0)throw new RangeError('The value "'+W+'" is invalid for option "size"')}function f(W,k,D){return d(W),W<=0?a(W):k!==void 0?typeof D=="string"?a(W).fill(k,D):a(W).fill(k):a(W)}l.alloc=function(W,k,D){return f(W,k,D)};function p(W){return d(W),a(W<0?0:I(W)|0)}l.allocUnsafe=function(W){return p(W)},l.allocUnsafeSlow=function(W){return p(W)};function g(W,k){if((typeof k!="string"||k==="")&&(k="utf8"),!l.isEncoding(k))throw new TypeError("Unknown encoding: "+k);const D=T(W,k)|0;let X=a(D);const se=X.write(W,k);return se!==D&&(X=X.slice(0,se)),X}function v(W){const k=W.length<0?0:I(W.length)|0,D=a(k);for(let X=0;X<k;X+=1)D[X]=W[X]&255;return D}function C(W){if(kt(W,Uint8Array)){const k=new Uint8Array(W);return y(k.buffer,k.byteOffset,k.byteLength)}return v(W)}function y(W,k,D){if(k<0||W.byteLength<k)throw new RangeError('"offset" is outside of buffer bounds');if(W.byteLength<k+(D||0))throw new RangeError('"length" is outside of buffer bounds');let X;return k===void 0&&D===void 0?X=new Uint8Array(W):D===void 0?X=new Uint8Array(W,k):X=new Uint8Array(W,k,D),Object.setPrototypeOf(X,l.prototype),X}function x(W){if(l.isBuffer(W)){const k=I(W.length)|0,D=a(k);return D.length===0||W.copy(D,0,0,k),D}if(W.length!==void 0)return typeof W.length!="number"||jt(W.length)?a(0):v(W);if(W.type==="Buffer"&&Array.isArray(W.data))return v(W.data)}function I(W){if(W>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return W|0}function b(W){return+W!=W&&(W=0),l.alloc(+W)}l.isBuffer=function(k){return k!=null&&k._isBuffer===!0&&k!==l.prototype},l.compare=function(k,D){if(kt(k,Uint8Array)&&(k=l.from(k,k.offset,k.byteLength)),kt(D,Uint8Array)&&(D=l.from(D,D.offset,D.byteLength)),!l.isBuffer(k)||!l.isBuffer(D))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(k===D)return 0;let X=k.length,se=D.length;for(let xe=0,_e=Math.min(X,se);xe<_e;++xe)if(k[xe]!==D[xe]){X=k[xe],se=D[xe];break}return X<se?-1:se<X?1:0},l.isEncoding=function(k){switch(String(k).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(k,D){if(!Array.isArray(k))throw new TypeError('"list" argument must be an Array of Buffers');if(k.length===0)return l.alloc(0);let X;if(D===void 0)for(D=0,X=0;X<k.length;++X)D+=k[X].length;const se=l.allocUnsafe(D);let xe=0;for(X=0;X<k.length;++X){let _e=k[X];if(kt(_e,Uint8Array))xe+_e.length>se.length?(l.isBuffer(_e)||(_e=l.from(_e)),_e.copy(se,xe)):Uint8Array.prototype.set.call(se,_e,xe);else if(l.isBuffer(_e))_e.copy(se,xe);else throw new TypeError('"list" argument must be an Array of Buffers');xe+=_e.length}return se};function T(W,k){if(l.isBuffer(W))return W.length;if(ArrayBuffer.isView(W)||kt(W,ArrayBuffer))return W.byteLength;if(typeof W!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof W);const D=W.length,X=arguments.length>2&&arguments[2]===!0;if(!X&&D===0)return 0;let se=!1;for(;;)switch(k){case"ascii":case"latin1":case"binary":return D;case"utf8":case"utf-8":return bt(W).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D*2;case"hex":return D>>>1;case"base64":return At(W).length;default:if(se)return X?-1:bt(W).length;k=(""+k).toLowerCase(),se=!0}}l.byteLength=T;function R(W,k,D){let X=!1;if((k===void 0||k<0)&&(k=0),k>this.length||((D===void 0||D>this.length)&&(D=this.length),D<=0)||(D>>>=0,k>>>=0,D<=k))return"";for(W||(W="utf8");;)switch(W){case"hex":return pe(this,k,D);case"utf8":case"utf-8":return ie(this,k,D);case"ascii":return Re(this,k,D);case"latin1":case"binary":return de(this,k,D);case"base64":return q(this,k,D);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return be(this,k,D);default:if(X)throw new TypeError("Unknown encoding: "+W);W=(W+"").toLowerCase(),X=!0}}l.prototype._isBuffer=!0;function P(W,k,D){const X=W[k];W[k]=W[D],W[D]=X}l.prototype.swap16=function(){const k=this.length;if(k%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let D=0;D<k;D+=2)P(this,D,D+1);return this},l.prototype.swap32=function(){const k=this.length;if(k%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let D=0;D<k;D+=4)P(this,D,D+3),P(this,D+1,D+2);return this},l.prototype.swap64=function(){const k=this.length;if(k%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let D=0;D<k;D+=8)P(this,D,D+7),P(this,D+1,D+6),P(this,D+2,D+5),P(this,D+3,D+4);return this},l.prototype.toString=function(){const k=this.length;return k===0?"":arguments.length===0?ie(this,0,k):R.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(k){if(!l.isBuffer(k))throw new TypeError("Argument must be a Buffer");return this===k?!0:l.compare(this,k)===0},l.prototype.inspect=function(){let k="";const D=n.INSPECT_MAX_BYTES;return k=this.toString("hex",0,D).replace(/(.{2})/g,"$1 ").trim(),this.length>D&&(k+=" ... "),"<Buffer "+k+">"},r&&(l.prototype[r]=l.prototype.inspect),l.prototype.compare=function(k,D,X,se,xe){if(kt(k,Uint8Array)&&(k=l.from(k,k.offset,k.byteLength)),!l.isBuffer(k))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof k);if(D===void 0&&(D=0),X===void 0&&(X=k?k.length:0),se===void 0&&(se=0),xe===void 0&&(xe=this.length),D<0||X>k.length||se<0||xe>this.length)throw new RangeError("out of range index");if(se>=xe&&D>=X)return 0;if(se>=xe)return-1;if(D>=X)return 1;if(D>>>=0,X>>>=0,se>>>=0,xe>>>=0,this===k)return 0;let _e=xe-se,mt=X-D;const Zt=Math.min(_e,mt),Xt=this.slice(se,xe),Yt=k.slice(D,X);for(let zt=0;zt<Zt;++zt)if(Xt[zt]!==Yt[zt]){_e=Xt[zt],mt=Yt[zt];break}return _e<mt?-1:mt<_e?1:0};function B(W,k,D,X,se){if(W.length===0)return-1;if(typeof D=="string"?(X=D,D=0):D>2147483647?D=2147483647:D<-2147483648&&(D=-2147483648),D=+D,jt(D)&&(D=se?0:W.length-1),D<0&&(D=W.length+D),D>=W.length){if(se)return-1;D=W.length-1}else if(D<0)if(se)D=0;else return-1;if(typeof k=="string"&&(k=l.from(k,X)),l.isBuffer(k))return k.length===0?-1:_(W,k,D,X,se);if(typeof k=="number")return k=k&255,typeof Uint8Array.prototype.indexOf=="function"?se?Uint8Array.prototype.indexOf.call(W,k,D):Uint8Array.prototype.lastIndexOf.call(W,k,D):_(W,[k],D,X,se);throw new TypeError("val must be string, number or Buffer")}function _(W,k,D,X,se){let xe=1,_e=W.length,mt=k.length;if(X!==void 0&&(X=String(X).toLowerCase(),X==="ucs2"||X==="ucs-2"||X==="utf16le"||X==="utf-16le")){if(W.length<2||k.length<2)return-1;xe=2,_e/=2,mt/=2,D/=2}function Zt(Yt,zt){return xe===1?Yt[zt]:Yt.readUInt16BE(zt*xe)}let Xt;if(se){let Yt=-1;for(Xt=D;Xt<_e;Xt++)if(Zt(W,Xt)===Zt(k,Yt===-1?0:Xt-Yt)){if(Yt===-1&&(Yt=Xt),Xt-Yt+1===mt)return Yt*xe}else Yt!==-1&&(Xt-=Xt-Yt),Yt=-1}else for(D+mt>_e&&(D=_e-mt),Xt=D;Xt>=0;Xt--){let Yt=!0;for(let zt=0;zt<mt;zt++)if(Zt(W,Xt+zt)!==Zt(k,zt)){Yt=!1;break}if(Yt)return Xt}return-1}l.prototype.includes=function(k,D,X){return this.indexOf(k,D,X)!==-1},l.prototype.indexOf=function(k,D,X){return B(this,k,D,X,!0)},l.prototype.lastIndexOf=function(k,D,X){return B(this,k,D,X,!1)};function M(W,k,D,X){D=Number(D)||0;const se=W.length-D;X?(X=Number(X),X>se&&(X=se)):X=se;const xe=k.length;X>xe/2&&(X=xe/2);let _e;for(_e=0;_e<X;++_e){const mt=parseInt(k.substr(_e*2,2),16);if(jt(mt))return _e;W[D+_e]=mt}return _e}function H(W,k,D,X){return Ut(bt(k,W.length-D),W,D,X)}function V(W,k,D,X){return Ut(xt(k),W,D,X)}function U(W,k,D,X){return Ut(At(k),W,D,X)}function Z(W,k,D,X){return Ut(ct(k,W.length-D),W,D,X)}l.prototype.write=function(k,D,X,se){if(D===void 0)se="utf8",X=this.length,D=0;else if(X===void 0&&typeof D=="string")se=D,X=this.length,D=0;else if(isFinite(D))D=D>>>0,isFinite(X)?(X=X>>>0,se===void 0&&(se="utf8")):(se=X,X=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const xe=this.length-D;if((X===void 0||X>xe)&&(X=xe),k.length>0&&(X<0||D<0)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");se||(se="utf8");let _e=!1;for(;;)switch(se){case"hex":return M(this,k,D,X);case"utf8":case"utf-8":return H(this,k,D,X);case"ascii":case"latin1":case"binary":return V(this,k,D,X);case"base64":return U(this,k,D,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,k,D,X);default:if(_e)throw new TypeError("Unknown encoding: "+se);se=(""+se).toLowerCase(),_e=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(W,k,D){return k===0&&D===W.length?e.fromByteArray(W):e.fromByteArray(W.slice(k,D))}function ie(W,k,D){D=Math.min(W.length,D);const X=[];let se=k;for(;se<D;){const xe=W[se];let _e=null,mt=xe>239?4:xe>223?3:xe>191?2:1;if(se+mt<=D){let Zt,Xt,Yt,zt;switch(mt){case 1:xe<128&&(_e=xe);break;case 2:Zt=W[se+1],(Zt&192)===128&&(zt=(xe&31)<<6|Zt&63,zt>127&&(_e=zt));break;case 3:Zt=W[se+1],Xt=W[se+2],(Zt&192)===128&&(Xt&192)===128&&(zt=(xe&15)<<12|(Zt&63)<<6|Xt&63,zt>2047&&(zt<55296||zt>57343)&&(_e=zt));break;case 4:Zt=W[se+1],Xt=W[se+2],Yt=W[se+3],(Zt&192)===128&&(Xt&192)===128&&(Yt&192)===128&&(zt=(xe&15)<<18|(Zt&63)<<12|(Xt&63)<<6|Yt&63,zt>65535&&zt<1114112&&(_e=zt))}}_e===null?(_e=65533,mt=1):_e>65535&&(_e-=65536,X.push(_e>>>10&1023|55296),_e=56320|_e&1023),X.push(_e),se+=mt}return Ce(X)}const le=4096;function Ce(W){const k=W.length;if(k<=le)return String.fromCharCode.apply(String,W);let D="",X=0;for(;X<k;)D+=String.fromCharCode.apply(String,W.slice(X,X+=le));return D}function Re(W,k,D){let X="";D=Math.min(W.length,D);for(let se=k;se<D;++se)X+=String.fromCharCode(W[se]&127);return X}function de(W,k,D){let X="";D=Math.min(W.length,D);for(let se=k;se<D;++se)X+=String.fromCharCode(W[se]);return X}function pe(W,k,D){const X=W.length;(!k||k<0)&&(k=0),(!D||D<0||D>X)&&(D=X);let se="";for(let xe=k;xe<D;++xe)se+=fn[W[xe]];return se}function be(W,k,D){const X=W.slice(k,D);let se="";for(let xe=0;xe<X.length-1;xe+=2)se+=String.fromCharCode(X[xe]+X[xe+1]*256);return se}l.prototype.slice=function(k,D){const X=this.length;k=~~k,D=D===void 0?X:~~D,k<0?(k+=X,k<0&&(k=0)):k>X&&(k=X),D<0?(D+=X,D<0&&(D=0)):D>X&&(D=X),D<k&&(D=k);const se=this.subarray(k,D);return Object.setPrototypeOf(se,l.prototype),se};function L(W,k,D){if(W%1!==0||W<0)throw new RangeError("offset is not uint");if(W+k>D)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(k,D,X){k=k>>>0,D=D>>>0,X||L(k,D,this.length);let se=this[k],xe=1,_e=0;for(;++_e<D&&(xe*=256);)se+=this[k+_e]*xe;return se},l.prototype.readUintBE=l.prototype.readUIntBE=function(k,D,X){k=k>>>0,D=D>>>0,X||L(k,D,this.length);let se=this[k+--D],xe=1;for(;D>0&&(xe*=256);)se+=this[k+--D]*xe;return se},l.prototype.readUint8=l.prototype.readUInt8=function(k,D){return k=k>>>0,D||L(k,1,this.length),this[k]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(k,D){return k=k>>>0,D||L(k,2,this.length),this[k]|this[k+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(k,D){return k=k>>>0,D||L(k,2,this.length),this[k]<<8|this[k+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(k,D){return k=k>>>0,D||L(k,4,this.length),(this[k]|this[k+1]<<8|this[k+2]<<16)+this[k+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(k,D){return k=k>>>0,D||L(k,4,this.length),this[k]*16777216+(this[k+1]<<16|this[k+2]<<8|this[k+3])},l.prototype.readBigUInt64LE=sn(function(k){k=k>>>0,yt(k,"offset");const D=this[k],X=this[k+7];(D===void 0||X===void 0)&&Pt(k,this.length-8);const se=D+this[++k]*2**8+this[++k]*2**16+this[++k]*2**24,xe=this[++k]+this[++k]*2**8+this[++k]*2**16+X*2**24;return BigInt(se)+(BigInt(xe)<<BigInt(32))}),l.prototype.readBigUInt64BE=sn(function(k){k=k>>>0,yt(k,"offset");const D=this[k],X=this[k+7];(D===void 0||X===void 0)&&Pt(k,this.length-8);const se=D*2**24+this[++k]*2**16+this[++k]*2**8+this[++k],xe=this[++k]*2**24+this[++k]*2**16+this[++k]*2**8+X;return(BigInt(se)<<BigInt(32))+BigInt(xe)}),l.prototype.readIntLE=function(k,D,X){k=k>>>0,D=D>>>0,X||L(k,D,this.length);let se=this[k],xe=1,_e=0;for(;++_e<D&&(xe*=256);)se+=this[k+_e]*xe;return xe*=128,se>=xe&&(se-=Math.pow(2,8*D)),se},l.prototype.readIntBE=function(k,D,X){k=k>>>0,D=D>>>0,X||L(k,D,this.length);let se=D,xe=1,_e=this[k+--se];for(;se>0&&(xe*=256);)_e+=this[k+--se]*xe;return xe*=128,_e>=xe&&(_e-=Math.pow(2,8*D)),_e},l.prototype.readInt8=function(k,D){return k=k>>>0,D||L(k,1,this.length),this[k]&128?(255-this[k]+1)*-1:this[k]},l.prototype.readInt16LE=function(k,D){k=k>>>0,D||L(k,2,this.length);const X=this[k]|this[k+1]<<8;return X&32768?X|4294901760:X},l.prototype.readInt16BE=function(k,D){k=k>>>0,D||L(k,2,this.length);const X=this[k+1]|this[k]<<8;return X&32768?X|4294901760:X},l.prototype.readInt32LE=function(k,D){return k=k>>>0,D||L(k,4,this.length),this[k]|this[k+1]<<8|this[k+2]<<16|this[k+3]<<24},l.prototype.readInt32BE=function(k,D){return k=k>>>0,D||L(k,4,this.length),this[k]<<24|this[k+1]<<16|this[k+2]<<8|this[k+3]},l.prototype.readBigInt64LE=sn(function(k){k=k>>>0,yt(k,"offset");const D=this[k],X=this[k+7];(D===void 0||X===void 0)&&Pt(k,this.length-8);const se=this[k+4]+this[k+5]*2**8+this[k+6]*2**16+(X<<24);return(BigInt(se)<<BigInt(32))+BigInt(D+this[++k]*2**8+this[++k]*2**16+this[++k]*2**24)}),l.prototype.readBigInt64BE=sn(function(k){k=k>>>0,yt(k,"offset");const D=this[k],X=this[k+7];(D===void 0||X===void 0)&&Pt(k,this.length-8);const se=(D<<24)+this[++k]*2**16+this[++k]*2**8+this[++k];return(BigInt(se)<<BigInt(32))+BigInt(this[++k]*2**24+this[++k]*2**16+this[++k]*2**8+X)}),l.prototype.readFloatLE=function(k,D){return k=k>>>0,D||L(k,4,this.length),t.read(this,k,!0,23,4)},l.prototype.readFloatBE=function(k,D){return k=k>>>0,D||L(k,4,this.length),t.read(this,k,!1,23,4)},l.prototype.readDoubleLE=function(k,D){return k=k>>>0,D||L(k,8,this.length),t.read(this,k,!0,52,8)},l.prototype.readDoubleBE=function(k,D){return k=k>>>0,D||L(k,8,this.length),t.read(this,k,!1,52,8)};function K(W,k,D,X,se,xe){if(!l.isBuffer(W))throw new TypeError('"buffer" argument must be a Buffer instance');if(k>se||k<xe)throw new RangeError('"value" argument is out of bounds');if(D+X>W.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(k,D,X,se){if(k=+k,D=D>>>0,X=X>>>0,!se){const mt=Math.pow(2,8*X)-1;K(this,k,D,X,mt,0)}let xe=1,_e=0;for(this[D]=k&255;++_e<X&&(xe*=256);)this[D+_e]=k/xe&255;return D+X},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(k,D,X,se){if(k=+k,D=D>>>0,X=X>>>0,!se){const mt=Math.pow(2,8*X)-1;K(this,k,D,X,mt,0)}let xe=X-1,_e=1;for(this[D+xe]=k&255;--xe>=0&&(_e*=256);)this[D+xe]=k/_e&255;return D+X},l.prototype.writeUint8=l.prototype.writeUInt8=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,1,255,0),this[D]=k&255,D+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,2,65535,0),this[D]=k&255,this[D+1]=k>>>8,D+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,2,65535,0),this[D]=k>>>8,this[D+1]=k&255,D+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,4,4294967295,0),this[D+3]=k>>>24,this[D+2]=k>>>16,this[D+1]=k>>>8,this[D]=k&255,D+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,4,4294967295,0),this[D]=k>>>24,this[D+1]=k>>>16,this[D+2]=k>>>8,this[D+3]=k&255,D+4};function ue(W,k,D,X,se){Rt(k,X,se,W,D,7);let xe=Number(k&BigInt(4294967295));W[D++]=xe,xe=xe>>8,W[D++]=xe,xe=xe>>8,W[D++]=xe,xe=xe>>8,W[D++]=xe;let _e=Number(k>>BigInt(32)&BigInt(4294967295));return W[D++]=_e,_e=_e>>8,W[D++]=_e,_e=_e>>8,W[D++]=_e,_e=_e>>8,W[D++]=_e,D}function he(W,k,D,X,se){Rt(k,X,se,W,D,7);let xe=Number(k&BigInt(4294967295));W[D+7]=xe,xe=xe>>8,W[D+6]=xe,xe=xe>>8,W[D+5]=xe,xe=xe>>8,W[D+4]=xe;let _e=Number(k>>BigInt(32)&BigInt(4294967295));return W[D+3]=_e,_e=_e>>8,W[D+2]=_e,_e=_e>>8,W[D+1]=_e,_e=_e>>8,W[D]=_e,D+8}l.prototype.writeBigUInt64LE=sn(function(k,D=0){return ue(this,k,D,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=sn(function(k,D=0){return he(this,k,D,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(k,D,X,se){if(k=+k,D=D>>>0,!se){const Zt=Math.pow(2,8*X-1);K(this,k,D,X,Zt-1,-Zt)}let xe=0,_e=1,mt=0;for(this[D]=k&255;++xe<X&&(_e*=256);)k<0&&mt===0&&this[D+xe-1]!==0&&(mt=1),this[D+xe]=(k/_e>>0)-mt&255;return D+X},l.prototype.writeIntBE=function(k,D,X,se){if(k=+k,D=D>>>0,!se){const Zt=Math.pow(2,8*X-1);K(this,k,D,X,Zt-1,-Zt)}let xe=X-1,_e=1,mt=0;for(this[D+xe]=k&255;--xe>=0&&(_e*=256);)k<0&&mt===0&&this[D+xe+1]!==0&&(mt=1),this[D+xe]=(k/_e>>0)-mt&255;return D+X},l.prototype.writeInt8=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,1,127,-128),k<0&&(k=255+k+1),this[D]=k&255,D+1},l.prototype.writeInt16LE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,2,32767,-32768),this[D]=k&255,this[D+1]=k>>>8,D+2},l.prototype.writeInt16BE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,2,32767,-32768),this[D]=k>>>8,this[D+1]=k&255,D+2},l.prototype.writeInt32LE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,4,2147483647,-2147483648),this[D]=k&255,this[D+1]=k>>>8,this[D+2]=k>>>16,this[D+3]=k>>>24,D+4},l.prototype.writeInt32BE=function(k,D,X){return k=+k,D=D>>>0,X||K(this,k,D,4,2147483647,-2147483648),k<0&&(k=4294967295+k+1),this[D]=k>>>24,this[D+1]=k>>>16,this[D+2]=k>>>8,this[D+3]=k&255,D+4},l.prototype.writeBigInt64LE=sn(function(k,D=0){return ue(this,k,D,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=sn(function(k,D=0){return he(this,k,D,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ee(W,k,D,X,se,xe){if(D+X>W.length)throw new RangeError("Index out of range");if(D<0)throw new RangeError("Index out of range")}function Fe(W,k,D,X,se){return k=+k,D=D>>>0,se||Ee(W,k,D,4),t.write(W,k,D,X,23,4),D+4}l.prototype.writeFloatLE=function(k,D,X){return Fe(this,k,D,!0,X)},l.prototype.writeFloatBE=function(k,D,X){return Fe(this,k,D,!1,X)};function Je(W,k,D,X,se){return k=+k,D=D>>>0,se||Ee(W,k,D,8),t.write(W,k,D,X,52,8),D+8}l.prototype.writeDoubleLE=function(k,D,X){return Je(this,k,D,!0,X)},l.prototype.writeDoubleBE=function(k,D,X){return Je(this,k,D,!1,X)},l.prototype.copy=function(k,D,X,se){if(!l.isBuffer(k))throw new TypeError("argument should be a Buffer");if(X||(X=0),!se&&se!==0&&(se=this.length),D>=k.length&&(D=k.length),D||(D=0),se>0&&se<X&&(se=X),se===X||k.length===0||this.length===0)return 0;if(D<0)throw new RangeError("targetStart out of bounds");if(X<0||X>=this.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("sourceEnd out of bounds");se>this.length&&(se=this.length),k.length-D<se-X&&(se=k.length-D+X);const xe=se-X;return this===k&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(D,X,se):Uint8Array.prototype.set.call(k,this.subarray(X,se),D),xe},l.prototype.fill=function(k,D,X,se){if(typeof k=="string"){if(typeof D=="string"?(se=D,D=0,X=this.length):typeof X=="string"&&(se=X,X=this.length),se!==void 0&&typeof se!="string")throw new TypeError("encoding must be a string");if(typeof se=="string"&&!l.isEncoding(se))throw new TypeError("Unknown encoding: "+se);if(k.length===1){const _e=k.charCodeAt(0);(se==="utf8"&&_e<128||se==="latin1")&&(k=_e)}}else typeof k=="number"?k=k&255:typeof k=="boolean"&&(k=Number(k));if(D<0||this.length<D||this.length<X)throw new RangeError("Out of range index");if(X<=D)return this;D=D>>>0,X=X===void 0?this.length:X>>>0,k||(k=0);let xe;if(typeof k=="number")for(xe=D;xe<X;++xe)this[xe]=k;else{const _e=l.isBuffer(k)?k:l.from(k,se),mt=_e.length;if(mt===0)throw new TypeError('The value "'+k+'" is invalid for argument "value"');for(xe=0;xe<X-D;++xe)this[xe+D]=_e[xe%mt]}return this};const Te={};function ft(W,k,D){Te[W]=class extends D{constructor(){super(),Object.defineProperty(this,"message",{value:k.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${W}]`,this.stack,delete this.name}get code(){return W}set code(se){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:se,writable:!0})}toString(){return`${this.name} [${W}]: ${this.message}`}}}ft("ERR_BUFFER_OUT_OF_BOUNDS",function(W){return W?`${W} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ft("ERR_INVALID_ARG_TYPE",function(W,k){return`The "${W}" argument must be of type number. Received type ${typeof k}`},TypeError),ft("ERR_OUT_OF_RANGE",function(W,k,D){let X=`The value of "${W}" is out of range.`,se=D;return Number.isInteger(D)&&Math.abs(D)>2**32?se=Nt(String(D)):typeof D=="bigint"&&(se=String(D),(D>BigInt(2)**BigInt(32)||D<-(BigInt(2)**BigInt(32)))&&(se=Nt(se)),se+="n"),X+=` It must be ${k}. Received ${se}`,X},RangeError);function Nt(W){let k="",D=W.length;const X=W[0]==="-"?1:0;for(;D>=X+4;D-=3)k=`_${W.slice(D-3,D)}${k}`;return`${W.slice(0,D)}${k}`}function rn(W,k,D){yt(k,"offset"),(W[k]===void 0||W[k+D]===void 0)&&Pt(k,W.length-(D+1))}function Rt(W,k,D,X,se,xe){if(W>D||W<k){const _e=typeof k=="bigint"?"n":"";let mt;throw k===0||k===BigInt(0)?mt=`>= 0${_e} and < 2${_e} ** ${(xe+1)*8}${_e}`:mt=`>= -(2${_e} ** ${(xe+1)*8-1}${_e}) and < 2 ** ${(xe+1)*8-1}${_e}`,new Te.ERR_OUT_OF_RANGE("value",mt,W)}rn(X,se,xe)}function yt(W,k){if(typeof W!="number")throw new Te.ERR_INVALID_ARG_TYPE(k,"number",W)}function Pt(W,k,D){throw Math.floor(W)!==W?(yt(W,D),new Te.ERR_OUT_OF_RANGE("offset","an integer",W)):k<0?new Te.ERR_BUFFER_OUT_OF_BOUNDS:new Te.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${k}`,W)}const He=/[^+/0-9A-Za-z-_]/g;function $e(W){if(W=W.split("=")[0],W=W.trim().replace(He,""),W.length<2)return"";for(;W.length%4!==0;)W=W+"=";return W}function bt(W,k){k=k||1/0;let D;const X=W.length;let se=null;const xe=[];for(let _e=0;_e<X;++_e){if(D=W.charCodeAt(_e),D>55295&&D<57344){if(!se){if(D>56319){(k-=3)>-1&&xe.push(239,191,189);continue}else if(_e+1===X){(k-=3)>-1&&xe.push(239,191,189);continue}se=D;continue}if(D<56320){(k-=3)>-1&&xe.push(239,191,189),se=D;continue}D=(se-55296<<10|D-56320)+65536}else se&&(k-=3)>-1&&xe.push(239,191,189);if(se=null,D<128){if((k-=1)<0)break;xe.push(D)}else if(D<2048){if((k-=2)<0)break;xe.push(D>>6|192,D&63|128)}else if(D<65536){if((k-=3)<0)break;xe.push(D>>12|224,D>>6&63|128,D&63|128)}else if(D<1114112){if((k-=4)<0)break;xe.push(D>>18|240,D>>12&63|128,D>>6&63|128,D&63|128)}else throw new Error("Invalid code point")}return xe}function xt(W){const k=[];for(let D=0;D<W.length;++D)k.push(W.charCodeAt(D)&255);return k}function ct(W,k){let D,X,se;const xe=[];for(let _e=0;_e<W.length&&!((k-=2)<0);++_e)D=W.charCodeAt(_e),X=D>>8,se=D%256,xe.push(se),xe.push(X);return xe}function At(W){return e.toByteArray($e(W))}function Ut(W,k,D,X){let se;for(se=0;se<X&&!(se+D>=k.length||se>=W.length);++se)k[se+D]=W[se];return se}function kt(W,k){return W instanceof k||W!=null&&W.constructor!=null&&W.constructor.name!=null&&W.constructor.name===k.name}function jt(W){return W!==W}const fn=function(){const W="0123456789abcdef",k=new Array(256);for(let D=0;D<16;++D){const X=D*16;for(let se=0;se<16;++se)k[X+se]=W[D]+W[se]}return k}();function sn(W){return typeof BigInt>"u"?yn:W}function yn(){throw new Error("BigInt not supported")}}(Hm)),Hm}var Xr=qP(),Qd=(n=>(n[n.BINARY=0]="BINARY",n[n.ECHO=1]="ECHO",n[n.RCP=2]="RCP",n[n.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",n[n.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",n[n.STATUS=5]="STATUS",n[n.TIMING_MARK=6]="TIMING_MARK",n[n.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",n[n.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",n[n.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",n[n.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",n[n.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",n[n.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",n[n.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",n[n.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",n[n.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",n[n.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",n[n.EXTENDED_ASCII=17]="EXTENDED_ASCII",n[n.LOGOUT=18]="LOGOUT",n[n.BYTE_MACRO=19]="BYTE_MACRO",n[n.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",n[n.SUPDUP=21]="SUPDUP",n[n.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",n[n.SEND_LOCATION=23]="SEND_LOCATION",n[n.TERMINAL_TYPE=24]="TERMINAL_TYPE",n[n.END_OF_RECORD=25]="END_OF_RECORD",n[n.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",n[n.OUTPUT_MARKING=27]="OUTPUT_MARKING",n[n.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",n[n.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",n[n.X_3_PAD=30]="X_3_PAD",n[n.NAWS=31]="NAWS",n[n.TERMINAL_SPEED=32]="TERMINAL_SPEED",n[n.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",n[n.LINEMODE=34]="LINEMODE",n[n.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",n[n.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",n[n.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",n[n.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",n[n.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",n[n.TN3270E=40]="TN3270E",n[n.XAUTH=41]="XAUTH",n[n.CHARSET=42]="CHARSET",n[n.RSP=43]="RSP",n[n.COM_PORT_OPTION=44]="COM_PORT_OPTION",n[n.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",n[n.START_TLS=46]="START_TLS",n[n.KERMIT=47]="KERMIT",n[n.SEND_URL=48]="SEND_URL",n[n.FORWARD_X=49]="FORWARD_X",n[n.PRAGMA_LOGON=138]="PRAGMA_LOGON",n[n.GMCP=201]="GMCP",n))(Qd||{}),ef=(n=>(n[n.SE=240]="SE",n[n.NOP=241]="NOP",n[n.DM=242]="DM",n[n.BRK=243]="BRK",n[n.IP=244]="IP",n[n.AO=245]="AO",n[n.AYT=246]="AYT",n[n.EC=247]="EC",n[n.EL=248]="EL",n[n.GA=249]="GA",n[n.SB=250]="SB",n[n.WILL=251]="WILL",n[n.WONT=252]="WONT",n[n.DO=253]="DO",n[n.DONT=254]="DONT",n[n.IAC=255]="IAC",n))(ef||{});class QP{constructor(e){ee(this,"ws");this.ws=e}on(e,t){if(e==="data"){this.ws.onmessage=i=>{t(i.data)};return}const r="on"+e;this[r]=t}write(e){this.ws.send(e)}}class eD extends z0{constructor(t){super();ee(this,"state");ee(this,"buffer");ee(this,"subBuffer");ee(this,"iacSEBuffer",Xr.Buffer.from([255,240]));ee(this,"negotiationByte",0);ee(this,"stream");this.state=0,this.buffer=Xr.Buffer.alloc(0),this.subBuffer=Xr.Buffer.alloc(0),t&&t.on("data",r=>this.parse(r)),this.stream=t}parse(t){for(this.buffer=Xr.Buffer.concat([this.buffer,Xr.Buffer.from(t)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const t=this.buffer.indexOf(255);if(t===-1){this.emit("data",this.buffer),this.buffer=Xr.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,t)),this.buffer=this.buffer.slice(t),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const t=this.buffer[1];switch(this.buffer=this.buffer.slice(2),t){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=Xr.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=t,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const t=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",t,r),this.state=0,!1}handleSubnegotiation(){let t=this.buffer.indexOf(this.iacSEBuffer);if(t===-1)return!0;this.state=0;let r=this.buffer.slice(0,t);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(t+2),!1}handleGmcp(t){const r=t.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(t,r){this.stream.write(Xr.Buffer.from([255,t,r]))}sendGmcp(t,r){const i=t+" "+r,o=Xr.Buffer.from(i),a=Xr.Buffer.concat([Xr.Buffer.from([255,250]),Xr.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(a)}sendTerminalType(t){const r=Xr.Buffer.from(t),i=Xr.Buffer.concat([Xr.Buffer.from([255,250]),Xr.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function tD({onlyFirst:n=!1}={}){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(t,n?void 0:"g")}const nD=tD();function rD(n){if(typeof n!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof n}\``);return n.replace(nD,"")}class iD{constructor(e){ee(this,"editors");ee(this,"channel");this.client=e,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(e){console.log("Opening editor window for session:",e);const t=e.reference,r=this.editors.get(t);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(t),o=window.open(`/editor?reference=${i}`,"_blank"),a={...e,window:o,state:0};this.editors.set(t,a),o&&o.focus()}}saveEditorWindow(e){const t={reference:e.reference,type:e.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",t,e.contents)}setupChannelListeners(){this.channel.onmessage=e=>{console.log("Editor window message:",e);const{type:t,id:r,session:i}=e.data;switch(t){case"ready":console.log("Editor window ready, id:",r);const o=this.editors.get(r);if(o){o.state=1;const{window:l,...u}=o;this.channel.postMessage({type:"load",session:u})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const a=this.editors.get(r);a&&(a.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((e,t)=>{try{e.state===1&&e.window&&(console.log(`Closing editor window for ${t}`),e.window.close(),this.channel.postMessage({type:"shutdown",id:t}))}catch(r){console.error(`Error closing editor window ${t}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class Un{constructor(e){ee(this,"packageName");ee(this,"packageVersion",1);ee(this,"client");this.client=e}sendData(e,t){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(t))}shutdown(){}}class oD extends Un{constructor(){super(...arguments);ee(this,"packageName","Auth.Autologin")}handleToken(t){localStorage.setItem("LoginRefreshToken",t)}sendLogin(){var t=localStorage.getItem("LoginRefreshToken");t&&this.sendData("Login",t)}}class vS extends Un{constructor(){super(...arguments);ee(this,"packageName","Char")}handleName(t){this.client.worldData.playerId=t.name,this.client.worldData.playerName=t.fullname,this.client.emit("statustext",`Logged in as ${t.fullname}`)}handleVitals(t){console.log("Received Char.Vitals:",t),this.client.emit("vitals",t)}handleStatusVars(t){console.log("Received Char.StatusVars:",t),this.client.emit("statusVars",t)}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("statusUpdate",t)}sendLogin(t,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:t,password:r}))}}class sD extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Offer")}handleOffer(t){console.log("Received Char.Offer:",t),this.client.emit("offer",t)}sendOfferRequest(){this.sendData("Offer",{})}}class aD extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Prompt")}handlePrompt(t){console.log("Received Char.Prompt:",t),this.client.emit("prompt",t)}sendPromptRequest(){this.sendData("Prompt",{})}}class lD extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Status")}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("status",t)}sendStatusRequest(){this.sendData("Status",{})}}class cD extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Status.AffectedBy")}handleAffectedBy(t){console.log("Received Char.Status.AffectedBy:",t),this.client.emit("statusAffectedBy",t)}sendAffectedByRequest(){this.sendData("AffectedBy",{})}}class uD extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Status.Conditions")}handleConditions(t){console.log("Received Char.Status.Conditions:",t),this.client.emit("statusConditions",t)}sendConditionsRequest(){this.sendData("Conditions",{})}}class dD extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Status.Timers")}handleTimers(t){console.log("Received Char.Status.Timers:",t),this.client.emit("statusTimers",t)}sendTimersRequest(){this.sendData("Timers",{})}}class CS extends Un{constructor(){super(...arguments);ee(this,"packageName","Client.FileTransfer")}sendCandidate(t,r){this.sendData("Candidate",{recipient:t,candidate:JSON.stringify(r)})}handleCandidate(t){const r=JSON.parse(t.candidate);this.client.webRTCService.handleIceCandidate(r)}handleOffer(t){console.log("[GMCPClientFileTransfer] Received offer:",t),this.client.fileTransferManager.pendingOffers.set(`${t.hash}`,t),this.client.onFileTransferOffer(t.sender,t.hash,t.filename,t.filesize,t.offerSdp)}handleAccept(t){this.client.onFileTransferAccept(t.sender,t.hash,t.filename,t.answerSdp)}handleReject(t){this.client.onFileTransferReject(t.sender,t.hash)}handleCancel(t){this.client.onFileTransferCancel(t.sender,t.hash)}sendOffer(t,r,i,o,a){this.sendData("Offer",{recipient:t,filename:r,filesize:i,offerSdp:o,hash:a})}sendAccept(t,r,i,o){this.sendData("Accept",{sender:t,hash:r,filename:i,answerSdp:o})}sendReject(t,r){this.sendData("Reject",{sender:t,hash:r})}sendCancel(t,r){this.sendData("Cancel",{recipient:t,hash:r})}sendRequestResend(t,r){this.sendData("RequestResend",{sender:t,hash:r})}}function YC(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Rc=YC();function yS(n){Rc=n}var sf={exec:()=>null};function gn(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(i,o)=>{let a=typeof o=="string"?o:o.source;return a=a.replace(ui.caret,"$1"),t=t.replace(i,a),r},getRegex:()=>new RegExp(t,e)};return r}var ui={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},fD=/^(?:[ \t]*(?:\n|$))+/,hD=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,pD=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Of=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,gD=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,qC=/(?:[*+-]|\d{1,9}[.)])/,xS=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,IS=gn(xS).replace(/bull/g,qC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),mD=gn(xS).replace(/bull/g,qC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),QC=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,vD=/^[^\n]+/,ey=/(?!\s*\])(?:\\.|[^\[\]\\])+/,CD=gn(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ey).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),yD=gn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,qC).getRegex(),H0="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ty=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,xD=gn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ty).replace("tag",H0).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),bS=gn(QC).replace("hr",Of).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",H0).getRegex(),ID=gn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",bS).getRegex(),ny={blockquote:ID,code:hD,def:CD,fences:pD,heading:gD,hr:Of,html:xD,lheading:IS,list:yD,newline:fD,paragraph:bS,table:sf,text:vD},$I=gn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Of).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",H0).getRegex(),bD={...ny,lheading:mD,table:$I,paragraph:gn(QC).replace("hr",Of).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",$I).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",H0).getRegex()},AD={...ny,html:gn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ty).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:sf,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:gn(QC).replace("hr",Of).replace("heading",` *#{1,6} *[^
]`).replace("lheading",IS).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},wD=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,SD=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,AS=/^( {2,}|\\)\n(?!\s*$)/,kD=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Z0=/[\p{P}\p{S}]/u,ry=/[\s\p{P}\p{S}]/u,wS=/[^\s\p{P}\p{S}]/u,ED=gn(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,ry).getRegex(),SS=/(?!~)[\p{P}\p{S}]/u,TD=/(?!~)[\s\p{P}\p{S}]/u,RD=/(?:[^\s\p{P}\p{S}]|~)/u,_D=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,kS=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,PD=gn(kS,"u").replace(/punct/g,Z0).getRegex(),DD=gn(kS,"u").replace(/punct/g,SS).getRegex(),ES="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",ND=gn(ES,"gu").replace(/notPunctSpace/g,wS).replace(/punctSpace/g,ry).replace(/punct/g,Z0).getRegex(),BD=gn(ES,"gu").replace(/notPunctSpace/g,RD).replace(/punctSpace/g,TD).replace(/punct/g,SS).getRegex(),OD=gn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,wS).replace(/punctSpace/g,ry).replace(/punct/g,Z0).getRegex(),FD=gn(/\\(punct)/,"gu").replace(/punct/g,Z0).getRegex(),MD=gn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),LD=gn(ty).replace("(?:-->|$)","-->").getRegex(),UD=gn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",LD).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),g0=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,VD=gn(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",g0).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),TS=gn(/^!?\[(label)\]\[(ref)\]/).replace("label",g0).replace("ref",ey).getRegex(),RS=gn(/^!?\[(ref)\](?:\[\])?/).replace("ref",ey).getRegex(),GD=gn("reflink|nolink(?!\\()","g").replace("reflink",TS).replace("nolink",RS).getRegex(),iy={_backpedal:sf,anyPunctuation:FD,autolink:MD,blockSkip:_D,br:AS,code:SD,del:sf,emStrongLDelim:PD,emStrongRDelimAst:ND,emStrongRDelimUnd:OD,escape:wD,link:VD,nolink:RS,punctuation:ED,reflink:TS,reflinkSearch:GD,tag:UD,text:kD,url:sf},WD={...iy,link:gn(/^!?\[(label)\]\((.*?)\)/).replace("label",g0).getRegex(),reflink:gn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",g0).getRegex()},Dv={...iy,emStrongRDelimAst:BD,emStrongLDelim:DD,url:gn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},jD={...Dv,br:gn(AS).replace("{2,}","*").getRegex(),text:gn(Dv.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},qh={normal:ny,gfm:bD,pedantic:AD},Ld={normal:iy,gfm:Dv,breaks:jD,pedantic:WD},zD={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},JI=n=>zD[n];function ms(n,e){if(e){if(ui.escapeTest.test(n))return n.replace(ui.escapeReplace,JI)}else if(ui.escapeTestNoEncode.test(n))return n.replace(ui.escapeReplaceNoEncode,JI);return n}function YI(n){try{n=encodeURI(n).replace(ui.percentDecode,"%")}catch{return null}return n}function qI(n,e){var o;const t=n.replace(ui.findPipe,(a,l,u)=>{let d=!1,f=l;for(;--f>=0&&u[f]==="\\";)d=!d;return d?"|":" |"}),r=t.split(ui.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(ui.slashPipe,"|");return r}function Ud(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function HD(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function QI(n,e,t,r,i){const o=e.href,a=e.title||null,l=n[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const u={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:o,title:a,text:l,tokens:r.inlineTokens(l)};return r.state.inLink=!1,u}function ZD(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(o=>{const a=o.match(t.other.beginningSpace);if(a===null)return o;const[l]=a;return l.length>=i.length?o.slice(i.length):o}).join(`
`)}var m0=class{constructor(n){ee(this,"options");ee(this,"rules");ee(this,"lexer");this.options=n||Rc}space(n){const e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){const e=this.rules.block.code.exec(n);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Ud(t,`
`)}}}fences(n){const e=this.rules.block.fences.exec(n);if(e){const t=e[0],r=ZD(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(n){const e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const r=Ud(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){const e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:Ud(e[0],`
`)}}blockquote(n){const e=this.rules.block.blockquote.exec(n);if(e){let t=Ud(e[0],`
`).split(`
`),r="",i="";const o=[];for(;t.length>0;){let a=!1;const l=[];let u;for(u=0;u<t.length;u++)if(this.rules.other.blockquoteStart.test(t[u]))l.push(t[u]),a=!0;else if(!a)l.push(t[u]);else break;t=t.slice(u);const d=l.join(`
`),f=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${d}`:d,i=i?`${i}
${f}`:f;const p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(f,o,!0),this.lexer.state.top=p,t.length===0)break;const g=o.at(-1);if((g==null?void 0:g.type)==="code")break;if((g==null?void 0:g.type)==="blockquote"){const v=g,C=v.raw+`
`+t.join(`
`),y=this.blockquote(C);o[o.length-1]=y,r=r.substring(0,r.length-v.raw.length)+y.raw,i=i.substring(0,i.length-v.text.length)+y.text;break}else if((g==null?void 0:g.type)==="list"){const v=g,C=v.raw+`
`+t.join(`
`),y=this.list(C);o[o.length-1]=y,r=r.substring(0,r.length-g.raw.length)+y.raw,i=i.substring(0,i.length-v.raw.length)+y.raw,t=C.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:i}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim();const r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");const o=this.rules.other.listItemRegex(t);let a=!1;for(;n;){let u=!1,d="",f="";if(!(e=o.exec(n))||this.rules.block.hr.test(n))break;d=e[0],n=n.substring(d.length);let p=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,I=>" ".repeat(3*I.length)),g=n.split(`
`,1)[0],v=!p.trim(),C=0;if(this.options.pedantic?(C=2,f=p.trimStart()):v?C=e[1].length+1:(C=e[2].search(this.rules.other.nonSpaceChar),C=C>4?1:C,f=p.slice(C),C+=e[1].length),v&&this.rules.other.blankLine.test(g)&&(d+=g+`
`,n=n.substring(g.length+1),u=!0),!u){const I=this.rules.other.nextBulletRegex(C),b=this.rules.other.hrRegex(C),T=this.rules.other.fencesBeginRegex(C),R=this.rules.other.headingBeginRegex(C),P=this.rules.other.htmlBeginRegex(C);for(;n;){const B=n.split(`
`,1)[0];let _;if(g=B,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),_=g):_=g.replace(this.rules.other.tabCharGlobal,"    "),T.test(g)||R.test(g)||P.test(g)||I.test(g)||b.test(g))break;if(_.search(this.rules.other.nonSpaceChar)>=C||!g.trim())f+=`
`+_.slice(C);else{if(v||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||T.test(p)||R.test(p)||b.test(p))break;f+=`
`+g}!v&&!g.trim()&&(v=!0),d+=B+`
`,n=n.substring(B.length+1),p=_.slice(C)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(a=!0));let y=null,x;this.options.gfm&&(y=this.rules.other.listIsTask.exec(f),y&&(x=y[0]!=="[ ] ",f=f.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:d,task:!!y,checked:x,loose:!1,text:f,tokens:[]}),i.raw+=d}const l=i.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let u=0;u<i.items.length;u++)if(this.lexer.state.top=!1,i.items[u].tokens=this.lexer.blockTokens(i.items[u].text,[]),!i.loose){const d=i.items[u].tokens.filter(p=>p.type==="space"),f=d.length>0&&d.some(p=>this.rules.other.anyLine.test(p.raw));i.loose=f}if(i.loose)for(let u=0;u<i.items.length;u++)i.items[u].loose=!0;return i}}html(n){const e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){const e=this.rules.block.def.exec(n);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){var a;const e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=qI(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(const l of r)this.rules.other.tableAlignRight.test(l)?o.align.push("right"):this.rules.other.tableAlignCenter.test(l)?o.align.push("center"):this.rules.other.tableAlignLeft.test(l)?o.align.push("left"):o.align.push(null);for(let l=0;l<t.length;l++)o.header.push({text:t[l],tokens:this.lexer.inline(t[l]),header:!0,align:o.align[l]});for(const l of i)o.rows.push(qI(l,o.header.length).map((u,d)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:o.align[d]})));return o}}lheading(n){const e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){const e=this.rules.block.paragraph.exec(n);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){const e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){const e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){const e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){const e=this.rules.inline.link.exec(n);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const o=Ud(t.slice(0,-1),"\\");if((t.length-o.length)%2===0)return}else{const o=HD(e[2],"()");if(o===-2)return;if(o>-1){const l=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),QI(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){const r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[r.toLowerCase()];if(!i){const o=t[0].charAt(0);return{type:"text",raw:o,text:o}}return QI(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(n);if(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const o=[...r[0]].length-1;let a,l,u=o,d=0;const f=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,e=e.slice(-1*n.length+o);(r=f.exec(e))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(l=[...a].length,r[3]||r[4]){u+=l;continue}else if((r[5]||r[6])&&o%3&&!((o+l)%3)){d+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+d);const p=[...r[0]][0].length,g=n.slice(0,o+r.index+p+l);if(Math.min(o,l)%2){const C=g.slice(1,-1);return{type:"em",raw:g,text:C,tokens:this.lexer.inlineTokens(C)}}const v=g.slice(2,-2);return{type:"strong",raw:g,text:v,tokens:this.lexer.inlineTokens(v)}}}}codespan(n){const e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){const e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){const e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){const e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){var t;let e;if(e=this.rules.inline.url.exec(n)){let r,i;if(e[2]==="@")r=e[0],i="mailto:"+r;else{let o;do o=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(o!==e[0]);r=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(n){const e=this.rules.inline.text.exec(n);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},da=class Nv{constructor(e){ee(this,"tokens");ee(this,"options");ee(this,"state");ee(this,"tokenizer");ee(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Rc,this.options.tokenizer=this.options.tokenizer||new m0,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:ui,block:qh.normal,inline:Ld.normal};this.options.pedantic?(t.block=qh.pedantic,t.inline=Ld.pedantic):this.options.gfm&&(t.block=qh.gfm,this.options.breaks?t.inline=Ld.breaks:t.inline=Ld.gfm),this.tokenizer.rules=t}static get rules(){return{block:qh,inline:Ld}}static lex(e,t){return new Nv(t).lex(e)}static lexInline(e,t){return new Nv(t).inlineTokens(e)}lex(e){e=e.replace(ui.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){var i,o,a;for(this.options.pedantic&&(e=e.replace(ui.tabCharGlobal,"    ").replace(ui.spaceLine,""));e;){let l;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(d=>(l=d.call({lexer:this},e,t))?(e=e.substring(l.raw.length),t.push(l),!0):!1))continue;if(l=this.tokenizer.space(e)){e=e.substring(l.raw.length);const d=t.at(-1);l.raw.length===1&&d!==void 0?d.raw+=`
`:t.push(l);continue}if(l=this.tokenizer.code(e)){e=e.substring(l.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+l.raw,d.text+=`
`+l.text,this.inlineQueue.at(-1).src=d.text):t.push(l);continue}if(l=this.tokenizer.fences(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.heading(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.hr(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.blockquote(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.list(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.html(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.def(e)){e=e.substring(l.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+l.raw,d.text+=`
`+l.raw,this.inlineQueue.at(-1).src=d.text):this.tokens.links[l.tag]||(this.tokens.links[l.tag]={href:l.href,title:l.title});continue}if(l=this.tokenizer.table(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.lheading(e)){e=e.substring(l.raw.length),t.push(l);continue}let u=e;if((a=this.options.extensions)!=null&&a.startBlock){let d=1/0;const f=e.slice(1);let p;this.options.extensions.startBlock.forEach(g=>{p=g.call({lexer:this},f),typeof p=="number"&&p>=0&&(d=Math.min(d,p))}),d<1/0&&d>=0&&(u=e.substring(0,d+1))}if(this.state.top&&(l=this.tokenizer.paragraph(u))){const d=t.at(-1);r&&(d==null?void 0:d.type)==="paragraph"?(d.raw+=`
`+l.raw,d.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):t.push(l),r=u.length!==e.length,e=e.substring(l.raw.length);continue}if(l=this.tokenizer.text(e)){e=e.substring(l.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=`
`+l.raw,d.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):t.push(l);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var l,u,d;let r=e,i=null;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)f.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,a="";for(;e;){o||(a=""),o=!1;let f;if((u=(l=this.options.extensions)==null?void 0:l.inline)!=null&&u.some(g=>(f=g.call({lexer:this},e,t))?(e=e.substring(f.raw.length),t.push(f),!0):!1))continue;if(f=this.tokenizer.escape(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.tag(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.link(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(f.raw.length);const g=t.at(-1);f.type==="text"&&(g==null?void 0:g.type)==="text"?(g.raw+=f.raw,g.text+=f.text):t.push(f);continue}if(f=this.tokenizer.emStrong(e,r,a)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.codespan(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.br(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.del(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.autolink(e)){e=e.substring(f.raw.length),t.push(f);continue}if(!this.state.inLink&&(f=this.tokenizer.url(e))){e=e.substring(f.raw.length),t.push(f);continue}let p=e;if((d=this.options.extensions)!=null&&d.startInline){let g=1/0;const v=e.slice(1);let C;this.options.extensions.startInline.forEach(y=>{C=y.call({lexer:this},v),typeof C=="number"&&C>=0&&(g=Math.min(g,C))}),g<1/0&&g>=0&&(p=e.substring(0,g+1))}if(f=this.tokenizer.inlineText(p)){e=e.substring(f.raw.length),f.raw.slice(-1)!=="_"&&(a=f.raw.slice(-1)),o=!0;const g=t.at(-1);(g==null?void 0:g.type)==="text"?(g.raw+=f.raw,g.text+=f.text):t.push(f);continue}if(e){const g="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return t}},v0=class{constructor(n){ee(this,"options");ee(this,"parser");this.options=n||Rc}space(n){return""}code({text:n,lang:e,escaped:t}){var o;const r=(o=(e||"").match(ui.notSpaceStart))==null?void 0:o[0],i=n.replace(ui.endingNewline,"")+`
`;return r?'<pre><code class="language-'+ms(r)+'">'+(t?i:ms(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:ms(i,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){const e=n.ordered,t=n.start;let r="";for(let a=0;a<n.items.length;a++){const l=n.items[a];r+=this.listitem(l)}const i=e?"ol":"ul",o=e&&t!==1?' start="'+t+'"':"";return"<"+i+o+`>
`+r+"</"+i+`>
`}listitem(n){var t;let e="";if(n.task){const r=this.checkbox({checked:!!n.checked});n.loose?((t=n.tokens[0])==null?void 0:t.type)==="paragraph"?(n.tokens[0].text=r+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&n.tokens[0].tokens[0].type==="text"&&(n.tokens[0].tokens[0].text=r+" "+ms(n.tokens[0].tokens[0].text),n.tokens[0].tokens[0].escaped=!0)):n.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return e+=this.parser.parse(n.tokens,!!n.loose),`<li>${e}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let i=0;i<n.header.length;i++)t+=this.tablecell(n.header[i]);e+=this.tablerow({text:t});let r="";for(let i=0;i<n.rows.length;i++){const o=n.rows[i];t="";for(let a=0;a<o.length;a++)t+=this.tablecell(o[a]);r+=this.tablerow({text:t})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){const e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${ms(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){const r=this.parser.parseInline(t),i=YI(n);if(i===null)return r;n=i;let o='<a href="'+n+'"';return e&&(o+=' title="'+ms(e)+'"'),o+=">"+r+"</a>",o}image({href:n,title:e,text:t,tokens:r}){r&&(t=this.parser.parseInline(r,this.parser.textRenderer));const i=YI(n);if(i===null)return ms(t);n=i;let o=`<img src="${n}" alt="${t}"`;return e&&(o+=` title="${ms(e)}"`),o+=">",o}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:ms(n.text)}},oy=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},fa=class Bv{constructor(e){ee(this,"options");ee(this,"renderer");ee(this,"textRenderer");this.options=e||Rc,this.options.renderer=this.options.renderer||new v0,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new oy}static parse(e,t){return new Bv(t).parse(e)}static parseInline(e,t){return new Bv(t).parseInline(e)}parse(e,t=!0){var i,o;let r="";for(let a=0;a<e.length;a++){const l=e[a];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[l.type]){const d=l,f=this.options.extensions.renderers[d.type].call({parser:this},d);if(f!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type)){r+=f||"";continue}}const u=l;switch(u.type){case"space":{r+=this.renderer.space(u);continue}case"hr":{r+=this.renderer.hr(u);continue}case"heading":{r+=this.renderer.heading(u);continue}case"code":{r+=this.renderer.code(u);continue}case"table":{r+=this.renderer.table(u);continue}case"blockquote":{r+=this.renderer.blockquote(u);continue}case"list":{r+=this.renderer.list(u);continue}case"html":{r+=this.renderer.html(u);continue}case"paragraph":{r+=this.renderer.paragraph(u);continue}case"text":{let d=u,f=this.renderer.text(d);for(;a+1<e.length&&e[a+1].type==="text";)d=e[++a],f+=`
`+this.renderer.text(d);t?r+=this.renderer.paragraph({type:"paragraph",raw:f,text:f,tokens:[{type:"text",raw:f,text:f,escaped:!0}]}):r+=f;continue}default:{const d='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}parseInline(e,t=this.renderer){var i,o;let r="";for(let a=0;a<e.length;a++){const l=e[a];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[l.type]){const d=this.options.extensions.renderers[l.type].call({parser:this},l);if(d!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){r+=d||"";continue}}const u=l;switch(u.type){case"escape":{r+=t.text(u);break}case"html":{r+=t.html(u);break}case"link":{r+=t.link(u);break}case"image":{r+=t.image(u);break}case"strong":{r+=t.strong(u);break}case"em":{r+=t.em(u);break}case"codespan":{r+=t.codespan(u);break}case"br":{r+=t.br(u);break}case"del":{r+=t.del(u);break}case"text":{r+=t.text(u);break}default:{const d='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}},Ev,fp=(Ev=class{constructor(n){ee(this,"options");ee(this,"block");this.options=n||Rc}preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?da.lex:da.lexInline}provideParser(){return this.block?fa.parse:fa.parseInline}},ee(Ev,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Ev),XD=class{constructor(...n){ee(this,"defaults",YC());ee(this,"options",this.setOptions);ee(this,"parse",this.parseMarkdown(!0));ee(this,"parseInline",this.parseMarkdown(!1));ee(this,"Parser",fa);ee(this,"Renderer",v0);ee(this,"TextRenderer",oy);ee(this,"Lexer",da);ee(this,"Tokenizer",m0);ee(this,"Hooks",fp);this.use(...n)}walkTokens(n,e){var r,i;let t=[];for(const o of n)switch(t=t.concat(e.call(this,o)),o.type){case"table":{const a=o;for(const l of a.header)t=t.concat(this.walkTokens(l.tokens,e));for(const l of a.rows)for(const u of l)t=t.concat(this.walkTokens(u.tokens,e));break}case"list":{const a=o;t=t.concat(this.walkTokens(a.items,e));break}default:{const a=o;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const u=a[l].flat(1/0);t=t.concat(this.walkTokens(u,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const o=e.renderers[i.name];o?e.renderers[i.name]=function(...a){let l=i.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){const i=this.defaults.renderer||new v0(this.defaults);for(const o in t.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const a=o,l=t.renderer[a],u=i[a];i[a]=(...d)=>{let f=l.apply(i,d);return f===!1&&(f=u.apply(i,d)),f||""}}r.renderer=i}if(t.tokenizer){const i=this.defaults.tokenizer||new m0(this.defaults);for(const o in t.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,l=t.tokenizer[a],u=i[a];i[a]=(...d)=>{let f=l.apply(i,d);return f===!1&&(f=u.apply(i,d)),f}}r.tokenizer=i}if(t.hooks){const i=this.defaults.hooks||new fp;for(const o in t.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const a=o,l=t.hooks[a],u=i[a];fp.passThroughHooks.has(o)?i[a]=d=>{if(this.defaults.async)return Promise.resolve(l.call(i,d)).then(p=>u.call(i,p));const f=l.call(i,d);return u.call(i,f)}:i[a]=(...d)=>{let f=l.apply(i,d);return f===!1&&(f=u.apply(i,d)),f}}r.hooks=i}if(t.walkTokens){const i=this.defaults.walkTokens,o=t.walkTokens;r.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),i&&(l=l.concat(i.call(this,a))),l}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return da.lex(n,e??this.defaults)}parser(n,e){return fa.parse(n,e??this.defaults)}parseMarkdown(n){return(t,r)=>{const i={...r},o={...this.defaults,...i},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=n);const l=o.hooks?o.hooks.provideLexer():n?da.lex:da.lexInline,u=o.hooks?o.hooks.provideParser():n?fa.parse:fa.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then(d=>l(d,o)).then(d=>o.hooks?o.hooks.processAllTokens(d):d).then(d=>o.walkTokens?Promise.all(this.walkTokens(d,o.walkTokens)).then(()=>d):d).then(d=>u(d,o)).then(d=>o.hooks?o.hooks.postprocess(d):d).catch(a);try{o.hooks&&(t=o.hooks.preprocess(t));let d=l(t,o);o.hooks&&(d=o.hooks.processAllTokens(d)),o.walkTokens&&this.walkTokens(d,o.walkTokens);let f=u(d,o);return o.hooks&&(f=o.hooks.postprocess(f)),f}catch(d){return a(d)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const r="<p>An error occurred:</p><pre>"+ms(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},yc=new XD;function Cn(n,e){return yc.parse(n,e)}Cn.options=Cn.setOptions=function(n){return yc.setOptions(n),Cn.defaults=yc.defaults,yS(Cn.defaults),Cn};Cn.getDefaults=YC;Cn.defaults=Rc;Cn.use=function(...n){return yc.use(...n),Cn.defaults=yc.defaults,yS(Cn.defaults),Cn};Cn.walkTokens=function(n,e){return yc.walkTokens(n,e)};Cn.parseInline=yc.parseInline;Cn.Parser=fa;Cn.parser=fa.parse;Cn.Renderer=v0;Cn.TextRenderer=oy;Cn.Lexer=da;Cn.lexer=da.lex;Cn.Tokenizer=m0;Cn.Hooks=fp;Cn.parse=Cn;Cn.options;Cn.setOptions;Cn.use;Cn.walkTokens;Cn.parseInline;fa.parse;da.lex;class KD extends Un{constructor(t){super(t);ee(this,"packageName","Client.Html")}handleAdd_html(t){this.client.emit("html",t.data.join(`
`))}handleAdd_markdown(t){const r=t.data.join(`
`),i=Cn(r);this.client.emit("html",i)}}class $D{constructor(){ee(this,"state",{text:""});ee(this,"listeners",new Set);ee(this,"dispatch",e=>{const t=this.state;this.state=this.reducer(this.state,e),this.state!==t&&this.listeners.forEach(r=>r())})}reducer(e,t){switch(t.type){case"SET_INPUT":return e.text!==t.data?{...e,text:t.data}:e;case"CLEAR_INPUT":return e.text!==""?{...e,text:""}:e;default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const Cu=new $D,cc=n=>{Cu.dispatch({type:"SET_INPUT",data:n})},JD=()=>{Cu.dispatch({type:"CLEAR_INPUT"})};class YD extends Un{constructor(t){super(t);ee(this,"packageName","Client.Keystrokes");ee(this,"bindings",[]);ee(this,"boundKeyDownHandler");this.boundKeyDownHandler=this.handleKeydown.bind(this),document.addEventListener("keydown",this.boundKeyDownHandler)}handleKeydown(t){const r=this.findBinding(t);if(r){t.preventDefault();const i=Cu.getState().text,o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",this.boundKeyDownHandler)}findBinding(t){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==t.key.toLowerCase())return!1;const i=new Set([t.altKey&&"alt",t.ctrlKey&&"control",t.shiftKey&&"shift",t.metaKey&&"meta"].filter(Boolean)),o=new Set((r.modifiers||[]).map(a=>a.toLowerCase()));return i.size!==o.size?!1:Array.from(o).every(a=>i.has(a))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(t,r){const i=r.trim().split(/\s+/);return t.replace(/%(\d+|\*)/g,(o,a)=>{if(a==="*")return r;const l=parseInt(a,10)-1;return l>=0&&l<i.length?i[l]:o})}placeInInputField(t){cc(t)}bindKey(t){const r={key:t.key,modifiers:t.modifiers,command:t.command,autosend:t.autosend};this.bindings.push(r)}unbindKey(t){const r=new Set((t.modifiers||[]).map(i=>i.toLowerCase()));this.bindings=this.bindings.filter(i=>{const o=new Set((i.modifiers||[]).map(l=>l.toLowerCase()));return i.key.toLowerCase()!==t.key.toLowerCase()||o.size!==r.size?!0:!Array.from(r).every(l=>o.has(l))})}unbindAll(){this.bindings=[]}handleBind(t){this.bindKey(t)}handleUnbind(t){this.unbindKey(t)}handleBind_all(t){this.bindings=t.bindings.map(r=>({...r}))}handleUnbindAll(t){console.log("Received Client.Keystrokes.UnbindAll, clearing all bindings."),this.unbindAll()}handleListBindings(t){console.log("Received Client.Keystrokes.ListBindings request, sending current bindings.");const r=this.listBindings();this.sendData("BindingsList",r)}listBindings(){return[...this.bindings]}}const eb=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),tb=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),Ov=(n,e)=>({startTime:e,type:"setValue",value:n}),_S=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),PS=(n,e,{startTime:t,target:r,timeConstant:i})=>r+(e-r)*Math.exp((t-n)/i),gu=n=>n.type==="exponentialRampToValue",C0=n=>n.type==="linearRampToValue",Cl=n=>gu(n)||C0(n),sy=n=>n.type==="setValue",sa=n=>n.type==="setValueCurve",y0=(n,e,t,r)=>{const i=n[e];return i===void 0?r:Cl(i)||sy(i)?i.value:sa(i)?i.values[i.values.length-1]:PS(t,y0(n,e-1,i.startTime,r),i)},nb=(n,e,t,r,i)=>t===void 0?[r.insertTime,i]:Cl(t)?[t.endTime,t.value]:sy(t)?[t.startTime,t.value]:sa(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,y0(n,e-1,t.startTime,i)],Fv=n=>n.type==="cancelAndHold",Mv=n=>n.type==="cancelScheduledValues",ul=n=>Fv(n)||Mv(n)?n.cancelTime:gu(n)||C0(n)?n.endTime:n.startTime,rb=(n,e,t,{endTime:r,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(r-e)):0,ib=(n,e,t,{endTime:r,value:i})=>t+(n-e)/(r-e)*(i-t),qD=(n,e)=>{const t=Math.floor(e),r=Math.ceil(e);return t===r?n[t]:(1-(e-t))*n[t]+(1-(r-e))*n[r]},QD=(n,{duration:e,startTime:t,values:r})=>{const i=(n-t)/e*(r.length-1);return qD(r,i)},Qh=n=>n.type==="setTarget";class e3{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=ul(e);if(Fv(e)||Mv(e)){const r=this._automationEvents.findIndex(o=>Mv(e)&&sa(o)?o.startTime+o.duration>=t:ul(o)>=t),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Fv(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Cl(i)){if(o!==void 0&&Qh(o))throw new Error("The internal list is malformed.");const a=o===void 0?i.insertTime:sa(o)?o.startTime+o.duration:ul(o),l=o===void 0?this._defaultValue:sa(o)?o.values[o.values.length-1]:o.value,u=gu(i)?rb(t,a,l,i):ib(t,a,l,i),d=gu(i)?eb(u,t,this._currenTime):tb(u,t,this._currenTime);this._automationEvents.push(d)}if(o!==void 0&&Qh(o)&&this._automationEvents.push(Ov(this.getValue(t),t)),o!==void 0&&sa(o)&&o.startTime+o.duration>t){const a=t-o.startTime,l=(o.values.length-1)/o.duration,u=Math.max(2,1+Math.ceil(a*l)),d=a/(u-1)*l,f=o.values.slice(0,u);if(d<1)for(let p=1;p<u;p+=1){const g=d*p%1;f[p]=o.values[p-1]*(1-g)+o.values[p]*g}this._automationEvents[this._automationEvents.length-1]=_S(f,o.startTime,a)}}}else{const r=this._automationEvents.findIndex(a=>ul(a)>t),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&sa(i)&&ul(i)+i.duration>t)return!1;const o=gu(e)?eb(e.value,e.endTime,this._currenTime):C0(e)?tb(e.value,t,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(sa(e)&&t+e.duration>ul(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const t=this._automationEvents.findIndex(r=>ul(r)>e);if(t>1){const r=this._automationEvents.slice(t-1),i=r[0];Qh(i)&&r.unshift(Ov(y0(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>ul(a)>e),r=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,o=this._automationEvents[i];if(o!==void 0&&Qh(o)&&(r===void 0||!Cl(r)||r.insertTime>e))return PS(e,y0(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&sy(o)&&(r===void 0||!Cl(r)))return o.value;if(o!==void 0&&sa(o)&&(r===void 0||!Cl(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?QD(e,o):o.values[o.values.length-1];if(o!==void 0&&Cl(o)&&(r===void 0||!Cl(r)))return o.value;if(r!==void 0&&gu(r)){const[a,l]=nb(this._automationEvents,i,o,r,this._defaultValue);return rb(e,a,l,r)}if(r!==void 0&&C0(r)){const[a,l]=nb(this._automationEvents,i,o,r,this._defaultValue);return ib(e,a,l,r)}return this._defaultValue}}const t3=n=>({cancelTime:n,type:"cancelAndHold"}),n3=n=>({cancelTime:n,type:"cancelScheduledValues"}),r3=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),i3=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),o3=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),s3=()=>new DOMException("","AbortError"),a3=n=>(e,t,[r,i,o],a)=>{n(e[i],[t,r,o],l=>l[0]===t&&l[1]===r,a)},l3=n=>(e,t,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},c3=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Nu=new WeakSet,DS=new WeakMap,NS=new WeakMap,BS=new WeakMap,OS=new WeakMap,FS=new WeakMap,MS=new WeakMap,Lv=new WeakMap,Uv=new WeakMap,Vv=new WeakMap,LS={construct(){return LS}},u3=n=>{try{const e=new Proxy(n,LS);new e}catch{return!1}return!0},ob=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,sb=(n,e)=>{const t=[];let r=n.replace(/^[\s]+/,""),i=r.match(ob);for(;i!==null;){const o=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());t.push(a),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(ob)}return[t.join(";"),r]},ab=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},lb=n=>{if(!u3(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},d3=(n,e,t,r,i,o,a,l,u,d,f,p,g)=>{let v=0;return(C,y,x={credentials:"omit"})=>{const I=f.get(C);if(I!==void 0&&I.has(y))return Promise.resolve();const b=d.get(C);if(b!==void 0){const P=b.get(y);if(P!==void 0)return P}const T=o(C),R=T.audioWorklet===void 0?i(y).then(([P,B])=>{const[_,M]=sb(P,B),H=`${_};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${M}
})})(window,'_AWGS')`;return t(H)}).then(()=>{const P=g._AWGS.pop();if(P===void 0)throw new SyntaxError;r(T.currentTime,T.sampleRate,()=>P(class{},void 0,(B,_)=>{if(B.trim()==="")throw e();const M=Uv.get(T);if(M!==void 0){if(M.has(B))throw e();lb(_),ab(_.parameterDescriptors),M.set(B,_)}else lb(_),ab(_.parameterDescriptors),Uv.set(T,new Map([[B,_]]))},T.sampleRate,void 0,void 0))}):Promise.all([i(y),Promise.resolve(n(p,p))]).then(([[P,B],_])=>{const M=v+1;v=M;const[H,V]=sb(P,B),ie=`${H};((AudioWorkletProcessor,registerProcessor)=>{${V}
})(${_?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${_?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${_?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${M}',class extends AudioWorkletProcessor{process(){return !1}})`,le=new Blob([ie],{type:"application/javascript; charset=utf-8"}),Ce=URL.createObjectURL(le);return T.audioWorklet.addModule(Ce,x).then(()=>{if(l(T))return T;const Re=a(T);return Re.audioWorklet.addModule(Ce,x).then(()=>Re)}).then(Re=>{if(u===null)throw new SyntaxError;try{new u(Re,`__sac${M}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(Ce))});return b===void 0?d.set(C,new Map([[y,R]])):b.set(y,R),R.then(()=>{const P=f.get(C);P===void 0?f.set(C,new Set([y])):P.add(y)}).finally(()=>{const P=d.get(C);P!==void 0&&P.delete(y)}),R}},Ko=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},X0=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return n.delete(r),r},US=(n,e,t,r)=>{const i=Ko(n,e),o=X0(i,a=>a[0]===t&&a[1]===r);return i.size===0&&n.delete(e),o},Ff=n=>Ko(MS,n),Bu=n=>{if(Nu.has(n))throw new Error("The AudioNode is already stored.");Nu.add(n),Ff(n).forEach(e=>e(!0))},VS=n=>"port"in n,Mf=n=>{if(!Nu.has(n))throw new Error("The AudioNode is not stored.");Nu.delete(n),Ff(n).forEach(e=>e(!1))},Gv=(n,e)=>{!VS(n)&&e.every(t=>t.size===0)&&Mf(n)},f3=(n,e,t,r,i,o,a,l,u,d,f,p,g)=>{const v=new WeakMap;return(C,y,x,I,b)=>{const{activeInputs:T,passiveInputs:R}=o(y),{outputs:P}=o(C),B=l(C),_=M=>{const H=u(y),V=u(C);if(M){const U=US(R,C,x,I);n(T,C,U,!1),!b&&!p(C)&&t(V,H,x,I),g(y)&&Bu(y)}else{const U=r(T,C,x,I);e(R,I,U,!1),!b&&!p(C)&&i(V,H,x,I);const Z=a(y);if(Z===0)f(y)&&Gv(y,T);else{const q=v.get(y);q!==void 0&&clearTimeout(q),v.set(y,setTimeout(()=>{f(y)&&Gv(y,T)},Z*1e3))}}};return d(P,[y,x,I],M=>M[0]===y&&M[1]===x&&M[2]===I,!0)?(B.add(_),f(C)?n(T,C,[x,I,_],!0):e(R,I,[C,x,_],!0),!0):!1}},h3=n=>(e,t,[r,i,o],a)=>{const l=e.get(r);l===void 0?e.set(r,new Set([[i,t,o]])):n(l,[i,t,o],u=>u[0]===i&&u[1]===t,a)},p3=n=>(e,t)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(r),r.disconnect()};t.addEventListener("ended",i)},g3=n=>(e,t)=>{n(e).add(t)},m3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},v3=(n,e,t,r,i,o)=>class extends n{constructor(l,u){const d=i(l),f={...m3,...u},p=r(d,f),g=o(d)?e():null;super(l,!1,p,g),this._nativeAnalyserNode=p}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(l){this._nativeAnalyserNode.fftSize=l}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(l){const u=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=l,!(l>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=u,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(l){const u=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=l,!(this._nativeAnalyserNode.maxDecibels>l))throw this._nativeAnalyserNode.minDecibels=u,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(l){this._nativeAnalyserNode.smoothingTimeConstant=l}getByteFrequencyData(l){this._nativeAnalyserNode.getByteFrequencyData(l)}getByteTimeDomainData(l){this._nativeAnalyserNode.getByteTimeDomainData(l)}getFloatFrequencyData(l){this._nativeAnalyserNode.getFloatFrequencyData(l)}getFloatTimeDomainData(l){this._nativeAnalyserNode.getFloatTimeDomainData(l)}},qr=(n,e)=>n.context===e,C3=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let l=e(o);if(!qr(l,a)){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,fftSize:l.fftSize,maxDecibels:l.maxDecibels,minDecibels:l.minDecibels,smoothingTimeConstant:l.smoothingTimeConstant};l=n(a,d)}return r.set(a,l),await t(o,a,l),l};return{render(o,a){const l=r.get(a);return l!==void 0?Promise.resolve(l):i(o,a)}}},Wv=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Us=()=>new DOMException("","IndexSizeError"),GS=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(r){throw r.code===12?Us():r}})(n.getChannelData)},y3={numberOfChannels:1},x3=(n,e,t,r,i,o,a,l)=>{let u=null;return class WS{constructor(f){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:p,numberOfChannels:g,sampleRate:v}={...y3,...f};u===null&&(u=new i(1,1,44100));const C=r!==null&&e(o,o)?new r({length:p,numberOfChannels:g,sampleRate:v}):u.createBuffer(g,p,v);if(C.numberOfChannels===0)throw t();return typeof C.copyFromChannel!="function"?(a(C),GS(C)):e(Wv,()=>Wv(C))||l(C),n.add(C),C}static[Symbol.hasInstance](f){return f!==null&&typeof f=="object"&&Object.getPrototypeOf(f)===WS.prototype||n.has(f)}}},Bi=-34028234663852886e22,ai=-Bi,Ma=n=>Nu.has(n),I3={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},b3=(n,e,t,r,i,o,a,l)=>class extends n{constructor(d,f){const p=o(d),g={...I3,...f},v=i(p,g),C=a(p),y=C?e():null;super(d,!1,v,y),this._audioBufferSourceNodeRenderer=y,this._isBufferNullified=!1,this._isBufferSet=g.buffer!==null,this._nativeAudioBufferSourceNode=v,this._onended=null,this._playbackRate=t(this,C,v.playbackRate,ai,Bi)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(d){if(this._nativeAudioBufferSourceNode.buffer=d,d!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(d){this._nativeAudioBufferSourceNode.loop=d}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(d){this._nativeAudioBufferSourceNode.loopEnd=d}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(d){this._nativeAudioBufferSourceNode.loopStart=d}get onended(){return this._onended}set onended(d){const f=typeof d=="function"?l(this,d):null;this._nativeAudioBufferSourceNode.onended=f;const p=this._nativeAudioBufferSourceNode.onended;this._onended=p!==null&&p===f?d:p}get playbackRate(){return this._playbackRate}start(d=0,f=0,p){if(this._nativeAudioBufferSourceNode.start(d,f,p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=p===void 0?[d,f]:[d,f,p]),this.context.state!=="closed"){Bu(this);const g=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",g),Ma(this)&&Mf(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",g)}}stop(d=0){this._nativeAudioBufferSourceNode.stop(d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=d)}},A3=(n,e,t,r,i)=>()=>{const o=new WeakMap;let a=null,l=null;const u=async(d,f)=>{let p=t(d);const g=qr(p,f);if(!g){const v={buffer:p.buffer,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,loop:p.loop,loopEnd:p.loopEnd,loopStart:p.loopStart,playbackRate:p.playbackRate.value};p=e(f,v),a!==null&&p.start(...a),l!==null&&p.stop(l)}return o.set(f,p),g?await n(f,d.playbackRate,p.playbackRate):await r(f,d.playbackRate,p.playbackRate),await i(d,f,p),p};return{set start(d){a=d},set stop(d){l=d},render(d,f){const p=o.get(f);return p!==void 0?Promise.resolve(p):u(d,f)}}},w3=n=>"playbackRate"in n,S3=n=>"frequency"in n&&"gain"in n,k3=n=>"offset"in n,E3=n=>!("frequency"in n)&&"gain"in n,T3=n=>"detune"in n&&"frequency"in n&&!("gain"in n),R3=n=>"pan"in n,di=n=>Ko(DS,n),Lf=n=>Ko(BS,n),jv=(n,e)=>{const{activeInputs:t}=di(n);t.forEach(i=>i.forEach(([o])=>{e.includes(n)||jv(o,[...e,n])}));const r=w3(n)?[n.playbackRate]:VS(n)?Array.from(n.parameters.values()):S3(n)?[n.Q,n.detune,n.frequency,n.gain]:k3(n)?[n.offset]:E3(n)?[n.gain]:T3(n)?[n.detune,n.frequency]:R3(n)?[n.pan]:[];for(const i of r){const o=Lf(i);o!==void 0&&o.activeInputs.forEach(([a])=>jv(a,e))}Ma(n)&&Mf(n)},_3=n=>{jv(n.destination,[])},P3=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),D3=(n,e,t,r,i,o,a,l,u)=>class extends n{constructor(f={}){if(u===null)throw new Error("Missing the native AudioContext constructor.");let p;try{p=new u(f)}catch(C){throw C.code===12&&C.message==="sampleRate is not in range"?t():C}if(p===null)throw r();if(!P3(f.latencyHint))throw new TypeError(`The provided value '${f.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(f.sampleRate!==void 0&&p.sampleRate!==f.sampleRate)throw t();super(p,2);const{latencyHint:g}=f,{sampleRate:v}=p;if(this._baseLatency=typeof p.baseLatency=="number"?p.baseLatency:g==="balanced"?512/v:g==="interactive"||g===void 0?256/v:g==="playback"?1024/v:Math.max(2,Math.min(128,Math.round(g*v/128)))*128/v,this._nativeAudioContext=p,u.name==="webkitAudioContext"?(this._nativeGainNode=p.createGain(),this._nativeOscillatorNode=p.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(p.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,p.state==="running"){this._state="suspended";const C=()=>{this._state==="suspended"&&(this._state=null),p.removeEventListener("statechange",C)};p.addEventListener("statechange",C)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),_3(this)}))}createMediaElementSource(f){return new i(this,{mediaElement:f})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(f){return new a(this,{mediaStream:f})}createMediaStreamTrackSource(f){return new l(this,{mediaStreamTrack:f})}resume(){return this._state==="suspended"?new Promise((f,p)=>{const g=()=>{this._nativeAudioContext.removeEventListener("statechange",g),this._nativeAudioContext.state==="running"?f():this.resume().then(f,p)};this._nativeAudioContext.addEventListener("statechange",g)}):this._nativeAudioContext.resume().catch(f=>{throw f===void 0||f.code===15?e():f})}suspend(){return this._nativeAudioContext.suspend().catch(f=>{throw f===void 0?e():f})}},N3=(n,e,t,r,i,o,a,l)=>class extends n{constructor(d,f){const p=o(d),g=a(p),v=i(p,f,g),C=g?e(l):null;super(d,!1,v,C),this._isNodeOfNativeOfflineAudioContext=g,this._nativeAudioDestinationNode=v}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(d){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(d>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=d}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(d){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=d}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},B3=n=>{const e=new WeakMap,t=async(r,i)=>{const o=i.destination;return e.set(i,o),await n(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):t(r,i)}}},O3=(n,e,t,r,i,o,a,l)=>(u,d)=>{const f=d.listener,p=()=>{const P=new Float32Array(1),B=e(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),_=a(d);let M=!1,H=[0,0,-1,0,1,0],V=[0,0,0];const U=()=>{if(M)return;M=!0;const le=r(d,256,9,0);le.onaudioprocess=({inputBuffer:Ce})=>{const Re=[o(Ce,P,0),o(Ce,P,1),o(Ce,P,2),o(Ce,P,3),o(Ce,P,4),o(Ce,P,5)];Re.some((pe,be)=>pe!==H[be])&&(f.setOrientation(...Re),H=Re);const de=[o(Ce,P,6),o(Ce,P,7),o(Ce,P,8)];de.some((pe,be)=>pe!==V[be])&&(f.setPosition(...de),V=de)},B.connect(le)},Z=le=>Ce=>{Ce!==H[le]&&(H[le]=Ce,f.setOrientation(...H))},q=le=>Ce=>{Ce!==V[le]&&(V[le]=Ce,f.setPosition(...V))},ie=(le,Ce,Re)=>{const de=t(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Ce});de.connect(B,0,le),de.start(),Object.defineProperty(de.offset,"defaultValue",{get(){return Ce}});const pe=n({context:u},_,de.offset,ai,Bi);return l(pe,"value",be=>()=>be.call(pe),be=>L=>{try{be.call(pe,L)}catch(K){if(K.code!==9)throw K}U(),_&&Re(L)}),pe.cancelAndHoldAtTime=(be=>_?()=>{throw i()}:(...L)=>{const K=be.apply(pe,L);return U(),K})(pe.cancelAndHoldAtTime),pe.cancelScheduledValues=(be=>_?()=>{throw i()}:(...L)=>{const K=be.apply(pe,L);return U(),K})(pe.cancelScheduledValues),pe.exponentialRampToValueAtTime=(be=>_?()=>{throw i()}:(...L)=>{const K=be.apply(pe,L);return U(),K})(pe.exponentialRampToValueAtTime),pe.linearRampToValueAtTime=(be=>_?()=>{throw i()}:(...L)=>{const K=be.apply(pe,L);return U(),K})(pe.linearRampToValueAtTime),pe.setTargetAtTime=(be=>_?()=>{throw i()}:(...L)=>{const K=be.apply(pe,L);return U(),K})(pe.setTargetAtTime),pe.setValueAtTime=(be=>_?()=>{throw i()}:(...L)=>{const K=be.apply(pe,L);return U(),K})(pe.setValueAtTime),pe.setValueCurveAtTime=(be=>_?()=>{throw i()}:(...L)=>{const K=be.apply(pe,L);return U(),K})(pe.setValueCurveAtTime),pe};return{forwardX:ie(0,0,Z(0)),forwardY:ie(1,0,Z(1)),forwardZ:ie(2,-1,Z(2)),positionX:ie(6,0,q(0)),positionY:ie(7,0,q(1)),positionZ:ie(8,0,q(2)),upX:ie(3,0,Z(3)),upY:ie(4,1,Z(4)),upZ:ie(5,0,Z(5))}},{forwardX:g,forwardY:v,forwardZ:C,positionX:y,positionY:x,positionZ:I,upX:b,upY:T,upZ:R}=f.forwardX===void 0?p():f;return{get forwardX(){return g},get forwardY(){return v},get forwardZ(){return C},get positionX(){return y},get positionY(){return x},get positionZ(){return I},get upX(){return b},get upY(){return T},get upZ(){return R}}},x0=n=>"context"in n,Uf=n=>x0(n[0]),_c=(n,e,t,r)=>{for(const i of n)if(t(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},cb=(n,e,[t,r],i)=>{_c(n,[e,t,r],o=>o[0]===e&&o[1]===t,i)},ub=(n,[e,t,r],i)=>{const o=n.get(e);o===void 0?n.set(e,new Set([[t,r]])):_c(o,[t,r],a=>a[0]===t,i)},Wu=n=>"inputs"in n,I0=(n,e,t,r)=>{if(Wu(e)){const i=e.inputs[r];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,r),[e,t,r]},jS=(n,e,t)=>{for(const r of n)if(r[0]===e&&r[1]===t)return n.delete(r),r;return null},F3=(n,e,t)=>X0(n,r=>r[0]===e&&r[1]===t),zS=(n,e)=>{if(!Ff(n).delete(e))throw new Error("Missing the expected event listener.")},HS=(n,e,t)=>{const r=Ko(n,e),i=X0(r,o=>o[0]===t);return r.size===0&&n.delete(e),i},b0=(n,e,t,r)=>{Wu(e)?n.disconnect(e.inputs[r],t,0):n.disconnect(e,t,r)},Ln=n=>Ko(NS,n),pf=n=>Ko(OS,n),xc=n=>Lv.has(n),hp=n=>!Nu.has(n),db=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const r=n.createScriptProcessor(256,1,1),i=n.createGain(),o=n.createBuffer(1,2,44100),a=o.getChannelData(0);a[0]=1,a[1]=1;const l=n.createBufferSource();l.buffer=o,l.loop=!0,l.connect(r).connect(n.destination),l.connect(i),l.disconnect(i),r.onaudioprocess=u=>{const d=u.inputBuffer.getChannelData(0);Array.prototype.some.call(d,f=>f===1)?t(!0):t(!1),l.stop(),r.onaudioprocess=null,l.disconnect(r),r.disconnect(n.destination)},l.start()}}),Zm=(n,e)=>{const t=new Map;for(const r of n)for(const i of r){const o=t.get(i);t.set(i,o===void 0?1:o+1)}t.forEach((r,i)=>e(i,r))},A0=n=>"context"in n,M3=n=>{const e=new Map;n.connect=(t=>(r,i=0,o=0)=>{const a=A0(r)?t(r,i,o):t(r,i),l=e.get(r);return l===void 0?e.set(r,[{input:o,output:i}]):l.every(u=>u.input!==o||u.output!==i)&&l.push({input:o,output:i}),a})(n.connect.bind(n)),n.disconnect=(t=>(r,i,o)=>{if(t.apply(n),r===void 0)e.clear();else if(typeof r=="number")for(const[a,l]of e){const u=l.filter(d=>d.output!==r);u.length===0?e.delete(a):e.set(a,u)}else if(e.has(r))if(i===void 0)e.delete(r);else{const a=e.get(r);if(a!==void 0){const l=a.filter(u=>u.output!==i&&(u.input!==o||o===void 0));l.length===0?e.delete(r):e.set(r,l)}}for(const[a,l]of e)l.forEach(u=>{A0(a)?n.connect(a,u.output,u.input):n.connect(a,u.output)})})(n.disconnect)},L3=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:o}=Lf(e),{outputs:a}=di(n),l=Ff(n),u=d=>{const f=Ln(n),p=pf(e);if(d){const g=HS(o,n,t);cb(i,n,g,!1),!r&&!xc(n)&&f.connect(p,t)}else{const g=F3(i,n,t);ub(o,g,!1),!r&&!xc(n)&&f.disconnect(p,t)}};return _c(a,[e,t],d=>d[0]===e&&d[1]===t,!0)?(l.add(u),Ma(n)?cb(i,n,[t,u],!0):ub(o,[n,t,u],!0),!0):!1},U3=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:o}=di(e),a=jS(i[r],n,t);return a===null?[US(o,n,t,r)[2],!1]:[a[2],!0]},V3=(n,e,t)=>{const{activeInputs:r,passiveInputs:i}=Lf(e),o=jS(r,n,t);return o===null?[HS(i,n,t)[1],!1]:[o[2],!0]},ay=(n,e,t,r,i)=>{const[o,a]=U3(n,t,r,i);if(o!==null&&(zS(n,o),a&&!e&&!xc(n)&&b0(Ln(n),Ln(t),r,i)),Ma(t)){const{activeInputs:l}=di(t);Gv(t,l)}},ly=(n,e,t,r)=>{const[i,o]=V3(n,t,r);i!==null&&(zS(n,i),o&&!e&&!xc(n)&&Ln(n).disconnect(pf(t),r))},G3=(n,e)=>{const t=di(n),r=[];for(const i of t.outputs)Uf(i)?ay(n,e,...i):ly(n,e,...i),r.push(i[0]);return t.outputs.clear(),r},W3=(n,e,t)=>{const r=di(n),i=[];for(const o of r.outputs)o[1]===t&&(Uf(o)?ay(n,e,...o):ly(n,e,...o),i.push(o[0]),r.outputs.delete(o));return i},j3=(n,e,t,r,i)=>{const o=di(n);return Array.from(o.outputs).filter(a=>a[0]===t&&(r===void 0||a[1]===r)&&(i===void 0||a[2]===i)).map(a=>(Uf(a)?ay(n,e,...a):ly(n,e,...a),o.outputs.delete(a),a[0]))},z3=(n,e,t,r,i,o,a,l,u,d,f,p,g,v,C,y)=>class extends d{constructor(I,b,T,R){super(T),this._context=I,this._nativeAudioNode=T;const P=f(I);p(P)&&t(db,()=>db(P,y))!==!0&&M3(T),NS.set(this,T),MS.set(this,new Set),I.state!=="closed"&&b&&Bu(this),n(this,R,T)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(I){this._nativeAudioNode.channelCount=I}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(I){this._nativeAudioNode.channelCountMode=I}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(I){this._nativeAudioNode.channelInterpretation=I}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(I,b=0,T=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw i();const R=f(this._context),P=C(R);if(g(I)||v(I))throw o();if(x0(I)){const M=Ln(I);try{const V=I0(this._nativeAudioNode,M,b,T),U=hp(this);(P||U)&&this._nativeAudioNode.disconnect(...V),this.context.state!=="closed"&&!U&&hp(I)&&Bu(I)}catch(V){throw V.code===12?o():V}if(e(this,I,b,T,P)){const V=u([this],I);Zm(V,r(P))}return I}const B=pf(I);if(B.name==="playbackRate"&&B.maxValue===1024)throw a();try{this._nativeAudioNode.connect(B,b),(P||hp(this))&&this._nativeAudioNode.disconnect(B,b)}catch(M){throw M.code===12?o():M}if(L3(this,I,b,P)){const M=u([this],I);Zm(M,r(P))}}disconnect(I,b,T){let R;const P=f(this._context),B=C(P);if(I===void 0)R=G3(this,B);else if(typeof I=="number"){if(I<0||I>=this.numberOfOutputs)throw i();R=W3(this,B,I)}else{if(b!==void 0&&(b<0||b>=this.numberOfOutputs)||x0(I)&&T!==void 0&&(T<0||T>=I.numberOfInputs))throw i();if(R=j3(this,B,I,b,T),R.length===0)throw o()}for(const _ of R){const M=u([this],_);Zm(M,l)}}},H3=(n,e,t,r,i,o,a,l,u,d,f,p,g)=>(v,C,y,x=null,I=null)=>{const b=y.value,T=new e3(b),R=C?r(T):null,P={get defaultValue(){return b},get maxValue(){return x===null?y.maxValue:x},get minValue(){return I===null?y.minValue:I},get value(){return y.value},set value(B){y.value=B,P.setValueAtTime(B,v.context.currentTime)},cancelAndHoldAtTime(B){if(typeof y.cancelAndHoldAtTime=="function")R===null&&T.flush(v.context.currentTime),T.add(i(B)),y.cancelAndHoldAtTime(B);else{const _=Array.from(T).pop();R===null&&T.flush(v.context.currentTime),T.add(i(B));const M=Array.from(T).pop();y.cancelScheduledValues(B),_!==M&&M!==void 0&&(M.type==="exponentialRampToValue"?y.exponentialRampToValueAtTime(M.value,M.endTime):M.type==="linearRampToValue"?y.linearRampToValueAtTime(M.value,M.endTime):M.type==="setValue"?y.setValueAtTime(M.value,M.startTime):M.type==="setValueCurve"&&y.setValueCurveAtTime(M.values,M.startTime,M.duration))}return P},cancelScheduledValues(B){return R===null&&T.flush(v.context.currentTime),T.add(o(B)),y.cancelScheduledValues(B),P},exponentialRampToValueAtTime(B,_){if(B===0)throw new RangeError;if(!Number.isFinite(_)||_<0)throw new RangeError;const M=v.context.currentTime;return R===null&&T.flush(M),Array.from(T).length===0&&(T.add(d(b,M)),y.setValueAtTime(b,M)),T.add(a(B,_)),y.exponentialRampToValueAtTime(B,_),P},linearRampToValueAtTime(B,_){const M=v.context.currentTime;return R===null&&T.flush(M),Array.from(T).length===0&&(T.add(d(b,M)),y.setValueAtTime(b,M)),T.add(l(B,_)),y.linearRampToValueAtTime(B,_),P},setTargetAtTime(B,_,M){return R===null&&T.flush(v.context.currentTime),T.add(u(B,_,M)),y.setTargetAtTime(B,_,M),P},setValueAtTime(B,_){return R===null&&T.flush(v.context.currentTime),T.add(d(B,_)),y.setValueAtTime(B,_),P},setValueCurveAtTime(B,_,M){const H=B instanceof Float32Array?B:new Float32Array(B);if(p!==null&&p.name==="webkitAudioContext"){const V=_+M,U=v.context.sampleRate,Z=Math.ceil(_*U),q=Math.floor(V*U),ie=q-Z,le=new Float32Array(ie);for(let Re=0;Re<ie;Re+=1){const de=(H.length-1)/M*((Z+Re)/U-_),pe=Math.floor(de),be=Math.ceil(de);le[Re]=pe===be?H[pe]:(1-(de-pe))*H[pe]+(1-(be-de))*H[be]}R===null&&T.flush(v.context.currentTime),T.add(f(le,_,M)),y.setValueCurveAtTime(le,_,M);const Ce=q/U;Ce<V&&g(P,le[le.length-1],Ce),g(P,H[H.length-1],V)}else R===null&&T.flush(v.context.currentTime),T.add(f(H,_,M)),y.setValueCurveAtTime(H,_,M);return P}};return t.set(P,y),e.set(P,v),n(P,R),P},Z3=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:r,value:i}=t;e.exponentialRampToValueAtTime(i,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:i}=t;e.linearRampToValueAtTime(i,r)}else if(t.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=t;e.setTargetAtTime(i,r,o)}else if(t.type==="setValue"){const{startTime:r,value:i}=t;e.setValueAtTime(i,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=t;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class ZS{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,i)=>e.call(t,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const X3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},K3=(n,e,t,r,i,o,a,l,u,d,f,p,g,v)=>class extends e{constructor(y,x,I){var b;const T=l(y),R=u(T),P=f({...X3,...I});g(P);const B=Uv.get(T),_=B==null?void 0:B.get(x),M=R||T.state!=="closed"?T:(b=a(T))!==null&&b!==void 0?b:T,H=i(M,R?null:y.baseLatency,d,x,_,P),V=R?r(x,P,_):null;super(y,!0,H,V);const U=[];H.parameters.forEach((q,ie)=>{const le=t(this,R,q);U.push([ie,le])}),this._nativeAudioWorkletNode=H,this._onprocessorerror=null,this._parameters=new ZS(U),R&&n(T,this);const{activeInputs:Z}=o(this);p(H,Z)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(y){const x=typeof y=="function"?v(this,y):null;this._nativeAudioWorkletNode.onprocessorerror=x;const I=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=I!==null&&I===x?y:I}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function w0(n,e,t,r,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],r,i);else{const o=n.getChannelData(r);if(e[t].byteLength===0)e[t]=o.slice(i,i+128);else{const a=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const XS=(n,e,t,r,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],r,i):e[t].byteLength!==0&&n.getChannelData(r).set(e[t],i)},S0=(n,e)=>{const t=[];for(let r=0;r<n;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let a=0;a<o;a+=1)i.push(new Float32Array(128));t.push(i)}return t},$3=(n,e)=>{const t=Ko(Vv,n),r=Ln(e);return Ko(t,r)},J3=async(n,e,t,r,i,o,a)=>{const l=e===null?Math.ceil(n.context.length/128)*128:e.length,u=r.channelCount*r.numberOfInputs,d=i.reduce((x,I)=>x+I,0),f=d===0?null:t.createBuffer(d,l,t.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const p=di(n),g=await $3(t,n),v=S0(r.numberOfInputs,r.channelCount),C=S0(r.numberOfOutputs,i),y=Array.from(n.parameters.keys()).reduce((x,I)=>({...x,[I]:new Float32Array(128)}),{});for(let x=0;x<l;x+=128){if(r.numberOfInputs>0&&e!==null)for(let I=0;I<r.numberOfInputs;I+=1)for(let b=0;b<r.channelCount;b+=1)w0(e,v[I],b,b,x);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:I},b)=>{w0(e,y,I,u+b,x)});for(let I=0;I<r.numberOfInputs;I+=1)for(let b=0;b<i[I];b+=1)C[I][b].byteLength===0&&(C[I][b]=new Float32Array(128));try{const I=v.map((T,R)=>p.activeInputs[R].size===0?[]:T),b=a(x/t.sampleRate,t.sampleRate,()=>g.process(I,C,y));if(f!==null)for(let T=0,R=0;T<r.numberOfOutputs;T+=1){for(let P=0;P<i[T];P+=1)XS(f,C[T],P,R+P,x);R+=i[T]}if(!b)break}catch(I){n.dispatchEvent(new ErrorEvent("processorerror",{colno:I.colno,filename:I.filename,lineno:I.lineno,message:I.message}));break}}return f},Y3=(n,e,t,r,i,o,a,l,u,d,f,p,g,v,C,y)=>(x,I,b)=>{const T=new WeakMap;let R=null;const P=async(B,_)=>{let M=f(B),H=null;const V=qr(M,_),U=Array.isArray(I.outputChannelCount)?I.outputChannelCount:Array.from(I.outputChannelCount);if(p===null){const Z=U.reduce((Ce,Re)=>Ce+Re,0),q=i(_,{channelCount:Math.max(1,Z),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,Z)}),ie=[];for(let Ce=0;Ce<B.numberOfOutputs;Ce+=1)ie.push(r(_,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:U[Ce]}));const le=a(_,{channelCount:I.channelCount,channelCountMode:I.channelCountMode,channelInterpretation:I.channelInterpretation,gain:1});le.connect=e.bind(null,ie),le.disconnect=u.bind(null,ie),H=[q,ie,le]}else V||(M=new p(_,x));if(T.set(_,H===null?M:H[2]),H!==null){if(R===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(g===null)throw new Error("Missing the native OfflineAudioContext constructor.");const Re=B.channelCount*B.numberOfInputs,de=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,pe=Re+de;R=J3(B,pe===0?null:await(async()=>{const L=new g(pe,Math.ceil(B.context.length/128)*128,_.sampleRate),K=[],ue=[];for(let Fe=0;Fe<I.numberOfInputs;Fe+=1)K.push(a(L,{channelCount:I.channelCount,channelCountMode:I.channelCountMode,channelInterpretation:I.channelInterpretation,gain:1})),ue.push(i(L,{channelCount:I.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:I.channelCount}));const he=await Promise.all(Array.from(B.parameters.values()).map(async Fe=>{const Je=o(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Fe.value});return await v(L,Fe,Je.offset),Je})),Ee=r(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Re+de)});for(let Fe=0;Fe<I.numberOfInputs;Fe+=1){K[Fe].connect(ue[Fe]);for(let Je=0;Je<I.channelCount;Je+=1)ue[Fe].connect(Ee,Je,Fe*I.channelCount+Je)}for(const[Fe,Je]of he.entries())Je.connect(Ee,0,Re+Fe),Je.start(0);return Ee.connect(L.destination),await Promise.all(K.map(Fe=>C(B,L,Fe))),y(L)})(),_,I,U,b,d)}const Z=await R,q=t(_,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[ie,le,Ce]=H;Z!==null&&(q.buffer=Z,q.start(0)),q.connect(ie);for(let Re=0,de=0;Re<B.numberOfOutputs;Re+=1){const pe=le[Re];for(let be=0;be<U[Re];be+=1)ie.connect(pe,de+be,be);de+=U[Re]}return Ce}if(V)for(const[Z,q]of B.parameters.entries())await n(_,q,M.parameters.get(Z));else for(const[Z,q]of B.parameters.entries())await v(_,q,M.parameters.get(Z));return await C(B,_,M),M};return{render(B,_){l(_,B);const M=T.get(_);return M!==void 0?Promise.resolve(M):P(B,_)}}},q3=(n,e,t,r,i,o,a,l,u,d,f,p,g,v,C,y,x,I,b,T)=>class extends C{constructor(P,B){super(P,B),this._nativeContext=P,this._audioWorklet=n===void 0?void 0:{addModule:(_,M)=>n(this,_,M)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(P,B,_){return new t({length:B,numberOfChannels:P,sampleRate:_})}createBufferSource(){return new r(this)}createChannelMerger(P=6){return new o(this,{numberOfInputs:P})}createChannelSplitter(P=6){return new a(this,{numberOfOutputs:P})}createConstantSource(){return new l(this)}createConvolver(){return new u(this)}createDelay(P=1){return new f(this,{maxDelayTime:P})}createDynamicsCompressor(){return new p(this)}createGain(){return new g(this)}createIIRFilter(P,B){return new v(this,{feedback:B,feedforward:P})}createOscillator(){return new y(this)}createPanner(){return new x(this)}createPeriodicWave(P,B,_={disableNormalization:!1}){return new I(this,{..._,imag:B,real:P})}createStereoPanner(){return new b(this)}createWaveShaper(){return new T(this)}decodeAudioData(P,B,_){return d(this._nativeContext,P).then(M=>(typeof B=="function"&&B(M),M),M=>{throw typeof _=="function"&&_(M),M})}},Q3={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},eN=(n,e,t,r,i,o,a,l)=>class extends n{constructor(d,f){const p=o(d),g={...Q3,...f},v=i(p,g),C=a(p),y=C?t():null;super(d,!1,v,y),this._Q=e(this,C,v.Q,ai,Bi),this._detune=e(this,C,v.detune,1200*Math.log2(ai),-1200*Math.log2(ai)),this._frequency=e(this,C,v.frequency,d.sampleRate/2,0),this._gain=e(this,C,v.gain,40*Math.log10(ai),Bi),this._nativeBiquadFilterNode=v,l(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(d){this._nativeBiquadFilterNode.type=d}getFrequencyResponse(d,f,p){try{this._nativeBiquadFilterNode.getFrequencyResponse(d,f,p)}catch(g){throw g.code===11?r():g}if(d.length!==f.length||f.length!==p.length)throw r()}},tN=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(l,u)=>{let d=t(l);const f=qr(d,u);if(!f){const p={Q:d.Q.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,gain:d.gain.value,type:d.type};d=e(u,p)}return o.set(u,d),f?(await n(u,l.Q,d.Q),await n(u,l.detune,d.detune),await n(u,l.frequency,d.frequency),await n(u,l.gain,d.gain)):(await r(u,l.Q,d.Q),await r(u,l.detune,d.detune),await r(u,l.frequency,d.frequency),await r(u,l.gain,d.gain)),await i(l,u,d),d};return{render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):a(l,u)}}},nN=(n,e)=>(t,r)=>{const i=e.get(t);if(i!==void 0)return i;const o=n.get(t);if(o!==void 0)return o;try{const a=r();return a instanceof Promise?(n.set(t,a),a.catch(()=>!1).then(l=>(n.delete(t),e.set(t,l),l))):(e.set(t,a),a)}catch{return e.set(t,!1),!1}},rN={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},iN=(n,e,t,r,i)=>class extends n{constructor(a,l){const u=r(a),d={...rN,...l},f=t(u,d),p=i(u)?e():null;super(a,!1,f,p)}},oN=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let l=e(o);if(!qr(l,a)){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,numberOfInputs:l.numberOfInputs};l=n(a,d)}return r.set(a,l),await t(o,a,l),l};return{render(o,a){const l=r.get(a);return l!==void 0?Promise.resolve(l):i(o,a)}}},sN={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},aN=(n,e,t,r,i,o)=>class extends n{constructor(l,u){const d=r(l),f=o({...sN,...u}),p=t(d,f),g=i(d)?e():null;super(l,!1,p,g)}},lN=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let l=e(o);if(!qr(l,a)){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,numberOfOutputs:l.numberOfOutputs};l=n(a,d)}return r.set(a,l),await t(o,a,l),l};return{render(o,a){const l=r.get(a);return l!==void 0?Promise.resolve(l):i(o,a)}}},cN=n=>(e,t,r)=>n(t,e,r),uN=n=>(e,t,r=0,i=0)=>{const o=e[r];if(o===void 0)throw n();return A0(t)?o.connect(t,0,i):o.connect(t,0)},dN=n=>(e,t)=>{const r=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},fN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},hN=(n,e,t,r,i,o,a)=>class extends n{constructor(u,d){const f=i(u),p={...fN,...d},g=r(f,p),v=o(f),C=v?t():null;super(u,!1,g,C),this._constantSourceNodeRenderer=C,this._nativeConstantSourceNode=g,this._offset=e(this,v,g.offset,ai,Bi),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(u){const d=typeof u=="function"?a(this,u):null;this._nativeConstantSourceNode.onended=d;const f=this._nativeConstantSourceNode.onended;this._onended=f!==null&&f===d?u:f}start(u=0){if(this._nativeConstantSourceNode.start(u),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=u),this.context.state!=="closed"){Bu(this);const d=()=>{this._nativeConstantSourceNode.removeEventListener("ended",d),Ma(this)&&Mf(this)};this._nativeConstantSourceNode.addEventListener("ended",d)}}stop(u=0){this._nativeConstantSourceNode.stop(u),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=u)}},pN=(n,e,t,r,i)=>()=>{const o=new WeakMap;let a=null,l=null;const u=async(d,f)=>{let p=t(d);const g=qr(p,f);if(!g){const v={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,offset:p.offset.value};p=e(f,v),a!==null&&p.start(a),l!==null&&p.stop(l)}return o.set(f,p),g?await n(f,d.offset,p.offset):await r(f,d.offset,p.offset),await i(d,f,p),p};return{set start(d){a=d},set stop(d){l=d},render(d,f){const p=o.get(f);return p!==void 0?Promise.resolve(p):u(d,f)}}},gN=n=>e=>(n[0]=e,n[0]),mN={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},vN=(n,e,t,r,i,o)=>class extends n{constructor(l,u){const d=r(l),f={...mN,...u},p=t(d,f),v=i(d)?e():null;super(l,!1,p,v),this._isBufferNullified=!1,this._nativeConvolverNode=p,f.buffer!==null&&o(this,f.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(l){if(this._nativeConvolverNode.buffer=l,l===null&&this._nativeConvolverNode.buffer!==null){const u=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=u.createBuffer(1,1,u.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(l){this._nativeConvolverNode.normalize=l}},CN=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let l=e(o);if(!qr(l,a)){const d={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,disableNormalization:!l.normalize};l=n(a,d)}return r.set(a,l),Wu(l)?await t(o,a,l.inputs[0]):await t(o,a,l),l};return{render(o,a){const l=r.get(a);return l!==void 0?Promise.resolve(l):i(o,a)}}},yN=()=>new DOMException("","DataCloneError"),fb=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{const i=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},xN=(n,e,t,r,i,o,a,l,u,d,f)=>(p,g)=>{const v=a(p)?p:o(p);if(i.has(g)){const C=t();return Promise.reject(C)}try{i.add(g)}catch{}return e(u,()=>u(v))?v.decodeAudioData(g).then(C=>(fb(g).catch(()=>{}),e(l,()=>l(C))||f(C),n.add(C),C)):new Promise((C,y)=>{const x=async()=>{try{await fb(g)}catch{}},I=b=>{y(b),x()};try{v.decodeAudioData(g,b=>{typeof b.copyFromChannel!="function"&&(d(b),GS(b)),n.add(b),x().then(()=>C(b))},b=>{I(b===null?r():b)})}catch(b){I(b)}})},IN=(n,e,t,r,i,o,a,l)=>(u,d)=>{const f=e.get(u);if(f===void 0)throw new Error("Missing the expected cycle count.");const p=o(u.context),g=l(p);if(f===d){if(e.delete(u),!g&&a(u)){const v=r(u),{outputs:C}=t(u);for(const y of C)if(Uf(y)){const x=r(y[0]);n(v,x,y[1],y[2])}else{const x=i(y[0]);v.connect(x,y[1])}}}else e.set(u,f-d)},bN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},AN=(n,e,t,r,i,o,a)=>class extends n{constructor(u,d){const f=i(u),p={...bN,...d},g=r(f,p),v=o(f),C=v?t(p.maxDelayTime):null;super(u,!1,g,C),this._delayTime=e(this,v,g.delayTime),a(this,p.maxDelayTime)}get delayTime(){return this._delayTime}},wN=(n,e,t,r,i)=>o=>{const a=new WeakMap,l=async(u,d)=>{let f=t(u);const p=qr(f,d);if(!p){const g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,delayTime:f.delayTime.value,maxDelayTime:o};f=e(d,g)}return a.set(d,f),p?await n(d,u.delayTime,f.delayTime):await r(d,u.delayTime,f.delayTime),await i(u,d,f),f};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},SN=n=>(e,t,r,i)=>n(e[i],o=>o[0]===t&&o[1]===r),kN=n=>(e,t)=>{n(e).delete(t)},EN=n=>"delayTime"in n,TN=(n,e,t)=>function r(i,o){const a=x0(o)?o:t(n,o);if(EN(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];const{outputs:l}=e(a);return Array.from(l).map(u=>r([...i,a],u[0])).reduce((u,d)=>u.concat(d),[])},ep=(n,e,t)=>{const r=e[t];if(r===void 0)throw n();return r},RN=n=>(e,t=void 0,r=void 0,i=0)=>t===void 0?e.forEach(o=>o.disconnect()):typeof t=="number"?ep(n,e,t).disconnect():A0(t)?r===void 0?e.forEach(o=>o.disconnect(t)):i===void 0?ep(n,e,r).disconnect(t,0):ep(n,e,r).disconnect(t,0,i):r===void 0?e.forEach(o=>o.disconnect(t)):ep(n,e,r).disconnect(t,0),_N={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},PN=(n,e,t,r,i,o,a,l)=>class extends n{constructor(d,f){const p=o(d),g={..._N,...f},v=r(p,g),C=a(p),y=C?t():null;super(d,!1,v,y),this._attack=e(this,C,v.attack),this._knee=e(this,C,v.knee),this._nativeDynamicsCompressorNode=v,this._ratio=e(this,C,v.ratio),this._release=e(this,C,v.release),this._threshold=e(this,C,v.threshold),l(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(d){const f=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=d,d>2)throw this._nativeDynamicsCompressorNode.channelCount=f,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(d){const f=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=d,d==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=f,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},DN=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(l,u)=>{let d=t(l);const f=qr(d,u);if(!f){const p={attack:d.attack.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,knee:d.knee.value,ratio:d.ratio.value,release:d.release.value,threshold:d.threshold.value};d=e(u,p)}return o.set(u,d),f?(await n(u,l.attack,d.attack),await n(u,l.knee,d.knee),await n(u,l.ratio,d.ratio),await n(u,l.release,d.release),await n(u,l.threshold,d.threshold)):(await r(u,l.attack,d.attack),await r(u,l.knee,d.knee),await r(u,l.ratio,d.ratio),await r(u,l.release,d.release),await r(u,l.threshold,d.threshold)),await i(l,u,d),d};return{render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):a(l,u)}}},NN=()=>new DOMException("","EncodingError"),BN=n=>e=>new Promise((t,r)=>{if(n===null){r(new SyntaxError);return}const i=n.document.head;if(i===null)r(new SyntaxError);else{const o=n.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),l=URL.createObjectURL(a),u=n.onerror,d=()=>{n.onerror=u,URL.revokeObjectURL(l)};n.onerror=(f,p,g,v,C)=>{if(p===l||p===n.location.href&&g===1&&v===1)return d(),r(C),!1;if(u!==null)return u(f,p,g,v,C)},o.onerror=()=>{d(),r(new SyntaxError)},o.onload=()=>{d(),t()},o.src=l,o.type="module",i.appendChild(o)}}),ON=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=n(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(t,o,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,o===void 0?null:o,i)}},FN=n=>(e,t,r)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},MN=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},LN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},UN=(n,e,t,r,i,o)=>class extends n{constructor(l,u){const d=i(l),f={...LN,...u},p=r(d,f),g=o(d),v=g?t():null;super(l,!1,p,v),this._gain=e(this,g,p.gain,ai,Bi)}get gain(){return this._gain}},VN=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(l,u)=>{let d=t(l);const f=qr(d,u);if(!f){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:d.gain.value};d=e(u,p)}return o.set(u,d),f?await n(u,l.gain,d.gain):await r(u,l.gain,d.gain),await i(l,u,d),d};return{render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):a(l,u)}}},GN=(n,e)=>t=>e(n,t),WN=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},jN=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},zN=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},HN=n=>e=>n.get(e),Nr=()=>new DOMException("","InvalidStateError"),ZN=n=>e=>{const t=n.get(e);if(t===void 0)throw Nr();return t},XN=(n,e)=>t=>{let r=n.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),n.set(t,r),r},KN=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},K0=()=>new DOMException("","InvalidAccessError"),$N=n=>{n.getFrequencyResponse=(e=>(t,r,i)=>{if(t.length!==r.length||r.length!==i.length)throw K0();return e.call(n,t,r,i)})(n.getFrequencyResponse)},JN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},YN=(n,e,t,r,i,o)=>class extends n{constructor(l,u){const d=r(l),f=i(d),p={...JN,...u},g=e(d,f?null:l.baseLatency,p),v=f?t(p.feedback,p.feedforward):null;super(l,!1,g,v),$N(g),this._nativeIIRFilterNode=g,o(this,1)}getFrequencyResponse(l,u,d){return this._nativeIIRFilterNode.getFrequencyResponse(l,u,d)}},KS=(n,e,t,r,i,o,a,l,u,d,f)=>{const p=d.length;let g=l;for(let v=0;v<p;v+=1){let C=t[0]*d[v];for(let y=1;y<i;y+=1){const x=g-y&u-1;C+=t[y]*o[x],C-=n[y]*a[x]}for(let y=i;y<r;y+=1)C+=t[y]*o[g-y&u-1];for(let y=i;y<e;y+=1)C-=n[y]*a[g-y&u-1];o[g]=d[v],a[g]=C,g=g+1&u-1,f[v]=C}return g},qN=(n,e,t,r)=>{const i=t instanceof Float64Array?t:new Float64Array(t),o=r instanceof Float64Array?r:new Float64Array(r),a=i.length,l=o.length,u=Math.min(a,l);if(i[0]!==1){for(let C=0;C<a;C+=1)o[C]/=i[0];for(let C=1;C<l;C+=1)i[C]/=i[0]}const d=32,f=new Float32Array(d),p=new Float32Array(d),g=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),v=n.numberOfChannels;for(let C=0;C<v;C+=1){const y=n.getChannelData(C),x=g.getChannelData(C);f.fill(0),p.fill(0),KS(i,a,o,l,u,f,p,0,d,y,x)}return g},QN=(n,e,t,r,i)=>(o,a)=>{const l=new WeakMap;let u=null;const d=async(f,p)=>{let g=null,v=e(f);const C=qr(v,p);if(p.createIIRFilter===void 0?g=n(p,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):C||(v=p.createIIRFilter(a,o)),l.set(p,g===null?v:g),g!==null){if(u===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const x=new t(f.context.destination.channelCount,f.context.length,p.sampleRate);u=(async()=>{await r(f,x,x.destination);const I=await i(x);return qN(I,p,o,a)})()}const y=await u;return g.buffer=y,g.start(0),g}return await r(f,p,v),v};return{render(f,p){const g=l.get(p);return g!==void 0?Promise.resolve(g):d(f,p)}}},eB=(n,e,t,r,i,o)=>a=>(l,u)=>{const d=n.get(l);if(d===void 0){if(!a&&o(l)){const f=r(l),{outputs:p}=t(l);for(const g of p)if(Uf(g)){const v=r(g[0]);e(f,v,g[1],g[2])}else{const v=i(g[0]);f.disconnect(v,g[1])}}n.set(l,u)}else n.set(l,d+u)},tB=n=>e=>n!==null&&e instanceof n,nB=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,rB=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,iB=(n,e)=>t=>n(t)||e(t),oB=n=>e=>n!==null&&e instanceof n,sB=n=>n!==null&&n.isSecureContext,aB=(n,e,t,r)=>class extends n{constructor(o,a){const l=t(o),u=e(l,a);if(r(l))throw TypeError();super(o,!0,u,null),this._nativeMediaElementAudioSourceNode=u}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},lB={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},cB=(n,e,t,r)=>class extends n{constructor(o,a){const l=t(o);if(r(l))throw new TypeError;const u={...lB,...a},d=e(l,u);super(o,!1,d,null),this._nativeMediaStreamAudioDestinationNode=d}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},uB=(n,e,t,r)=>class extends n{constructor(o,a){const l=t(o),u=e(l,a);if(r(l))throw new TypeError;super(o,!0,u,null),this._nativeMediaStreamAudioSourceNode=u}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},dB=(n,e,t)=>class extends n{constructor(i,o){const a=t(i),l=e(a,o);super(i,!0,l,null)}},fB=(n,e,t,r,i,o)=>class extends t{constructor(l,u){super(l),this._nativeContext=l,FS.set(this,l),r(l)&&i.set(l,new Set),this._destination=new n(this,u),this._listener=e(this,l),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(l){const u=typeof l=="function"?o(this,l):null;this._nativeContext.onstatechange=u;const d=this._nativeContext.onstatechange;this._onstatechange=d!==null&&d===u?l:d}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},zv=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},hB=(n,e)=>(t,r,i)=>{const o=new Set;return t.connect=(a=>(l,u=0,d=0)=>{const f=o.size===0;if(e(l))return a.call(t,l,u,d),n(o,[l,u,d],p=>p[0]===l&&p[1]===u&&p[2]===d,!0),f&&r(),l;a.call(t,l,u),n(o,[l,u],p=>p[0]===l&&p[1]===u,!0),f&&r()})(t.connect),t.disconnect=(a=>(l,u,d)=>{const f=o.size>0;if(l===void 0)a.apply(t),o.clear();else if(typeof l=="number"){a.call(t,l);for(const g of o)g[1]===l&&o.delete(g)}else{e(l)?a.call(t,l,u,d):a.call(t,l,u);for(const g of o)g[0]===l&&(u===void 0||g[1]===u)&&(d===void 0||g[2]===d)&&o.delete(g)}const p=o.size===0;f&&p&&i()})(t.disconnect),t},jn=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t]&&(n[t]=r)},vr=(n,e)=>{jn(n,e,"channelCount"),jn(n,e,"channelCountMode"),jn(n,e,"channelInterpretation")},hb=n=>typeof n.getFloatTimeDomainData=="function",pB=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const r=Math.max(t.length,n.fftSize);for(let i=0;i<r;i+=1)e[i]=(t[i]-128)*.0078125;return e}},gB=(n,e)=>(t,r)=>{const i=t.createAnalyser();if(vr(i,r),!(r.maxDecibels>r.minDecibels))throw e();return jn(i,r,"fftSize"),jn(i,r,"maxDecibels"),jn(i,r,"minDecibels"),jn(i,r,"smoothingTimeConstant"),n(hb,()=>hb(i))||pB(i),i},mB=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,Yn=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t].value&&(n[t].value=r)},vB=n=>{n.start=(e=>{let t=!1;return(r=0,i=0,o)=>{if(t)throw Nr();e.call(n,r,i,o),t=!0}})(n.start)},cy=n=>{n.start=(e=>(t=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,r,i)})(n.start)},uy=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},CB=(n,e,t,r,i,o,a,l,u,d,f)=>(p,g)=>{const v=p.createBufferSource();return vr(v,g),Yn(v,g,"playbackRate"),jn(v,g,"buffer"),jn(v,g,"loop"),jn(v,g,"loopEnd"),jn(v,g,"loopStart"),e(t,()=>t(p))||vB(v),e(r,()=>r(p))||u(v),e(i,()=>i(p))||d(v,p),e(o,()=>o(p))||cy(v),e(a,()=>a(p))||f(v,p),e(l,()=>l(p))||uy(v),n(p,v),v},yB=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,xB=(n,e)=>(t,r,i)=>{const o=t.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const a=n(t,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(a,"channelCount",l=>()=>l.call(a),l=>u=>{l.call(a,u);try{o.channelCount=u}catch(d){if(u>o.maxChannelCount)throw d}}),e(a,"channelCountMode",l=>()=>l.call(a),l=>u=>{l.call(a,u),o.channelCountMode=u}),e(a,"channelInterpretation",l=>()=>l.call(a),l=>u=>{l.call(a,u),o.channelInterpretation=u}),Object.defineProperty(a,"maxChannelCount",{get:()=>o.maxChannelCount}),a.connect(o),a},IB=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,bB=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},AB=(n,e,t,r,i)=>(o,a,l,u,d,f)=>{if(l!==null)try{const p=new l(o,u,f),g=new Map;let v=null;if(Object.defineProperties(p,{channelCount:{get:()=>f.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>v,set:C=>{typeof v=="function"&&p.removeEventListener("processorerror",v),v=typeof C=="function"?C:null,typeof v=="function"&&p.addEventListener("processorerror",v)}}}),p.addEventListener=(C=>(...y)=>{if(y[0]==="processorerror"){const x=typeof y[1]=="function"?y[1]:typeof y[1]=="object"&&y[1]!==null&&typeof y[1].handleEvent=="function"?y[1].handleEvent:null;if(x!==null){const I=g.get(y[1]);I!==void 0?y[1]=I:(y[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),x(b)):x(new ErrorEvent(y[0],{...b}))},g.set(x,y[1]))}}return C.call(p,"error",y[1],y[2]),C.call(p,...y)})(p.addEventListener),p.removeEventListener=(C=>(...y)=>{if(y[0]==="processorerror"){const x=g.get(y[1]);x!==void 0&&(g.delete(y[1]),y[1]=x)}return C.call(p,"error",y[1],y[2]),C.call(p,y[0],y[1],y[2])})(p.removeEventListener),f.numberOfOutputs!==0){const C=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return p.connect(C).connect(o.destination),i(p,()=>C.disconnect(),()=>C.connect(o.destination))}return p}catch(p){throw p.code===11?r():p}if(d===void 0)throw r();return bB(f),e(o,a,d,f)},$S=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),wB=n=>new Promise((e,t)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),t(o)},i.postMessage(n)}),SB=async(n,e)=>{const t=await wB(e);return new n(t)},kB=(n,e,t,r)=>{let i=Vv.get(n);i===void 0&&(i=new WeakMap,Vv.set(n,i));const o=SB(t,r);return i.set(e,o),o},EB=(n,e,t,r,i,o,a,l,u,d,f,p,g)=>(v,C,y,x)=>{if(x.numberOfInputs===0&&x.numberOfOutputs===0)throw u();const I=Array.isArray(x.outputChannelCount)?x.outputChannelCount:Array.from(x.outputChannelCount);if(I.some(He=>He<1))throw u();if(I.length!==x.numberOfOutputs)throw e();if(x.channelCountMode!=="explicit")throw u();const b=x.channelCount*x.numberOfInputs,T=I.reduce((He,$e)=>He+$e,0),R=y.parameterDescriptors===void 0?0:y.parameterDescriptors.length;if(b+R>6||T>6)throw u();const P=new MessageChannel,B=[],_=[];for(let He=0;He<x.numberOfInputs;He+=1)B.push(a(v,{channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,gain:1})),_.push(i(v,{channelCount:x.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:x.channelCount}));const M=[];if(y.parameterDescriptors!==void 0)for(const{defaultValue:He,maxValue:$e,minValue:bt,name:xt}of y.parameterDescriptors){const ct=o(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:x.parameterData[xt]!==void 0?x.parameterData[xt]:He===void 0?0:He});Object.defineProperties(ct.offset,{defaultValue:{get:()=>He===void 0?0:He},maxValue:{get:()=>$e===void 0?ai:$e},minValue:{get:()=>bt===void 0?Bi:bt}}),M.push(ct)}const H=r(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+R)}),V=$S(C,v.sampleRate),U=l(v,V,b+R,Math.max(1,T)),Z=i(v,{channelCount:Math.max(1,T),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,T)}),q=[];for(let He=0;He<x.numberOfOutputs;He+=1)q.push(r(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:I[He]}));for(let He=0;He<x.numberOfInputs;He+=1){B[He].connect(_[He]);for(let $e=0;$e<x.channelCount;$e+=1)_[He].connect(H,$e,He*x.channelCount+$e)}const ie=new ZS(y.parameterDescriptors===void 0?[]:y.parameterDescriptors.map(({name:He},$e)=>{const bt=M[$e];return bt.connect(H,0,b+$e),bt.start(0),[He,bt.offset]}));H.connect(U);let le=x.channelInterpretation,Ce=null;const Re=x.numberOfOutputs===0?[U]:q,de={get bufferSize(){return V},get channelCount(){return x.channelCount},set channelCount(He){throw t()},get channelCountMode(){return x.channelCountMode},set channelCountMode(He){throw t()},get channelInterpretation(){return le},set channelInterpretation(He){for(const $e of B)$e.channelInterpretation=He;le=He},get context(){return U.context},get inputs(){return B},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get onprocessorerror(){return Ce},set onprocessorerror(He){typeof Ce=="function"&&de.removeEventListener("processorerror",Ce),Ce=typeof He=="function"?He:null,typeof Ce=="function"&&de.addEventListener("processorerror",Ce)},get parameters(){return ie},get port(){return P.port2},addEventListener(...He){return U.addEventListener(He[0],He[1],He[2])},connect:n.bind(null,Re),disconnect:d.bind(null,Re),dispatchEvent(...He){return U.dispatchEvent(He[0])},removeEventListener(...He){return U.removeEventListener(He[0],He[1],He[2])}},pe=new Map;P.port1.addEventListener=(He=>(...$e)=>{if($e[0]==="message"){const bt=typeof $e[1]=="function"?$e[1]:typeof $e[1]=="object"&&$e[1]!==null&&typeof $e[1].handleEvent=="function"?$e[1].handleEvent:null;if(bt!==null){const xt=pe.get($e[1]);xt!==void 0?$e[1]=xt:($e[1]=ct=>{f(v.currentTime,v.sampleRate,()=>bt(ct))},pe.set(bt,$e[1]))}}return He.call(P.port1,$e[0],$e[1],$e[2])})(P.port1.addEventListener),P.port1.removeEventListener=(He=>(...$e)=>{if($e[0]==="message"){const bt=pe.get($e[1]);bt!==void 0&&(pe.delete($e[1]),$e[1]=bt)}return He.call(P.port1,$e[0],$e[1],$e[2])})(P.port1.removeEventListener);let be=null;Object.defineProperty(P.port1,"onmessage",{get:()=>be,set:He=>{typeof be=="function"&&P.port1.removeEventListener("message",be),be=typeof He=="function"?He:null,typeof be=="function"&&(P.port1.addEventListener("message",be),P.port1.start())}}),y.prototype.port=P.port1;let L=null;kB(v,de,y,x).then(He=>L=He);const ue=S0(x.numberOfInputs,x.channelCount),he=S0(x.numberOfOutputs,I),Ee=y.parameterDescriptors===void 0?[]:y.parameterDescriptors.reduce((He,{name:$e})=>({...He,[$e]:new Float32Array(128)}),{});let Fe=!0;const Je=()=>{x.numberOfOutputs>0&&U.disconnect(Z);for(let He=0,$e=0;He<x.numberOfOutputs;He+=1){const bt=q[He];for(let xt=0;xt<I[He];xt+=1)Z.disconnect(bt,$e+xt,xt);$e+=I[He]}},Te=new Map;U.onaudioprocess=({inputBuffer:He,outputBuffer:$e})=>{if(L!==null){const bt=p(de);for(let xt=0;xt<V;xt+=128){for(let ct=0;ct<x.numberOfInputs;ct+=1)for(let At=0;At<x.channelCount;At+=1)w0(He,ue[ct],At,At,xt);y.parameterDescriptors!==void 0&&y.parameterDescriptors.forEach(({name:ct},At)=>{w0(He,Ee,ct,b+At,xt)});for(let ct=0;ct<x.numberOfInputs;ct+=1)for(let At=0;At<I[ct];At+=1)he[ct][At].byteLength===0&&(he[ct][At]=new Float32Array(128));try{const ct=ue.map((Ut,kt)=>{if(bt[kt].size>0)return Te.set(kt,V/128),Ut;const fn=Te.get(kt);return fn===void 0?[]:(Ut.every(sn=>sn.every(yn=>yn===0))&&(fn===1?Te.delete(kt):Te.set(kt,fn-1)),Ut)});Fe=f(v.currentTime+xt/v.sampleRate,v.sampleRate,()=>L.process(ct,he,Ee));for(let Ut=0,kt=0;Ut<x.numberOfOutputs;Ut+=1){for(let jt=0;jt<I[Ut];jt+=1)XS($e,he[Ut],jt,kt+jt,xt);kt+=I[Ut]}}catch(ct){Fe=!1,de.dispatchEvent(new ErrorEvent("processorerror",{colno:ct.colno,filename:ct.filename,lineno:ct.lineno,message:ct.message}))}if(!Fe){for(let ct=0;ct<x.numberOfInputs;ct+=1){B[ct].disconnect(_[ct]);for(let At=0;At<x.channelCount;At+=1)_[xt].disconnect(H,At,ct*x.channelCount+At)}if(y.parameterDescriptors!==void 0){const ct=y.parameterDescriptors.length;for(let At=0;At<ct;At+=1){const Ut=M[At];Ut.disconnect(H,0,b+At),Ut.stop()}}H.disconnect(U),U.onaudioprocess=null,ft?Je():Rt();break}}}};let ft=!1;const Nt=a(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),rn=()=>U.connect(Nt).connect(v.destination),Rt=()=>{U.disconnect(Nt),Nt.disconnect()},yt=()=>{if(Fe){Rt(),x.numberOfOutputs>0&&U.connect(Z);for(let He=0,$e=0;He<x.numberOfOutputs;He+=1){const bt=q[He];for(let xt=0;xt<I[He];xt+=1)Z.connect(bt,$e+xt,xt);$e+=I[He]}}ft=!0},Pt=()=>{Fe&&(rn(),Je()),ft=!1};return rn(),g(de,yt,Pt)},JS=(n,e)=>{const t=n.createBiquadFilter();return vr(t,e),Yn(t,e,"Q"),Yn(t,e,"detune"),Yn(t,e,"frequency"),Yn(t,e,"gain"),jn(t,e,"type"),t},TB=(n,e)=>(t,r)=>{const i=t.createChannelMerger(r.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),vr(i,r),i},RB=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Nr()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw Nr()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw Nr()}})},Vf=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return vr(t,e),RB(t),t},_B=(n,e,t,r,i)=>(o,a)=>{if(o.createConstantSource===void 0)return t(o,a);const l=o.createConstantSource();return vr(l,a),Yn(l,a,"offset"),e(r,()=>r(o))||cy(l),e(i,()=>i(o))||uy(l),n(o,l),l},ju=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),PB=(n,e,t,r)=>(i,{offset:o,...a})=>{const l=i.createBuffer(1,2,44100),u=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),d=t(i,{...a,gain:o}),f=l.getChannelData(0);f[0]=1,f[1]=1,u.buffer=l,u.loop=!0;const p={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(C){d.channelCount=C},get channelCountMode(){return d.channelCountMode},set channelCountMode(C){d.channelCountMode=C},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(C){d.channelInterpretation=C},get context(){return d.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get offset(){return d.gain},get onended(){return u.onended},set onended(C){u.onended=C},addEventListener(...C){return u.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return u.dispatchEvent(C[0])},removeEventListener(...C){return u.removeEventListener(C[0],C[1],C[2])},start(C=0){u.start.call(u,C)},stop(C=0){u.stop.call(u,C)}},g=()=>u.connect(d),v=()=>u.disconnect(d);return n(i,u),r(ju(p,d),g,v)},DB=(n,e)=>(t,r)=>{const i=t.createConvolver();if(vr(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),jn(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>a=>{if(a>2)throw n();return o.call(i,a)}),r.channelCountMode==="max"))throw n();return e(i,"channelCountMode",o=>()=>o.call(i),o=>a=>{if(a==="max")throw n();return o.call(i,a)}),i},YS=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return vr(t,e),Yn(t,e,"delayTime"),t},NB=n=>(e,t)=>{const r=e.createDynamicsCompressor();if(vr(r,t),t.channelCount>2||t.channelCountMode==="max")throw n();return Yn(r,t,"attack"),Yn(r,t,"knee"),Yn(r,t,"ratio"),Yn(r,t,"release"),Yn(r,t,"threshold"),r},Li=(n,e)=>{const t=n.createGain();return vr(t,e),Yn(t,e,"gain"),t},BB=n=>(e,t,r)=>{if(e.createIIRFilter===void 0)return n(e,t,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return vr(i,r),i};function OB(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function FB(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function pb(n,e){let t=[0,0];for(let r=n.length-1;r>=0;r-=1)t=FB(t,e),t[0]+=n[r];return t}const MB=(n,e,t,r)=>(i,o,{channelCount:a,channelCountMode:l,channelInterpretation:u,feedback:d,feedforward:f})=>{const p=$S(o,i.sampleRate),g=d instanceof Float64Array?d:new Float64Array(d),v=f instanceof Float64Array?f:new Float64Array(f),C=g.length,y=v.length,x=Math.min(C,y);if(C===0||C>20)throw r();if(g[0]===0)throw e();if(y===0||y>20)throw r();if(v[0]===0)throw e();if(g[0]!==1){for(let M=0;M<y;M+=1)v[M]/=g[0];for(let M=1;M<C;M+=1)g[M]/=g[0]}const I=t(i,p,a,a);I.channelCount=a,I.channelCountMode=l,I.channelInterpretation=u;const b=32,T=[],R=[],P=[];for(let M=0;M<a;M+=1){T.push(0);const H=new Float32Array(b),V=new Float32Array(b);H.fill(0),V.fill(0),R.push(H),P.push(V)}I.onaudioprocess=M=>{const H=M.inputBuffer,V=M.outputBuffer,U=H.numberOfChannels;for(let Z=0;Z<U;Z+=1){const q=H.getChannelData(Z),ie=V.getChannelData(Z);T[Z]=KS(g,C,v,y,x,R[Z],P[Z],T[Z],b,q,ie)}};const B=i.sampleRate/2;return ju({get bufferSize(){return p},get channelCount(){return I.channelCount},set channelCount(M){I.channelCount=M},get channelCountMode(){return I.channelCountMode},set channelCountMode(M){I.channelCountMode=M},get channelInterpretation(){return I.channelInterpretation},set channelInterpretation(M){I.channelInterpretation=M},get context(){return I.context},get inputs(){return[I]},get numberOfInputs(){return I.numberOfInputs},get numberOfOutputs(){return I.numberOfOutputs},addEventListener(...M){return I.addEventListener(M[0],M[1],M[2])},dispatchEvent(...M){return I.dispatchEvent(M[0])},getFrequencyResponse(M,H,V){if(M.length!==H.length||H.length!==V.length)throw n();const U=M.length;for(let Z=0;Z<U;Z+=1){const q=-Math.PI*(M[Z]/B),ie=[Math.cos(q),Math.sin(q)],le=pb(v,ie),Ce=pb(g,ie),Re=OB(le,Ce);H[Z]=Math.sqrt(Re[0]*Re[0]+Re[1]*Re[1]),V[Z]=Math.atan2(Re[1],Re[0])}},removeEventListener(...M){return I.removeEventListener(M[0],M[1],M[2])}},I)},LB=(n,e)=>n.createMediaElementSource(e.mediaElement),UB=(n,e)=>{const t=n.createMediaStreamDestination();return vr(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},VB=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((o,a)=>o.id<a.id?-1:o.id>a.id?1:0);const r=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},GB=(n,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=t.createMediaStreamSource(i);if(r.kind!=="audio")throw n();if(e(t))throw new TypeError;return o},WB=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,jB=(n,e,t,r,i,o)=>(a,l)=>{const u=a.createOscillator();return vr(u,l),Yn(u,l,"detune"),Yn(u,l,"frequency"),l.periodicWave!==void 0?u.setPeriodicWave(l.periodicWave):jn(u,l,"type"),e(t,()=>t(a))||cy(u),e(r,()=>r(a))||o(u,a),e(i,()=>i(a))||uy(u),n(a,u),u},zB=n=>(e,t)=>{const r=e.createPanner();return r.orientationX===void 0?n(e,t):(vr(r,t),Yn(r,t,"orientationX"),Yn(r,t,"orientationY"),Yn(r,t,"orientationZ"),Yn(r,t,"positionX"),Yn(r,t,"positionY"),Yn(r,t,"positionZ"),jn(r,t,"coneInnerAngle"),jn(r,t,"coneOuterAngle"),jn(r,t,"coneOuterGain"),jn(r,t,"distanceModel"),jn(r,t,"maxDistance"),jn(r,t,"panningModel"),jn(r,t,"refDistance"),jn(r,t,"rolloffFactor"),r)},HB=(n,e,t,r,i,o,a,l,u,d)=>(f,{coneInnerAngle:p,coneOuterAngle:g,coneOuterGain:v,distanceModel:C,maxDistance:y,orientationX:x,orientationY:I,orientationZ:b,panningModel:T,positionX:R,positionY:P,positionZ:B,refDistance:_,rolloffFactor:M,...H})=>{const V=f.createPanner();if(H.channelCount>2||H.channelCountMode==="max")throw a();vr(V,H);const U={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},Z=t(f,{...U,channelInterpretation:"speakers",numberOfInputs:6}),q=r(f,{...H,gain:1}),ie=r(f,{...U,gain:1}),le=r(f,{...U,gain:0}),Ce=r(f,{...U,gain:0}),Re=r(f,{...U,gain:0}),de=r(f,{...U,gain:0}),pe=r(f,{...U,gain:0}),be=i(f,256,6,1),L=o(f,{...U,curve:new Float32Array([1,1]),oversample:"none"});let K=[x,I,b],ue=[R,P,B];const he=new Float32Array(1);be.onaudioprocess=({inputBuffer:Te})=>{const ft=[u(Te,he,0),u(Te,he,1),u(Te,he,2)];ft.some((rn,Rt)=>rn!==K[Rt])&&(V.setOrientation(...ft),K=ft);const Nt=[u(Te,he,3),u(Te,he,4),u(Te,he,5)];Nt.some((rn,Rt)=>rn!==ue[Rt])&&(V.setPosition(...Nt),ue=Nt)},Object.defineProperty(le.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Ce.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Re.gain,"defaultValue",{get:()=>0}),Object.defineProperty(de.gain,"defaultValue",{get:()=>0}),Object.defineProperty(pe.gain,"defaultValue",{get:()=>0});const Ee={get bufferSize(){},get channelCount(){return V.channelCount},set channelCount(Te){if(Te>2)throw a();q.channelCount=Te,V.channelCount=Te},get channelCountMode(){return V.channelCountMode},set channelCountMode(Te){if(Te==="max")throw a();q.channelCountMode=Te,V.channelCountMode=Te},get channelInterpretation(){return V.channelInterpretation},set channelInterpretation(Te){q.channelInterpretation=Te,V.channelInterpretation=Te},get coneInnerAngle(){return V.coneInnerAngle},set coneInnerAngle(Te){V.coneInnerAngle=Te},get coneOuterAngle(){return V.coneOuterAngle},set coneOuterAngle(Te){V.coneOuterAngle=Te},get coneOuterGain(){return V.coneOuterGain},set coneOuterGain(Te){if(Te<0||Te>1)throw e();V.coneOuterGain=Te},get context(){return V.context},get distanceModel(){return V.distanceModel},set distanceModel(Te){V.distanceModel=Te},get inputs(){return[q]},get maxDistance(){return V.maxDistance},set maxDistance(Te){if(Te<0)throw new RangeError;V.maxDistance=Te},get numberOfInputs(){return V.numberOfInputs},get numberOfOutputs(){return V.numberOfOutputs},get orientationX(){return ie.gain},get orientationY(){return le.gain},get orientationZ(){return Ce.gain},get panningModel(){return V.panningModel},set panningModel(Te){V.panningModel=Te},get positionX(){return Re.gain},get positionY(){return de.gain},get positionZ(){return pe.gain},get refDistance(){return V.refDistance},set refDistance(Te){if(Te<0)throw new RangeError;V.refDistance=Te},get rolloffFactor(){return V.rolloffFactor},set rolloffFactor(Te){if(Te<0)throw new RangeError;V.rolloffFactor=Te},addEventListener(...Te){return q.addEventListener(Te[0],Te[1],Te[2])},dispatchEvent(...Te){return q.dispatchEvent(Te[0])},removeEventListener(...Te){return q.removeEventListener(Te[0],Te[1],Te[2])}};p!==Ee.coneInnerAngle&&(Ee.coneInnerAngle=p),g!==Ee.coneOuterAngle&&(Ee.coneOuterAngle=g),v!==Ee.coneOuterGain&&(Ee.coneOuterGain=v),C!==Ee.distanceModel&&(Ee.distanceModel=C),y!==Ee.maxDistance&&(Ee.maxDistance=y),x!==Ee.orientationX.value&&(Ee.orientationX.value=x),I!==Ee.orientationY.value&&(Ee.orientationY.value=I),b!==Ee.orientationZ.value&&(Ee.orientationZ.value=b),T!==Ee.panningModel&&(Ee.panningModel=T),R!==Ee.positionX.value&&(Ee.positionX.value=R),P!==Ee.positionY.value&&(Ee.positionY.value=P),B!==Ee.positionZ.value&&(Ee.positionZ.value=B),_!==Ee.refDistance&&(Ee.refDistance=_),M!==Ee.rolloffFactor&&(Ee.rolloffFactor=M),(K[0]!==1||K[1]!==0||K[2]!==0)&&V.setOrientation(...K),(ue[0]!==0||ue[1]!==0||ue[2]!==0)&&V.setPosition(...ue);const Fe=()=>{q.connect(V),n(q,L,0,0),L.connect(ie).connect(Z,0,0),L.connect(le).connect(Z,0,1),L.connect(Ce).connect(Z,0,2),L.connect(Re).connect(Z,0,3),L.connect(de).connect(Z,0,4),L.connect(pe).connect(Z,0,5),Z.connect(be).connect(f.destination)},Je=()=>{q.disconnect(V),l(q,L,0,0),L.disconnect(ie),ie.disconnect(Z),L.disconnect(le),le.disconnect(Z),L.disconnect(Ce),Ce.disconnect(Z),L.disconnect(Re),Re.disconnect(Z),L.disconnect(de),de.disconnect(Z),L.disconnect(pe),pe.disconnect(Z),Z.disconnect(be),be.disconnect(f.destination)};return d(ju(Ee,V),Fe,Je)},ZB=n=>(e,{disableNormalization:t,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),a=i instanceof Float32Array?i:new Float32Array(i),l=e.createPeriodicWave(a,o,{disableNormalization:t});if(Array.from(r).length<2)throw n();return l},Gf=(n,e,t,r)=>n.createScriptProcessor(e,t,r),XB=(n,e)=>(t,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,r);const o=t.createStereoPanner();return vr(o,r),Yn(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:a=>{if(a!==i)throw e()}}),o},KB=(n,e,t,r,i,o)=>{const l=new Float32Array([1,1]),u=Math.PI/2,d={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},f={...d,oversample:"none"},p=(C,y,x,I)=>{const b=new Float32Array(16385),T=new Float32Array(16385);for(let H=0;H<16385;H+=1){const V=H/16384*u;b[H]=Math.cos(V),T[H]=Math.sin(V)}const R=t(C,{...d,gain:0}),P=r(C,{...f,curve:b}),B=r(C,{...f,curve:l}),_=t(C,{...d,gain:0}),M=r(C,{...f,curve:T});return{connectGraph(){y.connect(R),y.connect(B.inputs===void 0?B:B.inputs[0]),y.connect(_),B.connect(x),x.connect(P.inputs===void 0?P:P.inputs[0]),x.connect(M.inputs===void 0?M:M.inputs[0]),P.connect(R.gain),M.connect(_.gain),R.connect(I,0,0),_.connect(I,0,1)},disconnectGraph(){y.disconnect(R),y.disconnect(B.inputs===void 0?B:B.inputs[0]),y.disconnect(_),B.disconnect(x),x.disconnect(P.inputs===void 0?P:P.inputs[0]),x.disconnect(M.inputs===void 0?M:M.inputs[0]),P.disconnect(R.gain),M.disconnect(_.gain),R.disconnect(I,0,0),_.disconnect(I,0,1)}}},g=(C,y,x,I)=>{const b=new Float32Array(16385),T=new Float32Array(16385),R=new Float32Array(16385),P=new Float32Array(16385),B=Math.floor(16385/2);for(let Re=0;Re<16385;Re+=1)if(Re>B){const de=(Re-B)/(16384-B)*u;b[Re]=Math.cos(de),T[Re]=Math.sin(de),R[Re]=0,P[Re]=1}else{const de=Re/(16384-B)*u;b[Re]=1,T[Re]=0,R[Re]=Math.cos(de),P[Re]=Math.sin(de)}const _=e(C,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),M=t(C,{...d,gain:0}),H=r(C,{...f,curve:b}),V=t(C,{...d,gain:0}),U=r(C,{...f,curve:T}),Z=r(C,{...f,curve:l}),q=t(C,{...d,gain:0}),ie=r(C,{...f,curve:R}),le=t(C,{...d,gain:0}),Ce=r(C,{...f,curve:P});return{connectGraph(){y.connect(_),y.connect(Z.inputs===void 0?Z:Z.inputs[0]),_.connect(M,0),_.connect(V,0),_.connect(q,1),_.connect(le,1),Z.connect(x),x.connect(H.inputs===void 0?H:H.inputs[0]),x.connect(U.inputs===void 0?U:U.inputs[0]),x.connect(ie.inputs===void 0?ie:ie.inputs[0]),x.connect(Ce.inputs===void 0?Ce:Ce.inputs[0]),H.connect(M.gain),U.connect(V.gain),ie.connect(q.gain),Ce.connect(le.gain),M.connect(I,0,0),q.connect(I,0,0),V.connect(I,0,1),le.connect(I,0,1)},disconnectGraph(){y.disconnect(_),y.disconnect(Z.inputs===void 0?Z:Z.inputs[0]),_.disconnect(M,0),_.disconnect(V,0),_.disconnect(q,1),_.disconnect(le,1),Z.disconnect(x),x.disconnect(H.inputs===void 0?H:H.inputs[0]),x.disconnect(U.inputs===void 0?U:U.inputs[0]),x.disconnect(ie.inputs===void 0?ie:ie.inputs[0]),x.disconnect(Ce.inputs===void 0?Ce:Ce.inputs[0]),H.disconnect(M.gain),U.disconnect(V.gain),ie.disconnect(q.gain),Ce.disconnect(le.gain),M.disconnect(I,0,0),q.disconnect(I,0,0),V.disconnect(I,0,1),le.disconnect(I,0,1)}}},v=(C,y,x,I,b)=>{if(y===1)return p(C,x,I,b);if(y===2)return g(C,x,I,b);throw i()};return(C,{channelCount:y,channelCountMode:x,pan:I,...b})=>{if(x==="max")throw i();const T=n(C,{...b,channelCount:1,channelCountMode:x,numberOfInputs:2}),R=t(C,{...b,channelCount:y,channelCountMode:x,gain:1}),P=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:I});let{connectGraph:B,disconnectGraph:_}=v(C,y,R,P,T);Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"maxValue",{get:()=>1}),Object.defineProperty(P.gain,"minValue",{get:()=>-1});const M={get bufferSize(){},get channelCount(){return R.channelCount},set channelCount(Z){R.channelCount!==Z&&(H&&_(),{connectGraph:B,disconnectGraph:_}=v(C,Z,R,P,T),H&&B()),R.channelCount=Z},get channelCountMode(){return R.channelCountMode},set channelCountMode(Z){if(Z==="clamped-max"||Z==="max")throw i();R.channelCountMode=Z},get channelInterpretation(){return R.channelInterpretation},set channelInterpretation(Z){R.channelInterpretation=Z},get context(){return R.context},get inputs(){return[R]},get numberOfInputs(){return R.numberOfInputs},get numberOfOutputs(){return R.numberOfOutputs},get pan(){return P.gain},addEventListener(...Z){return R.addEventListener(Z[0],Z[1],Z[2])},dispatchEvent(...Z){return R.dispatchEvent(Z[0])},removeEventListener(...Z){return R.removeEventListener(Z[0],Z[1],Z[2])}};let H=!1;const V=()=>{B(),H=!0},U=()=>{_(),H=!1};return o(ju(M,T),V,U)}},$B=(n,e,t,r,i,o,a)=>(l,u)=>{const d=l.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&l.createGain().gain.automationRate===void 0)return t(l,u);vr(d,u);const f=u.curve===null||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(f!==null&&f.length<2)throw e();jn(d,{curve:f},"curve"),jn(d,u,"oversample");let p=null,g=!1;return a(d,"curve",y=>()=>y.call(d),y=>x=>(y.call(d,x),g&&(r(x)&&p===null?p=n(l,d):!r(x)&&p!==null&&(p(),p=null)),x)),i(d,()=>{g=!0,r(d.curve)&&(p=n(l,d))},()=>{g=!1,p!==null&&(p(),p=null)})},JB=(n,e,t,r,i)=>(o,{curve:a,oversample:l,...u})=>{const d=o.createWaveShaper(),f=o.createWaveShaper();vr(d,u),vr(f,u);const p=t(o,{...u,gain:1}),g=t(o,{...u,gain:-1}),v=t(o,{...u,gain:1}),C=t(o,{...u,gain:-1});let y=null,x=!1,I=null;const b={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(P){p.channelCount=P,g.channelCount=P,d.channelCount=P,v.channelCount=P,f.channelCount=P,C.channelCount=P},get channelCountMode(){return d.channelCountMode},set channelCountMode(P){p.channelCountMode=P,g.channelCountMode=P,d.channelCountMode=P,v.channelCountMode=P,f.channelCountMode=P,C.channelCountMode=P},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(P){p.channelInterpretation=P,g.channelInterpretation=P,d.channelInterpretation=P,v.channelInterpretation=P,f.channelInterpretation=P,C.channelInterpretation=P},get context(){return d.context},get curve(){return I},set curve(P){if(P!==null&&P.length<2)throw e();if(P===null)d.curve=P,f.curve=P;else{const B=P.length,_=new Float32Array(B+2-B%2),M=new Float32Array(B+2-B%2);_[0]=P[0],M[0]=-P[B-1];const H=Math.ceil((B+1)/2),V=(B+1)/2-1;for(let U=1;U<H;U+=1){const Z=U/H*V,q=Math.floor(Z),ie=Math.ceil(Z);_[U]=q===ie?P[q]:(1-(Z-q))*P[q]+(1-(ie-Z))*P[ie],M[U]=q===ie?-P[B-1-q]:-((1-(Z-q))*P[B-1-q])-(1-(ie-Z))*P[B-1-ie]}_[H]=B%2===1?P[H-1]:(P[H-2]+P[H-1])/2,d.curve=_,f.curve=M}I=P,x&&(r(I)&&y===null?y=n(o,p):y!==null&&(y(),y=null))},get inputs(){return[p]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get oversample(){return d.oversample},set oversample(P){d.oversample=P,f.oversample=P},addEventListener(...P){return p.addEventListener(P[0],P[1],P[2])},dispatchEvent(...P){return p.dispatchEvent(P[0])},removeEventListener(...P){return p.removeEventListener(P[0],P[1],P[2])}};a!==null&&(b.curve=a instanceof Float32Array?a:new Float32Array(a)),l!==b.oversample&&(b.oversample=l);const T=()=>{p.connect(d).connect(v),p.connect(g).connect(f).connect(C).connect(v),x=!0,r(I)&&(y=n(o,p))},R=()=>{p.disconnect(d),d.disconnect(v),p.disconnect(g),g.disconnect(f),f.disconnect(C),C.disconnect(v),x=!1,y!==null&&(y(),y=null)};return i(ju(b,v),T,R)},Ui=()=>new DOMException("","NotSupportedError"),YB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},qB=(n,e,t,r,i,o,a)=>class extends n{constructor(u,d){const f=i(u),p={...YB,...d},g=t(f,p),v=o(f),C=v?r():null,y=u.sampleRate/2;super(u,!1,g,C),this._detune=e(this,v,g.detune,153600,-153600),this._frequency=e(this,v,g.frequency,y,-y),this._nativeOscillatorNode=g,this._onended=null,this._oscillatorNodeRenderer=C,this._oscillatorNodeRenderer!==null&&p.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=p.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(u){const d=typeof u=="function"?a(this,u):null;this._nativeOscillatorNode.onended=d;const f=this._nativeOscillatorNode.onended;this._onended=f!==null&&f===d?u:f}get type(){return this._nativeOscillatorNode.type}set type(u){this._nativeOscillatorNode.type=u,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(u){this._nativeOscillatorNode.setPeriodicWave(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=u)}start(u=0){if(this._nativeOscillatorNode.start(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=u),this.context.state!=="closed"){Bu(this);const d=()=>{this._nativeOscillatorNode.removeEventListener("ended",d),Ma(this)&&Mf(this)};this._nativeOscillatorNode.addEventListener("ended",d)}}stop(u=0){this._nativeOscillatorNode.stop(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=u)}},QB=(n,e,t,r,i)=>()=>{const o=new WeakMap;let a=null,l=null,u=null;const d=async(f,p)=>{let g=t(f);const v=qr(g,p);if(!v){const C={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,detune:g.detune.value,frequency:g.frequency.value,periodicWave:a===null?void 0:a,type:g.type};g=e(p,C),l!==null&&g.start(l),u!==null&&g.stop(u)}return o.set(p,g),v?(await n(p,f.detune,g.detune),await n(p,f.frequency,g.frequency)):(await r(p,f.detune,g.detune),await r(p,f.frequency,g.frequency)),await i(f,p,g),g};return{set periodicWave(f){a=f},set start(f){l=f},set stop(f){u=f},render(f,p){const g=o.get(p);return g!==void 0?Promise.resolve(g):d(f,p)}}},e5={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},t5=(n,e,t,r,i,o,a)=>class extends n{constructor(u,d){const f=i(u),p={...e5,...d},g=t(f,p),v=o(f),C=v?r():null;super(u,!1,g,C),this._nativePannerNode=g,this._orientationX=e(this,v,g.orientationX,ai,Bi),this._orientationY=e(this,v,g.orientationY,ai,Bi),this._orientationZ=e(this,v,g.orientationZ,ai,Bi),this._positionX=e(this,v,g.positionX,ai,Bi),this._positionY=e(this,v,g.positionY,ai,Bi),this._positionZ=e(this,v,g.positionZ,ai,Bi),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(u){this._nativePannerNode.coneInnerAngle=u}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(u){this._nativePannerNode.coneOuterAngle=u}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(u){this._nativePannerNode.coneOuterGain=u}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(u){this._nativePannerNode.distanceModel=u}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(u){this._nativePannerNode.maxDistance=u}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(u){this._nativePannerNode.panningModel=u}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(u){this._nativePannerNode.refDistance=u}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(u){this._nativePannerNode.rolloffFactor=u}},n5=(n,e,t,r,i,o,a,l,u,d)=>()=>{const f=new WeakMap;let p=null;const g=async(v,C)=>{let y=null,x=o(v);const I={channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation},b={...I,coneInnerAngle:x.coneInnerAngle,coneOuterAngle:x.coneOuterAngle,coneOuterGain:x.coneOuterGain,distanceModel:x.distanceModel,maxDistance:x.maxDistance,panningModel:x.panningModel,refDistance:x.refDistance,rolloffFactor:x.rolloffFactor},T=qr(x,C);if("bufferSize"in x)y=r(C,{...I,gain:1});else if(!T){const R={...b,orientationX:x.orientationX.value,orientationY:x.orientationY.value,orientationZ:x.orientationZ.value,positionX:x.positionX.value,positionY:x.positionY.value,positionZ:x.positionZ.value};x=i(C,R)}if(f.set(C,y===null?x:y),y!==null){if(p===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const U=new a(6,v.context.length,C.sampleRate),Z=e(U,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});Z.connect(U.destination),p=(async()=>{const q=await Promise.all([v.orientationX,v.orientationY,v.orientationZ,v.positionX,v.positionY,v.positionZ].map(async(ie,le)=>{const Ce=t(U,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:le===0?1:0});return await l(U,ie,Ce.offset),Ce}));for(let ie=0;ie<6;ie+=1)q[ie].connect(Z,0,ie),q[ie].start(0);return d(U)})()}const R=await p,P=r(C,{...I,gain:1});await u(v,C,P);const B=[];for(let U=0;U<R.numberOfChannels;U+=1)B.push(R.getChannelData(U));let _=[B[0][0],B[1][0],B[2][0]],M=[B[3][0],B[4][0],B[5][0]],H=r(C,{...I,gain:1}),V=i(C,{...b,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:M[0],positionY:M[1],positionZ:M[2]});P.connect(H).connect(V.inputs[0]),V.connect(y);for(let U=128;U<R.length;U+=128){const Z=[B[0][U],B[1][U],B[2][U]],q=[B[3][U],B[4][U],B[5][U]];if(Z.some((ie,le)=>ie!==_[le])||q.some((ie,le)=>ie!==M[le])){_=Z,M=q;const ie=U/C.sampleRate;H.gain.setValueAtTime(0,ie),H=r(C,{...I,gain:0}),V=i(C,{...b,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:M[0],positionY:M[1],positionZ:M[2]}),H.gain.setValueAtTime(1,ie),P.connect(H).connect(V.inputs[0]),V.connect(y)}}return y}return T?(await n(C,v.orientationX,x.orientationX),await n(C,v.orientationY,x.orientationY),await n(C,v.orientationZ,x.orientationZ),await n(C,v.positionX,x.positionX),await n(C,v.positionY,x.positionY),await n(C,v.positionZ,x.positionZ)):(await l(C,v.orientationX,x.orientationX),await l(C,v.orientationY,x.orientationY),await l(C,v.orientationZ,x.orientationZ),await l(C,v.positionX,x.positionX),await l(C,v.positionY,x.positionY),await l(C,v.positionZ,x.positionZ)),Wu(x)?await u(v,C,x.inputs[0]):await u(v,C,x),x};return{render(v,C){const y=f.get(C);return y!==void 0?Promise.resolve(y):g(v,C)}}},r5={disableNormalization:!1},i5=(n,e,t,r)=>class qS{constructor(o,a){const l=e(o),u=r({...r5,...a}),d=n(l,u);return t.add(d),d}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===qS.prototype||t.has(o)}},o5=(n,e)=>(t,r,i)=>(n(r).replay(i),e(r,t,i)),s5=(n,e,t)=>async(r,i,o)=>{const a=n(r);await Promise.all(a.activeInputs.map((l,u)=>Array.from(l).map(async([d,f])=>{const g=await e(d).render(d,i),v=r.context.destination;!t(d)&&(r!==v||!t(r))&&g.connect(o,f,u)})).reduce((l,u)=>[...l,...u],[]))},a5=(n,e,t)=>async(r,i,o)=>{const a=e(r);await Promise.all(Array.from(a.activeInputs).map(async([l,u])=>{const f=await n(l).render(l,i);t(l)||f.connect(o,u)}))},l5=(n,e,t,r)=>i=>n(zv,()=>zv(i))?Promise.resolve(n(r,r)).then(o=>{if(!o){const a=t(i,512,0,1);i.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>i.currentTime,a.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const a=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=l=>{a.disconnect(),o(l.renderedBuffer)},a.connect(i.destination),i.startRendering()}),c5=n=>(e,t)=>{n.set(e,t)},u5=n=>(e,t)=>n.set(e,t),d5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},f5=(n,e,t,r,i,o)=>class extends n{constructor(l,u){const d=i(l),f={...d5,...u},p=t(d,f),g=o(d),v=g?r():null;super(l,!1,p,v),this._pan=e(this,g,p.pan)}get pan(){return this._pan}},h5=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(l,u)=>{let d=t(l);const f=qr(d,u);if(!f){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,pan:d.pan.value};d=e(u,p)}return o.set(u,d),f?await n(u,l.pan,d.pan):await r(u,l.pan,d.pan),Wu(d)?await i(l,u,d.inputs[0]):await i(l,u,d),d};return{render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):a(l,u)}}},p5=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},g5=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(t);let o=!1,a=!1;try{await r.audioWorklet.addModule(i);const l=new n(r,"a",{numberOfOutputs:0}),u=r.createOscillator();l.port.onmessage=()=>o=!0,l.onprocessorerror=()=>a=!0,u.connect(l),u.start(0),await r.startRendering(),await new Promise(d=>setTimeout(d))}catch{}finally{URL.revokeObjectURL(i)}return o&&!a},m5=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{r.disconnect(),i(t.currentTime!==0)},t.startRendering()})},v5=()=>new DOMException("","UnknownError"),C5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},y5=(n,e,t,r,i,o,a)=>class extends n{constructor(u,d){const f=i(u),p={...C5,...d},g=t(f,p),C=o(f)?r():null;super(u,!0,g,C),this._isCurveNullified=!1,this._nativeWaveShaperNode=g,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(u){if(u===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(u.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=u}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(u){this._nativeWaveShaperNode.oversample=u}},x5=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let l=e(o);if(!qr(l,a)){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,curve:l.curve,oversample:l.oversample};l=n(a,d)}return r.set(a,l),Wu(l)?await t(o,a,l.inputs[0]):await t(o,a,l),l};return{render(o,a){const l=r.get(a);return l!==void 0?Promise.resolve(l):i(o,a)}}},I5=()=>typeof window>"u"?null:window,b5=(n,e)=>t=>{t.copyFromChannel=(r,i,o=0)=>{const a=n(o),l=n(i);if(l>=t.numberOfChannels)throw e();const u=t.length,d=t.getChannelData(l),f=r.length;for(let p=a<0?-a:0;p+a<u&&p<f;p+=1)r[p]=d[p+a]},t.copyToChannel=(r,i,o=0)=>{const a=n(o),l=n(i);if(l>=t.numberOfChannels)throw e();const u=t.length,d=t.getChannelData(l),f=r.length;for(let p=a<0?-a:0;p+a<u&&p<f;p+=1)d[p+a]=r[p]}},A5=n=>e=>{e.copyFromChannel=(t=>(r,i,o=0)=>{const a=n(o),l=n(i);if(a<e.length)return t.call(e,r,l,a)})(e.copyFromChannel),e.copyToChannel=(t=>(r,i,o=0)=>{const a=n(o),l=n(i);if(a<e.length)return t.call(e,r,l,a)})(e.copyToChannel)},w5=n=>(e,t)=>{const r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),n(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},S5=(n,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(r,()=>{const l=r.numberOfInputs;for(let u=0;u<l;u+=1)i.connect(r,0,u)},()=>i.disconnect(r))},QS=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),ek=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},Wf=(n,e,t,r)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:a}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(o),set:r(a)})},k5=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),E5=n=>({...n,channelCount:n.numberOfOutputs}),T5=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},tk=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;tk(n,e,t+1e-7)}},R5=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},_5=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},P5=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},dy=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},nk=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},fy=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},D5=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},N5=n=>{n.start=(e=>(t=0,r=0,i)=>{const o=n.buffer,a=o===null?r:Math.min(o.duration,r);o!==null&&a>o.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,a,i)})(n.start)},rk=(n,e)=>{const t=e.createGain();n.connect(t);const r=(i=>()=>{i.call(n,t),n.removeEventListener("ended",r)})(n.disconnect);n.addEventListener("ended",r),ju(n,t),n.stop=(i=>{let o=!1;return(a=0)=>{if(o)try{i.call(n,a)}catch{t.gain.setValueAtTime(0,a)}else i.call(n,a),o=!0}})(n.stop)},zu=(n,e)=>t=>{const r={value:n};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},B5=a3(_c),O5=h3(_c),F5=SN(X0),ik=new WeakMap,M5=jN(ik),Wa=nN(new Map,new WeakMap),Fs=I5(),ok=gB(Wa,Us),sk=WN(di),Fr=s5(di,sk,xc),L5=C3(ok,Ln,Fr),Dn=ZN(FS),Bl=WB(Fs),Tn=oB(Bl),ak=new WeakMap,lk=ON(zu),jf=yB(Fs),ck=tB(jf),uk=nB(Fs),U5=rB(Fs),gf=IB(Fs),rr=z3(l3(DS),f3(B5,O5,I0,F5,b0,di,M5,Ff,Ln,_c,Ma,xc,hp),Wa,eB(Lv,b0,di,Ln,pf,Ma),Us,K0,Ui,IN(I0,Lv,di,Ln,pf,Dn,Ma,Tn),TN(ak,di,Ko),lk,Dn,ck,uk,U5,Tn,gf),V5=v3(rr,L5,Us,ok,Dn,Tn),dk=new WeakSet,gb=mB(Fs),fk=gN(new Uint32Array(1)),hk=b5(fk,Us),pk=A5(fk),G5=x3(dk,Wa,Ui,gb,Bl,p5(gb),hk,pk),$0=p3(Li),gk=a5(sk,Lf,xc),Vs=cN(gk),Hu=CB($0,Wa,R5,_5,P5,dy,nk,fy,N5,w5(Wf),rk),Gs=o5(zN(Lf),gk),W5=A3(Vs,Hu,Ln,Gs,Fr),Qo=H3(c3(BS),ak,OS,Z3,t3,n3,r3,i3,o3,Ov,_S,jf,tk),j5=b3(rr,W5,Qo,Nr,Hu,Dn,Tn,zu),z5=N3(rr,B3,Us,Nr,xB(Li,Wf),Dn,Tn,Fr),H5=tN(Vs,JS,Ln,Gs,Fr),Pc=u5(ik),Z5=eN(rr,Qo,H5,K0,JS,Dn,Tn,Pc),Ol=hB(_c,uk),X5=S5(Nr,Ol),Fl=TB(jf,X5),K5=oN(Fl,Ln,Fr),$5=iN(rr,K5,Fl,Dn,Tn),J5=lN(Vf,Ln,Fr),Y5=aN(rr,J5,Vf,Dn,Tn,E5),q5=PB($0,Hu,Li,Ol),Zu=_B($0,Wa,q5,dy,fy),Q5=pN(Vs,Zu,Ln,Gs,Fr),e4=hN(rr,Qo,Q5,Zu,Dn,Tn,zu),mk=DB(Ui,Wf),t4=CN(mk,Ln,Fr),n4=vN(rr,t4,mk,Dn,Tn,Pc),r4=wN(Vs,YS,Ln,Gs,Fr),i4=AN(rr,Qo,r4,YS,Dn,Tn,Pc),vk=NB(Ui),o4=DN(Vs,vk,Ln,Gs,Fr),s4=PN(rr,Qo,o4,vk,Ui,Dn,Tn,Pc),a4=VN(Vs,Li,Ln,Gs,Fr),l4=UN(rr,Qo,a4,Li,Dn,Tn),c4=MB(K0,Nr,Gf,Ui),hy=l5(Wa,Li,Gf,m5(Li,Bl)),u4=QN(Hu,Ln,Bl,Fr,hy),d4=BB(c4),f4=YN(rr,d4,u4,Dn,Tn,Pc),h4=O3(Qo,Fl,Zu,Gf,Ui,QS,Tn,Wf),Ck=new WeakMap,p4=fB(z5,h4,lk,Tn,Ck,zu),yk=jB($0,Wa,dy,nk,fy,rk),g4=QB(Vs,yk,Ln,Gs,Fr),m4=qB(rr,Qo,yk,g4,Dn,Tn,zu),xk=dN(Hu),v4=JB(xk,Nr,Li,ek,Ol),J0=$B(xk,Nr,v4,ek,Ol,jf,Wf),C4=HB(I0,Nr,Fl,Li,Gf,J0,Ui,b0,QS,Ol),Ik=zB(C4),y4=n5(Vs,Fl,Zu,Li,Ik,Ln,Bl,Gs,Fr,hy),x4=t5(rr,Qo,Ik,y4,Dn,Tn,Pc),I4=ZB(Us),b4=i5(I4,Dn,new WeakSet,T5),A4=KB(Fl,Vf,Li,J0,Ui,Ol),bk=XB(A4,Ui),w4=h5(Vs,bk,Ln,Gs,Fr),S4=f5(rr,Qo,bk,w4,Dn,Tn),k4=x5(J0,Ln,Fr),E4=y5(rr,Nr,J0,k4,Dn,Tn,Pc),Ak=sB(Fs),py=FN(Fs),wk=new WeakMap,T4=XN(wk,Bl),R4=Ak?d3(Wa,Ui,BN(Fs),py,MN(s3),Dn,T4,Tn,gf,new WeakMap,new WeakMap,g5(gf,Bl),Fs):void 0,_4=iB(ck,Tn),P4=xN(dk,Wa,yN,NN,new WeakSet,Dn,_4,Wv,zv,hk,pk),D4=q3(R4,V5,G5,j5,Z5,$5,Y5,e4,n4,P4,i4,s4,l4,f4,p4,m4,x4,b4,S4,E4),N4=aB(rr,LB,Dn,Tn),B4=cB(rr,UB,Dn,Tn),O4=uB(rr,VB,Dn,Tn),F4=GB(Nr,Tn),M4=dB(rr,F4,Dn),L4=D3(D4,Nr,Ui,v5,N4,B4,O4,M4,jf),Sk=KN(Ck),U4=g3(Sk),kk=uN(Us),V4=kN(Sk),Ek=RN(Us),Tk=new WeakMap,G4=GN(Tk,Ko),W4=EB(kk,Us,Nr,Fl,Vf,Zu,Li,Gf,Ui,Ek,py,G4,Ol),j4=AB(Nr,W4,Li,Ui,Ol),z4=Y3(Vs,kk,Hu,Fl,Vf,Zu,Li,V4,Ek,py,Ln,gf,Bl,Gs,Fr,hy),H4=HN(wk),Z4=c5(Tk),mb=Ak?K3(U4,rr,Qo,z4,j4,di,H4,Dn,Tn,gf,k5,Z4,D5,zu):void 0,X4="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";class vb{constructor(e){ee(this,"maxSize");ee(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;r!==void 0&&this.cache.delete(r)}this.cache.set(e,t)}has(e){return this.cache.has(e)}}const Cb=100,er=class er{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getOrCreatePendingRequest(e,t){let r=this.pendingRequests.get(e);if(!r){const i=(async()=>{try{const o=await t();if(o===void 0)throw new Error("Failed to create audio buffer.");return o}finally{this.pendingRequests.delete(e)}})();return this.pendingRequests.set(e,i),i}return r}static async updateMetadata(e,t,r){const i={url:t,timestamp:Date.now(),...r};await e.put(`${t}:meta`,new Response(JSON.stringify(i),{headers:{"Content-Type":"application/json"}}))}static async getBufferFromCache(e,t){try{const r=await t.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,t,r,i){const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const a=await fetch(e,{headers:o});if(a.status===304){const l=await t.match(e);if(l){const u=Date.now();return await this.updateMetadata(t,e,{timestamp:u,etag:r,lastModified:i}),await l.arrayBuffer()}else{console.warn(`Cache inconsistency detected for ${e}: 304 response but no cached body. Re-fetching.`);const u=await fetch(e);if(u.status===200){const d=u.clone(),f=u.headers.get("ETag"),p=u.headers.get("Last-Modified");try{await Promise.all([t.put(e,d),this.updateMetadata(t,e,{timestamp:Date.now(),etag:f||void 0,lastModified:p||void 0})])}catch(g){throw await t.delete(e),await t.delete(`${e}:meta`),g}return await u.arrayBuffer()}else throw new Error(`Failed to fetch resource after cache inconsistency: ${u.status} ${u.statusText}`)}}if(a.status===200){const l=a.clone(),u=a.headers.get("ETag"),d=a.headers.get("Last-Modified");try{await Promise.all([t.put(e,l),this.updateMetadata(t,e,{timestamp:Date.now(),etag:u||void 0,lastModified:d||void 0})])}catch(f){throw await t.delete(e),await t.delete(`${e}:meta`),f}}return await a.arrayBuffer()}static async decodeAudioData(e,t){try{return await e.decodeAudioData(t)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,t){try{const r=await t.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}async getAudioBuffer(e,t){if(er.decodedBuffers.has(t))return er.decodedBuffers.get(t);if(t.startsWith("data:")){const a=t.split(",")[1],l=Uint8Array.from(atob(a),d=>d.charCodeAt(0)).buffer,u=await er.decodeAudioData(e,l);return er.decodedBuffers.set(t,u),u}const r=await er.openCache(),i=await er.getMetadataFromCache(t,r),o=!i||i.etag||i.lastModified||Date.now()-i.timestamp>er.cacheExpirationTime;return er.getOrCreatePendingRequest(t,async()=>{if(o){const a=await er.fetchAndCacheBuffer(t,r,i==null?void 0:i.etag,i==null?void 0:i.lastModified),l=await er.decodeAudioData(e,a);return er.decodedBuffers.set(t,l),l}else{const a=await er.getBufferFromCache(t,r);if(a){const l=await er.decodeAudioData(e,a);return er.decodedBuffers.set(t,l),l}}})}clearMemoryCache(){er.decodedBuffers=new vb(Cb),er.pendingRequests.clear()}};ee(er,"pendingRequests",new Map),ee(er,"decodedBuffers",new vb(Cb)),ee(er,"cacheExpirationTime",24*60*60*1e3);let Hv=er;class yb{constructor(e=[]){ee(this,"_position",[0,0,0]);ee(this,"loopCount",0);ee(this,"playIndex",0);this.sounds=e}preplayRandom(){if(this.sounds.length===0)return;const e=this.randomSound().preplay();return e.length>0?e[0]:void 0}playRandom(){const e=this.preplayRandom();return e&&e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)return;const t=this.sounds[this.playIndex].preplay();if(t.length!==0)return this.playIndex=(this.playIndex+1)%this.sounds.length,!e&&this.playIndex===0&&(this.playIndex=this.sounds.length),t[0]}playOrdered(e=!0){const t=this.preplayOrdered(e);return t&&t.play(),t}get duration(){return this.sounds.map(e=>e.duration).reduce((e,t)=>Math.max(e,t),0)}seek(e){this.sounds.forEach(t=>t.seek&&t.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.map(e=>e.preplay()).flat()}play(){const e=[];return this.preplay().forEach(t=>{t.play(),e.push(t)}),e}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(t=>t.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(t=>t.addFilter(e))}removeFilter(e){this.sounds.forEach(t=>t.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(t=>t.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,t)=>e+t,0)/this.sounds.length}set volume(e){this.sounds.forEach(t=>t.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(t=>t.playbackRate=e)}}class Xu{constructor(){ee(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(t=>t.frequency.value!==e.frequency.value&&t.type!==e.type&&t.Q.value!==e.Q.value&&t.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((t,r)=>(t.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(t=>this.addFilter(t))}removeFilters(e){e.forEach(t=>this.removeFilter(t))}}let K4=class extends Xu{constructor(t,r,i,o=0){super();ee(this,"context");ee(this,"source");ee(this,"gainNode");ee(this,"panner");this.source=t,this.gainNode=r,this.context=i,this.panner=i.createPanner(),t.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(t){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=t}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!0)}addFilter(t){super.addFilter(t),this.refreshFilters()}removeFilter(t){super.removeFilter(t),this.refreshFilters()}set position(t){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=t;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.source;this.source.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(t){}};class $4 extends Xu{constructor(t){super();ee(this,"context");ee(this,"_position",[0,0,0]);ee(this,"loopCount",0);ee(this,"prevVolume",1);ee(this,"microphoneGainNode");ee(this,"streamPlayback");ee(this,"stream");ee(this,"streamSource");this.context=t,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{this.stream=t,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new K4(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(t=>{console.error("Error initializing microphone stream:",t)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(t){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(t){this.streamPlayback&&this.streamPlayback.addFilter(t)}removeFilter(t){this.streamPlayback&&this.streamPlayback.removeFilter(t)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(t){this.streamPlayback&&(this.streamPlayback.volume=t)}get position(){return[0,0,0]}set position(t){}loop(t){return 0}get playbackRate(){return 1}set playbackRate(t){}}function Rk(n){class e extends n{constructor(){super(...arguments);ee(this,"playbacks",[]);ee(this,"_position",[0,0,0]);ee(this,"_stereoPan",0);ee(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});ee(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function _k(n){class e extends n{constructor(){super(...arguments);ee(this,"panner");ee(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=xb(i,-1,1),this.panner.pan.setValueAtTime(xb(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,a,l]=i,u=this.panner;u.positionX.value=o,u.positionY.value=a,u.positionZ.value=l}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function xb(n,e,t){return Math.min(Math.max(n,e),t)}function Pk(n){class e extends n{constructor(){super(...arguments);ee(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}class Dk extends _k(Pk(Xu)){constructor(){super(...arguments);ee(this,"source");ee(this,"_playing",!1);ee(this,"origin")}get isPlaying(){return this.source?this._playing:!1}}class gy extends Dk{constructor(t,r,i){super();ee(this,"context");ee(this,"loopCount",0);ee(this,"currentLoop",0);ee(this,"buffer");ee(this,"_offset",0);ee(this,"_startTime",0);ee(this,"_state",0);ee(this,"_playbackRate",1);ee(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():this.play()))});this.origin=t,this.context=t.context,this.loopCount=t.loopCount,this.setPanType(t.panType,t.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(t){if("mediaElement"in t&&t.mediaElement)t.mediaElement.onended=this.loopEnded;else if("onended"in t)t.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(t){if(t<=0)throw new Error("Playback rate must be greater than 0");if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=t,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=t))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const t=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=t,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(t){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(t)||t<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=t,"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.currentTime=t),r&&this.play()}get currentTime(){if(this._state===1){const t=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+t}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&(!("mediaElement"in this.source)&&"onended"in this.source&&(this.source.onended=null),this.source.disconnect()),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(t){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=t)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(t=>{t&&t.disconnect()}),this._filters=[]}loop(t){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(t!==void 0&&(this.loopCount=t==="infinite"?"infinite":Math.max(0,t),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(t){const r=this.context.createBiquadFilter();r.type=t.type,r.frequency.value=t.frequency.value,r.Q.value=t.Q.value,r.gain.value=t.gain.value,this._filters.push(r),this.refreshFilters()}removeFilter(t){const r=this._filters.indexOf(t);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}clone(t={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=t.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const a=t.loopCount!==void 0?t.loopCount:this.loopCount,l=new gy(this.origin,o,i);return l.loopCount=a,l.currentLoop=this.currentLoop,l.setPanType(r,this.context),l.volume=this.volume,l.playbackRate=this._playbackRate,l._offset=this._offset,l._state=this._state,this._filters.forEach(u=>{const d=this.context.createBiquadFilter();d.type=u.type,d.frequency.value=u.frequency.value,d.Q.value=u.Q.value,d.gain.value=u.gain.value,l.addFilter(d)}),this._state===1&&l.play(),l}}let tp=class Nk extends Rk(Xu){constructor(t,r,i,o,a=mf.Buffer,l="HRTF"){super();ee(this,"buffer");ee(this,"context");ee(this,"loopCount",0);ee(this,"_playbackRate",1);this.url=t,this.globalGainNode=o,this.soundType=a,this.panType=l,this.buffer=r,this.context=i}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan,o=t.threeDOptions||this.threeDOptions,a=t.loopCount!==void 0?t.loopCount:this.loopCount,l=t.playbackRate||this.playbackRate,u=t.volume!==void 0?t.volume:this.volume,d=t.position!==void 0?t.position:this.position,f=t.filters&&t.filters.length?t.filters:this._filters,p=new Nk(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return p.loop(a),p.playbackRate=l,p.volume=u,r==="HRTF"?(p.threeDOptions=o,p.position=d):p.stereoPan=i,p.addFilters(f),p}preplay(){let t;if(this.buffer)t=this.context.createBufferSource(),t.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",t=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new gy(this,t,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(t){this.playbacks.forEach(r=>r.seek(t))}get duration(){var t;return this.playbacks.length>0?this.playbacks[0].duration:((t=this.buffer)==null?void 0:t.duration)||NaN}loop(t){return t===void 0?this.loopCount:(this.loopCount=t,this.playbacks.forEach(r=>r.loop(t)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.playbacks.forEach(r=>r.playbackRate=t)}};function J4(n){class e extends Dk{constructor(){super(...arguments);ee(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}class Y4 extends J4(_k(Pk(Xu))){constructor(t,r,i){super();ee(this,"context");this.origin=t,this.source=r,this.context=t.context,this.setPanType(t.panType,t.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}}class my extends Rk(Xu){constructor(t,r,i=mf.Oscillator,o="HRTF",a={}){super();ee(this,"_oscillatorOptions");ee(this,"playbacks",[]);this.context=t,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=t,this._oscillatorOptions=a}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan??0,o=t.threeDOptions||this.threeDOptions,a=t.volume!==void 0?t.volume:this.volume,l=t.position&&t.position.length?t.position:this.position,u=t.filters&&t.filters.length?t.filters:this._filters,d=t.oscillatorOptions||this._oscillatorOptions,f=new my(this.context,this.globalGainNode,this.soundType,r,d);return f._volume=a,f._position=l,f._stereoPan=i,f._threeDOptions=o,f.addFilters(u),f}preplay(){const t=this.context.createOscillator();this.oscillatorOptions.detune&&(t.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(t.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(t.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new Y4(this,t,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(t){this._oscillatorOptions=t,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(t){this._oscillatorOptions.frequency=t,this.playbacks.forEach(r=>r.frequency=t)}get detune(){return this.oscillatorOptions.detune}set detune(t){this._oscillatorOptions.detune=t,this.playbacks.forEach(r=>r.detune=t)}get type(){return this.oscillatorOptions.type||"sine"}set type(t){this._oscillatorOptions.type=t,this.playbacks.forEach(r=>r.type=t)}}var mf=(n=>(n.HTML="HTML",n.Streaming="Streaming",n.Buffer="Buffer",n.Oscillator="oscillator",n))(mf||{});class q4{constructor(e,t){ee(this,"context");ee(this,"globalGainNode");ee(this,"listener");ee(this,"prevVolume",1);ee(this,"finalizationRegistry");ee(this,"cache");ee(this,"createBiquadFilter",({type:e,frequency:t,gain:r,Q:i})=>{t===void 0&&(t=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=t,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new L4,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.cache=t||new Hv,this.finalizationRegistry=new FinalizationRegistry(r=>{r.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",X4):console.warn("AudioWorklet not supported")}async createWorkletNode(e,t){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new mb(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",t);try{await this.context.audioWorklet.addModule(t)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${t}`)}return new mb(this.context,e)}}clearMemoryCache(){this.cache.clearMemoryCache()}createOscillator(e,t="HRTF"){return new my(this.context,this.globalGainNode,"oscillator",t,e)}async createSound(e,t="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new tp("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(t==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new tp(i,void 0,this.context,this.globalGainNode,"HTML",r)}return this.cache.getAudioBuffer(this.context,i).then(o=>new tp(i,o,this.context,this.globalGainNode,t,r))}async createGroup(e){const t=new yb;return e.forEach(r=>t.addSound(r)),t}async createGroupFromUrls(e,t="Buffer",r="HRTF"){const i=new yb;return(await Promise.all(e.map(o=>this.createSound(o,t,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return new tp(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:t,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:a,channelCountMode:l,channelInterpretation:u,panningModel:d,refDistance:f,rolloffFactor:p,positionX:g,positionY:v,positionZ:C,orientationX:y,orientationY:x,orientationZ:I}){const b=this.context.createPanner();return b.coneInnerAngle=e||360,b.coneOuterAngle=t||360,b.coneOuterGain=r||0,b.distanceModel=i||"inverse",b.maxDistance=o||1e4,b.channelCount=a||2,b.channelCountMode=l||"clamped-max",b.channelInterpretation=u||"speakers",b.panningModel=d||"HRTF",b.refDistance=f||1,b.rolloffFactor=p||1,b.positionX.value=g||0,b.positionY.value=v||0,b.positionZ.value=C||0,b.orientationX.value=y||0,b.orientationY.value=x||0,b.orientationZ.value=I||0,b}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new $4(this.context);i.play(),e(i)}).catch(r=>{t(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:t,up:r}=e,[i,o,a]=t,[l,u,d]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=a,this.listener.upX.value=l,this.listener.upY.value=u,this.listener.upZ.value=d}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[t,r,i]=e;this.listener.upX.value=t,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[t,r,i]=e;this.listener.forwardX.value=t,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[t,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(t,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}}const Q4="https://mongoose.world:9080/?url=";class eO extends Un{constructor(){super(...arguments);ee(this,"packageName","Client.Media");ee(this,"sounds",{});ee(this,"defaultUrl","")}handleDefault(t){this.defaultUrl=t}async handleLoad(t){const r=(t.url||this.defaultUrl)+t.name,i=t.url+t.name;if(!this.sounds[i]){let a=await this.client.cacophony.createSound(r);a.key=i,this.sounds[i]=a}}mediaUrl(t){var i;let r=(t.url||this.defaultUrl)+t.name;return((i=t.type)==null?void 0:i.toLowerCase())==="music"&&(r=Q4+encodeURIComponent(r)),r}async handlePlay(t){let r=this.mediaUrl(t);t.key=t.key||r;let i=this.sounds[t.key];const o=t.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(t.type==="music"?i=await this.client.cacophony.createSound(r,mf.HTML,o):i=await this.client.cacophony.createSound(r,mf.Buffer,o)),t.volume!==void 0&&(i.volume=t.volume/100),t.loops!==void 0){const a=t.loops===-1?1/0:t.loops-1;i.loop(a)}if(t.start&&i.seek(t.start/1e3),t.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},t.end),t.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[t.position[0],t.position[1],t.position[2]]),t.priority){for(let a in this.sounds){const l=this.sounds[a];l.priority&&l.priority<t.priority&&l.stop()}i.priority=t.priority}i.isPlaying||(i.play()[0],t.fadein,t.fadeout),i.key=t.key,this.sounds[i.key]=i}handleStop(t){t.name&&this.soundsByName(t.name).forEach(r=>this.stopSound(r)),t.type&&this.soundsByType(t.type).forEach(r=>this.stopSound(r)),t.tag&&this.soundsByTag(t.tag).forEach(r=>this.stopSound(r)),t.key&&this.soundsByKey(t.key).forEach(r=>this.stopSound(r)),!t.name&&!t.type&&!t.tag&&!t.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(t){delete this.sounds[t.key],t.stop()}handleListenerPosition(t){var r;(r=t.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=t.position)}handleListenerOrientation(t){t.up&&t.up.length&&(this.client.cacophony.listenerUpOrientation=t.up),t.forward&&t.forward.length&&(this.client.cacophony.listenerForwardOrientation=t.forward)}soundsByName(t){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(t))}soundsByKey(t){return Object.values(this.sounds).filter(r=>r.key===t)}soundsByTag(t){return Object.values(this.sounds).filter(r=>r.tag===t)}soundsByType(t){return Object.values(this.sounds).filter(r=>r.mediaType===t)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(t=>t.stop()),this.sounds={}}}class tO extends Un{constructor(){super(...arguments);ee(this,"packageName","Client.Speech")}handleSpeak(t){const r=new SpeechSynthesisUtterance(t.text);r.rate=t.rate,r.pitch=t.pitch,r.volume=t.volume,speechSynthesis.speak(r)}}class nO extends Un{constructor(){super(...arguments);ee(this,"packageName","Comm.Channel");ee(this,"channels",[])}handleList(t){this.channels=t}sendList(){this.sendData("List")}handleText(t){console.log(`Received Comm.Channel.Text on ${t.channel} from ${t.talker}: ${t.text}`),this.client.emit("channelText",t),t.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${t.talker}`,`${t.text}`))}handlePlayers(t){console.log("Received Comm.Channel.Players:",t),this.client.emit("channelPlayers",t)}sendPlayersRequest(){this.sendData("Players","")}sendEnable(t){this.sendData("Enable",t)}handleStart(t){console.log(`Received Comm.Channel.Start for ${t}`),this.client.emit("channelStart",t)}handleEnd(t){console.log(`Received Comm.Channel.End for ${t}`),this.client.emit("channelEnd",t)}}class rO extends Un{constructor(){super(...arguments);ee(this,"packageName","Comm.LiveKit")}handleroom_token(t){this.client.worldData.liveKitTokens.push(t.token),this.client.emit("livekitToken",t.token)}handleroom_leave(t){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==t.token),this.client.emit("livekitLeave",t.token)}}class iO extends Un{constructor(){super(...arguments);ee(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}sendKeepAlive(){this.sendData("KeepAlive")}sendPing(t){this.sendData("Ping",t)}handlePing(){console.log("Received Core.Ping response from server."),this.client.emit("corePing")}handleGoodbye(t){console.log(`Server sent Core.Goodbye: ${t}`),this.client.emit("coreGoodbye",t)}}class oO extends Un{constructor(){super(...arguments);ee(this,"packageName","Core.Supports")}sendSet(){const t=Object.values(this.client.gmcpHandlers).filter(r=>r.packageName&&r.packageVersion).map(r=>`${r.packageName} ${r.packageVersion.toString()}`);this.sendData("Set",t)}sendAdd(t){const r=t.map(i=>`${i.name} ${i.version}`);this.sendData("Add",r)}sendRemove(t){this.sendData("Remove",t)}}class sO extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Afflictions")}handleList(t){console.log("Received Char.Afflictions.List:",t),this.client.emit("afflictionsList",t)}handleAdd(t){console.log("Received Char.Afflictions.Add:",t),this.client.emit("afflictionAdd",t)}handleRemove(t){console.log("Received Char.Afflictions.Remove:",t),this.client.emit("afflictionRemove",t)}}class aO extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Defences")}handleList(t){console.log("Received Char.Defences.List:",t),this.client.emit("defencesList",t)}handleAdd(t){console.log("Received Char.Defences.Add:",t),this.client.emit("defenceAdd",t)}handleRemove(t){console.log("Received Char.Defences.Remove:",t),this.client.emit("defenceRemove",t)}}class lO extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Items")}handleList(t){console.log(`Received Char.Items.List for ${t.location}:`,t.items);const r=t.items.map(i=>({...i,location:t.location}));this.client.emit("itemsList",{...t,items:r})}handleAdd(t){console.log(`Received Char.Items.Add for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemAdd",{...t,item:r})}handleRemove(t){console.log(`Received Char.Items.Remove for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemRemove",{...t,item:r})}handleUpdate(t){console.log(`Received Char.Items.Update for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemUpdate",{...t,item:r})}sendContentsRequest(t){this.sendData("Contents",t)}sendInventoryRequest(){this.sendData("Inv","")}sendRoomRequest(){this.sendData("Room","")}}class cO extends Un{constructor(){super(...arguments);ee(this,"packageName","Char.Skills")}handleGroups(t){console.log("Received Char.Skills.Groups:",t),this.client.emit("skillGroups",t)}handleList(t){console.log(`Received Char.Skills.List for ${t.group}:`,t),this.client.emit("skillList",t)}handleInfo(t){console.log(`Received Char.Skills.Info for ${t.group}.${t.skill}:`,t.info),this.client.emit("skillInfo",t)}sendGetRequest(t,r){const i={};t&&(i.group=t),r&&(i.name=r),this.sendData("Get",i)}}class uO extends Un{constructor(){super(...arguments);ee(this,"packageName","Group")}handleInfo(t){console.log("Received Group.Info:",t),this.client.emit("groupInfo",t)}sendInfoRequest(){this.sendData("Info",{})}}class dO extends Un{constructor(){super(...arguments);ee(this,"packageName","Logging")}handleError(t){console.error("Received Logging.Error from server:",t),this.client.emit("gmcpError",t)}}class fO extends Un{constructor(){super(...arguments);ee(this,"packageName","Redirect")}handleWindow(t){const r=t||"main";console.log(`Received Redirect.Window: ${r}`),this.client.emit("redirectWindow",r)}}class hO extends Un{constructor(){super(...arguments);ee(this,"packageName","Room");ee(this,"name","");ee(this,"id","");ee(this,"exits",[]);ee(this,"people",[])}handleInfo(t){this.client.worldData.roomPlayers=[],this.name=t.name,this.id=t.num.toString(),this.client.worldData.roomId=this.id,this.client.currentRoomInfo=t,console.log("Received Room.Info:",t),this.client.emit("roomInfo",t)}handleWrongDir(t){console.log(`Received Room.WrongDir: ${t}`),this.client.emit("roomWrongDir",t)}handlePlayers(t){console.log("Received Room.Players:",t),this.client.worldData.roomPlayers=t.sort((r,i)=>r.fullname.localeCompare(i.fullname)),this.client.emit("roomPlayers",t)}handleAddPlayer(t){console.log("Received Room.AddPlayer:",t),this.client.worldData.roomPlayers.some(r=>r.name===t.name)||(this.client.worldData.roomPlayers.push(t),this.client.worldData.roomPlayers.sort((r,i)=>r.fullname.localeCompare(i.fullname))),this.client.emit("roomAddPlayer",t)}handleRemovePlayer(t){console.log("Received Room.RemovePlayer:",t),this.client.worldData.roomPlayers=this.client.worldData.roomPlayers.filter(r=>r.name!==t),this.client.emit("roomRemovePlayer",t)}}const du=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Bk=new Set,Zv=typeof process=="object"&&process?process:{},Ok=(n,e,t,r)=>{typeof Zv.emitWarning=="function"?Zv.emitWarning(n,e,t,r):console.error(`[${t}] ${e}: ${n}`)};let k0=globalThis.AbortController,Ib=globalThis.AbortSignal;var $w;if(typeof k0>"u"){Ib=class{constructor(){ee(this,"onabort");ee(this,"_onabort",[]);ee(this,"reason");ee(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},k0=class{constructor(){ee(this,"signal",new Ib);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const a of this.signal._onabort)a(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let n=(($w=Zv.env)==null?void 0:$w.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{n&&(n=!1,Ok("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const pO=n=>!Bk.has(n),pl=n=>n&&n===Math.floor(n)&&n>0&&isFinite(n),Fk=n=>pl(n)?n<=Math.pow(2,8)?Uint8Array:n<=Math.pow(2,16)?Uint16Array:n<=Math.pow(2,32)?Uint32Array:n<=Number.MAX_SAFE_INTEGER?pp:null:null;class pp extends Array{constructor(e){super(e),this.fill(0)}}var Tu;const uc=class uc{constructor(e,t){ee(this,"heap");ee(this,"length");if(!Q(uc,Tu))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}static create(e){const t=Fk(e);if(!t)return[];Tt(uc,Tu,!0);const r=new uc(e,t);return Tt(uc,Tu,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};Tu=new WeakMap,un(uc,Tu,!1);let Xv=uc;var Jw,Yw,_o,Hi,Po,Do,Ru,_u,dr,No,sr,Fn,Wt,oi,Zi,Kr,Ar,Bo,wr,Oo,Fo,Xi,Mo,yl,si,Qe,$v,fc,ca,_f,Ki,Mk,hc,Pu,Pf,gl,ml,Jv,gp,mp,On,Yv,tf,vl,qv;const c1=class c1{constructor(e){un(this,Qe);un(this,_o);un(this,Hi);un(this,Po);un(this,Do);un(this,Ru);un(this,_u);ee(this,"ttl");ee(this,"ttlResolution");ee(this,"ttlAutopurge");ee(this,"updateAgeOnGet");ee(this,"updateAgeOnHas");ee(this,"allowStale");ee(this,"noDisposeOnSet");ee(this,"noUpdateTTL");ee(this,"maxEntrySize");ee(this,"sizeCalculation");ee(this,"noDeleteOnFetchRejection");ee(this,"noDeleteOnStaleGet");ee(this,"allowStaleOnFetchAbort");ee(this,"allowStaleOnFetchRejection");ee(this,"ignoreFetchAbort");un(this,dr);un(this,No);un(this,sr);un(this,Fn);un(this,Wt);un(this,oi);un(this,Zi);un(this,Kr);un(this,Ar);un(this,Bo);un(this,wr);un(this,Oo);un(this,Fo);un(this,Xi);un(this,Mo);un(this,yl);un(this,si);un(this,fc,()=>{});un(this,ca,()=>{});un(this,_f,()=>{});un(this,Ki,()=>!1);un(this,hc,e=>{});un(this,Pu,(e,t,r)=>{});un(this,Pf,(e,t,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});ee(this,Jw,"LRUCache");const{max:t=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:a,updateAgeOnHas:l,allowStale:u,dispose:d,disposeAfter:f,noDisposeOnSet:p,noUpdateTTL:g,maxSize:v=0,maxEntrySize:C=0,sizeCalculation:y,fetchMethod:x,memoMethod:I,noDeleteOnFetchRejection:b,noDeleteOnStaleGet:T,allowStaleOnFetchRejection:R,allowStaleOnFetchAbort:P,ignoreFetchAbort:B}=e;if(t!==0&&!pl(t))throw new TypeError("max option must be a nonnegative integer");const _=t?Fk(t):Array;if(!_)throw new Error("invalid max value: "+t);if(Tt(this,_o,t),Tt(this,Hi,v),this.maxEntrySize=C||Q(this,Hi),this.sizeCalculation=y,this.sizeCalculation){if(!Q(this,Hi)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(I!==void 0&&typeof I!="function")throw new TypeError("memoMethod must be a function if defined");if(Tt(this,_u,I),x!==void 0&&typeof x!="function")throw new TypeError("fetchMethod must be a function if specified");if(Tt(this,Ru,x),Tt(this,yl,!!x),Tt(this,sr,new Map),Tt(this,Fn,new Array(t).fill(void 0)),Tt(this,Wt,new Array(t).fill(void 0)),Tt(this,oi,new _(t)),Tt(this,Zi,new _(t)),Tt(this,Kr,0),Tt(this,Ar,0),Tt(this,Bo,Xv.create(t)),Tt(this,dr,0),Tt(this,No,0),typeof d=="function"&&Tt(this,Po,d),typeof f=="function"?(Tt(this,Do,f),Tt(this,wr,[])):(Tt(this,Do,void 0),Tt(this,wr,void 0)),Tt(this,Mo,!!Q(this,Po)),Tt(this,si,!!Q(this,Do)),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!g,this.noDeleteOnFetchRejection=!!b,this.allowStaleOnFetchRejection=!!R,this.allowStaleOnFetchAbort=!!P,this.ignoreFetchAbort=!!B,this.maxEntrySize!==0){if(Q(this,Hi)!==0&&!pl(Q(this,Hi)))throw new TypeError("maxSize must be a positive integer if specified");if(!pl(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");ut(this,Qe,Mk).call(this)}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!T,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!l,this.ttlResolution=pl(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!pl(this.ttl))throw new TypeError("ttl must be a positive integer if specified");ut(this,Qe,$v).call(this)}if(Q(this,_o)===0&&this.ttl===0&&Q(this,Hi)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!Q(this,_o)&&!Q(this,Hi)){const M="LRU_CACHE_UNBOUNDED";pO(M)&&(Bk.add(M),Ok("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",M,c1))}}static unsafeExposeInternals(e){return{starts:Q(e,Fo),ttls:Q(e,Xi),sizes:Q(e,Oo),keyMap:Q(e,sr),keyList:Q(e,Fn),valList:Q(e,Wt),next:Q(e,oi),prev:Q(e,Zi),get head(){return Q(e,Kr)},get tail(){return Q(e,Ar)},free:Q(e,Bo),isBackgroundFetch:t=>{var r;return ut(r=e,Qe,On).call(r,t)},backgroundFetch:(t,r,i,o)=>{var a;return ut(a=e,Qe,mp).call(a,t,r,i,o)},moveToTail:t=>{var r;return ut(r=e,Qe,tf).call(r,t)},indexes:t=>{var r;return ut(r=e,Qe,gl).call(r,t)},rindexes:t=>{var r;return ut(r=e,Qe,ml).call(r,t)},isStale:t=>{var r;return Q(r=e,Ki).call(r,t)}}}get max(){return Q(this,_o)}get maxSize(){return Q(this,Hi)}get calculatedSize(){return Q(this,No)}get size(){return Q(this,dr)}get fetchMethod(){return Q(this,Ru)}get memoMethod(){return Q(this,_u)}get dispose(){return Q(this,Po)}get disposeAfter(){return Q(this,Do)}getRemainingTTL(e){return Q(this,sr).has(e)?1/0:0}*entries(){for(const e of ut(this,Qe,gl).call(this))Q(this,Wt)[e]!==void 0&&Q(this,Fn)[e]!==void 0&&!ut(this,Qe,On).call(this,Q(this,Wt)[e])&&(yield[Q(this,Fn)[e],Q(this,Wt)[e]])}*rentries(){for(const e of ut(this,Qe,ml).call(this))Q(this,Wt)[e]!==void 0&&Q(this,Fn)[e]!==void 0&&!ut(this,Qe,On).call(this,Q(this,Wt)[e])&&(yield[Q(this,Fn)[e],Q(this,Wt)[e]])}*keys(){for(const e of ut(this,Qe,gl).call(this)){const t=Q(this,Fn)[e];t!==void 0&&!ut(this,Qe,On).call(this,Q(this,Wt)[e])&&(yield t)}}*rkeys(){for(const e of ut(this,Qe,ml).call(this)){const t=Q(this,Fn)[e];t!==void 0&&!ut(this,Qe,On).call(this,Q(this,Wt)[e])&&(yield t)}}*values(){for(const e of ut(this,Qe,gl).call(this))Q(this,Wt)[e]!==void 0&&!ut(this,Qe,On).call(this,Q(this,Wt)[e])&&(yield Q(this,Wt)[e])}*rvalues(){for(const e of ut(this,Qe,ml).call(this))Q(this,Wt)[e]!==void 0&&!ut(this,Qe,On).call(this,Q(this,Wt)[e])&&(yield Q(this,Wt)[e])}[(Yw=Symbol.iterator,Jw=Symbol.toStringTag,Yw)](){return this.entries()}find(e,t={}){for(const r of ut(this,Qe,gl).call(this)){const i=Q(this,Wt)[r],o=ut(this,Qe,On).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,Q(this,Fn)[r],this))return this.get(Q(this,Fn)[r],t)}}forEach(e,t=this){for(const r of ut(this,Qe,gl).call(this)){const i=Q(this,Wt)[r],o=ut(this,Qe,On).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(t,o,Q(this,Fn)[r],this)}}rforEach(e,t=this){for(const r of ut(this,Qe,ml).call(this)){const i=Q(this,Wt)[r],o=ut(this,Qe,On).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(t,o,Q(this,Fn)[r],this)}}purgeStale(){let e=!1;for(const t of ut(this,Qe,ml).call(this,{allowStale:!0}))Q(this,Ki).call(this,t)&&(ut(this,Qe,vl).call(this,Q(this,Fn)[t],"expire"),e=!0);return e}info(e){const t=Q(this,sr).get(e);if(t===void 0)return;const r=Q(this,Wt)[t],i=ut(this,Qe,On).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(Q(this,Xi)&&Q(this,Fo)){const a=Q(this,Xi)[t],l=Q(this,Fo)[t];if(a&&l){const u=a-(du.now()-l);o.ttl=u,o.start=Date.now()}}return Q(this,Oo)&&(o.size=Q(this,Oo)[t]),o}dump(){const e=[];for(const t of ut(this,Qe,gl).call(this,{allowStale:!0})){const r=Q(this,Fn)[t],i=Q(this,Wt)[t],o=ut(this,Qe,On).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const a={value:o};if(Q(this,Xi)&&Q(this,Fo)){a.ttl=Q(this,Xi)[t];const l=du.now()-Q(this,Fo)[t];a.start=Math.floor(Date.now()-l)}Q(this,Oo)&&(a.size=Q(this,Oo)[t]),e.unshift([r,a])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const i=Date.now()-r.start;r.start=du.now()-i}this.set(t,r.value,r)}}set(e,t,r={}){var g,v,C,y,x;if(t===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:l=this.sizeCalculation,status:u}=r;let{noUpdateTTL:d=this.noUpdateTTL}=r;const f=Q(this,Pf).call(this,e,t,r.size||0,l);if(this.maxEntrySize&&f>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),ut(this,Qe,vl).call(this,e,"set"),this;let p=Q(this,dr)===0?void 0:Q(this,sr).get(e);if(p===void 0)p=Q(this,dr)===0?Q(this,Ar):Q(this,Bo).length!==0?Q(this,Bo).pop():Q(this,dr)===Q(this,_o)?ut(this,Qe,gp).call(this,!1):Q(this,dr),Q(this,Fn)[p]=e,Q(this,Wt)[p]=t,Q(this,sr).set(e,p),Q(this,oi)[Q(this,Ar)]=p,Q(this,Zi)[p]=Q(this,Ar),Tt(this,Ar,p),Kh(this,dr)._++,Q(this,Pu).call(this,p,f,u),u&&(u.set="add"),d=!1;else{ut(this,Qe,tf).call(this,p);const I=Q(this,Wt)[p];if(t!==I){if(Q(this,yl)&&ut(this,Qe,On).call(this,I)){I.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:b}=I;b!==void 0&&!a&&(Q(this,Mo)&&((g=Q(this,Po))==null||g.call(this,b,e,"set")),Q(this,si)&&((v=Q(this,wr))==null||v.push([b,e,"set"])))}else a||(Q(this,Mo)&&((C=Q(this,Po))==null||C.call(this,I,e,"set")),Q(this,si)&&((y=Q(this,wr))==null||y.push([I,e,"set"])));if(Q(this,hc).call(this,p),Q(this,Pu).call(this,p,f,u),Q(this,Wt)[p]=t,u){u.set="replace";const b=I&&ut(this,Qe,On).call(this,I)?I.__staleWhileFetching:I;b!==void 0&&(u.oldValue=b)}}else u&&(u.set="update")}if(i!==0&&!Q(this,Xi)&&ut(this,Qe,$v).call(this),Q(this,Xi)&&(d||Q(this,_f).call(this,p,i,o),u&&Q(this,ca).call(this,u,p)),!a&&Q(this,si)&&Q(this,wr)){const I=Q(this,wr);let b;for(;b=I==null?void 0:I.shift();)(x=Q(this,Do))==null||x.call(this,...b)}return this}pop(){var e;try{for(;Q(this,dr);){const t=Q(this,Wt)[Q(this,Kr)];if(ut(this,Qe,gp).call(this,!0),ut(this,Qe,On).call(this,t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(Q(this,si)&&Q(this,wr)){const t=Q(this,wr);let r;for(;r=t==null?void 0:t.shift();)(e=Q(this,Do))==null||e.call(this,...r)}}}has(e,t={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=t,o=Q(this,sr).get(e);if(o!==void 0){const a=Q(this,Wt)[o];if(ut(this,Qe,On).call(this,a)&&a.__staleWhileFetching===void 0)return!1;if(Q(this,Ki).call(this,o))i&&(i.has="stale",Q(this,ca).call(this,i,o));else return r&&Q(this,fc).call(this,o),i&&(i.has="hit",Q(this,ca).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,t={}){const{allowStale:r=this.allowStale}=t,i=Q(this,sr).get(e);if(i===void 0||!r&&Q(this,Ki).call(this,i))return;const o=Q(this,Wt)[i];return ut(this,Qe,On).call(this,o)?o.__staleWhileFetching:o}async fetch(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:l=this.noDisposeOnSet,size:u=0,sizeCalculation:d=this.sizeCalculation,noUpdateTTL:f=this.noUpdateTTL,noDeleteOnFetchRejection:p=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:g=this.allowStaleOnFetchRejection,ignoreFetchAbort:v=this.ignoreFetchAbort,allowStaleOnFetchAbort:C=this.allowStaleOnFetchAbort,context:y,forceRefresh:x=!1,status:I,signal:b}=t;if(!Q(this,yl))return I&&(I.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:I});const T={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:a,noDisposeOnSet:l,size:u,sizeCalculation:d,noUpdateTTL:f,noDeleteOnFetchRejection:p,allowStaleOnFetchRejection:g,allowStaleOnFetchAbort:C,ignoreFetchAbort:v,status:I,signal:b};let R=Q(this,sr).get(e);if(R===void 0){I&&(I.fetch="miss");const P=ut(this,Qe,mp).call(this,e,R,T,y);return P.__returned=P}else{const P=Q(this,Wt)[R];if(ut(this,Qe,On).call(this,P)){const V=r&&P.__staleWhileFetching!==void 0;return I&&(I.fetch="inflight",V&&(I.returnedStale=!0)),V?P.__staleWhileFetching:P.__returned=P}const B=Q(this,Ki).call(this,R);if(!x&&!B)return I&&(I.fetch="hit"),ut(this,Qe,tf).call(this,R),i&&Q(this,fc).call(this,R),I&&Q(this,ca).call(this,I,R),P;const _=ut(this,Qe,mp).call(this,e,R,T,y),H=_.__staleWhileFetching!==void 0&&r;return I&&(I.fetch=B?"stale":"refresh",H&&B&&(I.returnedStale=!0)),H?_.__staleWhileFetching:_.__returned=_}}async forceFetch(e,t={}){const r=await this.fetch(e,t);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,t={}){const r=Q(this,_u);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...a}=t,l=this.get(e,a);if(!o&&l!==void 0)return l;const u=r(e,l,{options:a,context:i});return this.set(e,u,a),u}get(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:a}=t,l=Q(this,sr).get(e);if(l!==void 0){const u=Q(this,Wt)[l],d=ut(this,Qe,On).call(this,u);return a&&Q(this,ca).call(this,a,l),Q(this,Ki).call(this,l)?(a&&(a.get="stale"),d?(a&&r&&u.__staleWhileFetching!==void 0&&(a.returnedStale=!0),r?u.__staleWhileFetching:void 0):(o||ut(this,Qe,vl).call(this,e,"expire"),a&&r&&(a.returnedStale=!0),r?u:void 0)):(a&&(a.get="hit"),d?u.__staleWhileFetching:(ut(this,Qe,tf).call(this,l),i&&Q(this,fc).call(this,l),u))}else a&&(a.get="miss")}delete(e){return ut(this,Qe,vl).call(this,e,"delete")}clear(){return ut(this,Qe,qv).call(this,"delete")}};_o=new WeakMap,Hi=new WeakMap,Po=new WeakMap,Do=new WeakMap,Ru=new WeakMap,_u=new WeakMap,dr=new WeakMap,No=new WeakMap,sr=new WeakMap,Fn=new WeakMap,Wt=new WeakMap,oi=new WeakMap,Zi=new WeakMap,Kr=new WeakMap,Ar=new WeakMap,Bo=new WeakMap,wr=new WeakMap,Oo=new WeakMap,Fo=new WeakMap,Xi=new WeakMap,Mo=new WeakMap,yl=new WeakMap,si=new WeakMap,Qe=new WeakSet,$v=function(){const e=new pp(Q(this,_o)),t=new pp(Q(this,_o));Tt(this,Xi,e),Tt(this,Fo,t),Tt(this,_f,(o,a,l=du.now())=>{if(t[o]=a!==0?l:0,e[o]=a,a!==0&&this.ttlAutopurge){const u=setTimeout(()=>{Q(this,Ki).call(this,o)&&ut(this,Qe,vl).call(this,Q(this,Fn)[o],"expire")},a+1);u.unref&&u.unref()}}),Tt(this,fc,o=>{t[o]=e[o]!==0?du.now():0}),Tt(this,ca,(o,a)=>{if(e[a]){const l=e[a],u=t[a];if(!l||!u)return;o.ttl=l,o.start=u,o.now=r||i();const d=o.now-u;o.remainingTTL=l-d}});let r=0;const i=()=>{const o=du.now();if(this.ttlResolution>0){r=o;const a=setTimeout(()=>r=0,this.ttlResolution);a.unref&&a.unref()}return o};this.getRemainingTTL=o=>{const a=Q(this,sr).get(o);if(a===void 0)return 0;const l=e[a],u=t[a];if(!l||!u)return 1/0;const d=(r||i())-u;return l-d},Tt(this,Ki,o=>{const a=t[o],l=e[o];return!!l&&!!a&&(r||i())-a>l})},fc=new WeakMap,ca=new WeakMap,_f=new WeakMap,Ki=new WeakMap,Mk=function(){const e=new pp(Q(this,_o));Tt(this,No,0),Tt(this,Oo,e),Tt(this,hc,t=>{Tt(this,No,Q(this,No)-e[t]),e[t]=0}),Tt(this,Pf,(t,r,i,o)=>{if(ut(this,Qe,On).call(this,r))return 0;if(!pl(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,t),!pl(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Tt(this,Pu,(t,r,i)=>{if(e[t]=r,Q(this,Hi)){const o=Q(this,Hi)-e[t];for(;Q(this,No)>o;)ut(this,Qe,gp).call(this,!0)}Tt(this,No,Q(this,No)+e[t]),i&&(i.entrySize=r,i.totalCalculatedSize=Q(this,No))})},hc=new WeakMap,Pu=new WeakMap,Pf=new WeakMap,gl=function*({allowStale:e=this.allowStale}={}){if(Q(this,dr))for(let t=Q(this,Ar);!(!ut(this,Qe,Jv).call(this,t)||((e||!Q(this,Ki).call(this,t))&&(yield t),t===Q(this,Kr)));)t=Q(this,Zi)[t]},ml=function*({allowStale:e=this.allowStale}={}){if(Q(this,dr))for(let t=Q(this,Kr);!(!ut(this,Qe,Jv).call(this,t)||((e||!Q(this,Ki).call(this,t))&&(yield t),t===Q(this,Ar)));)t=Q(this,oi)[t]},Jv=function(e){return e!==void 0&&Q(this,sr).get(Q(this,Fn)[e])===e},gp=function(e){var o,a;const t=Q(this,Kr),r=Q(this,Fn)[t],i=Q(this,Wt)[t];return Q(this,yl)&&ut(this,Qe,On).call(this,i)?i.__abortController.abort(new Error("evicted")):(Q(this,Mo)||Q(this,si))&&(Q(this,Mo)&&((o=Q(this,Po))==null||o.call(this,i,r,"evict")),Q(this,si)&&((a=Q(this,wr))==null||a.push([i,r,"evict"]))),Q(this,hc).call(this,t),e&&(Q(this,Fn)[t]=void 0,Q(this,Wt)[t]=void 0,Q(this,Bo).push(t)),Q(this,dr)===1?(Tt(this,Kr,Tt(this,Ar,0)),Q(this,Bo).length=0):Tt(this,Kr,Q(this,oi)[t]),Q(this,sr).delete(r),Kh(this,dr)._--,t},mp=function(e,t,r,i){const o=t===void 0?void 0:Q(this,Wt)[t];if(ut(this,Qe,On).call(this,o))return o;const a=new k0,{signal:l}=r;l==null||l.addEventListener("abort",()=>a.abort(l.reason),{signal:a.signal});const u={signal:a.signal,options:r,context:i},d=(y,x=!1)=>{const{aborted:I}=a.signal,b=r.ignoreFetchAbort&&y!==void 0;if(r.status&&(I&&!x?(r.status.fetchAborted=!0,r.status.fetchError=a.signal.reason,b&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),I&&!b&&!x)return p(a.signal.reason);const T=v;return Q(this,Wt)[t]===v&&(y===void 0?T.__staleWhileFetching?Q(this,Wt)[t]=T.__staleWhileFetching:ut(this,Qe,vl).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,y,u.options))),y},f=y=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=y),p(y)),p=y=>{const{aborted:x}=a.signal,I=x&&r.allowStaleOnFetchAbort,b=I||r.allowStaleOnFetchRejection,T=b||r.noDeleteOnFetchRejection,R=v;if(Q(this,Wt)[t]===v&&(!T||R.__staleWhileFetching===void 0?ut(this,Qe,vl).call(this,e,"fetch"):I||(Q(this,Wt)[t]=R.__staleWhileFetching)),b)return r.status&&R.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),R.__staleWhileFetching;if(R.__returned===R)throw y},g=(y,x)=>{var b;const I=(b=Q(this,Ru))==null?void 0:b.call(this,e,o,u);I&&I instanceof Promise&&I.then(T=>y(T===void 0?void 0:T),x),a.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(y(void 0),r.allowStaleOnFetchAbort&&(y=T=>d(T,!0)))})};r.status&&(r.status.fetchDispatched=!0);const v=new Promise(g).then(d,f),C=Object.assign(v,{__abortController:a,__staleWhileFetching:o,__returned:void 0});return t===void 0?(this.set(e,C,{...u.options,status:void 0}),t=Q(this,sr).get(e)):Q(this,Wt)[t]=C,C},On=function(e){if(!Q(this,yl))return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof k0},Yv=function(e,t){Q(this,Zi)[t]=e,Q(this,oi)[e]=t},tf=function(e){e!==Q(this,Ar)&&(e===Q(this,Kr)?Tt(this,Kr,Q(this,oi)[e]):ut(this,Qe,Yv).call(this,Q(this,Zi)[e],Q(this,oi)[e]),ut(this,Qe,Yv).call(this,Q(this,Ar),e),Tt(this,Ar,e))},vl=function(e,t){var i,o,a,l;let r=!1;if(Q(this,dr)!==0){const u=Q(this,sr).get(e);if(u!==void 0)if(r=!0,Q(this,dr)===1)ut(this,Qe,qv).call(this,t);else{Q(this,hc).call(this,u);const d=Q(this,Wt)[u];if(ut(this,Qe,On).call(this,d)?d.__abortController.abort(new Error("deleted")):(Q(this,Mo)||Q(this,si))&&(Q(this,Mo)&&((i=Q(this,Po))==null||i.call(this,d,e,t)),Q(this,si)&&((o=Q(this,wr))==null||o.push([d,e,t]))),Q(this,sr).delete(e),Q(this,Fn)[u]=void 0,Q(this,Wt)[u]=void 0,u===Q(this,Ar))Tt(this,Ar,Q(this,Zi)[u]);else if(u===Q(this,Kr))Tt(this,Kr,Q(this,oi)[u]);else{const f=Q(this,Zi)[u];Q(this,oi)[f]=Q(this,oi)[u];const p=Q(this,oi)[u];Q(this,Zi)[p]=Q(this,Zi)[u]}Kh(this,dr)._--,Q(this,Bo).push(u)}}if(Q(this,si)&&((a=Q(this,wr))!=null&&a.length)){const u=Q(this,wr);let d;for(;d=u==null?void 0:u.shift();)(l=Q(this,Do))==null||l.call(this,...d)}return r},qv=function(e){var t,r,i;for(const o of ut(this,Qe,ml).call(this,{allowStale:!0})){const a=Q(this,Wt)[o];if(ut(this,Qe,On).call(this,a))a.__abortController.abort(new Error("deleted"));else{const l=Q(this,Fn)[o];Q(this,Mo)&&((t=Q(this,Po))==null||t.call(this,a,l,e)),Q(this,si)&&((r=Q(this,wr))==null||r.push([a,l,e]))}}if(Q(this,sr).clear(),Q(this,Wt).fill(void 0),Q(this,Fn).fill(void 0),Q(this,Xi)&&Q(this,Fo)&&(Q(this,Xi).fill(0),Q(this,Fo).fill(0)),Q(this,Oo)&&Q(this,Oo).fill(0),Tt(this,Kr,0),Tt(this,Ar,0),Q(this,Bo).length=0,Tt(this,No,0),Tt(this,dr,0),Q(this,si)&&Q(this,wr)){const o=Q(this,wr);let a;for(;a=o==null?void 0:o.shift();)(i=Q(this,Do))==null||i.call(this,...a)}};let Kv=c1;function gO(n){const e=n.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+n+"`"),null;const t=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let a;for(;a=o.exec(e[3]);){const l=a[1]||a[3],u=a[2]||a[4];l in i?console.log(`Invalid message format: duplicate key ${l} detected`):i[l]=u}return{name:t,authKey:r,keyvals:i}}function bb(n){const e=n.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+n+"`"),null;const t=e[1]||e[4],r=void 0,i=e[2],o=e[3],a={};return a[i]=o,{name:t,authKey:r,keyvals:a}}function Ab(){return(Math.random()+1).toString(36).substring(3,9)}class Ku{constructor(e){ee(this,"packageName");ee(this,"minVersion",1);ee(this,"maxVersion",1);ee(this,"packageVersion",0);ee(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,t){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,t)}}class mO extends Ku{constructor(){super(...arguments);ee(this,"packageName","mcp-negotiate");ee(this,"minVersion",2);ee(this,"maxVersion",2)}handle(t){t.name}sendNegotiate(){var t,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(t=i.minVersion)==null?void 0:t.toFixed(1),a=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":a})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class vO extends Ku{constructor(){super(...arguments);ee(this,"packageName","dns-com-awns-status")}handle(t){console.log(t),this.client.emit("statustext",t.keyvals.text)}}class CO extends Ku{constructor(t){super(t);ee(this,"packageName","dns-org-mud-moo-simpleedit");ee(this,"currentSession",null)}handle(t){t.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:t.keyvals.name,reference:t.keyvals.reference,type:t.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${t}`)}handleMultiline(t){this.currentSession&&"content"in t.keyvals?this.currentSession.contents.push(t.keyvals.content):console.log(`Unexpected simpleedit ML ${t}`)}closeMultiline(t){console.log(`Closing multiline ${t.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class yO extends Ku{constructor(){super(...arguments);ee(this,"packageName","dns-com-awns-getset");ee(this,"id",1);ee(this,"cache",new Kv({max:10}));ee(this,"LocalCache",{})}handle(t){switch(t.name){case"dns-com-awns-getset-ack":const r=this.cache.get(t.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${t.keyvals.id}`);break}const i=t.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(t){const r=(this.id++).toString();this.cache.set(r,t),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:t})}sendSet(t,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:t,value:r})}sendDrop(t){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:t})}}class xO extends Ku{constructor(){super(...arguments);ee(this,"packageName","dns-com-vmoo-userlist");ee(this,"maxVersion",1.1);ee(this,"player");ee(this,"fields",["Object","Name","Icon"]);ee(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);ee(this,"players",[])}handle(t){switch(t.name){case"dns-com-vmoo-userlist-you":this.player=t.keyvals.nr;break}}handleMultiline(t){if("fields"in t.keyvals&&(this.fields=ko(t.keyvals.fields.trim())),"icons"in t.keyvals&&(this.icons=ko(t.keyvals.icons.trim())),"d"in t.keyvals){const o=t.keyvals.d[0];switch(o){case"=":var r=ko(t.keyvals.d.slice(1));this.players=r.map(l=>this.playerFromArray(l));break;case"+":this.players.push(this.playerFromArray(ko(t.keyvals.d.slice(1))));break;case"-":var i=ko(t.keyvals.d.slice(1));this.players=this.players.filter(l=>!i.includes(l.Object));break;case"*":const a=this.playerFromArray(ko(t.keyvals.d.slice(1)));this.updatePlayer(a);break;case"<":i=ko(t.keyvals.d.slice(1)),this.players.forEach((l,u)=>{i.includes(l.Object)&&(l.idle=!0,this.players[u]=l)});break;case">":i=ko(t.keyvals.d.slice(1)),this.players.forEach((l,u)=>{i.includes(l.Object)&&(l.idle=!1,this.players[u]=l)});break;case"[":i=ko(t.keyvals.d.slice(1)),this.players.forEach((l,u)=>{i.includes(l.Object)&&(l.away=!0,this.players[u]=l)});break;case"]":i=ko(t.keyvals.d.slice(1)),this.players.forEach((l,u)=>{i.includes(l.Object)&&(l.away=!1,this.players[u]=l)});break;default:console.log(`Unknown userlist mode ${o} in ${t.keyvals.d}`);break}this.update()}}updatePlayer(t){const r=this.players.findIndex(i=>i.Object===t.Object);r!==-1?this.players[r]=t:this.players.push(t)}update(){this.players.sort((r,i)=>t(i)-t(r)),this.client.emit("userlist",this.players);function t(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(t){const r={};return t.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function ko(n){n=n.slice(1,-1);let e=[],t="",r=0;for(let o=0;o<n.length;o++){const a=n[o];if(a==="{")r++;else if(a==="}")r--;else if(a===","&&r===0){i(),t="";continue}t+=a}return t.length>0&&i(),e;function i(){t=t.trim(),t.startsWith("{")&&t.endsWith("}")?e.push(ko(t)):Number.isNaN(Number(t))?t.startsWith('"')&&t.endsWith('"')?e.push(t.slice(1,-1)):e.push(t):e.push(Number(t))}}class IO extends Ku{constructor(){super(...arguments);ee(this,"packageName","dns-com-awns-ping");ee(this,"id",1)}handle(t){switch(t.name){case"dns-com-awns-ping":this.send("reply",t.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}var Qv=(n=>(n.Off="off",n.Unfocused="unfocused",n.All="all",n))(Qv||{}),$o=(n=>(n.SetGeneral="SET_GENERAL",n.SetSpeech="SET_SPEECH",n.SetSound="SET_SOUND",n.SetChannels="SET_CHANNELS",n.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",n.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",n))($o||{});class bO{constructor(){ee(this,"state");ee(this,"listeners",new Set);ee(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(t=>t())});var i;const e=localStorage.getItem("preferences"),t=this.getInitialPreferences();let r=e?JSON.parse(e):null;((i=r==null?void 0:r.general)==null?void 0:i.volume)!==void 0&&(r!=null&&r.sound)&&(r.sound.volume||(r.sound.volume=r.general.volume),delete r.general.volume),this.state=r?this.mergePreferences(t,r):t}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},sound:{muteInBackground:!1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,t){return{...e,general:{...e.general,...t.general},speech:{...e.speech,...t.speech},sound:{...e.sound,...t.sound},channels:t.channels?{...e.channels,...t.channels}:e.channels,editor:{...e.editor,...t.editor}}}reducer(e,t){switch(t.type){case"SET_GENERAL":return{...e,general:t.data};case"SET_SPEECH":return{...e,speech:t.data};case"SET_SOUND":return{...e,sound:t.data};case"SET_CHANNELS":return{...e,channels:t.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:t.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:t.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const li=new bO;class AO extends z0{constructor(t){super();ee(this,"peerConnection",null);ee(this,"dataChannel",null);ee(this,"client");ee(this,"connectionTimeout",3e5);ee(this,"connectionTimeoutId");ee(this,"recipient","");ee(this,"pendingCandidates",[]);ee(this,"remoteOfferReceived",!1);this.client=t}isDataChannelOpen(){return this.dataChannel!==null&&this.dataChannel.readyState==="open"}async createPeerConnection(){try{const t={iceServers:[{urls:["turn:mongoose.world:3478","stun:mongoose.world:3478"],username:"p2p",credential:"p2p"},{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(t),this.peerConnection.onconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.connectionState;switch(console.log("[WebRTCService] Connection state changed to:",r),this.emit("webRTCStateChange",`Connection: ${r}`),r){case"connected":console.log("[WebRTCService] Peer connection established successfully"),this.emit("webRTCConnected");break;case"disconnected":console.log("[WebRTCService] Connection temporarily disconnected"),this.emit("webRTCDisconnected"),setTimeout(()=>{var o;((o=this.peerConnection)==null?void 0:o.connectionState)==="disconnected"&&this.attemptRecovery()},5e3);break;case"failed":console.log("[WebRTCService] Connection failed - attempting immediate recovery"),this.attemptRecovery();break}},this.peerConnection.oniceconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceConnectionState;console.log("[WebRTCService] ICE connection state changed to:",r),this.emit("webRTCStateChange",`ICE: ${r}`),r==="failed"&&(console.log("[WebRTCService] ICE connection failed"),this.attemptRecovery())},this.peerConnection.onsignalingstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.signalingState;console.log("[WebRTCService] Signaling state changed to:",r),this.emit("webRTCStateChange",`Signaling: ${r}`),r==="stable"&&console.log("[WebRTCService] Signaling completed successfully")},this.peerConnection.onicegatheringstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceGatheringState;console.log("[WebRTCService] ICE gathering state changed to:",r),this.emit("webRTCStateChange",`ICE Gathering: ${r}`),r==="complete"&&(console.log("[WebRTCService] ICE gathering completed"),this.emit("iceGatheringComplete"))},this.peerConnection.onicecandidate=r=>{r.candidate?(console.debug("[WebRTCService] New ICE candidate:",{type:r.candidate.type,protocol:r.candidate.protocol,address:r.candidate.address,port:r.candidate.port}),this.recipient&&this.client.gmcp_fileTransfer.sendCandidate(this.recipient,r.candidate)):console.log("[WebRTCService] ICE gathering complete")},this.peerConnection.ondatachannel=r=>{console.log("[WebRTCService] Received data channel"),this.dataChannel=r.channel,this.setupDataChannel()},this.dataChannel||(console.log("[WebRTCService] Creating data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(t){throw console.error("Error creating peer connection:",t),t}}setupDataChannel(){this.dataChannel&&(this.dataChannel.onopen=()=>{var t;console.log("[WebRTCService] Data channel opened with state:",(t=this.dataChannel)==null?void 0:t.readyState),this.emit("dataChannelOpen")},this.dataChannel.onclose=()=>{console.log("[WebRTCService] Data channel closed"),this.emit("dataChannelClose")},this.dataChannel.onerror=t=>{console.error("[WebRTCService] Data channel error:",t),this.emit("dataChannelError",t)},this.dataChannel.onmessage=t=>{t.data instanceof ArrayBuffer&&this.emit("dataChannelMessage",t.data)})}async attemptRecovery(){try{console.log("[WebRTCService] Attempting connection recovery"),this.close(),await new Promise(t=>setTimeout(t,1e3)),await this.createPeerConnection(),console.log("[WebRTCService] Recovery attempt completed")}catch(t){console.error("[WebRTCService] Recovery attempt failed:",t)}}async attemptChannelRecovery(){var t;try{this.dataChannel=((t=this.peerConnection)==null?void 0:t.createDataChannel("fileTransfer"))??null,this.setupDataChannel()}catch(r){console.error("Failed to recover data channel:",r),this.emit("dataChannelRecoveryFailed",r)}}async sendData(t){if(!this.dataChannel)throw new Error("Data channel not initialized");if(this.dataChannel.readyState!=="open")throw new Error("Data channel is not open");try{for(;this.dataChannel.bufferedAmount>1048576;)await new Promise(i=>{var a;const o=()=>{var l;(l=this.dataChannel)==null||l.removeEventListener("bufferedamountlow",o),i()};(a=this.dataChannel)==null||a.addEventListener("bufferedamountlow",o),this.dataChannel.bufferedAmountLowThreshold=1048576/2});this.dataChannel.send(t)}catch(r){throw console.error("[WebRTCService] Error sending data:",r),r}}async createOffer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createOffer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating offer:",t),t}}async createAnswer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating answer:",t),t}}async handleAnswer(t){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{console.log("[WebRTCService] Received WebRTC answer:",t),console.log("[WebRTCService] Current connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Current signaling state:",this.peerConnection.signalingState),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),console.log("[WebRTCService] Remote description set successfully"),console.log("[WebRTCService] Updated connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Updated signaling state:",this.peerConnection.signalingState),this.pendingCandidates.length>0?(console.log(`[WebRTCService] Adding ${this.pendingCandidates.length} pending ICE candidates`),await Promise.all(this.pendingCandidates.map(async(r,i)=>{console.log(`[WebRTCService] Adding ICE candidate ${i+1}/${this.pendingCandidates.length}`),await this.peerConnection.addIceCandidate(new RTCIceCandidate(r))})),console.log("[WebRTCService] All pending ICE candidates added successfully"),this.pendingCandidates=[]):console.log("[WebRTCService] No pending ICE candidates to add")}catch(r){throw console.error("Error handling answer:",r),r}}async handleIceCandidate(t){if(!this.peerConnection||!this.peerConnection.remoteDescription){console.log("[WebRTCService] Storing ICE candidate until peer connection is ready"),this.pendingCandidates.push(t);return}try{console.log("[WebRTCService] Adding ICE candidate immediately"),await this.peerConnection.addIceCandidate(new RTCIceCandidate(t))}catch(r){throw console.error("Error handling ICE candidate:",r),r}}async reconnect(){this.close(),await this.createPeerConnection(),this.emit("webRTCReconnecting")}cleanup(){this.connectionTimeoutId&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0),this.close()}close(){this.pendingCandidates=[],this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.emit("webRTCClosed")}async waitForConnection(){return new Promise((t,r)=>{if(this.connectionTimeoutId=window.setTimeout(()=>{a(),r(new Error("Connection timeout"))},this.connectionTimeout),this.isDataChannelOpen())return clearTimeout(this.connectionTimeoutId),t();const i=()=>{clearTimeout(this.connectionTimeoutId),a(),t()},o=()=>{var u;((u=this.peerConnection)==null?void 0:u.connectionState)==="failed"&&(clearTimeout(this.connectionTimeoutId),a(),r(new Error("Connection failed")))},a=()=>{this.dataChannel&&this.dataChannel.removeEventListener("open",i),this.peerConnection&&this.peerConnection.removeEventListener("connectionstatechange",o),this.off("dataChannelOpen",i),this.off("webRTCFailed",l)},l=()=>{clearTimeout(this.connectionTimeoutId),a(),r(new Error("Connection failed"))};this.dataChannel&&this.dataChannel.addEventListener("open",i),this.peerConnection&&this.peerConnection.addEventListener("connectionstatechange",o),this.on("dataChannelOpen",i),this.on("webRTCFailed",l)})}isPeerConnectionInitialized(){var t;return console.log("[WebRTCService] Peer connection state:",(t=this.peerConnection)==null?void 0:t.connectionState),this.peerConnection!==null&&this.peerConnection.connectionState!=="closed"}hasRemoteOffer(){return this.remoteOfferReceived}async waitForRemoteOffer(t=3e4){return console.log("[WebRTCService] Waiting for remote offer..."),new Promise((r,i)=>{const o=setTimeout(()=>{l(),console.log("[WebRTCService] Timeout waiting for remote offer"),i(new Error("Timeout waiting for remote offer"))},t),a=()=>{console.log("[WebRTCService] Remote offer received"),clearTimeout(o),l(),r()},l=()=>{this.client.off("remoteOfferReceived",a)};if(this.remoteOfferReceived){console.log("[WebRTCService] Remote offer already received"),clearTimeout(o),r();return}this.client.on("remoteOfferReceived",a)})}async handleOffer(t){console.log("[WebRTCService] Handling WebRTC offer:",t),this.peerConnection||(console.log("[WebRTCService] Creating new peer connection for offer"),await this.createPeerConnection());try{if(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),this.remoteOfferReceived=!0,this.client.emit("remoteOfferReceived"),console.log("[WebRTCService] Remote offer set successfully"),this.pendingCandidates.length>0){console.log(`[WebRTCService] Processing ${this.pendingCandidates.length} pending ICE candidates`);const r=[...this.pendingCandidates];this.pendingCandidates=[];for(const i of r)try{await this.peerConnection.addIceCandidate(new RTCIceCandidate(i)),console.log("[WebRTCService] Successfully added pending ICE candidate")}catch(o){console.warn("[WebRTCService] Failed to add pending ICE candidate:",o)}}}catch(r){throw console.error("[WebRTCService] Error handling offer:",r),r}}}var vp={exports:{}};function wO(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Cp={exports:{}};const SO={},kO=Object.freeze(Object.defineProperty({__proto__:null,default:SO},Symbol.toStringTag,{value:"Module"})),EO=u_(kO);var TO=Cp.exports,wb;function on(){return wb||(wb=1,function(n,e){(function(t,r){n.exports=r()})(TO,function(){var t=t||function(r,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Om<"u"&&Om.crypto&&(o=Om.crypto),!o&&typeof wO=="function")try{o=EO}catch{}var a=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},l=Object.create||function(){function b(){}return function(T){var R;return b.prototype=T,R=new b,b.prototype=null,R}}(),u={},d=u.lib={},f=d.Base=function(){return{extend:function(b){var T=l(this);return b&&T.mixIn(b),(!T.hasOwnProperty("init")||this.init===T.init)&&(T.init=function(){T.$super.init.apply(this,arguments)}),T.init.prototype=T,T.$super=this,T},create:function(){var b=this.extend();return b.init.apply(b,arguments),b},init:function(){},mixIn:function(b){for(var T in b)b.hasOwnProperty(T)&&(this[T]=b[T]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),p=d.WordArray=f.extend({init:function(b,T){b=this.words=b||[],T!=i?this.sigBytes=T:this.sigBytes=b.length*4},toString:function(b){return(b||v).stringify(this)},concat:function(b){var T=this.words,R=b.words,P=this.sigBytes,B=b.sigBytes;if(this.clamp(),P%4)for(var _=0;_<B;_++){var M=R[_>>>2]>>>24-_%4*8&255;T[P+_>>>2]|=M<<24-(P+_)%4*8}else for(var H=0;H<B;H+=4)T[P+H>>>2]=R[H>>>2];return this.sigBytes+=B,this},clamp:function(){var b=this.words,T=this.sigBytes;b[T>>>2]&=4294967295<<32-T%4*8,b.length=r.ceil(T/4)},clone:function(){var b=f.clone.call(this);return b.words=this.words.slice(0),b},random:function(b){for(var T=[],R=0;R<b;R+=4)T.push(a());return new p.init(T,b)}}),g=u.enc={},v=g.Hex={stringify:function(b){for(var T=b.words,R=b.sigBytes,P=[],B=0;B<R;B++){var _=T[B>>>2]>>>24-B%4*8&255;P.push((_>>>4).toString(16)),P.push((_&15).toString(16))}return P.join("")},parse:function(b){for(var T=b.length,R=[],P=0;P<T;P+=2)R[P>>>3]|=parseInt(b.substr(P,2),16)<<24-P%8*4;return new p.init(R,T/2)}},C=g.Latin1={stringify:function(b){for(var T=b.words,R=b.sigBytes,P=[],B=0;B<R;B++){var _=T[B>>>2]>>>24-B%4*8&255;P.push(String.fromCharCode(_))}return P.join("")},parse:function(b){for(var T=b.length,R=[],P=0;P<T;P++)R[P>>>2]|=(b.charCodeAt(P)&255)<<24-P%4*8;return new p.init(R,T)}},y=g.Utf8={stringify:function(b){try{return decodeURIComponent(escape(C.stringify(b)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(b){return C.parse(unescape(encodeURIComponent(b)))}},x=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(b){typeof b=="string"&&(b=y.parse(b)),this._data.concat(b),this._nDataBytes+=b.sigBytes},_process:function(b){var T,R=this._data,P=R.words,B=R.sigBytes,_=this.blockSize,M=_*4,H=B/M;b?H=r.ceil(H):H=r.max((H|0)-this._minBufferSize,0);var V=H*_,U=r.min(V*4,B);if(V){for(var Z=0;Z<V;Z+=_)this._doProcessBlock(P,Z);T=P.splice(0,V),R.sigBytes-=U}return new p.init(T,U)},clone:function(){var b=f.clone.call(this);return b._data=this._data.clone(),b},_minBufferSize:0});d.Hasher=x.extend({cfg:f.extend(),init:function(b){this.cfg=this.cfg.extend(b),this.reset()},reset:function(){x.reset.call(this),this._doReset()},update:function(b){return this._append(b),this._process(),this},finalize:function(b){b&&this._append(b);var T=this._doFinalize();return T},blockSize:16,_createHelper:function(b){return function(T,R){return new b.init(R).finalize(T)}},_createHmacHelper:function(b){return function(T,R){return new I.HMAC.init(b,R).finalize(T)}}});var I=u.algo={};return u}(Math);return t})}(Cp)),Cp.exports}var yp={exports:{}},RO=yp.exports,Sb;function Y0(){return Sb||(Sb=1,function(n,e){(function(t,r){n.exports=r(on())})(RO,function(t){return function(r){var i=t,o=i.lib,a=o.Base,l=o.WordArray,u=i.x64={};u.Word=a.extend({init:function(d,f){this.high=d,this.low=f}}),u.WordArray=a.extend({init:function(d,f){d=this.words=d||[],f!=r?this.sigBytes=f:this.sigBytes=d.length*8},toX32:function(){for(var d=this.words,f=d.length,p=[],g=0;g<f;g++){var v=d[g];p.push(v.high),p.push(v.low)}return l.create(p,this.sigBytes)},clone:function(){for(var d=a.clone.call(this),f=d.words=this.words.slice(0),p=f.length,g=0;g<p;g++)f[g]=f[g].clone();return d}})}(),t})}(yp)),yp.exports}var xp={exports:{}},_O=xp.exports,kb;function PO(){return kb||(kb=1,function(n,e){(function(t,r){n.exports=r(on())})(_O,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,i=r.lib,o=i.WordArray,a=o.init,l=o.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var d=u.byteLength,f=[],p=0;p<d;p++)f[p>>>2]|=u[p]<<24-p%4*8;a.call(this,f,d)}else a.apply(this,arguments)};l.prototype=o}}(),t.lib.WordArray})}(xp)),xp.exports}var Ip={exports:{}},DO=Ip.exports,Eb;function NO(){return Eb||(Eb=1,function(n,e){(function(t,r){n.exports=r(on())})(DO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.enc;a.Utf16=a.Utf16BE={stringify:function(u){for(var d=u.words,f=u.sigBytes,p=[],g=0;g<f;g+=2){var v=d[g>>>2]>>>16-g%4*8&65535;p.push(String.fromCharCode(v))}return p.join("")},parse:function(u){for(var d=u.length,f=[],p=0;p<d;p++)f[p>>>1]|=u.charCodeAt(p)<<16-p%2*16;return o.create(f,d*2)}},a.Utf16LE={stringify:function(u){for(var d=u.words,f=u.sigBytes,p=[],g=0;g<f;g+=2){var v=l(d[g>>>2]>>>16-g%4*8&65535);p.push(String.fromCharCode(v))}return p.join("")},parse:function(u){for(var d=u.length,f=[],p=0;p<d;p++)f[p>>>1]|=l(u.charCodeAt(p)<<16-p%2*16);return o.create(f,d*2)}};function l(u){return u<<8&4278255360|u>>>8&16711935}}(),t.enc.Utf16})}(Ip)),Ip.exports}var bp={exports:{}},BO=bp.exports,Tb;function Dc(){return Tb||(Tb=1,function(n,e){(function(t,r){n.exports=r(on())})(BO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.enc;a.Base64={stringify:function(u){var d=u.words,f=u.sigBytes,p=this._map;u.clamp();for(var g=[],v=0;v<f;v+=3)for(var C=d[v>>>2]>>>24-v%4*8&255,y=d[v+1>>>2]>>>24-(v+1)%4*8&255,x=d[v+2>>>2]>>>24-(v+2)%4*8&255,I=C<<16|y<<8|x,b=0;b<4&&v+b*.75<f;b++)g.push(p.charAt(I>>>6*(3-b)&63));var T=p.charAt(64);if(T)for(;g.length%4;)g.push(T);return g.join("")},parse:function(u){var d=u.length,f=this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var g=0;g<f.length;g++)p[f.charCodeAt(g)]=g}var v=f.charAt(64);if(v){var C=u.indexOf(v);C!==-1&&(d=C)}return l(u,d,p)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function l(u,d,f){for(var p=[],g=0,v=0;v<d;v++)if(v%4){var C=f[u.charCodeAt(v-1)]<<v%4*2,y=f[u.charCodeAt(v)]>>>6-v%4*2,x=C|y;p[g>>>2]|=x<<24-g%4*8,g++}return o.create(p,g)}}(),t.enc.Base64})}(bp)),bp.exports}var Ap={exports:{}},OO=Ap.exports,Rb;function FO(){return Rb||(Rb=1,function(n,e){(function(t,r){n.exports=r(on())})(OO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.enc;a.Base64url={stringify:function(u,d){d===void 0&&(d=!0);var f=u.words,p=u.sigBytes,g=d?this._safe_map:this._map;u.clamp();for(var v=[],C=0;C<p;C+=3)for(var y=f[C>>>2]>>>24-C%4*8&255,x=f[C+1>>>2]>>>24-(C+1)%4*8&255,I=f[C+2>>>2]>>>24-(C+2)%4*8&255,b=y<<16|x<<8|I,T=0;T<4&&C+T*.75<p;T++)v.push(g.charAt(b>>>6*(3-T)&63));var R=g.charAt(64);if(R)for(;v.length%4;)v.push(R);return v.join("")},parse:function(u,d){d===void 0&&(d=!0);var f=u.length,p=d?this._safe_map:this._map,g=this._reverseMap;if(!g){g=this._reverseMap=[];for(var v=0;v<p.length;v++)g[p.charCodeAt(v)]=v}var C=p.charAt(64);if(C){var y=u.indexOf(C);y!==-1&&(f=y)}return l(u,f,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function l(u,d,f){for(var p=[],g=0,v=0;v<d;v++)if(v%4){var C=f[u.charCodeAt(v-1)]<<v%4*2,y=f[u.charCodeAt(v)]>>>6-v%4*2,x=C|y;p[g>>>2]|=x<<24-g%4*8,g++}return o.create(p,g)}}(),t.enc.Base64url})}(Ap)),Ap.exports}var wp={exports:{}},MO=wp.exports,_b;function Nc(){return _b||(_b=1,function(n,e){(function(t,r){n.exports=r(on())})(MO,function(t){return function(r){var i=t,o=i.lib,a=o.WordArray,l=o.Hasher,u=i.algo,d=[];(function(){for(var y=0;y<64;y++)d[y]=r.abs(r.sin(y+1))*4294967296|0})();var f=u.MD5=l.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,x){for(var I=0;I<16;I++){var b=x+I,T=y[b];y[b]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var R=this._hash.words,P=y[x+0],B=y[x+1],_=y[x+2],M=y[x+3],H=y[x+4],V=y[x+5],U=y[x+6],Z=y[x+7],q=y[x+8],ie=y[x+9],le=y[x+10],Ce=y[x+11],Re=y[x+12],de=y[x+13],pe=y[x+14],be=y[x+15],L=R[0],K=R[1],ue=R[2],he=R[3];L=p(L,K,ue,he,P,7,d[0]),he=p(he,L,K,ue,B,12,d[1]),ue=p(ue,he,L,K,_,17,d[2]),K=p(K,ue,he,L,M,22,d[3]),L=p(L,K,ue,he,H,7,d[4]),he=p(he,L,K,ue,V,12,d[5]),ue=p(ue,he,L,K,U,17,d[6]),K=p(K,ue,he,L,Z,22,d[7]),L=p(L,K,ue,he,q,7,d[8]),he=p(he,L,K,ue,ie,12,d[9]),ue=p(ue,he,L,K,le,17,d[10]),K=p(K,ue,he,L,Ce,22,d[11]),L=p(L,K,ue,he,Re,7,d[12]),he=p(he,L,K,ue,de,12,d[13]),ue=p(ue,he,L,K,pe,17,d[14]),K=p(K,ue,he,L,be,22,d[15]),L=g(L,K,ue,he,B,5,d[16]),he=g(he,L,K,ue,U,9,d[17]),ue=g(ue,he,L,K,Ce,14,d[18]),K=g(K,ue,he,L,P,20,d[19]),L=g(L,K,ue,he,V,5,d[20]),he=g(he,L,K,ue,le,9,d[21]),ue=g(ue,he,L,K,be,14,d[22]),K=g(K,ue,he,L,H,20,d[23]),L=g(L,K,ue,he,ie,5,d[24]),he=g(he,L,K,ue,pe,9,d[25]),ue=g(ue,he,L,K,M,14,d[26]),K=g(K,ue,he,L,q,20,d[27]),L=g(L,K,ue,he,de,5,d[28]),he=g(he,L,K,ue,_,9,d[29]),ue=g(ue,he,L,K,Z,14,d[30]),K=g(K,ue,he,L,Re,20,d[31]),L=v(L,K,ue,he,V,4,d[32]),he=v(he,L,K,ue,q,11,d[33]),ue=v(ue,he,L,K,Ce,16,d[34]),K=v(K,ue,he,L,pe,23,d[35]),L=v(L,K,ue,he,B,4,d[36]),he=v(he,L,K,ue,H,11,d[37]),ue=v(ue,he,L,K,Z,16,d[38]),K=v(K,ue,he,L,le,23,d[39]),L=v(L,K,ue,he,de,4,d[40]),he=v(he,L,K,ue,P,11,d[41]),ue=v(ue,he,L,K,M,16,d[42]),K=v(K,ue,he,L,U,23,d[43]),L=v(L,K,ue,he,ie,4,d[44]),he=v(he,L,K,ue,Re,11,d[45]),ue=v(ue,he,L,K,be,16,d[46]),K=v(K,ue,he,L,_,23,d[47]),L=C(L,K,ue,he,P,6,d[48]),he=C(he,L,K,ue,Z,10,d[49]),ue=C(ue,he,L,K,pe,15,d[50]),K=C(K,ue,he,L,V,21,d[51]),L=C(L,K,ue,he,Re,6,d[52]),he=C(he,L,K,ue,M,10,d[53]),ue=C(ue,he,L,K,le,15,d[54]),K=C(K,ue,he,L,B,21,d[55]),L=C(L,K,ue,he,q,6,d[56]),he=C(he,L,K,ue,be,10,d[57]),ue=C(ue,he,L,K,U,15,d[58]),K=C(K,ue,he,L,de,21,d[59]),L=C(L,K,ue,he,H,6,d[60]),he=C(he,L,K,ue,Ce,10,d[61]),ue=C(ue,he,L,K,_,15,d[62]),K=C(K,ue,he,L,ie,21,d[63]),R[0]=R[0]+L|0,R[1]=R[1]+K|0,R[2]=R[2]+ue|0,R[3]=R[3]+he|0},_doFinalize:function(){var y=this._data,x=y.words,I=this._nDataBytes*8,b=y.sigBytes*8;x[b>>>5]|=128<<24-b%32;var T=r.floor(I/4294967296),R=I;x[(b+64>>>9<<4)+15]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,x[(b+64>>>9<<4)+14]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,y.sigBytes=(x.length+1)*4,this._process();for(var P=this._hash,B=P.words,_=0;_<4;_++){var M=B[_];B[_]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360}return P},clone:function(){var y=l.clone.call(this);return y._hash=this._hash.clone(),y}});function p(y,x,I,b,T,R,P){var B=y+(x&I|~x&b)+T+P;return(B<<R|B>>>32-R)+x}function g(y,x,I,b,T,R,P){var B=y+(x&b|I&~b)+T+P;return(B<<R|B>>>32-R)+x}function v(y,x,I,b,T,R,P){var B=y+(x^I^b)+T+P;return(B<<R|B>>>32-R)+x}function C(y,x,I,b,T,R,P){var B=y+(I^(x|~b))+T+P;return(B<<R|B>>>32-R)+x}i.MD5=l._createHelper(f),i.HmacMD5=l._createHmacHelper(f)}(Math),t.MD5})}(wp)),wp.exports}var Sp={exports:{}},LO=Sp.exports,Pb;function Lk(){return Pb||(Pb=1,function(n,e){(function(t,r){n.exports=r(on())})(LO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=i.Hasher,l=r.algo,u=[],d=l.SHA1=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(f,p){for(var g=this._hash.words,v=g[0],C=g[1],y=g[2],x=g[3],I=g[4],b=0;b<80;b++){if(b<16)u[b]=f[p+b]|0;else{var T=u[b-3]^u[b-8]^u[b-14]^u[b-16];u[b]=T<<1|T>>>31}var R=(v<<5|v>>>27)+I+u[b];b<20?R+=(C&y|~C&x)+1518500249:b<40?R+=(C^y^x)+1859775393:b<60?R+=(C&y|C&x|y&x)-1894007588:R+=(C^y^x)-899497514,I=x,x=y,y=C<<30|C>>>2,C=v,v=R}g[0]=g[0]+v|0,g[1]=g[1]+C|0,g[2]=g[2]+y|0,g[3]=g[3]+x|0,g[4]=g[4]+I|0},_doFinalize:function(){var f=this._data,p=f.words,g=this._nDataBytes*8,v=f.sigBytes*8;return p[v>>>5]|=128<<24-v%32,p[(v+64>>>9<<4)+14]=Math.floor(g/4294967296),p[(v+64>>>9<<4)+15]=g,f.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var f=a.clone.call(this);return f._hash=this._hash.clone(),f}});r.SHA1=a._createHelper(d),r.HmacSHA1=a._createHmacHelper(d)}(),t.SHA1})}(Sp)),Sp.exports}var kp={exports:{}},UO=kp.exports,Db;function vy(){return Db||(Db=1,function(n,e){(function(t,r){n.exports=r(on())})(UO,function(t){return function(r){var i=t,o=i.lib,a=o.WordArray,l=o.Hasher,u=i.algo,d=[],f=[];(function(){function v(I){for(var b=r.sqrt(I),T=2;T<=b;T++)if(!(I%T))return!1;return!0}function C(I){return(I-(I|0))*4294967296|0}for(var y=2,x=0;x<64;)v(y)&&(x<8&&(d[x]=C(r.pow(y,1/2))),f[x]=C(r.pow(y,1/3)),x++),y++})();var p=[],g=u.SHA256=l.extend({_doReset:function(){this._hash=new a.init(d.slice(0))},_doProcessBlock:function(v,C){for(var y=this._hash.words,x=y[0],I=y[1],b=y[2],T=y[3],R=y[4],P=y[5],B=y[6],_=y[7],M=0;M<64;M++){if(M<16)p[M]=v[C+M]|0;else{var H=p[M-15],V=(H<<25|H>>>7)^(H<<14|H>>>18)^H>>>3,U=p[M-2],Z=(U<<15|U>>>17)^(U<<13|U>>>19)^U>>>10;p[M]=V+p[M-7]+Z+p[M-16]}var q=R&P^~R&B,ie=x&I^x&b^I&b,le=(x<<30|x>>>2)^(x<<19|x>>>13)^(x<<10|x>>>22),Ce=(R<<26|R>>>6)^(R<<21|R>>>11)^(R<<7|R>>>25),Re=_+Ce+q+f[M]+p[M],de=le+ie;_=B,B=P,P=R,R=T+Re|0,T=b,b=I,I=x,x=Re+de|0}y[0]=y[0]+x|0,y[1]=y[1]+I|0,y[2]=y[2]+b|0,y[3]=y[3]+T|0,y[4]=y[4]+R|0,y[5]=y[5]+P|0,y[6]=y[6]+B|0,y[7]=y[7]+_|0},_doFinalize:function(){var v=this._data,C=v.words,y=this._nDataBytes*8,x=v.sigBytes*8;return C[x>>>5]|=128<<24-x%32,C[(x+64>>>9<<4)+14]=r.floor(y/4294967296),C[(x+64>>>9<<4)+15]=y,v.sigBytes=C.length*4,this._process(),this._hash},clone:function(){var v=l.clone.call(this);return v._hash=this._hash.clone(),v}});i.SHA256=l._createHelper(g),i.HmacSHA256=l._createHmacHelper(g)}(Math),t.SHA256})}(kp)),kp.exports}var Ep={exports:{}},VO=Ep.exports,Nb;function GO(){return Nb||(Nb=1,function(n,e){(function(t,r,i){n.exports=r(on(),vy())})(VO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.algo,l=a.SHA256,u=a.SHA224=l.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var d=l._doFinalize.call(this);return d.sigBytes-=4,d}});r.SHA224=l._createHelper(u),r.HmacSHA224=l._createHmacHelper(u)}(),t.SHA224})}(Ep)),Ep.exports}var Tp={exports:{}},WO=Tp.exports,Bb;function Uk(){return Bb||(Bb=1,function(n,e){(function(t,r,i){n.exports=r(on(),Y0())})(WO,function(t){return function(){var r=t,i=r.lib,o=i.Hasher,a=r.x64,l=a.Word,u=a.WordArray,d=r.algo;function f(){return l.create.apply(l,arguments)}var p=[f(1116352408,3609767458),f(1899447441,602891725),f(3049323471,3964484399),f(3921009573,2173295548),f(961987163,4081628472),f(1508970993,3053834265),f(2453635748,2937671579),f(2870763221,3664609560),f(3624381080,2734883394),f(310598401,1164996542),f(607225278,1323610764),f(1426881987,3590304994),f(1925078388,4068182383),f(2162078206,991336113),f(2614888103,633803317),f(3248222580,3479774868),f(3835390401,2666613458),f(4022224774,944711139),f(264347078,2341262773),f(604807628,2007800933),f(770255983,1495990901),f(1249150122,1856431235),f(1555081692,3175218132),f(1996064986,2198950837),f(2554220882,3999719339),f(2821834349,766784016),f(2952996808,2566594879),f(3210313671,3203337956),f(3336571891,1034457026),f(3584528711,2466948901),f(113926993,3758326383),f(338241895,168717936),f(666307205,1188179964),f(773529912,1546045734),f(1294757372,1522805485),f(1396182291,2643833823),f(1695183700,2343527390),f(1986661051,1014477480),f(2177026350,1206759142),f(2456956037,344077627),f(2730485921,1290863460),f(2820302411,3158454273),f(3259730800,3505952657),f(3345764771,106217008),f(3516065817,3606008344),f(3600352804,1432725776),f(4094571909,1467031594),f(275423344,851169720),f(430227734,3100823752),f(506948616,1363258195),f(659060556,3750685593),f(883997877,3785050280),f(958139571,3318307427),f(1322822218,3812723403),f(1537002063,2003034995),f(1747873779,3602036899),f(1955562222,1575990012),f(2024104815,1125592928),f(2227730452,2716904306),f(2361852424,442776044),f(2428436474,593698344),f(2756734187,3733110249),f(3204031479,2999351573),f(3329325298,3815920427),f(3391569614,3928383900),f(3515267271,566280711),f(3940187606,3454069534),f(4118630271,4000239992),f(116418474,1914138554),f(174292421,2731055270),f(289380356,3203993006),f(460393269,320620315),f(685471733,587496836),f(852142971,1086792851),f(1017036298,365543100),f(1126000580,2618297676),f(1288033470,3409855158),f(1501505948,4234509866),f(1607167915,987167468),f(1816402316,1246189591)],g=[];(function(){for(var C=0;C<80;C++)g[C]=f()})();var v=d.SHA512=o.extend({_doReset:function(){this._hash=new u.init([new l.init(1779033703,4089235720),new l.init(3144134277,2227873595),new l.init(1013904242,4271175723),new l.init(2773480762,1595750129),new l.init(1359893119,2917565137),new l.init(2600822924,725511199),new l.init(528734635,4215389547),new l.init(1541459225,327033209)])},_doProcessBlock:function(C,y){for(var x=this._hash.words,I=x[0],b=x[1],T=x[2],R=x[3],P=x[4],B=x[5],_=x[6],M=x[7],H=I.high,V=I.low,U=b.high,Z=b.low,q=T.high,ie=T.low,le=R.high,Ce=R.low,Re=P.high,de=P.low,pe=B.high,be=B.low,L=_.high,K=_.low,ue=M.high,he=M.low,Ee=H,Fe=V,Je=U,Te=Z,ft=q,Nt=ie,rn=le,Rt=Ce,yt=Re,Pt=de,He=pe,$e=be,bt=L,xt=K,ct=ue,At=he,Ut=0;Ut<80;Ut++){var kt,jt,fn=g[Ut];if(Ut<16)jt=fn.high=C[y+Ut*2]|0,kt=fn.low=C[y+Ut*2+1]|0;else{var sn=g[Ut-15],yn=sn.high,W=sn.low,k=(yn>>>1|W<<31)^(yn>>>8|W<<24)^yn>>>7,D=(W>>>1|yn<<31)^(W>>>8|yn<<24)^(W>>>7|yn<<25),X=g[Ut-2],se=X.high,xe=X.low,_e=(se>>>19|xe<<13)^(se<<3|xe>>>29)^se>>>6,mt=(xe>>>19|se<<13)^(xe<<3|se>>>29)^(xe>>>6|se<<26),Zt=g[Ut-7],Xt=Zt.high,Yt=Zt.low,zt=g[Ut-16],xn=zt.high,ir=zt.low;kt=D+Yt,jt=k+Xt+(kt>>>0<D>>>0?1:0),kt=kt+mt,jt=jt+_e+(kt>>>0<mt>>>0?1:0),kt=kt+ir,jt=jt+xn+(kt>>>0<ir>>>0?1:0),fn.high=jt,fn.low=kt}var qn=yt&He^~yt&bt,Bt=Pt&$e^~Pt&xt,Mr=Ee&Je^Ee&ft^Je&ft,Lr=Fe&Te^Fe&Nt^Te&Nt,an=(Ee>>>28|Fe<<4)^(Ee<<30|Fe>>>2)^(Ee<<25|Fe>>>7),Rn=(Fe>>>28|Ee<<4)^(Fe<<30|Ee>>>2)^(Fe<<25|Ee>>>7),Cr=(yt>>>14|Pt<<18)^(yt>>>18|Pt<<14)^(yt<<23|Pt>>>9),zn=(Pt>>>14|yt<<18)^(Pt>>>18|yt<<14)^(Pt<<23|yt>>>9),Ur=p[Ut],yr=Ur.high,re=Ur.low,ce=At+zn,ve=ct+Cr+(ce>>>0<At>>>0?1:0),ce=ce+Bt,ve=ve+qn+(ce>>>0<Bt>>>0?1:0),ce=ce+re,ve=ve+yr+(ce>>>0<re>>>0?1:0),ce=ce+kt,ve=ve+jt+(ce>>>0<kt>>>0?1:0),Oe=Rn+Lr,Ze=an+Mr+(Oe>>>0<Rn>>>0?1:0);ct=bt,At=xt,bt=He,xt=$e,He=yt,$e=Pt,Pt=Rt+ce|0,yt=rn+ve+(Pt>>>0<Rt>>>0?1:0)|0,rn=ft,Rt=Nt,ft=Je,Nt=Te,Je=Ee,Te=Fe,Fe=ce+Oe|0,Ee=ve+Ze+(Fe>>>0<ce>>>0?1:0)|0}V=I.low=V+Fe,I.high=H+Ee+(V>>>0<Fe>>>0?1:0),Z=b.low=Z+Te,b.high=U+Je+(Z>>>0<Te>>>0?1:0),ie=T.low=ie+Nt,T.high=q+ft+(ie>>>0<Nt>>>0?1:0),Ce=R.low=Ce+Rt,R.high=le+rn+(Ce>>>0<Rt>>>0?1:0),de=P.low=de+Pt,P.high=Re+yt+(de>>>0<Pt>>>0?1:0),be=B.low=be+$e,B.high=pe+He+(be>>>0<$e>>>0?1:0),K=_.low=K+xt,_.high=L+bt+(K>>>0<xt>>>0?1:0),he=M.low=he+At,M.high=ue+ct+(he>>>0<At>>>0?1:0)},_doFinalize:function(){var C=this._data,y=C.words,x=this._nDataBytes*8,I=C.sigBytes*8;y[I>>>5]|=128<<24-I%32,y[(I+128>>>10<<5)+30]=Math.floor(x/4294967296),y[(I+128>>>10<<5)+31]=x,C.sigBytes=y.length*4,this._process();var b=this._hash.toX32();return b},clone:function(){var C=o.clone.call(this);return C._hash=this._hash.clone(),C},blockSize:1024/32});r.SHA512=o._createHelper(v),r.HmacSHA512=o._createHmacHelper(v)}(),t.SHA512})}(Tp)),Tp.exports}var Rp={exports:{}},jO=Rp.exports,Ob;function zO(){return Ob||(Ob=1,function(n,e){(function(t,r,i){n.exports=r(on(),Y0(),Uk())})(jO,function(t){return function(){var r=t,i=r.x64,o=i.Word,a=i.WordArray,l=r.algo,u=l.SHA512,d=l.SHA384=u.extend({_doReset:function(){this._hash=new a.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var f=u._doFinalize.call(this);return f.sigBytes-=16,f}});r.SHA384=u._createHelper(d),r.HmacSHA384=u._createHmacHelper(d)}(),t.SHA384})}(Rp)),Rp.exports}var _p={exports:{}},HO=_p.exports,Fb;function ZO(){return Fb||(Fb=1,function(n,e){(function(t,r,i){n.exports=r(on(),Y0())})(HO,function(t){return function(r){var i=t,o=i.lib,a=o.WordArray,l=o.Hasher,u=i.x64,d=u.Word,f=i.algo,p=[],g=[],v=[];(function(){for(var x=1,I=0,b=0;b<24;b++){p[x+5*I]=(b+1)*(b+2)/2%64;var T=I%5,R=(2*x+3*I)%5;x=T,I=R}for(var x=0;x<5;x++)for(var I=0;I<5;I++)g[x+5*I]=I+(2*x+3*I)%5*5;for(var P=1,B=0;B<24;B++){for(var _=0,M=0,H=0;H<7;H++){if(P&1){var V=(1<<H)-1;V<32?M^=1<<V:_^=1<<V-32}P&128?P=P<<1^113:P<<=1}v[B]=d.create(_,M)}})();var C=[];(function(){for(var x=0;x<25;x++)C[x]=d.create()})();var y=f.SHA3=l.extend({cfg:l.cfg.extend({outputLength:512}),_doReset:function(){for(var x=this._state=[],I=0;I<25;I++)x[I]=new d.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(x,I){for(var b=this._state,T=this.blockSize/2,R=0;R<T;R++){var P=x[I+2*R],B=x[I+2*R+1];P=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,B=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360;var _=b[R];_.high^=B,_.low^=P}for(var M=0;M<24;M++){for(var H=0;H<5;H++){for(var V=0,U=0,Z=0;Z<5;Z++){var _=b[H+5*Z];V^=_.high,U^=_.low}var q=C[H];q.high=V,q.low=U}for(var H=0;H<5;H++)for(var ie=C[(H+4)%5],le=C[(H+1)%5],Ce=le.high,Re=le.low,V=ie.high^(Ce<<1|Re>>>31),U=ie.low^(Re<<1|Ce>>>31),Z=0;Z<5;Z++){var _=b[H+5*Z];_.high^=V,_.low^=U}for(var de=1;de<25;de++){var V,U,_=b[de],pe=_.high,be=_.low,L=p[de];L<32?(V=pe<<L|be>>>32-L,U=be<<L|pe>>>32-L):(V=be<<L-32|pe>>>64-L,U=pe<<L-32|be>>>64-L);var K=C[g[de]];K.high=V,K.low=U}var ue=C[0],he=b[0];ue.high=he.high,ue.low=he.low;for(var H=0;H<5;H++)for(var Z=0;Z<5;Z++){var de=H+5*Z,_=b[de],Ee=C[de],Fe=C[(H+1)%5+5*Z],Je=C[(H+2)%5+5*Z];_.high=Ee.high^~Fe.high&Je.high,_.low=Ee.low^~Fe.low&Je.low}var _=b[0],Te=v[M];_.high^=Te.high,_.low^=Te.low}},_doFinalize:function(){var x=this._data,I=x.words;this._nDataBytes*8;var b=x.sigBytes*8,T=this.blockSize*32;I[b>>>5]|=1<<24-b%32,I[(r.ceil((b+1)/T)*T>>>5)-1]|=128,x.sigBytes=I.length*4,this._process();for(var R=this._state,P=this.cfg.outputLength/8,B=P/8,_=[],M=0;M<B;M++){var H=R[M],V=H.high,U=H.low;V=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,U=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360,_.push(U),_.push(V)}return new a.init(_,P)},clone:function(){for(var x=l.clone.call(this),I=x._state=this._state.slice(0),b=0;b<25;b++)I[b]=I[b].clone();return x}});i.SHA3=l._createHelper(y),i.HmacSHA3=l._createHmacHelper(y)}(Math),t.SHA3})}(_p)),_p.exports}var Pp={exports:{}},XO=Pp.exports,Mb;function KO(){return Mb||(Mb=1,function(n,e){(function(t,r){n.exports=r(on())})(XO,function(t){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=t,o=i.lib,a=o.WordArray,l=o.Hasher,u=i.algo,d=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),f=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),p=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),g=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),v=a.create([0,1518500249,1859775393,2400959708,2840853838]),C=a.create([1352829926,1548603684,1836072691,2053994217,0]),y=u.RIPEMD160=l.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(B,_){for(var M=0;M<16;M++){var H=_+M,V=B[H];B[H]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}var U=this._hash.words,Z=v.words,q=C.words,ie=d.words,le=f.words,Ce=p.words,Re=g.words,de,pe,be,L,K,ue,he,Ee,Fe,Je;ue=de=U[0],he=pe=U[1],Ee=be=U[2],Fe=L=U[3],Je=K=U[4];for(var Te,M=0;M<80;M+=1)Te=de+B[_+ie[M]]|0,M<16?Te+=x(pe,be,L)+Z[0]:M<32?Te+=I(pe,be,L)+Z[1]:M<48?Te+=b(pe,be,L)+Z[2]:M<64?Te+=T(pe,be,L)+Z[3]:Te+=R(pe,be,L)+Z[4],Te=Te|0,Te=P(Te,Ce[M]),Te=Te+K|0,de=K,K=L,L=P(be,10),be=pe,pe=Te,Te=ue+B[_+le[M]]|0,M<16?Te+=R(he,Ee,Fe)+q[0]:M<32?Te+=T(he,Ee,Fe)+q[1]:M<48?Te+=b(he,Ee,Fe)+q[2]:M<64?Te+=I(he,Ee,Fe)+q[3]:Te+=x(he,Ee,Fe)+q[4],Te=Te|0,Te=P(Te,Re[M]),Te=Te+Je|0,ue=Je,Je=Fe,Fe=P(Ee,10),Ee=he,he=Te;Te=U[1]+be+Fe|0,U[1]=U[2]+L+Je|0,U[2]=U[3]+K+ue|0,U[3]=U[4]+de+he|0,U[4]=U[0]+pe+Ee|0,U[0]=Te},_doFinalize:function(){var B=this._data,_=B.words,M=this._nDataBytes*8,H=B.sigBytes*8;_[H>>>5]|=128<<24-H%32,_[(H+64>>>9<<4)+14]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360,B.sigBytes=(_.length+1)*4,this._process();for(var V=this._hash,U=V.words,Z=0;Z<5;Z++){var q=U[Z];U[Z]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}return V},clone:function(){var B=l.clone.call(this);return B._hash=this._hash.clone(),B}});function x(B,_,M){return B^_^M}function I(B,_,M){return B&_|~B&M}function b(B,_,M){return(B|~_)^M}function T(B,_,M){return B&M|_&~M}function R(B,_,M){return B^(_|~M)}function P(B,_){return B<<_|B>>>32-_}i.RIPEMD160=l._createHelper(y),i.HmacRIPEMD160=l._createHmacHelper(y)}(),t.RIPEMD160})}(Pp)),Pp.exports}var Dp={exports:{}},$O=Dp.exports,Lb;function Cy(){return Lb||(Lb=1,function(n,e){(function(t,r){n.exports=r(on())})($O,function(t){(function(){var r=t,i=r.lib,o=i.Base,a=r.enc,l=a.Utf8,u=r.algo;u.HMAC=o.extend({init:function(d,f){d=this._hasher=new d.init,typeof f=="string"&&(f=l.parse(f));var p=d.blockSize,g=p*4;f.sigBytes>g&&(f=d.finalize(f)),f.clamp();for(var v=this._oKey=f.clone(),C=this._iKey=f.clone(),y=v.words,x=C.words,I=0;I<p;I++)y[I]^=1549556828,x[I]^=909522486;v.sigBytes=C.sigBytes=g,this.reset()},reset:function(){var d=this._hasher;d.reset(),d.update(this._iKey)},update:function(d){return this._hasher.update(d),this},finalize:function(d){var f=this._hasher,p=f.finalize(d);f.reset();var g=f.finalize(this._oKey.clone().concat(p));return g}})})()})}(Dp)),Dp.exports}var Np={exports:{}},JO=Np.exports,Ub;function YO(){return Ub||(Ub=1,function(n,e){(function(t,r,i){n.exports=r(on(),vy(),Cy())})(JO,function(t){return function(){var r=t,i=r.lib,o=i.Base,a=i.WordArray,l=r.algo,u=l.SHA256,d=l.HMAC,f=l.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:u,iterations:25e4}),init:function(p){this.cfg=this.cfg.extend(p)},compute:function(p,g){for(var v=this.cfg,C=d.create(v.hasher,p),y=a.create(),x=a.create([1]),I=y.words,b=x.words,T=v.keySize,R=v.iterations;I.length<T;){var P=C.update(g).finalize(x);C.reset();for(var B=P.words,_=B.length,M=P,H=1;H<R;H++){M=C.finalize(M),C.reset();for(var V=M.words,U=0;U<_;U++)B[U]^=V[U]}y.concat(P),b[0]++}return y.sigBytes=T*4,y}});r.PBKDF2=function(p,g,v){return f.create(v).compute(p,g)}}(),t.PBKDF2})}(Np)),Np.exports}var Bp={exports:{}},qO=Bp.exports,Vb;function Ml(){return Vb||(Vb=1,function(n,e){(function(t,r,i){n.exports=r(on(),Lk(),Cy())})(qO,function(t){return function(){var r=t,i=r.lib,o=i.Base,a=i.WordArray,l=r.algo,u=l.MD5,d=l.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:u,iterations:1}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,p){for(var g,v=this.cfg,C=v.hasher.create(),y=a.create(),x=y.words,I=v.keySize,b=v.iterations;x.length<I;){g&&C.update(g),g=C.update(f).finalize(p),C.reset();for(var T=1;T<b;T++)g=C.finalize(g),C.reset();y.concat(g)}return y.sigBytes=I*4,y}});r.EvpKDF=function(f,p,g){return d.create(g).compute(f,p)}}(),t.EvpKDF})}(Bp)),Bp.exports}var Op={exports:{}},QO=Op.exports,Gb;function kr(){return Gb||(Gb=1,function(n,e){(function(t,r,i){n.exports=r(on(),Ml())})(QO,function(t){t.lib.Cipher||function(r){var i=t,o=i.lib,a=o.Base,l=o.WordArray,u=o.BufferedBlockAlgorithm,d=i.enc;d.Utf8;var f=d.Base64,p=i.algo,g=p.EvpKDF,v=o.Cipher=u.extend({cfg:a.extend(),createEncryptor:function(V,U){return this.create(this._ENC_XFORM_MODE,V,U)},createDecryptor:function(V,U){return this.create(this._DEC_XFORM_MODE,V,U)},init:function(V,U,Z){this.cfg=this.cfg.extend(Z),this._xformMode=V,this._key=U,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(V){return this._append(V),this._process()},finalize:function(V){V&&this._append(V);var U=this._doFinalize();return U},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function V(U){return typeof U=="string"?H:B}return function(U){return{encrypt:function(Z,q,ie){return V(q).encrypt(U,Z,q,ie)},decrypt:function(Z,q,ie){return V(q).decrypt(U,Z,q,ie)}}}}()});o.StreamCipher=v.extend({_doFinalize:function(){var V=this._process(!0);return V},blockSize:1});var C=i.mode={},y=o.BlockCipherMode=a.extend({createEncryptor:function(V,U){return this.Encryptor.create(V,U)},createDecryptor:function(V,U){return this.Decryptor.create(V,U)},init:function(V,U){this._cipher=V,this._iv=U}}),x=C.CBC=function(){var V=y.extend();V.Encryptor=V.extend({processBlock:function(Z,q){var ie=this._cipher,le=ie.blockSize;U.call(this,Z,q,le),ie.encryptBlock(Z,q),this._prevBlock=Z.slice(q,q+le)}}),V.Decryptor=V.extend({processBlock:function(Z,q){var ie=this._cipher,le=ie.blockSize,Ce=Z.slice(q,q+le);ie.decryptBlock(Z,q),U.call(this,Z,q,le),this._prevBlock=Ce}});function U(Z,q,ie){var le,Ce=this._iv;Ce?(le=Ce,this._iv=r):le=this._prevBlock;for(var Re=0;Re<ie;Re++)Z[q+Re]^=le[Re]}return V}(),I=i.pad={},b=I.Pkcs7={pad:function(V,U){for(var Z=U*4,q=Z-V.sigBytes%Z,ie=q<<24|q<<16|q<<8|q,le=[],Ce=0;Ce<q;Ce+=4)le.push(ie);var Re=l.create(le,q);V.concat(Re)},unpad:function(V){var U=V.words[V.sigBytes-1>>>2]&255;V.sigBytes-=U}};o.BlockCipher=v.extend({cfg:v.cfg.extend({mode:x,padding:b}),reset:function(){var V;v.reset.call(this);var U=this.cfg,Z=U.iv,q=U.mode;this._xformMode==this._ENC_XFORM_MODE?V=q.createEncryptor:(V=q.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==V?this._mode.init(this,Z&&Z.words):(this._mode=V.call(q,this,Z&&Z.words),this._mode.__creator=V)},_doProcessBlock:function(V,U){this._mode.processBlock(V,U)},_doFinalize:function(){var V,U=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(U.pad(this._data,this.blockSize),V=this._process(!0)):(V=this._process(!0),U.unpad(V)),V},blockSize:128/32});var T=o.CipherParams=a.extend({init:function(V){this.mixIn(V)},toString:function(V){return(V||this.formatter).stringify(this)}}),R=i.format={},P=R.OpenSSL={stringify:function(V){var U,Z=V.ciphertext,q=V.salt;return q?U=l.create([1398893684,1701076831]).concat(q).concat(Z):U=Z,U.toString(f)},parse:function(V){var U,Z=f.parse(V),q=Z.words;return q[0]==1398893684&&q[1]==1701076831&&(U=l.create(q.slice(2,4)),q.splice(0,4),Z.sigBytes-=16),T.create({ciphertext:Z,salt:U})}},B=o.SerializableCipher=a.extend({cfg:a.extend({format:P}),encrypt:function(V,U,Z,q){q=this.cfg.extend(q);var ie=V.createEncryptor(Z,q),le=ie.finalize(U),Ce=ie.cfg;return T.create({ciphertext:le,key:Z,iv:Ce.iv,algorithm:V,mode:Ce.mode,padding:Ce.padding,blockSize:V.blockSize,formatter:q.format})},decrypt:function(V,U,Z,q){q=this.cfg.extend(q),U=this._parse(U,q.format);var ie=V.createDecryptor(Z,q).finalize(U.ciphertext);return ie},_parse:function(V,U){return typeof V=="string"?U.parse(V,this):V}}),_=i.kdf={},M=_.OpenSSL={execute:function(V,U,Z,q,ie){if(q||(q=l.random(64/8)),ie)var le=g.create({keySize:U+Z,hasher:ie}).compute(V,q);else var le=g.create({keySize:U+Z}).compute(V,q);var Ce=l.create(le.words.slice(U),Z*4);return le.sigBytes=U*4,T.create({key:le,iv:Ce,salt:q})}},H=o.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:M}),encrypt:function(V,U,Z,q){q=this.cfg.extend(q);var ie=q.kdf.execute(Z,V.keySize,V.ivSize,q.salt,q.hasher);q.iv=ie.iv;var le=B.encrypt.call(this,V,U,ie.key,q);return le.mixIn(ie),le},decrypt:function(V,U,Z,q){q=this.cfg.extend(q),U=this._parse(U,q.format);var ie=q.kdf.execute(Z,V.keySize,V.ivSize,U.salt,q.hasher);q.iv=ie.iv;var le=B.decrypt.call(this,V,U,ie.key,q);return le}})}()})}(Op)),Op.exports}var Fp={exports:{}},eF=Fp.exports,Wb;function tF(){return Wb||(Wb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(eF,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(o,a){var l=this._cipher,u=l.blockSize;i.call(this,o,a,u,l),this._prevBlock=o.slice(a,a+u)}}),r.Decryptor=r.extend({processBlock:function(o,a){var l=this._cipher,u=l.blockSize,d=o.slice(a,a+u);i.call(this,o,a,u,l),this._prevBlock=d}});function i(o,a,l,u){var d,f=this._iv;f?(d=f.slice(0),this._iv=void 0):d=this._prevBlock,u.encryptBlock(d,0);for(var p=0;p<l;p++)o[a+p]^=d[p]}return r}(),t.mode.CFB})}(Fp)),Fp.exports}var Mp={exports:{}},nF=Mp.exports,jb;function rF(){return jb||(jb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(nF,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,a){var l=this._cipher,u=l.blockSize,d=this._iv,f=this._counter;d&&(f=this._counter=d.slice(0),this._iv=void 0);var p=f.slice(0);l.encryptBlock(p,0),f[u-1]=f[u-1]+1|0;for(var g=0;g<u;g++)o[a+g]^=p[g]}});return r.Decryptor=i,r}(),t.mode.CTR})}(Mp)),Mp.exports}var Lp={exports:{}},iF=Lp.exports,zb;function oF(){return zb||(zb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(iF,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function i(l){if((l>>24&255)===255){var u=l>>16&255,d=l>>8&255,f=l&255;u===255?(u=0,d===255?(d=0,f===255?f=0:++f):++d):++u,l=0,l+=u<<16,l+=d<<8,l+=f}else l+=1<<24;return l}function o(l){return(l[0]=i(l[0]))===0&&(l[1]=i(l[1])),l}var a=r.Encryptor=r.extend({processBlock:function(l,u){var d=this._cipher,f=d.blockSize,p=this._iv,g=this._counter;p&&(g=this._counter=p.slice(0),this._iv=void 0),o(g);var v=g.slice(0);d.encryptBlock(v,0);for(var C=0;C<f;C++)l[u+C]^=v[C]}});return r.Decryptor=a,r}(),t.mode.CTRGladman})}(Lp)),Lp.exports}var Up={exports:{}},sF=Up.exports,Hb;function aF(){return Hb||(Hb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(sF,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,a){var l=this._cipher,u=l.blockSize,d=this._iv,f=this._keystream;d&&(f=this._keystream=d.slice(0),this._iv=void 0),l.encryptBlock(f,0);for(var p=0;p<u;p++)o[a+p]^=f[p]}});return r.Decryptor=i,r}(),t.mode.OFB})}(Up)),Up.exports}var Vp={exports:{}},lF=Vp.exports,Zb;function cF(){return Zb||(Zb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(lF,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),r.Decryptor=r.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),r}(),t.mode.ECB})}(Vp)),Vp.exports}var Gp={exports:{}},uF=Gp.exports,Xb;function dF(){return Xb||(Xb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(uF,function(t){return t.pad.AnsiX923={pad:function(r,i){var o=r.sigBytes,a=i*4,l=a-o%a,u=o+l-1;r.clamp(),r.words[u>>>2]|=l<<24-u%4*8,r.sigBytes+=l},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Ansix923})}(Gp)),Gp.exports}var Wp={exports:{}},fF=Wp.exports,Kb;function hF(){return Kb||(Kb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(fF,function(t){return t.pad.Iso10126={pad:function(r,i){var o=i*4,a=o-r.sigBytes%o;r.concat(t.lib.WordArray.random(a-1)).concat(t.lib.WordArray.create([a<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Iso10126})}(Wp)),Wp.exports}var jp={exports:{}},pF=jp.exports,$b;function gF(){return $b||($b=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(pF,function(t){return t.pad.Iso97971={pad:function(r,i){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,i)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(jp)),jp.exports}var zp={exports:{}},mF=zp.exports,Jb;function vF(){return Jb||(Jb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(mF,function(t){return t.pad.ZeroPadding={pad:function(r,i){var o=i*4;r.clamp(),r.sigBytes+=o-(r.sigBytes%o||o)},unpad:function(r){for(var i=r.words,o=r.sigBytes-1,o=r.sigBytes-1;o>=0;o--)if(i[o>>>2]>>>24-o%4*8&255){r.sigBytes=o+1;break}}},t.pad.ZeroPadding})}(zp)),zp.exports}var Hp={exports:{}},CF=Hp.exports,Yb;function yF(){return Yb||(Yb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(CF,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(Hp)),Hp.exports}var Zp={exports:{}},xF=Zp.exports,qb;function IF(){return qb||(qb=1,function(n,e){(function(t,r,i){n.exports=r(on(),kr())})(xF,function(t){return function(r){var i=t,o=i.lib,a=o.CipherParams,l=i.enc,u=l.Hex,d=i.format;d.Hex={stringify:function(f){return f.ciphertext.toString(u)},parse:function(f){var p=u.parse(f);return a.create({ciphertext:p})}}}(),t.format.Hex})}(Zp)),Zp.exports}var Xp={exports:{}},bF=Xp.exports,Qb;function AF(){return Qb||(Qb=1,function(n,e){(function(t,r,i){n.exports=r(on(),Dc(),Nc(),Ml(),kr())})(bF,function(t){return function(){var r=t,i=r.lib,o=i.BlockCipher,a=r.algo,l=[],u=[],d=[],f=[],p=[],g=[],v=[],C=[],y=[],x=[];(function(){for(var T=[],R=0;R<256;R++)R<128?T[R]=R<<1:T[R]=R<<1^283;for(var P=0,B=0,R=0;R<256;R++){var _=B^B<<1^B<<2^B<<3^B<<4;_=_>>>8^_&255^99,l[P]=_,u[_]=P;var M=T[P],H=T[M],V=T[H],U=T[_]*257^_*16843008;d[P]=U<<24|U>>>8,f[P]=U<<16|U>>>16,p[P]=U<<8|U>>>24,g[P]=U;var U=V*16843009^H*65537^M*257^P*16843008;v[_]=U<<24|U>>>8,C[_]=U<<16|U>>>16,y[_]=U<<8|U>>>24,x[_]=U,P?(P=M^T[T[T[V^M]]],B^=T[T[B]]):P=B=1}})();var I=[0,1,2,4,8,16,32,64,128,27,54],b=a.AES=o.extend({_doReset:function(){var T;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var R=this._keyPriorReset=this._key,P=R.words,B=R.sigBytes/4,_=this._nRounds=B+6,M=(_+1)*4,H=this._keySchedule=[],V=0;V<M;V++)V<B?H[V]=P[V]:(T=H[V-1],V%B?B>6&&V%B==4&&(T=l[T>>>24]<<24|l[T>>>16&255]<<16|l[T>>>8&255]<<8|l[T&255]):(T=T<<8|T>>>24,T=l[T>>>24]<<24|l[T>>>16&255]<<16|l[T>>>8&255]<<8|l[T&255],T^=I[V/B|0]<<24),H[V]=H[V-B]^T);for(var U=this._invKeySchedule=[],Z=0;Z<M;Z++){var V=M-Z;if(Z%4)var T=H[V];else var T=H[V-4];Z<4||V<=4?U[Z]=T:U[Z]=v[l[T>>>24]]^C[l[T>>>16&255]]^y[l[T>>>8&255]]^x[l[T&255]]}}},encryptBlock:function(T,R){this._doCryptBlock(T,R,this._keySchedule,d,f,p,g,l)},decryptBlock:function(T,R){var P=T[R+1];T[R+1]=T[R+3],T[R+3]=P,this._doCryptBlock(T,R,this._invKeySchedule,v,C,y,x,u);var P=T[R+1];T[R+1]=T[R+3],T[R+3]=P},_doCryptBlock:function(T,R,P,B,_,M,H,V){for(var U=this._nRounds,Z=T[R]^P[0],q=T[R+1]^P[1],ie=T[R+2]^P[2],le=T[R+3]^P[3],Ce=4,Re=1;Re<U;Re++){var de=B[Z>>>24]^_[q>>>16&255]^M[ie>>>8&255]^H[le&255]^P[Ce++],pe=B[q>>>24]^_[ie>>>16&255]^M[le>>>8&255]^H[Z&255]^P[Ce++],be=B[ie>>>24]^_[le>>>16&255]^M[Z>>>8&255]^H[q&255]^P[Ce++],L=B[le>>>24]^_[Z>>>16&255]^M[q>>>8&255]^H[ie&255]^P[Ce++];Z=de,q=pe,ie=be,le=L}var de=(V[Z>>>24]<<24|V[q>>>16&255]<<16|V[ie>>>8&255]<<8|V[le&255])^P[Ce++],pe=(V[q>>>24]<<24|V[ie>>>16&255]<<16|V[le>>>8&255]<<8|V[Z&255])^P[Ce++],be=(V[ie>>>24]<<24|V[le>>>16&255]<<16|V[Z>>>8&255]<<8|V[q&255])^P[Ce++],L=(V[le>>>24]<<24|V[Z>>>16&255]<<16|V[q>>>8&255]<<8|V[ie&255])^P[Ce++];T[R]=de,T[R+1]=pe,T[R+2]=be,T[R+3]=L},keySize:256/32});r.AES=o._createHelper(b)}(),t.AES})}(Xp)),Xp.exports}var Kp={exports:{}},wF=Kp.exports,eA;function SF(){return eA||(eA=1,function(n,e){(function(t,r,i){n.exports=r(on(),Dc(),Nc(),Ml(),kr())})(wF,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=i.BlockCipher,l=r.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],d=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],f=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],p=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],g=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],v=l.DES=a.extend({_doReset:function(){for(var I=this._key,b=I.words,T=[],R=0;R<56;R++){var P=u[R]-1;T[R]=b[P>>>5]>>>31-P%32&1}for(var B=this._subKeys=[],_=0;_<16;_++){for(var M=B[_]=[],H=f[_],R=0;R<24;R++)M[R/6|0]|=T[(d[R]-1+H)%28]<<31-R%6,M[4+(R/6|0)]|=T[28+(d[R+24]-1+H)%28]<<31-R%6;M[0]=M[0]<<1|M[0]>>>31;for(var R=1;R<7;R++)M[R]=M[R]>>>(R-1)*4+3;M[7]=M[7]<<5|M[7]>>>27}for(var V=this._invSubKeys=[],R=0;R<16;R++)V[R]=B[15-R]},encryptBlock:function(I,b){this._doCryptBlock(I,b,this._subKeys)},decryptBlock:function(I,b){this._doCryptBlock(I,b,this._invSubKeys)},_doCryptBlock:function(I,b,T){this._lBlock=I[b],this._rBlock=I[b+1],C.call(this,4,252645135),C.call(this,16,65535),y.call(this,2,858993459),y.call(this,8,16711935),C.call(this,1,1431655765);for(var R=0;R<16;R++){for(var P=T[R],B=this._lBlock,_=this._rBlock,M=0,H=0;H<8;H++)M|=p[H][((_^P[H])&g[H])>>>0];this._lBlock=_,this._rBlock=B^M}var V=this._lBlock;this._lBlock=this._rBlock,this._rBlock=V,C.call(this,1,1431655765),y.call(this,8,16711935),y.call(this,2,858993459),C.call(this,16,65535),C.call(this,4,252645135),I[b]=this._lBlock,I[b+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function C(I,b){var T=(this._lBlock>>>I^this._rBlock)&b;this._rBlock^=T,this._lBlock^=T<<I}function y(I,b){var T=(this._rBlock>>>I^this._lBlock)&b;this._lBlock^=T,this._rBlock^=T<<I}r.DES=a._createHelper(v);var x=l.TripleDES=a.extend({_doReset:function(){var I=this._key,b=I.words;if(b.length!==2&&b.length!==4&&b.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var T=b.slice(0,2),R=b.length<4?b.slice(0,2):b.slice(2,4),P=b.length<6?b.slice(0,2):b.slice(4,6);this._des1=v.createEncryptor(o.create(T)),this._des2=v.createEncryptor(o.create(R)),this._des3=v.createEncryptor(o.create(P))},encryptBlock:function(I,b){this._des1.encryptBlock(I,b),this._des2.decryptBlock(I,b),this._des3.encryptBlock(I,b)},decryptBlock:function(I,b){this._des3.decryptBlock(I,b),this._des2.encryptBlock(I,b),this._des1.decryptBlock(I,b)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=a._createHelper(x)}(),t.TripleDES})}(Kp)),Kp.exports}var $p={exports:{}},kF=$p.exports,tA;function EF(){return tA||(tA=1,function(n,e){(function(t,r,i){n.exports=r(on(),Dc(),Nc(),Ml(),kr())})(kF,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,a=r.algo,l=a.RC4=o.extend({_doReset:function(){for(var f=this._key,p=f.words,g=f.sigBytes,v=this._S=[],C=0;C<256;C++)v[C]=C;for(var C=0,y=0;C<256;C++){var x=C%g,I=p[x>>>2]>>>24-x%4*8&255;y=(y+v[C]+I)%256;var b=v[C];v[C]=v[y],v[y]=b}this._i=this._j=0},_doProcessBlock:function(f,p){f[p]^=u.call(this)},keySize:256/32,ivSize:0});function u(){for(var f=this._S,p=this._i,g=this._j,v=0,C=0;C<4;C++){p=(p+1)%256,g=(g+f[p])%256;var y=f[p];f[p]=f[g],f[g]=y,v|=f[(f[p]+f[g])%256]<<24-C*8}return this._i=p,this._j=g,v}r.RC4=o._createHelper(l);var d=a.RC4Drop=l.extend({cfg:l.cfg.extend({drop:192}),_doReset:function(){l._doReset.call(this);for(var f=this.cfg.drop;f>0;f--)u.call(this)}});r.RC4Drop=o._createHelper(d)}(),t.RC4})}($p)),$p.exports}var Jp={exports:{}},TF=Jp.exports,nA;function RF(){return nA||(nA=1,function(n,e){(function(t,r,i){n.exports=r(on(),Dc(),Nc(),Ml(),kr())})(TF,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,a=r.algo,l=[],u=[],d=[],f=a.Rabbit=o.extend({_doReset:function(){for(var g=this._key.words,v=this.cfg.iv,C=0;C<4;C++)g[C]=(g[C]<<8|g[C]>>>24)&16711935|(g[C]<<24|g[C]>>>8)&4278255360;var y=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],x=this._C=[g[2]<<16|g[2]>>>16,g[0]&4294901760|g[1]&65535,g[3]<<16|g[3]>>>16,g[1]&4294901760|g[2]&65535,g[0]<<16|g[0]>>>16,g[2]&4294901760|g[3]&65535,g[1]<<16|g[1]>>>16,g[3]&4294901760|g[0]&65535];this._b=0;for(var C=0;C<4;C++)p.call(this);for(var C=0;C<8;C++)x[C]^=y[C+4&7];if(v){var I=v.words,b=I[0],T=I[1],R=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,P=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,B=R>>>16|P&4294901760,_=P<<16|R&65535;x[0]^=R,x[1]^=B,x[2]^=P,x[3]^=_,x[4]^=R,x[5]^=B,x[6]^=P,x[7]^=_;for(var C=0;C<4;C++)p.call(this)}},_doProcessBlock:function(g,v){var C=this._X;p.call(this),l[0]=C[0]^C[5]>>>16^C[3]<<16,l[1]=C[2]^C[7]>>>16^C[5]<<16,l[2]=C[4]^C[1]>>>16^C[7]<<16,l[3]=C[6]^C[3]>>>16^C[1]<<16;for(var y=0;y<4;y++)l[y]=(l[y]<<8|l[y]>>>24)&16711935|(l[y]<<24|l[y]>>>8)&4278255360,g[v+y]^=l[y]},blockSize:128/32,ivSize:64/32});function p(){for(var g=this._X,v=this._C,C=0;C<8;C++)u[C]=v[C];v[0]=v[0]+1295307597+this._b|0,v[1]=v[1]+3545052371+(v[0]>>>0<u[0]>>>0?1:0)|0,v[2]=v[2]+886263092+(v[1]>>>0<u[1]>>>0?1:0)|0,v[3]=v[3]+1295307597+(v[2]>>>0<u[2]>>>0?1:0)|0,v[4]=v[4]+3545052371+(v[3]>>>0<u[3]>>>0?1:0)|0,v[5]=v[5]+886263092+(v[4]>>>0<u[4]>>>0?1:0)|0,v[6]=v[6]+1295307597+(v[5]>>>0<u[5]>>>0?1:0)|0,v[7]=v[7]+3545052371+(v[6]>>>0<u[6]>>>0?1:0)|0,this._b=v[7]>>>0<u[7]>>>0?1:0;for(var C=0;C<8;C++){var y=g[C]+v[C],x=y&65535,I=y>>>16,b=((x*x>>>17)+x*I>>>15)+I*I,T=((y&4294901760)*y|0)+((y&65535)*y|0);d[C]=b^T}g[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,g[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,g[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,g[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,g[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,g[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,g[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,g[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}r.Rabbit=o._createHelper(f)}(),t.Rabbit})}(Jp)),Jp.exports}var Yp={exports:{}},_F=Yp.exports,rA;function PF(){return rA||(rA=1,function(n,e){(function(t,r,i){n.exports=r(on(),Dc(),Nc(),Ml(),kr())})(_F,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,a=r.algo,l=[],u=[],d=[],f=a.RabbitLegacy=o.extend({_doReset:function(){var g=this._key.words,v=this.cfg.iv,C=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],y=this._C=[g[2]<<16|g[2]>>>16,g[0]&4294901760|g[1]&65535,g[3]<<16|g[3]>>>16,g[1]&4294901760|g[2]&65535,g[0]<<16|g[0]>>>16,g[2]&4294901760|g[3]&65535,g[1]<<16|g[1]>>>16,g[3]&4294901760|g[0]&65535];this._b=0;for(var x=0;x<4;x++)p.call(this);for(var x=0;x<8;x++)y[x]^=C[x+4&7];if(v){var I=v.words,b=I[0],T=I[1],R=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,P=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,B=R>>>16|P&4294901760,_=P<<16|R&65535;y[0]^=R,y[1]^=B,y[2]^=P,y[3]^=_,y[4]^=R,y[5]^=B,y[6]^=P,y[7]^=_;for(var x=0;x<4;x++)p.call(this)}},_doProcessBlock:function(g,v){var C=this._X;p.call(this),l[0]=C[0]^C[5]>>>16^C[3]<<16,l[1]=C[2]^C[7]>>>16^C[5]<<16,l[2]=C[4]^C[1]>>>16^C[7]<<16,l[3]=C[6]^C[3]>>>16^C[1]<<16;for(var y=0;y<4;y++)l[y]=(l[y]<<8|l[y]>>>24)&16711935|(l[y]<<24|l[y]>>>8)&4278255360,g[v+y]^=l[y]},blockSize:128/32,ivSize:64/32});function p(){for(var g=this._X,v=this._C,C=0;C<8;C++)u[C]=v[C];v[0]=v[0]+1295307597+this._b|0,v[1]=v[1]+3545052371+(v[0]>>>0<u[0]>>>0?1:0)|0,v[2]=v[2]+886263092+(v[1]>>>0<u[1]>>>0?1:0)|0,v[3]=v[3]+1295307597+(v[2]>>>0<u[2]>>>0?1:0)|0,v[4]=v[4]+3545052371+(v[3]>>>0<u[3]>>>0?1:0)|0,v[5]=v[5]+886263092+(v[4]>>>0<u[4]>>>0?1:0)|0,v[6]=v[6]+1295307597+(v[5]>>>0<u[5]>>>0?1:0)|0,v[7]=v[7]+3545052371+(v[6]>>>0<u[6]>>>0?1:0)|0,this._b=v[7]>>>0<u[7]>>>0?1:0;for(var C=0;C<8;C++){var y=g[C]+v[C],x=y&65535,I=y>>>16,b=((x*x>>>17)+x*I>>>15)+I*I,T=((y&4294901760)*y|0)+((y&65535)*y|0);d[C]=b^T}g[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,g[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,g[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,g[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,g[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,g[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,g[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,g[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}r.RabbitLegacy=o._createHelper(f)}(),t.RabbitLegacy})}(Yp)),Yp.exports}var qp={exports:{}},DF=qp.exports,iA;function NF(){return iA||(iA=1,function(n,e){(function(t,r,i){n.exports=r(on(),Dc(),Nc(),Ml(),kr())})(DF,function(t){return function(){var r=t,i=r.lib,o=i.BlockCipher,a=r.algo;const l=16,u=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],d=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var f={pbox:[],sbox:[]};function p(x,I){let b=I>>24&255,T=I>>16&255,R=I>>8&255,P=I&255,B=x.sbox[0][b]+x.sbox[1][T];return B=B^x.sbox[2][R],B=B+x.sbox[3][P],B}function g(x,I,b){let T=I,R=b,P;for(let B=0;B<l;++B)T=T^x.pbox[B],R=p(x,T)^R,P=T,T=R,R=P;return P=T,T=R,R=P,R=R^x.pbox[l],T=T^x.pbox[l+1],{left:T,right:R}}function v(x,I,b){let T=I,R=b,P;for(let B=l+1;B>1;--B)T=T^x.pbox[B],R=p(x,T)^R,P=T,T=R,R=P;return P=T,T=R,R=P,R=R^x.pbox[1],T=T^x.pbox[0],{left:T,right:R}}function C(x,I,b){for(let _=0;_<4;_++){x.sbox[_]=[];for(let M=0;M<256;M++)x.sbox[_][M]=d[_][M]}let T=0;for(let _=0;_<l+2;_++)x.pbox[_]=u[_]^I[T],T++,T>=b&&(T=0);let R=0,P=0,B=0;for(let _=0;_<l+2;_+=2)B=g(x,R,P),R=B.left,P=B.right,x.pbox[_]=R,x.pbox[_+1]=P;for(let _=0;_<4;_++)for(let M=0;M<256;M+=2)B=g(x,R,P),R=B.left,P=B.right,x.sbox[_][M]=R,x.sbox[_][M+1]=P;return!0}var y=a.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var x=this._keyPriorReset=this._key,I=x.words,b=x.sigBytes/4;C(f,I,b)}},encryptBlock:function(x,I){var b=g(f,x[I],x[I+1]);x[I]=b.left,x[I+1]=b.right},decryptBlock:function(x,I){var b=v(f,x[I],x[I+1]);x[I]=b.left,x[I+1]=b.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=o._createHelper(y)}(),t.Blowfish})}(qp)),qp.exports}var BF=vp.exports,oA;function OF(){return oA||(oA=1,function(n,e){(function(t,r,i){n.exports=r(on(),Y0(),PO(),NO(),Dc(),FO(),Nc(),Lk(),vy(),GO(),Uk(),zO(),ZO(),KO(),Cy(),YO(),Ml(),kr(),tF(),rF(),oF(),aF(),cF(),dF(),hF(),gF(),vF(),yF(),IF(),AF(),SF(),EF(),RF(),PF(),NF())})(BF,function(t){return t})}(vp)),vp.exports}var FF=OF();const sA=Dl(FF);class lo extends Error{constructor(e,t){super(t),this.code=e,this.name="FileTransferError"}}const ps={CONNECTION_FAILED:"CONNECTION_FAILED",TRANSFER_TIMEOUT:"TRANSFER_TIMEOUT",INVALID_FILE:"INVALID_FILE",DATA_CHANNEL_ERROR:"DATA_CHANNEL_ERROR"};class MF extends z0{constructor(t,r){super();ee(this,"webRTCService");ee(this,"client");ee(this,"gmcpFileTransfer");ee(this,"chunkSize",16384);ee(this,"transferTimeoutInterval");ee(this,"incomingTransfers",new Map);ee(this,"outgoingTransfers",new Map);ee(this,"maxFileSize",100*1024*1024);ee(this,"transferTimeout",3e4);ee(this,"pendingOffers",new Map);this.client=t,this.gmcpFileTransfer=r,this.webRTCService=t.webRTCService,this.setupListeners()}isDataChannelReady(){return this.webRTCService.isDataChannelOpen()}setupListeners(){this.webRTCService.on("dataChannelMessage",this.handleIncomingChunk.bind(this)),this.client.on("fileTransferAccepted",this.handleAcceptedTransfer.bind(this)),this.transferTimeoutInterval=window.setInterval(()=>this.checkTransferTimeouts(),5e3)}async initializeWebRTC(){this.webRTCService.isDataChannelOpen()||await this.webRTCService.createPeerConnection()}async sendFile(t,r){if(t.size>this.maxFileSize)throw new lo(ps.INVALID_FILE,`File size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);const i=await this.computeFileHash(t);console.log(`[FileTransferManager] Computed hash for ${t.name}: ${i}`),console.log(`[FileTransferManager] Registering outgoing transfer for file: ${t.name}`),this.outgoingTransfers.set(i,{file:t,filename:t.name,hash:i,lastActivityTimestamp:Date.now()});try{await this.initializeWebRTC(),this.webRTCService.recipient=r;const o=await this.webRTCService.createOffer();console.log(`[FileTransferManager] Sending offer for file: ${t.name}`),await this.gmcpFileTransfer.sendOffer(r,t.name,t.size,JSON.stringify(o),i),await this.webRTCService.waitForConnection()}catch(o){console.error(`[FileTransferManager] Failed to send file ${t.name}:`,o),this.handleTransferError(i,t.name,"send",o instanceof lo?o:new lo(ps.CONNECTION_FAILED,"Failed to establish connection")),this.cleanupTransfer(i)}}async computeFileHash(t){return new Promise((r,i)=>{const o=new FileReader;o.onload=()=>{if(o.result instanceof ArrayBuffer){const a=sA.lib.WordArray.create(o.result),l=sA.SHA256(a).toString();r(l)}else i(new Error("Failed to read file for hashing"))},o.onerror=()=>i(o.error),o.readAsArrayBuffer(t)})}async startFileTransfer(t,r){let i=0;const o=new FileReader;for(;i<t.size;){const a=t.slice(i,i+this.chunkSize),l=await new Promise((d,f)=>{o.onload=()=>{o.result instanceof ArrayBuffer?d(o.result):f(new lo(ps.INVALID_FILE,"Failed to read file chunk"))},o.onerror=()=>f(new lo(ps.INVALID_FILE,"Error reading file")),o.readAsArrayBuffer(a)});await this.sendChunk(t.name,r,l,i,t.size),i+=l.byteLength;const u={hash:r,filename:t.name,sentBytes:i,totalBytes:t.size};this.emit("fileSendProgress",u)}}async sendChunk(t,r,i,o,a){try{const l={hash:r,filename:t,chunkIndex:Math.floor(o/this.chunkSize),totalChunks:Math.ceil(a/this.chunkSize),chunkSize:i.byteLength,totalSize:a},u=JSON.stringify(l),d=new TextEncoder().encode(u),f=new ArrayBuffer(4);new DataView(f).setUint32(0,d.byteLength,!0);const p=new Uint8Array(4+d.byteLength+i.byteLength);p.set(new Uint8Array(f),0),p.set(d,4),p.set(new Uint8Array(i),4+d.byteLength),await this.webRTCService.sendData(p.buffer)}catch{throw new lo(ps.DATA_CHANNEL_ERROR,"Failed to send chunk")}}async handleAcceptedTransfer(t){console.log("[FileTransferManager] Handling accepted transfer for file transfer request ",t);const{sender:r,hash:i,filename:o,answerSdp:a}=t,l=this.outgoingTransfers.get(i);if(!l){const u=`No outgoing transfer found for hash: ${i} (${o}). Active transfers: ${Array.from(this.outgoingTransfers.keys()).join(", ")}`;console.error(`[FileTransferManager] ${u}`),this.client.onFileTransferError(i,o,"send",u);return}try{console.log(`[FileTransferManager] Processing WebRTC answer for file: ${o}`);const u=JSON.parse(a);console.log(`[FileTransferManager] Answer object for file: ${o}`,u),await this.webRTCService.handleAnswer(u),console.log(`[FileTransferManager] Waiting for data channel to open for file: ${o}`),await this.waitForDataChannel(i),console.log(`[FileTransferManager] Data channel ready for outgoing transfer of: ${o}`),await this.startFileTransfer(l.file,l.hash),console.log(`[FileTransferManager] File transfer completed successfully: ${o}`),this.client.onFileSendComplete(i,o)}catch(u){console.error(`[FileTransferManager] Error in accepted transfer for ${o}:`,u),this.handleTransferError(i,o,"send",u)}finally{console.log(`[FileTransferManager] Cleaning up successful transfer: ${o} (${i})`),this.outgoingTransfers.delete(i)}}async waitForDataChannel(t){return new Promise((r,i)=>{if(this.isDataChannelReady()){r();return}let o=0;const a=50,l=setInterval(()=>{o++,this.isDataChannelReady()?(clearInterval(l),r()):o>=a&&(clearInterval(l),i(new lo(ps.CONNECTION_FAILED,`Data channel failed to open for transfer ${t} after ${o} attempts`)))},100)})}async handleIncomingChunk(t){try{if(t.byteLength<4)throw new Error("Received data is too short to contain header size");const r=new Uint8Array(t.slice(0,4)),i=new DataView(r.buffer).getUint32(0,!0);if(t.byteLength<4+i)throw new Error("Received data is too short to contain header");const o=new TextDecoder().decode(t.slice(4,4+i)),a=JSON.parse(o);if(t.byteLength<4+i+a.chunkSize)throw new Error("Received data is too short to contain chunk data");const l=this.pendingOffers.get(a.hash),u=(l==null?void 0:l.sender)||"unknown";if(typeof a.chunkIndex!="number"||a.chunkIndex<0||a.chunkIndex>=a.totalChunks)throw new Error("Invalid chunk index in header");if(typeof a.totalChunks!="number"||a.totalChunks<=0)throw new Error("Invalid total chunks in header");const d=t.slice(4+i,4+i+a.chunkSize);let f=this.incomingTransfers.get(a.hash);if(!f){if(a.totalSize>this.maxFileSize){this.client.onFileTransferError(a.hash,a.filename,"receive",`Incoming file size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);return}f={hash:a.hash,filename:a.filename,totalSize:a.totalSize,receivedSize:0,chunks:new Array(a.totalChunks),lastActivityTimestamp:Date.now(),sender:u},this.incomingTransfers.set(a.hash,f)}f.chunks[a.chunkIndex]=d,f.receivedSize+=d.byteLength,f.lastActivityTimestamp=Date.now();const p={hash:a.hash,filename:a.filename,receivedBytes:f.receivedSize,totalBytes:f.totalSize};if(this.emit("fileReceiveProgress",p),f.receivedSize===f.totalSize)if(f.chunks.every(g=>g)){const g=new Blob(f.chunks),v=new File([g],f.filename,{type:g.type});if(await this.computeFileHash(v)!==f.hash){this.client.onFileTransferError(f.hash,a.filename,"receive","File integrity check failed - hash mismatch"),this.incomingTransfers.delete(f.hash);return}const y=window.URL.createObjectURL(g),x=document.createElement("a");x.href=y,x.download=a.filename,document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(y);const I={hash:f.hash,filename:a.filename,file:g};this.emit("fileReceiveComplete",I),this.incomingTransfers.delete(f.hash)}else this.client.onFileTransferError(f.hash,a.filename,"receive","Missing chunks in received file")}catch(r){this.handleTransferError("unknown","unknown_file","receive",new lo("UNKNOWN_ERROR",r instanceof Error?r.message:"Unknown error"))}}handleTransferError(t,r,i,o){console.error(`Error ${i}ing file ${r} (${t}):`,o);const a=o instanceof Error?o.message:"Unknown error";this.client.onFileTransferError(t,r,i,a),this.cleanupTransfer(t),this.attemptRecovery(t,r,i)}cleanupTransfer(t){console.log(`[FileTransferManager] Starting cleanup for hash: ${t}`);const r=this.outgoingTransfers.get(t);r&&(console.log(`[FileTransferManager] Cleaning up outgoing transfer for: ${r.filename} (${t})`),this.outgoingTransfers.delete(t));const i=this.incomingTransfers.get(t);if(i&&(console.log(`[FileTransferManager] Cleaning up incoming transfer for: ${i.filename} (${t})`),this.incomingTransfers.delete(t)),this.pendingOffers.has(t)){const o=this.pendingOffers.get(t);console.log(`[FileTransferManager] Removing pending offer for: ${o==null?void 0:o.filename} (${t})`),this.pendingOffers.delete(t)}console.log(`[FileTransferManager] Cleanup complete for hash: ${t}`)}async attemptRecovery(t,r,i){try{if(await this.webRTCService.createPeerConnection(),this.client.onConnectionRecovered({hash:t,filename:r,direction:i}),i==="send"){const o=this.outgoingTransfers.get(t);o&&await this.startFileTransfer(o.file,o.hash)}else if(i==="receive"){const o=this.incomingTransfers.get(t);o&&this.gmcpFileTransfer.sendRequestResend(o.sender,t)}}catch(o){console.error("Failed to recover connection:",o),this.client.onRecoveryFailed({filename:r,direction:i,error:o instanceof Error?o.message:"Unknown error"})}}checkTransferTimeouts(){const t=Date.now();this.incomingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"receive",new lo(ps.TRANSFER_TIMEOUT,"Transfer timeout - no data received"))}),this.outgoingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"send",new lo(ps.TRANSFER_TIMEOUT,"Transfer timeout - no activity"))})}cleanup(){this.transferTimeoutInterval&&(clearInterval(this.transferTimeoutInterval),this.transferTimeoutInterval=void 0),[...this.outgoingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),[...this.incomingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),this.incomingTransfers.clear(),this.outgoingTransfers.clear(),this.pendingOffers.clear(),this.webRTCService.cleanup()}cancelTransfer(t){const r=this.outgoingTransfers.get(t)||this.incomingTransfers.get(t);r?(console.log(`[FileTransferManager] Cancelling transfer for hash: ${t} (${r.filename})`),this.cleanupTransfer(t),this.client.onFileTransferCancel(this.client.worldData.playerId,t),this.gmcpFileTransfer.sendCancel(this.client.worldData.playerId,t)):console.log(`[FileTransferManager] No active transfer found for hash: ${t}`)}async acceptTransfer(t,r){if(console.log("[FileTransferManager] Accepting transfer",t,r),this.incomingTransfers.has(r))throw new Error("Already receiving this file");const i=this.pendingOffers.get(r);if(console.log("[FileTransferManager] Checking pending offers:",Array.from(this.pendingOffers.entries())),!i)throw new lo(ps.INVALID_FILE,`No pending offer found for transfer with hash: ${r}`);console.log("[FileTransferManager] Found pending offer for transfer:",{sender:t,hash:r,filename:i.filename,filesize:i.filesize});try{await this.initializeWebRTC(),this.webRTCService.recipient=t,console.log("[FileTransferManager] Setting remote description with offer"),await this.webRTCService.handleOffer(JSON.parse(i.offerSdp)),console.log("[FileTransferManager] Creating WebRTC answer");const o=await this.webRTCService.createAnswer();if(console.log("[FileTransferManager] WebRTC answer created successfully"),this.pendingOffers.has(r))await this.gmcpFileTransfer.sendAccept(t,r,i.filename,JSON.stringify(o)),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready for incoming transfer"),this.pendingOffers.delete(r);else throw new Error("Transfer was cancelled during setup")}catch(o){throw console.error("Failed to accept transfer:",o),this.cleanupTransfer(r),new lo(ps.CONNECTION_FAILED,`Failed to accept transfer: ${o instanceof Error?o.message:"Unknown error"}`)}}}class LF extends z0{constructor(t,r){super();ee(this,"ws");ee(this,"decoder",new TextDecoder("utf8"));ee(this,"telnet");ee(this,"_connected",!1);ee(this,"intentionalDisconnect",!1);ee(this,"host");ee(this,"port");ee(this,"telnetNegotiation",!1);ee(this,"telnetBuffer","");ee(this,"gmcpHandlers",{});ee(this,"mcpHandlers",{});ee(this,"mcpMultilines",{});ee(this,"mcpAuthKey",null);ee(this,"mcp_negotiate");ee(this,"mcp_getset");ee(this,"gmcp_char");ee(this,"gmcp_fileTransfer");ee(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[],roomPlayers:[]});ee(this,"cacophony");ee(this,"editors");ee(this,"webRTCService");ee(this,"fileTransferManager");ee(this,"currentRoomInfo",null);ee(this,"_autosay",!1);ee(this,"globalMuted",!1);ee(this,"isWindowFocused",!0);this.host=t,this.port=r,this.mcp_negotiate=this.registerMcpPackage(mO),this.mcp_getset=this.registerMcpPackage(yO),this.gmcp_char=this.registerGMCPPackage(vS),this.gmcp_fileTransfer=this.registerGMCPPackage(CS),this.cacophony=new q4,this.cacophony.setGlobalVolume(li.getState().sound.volume),this.editors=new iD(this),this.webRTCService=new AO(this),this.fileTransferManager=new MF(this,this.gmcp_fileTransfer),window.addEventListener("focus",()=>{this.isWindowFocused=!0,this.updateBackgroundMuteState()}),window.addEventListener("blur",()=>{this.isWindowFocused=!1,this.updateBackgroundMuteState()}),li.subscribe(()=>{this.updateBackgroundMuteState()})}get connected(){return this._connected}get autosay(){return this._autosay}set autosay(t){this._autosay=t,this.emit("autosayChanged",t)}async sendFile(t,r){await this.fileTransferManager.sendFile(t,r)}cancelTransfer(t){this.fileTransferManager.cancelTransfer(t)}acceptTransfer(t,r){this.fileTransferManager.acceptTransfer(t,r)}rejectTransfer(t,r){this.gmcp_fileTransfer.sendReject(t,r)}onFileTransferOffer(t,r,i,o,a){console.log("[MudClient] Emitting fileTransferOffer event:",{sender:t,hash:r,filename:i,filesize:o,offerSdp:a}),this.emit("fileTransferOffer",{sender:t,hash:r,filename:i,filesize:o,offerSdp:a})}onFileTransferAccept(t,r,i,o){console.log("[MudClient] Emitting fileTransferAccepted event:",{sender:t,hash:r,filename:i,answerSdp:o}),this.emit("fileTransferAccepted",{sender:t,hash:r,filename:i,answerSdp:o})}onFileTransferReject(t,r){this.emit("fileTransferRejected",{sender:t,hash:r})}onFileTransferCancel(t,r){this.emit("fileTransferCancelled",{sender:t,hash:r})}onFileSendComplete(t,r){this.emit("fileSendComplete",{hash:t,filename:r})}onFileTransferError(t,r,i,o){this.emit("fileTransferError",{hash:t,filename:r,direction:i,error:o})}onConnectionRecovered(t){this.emit("connectionRecovered",t)}onRecoveryFailed(t){this.emit("recoveryFailed",t)}sendFileTransferOffer(t,r,i,o,a){this.gmcp_fileTransfer.sendOffer(t,r,o,a,i)}sendFileTransferAccept(t,r,i,o){this.gmcp_fileTransfer.sendAccept(t,i,r,o)}registerGMCPPackage(t){const r=new t(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(t){const r=new t(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.intentionalDisconnect=!1,this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new eD(new QP(this.ws)),this.ws.onopen=()=>{this._connected=!0,this.emit("connect"),this.emit("connectionChange",!0)},this.telnet.on("data",t=>{this.handleData(t)}),this.telnet.on("negotiation",(t,r)=>{t===ef.WILL&&r===Qd.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(ef.DO,Qd.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):t===ef.DO&&r===Qd.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(ef.WILL,Qd.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(t,r)=>{console.log("GMCP Package:",t,r);try{this.handleGmcpData(t,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.cleanupConnection(),this.intentionalDisconnect||setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=t=>{this.emit("error",t)}}send(t){this.ws.send(t)}cleanupConnection(){this._connected=!1,this.mcpAuthKey=null,this.telnetBuffer="",this.telnetNegotiation=!1,this.currentRoomInfo=null,this.webRTCService.cleanup(),this.fileTransferManager.cleanup(),this.emit("disconnect"),this.emit("connectionChange",!1)}close(){this.intentionalDisconnect=!0,this.ws&&this.ws.close(),this.cleanupConnection()}sendCommand(t){li.getState().general.localEcho&&this.emit("command",t),this.autosay&&!t.startsWith("-")&&!t.startsWith("'")&&(t="say "+t),this.send(t+`\r
`),console.log("> "+t)}handleData(t){const r=this.decoder.decode(t).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(t){if(t.startsWith("#$#*")){const i=bb(t.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(t.startsWith("#$#:")){const i=bb(t.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=gO(t.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=Ab(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(t,r){const i=t.lastIndexOf("."),o=t.substring(0,i),a=t.substring(i+1);console.log("GMCP Message:",o,a,r);const l=this.gmcpHandlers[o];if(!l){console.log("No handler for GMCP package:",o);return}const u=l["handle"+a];if(u){console.log("Calling handler for:",a,u);let d;typeof r=="string"&&r.trim()!==""?d=r:(console.warn(`GMCP message data for ${o}.${a} is missing or empty. Defaulting to {}. Original data:`,r),d="{}");try{const f=JSON.parse(d);u.call(l,f)}catch(f){console.error(`Error parsing GMCP JSON for ${o}.${a}:`,f),console.error("Attempted to parse:",d)}}else console.log("No handler on package:",o,a)}emitMessage(t){const r=li.getState().speech.autoreadMode;r===Qv.All&&this.speak(t),r===Qv.Unfocused&&!document.hasFocus()&&this.speak(t),this.emit("message",t)}sendGmcp(t,r){console.log("Sending GMCP:",t,r),this.telnet.sendGmcp(t,r)}sendMcp(t,r){if(typeof r=="object"){let o="";for(const[a,l]of Object.entries(r))o+=` ${a}: ${l||'""'}`;r=o}const i=`#$#${t} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(t,r,i){this.send(`#$#* ${t} ${r}: ${i}\r
`)}closeMcpML(t){this.send(`#$#: ${t}\r
`)}sendMCPMultiline(t,r,i){const o=Ab();r["_data-tag"]=o,this.sendMcp(t,r);for(const a of i)this.sendMcpMLLine(o,"content",a);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(t=>{t.shutdown()}),Object.values(this.gmcpHandlers).forEach(t=>{t.shutdown()}),this.editors.shutdown(),this.webRTCService.cleanup(),this.fileTransferManager.cleanup()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(t,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(t,{body:r})}speak(t){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(rD(t));r.lang="en-US";const{rate:i,pitch:o,voice:a,volume:l}=li.getState().speech;r.rate=i,r.pitch=o,r.volume=l;const d=speechSynthesis.getVoices().find(f=>f.name===a);d&&(r.voice=d),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}updateBackgroundMuteState(){const r=li.getState().sound.muteInBackground&&!this.isWindowFocused;this.cacophony.muted=this.globalMuted||r}setGlobalMute(t){this.globalMuted=t,this.updateBackgroundMuteState()}}class UF{constructor(){ee(this,"history",[]);ee(this,"currentIndex",-1);ee(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&this.history.push(e.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(e){return this.currentIndex===-1&&(this.unsentInput=e),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(e){return this.currentIndex===-1&&(this.unsentInput=e),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}getHistory(){return[...this.history]}}const VF=()=>{const[,n]=N.useReducer(e=>e+1,0);return N.useEffect(()=>Cu.subscribe(n),[]),[Cu.getState(),Cu.dispatch]},aA="command_history",GF=1e3,Xm=n=>n.includes(" ")?`"${n}"`:n,Km=n=>{if(n.startsWith('"'))return{leadingPunctuation:"",namePart:n.substring(1)};{const e=n.match(/^([^\w\s"]+)(.*)$/);return e?{leadingPunctuation:e[1],namePart:e[2]}:{leadingPunctuation:"",namePart:n}}},WF=({onSend:n,inputRef:e,client:t})=>{const r=N.useRef(new UF),[i,o]=VF(),a=N.useRef([]),l=N.useRef(0),u=N.useRef(null);N.useEffect(()=>{const v=localStorage.getItem(aA);v&&JSON.parse(v).forEach(y=>{r.current.addCommand(y)})},[]);const d=()=>{try{const C=r.current.getHistory().slice(-GF);localStorage.setItem(aA,JSON.stringify(C))}catch(v){console.warn("Failed to save command history:",v)}},f=N.useCallback(()=>{a.current=[],l.current=0,u.current=null},[]),p=N.useCallback(()=>{var C;const v=i.text;v.trim()&&(n(v),r.current.addCommand(v),d(),JD(),(C=e.current)==null||C.focus(),f())},[i.text,n,e,f]),g=N.useCallback(v=>{const C=r.current,y=i.text,x=e.current;if(v.key==="Tab"){if(!x)return;if(y===""){f();return}v.preventDefault();const I=x.selectionStart,b=y.substring(0,I),T=b.match(/(?:[^"\s]\S*|"[^"]*"?)$/),R=T?T[0]:"",P=T?b.lastIndexOf(R):-1;if(R===""&&u.current===null){f();return}let B=!1;if(u.current!==null&&a.current.length>0){const _=a.current[l.current],{leadingPunctuation:M}=Km(u.current),H=M+Xm(_.name);B=R===H}if(B){l.current=(l.current+1)%a.current.length;const _=a.current[l.current],{leadingPunctuation:M}=Km(u.current),H=Xm(_.name),V=M+H,U=y.substring(0,P)+V+y.substring(I);cc(U);const Z=P+V.length;requestAnimationFrame(()=>x.setSelectionRange(Z,Z))}else{f();const{leadingPunctuation:_,namePart:M}=Km(R);if(M==="")return;const V=(t.worldData.roomPlayers||[]).filter(U=>{const Z=typeof U.name=="string"&&U.name.toLowerCase().startsWith(M.toLowerCase()),ie=(typeof U.fullname=="string"?U.fullname.toLowerCase().split(" "):[]).some(le=>le.startsWith(M.toLowerCase()));return Z||ie}).sort((U,Z)=>{const q=U.name.localeCompare(Z.name);return q!==0?q:U.fullname.localeCompare(Z.fullname)});if(V.length>0){u.current=R,a.current=V,l.current=0;const U=V[0],Z=Xm(U.name),q=_+Z,ie=y.substring(0,P)+q+y.substring(I);cc(ie);const le=P+q.length;requestAnimationFrame(()=>x.setSelectionRange(le,le))}}}else if(v.key==="Enter"&&!v.shiftKey)v.preventDefault(),p();else if(v.key==="ArrowUp"){v.preventDefault();const I=C.navigateUp(y);cc(I),f()}else if(v.key==="ArrowDown"){v.preventDefault();const I=C.navigateDown(y);cc(I),f()}else(v.key.length===1||v.key==="Backspace"||v.key==="Delete")&&f()},[i.text,t,e,n,f,p]);return oe.jsxs("div",{className:"command-input-container",children:[oe.jsx("textarea",{value:i.text,onChange:v=>{cc(v.target.value),f()},onKeyDown:g,id:"command-input",ref:e,autoFocus:!0}),oe.jsx("button",{onClick:p,className:"send-button",children:"Send"})]})},Vk=7e3;let gs=null;function lA(n,e="assertive",t=Vk){gs?gs.announce(n,e,t):(gs=new jF,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?gs.announce(n,e,t):setTimeout(()=>{gs!=null&&gs.isAttached()&&(gs==null||gs.announce(n,e,t))},100))}class jF{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let t=document.createElement("div");return t.setAttribute("role","log"),t.setAttribute("aria-live",e),t.setAttribute("aria-relevant","additions"),t}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,t="assertive",r=Vk){var i,o;if(!this.node)return;let a=document.createElement("div");typeof e=="object"?(a.setAttribute("role","img"),a.setAttribute("aria-labelledby",e["aria-labelledby"])):a.textContent=e,t==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(a):(o=this.politeLog)===null||o===void 0||o.appendChild(a),e!==""&&setTimeout(()=>{a.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var $m,cA;function zF(){if(cA)return $m;cA=1;var n=function(){function o(a,l){for(var u=0;u<l.length;u++){var d=l[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(a,l,u){return l&&o(a.prototype,l),u&&o(a,u),a}}();function e(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}var t=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],r=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,i=function(){n(o,null,[{key:"escapeForHtml",value:function(l){return new o().escapeForHtml(l)}},{key:"linkify",value:function(l){return new o().linkify(l)}},{key:"ansiToHtml",value:function(l,u){return new o().ansiToHtml(l,u)}},{key:"ansiToJson",value:function(l,u){return new o().ansiToJson(l,u)}},{key:"ansiToText",value:function(l){return new o().ansiToText(l)}}]);function o(){e(this,o),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return n(o,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var l=0;l<2;++l)for(var u=0;u<8;++u)this.PALETTE_COLORS.push(t[l][u].color);for(var d=[0,95,135,175,215,255],f=function(I,b,T){return d[I]+", "+d[b]+", "+d[T]},p=0;p<6;++p)for(var g=0;g<6;++g)for(var v=0;v<6;++v)this.PALETTE_COLORS.push(f(p,g,v));for(var C=8,y=0;y<24;++y,C+=10)this.PALETTE_COLORS.push(f(C,C,C))}},{key:"escapeForHtml",value:function(l){return l.replace(/[&<>\"]/gm,function(u){return u=="&"?"&amp;":u=='"'?"&quot;":u=="<"?"&lt;":u==">"?"&gt;":""})}},{key:"linkify",value:function(l){return l.replace(r,function(u){return'<a href="'+u+'">'+u+"</a>"})}},{key:"ansiToHtml",value:function(l,u){return this.process(l,u,!0)}},{key:"ansiToJson",value:function(l,u){return u=u||{},u.json=!0,u.clearLine=!1,this.process(l,u,!0)}},{key:"ansiToText",value:function(l){return this.process(l,{},!1)}},{key:"process",value:function(l,u,d){var f=this,p=this,g=l.split(/\033\[/),v=g.shift();u==null&&(u={}),u.clearLine=/\r/.test(l);var C=g.map(function(x){return f.processChunk(x,u,d)});if(u&&u.json){var y=p.processChunkJson("");return y.content=v,y.clearLine=u.clearLine,C.unshift(y),u.remove_empty&&(C=C.filter(function(x){return!x.isEmpty()})),C}else C.unshift(v);return C.join("")}},{key:"processChunkJson",value:function(l,u,d){u=typeof u>"u"?{}:u;var f=u.use_classes=typeof u.use_classes<"u"&&u.use_classes,p=u.key=f?"class":"color",g={content:l,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:u.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!g.content}},v=l.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!v)return g;g.content=v[4];var C=v[2].split(";");if(v[1]!==""||v[3]!=="m"||!d)return g;for(var y=this;C.length>0;){var x=C.shift(),I=parseInt(x);if(isNaN(I)||I===0)y.fg=y.bg=null,y.decorations=[];else if(I===1)y.decorations.push("bold");else if(I===2)y.decorations.push("dim");else if(I===3)y.decorations.push("italic");else if(I===4)y.decorations.push("underline");else if(I===5)y.decorations.push("blink");else if(I===7)y.decorations.push("reverse");else if(I===8)y.decorations.push("hidden");else if(I===9)y.decorations.push("strikethrough");else if(I===21)y.removeDecoration("bold");else if(I===22)y.removeDecoration("bold"),y.removeDecoration("dim");else if(I===23)y.removeDecoration("italic");else if(I===24)y.removeDecoration("underline");else if(I===25)y.removeDecoration("blink");else if(I===27)y.removeDecoration("reverse");else if(I===28)y.removeDecoration("hidden");else if(I===29)y.removeDecoration("strikethrough");else if(I===39)y.fg=null;else if(I===49)y.bg=null;else if(I>=30&&I<38)y.fg=t[0][I%10][p];else if(I>=90&&I<98)y.fg=t[1][I%10][p];else if(I>=40&&I<48)y.bg=t[0][I%10][p];else if(I>=100&&I<108)y.bg=t[1][I%10][p];else if(I===38||I===48){var b=I===38;if(C.length>=1){var T=C.shift();if(T==="5"&&C.length>=1){var R=parseInt(C.shift());if(R>=0&&R<=255)if(!f)this.PALETTE_COLORS||y.setupPalette(),b?y.fg=this.PALETTE_COLORS[R]:y.bg=this.PALETTE_COLORS[R];else{var P=R>=16?"ansi-palette-"+R:t[R>7?1:0][R%8].class;b?y.fg=P:y.bg=P}}else if(T==="2"&&C.length>=3){var B=parseInt(C.shift()),_=parseInt(C.shift()),M=parseInt(C.shift());if(B>=0&&B<=255&&_>=0&&_<=255&&M>=0&&M<=255){var H=B+", "+_+", "+M;f?b?(y.fg="ansi-truecolor",y.fg_truecolor=H):(y.bg="ansi-truecolor",y.bg_truecolor=H):b?y.fg=H:y.bg=H}}}}}return y.fg===null&&y.bg===null&&y.decorations.length===0||(g.fg=y.fg,g.bg=y.bg,g.fg_truecolor=y.fg_truecolor,g.bg_truecolor=y.bg_truecolor,g.decorations=y.decorations,g.decoration=y.decorations.slice(-1).pop()||null,g.was_processed=!0),g}},{key:"processChunk",value:function(l,u,d){var f=this;u=u||{};var p=this.processChunkJson(l,u,d),g=u.use_classes;if(p.decorations=p.decorations.filter(function(b){if(b==="reverse"){p.fg||(p.fg=t[0][7][g?"class":"color"]),p.bg||(p.bg=t[0][0][g?"class":"color"]);var T=p.fg;p.fg=p.bg,p.bg=T;var R=p.fg_truecolor;return p.fg_truecolor=p.bg_truecolor,p.bg_truecolor=R,p.isInverted=!0,!1}return!0}),u.json)return p;if(p.isEmpty())return"";if(!p.was_processed)return p.content;var v=[],C=[],y=[],x={},I=function(T){var R=[],P=void 0;for(P in T)T.hasOwnProperty(P)&&R.push("data-"+P+'="'+f.escapeForHtml(T[P])+'"');return R.length>0?" "+R.join(" "):""};return p.isInverted&&(x["ansi-is-inverted"]="true"),p.fg&&(g?(v.push(p.fg+"-fg"),p.fg_truecolor!==null&&(x["ansi-truecolor-fg"]=p.fg_truecolor,p.fg_truecolor=null)):v.push("color:rgb("+p.fg+")")),p.bg&&(g?(v.push(p.bg+"-bg"),p.bg_truecolor!==null&&(x["ansi-truecolor-bg"]=p.bg_truecolor,p.bg_truecolor=null)):v.push("background-color:rgb("+p.bg+")")),p.decorations.forEach(function(b){if(g){C.push("ansi-"+b);return}b==="bold"?C.push("font-weight:bold"):b==="dim"?C.push("opacity:0.5"):b==="italic"?C.push("font-style:italic"):b==="hidden"?C.push("visibility:hidden"):b==="strikethrough"?y.push("line-through"):y.push(b)}),y.length&&C.push("text-decoration:"+y.join(" ")),g?'<span class="'+v.concat(C).join(" ")+'"'+I(x)+">"+p.content+"</span>":'<span style="'+v.concat(C).join(";")+'"'+I(x)+">"+p.content+"</span>"}},{key:"removeDecoration",value:function(l){var u=this.decorations.indexOf(l);u>=0&&this.decorations.splice(u,1)}}]),o}();return $m=i,$m}var HF=zF();const ZF=Dl(HF);function XF(n,e){let t=[];for(const r of n.split(`\r
`)){const i=ZF.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const a of i){const l=YF(a,e);o=[...o,...l]}t=[...t,oe.jsx("span",{children:o},t.length)]}return t}const KF=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,$F=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,JF=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function YF(n,e){const t=qF(n),r=[];let i=0,o=0;function a(f,p){let g;for(;(g=f.exec(n.content))!==null;){const v=g.index;v>i&&r.push(n.content.substring(i,v)),r.push(p(g)),i=f.lastIndex}}function l(f){const[,p,g]=f,v=g;return oe.jsxs(oe.Fragment,{children:[p,oe.jsx("a",{href:v,target:"_blank",rel:"noreferrer",children:g})]})}function u(f){const p=f.groups.name,g=`mailto:${p}`;return oe.jsxs(oe.Fragment,{children:[f.groups.slorp1,oe.jsx("a",{href:g,target:"_blank",rel:"noreferrer",children:p}),f.groups.slorp2]})}function d(f){const[,p,g]=f;return oe.jsx("a",{onClick:()=>e(p),className:"exit",children:g})}return a(KF,l),a($F,u),a(JF,d),i<n.content.length&&r.push(n.content.substring(i)),r.map(f=>oe.jsx("span",{style:t,children:f},o++))}function qF(n){const e={};switch(n.bg&&(e.backgroundColor=`rgb(${n.bg})`),n.fg&&(e.color=`rgb(${n.fg})`),n.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var dl={},oc={},uA;function QF(){if(uA)return oc;uA=1;var n=Df();function e(w){for(var F="https://reactjs.org/docs/error-decoder.html?invariant="+w,z=1;z<arguments.length;z++)F+="&args[]="+encodeURIComponent(arguments[z]);return"Minified React error #"+w+"; visit "+F+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=Object.prototype.hasOwnProperty,r=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i={},o={};function a(w){return t.call(o,w)?!0:t.call(i,w)?!1:r.test(w)?o[w]=!0:(i[w]=!0,!1)}function l(w,F,z,Y,Ae,me,Pe){this.acceptsBooleans=F===2||F===3||F===4,this.attributeName=Y,this.attributeNamespace=Ae,this.mustUseProperty=z,this.propertyName=w,this.type=F,this.sanitizeURL=me,this.removeEmptyString=Pe}var u={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(w){u[w]=new l(w,0,!1,w,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(w){var F=w[0];u[F]=new l(F,1,!1,w[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(w){u[w]=new l(w,2,!1,w.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(w){u[w]=new l(w,2,!1,w,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(w){u[w]=new l(w,3,!1,w.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(w){u[w]=new l(w,3,!0,w,null,!1,!1)}),["capture","download"].forEach(function(w){u[w]=new l(w,4,!1,w,null,!1,!1)}),["cols","rows","size","span"].forEach(function(w){u[w]=new l(w,6,!1,w,null,!1,!1)}),["rowSpan","start"].forEach(function(w){u[w]=new l(w,5,!1,w.toLowerCase(),null,!1,!1)});var d=/[\-:]([a-z])/g;function f(w){return w[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(w){var F=w.replace(d,f);u[F]=new l(F,1,!1,w,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(w){var F=w.replace(d,f);u[F]=new l(F,1,!1,w,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(w){var F=w.replace(d,f);u[F]=new l(F,1,!1,w,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(w){u[w]=new l(w,1,!1,w.toLowerCase(),null,!1,!1)}),u.xlinkHref=new l("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(w){u[w]=new l(w,1,!1,w.toLowerCase(),null,!0,!0)});var p={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},g=["Webkit","ms","Moz","O"];Object.keys(p).forEach(function(w){g.forEach(function(F){F=F+w.charAt(0).toUpperCase()+w.substring(1),p[F]=p[w]})});var v=/["'&<>]/;function C(w){if(typeof w=="boolean"||typeof w=="number")return""+w;w=""+w;var F=v.exec(w);if(F){var z="",Y,Ae=0;for(Y=F.index;Y<w.length;Y++){switch(w.charCodeAt(Y)){case 34:F="&quot;";break;case 38:F="&amp;";break;case 39:F="&#x27;";break;case 60:F="&lt;";break;case 62:F="&gt;";break;default:continue}Ae!==Y&&(z+=w.substring(Ae,Y)),Ae=Y+1,z+=F}w=Ae!==Y?z+w.substring(Ae,Y):z}return w}var y=/([A-Z])/g,x=/^ms-/,I=Array.isArray;function b(w,F){return{insertionMode:w,selectedValue:F}}function T(w,F,z){switch(F){case"select":return b(1,z.value!=null?z.value:z.defaultValue);case"svg":return b(2,null);case"math":return b(3,null);case"foreignObject":return b(1,null);case"table":return b(4,null);case"thead":case"tbody":case"tfoot":return b(5,null);case"colgroup":return b(7,null);case"tr":return b(6,null)}return 4<=w.insertionMode||w.insertionMode===0?b(1,null):w}var R=new Map;function P(w,F,z){if(typeof z!="object")throw Error(e(62));F=!0;for(var Y in z)if(t.call(z,Y)){var Ae=z[Y];if(Ae!=null&&typeof Ae!="boolean"&&Ae!==""){if(Y.indexOf("--")===0){var me=C(Y);Ae=C((""+Ae).trim())}else{me=Y;var Pe=R.get(me);Pe!==void 0||(Pe=C(me.replace(y,"-$1").toLowerCase().replace(x,"-ms-")),R.set(me,Pe)),me=Pe,Ae=typeof Ae=="number"?Ae===0||t.call(p,Y)?""+Ae:Ae+"px":C((""+Ae).trim())}F?(F=!1,w.push(' style="',me,":",Ae)):w.push(";",me,":",Ae)}}F||w.push('"')}function B(w,F,z,Y){switch(z){case"style":P(w,F,Y);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<z.length)||z[0]!=="o"&&z[0]!=="O"||z[1]!=="n"&&z[1]!=="N"){if(F=u.hasOwnProperty(z)?u[z]:null,F!==null){switch(typeof Y){case"function":case"symbol":return;case"boolean":if(!F.acceptsBooleans)return}switch(z=F.attributeName,F.type){case 3:Y&&w.push(" ",z,'=""');break;case 4:Y===!0?w.push(" ",z,'=""'):Y!==!1&&w.push(" ",z,'="',C(Y),'"');break;case 5:isNaN(Y)||w.push(" ",z,'="',C(Y),'"');break;case 6:!isNaN(Y)&&1<=Y&&w.push(" ",z,'="',C(Y),'"');break;default:F.sanitizeURL&&(Y=""+Y),w.push(" ",z,'="',C(Y),'"')}}else if(a(z)){switch(typeof Y){case"function":case"symbol":return;case"boolean":if(F=z.toLowerCase().slice(0,5),F!=="data-"&&F!=="aria-")return}w.push(" ",z,'="',C(Y),'"')}}}function _(w,F,z){if(F!=null){if(z!=null)throw Error(e(60));if(typeof F!="object"||!("__html"in F))throw Error(e(61));F=F.__html,F!=null&&w.push(""+F)}}function M(w){var F="";return n.Children.forEach(w,function(z){z!=null&&(F+=z)}),F}function H(w,F,z,Y){w.push(Z(z));var Ae=z=null,me;for(me in F)if(t.call(F,me)){var Pe=F[me];if(Pe!=null)switch(me){case"children":z=Pe;break;case"dangerouslySetInnerHTML":Ae=Pe;break;default:B(w,Y,me,Pe)}}return w.push(">"),_(w,Ae,z),typeof z=="string"?(w.push(C(z)),null):z}var V=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,U=new Map;function Z(w){var F=U.get(w);if(F===void 0){if(!V.test(w))throw Error(e(65,w));F="<"+w,U.set(w,F)}return F}function q(w,F,z,Y,Ae){switch(F){case"select":w.push(Z("select"));var me=null,Pe=null;for(Vt in z)if(t.call(z,Vt)){var Ke=z[Vt];if(Ke!=null)switch(Vt){case"children":me=Ke;break;case"dangerouslySetInnerHTML":Pe=Ke;break;case"defaultValue":case"value":break;default:B(w,Y,Vt,Ke)}}return w.push(">"),_(w,Pe,me),me;case"option":Pe=Ae.selectedValue,w.push(Z("option"));var qe=Ke=null,_t=null,Vt=null;for(me in z)if(t.call(z,me)){var bn=z[me];if(bn!=null)switch(me){case"children":Ke=bn;break;case"selected":_t=bn;break;case"dangerouslySetInnerHTML":Vt=bn;break;case"value":qe=bn;default:B(w,Y,me,bn)}}if(Pe!=null)if(z=qe!==null?""+qe:M(Ke),I(Pe)){for(Y=0;Y<Pe.length;Y++)if(""+Pe[Y]===z){w.push(' selected=""');break}}else""+Pe===z&&w.push(' selected=""');else _t&&w.push(' selected=""');return w.push(">"),_(w,Vt,Ke),Ke;case"textarea":w.push(Z("textarea")),Vt=Pe=me=null;for(Ke in z)if(t.call(z,Ke)&&(qe=z[Ke],qe!=null))switch(Ke){case"children":Vt=qe;break;case"value":me=qe;break;case"defaultValue":Pe=qe;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:B(w,Y,Ke,qe)}if(me===null&&Pe!==null&&(me=Pe),w.push(">"),Vt!=null){if(me!=null)throw Error(e(92));if(I(Vt)&&1<Vt.length)throw Error(e(93));me=""+Vt}return typeof me=="string"&&me[0]===`
`&&w.push(`
`),me!==null&&w.push(C(""+me)),null;case"input":w.push(Z("input")),qe=Vt=Ke=me=null;for(Pe in z)if(t.call(z,Pe)&&(_t=z[Pe],_t!=null))switch(Pe){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":qe=_t;break;case"defaultValue":Ke=_t;break;case"checked":Vt=_t;break;case"value":me=_t;break;default:B(w,Y,Pe,_t)}return Vt!==null?B(w,Y,"checked",Vt):qe!==null&&B(w,Y,"checked",qe),me!==null?B(w,Y,"value",me):Ke!==null&&B(w,Y,"value",Ke),w.push("/>"),null;case"menuitem":w.push(Z("menuitem"));for(var Ci in z)if(t.call(z,Ci)&&(me=z[Ci],me!=null))switch(Ci){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:B(w,Y,Ci,me)}return w.push(">"),null;case"title":w.push(Z("title")),me=null;for(bn in z)if(t.call(z,bn)&&(Pe=z[bn],Pe!=null))switch(bn){case"children":me=Pe;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:B(w,Y,bn,Pe)}return w.push(">"),me;case"listing":case"pre":w.push(Z(F)),Pe=me=null;for(qe in z)if(t.call(z,qe)&&(Ke=z[qe],Ke!=null))switch(qe){case"children":me=Ke;break;case"dangerouslySetInnerHTML":Pe=Ke;break;default:B(w,Y,qe,Ke)}if(w.push(">"),Pe!=null){if(me!=null)throw Error(e(60));if(typeof Pe!="object"||!("__html"in Pe))throw Error(e(61));z=Pe.__html,z!=null&&(typeof z=="string"&&0<z.length&&z[0]===`
`?w.push(`
`,z):w.push(""+z))}return typeof me=="string"&&me[0]===`
`&&w.push(`
`),me;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":w.push(Z(F));for(var yi in z)if(t.call(z,yi)&&(me=z[yi],me!=null))switch(yi){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,F));default:B(w,Y,yi,me)}return w.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return H(w,z,F,Y);case"html":return Ae.insertionMode===0&&w.push("<!DOCTYPE html>"),H(w,z,F,Y);default:if(F.indexOf("-")===-1&&typeof z.is!="string")return H(w,z,F,Y);w.push(Z(F)),Pe=me=null;for(_t in z)if(t.call(z,_t)&&(Ke=z[_t],Ke!=null))switch(_t){case"children":me=Ke;break;case"dangerouslySetInnerHTML":Pe=Ke;break;case"style":P(w,Y,Ke);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:a(_t)&&typeof Ke!="function"&&typeof Ke!="symbol"&&w.push(" ",_t,'="',C(Ke),'"')}return w.push(">"),_(w,Pe,me),me}}function ie(w,F,z){if(w.push('<!--$?--><template id="'),z===null)throw Error(e(395));return w.push(z),w.push('"></template>')}function le(w,F,z,Y){switch(z.insertionMode){case 0:case 1:return w.push('<div hidden id="'),w.push(F.segmentPrefix),F=Y.toString(16),w.push(F),w.push('">');case 2:return w.push('<svg aria-hidden="true" style="display:none" id="'),w.push(F.segmentPrefix),F=Y.toString(16),w.push(F),w.push('">');case 3:return w.push('<math aria-hidden="true" style="display:none" id="'),w.push(F.segmentPrefix),F=Y.toString(16),w.push(F),w.push('">');case 4:return w.push('<table hidden id="'),w.push(F.segmentPrefix),F=Y.toString(16),w.push(F),w.push('">');case 5:return w.push('<table hidden><tbody id="'),w.push(F.segmentPrefix),F=Y.toString(16),w.push(F),w.push('">');case 6:return w.push('<table hidden><tr id="'),w.push(F.segmentPrefix),F=Y.toString(16),w.push(F),w.push('">');case 7:return w.push('<table hidden><colgroup id="'),w.push(F.segmentPrefix),F=Y.toString(16),w.push(F),w.push('">');default:throw Error(e(397))}}function Ce(w,F){switch(F.insertionMode){case 0:case 1:return w.push("</div>");case 2:return w.push("</svg>");case 3:return w.push("</math>");case 4:return w.push("</table>");case 5:return w.push("</tbody></table>");case 6:return w.push("</tr></table>");case 7:return w.push("</colgroup></table>");default:throw Error(e(397))}}var Re=/[<\u2028\u2029]/g;function de(w){return JSON.stringify(w).replace(Re,function(F){switch(F){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function pe(w,F){return F=F===void 0?"":F,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:F+"P:",segmentPrefix:F+"S:",boundaryPrefix:F+"B:",idPrefix:F,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:w}}function be(w,F,z,Y){return z.generateStaticMarkup?(w.push(C(F)),!1):(F===""?w=Y:(Y&&w.push("<!-- -->"),w.push(C(F)),w=!0),w)}var L=Object.assign,K=Symbol.for("react.element"),ue=Symbol.for("react.portal"),he=Symbol.for("react.fragment"),Ee=Symbol.for("react.strict_mode"),Fe=Symbol.for("react.profiler"),Je=Symbol.for("react.provider"),Te=Symbol.for("react.context"),ft=Symbol.for("react.forward_ref"),Nt=Symbol.for("react.suspense"),rn=Symbol.for("react.suspense_list"),Rt=Symbol.for("react.memo"),yt=Symbol.for("react.lazy"),Pt=Symbol.for("react.scope"),He=Symbol.for("react.debug_trace_mode"),$e=Symbol.for("react.legacy_hidden"),bt=Symbol.for("react.default_value"),xt=Symbol.iterator;function ct(w){if(w==null)return null;if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w;switch(w){case he:return"Fragment";case ue:return"Portal";case Fe:return"Profiler";case Ee:return"StrictMode";case Nt:return"Suspense";case rn:return"SuspenseList"}if(typeof w=="object")switch(w.$$typeof){case Te:return(w.displayName||"Context")+".Consumer";case Je:return(w._context.displayName||"Context")+".Provider";case ft:var F=w.render;return w=w.displayName,w||(w=F.displayName||F.name||"",w=w!==""?"ForwardRef("+w+")":"ForwardRef"),w;case Rt:return F=w.displayName||null,F!==null?F:ct(w.type)||"Memo";case yt:F=w._payload,w=w._init;try{return ct(w(F))}catch{}}return null}var At={};function Ut(w,F){if(w=w.contextTypes,!w)return At;var z={},Y;for(Y in w)z[Y]=F[Y];return z}var kt=null;function jt(w,F){if(w!==F){w.context._currentValue2=w.parentValue,w=w.parent;var z=F.parent;if(w===null){if(z!==null)throw Error(e(401))}else{if(z===null)throw Error(e(401));jt(w,z)}F.context._currentValue2=F.value}}function fn(w){w.context._currentValue2=w.parentValue,w=w.parent,w!==null&&fn(w)}function sn(w){var F=w.parent;F!==null&&sn(F),w.context._currentValue2=w.value}function yn(w,F){if(w.context._currentValue2=w.parentValue,w=w.parent,w===null)throw Error(e(402));w.depth===F.depth?jt(w,F):yn(w,F)}function W(w,F){var z=F.parent;if(z===null)throw Error(e(402));w.depth===z.depth?jt(w,z):W(w,z),F.context._currentValue2=F.value}function k(w){var F=kt;F!==w&&(F===null?sn(w):w===null?fn(F):F.depth===w.depth?jt(F,w):F.depth>w.depth?yn(F,w):W(F,w),kt=w)}var D={isMounted:function(){return!1},enqueueSetState:function(w,F){w=w._reactInternals,w.queue!==null&&w.queue.push(F)},enqueueReplaceState:function(w,F){w=w._reactInternals,w.replace=!0,w.queue=[F]},enqueueForceUpdate:function(){}};function X(w,F,z,Y){var Ae=w.state!==void 0?w.state:null;w.updater=D,w.props=z,w.state=Ae;var me={queue:[],replace:!1};w._reactInternals=me;var Pe=F.contextType;if(w.context=typeof Pe=="object"&&Pe!==null?Pe._currentValue2:Y,Pe=F.getDerivedStateFromProps,typeof Pe=="function"&&(Pe=Pe(z,Ae),Ae=Pe==null?Ae:L({},Ae,Pe),w.state=Ae),typeof F.getDerivedStateFromProps!="function"&&typeof w.getSnapshotBeforeUpdate!="function"&&(typeof w.UNSAFE_componentWillMount=="function"||typeof w.componentWillMount=="function"))if(F=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),F!==w.state&&D.enqueueReplaceState(w,w.state,null),me.queue!==null&&0<me.queue.length)if(F=me.queue,Pe=me.replace,me.queue=null,me.replace=!1,Pe&&F.length===1)w.state=F[0];else{for(me=Pe?F[0]:w.state,Ae=!0,Pe=Pe?1:0;Pe<F.length;Pe++){var Ke=F[Pe];Ke=typeof Ke=="function"?Ke.call(w,me,z,Y):Ke,Ke!=null&&(Ae?(Ae=!1,me=L({},me,Ke)):L(me,Ke))}w.state=me}else me.queue=null}var se={id:1,overflow:""};function xe(w,F,z){var Y=w.id;w=w.overflow;var Ae=32-_e(Y)-1;Y&=~(1<<Ae),z+=1;var me=32-_e(F)+Ae;if(30<me){var Pe=Ae-Ae%5;return me=(Y&(1<<Pe)-1).toString(32),Y>>=Pe,Ae-=Pe,{id:1<<32-_e(F)+Ae|z<<Ae|Y,overflow:me+w}}return{id:1<<me|z<<Ae|Y,overflow:w}}var _e=Math.clz32?Math.clz32:Xt,mt=Math.log,Zt=Math.LN2;function Xt(w){return w>>>=0,w===0?32:31-(mt(w)/Zt|0)|0}function Yt(w,F){return w===F&&(w!==0||1/w===1/F)||w!==w&&F!==F}var zt=typeof Object.is=="function"?Object.is:Yt,xn=null,ir=null,qn=null,Bt=null,Mr=!1,Lr=!1,an=0,Rn=null,Cr=0;function zn(){if(xn===null)throw Error(e(321));return xn}function Ur(){if(0<Cr)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function yr(){return Bt===null?qn===null?(Mr=!1,qn=Bt=Ur()):(Mr=!0,Bt=qn):Bt.next===null?(Mr=!1,Bt=Bt.next=Ur()):(Mr=!0,Bt=Bt.next),Bt}function re(){ir=xn=null,Lr=!1,qn=null,Cr=0,Bt=Rn=null}function ce(w,F){return typeof F=="function"?F(w):F}function ve(w,F,z){if(xn=zn(),Bt=yr(),Mr){var Y=Bt.queue;if(F=Y.dispatch,Rn!==null&&(z=Rn.get(Y),z!==void 0)){Rn.delete(Y),Y=Bt.memoizedState;do Y=w(Y,z.action),z=z.next;while(z!==null);return Bt.memoizedState=Y,[Y,F]}return[Bt.memoizedState,F]}return w=w===ce?typeof F=="function"?F():F:z!==void 0?z(F):F,Bt.memoizedState=w,w=Bt.queue={last:null,dispatch:null},w=w.dispatch=Ze.bind(null,xn,w),[Bt.memoizedState,w]}function Oe(w,F){if(xn=zn(),Bt=yr(),F=F===void 0?null:F,Bt!==null){var z=Bt.memoizedState;if(z!==null&&F!==null){var Y=z[1];e:if(Y===null)Y=!1;else{for(var Ae=0;Ae<Y.length&&Ae<F.length;Ae++)if(!zt(F[Ae],Y[Ae])){Y=!1;break e}Y=!0}if(Y)return z[0]}}return w=w(),Bt.memoizedState=[w,F],w}function Ze(w,F,z){if(25<=Cr)throw Error(e(301));if(w===xn)if(Lr=!0,w={action:z,next:null},Rn===null&&(Rn=new Map),z=Rn.get(F),z===void 0)Rn.set(F,w);else{for(F=z;F.next!==null;)F=F.next;F.next=w}}function st(){throw Error(e(394))}function gt(){}var nt={readContext:function(w){return w._currentValue2},useContext:function(w){return zn(),w._currentValue2},useMemo:Oe,useReducer:ve,useRef:function(w){xn=zn(),Bt=yr();var F=Bt.memoizedState;return F===null?(w={current:w},Bt.memoizedState=w):F},useState:function(w){return ve(ce,w)},useInsertionEffect:gt,useLayoutEffect:function(){},useCallback:function(w,F){return Oe(function(){return w},F)},useImperativeHandle:gt,useEffect:gt,useDebugValue:gt,useDeferredValue:function(w){return zn(),w},useTransition:function(){return zn(),[!1,st]},useId:function(){var w=ir.treeContext,F=w.overflow;w=w.id,w=(w&~(1<<32-_e(w)-1)).toString(32)+F;var z=Ye;if(z===null)throw Error(e(404));return F=an++,w=":"+z.idPrefix+"R"+w,0<F&&(w+="H"+F.toString(32)),w+":"},useMutableSource:function(w,F){return zn(),F(w._source)},useSyncExternalStore:function(w,F,z){if(z===void 0)throw Error(e(407));return z()}},Ye=null,et=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function rt(w){return console.error(w),null}function It(){}function Gt(w,F,z,Y,Ae,me,Pe,Ke,qe){var _t=[],Vt=new Set;return F={destination:null,responseState:F,progressiveChunkSize:Y===void 0?12800:Y,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Vt,pingedTasks:_t,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Ae===void 0?rt:Ae,onAllReady:It,onShellReady:Pe===void 0?It:Pe,onShellError:It,onFatalError:It},z=je(F,0,null,z,!1,!1),z.parentFlushed=!0,w=kn(F,w,null,z,Vt,At,null,se),_t.push(w),F}function kn(w,F,z,Y,Ae,me,Pe,Ke){w.allPendingTasks++,z===null?w.pendingRootTasks++:z.pendingTasks++;var qe={node:F,ping:function(){var _t=w.pingedTasks;_t.push(qe),_t.length===1&&Kn(w)},blockedBoundary:z,blockedSegment:Y,abortSet:Ae,legacyContext:me,context:Pe,treeContext:Ke};return Ae.add(qe),qe}function je(w,F,z,Y,Ae,me){return{status:0,id:-1,index:F,parentFlushed:!1,chunks:[],children:[],formatContext:Y,boundary:z,lastPushedText:Ae,textEmbedded:me}}function ne(w,F){if(w=w.onError(F),w!=null&&typeof w!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof w+'" instead');return w}function De(w,F){var z=w.onShellError;z(F),z=w.onFatalError,z(F),w.destination!==null?(w.status=2,w.destination.destroy(F)):(w.status=1,w.fatalError=F)}function tt(w,F,z,Y,Ae){for(xn={},ir=F,an=0,w=z(Y,Ae);Lr;)Lr=!1,an=0,Cr+=1,Bt=null,w=z(Y,Ae);return re(),w}function Qt(w,F,z,Y){var Ae=z.render(),me=Y.childContextTypes;if(me!=null){var Pe=F.legacyContext;if(typeof z.getChildContext!="function")Y=Pe;else{z=z.getChildContext();for(var Ke in z)if(!(Ke in me))throw Error(e(108,ct(Y)||"Unknown",Ke));Y=L({},Pe,z)}F.legacyContext=Y,tn(w,F,Ae),F.legacyContext=Pe}else tn(w,F,Ae)}function ln(w,F){if(w&&w.defaultProps){F=L({},F),w=w.defaultProps;for(var z in w)F[z]===void 0&&(F[z]=w[z]);return F}return F}function Ct(w,F,z,Y,Ae){if(typeof z=="function")if(z.prototype&&z.prototype.isReactComponent){Ae=Ut(z,F.legacyContext);var me=z.contextType;me=new z(Y,typeof me=="object"&&me!==null?me._currentValue2:Ae),X(me,z,Y,Ae),Qt(w,F,me,z)}else{me=Ut(z,F.legacyContext),Ae=tt(w,F,z,Y,me);var Pe=an!==0;if(typeof Ae=="object"&&Ae!==null&&typeof Ae.render=="function"&&Ae.$$typeof===void 0)X(Ae,z,Y,me),Qt(w,F,Ae,z);else if(Pe){Y=F.treeContext,F.treeContext=xe(Y,1,0);try{tn(w,F,Ae)}finally{F.treeContext=Y}}else tn(w,F,Ae)}else if(typeof z=="string"){switch(Ae=F.blockedSegment,me=q(Ae.chunks,z,Y,w.responseState,Ae.formatContext),Ae.lastPushedText=!1,Pe=Ae.formatContext,Ae.formatContext=T(Pe,z,Y),Xn(w,F,me),Ae.formatContext=Pe,z){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Ae.chunks.push("</",z,">")}Ae.lastPushedText=!1}else{switch(z){case $e:case He:case Ee:case Fe:case he:tn(w,F,Y.children);return;case rn:tn(w,F,Y.children);return;case Pt:throw Error(e(343));case Nt:e:{z=F.blockedBoundary,Ae=F.blockedSegment,me=Y.fallback,Y=Y.children,Pe=new Set;var Ke={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Pe,errorDigest:null},qe=je(w,Ae.chunks.length,Ke,Ae.formatContext,!1,!1);Ae.children.push(qe),Ae.lastPushedText=!1;var _t=je(w,0,null,Ae.formatContext,!1,!1);_t.parentFlushed=!0,F.blockedBoundary=Ke,F.blockedSegment=_t;try{if(Xn(w,F,Y),w.responseState.generateStaticMarkup||_t.lastPushedText&&_t.textEmbedded&&_t.chunks.push("<!-- -->"),_t.status=1,Ot(Ke,_t),Ke.pendingTasks===0)break e}catch(Vt){_t.status=4,Ke.forceClientRender=!0,Ke.errorDigest=ne(w,Vt)}finally{F.blockedBoundary=z,F.blockedSegment=Ae}F=kn(w,me,z,qe,Pe,F.legacyContext,F.context,F.treeContext),w.pingedTasks.push(F)}return}if(typeof z=="object"&&z!==null)switch(z.$$typeof){case ft:if(Y=tt(w,F,z.render,Y,Ae),an!==0){z=F.treeContext,F.treeContext=xe(z,1,0);try{tn(w,F,Y)}finally{F.treeContext=z}}else tn(w,F,Y);return;case Rt:z=z.type,Y=ln(z,Y),Ct(w,F,z,Y,Ae);return;case Je:if(Ae=Y.children,z=z._context,Y=Y.value,me=z._currentValue2,z._currentValue2=Y,Pe=kt,kt=Y={parent:Pe,depth:Pe===null?0:Pe.depth+1,context:z,parentValue:me,value:Y},F.context=Y,tn(w,F,Ae),w=kt,w===null)throw Error(e(403));Y=w.parentValue,w.context._currentValue2=Y===bt?w.context._defaultValue:Y,w=kt=w.parent,F.context=w;return;case Te:Y=Y.children,Y=Y(z._currentValue2),tn(w,F,Y);return;case yt:Ae=z._init,z=Ae(z._payload),Y=ln(z,Y),Ct(w,F,z,Y,void 0);return}throw Error(e(130,z==null?z:typeof z,""))}}function tn(w,F,z){if(F.node=z,typeof z=="object"&&z!==null){switch(z.$$typeof){case K:Ct(w,F,z.type,z.props,z.ref);return;case ue:throw Error(e(257));case yt:var Y=z._init;z=Y(z._payload),tn(w,F,z);return}if(I(z)){Vn(w,F,z);return}if(z===null||typeof z!="object"?Y=null:(Y=xt&&z[xt]||z["@@iterator"],Y=typeof Y=="function"?Y:null),Y&&(Y=Y.call(z))){if(z=Y.next(),!z.done){var Ae=[];do Ae.push(z.value),z=Y.next();while(!z.done);Vn(w,F,Ae)}return}throw w=Object.prototype.toString.call(z),Error(e(31,w==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":w))}typeof z=="string"?(Y=F.blockedSegment,Y.lastPushedText=be(F.blockedSegment.chunks,z,w.responseState,Y.lastPushedText)):typeof z=="number"&&(Y=F.blockedSegment,Y.lastPushedText=be(F.blockedSegment.chunks,""+z,w.responseState,Y.lastPushedText))}function Vn(w,F,z){for(var Y=z.length,Ae=0;Ae<Y;Ae++){var me=F.treeContext;F.treeContext=xe(me,Y,Ae);try{Xn(w,F,z[Ae])}finally{F.treeContext=me}}}function Xn(w,F,z){var Y=F.blockedSegment.formatContext,Ae=F.legacyContext,me=F.context;try{return tn(w,F,z)}catch(qe){if(re(),typeof qe=="object"&&qe!==null&&typeof qe.then=="function"){z=qe;var Pe=F.blockedSegment,Ke=je(w,Pe.chunks.length,null,Pe.formatContext,Pe.lastPushedText,!0);Pe.children.push(Ke),Pe.lastPushedText=!1,w=kn(w,F.node,F.blockedBoundary,Ke,F.abortSet,F.legacyContext,F.context,F.treeContext).ping,z.then(w,w),F.blockedSegment.formatContext=Y,F.legacyContext=Ae,F.context=me,k(me)}else throw F.blockedSegment.formatContext=Y,F.legacyContext=Ae,F.context=me,k(me),qe}}function lr(w){var F=w.blockedBoundary;w=w.blockedSegment,w.status=3,Jt(this,F,w)}function In(w,F,z){var Y=w.blockedBoundary;w.blockedSegment.status=3,Y===null?(F.allPendingTasks--,F.status!==2&&(F.status=2,F.destination!==null&&F.destination.push(null))):(Y.pendingTasks--,Y.forceClientRender||(Y.forceClientRender=!0,w=z===void 0?Error(e(432)):z,Y.errorDigest=F.onError(w),Y.parentFlushed&&F.clientRenderedBoundaries.push(Y)),Y.fallbackAbortableTasks.forEach(function(Ae){return In(Ae,F,z)}),Y.fallbackAbortableTasks.clear(),F.allPendingTasks--,F.allPendingTasks===0&&(Y=F.onAllReady,Y()))}function Ot(w,F){if(F.chunks.length===0&&F.children.length===1&&F.children[0].boundary===null){var z=F.children[0];z.id=F.id,z.parentFlushed=!0,z.status===1&&Ot(w,z)}else w.completedSegments.push(F)}function Jt(w,F,z){if(F===null){if(z.parentFlushed){if(w.completedRootSegment!==null)throw Error(e(389));w.completedRootSegment=z}w.pendingRootTasks--,w.pendingRootTasks===0&&(w.onShellError=It,F=w.onShellReady,F())}else F.pendingTasks--,F.forceClientRender||(F.pendingTasks===0?(z.parentFlushed&&z.status===1&&Ot(F,z),F.parentFlushed&&w.completedBoundaries.push(F),F.fallbackAbortableTasks.forEach(lr,w),F.fallbackAbortableTasks.clear()):z.parentFlushed&&z.status===1&&(Ot(F,z),F.completedSegments.length===1&&F.parentFlushed&&w.partialBoundaries.push(F)));w.allPendingTasks--,w.allPendingTasks===0&&(w=w.onAllReady,w())}function Kn(w){if(w.status!==2){var F=kt,z=et.current;et.current=nt;var Y=Ye;Ye=w.responseState;try{var Ae=w.pingedTasks,me;for(me=0;me<Ae.length;me++){var Pe=Ae[me],Ke=w,qe=Pe.blockedSegment;if(qe.status===0){k(Pe.context);try{tn(Ke,Pe,Pe.node),Ke.responseState.generateStaticMarkup||qe.lastPushedText&&qe.textEmbedded&&qe.chunks.push("<!-- -->"),Pe.abortSet.delete(Pe),qe.status=1,Jt(Ke,Pe.blockedBoundary,qe)}catch(Vr){if(re(),typeof Vr=="object"&&Vr!==null&&typeof Vr.then=="function"){var _t=Pe.ping;Vr.then(_t,_t)}else{Pe.abortSet.delete(Pe),qe.status=4;var Vt=Pe.blockedBoundary,bn=Vr,Ci=ne(Ke,bn);if(Vt===null?De(Ke,bn):(Vt.pendingTasks--,Vt.forceClientRender||(Vt.forceClientRender=!0,Vt.errorDigest=Ci,Vt.parentFlushed&&Ke.clientRenderedBoundaries.push(Vt))),Ke.allPendingTasks--,Ke.allPendingTasks===0){var yi=Ke.onAllReady;yi()}}}finally{}}}Ae.splice(0,me),w.destination!==null&&mo(w,w.destination)}catch(Vr){ne(w,Vr),De(w,Vr)}finally{Ye=Y,et.current=z,z===nt&&k(F)}}}function ei(w,F,z){switch(z.parentFlushed=!0,z.status){case 0:var Y=z.id=w.nextSegmentId++;return z.lastPushedText=!1,z.textEmbedded=!1,w=w.responseState,F.push('<template id="'),F.push(w.placeholderPrefix),w=Y.toString(16),F.push(w),F.push('"></template>');case 1:z.status=2;var Ae=!0;Y=z.chunks;var me=0;z=z.children;for(var Pe=0;Pe<z.length;Pe++){for(Ae=z[Pe];me<Ae.index;me++)F.push(Y[me]);Ae=$t(w,F,Ae)}for(;me<Y.length-1;me++)F.push(Y[me]);return me<Y.length&&(Ae=F.push(Y[me])),Ae;default:throw Error(e(390))}}function $t(w,F,z){var Y=z.boundary;if(Y===null)return ei(w,F,z);if(Y.parentFlushed=!0,Y.forceClientRender)return w.responseState.generateStaticMarkup||(Y=Y.errorDigest,F.push("<!--$!-->"),F.push("<template"),Y&&(F.push(' data-dgst="'),Y=C(Y),F.push(Y),F.push('"')),F.push("></template>")),ei(w,F,z),w=w.responseState.generateStaticMarkup?!0:F.push("<!--/$-->"),w;if(0<Y.pendingTasks){Y.rootSegmentID=w.nextSegmentId++,0<Y.completedSegments.length&&w.partialBoundaries.push(Y);var Ae=w.responseState,me=Ae.nextSuspenseID++;return Ae=Ae.boundaryPrefix+me.toString(16),Y=Y.id=Ae,ie(F,w.responseState,Y),ei(w,F,z),F.push("<!--/$-->")}if(Y.byteSize>w.progressiveChunkSize)return Y.rootSegmentID=w.nextSegmentId++,w.completedBoundaries.push(Y),ie(F,w.responseState,Y.id),ei(w,F,z),F.push("<!--/$-->");if(w.responseState.generateStaticMarkup||F.push("<!--$-->"),z=Y.completedSegments,z.length!==1)throw Error(e(391));return $t(w,F,z[0]),w=w.responseState.generateStaticMarkup?!0:F.push("<!--/$-->"),w}function vi(w,F,z){return le(F,w.responseState,z.formatContext,z.id),$t(w,F,z),Ce(F,z.formatContext)}function ns(w,F,z){for(var Y=z.completedSegments,Ae=0;Ae<Y.length;Ae++)Hs(w,F,z,Y[Ae]);if(Y.length=0,w=w.responseState,Y=z.id,z=z.rootSegmentID,F.push(w.startInlineScript),w.sentCompleteBoundaryFunction?F.push('$RC("'):(w.sentCompleteBoundaryFunction=!0,F.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),Y===null)throw Error(e(395));return z=z.toString(16),F.push(Y),F.push('","'),F.push(w.segmentPrefix),F.push(z),F.push('")<\/script>')}function Hs(w,F,z,Y){if(Y.status===2)return!0;var Ae=Y.id;if(Ae===-1){if((Y.id=z.rootSegmentID)===-1)throw Error(e(392));return vi(w,F,Y)}return vi(w,F,Y),w=w.responseState,F.push(w.startInlineScript),w.sentCompleteSegmentFunction?F.push('$RS("'):(w.sentCompleteSegmentFunction=!0,F.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),F.push(w.segmentPrefix),Ae=Ae.toString(16),F.push(Ae),F.push('","'),F.push(w.placeholderPrefix),F.push(Ae),F.push('")<\/script>')}function mo(w,F){try{var z=w.completedRootSegment;if(z!==null&&w.pendingRootTasks===0){$t(w,F,z),w.completedRootSegment=null;var Y=w.responseState.bootstrapChunks;for(z=0;z<Y.length-1;z++)F.push(Y[z]);z<Y.length&&F.push(Y[z])}var Ae=w.clientRenderedBoundaries,me;for(me=0;me<Ae.length;me++){var Pe=Ae[me];Y=F;var Ke=w.responseState,qe=Pe.id,_t=Pe.errorDigest,Vt=Pe.errorMessage,bn=Pe.errorComponentStack;if(Y.push(Ke.startInlineScript),Ke.sentClientRenderFunction?Y.push('$RX("'):(Ke.sentClientRenderFunction=!0,Y.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),qe===null)throw Error(e(395));if(Y.push(qe),Y.push('"'),_t||Vt||bn){Y.push(",");var Ci=de(_t||"");Y.push(Ci)}if(Vt||bn){Y.push(",");var yi=de(Vt||"");Y.push(yi)}if(bn){Y.push(",");var Vr=de(bn);Y.push(Vr)}if(!Y.push(")<\/script>")){w.destination=null,me++,Ae.splice(0,me);return}}Ae.splice(0,me);var vo=w.completedBoundaries;for(me=0;me<vo.length;me++)if(!ns(w,F,vo[me])){w.destination=null,me++,vo.splice(0,me);return}vo.splice(0,me);var xi=w.partialBoundaries;for(me=0;me<xi.length;me++){var Ii=xi[me];e:{Ae=w,Pe=F;var Gr=Ii.completedSegments;for(Ke=0;Ke<Gr.length;Ke++)if(!Hs(Ae,Pe,Ii,Gr[Ke])){Ke++,Gr.splice(0,Ke);var Vi=!1;break e}Gr.splice(0,Ke),Vi=!0}if(!Vi){w.destination=null,me++,xi.splice(0,me);return}}xi.splice(0,me);var bi=w.completedBoundaries;for(me=0;me<bi.length;me++)if(!ns(w,F,bi[me])){w.destination=null,me++,bi.splice(0,me);return}bi.splice(0,me)}finally{w.allPendingTasks===0&&w.pingedTasks.length===0&&w.clientRenderedBoundaries.length===0&&w.completedBoundaries.length===0&&F.push(null)}}function Zs(w,F){try{var z=w.abortableTasks;z.forEach(function(Y){return In(Y,w,F)}),z.clear(),w.destination!==null&&mo(w,w.destination)}catch(Y){ne(w,Y),De(w,Y)}}function rs(){}function is(w,F,z,Y){var Ae=!1,me=null,Pe="",Ke={push:function(_t){return _t!==null&&(Pe+=_t),!0},destroy:function(_t){Ae=!0,me=_t}},qe=!1;if(w=Gt(w,pe(z,F?F.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,rs,void 0,function(){qe=!0}),Kn(w),Zs(w,Y),w.status===1)w.status=2,Ke.destroy(w.fatalError);else if(w.status!==2&&w.destination===null){w.destination=Ke;try{mo(w,Ke)}catch(_t){ne(w,_t),De(w,_t)}}if(Ae)throw me;if(!qe)throw Error(e(426));return Pe}return oc.renderToNodeStream=function(){throw Error(e(207))},oc.renderToStaticMarkup=function(w,F){return is(w,F,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},oc.renderToStaticNodeStream=function(){throw Error(e(208))},oc.renderToString=function(w,F){return is(w,F,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},oc.version="18.3.1",oc}var np={},dA;function eM(){if(dA)return np;dA=1;var n=Df();function e(S){for(var O="https://reactjs.org/docs/error-decoder.html?invariant="+S,j=1;j<arguments.length;j++)O+="&args[]="+encodeURIComponent(arguments[j]);return"Minified React error #"+S+"; visit "+O+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=null,r=0;function i(S,O){if(O.length!==0)if(512<O.length)0<r&&(S.enqueue(new Uint8Array(t.buffer,0,r)),t=new Uint8Array(512),r=0),S.enqueue(O);else{var j=t.length-r;j<O.length&&(j===0?S.enqueue(t):(t.set(O.subarray(0,j),r),S.enqueue(t),O=O.subarray(j)),t=new Uint8Array(512),r=0),t.set(O,r),r+=O.length}}function o(S,O){return i(S,O),!0}function a(S){t&&0<r&&(S.enqueue(new Uint8Array(t.buffer,0,r)),t=null,r=0)}var l=new TextEncoder;function u(S){return l.encode(S)}function d(S){return l.encode(S)}function f(S,O){typeof S.error=="function"?S.error(O):S.close()}var p=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},C={};function y(S){return p.call(C,S)?!0:p.call(v,S)?!1:g.test(S)?C[S]=!0:(v[S]=!0,!1)}function x(S,O,j,J,Se,Ie,Be){this.acceptsBooleans=O===2||O===3||O===4,this.attributeName=J,this.attributeNamespace=Se,this.mustUseProperty=j,this.propertyName=S,this.type=O,this.sanitizeURL=Ie,this.removeEmptyString=Be}var I={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(S){I[S]=new x(S,0,!1,S,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(S){var O=S[0];I[O]=new x(O,1,!1,S[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(S){I[S]=new x(S,2,!1,S.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(S){I[S]=new x(S,2,!1,S,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(S){I[S]=new x(S,3,!1,S.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(S){I[S]=new x(S,3,!0,S,null,!1,!1)}),["capture","download"].forEach(function(S){I[S]=new x(S,4,!1,S,null,!1,!1)}),["cols","rows","size","span"].forEach(function(S){I[S]=new x(S,6,!1,S,null,!1,!1)}),["rowSpan","start"].forEach(function(S){I[S]=new x(S,5,!1,S.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function T(S){return S[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(S){var O=S.replace(b,T);I[O]=new x(O,1,!1,S,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(S){var O=S.replace(b,T);I[O]=new x(O,1,!1,S,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(S){var O=S.replace(b,T);I[O]=new x(O,1,!1,S,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(S){I[S]=new x(S,1,!1,S.toLowerCase(),null,!1,!1)}),I.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(S){I[S]=new x(S,1,!1,S.toLowerCase(),null,!0,!0)});var R={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},P=["Webkit","ms","Moz","O"];Object.keys(R).forEach(function(S){P.forEach(function(O){O=O+S.charAt(0).toUpperCase()+S.substring(1),R[O]=R[S]})});var B=/["'&<>]/;function _(S){if(typeof S=="boolean"||typeof S=="number")return""+S;S=""+S;var O=B.exec(S);if(O){var j="",J,Se=0;for(J=O.index;J<S.length;J++){switch(S.charCodeAt(J)){case 34:O="&quot;";break;case 38:O="&amp;";break;case 39:O="&#x27;";break;case 60:O="&lt;";break;case 62:O="&gt;";break;default:continue}Se!==J&&(j+=S.substring(Se,J)),Se=J+1,j+=O}S=Se!==J?j+S.substring(Se,J):j}return S}var M=/([A-Z])/g,H=/^ms-/,V=Array.isArray,U=d("<script>"),Z=d("<\/script>"),q=d('<script src="'),ie=d('<script type="module" src="'),le=d('" async=""><\/script>'),Ce=/(<\/|<)(s)(cript)/gi;function Re(S,O,j,J){return""+O+(j==="s"?"\\u0073":"\\u0053")+J}function de(S,O,j,J,Se){S=S===void 0?"":S,O=O===void 0?U:d('<script nonce="'+_(O)+'">');var Ie=[];if(j!==void 0&&Ie.push(O,u((""+j).replace(Ce,Re)),Z),J!==void 0)for(j=0;j<J.length;j++)Ie.push(q,u(_(J[j])),le);if(Se!==void 0)for(J=0;J<Se.length;J++)Ie.push(ie,u(_(Se[J])),le);return{bootstrapChunks:Ie,startInlineScript:O,placeholderPrefix:d(S+"P:"),segmentPrefix:d(S+"S:"),boundaryPrefix:S+"B:",idPrefix:S,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function pe(S,O){return{insertionMode:S,selectedValue:O}}function be(S){return pe(S==="http://www.w3.org/2000/svg"?2:S==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function L(S,O,j){switch(O){case"select":return pe(1,j.value!=null?j.value:j.defaultValue);case"svg":return pe(2,null);case"math":return pe(3,null);case"foreignObject":return pe(1,null);case"table":return pe(4,null);case"thead":case"tbody":case"tfoot":return pe(5,null);case"colgroup":return pe(7,null);case"tr":return pe(6,null)}return 4<=S.insertionMode||S.insertionMode===0?pe(1,null):S}var K=d("<!-- -->");function ue(S,O,j,J){return O===""?J:(J&&S.push(K),S.push(u(_(O))),!0)}var he=new Map,Ee=d(' style="'),Fe=d(":"),Je=d(";");function Te(S,O,j){if(typeof j!="object")throw Error(e(62));O=!0;for(var J in j)if(p.call(j,J)){var Se=j[J];if(Se!=null&&typeof Se!="boolean"&&Se!==""){if(J.indexOf("--")===0){var Ie=u(_(J));Se=u(_((""+Se).trim()))}else{Ie=J;var Be=he.get(Ie);Be!==void 0||(Be=d(_(Ie.replace(M,"-$1").toLowerCase().replace(H,"-ms-"))),he.set(Ie,Be)),Ie=Be,Se=typeof Se=="number"?Se===0||p.call(R,J)?u(""+Se):u(Se+"px"):u(_((""+Se).trim()))}O?(O=!1,S.push(Ee,Ie,Fe,Se)):S.push(Je,Ie,Fe,Se)}}O||S.push(rn)}var ft=d(" "),Nt=d('="'),rn=d('"'),Rt=d('=""');function yt(S,O,j,J){switch(j){case"style":Te(S,O,J);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<j.length)||j[0]!=="o"&&j[0]!=="O"||j[1]!=="n"&&j[1]!=="N"){if(O=I.hasOwnProperty(j)?I[j]:null,O!==null){switch(typeof J){case"function":case"symbol":return;case"boolean":if(!O.acceptsBooleans)return}switch(j=u(O.attributeName),O.type){case 3:J&&S.push(ft,j,Rt);break;case 4:J===!0?S.push(ft,j,Rt):J!==!1&&S.push(ft,j,Nt,u(_(J)),rn);break;case 5:isNaN(J)||S.push(ft,j,Nt,u(_(J)),rn);break;case 6:!isNaN(J)&&1<=J&&S.push(ft,j,Nt,u(_(J)),rn);break;default:O.sanitizeURL&&(J=""+J),S.push(ft,j,Nt,u(_(J)),rn)}}else if(y(j)){switch(typeof J){case"function":case"symbol":return;case"boolean":if(O=j.toLowerCase().slice(0,5),O!=="data-"&&O!=="aria-")return}S.push(ft,u(j),Nt,u(_(J)),rn)}}}var Pt=d(">"),He=d("/>");function $e(S,O,j){if(O!=null){if(j!=null)throw Error(e(60));if(typeof O!="object"||!("__html"in O))throw Error(e(61));O=O.__html,O!=null&&S.push(u(""+O))}}function bt(S){var O="";return n.Children.forEach(S,function(j){j!=null&&(O+=j)}),O}var xt=d(' selected=""');function ct(S,O,j,J){S.push(jt(j));var Se=j=null,Ie;for(Ie in O)if(p.call(O,Ie)){var Be=O[Ie];if(Be!=null)switch(Ie){case"children":j=Be;break;case"dangerouslySetInnerHTML":Se=Be;break;default:yt(S,J,Ie,Be)}}return S.push(Pt),$e(S,Se,j),typeof j=="string"?(S.push(u(_(j))),null):j}var At=d(`
`),Ut=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,kt=new Map;function jt(S){var O=kt.get(S);if(O===void 0){if(!Ut.test(S))throw Error(e(65,S));O=d("<"+S),kt.set(S,O)}return O}var fn=d("<!DOCTYPE html>");function sn(S,O,j,J,Se){switch(O){case"select":S.push(jt("select"));var Ie=null,Be=null;for(Ft in j)if(p.call(j,Ft)){var ze=j[Ft];if(ze!=null)switch(Ft){case"children":Ie=ze;break;case"dangerouslySetInnerHTML":Be=ze;break;case"defaultValue":case"value":break;default:yt(S,J,Ft,ze)}}return S.push(Pt),$e(S,Be,Ie),Ie;case"option":Be=Se.selectedValue,S.push(jt("option"));var Et=ze=null,Ht=null,Ft=null;for(Ie in j)if(p.call(j,Ie)){var En=j[Ie];if(En!=null)switch(Ie){case"children":ze=En;break;case"selected":Ht=En;break;case"dangerouslySetInnerHTML":Ft=En;break;case"value":Et=En;default:yt(S,J,Ie,En)}}if(Be!=null)if(j=Et!==null?""+Et:bt(ze),V(Be)){for(J=0;J<Be.length;J++)if(""+Be[J]===j){S.push(xt);break}}else""+Be===j&&S.push(xt);else Ht&&S.push(xt);return S.push(Pt),$e(S,Ft,ze),ze;case"textarea":S.push(jt("textarea")),Ft=Be=Ie=null;for(ze in j)if(p.call(j,ze)&&(Et=j[ze],Et!=null))switch(ze){case"children":Ft=Et;break;case"value":Ie=Et;break;case"defaultValue":Be=Et;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:yt(S,J,ze,Et)}if(Ie===null&&Be!==null&&(Ie=Be),S.push(Pt),Ft!=null){if(Ie!=null)throw Error(e(92));if(V(Ft)&&1<Ft.length)throw Error(e(93));Ie=""+Ft}return typeof Ie=="string"&&Ie[0]===`
`&&S.push(At),Ie!==null&&S.push(u(_(""+Ie))),null;case"input":S.push(jt("input")),Et=Ft=ze=Ie=null;for(Be in j)if(p.call(j,Be)&&(Ht=j[Be],Ht!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":Et=Ht;break;case"defaultValue":ze=Ht;break;case"checked":Ft=Ht;break;case"value":Ie=Ht;break;default:yt(S,J,Be,Ht)}return Ft!==null?yt(S,J,"checked",Ft):Et!==null&&yt(S,J,"checked",Et),Ie!==null?yt(S,J,"value",Ie):ze!==null&&yt(S,J,"value",ze),S.push(He),null;case"menuitem":S.push(jt("menuitem"));for(var Wr in j)if(p.call(j,Wr)&&(Ie=j[Wr],Ie!=null))switch(Wr){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:yt(S,J,Wr,Ie)}return S.push(Pt),null;case"title":S.push(jt("title")),Ie=null;for(En in j)if(p.call(j,En)&&(Be=j[En],Be!=null))switch(En){case"children":Ie=Be;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:yt(S,J,En,Be)}return S.push(Pt),Ie;case"listing":case"pre":S.push(jt(O)),Be=Ie=null;for(Et in j)if(p.call(j,Et)&&(ze=j[Et],ze!=null))switch(Et){case"children":Ie=ze;break;case"dangerouslySetInnerHTML":Be=ze;break;default:yt(S,J,Et,ze)}if(S.push(Pt),Be!=null){if(Ie!=null)throw Error(e(60));if(typeof Be!="object"||!("__html"in Be))throw Error(e(61));j=Be.__html,j!=null&&(typeof j=="string"&&0<j.length&&j[0]===`
`?S.push(At,u(j)):S.push(u(""+j)))}return typeof Ie=="string"&&Ie[0]===`
`&&S.push(At),Ie;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":S.push(jt(O));for(var Ai in j)if(p.call(j,Ai)&&(Ie=j[Ai],Ie!=null))switch(Ai){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,O));default:yt(S,J,Ai,Ie)}return S.push(He),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return ct(S,j,O,J);case"html":return Se.insertionMode===0&&S.push(fn),ct(S,j,O,J);default:if(O.indexOf("-")===-1&&typeof j.is!="string")return ct(S,j,O,J);S.push(jt(O)),Be=Ie=null;for(Ht in j)if(p.call(j,Ht)&&(ze=j[Ht],ze!=null))switch(Ht){case"children":Ie=ze;break;case"dangerouslySetInnerHTML":Be=ze;break;case"style":Te(S,J,ze);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:y(Ht)&&typeof ze!="function"&&typeof ze!="symbol"&&S.push(ft,u(Ht),Nt,u(_(ze)),rn)}return S.push(Pt),$e(S,Be,Ie),Ie}}var yn=d("</"),W=d(">"),k=d('<template id="'),D=d('"></template>'),X=d("<!--$-->"),se=d('<!--$?--><template id="'),xe=d('"></template>'),_e=d("<!--$!-->"),mt=d("<!--/$-->"),Zt=d("<template"),Xt=d('"'),Yt=d(' data-dgst="');d(' data-msg="'),d(' data-stck="');var zt=d("></template>");function xn(S,O,j){if(i(S,se),j===null)throw Error(e(395));return i(S,j),o(S,xe)}var ir=d('<div hidden id="'),qn=d('">'),Bt=d("</div>"),Mr=d('<svg aria-hidden="true" style="display:none" id="'),Lr=d('">'),an=d("</svg>"),Rn=d('<math aria-hidden="true" style="display:none" id="'),Cr=d('">'),zn=d("</math>"),Ur=d('<table hidden id="'),yr=d('">'),re=d("</table>"),ce=d('<table hidden><tbody id="'),ve=d('">'),Oe=d("</tbody></table>"),Ze=d('<table hidden><tr id="'),st=d('">'),gt=d("</tr></table>"),nt=d('<table hidden><colgroup id="'),Ye=d('">'),et=d("</colgroup></table>");function rt(S,O,j,J){switch(j.insertionMode){case 0:case 1:return i(S,ir),i(S,O.segmentPrefix),i(S,u(J.toString(16))),o(S,qn);case 2:return i(S,Mr),i(S,O.segmentPrefix),i(S,u(J.toString(16))),o(S,Lr);case 3:return i(S,Rn),i(S,O.segmentPrefix),i(S,u(J.toString(16))),o(S,Cr);case 4:return i(S,Ur),i(S,O.segmentPrefix),i(S,u(J.toString(16))),o(S,yr);case 5:return i(S,ce),i(S,O.segmentPrefix),i(S,u(J.toString(16))),o(S,ve);case 6:return i(S,Ze),i(S,O.segmentPrefix),i(S,u(J.toString(16))),o(S,st);case 7:return i(S,nt),i(S,O.segmentPrefix),i(S,u(J.toString(16))),o(S,Ye);default:throw Error(e(397))}}function It(S,O){switch(O.insertionMode){case 0:case 1:return o(S,Bt);case 2:return o(S,an);case 3:return o(S,zn);case 4:return o(S,re);case 5:return o(S,Oe);case 6:return o(S,gt);case 7:return o(S,et);default:throw Error(e(397))}}var Gt=d('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),kn=d('$RS("'),je=d('","'),ne=d('")<\/script>'),De=d('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),tt=d('$RC("'),Qt=d('","'),ln=d('")<\/script>'),Ct=d('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),tn=d('$RX("'),Vn=d('"'),Xn=d(")<\/script>"),lr=d(","),In=/[<\u2028\u2029]/g;function Ot(S){return JSON.stringify(S).replace(In,function(O){switch(O){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Jt=Object.assign,Kn=Symbol.for("react.element"),ei=Symbol.for("react.portal"),$t=Symbol.for("react.fragment"),vi=Symbol.for("react.strict_mode"),ns=Symbol.for("react.profiler"),Hs=Symbol.for("react.provider"),mo=Symbol.for("react.context"),Zs=Symbol.for("react.forward_ref"),rs=Symbol.for("react.suspense"),is=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),z=Symbol.for("react.scope"),Y=Symbol.for("react.debug_trace_mode"),Ae=Symbol.for("react.legacy_hidden"),me=Symbol.for("react.default_value"),Pe=Symbol.iterator;function Ke(S){if(S==null)return null;if(typeof S=="function")return S.displayName||S.name||null;if(typeof S=="string")return S;switch(S){case $t:return"Fragment";case ei:return"Portal";case ns:return"Profiler";case vi:return"StrictMode";case rs:return"Suspense";case is:return"SuspenseList"}if(typeof S=="object")switch(S.$$typeof){case mo:return(S.displayName||"Context")+".Consumer";case Hs:return(S._context.displayName||"Context")+".Provider";case Zs:var O=S.render;return S=S.displayName,S||(S=O.displayName||O.name||"",S=S!==""?"ForwardRef("+S+")":"ForwardRef"),S;case w:return O=S.displayName||null,O!==null?O:Ke(S.type)||"Memo";case F:O=S._payload,S=S._init;try{return Ke(S(O))}catch{}}return null}var qe={};function _t(S,O){if(S=S.contextTypes,!S)return qe;var j={},J;for(J in S)j[J]=O[J];return j}var Vt=null;function bn(S,O){if(S!==O){S.context._currentValue=S.parentValue,S=S.parent;var j=O.parent;if(S===null){if(j!==null)throw Error(e(401))}else{if(j===null)throw Error(e(401));bn(S,j)}O.context._currentValue=O.value}}function Ci(S){S.context._currentValue=S.parentValue,S=S.parent,S!==null&&Ci(S)}function yi(S){var O=S.parent;O!==null&&yi(O),S.context._currentValue=S.value}function Vr(S,O){if(S.context._currentValue=S.parentValue,S=S.parent,S===null)throw Error(e(402));S.depth===O.depth?bn(S,O):Vr(S,O)}function vo(S,O){var j=O.parent;if(j===null)throw Error(e(402));S.depth===j.depth?bn(S,j):vo(S,j),O.context._currentValue=O.value}function xi(S){var O=Vt;O!==S&&(O===null?yi(S):S===null?Ci(O):O.depth===S.depth?bn(O,S):O.depth>S.depth?Vr(O,S):vo(O,S),Vt=S)}var Ii={isMounted:function(){return!1},enqueueSetState:function(S,O){S=S._reactInternals,S.queue!==null&&S.queue.push(O)},enqueueReplaceState:function(S,O){S=S._reactInternals,S.replace=!0,S.queue=[O]},enqueueForceUpdate:function(){}};function Gr(S,O,j,J){var Se=S.state!==void 0?S.state:null;S.updater=Ii,S.props=j,S.state=Se;var Ie={queue:[],replace:!1};S._reactInternals=Ie;var Be=O.contextType;if(S.context=typeof Be=="object"&&Be!==null?Be._currentValue:J,Be=O.getDerivedStateFromProps,typeof Be=="function"&&(Be=Be(j,Se),Se=Be==null?Se:Jt({},Se,Be),S.state=Se),typeof O.getDerivedStateFromProps!="function"&&typeof S.getSnapshotBeforeUpdate!="function"&&(typeof S.UNSAFE_componentWillMount=="function"||typeof S.componentWillMount=="function"))if(O=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),O!==S.state&&Ii.enqueueReplaceState(S,S.state,null),Ie.queue!==null&&0<Ie.queue.length)if(O=Ie.queue,Be=Ie.replace,Ie.queue=null,Ie.replace=!1,Be&&O.length===1)S.state=O[0];else{for(Ie=Be?O[0]:S.state,Se=!0,Be=Be?1:0;Be<O.length;Be++){var ze=O[Be];ze=typeof ze=="function"?ze.call(S,Ie,j,J):ze,ze!=null&&(Se?(Se=!1,Ie=Jt({},Ie,ze)):Jt(Ie,ze))}S.state=Ie}else Ie.queue=null}var Vi={id:1,overflow:""};function bi(S,O,j){var J=S.id;S=S.overflow;var Se=32-os(J)-1;J&=~(1<<Se),j+=1;var Ie=32-os(O)+Se;if(30<Ie){var Be=Se-Se%5;return Ie=(J&(1<<Be)-1).toString(32),J>>=Be,Se-=Be,{id:1<<32-os(O)+Se|j<<Se|J,overflow:Ie+S}}return{id:1<<Ie|j<<Se|J,overflow:S}}var os=Math.clz32?Math.clz32:Kf,ss=Math.log,fg=Math.LN2;function Kf(S){return S>>>=0,S===0?32:31-(ss(S)/fg|0)|0}function Ul(S,O){return S===O&&(S!==0||1/S===1/O)||S!==S&&O!==O}var hg=typeof Object.is=="function"?Object.is:Ul,eo=null,Za=null,Vl=null,An=null,Co=!1,as=!1,to=0,Gi=null,Fc=0;function Xs(){if(eo===null)throw Error(e(321));return eo}function Mc(){if(0<Fc)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Xa(){return An===null?Vl===null?(Co=!1,Vl=An=Mc()):(Co=!0,An=Vl):An.next===null?(Co=!1,An=An.next=Mc()):(Co=!0,An=An.next),An}function Gl(){Za=eo=null,as=!1,Vl=null,Fc=0,An=Gi=null}function nd(S,O){return typeof O=="function"?O(S):O}function yo(S,O,j){if(eo=Xs(),An=Xa(),Co){var J=An.queue;if(O=J.dispatch,Gi!==null&&(j=Gi.get(J),j!==void 0)){Gi.delete(J),J=An.memoizedState;do J=S(J,j.action),j=j.next;while(j!==null);return An.memoizedState=J,[J,O]}return[An.memoizedState,O]}return S=S===nd?typeof O=="function"?O():O:j!==void 0?j(O):O,An.memoizedState=S,S=An.queue={last:null,dispatch:null},S=S.dispatch=Uc.bind(null,eo,S),[An.memoizedState,S]}function Lc(S,O){if(eo=Xs(),An=Xa(),O=O===void 0?null:O,An!==null){var j=An.memoizedState;if(j!==null&&O!==null){var J=j[1];e:if(J===null)J=!1;else{for(var Se=0;Se<J.length&&Se<O.length;Se++)if(!hg(O[Se],J[Se])){J=!1;break e}J=!0}if(J)return j[0]}}return S=S(),An.memoizedState=[S,O],S}function Uc(S,O,j){if(25<=Fc)throw Error(e(301));if(S===eo)if(as=!0,S={action:j,next:null},Gi===null&&(Gi=new Map),j=Gi.get(O),j===void 0)Gi.set(O,S);else{for(O=j;O.next!==null;)O=O.next;O.next=S}}function $f(){throw Error(e(394))}function Ks(){}var Wl={readContext:function(S){return S._currentValue},useContext:function(S){return Xs(),S._currentValue},useMemo:Lc,useReducer:yo,useRef:function(S){eo=Xs(),An=Xa();var O=An.memoizedState;return O===null?(S={current:S},An.memoizedState=S):O},useState:function(S){return yo(nd,S)},useInsertionEffect:Ks,useLayoutEffect:function(){},useCallback:function(S,O){return Lc(function(){return S},O)},useImperativeHandle:Ks,useEffect:Ks,useDebugValue:Ks,useDeferredValue:function(S){return Xs(),S},useTransition:function(){return Xs(),[!1,$f]},useId:function(){var S=Za.treeContext,O=S.overflow;S=S.id,S=(S&~(1<<32-os(S)-1)).toString(32)+O;var j=jl;if(j===null)throw Error(e(404));return O=to++,S=":"+j.idPrefix+"R"+S,0<O&&(S+="H"+O.toString(32)),S+":"},useMutableSource:function(S,O){return Xs(),O(S._source)},useSyncExternalStore:function(S,O,j){if(j===void 0)throw Error(e(407));return j()}},jl=null,Er=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Ka(S){return console.error(S),null}function $s(){}function zl(S,O,j,J,Se,Ie,Be,ze,Et){var Ht=[],Ft=new Set;return O={destination:null,responseState:O,progressiveChunkSize:J===void 0?12800:J,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Ft,pingedTasks:Ht,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Se===void 0?Ka:Se,onAllReady:Ie===void 0?$s:Ie,onShellReady:Be===void 0?$s:Be,onShellError:ze===void 0?$s:ze,onFatalError:Et===void 0?$s:Et},j=$a(O,0,null,j,!1,!1),j.parentFlushed=!0,S=rd(O,S,null,j,Ft,qe,null,Vi),Ht.push(S),O}function rd(S,O,j,J,Se,Ie,Be,ze){S.allPendingTasks++,j===null?S.pendingRootTasks++:j.pendingTasks++;var Et={node:O,ping:function(){var Ht=S.pingedTasks;Ht.push(Et),Ht.length===1&&ad(S)},blockedBoundary:j,blockedSegment:J,abortSet:Se,legacyContext:Ie,context:Be,treeContext:ze};return Se.add(Et),Et}function $a(S,O,j,J,Se,Ie){return{status:0,id:-1,index:O,parentFlushed:!1,chunks:[],children:[],formatContext:J,boundary:j,lastPushedText:Se,textEmbedded:Ie}}function Js(S,O){if(S=S.onError(O),S!=null&&typeof S!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof S+'" instead');return S}function ls(S,O){var j=S.onShellError;j(O),j=S.onFatalError,j(O),S.destination!==null?(S.status=2,f(S.destination,O)):(S.status=1,S.fatalError=O)}function Hl(S,O,j,J,Se){for(eo={},Za=O,to=0,S=j(J,Se);as;)as=!1,to=0,Fc+=1,An=null,S=j(J,Se);return Gl(),S}function id(S,O,j,J){var Se=j.render(),Ie=J.childContextTypes;if(Ie!=null){var Be=O.legacyContext;if(typeof j.getChildContext!="function")J=Be;else{j=j.getChildContext();for(var ze in j)if(!(ze in Ie))throw Error(e(108,Ke(J)||"Unknown",ze));J=Jt({},Be,j)}O.legacyContext=J,ti(S,O,Se),O.legacyContext=Be}else ti(S,O,Se)}function Jf(S,O){if(S&&S.defaultProps){O=Jt({},O),S=S.defaultProps;for(var j in S)O[j]===void 0&&(O[j]=S[j]);return O}return O}function od(S,O,j,J,Se){if(typeof j=="function")if(j.prototype&&j.prototype.isReactComponent){Se=_t(j,O.legacyContext);var Ie=j.contextType;Ie=new j(J,typeof Ie=="object"&&Ie!==null?Ie._currentValue:Se),Gr(Ie,j,J,Se),id(S,O,Ie,j)}else{Ie=_t(j,O.legacyContext),Se=Hl(S,O,j,J,Ie);var Be=to!==0;if(typeof Se=="object"&&Se!==null&&typeof Se.render=="function"&&Se.$$typeof===void 0)Gr(Se,j,J,Ie),id(S,O,Se,j);else if(Be){J=O.treeContext,O.treeContext=bi(J,1,0);try{ti(S,O,Se)}finally{O.treeContext=J}}else ti(S,O,Se)}else if(typeof j=="string"){switch(Se=O.blockedSegment,Ie=sn(Se.chunks,j,J,S.responseState,Se.formatContext),Se.lastPushedText=!1,Be=Se.formatContext,Se.formatContext=L(Be,j,J),sd(S,O,Ie),Se.formatContext=Be,j){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Se.chunks.push(yn,u(j),W)}Se.lastPushedText=!1}else{switch(j){case Ae:case Y:case vi:case ns:case $t:ti(S,O,J.children);return;case is:ti(S,O,J.children);return;case z:throw Error(e(343));case rs:e:{j=O.blockedBoundary,Se=O.blockedSegment,Ie=J.fallback,J=J.children,Be=new Set;var ze={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Be,errorDigest:null},Et=$a(S,Se.chunks.length,ze,Se.formatContext,!1,!1);Se.children.push(Et),Se.lastPushedText=!1;var Ht=$a(S,0,null,Se.formatContext,!1,!1);Ht.parentFlushed=!0,O.blockedBoundary=ze,O.blockedSegment=Ht;try{if(sd(S,O,J),Ht.lastPushedText&&Ht.textEmbedded&&Ht.chunks.push(K),Ht.status=1,Gc(ze,Ht),ze.pendingTasks===0)break e}catch(Ft){Ht.status=4,ze.forceClientRender=!0,ze.errorDigest=Js(S,Ft)}finally{O.blockedBoundary=j,O.blockedSegment=Se}O=rd(S,Ie,j,Et,Be,O.legacyContext,O.context,O.treeContext),S.pingedTasks.push(O)}return}if(typeof j=="object"&&j!==null)switch(j.$$typeof){case Zs:if(J=Hl(S,O,j.render,J,Se),to!==0){j=O.treeContext,O.treeContext=bi(j,1,0);try{ti(S,O,J)}finally{O.treeContext=j}}else ti(S,O,J);return;case w:j=j.type,J=Jf(j,J),od(S,O,j,J,Se);return;case Hs:if(Se=J.children,j=j._context,J=J.value,Ie=j._currentValue,j._currentValue=J,Be=Vt,Vt=J={parent:Be,depth:Be===null?0:Be.depth+1,context:j,parentValue:Ie,value:J},O.context=J,ti(S,O,Se),S=Vt,S===null)throw Error(e(403));J=S.parentValue,S.context._currentValue=J===me?S.context._defaultValue:J,S=Vt=S.parent,O.context=S;return;case mo:J=J.children,J=J(j._currentValue),ti(S,O,J);return;case F:Se=j._init,j=Se(j._payload),J=Jf(j,J),od(S,O,j,J,void 0);return}throw Error(e(130,j==null?j:typeof j,""))}}function ti(S,O,j){if(O.node=j,typeof j=="object"&&j!==null){switch(j.$$typeof){case Kn:od(S,O,j.type,j.props,j.ref);return;case ei:throw Error(e(257));case F:var J=j._init;j=J(j._payload),ti(S,O,j);return}if(V(j)){Vc(S,O,j);return}if(j===null||typeof j!="object"?J=null:(J=Pe&&j[Pe]||j["@@iterator"],J=typeof J=="function"?J:null),J&&(J=J.call(j))){if(j=J.next(),!j.done){var Se=[];do Se.push(j.value),j=J.next();while(!j.done);Vc(S,O,Se)}return}throw S=Object.prototype.toString.call(j),Error(e(31,S==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":S))}typeof j=="string"?(J=O.blockedSegment,J.lastPushedText=ue(O.blockedSegment.chunks,j,S.responseState,J.lastPushedText)):typeof j=="number"&&(J=O.blockedSegment,J.lastPushedText=ue(O.blockedSegment.chunks,""+j,S.responseState,J.lastPushedText))}function Vc(S,O,j){for(var J=j.length,Se=0;Se<J;Se++){var Ie=O.treeContext;O.treeContext=bi(Ie,J,Se);try{sd(S,O,j[Se])}finally{O.treeContext=Ie}}}function sd(S,O,j){var J=O.blockedSegment.formatContext,Se=O.legacyContext,Ie=O.context;try{return ti(S,O,j)}catch(Et){if(Gl(),typeof Et=="object"&&Et!==null&&typeof Et.then=="function"){j=Et;var Be=O.blockedSegment,ze=$a(S,Be.chunks.length,null,Be.formatContext,Be.lastPushedText,!0);Be.children.push(ze),Be.lastPushedText=!1,S=rd(S,O.node,O.blockedBoundary,ze,O.abortSet,O.legacyContext,O.context,O.treeContext).ping,j.then(S,S),O.blockedSegment.formatContext=J,O.legacyContext=Se,O.context=Ie,xi(Ie)}else throw O.blockedSegment.formatContext=J,O.legacyContext=Se,O.context=Ie,xi(Ie),Et}}function pg(S){var O=S.blockedBoundary;S=S.blockedSegment,S.status=3,qf(this,O,S)}function Yf(S,O,j){var J=S.blockedBoundary;S.blockedSegment.status=3,J===null?(O.allPendingTasks--,O.status!==2&&(O.status=2,O.destination!==null&&O.destination.close())):(J.pendingTasks--,J.forceClientRender||(J.forceClientRender=!0,S=j===void 0?Error(e(432)):j,J.errorDigest=O.onError(S),J.parentFlushed&&O.clientRenderedBoundaries.push(J)),J.fallbackAbortableTasks.forEach(function(Se){return Yf(Se,O,j)}),J.fallbackAbortableTasks.clear(),O.allPendingTasks--,O.allPendingTasks===0&&(J=O.onAllReady,J()))}function Gc(S,O){if(O.chunks.length===0&&O.children.length===1&&O.children[0].boundary===null){var j=O.children[0];j.id=O.id,j.parentFlushed=!0,j.status===1&&Gc(S,j)}else S.completedSegments.push(O)}function qf(S,O,j){if(O===null){if(j.parentFlushed){if(S.completedRootSegment!==null)throw Error(e(389));S.completedRootSegment=j}S.pendingRootTasks--,S.pendingRootTasks===0&&(S.onShellError=$s,O=S.onShellReady,O())}else O.pendingTasks--,O.forceClientRender||(O.pendingTasks===0?(j.parentFlushed&&j.status===1&&Gc(O,j),O.parentFlushed&&S.completedBoundaries.push(O),O.fallbackAbortableTasks.forEach(pg,S),O.fallbackAbortableTasks.clear()):j.parentFlushed&&j.status===1&&(Gc(O,j),O.completedSegments.length===1&&O.parentFlushed&&S.partialBoundaries.push(O)));S.allPendingTasks--,S.allPendingTasks===0&&(S=S.onAllReady,S())}function ad(S){if(S.status!==2){var O=Vt,j=Er.current;Er.current=Wl;var J=jl;jl=S.responseState;try{var Se=S.pingedTasks,Ie;for(Ie=0;Ie<Se.length;Ie++){var Be=Se[Ie],ze=S,Et=Be.blockedSegment;if(Et.status===0){xi(Be.context);try{ti(ze,Be,Be.node),Et.lastPushedText&&Et.textEmbedded&&Et.chunks.push(K),Be.abortSet.delete(Be),Et.status=1,qf(ze,Be.blockedBoundary,Et)}catch(wi){if(Gl(),typeof wi=="object"&&wi!==null&&typeof wi.then=="function"){var Ht=Be.ping;wi.then(Ht,Ht)}else{Be.abortSet.delete(Be),Et.status=4;var Ft=Be.blockedBoundary,En=wi,Wr=Js(ze,En);if(Ft===null?ls(ze,En):(Ft.pendingTasks--,Ft.forceClientRender||(Ft.forceClientRender=!0,Ft.errorDigest=Wr,Ft.parentFlushed&&ze.clientRenderedBoundaries.push(Ft))),ze.allPendingTasks--,ze.allPendingTasks===0){var Ai=ze.onAllReady;Ai()}}}finally{}}}Se.splice(0,Ie),S.destination!==null&&ld(S,S.destination)}catch(wi){Js(S,wi),ls(S,wi)}finally{jl=J,Er.current=j,j===Wl&&xi(O)}}}function Wc(S,O,j){switch(j.parentFlushed=!0,j.status){case 0:var J=j.id=S.nextSegmentId++;return j.lastPushedText=!1,j.textEmbedded=!1,S=S.responseState,i(O,k),i(O,S.placeholderPrefix),S=u(J.toString(16)),i(O,S),o(O,D);case 1:j.status=2;var Se=!0;J=j.chunks;var Ie=0;j=j.children;for(var Be=0;Be<j.length;Be++){for(Se=j[Be];Ie<Se.index;Ie++)i(O,J[Ie]);Se=jc(S,O,Se)}for(;Ie<J.length-1;Ie++)i(O,J[Ie]);return Ie<J.length&&(Se=o(O,J[Ie])),Se;default:throw Error(e(390))}}function jc(S,O,j){var J=j.boundary;if(J===null)return Wc(S,O,j);if(J.parentFlushed=!0,J.forceClientRender)J=J.errorDigest,o(O,_e),i(O,Zt),J&&(i(O,Yt),i(O,u(_(J))),i(O,Xt)),o(O,zt),Wc(S,O,j);else if(0<J.pendingTasks){J.rootSegmentID=S.nextSegmentId++,0<J.completedSegments.length&&S.partialBoundaries.push(J);var Se=S.responseState,Ie=Se.nextSuspenseID++;Se=d(Se.boundaryPrefix+Ie.toString(16)),J=J.id=Se,xn(O,S.responseState,J),Wc(S,O,j)}else if(J.byteSize>S.progressiveChunkSize)J.rootSegmentID=S.nextSegmentId++,S.completedBoundaries.push(J),xn(O,S.responseState,J.id),Wc(S,O,j);else{if(o(O,X),j=J.completedSegments,j.length!==1)throw Error(e(391));jc(S,O,j[0])}return o(O,mt)}function Qf(S,O,j){return rt(O,S.responseState,j.formatContext,j.id),jc(S,O,j),It(O,j.formatContext)}function eh(S,O,j){for(var J=j.completedSegments,Se=0;Se<J.length;Se++)zc(S,O,j,J[Se]);if(J.length=0,S=S.responseState,J=j.id,j=j.rootSegmentID,i(O,S.startInlineScript),S.sentCompleteBoundaryFunction?i(O,tt):(S.sentCompleteBoundaryFunction=!0,i(O,De)),J===null)throw Error(e(395));return j=u(j.toString(16)),i(O,J),i(O,Qt),i(O,S.segmentPrefix),i(O,j),o(O,ln)}function zc(S,O,j,J){if(J.status===2)return!0;var Se=J.id;if(Se===-1){if((J.id=j.rootSegmentID)===-1)throw Error(e(392));return Qf(S,O,J)}return Qf(S,O,J),S=S.responseState,i(O,S.startInlineScript),S.sentCompleteSegmentFunction?i(O,kn):(S.sentCompleteSegmentFunction=!0,i(O,Gt)),i(O,S.segmentPrefix),Se=u(Se.toString(16)),i(O,Se),i(O,je),i(O,S.placeholderPrefix),i(O,Se),o(O,ne)}function ld(S,O){t=new Uint8Array(512),r=0;try{var j=S.completedRootSegment;if(j!==null&&S.pendingRootTasks===0){jc(S,O,j),S.completedRootSegment=null;var J=S.responseState.bootstrapChunks;for(j=0;j<J.length-1;j++)i(O,J[j]);j<J.length&&o(O,J[j])}var Se=S.clientRenderedBoundaries,Ie;for(Ie=0;Ie<Se.length;Ie++){var Be=Se[Ie];J=O;var ze=S.responseState,Et=Be.id,Ht=Be.errorDigest,Ft=Be.errorMessage,En=Be.errorComponentStack;if(i(J,ze.startInlineScript),ze.sentClientRenderFunction?i(J,tn):(ze.sentClientRenderFunction=!0,i(J,Ct)),Et===null)throw Error(e(395));i(J,Et),i(J,Vn),(Ht||Ft||En)&&(i(J,lr),i(J,u(Ot(Ht||"")))),(Ft||En)&&(i(J,lr),i(J,u(Ot(Ft||"")))),En&&(i(J,lr),i(J,u(Ot(En)))),o(J,Xn)}Se.splice(0,Ie);var Wr=S.completedBoundaries;for(Ie=0;Ie<Wr.length;Ie++)eh(S,O,Wr[Ie]);Wr.splice(0,Ie),a(O),t=new Uint8Array(512),r=0;var Ai=S.partialBoundaries;for(Ie=0;Ie<Ai.length;Ie++){var wi=Ai[Ie];e:{Se=S,Be=O;var Zl=wi.completedSegments;for(ze=0;ze<Zl.length;ze++)if(!zc(Se,Be,wi,Zl[ze])){ze++,Zl.splice(0,ze);var cd=!1;break e}Zl.splice(0,ze),cd=!0}if(!cd){S.destination=null,Ie++,Ai.splice(0,Ie);return}}Ai.splice(0,Ie);var cs=S.completedBoundaries;for(Ie=0;Ie<cs.length;Ie++)eh(S,O,cs[Ie]);cs.splice(0,Ie)}finally{a(O),S.allPendingTasks===0&&S.pingedTasks.length===0&&S.clientRenderedBoundaries.length===0&&S.completedBoundaries.length===0&&O.close()}}function th(S,O){try{var j=S.abortableTasks;j.forEach(function(J){return Yf(J,S,O)}),j.clear(),S.destination!==null&&ld(S,S.destination)}catch(J){Js(S,J),ls(S,J)}}return np.renderToReadableStream=function(S,O){return new Promise(function(j,J){var Se,Ie,Be=new Promise(function(Ft,En){Ie=Ft,Se=En}),ze=zl(S,de(O?O.identifierPrefix:void 0,O?O.nonce:void 0,O?O.bootstrapScriptContent:void 0,O?O.bootstrapScripts:void 0,O?O.bootstrapModules:void 0),be(O?O.namespaceURI:void 0),O?O.progressiveChunkSize:void 0,O?O.onError:void 0,Ie,function(){var Ft=new ReadableStream({type:"bytes",pull:function(En){if(ze.status===1)ze.status=2,f(En,ze.fatalError);else if(ze.status!==2&&ze.destination===null){ze.destination=En;try{ld(ze,En)}catch(Wr){Js(ze,Wr),ls(ze,Wr)}}},cancel:function(){th(ze)}},{highWaterMark:0});Ft.allReady=Be,j(Ft)},function(Ft){Be.catch(function(){}),J(Ft)},Se);if(O&&O.signal){var Et=O.signal,Ht=function(){th(ze,Et.reason),Et.removeEventListener("abort",Ht)};Et.addEventListener("abort",Ht)}ad(ze)})},np.version="18.3.1",np}var fA;function tM(){if(fA)return dl;fA=1;var n,e;return n=QF(),e=eM(),dl.version=n.version,dl.renderToString=n.renderToString,dl.renderToStaticMarkup=n.renderToStaticMarkup,dl.renderToNodeStream=n.renderToNodeStream,dl.renderToStaticNodeStream=n.renderToStaticNodeStream,dl.renderToReadableStream=e.renderToReadableStream,dl}var nM=tM();const hA=Dl(nM);/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Gk,setPrototypeOf:pA,isFrozen:rM,getPrototypeOf:iM,getOwnPropertyDescriptor:oM}=Object;let{freeze:pi,seal:po,create:Wk}=Object,{apply:eC,construct:tC}=typeof Reflect<"u"&&Reflect;pi||(pi=function(e){return e});po||(po=function(e){return e});eC||(eC=function(e,t,r){return e.apply(t,r)});tC||(tC=function(e,t){return new e(...t)});const rp=gi(Array.prototype.forEach),sM=gi(Array.prototype.lastIndexOf),gA=gi(Array.prototype.pop),Vd=gi(Array.prototype.push),aM=gi(Array.prototype.splice),Qp=gi(String.prototype.toLowerCase),Jm=gi(String.prototype.toString),mA=gi(String.prototype.match),Gd=gi(String.prototype.replace),lM=gi(String.prototype.indexOf),cM=gi(String.prototype.trim),Eo=gi(Object.prototype.hasOwnProperty),ii=gi(RegExp.prototype.test),Wd=uM(TypeError);function gi(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return eC(n,e,r)}}function uM(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return tC(n,t)}}function en(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qp;pA&&pA(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=t(i);o!==i&&(rM(e)||(e[r]=o),i=o)}n[i]=!0}return n}function dM(n){for(let e=0;e<n.length;e++)Eo(n,e)||(n[e]=null);return n}function oa(n){const e=Wk(null);for(const[t,r]of Gk(n))Eo(n,t)&&(Array.isArray(r)?e[t]=dM(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=oa(r):e[t]=r);return e}function jd(n,e){for(;n!==null;){const r=oM(n,e);if(r){if(r.get)return gi(r.get);if(typeof r.value=="function")return gi(r.value)}n=iM(n)}function t(){return null}return t}const vA=pi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ym=pi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qm=pi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),fM=pi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Qm=pi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),hM=pi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),CA=pi(["#text"]),yA=pi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ev=pi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),xA=pi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ip=pi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),pM=po(/\{\{[\w\W]*|[\w\W]*\}\}/gm),gM=po(/<%[\w\W]*|[\w\W]*%>/gm),mM=po(/\$\{[\w\W]*/gm),vM=po(/^data-[\-\w.\u00B7-\uFFFF]+$/),CM=po(/^aria-[\-\w]+$/),jk=po(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yM=po(/^(?:\w+script|data):/i),xM=po(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zk=po(/^html$/i),IM=po(/^[a-z][.\w]*(-[.\w]+)+$/i);var IA=Object.freeze({__proto__:null,ARIA_ATTR:CM,ATTR_WHITESPACE:xM,CUSTOM_ELEMENT:IM,DATA_ATTR:vM,DOCTYPE_NAME:zk,ERB_EXPR:gM,IS_ALLOWED_URI:jk,IS_SCRIPT_OR_DATA:yM,MUSTACHE_EXPR:pM,TMPLIT_EXPR:mM});const zd={element:1,text:3,progressingInstruction:7,comment:8,document:9},bM=function(){return typeof window>"u"?null:window},AM=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},bA=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Hk(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bM();const e=je=>Hk(je);if(e.version="3.2.6",e.removed=[],!n||!n.document||n.document.nodeType!==zd.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:l,Element:u,NodeFilter:d,NamedNodeMap:f=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:p,DOMParser:g,trustedTypes:v}=n,C=u.prototype,y=jd(C,"cloneNode"),x=jd(C,"remove"),I=jd(C,"nextSibling"),b=jd(C,"childNodes"),T=jd(C,"parentNode");if(typeof a=="function"){const je=t.createElement("template");je.content&&je.content.ownerDocument&&(t=je.content.ownerDocument)}let R,P="";const{implementation:B,createNodeIterator:_,createDocumentFragment:M,getElementsByTagName:H}=t,{importNode:V}=r;let U=bA();e.isSupported=typeof Gk=="function"&&typeof T=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Z,ERB_EXPR:q,TMPLIT_EXPR:ie,DATA_ATTR:le,ARIA_ATTR:Ce,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:de,CUSTOM_ELEMENT:pe}=IA;let{IS_ALLOWED_URI:be}=IA,L=null;const K=en({},[...vA,...Ym,...qm,...Qm,...CA]);let ue=null;const he=en({},[...yA,...ev,...xA,...ip]);let Ee=Object.seal(Wk(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Fe=null,Je=null,Te=!0,ft=!0,Nt=!1,rn=!0,Rt=!1,yt=!0,Pt=!1,He=!1,$e=!1,bt=!1,xt=!1,ct=!1,At=!0,Ut=!1;const kt="user-content-";let jt=!0,fn=!1,sn={},yn=null;const W=en({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let k=null;const D=en({},["audio","video","img","source","image","track"]);let X=null;const se=en({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),xe="http://www.w3.org/1998/Math/MathML",_e="http://www.w3.org/2000/svg",mt="http://www.w3.org/1999/xhtml";let Zt=mt,Xt=!1,Yt=null;const zt=en({},[xe,_e,mt],Jm);let xn=en({},["mi","mo","mn","ms","mtext"]),ir=en({},["annotation-xml"]);const qn=en({},["title","style","font","a","script"]);let Bt=null;const Mr=["application/xhtml+xml","text/html"],Lr="text/html";let an=null,Rn=null;const Cr=t.createElement("form"),zn=function(ne){return ne instanceof RegExp||ne instanceof Function},Ur=function(){let ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Rn&&Rn===ne)){if((!ne||typeof ne!="object")&&(ne={}),ne=oa(ne),Bt=Mr.indexOf(ne.PARSER_MEDIA_TYPE)===-1?Lr:ne.PARSER_MEDIA_TYPE,an=Bt==="application/xhtml+xml"?Jm:Qp,L=Eo(ne,"ALLOWED_TAGS")?en({},ne.ALLOWED_TAGS,an):K,ue=Eo(ne,"ALLOWED_ATTR")?en({},ne.ALLOWED_ATTR,an):he,Yt=Eo(ne,"ALLOWED_NAMESPACES")?en({},ne.ALLOWED_NAMESPACES,Jm):zt,X=Eo(ne,"ADD_URI_SAFE_ATTR")?en(oa(se),ne.ADD_URI_SAFE_ATTR,an):se,k=Eo(ne,"ADD_DATA_URI_TAGS")?en(oa(D),ne.ADD_DATA_URI_TAGS,an):D,yn=Eo(ne,"FORBID_CONTENTS")?en({},ne.FORBID_CONTENTS,an):W,Fe=Eo(ne,"FORBID_TAGS")?en({},ne.FORBID_TAGS,an):oa({}),Je=Eo(ne,"FORBID_ATTR")?en({},ne.FORBID_ATTR,an):oa({}),sn=Eo(ne,"USE_PROFILES")?ne.USE_PROFILES:!1,Te=ne.ALLOW_ARIA_ATTR!==!1,ft=ne.ALLOW_DATA_ATTR!==!1,Nt=ne.ALLOW_UNKNOWN_PROTOCOLS||!1,rn=ne.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Rt=ne.SAFE_FOR_TEMPLATES||!1,yt=ne.SAFE_FOR_XML!==!1,Pt=ne.WHOLE_DOCUMENT||!1,bt=ne.RETURN_DOM||!1,xt=ne.RETURN_DOM_FRAGMENT||!1,ct=ne.RETURN_TRUSTED_TYPE||!1,$e=ne.FORCE_BODY||!1,At=ne.SANITIZE_DOM!==!1,Ut=ne.SANITIZE_NAMED_PROPS||!1,jt=ne.KEEP_CONTENT!==!1,fn=ne.IN_PLACE||!1,be=ne.ALLOWED_URI_REGEXP||jk,Zt=ne.NAMESPACE||mt,xn=ne.MATHML_TEXT_INTEGRATION_POINTS||xn,ir=ne.HTML_INTEGRATION_POINTS||ir,Ee=ne.CUSTOM_ELEMENT_HANDLING||{},ne.CUSTOM_ELEMENT_HANDLING&&zn(ne.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=ne.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ne.CUSTOM_ELEMENT_HANDLING&&zn(ne.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=ne.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ne.CUSTOM_ELEMENT_HANDLING&&typeof ne.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=ne.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Rt&&(ft=!1),xt&&(bt=!0),sn&&(L=en({},CA),ue=[],sn.html===!0&&(en(L,vA),en(ue,yA)),sn.svg===!0&&(en(L,Ym),en(ue,ev),en(ue,ip)),sn.svgFilters===!0&&(en(L,qm),en(ue,ev),en(ue,ip)),sn.mathMl===!0&&(en(L,Qm),en(ue,xA),en(ue,ip))),ne.ADD_TAGS&&(L===K&&(L=oa(L)),en(L,ne.ADD_TAGS,an)),ne.ADD_ATTR&&(ue===he&&(ue=oa(ue)),en(ue,ne.ADD_ATTR,an)),ne.ADD_URI_SAFE_ATTR&&en(X,ne.ADD_URI_SAFE_ATTR,an),ne.FORBID_CONTENTS&&(yn===W&&(yn=oa(yn)),en(yn,ne.FORBID_CONTENTS,an)),jt&&(L["#text"]=!0),Pt&&en(L,["html","head","body"]),L.table&&(en(L,["tbody"]),delete Fe.tbody),ne.TRUSTED_TYPES_POLICY){if(typeof ne.TRUSTED_TYPES_POLICY.createHTML!="function")throw Wd('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ne.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Wd('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=ne.TRUSTED_TYPES_POLICY,P=R.createHTML("")}else R===void 0&&(R=AM(v,i)),R!==null&&typeof P=="string"&&(P=R.createHTML(""));pi&&pi(ne),Rn=ne}},yr=en({},[...Ym,...qm,...fM]),re=en({},[...Qm,...hM]),ce=function(ne){let De=T(ne);(!De||!De.tagName)&&(De={namespaceURI:Zt,tagName:"template"});const tt=Qp(ne.tagName),Qt=Qp(De.tagName);return Yt[ne.namespaceURI]?ne.namespaceURI===_e?De.namespaceURI===mt?tt==="svg":De.namespaceURI===xe?tt==="svg"&&(Qt==="annotation-xml"||xn[Qt]):!!yr[tt]:ne.namespaceURI===xe?De.namespaceURI===mt?tt==="math":De.namespaceURI===_e?tt==="math"&&ir[Qt]:!!re[tt]:ne.namespaceURI===mt?De.namespaceURI===_e&&!ir[Qt]||De.namespaceURI===xe&&!xn[Qt]?!1:!re[tt]&&(qn[tt]||!yr[tt]):!!(Bt==="application/xhtml+xml"&&Yt[ne.namespaceURI]):!1},ve=function(ne){Vd(e.removed,{element:ne});try{T(ne).removeChild(ne)}catch{x(ne)}},Oe=function(ne,De){try{Vd(e.removed,{attribute:De.getAttributeNode(ne),from:De})}catch{Vd(e.removed,{attribute:null,from:De})}if(De.removeAttribute(ne),ne==="is")if(bt||xt)try{ve(De)}catch{}else try{De.setAttribute(ne,"")}catch{}},Ze=function(ne){let De=null,tt=null;if($e)ne="<remove></remove>"+ne;else{const Ct=mA(ne,/^[\r\n\t ]+/);tt=Ct&&Ct[0]}Bt==="application/xhtml+xml"&&Zt===mt&&(ne='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ne+"</body></html>");const Qt=R?R.createHTML(ne):ne;if(Zt===mt)try{De=new g().parseFromString(Qt,Bt)}catch{}if(!De||!De.documentElement){De=B.createDocument(Zt,"template",null);try{De.documentElement.innerHTML=Xt?P:Qt}catch{}}const ln=De.body||De.documentElement;return ne&&tt&&ln.insertBefore(t.createTextNode(tt),ln.childNodes[0]||null),Zt===mt?H.call(De,Pt?"html":"body")[0]:Pt?De.documentElement:ln},st=function(ne){return _.call(ne.ownerDocument||ne,ne,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},gt=function(ne){return ne instanceof p&&(typeof ne.nodeName!="string"||typeof ne.textContent!="string"||typeof ne.removeChild!="function"||!(ne.attributes instanceof f)||typeof ne.removeAttribute!="function"||typeof ne.setAttribute!="function"||typeof ne.namespaceURI!="string"||typeof ne.insertBefore!="function"||typeof ne.hasChildNodes!="function")},nt=function(ne){return typeof l=="function"&&ne instanceof l};function Ye(je,ne,De){rp(je,tt=>{tt.call(e,ne,De,Rn)})}const et=function(ne){let De=null;if(Ye(U.beforeSanitizeElements,ne,null),gt(ne))return ve(ne),!0;const tt=an(ne.nodeName);if(Ye(U.uponSanitizeElement,ne,{tagName:tt,allowedTags:L}),yt&&ne.hasChildNodes()&&!nt(ne.firstElementChild)&&ii(/<[/\w!]/g,ne.innerHTML)&&ii(/<[/\w!]/g,ne.textContent)||ne.nodeType===zd.progressingInstruction||yt&&ne.nodeType===zd.comment&&ii(/<[/\w]/g,ne.data))return ve(ne),!0;if(!L[tt]||Fe[tt]){if(!Fe[tt]&&It(tt)&&(Ee.tagNameCheck instanceof RegExp&&ii(Ee.tagNameCheck,tt)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(tt)))return!1;if(jt&&!yn[tt]){const Qt=T(ne)||ne.parentNode,ln=b(ne)||ne.childNodes;if(ln&&Qt){const Ct=ln.length;for(let tn=Ct-1;tn>=0;--tn){const Vn=y(ln[tn],!0);Vn.__removalCount=(ne.__removalCount||0)+1,Qt.insertBefore(Vn,I(ne))}}}return ve(ne),!0}return ne instanceof u&&!ce(ne)||(tt==="noscript"||tt==="noembed"||tt==="noframes")&&ii(/<\/no(script|embed|frames)/i,ne.innerHTML)?(ve(ne),!0):(Rt&&ne.nodeType===zd.text&&(De=ne.textContent,rp([Z,q,ie],Qt=>{De=Gd(De,Qt," ")}),ne.textContent!==De&&(Vd(e.removed,{element:ne.cloneNode()}),ne.textContent=De)),Ye(U.afterSanitizeElements,ne,null),!1)},rt=function(ne,De,tt){if(At&&(De==="id"||De==="name")&&(tt in t||tt in Cr))return!1;if(!(ft&&!Je[De]&&ii(le,De))){if(!(Te&&ii(Ce,De))){if(!ue[De]||Je[De]){if(!(It(ne)&&(Ee.tagNameCheck instanceof RegExp&&ii(Ee.tagNameCheck,ne)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(ne))&&(Ee.attributeNameCheck instanceof RegExp&&ii(Ee.attributeNameCheck,De)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(De))||De==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&ii(Ee.tagNameCheck,tt)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(tt))))return!1}else if(!X[De]){if(!ii(be,Gd(tt,de,""))){if(!((De==="src"||De==="xlink:href"||De==="href")&&ne!=="script"&&lM(tt,"data:")===0&&k[ne])){if(!(Nt&&!ii(Re,Gd(tt,de,"")))){if(tt)return!1}}}}}}return!0},It=function(ne){return ne!=="annotation-xml"&&mA(ne,pe)},Gt=function(ne){Ye(U.beforeSanitizeAttributes,ne,null);const{attributes:De}=ne;if(!De||gt(ne))return;const tt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ue,forceKeepAttr:void 0};let Qt=De.length;for(;Qt--;){const ln=De[Qt],{name:Ct,namespaceURI:tn,value:Vn}=ln,Xn=an(Ct),lr=Vn;let In=Ct==="value"?lr:cM(lr);if(tt.attrName=Xn,tt.attrValue=In,tt.keepAttr=!0,tt.forceKeepAttr=void 0,Ye(U.uponSanitizeAttribute,ne,tt),In=tt.attrValue,Ut&&(Xn==="id"||Xn==="name")&&(Oe(Ct,ne),In=kt+In),yt&&ii(/((--!?|])>)|<\/(style|title)/i,In)){Oe(Ct,ne);continue}if(tt.forceKeepAttr)continue;if(!tt.keepAttr){Oe(Ct,ne);continue}if(!rn&&ii(/\/>/i,In)){Oe(Ct,ne);continue}Rt&&rp([Z,q,ie],Jt=>{In=Gd(In,Jt," ")});const Ot=an(ne.nodeName);if(!rt(Ot,Xn,In)){Oe(Ct,ne);continue}if(R&&typeof v=="object"&&typeof v.getAttributeType=="function"&&!tn)switch(v.getAttributeType(Ot,Xn)){case"TrustedHTML":{In=R.createHTML(In);break}case"TrustedScriptURL":{In=R.createScriptURL(In);break}}if(In!==lr)try{tn?ne.setAttributeNS(tn,Ct,In):ne.setAttribute(Ct,In),gt(ne)?ve(ne):gA(e.removed)}catch{Oe(Ct,ne)}}Ye(U.afterSanitizeAttributes,ne,null)},kn=function je(ne){let De=null;const tt=st(ne);for(Ye(U.beforeSanitizeShadowDOM,ne,null);De=tt.nextNode();)Ye(U.uponSanitizeShadowNode,De,null),et(De),Gt(De),De.content instanceof o&&je(De.content);Ye(U.afterSanitizeShadowDOM,ne,null)};return e.sanitize=function(je){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},De=null,tt=null,Qt=null,ln=null;if(Xt=!je,Xt&&(je="<!-->"),typeof je!="string"&&!nt(je))if(typeof je.toString=="function"){if(je=je.toString(),typeof je!="string")throw Wd("dirty is not a string, aborting")}else throw Wd("toString is not a function");if(!e.isSupported)return je;if(He||Ur(ne),e.removed=[],typeof je=="string"&&(fn=!1),fn){if(je.nodeName){const Vn=an(je.nodeName);if(!L[Vn]||Fe[Vn])throw Wd("root node is forbidden and cannot be sanitized in-place")}}else if(je instanceof l)De=Ze("<!---->"),tt=De.ownerDocument.importNode(je,!0),tt.nodeType===zd.element&&tt.nodeName==="BODY"||tt.nodeName==="HTML"?De=tt:De.appendChild(tt);else{if(!bt&&!Rt&&!Pt&&je.indexOf("<")===-1)return R&&ct?R.createHTML(je):je;if(De=Ze(je),!De)return bt?null:ct?P:""}De&&$e&&ve(De.firstChild);const Ct=st(fn?je:De);for(;Qt=Ct.nextNode();)et(Qt),Gt(Qt),Qt.content instanceof o&&kn(Qt.content);if(fn)return je;if(bt){if(xt)for(ln=M.call(De.ownerDocument);De.firstChild;)ln.appendChild(De.firstChild);else ln=De;return(ue.shadowroot||ue.shadowrootmode)&&(ln=V.call(r,ln,!0)),ln}let tn=Pt?De.outerHTML:De.innerHTML;return Pt&&L["!doctype"]&&De.ownerDocument&&De.ownerDocument.doctype&&De.ownerDocument.doctype.name&&ii(zk,De.ownerDocument.doctype.name)&&(tn="<!DOCTYPE "+De.ownerDocument.doctype.name+`>
`+tn),Rt&&rp([Z,q,ie],Vn=>{tn=Gd(tn,Vn," ")}),R&&ct?R.createHTML(tn):tn},e.setConfig=function(){let je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ur(je),He=!0},e.clearConfig=function(){Rn=null,He=!1},e.isValidAttribute=function(je,ne,De){Rn||Ur({});const tt=an(je),Qt=an(ne);return rt(tt,Qt,De)},e.addHook=function(je,ne){typeof ne=="function"&&Vd(U[je],ne)},e.removeHook=function(je,ne){if(ne!==void 0){const De=sM(U[je],ne);return De===-1?void 0:aM(U[je],De,1)[0]}return gA(U[je])},e.removeHooks=function(je){U[je]=[]},e.removeAllHooks=function(){U=bA()},e}var wM=Hk();function SM(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}return n}function nC(n,e){return Array(e+1).join(n)}function kM(n){return n.replace(/^\n*/,"")}function EM(n){for(var e=n.length;e>0&&n[e-1]===`
`;)e--;return n.substring(0,e)}var TM=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function yy(n){return xy(n,TM)}var Zk=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function Xk(n){return xy(n,Zk)}function RM(n){return $k(n,Zk)}var Kk=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function _M(n){return xy(n,Kk)}function PM(n){return $k(n,Kk)}function xy(n,e){return e.indexOf(n.nodeName)>=0}function $k(n,e){return n.getElementsByTagName&&e.some(function(t){return n.getElementsByTagName(t).length})}var Qr={};Qr.paragraph={filter:"p",replacement:function(n){return`

`+n+`

`}};Qr.lineBreak={filter:"br",replacement:function(n,e,t){return t.br+`
`}};Qr.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(n,e,t){var r=Number(e.nodeName.charAt(1));if(t.headingStyle==="setext"&&r<3){var i=nC(r===1?"=":"-",n.length);return`

`+n+`
`+i+`

`}else return`

`+nC("#",r)+" "+n+`

`}};Qr.blockquote={filter:"blockquote",replacement:function(n){return n=n.replace(/^\n+|\n+$/g,""),n=n.replace(/^/gm,"> "),`

`+n+`

`}};Qr.list={filter:["ul","ol"],replacement:function(n,e){var t=e.parentNode;return t.nodeName==="LI"&&t.lastElementChild===e?`
`+n:`

`+n+`

`}};Qr.listItem={filter:"li",replacement:function(n,e,t){n=n.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=t.bulletListMarker+"   ",i=e.parentNode;if(i.nodeName==="OL"){var o=i.getAttribute("start"),a=Array.prototype.indexOf.call(i.children,e);r=(o?Number(o)+a:a+1)+".  "}return r+n+(e.nextSibling&&!/\n$/.test(n)?`
`:"")}};Qr.indentedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="indented"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){return`

    `+e.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Qr.fencedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="fenced"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){for(var r=e.firstChild.getAttribute("class")||"",i=(r.match(/language-(\S+)/)||[null,""])[1],o=e.firstChild.textContent,a=t.fence.charAt(0),l=3,u=new RegExp("^"+a+"{3,}","gm"),d;d=u.exec(o);)d[0].length>=l&&(l=d[0].length+1);var f=nC(a,l);return`

`+f+i+`
`+o.replace(/\n$/,"")+`
`+f+`

`}};Qr.horizontalRule={filter:"hr",replacement:function(n,e,t){return`

`+t.hr+`

`}};Qr.inlineLink={filter:function(n,e){return e.linkStyle==="inlined"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e){var t=e.getAttribute("href");t&&(t=t.replace(/([()])/g,"\\$1"));var r=E0(e.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+n+"]("+t+r+")"}};Qr.referenceLink={filter:function(n,e){return e.linkStyle==="referenced"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e,t){var r=e.getAttribute("href"),i=E0(e.getAttribute("title"));i&&(i=' "'+i+'"');var o,a;switch(t.linkReferenceStyle){case"collapsed":o="["+n+"][]",a="["+n+"]: "+r+i;break;case"shortcut":o="["+n+"]",a="["+n+"]: "+r+i;break;default:var l=this.references.length+1;o="["+n+"]["+l+"]",a="["+l+"]: "+r+i}return this.references.push(a),o},references:[],append:function(n){var e="";return this.references.length&&(e=`

`+this.references.join(`
`)+`

`,this.references=[]),e}};Qr.emphasis={filter:["em","i"],replacement:function(n,e,t){return n.trim()?t.emDelimiter+n+t.emDelimiter:""}};Qr.strong={filter:["strong","b"],replacement:function(n,e,t){return n.trim()?t.strongDelimiter+n+t.strongDelimiter:""}};Qr.code={filter:function(n){var e=n.previousSibling||n.nextSibling,t=n.parentNode.nodeName==="PRE"&&!e;return n.nodeName==="CODE"&&!t},replacement:function(n){if(!n)return"";n=n.replace(/\r?\n|\r/g," ");for(var e=/^`|^ .*?[^ ].* $|`$/.test(n)?" ":"",t="`",r=n.match(/`+/gm)||[];r.indexOf(t)!==-1;)t=t+"`";return t+e+n+e+t}};Qr.image={filter:"img",replacement:function(n,e){var t=E0(e.getAttribute("alt")),r=e.getAttribute("src")||"",i=E0(e.getAttribute("title")),o=i?' "'+i+'"':"";return r?"!["+t+"]("+r+o+")":""}};function E0(n){return n?n.replace(/(\n+\s*)+/g,`
`):""}function Jk(n){this.options=n,this._keep=[],this._remove=[],this.blankRule={replacement:n.blankReplacement},this.keepReplacement=n.keepReplacement,this.defaultRule={replacement:n.defaultReplacement},this.array=[];for(var e in n.rules)this.array.push(n.rules[e])}Jk.prototype={add:function(n,e){this.array.unshift(e)},keep:function(n){this._keep.unshift({filter:n,replacement:this.keepReplacement})},remove:function(n){this._remove.unshift({filter:n,replacement:function(){return""}})},forNode:function(n){if(n.isBlank)return this.blankRule;var e;return(e=tv(this.array,n,this.options))||(e=tv(this._keep,n,this.options))||(e=tv(this._remove,n,this.options))?e:this.defaultRule},forEach:function(n){for(var e=0;e<this.array.length;e++)n(this.array[e],e)}};function tv(n,e,t){for(var r=0;r<n.length;r++){var i=n[r];if(DM(i,e,t))return i}}function DM(n,e,t){var r=n.filter;if(typeof r=="string"){if(r===e.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(e.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(n,e,t))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function NM(n){var e=n.element,t=n.isBlock,r=n.isVoid,i=n.isPre||function(p){return p.nodeName==="PRE"};if(!(!e.firstChild||i(e))){for(var o=null,a=!1,l=null,u=AA(l,e,i);u!==e;){if(u.nodeType===3||u.nodeType===4){var d=u.data.replace(/[ \r\n\t]+/g," ");if((!o||/ $/.test(o.data))&&!a&&d[0]===" "&&(d=d.substr(1)),!d){u=nv(u);continue}u.data=d,o=u}else if(u.nodeType===1)t(u)||u.nodeName==="BR"?(o&&(o.data=o.data.replace(/ $/,"")),o=null,a=!1):r(u)||i(u)?(o=null,a=!0):o&&(a=!1);else{u=nv(u);continue}var f=AA(l,u,i);l=u,u=f}o&&(o.data=o.data.replace(/ $/,""),o.data||nv(o))}}function nv(n){var e=n.nextSibling||n.parentNode;return n.parentNode.removeChild(n),e}function AA(n,e,t){return n&&n.parentNode===e||t(e)?e.nextSibling||e.parentNode:e.firstChild||e.nextSibling||e.parentNode}var Iy=typeof window<"u"?window:{};function BM(){var n=Iy.DOMParser,e=!1;try{new n().parseFromString("","text/html")&&(e=!0)}catch{}return e}function OM(){var n=function(){};return FM()?n.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:n.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},n}function FM(){var n=!1;try{document.implementation.createHTMLDocument("").open()}catch{Iy.ActiveXObject&&(n=!0)}return n}var MM=BM()?Iy.DOMParser:OM();function LM(n,e){var t;if(typeof n=="string"){var r=UM().parseFromString('<x-turndown id="turndown-root">'+n+"</x-turndown>","text/html");t=r.getElementById("turndown-root")}else t=n.cloneNode(!0);return NM({element:t,isBlock:yy,isVoid:Xk,isPre:e.preformattedCode?VM:null}),t}var rv;function UM(){return rv=rv||new MM,rv}function VM(n){return n.nodeName==="PRE"||n.nodeName==="CODE"}function GM(n,e){return n.isBlock=yy(n),n.isCode=n.nodeName==="CODE"||n.parentNode.isCode,n.isBlank=WM(n),n.flankingWhitespace=jM(n,e),n}function WM(n){return!Xk(n)&&!_M(n)&&/^\s*$/i.test(n.textContent)&&!RM(n)&&!PM(n)}function jM(n,e){if(n.isBlock||e.preformattedCode&&n.isCode)return{leading:"",trailing:""};var t=zM(n.textContent);return t.leadingAscii&&wA("left",n,e)&&(t.leading=t.leadingNonAscii),t.trailingAscii&&wA("right",n,e)&&(t.trailing=t.trailingNonAscii),{leading:t.leading,trailing:t.trailing}}function zM(n){var e=n.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:e[1],leadingAscii:e[2],leadingNonAscii:e[3],trailing:e[4],trailingNonAscii:e[5],trailingAscii:e[6]}}function wA(n,e,t){var r,i,o;return n==="left"?(r=e.previousSibling,i=/ $/):(r=e.nextSibling,i=/^ /),r&&(r.nodeType===3?o=i.test(r.nodeValue):t.preformattedCode&&r.nodeName==="CODE"?o=!1:r.nodeType===1&&!yy(r)&&(o=i.test(r.textContent))),o}var HM=Array.prototype.reduce,ZM=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function T0(n){if(!(this instanceof T0))return new T0(n);var e={rules:Qr,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(t,r){return r.isBlock?`

`:""},keepReplacement:function(t,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(t,r){return r.isBlock?`

`+t+`

`:t}};this.options=SM({},e,n),this.rules=new Jk(this.options)}T0.prototype={turndown:function(n){if(!$M(n))throw new TypeError(n+" is not a string, or an element/document/fragment node.");if(n==="")return"";var e=Yk.call(this,new LM(n,this.options));return XM.call(this,e)},use:function(n){if(Array.isArray(n))for(var e=0;e<n.length;e++)this.use(n[e]);else if(typeof n=="function")n(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(n,e){return this.rules.add(n,e),this},keep:function(n){return this.rules.keep(n),this},remove:function(n){return this.rules.remove(n),this},escape:function(n){return ZM.reduce(function(e,t){return e.replace(t[0],t[1])},n)}};function Yk(n){var e=this;return HM.call(n.childNodes,function(t,r){r=new GM(r,e.options);var i="";return r.nodeType===3?i=r.isCode?r.nodeValue:e.escape(r.nodeValue):r.nodeType===1&&(i=KM.call(e,r)),qk(t,i)},"")}function XM(n){var e=this;return this.rules.forEach(function(t){typeof t.append=="function"&&(n=qk(n,t.append(e.options)))}),n.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function KM(n){var e=this.rules.forNode(n),t=Yk.call(this,n),r=n.flankingWhitespace;return(r.leading||r.trailing)&&(t=t.trim()),r.leading+e.replacement(t,n,this.options)+r.trailing}function qk(n,e){var t=EM(n),r=kM(e),i=Math.max(n.length-t.length,e.length-r.length),o=`

`.substring(0,i);return t+o+r}function $M(n){return n!=null&&(typeof n=="string"||n.nodeType&&(n.nodeType===1||n.nodeType===9||n.nodeType===11))}const SA=1,JM=2,Ro=class Ro extends Lt.Component{constructor(t){super(t);ee(this,"outputRef",Lt.createRef());ee(this,"messageKey",0);ee(this,"unsubscribePrefs");ee(this,"turndownService",new T0({headingStyle:"atx",emDelimiter:"*"}));ee(this,"handlePreferencesChange",()=>{this.setState({localEchoActive:li.getState().general.localEcho})});ee(this,"saveOutput",()=>{const t=this.state.output.map(i=>{let o="";const a=i.content.props;if(a.dangerouslySetInnerHTML&&a.dangerouslySetInnerHTML.__html)o=a.dangerouslySetInnerHTML.__html;else if(a.children){const l=a.children;Lt.isValidElement(l)&&l.props.dangerouslySetInnerHTML&&l.props.dangerouslySetInnerHTML.__html?o=l.props.dangerouslySetInnerHTML.__html:Lt.isValidElement(l)||Array.isArray(l)&&l.every(u=>Lt.isValidElement(u)||typeof u=="string")?o=hA.renderToStaticMarkup(l):typeof l=="string"?o=l:(console.warn("Unexpected children structure in OutputLine for saving:",l),o="")}return{type:i.type,htmlContent:o}}).filter(i=>i.htmlContent!==""),r={version:SA,lines:t};localStorage.setItem(Ro.LOCAL_STORAGE_KEY,JSON.stringify(r))});ee(this,"loadOutput",()=>{const t=localStorage.getItem(Ro.LOCAL_STORAGE_KEY);if(t)try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"version"in r&&"lines"in r){const i=r;return i.version===SA?i.lines.map(o=>{const a=this.messageKey++;return{id:a,type:o.type,content:Lt.createElement("div",{key:a,className:`output-line output-line-${o.type}`,dangerouslySetInnerHTML:{__html:o.htmlContent}})}}):(console.warn(`Unsupported log version: ${i.version}. Discarding.`),localStorage.removeItem(Ro.LOCAL_STORAGE_KEY),[])}else return Array.isArray(r)?(console.log("Loading old format output log."),r.map(o=>{const a=this.messageKey++;return{id:a,type:"serverMessage",content:Lt.createElement("div",{key:a,className:"output-line output-line-serverMessage",dangerouslySetInnerHTML:{__html:o}})}})):(console.error("Saved output log is in an unrecognized format:",r),localStorage.removeItem(Ro.LOCAL_STORAGE_KEY),[])}catch(r){return console.error("Failed to parse saved output log:",r),localStorage.removeItem(Ro.LOCAL_STORAGE_KEY),[]}return[]});ee(this,"addCommand",t=>{this.addToOutput([oe.jsx("span",{className:"command","aria-live":"off",children:t})],"command",!1)});ee(this,"addError",t=>this.addToOutput([oe.jsxs("h2",{children:[" Error: ",t.message]})],"errorMessage"));ee(this,"handleConnected",()=>this.addToOutput([oe.jsx("h2",{children:" Connected"})],"systemInfo"));ee(this,"handleDisconnected",()=>{this.addToOutput([oe.jsx("h2",{children:" Disconnected"})],"systemInfo"),this.setState({sidebarVisible:!1})});ee(this,"handleUserList",t=>this.setState({sidebarVisible:!!t}));ee(this,"addCopyButtons",()=>{const t=this.outputRef.current;if(!t)return;t.querySelectorAll("blockquote:not(:has(.blockquote-copy-button))").forEach(i=>{const o=document.createElement("button");o.classList.add("blockquote-copy-button"),o.textContent="Copy",o.setAttribute("type","button"),window.getComputedStyle(i).position==="static"&&(i.style.position="relative"),i.appendChild(o)})});ee(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});ee(this,"isScrolledToBottom",()=>{const t=this.outputRef.current;if(!t)return!1;const r=Math.ceil(t.scrollHeight-t.scrollTop),i=Math.ceil(t.clientHeight);return r<=i+JM});ee(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});ee(this,"scrollToBottom",()=>{const t=this.outputRef.current;t&&requestAnimationFrame(()=>{t.scrollTop=t.scrollHeight})});ee(this,"handleMessage",t=>{if(!t)return;const r=XF(t,this.handleExitClick);this.addToOutput(r,"serverMessage")});ee(this,"handleHtml",t=>{const r=wM.sanitize(t),i=oe.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i],"serverMessage")});ee(this,"handleExitClick",t=>{this.props.client.sendCommand(t)});ee(this,"handleDataTextClick",t=>{var a,l;const r=t.target,i=r.closest(".blockquote-copy-button");if(i instanceof HTMLButtonElement){t.preventDefault(),t.stopPropagation();const u=i.closest("blockquote");if(u){const d=u.cloneNode(!0),f=d.querySelector(".blockquote-copy-button");f&&f.remove();let p;if(u.dataset.contentType==="text/markdown"){const v=d.innerHTML;p=this.turndownService.turndown(v)}else p=d.textContent||"";navigator.clipboard.writeText(p.trim()).then(()=>{i.textContent="Copied!",i.classList.add("copied"),setTimeout(()=>{i.textContent="Copy",i.classList.remove("copied")},1500)}).catch(v=>{console.error("Failed to copy text: ",v),i.textContent="Error",setTimeout(()=>{i.textContent="Copy"},1500)})}return}const o=r.closest("a.command[data-text]");if(o instanceof HTMLAnchorElement){t.preventDefault();const u=o.dataset.text;u!=null&&(cc(u),(l=(a=this.props).focusInput)==null||l.call(a))}});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0,localEchoActive:li.getState().general.localEcho}}getSnapshotBeforeUpdate(t,r){return this.outputRef.current?(this.outputRef.current,this.isScrolledToBottom()):null}componentDidUpdate(t,r,i){i&&this.scrollToBottom();const o=this.state.output.slice(r.output.length);if(o.length>0){const a=o.filter(l=>this.state.localEchoActive||l.type!=="command").length;a>0&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState(l=>({newLinesCount:l.newLinesCount+a})))}this.saveOutput(),this.addCopyButtons()}componentDidMount(){const{client:t}=this.props;t.on("message",this.handleMessage),t.on("html",this.handleHtml),t.on("connect",this.handleConnected),t.on("disconnect",this.handleDisconnected),t.on("error",this.addError),t.on("command",this.addCommand),t.on("userlist",this.handleUserList),this.unsubscribePrefs=li.subscribe(this.handlePreferencesChange)}componentWillUnmount(){const{client:t}=this.props;this.unsubscribePrefs&&this.unsubscribePrefs(),t.removeListener("message",this.handleMessage),t.removeListener("html",this.handleHtml),t.removeListener("connect",this.handleConnected),t.removeListener("disconnect",this.handleDisconnected),t.removeListener("error",this.addError),t.removeListener("command",this.addCommand),t.removeListener("userlist",this.handleUserList)}sanitizeHtml(t){return new DOMParser().parseFromString(t,"text/html").body.textContent||""}addToOutput(t,r,i=!0){i&&t.forEach(o=>{if(Lt.isValidElement(o)){const a=hA.renderToString(o),l=this.sanitizeHtml(a);lA(l)}else typeof o=="string"&&lA(o)}),this.setState(o=>{const a=t.map(d=>{const f=this.messageKey++;return{id:f,type:r,content:oe.jsx("div",{className:`output-line output-line-${r}`,children:d},f)}});return{output:[...o.output,...a].slice(-Ro.MAX_OUTPUT_LENGTH)}})}saveLog(){const t=this.outputRef.current;if(t){const r=t.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),a=document.createElement("a"),l=new Date,u=l.toLocaleDateString(),d=l.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),p=`${document.title.replace(/\s+/g,"-")}-log-${u}-${d}.html`;a.download=p,a.href=o,a.click(),URL.revokeObjectURL(o),a.remove()}}clearLog(){this.setState({output:[]}),localStorage.removeItem(Ro.LOCAL_STORAGE_KEY)}copyLog(){const t=this.outputRef.current;if(t){const r=t.innerText;navigator.clipboard.writeText(r).then(()=>{console.log("Log copied to clipboard.")}).catch(i=>{console.error("Failed to copy log: ",i),alert("Failed to copy log to clipboard. See console for details.")})}}render(){var t="output";this.state.sidebarVisible&&(t+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return oe.jsxs("div",{ref:this.outputRef,className:t,onScroll:this.handleScroll,onClick:this.handleDataTextClick,children:[this.state.output.filter(i=>this.state.localEchoActive||i.type!=="command").map(i=>i.content),this.state.newLinesCount>0&&oe.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};ee(Ro,"MAX_OUTPUT_LENGTH",7500),ee(Ro,"LOCAL_STORAGE_KEY","outputLog");let rC=Ro;const YM="3bce94acc3bb4d531abe6e469204a023376edade",Ws=()=>{const[,n]=N.useReducer(e=>e+1,0);return N.useEffect(()=>li.subscribe(n),[]),[li.getState(),li.dispatch]},qM=()=>{const[n,e]=N.useState([]);return N.useEffect(()=>{const t=()=>{e(window.speechSynthesis.getVoices())};t(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=t)},[]),n},Qk=({tabs:n})=>{const[e,t]=N.useState(0),r=N.useRef([]),i=N.useRef(!1);return N.useEffect(()=>{r.current=r.current.slice(0,n.length)},[n]),N.useEffect(()=>{const o=l=>{switch(l.key){case"ArrowLeft":i.current=!0,t(u=>u>0?u-1:n.length-1);break;case"ArrowRight":i.current=!0,t(u=>u<n.length-1?u+1:0);break;case"Home":i.current=!0,t(0);break;case"End":i.current=!0,t(n.length-1);break}},a=r.current[e];return a==null||a.addEventListener("keydown",o),()=>{a==null||a.removeEventListener("keydown",o)}},[n.length,e]),N.useEffect(()=>{var o;i.current&&((o=r.current[e])==null||o.focus())},[e]),oe.jsxs("div",{className:"tabs-container",children:[oe.jsx("div",{role:"tablist",children:n.map((o,a)=>oe.jsx("button",{ref:l=>r.current[a]=l,role:"tab","aria-selected":e===a,id:o.id,"aria-controls":`${o.id}-panel`,onClick:()=>{console.log(`Tab onClick triggered for: ${o.label} (Index: ${a})`),i.current=!0,t(a),console.log(`Tab state updated to index: ${a}`)},tabIndex:e===a?void 0:-1,children:o.label},a))}),n.map((o,a)=>oe.jsx("div",{role:"tabpanel",id:`${o.id}-panel`,"aria-labelledby":o.id,hidden:e!==a,children:oe.jsx("div",{className:"sidebar-tab-content",children:o.content})},o.id))]})},QM=()=>{const[n,e]=Ws();return oe.jsxs("label",{children:[oe.jsx("input",{type:"checkbox",checked:n.general.localEcho,onChange:t=>e({type:$o.SetGeneral,data:{...n.general,localEcho:t.target.checked}})}),"Local Echo"]})},eL=()=>{const[n,e]=Ws();return oe.jsxs("label",{children:["Auto Read:",oe.jsxs("select",{value:n.speech.autoreadMode,onChange:t=>e({type:$o.SetSpeech,data:{...n.speech,autoreadMode:t.target.value}}),children:[oe.jsx("option",{value:"off",children:"Off"}),oe.jsx("option",{value:"unfocused",children:"Unfocused"}),oe.jsx("option",{value:"all",children:"Always"})]})]})},tL=()=>{const[n,e]=Ws(),t=qM();return oe.jsxs("label",{children:["Voice:",oe.jsx("select",{value:n.speech.voice,onChange:r=>e({type:$o.SetSpeech,data:{...n.speech,voice:r.target.value}}),children:t.map(r=>oe.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},nL=()=>{const[n,e]=Ws();return oe.jsxs("label",{children:["Rate (0.1 - 10.0):",oe.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:n.speech.rate,onChange:t=>e({type:$o.SetSpeech,data:{...n.speech,rate:parseFloat(t.target.value)}})})]})},rL=()=>{const[n,e]=Ws();return oe.jsxs("label",{children:["Pitch (0 - 2):",oe.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:n.speech.pitch,onChange:t=>e({type:$o.SetSpeech,data:{...n.speech,pitch:parseFloat(t.target.value)}})})]})},iL=()=>{const[n,e]=Ws();return oe.jsxs("label",{children:["Volume (0 - 1):",oe.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:n.speech.volume,onChange:t=>e({type:$o.SetSpeech,data:{...n.speech,volume:parseFloat(t.target.value)}})})]})},oL=()=>{const[n]=Ws(),[e,t]=N.useState(!1),r=Lt.useRef(!0);Lt.useEffect(()=>()=>{r.current=!1,speechSynthesis.cancel()},[]);const i=()=>{if(e)return;t(!0),console.log("Preview button clicked");const o=()=>{if(!r.current)return;const a=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),l=speechSynthesis.getVoices();console.log("Available voices:",l.map(d=>d.name));const u=l.find(d=>d.name===n.speech.voice);console.log("Selected voice:",u?u.name:"Not found"),a.voice=u||null,a.rate=n.speech.rate,a.pitch=n.speech.pitch,a.volume=n.speech.volume,console.log("Utterance settings:",{voice:a.voice?a.voice.name:"Default",rate:a.rate,pitch:a.pitch,volume:a.volume}),a.onend=()=>{r.current&&(console.log("Speech ended"),t(!1))},a.onerror=d=>{r.current&&(console.error("Speech synthesis error:",d),t(!1))},speechSynthesis.cancel(),speechSynthesis.speak(a),console.log("Speech started")};if(speechSynthesis.getVoices().length>0)o();else{let a=()=>{a&&(speechSynthesis.onvoiceschanged=null,a=null,r.current&&o())};speechSynthesis.onvoiceschanged=a;const l=()=>{a&&(speechSynthesis.onvoiceschanged=null,a=null)};Lt.useEffect(()=>l,[])}};return oe.jsx("button",{onClick:i,disabled:e,children:e?"Playing...":"Preview Voice"})},sL=()=>oe.jsxs("div",{children:[oe.jsx(eL,{}),oe.jsx("br",{}),oe.jsx(tL,{}),oe.jsx("br",{}),oe.jsx(nL,{}),oe.jsx("br",{}),oe.jsx(rL,{}),oe.jsx("br",{}),oe.jsx(iL,{}),oe.jsx("br",{}),oe.jsx(oL,{})]}),aL=()=>{const[n,e]=Ws();return oe.jsx("div",{children:oe.jsxs("label",{children:[oe.jsx("input",{type:"checkbox",checked:n.sound.muteInBackground,onChange:t=>e({type:$o.SetSound,data:{...n.sound,muteInBackground:t.target.checked}})}),"Mute sounds when in background"]})})},lL=()=>{const[n,e]=Ws(),t=n.editor,r=o=>{e({type:$o.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:$o.SetEditorAccessibilityMode,data:o.target.checked})};return oe.jsxs("div",{children:[oe.jsxs("label",{children:[oe.jsx("input",{type:"checkbox",checked:t.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),oe.jsx("br",{}),oe.jsxs("label",{children:[oe.jsx("input",{type:"checkbox",checked:t.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),oe.jsx("br",{})]})},cL=()=>{const n=[{label:"General",content:oe.jsx(QM,{})},{label:"Speech",content:oe.jsx(sL,{})},{label:"Sounds",content:oe.jsx(aL,{})},{label:"Editor",content:oe.jsx(lL,{})}];return oe.jsx(Qk,{tabs:n})};function uL(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function vf(){return vf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},vf.apply(null,arguments)}var iC="data-focus-lock",eE="data-focus-lock-disabled",dL="data-no-focus-lock",fL="data-autofocus-inside",hL="data-no-autofocus";function iv(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function pL(n,e){var t=N.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var i=t.value;i!==r&&(t.value=r,t.callback(r,i))}}}})[0];return t.callback=e,t.facade}var gL=typeof window<"u"?N.useLayoutEffect:N.useEffect,kA=new WeakMap;function mL(n,e){var t=pL(null,function(r){return n.forEach(function(i){return iv(i,r)})});return gL(function(){var r=kA.get(t);if(r){var i=new Set(r),o=new Set(n),a=t.current;i.forEach(function(l){o.has(l)||iv(l,null)}),o.forEach(function(l){i.has(l)||iv(l,a)})}kA.set(t,n)},[n]),t}var ov={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},oC=function(n,e){return oC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},oC(n,e)};function $u(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");oC(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var sC=function(){return sC=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},sC.apply(this,arguments)};function vL(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(f){try{d(r.next(f))}catch(p){a(p)}}function u(f){try{d(r.throw(f))}catch(p){a(p)}}function d(f){f.done?o(f.value):i(f.value).then(l,u)}d((r=r.apply(n,e||[])).next())})}function tE(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(d){return function(f){return u([d,f])}}function u(d){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(t=0)),t;)try{if(r=1,i&&(o=d[0]&2?i.return:d[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,d[1])).done)return o;switch(i=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,i=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){t.label=d[1];break}if(d[0]===6&&t.label<o[1]){t.label=o[1],o=d;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(d);break}o[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(f){d=[6,f],i=0}finally{r=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Ou(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function aC(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(l){a={error:l}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return o}function lC(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}function yu(n){return this instanceof yu?(this.v=n,this):new yu(n)}function CL(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(v){return function(C){return Promise.resolve(C).then(v,p)}}function l(v,C){r[v]&&(i[v]=function(y){return new Promise(function(x,I){o.push([v,y,x,I])>1||u(v,y)})},C&&(i[v]=C(i[v])))}function u(v,C){try{d(r[v](C))}catch(y){g(o[0][3],y)}}function d(v){v.value instanceof yu?Promise.resolve(v.value.v).then(f,p):g(o[0][2],v)}function f(v){u("next",v)}function p(v){u("throw",v)}function g(v,C){v(C),o.shift(),o.length&&u(o[0][0],o[0][1])}}function yL(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Ou=="function"?Ou(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(a){return new Promise(function(l,u){a=n[o](a),i(l,u,a.done,a.value)})}}function i(o,a,l,u){Promise.resolve(u).then(function(d){o({value:d,done:l})},a)}}function nE(n){return n}function rE(n,e){e===void 0&&(e=nE);var t=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(o){var a=e(o,r);return t.push(a),function(){t=t.filter(function(l){return l!==a})}},assignSyncMedium:function(o){for(r=!0;t.length;){var a=t;t=[],a.forEach(o)}t={push:function(l){return o(l)},filter:function(){return t}}},assignMedium:function(o){r=!0;var a=[];if(t.length){var l=t;t=[],l.forEach(o),a=t}var u=function(){var f=a;a=[],f.forEach(o)},d=function(){return Promise.resolve().then(u)};d(),t={push:function(f){a.push(f),d()},filter:function(f){return a=a.filter(f),t}}}};return i}function by(n,e){return e===void 0&&(e=nE),rE(n,e)}function xL(n){n===void 0&&(n={});var e=rE(null);return e.options=sC({async:!0,ssr:!1},n),e}var iE=by({},function(n){var e=n.target,t=n.currentTarget;return{target:e,currentTarget:t}}),oE=by(),IL=by(),bL=xL({async:!0,ssr:typeof document<"u"}),AL=N.createContext(void 0),wL=[],Ay=N.forwardRef(function(e,t){var r,i=N.useState(),o=i[0],a=i[1],l=N.useRef(),u=N.useRef(!1),d=N.useRef(null),f=N.useState({}),p=f[1],g=e.children,v=e.disabled,C=v===void 0?!1:v,y=e.noFocusGuards,x=y===void 0?!1:y,I=e.persistentFocus,b=I===void 0?!1:I,T=e.crossFrame,R=T===void 0?!0:T,P=e.autoFocus,B=P===void 0?!0:P;e.allowTextSelection;var _=e.group,M=e.className,H=e.whiteList,V=e.hasPositiveIndices,U=e.shards,Z=U===void 0?wL:U,q=e.as,ie=q===void 0?"div":q,le=e.lockProps,Ce=le===void 0?{}:le,Re=e.sideCar,de=e.returnFocus,pe=de===void 0?!1:de,be=e.focusOptions,L=e.onActivation,K=e.onDeactivation,ue=N.useState({}),he=ue[0],Ee=N.useCallback(function($e){var bt=$e.captureFocusRestore;if(!d.current){var xt,ct=(xt=document)==null?void 0:xt.activeElement;d.current=ct,ct!==document.body&&(d.current=bt(ct))}l.current&&L&&L(l.current),u.current=!0,p()},[L]),Fe=N.useCallback(function(){u.current=!1,K&&K(l.current),p()},[K]),Je=N.useCallback(function($e){var bt=d.current;if(bt){var xt=(typeof bt=="function"?bt():bt)||document.body,ct=typeof pe=="function"?pe(xt):pe;if(ct){var At=typeof ct=="object"?ct:void 0;d.current=null,$e?Promise.resolve().then(function(){return xt.focus(At)}):xt.focus(At)}}},[pe]),Te=N.useCallback(function($e){u.current&&iE.useMedium($e)},[]),ft=oE.useMedium,Nt=N.useCallback(function($e){l.current!==$e&&(l.current=$e,a($e))},[]),rn=vf((r={},r[eE]=C&&"disabled",r[iC]=_,r),Ce),Rt=x!==!0,yt=Rt&&x!=="tail",Pt=mL([t,Nt]),He=N.useMemo(function(){return{observed:l,shards:Z,enabled:!C,active:u.current}},[C,u.current,Z,o]);return Lt.createElement(N.Fragment,null,Rt&&[Lt.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:C?-1:0,style:ov}),V?Lt.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:C?-1:1,style:ov}):null],!C&&Lt.createElement(Re,{id:he,sideCar:bL,observed:o,disabled:C,persistentFocus:b,crossFrame:R,autoFocus:B,whiteList:H,shards:Z,onActivation:Ee,onDeactivation:Fe,returnFocus:Je,focusOptions:be,noFocusGuards:x}),Lt.createElement(ie,vf({ref:Pt},rn,{className:M,onBlur:ft,onFocus:Te}),Lt.createElement(AL.Provider,{value:He},g)),yt&&Lt.createElement("div",{"data-focus-guard":!0,tabIndex:C?-1:0,style:ov}))});Ay.propTypes={};function cC(n,e){return cC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},cC(n,e)}function SL(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,cC(n,e)}function Cf(n){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cf(n)}function kL(n,e){if(Cf(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Cf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function EL(n){var e=kL(n,"string");return Cf(e)=="symbol"?e:e+""}function TL(n,e,t){return(e=EL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RL(n,e){function t(r){return r.displayName||r.name||"Component"}return function(i){var o=[],a;function l(){a=n(o.map(function(d){return d.props})),e(a)}var u=function(d){SL(f,d);function f(){return d.apply(this,arguments)||this}f.peek=function(){return a};var p=f.prototype;return p.componentDidMount=function(){o.push(this),l()},p.componentDidUpdate=function(){l()},p.componentWillUnmount=function(){var v=o.indexOf(this);o.splice(v,1),l()},p.render=function(){return Lt.createElement(i,this.props)},f}(N.PureComponent);return TL(u,"displayName","SideEffect("+t(i)+")"),u}}var js=function(n){for(var e=Array(n.length),t=0;t<n.length;++t)e[t]=n[t];return e},Ic=function(n){return Array.isArray(n)?n:[n]},sE=function(n){return Array.isArray(n)?n[0]:n},_L=function(n){if(n.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(n,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},aE=function(n){return n.parentNode&&n.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.parentNode.host:n.parentNode},lE=function(n){return n===document||n&&n.nodeType===Node.DOCUMENT_NODE},PL=function(n){return n.hasAttribute("inert")},DL=function(n,e){return!n||lE(n)||!_L(n)&&!PL(n)&&e(aE(n))},cE=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=DL(e,cE.bind(void 0,n));return n.set(e,r),r},NL=function(n,e){return n&&!lE(n)?FL(n)?e(aE(n)):!1:!0},uE=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=NL(e,uE.bind(void 0,n));return n.set(e,r),r},dE=function(n){return n.dataset},BL=function(n){return n.tagName==="BUTTON"},fE=function(n){return n.tagName==="INPUT"},hE=function(n){return fE(n)&&n.type==="radio"},OL=function(n){return!((fE(n)||BL(n))&&(n.type==="hidden"||n.disabled))},FL=function(n){var e=n.getAttribute(hL);return![!0,"true",""].includes(e)},wy=function(n){var e;return!!(n&&(!((e=dE(n))===null||e===void 0)&&e.focusGuard))},uC=function(n){return!wy(n)},ML=function(n){return!!n},LL=function(n,e){var t=Math.max(0,n.tabIndex),r=Math.max(0,e.tabIndex),i=t-r,o=n.index-e.index;if(i){if(!t)return 1;if(!r)return-1}return i||o},UL=function(n){return n.tabIndex<0&&!n.hasAttribute("tabindex")?0:n.tabIndex},Sy=function(n,e,t){return js(n).map(function(r,i){var o=UL(r);return{node:r,index:i,tabIndex:t&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(LL)},VL=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],ky=VL.join(","),GL="".concat(ky,", [data-focus-guard]"),pE=function(n,e){return js((n.shadowRoot||n).children).reduce(function(t,r){return t.concat(r.matches(e?GL:ky)?[r]:[],pE(r))},[])},WL=function(n,e){var t;return n instanceof HTMLIFrameElement&&(!((t=n.contentDocument)===null||t===void 0)&&t.body)?Fu([n.contentDocument.body],e):[n]},Fu=function(n,e){return n.reduce(function(t,r){var i,o=pE(r,e),a=(i=[]).concat.apply(i,o.map(function(l){return WL(l,e)}));return t.concat(a,r.parentNode?js(r.parentNode.querySelectorAll(ky)).filter(function(l){return l===r}):[])},[])},jL=function(n){var e=n.querySelectorAll("[".concat(fL,"]"));return js(e).map(function(t){return Fu([t])}).reduce(function(t,r){return t.concat(r)},[])},Ey=function(n,e){return js(n).filter(function(t){return cE(e,t)}).filter(function(t){return OL(t)})},EA=function(n,e){return e===void 0&&(e=new Map),js(n).filter(function(t){return uE(e,t)})},Ty=function(n,e,t){return Sy(Ey(Fu(n,t),e),!0,t)},yf=function(n,e){return Sy(Ey(Fu(n),e),!1)},zL=function(n,e){return Ey(jL(n),e)},gc=function(n,e){return n.shadowRoot?gc(n.shadowRoot,e):Object.getPrototypeOf(n).contains!==void 0&&Object.getPrototypeOf(n).contains.call(n,e)?!0:js(n.children).some(function(t){var r;if(t instanceof HTMLIFrameElement){var i=(r=t.contentDocument)===null||r===void 0?void 0:r.body;return i?gc(i,e):!1}return gc(t,e)})},HL=function(n){for(var e=new Set,t=n.length,r=0;r<t;r+=1)for(var i=r+1;i<t;i+=1){var o=n[r].compareDocumentPosition(n[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return n.filter(function(a,l){return!e.has(l)})},gE=function(n){return n.parentNode?gE(n.parentNode):n},Ry=function(n){var e=Ic(n);return e.filter(Boolean).reduce(function(t,r){var i=r.getAttribute(iC);return t.push.apply(t,i?HL(js(gE(r).querySelectorAll("[".concat(iC,'="').concat(i,'"]:not([').concat(eE,'="disabled"])')))):[r]),t},[])},ZL=function(n){try{return n()}catch{return}},xf=function(n){if(n===void 0&&(n=document),!(!n||!n.activeElement)){var e=n.activeElement;return e.shadowRoot?xf(e.shadowRoot):e instanceof HTMLIFrameElement&&ZL(function(){return e.contentWindow.document})?xf(e.contentWindow.document):e}},XL=function(n,e){return n===e},KL=function(n,e){return!!js(n.querySelectorAll("iframe")).some(function(t){return XL(t,e)})},mE=function(n,e){return e===void 0&&(e=xf(sE(n).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:Ry(n).some(function(t){return gc(t,e)||KL(t,e)})},$L=function(n){n===void 0&&(n=document);var e=xf(n);return e?js(n.querySelectorAll("[".concat(dL,"]"))).some(function(t){return gc(t,e)}):!1},JL=function(n,e){return e.filter(hE).filter(function(t){return t.name===n.name}).filter(function(t){return t.checked})[0]||n},_y=function(n,e){return hE(n)&&n.name?JL(n,e):n},YL=function(n){var e=new Set;return n.forEach(function(t){return e.add(_y(t,n))}),n.filter(function(t){return e.has(t)})},TA=function(n){return n[0]&&n.length>1?_y(n[0],n):n[0]},RA=function(n,e){return n.indexOf(_y(e,n))},dC="NEW_FOCUS",qL=function(n,e,t,r,i){var o=n.length,a=n[0],l=n[o-1],u=wy(r);if(!(r&&n.indexOf(r)>=0)){var d=r!==void 0?t.indexOf(r):-1,f=i?t.indexOf(i):d,p=i?n.indexOf(i):-1;if(d===-1)return p!==-1?p:dC;if(p===-1)return dC;var g=d-f,v=t.indexOf(a),C=t.indexOf(l),y=YL(t),x=r!==void 0?y.indexOf(r):-1,I=i?y.indexOf(i):x,b=y.filter(function(M){return M.tabIndex>=0}),T=r!==void 0?b.indexOf(r):-1,R=i?b.indexOf(i):T,P=T>=0&&R>=0?R-T:I-x;if(!g&&p>=0||e.length===0)return p;var B=RA(n,e[0]),_=RA(n,e[e.length-1]);if(d<=v&&u&&Math.abs(g)>1)return _;if(d>=C&&u&&Math.abs(g)>1)return B;if(g&&Math.abs(P)>1)return p;if(d<=v)return _;if(d>C)return B;if(g)return Math.abs(g)>1?p:(o+p+g)%o}},QL=function(n){return function(e){var t,r=(t=dE(e))===null||t===void 0?void 0:t.autofocus;return e.autofocus||r!==void 0&&r!=="false"||n.indexOf(e)>=0}},_A=function(n,e,t){var r=n.map(function(o){var a=o.node;return a}),i=EA(r.filter(QL(t)));return i&&i.length?TA(i):TA(EA(e))},fC=function(n,e){return e===void 0&&(e=[]),e.push(n),n.parentNode&&fC(n.parentNode.host||n.parentNode,e),e},sv=function(n,e){for(var t=fC(n),r=fC(e),i=0;i<t.length;i+=1){var o=t[i];if(r.indexOf(o)>=0)return o}return!1},vE=function(n,e,t){var r=Ic(n),i=Ic(e),o=r[0],a=!1;return i.filter(Boolean).forEach(function(l){a=sv(a||l,l)||a,t.filter(Boolean).forEach(function(u){var d=sv(o,u);d&&(!a||gc(d,a)?a=d:a=sv(d,a))})}),a},PA=function(n,e){return n.reduce(function(t,r){return t.concat(zL(r,e))},[])},e8=function(n,e){var t=new Map;return e.forEach(function(r){return t.set(r.node,r)}),n.map(function(r){return t.get(r)}).filter(ML)},t8=function(n,e){var t=xf(Ic(n).length>0?document:sE(n).ownerDocument),r=Ry(n).filter(uC),i=vE(t||n,n,r),o=new Map,a=yf(r,o),l=a.filter(function(C){var y=C.node;return uC(y)});if(l[0]){var u=yf([i],o).map(function(C){var y=C.node;return y}),d=e8(u,l),f=d.map(function(C){var y=C.node;return y}),p=d.filter(function(C){var y=C.tabIndex;return y>=0}).map(function(C){var y=C.node;return y}),g=qL(f,p,u,t,e);if(g===dC){var v=_A(a,p,PA(r,o))||_A(a,f,PA(r,o));if(v)return{node:v};console.warn("focus-lock: cannot find any node to move focus into");return}return g===void 0?g:d[g]}},n8=function(n){var e=Ry(n).filter(uC),t=vE(n,n,e),r=Sy(Fu([t],!0),!0,!0),i=Fu(e,!1);return r.map(function(o){var a=o.node,l=o.index;return{node:a,index:l,lockItem:i.indexOf(a)>=0,guard:wy(a)}})},Py=function(n,e){n&&("focus"in n&&n.focus(e),"contentWindow"in n&&n.contentWindow&&n.contentWindow.focus())},av=0,lv=!1,CE=function(n,e,t){t===void 0&&(t={});var r=t8(n,e);if(!lv&&r){if(av>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),lv=!0,setTimeout(function(){lv=!1},1);return}av++,Py(r.node,t.focusOptions),av--}};function Hd(n){if(!n)return null;if(typeof WeakRef>"u")return function(){return n||null};var e=n?new WeakRef(n):null;return function(){return(e==null?void 0:e.deref())||null}}var r8=function(n){if(!n)return null;for(var e=[],t=n;t&&t!==document.body;)e.push({current:Hd(t),parent:Hd(t.parentElement),left:Hd(t.previousElementSibling),right:Hd(t.nextElementSibling)}),t=t.parentElement;return{element:Hd(n),stack:e,ownerDocument:n.ownerDocument}},i8=function(n){var e,t,r,i,o;if(n)for(var a=n.stack,l=n.ownerDocument,u=new Map,d=0,f=a;d<f.length;d++){var p=f[d],g=(e=p.parent)===null||e===void 0?void 0:e.call(p);if(g&&l.contains(g)){for(var v=(t=p.left)===null||t===void 0?void 0:t.call(p),C=p.current(),y=g.contains(C)?C:void 0,x=(r=p.right)===null||r===void 0?void 0:r.call(p),I=Ty([g],u),b=(o=(i=y??(v==null?void 0:v.nextElementSibling))!==null&&i!==void 0?i:x)!==null&&o!==void 0?o:v;b;){for(var T=0,R=I;T<R.length;T++){var P=R[T];if(b!=null&&b.contains(P.node))return P.node}b=b.nextElementSibling}if(I.length)return I[0].node}}},yE=function(n){var e=r8(n);return function(){return i8(e)}},o8=function(n,e,t){if(!n||!e)return console.error("no element or scope given"),{};var r=Ic(e);if(r.every(function(a){return!gc(a,n)}))return console.error("Active element is not contained in the scope"),{};var i=t?Ty(r,new Map):yf(r,new Map),o=i.findIndex(function(a){var l=a.node;return l===n});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},s8=function(n,e){var t=e?Ty(Ic(n),new Map):yf(Ic(n),new Map);return{first:t[0],last:t[t.length-1]}},a8=function(n){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},n)},xE=function(n,e,t){e===void 0&&(e={});var r=a8(e),i=o8(n,r.scope,r.onlyTabbable);if(i){var o=t(i,r.cycle);o&&Py(o.node,r.focusOptions)}},l8=function(n,e){e===void 0&&(e={}),xE(n,e,function(t,r){var i=t.next,o=t.first;return i||r&&o})},c8=function(n,e){e===void 0&&(e={}),xE(n,e,function(t,r){var i=t.prev,o=t.last;return i||r&&o})},IE=function(n,e,t){var r,i=s8(n,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[t];o&&Py(o.node,e.focusOptions)},u8=function(n,e){e===void 0&&(e={}),IE(n,e,"first")},d8=function(n,e){e===void 0&&(e={}),IE(n,e,"last")};function Dy(n){setTimeout(n,1)}var f8=function(e){return e&&"current"in e?e.current:e},bE=function(){return document&&document.activeElement===document.body},h8=function(){return bE()||$L()},xu=null,Pi=null,DA=function(){return null},Iu=null,If=!1,Ny=!1,p8=function(){return!0},g8=function(e){return(xu.whiteList||p8)(e)},m8=function(e,t){Iu={observerNode:e,portaledElement:t}},v8=function(e){return Iu&&Iu.portaledElement===e};function NA(n,e,t,r){var i=null,o=n;do{var a=r[o];if(a.guard)a.node.dataset.focusAutoGuard&&(i=a);else if(a.lockItem){if(o!==n)return;i=null}else break}while((o+=t)!==e);i&&(i.node.tabIndex=0)}var C8=function(e){return e?!!If:If==="meanwhile"},y8=function n(e,t,r){return t&&(t.host===e&&(!t.activeElement||r.contains(t.activeElement))||t.parentNode&&n(e,t.parentNode,r))},x8=function(e,t){return t.some(function(r){return y8(e,r,r)})},AE=function(e){return yf(e,new Map)},I8=function(e){return!AE([e.parentNode]).some(function(t){return t.node===e})},R0=function(){var e=!1;if(xu){var t=xu,r=t.observed,i=t.persistentFocus,o=t.autoFocus,a=t.shards,l=t.crossFrame,u=t.focusOptions,d=t.noFocusGuards,f=r||Iu&&Iu.portaledElement;if(bE()&&Pi&&Pi!==document.body&&(!document.body.contains(Pi)||I8(Pi))){var p=DA();p&&p.focus()}var g=document&&document.activeElement;if(f){var v=[f].concat(a.map(f8).filter(Boolean)),C=function(){if(!C8(l)||!d||!Pi||Ny)return!1;var T=AE(v),R=T.findIndex(function(P){var B=P.node;return B===Pi});return R===0||R===T.length-1};if((!g||g8(g))&&(i||C()||!h8()||!Pi&&o)&&(f&&!(mE(v)||g&&x8(g,v)||v8(g))&&(document&&!Pi&&g&&!o?(g.blur&&g.blur(),document.body.focus()):(e=CE(v,Pi,{focusOptions:u}),Iu={})),Pi=document&&document.activeElement,Pi!==document.body&&(DA=yE(Pi)),If=!1),document&&g!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var y=document&&document.activeElement,x=n8(v),I=x.map(function(b){var T=b.node;return T}).indexOf(y);I>-1&&(x.filter(function(b){var T=b.guard,R=b.node;return T&&R.dataset.focusAutoGuard}).forEach(function(b){var T=b.node;return T.removeAttribute("tabIndex")}),NA(I,x.length,1,x),NA(I,-1,-1,x))}}}return e},wE=function(e){R0()&&e&&(e.stopPropagation(),e.preventDefault())},By=function(){return Dy(R0)},b8=function(e){var t=e.target,r=e.currentTarget;r.contains(t)||m8(r,t)},A8=function(){return null},SE=function(){Ny=!0},kE=function(){Ny=!1,If="just",Dy(function(){If="meanwhile"})},w8=function(){document.addEventListener("focusin",wE),document.addEventListener("focusout",By),window.addEventListener("focus",SE),window.addEventListener("blur",kE)},S8=function(){document.removeEventListener("focusin",wE),document.removeEventListener("focusout",By),window.removeEventListener("focus",SE),window.removeEventListener("blur",kE)};function k8(n){return n.filter(function(e){var t=e.disabled;return!t})}var EE={moveFocusInside:CE,focusInside:mE,focusNextElement:l8,focusPrevElement:c8,focusFirstElement:u8,focusLastElement:d8,captureFocusRestore:yE};function E8(n){var e=n.slice(-1)[0];e&&!xu&&w8();var t=xu,r=t&&e&&e.id===t.id;xu=e,t&&!r&&(t.onDeactivation(),n.filter(function(i){var o=i.id;return o===t.id}).length||t.returnFocus(!e)),e?(Pi=null,(!r||t.observed!==e.observed)&&e.onActivation(EE),R0(),Dy(R0)):(S8(),Pi=null)}iE.assignSyncMedium(b8);oE.assignMedium(By);IL.assignMedium(function(n){return n(EE)});const T8=RL(k8,E8)(A8);var TE=N.forwardRef(function(e,t){return Lt.createElement(Ay,vf({sideCar:T8,ref:t},e))}),RE=Ay.propTypes||{};RE.sideCar;uL(RE,["sideCar"]);TE.propTypes={};const R8=Lt.forwardRef((n,e)=>{const[t,r]=N.useState(!1),i=N.useRef(null);return Lt.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),N.useEffect(()=>{var o;t&&((o=i.current)==null||o.focus())},[t]),N.useEffect(()=>{const o=a=>{a.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),oe.jsx(TE,{disabled:!t,children:oe.jsxs("dialog",{className:"preferences-dialog",open:t,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[oe.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),t&&oe.jsx(cL,{}),oe.jsx("button",{onClick:()=>r(!1),children:"Close"}),oe.jsx("br",{}),oe.jsxs("span",{id:"commit-hash",children:["Version: ",YM]})]})})}),_8=({onFileChange:n,onRecipientChange:e,onSendFile:t,selectedFile:r,recipient:i})=>{const o=l=>{l.target.files&&l.target.files.length>0&&n(l.target.files[0])},a=l=>{e(l.target.value)};return oe.jsxs("div",{className:"file-transfer-controls",children:[oe.jsx("input",{type:"file",onChange:o}),oe.jsx("input",{type:"text",placeholder:"Recipient",value:i,onChange:a}),oe.jsx("button",{onClick:t,disabled:!r||!i,children:"Send File"})]})},P8=({progress:n})=>oe.jsxs("div",{className:"progress-bar",children:[oe.jsx("progress",{value:n,max:"100"}),oe.jsxs("span",{children:[n.toFixed(2),"%"]})]}),D8=({offer:n,onAccept:e,onReject:t})=>oe.jsxs("div",{className:"incoming-transfer",children:[oe.jsxs("p",{children:["Incoming file: ",n.filename," from ",n.sender]}),oe.jsx("button",{onClick:()=>e(n.sender,n.hash),children:"Accept"}),oe.jsx("button",{onClick:()=>t(n.sender,n.hash),children:"Reject"})]}),N8=({history:n})=>oe.jsxs("div",{className:"transfer-history","aria-live":"polite",children:[oe.jsx("h4",{children:"Transfer History"}),oe.jsx("ul",{children:n.map((e,t)=>oe.jsx("li",{children:e},t))})]}),B8=({client:n,expanded:e})=>{const[t,r]=N.useState(null),[i,o]=N.useState(""),[a,l]=N.useState(0),[u,d]=N.useState(0),[f,p]=N.useState([]),[g,v]=N.useState([]),C=N.useCallback(U=>{v(Z=>[...Z,U].slice(-10))},[]),y=N.useCallback(U=>{const Z=U.sentBytes/U.totalBytes*100;l(Z)},[]),x=N.useCallback(U=>{const Z=U.receivedBytes/U.totalBytes*100;d(Z)},[]),I=N.useCallback(U=>{C(`File sent successfully: ${U.filename}`),l(0)},[C]),b=N.useCallback(U=>{C(`File received successfully: ${U.filename}`),d(0)},[C]),T=N.useCallback(U=>{C(`Error ${U.direction}ing file ${U.filename}: ${U.error}`),U.direction==="send"?l(0):d(0)},[C]),R=N.useCallback(U=>{C(`File transfer cancelled: ${U.filename} (${U.direction})`),U.direction==="send"?l(0):d(0)},[C]),P=N.useCallback(U=>{C(`File transfer rejected: ${U.filename} from ${U.sender}`)},[C]),B=N.useCallback(U=>{C(`File transfer accepted: ${U.filename} by ${U.sender}`)},[C]),_=N.useCallback(U=>{p(Z=>[...Z,U]),C(`Incoming file offer: ${U.filename} from ${U.sender}`)},[C]);N.useEffect(()=>(n.on("fileTransferOffer",_),n.on("fileTransferAccepted",B),n.fileTransferManager.on("fileSendProgress",y),n.fileTransferManager.on("fileReceiveProgress",x),n.on("fileTransferError",T),n.on("fileTransferCancelled",R),n.on("fileTransferRejected",P),n.on("fileSendComplete",I),n.fileTransferManager.on("fileReceiveComplete",b),()=>{n.off("fileTransferOffer",_),n.off("fileTransferAccepted",B),n.fileTransferManager.off("fileSendProgress",y),n.fileTransferManager.off("fileReceiveProgress",x),n.off("fileTransferError",T),n.off("fileTransferCancelled",R),n.off("fileTransferRejected",P),n.off("fileSendComplete",I),n.fileTransferManager.off("fileReceiveComplete",b)}),[n,_,B,y,x,T,R,P,I,b]);const M=()=>{t&&i&&n.sendFile(t,i).then(()=>{C(`Sending ${t.name} to ${i}`)}).catch(U=>{C(`Error sending file: ${U.message}`)})},H=(U,Z)=>{n.acceptTransfer(U,Z);const q=f.find(ie=>ie.hash===Z);q&&C(`Accepting file transfer: ${q.filename} from ${U}`),p(ie=>ie.filter(le=>le.hash!==Z))},V=(U,Z)=>{n.rejectTransfer(U,Z);const q=f.find(ie=>ie.hash===Z);q&&C(`Rejected file transfer: ${q.filename} from ${U}`),p(ie=>ie.filter(le=>le.hash!==Z))};return oe.jsxs("div",{className:`file-transfer-ui ${e?"expanded":"collapsed"}`,children:[oe.jsx("h3",{children:"File Transfer"}),oe.jsx(_8,{onFileChange:r,onRecipientChange:o,onSendFile:M,selectedFile:t,recipient:i}),(a>0||u>0)&&oe.jsx(P8,{progress:a>0?a:u}),f.map(U=>oe.jsx(D8,{offer:U,onAccept:H,onReject:V},`${U.sender}-${U.filename}`)),oe.jsx(N8,{history:g})]})};var BA={};function O8(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}var F8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M8(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var _E={exports:{}};(function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(F8,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(y,x){var I=y[x];if(typeof I.bind=="function")return I.bind(y);try{return Function.prototype.bind.call(I,y)}catch{return function(){return Function.prototype.apply.apply(I,[y,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(y){return y==="debug"&&(y="log"),typeof console===t?!1:y==="trace"&&r?a:console[y]!==void 0?o(console,y):console.log!==void 0?o(console,"log"):e}function u(y,x){for(var I=0;I<i.length;I++){var b=i[I];this[b]=I<y?e:this.methodFactory(b,y,x)}this.log=this.debug}function d(y,x,I){return function(){typeof console!==t&&(u.call(this,x,I),this[y].apply(this,arguments))}}function f(y,x,I){return l(y)||d.apply(this,arguments)}function p(y,x,I){var b=this,T;x=x??"WARN";var R="loglevel";typeof y=="string"?R+=":"+y:typeof y=="symbol"&&(R=void 0);function P(H){var V=(i[H]||"silent").toUpperCase();if(!(typeof window===t||!R)){try{window.localStorage[R]=V;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+V+";"}catch{}}}function B(){var H;if(!(typeof window===t||!R)){try{H=window.localStorage[R]}catch{}if(typeof H===t)try{var V=window.document.cookie,U=V.indexOf(encodeURIComponent(R)+"=");U!==-1&&(H=/^([^;]+)/.exec(V.slice(U))[1])}catch{}return b.levels[H]===void 0&&(H=void 0),H}}function _(){if(!(typeof window===t||!R)){try{window.localStorage.removeItem(R);return}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}b.name=y,b.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},b.methodFactory=I||f,b.getLevel=function(){return T},b.setLevel=function(H,V){if(typeof H=="string"&&b.levels[H.toUpperCase()]!==void 0&&(H=b.levels[H.toUpperCase()]),typeof H=="number"&&H>=0&&H<=b.levels.SILENT){if(T=H,V!==!1&&P(H),u.call(b,H,y),typeof console===t&&H<b.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+H},b.setDefaultLevel=function(H){x=H,B()||b.setLevel(H,!1)},b.resetLevel=function(){b.setLevel(x,!1),_()},b.enableAll=function(H){b.setLevel(b.levels.TRACE,H)},b.disableAll=function(H){b.setLevel(b.levels.SILENT,H)};var M=B();M==null&&(M=x),b.setLevel(M,!1)}var g=new p,v={};g.getLogger=function(x){if(typeof x!="symbol"&&typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var I=v[x];return I||(I=v[x]=new p(x,g.getLevel(),g.methodFactory)),I};var C=typeof window!==t?window.log:void 0;return g.noConflict=function(){return typeof window!==t&&window.log===g&&(window.log=C),g},g.getLoggers=function(){return v},g.default=g,g})})(_E);var Oy=_E.exports,hC;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(hC||(hC={}));var Ms;(function(n){n.Default="livekit",n.Room="livekit-room",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(Ms||(Ms={}));let nn=Oy.getLogger("livekit");nn.setDefaultLevel(hC.info);function Va(n){const e=Oy.getLogger(n);return e.setDefaultLevel(nn.getLevel()),e}Oy.getLogger("lk-e2ee");function Oi(n,e){if(!n)throw new Error(e)}const L8=34028234663852886e22,U8=-34028234663852886e22,V8=4294967295,G8=2147483647,W8=-2147483648;function e0(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>G8||n<W8)throw new Error("invalid int 32: "+n)}function pC(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>V8||n<0)throw new Error("invalid uint 32: "+n)}function PE(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>L8||n<U8))throw new Error("invalid float 32: "+n)}const DE=Symbol("@bufbuild/protobuf/enum-type");function j8(n){const e=n[DE];return Oi(e,"missing enum type on enum object"),e}function NE(n,e,t,r){n[DE]=BE(e,t.map(i=>({no:i.no,name:i.name,localName:n[i.no]})))}function BE(n,e,t){const r=Object.create(null),i=Object.create(null),o=[];for(const a of e){const l=OE(a);o.push(l),r[a.name]=l,i[a.no]=l}return{typeName:n,values:o,findName(a){return r[a]},findNumber(a){return i[a]}}}function z8(n,e,t){const r={};for(const i of e){const o=OE(i);r[o.localName]=o.no,r[o.no]=o.localName}return NE(r,n,e),r}function OE(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class lt{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(t);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,t){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(t);return i.readMessage(r,e,o,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function H8(n,e,t,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),a={[o]:function(l){n.util.initFields(this),n.util.initPartial(l,this)}}[o];return Object.setPrototypeOf(a.prototype,new lt),Object.assign(a,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(l,u){return new a().fromBinary(l,u)},fromJson(l,u){return new a().fromJson(l,u)},fromJsonString(l,u){return new a().fromJsonString(l,u)},equals(l,u){return n.util.equals(a,l,u)}}),a}function Z8(n,e,t,r){return{syntax:n,json:e,bin:t,util:r,makeMessageType(i,o,a){return H8(this,i,o,a)},makeEnum:z8,makeEnumType:BE,getEnumType:j8}}var Me;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(Me||(Me={}));var bc;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(bc||(bc={}));function X8(){let n=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(n|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function cv(n,e,t){for(let o=0;o<28;o=o+7){const a=n>>>o,l=!(!(a>>>7)&&e==0),u=(l?a|128:a)&255;if(t.push(u),!l)return}const r=n>>>28&15|(e&7)<<4,i=e>>3!=0;if(t.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const a=e>>>o,l=!!(a>>>7),u=(l?a|128:a)&255;if(t.push(u),!l)return}t.push(e>>>31&1)}}const t0=4294967296;function OA(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,i=0;function o(a,l){const u=Number(n.slice(a,l));i*=t,r=r*t+u,r>=t0&&(i=i+(r/t0|0),r=r%t0)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?ME(r,i):Fy(r,i)}function K8(n,e){let t=Fy(n,e);const r=t.hi&2147483648;r&&(t=ME(t.lo,t.hi));const i=FE(t.lo,t.hi);return r?"-"+i:i}function FE(n,e){if({lo:n,hi:e}=$8(n,e),e<=2097151)return String(t0*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,i=e>>16&65535;let o=t+r*6777216+i*6710656,a=r+i*8147497,l=i*2;const u=1e7;return o>=u&&(a+=Math.floor(o/u),o%=u),a>=u&&(l+=Math.floor(a/u),a%=u),l.toString()+FA(a)+FA(o)}function $8(n,e){return{lo:n>>>0,hi:e>>>0}}function Fy(n,e){return{lo:n|0,hi:e|0}}function ME(n,e){return e=~e,n?n=~n+1:e+=1,Fy(n,e)}const FA=n=>{const e=String(n);return"0000000".slice(e.length)+e};function MA(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function J8(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function Y8(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof BA!="object"||BA.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),a=BigInt("0"),l=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(u){const d=typeof u=="bigint"?u:BigInt(u);if(d>o||d<i)throw new Error("int64 invalid: ".concat(u));return d},uParse(u){const d=typeof u=="bigint"?u:BigInt(u);if(d>l||d<a)throw new Error("uint64 invalid: ".concat(u));return d},enc(u){return n.setBigInt64(0,this.parse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(u){return n.setBigInt64(0,this.uParse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(u,d){return n.setInt32(0,u,!0),n.setInt32(4,d,!0),n.getBigInt64(0,!0)},uDec(u,d){return n.setInt32(0,u,!0),n.setInt32(4,d,!0),n.getBigUint64(0,!0)}}}const t=i=>Oi(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>Oi(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),t(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),t(i),OA(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),OA(i)},dec(i,o){return K8(i,o)},uDec(i,o){return FE(i,o)}}}const Kt=Y8();var tr;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(tr||(tr={}));class q8{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(pC(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return e0(e),MA(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){PE(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){pC(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){e0(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return e0(e),e=(e<<1^e>>31)>>>0,MA(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=Kt.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=Kt.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=Kt.enc(e);return cv(t.lo,t.hi,this.buf),this}sint64(e){let t=Kt.enc(e),r=t.hi>>31,i=t.lo<<1^r,o=(t.hi<<1|t.lo>>>31)^r;return cv(i,o,this.buf),this}uint64(e){let t=Kt.uEnc(e);return cv(t.lo,t.hi,this.buf),this}}class Q8{constructor(e,t){this.varint64=X8,this.uint32=J8,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e){let t=this.pos;switch(e){case tr.Varint:for(;this.buf[this.pos++]&128;);break;case tr.Bit64:this.pos+=4;case tr.Bit32:this.pos+=4;break;case tr.LengthDelimited:let r=this.uint32();this.pos+=r;break;case tr.StartGroup:let i;for(;(i=this.tag()[1])!==tr.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Kt.dec(...this.varint64())}uint64(){return Kt.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,Kt.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Kt.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Kt.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function gC(n,e){return e instanceof lt||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}Me.DOUBLE,Me.FLOAT,Me.INT64,Me.UINT64,Me.INT32,Me.UINT32,Me.BOOL,Me.STRING,Me.BYTES;function fl(n,e,t){if(e===t)return!0;if(n==Me.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case Me.UINT64:case Me.FIXED64:case Me.INT64:case Me.SFIXED64:case Me.SINT64:return e==t}return!1}function mC(n,e){switch(n){case Me.BOOL:return!1;case Me.UINT64:case Me.FIXED64:case Me.INT64:case Me.SFIXED64:case Me.SINT64:return e==0?Kt.zero:"0";case Me.DOUBLE:case Me.FLOAT:return 0;case Me.BYTES:return new Uint8Array(0);case Me.STRING:return"";default:return 0}}function LE(n,e){const t=e===void 0;let r=tr.Varint,i=e===0;switch(n){case Me.STRING:i=t||!e.length,r=tr.LengthDelimited;break;case Me.BOOL:i=e===!1;break;case Me.DOUBLE:r=tr.Bit64;break;case Me.FLOAT:r=tr.Bit32;break;case Me.INT64:i=t||e==0;break;case Me.UINT64:i=t||e==0;break;case Me.FIXED64:i=t||e==0,r=tr.Bit64;break;case Me.BYTES:i=t||!e.byteLength,r=tr.LengthDelimited;break;case Me.FIXED32:r=tr.Bit32;break;case Me.SFIXED32:r=tr.Bit32;break;case Me.SFIXED64:i=t||e==0,r=tr.Bit64;break;case Me.SINT64:i=t||e==0;break}const o=Me[n].toLowerCase();return[r,o,t||i]}const fu=Symbol("@bufbuild/protobuf/unknown-fields"),LA={readUnknownFields:!0,readerFactory:n=>new Q8(n)},UA={writeUnknownFields:!0,writerFactory:()=>new q8};function e6(n){return n?Object.assign(Object.assign({},LA),n):LA}function t6(n){return n?Object.assign(Object.assign({},UA),n):UA}function n6(){return{makeReadOptions:e6,makeWriteOptions:t6,listUnknownFields(n){var e;return(e=n[fu])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[fu]},writeUnknownFields(n,e){const r=n[fu];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(n,e,t,r){const i=n;Array.isArray(i[fu])||(i[fu]=[]),i[fu].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r){const i=n.getType(),o=t===void 0?e.len:e.pos+t;for(;e.pos<o;){const[a,l]=e.tag(),u=i.fields.find(a);if(!u){const g=e.skip(l);r.readUnknownFields&&this.onUnknownField(n,a,l,g);continue}let d=n,f=u.repeated,p=u.localName;switch(u.oneof&&(d=d[u.oneof.localName],d.case!=p&&delete d.value,d.case=p,p="value"),u.kind){case"scalar":case"enum":const g=u.kind=="enum"?Me.INT32:u.T;let v=_0;if(u.kind=="scalar"&&u.L>0&&(v=i6),f){let I=d[p];if(l==tr.LengthDelimited&&g!=Me.STRING&&g!=Me.BYTES){let b=e.uint32()+e.pos;for(;e.pos<b;)I.push(v(e,g))}else I.push(v(e,g))}else d[p]=v(e,g);break;case"message":const C=u.T;f?d[p].push(n0(e,new C,r)):d[p]instanceof lt?n0(e,d[p],r):(d[p]=n0(e,new C,r),C.fieldWrapper&&!u.oneof&&!u.repeated&&(d[p]=C.fieldWrapper.unwrapField(d[p])));break;case"map":let[y,x]=r6(u,e,r);d[p][y]=x;break}}}}}function n0(n,e,t){return e.getType().runtime.bin.readMessage(e,n,n.uint32(),t),e}function r6(n,e,t){const r=e.uint32(),i=e.pos+r;let o,a;for(;e.pos<i;){let[l]=e.tag();switch(l){case 1:o=_0(e,n.K);break;case 2:switch(n.V.kind){case"scalar":a=_0(e,n.V.T);break;case"enum":a=e.int32();break;case"message":a=n0(e,new n.V.T,t);break}break}}if(o===void 0){let l=mC(n.K,bc.BIGINT);o=n.K==Me.BOOL?l.toString():l}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),a===void 0)switch(n.V.kind){case"scalar":a=mC(n.V.T,bc.BIGINT);break;case"enum":a=0;break;case"message":a=new n.V.T;break}return[o,a]}function i6(n,e){const t=_0(n,e);return typeof t=="bigint"?t.toString():t}function _0(n,e){switch(e){case Me.STRING:return n.string();case Me.BOOL:return n.bool();case Me.DOUBLE:return n.double();case Me.FLOAT:return n.float();case Me.INT32:return n.int32();case Me.INT64:return n.int64();case Me.UINT64:return n.uint64();case Me.FIXED64:return n.fixed64();case Me.BYTES:return n.bytes();case Me.FIXED32:return n.fixed32();case Me.SFIXED32:return n.sfixed32();case Me.SFIXED64:return n.sfixed64();case Me.SINT64:return n.sint64();case Me.UINT32:return n.uint32();case Me.SINT32:return n.sint32()}}function o6(n,e,t,r,i){n.tag(t.no,tr.LengthDelimited),n.fork();let o=r;switch(t.K){case Me.INT32:case Me.FIXED32:case Me.UINT32:case Me.SFIXED32:case Me.SINT32:o=Number.parseInt(r);break;case Me.BOOL:Oi(r=="true"||r=="false"),o=r=="true";break}switch(af(n,t.K,1,o,!0),t.V.kind){case"scalar":af(n,t.V.T,2,i,!0);break;case"enum":af(n,Me.INT32,2,i,!0);break;case"message":vC(n,e,t.V.T,2,i);break}n.join()}function vC(n,e,t,r,i){if(i!==void 0){const o=gC(t,i);n.tag(r,tr.LengthDelimited).bytes(o.toBinary(e))}}function af(n,e,t,r,i){let[o,a,l]=LE(e,r);(!l||i)&&n.tag(t,o)[a](r)}function s6(n,e,t,r){if(!r.length)return;n.tag(t,tr.LengthDelimited).fork();let[,i]=LE(e);for(let o=0;o<r.length;o++)n[i](r[o]);n.join()}function a6(){return Object.assign(Object.assign({},n6()),{writeMessage(n,e,t){const r=n.getType();for(const i of r.fields.byNumber()){let o,a=i.repeated,l=i.localName;if(i.oneof){const u=n[i.oneof.localName];if(u.case!==l)continue;o=u.value}else o=n[l];switch(i.kind){case"scalar":case"enum":let u=i.kind=="enum"?Me.INT32:i.T;if(a)if(i.packed)s6(e,u,i.no,o);else for(const d of o)af(e,u,i.no,d,!0);else o!==void 0&&af(e,u,i.no,o,!!i.oneof||i.opt);break;case"message":if(a)for(const d of o)vC(e,t,i.T,i.no,d);else vC(e,t,i.T,i.no,o);break;case"map":for(const[d,f]of Object.entries(o))o6(e,t,i,d,f);break}}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e}})}let ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),q0=[];for(let n=0;n<ua.length;n++)q0[ua[n].charCodeAt(0)]=n;q0[45]=ua.indexOf("+");q0[95]=ua.indexOf("/");const UE={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,i=0,o,a=0;for(let l=0;l<n.length;l++){if(o=q0[n.charCodeAt(l)],o===void 0)switch(n[l]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:a=o,i=1;break;case 1:t[r++]=a<<2|(o&48)>>4,a=o,i=2;break;case 2:t[r++]=(a&15)<<4|(o&60)>>2,a=o,i=3;break;case 3:t[r++]=(a&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,i=0;for(let o=0;o<n.length;o++)switch(r=n[o],t){case 0:e+=ua[r>>2],i=(r&3)<<4,t=1;break;case 1:e+=ua[i|r>>4],i=(r&15)<<2,t=2;break;case 2:e+=ua[i|r>>6],e+=ua[r&63],t=0;break}return t&&(e+=ua[i],e+="=",t==1&&(e+="=")),e}},VA={ignoreUnknownFields:!1},GA={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function l6(n){return n?Object.assign(Object.assign({},VA),n):VA}function c6(n){return n?Object.assign(Object.assign({},GA),n):GA}function u6(n){const e=n(d6,WA);return{makeReadOptions:l6,makeWriteOptions:c6,readMessage(t,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(this.debug(r)));o=o??new t;const a={};for(const[l,u]of Object.entries(r)){const d=t.fields.findJsonName(l);if(!d){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(l,'" is unknown'));continue}let f=d.localName,p=o;if(d.oneof){if(u===null&&d.kind=="scalar")continue;const g=a[d.oneof.localName];if(g)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(d.oneof.name,'" present: "').concat(g,'", "').concat(l,'"'));a[d.oneof.localName]=l,p=p[d.oneof.localName]={case:f},f="value"}if(d.repeated){if(u===null)continue;if(!Array.isArray(u))throw new Error("cannot decode field ".concat(t.typeName,".").concat(d.name," from JSON: ").concat(this.debug(u)));const g=p[f];for(const v of u){if(v===null)throw new Error("cannot decode field ".concat(t.typeName,".").concat(d.name," from JSON: ").concat(this.debug(v)));let C;switch(d.kind){case"message":C=d.T.fromJson(v,i);break;case"enum":if(C=uv(d.T,v,i.ignoreUnknownFields),C===void 0)continue;break;case"scalar":try{C=Zd(d.T,v,d.L)}catch(y){let x="cannot decode field ".concat(t.typeName,".").concat(d.name," from JSON: ").concat(this.debug(v));throw y instanceof Error&&y.message.length>0&&(x+=": ".concat(y.message)),new Error(x)}break}g.push(C)}}else if(d.kind=="map"){if(u===null)continue;if(Array.isArray(u)||typeof u!="object")throw new Error("cannot decode field ".concat(t.typeName,".").concat(d.name," from JSON: ").concat(this.debug(u)));const g=p[f];for(const[v,C]of Object.entries(u)){if(C===null)throw new Error("cannot decode field ".concat(t.typeName,".").concat(d.name," from JSON: map value null"));let y;switch(d.V.kind){case"message":y=d.V.T.fromJson(C,i);break;case"enum":if(y=uv(d.V.T,C,i.ignoreUnknownFields),y===void 0)continue;break;case"scalar":try{y=Zd(d.V.T,C,bc.BIGINT)}catch(x){let I="cannot decode map value for field ".concat(t.typeName,".").concat(d.name," from JSON: ").concat(this.debug(u));throw x instanceof Error&&x.message.length>0&&(I+=": ".concat(x.message)),new Error(I)}break}try{g[Zd(d.K,d.K==Me.BOOL?v=="true"?!0:v=="false"?!1:v:v,bc.BIGINT).toString()]=y}catch(x){let I="cannot decode map key for field ".concat(t.typeName,".").concat(d.name," from JSON: ").concat(this.debug(u));throw x instanceof Error&&x.message.length>0&&(I+=": ".concat(x.message)),new Error(I)}}}else switch(d.kind){case"message":const g=d.T;if(u===null&&g.typeName!="google.protobuf.Value"){if(d.oneof)throw new Error("cannot decode field ".concat(t.typeName,".").concat(d.name,' from JSON: null is invalid for oneof field "').concat(l,'"'));continue}p[f]instanceof lt?p[f].fromJson(u,i):(p[f]=g.fromJson(u,i),g.fieldWrapper&&!d.oneof&&(p[f]=g.fieldWrapper.unwrapField(p[f])));break;case"enum":const v=uv(d.T,u,i.ignoreUnknownFields);v!==void 0&&(p[f]=v);break;case"scalar":try{p[f]=Zd(d.T,u,d.L)}catch(C){let y="cannot decode field ".concat(t.typeName,".").concat(d.name," from JSON: ").concat(this.debug(u));throw C instanceof Error&&C.message.length>0&&(y+=": ".concat(C.message)),new Error(y)}break}}return o},writeMessage(t,r){const i=t.getType(),o={};let a;try{for(const l of i.fields.byMember()){let u;if(l.kind=="oneof"){const d=t[l.localName];if(d.value===void 0)continue;if(a=l.findField(d.case),!a)throw"oneof case not found: "+d.case;u=e(a,d.value,r)}else a=l,u=e(a,t[a.localName],r);u!==void 0&&(o[r.useProtoFieldName?a.name:a.jsonName]=u)}}catch(l){const u=a?"cannot encode field ".concat(i.typeName,".").concat(a.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),d=l instanceof Error?l.message:String(l);throw new Error(u+(d.length>0?": ".concat(d):""))}return o},readScalar:Zd,writeScalar:WA,debug:VE}}function VE(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function Zd(n,e,t){switch(n){case Me.DOUBLE:case Me.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return n==Me.FLOAT&&PE(r),r;case Me.INT32:case Me.FIXED32:case Me.SFIXED32:case Me.SINT32:case Me.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return n==Me.UINT32?pC(i):e0(i),i;case Me.INT64:case Me.SFIXED64:case Me.SINT64:if(e===null)return Kt.zero;if(typeof e!="number"&&typeof e!="string")break;const o=Kt.parse(e);return t?o.toString():o;case Me.FIXED64:case Me.UINT64:if(e===null)return Kt.zero;if(typeof e!="number"&&typeof e!="string")break;const a=Kt.uParse(e);return t?a.toString():a;case Me.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case Me.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case Me.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return UE.dec(e)}throw new Error}function uv(n,e,t){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=n.findName(e);if(r||t)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(VE(e)))}function d6(n,e,t,r){var i;if(e===void 0)return e;if(e===0&&!t)return;if(r)return e;if(n.typeName=="google.protobuf.NullValue")return null;const o=n.findNumber(e);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:e}function WA(n,e,t){if(e!==void 0)switch(n){case Me.INT32:case Me.SFIXED32:case Me.SINT32:case Me.FIXED32:case Me.UINT32:return Oi(typeof e=="number"),e!=0||t?e:void 0;case Me.FLOAT:case Me.DOUBLE:return Oi(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||t?e:void 0;case Me.STRING:return Oi(typeof e=="string"),e.length>0||t?e:void 0;case Me.BOOL:return Oi(typeof e=="boolean"),e||t?e:void 0;case Me.UINT64:case Me.FIXED64:case Me.INT64:case Me.SFIXED64:case Me.SINT64:return Oi(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),t||e!=0?e.toString(10):void 0;case Me.BYTES:return Oi(e instanceof Uint8Array),t||e.byteLength>0?UE.enc(e):void 0}}function f6(){return u6((n,e)=>function(r,i,o){if(r.kind=="map"){const a={};switch(r.V.kind){case"scalar":for(const[u,d]of Object.entries(i)){const f=e(r.V.T,d,!0);Oi(f!==void 0),a[u.toString()]=f}break;case"message":for(const[u,d]of Object.entries(i))a[u.toString()]=d.toJson(o);break;case"enum":const l=r.V.T;for(const[u,d]of Object.entries(i)){Oi(d===void 0||typeof d=="number");const f=n(l,d,!0,o.enumAsInteger);Oi(f!==void 0),a[u.toString()]=f}break}return o.emitDefaultValues||Object.keys(a).length>0?a:void 0}else if(r.repeated){const a=[];switch(r.kind){case"scalar":for(let l=0;l<i.length;l++)a.push(e(r.T,i[l],!0));break;case"enum":for(let l=0;l<i.length;l++)a.push(n(r.T,i[l],!0,o.enumAsInteger));break;case"message":for(let l=0;l<i.length;l++)a.push(gC(r.T,i[l]).toJson(o));break}return o.emitDefaultValues||a.length>0?a:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return n(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?gC(r.T,i).toJson(o):void 0}})}function h6(){return{setEnumType:NE,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const i=r.localName,o=e,a=n;if(a[i]!==void 0)switch(r.kind){case"oneof":const l=a[i].case;if(l===void 0)continue;const u=r.findField(l);let d=a[i].value;u&&u.kind=="message"&&!(d instanceof u.T)?d=new u.T(d):u&&u.kind==="scalar"&&u.T===Me.BYTES&&(d=Xd(d)),o[i]={case:l,value:d};break;case"scalar":case"enum":let f=a[i];r.T===Me.BYTES&&(f=r.repeated?f.map(Xd):Xd(f)),o[i]=f;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Me.BYTES)for(const[v,C]of Object.entries(a[i]))o[i][v]=Xd(C);else Object.assign(o[i],a[i]);break;case"message":const g=r.V.T;for(const v of Object.keys(a[i])){let C=a[i][v];g.fieldWrapper||(C=new g(C)),o[i][v]=C}break}break;case"message":const p=r.T;if(r.repeated)o[i]=a[i].map(g=>g instanceof p?g:new p(g));else if(a[i]!==void 0){const g=a[i];p.fieldWrapper?p.typeName==="google.protobuf.BytesValue"?o[i]=Xd(g):o[i]=g:o[i]=g instanceof p?g:new p(g)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const i=e[r.localName],o=t[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((a,l)=>r.T.equals(a,o[l]));case"scalar":return i.every((a,l)=>fl(r.T,a,o[l]));case"enum":return i.every((a,l)=>fl(Me.INT32,a,o[l]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return fl(Me.INT32,i,o);case"scalar":return fl(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const a=r.findField(i.case);if(a===void 0)return!0;switch(a.kind){case"message":return a.T.equals(i.value,o.value);case"enum":return fl(Me.INT32,i.value,o.value);case"scalar":return fl(a.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(a.kind));case"map":const l=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const u=r.V.T;return l.every(f=>u.equals(i[f],o[f]));case"enum":return l.every(f=>fl(Me.INT32,i[f],o[f]));case"scalar":const d=r.V.T;return l.every(f=>fl(d,i[f],o[f]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const i of e.fields.byMember()){const o=n[i.localName];let a;if(i.repeated)a=o.map(op);else if(i.kind=="map"){a=r[i.localName];for(const[l,u]of Object.entries(o))a[l]=op(u)}else i.kind=="oneof"?a=i.findField(o.case)?{case:o.case,value:op(o.value)}:{case:void 0}:a=op(o);r[i.localName]=a}return t}}}function op(n){if(n===void 0)return n;if(n instanceof lt)return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function Xd(n){return n instanceof Uint8Array?n:new Uint8Array(n)}class p6{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function GE(n,e){const t=WE(n);return e?t:x6(y6(t))}function g6(n){return GE(n,!1)}const m6=WE;function WE(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let i=n.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),t.push(i);break}}return t.join("")}const v6=new Set(["constructor","toString","toJSON","valueOf"]),C6=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),jE=n=>"".concat(n,"$"),y6=n=>C6.has(n)?jE(n):n,x6=n=>v6.has(n)?jE(n):n;class I6{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=g6(e)}addField(e){Oi(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}const $=Z8("proto3",f6(),a6(),Object.assign(Object.assign({},h6()),{newFieldList(n){return new p6(n,b6)},initFields(n){for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=mC(e.T,e.L);break}}}}));function b6(n){var e,t,r,i;const o=[];let a;for(const l of typeof n=="function"?n():n){const u=l;if(u.localName=GE(l.name,l.oneof!==void 0),u.jsonName=(e=l.jsonName)!==null&&e!==void 0?e:m6(l.name),u.repeated=(t=l.repeated)!==null&&t!==void 0?t:!1,l.kind=="scalar"&&(u.L=(r=l.L)!==null&&r!==void 0?r:bc.BIGINT),u.packed=(i=l.packed)!==null&&i!==void 0?i:l.kind=="enum"||l.kind=="scalar"&&l.T!=Me.BYTES&&l.T!=Me.STRING,l.oneof!==void 0){const d=typeof l.oneof=="string"?l.oneof:l.oneof.name;(!a||a.name!=d)&&(a=new I6(d)),u.oneof=a,a.addField(u)}o.push(u)}return o}class Sr extends lt{constructor(e){super(),this.seconds=Kt.zero,this.nanos=0,$.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat($.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Kt.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Sr.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Sr({seconds:Kt.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new Sr().fromBinary(e,t)}static fromJson(e,t){return new Sr().fromJson(e,t)}static fromJsonString(e,t){return new Sr().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Sr,e,t)}}Sr.runtime=$;Sr.typeName="google.protobuf.Timestamp";Sr.fields=$.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var CC;(function(n){n[n.DEFAULT_AC=0]="DEFAULT_AC",n[n.OPUS=1]="OPUS",n[n.AAC=2]="AAC"})(CC||(CC={}));$.util.setEnumType(CC,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var yC;(function(n){n[n.DEFAULT_VC=0]="DEFAULT_VC",n[n.H264_BASELINE=1]="H264_BASELINE",n[n.H264_MAIN=2]="H264_MAIN",n[n.H264_HIGH=3]="H264_HIGH",n[n.VP8=4]="VP8"})(yC||(yC={}));$.util.setEnumType(yC,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var xC;(function(n){n[n.IC_DEFAULT=0]="IC_DEFAULT",n[n.IC_JPEG=1]="IC_JPEG"})(xC||(xC={}));$.util.setEnumType(xC,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var $r;(function(n){n[n.AUDIO=0]="AUDIO",n[n.VIDEO=1]="VIDEO",n[n.DATA=2]="DATA"})($r||($r={}));$.util.setEnumType($r,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var nr;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.CAMERA=1]="CAMERA",n[n.MICROPHONE=2]="MICROPHONE",n[n.SCREEN_SHARE=3]="SCREEN_SHARE",n[n.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(nr||(nr={}));$.util.setEnumType(nr,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var gr;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH",n[n.OFF=3]="OFF"})(gr||(gr={}));$.util.setEnumType(gr,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var ha;(function(n){n[n.POOR=0]="POOR",n[n.GOOD=1]="GOOD",n[n.EXCELLENT=2]="EXCELLENT",n[n.LOST=3]="LOST"})(ha||(ha={}));$.util.setEnumType(ha,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Jo;(function(n){n[n.UNSET=0]="UNSET",n[n.DISABLED=1]="DISABLED",n[n.ENABLED=2]="ENABLED"})(Jo||(Jo={}));$.util.setEnumType(Jo,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var La;(function(n){n[n.UNKNOWN_REASON=0]="UNKNOWN_REASON",n[n.CLIENT_INITIATED=1]="CLIENT_INITIATED",n[n.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",n[n.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",n[n.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",n[n.ROOM_DELETED=5]="ROOM_DELETED",n[n.STATE_MISMATCH=6]="STATE_MISMATCH",n[n.JOIN_FAILURE=7]="JOIN_FAILURE"})(La||(La={}));$.util.setEnumType(La,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var aa;(function(n){n[n.RR_UNKNOWN=0]="RR_UNKNOWN",n[n.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",n[n.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",n[n.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",n[n.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(aa||(aa={}));$.util.setEnumType(aa,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var bf;(function(n){n[n.SE_UNKNOWN=0]="SE_UNKNOWN",n[n.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",n[n.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(bf||(bf={}));$.util.setEnumType(bf,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Ju=class nf extends lt{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Kt.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,$.util.initPartial(e,this)}static fromBinary(e,t){return new nf().fromBinary(e,t)}static fromJson(e,t){return new nf().fromJson(e,t)}static fromJsonString(e,t){return new nf().fromJsonString(e,t)}static equals(e,t){return $.util.equals(nf,e,t)}};Ju.runtime=$;Ju.typeName="livekit.Room";Ju.fields=$.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Vo,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class Vo extends lt{constructor(e){super(),this.mime="",this.fmtpLine="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Vo().fromBinary(e,t)}static fromJson(e,t){return new Vo().fromJson(e,t)}static fromJsonString(e,t){return new Vo().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Vo,e,t)}}Vo.runtime=$;Vo.typeName="livekit.Codec";Vo.fields=$.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Il extends lt{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,$.util.initPartial(e,this)}static fromBinary(e,t){return new Il().fromBinary(e,t)}static fromJson(e,t){return new Il().fromJson(e,t)}static fromJsonString(e,t){return new Il().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Il,e,t)}}Il.runtime=$;Il.typeName="livekit.PlayoutDelay";Il.fields=$.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class pa extends lt{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,$.util.initPartial(e,this)}static fromBinary(e,t){return new pa().fromBinary(e,t)}static fromJson(e,t){return new pa().fromJson(e,t)}static fromJsonString(e,t){return new pa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(pa,e,t)}}pa.runtime=$;pa.typeName="livekit.ParticipantPermission";pa.fields=$.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:$.getEnumType(nr),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Yi extends lt{constructor(e){super(),this.sid="",this.identity="",this.state=Ac.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Kt.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,$.util.initPartial(e,this)}static fromBinary(e,t){return new Yi().fromBinary(e,t)}static fromJson(e,t){return new Yi().fromJson(e,t)}static fromJsonString(e,t){return new Yi().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Yi,e,t)}}Yi.runtime=$;Yi.typeName="livekit.ParticipantInfo";Yi.fields=$.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:$.getEnumType(Ac)},{no:4,name:"tracks",kind:"message",T:Fi,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:pa},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var Ac;(function(n){n[n.JOINING=0]="JOINING",n[n.JOINED=1]="JOINED",n[n.ACTIVE=2]="ACTIVE",n[n.DISCONNECTED=3]="DISCONNECTED"})(Ac||(Ac={}));$.util.setEnumType(Ac,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class bl extends lt{constructor(e){super(),$.util.initPartial(e,this)}static fromBinary(e,t){return new bl().fromBinary(e,t)}static fromJson(e,t){return new bl().fromJson(e,t)}static fromJsonString(e,t){return new bl().fromJsonString(e,t)}static equals(e,t){return $.util.equals(bl,e,t)}}bl.runtime=$;bl.typeName="livekit.Encryption";bl.fields=$.util.newFieldList(()=>[]);var Pr;(function(n){n[n.NONE=0]="NONE",n[n.GCM=1]="GCM",n[n.CUSTOM=2]="CUSTOM"})(Pr||(Pr={}));$.util.setEnumType(Pr,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class ga extends lt{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new ga().fromBinary(e,t)}static fromJson(e,t){return new ga().fromJson(e,t)}static fromJsonString(e,t){return new ga().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ga,e,t)}}ga.runtime=$;ga.typeName="livekit.SimulcastCodecInfo";ga.fields=$.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:fi,repeated:!0}]);class Fi extends lt{constructor(e){super(),this.sid="",this.type=$r.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=nr.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Pr.NONE,this.stream="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Fi().fromBinary(e,t)}static fromJson(e,t){return new Fi().fromJson(e,t)}static fromJsonString(e,t){return new Fi().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Fi,e,t)}}Fi.runtime=$;Fi.typeName="livekit.TrackInfo";Fi.fields=$.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:$.getEnumType($r)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:$.getEnumType(nr)},{no:10,name:"layers",kind:"message",T:fi,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:ga,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:$.getEnumType(Pr)},{no:17,name:"stream",kind:"scalar",T:9}]);class fi extends lt{constructor(e){super(),this.quality=gr.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,$.util.initPartial(e,this)}static fromBinary(e,t){return new fi().fromBinary(e,t)}static fromJson(e,t){return new fi().fromJson(e,t)}static fromJsonString(e,t){return new fi().fromJsonString(e,t)}static equals(e,t){return $.util.equals(fi,e,t)}}fi.runtime=$;fi.typeName="livekit.VideoLayer";fi.fields=$.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:$.getEnumType(gr)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Cs extends lt{constructor(e){super(),this.kind=hr.RELIABLE,this.value={case:void 0},$.util.initPartial(e,this)}static fromBinary(e,t){return new Cs().fromBinary(e,t)}static fromJson(e,t){return new Cs().fromJson(e,t)}static fromJsonString(e,t){return new Cs().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Cs,e,t)}}Cs.runtime=$;Cs.typeName="livekit.DataPacket";Cs.fields=$.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:$.getEnumType(hr)},{no:2,name:"user",kind:"message",T:xs,oneof:"value"},{no:3,name:"speaker",kind:"message",T:ma,oneof:"value"}]);var hr;(function(n){n[n.RELIABLE=0]="RELIABLE",n[n.LOSSY=1]="LOSSY"})(hr||(hr={}));$.util.setEnumType(hr,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class ma extends lt{constructor(e){super(),this.speakers=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new ma().fromBinary(e,t)}static fromJson(e,t){return new ma().fromJson(e,t)}static fromJsonString(e,t){return new ma().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ma,e,t)}}ma.runtime=$;ma.typeName="livekit.ActiveSpeakerUpdate";ma.fields=$.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:ys,repeated:!0}]);class ys extends lt{constructor(e){super(),this.sid="",this.level=0,this.active=!1,$.util.initPartial(e,this)}static fromBinary(e,t){return new ys().fromBinary(e,t)}static fromJson(e,t){return new ys().fromJson(e,t)}static fromJsonString(e,t){return new ys().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ys,e,t)}}ys.runtime=$;ys.typeName="livekit.SpeakerInfo";ys.fields=$.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class xs extends lt{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new xs().fromBinary(e,t)}static fromJson(e,t){return new xs().fromJson(e,t)}static fromJsonString(e,t){return new xs().fromJsonString(e,t)}static equals(e,t){return $.util.equals(xs,e,t)}}xs.runtime=$;xs.typeName="livekit.UserPacket";xs.fields=$.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class Is extends lt{constructor(e){super(),this.participantSid="",this.trackSids=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Is().fromBinary(e,t)}static fromJson(e,t){return new Is().fromJson(e,t)}static fromJsonString(e,t){return new Is().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Is,e,t)}}Is.runtime=$;Is.typeName="livekit.ParticipantTracks";Is.fields=$.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class va extends lt{constructor(e){super(),this.edition=Mu.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",$.util.initPartial(e,this)}static fromBinary(e,t){return new va().fromBinary(e,t)}static fromJson(e,t){return new va().fromJson(e,t)}static fromJsonString(e,t){return new va().fromJsonString(e,t)}static equals(e,t){return $.util.equals(va,e,t)}}va.runtime=$;va.typeName="livekit.ServerInfo";va.fields=$.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:$.getEnumType(Mu)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Mu;(function(n){n[n.Standard=0]="Standard",n[n.Cloud=1]="Cloud"})(Mu||(Mu={}));$.util.setEnumType(Mu,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Ca extends lt{constructor(e){super(),this.sdk=Lu.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Ca().fromBinary(e,t)}static fromJson(e,t){return new Ca().fromJson(e,t)}static fromJsonString(e,t){return new Ca().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ca,e,t)}}Ca.runtime=$;Ca.typeName="livekit.ClientInfo";Ca.fields=$.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:$.getEnumType(Lu)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Lu;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.JS=1]="JS",n[n.SWIFT=2]="SWIFT",n[n.ANDROID=3]="ANDROID",n[n.FLUTTER=4]="FLUTTER",n[n.GO=5]="GO",n[n.UNITY=6]="UNITY",n[n.REACT_NATIVE=7]="REACT_NATIVE",n[n.RUST=8]="RUST",n[n.PYTHON=9]="PYTHON",n[n.CPP=10]="CPP"})(Lu||(Lu={}));$.util.setEnumType(Lu,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class bs extends lt{constructor(e){super(),this.resumeConnection=Jo.UNSET,this.forceRelay=Jo.UNSET,$.util.initPartial(e,this)}static fromBinary(e,t){return new bs().fromBinary(e,t)}static fromJson(e,t){return new bs().fromJson(e,t)}static fromJsonString(e,t){return new bs().fromJsonString(e,t)}static equals(e,t){return $.util.equals(bs,e,t)}}bs.runtime=$;bs.typeName="livekit.ClientConfiguration";bs.fields=$.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:As},{no:2,name:"screen",kind:"message",T:As},{no:3,name:"resume_connection",kind:"enum",T:$.getEnumType(Jo)},{no:4,name:"disabled_codecs",kind:"message",T:ya},{no:5,name:"force_relay",kind:"enum",T:$.getEnumType(Jo)}]);class As extends lt{constructor(e){super(),this.hardwareEncoder=Jo.UNSET,$.util.initPartial(e,this)}static fromBinary(e,t){return new As().fromBinary(e,t)}static fromJson(e,t){return new As().fromJson(e,t)}static fromJsonString(e,t){return new As().fromJsonString(e,t)}static equals(e,t){return $.util.equals(As,e,t)}}As.runtime=$;As.typeName="livekit.VideoConfiguration";As.fields=$.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:$.getEnumType(Jo)}]);class ya extends lt{constructor(e){super(),this.codecs=[],this.publish=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new ya().fromBinary(e,t)}static fromJson(e,t){return new ya().fromJson(e,t)}static fromJsonString(e,t){return new ya().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ya,e,t)}}ya.runtime=$;ya.typeName="livekit.DisabledCodecs";ya.fields=$.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Vo,repeated:!0},{no:2,name:"publish",kind:"message",T:Vo,repeated:!0}]);class ws extends lt{constructor(e){super(),this.duration=0,this.startTimestamp=Kt.zero,this.endTimestamp=Kt.zero,this.rtpClockTicks=Kt.zero,this.driftSamples=Kt.zero,this.driftMs=0,this.clockRate=0,$.util.initPartial(e,this)}static fromBinary(e,t){return new ws().fromBinary(e,t)}static fromJson(e,t){return new ws().fromJson(e,t)}static fromJsonString(e,t){return new ws().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ws,e,t)}}ws.runtime=$;ws.typeName="livekit.RTPDrift";ws.fields=$.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Sr},{no:2,name:"end_time",kind:"message",T:Sr},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Al extends lt{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Kt.zero,this.headerBytes=Kt.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Kt.zero,this.headerBytesDuplicate=Kt.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Kt.zero,this.headerBytesPadding=Kt.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,$.util.initPartial(e,this)}static fromBinary(e,t){return new Al().fromBinary(e,t)}static fromJson(e,t){return new Al().fromJson(e,t)}static fromJsonString(e,t){return new Al().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Al,e,t)}}Al.runtime=$;Al.typeName="livekit.RTPStats";Al.fields=$.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Sr},{no:2,name:"end_time",kind:"message",T:Sr},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:Sr},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:Sr},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:Sr},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:Sr},{no:44,name:"packet_drift",kind:"message",T:ws},{no:45,name:"report_drift",kind:"message",T:ws}]);class wl extends lt{constructor(e){super(),this.unixMicro=Kt.zero,this.ticks=0,$.util.initPartial(e,this)}static fromBinary(e,t){return new wl().fromBinary(e,t)}static fromJson(e,t){return new wl().fromJson(e,t)}static fromJsonString(e,t){return new wl().fromJsonString(e,t)}static equals(e,t){return $.util.equals(wl,e,t)}}wl.runtime=$;wl.typeName="livekit.TimedVersion";wl.fields=$.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const Kd=7e3,A6=[0,300,2*2*300,3*3*300,4*4*300,Kd,Kd,Kd,Kd,Kd];class w6{constructor(e){this._retryDelays=e!==void 0?[...e]:A6}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function ge(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(f){try{d(r.next(f))}catch(p){a(p)}}function u(f){try{d(r.throw(f))}catch(p){a(p)}}function d(f){f.done?o(f.value):i(f.value).then(l,u)}d((r=r.apply(n,[])).next())})}function jA(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof jA=="function"?jA(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(a){return new Promise(function(l,u){a=n[o](a),i(l,u,a.done,a.value)})}}function i(o,a,l,u){Promise.resolve(u).then(function(d){o({value:d,done:l})},a)}}var My={exports:{}},bu=typeof Reflect=="object"?Reflect:null,zA=bu&&typeof bu.apply=="function"?bu.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},r0;bu&&typeof bu.ownKeys=="function"?r0=bu.ownKeys:Object.getOwnPropertySymbols?r0=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:r0=function(e){return Object.getOwnPropertyNames(e)};function S6(n){console&&console.warn&&console.warn(n)}var zE=Number.isNaN||function(e){return e!==e};function Sn(){Sn.init.call(this)}My.exports=Sn;My.exports.once=R6;Sn.EventEmitter=Sn;Sn.prototype._events=void 0;Sn.prototype._eventsCount=0;Sn.prototype._maxListeners=void 0;var HA=10;function Q0(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Sn,"defaultMaxListeners",{enumerable:!0,get:function(){return HA},set:function(n){if(typeof n!="number"||n<0||zE(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");HA=n}});Sn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Sn.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||zE(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function HE(n){return n._maxListeners===void 0?Sn.defaultMaxListeners:n._maxListeners}Sn.prototype.getMaxListeners=function(){return HE(this)};Sn.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var l=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw l.context=a,l}var u=o[e];if(u===void 0)return!1;if(typeof u=="function")zA(u,this,t);else for(var d=u.length,f=JE(u,d),r=0;r<d;++r)zA(f[r],this,t);return!0};function ZE(n,e,t,r){var i,o,a;if(Q0(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),a=o[e]),a===void 0)a=o[e]=t,++n._eventsCount;else if(typeof a=="function"?a=o[e]=r?[t,a]:[a,t]:r?a.unshift(t):a.push(t),i=HE(n),i>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=n,l.type=e,l.count=a.length,S6(l)}return n}Sn.prototype.addListener=function(e,t){return ZE(this,e,t,!1)};Sn.prototype.on=Sn.prototype.addListener;Sn.prototype.prependListener=function(e,t){return ZE(this,e,t,!0)};function k6(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function XE(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=k6.bind(r);return i.listener=t,r.wrapFn=i,i}Sn.prototype.once=function(e,t){return Q0(t),this.on(e,XE(this,e,t)),this};Sn.prototype.prependOnceListener=function(e,t){return Q0(t),this.prependListener(e,XE(this,e,t)),this};Sn.prototype.removeListener=function(e,t){var r,i,o,a,l;if(Q0(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(o=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){l=r[a].listener,o=a;break}if(o<0)return this;o===0?r.shift():E6(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,l||t)}return this};Sn.prototype.off=Sn.prototype.removeListener;Sn.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),a;for(i=0;i<o.length;++i)a=o[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function KE(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?T6(i):JE(i,i.length)}Sn.prototype.listeners=function(e){return KE(this,e,!0)};Sn.prototype.rawListeners=function(e){return KE(this,e,!1)};Sn.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):$E.call(n,e)};Sn.prototype.listenerCount=$E;function $E(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Sn.prototype.eventNames=function(){return this._eventsCount>0?r0(this._events):[]};function JE(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function E6(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function T6(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function R6(n,e){return new Promise(function(t,r){function i(a){n.removeListener(e,o),r(a)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}YE(n,e,o,{once:!0}),e!=="error"&&_6(n,i,{once:!0})})}function _6(n,e,t){typeof n.on=="function"&&YE(n,"error",e,t)}function YE(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(o){r.once&&n.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var zs=My.exports;let qE=!0,QE=!0;function i0(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseInt(r[t],10)}function Bc(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(a,l){if(a!==e)return i.apply(this,arguments);const u=d=>{const f=t(d);f&&(l.handleEvent?l.handleEvent(f):l(f))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(l,u),i.apply(this,[a,u])};const o=r.removeEventListener;r.removeEventListener=function(a,l){if(a!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(l))return o.apply(this,arguments);const u=this._eventMap[e].get(l);return this._eventMap[e].delete(l),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[a,u])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function P6(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(qE=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function D6(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(QE=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function eT(){if(typeof window=="object"){if(qE)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Ly(n,e){QE&&console.warn(n+" is deprecated, please use "+e+" instead.")}function N6(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.mozGetUserMedia)e.browser="firefox",e.version=i0(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=i0(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=i0(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function ZA(n){return Object.prototype.toString.call(n)==="[object Object]"}function tT(n){return ZA(n)?Object.keys(n).reduce(function(e,t){const r=ZA(n[t]),i=r?tT(n[t]):n[t],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[t]:i})},{}):n}function IC(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?IC(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{IC(n,n.get(i),t)})}))}function XA(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return n.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&o.push(a)}),o.forEach(a=>{n.forEach(l=>{l.type===r&&l.trackId===a.id&&IC(n,l,i)})}),i}const KA=eT;function nT(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(l){if(typeof l!="object"||l.mandatory||l.optional)return l;const u={};return Object.keys(l).forEach(d=>{if(d==="require"||d==="advanced"||d==="mediaSource")return;const f=typeof l[d]=="object"?l[d]:{ideal:l[d]};f.exact!==void 0&&typeof f.exact=="number"&&(f.min=f.max=f.exact);const p=function(g,v){return g?g+v.charAt(0).toUpperCase()+v.slice(1):v==="deviceId"?"sourceId":v};if(f.ideal!==void 0){u.optional=u.optional||[];let g={};typeof f.ideal=="number"?(g[p("min",d)]=f.ideal,u.optional.push(g),g={},g[p("max",d)]=f.ideal,u.optional.push(g)):(g[p("",d)]=f.ideal,u.optional.push(g))}f.exact!==void 0&&typeof f.exact!="number"?(u.mandatory=u.mandatory||{},u.mandatory[p("",d)]=f.exact):["min","max"].forEach(g=>{f[g]!==void 0&&(u.mandatory=u.mandatory||{},u.mandatory[p(g,d)]=f[g])})}),l.advanced&&(u.optional=(u.optional||[]).concat(l.advanced)),u},i=function(l,u){if(e.version>=61)return u(l);if(l=JSON.parse(JSON.stringify(l)),l&&typeof l.audio=="object"){const d=function(f,p,g){p in f&&!(g in f)&&(f[g]=f[p],delete f[p])};l=JSON.parse(JSON.stringify(l)),d(l.audio,"autoGainControl","googAutoGainControl"),d(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=r(l.audio)}if(l&&typeof l.video=="object"){let d=l.video.facingMode;d=d&&(typeof d=="object"?d:{ideal:d});const f=e.version<66;if(d&&(d.exact==="user"||d.exact==="environment"||d.ideal==="user"||d.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!f)){delete l.video.facingMode;let p;if(d.exact==="environment"||d.ideal==="environment"?p=["back","rear"]:(d.exact==="user"||d.ideal==="user")&&(p=["front"]),p)return t.mediaDevices.enumerateDevices().then(g=>{g=g.filter(C=>C.kind==="videoinput");let v=g.find(C=>p.some(y=>C.label.toLowerCase().includes(y)));return!v&&g.length&&p.includes("back")&&(v=g[g.length-1]),v&&(l.video.deviceId=d.exact?{exact:v.deviceId}:{ideal:v.deviceId}),l.video=r(l.video),KA("chrome: "+JSON.stringify(l)),u(l)})}l.video=r(l.video)}return KA("chrome: "+JSON.stringify(l)),u(l)},o=function(l){return e.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(l,u,d){i(l,f=>{t.webkitGetUserMedia(f,u,p=>{d&&d(o(p))})})};if(t.getUserMedia=a.bind(t),t.mediaDevices.getUserMedia){const l=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(u){return i(u,d=>l(d).then(f=>{if(d.audio&&!f.getAudioTracks().length||d.video&&!f.getVideoTracks().length)throw f.getTracks().forEach(p=>{p.stop()}),new DOMException("","NotFoundError");return f},f=>Promise.reject(o(f))))}}}function B6(n,e){if(!(n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices)&&n.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}n.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const o=r.video&&r.video.width,a=r.video&&r.video.height,l=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:l||3}},o&&(r.video.mandatory.maxWidth=o),a&&(r.video.mandatory.maxHeight=a),n.navigator.mediaDevices.getUserMedia(r)})}}}function rT(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function iT(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===i.track.id):o={track:i.track};const a=new Event("track");a.track=i.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)}),r.stream.getTracks().forEach(i=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===i.id):o={track:i};const a=new Event("track");a.track=i,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Bc(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function oT(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(l,u){let d=i.apply(this,arguments);return d||(d=e(this,l),this._senders.push(d)),d};const o=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(l){o.apply(this,arguments);const u=this._senders.indexOf(l);u!==-1&&this._senders.splice(u,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(a=>{const l=this._senders.find(u=>u.track===a);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function sT(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const a=function(u){const d={};return u.result().forEach(p=>{const g={id:p.id,timestamp:p.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[p.type]||p.type};p.names().forEach(v=>{g[v]=p.stat(v)}),d[g.id]=g}),d},l=function(u){return new Map(Object.keys(u).map(d=>[d,u[d]]))};if(arguments.length>=2){const u=function(d){i(l(a(d)))};return e.apply(this,[u,r])}return new Promise((u,d)=>{e.apply(this,[function(f){u(l(a(f)))},d])}).then(i,o)}}function aT(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const o=t.apply(this,[]);return o.forEach(a=>a._pc=this),o});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),n.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(a=>XA(a,o.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Bc(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>XA(o,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,o,a;return this.getSenders().forEach(l=>{l.track===r&&(i?a=!0:i=l)}),this.getReceivers().forEach(l=>(l.track===r&&(o?a=!0:o=l),l.track===r)),a||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function lT(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(a,l){if(!l)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=e.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(u)===-1&&this._shimmedLocalStreams[l.id].push(u):this._shimmedLocalStreams[l.id]=[l,u],u};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(d=>{if(this.getSenders().find(p=>p.track===d))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();t.apply(this,arguments);const u=this.getSenders().filter(d=>l.indexOf(d)===-1);this._shimmedLocalStreams[a.id]=[a].concat(u)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const u=this._shimmedLocalStreams[l].indexOf(a);u!==-1&&this._shimmedLocalStreams[l].splice(u,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),i.apply(this,arguments)}}function cT(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return lT(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const f=t.apply(this);return this._reverseStreams=this._reverseStreams||{},f.map(p=>this._reverseStreams[p.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(f){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},f.getTracks().forEach(p=>{if(this.getSenders().find(v=>v.track===p))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[f.id]){const p=new n.MediaStream(f.getTracks());this._streams[f.id]=p,this._reverseStreams[p.id]=f,f=p}r.apply(this,[f])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(f){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[f.id]||f]),delete this._reverseStreams[this._streams[f.id]?this._streams[f.id].id:f.id],delete this._streams[f.id]},n.RTCPeerConnection.prototype.addTrack=function(f,p){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const g=[].slice.call(arguments,1);if(g.length!==1||!g[0].getTracks().find(y=>y===f))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(y=>y.track===f))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[p.id];if(C)C.addTrack(f),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const y=new n.MediaStream([f]);this._streams[p.id]=y,this._reverseStreams[y.id]=p,this.addStream(y)}return this.getSenders().find(y=>y.track===f)};function o(d,f){let p=f.sdp;return Object.keys(d._reverseStreams||[]).forEach(g=>{const v=d._reverseStreams[g],C=d._streams[v.id];p=p.replace(new RegExp(C.id,"g"),v.id)}),new RTCSessionDescription({type:f.type,sdp:p})}function a(d,f){let p=f.sdp;return Object.keys(d._reverseStreams||[]).forEach(g=>{const v=d._reverseStreams[g],C=d._streams[v.id];p=p.replace(new RegExp(v.id,"g"),C.id)}),new RTCSessionDescription({type:f.type,sdp:p})}["createOffer","createAnswer"].forEach(function(d){const f=n.RTCPeerConnection.prototype[d],p={[d](){const g=arguments;return arguments.length&&typeof arguments[0]=="function"?f.apply(this,[C=>{const y=o(this,C);g[0].apply(null,[y])},C=>{g[1]&&g[1].apply(null,C)},arguments[2]]):f.apply(this,arguments).then(C=>o(this,C))}};n.RTCPeerConnection.prototype[d]=p[d]});const l=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?l.apply(this,arguments):(arguments[0]=a(this,arguments[0]),l.apply(this,arguments))};const u=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const d=u.get.apply(this);return d.type===""?d:o(this,d)}}),n.RTCPeerConnection.prototype.removeTrack=function(f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!f._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(f._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let g;Object.keys(this._streams).forEach(v=>{this._streams[v].getTracks().find(y=>f.track===y)&&(g=this._streams[v])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(f.track),this.dispatchEvent(new Event("negotiationneeded")))}}function bC(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function uT(n,e){Bc(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}var $A=Object.freeze({__proto__:null,fixNegotiationNeeded:uT,shimAddTrackRemoveTrack:cT,shimAddTrackRemoveTrackWithNative:lT,shimGetDisplayMedia:B6,shimGetSendersWithDtmf:oT,shimGetStats:sT,shimGetUserMedia:nT,shimMediaStream:rT,shimOnTrack:iT,shimPeerConnection:bC,shimSenderReceiverGetStats:aT});function dT(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,o,a){Ly("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(o,a)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(a,l,u){l in a&&!(u in a)&&(a[u]=a[l],delete a[l])},o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a.audio,"autoGainControl","mozAutoGainControl"),i(a.audio,"noiseSuppression","mozNoiseSuppression")),o(a)},r&&r.prototype.getSettings){const a=r.prototype.getSettings;r.prototype.getSettings=function(){const l=a.apply(this,arguments);return i(l,"mozAutoGainControl","autoGainControl"),i(l,"mozNoiseSuppression","noiseSuppression"),l}}if(r&&r.prototype.applyConstraints){const a=r.prototype.applyConstraints;r.prototype.applyConstraints=function(l){return this.kind==="audio"&&typeof l=="object"&&(l=JSON.parse(JSON.stringify(l)),i(l,"autoGainControl","mozAutoGainControl"),i(l,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[l])}}}}function O6(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function fT(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function AC(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=n.RTCPeerConnection.prototype[i],a={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=a[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[o,a,l]=arguments;return r.apply(this,[o||null]).then(u=>{if(e.version<53&&!a)try{u.forEach(d=>{d.type=t[d.type]||d.type})}catch(d){if(d.name!=="TypeError")throw d;u.forEach((f,p)=>{u.set(p,Object.assign({},f,{type:t[f.type]||f.type}))})}return u}).then(a,l)}}function hT(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function pT(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Bc(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function gT(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){Ly("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function mT(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function vT(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:a}=o,l=a.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=r,a.sendEncodings=r,this.setParametersPromises.push(a.setParameters(l).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return o})}function CT(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function yT(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function xT(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var JA=Object.freeze({__proto__:null,shimAddTransceiver:vT,shimCreateAnswer:xT,shimCreateOffer:yT,shimGetDisplayMedia:O6,shimGetParameters:CT,shimGetUserMedia:dT,shimOnTrack:fT,shimPeerConnection:AC,shimRTCDataChannel:mT,shimReceiverGetStats:pT,shimRemoveStream:gT,shimSenderGetStats:hT});function IT(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return o&&o.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function bT(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const a=new Event("addstream");a.stream=o,r.dispatchEvent(a)})}),e.apply(r,arguments)}}}function AT(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(d,f){const p=arguments.length>=2?arguments[2]:arguments[0],g=t.apply(this,[p]);return f?(g.then(d,f),Promise.resolve()):g},e.createAnswer=function(d,f){const p=arguments.length>=2?arguments[2]:arguments[0],g=r.apply(this,[p]);return f?(g.then(d,f),Promise.resolve()):g};let l=function(u,d,f){const p=i.apply(this,[u]);return f?(p.then(d,f),Promise.resolve()):p};e.setLocalDescription=l,l=function(u,d,f){const p=o.apply(this,[u]);return f?(p.then(d,f),Promise.resolve()):p},e.setRemoteDescription=l,l=function(u,d,f){const p=a.apply(this,[u]);return f?(p.then(d,f),Promise.resolve()):p},e.addIceCandidate=l}function wT(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(ST(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function ST(n){return n&&n.video!==void 0?Object.assign({},n,{video:tT(n.video)}):n}function kT(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let a=0;a<r.iceServers.length;a++){let l=r.iceServers[a];l.urls===void 0&&l.url?(Ly("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,o.push(l)):o.push(r.iceServers[a])}r.iceServers=o}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function ET(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function TT(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(a=>a.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function RT(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var YA=Object.freeze({__proto__:null,shimAudioContext:RT,shimCallbacksAPI:AT,shimConstraints:ST,shimCreateOfferLegacy:TT,shimGetUserMedia:wT,shimLocalStreamsAPI:IT,shimRTCIceServerUrls:kT,shimRemoteStreamsAPI:bT,shimTrackEventTransceiver:ET}),_T={exports:{}};(function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const o=t.type;return r.push("typ"),r.push(o),o!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const o=t.substring(t.indexOf(" ")+1).split(";");for(let a=0;a<o.length;a++)i=o[a].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach(a=>{t.parameters[a]!==void 0?o.push(a+"="+t.parameters[a]):o.push(a)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},o=t.indexOf(":",r);return o>-1?(i.attribute=t.substring(r+1,o),i.value=t.substring(o+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],o=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(t)[0].split(" ");r.profile=o[2];for(let l=3;l<o.length;l++){const u=o[l],d=e.matchPrefix(t,"a=rtpmap:"+u+" ")[0];if(d){const f=e.parseRtpMap(d),p=e.matchPrefix(t,"a=fmtp:"+u+" ");switch(f.parameters=p.length?e.parseFmtp(p[0]):{},f.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+u+" ").map(e.parseRtcpFb),r.codecs.push(f),f.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(f.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(l=>{r.headerExtensions.push(e.parseExtmap(l))});const a=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(l=>{a.forEach(u=>{l.rtcpFeedback.find(f=>f.type===u.type&&f.parameter===u.parameter)||l.rtcpFeedback.push(u)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(a=>{i+=e.writeRtpMap(a),i+=e.writeFmtp(a),i+=e.writeRtcpFb(a)});let o=0;return r.codecs.forEach(a=>{a.maxptime>o&&(o=a.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(a=>{i+=e.writeExtmap(a)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),o=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,l=e.matchPrefix(t,"a=ssrc:").map(g=>e.parseSsrcMedia(g)).filter(g=>g.attribute==="cname"),u=l.length>0&&l[0].ssrc;let d;const f=e.matchPrefix(t,"a=ssrc-group:FID").map(g=>g.substring(17).split(" ").map(C=>parseInt(C,10)));f.length>0&&f[0].length>1&&f[0][0]===u&&(d=f[0][1]),i.codecs.forEach(g=>{if(g.name.toUpperCase()==="RTX"&&g.parameters.apt){let v={ssrc:u,codecPayloadType:parseInt(g.parameters.apt,10)};u&&d&&(v.rtx={ssrc:d}),r.push(v),o&&(v=JSON.parse(JSON.stringify(v)),v.fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},r.push(v))}}),r.length===0&&u&&r.push({ssrc:u});let p=e.matchPrefix(t,"b=");return p.length&&(p[0].indexOf("b=TIAS:")===0?p=parseInt(p[0].substring(7),10):p[0].indexOf("b=AS:")===0?p=parseInt(p[0].substring(5),10)*1e3*.95-50*40*8:p=void 0,r.forEach(g=>{g.maxBitrate=p})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const a=e.matchPrefix(t,"a=rtcp-mux");return r.mux=a.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const a=e.matchPrefix(t,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const l=e.matchPrefix(t,"a=sctpmap:");if(l.length>0){const u=l[0].substring(10).split(" ");return{port:parseInt(u[0],10),protocol:u[1],maxMessageSize:o}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let o;const a=r!==void 0?r:2;return t?o=t:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e})(_T);var PT=_T.exports,Au=M8(PT),F6=O8({__proto__:null,default:Au},[PT]);function o0(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=Au.parseCandidate(r.candidate);for(const a in o)a in i||Object.defineProperty(i,a,{value:o[a]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,Bc(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function wC(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||Bc(n,"icecandidate",e=>{if(e.candidate){const t=Au.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function s0(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(l){if(!l||!l.sdp)return!1;const u=Au.splitSections(l.sdp);return u.shift(),u.some(d=>{const f=Au.parseMLine(d);return f&&f.kind==="application"&&f.protocol.indexOf("SCTP")!==-1})},r=function(l){const u=l.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(u===null||u.length<2)return-1;const d=parseInt(u[1],10);return d!==d?-1:d},i=function(l){let u=65536;return e.browser==="firefox"&&(e.version<57?l===-1?u=16384:u=2147483637:e.version<60?u=e.version===57?65535:65536:u=2147483637),u},o=function(l,u){let d=65536;e.browser==="firefox"&&e.version===57&&(d=65535);const f=Au.matchPrefix(l.sdp,"a=max-message-size:");return f.length>0?d=parseInt(f[0].substring(19),10):e.browser==="firefox"&&u!==-1&&(d=2147483637),d},a=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const u=r(arguments[0]),d=i(u),f=o(arguments[0],u);let p;d===0&&f===0?p=Number.POSITIVE_INFINITY:d===0||f===0?p=Math.max(d,f):p=Math.min(d,f);const g={};Object.defineProperty(g,"maxMessageSize",{get(){return p}}),this._sctp=g}return a.apply(this,arguments)}}function a0(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const l=arguments[0],u=l.length||l.size||l.byteLength;if(r.readyState==="open"&&i.sctp&&u>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},Bc(n,"datachannel",r=>(e(r.channel,r.target),r))}function SC(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const a=new Event("connectionstatechange",i);o.dispatchEvent(a)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function kC(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return t.apply(this,arguments)}}function l0(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function c0(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}var M6=Object.freeze({__proto__:null,removeExtmapAllowMixed:kC,shimAddIceCandidateNullOrEmpty:l0,shimConnectionState:SC,shimMaxMessageSize:s0,shimParameterlessSetLocalDescription:c0,shimRTCIceCandidate:o0,shimRTCIceCandidateRelayProtocol:wC,shimSendThrowTypeError:a0});function L6(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=eT,r=N6(n),i={browserDetails:r,commonShim:M6,extractVersion:i0,disableLog:P6,disableWarnings:D6,sdp:F6};switch(r.browser){case"chrome":if(!$A||!bC||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=$A,l0(n,r),c0(n),nT(n,r),rT(n),bC(n,r),iT(n),cT(n,r),oT(n),sT(n),aT(n),uT(n,r),o0(n),wC(n),SC(n),s0(n,r),a0(n),kC(n,r);break;case"firefox":if(!JA||!AC||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=JA,l0(n,r),c0(n),dT(n,r),AC(n,r),fT(n),gT(n),hT(n),pT(n),mT(n),vT(n),CT(n),yT(n),xT(n),o0(n),SC(n),s0(n,r),a0(n);break;case"safari":if(!YA||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=YA,l0(n,r),c0(n),kT(n),TT(n),AT(n),IT(n),bT(n),ET(n),wT(n),RT(n),o0(n),wC(n),s0(n,r),a0(n),kC(n,r);break;default:t("Unsupported browser!");break}return i}L6({window:typeof window>"u"?void 0:window});const U6=10,sp="lk_e2ee",V6="LKFrameEncryptionKey",G6={sharedKey:!1,ratchetSalt:V6,ratchetWindowSize:8,failureTolerance:U6};var Tl;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(Tl||(Tl={}));var qA;(function(n){n.KeyRatcheted="keyRatcheted"})(qA||(qA={}));var Sl;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(Sl||(Sl={}));var QA;(function(n){n.Error="cryptorError"})(QA||(QA={}));function W6(){return j6()||EC()}function EC(){return typeof window.RTCRtpScriptTransform<"u"}function j6(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class Bz extends zs.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,r)=>{nn.debug("key ratcheted event received",{material:t,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},G6),e),this.on(Tl.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,r){const i={key:e,participantIdentity:t,keyIndex:r};this.keyInfoMap.set("".concat(t??"shared","-").concat(r??0),i),this.emit(Tl.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(Tl.RatchetRequest,e,t)}}class Yu extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}class Pn extends Yu{constructor(e,t,r){super(1,e),this.status=r,this.reason=t}}class Uy extends Yu{constructor(e){super(21,e??"device is unsupported")}}class vs extends Yu{constructor(e){super(20,e??"track is invalid")}}class z6 extends Yu{constructor(e){super(10,e??"unsupported server")}}class fr extends Yu{constructor(e){super(12,e??"unexpected connection state")}}class TC extends Yu{constructor(e){super(13,e??"unable to negotiate")}}var Af;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(Af||(Af={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(Af||(Af={}));var Le;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.StateChanged="connectionStateChanged",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged"})(Le||(Le={}));var We;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded"})(We||(We={}));var pt;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished"})(pt||(pt={}));var it;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed"})(it||(it={}));function Vy(n,e,t){var r,i,o;e===void 0&&(e=50),t===void 0&&(t={});var a=(r=t.isImmediate)!=null&&r,l=(i=t.callback)!=null&&i,u=t.maxWait,d=Date.now(),f=[];function p(){if(u!==void 0){var v=Date.now()-d;if(v+e>=u)return u-v}return e}var g=function(){var v=[].slice.call(arguments),C=this;return new Promise(function(y,x){var I=a&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,d=Date.now(),!a){var T=n.apply(C,v);l&&l(T),f.forEach(function(R){return(0,R.resolve)(T)}),f=[]}},p()),I){var b=n.apply(C,v);return l&&l(b),y(b)}f.push({resolve:y,reject:x})})};return g.cancel=function(v){o!==void 0&&clearTimeout(o),f.forEach(function(C){return(0,C.reject)(v)}),f=[]},g}const H6=/version\/(\d+(\.?_?\d+)+)/i;let dv;function Ga(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(dv===void 0||e){const r=Z6.find(i=>{let{test:o}=i;return o.test(t)});dv=r==null?void 0:r.describe(t)}return dv}const Z6=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:fv(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:fv(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:fv(H6,n),os:n.includes("mobile/")?"iOS":"macOS"}}}];function fv(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(n);return r&&r.length>=t&&r[t]||""}var X6="1.15.13";const K6=X6,$6=11;class Dr{}Dr.setTimeout=function(){return setTimeout(...arguments)};Dr.setInterval=function(){return setInterval(...arguments)};Dr.clearTimeout=function(){return clearTimeout(...arguments)};Dr.clearInterval=function(){return clearInterval(...arguments)};class wn{constructor(e,t,r,i,o){this.width=e,this.height=t,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const J6=["vp8","h264"],DT=["vp8","h264","vp9","av1"];function Y6(n){return!!J6.find(e=>e===n)}var P0;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:2e4},n.music={maxBitrate:32e3},n.musicStereo={maxBitrate:48e3},n.musicHighQuality={maxBitrate:64e3},n.musicHighQualityStereo={maxBitrate:96e3}})(P0||(P0={}));const wf={h90:new wn(160,90,9e4,20),h180:new wn(320,180,16e4,20),h216:new wn(384,216,18e4,20),h360:new wn(640,360,45e4,20),h540:new wn(960,540,8e5,25),h720:new wn(1280,720,17e5,30),h1080:new wn(1920,1080,3e6,30),h1440:new wn(2560,1440,5e6,30),h2160:new wn(3840,2160,8e6,30)},RC={h120:new wn(160,120,7e4,20),h180:new wn(240,180,125e3,20),h240:new wn(320,240,14e4,20),h360:new wn(480,360,33e4,20),h480:new wn(640,480,5e5,20),h540:new wn(720,540,6e5,25),h720:new wn(960,720,13e5,30),h1080:new wn(1440,1080,23e5,30),h1440:new wn(1920,1440,38e5,30)},Gy={h360fps3:new wn(640,360,2e5,3,"medium"),h360fps15:new wn(640,360,4e5,15,"medium"),h720fps5:new wn(1280,720,8e5,5,"medium"),h720fps15:new wn(1280,720,15e5,15,"medium"),h720fps30:new wn(1280,720,2e6,30,"medium"),h1080fps15:new wn(1920,1080,25e5,15,"medium"),h1080fps30:new wn(1920,1080,5e6,30,"medium"),original:new wn(0,0,7e6,30,"medium")};var Jr;(function(n){n[n.PUBLISHER=0]="PUBLISHER",n[n.SUBSCRIBER=1]="SUBSCRIBER"})(Jr||(Jr={}));$.util.setEnumType(Jr,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var wc;(function(n){n[n.ACTIVE=0]="ACTIVE",n[n.PAUSED=1]="PAUSED"})(wc||(wc={}));$.util.setEnumType(wc,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var D0;(function(n){n[n.UDP=0]="UDP",n[n.TCP=1]="TCP",n[n.TLS=2]="TLS"})(D0||(D0={}));$.util.setEnumType(D0,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class xa extends lt{constructor(e){super(),this.message={case:void 0},$.util.initPartial(e,this)}static fromBinary(e,t){return new xa().fromBinary(e,t)}static fromJson(e,t){return new xa().fromJson(e,t)}static fromJsonString(e,t){return new xa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(xa,e,t)}}xa.runtime=$;xa.typeName="livekit.SignalRequest";xa.fields=$.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:hi,oneof:"message"},{no:2,name:"answer",kind:"message",T:hi,oneof:"message"},{no:3,name:"trickle",kind:"message",T:jo,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Wo,oneof:"message"},{no:5,name:"mute",kind:"message",T:zo,oneof:"message"},{no:6,name:"subscription",kind:"message",T:fo,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:ks,oneof:"message"},{no:8,name:"leave",kind:"message",T:ho,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Es,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Ps,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Ds,oneof:"message"},{no:13,name:"simulate",kind:"message",T:_r,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Ts,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Bs,oneof:"message"}]);class Ss extends lt{constructor(e){super(),this.message={case:void 0},$.util.initPartial(e,this)}static fromBinary(e,t){return new Ss().fromBinary(e,t)}static fromJson(e,t){return new Ss().fromJson(e,t)}static fromJsonString(e,t){return new Ss().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ss,e,t)}}Ss.runtime=$;Ss.typeName="livekit.SignalResponse";Ss.fields=$.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:Ia,oneof:"message"},{no:2,name:"answer",kind:"message",T:hi,oneof:"message"},{no:3,name:"offer",kind:"message",T:hi,oneof:"message"},{no:4,name:"trickle",kind:"message",T:jo,oneof:"message"},{no:5,name:"update",kind:"message",T:wa,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Ho,oneof:"message"},{no:8,name:"leave",kind:"message",T:ho,oneof:"message"},{no:9,name:"mute",kind:"message",T:zo,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Sa,oneof:"message"},{no:11,name:"room_update",kind:"message",T:ka,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Ta,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:_a,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Da,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Na,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Aa,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:ba,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Ba,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Fa,oneof:"message"}]);class Go extends lt{constructor(e){super(),this.codec="",this.cid="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Go().fromBinary(e,t)}static fromJson(e,t){return new Go().fromJson(e,t)}static fromJsonString(e,t){return new Go().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Go,e,t)}}Go.runtime=$;Go.typeName="livekit.SimulcastCodec";Go.fields=$.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Wo extends lt{constructor(e){super(),this.cid="",this.name="",this.type=$r.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=nr.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Pr.NONE,this.stream="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Wo().fromBinary(e,t)}static fromJson(e,t){return new Wo().fromJson(e,t)}static fromJsonString(e,t){return new Wo().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Wo,e,t)}}Wo.runtime=$;Wo.typeName="livekit.AddTrackRequest";Wo.fields=$.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:$.getEnumType($r)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:$.getEnumType(nr)},{no:9,name:"layers",kind:"message",T:fi,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Go,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:$.getEnumType(Pr)},{no:15,name:"stream",kind:"scalar",T:9}]);class jo extends lt{constructor(e){super(),this.candidateInit="",this.target=Jr.PUBLISHER,$.util.initPartial(e,this)}static fromBinary(e,t){return new jo().fromBinary(e,t)}static fromJson(e,t){return new jo().fromJson(e,t)}static fromJsonString(e,t){return new jo().fromJsonString(e,t)}static equals(e,t){return $.util.equals(jo,e,t)}}jo.runtime=$;jo.typeName="livekit.TrickleRequest";jo.fields=$.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:$.getEnumType(Jr)}]);class zo extends lt{constructor(e){super(),this.sid="",this.muted=!1,$.util.initPartial(e,this)}static fromBinary(e,t){return new zo().fromBinary(e,t)}static fromJson(e,t){return new zo().fromJson(e,t)}static fromJsonString(e,t){return new zo().fromJsonString(e,t)}static equals(e,t){return $.util.equals(zo,e,t)}}zo.runtime=$;zo.typeName="livekit.MuteTrackRequest";zo.fields=$.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class Ia extends lt{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),$.util.initPartial(e,this)}static fromBinary(e,t){return new Ia().fromBinary(e,t)}static fromJson(e,t){return new Ia().fromJson(e,t)}static fromJsonString(e,t){return new Ia().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ia,e,t)}}Ia.runtime=$;Ia.typeName="livekit.JoinResponse";Ia.fields=$.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Ju},{no:2,name:"participant",kind:"message",T:Yi},{no:3,name:"other_participants",kind:"message",T:Yi,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Rs,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:bs},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:va},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class ba extends lt{constructor(e){super(),this.iceServers=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new ba().fromBinary(e,t)}static fromJson(e,t){return new ba().fromJson(e,t)}static fromJsonString(e,t){return new ba().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ba,e,t)}}ba.runtime=$;ba.typeName="livekit.ReconnectResponse";ba.fields=$.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:Rs,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:bs}]);class Ho extends lt{constructor(e){super(),this.cid="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Ho().fromBinary(e,t)}static fromJson(e,t){return new Ho().fromJson(e,t)}static fromJsonString(e,t){return new Ho().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ho,e,t)}}Ho.runtime=$;Ho.typeName="livekit.TrackPublishedResponse";Ho.fields=$.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Fi}]);class Aa extends lt{constructor(e){super(),this.trackSid="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Aa().fromBinary(e,t)}static fromJson(e,t){return new Aa().fromJson(e,t)}static fromJsonString(e,t){return new Aa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Aa,e,t)}}Aa.runtime=$;Aa.typeName="livekit.TrackUnpublishedResponse";Aa.fields=$.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class hi extends lt{constructor(e){super(),this.type="",this.sdp="",$.util.initPartial(e,this)}static fromBinary(e,t){return new hi().fromBinary(e,t)}static fromJson(e,t){return new hi().fromJson(e,t)}static fromJsonString(e,t){return new hi().fromJsonString(e,t)}static equals(e,t){return $.util.equals(hi,e,t)}}hi.runtime=$;hi.typeName="livekit.SessionDescription";hi.fields=$.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class wa extends lt{constructor(e){super(),this.participants=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new wa().fromBinary(e,t)}static fromJson(e,t){return new wa().fromJson(e,t)}static fromJsonString(e,t){return new wa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(wa,e,t)}}wa.runtime=$;wa.typeName="livekit.ParticipantUpdate";wa.fields=$.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Yi,repeated:!0}]);class fo extends lt{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new fo().fromBinary(e,t)}static fromJson(e,t){return new fo().fromJson(e,t)}static fromJsonString(e,t){return new fo().fromJsonString(e,t)}static equals(e,t){return $.util.equals(fo,e,t)}}fo.runtime=$;fo.typeName="livekit.UpdateSubscription";fo.fields=$.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Is,repeated:!0}]);class ks extends lt{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=gr.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,$.util.initPartial(e,this)}static fromBinary(e,t){return new ks().fromBinary(e,t)}static fromJson(e,t){return new ks().fromJson(e,t)}static fromJsonString(e,t){return new ks().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ks,e,t)}}ks.runtime=$;ks.typeName="livekit.UpdateTrackSettings";ks.fields=$.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:$.getEnumType(gr)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class ho extends lt{constructor(e){super(),this.canReconnect=!1,this.reason=La.UNKNOWN_REASON,$.util.initPartial(e,this)}static fromBinary(e,t){return new ho().fromBinary(e,t)}static fromJson(e,t){return new ho().fromJson(e,t)}static fromJsonString(e,t){return new ho().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ho,e,t)}}ho.runtime=$;ho.typeName="livekit.LeaveRequest";ho.fields=$.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:$.getEnumType(La)}]);class Es extends lt{constructor(e){super(),this.trackSid="",this.layers=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Es().fromBinary(e,t)}static fromJson(e,t){return new Es().fromJson(e,t)}static fromJsonString(e,t){return new Es().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Es,e,t)}}Es.runtime=$;Es.typeName="livekit.UpdateVideoLayers";Es.fields=$.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:fi,repeated:!0}]);class Ts extends lt{constructor(e){super(),this.metadata="",this.name="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Ts().fromBinary(e,t)}static fromJson(e,t){return new Ts().fromJson(e,t)}static fromJsonString(e,t){return new Ts().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ts,e,t)}}Ts.runtime=$;Ts.typeName="livekit.UpdateParticipantMetadata";Ts.fields=$.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class Rs extends lt{constructor(e){super(),this.urls=[],this.username="",this.credential="",$.util.initPartial(e,this)}static fromBinary(e,t){return new Rs().fromBinary(e,t)}static fromJson(e,t){return new Rs().fromJson(e,t)}static fromJsonString(e,t){return new Rs().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Rs,e,t)}}Rs.runtime=$;Rs.typeName="livekit.ICEServer";Rs.fields=$.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Sa extends lt{constructor(e){super(),this.speakers=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Sa().fromBinary(e,t)}static fromJson(e,t){return new Sa().fromJson(e,t)}static fromJsonString(e,t){return new Sa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Sa,e,t)}}Sa.runtime=$;Sa.typeName="livekit.SpeakersChanged";Sa.fields=$.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:ys,repeated:!0}]);class ka extends lt{constructor(e){super(),$.util.initPartial(e,this)}static fromBinary(e,t){return new ka().fromBinary(e,t)}static fromJson(e,t){return new ka().fromJson(e,t)}static fromJsonString(e,t){return new ka().fromJsonString(e,t)}static equals(e,t){return $.util.equals(ka,e,t)}}ka.runtime=$;ka.typeName="livekit.RoomUpdate";ka.fields=$.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Ju}]);class Ea extends lt{constructor(e){super(),this.participantSid="",this.quality=ha.POOR,this.score=0,$.util.initPartial(e,this)}static fromBinary(e,t){return new Ea().fromBinary(e,t)}static fromJson(e,t){return new Ea().fromJson(e,t)}static fromJsonString(e,t){return new Ea().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ea,e,t)}}Ea.runtime=$;Ea.typeName="livekit.ConnectionQualityInfo";Ea.fields=$.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:$.getEnumType(ha)},{no:3,name:"score",kind:"scalar",T:2}]);class Ta extends lt{constructor(e){super(),this.updates=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Ta().fromBinary(e,t)}static fromJson(e,t){return new Ta().fromJson(e,t)}static fromJsonString(e,t){return new Ta().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ta,e,t)}}Ta.runtime=$;Ta.typeName="livekit.ConnectionQualityUpdate";Ta.fields=$.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:Ea,repeated:!0}]);class Ra extends lt{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=wc.ACTIVE,$.util.initPartial(e,this)}static fromBinary(e,t){return new Ra().fromBinary(e,t)}static fromJson(e,t){return new Ra().fromJson(e,t)}static fromJsonString(e,t){return new Ra().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ra,e,t)}}Ra.runtime=$;Ra.typeName="livekit.StreamStateInfo";Ra.fields=$.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:$.getEnumType(wc)}]);class _a extends lt{constructor(e){super(),this.streamStates=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new _a().fromBinary(e,t)}static fromJson(e,t){return new _a().fromJson(e,t)}static fromJsonString(e,t){return new _a().fromJsonString(e,t)}static equals(e,t){return $.util.equals(_a,e,t)}}_a.runtime=$;_a.typeName="livekit.StreamStateUpdate";_a.fields=$.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:Ra,repeated:!0}]);class Zo extends lt{constructor(e){super(),this.quality=gr.LOW,this.enabled=!1,$.util.initPartial(e,this)}static fromBinary(e,t){return new Zo().fromBinary(e,t)}static fromJson(e,t){return new Zo().fromJson(e,t)}static fromJsonString(e,t){return new Zo().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Zo,e,t)}}Zo.runtime=$;Zo.typeName="livekit.SubscribedQuality";Zo.fields=$.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:$.getEnumType(gr)},{no:2,name:"enabled",kind:"scalar",T:8}]);class Pa extends lt{constructor(e){super(),this.codec="",this.qualities=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Pa().fromBinary(e,t)}static fromJson(e,t){return new Pa().fromJson(e,t)}static fromJsonString(e,t){return new Pa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Pa,e,t)}}Pa.runtime=$;Pa.typeName="livekit.SubscribedCodec";Pa.fields=$.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Zo,repeated:!0}]);class Da extends lt{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Da().fromBinary(e,t)}static fromJson(e,t){return new Da().fromJson(e,t)}static fromJsonString(e,t){return new Da().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Da,e,t)}}Da.runtime=$;Da.typeName="livekit.SubscribedQualityUpdate";Da.fields=$.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Zo,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Pa,repeated:!0}]);class _s extends lt{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",$.util.initPartial(e,this)}static fromBinary(e,t){return new _s().fromBinary(e,t)}static fromJson(e,t){return new _s().fromJson(e,t)}static fromJsonString(e,t){return new _s().fromJsonString(e,t)}static equals(e,t){return $.util.equals(_s,e,t)}}_s.runtime=$;_s.typeName="livekit.TrackPermission";_s.fields=$.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class Ps extends lt{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Ps().fromBinary(e,t)}static fromJson(e,t){return new Ps().fromJson(e,t)}static fromJsonString(e,t){return new Ps().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ps,e,t)}}Ps.runtime=$;Ps.typeName="livekit.SubscriptionPermission";Ps.fields=$.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:_s,repeated:!0}]);class Na extends lt{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,$.util.initPartial(e,this)}static fromBinary(e,t){return new Na().fromBinary(e,t)}static fromJson(e,t){return new Na().fromJson(e,t)}static fromJsonString(e,t){return new Na().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Na,e,t)}}Na.runtime=$;Na.typeName="livekit.SubscriptionPermissionUpdate";Na.fields=$.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class Ds extends lt{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new Ds().fromBinary(e,t)}static fromJson(e,t){return new Ds().fromJson(e,t)}static fromJsonString(e,t){return new Ds().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ds,e,t)}}Ds.runtime=$;Ds.typeName="livekit.SyncState";Ds.fields=$.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:hi},{no:2,name:"subscription",kind:"message",T:fo},{no:3,name:"publish_tracks",kind:"message",T:Ho,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Ns,repeated:!0},{no:5,name:"offer",kind:"message",T:hi}]);class Ns extends lt{constructor(e){super(),this.label="",this.id=0,this.target=Jr.PUBLISHER,$.util.initPartial(e,this)}static fromBinary(e,t){return new Ns().fromBinary(e,t)}static fromJson(e,t){return new Ns().fromJson(e,t)}static fromJsonString(e,t){return new Ns().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ns,e,t)}}Ns.runtime=$;Ns.typeName="livekit.DataChannelInfo";Ns.fields=$.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:$.getEnumType(Jr)}]);class _r extends lt{constructor(e){super(),this.scenario={case:void 0},$.util.initPartial(e,this)}static fromBinary(e,t){return new _r().fromBinary(e,t)}static fromJson(e,t){return new _r().fromJson(e,t)}static fromJsonString(e,t){return new _r().fromJsonString(e,t)}static equals(e,t){return $.util.equals(_r,e,t)}}_r.runtime=$;_r.typeName="livekit.SimulateScenario";_r.fields=$.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:$.getEnumType(D0),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class Bs extends lt{constructor(e){super(),this.timestamp=Kt.zero,this.rtt=Kt.zero,$.util.initPartial(e,this)}static fromBinary(e,t){return new Bs().fromBinary(e,t)}static fromJson(e,t){return new Bs().fromJson(e,t)}static fromJsonString(e,t){return new Bs().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Bs,e,t)}}Bs.runtime=$;Bs.typeName="livekit.Ping";Bs.fields=$.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class Ba extends lt{constructor(e){super(),this.lastPingTimestamp=Kt.zero,this.timestamp=Kt.zero,$.util.initPartial(e,this)}static fromBinary(e,t){return new Ba().fromBinary(e,t)}static fromJson(e,t){return new Ba().fromJson(e,t)}static fromJsonString(e,t){return new Ba().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Ba,e,t)}}Ba.runtime=$;Ba.typeName="livekit.Pong";Ba.fields=$.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class kl extends lt{constructor(e){super(),this.regions=[],$.util.initPartial(e,this)}static fromBinary(e,t){return new kl().fromBinary(e,t)}static fromJson(e,t){return new kl().fromJson(e,t)}static fromJsonString(e,t){return new kl().fromJsonString(e,t)}static equals(e,t){return $.util.equals(kl,e,t)}}kl.runtime=$;kl.typeName="livekit.RegionSettings";kl.fields=$.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Oa,repeated:!0}]);class Oa extends lt{constructor(e){super(),this.region="",this.url="",this.distance=Kt.zero,$.util.initPartial(e,this)}static fromBinary(e,t){return new Oa().fromBinary(e,t)}static fromJson(e,t){return new Oa().fromJson(e,t)}static fromJsonString(e,t){return new Oa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Oa,e,t)}}Oa.runtime=$;Oa.typeName="livekit.RegionInfo";Oa.fields=$.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class Fa extends lt{constructor(e){super(),this.trackSid="",this.err=bf.SE_UNKNOWN,$.util.initPartial(e,this)}static fromBinary(e,t){return new Fa().fromBinary(e,t)}static fromJson(e,t){return new Fa().fromJson(e,t)}static fromJsonString(e,t){return new Fa().fromJsonString(e,t)}static equals(e,t){return $.util.equals(Fa,e,t)}}Fa.runtime=$;Fa.typeName="livekit.SubscriptionResponse";Fa.fields=$.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:$.getEnumType(bf)}]);function q6(n){if(!(typeof n>"u"))return typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}const Q6=5e3,$d=[];class Ne extends zs.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Ne.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=nn,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),Q6):this.handleAppVisibilityChanged()},this.log=Va((i=r.loggerName)!==null&&i!==void 0?i:Ms.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Ne.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Mn(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===Ne.Kind.Video&&(t="video"),this.attachedElements.length===0&&Ne.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&($d.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&$d.splice($d.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),mu(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?it.AudioPlaybackStarted:it.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?it.AudioPlaybackFailed:it.VideoPlaybackFailed,o):o.name==="AbortError"?nn.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):nn.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(a=>a.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(it.ElementAttached,e),e}detach(e){try{if(e){wu(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(it.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(r=>{wu(this.mediaStreamTrack,r),t.push(r),this.recycleElement(r),this.emit(it.ElementDetached,r)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=Va(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),$d.forEach(r=>{r.parentElement||(t=!1)}),t&&$d.push(e)}}handleAppVisibilityChanged(){return ge(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){Mi()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Mi()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function mu(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let r;n.kind==="audio"?r=t.getAudioTracks():r=t.getVideoTracks(),r.includes(n)||(r.forEach(i=>{t.removeTrack(i)}),t.addTrack(n)),(!Sc()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(Sc()||Uu())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function wu(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(d){d.Audio="audio",d.Video="video",d.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(d){d.Camera="camera",d.Microphone="microphone",d.ScreenShare="screen_share",d.ScreenShareAudio="screen_share_audio",d.Unknown="unknown"})(t=n.Source||(n.Source={}));let r;(function(d){d.Active="active",d.Paused="paused",d.Unknown="unknown"})(r=n.StreamState||(n.StreamState={}));function i(d){switch(d){case e.Audio:return $r.AUDIO;case e.Video:return $r.VIDEO;default:return $r.DATA}}n.kindToProto=i;function o(d){switch(d){case $r.AUDIO:return e.Audio;case $r.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=o;function a(d){switch(d){case t.Camera:return nr.CAMERA;case t.Microphone:return nr.MICROPHONE;case t.ScreenShare:return nr.SCREEN_SHARE;case t.ScreenShareAudio:return nr.SCREEN_SHARE_AUDIO;default:return nr.UNKNOWN}}n.sourceToProto=a;function l(d){switch(d){case nr.CAMERA:return t.Camera;case nr.MICROPHONE:return t.Microphone;case nr.SCREEN_SHARE:return t.ScreenShare;case nr.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=l;function u(d){switch(d){case wc.ACTIVE:return r.Active;case wc.PAUSED:return r.Paused;default:return r.Unknown}}n.streamStateFromProto=u})(Ne||(Ne={}));function NT(n,e,t){var r;const i=(r=q6(n))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&_C(i.audio,e),i.video&&_C(i.video,t),i}function _C(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function eg(n){const e={};if(n.video)if(typeof n.video=="object"){const t={},r=t,i=n.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":_C(r,i.resolution);break;default:r[o]=i[o]}}),e.video=t}else e.video=n.video;else e.video=!1;return n.audio?typeof n.audio=="object"?e.audio=n.audio:e.audio=!0:e.audio=!1,e}function e9(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return ge(this,void 0,void 0,function*(){const t=Wy();if(t){const r=t.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);t.createMediaStreamSource(new MediaStream([n.mediaStreamTrack])).connect(r),yield Ua(e),r.getByteTimeDomainData(o);const l=o.some(u=>u!==128&&u!==0);return t.close(),!l}return!1})}function Wy(){const n=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(n)return new n({latencyHint:"interactive"})}function t9(n){return n===Ne.Source.Microphone?"audioinput":n===Ne.Source.Camera?"videoinput":void 0}function n9(n){var e,t;let r=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Sc()?r=Object.assign(Object.assign({},r),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:r,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio}}function BT(n){const e=n.split("/")[1].toLowerCase();if(!DT.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function r9(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new Ho({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function Mn(n){return n instanceof Ne?{trackSid:n.sid,trackSource:n.source,trackMuted:n.isMuted,trackEnabled:n.mediaStreamTrack.enabled,trackKind:n.kind}:{trackSid:n.trackSid,trackName:n.trackName,track:n.track?Mn(n.track):void 0,trackEnabled:n.isEnabled,trackEncrypted:n.isEncrypted,trackMimeType:n.mimeType}}const i9="|",ew="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function o9(n){const e=n.split(i9);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function Ua(n){return ge(this,void 0,void 0,function*(){return new Promise(e=>Dr.setTimeout(e,n))})}function tw(){return"addTransceiver"in RTCPeerConnection.prototype}function nw(){return"addTrack"in RTCPeerConnection.prototype}function s9(){if(!("getCapabilities"in RTCRtpSender)||Sc())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/AV1"){e=!0;break}}return e}function a9(){if(!("getCapabilities"in RTCRtpSender)||Uu())return!1;if(Sc()){const t=Ga();if(t!=null&&t.version&&jy(t.version,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/VP9"){e=!0;break}}return e}function lf(n){return n==="av1"||n==="vp9"}function PC(n){return document?(n||(n=document.createElement("audio")),"setSinkId"in n):!1}const l9={Chrome:"100",Safari:"15",Firefox:"100"};function c9(n){if(!Mi()||!("setCodecPreferences"in n))return!1;const e=Ga();if(!(e!=null&&e.name)||!e.version)return!1;const t=l9[e.name];return t?jy(e.version,t)>=0:!1}function Uu(){var n;return((n=Ga())===null||n===void 0?void 0:n.name)==="Firefox"}function u9(){var n;return((n=Ga())===null||n===void 0?void 0:n.name)==="Chrome"}function Sc(){var n;return((n=Ga())===null||n===void 0?void 0:n.name)==="Safari"}function d9(){const n=Ga();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")}function OT(){return Mi()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function Mi(){return typeof document<"u"}function kc(){return navigator.product=="ReactNative"}function DC(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function FT(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function MT(){if(!kc())return;let n=FT();if(n)return n.platform}function rw(){if(Mi())return window.devicePixelRatio;if(kc()){let n=FT();if(n)return n.devicePixelRatio}return 1}function jy(n,e){const t=n.split("."),r=e.split("."),i=Math.min(t.length,r.length);for(let o=0;o<i;++o){const a=parseInt(t[o],10),l=parseInt(r[o],10);if(a>l)return 1;if(a<l)return-1;if(o===i-1&&a===l)return 0}return n===""&&e!==""?-1:e===""?1:t.length==r.length?0:t.length<r.length?-1:1}function f9(n){for(const e of n)e.target.handleResize(e)}function h9(n){for(const e of n)e.target.handleVisibilityChanged(e)}let hv=null;const iw=()=>(hv||(hv=new ResizeObserver(f9)),hv);let pv=null;const ow=()=>(pv||(pv=new IntersectionObserver(h9,{root:null,rootMargin:"0px"})),pv);function p9(){var n;const e=new Ca({sdk:Lu.JS,protocol:$6,version:K6});return kc()&&(e.os=(n=MT())!==null&&n!==void 0?n:""),e}function sw(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=n,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(n/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const a=i.captureStream(),[l]=a.getTracks();if(!l)throw Error("Could not get empty media stream video track");return l.enabled=t,l}let Jd;function gv(){if(!Jd){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const r=n.createMediaStreamDestination();if(e.connect(t),t.connect(r),e.start(),[Jd]=r.stream.getAudioTracks(),!Jd)throw Error("Could not get empty media stream audio track");Jd.enabled=!1}return Jd.clone()}class LT{constructor(e,t){this.onFinally=t,this.promise=new Promise((r,i)=>ge(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function g9(n,e){const t=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=Wy();if(!r)throw new Error("Audio Context not supported on this browser");const i=t.cloneTrack?n.mediaStreamTrack.clone():n.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),a=r.createAnalyser();a.minDecibels=t.minDecibels,a.maxDecibels=t.maxDecibels,a.fftSize=t.fftSize,a.smoothingTimeConstant=t.smoothingTimeConstant,o.connect(a);const l=new Uint8Array(a.frequencyBinCount);return{calculateVolume:()=>{a.getByteFrequencyData(l);let f=0;for(const g of l)f+=Math.pow(g/255,2);return Math.sqrt(f/l.length)},analyser:a,cleanup:()=>ge(this,void 0,void 0,function*(){yield r.close(),t.cloneTrack&&i.stop()})}}class Xo{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),r}}function m9(n){return DT.includes(n)}function mc(n){if(typeof n=="string")return n;if(Array.isArray(n))return n[0];if(n.exact)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function v9(n){return n.startsWith("http")?n.replace(/^(http)/,"ws"):n}function aw(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}const lw="default";class ci{static getInstance(){return this.instance===void 0&&(this.instance=new ci),this.instance}getDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return ge(this,void 0,void 0,function*(){if(((r=ci.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){nn.debug("awaiting getUserMedia promise");try{e?yield ci.userMediaPromiseMap.get(e):yield Promise.all(ci.userMediaPromiseMap.values())}catch{nn.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(t&&!(Sc()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(a=>{const l=a.label==="",u=e?a.kind===e:!0;return l&&u}))){const a={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},l=yield navigator.mediaDevices.getUserMedia(a);i=yield navigator.mediaDevices.enumerateDevices(),l.getTracks().forEach(u=>{u.stop()})}return e&&(i=i.filter(o=>o.kind===e)),i})}normalizeDeviceId(e,t,r){return ge(this,void 0,void 0,function*(){if(t!==lw)return t;const o=(yield this.getDevices(e)).find(a=>a.groupId===r&&a.deviceId!==lw);return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?ci.userMediaPromiseMap.has(e):ci.userMediaPromiseMap.size>0}}ci.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];ci.userMediaPromiseMap=new Map;const C9=1e3;class Vu extends Ne{get constraints(){return this._constraints}constructor(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,t,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Vy(()=>ge(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>ge(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(it.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Xo,this.pauseUpstreamLock=new Xo,this.processorLock=new Xo,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Ne.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}setMediaStreamTrack(e,t){return ge(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{wu(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");mu(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{mu(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C9;var t;return ge(this,void 0,void 0,function*(){if(this.kind===Ne.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((t=Ga())===null||t===void 0?void 0:t.os)==="iOS"&&(yield Ua(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield Ua(50)}throw new vs("unable to get track dimensions after timeout")})}getDeviceId(){return ge(this,void 0,void 0,function*(){if(this.source===Ne.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this._mediaStreamTrack.getSettings(),r=this.kind===Ne.Kind.Audio?"audioinput":"videoinput";return ci.getInstance().normalizeDeviceId(r,e,t)})}mute(){return ge(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return ge(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return ge(this,void 0,void 0,function*(){if(!this.sender)throw new vs("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=t,this.processor&&(yield this.stopProcessor()),this})}restart(e){return ge(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const t={audio:!1,video:!1};this.kind===Ne.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach(o=>{wu(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(t)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(it.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?it.Muted:it.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return ge(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),OT()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return ge(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(it.UpstreamPaused,this);const t=Ga();if((t==null?void 0:t.name)==="Safari"&&jy(t.version,"12.0")<0)throw new Uy("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return ge(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(it.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return ge(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return ge(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),mu(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(l=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:l})));const a={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(a),this.processor=e,this.processor.processedTrack){for(const l of this.attachedElements)l!==this.processorElement&&t&&(wu(this._mediaStreamTrack,l),mu(this.processor.processedTrack,l));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var e,t;return ge(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(t=this.processorElement)===null||t===void 0||t.remove(),this.processorElement=void 0,yield this.restart())})}}class y9 extends zs.EventEmitter{constructor(e){super(),this.onWorkerMessage=t=>{var r,i;const{kind:o,data:a}=t.data;switch(o){case"error":nn.error(a.error.message),this.emit(Sl.EncryptionError,a.error);break;case"initAck":a.enabled&&this.keyProvider.getKeys().forEach(l=>{this.postKey(l)});break;case"enable":if(this.encryptionEnabled!==a.enabled&&a.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Sl.ParticipantEncryptionStatusChanged,a.enabled,this.room.localParticipant),this.encryptionEnabled=a.enabled;else if(a.participantIdentity){const l=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(a.participantIdentity);if(!l)throw TypeError("couldn't set encryption status, participant not found".concat(a.participantIdentity));this.emit(Sl.ParticipantEncryptionStatusChanged,a.enabled,l)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(l=>{this.postKey(l)});break;case"ratchetKey":this.keyProvider.emit(Tl.KeyRatcheted,a.material,a.keyIndex);break}},this.onWorkerError=t=>{nn.error("e2ee worker encountered an error:",{error:t.error}),this.emit(Sl.EncryptionError,t.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!W6())throw new Uy("tried to setup end-to-end encryption on an unsupported browser");if(nn.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(nn.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){nn.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?nn.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(pt.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(Le.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Pr.NONE,i.identity)),e.on(Le.ConnectionStateChanged,r=>{r===pn.Connected&&e.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Pr.NONE,i.identity)})})}).on(Le.TrackUnsubscribed,(r,i,o)=>{var a;const l={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(a=this.worker)===null||a===void 0||a.postMessage(l)}).on(Le.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(Le.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),t.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(We.LocalTrackPublished,r=>ge(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),t.on(Tl.SetKey,r=>this.postKey(r)).on(Tl.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(r)}postKey(e){let{key:t,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const a={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(a)}postEnable(e,t){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?BT(r.mimeType):void 0)}}setupE2EESender(e,t){if(!(e instanceof Vu)||!t){t||nn.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,r,i){return ge(this,void 0,void 0,function*(){if(this.worker){if(EC()){const o={kind:"decode",participantIdentity:r,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(sp in e&&i){const u={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:r}};this.worker.postMessage(u);return}let o=e.writableStream,a=e.readableStream;if(!o||!a){const u=e.createEncodedStreams();e.writableStream=u.writable,o=u.writable,e.readableStream=u.readable,a=u.readable}const l={kind:"decode",data:{readableStream:a,writableStream:o,trackId:t,codec:i,participantIdentity:r}};this.worker.postMessage(l,[a,o])}e[sp]=!0}})}handleSender(e,t,r){var i;if(!(sp in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(EC()){nn.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{nn.info("initialize encoded streams");const o=e.createEncodedStreams(),a={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(a,[o.readable,o.writable])}e[sp]=!0}}}var cf;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(cf||(cf={}));class x9{constructor(){this.pendingTasks=new Map,this.taskMutex=new Xo,this.nextTaskIndex=0}run(e){return ge(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:cf.WAITING};this.pendingTasks.set(t.id,t);const r=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=cf.RUNNING,yield e()}finally{t.status=cf.COMPLETED,this.pendingTasks.delete(t.id),r()}})}flush(){return ge(this,void 0,void 0,function*(){return this.run(()=>ge(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const I9=["syncState","trickle","offer","answer","simulate","leave"];function b9(n){const e=I9.indexOf(n.case)>=0;return nn.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var Jn;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})(Jn||(Jn={}));class zy{get currentState(){return this.state}get isDisconnected(){return this.state===Jn.DISCONNECTING||this.state===Jn.DISCONNECTED}get isEstablishingConnection(){return this.state===Jn.CONNECTING||this.state===Jn.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Jn.DISCONNECTED,this.log=nn,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Va((r=t.loggerName)!==null&&r!==void 0?r:Ms.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new x9,this.queuedRequests=[],this.closingLock=new Xo,this.connectionLock=new Xo,this.state=Jn.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,r,i){return ge(this,void 0,void 0,function*(){return this.state=Jn.CONNECTING,this.options=r,yield this.connect(e,t,r,i)})}reconnect(e,t,r,i){return ge(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Jn.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,t,r,i){this.connectOptions=r,e=v9(e),e=e.replace(/\/$/,""),e+="/rtc";const o=p9(),a=A9(t,o,r);return new Promise((l,u)=>ge(this,void 0,void 0,function*(){const d=yield this.connectionLock.lock();try{const f=()=>ge(this,void 0,void 0,function*(){this.close(),clearTimeout(p),u(new Pn("room connection has been cancelled (signal)"))}),p=setTimeout(()=>{this.close(),u(new Pn("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&f(),i==null||i.addEventListener("abort",f),this.log.debug("connecting to ".concat(e+a),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+a),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(p)},this.ws.onerror=g=>ge(this,void 0,void 0,function*(){if(this.state!==Jn.CONNECTED){clearTimeout(p);try{const v=yield fetch("http".concat(e.substring(2),"/validate").concat(a));if(v.status.toFixed(0).startsWith("4")){const C=yield v.text();u(new Pn(C,0,v.status))}else u(new Pn("Internal error",2,v.status))}catch{u(new Pn("server was not reachable",1))}return}this.handleWSError(g)}),this.ws.onmessage=g=>ge(this,void 0,void 0,function*(){var v,C,y,x;let I;if(typeof g.data=="string"){const b=JSON.parse(g.data);I=Ss.fromJson(b)}else if(g.data instanceof ArrayBuffer)I=Ss.fromBinary(new Uint8Array(g.data));else{this.log.error("could not decode websocket message: ".concat(typeof g.data),this.logContext);return}if(this.state!==Jn.CONNECTED){let b=!1;if(((v=I.message)===null||v===void 0?void 0:v.case)==="join"?(this.state=Jn.CONNECTED,i==null||i.removeEventListener("abort",f),this.pingTimeoutDuration=I.message.value.pingTimeout,this.pingIntervalDuration=I.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),l(I.message.value)):this.state===Jn.RECONNECTING&&I.message.case!=="leave"?(this.state=Jn.CONNECTED,i==null||i.removeEventListener("abort",f),this.startPingInterval(),((C=I.message)===null||C===void 0?void 0:C.case)==="reconnect"?l((y=I.message)===null||y===void 0?void 0:y.value):(l(),b=!0)):this.isEstablishingConnection&&I.message.case==="leave"?u(new Pn("Received leave request while trying to (re)connect",4)):r.reconnect||u(new Pn("did not receive join response, got ".concat((x=I.message)===null||x===void 0?void 0:x.case," instead"))),!b)return}this.signalLatency&&(yield Ua(this.signalLatency)),this.handleSignalResponse(I)}),this.ws.onclose=g=>{this.isEstablishingConnection&&u(new Pn("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:g.reason,state:this.state})),this.handleOnClose(g.reason)}}finally{d()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return ge(this,void 0,void 0,function*(){const t=yield this.closingLock.lock();try{if(e&&(this.state=Jn.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,Ua(250)])),this.ws=void 0}}finally{e&&(this.state=Jn.DISCONNECTED),this.clearPingInterval(),t()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:N0(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:N0(e)})}sendIceCandidate(e,t){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new jo({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new zo({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return this.sendRequest({case:"updateMetadata",value:new Ts({metadata:e,name:t})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new Es({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new Ps({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Kt.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Bs({timestamp:Kt.parse(Date.now()),rtt:Kt.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new ho({canReconnect:!1,reason:La.CLIENT_INITIATED})})}sendRequest(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return ge(this,void 0,void 0,function*(){if(!t&&!b9(e)&&this.state===Jn.RECONNECTING){this.queuedRequests.push(()=>ge(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(t||(yield this.requestQueue.flush()),this.signalLatency&&(yield Ua(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new xa({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(e){var t,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const a=cw(i.value);this.onAnswer&&this.onAnswer(a)}else if(i.case==="offer"){const a=cw(i.value);this.onOffer&&this.onOffer(a)}else if(i.case==="trickle"){const a=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(a,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=i.value.participants)!==null&&t!==void 0?t:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return ge(this,void 0,void 0,function*(){if(this.state===Jn.DISCONNECTED)return;const t=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Dr.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Dr.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Dr.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Dr.clearInterval(this.pingInterval)}}function cw(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function N0(n){return new hi({sdp:n.sdp,type:n.type})}function A9(n,e,t){var r;const i=new URLSearchParams;return i.set("access_token",n),t.reconnect&&(i.set("reconnect","1"),t.sid&&i.set("sid",t.sid)),i.set("auto_subscribe",t.autoSubscribe?"1":"0"),i.set("sdk",kc()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),t.publishOnly!==void 0&&i.set("publish",t.publishOnly),t.adaptiveStream&&i.set("adaptive_stream","1"),t.reconnectReason&&i.set("reconnect_reason",t.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var UT={},VT={exports:{}},uw=VT.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(n){return n.encoding?"rtpmap:%d %s/%s/%s":n.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(n){return n.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(n){return n.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(n){return"extmap:%d"+(n.direction?"/%s":"%v")+(n["encrypt-uri"]?" %s":"%v")+" %s"+(n.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(n){return n.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(n){var e="candidate:%s %d %s %d %s %d typ %s";return e+=n.raddr!=null?" raddr %s rport %d":"%v%v",e+=n.tcptype!=null?" tcptype %s":"%v",n.generation!=null&&(e+=" generation %d"),e+=n["network-id"]!=null?" network-id %d":"%v",e+=n["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(n){var e="ssrc:%d";return n.attribute!=null&&(e+=" %s",n.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(n){return n.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(n){return n.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(n){return"imageattr:%s %s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(n){return"simulcast:%s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(n){return"ts-refclk:%s"+(n.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(n){var e="mediaclk:";return e+=n.id!=null?"id=%s %s":"%v%s",e+=n.mediaClockValue!=null?"=%s":"",e+=n.rateNumerator!=null?" rate=%s":"",e+=n.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(uw).forEach(function(n){var e=uw[n];e.forEach(function(t){t.reg||(t.reg=/(.*)/),t.format||(t.format="%s")})});var GT=VT.exports;(function(n){var e=function(l){return String(Number(l))===l?Number(l):l},t=function(l,u,d,f){if(f&&!d)u[f]=e(l[1]);else for(var p=0;p<d.length;p+=1)l[p+1]!=null&&(u[d[p]]=e(l[p+1]))},r=function(l,u,d){var f=l.name&&l.names;l.push&&!u[l.push]?u[l.push]=[]:f&&!u[l.name]&&(u[l.name]={});var p=l.push?{}:f?u[l.name]:u;t(d.match(l.reg),p,l.names,l.name),l.push&&u[l.push].push(p)},i=GT,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(l){var u={},d=[],f=u;return l.split(/(\r\n|\r|\n)/).filter(o).forEach(function(p){var g=p[0],v=p.slice(2);g==="m"&&(d.push({rtp:[],fmtp:[]}),f=d[d.length-1]);for(var C=0;C<(i[g]||[]).length;C+=1){var y=i[g][C];if(y.reg.test(v))return r(y,f,v)}}),u.media=d,u};var a=function(l,u){var d=u.split(/=(.+)/,2);return d.length===2?l[d[0]]=e(d[1]):d.length===1&&u.length>1&&(l[d[0]]=void 0),l};n.parseParams=function(l){return l.split(/;\s?/).reduce(a,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(l){return l.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(l){for(var u=[],d=l.split(" ").map(e),f=0;f<d.length;f+=3)u.push({component:d[f],ip:d[f+1],port:d[f+2]});return u},n.parseImageAttributes=function(l){return l.split(" ").map(function(u){return u.substring(1,u.length-1).split(",").reduce(a,{})})},n.parseSimulcastStreamList=function(l){return l.split(";").map(function(u){return u.split(",").map(function(d){var f,p=!1;return d[0]!=="~"?f=e(d):(f=e(d.substring(1,d.length)),p=!0),{scid:f,paused:p}})})}})(UT);var mv=GT,w9=/%[sdv%]/g,S9=function(n){var e=1,t=arguments,r=t.length;return n.replace(w9,function(i){if(e>=r)return i;var o=t[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},Yd=function(n,e,t){var r=e.format instanceof Function?e.format(e.push?t:t[e.name]):e.format,i=[n+"="+r];if(e.names)for(var o=0;o<e.names.length;o+=1){var a=e.names[o];e.name?i.push(t[e.name][a]):i.push(t[e.names[o]])}else i.push(t[e.name]);return S9.apply(null,i)},k9=["v","o","s","i","u","e","p","c","b","t","r","z","a"],E9=["i","c","b","a"],T9=function(n,e){e=e||{},n.version==null&&(n.version=0),n.name==null&&(n.name=" "),n.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var t=e.outerOrder||k9,r=e.innerOrder||E9,i=[];return t.forEach(function(o){mv[o].forEach(function(a){a.name in n&&n[a.name]!=null?i.push(Yd(o,a,n)):a.push in n&&n[a.push]!=null&&n[a.push].forEach(function(l){i.push(Yd(o,a,l))})})}),n.media.forEach(function(o){i.push(Yd("m",mv.m[0],o)),r.forEach(function(a){mv[a].forEach(function(l){l.name in o&&o[l.name]!=null?i.push(Yd(a,l,o)):l.push in o&&o[l.push]!=null&&o[l.push].forEach(function(u){i.push(Yd(a,l,u))})})})}),i.join(`\r
`)+`\r
`},R9=UT,_9=T9,vv=_9,rf=R9.parse;const dw=.7,Su={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class fw extends zs.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=nn,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Vy(o=>ge(this,void 0,void 0,function*(){this.emit(Su.NegotiationStarted);try{yield this.createAndSendOffer()}catch(a){if(o)o(a);else throw a}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Va((i=r.loggerName)!==null&&i!==void 0?i:Ms.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=t,this._pc=this.createPC()}createPC(){const e=u9()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var r;t.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,t.candidate))},e.onicecandidateerror=t=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,t)},e.ontrack=t=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return ge(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var t;return ge(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:o}=D9(e);this.remoteStereoMids=i,this.remoteNackMids=o}else if(e.type==="answer"){const i=rf((t=e.sdp)!==null&&t!==void 0?t:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(a=>{if(!a.transceiver||o.mid!=a.transceiver.mid)return!1;let l=0;if(o.rtp.some(d=>d.codec.toUpperCase()===a.codec.toUpperCase()?(l=d.payload,!0):!1),l===0)return!0;let u=!1;for(const d of o.fmtp)if(d.payload===l){d.config=d.config.split(";").filter(f=>!f.includes("maxaveragebitrate")).join(";"),a.maxbr>0&&(d.config+=";maxaveragebitrate=".concat(a.maxbr*1e3)),u=!0;break}return u||a.maxbr>0&&o.fmtp.push({payload:l,config:"maxaveragebitrate=".concat(a.maxbr*1e3)}),!0})}),r=vv(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Su.NegotiationComplete),e.sdp&&rf(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(Su.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){var t;return ge(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=rf((t=r.sdp)!==null&&t!==void 0?t:"");i.media.forEach(o=>{o.type==="audio"?hw(o,[],[]):o.type==="video"&&(P9(o),this.trackBitrates.some(a=>{if(!o.msid||!a.cid||!o.msid.includes(a.cid))return!1;let l=0;if(o.rtp.some(d=>d.codec.toUpperCase()===a.codec.toUpperCase()?(l=d.payload,!0):!1),l===0)return!0;let u=!1;for(const d of o.fmtp)if(d.payload===l){d.config.includes("x-google-start-bitrate")||(d.config+=";x-google-start-bitrate=".concat(Math.round(a.maxbr*dw))),d.config.includes("x-google-max-bitrate")||(d.config+=";x-google-max-bitrate=".concat(a.maxbr)),u=!0;break}return u||o.fmtp.push({payload:l,config:"x-google-start-bitrate=".concat(Math.round(a.maxbr*dw),";x-google-max-bitrate=").concat(a.maxbr)}),!0}))}),yield this.setMungedSDP(r,vv(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return ge(this,void 0,void 0,function*(){const t=yield this.pc.createAnswer(),r=rf((e=t.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&hw(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,vv(r)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new fr("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new fr("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return ge(this,void 0,void 0,function*(){if(!this._pc)return;let t="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(l=>{switch(l.type){case"transport":t=l.selectedCandidatePairId;break;case"candidate-pair":t===""&&l.selected&&(t=l.id),r.set(l.id,l);break;case"remote-candidate":i.set(l.id,"".concat(l.address,":").concat(l.port));break}}),t==="")return;const a=(e=r.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(a!==void 0)return i.get(a)})}setMungedSDP(e,t,r){return ge(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:t})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const a={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(a.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:a})),new TC(o)}})}}function hw(n,e,t){let r=0;n.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(n.mid)&&!n.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&n.rtcpFb.push({payload:r,type:"nack"}),e.includes(n.mid)&&n.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function P9(n){var e,t,r,i;const o=(t=(e=n.rtp[0])===null||e===void 0?void 0:e.codec)===null||t===void 0?void 0:t.toLowerCase();if(!lf(o))return;let a=0;((r=n.ext)===null||r===void 0?void 0:r.some(u=>u.uri===ew?!0:(u.value>a&&(a=u.value),!1)))||(i=n.ext)===null||i===void 0||i.push({value:a+1,uri:ew})}function D9(n){var e;const t=[],r=[],i=rf((e=n.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(a=>{var l;a.type==="audio"&&(a.rtp.some(u=>u.codec==="opus"?(o=u.payload,!0):!1),!((l=a.rtcpFb)===null||l===void 0)&&l.some(u=>u.payload===o&&u.type==="nack")&&r.push(a.mid),a.fmtp.some(u=>u.payload===o?(u.config.includes("sprop-stereo=1")&&t.push(a.mid),!0):!1))}),{stereoMids:t,nackMids:r}}const NC="vp8",N9={audioBitrate:P0.music.maxBitrate,audioPreset:P0.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Gy.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:NC,backupCodec:!0},WT={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},jT={resolution:wf.h720.resolution},B9={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new w6,disconnectOnPageLeave:!0,expWebAudioMix:!1},Hy={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var pr;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})(pr||(pr={}));class O9{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,r){var i;this.peerConnectionTimeout=Hy.peerConnectionTimeout,this.log=nn,this.updateState=()=>{var a;const l=this.state,u=this.requiredTransports.map(d=>d.getConnectionState());u.every(d=>d==="connected")?this.state=pr.CONNECTED:u.some(d=>d==="failed")?this.state=pr.FAILED:u.some(d=>d==="connecting")?this.state=pr.CONNECTING:u.every(d=>d==="closed")?this.state=pr.CLOSED:u.some(d=>d==="closed")?this.state=pr.CLOSING:u.every(d=>d==="new")&&(this.state=pr.NEW),l!==this.state&&(this.log.debug("pc state change: from ".concat(pr[l]," to ").concat(pr[this.state]),this.logContext),(a=this.onStateChange)===null||a===void 0||a.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Va((i=r.loggerName)!==null&&i!==void 0?i:Ms.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t;const o={optional:[{googDscp:!0}]};this.publisher=new fw(e,o,r),this.subscriber=new fw(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,a,Jr.PUBLISHER)},this.subscriber.onIceCandidate=a=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,a,Jr.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var l;(l=this.onDataChannel)===null||l===void 0||l.call(this,a)},this.subscriber.onTrack=a=>{var l;(l=this.onTrack)===null||l===void 0||l.call(this,a)},this.publisher.onOffer=a=>{var l;(l=this.onPublisherOffer)===null||l===void 0||l.call(this,a)},this.state=pr.NEW,this.connectionLock=new Xo}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return ge(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return ge(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return ge(this,void 0,void 0,function*(){t===Jr.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return ge(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){var r;return ge(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,t)))}finally{i()}})}negotiate(e){return ge(this,void 0,void 0,function*(){return new Promise((t,r)=>ge(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(Su.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Su.NegotiationComplete,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(a=>{clearTimeout(i),r(a)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Jr.PUBLISHER?this.publisher.getConnectedAddress():e===Jr.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return ge(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((o,a)=>ge(this,void 0,void 0,function*(){const l=()=>{this.log.warn("abort transport connection",this.logContext),Dr.clearTimeout(u),a(new Pn("room connection has been cancelled",3))};t!=null&&t.signal.aborted&&l(),t==null||t.signal.addEventListener("abort",l);const u=Dr.setTimeout(()=>{t==null||t.signal.removeEventListener("abort",l),a(new Pn("could not establish pc connection"))},r);for(;this.state!==pr.CONNECTED;)if(yield Ua(50),t!=null&&t.signal.aborted){a(new Pn("room connection has been cancelled",3));return}Dr.clearTimeout(u),t==null||t.signal.removeEventListener("abort",l),o()}))})}}const pw="_lossy",gw="_reliable",F9=2*1e3,mw="leave-reconnect";var To;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(To||(To={}));class M9 extends zs.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Hy.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=To.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=nn,this.handleDataChannel=r=>{let{channel:i}=r;return ge(this,void 0,void 0,function*(){if(i){if(i.label===gw)this.reliableDCSub=i;else if(i.label===pw)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>ge(this,void 0,void 0,function*(){var i,o;const a=yield this.dataProcessLock.lock();try{let l;if(r.data instanceof ArrayBuffer)l=r.data;else if(r.data instanceof Blob)l=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const u=Cs.fromBinary(new Uint8Array(l));((i=u.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(pt.ActiveSpeakersUpdate,u.value.value.speakers):((o=u.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(pt.DataPacketReceived,u.value.value,u.kind)}finally{a()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:a}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:a}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?hr.LOSSY:hr.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=u=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(u,"ms. giving up"),this.logContext),this.emit(pt.Disconnected),this.close()},a=Date.now()-this.reconnectStart;let l=this.getNextRetryDelay({elapsedMs:a,retryCount:this.reconnectAttempts});if(l===null){o(a);return}r===mw&&(l=0),this.log.debug("reconnecting in ".concat(l,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Dr.setTimeout(()=>this.attemptReconnect(i),l)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===To.Connected&&r();const o=()=>{this.off(pt.Disconnected,a),r()},a=()=>{this.off(pt.Restarted,o),i()};this.once(pt.Restarted,o),this.once(pt.Disconnected,a)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(pt.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Jn.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(aa.RR_SIGNAL_DISCONNECTED))},this.log=Va((t=e.loggerName)!==null&&t!==void 0?t:Ms.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new zy(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Xo,this.dataProcessLock=new Xo,this.dcBufferStatus=new Map([[hr.LOSSY,!0],[hr.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(pt.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(pt.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(pt.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(pt.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(pt.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(pt.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(pt.StreamStateChanged,r)}get logContext(){var e,t,r,i,o,a;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(a=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||a===void 0?void 0:a.identity}}join(e,t,r,i){return ge(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,t,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof Pn&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,r,i);throw o}})}close(){return ge(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(pt.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return ge(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return ge(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new vs("a track with the same ID has already been published");return new Promise((t,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Pn("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),t(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return ge(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var t;return ge(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==pr.NEW)return;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new O9(r,e.subscriberPrimary,this.loggerOptions),this.emit(pt.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,a)=>ge(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===pr.CONNECTED){const l=this.pcState===To.New;this.pcState=To.Connected,l&&this.emit(pt.Connected,e)}else i===pr.FAILED&&this.pcState===To.Connected&&(this.pcState=To.Disconnected,this.handleDisconnect("peerconnection failed",a==="failed"?aa.RR_SUBSCRIBER_FAILED:aa.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(pt.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>ge(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=e=>ge(this,void 0,void 0,function*(){if(!this.pcManager)return;const t=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(pt.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(pt.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(pt.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",aa.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(mw)):(this.emit(pt.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var t;const r=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const a={urls:o.urls};o.username&&(a.username=o.username),o.credential&&(a.credential=o.credential),i.push(a)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Jo.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(pw,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(gw,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,t,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(t);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],a=[],l=[];i.codecs.forEach(u=>{const d=u.mimeType.toLowerCase();if(d==="audio/opus"){o.push(u);return}if(!(d==="video/".concat(r))){l.push(u);return}if(r==="h264"){u.sdpFmtpLine&&u.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(u):a.push(u);return}o.push(u)}),c9(e)&&e.setCodecPreferences(o.concat(a,l))}createSender(e,t,r){return ge(this,void 0,void 0,function*(){if(tw())return yield this.createTransceiverRTCRtpSender(e,t,r);if(nw())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new fr("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,r,i){return ge(this,void 0,void 0,function*(){if(tw())return this.createSimulcastTransceiverSender(e,t,r,i);if(nw())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new fr("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,r){return ge(this,void 0,void 0,function*(){if(!this.pcManager)throw new fr("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const a=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o);return e.kind===Ne.Kind.Video&&t.videoCodec&&(this.setPreferredCodec(a,e.kind,t.videoCodec),e.codec=t.videoCodec),a.sender})}createSimulcastTransceiverSender(e,t,r,i){return ge(this,void 0,void 0,function*(){if(!this.pcManager)throw new fr("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const a=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(a,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,a.sender),a.sender})}createRTCRtpSender(e){return ge(this,void 0,void 0,function*(){if(!this.pcManager)throw new fr("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var t,r,i;return ge(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){nn.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===Jo.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:pr.NEW)===pr.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let a=!0;o instanceof fr?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),a=!1):o instanceof hu||(this.fullReconnectOnNext=!0),a?this.handleDisconnect("reconnect",aa.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(pt.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){var t,r,i;return ge(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new fr("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(pt.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new hu;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(a){throw a instanceof Pn&&a.reason===0?new fr("could not reconnect, token might be expired"):new hu}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(pt.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==Jn.CONNECTED)throw new hu("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(pt.Restarted)}catch(o){const a=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(a){yield this.restartConnection(a);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){var t;return ge(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new fr("could not reconnect, url or token not saved");if(!this.pcManager)throw new fr("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(pt.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof Pn&&r.reason===0?new fr("could not reconnect, token might be expired"):r instanceof Pn&&r.reason===4?r:new hu(i)}if(this.emit(pt.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Jn.CONNECTED)throw new hu("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(pt.Resumed)})}waitForPCInitialConnection(e,t){return ge(this,void 0,void 0,function*(){if(!this.pcManager)throw new fr("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return ge(this,void 0,void 0,function*(){this.pcState=To.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Ua(F9),!this.pcManager)throw new fr("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=To.Connected}catch(e){throw this.pcState=To.Disconnected,new Pn("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,t){return ge(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(t);const i=this.dataChannelForKind(t);i&&i.send(r),this.updateAndEmitDCBufferStatus(t)})}ensureDataTransportConnected(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return ge(this,void 0,void 0,function*(){if(!this.pcManager)throw new fr("PC manager is closed");const i=t?this.pcManager.subscriber:this.pcManager.publisher,o=t?"Subscriber":"Publisher";if(!i)throw new Pn("".concat(o," connection not set"));!t&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const a=this.dataChannelForKind(e,t);if((a==null?void 0:a.readyState)==="open")return;const l=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<l;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,t))===null||r===void 0?void 0:r.readyState)==="open")return;yield Ua(50)}throw new Pn("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return ge(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==pr.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return ge(this,void 0,void 0,function*(){return new Promise((e,t)=>ge(this,void 0,void 0,function*(){if(!this.pcManager){t(new TC("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(pt.Closing,i),this.pcManager.publisher.once(Su.RTPVideoPayloadTypes,o=>{const a=new Map;o.forEach(l=>{const u=l.codec.toLowerCase();m9(u)&&a.set(l.payload,u)}),this.emit(pt.RTPVideoMapUpdate,a)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof TC&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",aa.RR_UNKNOWN),t(o)}finally{this.off(pt.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===hr.LOSSY)return this.lossyDCSub;if(e===hr.RELIABLE)return this.reliableDCSub}else{if(e===hr.LOSSY)return this.lossyDC;if(e===hr.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),a=this.pcManager.subscriber.getRemoteDescription(),l=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,u=new Array;e.forEach(d=>{d.isDesired!==l&&u.push(d.trackSid)}),this.client.sendSyncState(new Ds({answer:o?N0({sdp:o.sdp,type:o.type}):void 0,offer:a?N0({sdp:a.sdp,type:a.type}):void 0,subscription:new fo({trackSids:u,subscribe:!l,participantTracks:[]}),publishTracks:r9(t),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new Ns({label:r.label,id:r.id,target:i}))};return t(this.dataChannelForKind(hr.LOSSY),Jr.PUBLISHER),t(this.dataChannelForKind(hr.RELIABLE),Jr.PUBLISHER),t(this.dataChannelForKind(hr.LOSSY,!0),Jr.SUBSCRIBER),t(this.dataChannelForKind(hr.RELIABLE,!0),Jr.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Dr.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Mi()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Mi()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class hu extends Error{}class vw{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return DC(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return ge(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(t.length>0){const r=t[0];return this.attemptedRegions.push(r),nn.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return ge(this,void 0,void 0,function*(){const t=yield fetch("".concat(L9(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(t.ok){const r=yield t.json();return this.lastUpdateAt=Date.now(),r}else throw new Pn("Could not fetch region settings: ".concat(t.statusText),t.status===401?0:void 0,t.status)})}}function L9(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}const Zy=2e3;function tg(n,e){if(!e)return 0;let t,r;return"bytesReceived"in n?(t=n.bytesReceived,r=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,r=e.bytesSent),t===void 0||r===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-r)*8*1e3/(n.timestamp-e.timestamp)}class Ni extends Vu{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,Ne.Kind.Audio,t,r,o),this.stopOnMute=!1,this.monitorSender=()=>ge(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(l){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:l}));return}a&&this.prevStats&&(this._currentBitrate=tg(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return ge(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||mc(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return ge(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===Ne.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return ge(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==mc(this._constraints.deviceId);return this.source===Ne.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return ge(this,void 0,void 0,function*(){let t;if(e){const r=eg({audio:e});typeof r.audio!="boolean"&&(t=r.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return ge(this,void 0,void 0,function*(){const r=yield t.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){Mi()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Zy)))}setProcessor(e){var t;return ge(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return ge(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let r;return t.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return ge(this,void 0,void 0,function*(){const e=yield e9(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(it.AudioSilenceDetected)),e})}}function zT(n,e,t){switch(n.kind){case"audio":return new Ni(n,e,!1,void 0,t);case"video":return new co(n,e,!1,t);default:throw new vs("unsupported track type: ".concat(n.kind))}}const U9=Object.values(wf),V9=Object.values(RC),G9=Object.values(Gy),W9=[wf.h180,wf.h360],j9=[RC.h180,RC.h360],z9=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(t=>{var r,i;return new wn(Math.floor(n.width/t.scaleResolutionDownBy),Math.floor(n.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*(((r=n.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=t.fps)!==null&&i!==void 0?i:30))))),t.fps,n.encoding.priority)}),BC=["q","h","f"];function OC(n,e,t,r){var i,o;let a=r==null?void 0:r.videoEncoding;n&&(a=r==null?void 0:r.screenShareEncoding);const l=r==null?void 0:r.simulcast,u=r==null?void 0:r.scalabilityMode,d=r==null?void 0:r.videoCodec;if(!a&&!l&&!u||!e||!t)return[{}];a||(a=Z9(n,e,t,d),nn.debug("using video encoding",a));const f=new wn(e,t,a.maxBitrate,a.maxFramerate,a.priority);if(u&&lf(d)){nn.debug("using svc with scalabilityMode ".concat(u));const v=new HT(u),C=[];if(v.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(u));for(let y=0;y<v.spatial;y+=1)C.push({rid:BC[2-y],maxBitrate:a.maxBitrate/Math.pow(3,y),maxFramerate:f.encoding.maxFramerate});return C[0].scalabilityMode=u,nn.debug("encodings",C),C}if(!l)return[a];let p=[];n?p=(i=yw(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:Cw(n,f):p=(o=yw(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:Cw(n,f);let g;if(p.length>0){const v=p[0];p.length>1&&([,g]=p);const C=Math.max(e,t);if(C>=960&&g)return Cv(e,t,[v,g,f]);if(C>=480)return Cv(e,t,[v,f])}return Cv(e,t,[f])}function H9(n,e,t){var r,i,o,a;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&nn.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const l=n.mediaStreamTrack.getSettings(),u=(r=l.width)!==null&&r!==void 0?r:(i=n.dimensions)===null||i===void 0?void 0:i.width,d=(o=l.height)!==null&&o!==void 0?o:(a=n.dimensions)===null||a===void 0?void 0:a.height;return OC(n.source===Ne.Source.ScreenShare,u,d,t)}function Z9(n,e,t,r){const i=X9(n,e,t);let{encoding:o}=i[0];const a=Math.max(e,t);for(let l=0;l<i.length;l+=1){const u=i[l];if(o=u.encoding,u.width>=a)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function X9(n,e,t){if(n)return G9;const r=e>t?e/t:t/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?U9:V9}function Cw(n,e){if(n)return z9(e);const{width:t,height:r}=e,i=t>r?t/r:r/t;return Math.abs(i-16/9)<Math.abs(i-4/3)?W9:j9}function Cv(n,e,t){const r=[];if(t.forEach((i,o)=>{if(o>=BC.length)return;const a=Math.min(n,e),u={rid:BC[o],scaleResolutionDownBy:Math.max(1,a/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(u.maxFramerate=i.encoding.maxFramerate);const d=Uu()||o===0;i.encoding.priority&&d&&(u.priority=i.encoding.priority,u.networkPriority=i.encoding.priority),r.push(u)}),kc()&&MT()==="ios"){let i;r.forEach(a=>{i?a.maxFramerate&&a.maxFramerate>i&&(i=a.maxFramerate):i=a.maxFramerate});let o=!0;r.forEach(a=>{var l;a.maxFramerate!=i&&(o&&(o=!1,nn.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),nn.info('Setting framerate of encoding "'.concat((l=a.rid)!==null&&l!==void 0?l:"",'" to ').concat(i)),a.maxFramerate=i)})}return r}function yw(n){if(n)return n.sort((e,t)=>{const{encoding:r}=e,{encoding:i}=t;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class HT{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const K9=5e3;class co extends Vu{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Ne.Kind.Video,t,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>ge(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(l){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:l}));return}const a=new Map(o.map(l=>[l.rid,l]));if(this.prevStats){let l=0;a.forEach((u,d)=>{var f;const p=(f=this.prevStats)===null||f===void 0?void 0:f.get(d);l+=tg(u,p)}),this._currentBitrate=l}this.prevStats=a}),this.senderLock=new Xo}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!Mi())return;const r=(t=this.sender)===null||t===void 0?void 0:t.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Zy))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var t,r,i,o,a;return ge(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var l=!0,u=pu(this.simulcastCodecs.values()),d;d=yield u.next(),t=d.done,!t;l=!0)o=d.value,l=!1,yield(a=o.sender)===null||a===void 0?void 0:a.replaceTrack(null)}catch(f){r={error:f}}finally{try{!l&&!t&&(i=u.return)&&(yield i.call(u))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var t,r,i,o,a;return ge(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var l=!0,u=pu(this.simulcastCodecs.values()),d;d=yield u.next(),t=d.done,!t;l=!0){o=d.value,l=!1;const f=o;yield(a=f.sender)===null||a===void 0?void 0:a.replaceTrack(f.mediaStreamTrack)}}catch(f){r={error:f}}finally{try{!l&&!t&&(i=u.return)&&(yield i.call(u))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return ge(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===Ne.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return ge(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===Ne.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return ge(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const a={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},l=r.get(i.remoteId);l&&(a.jitter=l.jitter,a.packetsLost=l.packetsLost,a.roundTripTime=l.roundTripTime),t.push(a)}}),t})}setPublishingQuality(e){const t=[];for(let r=gr.LOW;r<=gr.HIGH;r+=1)t.push(new Zo({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(t)}setDeviceId(e){return ge(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===mc(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||mc(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var t,r,i,o;return ge(this,void 0,void 0,function*(){let a;if(e){const f=eg({video:e});typeof f.video!="boolean"&&(a=f.video)}yield this.restart(a);try{for(var l=!0,u=pu(this.simulcastCodecs.values()),d;d=yield u.next(),t=d.done,!t;l=!0){o=d.value,l=!1;const f=o;f.sender&&(f.mediaStreamTrack=this.mediaStreamTrack.clone(),yield f.sender.replaceTrack(f.mediaStreamTrack))}}catch(f){r={error:f}}finally{try{!l&&!t&&(i=u.return)&&(yield i.call(u))}finally{if(r)throw r.error}}})}setProcessor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,a,l,u,d;return ge(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,t),!((u=this.processor)===null||u===void 0)&&u.processedTrack)try{for(var f=!0,p=pu(this.simulcastCodecs.values()),g;g=yield p.next(),i=g.done,!i;f=!0)l=g.value,f=!1,yield(d=l.sender)===null||d===void 0?void 0:d.replaceTrack(this.processor.processedTrack)}catch(v){o={error:v}}finally{try{!f&&!i&&(a=p.return)&&(yield a.call(p))}finally{if(o)throw o.error}}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,t){const r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},K9))}setPublishingCodecs(e){var t,r,i,o,a,l,u;return ge(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const d=[];try{for(t=!0,r=pu(e);i=yield r.next(),o=i.done,!o;t=!0){u=i.value,t=!1;const f=u;if(!this.codec||this.codec===f.codec)yield this.setPublishingLayers(f.qualities);else{const p=this.simulcastCodecs.get(f.codec);if(this.log.debug("try setPublishingCodec for ".concat(f.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:p})),!p||!p.sender){for(const g of f.qualities)if(g.enabled){d.push(f.codec);break}}else p.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(f.codec),this.logContext),yield xw(p.sender,p.encodings,f.qualities,this.senderLock,this.log,this.logContext))}}}catch(f){a={error:f}}finally{try{!t&&!o&&(l=r.return)&&(yield l.call(r))}finally{if(a)throw a.error}}return d})}setPublishingLayers(e){return ge(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield xw(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return ge(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),OT()&&this.isInBackground&&this.source===Ne.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function xw(n,e,t,r,i,o){return ge(this,void 0,void 0,function*(){const a=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:n,qualities:t,senderEncodings:e}));try{const l=n.getParameters(),{encodings:u}=l;if(!u)return;if(u.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let d=!1;!1&&u[0].scalabilityMode||u.forEach((p,g)=>{var v;let C=(v=p.rid)!==null&&v!==void 0?v:"";C===""&&(C="q");const y=ZT(C),x=t.find(I=>I.quality===y);x&&p.active!==x.enabled&&(d=!0,p.active=x.enabled,i.debug("setting layer ".concat(x.quality," to ").concat(p.active?"enabled":"disabled"),o),Uu()&&(x.enabled?(p.scaleResolutionDownBy=e[g].scaleResolutionDownBy,p.maxBitrate=e[g].maxBitrate,p.maxFrameRate=e[g].maxFrameRate):(p.scaleResolutionDownBy=4,p.maxBitrate=10,p.maxFrameRate=2)))}),d&&(l.encodings=u,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:l.encodings})),yield n.setParameters(l))}finally{a()}})}function ZT(n){switch(n){case"f":return gr.HIGH;case"h":return gr.MEDIUM;case"q":return gr.LOW;default:return gr.HIGH}}function Iw(n,e,t,r){if(!t)return[new fi({quality:gr.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(r){const i=t[0].scalabilityMode,o=new HT(i),a=[];for(let l=0;l<o.spatial;l+=1)a.push(new fi({quality:gr.HIGH-l,width:Math.ceil(n/Math.pow(2,l)),height:Math.ceil(e/Math.pow(2,l)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(3,l)):0,ssrc:0}));return a}return t.map(i=>{var o,a,l;const u=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let d=ZT((a=i.rid)!==null&&a!==void 0?a:"");return new fi({quality:d,width:Math.ceil(n/u),height:Math.ceil(e/u),bitrate:(l=i.maxBitrate)!==null&&l!==void 0?l:0,ssrc:0})})}class XT extends Ne{constructor(e,t,r,i,o){super(e,r,o),this.sid=t,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?it.Muted:it.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver=void 0,this._currentBitrate=0,this.emit(it.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return ge(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Zy))}}class vc extends XT{constructor(e,t,r,i,o,a){super(e,t,Ne.Kind.Audio,r,a),this.monitorReceiver=()=>ge(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const l=yield this.getReceiverStats();l&&this.prevStats&&this.receiver&&(this._currentBitrate=tg(l,this.prevStats)),this.prevStats=l}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var t;for(const r of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):r.volume=e;kc()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(kc())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return ge(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(PC(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&PC(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(it.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(it.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return ge(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(r=>{r.type==="inbound-rtp"&&(t={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),t})}}const yv=100;class uf extends XT{constructor(e,t,r,i,o){super(e,t,Ne.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>ge(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=tg(a,this.prevStats)),this.prevStats=a}),this.debouncedHandleResize=Vy(()=>{this.updateDimensions()},yv),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?wu(this._mediaStreamTrack,t):mu(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new $9(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(r=>r===e);for(const r of t)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const r of t)this.stopObservingElement(r);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return ge(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,t={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),t&&r!==""&&i.get(r)&&(t.mimeType=i.get(r).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(r=>r.element===e);for(const r of t)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return ge(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,t;const r=this.elementInfos.reduce((l,u)=>Math.max(l,u.visibilityChangedAt||0),0),i=!((t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&t!==void 0)||t?this.isInBackground:!1,o=this.elementInfos.some(l=>l.pictureInPicture),a=this.elementInfos.some(l=>l.visible)&&!i||o;if(this.lastVisible!==a){if(!a&&Date.now()-r<yv){Dr.setTimeout(()=>{this.updateVisibility()},yv);return}this.lastVisible=a,this.emit(it.VisibilityChanged,a,this)}}updateDimensions(){var e,t;let r=0,i=0;const o=this.getPixelDensity();for(const a of this.elementInfos){const l=a.width()*o,u=a.height()*o;l+u>r+i&&(r=l,i=u)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===i||(this.lastDimensions={width:r,height:i},this.emit(it.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?rw():t||(rw()>2?2:1)}}class $9{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:a}=r;o===this.element&&(this.isIntersecting=a,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=t??bw(e),this.isPiP=Mi()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=bw(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,ow().observe(this.element),iw().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,t;(e=ow())===null||e===void 0||e.unobserve(this.element),(t=iw())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function bw(n){let e=n.offsetTop,t=n.offsetLeft;const r=n.offsetWidth,i=n.offsetHeight,{hidden:o}=n,{opacity:a,display:l}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,e+=n.offsetTop,t+=n.offsetLeft;return e<window.pageYOffset+window.innerHeight&&t<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&t+r>window.pageXOffset&&!o&&(a!==""?parseFloat(a)>0:!0)&&l!=="none"}class la extends zs.EventEmitter{constructor(e,t,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Pr.NONE,this.log=nn,this.handleMuted=()=>{this.emit(it.Muted)},this.handleUnmuted=()=>{this.emit(it.Unmuted)},this.log=Va((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:Ms.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=r,this.source=Ne.Source.Unknown}setTrack(e){this.track&&(this.track.off(it.Muted,this.handleMuted),this.track.off(it.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(it.Muted,this.handleMuted),e.on(it.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Mn(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Pr.NONE}get audioTrack(){if(this.track instanceof Ni||this.track instanceof vc)return this.track}get videoTrack(){if(this.track instanceof co||this.track instanceof uf)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Ne.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Ne.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(la||(la={}));class Sf extends la{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(it.Ended)},this.updateInfo(t),this.setTrack(r)}setTrack(e){this.track&&this.track.off(it.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(it.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return ge(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return ge(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return ge(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return ge(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var uo;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(uo||(uo={}));function J9(n){switch(n){case ha.EXCELLENT:return uo.Excellent;case ha.GOOD:return uo.Good;case ha.POOR:return uo.Poor;case ha.LOST:return uo.Lost;default:return uo.Unknown}}class KT extends zs.EventEmitter{get logContext(){var e,t;return Object.assign(Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,t;return(t=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&t!==void 0?t:!1}constructor(e,t,r,i,o){var a;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=uo.Unknown,this.log=nn,this.log=Va((a=o==null?void 0:o.loggerName)!==null&&a!==void 0?a:Ms.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,t]of this.tracks)if(t.source===e)return t}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(Ne.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(Ne.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Ne.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const t=this.metadata!==e,r=this.metadata;this.metadata=e,t&&this.emit(We.ParticipantMetadataChanged,r)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(We.ParticipantNameChanged,e)}setPermissions(e){var t,r,i,o,a;const l=this.permissions,u=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((a=this.permissions)===null||a===void 0?void 0:a.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((d,f)=>{var p;return d!==((p=this.permissions)===null||p===void 0?void 0:p.canPublishSources[f])});return this.permissions=e,u&&this.emit(We.ParticipantPermissionsChanged,l),u}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(We.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=J9(e),t!==this._connectionQuality&&this.emit(We.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(t=>(t.track instanceof vc||t.track instanceof Ni)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(it.Muted,()=>{this.emit(We.TrackMuted,e)}),e.on(it.Unmuted,()=>{this.emit(We.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Ne.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Ne.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function Y9(n){var e,t,r;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new _s({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(r=n.allowAll)!==null&&r!==void 0?r:!1,trackSids:n.allowedTrackSids||[]})}class Xy extends la{constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=gr.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(it.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new fo({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Is({participantSid:"",trackSids:[this.trackSid]})]});this.emit(it.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?la.SubscriptionStatus.Unsubscribed:super.isSubscribed?la.SubscriptionStatus.Subscribed:la.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?la.PermissionStatus.Allowed:la.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,r;this.isManualOperationAllowed()&&(((t=this.videoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof uf&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof uf&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const t=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(it.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(it.VisibilityChanged,this.handleVisibilityChange),i.off(it.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(it.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(it.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(it.VisibilityChanged,this.handleVisibilityChange),e.on(it.Ended,this.handleEnded),this.emit(it.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(it.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?it.Muted:it.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(it.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(it.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Ne.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof uf&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new ks({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=gr.HIGH,this.emit(it.UpdateSettings,e)}}class kf extends KT{static fromParticipantInfo(e,t){return new kf(e,t.sid,t.identity,t.name,t.metadata)}constructor(e,t,r,i,o,a){super(t,r||"",i,o,a),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(it.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Mn(e))),this.signalClient.sendUpdateTrackSettings(t)}),e.on(it.UpdateSubscription,t=>{t.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(it.SubscriptionPermissionChanged,t=>{this.emit(We.TrackSubscriptionPermissionChanged,e,t)}),e.on(it.SubscriptionStatusChanged,t=>{this.emit(We.TrackSubscriptionStatusChanged,e,t)}),e.on(it.Subscribed,t=>{this.emit(We.TrackSubscribed,t,e)}),e.on(it.Unsubscribed,t=>{this.emit(We.TrackUnsubscribed,t,e)}),e.on(it.SubscriptionFailed,t=>{this.emit(We.TrackSubscriptionFailed,e.trackSid,t)})}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ne.Source.Microphone;this.volumeMap.set(t,e);const r=this.getTrack(t);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ne.Source.Microphone;const t=this.getTrack(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,r,i,o,a){let l=this.getTrackPublication(t);if(l||t.startsWith("TR")||this.tracks.forEach(f=>{!l&&e.kind===f.kind.toString()&&(l=f)}),!l){if(a===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit(We.TrackSubscriptionFailed,t);return}a===void 0&&(a=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,r,i,o,a-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Mn(l))),this.emit(We.TrackSubscriptionFailed,t);return}const u=e.kind==="video";let d;return u?d=new uf(e,t,i,o):d=new vc(e,t,i,this.audioContext,this.audioOutput),d.source=l.source,d.isMuted=l.isMuted,d.setMediaStream(r),d.start(),l.setTrack(d),this.volumeMap.has(l.source)&&d instanceof vc&&d.setVolume(this.volumeMap.get(l.source)),l}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,r=new Map;return e.tracks.forEach(i=>{var o,a;let l=this.getTrackPublication(i.sid);if(l)l.updateInfo(i);else{const u=Ne.kindFromProto(i.type);if(!u)return;l=new Xy(u,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(a=this.loggerOptions)===null||a===void 0?void 0:a.loggerName}),l.updateInfo(i),r.set(i.sid,l);const d=Array.from(this.tracks.values()).find(f=>f.source===(l==null?void 0:l.source));d&&l.source!==Ne.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(l.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Mn(d),newTrack:Mn(l)})),this.addTrackPublication(l)}t.set(i.sid,l)}),this.tracks.forEach(i=>{t.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Mn(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(We.TrackPublished,i)}),!0}unpublishTrack(e,t){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case Ne.Kind.Audio:this.audioTracks.delete(e);break;case Ne.Kind.Video:this.videoTracks.delete(e);break}t&&this.emit(We.TrackUnpublished,r)}setAudioOutput(e){return ge(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTracks.forEach(r=>{var i;r.track instanceof vc&&t.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class FC extends KT{constructor(e,t,r,i){super(e,t,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Pr.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new LT)},this.handleReconnected=()=>{var o,a;(a=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||a===void 0||a.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,a;this.reconnectFuture&&(this.reconnectFuture.promise.catch(l=>this.log.warn(l.message,this.logContext)),(a=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||a===void 0||a.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>Y9(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,a)=>{if(a===void 0&&(a=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Mn(o)));return}this.engine.updateMuteStatus(o.sid,a)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Mn(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Mn(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>ge(this,void 0,void 0,function*(){var a,l,u,d,f,p;if(!(!((f=this.roomOptions)===null||f===void 0)&&f.dynacast))return;const g=this.videoTracks.get(o.trackSid);if(!g){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!g.videoTrack)return;const x=yield g.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var v=!0,C=pu(x),y;y=yield C.next(),a=y.done,!a;v=!0){d=y.value,v=!1;const I=d;Y6(I)&&(this.log.debug("publish ".concat(I," for ").concat(g.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Mn(g))),yield this.publishAdditionalCodecForTrack(g.videoTrack,I,g.options))}}catch(I){l={error:I}}finally{try{!v&&!a&&(u=C.return)&&(yield u.call(C))}finally{if(l)throw l.error}}}else o.subscribedQualities.length>0&&(yield(p=g.videoTrack)===null||p===void 0?void 0:p.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const a=this.tracks.get(o.trackSid);if(!a){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(a.track)},this.handleTrackEnded=o=>ge(this,void 0,void 0,function*(){if(o.source===Ne.Source.ScreenShare||o.source===Ne.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Mn(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof Ni||o instanceof co)try{if(Mi())try{const a=yield navigator==null?void 0:navigator.permissions.query({name:o.source===Ne.Source.Camera?"camera":"microphone"});if(a&&a.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),Mn(o))),a.onchange=()=>{a.state!=="denied"&&(o.isMuted||o.restartTrack(),a.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Mn(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Mn(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Pr.NONE}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.on(pt.RemoteMute,(t,r)=>{const i=this.tracks.get(t);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(pt.Connected,this.handleReconnected).on(pt.SignalRestarted,this.handleReconnected).on(pt.SignalResumed,this.handleReconnected).on(pt.Restarting,this.handleReconnecting).on(pt.Resuming,this.handleReconnecting).on(pt.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(pt.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(pt.Disconnected,this.handleDisconnected)}setMetadata(e){var t;this.engine.client.sendUpdateLocalMetadata(e,(t=this.name)!==null&&t!==void 0?t:"")}setName(e){var t;this.engine.client.sendUpdateLocalMetadata((t=this.metadata)!==null&&t!==void 0?t:"",e)}setCameraEnabled(e,t,r){return this.setTrackEnabled(Ne.Source.Camera,e,t,r)}setMicrophoneEnabled(e,t,r){return this.setTrackEnabled(Ne.Source.Microphone,e,t,r)}setScreenShareEnabled(e,t,r){return this.setTrackEnabled(Ne.Source.ScreenShare,e,t,r)}setPermissions(e){const t=this.permissions,r=super.setPermissions(e);return r&&t&&this.emit(We.ParticipantPermissionsChanged,t),r}setE2EEEnabled(e){return ge(this,void 0,void 0,function*(){this.encryptionType=e?Pr.GCM:Pr.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,r,i){var o,a;return ge(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t}));let l=this.getTrack(e);if(t)if(l)yield l.unmute();else{let u;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case Ne.Source.Camera:u=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case Ne.Source.Microphone:u=yield this.createTracks({audio:(a=r)!==null&&a!==void 0?a:!0});break;case Ne.Source.ScreenShare:u=yield this.createScreenTracks(Object.assign({},r));break;default:throw new vs(e)}const d=[];for(const p of u)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Mn(p))),d.push(this.publishTrack(p,i));[l]=yield Promise.all(d)}catch(d){throw u==null||u.forEach(f=>{f.stop()}),d instanceof Error&&!(d instanceof vs)&&this.emit(We.MediaDevicesError,d),d}finally{this.pendingPublishing.delete(e)}}else if(l&&l.track)if(e===Ne.Source.ScreenShare){l=yield this.unpublishTrack(l.track);const u=this.getTrack(Ne.Source.ScreenShareAudio);u&&u.track&&this.unpublishTrack(u.track)}else yield l.mute();return l})}enableCameraAndMicrophone(){return ge(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Ne.Source.Camera)||this.pendingPublishing.has(Ne.Source.Microphone))){this.pendingPublishing.add(Ne.Source.Camera),this.pendingPublishing.add(Ne.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(Ne.Source.Camera),this.pendingPublishing.delete(Ne.Source.Microphone)}}})}createTracks(e){var t,r;return ge(this,void 0,void 0,function*(){const i=NT(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=eg(i);let a;try{a=yield navigator.mediaDevices.getUserMedia(o)}catch(l){throw l instanceof Error&&(o.audio&&(this.microphoneError=l),o.video&&(this.cameraError=l)),l}return o.audio&&(this.microphoneError=void 0,this.emit(We.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),a.getTracks().map(l=>{const u=l.kind==="audio";u?e.audio:e.video;let d;const f=u?o.audio:o.video;typeof f!="boolean"&&(d=f);const p=zT(l,d,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return p.kind===Ne.Kind.Video?p.source=Ne.Source.Camera:p.kind===Ne.Kind.Audio&&(p.source=Ne.Source.Microphone),p.mediaStream=a,p})})}createScreenTracks(e){return ge(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Uy("getDisplayMedia not supported");e.resolution===void 0&&!d9()&&(e.resolution=Gy.h1080fps30.resolution);const t=n9(e),r=yield navigator.mediaDevices.getDisplayMedia(t),i=r.getVideoTracks();if(i.length===0)throw new vs("no video track found");const o=new co(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=Ne.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const a=[o];if(r.getAudioTracks().length>0){this.emit(We.AudioStreamAcquired);const l=new Ni(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});l.source=Ne.Source.ScreenShareAudio,a.push(l)}return a})}publishTrack(e,t){var r,i,o,a;return ge(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Vu&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let l;if(e instanceof MediaStreamTrack)l=e.getConstraints();else{l=e.constraints;let v;switch(e.source){case Ne.Source.Microphone:v="audioinput";break;case Ne.Source.Camera:v="videoinput"}v&&this.activeDeviceMap.has(v)&&(l=Object.assign(Object.assign({},l),{deviceId:this.activeDeviceMap.get(v)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Ni(e,l,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new co(e,l,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new vs("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof Ni&&e.setAudioContext(this.audioContext);let u;if(this.tracks.forEach(v=>{v.track&&v.track===e&&(u=v)}),u)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),Mn(u))),u;const d="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,f=(i=t==null?void 0:t.forceStereo)!==null&&i!==void 0?i:d;f&&(t||(t={}),t.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),Mn(e))),t.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=t.dtx)!==null&&o!==void 0||(t.dtx=!1),(a=t.red)!==null&&a!==void 0||(t.red=!1));const p=Object.assign(Object.assign({},this.roomOptions.publishDefaults),t);Sc()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),p.simulcast=!1),p.source&&(e.source=p.source);const g=this.publish(e,p,f);this.pendingPublishPromises.set(e,g);try{return yield g}catch(v){throw v}finally{this.pendingPublishPromises.delete(e)}})}publish(e,t,r){var i,o,a,l,u,d,f,p,g,v,C,y,x;return ge(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(M=>e instanceof Vu&&M.source===e.source)&&e.source!==Ne.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Mn(e))),t.stopMicTrackOnMute&&e instanceof Ni&&(e.stopOnMute=!0),e.source===Ne.Source.ScreenShare&&Uu()&&(t.simulcast=!1),t.videoCodec==="av1"&&!s9()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!a9()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=NC);const b=t.videoCodec;e.on(it.Muted,this.onTrackMuted),e.on(it.Unmuted,this.onTrackUnmuted),e.on(it.Ended,this.handleTrackEnded),e.on(it.UpstreamPaused,this.onTrackUpstreamPaused),e.on(it.UpstreamResumed,this.onTrackUpstreamResumed);const T=new Wo({cid:e.mediaStreamTrack.id,name:t.name,type:Ne.kindToProto(e.kind),muted:e.isMuted,source:Ne.sourceToProto(e.source),disableDtx:!(!((i=t.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=t.red)!==null&&o!==void 0)||o),stream:t==null?void 0:t.stream});let R;if(e.kind===Ne.Kind.Video){let M={width:0,height:0};try{M=yield e.waitForDimensions()}catch{const V=(l=(a=this.roomOptions.videoCaptureDefaults)===null||a===void 0?void 0:a.resolution)!==null&&l!==void 0?l:wf.h720.resolution;M={width:V.width,height:V.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Mn(e)),{dims:M}))}T.width=M.width,T.height=M.height,e instanceof co&&(lf(b)&&(e.source===Ne.Source.ScreenShare&&b==="vp9"&&(t.scalabilityMode="L1T3"),t.scalabilityMode=(u=t.scalabilityMode)!==null&&u!==void 0?u:"L3T3_KEY"),T.simulcastCodecs=[new Go({codec:b,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:NC}),t.backupCodec&&b!==t.backupCodec.codec&&T.encryption===Pr.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),T.simulcastCodecs.push(new Go({codec:t.backupCodec.codec,cid:""})))),R=OC(e.source===Ne.Source.ScreenShare,T.width,T.height,t),T.layers=Iw(T.width,T.height,R,lf(t.videoCodec))}else e.kind===Ne.Kind.Audio&&(R=[{maxBitrate:(f=(d=t.audioPreset)===null||d===void 0?void 0:d.maxBitrate)!==null&&f!==void 0?f:t.audioBitrate,priority:(g=(p=t.audioPreset)===null||p===void 0?void 0:p.priority)!==null&&g!==void 0?g:"high",networkPriority:(C=(v=t.audioPreset)===null||v===void 0?void 0:v.priority)!==null&&C!==void 0?C:"high"}]);if(!this.engine||this.engine.isClosed)throw new fr("cannot publish track when not connected");const P=yield this.engine.addTrack(T);let B;if(P.codecs.forEach(M=>{B===void 0&&(B=M.mimeType)}),B&&e.kind===Ne.Kind.Video){const M=BT(B);M!==b&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Mn(e)),{codec:M})),t.videoCodec=M,R=OC(e.source===Ne.Source.ScreenShare,T.width,T.height,t))}const _=new Sf(e.kind,P,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(_.options=t,e.sid=P.sid,!this.engine.pcManager)throw new fr("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:R,trackInfo:P})),e.sender=yield this.engine.createSender(e,t,R),R)if(Uu()&&e.kind===Ne.Kind.Audio){let M;for(const H of this.engine.pcManager.publisher.getTransceivers())if(H.sender===e.sender){M=H;break}M&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:M,codec:"opus",maxbr:!((y=R[0])===null||y===void 0)&&y.maxBitrate?R[0].maxBitrate/1e3:0})}else e.codec&&lf(e.codec)&&(!((x=R[0])===null||x===void 0)&&x.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:T.cid,codec:e.codec,maxbr:R[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof co?e.startMonitor(this.engine.client):e instanceof Ni&&e.startMonitor(),this.addTrackPublication(_),this.emit(We.LocalTrackPublished,_),_})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,r){var i;return ge(this,void 0,void 0,function*(){if(this.encryptionType!==Pr.NONE)return;let o;if(this.tracks.forEach(p=>{p.track&&p.track===e&&(o=p)}),!o)throw new vs("track is not published");if(!(e instanceof co))throw new vs("track is not a video track");const a=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),l=H9(e,t,a);if(!l){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Mn(e)));return}const u=e.addSimulcastTrack(t,l),d=new Wo({cid:u.mediaStreamTrack.id,type:Ne.kindToProto(e.kind),muted:e.isMuted,source:Ne.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:a.videoCodec,cid:u.mediaStreamTrack.id}]});if(d.layers=Iw(d.width,d.height,l),!this.engine||this.engine.isClosed)throw new fr("cannot publish track when not connected");const f=yield this.engine.addTrack(d);yield this.engine.createSimulcastSender(e,u,a,l),yield this.engine.negotiate(),this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:l,trackInfo:f}))})}unpublishTrack(e,t){var r,i;return ge(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(e),a=o?Mn(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),a)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),a));return}e=o.track,e.off(it.Muted,this.onTrackMuted),e.off(it.Unmuted,this.onTrackUnmuted),e.off(it.Ended,this.handleTrackEnded),e.off(it.UpstreamPaused,this.onTrackUpstreamPaused),e.off(it.UpstreamResumed,this.onTrackUpstreamResumed),t===void 0&&(t=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),t&&e.stop();let l=!1;const u=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<pr.FAILED&&u)try{for(const d of this.engine.pcManager.publisher.getTransceivers())d.sender===u&&(d.direction="inactive",l=!0);if(this.engine.removeTrack(u)&&(l=!0),e instanceof co){for(const[,d]of e.simulcastCodecs)d.sender&&(this.engine.removeTrack(d.sender)&&(l=!0),d.sender=void 0);e.simulcastCodecs.clear()}}catch(d){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),a),{error:d}))}switch(this.tracks.delete(o.trackSid),o.kind){case Ne.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case Ne.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(We.LocalTrackUnpublished,o),o.setTrack(void 0),l&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return ge(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Sf)})}republishAllTracks(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return ge(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>ge(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),t&&!o.isMuted&&o.source!==Ne.Source.ScreenShare&&o.source!==Ne.Source.ScreenShareAudio&&(o instanceof Ni||o instanceof co)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ge(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],a=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(u=>{u instanceof kf?o.push(u.sid):o.push(u)});const l=new Cs({kind:t,value:{case:"user",value:new xs({participantSid:this.sid,payload:e,destinationSids:o,topic:a})}});yield this.engine.sendDataPacket(l,t)})}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(t=>{var r,i;const o=this.tracks.get(t.sid);if(o){const a=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);a!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Mn(o)),{mutedOnServer:a})),this.engine.client.sendMuteTrack(t.sid,a))}}),!0)}getPublicationForTrack(e){let t;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof Ni||i instanceof co)&&i.mediaStreamTrack===e&&(t=r):e===i&&(t=r))}),t}}var pn;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting"})(pn||(pn={}));const q9=2*1e3;class B0 extends zs.EventEmitter{constructor(e){var t,r,i;super(),t=this,this.state=pn.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=nn,this.bufferedEvents=[],this.connect=(o,a,l)=>ge(this,void 0,void 0,function*(){var u;const d=yield this.disconnectLock.lock();if(this.state===pn.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),d(),Promise.resolve();if(this.connectFuture)return d(),this.connectFuture.promise;this.setAndEmitConnectionState(pn.Connecting),((u=this.regionUrlProvider)===null||u===void 0?void 0:u.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),DC(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new vw(o,a):this.regionUrlProvider.updateToken(a),this.regionUrlProvider.fetchRegionSettings().catch(g=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:g}))}));const f=(g,v,C)=>ge(this,void 0,void 0,function*(){var y;this.abortController&&this.abortController.abort();const x=new AbortController;this.abortController=x,d==null||d();try{yield this.attemptConnection(C??o,a,l,x),this.abortController=void 0,g()}catch(I){if(this.regionUrlProvider&&I instanceof Pn&&I.reason!==3&&I.reason!==0){let b=null;try{b=yield this.regionUrlProvider.getNextBestRegionUrl((y=this.abortController)===null||y===void 0?void 0:y.signal)}catch(T){if(T instanceof Pn&&(T.status===401||T.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),v(T);return}}b?(this.log.info("Initial connection failed with ConnectionError: ".concat(I.message,". Retrying with another region: ").concat(b),this.logContext),yield f(g,v,b)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),v(I))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),v(I)}}),p=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new LT((g,v)=>{f(g,v,p)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,a,l,u,d,f)=>ge(this,void 0,void 0,function*(){var p,g,v;const C=yield l.join(o,a,{autoSubscribe:u.autoSubscribe,publishOnly:u.publishOnly,adaptiveStream:typeof d.adaptiveStream=="object"?!0:d.adaptiveStream,maxRetries:u.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:u.websocketTimeout},f.signal);let y=C.serverInfo;if(y||(y={version:C.serverVersion,region:C.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(y).map(x=>{let[I,b]=x;return"".concat(I,": ").concat(b)}).join(", ")),{room:(p=C.room)===null||p===void 0?void 0:p.name,roomSid:(g=C.room)===null||g===void 0?void 0:g.sid,identity:(v=C.participant)===null||v===void 0?void 0:v.identity}),!C.serverVersion)throw new z6("unknown server version");return C.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),d.dynacast=!1),C}),this.applyJoinResponse=o=>{const a=o.participant;this.localParticipant.sid=a.sid,this.localParticipant.identity=a.identity,this.handleParticipantUpdates([a,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,a,l,u)=>ge(this,void 0,void 0,function*(){var d,f;this.state===pn.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((d=this.regionUrlProvider)===null||d===void 0)&&d.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Hy),l),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const p=yield this.connectSignal(o,a,this.engine,this.connOptions,this.options,u);this.applyJoinResponse(p),this.setupLocalParticipantEvents(),this.emit(Le.SignalConnected)}catch(p){yield this.engine.close(),this.recreateEngine();const g=new Pn("could not establish signal connection");throw p instanceof Error&&(g.message="".concat(g.message,": ").concat(p.message)),p instanceof Pn&&(g.reason=p.reason,g.status=p.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:p})),g}if(u.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Pn("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,u)}catch(p){throw yield this.engine.close(),this.recreateEngine(),p}Mi()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Mi()&&(document.addEventListener("freeze",this.onPageLeave),(f=navigator.mediaDevices)===null||f===void 0||f.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(pn.Connected),this.emit(Le.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return ge(t,void 0,void 0,function*(){var a,l,u,d;const f=yield this.disconnectLock.lock();try{if(this.state===pn.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===pn.Connecting||this.state===pn.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(a=this.abortController)===null||a===void 0||a.abort(),(u=(l=this.connectFuture)===null||l===void 0?void 0:l.reject)===null||u===void 0||u.call(l,new Pn("Client initiated disconnect")),this.connectFuture=void 0),!((d=this.engine)===null||d===void 0)&&d.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,La.CLIENT_INITIATED),this.engine=void 0}finally{f()}})},this.onPageLeave=()=>ge(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>ge(this,void 0,void 0,function*(){const o=[],a=Ga();if(a&&a.os==="iOS"){const l="livekit-dummy-audio-el";let u=document.getElementById(l);if(!u){u=document.createElement("audio"),u.id=l,u.autoplay=!0,u.hidden=!0;const d=gv();d.enabled=!0;const f=new MediaStream([d]);u.srcObject=f,document.addEventListener("visibilitychange",()=>{u&&(u.srcObject=document.hidden?null:f,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(u),this.once(Le.Disconnected,()=>{u==null||u.remove(),u=null})}o.push(u)}this.participants.forEach(l=>{l.audioTracks.forEach(u=>{u.track&&u.track.attachedElements.forEach(d=>{o.push(d)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(l=>(l.muted=!1,l.play()))]),this.handleAudioPlaybackStarted()}catch(l){throw this.handleAudioPlaybackFailed(l),l}}),this.startVideo=()=>ge(this,void 0,void 0,function*(){const o=[];for(const a of this.participants.values())a.videoTracks.forEach(l=>{var u;(u=l.track)===null||u===void 0||u.attachedElements.forEach(d=>{o.includes(d)||o.push(d)})});yield Promise.all(o.map(a=>a.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(a=>{a.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(pn.Reconnecting)&&this.emit(Le.Reconnecting)},this.handleSignalRestarted=o=>ge(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(a){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:a}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(pn.Connected),this.emit(Le.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(a=>{if(a.identity===this.localParticipant.identity){this.localParticipant.updateInfo(a);return}const l=this.identityToSid.get(a.identity);l&&l!==a.sid&&this.handleParticipantDisconnected(l,this.participants.get(l));let u=this.participants.get(a.sid);const d=!u;a.state===Ac.DISCONNECTED?this.handleParticipantDisconnected(a.sid,u):(u=this.getOrCreateParticipant(a.sid,a),d||u.updateInfo(a))})},this.handleActiveSpeakersUpdate=o=>{const a=[],l={};o.forEach(u=>{if(l[u.sid]=!0,u.sid===this.localParticipant.sid)this.localParticipant.audioLevel=u.level,this.localParticipant.setIsSpeaking(!0),a.push(this.localParticipant);else{const d=this.participants.get(u.sid);d&&(d.audioLevel=u.level,d.setIsSpeaking(!0),a.push(d))}}),l[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(u=>{l[u.sid]||(u.audioLevel=0,u.setIsSpeaking(!1))}),this.activeSpeakers=a,this.emitWhenConnected(Le.ActiveSpeakersChanged,a)},this.handleSpeakersChanged=o=>{const a=new Map;this.activeSpeakers.forEach(u=>{a.set(u.sid,u)}),o.forEach(u=>{let d=this.participants.get(u.sid);u.sid===this.localParticipant.sid&&(d=this.localParticipant),d&&(d.audioLevel=u.level,d.setIsSpeaking(u.active),u.active?a.set(u.sid,d):a.delete(u.sid))});const l=Array.from(a.values());l.sort((u,d)=>d.audioLevel-u.audioLevel),this.activeSpeakers=l,this.emitWhenConnected(Le.ActiveSpeakersChanged,l)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(a=>{const l=this.participants.get(a.participantSid);if(!l)return;const u=l.getTrackPublication(a.trackSid);!u||!u.track||(u.track.streamState=Ne.streamStateFromProto(a.state),l.emit(We.TrackStreamStateChanged,u,u.track.streamState),this.emitWhenConnected(Le.TrackStreamStateChanged,u,u.track.streamState,l))})},this.handleSubscriptionPermissionUpdate=o=>{const a=this.participants.get(o.participantSid);if(!a)return;const l=a.getTrackPublication(o.trackSid);l&&l.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const a=Array.from(this.participants.values()).find(u=>u.tracks.has(o.trackSid));if(!a)return;const l=a.getTrackPublication(o.trackSid);l&&l.setSubscriptionError(o.err)},this.handleDataPacket=(o,a)=>{const l=this.participants.get(o.participantSid);this.emit(Le.DataReceived,o.payload,l,a,o.topic),l==null||l.emit(We.DataReceived,o.payload,a)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Le.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Le.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Le.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Le.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>ge(this,void 0,void 0,function*(){this.emit(Le.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const a=this.roomInfo;this.roomInfo=o,a&&a.metadata!==o.metadata&&this.emitWhenConnected(Le.RoomMetadataChanged,o.metadata),(a==null?void 0:a.activeRecording)!==o.activeRecording&&this.emitWhenConnected(Le.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(a=>{if(a.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(a.quality);return}const l=this.participants.get(a.participantSid);l&&l.setConnectionQuality(a.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(Le.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(Le.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(Le.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(Le.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>ge(this,void 0,void 0,function*(){var a;this.emit(Le.LocalTrackPublished,o,this.localParticipant),o.track instanceof Ni&&(yield o.track.checkForSilence())&&this.emit(Le.LocalAudioSilenceDetected,o);const l=yield(a=o.track)===null||a===void 0?void 0:a.getDeviceId(),u=t9(o.source);u&&l&&l!==this.localParticipant.activeDeviceMap.get(u)&&(this.localParticipant.activeDeviceMap.set(u,l),this.emit(Le.ActiveDeviceChanged,u,l))}),this.onLocalTrackUnpublished=o=>{this.emit(Le.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(Le.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(Le.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(Le.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},B9),e),this.log=Va((r=this.options.loggerName)!==null&&r!==void 0?r:Ms.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},WT),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},jT),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},N9),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Xo,this.localParticipant=new FC("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",mc(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",mc(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",mc(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return ge(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new y9(this.options.e2ee),this.e2eeManager.on(Sl.ParticipantEncryptionStatusChanged,(t,r)=>{r instanceof FC&&(this.isE2EEEnabled=t),this.emit(Le.ParticipantEncryptionStatusChanged,t,r)}),this.e2eeManager.on(Sl.EncryptionError,t=>this.emit(Le.EncryptionError,t)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}get sid(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&t!==void 0?t:""}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new M9(this.options),this.engine.on(pt.ParticipantUpdate,this.handleParticipantUpdates).on(pt.RoomUpdate,this.handleRoomUpdate).on(pt.SpeakersChanged,this.handleSpeakersChanged).on(pt.StreamStateChanged,this.handleStreamStateUpdate).on(pt.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(pt.SubscriptionError,this.handleSubscriptionError).on(pt.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(pt.MediaTrackAdded,(e,t,r)=>{this.onTrackAdded(e,t,r)}).on(pt.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(pt.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(pt.DataPacketReceived,this.handleDataPacket).on(pt.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(pn.Reconnecting)&&this.emit(Le.Reconnecting)}).on(pt.Resumed,()=>{this.setAndEmitConnectionState(pn.Connected),this.emit(Le.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(pt.SignalResumed,()=>{this.bufferedEvents=[],this.state===pn.Reconnecting&&this.sendSyncState()}).on(pt.Restarting,this.handleRestarting).on(pt.SignalRestarted,this.handleSignalRestarted).on(pt.DCBufferStatusChanged,(e,t)=>{this.emit(Le.DCBufferStatusChanged,e,t)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return ci.getInstance().getDevices(e,t)}prepareConnection(e,t){return ge(this,void 0,void 0,function*(){if(this.state===pn.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(DC(new URL(e))&&t){this.regionUrlProvider=new vw(e,t);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===pn.Disconnected&&(this.regionUrl=r,yield fetch(aw(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(aw(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const t=this.identityToSid.get(e);if(t)return this.participants.get(t)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return ge(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new _r({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new _r({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new _r({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new _r({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>ge(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new _r({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>ge(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new _r({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new _r({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>ge(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new ho({reason:La.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new _r({scenario:{case:"subscriberBandwidth",value:BigInt(t)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,t;return(t=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&t!==void 0?t:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,a;return ge(this,void 0,void 0,function*(){let l=!1,u=!0;const d=r?{exact:t}:t;if(e==="audioinput"){const f=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=d,l=f!==d;const p=Array.from(this.localParticipant.audioTracks.values()).filter(g=>g.source===Ne.Source.Microphone);try{u=(yield Promise.all(p.map(g=>{var v;return(v=g.audioTrack)===null||v===void 0?void 0:v.setDeviceId(d)}))).every(g=>g===!0)}catch(g){throw this.options.audioCaptureDefaults.deviceId=f,g}}else if(e==="videoinput"){const f=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=d,l=f!==d;const p=Array.from(this.localParticipant.videoTracks.values()).filter(g=>g.source===Ne.Source.Camera);try{u=(yield Promise.all(p.map(g=>{var v;return(v=g.videoTrack)===null||v===void 0?void 0:v.setDeviceId(d)}))).every(g=>g===!0)}catch(g){throw this.options.videoCaptureDefaults.deviceId=f,g}}else if(e==="audiooutput"){if(!PC()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(a=this.options).audioOutput)!==null&&i!==void 0||(a.audioOutput={});const f=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=t,l=f!==d;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(t):yield Promise.all(Array.from(this.participants.values()).map(p=>p.setAudioOutput({deviceId:t})))}catch(p){throw this.options.audioOutput.deviceId=f,p}}return l&&u&&(this.localParticipant.activeDeviceMap.set(e,t),this.emit(Le.ActiveDeviceChanged,e,t)),u})}setupLocalParticipantEvents(){this.localParticipant.on(We.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(We.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(We.TrackMuted,this.onLocalTrackMuted).on(We.TrackUnmuted,this.onLocalTrackUnmuted).on(We.LocalTrackPublished,this.onLocalTrackPublished).on(We.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(We.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(We.MediaDevicesError,this.onMediaDevicesError).on(We.AudioStreamAcquired,this.startAudio).on(We.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,r){if(this.state===pn.Connecting||this.state===pn.Reconnecting){const f=()=>{this.onTrackAdded(e,t,r),p()},p=()=>{this.off(Le.Reconnected,f),this.off(Le.Connected,f),this.off(Le.Disconnected,p)};this.once(Le.Reconnected,f),this.once(Le.Connected,f),this.once(Le.Disconnected,p);return}if(this.state===pn.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=o9(t.id),o=i[0];let a=i[1],l=e.id;if(a&&a.startsWith("TR")&&(l=a),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const u=this.participants.get(o);if(!u){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let d;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?d=this.options.adaptiveStream:d={}),u.addSubscribedMediaTrack(e,l,t,r,d)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==pn.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,a;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((o=i.track)===null||o===void 0||o.detach(),(a=i.track)===null||a===void 0||a.stop())}),this.localParticipant.off(We.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(We.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(We.TrackMuted,this.onLocalTrackMuted).off(We.TrackUnmuted,this.onLocalTrackUnmuted).off(We.LocalTrackPublished,this.onLocalTrackPublished).off(We.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(We.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(We.MediaDevicesError,this.onMediaDevicesError).off(We.AudioStreamAcquired,this.startAudio).off(We.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Mi()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(pn.Disconnected),this.emit(Le.Disconnected,t)}}}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(this.identityToSid.delete(t.identity),t.tracks.forEach(r=>{t.unpublishTrack(r.trackSid,!0)}),this.emit(Le.ParticipantDisconnected,t))}acquireAudioContext(){var e,t;return ge(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Wy())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(Le.AudioPlaybackStatusChanged,r))})}createParticipant(e,t){var r;let i;return t?i=kf.fromParticipantInfo(this.engine.client,t):i=new kf(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,t);return this.participants.set(e,r),this.identityToSid.set(t.identity,t.sid),this.emitWhenConnected(Le.ParticipantConnected,r),r.on(We.TrackPublished,i=>{this.emitWhenConnected(Le.TrackPublished,i,r)}).on(We.TrackSubscribed,(i,o)=>{i.kind===Ne.Kind.Audio?(i.on(it.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(it.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Ne.Kind.Video&&(i.on(it.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(it.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Le.TrackSubscribed,i,o,r)}).on(We.TrackUnpublished,i=>{this.emit(Le.TrackUnpublished,i,r)}).on(We.TrackUnsubscribed,(i,o)=>{this.emit(Le.TrackUnsubscribed,i,o,r)}).on(We.TrackSubscriptionFailed,i=>{this.emit(Le.TrackSubscriptionFailed,i,r)}).on(We.TrackMuted,i=>{this.emitWhenConnected(Le.TrackMuted,i,r)}).on(We.TrackUnmuted,i=>{this.emitWhenConnected(Le.TrackUnmuted,i,r)}).on(We.ParticipantMetadataChanged,i=>{this.emitWhenConnected(Le.ParticipantMetadataChanged,i,r)}).on(We.ParticipantNameChanged,i=>{this.emitWhenConnected(Le.ParticipantNameChanged,i,r)}).on(We.ConnectionQualityChanged,i=>{this.emitWhenConnected(Le.ConnectionQualityChanged,i,r)}).on(We.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(Le.ParticipantPermissionsChanged,i,r)}).on(We.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(Le.TrackSubscriptionStatusChanged,i,o,r)}).on(We.TrackSubscriptionFailed,(i,o)=>{this.emit(Le.TrackSubscriptionFailed,i,r,o)}).on(We.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(Le.TrackSubscriptionPermissionChanged,i,o,r)}),t&&r.updateInfo(t),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),t=this.localParticipant.getTracks();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.participants.values())for(const t of e.videoTracks.values())t.isSubscribed&&t instanceof Xy&&t.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Dr.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,La.STATE_MISMATCH))):e=0},q9)}clearConnectionReconcile(){this.connectionReconcileInterval&&Dr.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(Le.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,r]=e;this.emit(t,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this.state===pn.Connected?this.emit(e,...r):(this.state===pn.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var t,r;return ge(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Ju({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Kt.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Yi({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Le.SignalConnected),this.emit(Le.Connected),this.setAndEmitConnectionState(pn.Connected),i.video){const a=new Sf(Ne.Kind.Video,new Fi({source:nr.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:$r.AUDIO,name:"video-dummy"}),new co(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:sw(160*((t=o.aspectRatios[0])!==null&&t!==void 0?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(We.LocalTrackPublished,a)}if(i.audio){const a=new Sf(Ne.Kind.Audio,new Fi({source:nr.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:$r.AUDIO}),new Ni(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:gv(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(We.LocalTrackPublished,a)}for(let a=0;a<o.count-1;a+=1){let l=new Yi({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(a),state:Ac.ACTIVE,tracks:[],joinedAt:Kt.parse(Date.now())});const u=this.getOrCreateParticipant(l.identity,l);if(o.video){const d=sw(160*((r=o.aspectRatios[a%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),f=new Fi({source:nr.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:$r.AUDIO});u.addSubscribedMediaTrack(d,f.sid,new MediaStream([d])),l.tracks=[...l.tracks,f]}if(o.audio){const d=gv(),f=new Fi({source:nr.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:$r.AUDIO});u.addSubscribedMediaTrack(d,f.sid,new MediaStream([d])),l.tracks=[...l.tracks,f]}u.updateInfo(l)}})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(e!==Le.ActiveSpeakersChanged){const o=$T(r).filter(a=>a!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}function $T(n){return n.map(e=>{if(e)return Array.isArray(e)?$T(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var Uo;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(Uo||(Uo={}));class qu extends zs.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Uo.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=t,this.name=this.constructor.name,this.room=new B0(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return ge(this,void 0,void 0,function*(){if(this.status!==Uo.IDLE)throw Error("check is running already");this.setStatus(Uo.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==Uo.SKIPPED&&this.setStatus(this.isSuccess()?Uo.SUCCESS:Uo.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return ge(this,void 0,void 0,function*(){return this.room.state===pn.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return ge(this,void 0,void 0,function*(){this.room&&this.room.state!==pn.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Uo.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function JT(n){var e,t;return ge(this,void 0,void 0,function*(){n??(n={}),(e=n.audio)!==null&&e!==void 0||(n.audio=!0),(t=n.video)!==null&&t!==void 0||(n.video=!0);const r=NT(n,WT,jT),i=eg(r),o=navigator.mediaDevices.getUserMedia(i);n.audio&&(ci.userMediaPromiseMap.set("audioinput",o),o.catch(()=>ci.userMediaPromiseMap.delete("audioinput"))),n.video&&(ci.userMediaPromiseMap.set("videoinput",o),o.catch(()=>ci.userMediaPromiseMap.delete("videoinput")));const a=yield o;return a.getTracks().map(l=>{const u=l.kind==="audio";u?n.audio:n.video;let d;const f=u?i.audio:i.video;typeof f!="boolean"&&(d=f),d?d.deviceId=l.getSettings().deviceId:d={deviceId:l.getSettings().deviceId};const p=zT(l,d);return p.kind===Ne.Kind.Video?p.source=Ne.Source.Camera:p.kind===Ne.Kind.Audio&&(p.source=Ne.Source.Microphone),p.mediaStream=a,p})})}function Q9(n){return ge(this,void 0,void 0,function*(){return(yield JT({audio:!1,video:n}))[0]})}function e7(n){return ge(this,void 0,void 0,function*(){return(yield JT({audio:n,video:!1}))[0]})}class t7 extends qu{get description(){return"Can publish audio"}perform(){var e;return ge(this,void 0,void 0,function*(){const t=yield this.connect(),r=yield e7();t.localParticipant.publishTrack(r),yield new Promise(a=>setTimeout(a,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(a=>{a.type==="outbound-rtp"&&a.mediaType==="audio"&&(o=a.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class n7 extends qu{get description(){return"Can publish video"}perform(){var e;return ge(this,void 0,void 0,function*(){const t=yield this.connect(),r=yield Q9();t.localParticipant.publishTrack(r),yield new Promise(a=>setTimeout(a,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(a=>{a.type==="outbound-rtp"&&a.mediaType==="video"&&(o=a.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class r7 extends qu{get description(){return"Resuming connection after interruption"}perform(){var e;return ge(this,void 0,void 0,function*(){const t=yield this.connect();let r=!1,i=!1,o;const a=new Promise(u=>{setTimeout(u,5e3),o=u});t.on(Le.Reconnecting,()=>{r=!0}).on(Le.Reconnected,()=>{i=!0,o(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const l=t.engine.client.onClose;if(l&&l(""),yield a,r){if(!i||t.state!==pn.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class i7 extends qu{get description(){return"Can connect via TURN"}perform(){var e,t;return ge(this,void 0,void 0,function*(){const r=new zy,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,a=!1,l=!1;for(let u of i.iceServers)for(let d of u.urls)d.startsWith("turn:")?(a=!0,l=!0):d.startsWith("turns:")&&(a=!0,l=!0,o=!0),d.startsWith("stun:")&&(l=!0);l?a&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((t=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||t===void 0)&&t.iceServers||a?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(u=>setTimeout(u,0)))})}}class o7 extends qu{get description(){return"Establishing WebRTC connection"}perform(){return ge(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(Le.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const a=new RTCIceCandidate(i);let l="".concat(a.protocol," ").concat(a.address,":").concat(a.port," ").concat(a.type);a.address&&(s7(a.address)?l+=" (private)":a.protocol==="tcp"&&a.tcpType==="passive"?(e=!0,l+=" (passive)"):a.protocol==="udp"&&(t=!0)),this.appendMessage(l)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),nn.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function s7(n){const e=n.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class a7 extends qu{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,t,r;return ge(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new zy;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===Mu.Cloud&&(!((t=o.serverInfo)===null||t===void 0)&&t.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class Oz extends zs.EventEmitter{constructor(e,t){super(),this.checkResults=new Map,this.url=e,this.token=t}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Uo.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Uo.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return ge(this,void 0,void 0,function*(){const t=this.getNextCheckId(),r=new e(this.url,this.token),i=a=>{this.updateCheck(t,a)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return ge(this,void 0,void 0,function*(){return this.createAndRunCheck(a7)})}checkWebRTC(){return ge(this,void 0,void 0,function*(){return this.createAndRunCheck(o7)})}checkTURN(){return ge(this,void 0,void 0,function*(){return this.createAndRunCheck(i7)})}checkReconnect(){return ge(this,void 0,void 0,function*(){return this.createAndRunCheck(r7)})}checkPublishAudio(){return ge(this,void 0,void 0,function*(){return this.createAndRunCheck(t7)})}checkPublishVideo(){return ge(this,void 0,void 0,function*(){return this.createAndRunCheck(n7)})}}function l7(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var t;const r=n instanceof Vu?n.mediaStreamTrack:n,i=r.getSettings();let o={facingMode:(t=e.defaultFacingMode)!==null&&t!==void 0?t:"user",confidence:"low"};if("facingMode"in i){const a=i.facingMode;nn.debug("rawFacingMode",{rawFacingMode:a}),a&&typeof a=="string"&&d7(a)&&(o={facingMode:a,confidence:"high"})}if(["low","medium"].includes(o.confidence)){nn.debug("Try to get facing mode from device label: (".concat(r.label,")"));const a=u7(r.label);a!==void 0&&(o=a)}return o}const Aw=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),c7=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function u7(n){var e;const t=n.trim().toLowerCase();if(t!=="")return Aw.has(t)?Aw.get(t):(e=Array.from(c7.entries()).find(r=>{let[i]=r;return t.includes(i)}))===null||e===void 0?void 0:e[1]}function d7(n){return n===void 0||["user","environment","left","right"].includes(n)}const MC=Math.min,ku=Math.max,O0=Math.round,Os=n=>({x:n,y:n}),f7={left:"right",right:"left",bottom:"top",top:"bottom"},h7={start:"end",end:"start"};function ww(n,e,t){return ku(n,MC(e,t))}function ng(n,e){return typeof n=="function"?n(e):n}function Ec(n){return n.split("-")[0]}function rg(n){return n.split("-")[1]}function YT(n){return n==="x"?"y":"x"}function qT(n){return n==="y"?"height":"width"}const p7=new Set(["top","bottom"]);function El(n){return p7.has(Ec(n))?"y":"x"}function QT(n){return YT(El(n))}function g7(n,e,t){t===void 0&&(t=!1);const r=rg(n),i=QT(n),o=qT(i);let a=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(a=F0(a)),[a,F0(a)]}function m7(n){const e=F0(n);return[LC(n),e,LC(e)]}function LC(n){return n.replace(/start|end/g,e=>h7[e])}const Sw=["left","right"],kw=["right","left"],v7=["top","bottom"],C7=["bottom","top"];function y7(n,e,t){switch(n){case"top":case"bottom":return t?e?kw:Sw:e?Sw:kw;case"left":case"right":return e?v7:C7;default:return[]}}function x7(n,e,t,r){const i=rg(n);let o=y7(Ec(n),t==="start",r);return i&&(o=o.map(a=>a+"-"+i),e&&(o=o.concat(o.map(LC)))),o}function F0(n){return n.replace(/left|right|bottom|top/g,e=>f7[e])}function I7(n){return{top:0,right:0,bottom:0,left:0,...n}}function b7(n){return typeof n!="number"?I7(n):{top:n,right:n,bottom:n,left:n}}function M0(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function Ew(n,e,t){let{reference:r,floating:i}=n;const o=El(e),a=QT(e),l=qT(a),u=Ec(e),d=o==="y",f=r.x+r.width/2-i.width/2,p=r.y+r.height/2-i.height/2,g=r[l]/2-i[l]/2;let v;switch(u){case"top":v={x:f,y:r.y-i.height};break;case"bottom":v={x:f,y:r.y+r.height};break;case"right":v={x:r.x+r.width,y:p};break;case"left":v={x:r.x-i.width,y:p};break;default:v={x:r.x,y:r.y}}switch(rg(e)){case"start":v[a]-=g*(t&&d?-1:1);break;case"end":v[a]+=g*(t&&d?-1:1);break}return v}const A7=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:a}=t,l=o.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let d=await a.getElementRects({reference:n,floating:e,strategy:i}),{x:f,y:p}=Ew(d,r,u),g=r,v={},C=0;for(let y=0;y<l.length;y++){const{name:x,fn:I}=l[y],{x:b,y:T,data:R,reset:P}=await I({x:f,y:p,initialPlacement:r,placement:g,strategy:i,middlewareData:v,rects:d,platform:a,elements:{reference:n,floating:e}});f=b??f,p=T??p,v={...v,[x]:{...v[x],...R}},P&&C<=50&&(C++,typeof P=="object"&&(P.placement&&(g=P.placement),P.rects&&(d=P.rects===!0?await a.getElementRects({reference:n,floating:e,strategy:i}):P.rects),{x:f,y:p}=Ew(d,g,u)),y=-1)}return{x:f,y:p,placement:g,strategy:i,middlewareData:v}};async function e2(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:a,elements:l,strategy:u}=n,{boundary:d="clippingAncestors",rootBoundary:f="viewport",elementContext:p="floating",altBoundary:g=!1,padding:v=0}=ng(e,n),C=b7(v),x=l[g?p==="floating"?"reference":"floating":p],I=M0(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(x)))==null||t?x:x.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:d,rootBoundary:f,strategy:u})),b=p==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,T=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),R=await(o.isElement==null?void 0:o.isElement(T))?await(o.getScale==null?void 0:o.getScale(T))||{x:1,y:1}:{x:1,y:1},P=M0(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:T,strategy:u}):b);return{top:(I.top-P.top+C.top)/R.y,bottom:(P.bottom-I.bottom+C.bottom)/R.y,left:(I.left-P.left+C.left)/R.x,right:(P.right-I.right+C.right)/R.x}}const w7=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:o,rects:a,initialPlacement:l,platform:u,elements:d}=e,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:g,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:C="none",flipAlignment:y=!0,...x}=ng(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const I=Ec(i),b=El(l),T=Ec(l)===l,R=await(u.isRTL==null?void 0:u.isRTL(d.floating)),P=g||(T||!y?[F0(l)]:m7(l)),B=C!=="none";!g&&B&&P.push(...x7(l,y,C,R));const _=[l,...P],M=await e2(e,x),H=[];let V=((r=o.flip)==null?void 0:r.overflows)||[];if(f&&H.push(M[I]),p){const ie=g7(i,a,R);H.push(M[ie[0]],M[ie[1]])}if(V=[...V,{placement:i,overflows:H}],!H.every(ie=>ie<=0)){var U,Z;const ie=(((U=o.flip)==null?void 0:U.index)||0)+1,le=_[ie];if(le&&(!(p==="alignment"?b!==El(le):!1)||V.every(de=>de.overflows[0]>0&&El(de.placement)===b)))return{data:{index:ie,overflows:V},reset:{placement:le}};let Ce=(Z=V.filter(Re=>Re.overflows[0]<=0).sort((Re,de)=>Re.overflows[1]-de.overflows[1])[0])==null?void 0:Z.placement;if(!Ce)switch(v){case"bestFit":{var q;const Re=(q=V.filter(de=>{if(B){const pe=El(de.placement);return pe===b||pe==="y"}return!0}).map(de=>[de.placement,de.overflows.filter(pe=>pe>0).reduce((pe,be)=>pe+be,0)]).sort((de,pe)=>de[1]-pe[1])[0])==null?void 0:q[0];Re&&(Ce=Re);break}case"initialPlacement":Ce=l;break}if(i!==Ce)return{reset:{placement:Ce}}}return{}}}},S7=new Set(["left","top"]);async function k7(n,e){const{placement:t,platform:r,elements:i}=n,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=Ec(t),l=rg(t),u=El(t)==="y",d=S7.has(a)?-1:1,f=o&&u?-1:1,p=ng(e,n);let{mainAxis:g,crossAxis:v,alignmentAxis:C}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&typeof C=="number"&&(v=l==="end"?C*-1:C),u?{x:v*f,y:g*d}:{x:g*d,y:v*f}}const E7=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:o,placement:a,middlewareData:l}=e,u=await k7(e,n);return a===((t=l.offset)==null?void 0:t.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:i+u.x,y:o+u.y,data:{...u,placement:a}}}}},T7=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:a=!1,limiter:l={fn:x=>{let{x:I,y:b}=x;return{x:I,y:b}}},...u}=ng(n,e),d={x:t,y:r},f=await e2(e,u),p=El(Ec(i)),g=YT(p);let v=d[g],C=d[p];if(o){const x=g==="y"?"top":"left",I=g==="y"?"bottom":"right",b=v+f[x],T=v-f[I];v=ww(b,v,T)}if(a){const x=p==="y"?"top":"left",I=p==="y"?"bottom":"right",b=C+f[x],T=C-f[I];C=ww(b,C,T)}const y=l.fn({...e,[g]:v,[p]:C});return{...y,data:{x:y.x-t,y:y.y-r,enabled:{[g]:o,[p]:a}}}}}};function ig(){return typeof window<"u"}function Qu(n){return t2(n)?(n.nodeName||"").toLowerCase():"#document"}function qi(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function ja(n){var e;return(e=(t2(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function t2(n){return ig()?n instanceof Node||n instanceof qi(n).Node:!1}function Yo(n){return ig()?n instanceof Element||n instanceof qi(n).Element:!1}function Ls(n){return ig()?n instanceof HTMLElement||n instanceof qi(n).HTMLElement:!1}function Tw(n){return!ig()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof qi(n).ShadowRoot}const R7=new Set(["inline","contents"]);function zf(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=qo(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!R7.has(i)}const _7=new Set(["table","td","th"]);function P7(n){return _7.has(Qu(n))}const D7=[":popover-open",":modal"];function og(n){return D7.some(e=>{try{return n.matches(e)}catch{return!1}})}const N7=["transform","translate","scale","rotate","perspective"],B7=["transform","translate","scale","rotate","perspective","filter"],O7=["paint","layout","strict","content"];function Ky(n){const e=$y(),t=Yo(n)?qo(n):n;return N7.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||B7.some(r=>(t.willChange||"").includes(r))||O7.some(r=>(t.contain||"").includes(r))}function F7(n){let e=_l(n);for(;Ls(e)&&!Gu(e);){if(Ky(e))return e;if(og(e))return null;e=_l(e)}return null}function $y(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const M7=new Set(["html","body","#document"]);function Gu(n){return M7.has(Qu(n))}function qo(n){return qi(n).getComputedStyle(n)}function sg(n){return Yo(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function _l(n){if(Qu(n)==="html")return n;const e=n.assignedSlot||n.parentNode||Tw(n)&&n.host||ja(n);return Tw(e)?e.host:e}function n2(n){const e=_l(n);return Gu(e)?n.ownerDocument?n.ownerDocument.body:n.body:Ls(e)&&zf(e)?e:n2(e)}function r2(n,e,t){var r;e===void 0&&(e=[]);const i=n2(n),o=i===((r=n.ownerDocument)==null?void 0:r.body),a=qi(i);return o?(UC(a),e.concat(a,a.visualViewport||[],zf(i)?i:[],[])):e.concat(i,r2(i,[]))}function UC(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function i2(n){const e=qo(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Ls(n),o=i?n.offsetWidth:t,a=i?n.offsetHeight:r,l=O0(t)!==o||O0(r)!==a;return l&&(t=o,r=a),{width:t,height:r,$:l}}function o2(n){return Yo(n)?n:n.contextElement}function Eu(n){const e=o2(n);if(!Ls(e))return Os(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:o}=i2(e);let a=(o?O0(t.width):t.width)/r,l=(o?O0(t.height):t.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const L7=Os(0);function s2(n){const e=qi(n);return!$y()||!e.visualViewport?L7:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function U7(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==qi(n)?!1:e}function Ef(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),o=o2(n);let a=Os(1);e&&(r?Yo(r)&&(a=Eu(r)):a=Eu(n));const l=U7(o,t,r)?s2(o):Os(0);let u=(i.left+l.x)/a.x,d=(i.top+l.y)/a.y,f=i.width/a.x,p=i.height/a.y;if(o){const g=qi(o),v=r&&Yo(r)?qi(r):r;let C=g,y=UC(C);for(;y&&r&&v!==C;){const x=Eu(y),I=y.getBoundingClientRect(),b=qo(y),T=I.left+(y.clientLeft+parseFloat(b.paddingLeft))*x.x,R=I.top+(y.clientTop+parseFloat(b.paddingTop))*x.y;u*=x.x,d*=x.y,f*=x.x,p*=x.y,u+=T,d+=R,C=qi(y),y=UC(C)}}return M0({width:f,height:p,x:u,y:d})}function Jy(n,e){const t=sg(n).scrollLeft;return e?e.left+t:Ef(ja(n)).left+t}function a2(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:Jy(n,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function V7(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const o=i==="fixed",a=ja(r),l=e?og(e.floating):!1;if(r===a||l&&o)return t;let u={scrollLeft:0,scrollTop:0},d=Os(1);const f=Os(0),p=Ls(r);if((p||!p&&!o)&&((Qu(r)!=="body"||zf(a))&&(u=sg(r)),Ls(r))){const v=Ef(r);d=Eu(r),f.x=v.x+r.clientLeft,f.y=v.y+r.clientTop}const g=a&&!p&&!o?a2(a,u,!0):Os(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-u.scrollLeft*d.x+f.x+g.x,y:t.y*d.y-u.scrollTop*d.y+f.y+g.y}}function G7(n){return Array.from(n.getClientRects())}function W7(n){const e=ja(n),t=sg(n),r=n.ownerDocument.body,i=ku(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=ku(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-t.scrollLeft+Jy(n);const l=-t.scrollTop;return qo(r).direction==="rtl"&&(a+=ku(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:l}}function j7(n,e){const t=qi(n),r=ja(n),i=t.visualViewport;let o=r.clientWidth,a=r.clientHeight,l=0,u=0;if(i){o=i.width,a=i.height;const d=$y();(!d||d&&e==="fixed")&&(l=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:l,y:u}}const z7=new Set(["absolute","fixed"]);function H7(n,e){const t=Ef(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,o=Ls(n)?Eu(n):Os(1),a=n.clientWidth*o.x,l=n.clientHeight*o.y,u=i*o.x,d=r*o.y;return{width:a,height:l,x:u,y:d}}function Rw(n,e,t){let r;if(e==="viewport")r=j7(n,t);else if(e==="document")r=W7(ja(n));else if(Yo(e))r=H7(e,t);else{const i=s2(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return M0(r)}function l2(n,e){const t=_l(n);return t===e||!Yo(t)||Gu(t)?!1:qo(t).position==="fixed"||l2(t,e)}function Z7(n,e){const t=e.get(n);if(t)return t;let r=r2(n,[]).filter(l=>Yo(l)&&Qu(l)!=="body"),i=null;const o=qo(n).position==="fixed";let a=o?_l(n):n;for(;Yo(a)&&!Gu(a);){const l=qo(a),u=Ky(a);!u&&l.position==="fixed"&&(i=null),(o?!u&&!i:!u&&l.position==="static"&&!!i&&z7.has(i.position)||zf(a)&&!u&&l2(n,a))?r=r.filter(f=>f!==a):i=l,a=_l(a)}return e.set(n,r),r}function X7(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const a=[...t==="clippingAncestors"?og(e)?[]:Z7(e,this._c):[].concat(t),r],l=a[0],u=a.reduce((d,f)=>{const p=Rw(e,f,i);return d.top=ku(p.top,d.top),d.right=MC(p.right,d.right),d.bottom=MC(p.bottom,d.bottom),d.left=ku(p.left,d.left),d},Rw(e,l,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function K7(n){const{width:e,height:t}=i2(n);return{width:e,height:t}}function $7(n,e,t){const r=Ls(e),i=ja(e),o=t==="fixed",a=Ef(n,!0,o,e);let l={scrollLeft:0,scrollTop:0};const u=Os(0);function d(){u.x=Jy(i)}if(r||!r&&!o)if((Qu(e)!=="body"||zf(i))&&(l=sg(e)),r){const v=Ef(e,!0,o,e);u.x=v.x+e.clientLeft,u.y=v.y+e.clientTop}else i&&d();o&&!r&&i&&d();const f=i&&!r&&!o?a2(i,l):Os(0),p=a.left+l.scrollLeft-u.x-f.x,g=a.top+l.scrollTop-u.y-f.y;return{x:p,y:g,width:a.width,height:a.height}}function xv(n){return qo(n).position==="static"}function _w(n,e){if(!Ls(n)||qo(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return ja(n)===t&&(t=t.ownerDocument.body),t}function c2(n,e){const t=qi(n);if(og(n))return t;if(!Ls(n)){let i=_l(n);for(;i&&!Gu(i);){if(Yo(i)&&!xv(i))return i;i=_l(i)}return t}let r=_w(n,e);for(;r&&P7(r)&&xv(r);)r=_w(r,e);return r&&Gu(r)&&xv(r)&&!Ky(r)?t:r||F7(n)||t}const J7=async function(n){const e=this.getOffsetParent||c2,t=this.getDimensions,r=await t(n.floating);return{reference:$7(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Y7(n){return qo(n).direction==="rtl"}const q7={convertOffsetParentRelativeRectToViewportRelativeRect:V7,getDocumentElement:ja,getClippingRect:X7,getOffsetParent:c2,getElementRects:J7,getClientRects:G7,getDimensions:K7,getScale:Eu,isElement:Yo,isRTL:Y7},Q7=E7,eU=T7,tU=w7,nU=(n,e,t)=>{const r=new Map,i={platform:q7,...t},o={...i.platform,_c:r};return A7(n,e,{...i,platform:o})};var u0={exports:{}},rU=u0.exports,Pw;function iU(){return Pw||(Pw=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(rU,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},a=null;function l(y,x){var I=y[x];if(typeof I.bind=="function")return I.bind(y);try{return Function.prototype.bind.call(I,y)}catch{return function(){return Function.prototype.apply.apply(I,[y,arguments])}}}function u(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function d(y){return y==="debug"&&(y="log"),typeof console===t?!1:y==="trace"&&r?u:console[y]!==void 0?l(console,y):console.log!==void 0?l(console,"log"):e}function f(){for(var y=this.getLevel(),x=0;x<i.length;x++){var I=i[x];this[I]=x<y?e:this.methodFactory(I,y,this.name)}if(this.log=this.debug,typeof console===t&&y<this.levels.SILENT)return"No console available for logging"}function p(y){return function(){typeof console!==t&&(f.call(this),this[y].apply(this,arguments))}}function g(y,x,I){return d(y)||p.apply(this,arguments)}function v(y,x){var I=this,b,T,R,P="loglevel";typeof y=="string"?P+=":"+y:typeof y=="symbol"&&(P=void 0);function B(U){var Z=(i[U]||"silent").toUpperCase();if(!(typeof window===t||!P)){try{window.localStorage[P]=Z;return}catch{}try{window.document.cookie=encodeURIComponent(P)+"="+Z+";"}catch{}}}function _(){var U;if(!(typeof window===t||!P)){try{U=window.localStorage[P]}catch{}if(typeof U===t)try{var Z=window.document.cookie,q=encodeURIComponent(P),ie=Z.indexOf(q+"=");ie!==-1&&(U=/^([^;]+)/.exec(Z.slice(ie+q.length+1))[1])}catch{}return I.levels[U]===void 0&&(U=void 0),U}}function M(){if(!(typeof window===t||!P)){try{window.localStorage.removeItem(P)}catch{}try{window.document.cookie=encodeURIComponent(P)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function H(U){var Z=U;if(typeof Z=="string"&&I.levels[Z.toUpperCase()]!==void 0&&(Z=I.levels[Z.toUpperCase()]),typeof Z=="number"&&Z>=0&&Z<=I.levels.SILENT)return Z;throw new TypeError("log.setLevel() called with invalid level: "+U)}I.name=y,I.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},I.methodFactory=x||g,I.getLevel=function(){return R??T??b},I.setLevel=function(U,Z){return R=H(U),Z!==!1&&B(R),f.call(I)},I.setDefaultLevel=function(U){T=H(U),_()||I.setLevel(U,!1)},I.resetLevel=function(){R=null,M(),f.call(I)},I.enableAll=function(U){I.setLevel(I.levels.TRACE,U)},I.disableAll=function(U){I.setLevel(I.levels.SILENT,U)},I.rebuild=function(){if(a!==I&&(b=H(a.getLevel())),f.call(I),a===I)for(var U in o)o[U].rebuild()},b=H(a?a.getLevel():"WARN");var V=_();V!=null&&(R=H(V)),f.call(I)}a=new v,a.getLogger=function(x){if(typeof x!="symbol"&&typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var I=o[x];return I||(I=o[x]=new v(x,a.methodFactory)),I};var C=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=C),a},a.getLoggers=function(){return o},a.default=a,a})}(u0)),u0.exports}var oU=iU();const sU=Dl(oU);function mr(n){return typeof n=="function"}function u2(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Iv=u2(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function VC(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var ag=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var l=Ou(a),u=l.next();!u.done;u=l.next()){var d=u.value;d.remove(this)}}catch(y){e={error:y}}finally{try{u&&!u.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else a.remove(this);var f=this.initialTeardown;if(mr(f))try{f()}catch(y){o=y instanceof Iv?y.errors:[y]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var g=Ou(p),v=g.next();!v.done;v=g.next()){var C=v.value;try{Dw(C)}catch(y){o=o??[],y instanceof Iv?o=lC(lC([],aC(o)),aC(y.errors)):o.push(y)}}}catch(y){r={error:y}}finally{try{v&&!v.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}}if(o)throw new Iv(o)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Dw(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&VC(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&VC(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),d2=ag.EMPTY;function f2(n){return n instanceof ag||n&&"closed"in n&&mr(n.remove)&&mr(n.add)&&mr(n.unsubscribe)}function Dw(n){mr(n)?n():n.unsubscribe()}var aU={Promise:void 0},lU={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,lC([n,e],aC(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function h2(n){lU.setTimeout(function(){throw n})}function GC(){}function d0(n){n()}var Yy=function(n){$u(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,f2(t)&&t.add(r)):r.destination=dU,r}return e.create=function(t,r,i){return new WC(t,r,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(ag),cU=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){ap(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){ap(r)}else ap(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){ap(t)}},n}(),WC=function(n){$u(e,n);function e(t,r,i){var o=n.call(this)||this,a;return mr(t)||!t?a={next:t??void 0,error:r??void 0,complete:i??void 0}:a=t,o.destination=new cU(a),o}return e}(Yy);function ap(n){h2(n)}function uU(n){throw n}var dU={closed:!0,next:GC,error:uU,complete:GC},qy=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function p2(n){return n}function fU(n){return n.length===0?p2:n.length===1?n[0]:function(t){return n.reduce(function(r,i){return i(r)},t)}}var Br=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,o=pU(e)?e:new WC(e,t,r);return d0(function(){var a=i,l=a.operator,u=a.source;o.add(l?l.call(o,u):u?i._subscribe(o):i._trySubscribe(o))}),o},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=Nw(t),new t(function(i,o){var a=new WC({next:function(l){try{e(l)}catch(u){o(u),a.unsubscribe()}},error:o,complete:i});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[qy]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fU(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=Nw(e),new e(function(r,i){var o;t.subscribe(function(a){return o=a},function(a){return i(a)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function Nw(n){var e;return(e=n??aU.Promise)!==null&&e!==void 0?e:Promise}function hU(n){return n&&mr(n.next)&&mr(n.error)&&mr(n.complete)}function pU(n){return n&&n instanceof Yy||hU(n)&&f2(n)}function gU(n){return mr(n==null?void 0:n.lift)}function za(n){return function(e){if(gU(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Tc(n,e,t,r,i){return new mU(n,e,t,r,i)}var mU=function(n){$u(e,n);function e(t,r,i,o,a,l){var u=n.call(this,t)||this;return u.onFinalize=a,u.shouldUnsubscribe=l,u._next=r?function(d){try{r(d)}catch(f){t.error(f)}}:n.prototype._next,u._error=o?function(d){try{o(d)}catch(f){t.error(f)}finally{this.unsubscribe()}}:n.prototype._error,u._complete=i?function(){try{i()}catch(d){t.error(d)}finally{this.unsubscribe()}}:n.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(Yy),vU=u2(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Pl=function(n){$u(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new Bw(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new vU},e.prototype.next=function(t){var r=this;d0(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=Ou(r.currentObservers),l=a.next();!l.done;l=a.next()){var u=l.value;u.next(t)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;d0(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;d0(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,o=i.hasError,a=i.isStopped,l=i.observers;return o||a?d2:(this.currentObservers=null,l.push(t),new ag(function(){r.currentObservers=null,VC(l,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,o=r.thrownError,a=r.isStopped;i?t.error(o):a&&t.complete()},e.prototype.asObservable=function(){var t=new Br;return t.source=this,t},e.create=function(t,r){return new Bw(t,r)},e}(Br),Bw=function(n){$u(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:d2},e}(Pl),g2=function(n){$u(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,i=t.thrownError,o=t._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(Pl);function CU(n){return n&&mr(n.schedule)}function yU(n){return n[n.length-1]}function m2(n){return CU(yU(n))?n.pop():void 0}var v2=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function C2(n){return mr(n==null?void 0:n.then)}function y2(n){return mr(n[qy])}function x2(n){return Symbol.asyncIterator&&mr(n==null?void 0:n[Symbol.asyncIterator])}function I2(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function xU(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var b2=xU();function A2(n){return mr(n==null?void 0:n[b2])}function w2(n){return CL(this,arguments,function(){var t,r,i,o;return tE(this,function(a){switch(a.label){case 0:t=n.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,yu(t.read())];case 3:return r=a.sent(),i=r.value,o=r.done,o?[4,yu(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,yu(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function S2(n){return mr(n==null?void 0:n.getReader)}function ed(n){if(n instanceof Br)return n;if(n!=null){if(y2(n))return IU(n);if(v2(n))return bU(n);if(C2(n))return AU(n);if(x2(n))return k2(n);if(A2(n))return wU(n);if(S2(n))return SU(n)}throw I2(n)}function IU(n){return new Br(function(e){var t=n[qy]();if(mr(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function bU(n){return new Br(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function AU(n){return new Br(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,h2)})}function wU(n){return new Br(function(e){var t,r;try{for(var i=Ou(n),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()})}function k2(n){return new Br(function(e){kU(n,e).catch(function(t){return e.error(t)})})}function SU(n){return k2(w2(n))}function kU(n,e){var t,r,i,o;return vL(this,void 0,void 0,function(){var a,l;return tE(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),t=yL(n),u.label=1;case 1:return[4,t.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=u.sent(),i={error:l},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(o=t.return)?[4,o.call(t)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Cc(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function E2(n,e){return e===void 0&&(e=0),za(function(t,r){t.subscribe(Tc(r,function(i){return Cc(r,n,function(){return r.next(i)},e)},function(){return Cc(r,n,function(){return r.complete()},e)},function(i){return Cc(r,n,function(){return r.error(i)},e)}))})}function T2(n,e){return e===void 0&&(e=0),za(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function EU(n,e){return ed(n).pipe(T2(e),E2(e))}function TU(n,e){return ed(n).pipe(T2(e),E2(e))}function RU(n,e){return new Br(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function _U(n,e){return new Br(function(t){var r;return Cc(t,e,function(){r=n[b2](),Cc(t,e,function(){var i,o,a;try{i=r.next(),o=i.value,a=i.done}catch(l){t.error(l);return}a?t.complete():t.next(o)},0,!0)}),function(){return mr(r==null?void 0:r.return)&&r.return()}})}function R2(n,e){if(!n)throw new Error("Iterable cannot be null");return new Br(function(t){Cc(t,e,function(){var r=n[Symbol.asyncIterator]();Cc(t,e,function(){r.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function PU(n,e){return R2(w2(n),e)}function DU(n,e){if(n!=null){if(y2(n))return EU(n,e);if(v2(n))return RU(n,e);if(C2(n))return TU(n,e);if(x2(n))return R2(n,e);if(A2(n))return _U(n,e);if(S2(n))return PU(n,e)}throw I2(n)}function NU(n,e){return e?DU(n,e):ed(n)}function mi(n,e){return za(function(t,r){var i=0;t.subscribe(Tc(r,function(o){r.next(n.call(e,o,i++))}))})}function BU(n,e,t,r,i,o,a,l){var u=[],d=0,f=0,p=!1,g=function(){p&&!u.length&&!d&&e.complete()},v=function(y){return d<r?C(y):u.push(y)},C=function(y){d++;var x=!1;ed(t(y,f++)).subscribe(Tc(e,function(I){e.next(I)},function(){x=!0},void 0,function(){if(x)try{d--;for(var I=function(){var b=u.shift();a||C(b)};u.length&&d<r;)I();g()}catch(b){e.error(b)}}))};return n.subscribe(Tc(e,v,function(){p=!0,g()})),function(){}}function _2(n,e,t){return t===void 0&&(t=1/0),mr(e)?_2(function(r,i){return mi(function(o,a){return e(r,o,i,a)})(ed(n(r,i)))},t):(typeof e=="number"&&(t=e),za(function(r,i){return BU(r,i,n,t)}))}function OU(n){return _2(p2,n)}function FU(){return OU(1)}function jC(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return FU()(NU(n,m2(n)))}function P2(n,e){return za(function(t,r){var i=0;t.subscribe(Tc(r,function(o){return n.call(e,o,i++)&&r.next(o)}))})}function MU(n,e,t,r,i){return function(o,a){var l=t,u=e,d=0;o.subscribe(Tc(a,function(f){var p=d++;u=l?n(u,f,p):(l=!0,f),a.next(u)},i))}}function LU(n){return za(function(e,t){try{e.subscribe(t)}finally{t.add(n)}})}function UU(n,e){return za(MU(n,e,arguments.length>=2,!0))}function es(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=m2(n);return za(function(r,i){(t?jC(n,r,t):jC(n,r)).subscribe(i)})}function Ow(n){return za(function(e,t){ed(n).subscribe(Tc(t,function(){return t.complete()},GC)),!t.closed&&e.subscribe(t)})}var VU=Object.defineProperty,GU=Object.defineProperties,WU=Object.getOwnPropertyDescriptors,L0=Object.getOwnPropertySymbols,D2=Object.prototype.hasOwnProperty,N2=Object.prototype.propertyIsEnumerable,Fw=(n,e,t)=>e in n?VU(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zC=(n,e)=>{for(var t in e||(e={}))D2.call(e,t)&&Fw(n,t,e[t]);if(L0)for(var t of L0(e))N2.call(e,t)&&Fw(n,t,e[t]);return n},jU=(n,e)=>GU(n,WU(e)),zU=(n,e)=>{var t={};for(var r in n)D2.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&L0)for(var r of L0(n))e.indexOf(r)<0&&N2.call(n,r)&&(t[r]=n[r]);return t},Ha=(n,e,t)=>new Promise((r,i)=>{var o=u=>{try{l(t.next(u))}catch(d){i(d)}},a=u=>{try{l(t.throw(u))}catch(d){i(d)}},l=u=>u.done?r(u.value):Promise.resolve(u.value).then(o,a);l((t=t.apply(n,e)).next())}),B2="lk";function Qy(n){return typeof n>"u"?!1:HU(n)||ZU(n)}function HU(n){var e;return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("track")&&typeof((e=n.publication)==null?void 0:e.track)<"u":!1}function ZU(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("publication")&&typeof n.publication<"u":!1}function XU(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&typeof n.publication>"u":!1}function O2(n){if(typeof n=="string"||typeof n=="number")return`${n}`;if(XU(n))return`${n.participant.identity}_${n.source}_placeholder`;if(Qy(n))return`${n.participant.identity}_${n.publication.source}_${n.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${n}`)}function KU(n){return n instanceof FC}function $U(n,e){return Ha(this,null,function*(){const{x:t,y:r}=yield nU(n,e,{placement:"top",middleware:[Q7(6),tU(),eU({padding:5})]});return{x:t,y:r}})}function JU(n,e){return!n.contains(e.target)}var YU=[Le.ConnectionStateChanged,Le.RoomMetadataChanged,Le.ActiveSpeakersChanged,Le.ConnectionQualityChanged,Le.ParticipantConnected,Le.ParticipantDisconnected,Le.ParticipantPermissionsChanged,Le.ParticipantMetadataChanged,Le.TrackMuted,Le.TrackUnmuted,Le.TrackPublished,Le.TrackUnpublished,Le.TrackStreamStateChanged,Le.TrackSubscriptionFailed,Le.TrackSubscriptionPermissionChanged,Le.TrackSubscriptionStatusChanged],qU=[...YU,Le.LocalTrackPublished,Le.LocalTrackUnpublished],QU=[We.ConnectionQualityChanged,We.IsSpeakingChanged,We.ParticipantMetadataChanged,We.ParticipantPermissionsChanged,We.TrackMuted,We.TrackUnmuted,We.TrackPublished,We.TrackUnpublished,We.TrackStreamStateChanged,We.TrackSubscriptionFailed,We.TrackSubscriptionPermissionChanged,We.TrackSubscriptionStatusChanged];[...QU,We.LocalTrackPublished,We.LocalTrackUnpublished];var vn=sU.getLogger("lk-components-js");vn.setDefaultLevel("WARN");function eV(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var tV=[],nV={showChat:!1,unreadMessages:0};function e1(n,...e){return new Br(r=>{const i=()=>{r.next(n)};return e.forEach(a=>{n.on(a,i)}),()=>{e.forEach(a=>{n.off(a,i)})}}).pipe(es(n))}function t1(n,e){return new Br(r=>{const i=(...a)=>{r.next(a)};return n.on(e,i),()=>{n.off(e,i)}})}function rV(n){return t1(n,Le.ConnectionStateChanged).pipe(mi(([e])=>e),es(n.state))}function iV(n,e,t=!0){var r;const i=()=>Ha(this,null,function*(){try{const l=yield B0.getLocalDevices(n,t);o.next(l)}catch(l){e==null||e(l)}}),o=new Pl,a=o.pipe(LU(()=>{var l;(l=navigator==null?void 0:navigator.mediaDevices)==null||l.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return jC(B0.getLocalDevices(n,t).catch(l=>e==null?void 0:e(l)),a)}function oV(n){return t1(n,Le.DataReceived)}function sV(n){return e1(n,Le.AudioPlaybackStatusChanged).pipe(mi(t=>({canPlayAudio:t.canPlaybackAudio})))}function aV(n){return e1(n,Le.VideoPlaybackStatusChanged).pipe(mi(t=>({canPlayVideo:t.canPlaybackVideo})))}function lV(n,e){return t1(n,Le.ActiveDeviceChanged).pipe(P2(([t])=>t===e),mi(([t,r])=>(vn.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:t,deviceId:r}),r)),es(n.getActiveDevice(e)))}function go(n){return`${B2}-${n}`}function cV(n){const e=HC(n),t=r1(n.participant).pipe(mi(()=>HC(n)),es(e));return{className:go(n.source===Ne.Source.Camera||n.source===Ne.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:t}}function HC(n){if(Qy(n))return n.publication;{const{source:e,name:t,participant:r}=n;if(e&&t)return r.getTracks().find(i=>i.source===e&&i.trackName===t);if(t)return r.getTrackByName(t);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function n1(n,...e){return new Br(r=>{const i=()=>{r.next(n)};return e.forEach(a=>{n.on(a,i)}),()=>{e.forEach(a=>{n.off(a,i)})}}).pipe(es(n))}function r1(n){return n1(n,We.TrackMuted,We.TrackUnmuted,We.ParticipantPermissionsChanged,We.TrackPublished,We.TrackUnpublished,We.LocalTrackPublished,We.LocalTrackUnpublished,We.MediaDevicesError,We.TrackSubscriptionStatusChanged).pipe(mi(t=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=t,a=t.getTrack(Ne.Source.Microphone),l=t.getTrack(Ne.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:l,microphoneTrack:a,participant:t}}))}function uV(n){return n1(n,We.ParticipantMetadataChanged).pipe(mi(({name:t,identity:r,metadata:i})=>({name:t,identity:r,metadata:i})),es({name:n.name,identity:n.identity,metadata:n.metadata}))}function dV(n){return i1(n,We.ConnectionQualityChanged).pipe(mi(([t])=>t),es(n.connectionQuality))}function i1(n,e){return new Br(r=>{const i=(...a)=>{r.next(a)};return n.on(e,i),()=>{n.off(e,i)}})}function F2(n){var e,t,r,i;return n1(n.participant,We.TrackMuted,We.TrackUnmuted,We.TrackSubscribed,We.TrackUnsubscribed,We.LocalTrackPublished,We.LocalTrackUnpublished).pipe(mi(o=>{var a,l;const u=(a=n.publication)!=null?a:o.getTrack(n.source);return(l=u==null?void 0:u.isMuted)!=null?l:!0}),es((i=(r=(e=n.publication)==null?void 0:e.isMuted)!=null?r:(t=n.participant.getTrack(n.source))==null?void 0:t.isMuted)!=null?i:!0))}function fV(n){return i1(n,We.IsSpeakingChanged).pipe(mi(([e])=>e))}function hV(n,e={}){var t;let r;const i=new Br(u=>(r=u,()=>l.unsubscribe())).pipe(es(Array.from(n.participants.values()))),o=(t=e.additionalRoomEvents)!=null?t:qU,a=Array.from(new Set([Le.ParticipantConnected,Le.ParticipantDisconnected,Le.ConnectionStateChanged,...o])),l=e1(n,...a).subscribe(u=>r==null?void 0:r.next(Array.from(u.participants.values())));return n.participants.size>0&&(r==null||r.next(Array.from(n.participants.values()))),i}function pV(n){return i1(n,We.ParticipantPermissionsChanged).pipe(mi(()=>n.permissions),es(n.permissions))}function gV(n,e,t){const{localParticipant:r}=e,i=(d,f)=>{let p=!1;switch(d){case Ne.Source.Camera:p=f.isCameraEnabled;break;case Ne.Source.Microphone:p=f.isMicrophoneEnabled;break;case Ne.Source.ScreenShare:p=f.isScreenShareEnabled;break}return p},o=r1(r).pipe(mi(d=>i(n,d.participant)),es(i(n,r))),a=new Pl,l=(d,f)=>Ha(this,null,function*(){try{switch(f??(f=t),a.next(!0),n){case Ne.Source.Camera:yield r.setCameraEnabled(d??!r.isCameraEnabled,f);break;case Ne.Source.Microphone:yield r.setMicrophoneEnabled(d??!r.isMicrophoneEnabled,f);break;case Ne.Source.ScreenShare:yield r.setScreenShareEnabled(d??!r.isScreenShareEnabled,f);break;default:break}}finally{a.next(!1)}});return{className:go("button"),toggle:l,enabledObserver:o,pendingObserver:a.asObservable()}}function mV(){let n=!1;const e=new Pl,t=new Pl,r=o=>{t.next(!0),n=o??!n,e.next(n),t.next(!1)};return{className:go("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:t.asObservable()}}function vV(n,e,t){const r=new g2(void 0),i=e?lV(e,n):r.asObservable(),o=(l,...u)=>Ha(this,[l,...u],function*(d,f={}){var p,g,v;if(e){vn.debug(`Switching active device of kind "${n}" with id ${d}.`),yield e.switchActiveDevice(n,d,f.exact);const C=(p=e.getActiveDevice(n))!=null?p:d;C!==d&&d!=="default"&&vn.info(`We tried to select the device with id (${d}), but the browser decided to select the device with id (${C}) instead.`);let y;n==="audioinput"?y=(g=e.localParticipant.getTrack(Ne.Source.Microphone))==null?void 0:g.track:n==="videoinput"&&(y=(v=e.localParticipant.getTrack(Ne.Source.Camera))==null?void 0:v.track);const x=d==="default"&&!y||d==="default"&&(y==null?void 0:y.mediaStreamTrack.label.startsWith("Default"));r.next(x?d:C)}else if(t){yield t.setDeviceId(f.exact?{exact:d}:d);const C=yield t.getDeviceId();r.next(d==="default"&&t.mediaStreamTrack.label.startsWith("Default")?d:C)}else r.value!==d&&(vn.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(d))});return{className:go("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function CV(n){const e=r=>{n.disconnect(r)};return{className:go("disconnect-button"),disconnect:e}}function yV(n){const e=go("connection-quality"),t=dV(n);return{className:e,connectionQualityObserver:t}}function xV(n){let e="track-muted-indicator-camera";switch(n.source){case Ne.Source.Camera:e="track-muted-indicator-camera";break;case Ne.Source.Microphone:e="track-muted-indicator-microphone";break}const t=go(e),r=F2(n);return{className:t,mediaMutedObserver:r}}function IV(n){return{className:"lk-participant-name",infoObserver:uV(n)}}function bV(){return{className:go("participant-tile")}}var AV={CHAT:"lk-chat-topic"};function M2(n,e,t){return Ha(this,arguments,function*(r,i,o,a={}){const{kind:l,destination:u}=a;yield r.publishData(i,l??hr.RELIABLE,{destination:u,topic:o})})}function wV(n,e,t){const r=oV(n).pipe(P2(([,,,l])=>e===void 0||l===e),mi(([l,u,,d])=>({payload:l,topic:d,from:u})));let i;const o=new Br(l=>{i=l});return{messageObservable:r,isSendingObservable:o,send:(l,...u)=>Ha(this,[l,...u],function*(d,f={}){i.next(!0);try{yield M2(n.localParticipant,d,e,f)}finally{i.next(!1)}})}}var SV=new TextEncoder,kV=new TextDecoder,lp=new Map,EV=n=>SV.encode(JSON.stringify({message:n.message,timestamp:n.timestamp})),TV=n=>JSON.parse(kV.decode(n));function RV(n,e){var t,r;const i=new Pl,{messageDecoder:o,messageEncoder:a,channelTopic:l}=e??{},u=l??AV.CHAT;let d=!1;lp.has(n)||(d=!0);const f=(t=lp.get(n))!=null?t:new Map,p=(r=f.get(u))!=null?r:new Pl;if(f.set(u,p),lp.set(n,f),d){const{messageObservable:b}=wV(n,u);b.pipe(Ow(i)).subscribe(p)}const g=o??TV,v=p.pipe(mi(b=>{const T=g(b.payload);return jU(zC({},T),{from:b.from})}),UU((b,T)=>[...b,T],[]),Ow(i)),C=new g2(!1),y=a??EV,x=b=>Ha(this,null,function*(){const T=Date.now(),R=y({message:b,timestamp:T});C.next(!0);try{yield M2(n.localParticipant,R,u,{kind:hr.RELIABLE}),p.next({payload:R,topic:u,from:n.localParticipant})}finally{C.next(!1)}});function I(){i.next(),i.complete(),lp.clear()}return n.once(Le.Disconnected,I),{messageObservable:v,isSendingObservable:C,send:x}}function _V(){const n=t=>Ha(this,null,function*(){vn.info("Start Audio for room: ",t),yield t.startAudio()});return{className:go("start-audio-button"),roomAudioPlaybackAllowedObservable:sV,handleStartAudioPlayback:n}}function PV(){const n=t=>Ha(this,null,function*(){vn.info("Start Video for room: ",t),yield t.startVideo()});return{className:go("start-audio-button"),roomVideoPlaybackAllowedObservable:aV,handleStartVideoPlayback:n}}function DV(){return{className:[go("button"),go("chat-toggle")].join(" ")}}function NV(){return{className:"lk-room-container"}}function BV(n,e){if(typeof localStorage>"u"){vn.error("Local storage is not available.");return}try{localStorage.setItem(n,JSON.stringify(e))}catch(t){vn.error(`Error setting item to local storage: ${t}`)}}function OV(n){if(typeof localStorage>"u"){vn.error("Local storage is not available.");return}try{const e=localStorage.getItem(n);if(!e){vn.warn(`Item with key ${n} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){vn.error(`Error getting item from local storage: ${e}`);return}}function FV(n){return{load:()=>OV(n),save:e=>BV(n,e)}}var MV=`${B2}-user-choices`,sc={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:LV,save:UV}=FV(MV);function VV(n,e=!1){if(e===!0)return;const t=n,{e2ee:r,sharedPassphrase:i}=t,o=zU(t,["e2ee","sharedPassphrase"]);UV(o)}function GV(n,e=!1){var t,r,i,o,a,l,u;const d={videoEnabled:(t=n==null?void 0:n.videoEnabled)!=null?t:sc.videoEnabled,audioEnabled:(r=n==null?void 0:n.audioEnabled)!=null?r:sc.audioEnabled,videoDeviceId:(i=n==null?void 0:n.videoDeviceId)!=null?i:sc.videoDeviceId,audioDeviceId:(o=n==null?void 0:n.audioDeviceId)!=null?o:sc.audioDeviceId,username:(a=n==null?void 0:n.username)!=null?a:sc.username,e2ee:(l=n==null?void 0:n.e2ee)!=null?l:sc.e2ee,sharedPassphrase:(u=n==null?void 0:n.sharedPassphrase)!=null?u:sc.sharedPassphrase};if(e)return d;{const f=LV();return zC(zC({},d),f??{})}}function L2(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=L2(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function WV(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=L2(n))&&(r&&(r+=" "),r+=e);return r}var jV=Object.defineProperty,zV=Object.defineProperties,HV=Object.getOwnPropertyDescriptors,U0=Object.getOwnPropertySymbols,U2=Object.prototype.hasOwnProperty,V2=Object.prototype.propertyIsEnumerable,Mw=(n,e,t)=>e in n?jV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Dt=(n,e)=>{for(var t in e||(e={}))U2.call(e,t)&&Mw(n,t,e[t]);if(U0)for(var t of U0(e))V2.call(e,t)&&Mw(n,t,e[t]);return n},Yr=(n,e)=>zV(n,HV(e)),Or=(n,e)=>{var t={};for(var r in n)U2.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&U0)for(var r of U0(n))e.indexOf(r)<0&&V2.call(n,r)&&(t[r]=n[r]);return t},G2=(n,e,t)=>new Promise((r,i)=>{var o=u=>{try{l(t.next(u))}catch(d){i(d)}},a=u=>{try{l(t.throw(u))}catch(d){i(d)}},l=u=>u.done?r(u.value):Promise.resolve(u.value).then(o,a);l((t=t.apply(n,e)).next())});function Qi(n,e){const[t,r]=N.useState(e);return N.useEffect(()=>{if(typeof window>"u"||!n)return;const i=n.subscribe(r);return()=>i.unsubscribe()},[n]),t}function ZV(n){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[t,r]=N.useState(e(n));function i(){r(e(n))}return N.useEffect(()=>{const o=window.matchMedia(n);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[n]),t}function XV(n,e){if(e.msg==="show_chat")return Yr(Dt({},n),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Yr(Dt({},n),{showChat:!1});if(e.msg==="toggle_chat"){const t=Yr(Dt({},n),{showChat:!n.showChat});return t.showChat===!0&&(t.unreadMessages=0),t}else return e.msg==="unread_msg"?Yr(Dt({},n),{unreadMessages:e.count}):Dt({},n)}function KV(n,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:Dt({},n)}var o1=N.createContext(void 0);function $V(){const n=N.useContext(o1);if(!n)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return n}function JV(n){const[e,t]=N.useReducer(KV,tV),[r,i]=N.useReducer(XV,nV);return n??{pin:{dispatch:t,state:e},widget:{dispatch:i,state:r}}}function W2(){return N.useContext(o1)}var YV=N.createContext(void 0);function Hf(){return N.useContext(YV)}var s1=N.createContext(void 0);function lg(){return N.useContext(s1)}function Oc(n){var e;const t=lg(),r=Hf(),i=(e=n??t)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var a1=N.createContext(void 0);function cg(){const n=N.useContext(a1);if(!n)throw Error("tried to access room context outside of livekit room component");return n}function ug(){return N.useContext(a1)}function Zf(n){const e=ug(),t=n??e;if(!t)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return t}var qV=N.createContext(void 0);function QV(...n){return(...e)=>{for(const t of n)typeof t=="function"&&t(...e)}}function Ll(...n){const e=Dt({},n[0]);for(let t=1;t<n.length;t++){const r=n[t];for(const i in r){const o=e[i],a=r[i];typeof o=="function"&&typeof a=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=QV(o,a):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof a=="string"?e[i]=WV(o,a):e[i]=a!==void 0?a:o}}return e}function eG(n={}){const e=Oc(n.participant),{className:t,connectionQualityObserver:r}=N.useMemo(()=>yV(e),[e]),i=Qi(r,uo.Unknown);return{className:t,quality:i}}function tG(n){const e=Zf(n),t=N.useMemo(()=>rV(e),[e]);return Qi(t,e.state)}function nG(n){const e=cg(),t=tG(e);return{buttonProps:N.useMemo(()=>{const{className:i,disconnect:o}=CV(e);return Ll(n,{className:i,onClick:()=>{var l;return o((l=n.stopTracks)!=null?l:!0)},disabled:t===pn.Disconnected})},[e,n,t])}}function rG(n){if(n.publication instanceof Sf){const e=n.publication.track;if(e){const{facingMode:t}=l7(e);return t}}return"undefined"}function Lw(n,e={}){var t,r;const i=typeof n=="string"?e.participant:n.participant,o=Oc(i),a=typeof n=="string"?{participant:o,source:n}:n,[l,u]=N.useState(!!((t=a.publication)!=null&&t.isMuted||(r=o.getTrack(a.source))!=null&&r.isMuted));return N.useEffect(()=>{const d=F2(a).subscribe(u);return()=>d.unsubscribe()},[O2(a)]),l}function iG(n){const e=Oc(n),t=N.useMemo(()=>fV(e),[e]);return Qi(t,e.isSpeaking)}var oG={connect:!0,audio:!1,video:!1};function sG(n){const e=Dt(Dt({},oG),n),{token:t,serverUrl:r,options:i,room:o,connectOptions:a,connect:l,audio:u,video:d,screen:f,onConnected:p,onDisconnected:g,onError:v,onMediaDeviceFailure:C,onEncryptionError:y,simulateParticipants:x}=e,I=Or(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&vn.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[b,T]=N.useState();N.useEffect(()=>{T(o??new B0(i))},[o]);const R=N.useMemo(()=>{const{className:P}=NV();return Ll(I,{className:P})},[I]);return N.useEffect(()=>{if(!b)return;const P=()=>{const M=b.localParticipant;vn.debug("trying to publish local tracks"),Promise.all([M.setMicrophoneEnabled(!!u,typeof u!="boolean"?u:void 0),M.setCameraEnabled(!!d,typeof d!="boolean"?d:void 0),M.setScreenShareEnabled(!!f,typeof f!="boolean"?f:void 0)]).catch(H=>{vn.warn(H),v==null||v(H)})},B=M=>{const H=Af.getFailure(M);C==null||C(H)},_=M=>{y==null||y(M)};return b.on(Le.SignalConnected,P).on(Le.MediaDevicesError,B).on(Le.EncryptionError,_),()=>{b.off(Le.SignalConnected,P).off(Le.MediaDevicesError,B).off(Le.EncryptionError,_)}},[b,u,d,f,v,y,C]),N.useEffect(()=>{if(b){if(x){b.simulateParticipants({participants:{count:x},publish:{audio:!0,useRealTracks:!0}});return}if(!t){vn.debug("no token yet");return}if(!r){vn.warn("no livekit url provided"),v==null||v(Error("no livekit url provided"));return}l?(vn.debug("connecting"),b.connect(r,t,a).catch(P=>{vn.warn(P),v==null||v(P)})):(vn.debug("disconnecting because connect is false"),b.disconnect())}},[l,t,JSON.stringify(a),b,v,r,x]),N.useEffect(()=>{if(!b)return;const P=B=>{switch(B){case pn.Disconnected:g&&g();break;case pn.Connected:p&&p();break}};return b.on(Le.ConnectionStateChanged,P),()=>{b.off(Le.ConnectionStateChanged,P)}},[t,p,g,b]),N.useEffect(()=>{if(b)return()=>{vn.info("disconnecting on onmount"),b.disconnect()}},[b]),{room:b,htmlProps:R}}function aG(n={}){const e=Zf(n.room),[t,r]=N.useState(e.localParticipant),[i,o]=N.useState(t.isMicrophoneEnabled),[a,l]=N.useState(t.isMicrophoneEnabled),[u,d]=N.useState(t.lastMicrophoneError),[f,p]=N.useState(t.lastCameraError),[g,v]=N.useState(t.isMicrophoneEnabled),[C,y]=N.useState(void 0),[x,I]=N.useState(void 0),b=T=>{l(T.isCameraEnabled),o(T.isMicrophoneEnabled),v(T.isScreenShareEnabled),I(T.cameraTrack),y(T.microphoneTrack),d(T.participant.lastMicrophoneError),p(T.participant.lastCameraError),r(T.participant)};return N.useEffect(()=>{const T=r1(t).subscribe(b);return()=>T.unsubscribe()},[t]),{isMicrophoneEnabled:i,isScreenShareEnabled:g,isCameraEnabled:a,microphoneTrack:C,cameraTrack:x,lastMicrophoneError:u,lastCameraError:f,localParticipant:t}}function lG(){const n=cg(),e=N.useMemo(()=>pV(n.localParticipant),[n]);return Qi(e,n.localParticipant.permissions)}function cG({kind:n,room:e,track:t,requestPermissions:r,onError:i}){const o=ug(),a=N.useMemo(()=>iV(n,i,r),[n,r,i]),l=Qi(a,[]),[u,d]=N.useState(""),{className:f,activeDeviceObservable:p,setActiveMediaDevice:g}=N.useMemo(()=>vV(n,e??o,t),[n,e,o,t]);return N.useEffect(()=>{const v=p.subscribe(C=>{vn.info("setCurrentDeviceId",C),C&&d(C)});return()=>{v==null||v.unsubscribe()}},[p]),{devices:l,className:f,activeDeviceId:u,setActiveMediaDevice:g}}function uG(n){return n!==void 0}function td(...n){return Ll(...n.filter(uG))}function j2(n,e,t){return N.Children.map(n,r=>N.isValidElement(r)&&N.Children.only(n)?N.cloneElement(r,Yr(Dt({},e),{key:t})):r)}function z2(n,e={}){var t;const[r,i]=N.useState(HC(n)),[o,a]=N.useState(r==null?void 0:r.isMuted),[l,u]=N.useState(r==null?void 0:r.isSubscribed),[d,f]=N.useState(r==null?void 0:r.track),[p,g]=N.useState("landscape"),v=N.useRef(),{className:C,trackObserver:y}=N.useMemo(()=>cV(n),[(t=n.participant.sid)!=null?t:n.participant.identity,n.source,Qy(n)&&n.publication.trackSid]);return N.useEffect(()=>{const x=y.subscribe(I=>{vn.debug("update track",I),i(I),a(I==null?void 0:I.isMuted),u(I==null?void 0:I.isSubscribed),f(I==null?void 0:I.track)});return()=>x==null?void 0:x.unsubscribe()},[y]),N.useEffect(()=>{var x,I;return d&&(v.current&&d.detach(v.current),(x=e.element)!=null&&x.current&&!(KU(n.participant)&&(d==null?void 0:d.kind)==="audio")&&d.attach(e.element.current)),v.current=(I=e.element)==null?void 0:I.current,()=>{v.current&&(d==null||d.detach(v.current))}},[d,e.element]),N.useEffect(()=>{var x,I;if(typeof((x=r==null?void 0:r.dimensions)==null?void 0:x.width)=="number"&&typeof((I=r==null?void 0:r.dimensions)==null?void 0:I.height)=="number"){const b=r.dimensions.width>r.dimensions.height?"landscape":"portrait";g(b)}},[r]),{publication:r,isMuted:o,isSubscribed:l,track:d,elementProps:td(e.props,Dt({className:C,"data-lk-local-participant":n.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":p}))}}function dG({trackRef:n,participant:e,source:t,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:a}){const l=Hf(),u=Oc(e),d=N.useMemo(()=>{var y,x,I,b,T,R;const P=(x=(y=n==null?void 0:n.source)!=null?y:l==null?void 0:l.source)!=null?x:t;if(P===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(b=(I=n==null?void 0:n.participant)!=null?I:l==null?void 0:l.participant)!=null?b:u,publication:(R=(T=n==null?void 0:n.publication)!=null?T:l==null?void 0:l.publication)!=null?R:r,source:P}},[n==null?void 0:n.participant,n==null?void 0:n.source,n==null?void 0:n.publication,l==null?void 0:l.participant,l==null?void 0:l.source,l==null?void 0:l.publication,u,t,r]),f=N.useMemo(()=>{const{className:y}=bV();return Ll(a,{className:y,onClick:x=>{var I,b;if((I=a.onClick)==null||I.call(a,x),typeof i=="function"){const T=(b=d.publication)!=null?b:d.participant.getTrack(d.source);i({participant:d.participant,track:T})}}})},[a,i,d.publication,d.source,d.participant]),p=Lw(Ne.Source.Camera,{participant:d.participant}),g=Lw(Ne.Source.Microphone,{participant:d.participant}),v=iG(d.participant),C=rG(d);return{elementProps:Dt({"data-lk-audio-muted":g,"data-lk-video-muted":p,"data-lk-speaking":o===!0?!1:v,"data-lk-local-participant":d.participant.isLocal,"data-lk-source":d.source,"data-lk-facing-mode":C},f)}}function fG(n={}){const e=Zf(n.room),[t,r]=N.useState([]);return N.useEffect(()=>{const i=hV(e,{additionalRoomEvents:n.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(n.updateOnlyOn)]),t}function hG(n={}){const e=fG(n),{localParticipant:t}=aG(n);return[t,...e]}function pG({room:n,props:e}){const t=Zf(n),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=N.useMemo(()=>_V(),[]),a=N.useMemo(()=>i(t),[t,i]),{canPlayAudio:l}=Qi(a,{canPlayAudio:t.canPlaybackAudio});return{mergedProps:N.useMemo(()=>Ll(e,{className:r,onClick:()=>{o(t)},style:{display:l?"none":"block"}}),[e,r,l,o,t]),canPlayAudio:l}}function gG({room:n,props:e}){const t=Zf(n),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=N.useMemo(()=>PV(),[]),a=N.useMemo(()=>i(t),[t,i]),{canPlayVideo:l}=Qi(a,{canPlayVideo:t.canPlaybackVideo});return{mergedProps:N.useMemo(()=>Ll(e,{className:r,onClick:()=>{o(t)},style:{display:l?"none":"block"}}),[e,r,l,o,t]),canPlayVideo:l}}function mG({props:n}){const{dispatch:e,state:t}=$V().widget,{className:r}=N.useMemo(()=>DV(),[]);return{mergedProps:N.useMemo(()=>Ll(n,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":t!=null&&t.showChat?"true":"false","data-lk-unread-msgs":t?t.unreadMessages<10?t.unreadMessages.toFixed(0):"9+":"0"}),[n,r,e,t])}}function vG(n,e={}){var t,r,i,o;let a=Hf();const l=(r=(t=lg())!=null?t:e.participant)!=null?r:a==null?void 0:a.participant;if(typeof n=="string"){if(!l)throw Error("Participant missing, either provide it via context or pass it in directly");a={participant:l,source:n}}else if(n)a=n;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:u,mediaMutedObserver:d}=N.useMemo(()=>xV(a),[O2(a)]);return{isMuted:Qi(d,!!((i=a.publication)!=null&&i.isMuted||(o=a.participant.getTrack(a.source))!=null&&o.isMuted)),className:u}}function CG(n){var e=n,{source:t,onChange:r,initialState:i,captureOptions:o}=e,a=Or(e,["source","onChange","initialState","captureOptions"]),l;const u=ug(),d=(l=u==null?void 0:u.localParticipant)==null?void 0:l.getTrack(t),{toggle:f,className:p,pendingObserver:g,enabledObserver:v}=N.useMemo(()=>u?gV(t,u,o):mV(),[u,t,JSON.stringify(o)]),C=Qi(g,!1),y=Qi(v,i??!!(d!=null&&d.isEnabled));N.useEffect(()=>{r==null||r(y)},[y,r]),N.useEffect(()=>{i!==void 0&&(vn.debug("forcing initial toggle state",t,i),f(i))},[]);const x=N.useMemo(()=>Ll(a,{className:p}),[a,p]),I=N.useCallback(b=>{var T;f(),(T=a.onClick)==null||T.call(a,b)},[a,f]);return{toggle:f,enabled:y,pending:C,track:d,buttonProps:Yr(Dt({},x),{"aria-pressed":y,"data-lk-source":t,"data-lk-enabled":y,disabled:C,onClick:I})}}function yG(n,e={}){return z2(n,e)}function xG(n){const e=cg(),[t,r]=N.useState(),i=Qi(t==null?void 0:t.isSendingObservable,!1),o=Qi(t==null?void 0:t.messageObservable,[]);return N.useEffect(()=>{const a=RV(e,n);r(a)},[e,n]),{send:t==null?void 0:t.send,chatMessages:o,isSending:i}}function IG(n={}){var e;const[t,r]=N.useState(GV(n.defaults,(e=n.preventLoad)!=null?e:!1)),i=N.useCallback(d=>{r(f=>Yr(Dt({},f),{audioEnabled:d}))},[]),o=N.useCallback(d=>{r(f=>Yr(Dt({},f),{videoEnabled:d}))},[]),a=N.useCallback(d=>{r(f=>Yr(Dt({},f),{audioDeviceId:d}))},[]),l=N.useCallback(d=>{r(f=>Yr(Dt({},f),{videoDeviceId:d}))},[]),u=N.useCallback(d=>{r(f=>Yr(Dt({},f),{username:d}))},[]);return N.useEffect(()=>{var d;VV(t,(d=n.preventSave)!=null?d:!1)},[t,n.preventSave]),{userChoices:t,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:a,saveVideoInputDeviceId:l,saveUsername:u}}function bG(n){const{mergedProps:e}=mG({props:n});return N.createElement("button",Dt({},e),n.children)}function AG(n){const{buttonProps:e}=nG(n);return N.createElement("button",Dt({},e),n.children)}var wG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),N.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),N.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),SG=wG,kG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),N.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),EG=kG,TG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},n),N.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),N.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),RG=TG,_G=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},n),N.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),N.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),PG=_G,DG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),N.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),N.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),NG=DG,BG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),N.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),N.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),OG=BG,FG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},n),N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),MG=FG,LG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},n),N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("g",{opacity:.25},N.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),UG=LG,VG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},n),N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("g",{opacity:.25},N.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),N.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),GG=VG,WG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},n),N.createElement("g",{opacity:.25},N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),N.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),jG=WG,zG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},n),N.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),N.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),HG=zG,ZG=n=>N.createElement("svg",Dt({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},n),N.createElement("g",{fill:"currentColor"},N.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),N.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),XG=ZG;function bv(n){var e=n,{kind:t,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:a,exactMatch:l,track:u,requestPermissions:d,onError:f}=e,p=Or(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const g=ug(),v=N.useCallback(P=>{g&&g.emit(Le.MediaDevicesError,P),f==null||f(P)},[g,f]),{devices:C,activeDeviceId:y,setActiveMediaDevice:x,className:I}=cG({kind:t,room:g,track:u,requestPermissions:d,onError:v});N.useEffect(()=>{r!==void 0&&x(r)},[x]),N.useEffect(()=>{typeof o=="function"&&o(C)},[o,C]),N.useEffect(()=>{y&&y!==""&&(i==null||i(y))},[y]);const b=P=>G2(this,null,function*(){try{yield x(P,{exact:l})}catch(B){if(B instanceof Error)a==null||a(B);else throw B}}),T=N.useMemo(()=>td(p,{className:I},{className:"lk-list"}),[I,p]);function R(P,B,_){return P===B||_===0&&B==="default"}return N.createElement("ul",Dt({},T),C.map((P,B)=>N.createElement("li",{key:P.deviceId,id:P.deviceId,"data-lk-active":R(P.deviceId,y,B),"aria-selected":R(P.deviceId,y,B),role:"option"},N.createElement("button",{className:"lk-button",onClick:()=>b(P.deviceId)},P.label))))}function H2(n,e){switch(n){case Ne.Source.Microphone:return e?N.createElement(OG,null):N.createElement(NG,null);case Ne.Source.Camera:return e?N.createElement(EG,null):N.createElement(SG,null);case Ne.Source.ScreenShare:return e?N.createElement(XG,null):N.createElement(HG,null);default:return}}function KG(n){switch(n){case uo.Excellent:return N.createElement(MG,null);case uo.Good:return N.createElement(UG,null);case uo.Poor:return N.createElement(GG,null);default:return N.createElement(jG,null)}}function Av(n){var e=n,{showIcon:t}=e,r=Or(e,["showIcon"]);const{buttonProps:i,enabled:o}=CG(r);return N.createElement("button",Dt({},i),(t??!0)&&H2(r.source,o),r.children)}function $G(n){var e;const{className:t,quality:r}=eG(n),i=N.useMemo(()=>Yr(Dt({},td(n,{className:t})),{"data-lk-quality":r}),[r,n,t]);return N.createElement("div",Dt({},i),(e=n.children)!=null?e:KG(r))}function JG(n){var e=n,{participant:t}=e,r=Or(e,["participant"]);const i=Oc(t),{className:o,infoObserver:a}=N.useMemo(()=>IV(i),[i]),{identity:l,name:u}=Qi(a,{name:i.name,identity:i.identity,metadata:i.metadata}),d=N.useMemo(()=>td(r,{className:o,"data-lk-participant-name":u}),[r,o,u]);return N.createElement("span",Dt({},d),u!==""?u:l,r.children)}function YG(n){var e=n,{source:t,participant:r,trackRef:i,show:o="always"}=e,a=Or(e,["source","participant","trackRef","show"]),l,u;const{className:d,isMuted:f}=vG(i??t,{participant:r}),p=o==="always"||o==="muted"&&f||o==="unmuted"&&!f,g=N.useMemo(()=>td(a,{className:d}),[d,a]);return p?N.createElement("div",Yr(Dt({},g),{"data-lk-muted":f}),(u=a.children)!=null?u:H2((l=i==null?void 0:i.source)!=null?l:t,!f)):null}function qG(n){var e=n,{trackRef:t,onSubscriptionStatusChanged:r,volume:i,source:o,name:a,publication:l,participant:u}=e,d=Or(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),f,p,g,v,C,y,x,I,b,T;const R=Hf(),P=(v=(g=(f=t==null?void 0:t.publication)==null?void 0:f.trackName)!=null?g:(p=R==null?void 0:R.publication)==null?void 0:p.trackName)!=null?v:a,B=(y=(C=t==null?void 0:t.source)!=null?C:R==null?void 0:R.source)!=null?y:o,_=(I=(x=t==null?void 0:t.publication)!=null?x:R==null?void 0:R.publication)!=null?I:l,M=(T=(b=t==null?void 0:t.participant)!=null?b:R==null?void 0:R.participant)!=null?T:u;if(B===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const H=N.useRef(null),V=Oc(M),{elementProps:U,isSubscribed:Z,track:q,publication:ie}=z2({source:B,name:P,participant:V,publication:_},{element:H,props:d});return N.useEffect(()=>{r==null||r(!!Z)},[Z,r]),N.useEffect(()=>{q===void 0||i===void 0||(q instanceof vc?q.setVolume(i):vn.warn("Volume can only be set on remote audio tracks."))},[i,q]),N.useEffect(()=>{ie===void 0||d.muted===void 0||(ie instanceof Xy?ie.setEnabled(!d.muted):vn.warn("Can only call setEnabled on remote track publications."))},[d.muted,ie,q]),N.createElement("audio",Dt({ref:H},U))}function QG(n){const e=!!lg();return n.participant&&!e?N.createElement(s1.Provider,{value:n.participant},n.children):N.createElement(N.Fragment,null,n.children)}function eW({value:n,onPinChange:e,onWidgetChange:t,children:r}){const i=JV(n);return N.useEffect(()=>{vn.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),N.useEffect(()=>{vn.debug("Widget Updated",{widgetState:i.widget.state}),t&&i.widget.state&&t(i.widget.state)},[t,i.widget.state]),N.createElement(o1.Provider,{value:i},r)}function tW(n){const{room:e,htmlProps:t}=sG(n);return N.createElement("div",Dt({},t),e&&N.createElement(a1.Provider,{value:e},N.createElement(qV.Provider,{value:n.featureFlags},n.children)))}function nW(n){var e=n,{participant:t,trackRef:r}=e,i=Or(e,["participant","trackRef"]),o,a;const[l,u]=N.useState([]),d=200,f=90,p=6,g=4,v=50,C=7,y=(o=lg())!=null?o:t;let x=(a=Hf())!=null?a:r;if(!x){if(!y)throw Error("Participant missing, provide it directly or within a context");x={participant:y,source:Ne.Source.Microphone}}const{track:I}=yG(x);return N.useEffect(()=>{if(!I||!(I instanceof Ni||I instanceof vc))return;const{analyser:b,cleanup:T}=g9(I,{smoothingTimeConstant:.8,fftSize:64}),R=new Uint8Array(b.frequencyBinCount),P=()=>{b.getByteFrequencyData(R);const _=new Array(C).fill(0);R.slice(1);const M=6;for(let H=0;H<C/2;H+=1){const V=Math.floor(C/2-H);for(let U=0;U<M;U+=1)_[V]+=Math.pow(R[H*M+U]/255,2);_[V]/=M}for(let H=0;H<C/2;H+=1){const V=Math.floor(C/2+H);if(_[V]===0){for(let U=0;U<M;U+=1)_[V]+=Math.pow(R[H*M+U]/255,2);_[V]/=M}}return _.map(H=>H*v)},B=setInterval(()=>{const _=P();u(_)},100);return()=>{clearInterval(B),T()}},[I]),N.createElement("svg",Yr(Dt({width:"100%",height:"100%",viewBox:`0 0 ${d} ${f}`},i),{className:"lk-audio-visualizer"}),N.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),N.createElement("g",{style:{transform:`translate(${(d-C*(p+g))/2}px, 0)`}},l.map((b,T)=>N.createElement("rect",{key:T,x:T*(p+g),y:f/2-b/2,width:p,height:b}))))}function rW(n){var e=n,{participants:t}=e,r=Or(e,["participants"]);return N.createElement(N.Fragment,null,t.map(i=>N.createElement(s1.Provider,{value:i,key:i.identity},j2(r.children))))}function iW(n){var e=n,{participant:t,children:r,source:i,publication:o,disableSpeakingIndicator:a,onParticipantClick:l}=e,u=Or(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const d=Oc(t),{elementProps:f}=dG({participant:d,htmlProps:u,disableSpeakingIndicator:a,source:Ne.Source.Microphone,publication:o,onParticipantClick:l});return N.createElement("div",Dt({style:{position:"relative"}},f),N.createElement(QG,{participant:d},r??N.createElement(N.Fragment,null,N.createElement(qG,{source:i??Ne.Source.Microphone}),N.createElement(nW,null),N.createElement("div",{className:"lk-participant-metadata"},N.createElement("div",{className:"lk-participant-metadata-item"},N.createElement(YG,{source:Ne.Source.Microphone}),N.createElement(JG,null)),N.createElement($G,{className:"lk-participant-metadata-item"})))))}function oW(n){var e=n,{entry:t,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=e,a=Or(e,["entry","hideName","hideTimestamp","messageFormatter"]),l,u,d,f;const p=N.useMemo(()=>o?o(t.message):t.message,[t.message,o]),g=new Date(t.timestamp),v=navigator?navigator.language:"en-US";return N.createElement("li",Dt({className:"lk-chat-entry",title:g.toLocaleTimeString(v,{timeStyle:"full"}),"data-lk-message-origin":(l=t.from)!=null&&l.isLocal?"local":"remote"},a),(!i||!r)&&N.createElement("span",{className:"lk-meta-data"},!r&&N.createElement("strong",{className:"lk-participant-name"},(f=(u=t.from)==null?void 0:u.name)!=null?f:(d=t.from)==null?void 0:d.identity),!i&&N.createElement("span",{className:"lk-timestamp"},g.toLocaleTimeString(v,{timeStyle:"short"}))),N.createElement("span",{className:"lk-message-body"},p))}function sW(n){var e=n,{messageFormatter:t,messageDecoder:r,messageEncoder:i,channelTopic:o}=e,a=Or(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const l=N.useRef(null),u=N.useRef(null),d=N.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:f,chatMessages:p,isSending:g}=xG(d),v=W2(),C=N.useRef(0);function y(x){return G2(this,null,function*(){x.preventDefault(),l.current&&l.current.value.trim()!==""&&f&&(yield f(l.current.value),l.current.value="",l.current.focus())})}return N.useEffect(()=>{var x;u&&((x=u.current)==null||x.scrollTo({top:u.current.scrollHeight}))},[u,p]),N.useEffect(()=>{var x,I,b,T,R;if(!v||p.length===0)return;if((x=v.widget.state)!=null&&x.showChat&&p.length>0&&C.current!==((I=p[p.length-1])==null?void 0:I.timestamp)){C.current=(b=p[p.length-1])==null?void 0:b.timestamp;return}const P=p.filter(_=>!C.current||_.timestamp>C.current).length,{widget:B}=v;P>0&&((T=B.state)==null?void 0:T.unreadMessages)!==P&&((R=B.dispatch)==null||R.call(B,{msg:"unread_msg",count:P}))},[p,v==null?void 0:v.widget]),N.createElement("div",Yr(Dt({},a),{className:"lk-chat"}),N.createElement("ul",{className:"lk-list lk-chat-messages",ref:u},a.children?p.map((x,I)=>j2(a.children,{entry:x,key:I,messageFormatter:t})):p.map((x,I,b)=>{const T=I>=1&&b[I-1].from===x.from,R=I>=1&&x.timestamp-b[I-1].timestamp<6e4;return N.createElement(oW,{key:I,hideName:T,hideTimestamp:T===!1?!1:R,entry:x,messageFormatter:t})})),N.createElement("form",{className:"lk-chat-form",onSubmit:y},N.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:g,ref:l,type:"text",placeholder:"Enter a message..."}),N.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:g},"Send")))}function Uw(n){var e=n,{kind:t,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:a=!1}=e,l=Or(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[u,d]=N.useState(!1),[f,p]=N.useState([]),[g,v]=N.useState(!0),C=(b,T)=>{vn.debug("handle device change"),d(!1),i==null||i(b,T)},y=N.useRef(null),x=N.useRef(null);N.useLayoutEffect(()=>{y.current&&x.current&&(f||g)&&$U(y.current,x.current).then(({x:b,y:T})=>{x.current&&Object.assign(x.current.style,{left:`${b}px`,top:`${T}px`})}),v(!1)},[y,x,f,g]);const I=N.useCallback(b=>{x.current&&b.target!==y.current&&u&&JU(x.current,b)&&d(!1)},[u,x,y]);return N.useEffect(()=>(document.addEventListener("click",I),window.addEventListener("resize",()=>v(!0)),()=>{document.removeEventListener("click",I),window.removeEventListener("resize",()=>v(!0))}),[I,v]),N.createElement(N.Fragment,null,N.createElement("button",Yr(Dt({className:"lk-button lk-button-menu","aria-pressed":u},l),{onClick:()=>d(!u),ref:y}),l.children),!l.disabled&&N.createElement("div",{className:"lk-device-menu",ref:x,style:{visibility:u?"visible":"hidden"}},t?N.createElement(bv,{initialSelection:r,onActiveDeviceChange:b=>C(t,b),onDeviceListChange:p,kind:t,track:o==null?void 0:o[t],requestPermissions:a}):N.createElement(N.Fragment,null,N.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),N.createElement(bv,{kind:"audioinput",onActiveDeviceChange:b=>C("audioinput",b),onDeviceListChange:p,track:o==null?void 0:o.audioinput,requestPermissions:a}),N.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),N.createElement(bv,{kind:"videoinput",onActiveDeviceChange:b=>C("videoinput",b),onDeviceListChange:p,track:o==null?void 0:o.videoinput,requestPermissions:a}))))}function aW(n){var e=n,{label:t}=e,r=Or(e,["label"]);const i=cg(),{mergedProps:o,canPlayAudio:a}=pG({room:i,props:r}),{mergedProps:l,canPlayVideo:u}=gG({room:i,props:o}),d=l,{style:f}=d,p=Or(d,["style"]);return f.display=a&&u?"none":"block",N.createElement("button",Dt({style:f},p),t??`Start ${a?"Video":"Audio"}`)}function lW(n){var e=n,{variation:t,controls:r,saveUserChoices:i=!0}=e,o=Or(e,["variation","controls","saveUserChoices"]),a,l,u,d,f;const[p,g]=N.useState(!1),v=W2();N.useEffect(()=>{var q,ie;((q=v==null?void 0:v.widget.state)==null?void 0:q.showChat)!==void 0&&g((ie=v==null?void 0:v.widget.state)==null?void 0:ie.showChat)},[(a=v==null?void 0:v.widget.state)==null?void 0:a.showChat]);const y=ZV(`(max-width: ${p?1e3:760}px)`)?"minimal":"verbose";t??(t=y);const x=Dt({leave:!0},r),I=lG();I?((l=x.camera)!=null||(x.camera=I.canPublish),(u=x.microphone)!=null||(x.microphone=I.canPublish),(d=x.screenShare)!=null||(x.screenShare=I.canPublish),(f=x.chat)!=null||(x.chat=I.canPublishData&&(r==null?void 0:r.chat))):(x.camera=!1,x.chat=!1,x.microphone=!1,x.screenShare=!1);const b=N.useMemo(()=>t==="minimal"||t==="verbose",[t]),T=N.useMemo(()=>t==="textOnly"||t==="verbose",[t]),R=eV(),[P,B]=N.useState(!1),_=q=>{B(q)},M=td({className:"lk-control-bar"},o),{saveAudioInputEnabled:H,saveVideoInputEnabled:V,saveAudioInputDeviceId:U,saveVideoInputDeviceId:Z}=IG({preventSave:!i});return N.createElement("div",Dt({},M),x.microphone&&N.createElement("div",{className:"lk-button-group"},N.createElement(Av,{source:Ne.Source.Microphone,showIcon:b,onChange:H},T&&"Microphone"),N.createElement("div",{className:"lk-button-group-menu"},N.createElement(Uw,{kind:"audioinput",onActiveDeviceChange:(q,ie)=>U(ie??"")}))),x.camera&&N.createElement("div",{className:"lk-button-group"},N.createElement(Av,{source:Ne.Source.Camera,showIcon:b,onChange:V},T&&"Camera"),N.createElement("div",{className:"lk-button-group-menu"},N.createElement(Uw,{kind:"videoinput",onActiveDeviceChange:(q,ie)=>Z(ie??"")}))),x.screenShare&&R&&N.createElement(Av,{source:Ne.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:b,onChange:_},T&&(P?"Stop screen share":"Share screen")),x.chat&&N.createElement(bG,null,b&&N.createElement(RG,null),T&&"Chat"),x.leave&&N.createElement(AG,null,b&&N.createElement(PG,null),T&&"Leave"),N.createElement(aW,null))}function cW(n){var e=Or(n,[]);const[t,r]=N.useState({showChat:!1,unreadMessages:0}),i=hG();return N.createElement(eW,{onWidgetChange:r},N.createElement("div",Dt({className:"lk-audio-conference"},e),N.createElement("div",{className:"lk-audio-conference-stage"},N.createElement(rW,{participants:i},N.createElement(iW,null))),N.createElement(lW,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),t.showChat&&N.createElement(sW,null)))}const uW="wss://mongoose-67t79p35.livekit.cloud",dW=({client:n})=>{const[e,t]=N.useState([]),[r,i]=N.useState(!1);return N.useEffect(()=>{const o=l=>{t(u=>[...u,l]),i(!0)},a=l=>{t(u=>{const d=u.filter(f=>f!==l);return d.length===0&&i(!1),d})};return n.on("livekitToken",o),n.on("livekitLeave",a),()=>{n.off("livekitToken",o),n.off("livekitLeave",a)}},[n]),e.length?oe.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,a)=>oe.jsx(tW,{video:!1,audio:!0,token:o,serverUrl:uW,connect:!0,onDisconnected:()=>n.emit("livekitLeave",o),children:oe.jsx(cW,{})},a)),oe.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},l1=({items:n,renderItem:e,listId:t,labelledBy:r,className:i="",itemClassName:o,getItemTextValue:a=u=>(u.name||u.id||"").toString().toLowerCase(),onSelectedIndexChange:l})=>{var C;const[u,d]=N.useState(-1),f=N.useRef(null),p=N.useCallback(y=>{d(y),l&&l(y)},[l]),g=()=>{u===-1&&n.length>0&&p(0)};N.useEffect(()=>{var y;if(u>=n.length&&p(n.length>0?0:-1),u!==-1&&n[u]){const x=`${t}-item-${(y=n[u])==null?void 0:y.id}`,I=document.getElementById(x);I&&I.scrollIntoView({block:"nearest"})}},[u,n,t]);const v=N.useCallback(y=>{if(n.length===0)return;let x=u,I=!0;switch(y.key){case"ArrowDown":x=(u+1)%n.length;break;case"ArrowUp":x=(u-1+n.length)%n.length;break;case"Home":x=0;break;case"End":x=n.length-1;break;case"PageUp":x=Math.max(u-5,0);break;case"PageDown":x=Math.min(u+5,n.length-1);break;default:if(y.key.length===1&&!y.ctrlKey&&!y.metaKey&&!y.altKey){const b=y.key.toLowerCase();let T=u===-1?0:(u+1)%n.length,R=-1;for(let P=0;P<n.length;P++){const B=(T+P)%n.length;if(a(n[B]).startsWith(b)){R=B;break}}R!==-1?x=R:I=!1}else I=!1;break}x!==u&&p(x),I&&y.preventDefault()},[u,n,a]);return oe.jsx("div",{id:t,className:`accessible-list-container ${i}`,ref:f,tabIndex:0,role:"listbox","aria-labelledby":r,"aria-activedescendant":u!==-1?`${t}-item-${(C=n[u])==null?void 0:C.id}`:void 0,onFocus:g,onKeyDown:v,children:oe.jsx("ul",{role:"none",className:"accessible-list-ul",children:n.map((y,x)=>{const I=x===u,b=e(y,x,I),T=o?o(y,x,I):"";return oe.jsx("li",{id:`${t}-item-${y.id}`,className:`${T} ${I?"selected":""}`,role:"option","aria-selected":I,onClick:()=>p(x),children:b},y.id)})})})},fW=n=>({...n,id:n.Object}),hW=({users:n})=>{const e=n.map(fW),t=(o,a,l)=>{let u="Online";return o.away&&(u="Away"),o.idle&&(u==="Online"?u="Idle":u+=" + Idle"),oe.jsxs(oe.Fragment,{children:[o.Name,oe.jsxs("span",{className:"sr-only",children:["",`(${u})`]})]})},r=(o,a,l)=>{let u="userlist-item";return o.away&&(u+=" away"),o.idle&&(u+=" idle"),u},i=o=>o.Name?o.Name.toLowerCase():"";return oe.jsxs(oe.Fragment,{children:[oe.jsx("div",{className:"sidebar-header",id:"userlist-header","aria-hidden":"true",children:"Connected Players"}),oe.jsxs("div",{className:"sidebar",children:[" ",oe.jsxs("div",{className:"sidebar-content",children:[" ",oe.jsx(l1,{items:e,renderItem:t,listId:"userlist",labelledBy:"userlist-header",className:"userlist-accessible-container",itemClassName:r,getItemTextValue:i})]})]})]})},pW=({items:n,onItemSelected:e,listId:t,labelledBy:r})=>{const i=u=>{u>-1&&n[u]?e(n[u]):e(null)},o=(u,d,f)=>oe.jsxs("span",{children:[" ",u.name]}),a=(u,d,f)=>"inventory-list-li",l=u=>u.name?u.name.toLowerCase():"";return oe.jsx(l1,{items:n,renderItem:o,listId:t,labelledBy:r,className:"inventory-accessible-list",itemClassName:a,getItemTextValue:l,onSelectedIndexChange:i})},Z2=({item:n,onDrop:e,onWear:t,onRemove:r,onGet:i})=>{var f,p;const o=n.name,a=(f=n.Attrib)==null?void 0:f.includes("W"),l=(p=n.Attrib)==null?void 0:p.includes("w"),u=g=>{g.stopPropagation(),e&&e(n)},d=g=>{g.stopPropagation(),i&&i(n)};return oe.jsxs("div",{className:"item-card",title:o,"data-item-id":n.id,children:[n.icon&&oe.jsx("img",{src:n.icon,alt:"",className:"item-icon"}),oe.jsxs("div",{className:"item-details",children:[" ",oe.jsx("div",{className:"item-name",children:n.name})]}),oe.jsxs("div",{className:"item-actions",children:[n.location==="room"&&i&&oe.jsx("button",{className:"item-get-button",onClick:d,"aria-label":`Get ${n.name}`,tabIndex:0,accessKey:"g",children:"Get"}),n.location==="inv"&&a&&!l&&t&&oe.jsx("button",{className:"item-wear-button",onClick:()=>t(n),"aria-label":`Wear ${n.name}`,tabIndex:0,accessKey:"w",children:"Wear"}),n.location==="inv"&&l&&r&&oe.jsx("button",{className:"item-remove-button",onClick:()=>r(n),"aria-label":`Remove ${n.name}`,tabIndex:0,accessKey:"r",children:"Remove"}),n.location==="inv"&&e&&oe.jsx("button",{className:"item-drop-button",onClick:u,"aria-label":`Drop ${n.name}`,tabIndex:0,accessKey:"d"})]})]})},gW=({client:n})=>{const[e,t]=N.useState([]),[r,i]=N.useState(null),o=N.useCallback((y,x)=>{y==="inv"&&(t(x),(x.length===0||!x.find(I=>I.id===(r==null?void 0:r.id)))&&i(null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]),a=N.useCallback((y,x)=>{y==="inv"&&t(I=>{if(I.some(T=>T.id===x.id))return I;const b=[...I,x];return n.emit("inventoryDataReceived"),b})},[n]),l=N.useCallback((y,x)=>{y==="inv"&&t(I=>{const b=I.filter(T=>T.id!==x.id);return b.length<I.length&&n.emit("inventoryDataReceived"),(r==null?void 0:r.id)===x.id&&i(null),b})},[n,r==null?void 0:r.id]),u=N.useCallback((y,x)=>{y==="inv"&&(t(I=>I.map(b=>b.id===x.id?{...b,...x}:b)),(r==null?void 0:r.id)===x.id&&i(I=>I?{...I,...x}:null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]);N.useEffect(()=>{const y=R=>o(R.location,R.items),x=R=>a(R.location,R.item),I=R=>l(R.location,R.item),b=R=>u(R.location,R.item);n.on("itemsList",y),n.on("itemAdd",x),n.on("itemRemove",I),n.on("itemUpdate",b);const T=n.gmcpHandlers["Char.Items"];return T!=null&&T.sendInventoryRequest&&T.sendInventoryRequest(),()=>{n.off("itemsList",y),n.off("itemAdd",x),n.off("itemRemove",I),n.off("itemUpdate",b)}},[n,o,a,l,u]);const d=y=>{i(y)},f=N.useCallback(y=>{n.sendCommand(`drop ${y.id}`)},[n]),p=N.useCallback(y=>{n.sendCommand(`wear ${y.id}`)},[n]),g=N.useCallback(y=>{n.sendCommand(`remove ${y.id}`)},[n]),v="inventory-heading";return oe.jsxs("div",{className:"inventory-tab-content",role:"region","aria-labelledby":v,children:[oe.jsx("h4",{id:v,tabIndex:-1,children:"Inventory"}),e.length===0?oe.jsx("p",{children:"Your inventory is empty."}):oe.jsx(pW,{items:e,onItemSelected:d,listId:"inventory-listbox",labelledBy:v}),r&&oe.jsx("div",{className:"selected-item-card-container",style:{marginTop:"1rem"},children:oe.jsx(Z2,{item:r,onDrop:f,onWear:p,onRemove:g})})]})};function Tf(n,e,t){const[r,i]=N.useState(t);return N.useEffect(()=>{if(!n)return i(t),()=>{};const o=a=>{i(a)};return n.on(e,o),()=>{n.off(e,o)}},[n,e,t]),r}const mW=({client:n})=>{const[e,t]=N.useState(n.currentRoomInfo),[r,i]=N.useState([]),[o,a]=N.useState(null),l=n.gmcpHandlers["Char.Items"],u=N.useCallback(B=>{t(B)},[]);N.useEffect(()=>(n.on("roomInfo",u),l!=null&&l.sendRoomRequest&&l.sendRoomRequest(),()=>{n.off("roomInfo",u)}),[n,l,u]);const d=N.useCallback((B,_)=>{B==="room"&&(i(_),o&&!_.find(M=>M.id===o.id)&&a(null))},[o]),f=N.useCallback((B,_)=>{B==="room"&&i(M=>M.some(H=>H.id===_.id)?M:[...M,_])},[]),p=N.useCallback((B,_)=>{B==="room"&&(i(M=>M.filter(H=>H.id!==_.id)),(o==null?void 0:o.id)===_.id&&a(null))},[o]);N.useEffect(()=>{const B=H=>d(H.location,H.items),_=H=>f(H.location,H.item),M=H=>p(H.location,H.item);return n.on("itemsList",B),n.on("itemAdd",_),n.on("itemRemove",M),()=>{n.off("itemsList",B),n.off("itemAdd",_),n.off("itemRemove",M)}},[n,d,f,p]);const g=B=>{n.sendCommand(B)},v=B=>{a(B>-1&&r[B]?r[B]:null)},C=N.useCallback(B=>{n.sendCommand(`get ${B.id}`)},[n]),y=B=>oe.jsx("span",{children:B.name}),x=()=>"room-item-li",I=B=>B.name.toLowerCase(),b="room-info-heading",T="room-contents-heading",R="room-contents-list";if(!e&&r.length===0)return oe.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":b,children:[oe.jsx("h4",{id:b,children:"Room Info"}),oe.jsx("p",{children:"Waiting for room data..."})]});const P=e!=null&&e.exits?Object.entries(e.exits).sort(([B],[_])=>B.localeCompare(_)):[];return oe.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":b,children:[e&&oe.jsxs(oe.Fragment,{children:[oe.jsx("h4",{id:b,children:e.name||"Current Room"}),e.area&&oe.jsxs("p",{className:"room-area",children:["Area: ",e.area]}),P.length>0&&oe.jsxs("div",{className:"room-exits",children:[oe.jsx("h5",{children:"Exits"}),oe.jsx("ul",{"aria-label":"Room Exits",children:P.map(([B,_])=>oe.jsx("li",{children:oe.jsx("button",{onClick:()=>g(B),title:`Go ${B} (to room ${_})`,"aria-label":`Go ${B}`,children:B.toUpperCase()})},B))})]})]}),oe.jsxs("div",{className:"room-contents-section",children:[oe.jsx("h5",{id:T,tabIndex:-1,children:"Contents"}),r.length===0?oe.jsx("p",{children:"Nothing on the ground."}):oe.jsx(l1,{items:r,renderItem:y,listId:R,labelledBy:T,className:"room-items-accessible-list",itemClassName:x,getItemTextValue:I,onSelectedIndexChange:v})]}),o&&oe.jsx("div",{className:"selected-room-item-card-container",style:{marginTop:"1rem"},children:oe.jsx(Z2,{item:o,onGet:C})})]})},vW=Lt.forwardRef(({client:n},e)=>{const t=Tf(n,"userlist",[]),[r,i]=N.useState(!0),[o,a]=N.useState(!1),[l,u]=N.useState(!!n.currentRoomInfo);N.useEffect(()=>{const p=()=>a(!0);return n.on("itemsList",p),()=>{n.off("itemsList",p)}},[n]),N.useEffect(()=>{const p=()=>{l||u(!0)};return n.on("roomInfo",p),()=>{n.off("roomInfo",p)}},[n,l]);const d=[{id:"room-tab",label:"Room",content:oe.jsx(mW,{client:n}),condition:l},{id:"inventory-tab",label:"Inventory",content:oe.jsx(gW,{client:n}),condition:o},{id:"users-tab",label:"Users",content:oe.jsx(hW,{users:t}),condition:!0},{id:"files-tab",label:"Files",content:oe.jsx(B8,{client:n,expanded:r}),condition:!0},{id:"audio-tab",label:"Audio",content:oe.jsx(dW,{client:n}),condition:!0}],f=Lt.useMemo(()=>d.filter(p=>p.condition??!0),[l,o]);return Lt.useImperativeHandle(e,()=>({switchToTab:p=>{var g;if(p>=0&&p<f.length){const v=(g=f[p])==null?void 0:g.id;if(v){console.log(`switchToTab: Trying index ${p}, ID: ${v}`);const C=document.getElementById(v);C?(console.log("switchToTab: Found button element, attempting click..."),C.click(),console.log("switchToTab: Click simulation finished.")):console.error(`switchToTab: Could not find button element with ID: ${v}`)}else console.warn(`switchToTab: Could not determine targetTabId for index ${p}. Visible tabs:`,f)}else console.warn(`switchToTab: Invalid targetIndex ${p}. Visible tabs count: ${f.length}`)}}),[f]),N.useEffect(()=>{const p=()=>i(!0);return n.on("fileTransferOffer",p),()=>{n.off("fileTransferOffer",p)}},[n]),oe.jsxs("div",{className:"sidebar",children:[" ",oe.jsxs("div",{className:"sidebar-content",children:[oe.jsx(Qk,{tabs:f})," "]})]})}),CW=({client:n})=>{const[e,t]=N.useState("Not connected"),[r,i]=N.useState(null),o=N.useCallback(g=>t(g),[]),a=N.useCallback(()=>t("Connected"),[]),l=N.useCallback(()=>{t("Disconnected"),i(null)},[]),u=N.useCallback(g=>i(g),[]);N.useEffect(()=>(n.on("statustext",o),n.on("connect",a),n.on("disconnect",l),n.on("vitals",u),()=>{n.off("statustext",o),n.off("connect",a),n.off("disconnect",l),n.off("vitals",u)}),[n,o,a,l,u]);const d=(g,v)=>g===void 0||v===void 0?null:`${g}/${v}`,f=d(r==null?void 0:r.hp,r==null?void 0:r.maxhp),p=d(r==null?void 0:r.mp,r==null?void 0:r.maxmp);return oe.jsxs("div",{className:"statusbar",children:[oe.jsx("span",{className:"status-connection",children:e}),r&&oe.jsxs("span",{className:"status-vitals",children:[f&&` HP: ${f}`,p&&` MP: ${p}`]})]})};var X2={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Vw=Lt.createContext&&Lt.createContext(X2),yW=["attr","size","title"];function xW(n,e){if(n==null)return{};var t=IW(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function IW(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function V0(){return V0=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},V0.apply(this,arguments)}function Gw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function G0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Gw(Object(t),!0).forEach(function(r){bW(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Gw(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function bW(n,e,t){return e=AW(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AW(n){var e=wW(n,"string");return typeof e=="symbol"?e:e+""}function wW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function K2(n){return n&&n.map((e,t)=>Lt.createElement(e.tag,G0({key:t},e.attr),K2(e.child)))}function ts(n){return e=>Lt.createElement(SW,V0({attr:G0({},n.attr)},e),K2(n.child))}function SW(n){var e=t=>{var{attr:r,size:i,title:o}=n,a=xW(n,yW),l=i||t.size||"1em",u;return t.className&&(u=t.className),n.className&&(u=(u?u+" ":"")+n.className),Lt.createElement("svg",V0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:u,style:G0(G0({color:n.color||t.color},t.style),n.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&Lt.createElement("title",null,o),n.children)};return Vw!==void 0?Lt.createElement(Vw.Consumer,null,t=>e(t)):e(X2)}function kW(n){return ts({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(n)}function EW(n){return ts({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(n)}function TW(n){return ts({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(n)}function RW(n){return ts({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(n)}function _W(n){return ts({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(n)}function PW(n){return ts({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(n)}function DW(n){return ts({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(n)}function $2(n){return ts({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(n)}function NW(n){return ts({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(n)}function BW(n){return ts({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(n)}function OW(n){return ts({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(n)}const FW=({client:n,onClearLog:e,onSaveLog:t,onCopyLog:r,onToggleSidebar:i,onOpenPrefs:o,showSidebar:a})=>{const l=Tf(n,"connectionChange",n.connected),[u,d]=Lt.useState(n.cacophony.muted),f=Tf(n,"autosayChanged",n.autosay)||!1,[p,g]=Lt.useState(li.getState().sound.volume),v=N.useCallback(()=>{const I=!u;d(I),n.setGlobalMute(I)},[u,n]),C=N.useCallback(I=>{const b=Number(I.target.value)/100;g(b),n.cacophony.setGlobalVolume(b),li.dispatch({type:$o.SetSound,data:{...li.getState().sound,volume:b}})},[n]),y=N.useCallback(I=>{n.autosay=I.target.checked},[n]),x=N.useCallback(()=>{l?n.close():n.connect()},[l,n]);return oe.jsxs("div",{className:"toolbar",children:[oe.jsxs("button",{onClick:t,accessKey:"l",children:[oe.jsx($2,{}),"Save Log (Alt+L)"]}),oe.jsxs("button",{onClick:r,accessKey:"C",children:[oe.jsx(_W,{}),"Copy Log (Alt+Shift+C)"]}),oe.jsxs("button",{onClick:e,accessKey:"E",children:[" ",oe.jsx(DW,{}),"Clear Log (Alt+E)"]}),oe.jsxs("button",{onClick:o,accessKey:"p",children:[oe.jsx(TW,{}),"Preferences (Alt+P)"]}),oe.jsxs("button",{onClick:v,accessKey:"M",children:[u?oe.jsx(OW,{}):oe.jsx(BW,{}),u?"Unmute":"Mute"]}),oe.jsxs("label",{children:["Volume",oe.jsx("input",{type:"range",min:"0",max:"100",value:p*100,onChange:C,accessKey:"V"})]}),oe.jsxs("label",{children:[oe.jsx(RW,{}),"Autosay",oe.jsx("input",{type:"checkbox",checked:f,onChange:y})]}),oe.jsx("button",{onClick:x,children:l?"Disconnect":"Connect"}),oe.jsxs("button",{onClick:i,accessKey:"U",title:a?"Hide Sidebar (Alt+U)":"Show Sidebar (Alt+U)","aria-label":a?"Hide Sidebar":"Show Sidebar","aria-expanded":a,children:[a?oe.jsx(EW,{}):oe.jsx(kW,{}),a?"Hide Sidebar":"Show Sidebar"]})]})};function MW(){const[n,e]=N.useState(null),[t,r]=N.useState(!1),[i,o]=N.useState(!1),[a,l]=N.useState(!1);Tf(n,"userlist",[]);const u=Lt.useRef(null),d=Lt.useRef(null),f=Lt.useRef(null),p=Lt.useRef(null),g=N.useRef(!1),v=()=>{u.current&&u.current.saveLog()},C=()=>{u.current&&u.current.clearLog()},y=()=>{u.current&&u.current.copyLog()},x=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);N.useEffect(()=>{if(g.current)return;const R=new LF("mongoose.moo.mud.org",8765);R.registerGMCPPackage(iO),R.registerGMCPPackage(eO),R.registerGMCPPackage(tO),R.registerGMCPPackage(YD),R.registerGMCPPackage(oO),R.registerGMCPPackage(nO),R.registerGMCPPackage(rO),R.registerGMCPPackage(oD),R.registerGMCPPackage(KD),R.registerGMCPPackage(CS),R.registerGMCPPackage(lO),R.registerGMCPPackage(lD),R.registerGMCPPackage(vS),R.registerGMCPPackage(sD),R.registerGMCPPackage(aD),R.registerGMCPPackage(cD),R.registerGMCPPackage(uD),R.registerGMCPPackage(dD),R.registerGMCPPackage(sO),R.registerGMCPPackage(aO),R.registerGMCPPackage(cO),R.registerGMCPPackage(uO),R.registerGMCPPackage(dO),R.registerGMCPPackage(fO),R.registerGMCPPackage(hO),R.registerMcpPackage(vO),R.registerMcpPackage(CO),R.registerMcpPackage(xO),R.registerMcpPackage(IO),R.connect(),R.requestNotificationPermission(),e(R),r(!x),window.mudClient=R,g.current=!0;const P=_=>{R&&(_.key==="Control"&&R.cancelSpeech(),_.key==="Escape"&&R.stopAllSounds())};window.addEventListener("keydown",P);const B=()=>{var _;(_=d.current)==null||_.focus()};return document.addEventListener("focus",B),()=>{window.removeEventListener("keydown",P),document.removeEventListener("focus",B)}},[x]),N.useEffect(()=>{const R=P=>{var _;if(!t||!P.ctrlKey)return;const B=parseInt(P.key,10);if(!isNaN(B)&&B>=1&&B<=9){const M=B-1;P.preventDefault(),console.log(`App: Detected CTRL+${B}, calling switchToTab(${M})`),(_=p.current)==null||_.switchToTab(M)}};return document.addEventListener("keydown",R,!0),()=>{document.removeEventListener("keydown",R,!0)}},[t]);const I=Tf(n,"fileTransferOffer",null),b=N.useCallback(R=>{n&&n.sendCommand(R)},[n]),T=N.useCallback(()=>{var R;(R=d.current)==null||R.focus()},[]);return N.useEffect(()=>{I!==null&&(l(!0),o(!0),n==null||n.sendNotification("File Transfer Offer",`${I.sender} wants to send you ${I.filename} (${Math.round(I.filesize/1024)} KB)`))},[I,n]),mS(R=>{n&&n.shutdown()}),N.useEffect(()=>{var R;(R=d.current)==null||R.focus()},[]),n?oe.jsxs("div",{className:`App ${t?"sidebar-shown":""}`,children:[oe.jsx("header",{role:"banner",style:{gridArea:"header"},children:oe.jsx(FW,{client:n,onSaveLog:v,onClearLog:C,onCopyLog:y,onToggleSidebar:()=>r(!t),onOpenPrefs:()=>{var R;return(R=f.current)==null?void 0:R.open()},showSidebar:t})}),oe.jsx("main",{role:"main",style:{gridArea:"main"},children:oe.jsx(rC,{client:n,ref:u,focusInput:T})}),oe.jsx("div",{role:"region","aria-label":"Command input",style:{gridArea:"input"},children:oe.jsx(WF,{onSend:b,inputRef:d,client:n})}),t&&oe.jsx("aside",{role:"complementary","aria-roledescription":"Sidebar",style:{gridArea:"sidebar"},children:oe.jsx(vW,{ref:p,client:n})}),oe.jsx("footer",{role:"contentinfo",style:{gridArea:"status"},children:oe.jsx(CW,{client:n})}),oe.jsx(R8,{ref:f})]}):null}function LW(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ww(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function jw(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ww(Object(t),!0).forEach(function(r){LW(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ww(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function UW(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function VW(n,e){if(n==null)return{};var t=UW(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function GW(n,e){return WW(n)||jW(n,e)||zW(n,e)||HW()}function WW(n){if(Array.isArray(n))return n}function jW(n,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(n)))){var t=[],r=!0,i=!1,o=void 0;try{for(var a=n[Symbol.iterator](),l;!(r=(l=a.next()).done)&&(t.push(l.value),!(e&&t.length===e));r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return t}}function zW(n,e){if(n){if(typeof n=="string")return zw(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zw(n,e)}}function zw(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function HW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZW(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function Zw(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hw(Object(t),!0).forEach(function(r){ZW(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hw(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function XW(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function of(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=n.length?n.apply(this,i):function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return e.apply(t,[].concat(i,l))}}}function W0(n){return{}.toString.call(n).includes("Object")}function KW(n){return!Object.keys(n).length}function Rf(n){return typeof n=="function"}function $W(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function JW(n,e){return W0(e)||Rl("changeType"),Object.keys(e).some(function(t){return!$W(n,t)})&&Rl("changeField"),e}function YW(n){Rf(n)||Rl("selectorType")}function qW(n){Rf(n)||W0(n)||Rl("handlerType"),W0(n)&&Object.values(n).some(function(e){return!Rf(e)})&&Rl("handlersType")}function QW(n){n||Rl("initialIsRequired"),W0(n)||Rl("initialType"),KW(n)&&Rl("initialContent")}function ej(n,e){throw new Error(n[e]||n.default)}var tj={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Rl=of(ej)(tj),cp={changes:JW,selector:YW,handler:qW,initial:QW};function nj(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cp.initial(n),cp.handler(e);var t={current:n},r=of(oj)(t,e),i=of(ij)(t),o=of(cp.changes)(n),a=of(rj)(t);function l(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(f){return f};return cp.selector(d),d(t.current)}function u(d){XW(r,i,o,a)(d)}return[l,u]}function rj(n,e){return Rf(e)?e(n.current):e}function ij(n,e){return n.current=Zw(Zw({},n.current),e),e}function oj(n,e,t){return Rf(e)?e(n.current):Object.keys(t).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,n.current[r])}),t}var sj={create:nj},aj={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function lj(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=n.length?n.apply(this,i):function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return e.apply(t,[].concat(i,l))}}}function cj(n){return{}.toString.call(n).includes("Object")}function uj(n){return n||Xw("configIsRequired"),cj(n)||Xw("configType"),n.urls?(dj(),{paths:{vs:n.urls.monacoBase}}):n}function dj(){console.warn(J2.deprecation)}function fj(n,e){throw new Error(n[e]||n.default)}var J2={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Xw=lj(fj)(J2),hj={config:uj},pj=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduceRight(function(o,a){return a(o)},i)}};function Y2(n,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&n[t]&&Object.assign(e[t],Y2(n[t],e[t]))}),jw(jw({},n),e)}var gj={type:"cancelation",msg:"operation is manually canceled"};function wv(n){var e=!1,t=new Promise(function(r,i){n.then(function(o){return e?i(gj):r(o)}),n.catch(i)});return t.cancel=function(){return e=!0},t}var mj=sj.create({config:aj,isInitialized:!1,resolve:null,reject:null,monaco:null}),q2=GW(mj,2),Xf=q2[0],dg=q2[1];function vj(n){var e=hj.config(n),t=e.monaco,r=VW(e,["monaco"]);dg(function(i){return{config:Y2(i.config,r),monaco:t}})}function Cj(){var n=Xf(function(e){var t=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:t,isInitialized:r,resolve:i}});if(!n.isInitialized){if(dg({isInitialized:!0}),n.monaco)return n.resolve(n.monaco),wv(Sv);if(window.monaco&&window.monaco.editor)return Q2(window.monaco),n.resolve(window.monaco),wv(Sv);pj(yj,Ij)(bj)}return wv(Sv)}function yj(n){return document.body.appendChild(n)}function xj(n){var e=document.createElement("script");return n&&(e.src=n),e}function Ij(n){var e=Xf(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),t=xj("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return n()},t.onerror=e.reject,t}function bj(){var n=Xf(function(t){var r=t.config,i=t.resolve,o=t.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(n.config),e(["vs/editor/editor.main"],function(t){Q2(t),n.resolve(t)},function(t){n.reject(t)})}function Q2(n){Xf().monaco||dg({monaco:n})}function Aj(){return Xf(function(n){var e=n.monaco;return e})}var Sv=new Promise(function(n,e){return dg({resolve:n,reject:e})}),eR={config:vj,init:Cj,__getMonacoInstance:Aj},wj={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},kv=wj,Sj={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},kj=Sj;function Ej({children:n}){return Lt.createElement("div",{style:kj.container},n)}var Tj=Ej,Rj=Tj;function _j({width:n,height:e,isEditorReady:t,loading:r,_ref:i,className:o,wrapperProps:a}){return Lt.createElement("section",{style:{...kv.wrapper,width:n,height:e},...a},!t&&Lt.createElement(Rj,null,r),Lt.createElement("div",{ref:i,style:{...kv.fullWidth,...!t&&kv.hide},className:o}))}var Pj=_j,tR=N.memo(Pj);function Dj(n){N.useEffect(n,[])}var nR=Dj;function Nj(n,e,t=!0){let r=N.useRef(!0);N.useEffect(r.current||!t?()=>{r.current=!1}:n,e)}var Ji=Nj;function df(){}function vu(n,e,t,r){return Bj(n,r)||Oj(n,e,t,r)}function Bj(n,e){return n.editor.getModel(rR(n,e))}function Oj(n,e,t,r){return n.editor.createModel(e,t,r?rR(n,r):void 0)}function rR(n,e){return n.Uri.parse(e)}function Fj({original:n,modified:e,language:t,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:a,keepCurrentOriginalModel:l=!1,keepCurrentModifiedModel:u=!1,theme:d="light",loading:f="Loading...",options:p={},height:g="100%",width:v="100%",className:C,wrapperProps:y={},beforeMount:x=df,onMount:I=df}){let[b,T]=N.useState(!1),[R,P]=N.useState(!0),B=N.useRef(null),_=N.useRef(null),M=N.useRef(null),H=N.useRef(I),V=N.useRef(x),U=N.useRef(!1);nR(()=>{let le=eR.init();return le.then(Ce=>(_.current=Ce)&&P(!1)).catch(Ce=>(Ce==null?void 0:Ce.type)!=="cancelation"&&console.error("Monaco initialization: error:",Ce)),()=>B.current?ie():le.cancel()}),Ji(()=>{if(B.current&&_.current){let le=B.current.getOriginalEditor(),Ce=vu(_.current,n||"",r||t||"text",o||"");Ce!==le.getModel()&&le.setModel(Ce)}},[o],b),Ji(()=>{if(B.current&&_.current){let le=B.current.getModifiedEditor(),Ce=vu(_.current,e||"",i||t||"text",a||"");Ce!==le.getModel()&&le.setModel(Ce)}},[a],b),Ji(()=>{let le=B.current.getModifiedEditor();le.getOption(_.current.editor.EditorOption.readOnly)?le.setValue(e||""):e!==le.getValue()&&(le.executeEdits("",[{range:le.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),le.pushUndoStop())},[e],b),Ji(()=>{var le,Ce;(Ce=(le=B.current)==null?void 0:le.getModel())==null||Ce.original.setValue(n||"")},[n],b),Ji(()=>{let{original:le,modified:Ce}=B.current.getModel();_.current.editor.setModelLanguage(le,r||t||"text"),_.current.editor.setModelLanguage(Ce,i||t||"text")},[t,r,i],b),Ji(()=>{var le;(le=_.current)==null||le.editor.setTheme(d)},[d],b),Ji(()=>{var le;(le=B.current)==null||le.updateOptions(p)},[p],b);let Z=N.useCallback(()=>{var Re;if(!_.current)return;V.current(_.current);let le=vu(_.current,n||"",r||t||"text",o||""),Ce=vu(_.current,e||"",i||t||"text",a||"");(Re=B.current)==null||Re.setModel({original:le,modified:Ce})},[t,e,i,n,r,o,a]),q=N.useCallback(()=>{var le;!U.current&&M.current&&(B.current=_.current.editor.createDiffEditor(M.current,{automaticLayout:!0,...p}),Z(),(le=_.current)==null||le.editor.setTheme(d),T(!0),U.current=!0)},[p,d,Z]);N.useEffect(()=>{b&&H.current(B.current,_.current)},[b]),N.useEffect(()=>{!R&&!b&&q()},[R,b,q]);function ie(){var Ce,Re,de,pe;let le=(Ce=B.current)==null?void 0:Ce.getModel();l||((Re=le==null?void 0:le.original)==null||Re.dispose()),u||((de=le==null?void 0:le.modified)==null||de.dispose()),(pe=B.current)==null||pe.dispose()}return Lt.createElement(tR,{width:v,height:g,isEditorReady:b,loading:f,_ref:M,className:C,wrapperProps:y})}var Mj=Fj;N.memo(Mj);function Lj(n){let e=N.useRef();return N.useEffect(()=>{e.current=n},[n]),e.current}var Uj=Lj,up=new Map;function Vj({defaultValue:n,defaultLanguage:e,defaultPath:t,value:r,language:i,path:o,theme:a="light",line:l,loading:u="Loading...",options:d={},overrideServices:f={},saveViewState:p=!0,keepCurrentModel:g=!1,width:v="100%",height:C="100%",className:y,wrapperProps:x={},beforeMount:I=df,onMount:b=df,onChange:T,onValidate:R=df}){let[P,B]=N.useState(!1),[_,M]=N.useState(!0),H=N.useRef(null),V=N.useRef(null),U=N.useRef(null),Z=N.useRef(b),q=N.useRef(I),ie=N.useRef(),le=N.useRef(r),Ce=Uj(o),Re=N.useRef(!1),de=N.useRef(!1);nR(()=>{let L=eR.init();return L.then(K=>(H.current=K)&&M(!1)).catch(K=>(K==null?void 0:K.type)!=="cancelation"&&console.error("Monaco initialization: error:",K)),()=>V.current?be():L.cancel()}),Ji(()=>{var K,ue,he,Ee;let L=vu(H.current,n||r||"",e||i||"",o||t||"");L!==((K=V.current)==null?void 0:K.getModel())&&(p&&up.set(Ce,(ue=V.current)==null?void 0:ue.saveViewState()),(he=V.current)==null||he.setModel(L),p&&((Ee=V.current)==null||Ee.restoreViewState(up.get(o))))},[o],P),Ji(()=>{var L;(L=V.current)==null||L.updateOptions(d)},[d],P),Ji(()=>{!V.current||r===void 0||(V.current.getOption(H.current.editor.EditorOption.readOnly)?V.current.setValue(r):r!==V.current.getValue()&&(de.current=!0,V.current.executeEdits("",[{range:V.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),V.current.pushUndoStop(),de.current=!1))},[r],P),Ji(()=>{var K,ue;let L=(K=V.current)==null?void 0:K.getModel();L&&i&&((ue=H.current)==null||ue.editor.setModelLanguage(L,i))},[i],P),Ji(()=>{var L;l!==void 0&&((L=V.current)==null||L.revealLine(l))},[l],P),Ji(()=>{var L;(L=H.current)==null||L.editor.setTheme(a)},[a],P);let pe=N.useCallback(()=>{var L;if(!(!U.current||!H.current)&&!Re.current){q.current(H.current);let K=o||t,ue=vu(H.current,r||n||"",e||i||"",K||"");V.current=(L=H.current)==null?void 0:L.editor.create(U.current,{model:ue,automaticLayout:!0,...d},f),p&&V.current.restoreViewState(up.get(K)),H.current.editor.setTheme(a),l!==void 0&&V.current.revealLine(l),B(!0),Re.current=!0}},[n,e,t,r,i,o,d,f,p,a,l]);N.useEffect(()=>{P&&Z.current(V.current,H.current)},[P]),N.useEffect(()=>{!_&&!P&&pe()},[_,P,pe]),le.current=r,N.useEffect(()=>{var L,K;P&&T&&((L=ie.current)==null||L.dispose(),ie.current=(K=V.current)==null?void 0:K.onDidChangeModelContent(ue=>{de.current||T(V.current.getValue(),ue)}))},[P,T]),N.useEffect(()=>{if(P){let L=H.current.editor.onDidChangeMarkers(K=>{var he;let ue=(he=V.current.getModel())==null?void 0:he.uri;if(ue&&K.find(Ee=>Ee.path===ue.path)){let Ee=H.current.editor.getModelMarkers({resource:ue});R==null||R(Ee)}});return()=>{L==null||L.dispose()}}return()=>{}},[P,R]);function be(){var L,K;(L=ie.current)==null||L.dispose(),g?p&&up.set(o,V.current.saveViewState()):(K=V.current.getModel())==null||K.dispose(),V.current.dispose()}return Lt.createElement(tR,{width:v,height:C,isEditorReady:P,loading:u,_ref:U,className:y,wrapperProps:x})}var Gj=Vj,Wj=N.memo(Gj),jj=Wj,zj={restoreOnUnmount:!1};function Hj(n,e){e===void 0&&(e=zj);var t=N.useRef(document.title);document.title!==n&&(document.title=n),N.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=t.current}},[])}const Zj=typeof document<"u"?Hj:function(n){};function Xj({onSave:n,onRevert:e,onDownload:t}){return oe.jsx("div",{className:"editor-toolbar",children:oe.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[oe.jsxs("button",{onClick:n,accessKey:"s",title:"Save (Alt+S)",children:[oe.jsx($2,{"aria-hidden":"true"}),"Save"]}),oe.jsxs("button",{onClick:e,accessKey:"r",title:"Revert (Alt+R)",children:[oe.jsx(NW,{"aria-hidden":"true"}),"Revert"]}),oe.jsxs("button",{onClick:t,accessKey:"d",title:"Download (Alt+D)",children:[oe.jsx(PW,{"aria-hidden":"true"}),"Download"]})]})})}const Kj=({docstate:n,session:e})=>oe.jsxs("div",{"aria-live":"polite",className:"editor-statusbar",children:[oe.jsx("span",{children:n}),oe.jsx("span",{"aria-hidden":"true",children:"|"}),oe.jsx("span",{children:e.reference}),oe.jsx("span",{"aria-hidden":"true",children:"|"}),oe.jsx("span",{children:e.type})]});function $j(){const n=pS(),e=Lt.useRef(null),[t,r]=N.useState(""),[i,o]=N.useState(""),[a,l]=N.useState(""),[u,d]=N.useState(0),[f,p]=N.useState({name:"none",contents:[],reference:"",type:""}),g=(q,ie)=>{e.current=q},[v,C]=Ws();console.log(v);const y=v.editor.accessibilityMode,x=v.editor.autocompleteEnabled;mS(q=>{P.postMessage({type:"close",id:_}),u===1&&q.preventDefault()});const[I,b]=N.useState(!1),T=I?`${f.name} - Mongoose Editor`:"Mongoose Editor";Zj(T);const R=N.useMemo(()=>{switch(u){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[u]),P=N.useMemo(()=>new BroadcastChannel("editor"),[]),B=new URLSearchParams(n.search),_=decodeURIComponent(B.get("reference")||"");N.useEffect(()=>{if(!_)return;console.log("ID: "+_),console.log("Sending ready message"),P.postMessage({type:"ready",id:_});const q=ie=>{switch(console.log(ie.data),ie.data.type){case"load":if(t!=="")return;const le=ie.data.session.contents.join(`
`);o(le),l(le),p(ie.data.session),d(0),r(ie.data.clientId),b(!0),setTimeout(Z,100);break;case"shutdown":if(console.log("Received shutdown message"),u===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;P.close(),window.close();break;default:console.warn("Unknown message type received",ie.data.type)}};return P.addEventListener("message",q),()=>{P.removeEventListener("message",q),P.postMessage({type:"close",id:_})}},[P,t,_,u]);const M=()=>{o(a),d(0)},H=q=>{const ie=i.split(/\r\n|\r|\n/),le={...f,contents:ie};P.postMessage({type:"save",session:le,id:_}),d(2),Z(),q.preventDefault()},V=q=>{q!==void 0&&(console.log("Original: "+a),console.log("New: "+q),o(q),q.split(/\r\n|\r|\n/).join(`
`)!==a?d(1):d(0),I||b(!0))},U=()=>{const q=new Blob([i],{type:"text/plain"}),ie=URL.createObjectURL(q),le=document.createElement("a"),Ce=new Date,Re=Ce.toLocaleDateString().replace(/\//g,"-"),de=Ce.toLocaleTimeString().replace(/:/g,"-"),pe=`${f.name}-${Re}-${de}.txt`;le.download=pe,le.href=ie,le.click(),URL.revokeObjectURL(ie),le.remove()};return oe.jsxs("div",{id:"editor-window",children:[oe.jsx(Xj,{onSave:H,onRevert:M,onDownload:U}),oe.jsx(jj,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:V,options:{wordWrap:"on",accessibilitySupport:y?"on":"off",quickSuggestions:x},onMount:g,path:f.reference}),oe.jsx(Kj,{docstate:R,session:f})]});function Z(){e.current!==null&&e.current.focus()}}const Jj="modulepreload",Yj=function(n){return"/"+n},Kw={},iR=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let a=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=a(t.map(d=>{if(d=Yj(d),d in Kw)return;Kw[d]=!0;const f=d.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":Jj,f||(g.as="script"),g.crossOrigin="",g.href=d,u&&g.setAttribute("nonce",u),document.head.appendChild(g),f)return new Promise((v,C)=>{g.addEventListener("load",v),g.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},qj=n=>{n&&n instanceof Function&&iR(async()=>{const{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-CFnx-5Zt.js");return{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o})=>{e(n),t(n),r(n),i(n),o(n)})};function Qj(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:a}=n;let l,u;const d=async(p=!0)=>{await u};async function f(){if("serviceWorker"in navigator){if(l=await iR(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/sw.js",{scope:"/",type:"classic"})).catch(p=>{a==null||a(p)}),!l)return;l.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),l.addEventListener("installed",p=>{p.isUpdate||r==null||r()}),l.register({immediate:e}).then(p=>{o?o("/sw.js",p):i==null||i(p)}).catch(p=>{a==null||a(p)})}}return u=f(),d}const ez=FP([{path:"/",element:oe.jsx(MW,{})},{path:"/editor",element:oe.jsx($j,{})}]),tz=x_.createRoot(document.getElementById("root"));tz.render(oe.jsx(Lt.StrictMode,{children:oe.jsx(HP,{router:ez})}));qj(console.log);Qj();

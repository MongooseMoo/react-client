var jN=Object.defineProperty;var kI=t=>{throw TypeError(t)};var ZN=(t,e,n)=>e in t?jN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var V=(t,e,n)=>ZN(t,typeof e!="symbol"?e+"":e,n),Eg=(t,e,n)=>e.has(t)||kI("Cannot "+n);var N=(t,e,n)=>(Eg(t,e,"read from private field"),n?n.call(t):e.get(t)),tt=(t,e,n)=>e.has(t)?kI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ne=(t,e,n,r)=>(Eg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),we=(t,e,n)=>(Eg(t,e,"access private method"),n);var hf=(t,e,n,r)=>({set _(i){Ne(t,e,i,n)},get _(){return N(t,e,r)}});function JA(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var HN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ud(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var YA={exports:{}},Fp={},QA={exports:{}},Ke={},Vd=Symbol.for("react.element"),zN=Symbol.for("react.portal"),XN=Symbol.for("react.fragment"),$N=Symbol.for("react.strict_mode"),KN=Symbol.for("react.profiler"),JN=Symbol.for("react.provider"),YN=Symbol.for("react.context"),QN=Symbol.for("react.forward_ref"),qN=Symbol.for("react.suspense"),e_=Symbol.for("react.memo"),t_=Symbol.for("react.lazy"),EI=Symbol.iterator;function n_(t){return t===null||typeof t!="object"?null:(t=EI&&t[EI]||t["@@iterator"],typeof t=="function"?t:null)}var qA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e1=Object.assign,t1={};function Nl(t,e,n){this.props=t,this.context=e,this.refs=t1,this.updater=n||qA}Nl.prototype.isReactComponent={};Nl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Nl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function n1(){}n1.prototype=Nl.prototype;function cy(t,e,n){this.props=t,this.context=e,this.refs=t1,this.updater=n||qA}var ly=cy.prototype=new n1;ly.constructor=cy;e1(ly,Nl.prototype);ly.isPureReactComponent=!0;var TI=Array.isArray,r1=Object.prototype.hasOwnProperty,uy={current:null},i1={key:!0,ref:!0,__self:!0,__source:!0};function o1(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)r1.call(e,r)&&!i1.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Vd,type:t,key:o,ref:s,props:i,_owner:uy.current}}function r_(t,e){return{$$typeof:Vd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function dy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vd}function i_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var RI=/\/+/g;function Tg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?i_(""+t.key):e.toString(36)}function Xf(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Vd:case zN:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Tg(s,0):r,TI(i)?(n="",t!=null&&(n=t.replace(RI,"$&/")+"/"),Xf(i,e,n,"",function(l){return l})):i!=null&&(dy(i)&&(i=r_(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(RI,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",TI(t))for(var a=0;a<t.length;a++){o=t[a];var c=r+Tg(o,a);s+=Xf(o,e,n,c,i)}else if(c=n_(t),typeof c=="function")for(t=c.call(t),a=0;!(o=t.next()).done;)o=o.value,c=r+Tg(o,a++),s+=Xf(o,e,n,c,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function pf(t,e,n){if(t==null)return t;var r=[],i=0;return Xf(t,r,"","",function(o){return e.call(n,o,i++)}),r}function o_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tr={current:null},$f={transition:null},s_={ReactCurrentDispatcher:tr,ReactCurrentBatchConfig:$f,ReactCurrentOwner:uy};function s1(){throw Error("act(...) is not supported in production builds of React.")}Ke.Children={map:pf,forEach:function(t,e,n){pf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return pf(t,function(){e++}),e},toArray:function(t){return pf(t,function(e){return e})||[]},only:function(t){if(!dy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ke.Component=Nl;Ke.Fragment=XN;Ke.Profiler=KN;Ke.PureComponent=cy;Ke.StrictMode=$N;Ke.Suspense=qN;Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s_;Ke.act=s1;Ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=e1({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=uy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)r1.call(e,c)&&!i1.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Vd,type:t.type,key:i,ref:o,props:r,_owner:s}};Ke.createContext=function(t){return t={$$typeof:YN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:JN,_context:t},t.Consumer=t};Ke.createElement=o1;Ke.createFactory=function(t){var e=o1.bind(null,t);return e.type=t,e};Ke.createRef=function(){return{current:null}};Ke.forwardRef=function(t){return{$$typeof:QN,render:t}};Ke.isValidElement=dy;Ke.lazy=function(t){return{$$typeof:t_,_payload:{_status:-1,_result:t},_init:o_}};Ke.memo=function(t,e){return{$$typeof:e_,type:t,compare:e===void 0?null:e}};Ke.startTransition=function(t){var e=$f.transition;$f.transition={};try{t()}finally{$f.transition=e}};Ke.unstable_act=s1;Ke.useCallback=function(t,e){return tr.current.useCallback(t,e)};Ke.useContext=function(t){return tr.current.useContext(t)};Ke.useDebugValue=function(){};Ke.useDeferredValue=function(t){return tr.current.useDeferredValue(t)};Ke.useEffect=function(t,e){return tr.current.useEffect(t,e)};Ke.useId=function(){return tr.current.useId()};Ke.useImperativeHandle=function(t,e,n){return tr.current.useImperativeHandle(t,e,n)};Ke.useInsertionEffect=function(t,e){return tr.current.useInsertionEffect(t,e)};Ke.useLayoutEffect=function(t,e){return tr.current.useLayoutEffect(t,e)};Ke.useMemo=function(t,e){return tr.current.useMemo(t,e)};Ke.useReducer=function(t,e,n){return tr.current.useReducer(t,e,n)};Ke.useRef=function(t){return tr.current.useRef(t)};Ke.useState=function(t){return tr.current.useState(t)};Ke.useSyncExternalStore=function(t,e,n){return tr.current.useSyncExternalStore(t,e,n)};Ke.useTransition=function(){return tr.current.useTransition()};Ke.version="18.3.1";QA.exports=Ke;var b=QA.exports;const ct=Ud(b),a_=JA({__proto__:null,default:ct},[b]);var c_=b,l_=Symbol.for("react.element"),u_=Symbol.for("react.fragment"),d_=Object.prototype.hasOwnProperty,f_=c_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h_={key:!0,ref:!0,__self:!0,__source:!0};function a1(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)d_.call(e,r)&&!h_.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:l_,type:t,key:o,ref:s,props:i,_owner:f_.current}}Fp.Fragment=u_;Fp.jsx=a1;Fp.jsxs=a1;YA.exports=Fp;var K=YA.exports,jm={},c1={exports:{}},jr={},l1={exports:{}},u1={};(function(t){function e($,z){var se=$.length;$.push(z);e:for(;0<se;){var j=se-1>>>1,oe=$[j];if(0<i(oe,z))$[j]=z,$[se]=oe,se=j;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var z=$[0],se=$.pop();if(se!==z){$[0]=se;e:for(var j=0,oe=$.length,Ce=oe>>>1;j<Ce;){var Be=2*(j+1)-1,fe=$[Be],Pe=Be+1,Xe=$[Pe];if(0>i(fe,se))Pe<oe&&0>i(Xe,fe)?($[j]=Xe,$[Pe]=se,j=Pe):($[j]=fe,$[Be]=se,j=Be);else if(Pe<oe&&0>i(Xe,se))$[j]=Xe,$[Pe]=se,j=Pe;else break e}}return z}function i($,z){var se=$.sortIndex-z.sortIndex;return se!==0?se:$.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var c=[],l=[],u=1,d=null,f=3,h=!1,p=!1,m=!1,C=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S($){for(var z=n(l);z!==null;){if(z.callback===null)r(l);else if(z.startTime<=$)r(l),z.sortIndex=z.expirationTime,e(c,z);else break;z=n(l)}}function k($){if(m=!1,S($),!p)if(n(c)!==null)p=!0,te(A);else{var z=n(l);z!==null&&le(k,z.startTime-$)}}function A($,z){p=!1,m&&(m=!1,g(w),w=-1),h=!0;var se=f;try{for(S(z),d=n(c);d!==null&&(!(d.expirationTime>z)||$&&!L());){var j=d.callback;if(typeof j=="function"){d.callback=null,f=d.priorityLevel;var oe=j(d.expirationTime<=z);z=t.unstable_now(),typeof oe=="function"?d.callback=oe:d===n(c)&&r(c),S(z)}else r(c);d=n(c)}if(d!==null)var Ce=!0;else{var Be=n(l);Be!==null&&le(k,Be.startTime-z),Ce=!1}return Ce}finally{d=null,f=se,h=!1}}var R=!1,P=null,w=-1,_=5,O=-1;function L(){return!(t.unstable_now()-O<_)}function U(){if(P!==null){var $=t.unstable_now();O=$;var z=!0;try{z=P(!0,$)}finally{z?X():(R=!1,P=null)}}else R=!1}var X;if(typeof v=="function")X=function(){v(U)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,J=H.port2;H.port1.onmessage=U,X=function(){J.postMessage(null)}}else X=function(){C(U,0)};function te($){P=$,R||(R=!0,X())}function le($,z){w=C(function(){$(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,te(A))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function($){switch(f){case 1:case 2:case 3:var z=3;break;default:z=f}var se=f;f=z;try{return $()}finally{f=se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,z){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var se=f;f=$;try{return z()}finally{f=se}},t.unstable_scheduleCallback=function($,z,se){var j=t.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?j+se:j):se=j,$){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=se+oe,$={id:u++,callback:z,priorityLevel:$,startTime:se,expirationTime:oe,sortIndex:-1},se>j?($.sortIndex=se,e(l,$),n(c)===null&&$===n(l)&&(m?(g(w),w=-1):m=!0,le(k,se-j))):($.sortIndex=oe,e(c,$),p||h||(p=!0,te(A))),$},t.unstable_shouldYield=L,t.unstable_wrapCallback=function($){var z=f;return function(){var se=f;f=z;try{return $.apply(this,arguments)}finally{f=se}}}})(u1);l1.exports=u1;var p_=l1.exports,g_=b,Vr=p_;function ce(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d1=new Set,qu={};function fc(t,e){hl(t,e),hl(t+"Capture",e)}function hl(t,e){for(qu[t]=e,t=0;t<e.length;t++)d1.add(e[t])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zm=Object.prototype.hasOwnProperty,m_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xI={},PI={};function v_(t){return Zm.call(PI,t)?!0:Zm.call(xI,t)?!1:m_.test(t)?PI[t]=!0:(xI[t]=!0,!1)}function y_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function C_(t,e,n,r){if(e===null||typeof e>"u"||y_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){An[t]=new nr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];An[e]=new nr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){An[t]=new nr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){An[t]=new nr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){An[t]=new nr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){An[t]=new nr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){An[t]=new nr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){An[t]=new nr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){An[t]=new nr(t,5,!1,t.toLowerCase(),null,!1,!1)});var fy=/[\-:]([a-z])/g;function hy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fy,hy);An[e]=new nr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fy,hy);An[e]=new nr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fy,hy);An[e]=new nr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){An[t]=new nr(t,1,!1,t.toLowerCase(),null,!1,!1)});An.xlinkHref=new nr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){An[t]=new nr(t,1,!1,t.toLowerCase(),null,!0,!0)});function py(t,e,n,r){var i=An.hasOwnProperty(e)?An[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(C_(e,n,i,r)&&(n=null),r||i===null?v_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Cs=g_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gf=Symbol.for("react.element"),Nc=Symbol.for("react.portal"),_c=Symbol.for("react.fragment"),gy=Symbol.for("react.strict_mode"),Hm=Symbol.for("react.profiler"),f1=Symbol.for("react.provider"),h1=Symbol.for("react.context"),my=Symbol.for("react.forward_ref"),zm=Symbol.for("react.suspense"),Xm=Symbol.for("react.suspense_list"),vy=Symbol.for("react.memo"),Ls=Symbol.for("react.lazy"),p1=Symbol.for("react.offscreen"),NI=Symbol.iterator;function Ql(t){return t===null||typeof t!="object"?null:(t=NI&&t[NI]||t["@@iterator"],typeof t=="function"?t:null)}var Mt=Object.assign,Rg;function Su(t){if(Rg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Rg=e&&e[1]||""}return`
`+Rg+t}var xg=!1;function Pg(t,e){if(!t||xg)return"";xg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var c=`
`+i[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=a);break}}}finally{xg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Su(t):""}function I_(t){switch(t.tag){case 5:return Su(t.type);case 16:return Su("Lazy");case 13:return Su("Suspense");case 19:return Su("SuspenseList");case 0:case 2:case 15:return t=Pg(t.type,!1),t;case 11:return t=Pg(t.type.render,!1),t;case 1:return t=Pg(t.type,!0),t;default:return""}}function $m(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _c:return"Fragment";case Nc:return"Portal";case Hm:return"Profiler";case gy:return"StrictMode";case zm:return"Suspense";case Xm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case h1:return(t.displayName||"Context")+".Consumer";case f1:return(t._context.displayName||"Context")+".Provider";case my:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case vy:return e=t.displayName||null,e!==null?e:$m(t.type)||"Memo";case Ls:e=t._payload,t=t._init;try{return $m(t(e))}catch{}}return null}function S_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $m(e);case 8:return e===gy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function la(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function g1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function b_(t){var e=g1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mf(t){t._valueTracker||(t._valueTracker=b_(t))}function m1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=g1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function _h(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Km(t,e){var n=e.checked;return Mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function _I(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=la(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function v1(t,e){e=e.checked,e!=null&&py(t,"checked",e,!1)}function Jm(t,e){v1(t,e);var n=la(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ym(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ym(t,e.type,la(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function OI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ym(t,e,n){(e!=="number"||_h(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bu=Array.isArray;function Xc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+la(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Qm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function MI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ce(92));if(bu(n)){if(1<n.length)throw Error(ce(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:la(n)}}function y1(t,e){var n=la(e.value),r=la(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function DI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function C1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?C1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vf,I1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(vf=vf||document.createElement("div"),vf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ed(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Lu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w_=["Webkit","ms","Moz","O"];Object.keys(Lu).forEach(function(t){w_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Lu[e]=Lu[t]})});function S1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Lu.hasOwnProperty(t)&&Lu[t]?(""+e).trim():e+"px"}function b1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=S1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var A_=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ev(t,e){if(e){if(A_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function tv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nv=null;function yy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var rv=null,$c=null,Kc=null;function LI(t){if(t=jd(t)){if(typeof rv!="function")throw Error(ce(280));var e=t.stateNode;e&&(e=Wp(e),rv(t.stateNode,t.type,e))}}function w1(t){$c?Kc?Kc.push(t):Kc=[t]:$c=t}function A1(){if($c){var t=$c,e=Kc;if(Kc=$c=null,LI(t),e)for(t=0;t<e.length;t++)LI(e[t])}}function k1(t,e){return t(e)}function E1(){}var Ng=!1;function T1(t,e,n){if(Ng)return t(e,n);Ng=!0;try{return k1(t,e,n)}finally{Ng=!1,($c!==null||Kc!==null)&&(E1(),A1())}}function td(t,e){var n=t.stateNode;if(n===null)return null;var r=Wp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ce(231,e,typeof n));return n}var iv=!1;if(us)try{var ql={};Object.defineProperty(ql,"passive",{get:function(){iv=!0}}),window.addEventListener("test",ql,ql),window.removeEventListener("test",ql,ql)}catch{iv=!1}function k_(t,e,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var Fu=!1,Oh=null,Mh=!1,ov=null,E_={onError:function(t){Fu=!0,Oh=t}};function T_(t,e,n,r,i,o,s,a,c){Fu=!1,Oh=null,k_.apply(E_,arguments)}function R_(t,e,n,r,i,o,s,a,c){if(T_.apply(this,arguments),Fu){if(Fu){var l=Oh;Fu=!1,Oh=null}else throw Error(ce(198));Mh||(Mh=!0,ov=l)}}function hc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function R1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function FI(t){if(hc(t)!==t)throw Error(ce(188))}function x_(t){var e=t.alternate;if(!e){if(e=hc(t),e===null)throw Error(ce(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return FI(i),t;if(o===r)return FI(i),e;o=o.sibling}throw Error(ce(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ce(189))}}if(n.alternate!==r)throw Error(ce(190))}if(n.tag!==3)throw Error(ce(188));return n.stateNode.current===n?t:e}function x1(t){return t=x_(t),t!==null?P1(t):null}function P1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=P1(t);if(e!==null)return e;t=t.sibling}return null}var N1=Vr.unstable_scheduleCallback,BI=Vr.unstable_cancelCallback,P_=Vr.unstable_shouldYield,N_=Vr.unstable_requestPaint,Zt=Vr.unstable_now,__=Vr.unstable_getCurrentPriorityLevel,Cy=Vr.unstable_ImmediatePriority,_1=Vr.unstable_UserBlockingPriority,Dh=Vr.unstable_NormalPriority,O_=Vr.unstable_LowPriority,O1=Vr.unstable_IdlePriority,Bp=null,po=null;function M_(t){if(po&&typeof po.onCommitFiberRoot=="function")try{po.onCommitFiberRoot(Bp,t,void 0,(t.current.flags&128)===128)}catch{}}var Ni=Math.clz32?Math.clz32:F_,D_=Math.log,L_=Math.LN2;function F_(t){return t>>>=0,t===0?32:31-(D_(t)/L_|0)|0}var yf=64,Cf=4194304;function wu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Lh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=wu(a):(o&=s,o!==0&&(r=wu(o)))}else s=n&~i,s!==0?r=wu(s):o!==0&&(r=wu(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ni(e),i=1<<n,r|=t[n],e&=~i;return r}function B_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Ni(o),a=1<<s,c=i[s];c===-1?(!(a&n)||a&r)&&(i[s]=B_(a,e)):c<=e&&(t.expiredLanes|=a),o&=~a}}function sv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function M1(){var t=yf;return yf<<=1,!(yf&4194240)&&(yf=64),t}function _g(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Gd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ni(e),t[e]=n}function V_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ni(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Iy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ni(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var lt=0;function D1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var L1,Sy,F1,B1,U1,av=!1,If=[],qs=null,ea=null,ta=null,nd=new Map,rd=new Map,Us=[],G_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function UI(t,e){switch(t){case"focusin":case"focusout":qs=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":nd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rd.delete(e.pointerId)}}function eu(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=jd(e),e!==null&&Sy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function W_(t,e,n,r,i){switch(e){case"focusin":return qs=eu(qs,t,e,n,r,i),!0;case"dragenter":return ea=eu(ea,t,e,n,r,i),!0;case"mouseover":return ta=eu(ta,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return nd.set(o,eu(nd.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,rd.set(o,eu(rd.get(o)||null,t,e,n,r,i)),!0}return!1}function V1(t){var e=Fa(t.target);if(e!==null){var n=hc(e);if(n!==null){if(e=n.tag,e===13){if(e=R1(n),e!==null){t.blockedOn=e,U1(t.priority,function(){F1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Kf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=cv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);nv=r,n.target.dispatchEvent(r),nv=null}else return e=jd(n),e!==null&&Sy(e),t.blockedOn=n,!1;e.shift()}return!0}function VI(t,e,n){Kf(t)&&n.delete(e)}function j_(){av=!1,qs!==null&&Kf(qs)&&(qs=null),ea!==null&&Kf(ea)&&(ea=null),ta!==null&&Kf(ta)&&(ta=null),nd.forEach(VI),rd.forEach(VI)}function tu(t,e){t.blockedOn===e&&(t.blockedOn=null,av||(av=!0,Vr.unstable_scheduleCallback(Vr.unstable_NormalPriority,j_)))}function id(t){function e(i){return tu(i,t)}if(0<If.length){tu(If[0],t);for(var n=1;n<If.length;n++){var r=If[n];r.blockedOn===t&&(r.blockedOn=null)}}for(qs!==null&&tu(qs,t),ea!==null&&tu(ea,t),ta!==null&&tu(ta,t),nd.forEach(e),rd.forEach(e),n=0;n<Us.length;n++)r=Us[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Us.length&&(n=Us[0],n.blockedOn===null);)V1(n),n.blockedOn===null&&Us.shift()}var Jc=Cs.ReactCurrentBatchConfig,Fh=!0;function Z_(t,e,n,r){var i=lt,o=Jc.transition;Jc.transition=null;try{lt=1,by(t,e,n,r)}finally{lt=i,Jc.transition=o}}function H_(t,e,n,r){var i=lt,o=Jc.transition;Jc.transition=null;try{lt=4,by(t,e,n,r)}finally{lt=i,Jc.transition=o}}function by(t,e,n,r){if(Fh){var i=cv(t,e,n,r);if(i===null)Wg(t,e,r,Bh,n),UI(t,r);else if(W_(i,t,e,n,r))r.stopPropagation();else if(UI(t,r),e&4&&-1<G_.indexOf(t)){for(;i!==null;){var o=jd(i);if(o!==null&&L1(o),o=cv(t,e,n,r),o===null&&Wg(t,e,r,Bh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Wg(t,e,r,null,n)}}var Bh=null;function cv(t,e,n,r){if(Bh=null,t=yy(r),t=Fa(t),t!==null)if(e=hc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=R1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bh=t,null}function G1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(__()){case Cy:return 1;case _1:return 4;case Dh:case O_:return 16;case O1:return 536870912;default:return 16}default:return 16}}var Ws=null,wy=null,Jf=null;function W1(){if(Jf)return Jf;var t,e=wy,n=e.length,r,i="value"in Ws?Ws.value:Ws.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return Jf=i.slice(t,1<r?1-r:void 0)}function Yf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sf(){return!0}function GI(){return!1}function Zr(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Sf:GI,this.isPropagationStopped=GI,this}return Mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sf)},persist:function(){},isPersistent:Sf}),e}var _l={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ay=Zr(_l),Wd=Mt({},_l,{view:0,detail:0}),z_=Zr(Wd),Og,Mg,nu,Up=Mt({},Wd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ky,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==nu&&(nu&&t.type==="mousemove"?(Og=t.screenX-nu.screenX,Mg=t.screenY-nu.screenY):Mg=Og=0,nu=t),Og)},movementY:function(t){return"movementY"in t?t.movementY:Mg}}),WI=Zr(Up),X_=Mt({},Up,{dataTransfer:0}),$_=Zr(X_),K_=Mt({},Wd,{relatedTarget:0}),Dg=Zr(K_),J_=Mt({},_l,{animationName:0,elapsedTime:0,pseudoElement:0}),Y_=Zr(J_),Q_=Mt({},_l,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),q_=Zr(Q_),eO=Mt({},_l,{data:0}),jI=Zr(eO),tO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=rO[t])?!!e[t]:!1}function ky(){return iO}var oO=Mt({},Wd,{key:function(t){if(t.key){var e=tO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Yf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?nO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ky,charCode:function(t){return t.type==="keypress"?Yf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Yf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sO=Zr(oO),aO=Mt({},Up,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ZI=Zr(aO),cO=Mt({},Wd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ky}),lO=Zr(cO),uO=Mt({},_l,{propertyName:0,elapsedTime:0,pseudoElement:0}),dO=Zr(uO),fO=Mt({},Up,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hO=Zr(fO),pO=[9,13,27,32],Ey=us&&"CompositionEvent"in window,Bu=null;us&&"documentMode"in document&&(Bu=document.documentMode);var gO=us&&"TextEvent"in window&&!Bu,j1=us&&(!Ey||Bu&&8<Bu&&11>=Bu),HI=" ",zI=!1;function Z1(t,e){switch(t){case"keyup":return pO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function H1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Oc=!1;function mO(t,e){switch(t){case"compositionend":return H1(e);case"keypress":return e.which!==32?null:(zI=!0,HI);case"textInput":return t=e.data,t===HI&&zI?null:t;default:return null}}function vO(t,e){if(Oc)return t==="compositionend"||!Ey&&Z1(t,e)?(t=W1(),Jf=wy=Ws=null,Oc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return j1&&e.locale!=="ko"?null:e.data;default:return null}}var yO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function XI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!yO[t.type]:e==="textarea"}function z1(t,e,n,r){w1(r),e=Uh(e,"onChange"),0<e.length&&(n=new Ay("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Uu=null,od=null;function CO(t){rk(t,0)}function Vp(t){var e=Lc(t);if(m1(e))return t}function IO(t,e){if(t==="change")return e}var X1=!1;if(us){var Lg;if(us){var Fg="oninput"in document;if(!Fg){var $I=document.createElement("div");$I.setAttribute("oninput","return;"),Fg=typeof $I.oninput=="function"}Lg=Fg}else Lg=!1;X1=Lg&&(!document.documentMode||9<document.documentMode)}function KI(){Uu&&(Uu.detachEvent("onpropertychange",$1),od=Uu=null)}function $1(t){if(t.propertyName==="value"&&Vp(od)){var e=[];z1(e,od,t,yy(t)),T1(CO,e)}}function SO(t,e,n){t==="focusin"?(KI(),Uu=e,od=n,Uu.attachEvent("onpropertychange",$1)):t==="focusout"&&KI()}function bO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vp(od)}function wO(t,e){if(t==="click")return Vp(e)}function AO(t,e){if(t==="input"||t==="change")return Vp(e)}function kO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mi=typeof Object.is=="function"?Object.is:kO;function sd(t,e){if(Mi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Zm.call(e,i)||!Mi(t[i],e[i]))return!1}return!0}function JI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function YI(t,e){var n=JI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=JI(n)}}function K1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?K1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function J1(){for(var t=window,e=_h();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=_h(t.document)}return e}function Ty(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function EO(t){var e=J1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&K1(n.ownerDocument.documentElement,n)){if(r!==null&&Ty(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=YI(n,o);var s=YI(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var TO=us&&"documentMode"in document&&11>=document.documentMode,Mc=null,lv=null,Vu=null,uv=!1;function QI(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;uv||Mc==null||Mc!==_h(r)||(r=Mc,"selectionStart"in r&&Ty(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vu&&sd(Vu,r)||(Vu=r,r=Uh(lv,"onSelect"),0<r.length&&(e=new Ay("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mc)))}function bf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Dc={animationend:bf("Animation","AnimationEnd"),animationiteration:bf("Animation","AnimationIteration"),animationstart:bf("Animation","AnimationStart"),transitionend:bf("Transition","TransitionEnd")},Bg={},Y1={};us&&(Y1=document.createElement("div").style,"AnimationEvent"in window||(delete Dc.animationend.animation,delete Dc.animationiteration.animation,delete Dc.animationstart.animation),"TransitionEvent"in window||delete Dc.transitionend.transition);function Gp(t){if(Bg[t])return Bg[t];if(!Dc[t])return t;var e=Dc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Y1)return Bg[t]=e[n];return t}var Q1=Gp("animationend"),q1=Gp("animationiteration"),ek=Gp("animationstart"),tk=Gp("transitionend"),nk=new Map,qI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ga(t,e){nk.set(t,e),fc(e,[t])}for(var Ug=0;Ug<qI.length;Ug++){var Vg=qI[Ug],RO=Vg.toLowerCase(),xO=Vg[0].toUpperCase()+Vg.slice(1);ga(RO,"on"+xO)}ga(Q1,"onAnimationEnd");ga(q1,"onAnimationIteration");ga(ek,"onAnimationStart");ga("dblclick","onDoubleClick");ga("focusin","onFocus");ga("focusout","onBlur");ga(tk,"onTransitionEnd");hl("onMouseEnter",["mouseout","mouseover"]);hl("onMouseLeave",["mouseout","mouseover"]);hl("onPointerEnter",["pointerout","pointerover"]);hl("onPointerLeave",["pointerout","pointerover"]);fc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fc("onBeforeInput",["compositionend","keypress","textInput","paste"]);fc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PO=new Set("cancel close invalid load scroll toggle".split(" ").concat(Au));function eS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,R_(r,e,void 0,t),t.currentTarget=null}function rk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;eS(i,a,l),o=c}else for(s=0;s<r.length;s++){if(a=r[s],c=a.instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;eS(i,a,l),o=c}}}if(Mh)throw t=ov,Mh=!1,ov=null,t}function Ct(t,e){var n=e[gv];n===void 0&&(n=e[gv]=new Set);var r=t+"__bubble";n.has(r)||(ik(e,t,2,!1),n.add(r))}function Gg(t,e,n){var r=0;e&&(r|=4),ik(n,t,r,e)}var wf="_reactListening"+Math.random().toString(36).slice(2);function ad(t){if(!t[wf]){t[wf]=!0,d1.forEach(function(n){n!=="selectionchange"&&(PO.has(n)||Gg(n,!1,t),Gg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wf]||(e[wf]=!0,Gg("selectionchange",!1,e))}}function ik(t,e,n,r){switch(G1(e)){case 1:var i=Z_;break;case 4:i=H_;break;default:i=by}n=i.bind(null,e,n,t),i=void 0,!iv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Wg(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Fa(a),s===null)return;if(c=s.tag,c===5||c===6){r=o=s;continue e}a=a.parentNode}}r=r.return}T1(function(){var l=o,u=yy(n),d=[];e:{var f=nk.get(t);if(f!==void 0){var h=Ay,p=t;switch(t){case"keypress":if(Yf(n)===0)break e;case"keydown":case"keyup":h=sO;break;case"focusin":p="focus",h=Dg;break;case"focusout":p="blur",h=Dg;break;case"beforeblur":case"afterblur":h=Dg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=WI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=$_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=lO;break;case Q1:case q1:case ek:h=Y_;break;case tk:h=dO;break;case"scroll":h=z_;break;case"wheel":h=hO;break;case"copy":case"cut":case"paste":h=q_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=ZI}var m=(e&4)!==0,C=!m&&t==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var v=l,S;v!==null;){S=v;var k=S.stateNode;if(S.tag===5&&k!==null&&(S=k,g!==null&&(k=td(v,g),k!=null&&m.push(cd(v,k,S)))),C)break;v=v.return}0<m.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==nv&&(p=n.relatedTarget||n.fromElement)&&(Fa(p)||p[ds]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?Fa(p):null,p!==null&&(C=hc(p),p!==C||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(m=WI,k="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=ZI,k="onPointerLeave",g="onPointerEnter",v="pointer"),C=h==null?f:Lc(h),S=p==null?f:Lc(p),f=new m(k,v+"leave",h,n,u),f.target=C,f.relatedTarget=S,k=null,Fa(u)===l&&(m=new m(g,v+"enter",p,n,u),m.target=S,m.relatedTarget=C,k=m),C=k,h&&p)t:{for(m=h,g=p,v=0,S=m;S;S=wc(S))v++;for(S=0,k=g;k;k=wc(k))S++;for(;0<v-S;)m=wc(m),v--;for(;0<S-v;)g=wc(g),S--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=wc(m),g=wc(g)}m=null}else m=null;h!==null&&tS(d,f,h,m,!1),p!==null&&C!==null&&tS(d,C,p,m,!0)}}e:{if(f=l?Lc(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var A=IO;else if(XI(f))if(X1)A=AO;else{A=bO;var R=SO}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(A=wO);if(A&&(A=A(t,l))){z1(d,A,n,u);break e}R&&R(t,f,l),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&Ym(f,"number",f.value)}switch(R=l?Lc(l):window,t){case"focusin":(XI(R)||R.contentEditable==="true")&&(Mc=R,lv=l,Vu=null);break;case"focusout":Vu=lv=Mc=null;break;case"mousedown":uv=!0;break;case"contextmenu":case"mouseup":case"dragend":uv=!1,QI(d,n,u);break;case"selectionchange":if(TO)break;case"keydown":case"keyup":QI(d,n,u)}var P;if(Ey)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Oc?Z1(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(j1&&n.locale!=="ko"&&(Oc||w!=="onCompositionStart"?w==="onCompositionEnd"&&Oc&&(P=W1()):(Ws=u,wy="value"in Ws?Ws.value:Ws.textContent,Oc=!0)),R=Uh(l,w),0<R.length&&(w=new jI(w,t,null,n,u),d.push({event:w,listeners:R}),P?w.data=P:(P=H1(n),P!==null&&(w.data=P)))),(P=gO?mO(t,n):vO(t,n))&&(l=Uh(l,"onBeforeInput"),0<l.length&&(u=new jI("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=P))}rk(d,e)})}function cd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Uh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=td(t,n),o!=null&&r.unshift(cd(t,o,i)),o=td(t,e),o!=null&&r.push(cd(t,o,i))),t=t.return}return r}function wc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function tS(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=td(n,o),c!=null&&s.unshift(cd(n,c,a))):i||(c=td(n,o),c!=null&&s.push(cd(n,c,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var NO=/\r\n?/g,_O=/\u0000|\uFFFD/g;function nS(t){return(typeof t=="string"?t:""+t).replace(NO,`
`).replace(_O,"")}function Af(t,e,n){if(e=nS(e),nS(t)!==e&&n)throw Error(ce(425))}function Vh(){}var dv=null,fv=null;function hv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var pv=typeof setTimeout=="function"?setTimeout:void 0,OO=typeof clearTimeout=="function"?clearTimeout:void 0,rS=typeof Promise=="function"?Promise:void 0,MO=typeof queueMicrotask=="function"?queueMicrotask:typeof rS<"u"?function(t){return rS.resolve(null).then(t).catch(DO)}:pv;function DO(t){setTimeout(function(){throw t})}function jg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),id(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);id(e)}function na(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function iS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ol=Math.random().toString(36).slice(2),$i="__reactFiber$"+Ol,ld="__reactProps$"+Ol,ds="__reactContainer$"+Ol,gv="__reactEvents$"+Ol,LO="__reactListeners$"+Ol,FO="__reactHandles$"+Ol;function Fa(t){var e=t[$i];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ds]||n[$i]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=iS(t);t!==null;){if(n=t[$i])return n;t=iS(t)}return e}t=n,n=t.parentNode}return null}function jd(t){return t=t[$i]||t[ds],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Lc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ce(33))}function Wp(t){return t[ld]||null}var mv=[],Fc=-1;function ma(t){return{current:t}}function At(t){0>Fc||(t.current=mv[Fc],mv[Fc]=null,Fc--)}function vt(t,e){Fc++,mv[Fc]=t.current,t.current=e}var ua={},Bn=ma(ua),pr=ma(!1),Qa=ua;function pl(t,e){var n=t.type.contextTypes;if(!n)return ua;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function gr(t){return t=t.childContextTypes,t!=null}function Gh(){At(pr),At(Bn)}function oS(t,e,n){if(Bn.current!==ua)throw Error(ce(168));vt(Bn,e),vt(pr,n)}function ok(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ce(108,S_(t)||"Unknown",i));return Mt({},n,r)}function Wh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ua,Qa=Bn.current,vt(Bn,t),vt(pr,pr.current),!0}function sS(t,e,n){var r=t.stateNode;if(!r)throw Error(ce(169));n?(t=ok(t,e,Qa),r.__reactInternalMemoizedMergedChildContext=t,At(pr),At(Bn),vt(Bn,t)):At(pr),vt(pr,n)}var xo=null,jp=!1,Zg=!1;function sk(t){xo===null?xo=[t]:xo.push(t)}function BO(t){jp=!0,sk(t)}function va(){if(!Zg&&xo!==null){Zg=!0;var t=0,e=lt;try{var n=xo;for(lt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}xo=null,jp=!1}catch(i){throw xo!==null&&(xo=xo.slice(t+1)),N1(Cy,va),i}finally{lt=e,Zg=!1}}return null}var Bc=[],Uc=0,jh=null,Zh=0,Jr=[],Yr=0,qa=null,Mo=1,Do="";function Ra(t,e){Bc[Uc++]=Zh,Bc[Uc++]=jh,jh=t,Zh=e}function ak(t,e,n){Jr[Yr++]=Mo,Jr[Yr++]=Do,Jr[Yr++]=qa,qa=t;var r=Mo;t=Do;var i=32-Ni(r)-1;r&=~(1<<i),n+=1;var o=32-Ni(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Mo=1<<32-Ni(e)+i|n<<i|r,Do=o+t}else Mo=1<<o|n<<i|r,Do=t}function Ry(t){t.return!==null&&(Ra(t,1),ak(t,1,0))}function xy(t){for(;t===jh;)jh=Bc[--Uc],Bc[Uc]=null,Zh=Bc[--Uc],Bc[Uc]=null;for(;t===qa;)qa=Jr[--Yr],Jr[Yr]=null,Do=Jr[--Yr],Jr[Yr]=null,Mo=Jr[--Yr],Jr[Yr]=null}var Br=null,Lr=null,Rt=!1,wi=null;function ck(t,e){var n=qr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function aS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Br=t,Lr=na(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Br=t,Lr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qa!==null?{id:Mo,overflow:Do}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=qr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Br=t,Lr=null,!0):!1;default:return!1}}function vv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function yv(t){if(Rt){var e=Lr;if(e){var n=e;if(!aS(t,e)){if(vv(t))throw Error(ce(418));e=na(n.nextSibling);var r=Br;e&&aS(t,e)?ck(r,n):(t.flags=t.flags&-4097|2,Rt=!1,Br=t)}}else{if(vv(t))throw Error(ce(418));t.flags=t.flags&-4097|2,Rt=!1,Br=t}}}function cS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Br=t}function kf(t){if(t!==Br)return!1;if(!Rt)return cS(t),Rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hv(t.type,t.memoizedProps)),e&&(e=Lr)){if(vv(t))throw lk(),Error(ce(418));for(;e;)ck(t,e),e=na(e.nextSibling)}if(cS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ce(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Lr=na(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Lr=null}}else Lr=Br?na(t.stateNode.nextSibling):null;return!0}function lk(){for(var t=Lr;t;)t=na(t.nextSibling)}function gl(){Lr=Br=null,Rt=!1}function Py(t){wi===null?wi=[t]:wi.push(t)}var UO=Cs.ReactCurrentBatchConfig;function ru(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ce(309));var r=n.stateNode}if(!r)throw Error(ce(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(ce(284));if(!n._owner)throw Error(ce(290,t))}return t}function Ef(t,e){throw t=Object.prototype.toString.call(e),Error(ce(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lS(t){var e=t._init;return e(t._payload)}function uk(t){function e(g,v){if(t){var S=g.deletions;S===null?(g.deletions=[v],g.flags|=16):S.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function i(g,v){return g=sa(g,v),g.index=0,g.sibling=null,g}function o(g,v,S){return g.index=S,t?(S=g.alternate,S!==null?(S=S.index,S<v?(g.flags|=2,v):S):(g.flags|=2,v)):(g.flags|=1048576,v)}function s(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,v,S,k){return v===null||v.tag!==6?(v=Yg(S,g.mode,k),v.return=g,v):(v=i(v,S),v.return=g,v)}function c(g,v,S,k){var A=S.type;return A===_c?u(g,v,S.props.children,k,S.key):v!==null&&(v.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ls&&lS(A)===v.type)?(k=i(v,S.props),k.ref=ru(g,v,S),k.return=g,k):(k=ih(S.type,S.key,S.props,null,g.mode,k),k.ref=ru(g,v,S),k.return=g,k)}function l(g,v,S,k){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=Qg(S,g.mode,k),v.return=g,v):(v=i(v,S.children||[]),v.return=g,v)}function u(g,v,S,k,A){return v===null||v.tag!==7?(v=za(S,g.mode,k,A),v.return=g,v):(v=i(v,S),v.return=g,v)}function d(g,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Yg(""+v,g.mode,S),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case gf:return S=ih(v.type,v.key,v.props,null,g.mode,S),S.ref=ru(g,null,v),S.return=g,S;case Nc:return v=Qg(v,g.mode,S),v.return=g,v;case Ls:var k=v._init;return d(g,k(v._payload),S)}if(bu(v)||Ql(v))return v=za(v,g.mode,S,null),v.return=g,v;Ef(g,v)}return null}function f(g,v,S,k){var A=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return A!==null?null:a(g,v,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case gf:return S.key===A?c(g,v,S,k):null;case Nc:return S.key===A?l(g,v,S,k):null;case Ls:return A=S._init,f(g,v,A(S._payload),k)}if(bu(S)||Ql(S))return A!==null?null:u(g,v,S,k,null);Ef(g,S)}return null}function h(g,v,S,k,A){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(S)||null,a(v,g,""+k,A);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case gf:return g=g.get(k.key===null?S:k.key)||null,c(v,g,k,A);case Nc:return g=g.get(k.key===null?S:k.key)||null,l(v,g,k,A);case Ls:var R=k._init;return h(g,v,S,R(k._payload),A)}if(bu(k)||Ql(k))return g=g.get(S)||null,u(v,g,k,A,null);Ef(v,k)}return null}function p(g,v,S,k){for(var A=null,R=null,P=v,w=v=0,_=null;P!==null&&w<S.length;w++){P.index>w?(_=P,P=null):_=P.sibling;var O=f(g,P,S[w],k);if(O===null){P===null&&(P=_);break}t&&P&&O.alternate===null&&e(g,P),v=o(O,v,w),R===null?A=O:R.sibling=O,R=O,P=_}if(w===S.length)return n(g,P),Rt&&Ra(g,w),A;if(P===null){for(;w<S.length;w++)P=d(g,S[w],k),P!==null&&(v=o(P,v,w),R===null?A=P:R.sibling=P,R=P);return Rt&&Ra(g,w),A}for(P=r(g,P);w<S.length;w++)_=h(P,g,w,S[w],k),_!==null&&(t&&_.alternate!==null&&P.delete(_.key===null?w:_.key),v=o(_,v,w),R===null?A=_:R.sibling=_,R=_);return t&&P.forEach(function(L){return e(g,L)}),Rt&&Ra(g,w),A}function m(g,v,S,k){var A=Ql(S);if(typeof A!="function")throw Error(ce(150));if(S=A.call(S),S==null)throw Error(ce(151));for(var R=A=null,P=v,w=v=0,_=null,O=S.next();P!==null&&!O.done;w++,O=S.next()){P.index>w?(_=P,P=null):_=P.sibling;var L=f(g,P,O.value,k);if(L===null){P===null&&(P=_);break}t&&P&&L.alternate===null&&e(g,P),v=o(L,v,w),R===null?A=L:R.sibling=L,R=L,P=_}if(O.done)return n(g,P),Rt&&Ra(g,w),A;if(P===null){for(;!O.done;w++,O=S.next())O=d(g,O.value,k),O!==null&&(v=o(O,v,w),R===null?A=O:R.sibling=O,R=O);return Rt&&Ra(g,w),A}for(P=r(g,P);!O.done;w++,O=S.next())O=h(P,g,w,O.value,k),O!==null&&(t&&O.alternate!==null&&P.delete(O.key===null?w:O.key),v=o(O,v,w),R===null?A=O:R.sibling=O,R=O);return t&&P.forEach(function(U){return e(g,U)}),Rt&&Ra(g,w),A}function C(g,v,S,k){if(typeof S=="object"&&S!==null&&S.type===_c&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case gf:e:{for(var A=S.key,R=v;R!==null;){if(R.key===A){if(A=S.type,A===_c){if(R.tag===7){n(g,R.sibling),v=i(R,S.props.children),v.return=g,g=v;break e}}else if(R.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ls&&lS(A)===R.type){n(g,R.sibling),v=i(R,S.props),v.ref=ru(g,R,S),v.return=g,g=v;break e}n(g,R);break}else e(g,R);R=R.sibling}S.type===_c?(v=za(S.props.children,g.mode,k,S.key),v.return=g,g=v):(k=ih(S.type,S.key,S.props,null,g.mode,k),k.ref=ru(g,v,S),k.return=g,g=k)}return s(g);case Nc:e:{for(R=S.key;v!==null;){if(v.key===R)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){n(g,v.sibling),v=i(v,S.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=Qg(S,g.mode,k),v.return=g,g=v}return s(g);case Ls:return R=S._init,C(g,v,R(S._payload),k)}if(bu(S))return p(g,v,S,k);if(Ql(S))return m(g,v,S,k);Ef(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(n(g,v.sibling),v=i(v,S),v.return=g,g=v):(n(g,v),v=Yg(S,g.mode,k),v.return=g,g=v),s(g)):n(g,v)}return C}var ml=uk(!0),dk=uk(!1),Hh=ma(null),zh=null,Vc=null,Ny=null;function _y(){Ny=Vc=zh=null}function Oy(t){var e=Hh.current;At(Hh),t._currentValue=e}function Cv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yc(t,e){zh=t,Ny=Vc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(fr=!0),t.firstContext=null)}function ri(t){var e=t._currentValue;if(Ny!==t)if(t={context:t,memoizedValue:e,next:null},Vc===null){if(zh===null)throw Error(ce(308));Vc=t,zh.dependencies={lanes:0,firstContext:t}}else Vc=Vc.next=t;return e}var Ba=null;function My(t){Ba===null?Ba=[t]:Ba.push(t)}function fk(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,My(e)):(n.next=i.next,i.next=n),e.interleaved=n,fs(t,r)}function fs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fs=!1;function Dy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ss(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ra(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,nt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,fs(t,n)}return i=r.interleaved,i===null?(e.next=e,My(r)):(e.next=i.next,i.next=e),r.interleaved=e,fs(t,n)}function Qf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Iy(t,n)}}function uS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xh(t,e,n,r){var i=t.updateQueue;Fs=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,s===null?o=l:s.next=l,s=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(o!==null){var d=i.baseState;s=0,u=l=c=null,a=o;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Mt({},d,f);break e;case 2:Fs=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=h,c=d):u=u.next=h,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);tc|=s,t.lanes=s,t.memoizedState=d}}function dS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ce(191,i));i.call(r)}}}var Zd={},go=ma(Zd),ud=ma(Zd),dd=ma(Zd);function Ua(t){if(t===Zd)throw Error(ce(174));return t}function Ly(t,e){switch(vt(dd,e),vt(ud,t),vt(go,Zd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qm(e,t)}At(go),vt(go,e)}function vl(){At(go),At(ud),At(dd)}function pk(t){Ua(dd.current);var e=Ua(go.current),n=qm(e,t.type);e!==n&&(vt(ud,t),vt(go,n))}function Fy(t){ud.current===t&&(At(go),At(ud))}var _t=ma(0);function $h(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hg=[];function By(){for(var t=0;t<Hg.length;t++)Hg[t]._workInProgressVersionPrimary=null;Hg.length=0}var qf=Cs.ReactCurrentDispatcher,zg=Cs.ReactCurrentBatchConfig,ec=0,Ot=null,on=null,hn=null,Kh=!1,Gu=!1,fd=0,VO=0;function Nn(){throw Error(ce(321))}function Uy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mi(t[n],e[n]))return!1;return!0}function Vy(t,e,n,r,i,o){if(ec=o,Ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qf.current=t===null||t.memoizedState===null?ZO:HO,t=n(r,i),Gu){o=0;do{if(Gu=!1,fd=0,25<=o)throw Error(ce(301));o+=1,hn=on=null,e.updateQueue=null,qf.current=zO,t=n(r,i)}while(Gu)}if(qf.current=Jh,e=on!==null&&on.next!==null,ec=0,hn=on=Ot=null,Kh=!1,e)throw Error(ce(300));return t}function Gy(){var t=fd!==0;return fd=0,t}function zi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Ot.memoizedState=hn=t:hn=hn.next=t,hn}function ii(){if(on===null){var t=Ot.alternate;t=t!==null?t.memoizedState:null}else t=on.next;var e=hn===null?Ot.memoizedState:hn.next;if(e!==null)hn=e,on=t;else{if(t===null)throw Error(ce(310));on=t,t={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},hn===null?Ot.memoizedState=hn=t:hn=hn.next=t}return hn}function hd(t,e){return typeof e=="function"?e(t):e}function Xg(t){var e=ii(),n=e.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=t;var r=on,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,c=null,l=o;do{var u=l.lane;if((ec&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,s=r):c=c.next=d,Ot.lanes|=u,tc|=u}l=l.next}while(l!==null&&l!==o);c===null?s=r:c.next=a,Mi(r,e.memoizedState)||(fr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Ot.lanes|=o,tc|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $g(t){var e=ii(),n=e.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Mi(o,e.memoizedState)||(fr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function gk(){}function mk(t,e){var n=Ot,r=ii(),i=e(),o=!Mi(r.memoizedState,i);if(o&&(r.memoizedState=i,fr=!0),r=r.queue,Wy(Ck.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||hn!==null&&hn.memoizedState.tag&1){if(n.flags|=2048,pd(9,yk.bind(null,n,r,i,e),void 0,null),gn===null)throw Error(ce(349));ec&30||vk(n,e,i)}return i}function vk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function yk(t,e,n,r){e.value=n,e.getSnapshot=r,Ik(e)&&Sk(t)}function Ck(t,e,n){return n(function(){Ik(e)&&Sk(t)})}function Ik(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mi(t,n)}catch{return!0}}function Sk(t){var e=fs(t,1);e!==null&&_i(e,t,1,-1)}function fS(t){var e=zi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hd,lastRenderedState:t},e.queue=t,t=t.dispatch=jO.bind(null,Ot,t),[e.memoizedState,t]}function pd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function bk(){return ii().memoizedState}function eh(t,e,n,r){var i=zi();Ot.flags|=t,i.memoizedState=pd(1|e,n,void 0,r===void 0?null:r)}function Zp(t,e,n,r){var i=ii();r=r===void 0?null:r;var o=void 0;if(on!==null){var s=on.memoizedState;if(o=s.destroy,r!==null&&Uy(r,s.deps)){i.memoizedState=pd(e,n,o,r);return}}Ot.flags|=t,i.memoizedState=pd(1|e,n,o,r)}function hS(t,e){return eh(8390656,8,t,e)}function Wy(t,e){return Zp(2048,8,t,e)}function wk(t,e){return Zp(4,2,t,e)}function Ak(t,e){return Zp(4,4,t,e)}function kk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ek(t,e,n){return n=n!=null?n.concat([t]):null,Zp(4,4,kk.bind(null,e,t),n)}function jy(){}function Tk(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Rk(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function xk(t,e,n){return ec&21?(Mi(n,e)||(n=M1(),Ot.lanes|=n,tc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,fr=!0),t.memoizedState=n)}function GO(t,e){var n=lt;lt=n!==0&&4>n?n:4,t(!0);var r=zg.transition;zg.transition={};try{t(!1),e()}finally{lt=n,zg.transition=r}}function Pk(){return ii().memoizedState}function WO(t,e,n){var r=oa(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Nk(t))_k(e,n);else if(n=fk(t,e,n,r),n!==null){var i=qn();_i(n,t,r,i),Ok(n,e,r)}}function jO(t,e,n){var r=oa(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Nk(t))_k(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Mi(a,s)){var c=e.interleaved;c===null?(i.next=i,My(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=fk(t,e,i,r),n!==null&&(i=qn(),_i(n,t,r,i),Ok(n,e,r))}}function Nk(t){var e=t.alternate;return t===Ot||e!==null&&e===Ot}function _k(t,e){Gu=Kh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ok(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Iy(t,n)}}var Jh={readContext:ri,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},ZO={readContext:ri,useCallback:function(t,e){return zi().memoizedState=[t,e===void 0?null:e],t},useContext:ri,useEffect:hS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,eh(4194308,4,kk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return eh(4194308,4,t,e)},useInsertionEffect:function(t,e){return eh(4,2,t,e)},useMemo:function(t,e){var n=zi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=zi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=WO.bind(null,Ot,t),[r.memoizedState,t]},useRef:function(t){var e=zi();return t={current:t},e.memoizedState=t},useState:fS,useDebugValue:jy,useDeferredValue:function(t){return zi().memoizedState=t},useTransition:function(){var t=fS(!1),e=t[0];return t=GO.bind(null,t[1]),zi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ot,i=zi();if(Rt){if(n===void 0)throw Error(ce(407));n=n()}else{if(n=e(),gn===null)throw Error(ce(349));ec&30||vk(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,hS(Ck.bind(null,r,o,t),[t]),r.flags|=2048,pd(9,yk.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=zi(),e=gn.identifierPrefix;if(Rt){var n=Do,r=Mo;n=(r&~(1<<32-Ni(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=VO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},HO={readContext:ri,useCallback:Tk,useContext:ri,useEffect:Wy,useImperativeHandle:Ek,useInsertionEffect:wk,useLayoutEffect:Ak,useMemo:Rk,useReducer:Xg,useRef:bk,useState:function(){return Xg(hd)},useDebugValue:jy,useDeferredValue:function(t){var e=ii();return xk(e,on.memoizedState,t)},useTransition:function(){var t=Xg(hd)[0],e=ii().memoizedState;return[t,e]},useMutableSource:gk,useSyncExternalStore:mk,useId:Pk,unstable_isNewReconciler:!1},zO={readContext:ri,useCallback:Tk,useContext:ri,useEffect:Wy,useImperativeHandle:Ek,useInsertionEffect:wk,useLayoutEffect:Ak,useMemo:Rk,useReducer:$g,useRef:bk,useState:function(){return $g(hd)},useDebugValue:jy,useDeferredValue:function(t){var e=ii();return on===null?e.memoizedState=t:xk(e,on.memoizedState,t)},useTransition:function(){var t=$g(hd)[0],e=ii().memoizedState;return[t,e]},useMutableSource:gk,useSyncExternalStore:mk,useId:Pk,unstable_isNewReconciler:!1};function di(t,e){if(t&&t.defaultProps){e=Mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Iv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Hp={isMounted:function(t){return(t=t._reactInternals)?hc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=qn(),i=oa(t),o=ss(r,i);o.payload=e,n!=null&&(o.callback=n),e=ra(t,o,i),e!==null&&(_i(e,t,i,r),Qf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=qn(),i=oa(t),o=ss(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ra(t,o,i),e!==null&&(_i(e,t,i,r),Qf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=qn(),r=oa(t),i=ss(n,r);i.tag=2,e!=null&&(i.callback=e),e=ra(t,i,r),e!==null&&(_i(e,t,r,n),Qf(e,t,r))}};function pS(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!sd(n,r)||!sd(i,o):!0}function Mk(t,e,n){var r=!1,i=ua,o=e.contextType;return typeof o=="object"&&o!==null?o=ri(o):(i=gr(e)?Qa:Bn.current,r=e.contextTypes,o=(r=r!=null)?pl(t,i):ua),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Hp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function gS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Hp.enqueueReplaceState(e,e.state,null)}function Sv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Dy(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=ri(o):(o=gr(e)?Qa:Bn.current,i.context=pl(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Iv(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Hp.enqueueReplaceState(i,i.state,null),Xh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function yl(t,e){try{var n="",r=e;do n+=I_(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Kg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function bv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var XO=typeof WeakMap=="function"?WeakMap:Map;function Dk(t,e,n){n=ss(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qh||(Qh=!0,_v=r),bv(t,e)},n}function Lk(t,e,n){n=ss(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){bv(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){bv(t,e),typeof r!="function"&&(ia===null?ia=new Set([this]):ia.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function mS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new XO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=aM.bind(null,t,e,n),e.then(t,t))}function vS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yS(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ss(-1,1),e.tag=2,ra(n,e,1))),n.lanes|=1),t)}var $O=Cs.ReactCurrentOwner,fr=!1;function zn(t,e,n,r){e.child=t===null?dk(e,null,n,r):ml(e,t.child,n,r)}function CS(t,e,n,r,i){n=n.render;var o=e.ref;return Yc(e,i),r=Vy(t,e,n,r,o,i),n=Gy(),t!==null&&!fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hs(t,e,i)):(Rt&&n&&Ry(e),e.flags|=1,zn(t,e,r,i),e.child)}function IS(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Yy(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Fk(t,e,o,r,i)):(t=ih(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:sd,n(s,r)&&t.ref===e.ref)return hs(t,e,i)}return e.flags|=1,t=sa(o,r),t.ref=e.ref,t.return=e,e.child=t}function Fk(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(sd(o,r)&&t.ref===e.ref)if(fr=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(fr=!0);else return e.lanes=t.lanes,hs(t,e,i)}return wv(t,e,n,r,i)}function Bk(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(Wc,xr),xr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vt(Wc,xr),xr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,vt(Wc,xr),xr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,vt(Wc,xr),xr|=r;return zn(t,e,i,n),e.child}function Uk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function wv(t,e,n,r,i){var o=gr(n)?Qa:Bn.current;return o=pl(e,o),Yc(e,i),n=Vy(t,e,n,r,o,i),r=Gy(),t!==null&&!fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hs(t,e,i)):(Rt&&r&&Ry(e),e.flags|=1,zn(t,e,n,i),e.child)}function SS(t,e,n,r,i){if(gr(n)){var o=!0;Wh(e)}else o=!1;if(Yc(e,i),e.stateNode===null)th(t,e),Mk(e,n,r),Sv(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var c=s.context,l=n.contextType;typeof l=="object"&&l!==null?l=ri(l):(l=gr(n)?Qa:Bn.current,l=pl(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||c!==l)&&gS(e,s,r,l),Fs=!1;var f=e.memoizedState;s.state=f,Xh(e,r,s,i),c=e.memoizedState,a!==r||f!==c||pr.current||Fs?(typeof u=="function"&&(Iv(e,n,u,r),c=e.memoizedState),(a=Fs||pS(e,n,a,r,f,c,l))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,hk(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:di(e.type,a),s.props=l,d=e.pendingProps,f=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=ri(c):(c=gr(n)?Qa:Bn.current,c=pl(e,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||f!==c)&&gS(e,s,r,c),Fs=!1,f=e.memoizedState,s.state=f,Xh(e,r,s,i);var p=e.memoizedState;a!==d||f!==p||pr.current||Fs?(typeof h=="function"&&(Iv(e,n,h,r),p=e.memoizedState),(l=Fs||pS(e,n,l,r,f,p,c)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=c,r=l):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Av(t,e,n,r,o,i)}function Av(t,e,n,r,i,o){Uk(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&sS(e,n,!1),hs(t,e,o);r=e.stateNode,$O.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=ml(e,t.child,null,o),e.child=ml(e,null,a,o)):zn(t,e,a,o),e.memoizedState=r.state,i&&sS(e,n,!0),e.child}function Vk(t){var e=t.stateNode;e.pendingContext?oS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&oS(t,e.context,!1),Ly(t,e.containerInfo)}function bS(t,e,n,r,i){return gl(),Py(i),e.flags|=256,zn(t,e,n,r),e.child}var kv={dehydrated:null,treeContext:null,retryLane:0};function Ev(t){return{baseLanes:t,cachePool:null,transitions:null}}function Gk(t,e,n){var r=e.pendingProps,i=_t.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),vt(_t,i&1),t===null)return yv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=$p(s,r,0,null),t=za(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Ev(n),e.memoizedState=kv,t):Zy(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return KO(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=sa(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=sa(a,o):(o=za(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Ev(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=kv,r}return o=t.child,t=o.sibling,r=sa(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Zy(t,e){return e=$p({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Tf(t,e,n,r){return r!==null&&Py(r),ml(e,t.child,null,n),t=Zy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function KO(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Kg(Error(ce(422))),Tf(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=$p({mode:"visible",children:r.children},i,0,null),o=za(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ml(e,t.child,null,s),e.child.memoizedState=Ev(s),e.memoizedState=kv,o);if(!(e.mode&1))return Tf(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ce(419)),r=Kg(o,r,void 0),Tf(t,e,s,r)}if(a=(s&t.childLanes)!==0,fr||a){if(r=gn,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,fs(t,i),_i(r,t,i,-1))}return Jy(),r=Kg(Error(ce(421))),Tf(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=cM.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Lr=na(i.nextSibling),Br=e,Rt=!0,wi=null,t!==null&&(Jr[Yr++]=Mo,Jr[Yr++]=Do,Jr[Yr++]=qa,Mo=t.id,Do=t.overflow,qa=e),e=Zy(e,r.children),e.flags|=4096,e)}function wS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Cv(t.return,e,n)}function Jg(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Wk(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(zn(t,e,r.children,n),r=_t.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wS(t,n,e);else if(t.tag===19)wS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(vt(_t,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&$h(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Jg(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&$h(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Jg(e,!0,n,null,o);break;case"together":Jg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function th(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),tc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ce(153));if(e.child!==null){for(t=e.child,n=sa(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=sa(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function JO(t,e,n){switch(e.tag){case 3:Vk(e),gl();break;case 5:pk(e);break;case 1:gr(e.type)&&Wh(e);break;case 4:Ly(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;vt(Hh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(vt(_t,_t.current&1),e.flags|=128,null):n&e.child.childLanes?Gk(t,e,n):(vt(_t,_t.current&1),t=hs(t,e,n),t!==null?t.sibling:null);vt(_t,_t.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Wk(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),vt(_t,_t.current),r)break;return null;case 22:case 23:return e.lanes=0,Bk(t,e,n)}return hs(t,e,n)}var jk,Tv,Zk,Hk;jk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Tv=function(){};Zk=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ua(go.current);var o=null;switch(n){case"input":i=Km(t,i),r=Km(t,r),o=[];break;case"select":i=Mt({},i,{value:void 0}),r=Mt({},r,{value:void 0}),o=[];break;case"textarea":i=Qm(t,i),r=Qm(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Vh)}ev(n,r);var s;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(qu.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&a[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(qu.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&Ct("scroll",t),o||a===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(e.updateQueue=l)&&(e.flags|=4)}};Hk=function(t,e,n,r){n!==r&&(e.flags|=4)};function iu(t,e){if(!Rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function _n(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function YO(t,e,n){var r=e.pendingProps;switch(xy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(e),null;case 1:return gr(e.type)&&Gh(),_n(e),null;case 3:return r=e.stateNode,vl(),At(pr),At(Bn),By(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(kf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wi!==null&&(Dv(wi),wi=null))),Tv(t,e),_n(e),null;case 5:Fy(e);var i=Ua(dd.current);if(n=e.type,t!==null&&e.stateNode!=null)Zk(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ce(166));return _n(e),null}if(t=Ua(go.current),kf(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[$i]=e,r[ld]=o,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",r),Ct("close",r);break;case"iframe":case"object":case"embed":Ct("load",r);break;case"video":case"audio":for(i=0;i<Au.length;i++)Ct(Au[i],r);break;case"source":Ct("error",r);break;case"img":case"image":case"link":Ct("error",r),Ct("load",r);break;case"details":Ct("toggle",r);break;case"input":_I(r,o),Ct("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ct("invalid",r);break;case"textarea":MI(r,o),Ct("invalid",r)}ev(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Af(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Af(r.textContent,a,t),i=["children",""+a]):qu.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Ct("scroll",r)}switch(n){case"input":mf(r),OI(r,o,!0);break;case"textarea":mf(r),DI(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Vh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=C1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[$i]=e,t[ld]=r,jk(t,e,!1,!1),e.stateNode=t;e:{switch(s=tv(n,r),n){case"dialog":Ct("cancel",t),Ct("close",t),i=r;break;case"iframe":case"object":case"embed":Ct("load",t),i=r;break;case"video":case"audio":for(i=0;i<Au.length;i++)Ct(Au[i],t);i=r;break;case"source":Ct("error",t),i=r;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),i=r;break;case"details":Ct("toggle",t),i=r;break;case"input":_I(t,r),i=Km(t,r),Ct("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Mt({},r,{value:void 0}),Ct("invalid",t);break;case"textarea":MI(t,r),i=Qm(t,r),Ct("invalid",t);break;default:i=r}ev(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?b1(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&I1(t,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ed(t,c):typeof c=="number"&&ed(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(qu.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Ct("scroll",t):c!=null&&py(t,o,c,s))}switch(n){case"input":mf(t),OI(t,r,!1);break;case"textarea":mf(t),DI(t);break;case"option":r.value!=null&&t.setAttribute("value",""+la(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Xc(t,!!r.multiple,o,!1):r.defaultValue!=null&&Xc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Vh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _n(e),null;case 6:if(t&&e.stateNode!=null)Hk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ce(166));if(n=Ua(dd.current),Ua(go.current),kf(e)){if(r=e.stateNode,n=e.memoizedProps,r[$i]=e,(o=r.nodeValue!==n)&&(t=Br,t!==null))switch(t.tag){case 3:Af(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Af(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$i]=e,e.stateNode=r}return _n(e),null;case 13:if(At(_t),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Rt&&Lr!==null&&e.mode&1&&!(e.flags&128))lk(),gl(),e.flags|=98560,o=!1;else if(o=kf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ce(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ce(317));o[$i]=e}else gl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_n(e),o=!1}else wi!==null&&(Dv(wi),wi=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||_t.current&1?sn===0&&(sn=3):Jy())),e.updateQueue!==null&&(e.flags|=4),_n(e),null);case 4:return vl(),Tv(t,e),t===null&&ad(e.stateNode.containerInfo),_n(e),null;case 10:return Oy(e.type._context),_n(e),null;case 17:return gr(e.type)&&Gh(),_n(e),null;case 19:if(At(_t),o=e.memoizedState,o===null)return _n(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)iu(o,!1);else{if(sn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=$h(t),s!==null){for(e.flags|=128,iu(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return vt(_t,_t.current&1|2),e.child}t=t.sibling}o.tail!==null&&Zt()>Cl&&(e.flags|=128,r=!0,iu(o,!1),e.lanes=4194304)}else{if(!r)if(t=$h(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),iu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Rt)return _n(e),null}else 2*Zt()-o.renderingStartTime>Cl&&n!==1073741824&&(e.flags|=128,r=!0,iu(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Zt(),e.sibling=null,n=_t.current,vt(_t,r?n&1|2:n&1),e):(_n(e),null);case 22:case 23:return Ky(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xr&1073741824&&(_n(e),e.subtreeFlags&6&&(e.flags|=8192)):_n(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function QO(t,e){switch(xy(e),e.tag){case 1:return gr(e.type)&&Gh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return vl(),At(pr),At(Bn),By(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Fy(e),null;case 13:if(At(_t),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));gl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return At(_t),null;case 4:return vl(),null;case 10:return Oy(e.type._context),null;case 22:case 23:return Ky(),null;case 24:return null;default:return null}}var Rf=!1,Mn=!1,qO=typeof WeakSet=="function"?WeakSet:Set,Se=null;function Gc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Bt(t,e,r)}else n.current=null}function Rv(t,e,n){try{n()}catch(r){Bt(t,e,r)}}var AS=!1;function eM(t,e){if(dv=Fh,t=J1(),Ty(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,c=-1,l=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(c=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++l===i&&(a=s),f===o&&++u===r&&(c=s),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(fv={focusedElem:t,selectionRange:n},Fh=!1,Se=e;Se!==null;)if(e=Se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Se=t;else for(;Se!==null;){e=Se;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,C=p.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:di(e.type,m),C);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(k){Bt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Se=t;break}Se=e.return}return p=AS,AS=!1,p}function Wu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Rv(e,n,o)}i=i.next}while(i!==r)}}function zp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function xv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function zk(t){var e=t.alternate;e!==null&&(t.alternate=null,zk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$i],delete e[ld],delete e[gv],delete e[LO],delete e[FO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Xk(t){return t.tag===5||t.tag===3||t.tag===4}function kS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Xk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Vh));else if(r!==4&&(t=t.child,t!==null))for(Pv(t,e,n),t=t.sibling;t!==null;)Pv(t,e,n),t=t.sibling}function Nv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Nv(t,e,n),t=t.sibling;t!==null;)Nv(t,e,n),t=t.sibling}var vn=null,Ii=!1;function ks(t,e,n){for(n=n.child;n!==null;)$k(t,e,n),n=n.sibling}function $k(t,e,n){if(po&&typeof po.onCommitFiberUnmount=="function")try{po.onCommitFiberUnmount(Bp,n)}catch{}switch(n.tag){case 5:Mn||Gc(n,e);case 6:var r=vn,i=Ii;vn=null,ks(t,e,n),vn=r,Ii=i,vn!==null&&(Ii?(t=vn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vn.removeChild(n.stateNode));break;case 18:vn!==null&&(Ii?(t=vn,n=n.stateNode,t.nodeType===8?jg(t.parentNode,n):t.nodeType===1&&jg(t,n),id(t)):jg(vn,n.stateNode));break;case 4:r=vn,i=Ii,vn=n.stateNode.containerInfo,Ii=!0,ks(t,e,n),vn=r,Ii=i;break;case 0:case 11:case 14:case 15:if(!Mn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Rv(n,e,s),i=i.next}while(i!==r)}ks(t,e,n);break;case 1:if(!Mn&&(Gc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Bt(n,e,a)}ks(t,e,n);break;case 21:ks(t,e,n);break;case 22:n.mode&1?(Mn=(r=Mn)||n.memoizedState!==null,ks(t,e,n),Mn=r):ks(t,e,n);break;default:ks(t,e,n)}}function ES(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new qO),e.forEach(function(r){var i=lM.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ai(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:vn=a.stateNode,Ii=!1;break e;case 3:vn=a.stateNode.containerInfo,Ii=!0;break e;case 4:vn=a.stateNode.containerInfo,Ii=!0;break e}a=a.return}if(vn===null)throw Error(ce(160));$k(o,s,i),vn=null,Ii=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Bt(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Kk(e,t),e=e.sibling}function Kk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ai(e,t),Wi(t),r&4){try{Wu(3,t,t.return),zp(3,t)}catch(m){Bt(t,t.return,m)}try{Wu(5,t,t.return)}catch(m){Bt(t,t.return,m)}}break;case 1:ai(e,t),Wi(t),r&512&&n!==null&&Gc(n,n.return);break;case 5:if(ai(e,t),Wi(t),r&512&&n!==null&&Gc(n,n.return),t.flags&32){var i=t.stateNode;try{ed(i,"")}catch(m){Bt(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&v1(i,o),tv(a,s);var l=tv(a,o);for(s=0;s<c.length;s+=2){var u=c[s],d=c[s+1];u==="style"?b1(i,d):u==="dangerouslySetInnerHTML"?I1(i,d):u==="children"?ed(i,d):py(i,u,d,l)}switch(a){case"input":Jm(i,o);break;case"textarea":y1(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Xc(i,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?Xc(i,!!o.multiple,o.defaultValue,!0):Xc(i,!!o.multiple,o.multiple?[]:"",!1))}i[ld]=o}catch(m){Bt(t,t.return,m)}}break;case 6:if(ai(e,t),Wi(t),r&4){if(t.stateNode===null)throw Error(ce(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(m){Bt(t,t.return,m)}}break;case 3:if(ai(e,t),Wi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{id(e.containerInfo)}catch(m){Bt(t,t.return,m)}break;case 4:ai(e,t),Wi(t);break;case 13:ai(e,t),Wi(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Xy=Zt())),r&4&&ES(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Mn=(l=Mn)||u,ai(e,t),Mn=l):ai(e,t),Wi(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(Se=t,u=t.child;u!==null;){for(d=Se=u;Se!==null;){switch(f=Se,h=f.child,f.tag){case 0:case 11:case 14:case 15:Wu(4,f,f.return);break;case 1:Gc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Bt(r,n,m)}}break;case 5:Gc(f,f.return);break;case 22:if(f.memoizedState!==null){RS(d);continue}}h!==null?(h.return=f,Se=h):RS(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,c=d.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=S1("display",s))}catch(m){Bt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){Bt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ai(e,t),Wi(t),r&4&&ES(t);break;case 21:break;default:ai(e,t),Wi(t)}}function Wi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Xk(n)){var r=n;break e}n=n.return}throw Error(ce(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ed(i,""),r.flags&=-33);var o=kS(t);Nv(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=kS(t);Pv(t,a,s);break;default:throw Error(ce(161))}}catch(c){Bt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tM(t,e,n){Se=t,Jk(t)}function Jk(t,e,n){for(var r=(t.mode&1)!==0;Se!==null;){var i=Se,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Rf;if(!s){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Mn;a=Rf;var l=Mn;if(Rf=s,(Mn=c)&&!l)for(Se=i;Se!==null;)s=Se,c=s.child,s.tag===22&&s.memoizedState!==null?xS(i):c!==null?(c.return=s,Se=c):xS(i);for(;o!==null;)Se=o,Jk(o),o=o.sibling;Se=i,Rf=a,Mn=l}TS(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Se=o):TS(t)}}function TS(t){for(;Se!==null;){var e=Se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Mn||zp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Mn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:di(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&dS(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}dS(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&id(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Mn||e.flags&512&&xv(e)}catch(f){Bt(e,e.return,f)}}if(e===t){Se=null;break}if(n=e.sibling,n!==null){n.return=e.return,Se=n;break}Se=e.return}}function RS(t){for(;Se!==null;){var e=Se;if(e===t){Se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Se=n;break}Se=e.return}}function xS(t){for(;Se!==null;){var e=Se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{zp(4,e)}catch(c){Bt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Bt(e,i,c)}}var o=e.return;try{xv(e)}catch(c){Bt(e,o,c)}break;case 5:var s=e.return;try{xv(e)}catch(c){Bt(e,s,c)}}}catch(c){Bt(e,e.return,c)}if(e===t){Se=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Se=a;break}Se=e.return}}var nM=Math.ceil,Yh=Cs.ReactCurrentDispatcher,Hy=Cs.ReactCurrentOwner,ni=Cs.ReactCurrentBatchConfig,nt=0,gn=null,Yt=null,bn=0,xr=0,Wc=ma(0),sn=0,gd=null,tc=0,Xp=0,zy=0,ju=null,lr=null,Xy=0,Cl=1/0,To=null,Qh=!1,_v=null,ia=null,xf=!1,js=null,qh=0,Zu=0,Ov=null,nh=-1,rh=0;function qn(){return nt&6?Zt():nh!==-1?nh:nh=Zt()}function oa(t){return t.mode&1?nt&2&&bn!==0?bn&-bn:UO.transition!==null?(rh===0&&(rh=M1()),rh):(t=lt,t!==0||(t=window.event,t=t===void 0?16:G1(t.type)),t):1}function _i(t,e,n,r){if(50<Zu)throw Zu=0,Ov=null,Error(ce(185));Gd(t,n,r),(!(nt&2)||t!==gn)&&(t===gn&&(!(nt&2)&&(Xp|=n),sn===4&&Vs(t,bn)),mr(t,r),n===1&&nt===0&&!(e.mode&1)&&(Cl=Zt()+500,jp&&va()))}function mr(t,e){var n=t.callbackNode;U_(t,e);var r=Lh(t,t===gn?bn:0);if(r===0)n!==null&&BI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&BI(n),e===1)t.tag===0?BO(PS.bind(null,t)):sk(PS.bind(null,t)),MO(function(){!(nt&6)&&va()}),n=null;else{switch(D1(r)){case 1:n=Cy;break;case 4:n=_1;break;case 16:n=Dh;break;case 536870912:n=O1;break;default:n=Dh}n=iE(n,Yk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Yk(t,e){if(nh=-1,rh=0,nt&6)throw Error(ce(327));var n=t.callbackNode;if(Qc()&&t.callbackNode!==n)return null;var r=Lh(t,t===gn?bn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ep(t,r);else{e=r;var i=nt;nt|=2;var o=qk();(gn!==t||bn!==e)&&(To=null,Cl=Zt()+500,Ha(t,e));do try{oM();break}catch(a){Qk(t,a)}while(!0);_y(),Yh.current=o,nt=i,Yt!==null?e=0:(gn=null,bn=0,e=sn)}if(e!==0){if(e===2&&(i=sv(t),i!==0&&(r=i,e=Mv(t,i))),e===1)throw n=gd,Ha(t,0),Vs(t,r),mr(t,Zt()),n;if(e===6)Vs(t,r);else{if(i=t.current.alternate,!(r&30)&&!rM(i)&&(e=ep(t,r),e===2&&(o=sv(t),o!==0&&(r=o,e=Mv(t,o))),e===1))throw n=gd,Ha(t,0),Vs(t,r),mr(t,Zt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ce(345));case 2:xa(t,lr,To);break;case 3:if(Vs(t,r),(r&130023424)===r&&(e=Xy+500-Zt(),10<e)){if(Lh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){qn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=pv(xa.bind(null,t,lr,To),e);break}xa(t,lr,To);break;case 4:if(Vs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Ni(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Zt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nM(r/1960))-r,10<r){t.timeoutHandle=pv(xa.bind(null,t,lr,To),r);break}xa(t,lr,To);break;case 5:xa(t,lr,To);break;default:throw Error(ce(329))}}}return mr(t,Zt()),t.callbackNode===n?Yk.bind(null,t):null}function Mv(t,e){var n=ju;return t.current.memoizedState.isDehydrated&&(Ha(t,e).flags|=256),t=ep(t,e),t!==2&&(e=lr,lr=n,e!==null&&Dv(e)),t}function Dv(t){lr===null?lr=t:lr.push.apply(lr,t)}function rM(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Mi(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vs(t,e){for(e&=~zy,e&=~Xp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ni(e),r=1<<n;t[n]=-1,e&=~r}}function PS(t){if(nt&6)throw Error(ce(327));Qc();var e=Lh(t,0);if(!(e&1))return mr(t,Zt()),null;var n=ep(t,e);if(t.tag!==0&&n===2){var r=sv(t);r!==0&&(e=r,n=Mv(t,r))}if(n===1)throw n=gd,Ha(t,0),Vs(t,e),mr(t,Zt()),n;if(n===6)throw Error(ce(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xa(t,lr,To),mr(t,Zt()),null}function $y(t,e){var n=nt;nt|=1;try{return t(e)}finally{nt=n,nt===0&&(Cl=Zt()+500,jp&&va())}}function nc(t){js!==null&&js.tag===0&&!(nt&6)&&Qc();var e=nt;nt|=1;var n=ni.transition,r=lt;try{if(ni.transition=null,lt=1,t)return t()}finally{lt=r,ni.transition=n,nt=e,!(nt&6)&&va()}}function Ky(){xr=Wc.current,At(Wc)}function Ha(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,OO(n)),Yt!==null)for(n=Yt.return;n!==null;){var r=n;switch(xy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gh();break;case 3:vl(),At(pr),At(Bn),By();break;case 5:Fy(r);break;case 4:vl();break;case 13:At(_t);break;case 19:At(_t);break;case 10:Oy(r.type._context);break;case 22:case 23:Ky()}n=n.return}if(gn=t,Yt=t=sa(t.current,null),bn=xr=e,sn=0,gd=null,zy=Xp=tc=0,lr=ju=null,Ba!==null){for(e=0;e<Ba.length;e++)if(n=Ba[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Ba=null}return t}function Qk(t,e){do{var n=Yt;try{if(_y(),qf.current=Jh,Kh){for(var r=Ot.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Kh=!1}if(ec=0,hn=on=Ot=null,Gu=!1,fd=0,Hy.current=null,n===null||n.return===null){sn=1,gd=e,Yt=null;break}e:{var o=t,s=n.return,a=n,c=e;if(e=bn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=vS(s);if(h!==null){h.flags&=-257,yS(h,s,a,o,e),h.mode&1&&mS(o,l,e),e=h,c=l;var p=e.updateQueue;if(p===null){var m=new Set;m.add(c),e.updateQueue=m}else p.add(c);break e}else{if(!(e&1)){mS(o,l,e),Jy();break e}c=Error(ce(426))}}else if(Rt&&a.mode&1){var C=vS(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),yS(C,s,a,o,e),Py(yl(c,a));break e}}o=c=yl(c,a),sn!==4&&(sn=2),ju===null?ju=[o]:ju.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=Dk(o,c,e);uS(o,g);break e;case 1:a=c;var v=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ia===null||!ia.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var k=Lk(o,a,e);uS(o,k);break e}}o=o.return}while(o!==null)}tE(n)}catch(A){e=A,Yt===n&&n!==null&&(Yt=n=n.return);continue}break}while(!0)}function qk(){var t=Yh.current;return Yh.current=Jh,t===null?Jh:t}function Jy(){(sn===0||sn===3||sn===2)&&(sn=4),gn===null||!(tc&268435455)&&!(Xp&268435455)||Vs(gn,bn)}function ep(t,e){var n=nt;nt|=2;var r=qk();(gn!==t||bn!==e)&&(To=null,Ha(t,e));do try{iM();break}catch(i){Qk(t,i)}while(!0);if(_y(),nt=n,Yh.current=r,Yt!==null)throw Error(ce(261));return gn=null,bn=0,sn}function iM(){for(;Yt!==null;)eE(Yt)}function oM(){for(;Yt!==null&&!P_();)eE(Yt)}function eE(t){var e=rE(t.alternate,t,xr);t.memoizedProps=t.pendingProps,e===null?tE(t):Yt=e,Hy.current=null}function tE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QO(n,e),n!==null){n.flags&=32767,Yt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{sn=6,Yt=null;return}}else if(n=YO(n,e,xr),n!==null){Yt=n;return}if(e=e.sibling,e!==null){Yt=e;return}Yt=e=t}while(e!==null);sn===0&&(sn=5)}function xa(t,e,n){var r=lt,i=ni.transition;try{ni.transition=null,lt=1,sM(t,e,n,r)}finally{ni.transition=i,lt=r}return null}function sM(t,e,n,r){do Qc();while(js!==null);if(nt&6)throw Error(ce(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ce(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(V_(t,o),t===gn&&(Yt=gn=null,bn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xf||(xf=!0,iE(Dh,function(){return Qc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ni.transition,ni.transition=null;var s=lt;lt=1;var a=nt;nt|=4,Hy.current=null,eM(t,n),Kk(n,t),EO(fv),Fh=!!dv,fv=dv=null,t.current=n,tM(n),N_(),nt=a,lt=s,ni.transition=o}else t.current=n;if(xf&&(xf=!1,js=t,qh=i),o=t.pendingLanes,o===0&&(ia=null),M_(n.stateNode),mr(t,Zt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Qh)throw Qh=!1,t=_v,_v=null,t;return qh&1&&t.tag!==0&&Qc(),o=t.pendingLanes,o&1?t===Ov?Zu++:(Zu=0,Ov=t):Zu=0,va(),null}function Qc(){if(js!==null){var t=D1(qh),e=ni.transition,n=lt;try{if(ni.transition=null,lt=16>t?16:t,js===null)var r=!1;else{if(t=js,js=null,qh=0,nt&6)throw Error(ce(331));var i=nt;for(nt|=4,Se=t.current;Se!==null;){var o=Se,s=o.child;if(Se.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(Se=l;Se!==null;){var u=Se;switch(u.tag){case 0:case 11:case 15:Wu(8,u,o)}var d=u.child;if(d!==null)d.return=u,Se=d;else for(;Se!==null;){u=Se;var f=u.sibling,h=u.return;if(zk(u),u===l){Se=null;break}if(f!==null){f.return=h,Se=f;break}Se=h}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var C=m.sibling;m.sibling=null,m=C}while(m!==null)}}Se=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Se=s;else e:for(;Se!==null;){if(o=Se,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Wu(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,Se=g;break e}Se=o.return}}var v=t.current;for(Se=v;Se!==null;){s=Se;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,Se=S;else e:for(s=v;Se!==null;){if(a=Se,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:zp(9,a)}}catch(A){Bt(a,a.return,A)}if(a===s){Se=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,Se=k;break e}Se=a.return}}if(nt=i,va(),po&&typeof po.onPostCommitFiberRoot=="function")try{po.onPostCommitFiberRoot(Bp,t)}catch{}r=!0}return r}finally{lt=n,ni.transition=e}}return!1}function NS(t,e,n){e=yl(n,e),e=Dk(t,e,1),t=ra(t,e,1),e=qn(),t!==null&&(Gd(t,1,e),mr(t,e))}function Bt(t,e,n){if(t.tag===3)NS(t,t,n);else for(;e!==null;){if(e.tag===3){NS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ia===null||!ia.has(r))){t=yl(n,t),t=Lk(e,t,1),e=ra(e,t,1),t=qn(),e!==null&&(Gd(e,1,t),mr(e,t));break}}e=e.return}}function aM(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=qn(),t.pingedLanes|=t.suspendedLanes&n,gn===t&&(bn&n)===n&&(sn===4||sn===3&&(bn&130023424)===bn&&500>Zt()-Xy?Ha(t,0):zy|=n),mr(t,e)}function nE(t,e){e===0&&(t.mode&1?(e=Cf,Cf<<=1,!(Cf&130023424)&&(Cf=4194304)):e=1);var n=qn();t=fs(t,e),t!==null&&(Gd(t,e,n),mr(t,n))}function cM(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nE(t,n)}function lM(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ce(314))}r!==null&&r.delete(e),nE(t,n)}var rE;rE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pr.current)fr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return fr=!1,JO(t,e,n);fr=!!(t.flags&131072)}else fr=!1,Rt&&e.flags&1048576&&ak(e,Zh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;th(t,e),t=e.pendingProps;var i=pl(e,Bn.current);Yc(e,n),i=Vy(null,e,r,t,i,n);var o=Gy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gr(r)?(o=!0,Wh(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Dy(e),i.updater=Hp,e.stateNode=i,i._reactInternals=e,Sv(e,r,t,n),e=Av(null,e,r,!0,o,n)):(e.tag=0,Rt&&o&&Ry(e),zn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(th(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=dM(r),t=di(r,t),i){case 0:e=wv(null,e,r,t,n);break e;case 1:e=SS(null,e,r,t,n);break e;case 11:e=CS(null,e,r,t,n);break e;case 14:e=IS(null,e,r,di(r.type,t),n);break e}throw Error(ce(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),wv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),SS(t,e,r,i,n);case 3:e:{if(Vk(e),t===null)throw Error(ce(387));r=e.pendingProps,o=e.memoizedState,i=o.element,hk(t,e),Xh(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=yl(Error(ce(423)),e),e=bS(t,e,r,n,i);break e}else if(r!==i){i=yl(Error(ce(424)),e),e=bS(t,e,r,n,i);break e}else for(Lr=na(e.stateNode.containerInfo.firstChild),Br=e,Rt=!0,wi=null,n=dk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(gl(),r===i){e=hs(t,e,n);break e}zn(t,e,r,n)}e=e.child}return e;case 5:return pk(e),t===null&&yv(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,hv(r,i)?s=null:o!==null&&hv(r,o)&&(e.flags|=32),Uk(t,e),zn(t,e,s,n),e.child;case 6:return t===null&&yv(e),null;case 13:return Gk(t,e,n);case 4:return Ly(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ml(e,null,r,n):zn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),CS(t,e,r,i,n);case 7:return zn(t,e,e.pendingProps,n),e.child;case 8:return zn(t,e,e.pendingProps.children,n),e.child;case 12:return zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,vt(Hh,r._currentValue),r._currentValue=s,o!==null)if(Mi(o.value,s)){if(o.children===i.children&&!pr.current){e=hs(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=ss(-1,n&-n),c.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Cv(o.return,n,e),a.lanes|=n;break}c=c.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ce(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Cv(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}zn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Yc(e,n),i=ri(i),r=r(i),e.flags|=1,zn(t,e,r,n),e.child;case 14:return r=e.type,i=di(r,e.pendingProps),i=di(r.type,i),IS(t,e,r,i,n);case 15:return Fk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),th(t,e),e.tag=1,gr(r)?(t=!0,Wh(e)):t=!1,Yc(e,n),Mk(e,r,i),Sv(e,r,i,n),Av(null,e,r,!0,t,n);case 19:return Wk(t,e,n);case 22:return Bk(t,e,n)}throw Error(ce(156,e.tag))};function iE(t,e){return N1(t,e)}function uM(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(t,e,n,r){return new uM(t,e,n,r)}function Yy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dM(t){if(typeof t=="function")return Yy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===my)return 11;if(t===vy)return 14}return 2}function sa(t,e){var n=t.alternate;return n===null?(n=qr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ih(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")Yy(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case _c:return za(n.children,i,o,e);case gy:s=8,i|=8;break;case Hm:return t=qr(12,n,e,i|2),t.elementType=Hm,t.lanes=o,t;case zm:return t=qr(13,n,e,i),t.elementType=zm,t.lanes=o,t;case Xm:return t=qr(19,n,e,i),t.elementType=Xm,t.lanes=o,t;case p1:return $p(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case f1:s=10;break e;case h1:s=9;break e;case my:s=11;break e;case vy:s=14;break e;case Ls:s=16,r=null;break e}throw Error(ce(130,t==null?t:typeof t,""))}return e=qr(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function za(t,e,n,r){return t=qr(7,t,r,e),t.lanes=n,t}function $p(t,e,n,r){return t=qr(22,t,r,e),t.elementType=p1,t.lanes=n,t.stateNode={isHidden:!1},t}function Yg(t,e,n){return t=qr(6,t,null,e),t.lanes=n,t}function Qg(t,e,n){return e=qr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function fM(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_g(0),this.expirationTimes=_g(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_g(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qy(t,e,n,r,i,o,s,a,c){return t=new fM(t,e,n,a,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=qr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dy(o),t}function hM(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function oE(t){if(!t)return ua;t=t._reactInternals;e:{if(hc(t)!==t||t.tag!==1)throw Error(ce(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(t.tag===1){var n=t.type;if(gr(n))return ok(t,n,e)}return e}function sE(t,e,n,r,i,o,s,a,c){return t=Qy(n,r,!0,t,i,o,s,a,c),t.context=oE(null),n=t.current,r=qn(),i=oa(n),o=ss(r,i),o.callback=e??null,ra(n,o,i),t.current.lanes=i,Gd(t,i,r),mr(t,r),t}function Kp(t,e,n,r){var i=e.current,o=qn(),s=oa(i);return n=oE(n),e.context===null?e.context=n:e.pendingContext=n,e=ss(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ra(i,e,s),t!==null&&(_i(t,i,s,o),Qf(t,i,s)),s}function tp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _S(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qy(t,e){_S(t,e),(t=t.alternate)&&_S(t,e)}function pM(){return null}var aE=typeof reportError=="function"?reportError:function(t){console.error(t)};function eC(t){this._internalRoot=t}Jp.prototype.render=eC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ce(409));Kp(t,e,null,null)};Jp.prototype.unmount=eC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;nc(function(){Kp(null,t,null,null)}),e[ds]=null}};function Jp(t){this._internalRoot=t}Jp.prototype.unstable_scheduleHydration=function(t){if(t){var e=B1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Us.length&&e!==0&&e<Us[n].priority;n++);Us.splice(n,0,t),n===0&&V1(t)}};function tC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function OS(){}function gM(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=tp(s);o.call(l)}}var s=sE(e,r,t,0,null,!1,!1,"",OS);return t._reactRootContainer=s,t[ds]=s.current,ad(t.nodeType===8?t.parentNode:t),nc(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=tp(c);a.call(l)}}var c=Qy(t,0,!1,null,null,!1,!1,"",OS);return t._reactRootContainer=c,t[ds]=c.current,ad(t.nodeType===8?t.parentNode:t),nc(function(){Kp(e,c,n,r)}),c}function Qp(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var c=tp(s);a.call(c)}}Kp(e,s,t,i)}else s=gM(n,e,t,i,r);return tp(s)}L1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wu(e.pendingLanes);n!==0&&(Iy(e,n|1),mr(e,Zt()),!(nt&6)&&(Cl=Zt()+500,va()))}break;case 13:nc(function(){var r=fs(t,1);if(r!==null){var i=qn();_i(r,t,1,i)}}),qy(t,1)}};Sy=function(t){if(t.tag===13){var e=fs(t,134217728);if(e!==null){var n=qn();_i(e,t,134217728,n)}qy(t,134217728)}};F1=function(t){if(t.tag===13){var e=oa(t),n=fs(t,e);if(n!==null){var r=qn();_i(n,t,e,r)}qy(t,e)}};B1=function(){return lt};U1=function(t,e){var n=lt;try{return lt=t,e()}finally{lt=n}};rv=function(t,e,n){switch(e){case"input":if(Jm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Wp(r);if(!i)throw Error(ce(90));m1(r),Jm(r,i)}}}break;case"textarea":y1(t,n);break;case"select":e=n.value,e!=null&&Xc(t,!!n.multiple,e,!1)}};k1=$y;E1=nc;var mM={usingClientEntryPoint:!1,Events:[jd,Lc,Wp,w1,A1,$y]},ou={findFiberByHostInstance:Fa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vM={bundleType:ou.bundleType,version:ou.version,rendererPackageName:ou.rendererPackageName,rendererConfig:ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=x1(t),t===null?null:t.stateNode},findFiberByHostInstance:ou.findFiberByHostInstance||pM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pf.isDisabled&&Pf.supportsFiber)try{Bp=Pf.inject(vM),po=Pf}catch{}}jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mM;jr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tC(e))throw Error(ce(200));return hM(t,e,null,n)};jr.createRoot=function(t,e){if(!tC(t))throw Error(ce(299));var n=!1,r="",i=aE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qy(t,1,!1,null,null,n,!1,r,i),t[ds]=e.current,ad(t.nodeType===8?t.parentNode:t),new eC(e)};jr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ce(188)):(t=Object.keys(t).join(","),Error(ce(268,t)));return t=x1(e),t=t===null?null:t.stateNode,t};jr.flushSync=function(t){return nc(t)};jr.hydrate=function(t,e,n){if(!Yp(e))throw Error(ce(200));return Qp(null,t,e,!0,n)};jr.hydrateRoot=function(t,e,n){if(!tC(t))throw Error(ce(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=aE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=sE(e,null,t,1,n??null,i,!1,o,s),t[ds]=e.current,ad(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Jp(e)};jr.render=function(t,e,n){if(!Yp(e))throw Error(ce(200));return Qp(null,t,e,!1,n)};jr.unmountComponentAtNode=function(t){if(!Yp(t))throw Error(ce(40));return t._reactRootContainer?(nc(function(){Qp(null,null,t,!1,function(){t._reactRootContainer=null,t[ds]=null})}),!0):!1};jr.unstable_batchedUpdates=$y;jr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Yp(n))throw Error(ce(200));if(t==null||t._reactInternals===void 0)throw Error(ce(38));return Qp(t,e,n,!1,r)};jr.version="18.3.1-next-f1338f8080-20240426";function cE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cE)}catch(t){console.error(t)}}cE(),c1.exports=jr;var nC=c1.exports;const yM=Ud(nC),CM=JA({__proto__:null,default:yM},[nC]);var MS=nC;jm.createRoot=MS.createRoot,jm.hydrateRoot=MS.hydrateRoot;/**
 * @remix-run/router v1.19.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nt(){return Nt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Nt.apply(this,arguments)}var Jt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Jt||(Jt={}));const DS="popstate";function IM(t){t===void 0&&(t={});function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return md("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Hd(i)}return bM(e,n,null,t)}function Qe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Il(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function SM(){return Math.random().toString(36).substr(2,8)}function LS(t,e){return{usr:t.state,key:t.key,idx:e}}function md(t,e,n,r){return n===void 0&&(n=null),Nt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ya(e):e,{state:n,key:e&&e.key||r||SM()})}function Hd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ya(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function bM(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=Jt.Pop,c=null,l=u();l==null&&(l=0,s.replaceState(Nt({},s.state,{idx:l}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=Jt.Pop;let C=u(),g=C==null?null:C-l;l=C,c&&c({action:a,location:m.location,delta:g})}function f(C,g){a=Jt.Push;let v=md(m.location,C,g);l=u()+1;let S=LS(v,l),k=m.createHref(v);try{s.pushState(S,"",k)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;i.location.assign(k)}o&&c&&c({action:a,location:m.location,delta:1})}function h(C,g){a=Jt.Replace;let v=md(m.location,C,g);l=u();let S=LS(v,l),k=m.createHref(v);s.replaceState(S,"",k),o&&c&&c({action:a,location:m.location,delta:0})}function p(C){let g=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof C=="string"?C:Hd(C);return v=v.replace(/ $/,"%20"),Qe(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let m={get action(){return a},get location(){return t(i,s)},listen(C){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(DS,d),c=C,()=>{i.removeEventListener(DS,d),c=null}},createHref(C){return e(i,C)},createURL:p,encodeLocation(C){let g=p(C);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(C){return s.go(C)}};return m}var ut;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ut||(ut={}));const wM=new Set(["lazy","caseSensitive","path","id","index","children"]);function AM(t){return t.index===!0}function vd(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,o)=>{let s=[...n,String(o)],a=typeof i.id=="string"?i.id:s.join("-");if(Qe(i.index!==!0||!i.children,"Cannot specify children on an index route"),Qe(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),AM(i)){let c=Nt({},i,e(i),{id:a});return r[a]=c,c}else{let c=Nt({},i,e(i),{id:a,children:void 0});return r[a]=c,i.children&&(c.children=vd(i.children,e,s,r)),c}})}function Na(t,e,n){return n===void 0&&(n="/"),oh(t,e,n,!1)}function oh(t,e,n,r){let i=typeof e=="string"?ya(e):e,o=zd(i.pathname||"/",n);if(o==null)return null;let s=lE(t);EM(s);let a=null;for(let c=0;a==null&&c<s.length;++c){let l=FM(o);a=DM(s[c],l,r)}return a}function kM(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function lE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let c={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};c.relativePath.startsWith("/")&&(Qe(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=Xa([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(Qe(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),lE(o.children,e,u,l)),!(o.path==null&&!o.index)&&e.push({path:l,score:OM(l,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let c of uE(o.path))i(o,s,c)}),e}function uE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=uE(r.join("/")),a=[];return a.push(...s.map(c=>c===""?o:[o,c].join("/"))),i&&a.push(...s),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function EM(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:MM(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const TM=/^:[\w-]+$/,RM=3,xM=2,PM=1,NM=10,_M=-2,FS=t=>t==="*";function OM(t,e){let n=t.split("/"),r=n.length;return n.some(FS)&&(r+=_M),e&&(r+=xM),n.filter(i=>!FS(i)).reduce((i,o)=>i+(TM.test(o)?RM:o===""?PM:NM),r)}function MM(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function DM(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let c=r[a],l=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=BS({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),f=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=BS({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:Xa([o,d.pathname]),pathnameBase:WM(Xa([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=Xa([o,d.pathnameBase]))}return s}function BS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=LM(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let m=a[d]||"";s=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?l[f]=void 0:l[f]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:o,pathnameBase:s,pattern:t}}function LM(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Il(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function FM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Il(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function zd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function BM(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?ya(t):t;return{pathname:n?n.startsWith("/")?n:UM(n,e):e,search:jM(r),hash:ZM(i)}}function UM(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function qg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dE(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function VM(t,e){let n=dE(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function GM(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=ya(t):(i=Nt({},t),Qe(!i.pathname||!i.pathname.includes("?"),qg("?","pathname","search",i)),Qe(!i.pathname||!i.pathname.includes("#"),qg("#","pathname","hash",i)),Qe(!i.search||!i.search.includes("#"),qg("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let f=s.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let c=BM(i,a),l=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Xa=t=>t.join("/").replace(/\/\/+/g,"/"),WM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),jM=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ZM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class np{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function qp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const fE=["post","put","patch","delete"],HM=new Set(fE),zM=["get",...fE],XM=new Set(zM),$M=new Set([301,302,303,307,308]),KM=new Set([307,308]),em={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},JM={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},su={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},rC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,YM=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),hE="remix-router-transitions";function QM(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Qe(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let D=t.detectErrorBoundary;i=B=>({hasErrorBoundary:D(B)})}else i=YM;let o={},s=vd(t.routes,i,void 0,o),a,c=t.basename||"/",l=t.unstable_dataStrategy||iD,u=t.unstable_patchRoutesOnNavigation,d=Nt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,h=new Set,p=1e3,m=new Set,C=null,g=null,v=null,S=t.hydrationData!=null,k=Na(s,t.history.location,c),A=null;if(k==null&&!u){let D=Hn(404,{pathname:t.history.location.pathname}),{matches:B,route:Z}=XS(s);k=B,A={[Z.id]:D}}k&&!t.hydrationData&&Aa(k,s,t.history.location.pathname).active&&(k=null);let R;if(k)if(k.some(D=>D.route.lazy))R=!1;else if(!k.some(D=>D.route.loader))R=!0;else if(d.v7_partialHydration){let D=t.hydrationData?t.hydrationData.loaderData:null,B=t.hydrationData?t.hydrationData.errors:null,Z=re=>re.route.loader?typeof re.route.loader=="function"&&re.route.loader.hydrate===!0?!1:D&&D[re.route.id]!==void 0||B&&B[re.route.id]!==void 0:!0;if(B){let re=k.findIndex(ge=>B[ge.route.id]!==void 0);R=k.slice(0,re+1).every(Z)}else R=k.every(Z)}else R=t.hydrationData!=null;else if(R=!1,k=[],d.v7_partialHydration){let D=Aa(null,s,t.history.location.pathname);D.active&&D.matches&&(k=D.matches)}let P,w={historyAction:t.history.action,location:t.history.location,matches:k,initialized:R,navigation:em,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||A,fetchers:new Map,blockers:new Map},_=Jt.Pop,O=!1,L,U=!1,X=new Map,H=null,J=!1,te=!1,le=[],$=new Set,z=new Map,se=0,j=-1,oe=new Map,Ce=new Set,Be=new Map,fe=new Map,Pe=new Set,Xe=new Map,me=new Map,Qt=new Map,zt;function Vn(){if(f=t.history.listen(D=>{let{action:B,location:Z,delta:re}=D;if(zt){zt(),zt=void 0;return}Il(me.size===0||re!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ge=Gt({currentLocation:w.location,nextLocation:Z,historyAction:B});if(ge&&re!=null){let Re=new Promise(De=>{zt=De});t.history.go(re*-1),Cc(ge,{state:"blocked",location:Z,proceed(){Cc(ge,{state:"proceeding",proceed:void 0,reset:void 0,location:Z}),Re.then(()=>t.history.go(re))},reset(){let De=new Map(w.blockers);De.set(ge,su),qe({blockers:De})}});return}return Le(B,Z)}),n){CD(e,X);let D=()=>ID(e,X);e.addEventListener("pagehide",D),H=()=>e.removeEventListener("pagehide",D)}return w.initialized||Le(Jt.Pop,w.location,{initialHydration:!0}),P}function Vt(){f&&f(),H&&H(),h.clear(),L&&L.abort(),w.fetchers.forEach((D,B)=>Y(B)),w.blockers.forEach((D,B)=>sf(B))}function Pn(D){return h.add(D),()=>h.delete(D)}function qe(D,B){B===void 0&&(B={}),w=Nt({},w,D);let Z=[],re=[];d.v7_fetcherPersist&&w.fetchers.forEach((ge,Re)=>{ge.state==="idle"&&(Pe.has(Re)?re.push(Re):Z.push(Re))}),[...h].forEach(ge=>ge(w,{deletedFetchers:re,unstable_viewTransitionOpts:B.viewTransitionOpts,unstable_flushSync:B.flushSync===!0})),d.v7_fetcherPersist&&(Z.forEach(ge=>w.fetchers.delete(ge)),re.forEach(ge=>Y(ge)))}function de(D,B,Z){var re,ge;let{flushSync:Re}=Z===void 0?{}:Z,De=w.actionData!=null&&w.navigation.formMethod!=null&&Si(w.navigation.formMethod)&&w.navigation.state==="loading"&&((re=D.state)==null?void 0:re._isRedirect)!==!0,he;B.actionData?Object.keys(B.actionData).length>0?he=B.actionData:he=null:De?he=w.actionData:he=null;let xe=B.loaderData?HS(w.loaderData,B.loaderData,B.matches||[],B.errors):w.loaderData,ke=w.blockers;ke.size>0&&(ke=new Map(ke),ke.forEach((q,ue)=>ke.set(ue,su)));let ee=O===!0||w.navigation.formMethod!=null&&Si(w.navigation.formMethod)&&((ge=D.state)==null?void 0:ge._isRedirect)!==!0;a&&(s=a,a=void 0),J||_===Jt.Pop||(_===Jt.Push?t.history.push(D,D.state):_===Jt.Replace&&t.history.replace(D,D.state));let M;if(_===Jt.Pop){let q=X.get(w.location.pathname);q&&q.has(D.pathname)?M={currentLocation:w.location,nextLocation:D}:X.has(D.pathname)&&(M={currentLocation:D,nextLocation:w.location})}else if(U){let q=X.get(w.location.pathname);q?q.add(D.pathname):(q=new Set([D.pathname]),X.set(w.location.pathname,q)),M={currentLocation:w.location,nextLocation:D}}qe(Nt({},B,{actionData:he,loaderData:xe,historyAction:_,location:D,initialized:!0,navigation:em,revalidation:"idle",restoreScrollPosition:cf(D,B.matches||w.matches),preventScrollReset:ee,blockers:ke}),{viewTransitionOpts:M,flushSync:Re===!0}),_=Jt.Pop,O=!1,U=!1,J=!1,te=!1,le=[]}async function Ie(D,B){if(typeof D=="number"){t.history.go(D);return}let Z=Lv(w.location,w.matches,c,d.v7_prependBasename,D,d.v7_relativeSplatPath,B==null?void 0:B.fromRouteId,B==null?void 0:B.relative),{path:re,submission:ge,error:Re}=US(d.v7_normalizeFormMethod,!1,Z,B),De=w.location,he=md(w.location,re,B&&B.state);he=Nt({},he,t.history.encodeLocation(he));let xe=B&&B.replace!=null?B.replace:void 0,ke=Jt.Push;xe===!0?ke=Jt.Replace:xe===!1||ge!=null&&Si(ge.formMethod)&&ge.formAction===w.location.pathname+w.location.search&&(ke=Jt.Replace);let ee=B&&"preventScrollReset"in B?B.preventScrollReset===!0:void 0,M=(B&&B.unstable_flushSync)===!0,q=Gt({currentLocation:De,nextLocation:he,historyAction:ke});if(q){Cc(q,{state:"blocked",location:he,proceed(){Cc(q,{state:"proceeding",proceed:void 0,reset:void 0,location:he}),Ie(D,B)},reset(){let ue=new Map(w.blockers);ue.set(q,su),qe({blockers:ue})}});return}return await Le(ke,he,{submission:ge,pendingError:Re,preventScrollReset:ee,replace:B&&B.replace,enableViewTransition:B&&B.unstable_viewTransition,flushSync:M})}function We(){if(I(),qe({revalidation:"loading"}),w.navigation.state!=="submitting"){if(w.navigation.state==="idle"){Le(w.historyAction,w.location,{startUninterruptedRevalidation:!0});return}Le(_||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation,enableViewTransition:U===!0})}}async function Le(D,B,Z){L&&L.abort(),L=null,_=D,J=(Z&&Z.startUninterruptedRevalidation)===!0,af(w.location,w.matches),O=(Z&&Z.preventScrollReset)===!0,U=(Z&&Z.enableViewTransition)===!0;let re=a||s,ge=Z&&Z.overrideNavigation,Re=Na(re,B,c),De=(Z&&Z.flushSync)===!0,he=Aa(Re,re,B.pathname);if(he.active&&he.matches&&(Re=he.matches),!Re){let{error:Ee,notFoundMatches:Ye,route:He}=Gi(B.pathname);de(B,{matches:Ye,loaderData:{},errors:{[He.id]:Ee}},{flushSync:De});return}if(w.initialized&&!te&&uD(w.location,B)&&!(Z&&Z.submission&&Si(Z.submission.formMethod))){de(B,{matches:Re},{flushSync:De});return}L=new AbortController;let xe=Ac(t.history,B,L.signal,Z&&Z.submission),ke;if(Z&&Z.pendingError)ke=[jc(Re).route.id,{type:ut.error,error:Z.pendingError}];else if(Z&&Z.submission&&Si(Z.submission.formMethod)){let Ee=await Me(xe,B,Z.submission,Re,he.active,{replace:Z.replace,flushSync:De});if(Ee.shortCircuited)return;if(Ee.pendingActionResult){let[Ye,He]=Ee.pendingActionResult;if(Mr(He)&&qp(He.error)&&He.error.status===404){L=null,de(B,{matches:Ee.matches,loaderData:{},errors:{[Ye]:He.error}});return}}Re=Ee.matches||Re,ke=Ee.pendingActionResult,ge=tm(B,Z.submission),De=!1,he.active=!1,xe=Ac(t.history,xe.url,xe.signal)}let{shortCircuited:ee,matches:M,loaderData:q,errors:ue}=await et(xe,B,Re,he.active,ge,Z&&Z.submission,Z&&Z.fetcherSubmission,Z&&Z.replace,Z&&Z.initialHydration===!0,De,ke);ee||(L=null,de(B,Nt({matches:M||Re},zS(ke),{loaderData:q,errors:ue})))}async function Me(D,B,Z,re,ge,Re){Re===void 0&&(Re={}),I();let De=vD(B,Z);if(qe({navigation:De},{flushSync:Re.flushSync===!0}),ge){let ke=await ka(re,B.pathname,D.signal);if(ke.type==="aborted")return{shortCircuited:!0};if(ke.type==="error"){let{boundaryId:ee,error:M}=Ic(B.pathname,ke);return{matches:ke.partialMatches,pendingActionResult:[ee,{type:ut.error,error:M}]}}else if(ke.matches)re=ke.matches;else{let{notFoundMatches:ee,error:M,route:q}=Gi(B.pathname);return{matches:ee,pendingActionResult:[q.id,{type:ut.error,error:M}]}}}let he,xe=ku(re,B);if(!xe.route.action&&!xe.route.lazy)he={type:ut.error,error:Hn(405,{method:D.method,pathname:B.pathname,routeId:xe.route.id})};else if(he=(await E("action",w,D,[xe],re,null))[xe.route.id],D.signal.aborted)return{shortCircuited:!0};if(Va(he)){let ke;return Re&&Re.replace!=null?ke=Re.replace:ke=WS(he.response.headers.get("Location"),new URL(D.url),c)===w.location.pathname+w.location.search,await un(D,he,!0,{submission:Z,replace:ke}),{shortCircuited:!0}}if(Zs(he))throw Hn(400,{type:"defer-action"});if(Mr(he)){let ke=jc(re,xe.route.id);return(Re&&Re.replace)!==!0&&(_=Jt.Push),{matches:re,pendingActionResult:[ke.route.id,he]}}return{matches:re,pendingActionResult:[xe.route.id,he]}}async function et(D,B,Z,re,ge,Re,De,he,xe,ke,ee){let M=ge||tm(B,Re),q=Re||De||KS(M),ue=!J&&(!d.v7_partialHydration||!xe);if(re){if(ue){let Dt=xt(ee);qe(Nt({navigation:M},Dt!==void 0?{actionData:Dt}:{}),{flushSync:ke})}let Ge=await ka(Z,B.pathname,D.signal);if(Ge.type==="aborted")return{shortCircuited:!0};if(Ge.type==="error"){let{boundaryId:Dt,error:Sr}=Ic(B.pathname,Ge);return{matches:Ge.partialMatches,loaderData:{},errors:{[Dt]:Sr}}}else if(Ge.matches)Z=Ge.matches;else{let{error:Dt,notFoundMatches:Sr,route:Lt}=Gi(B.pathname);return{matches:Sr,loaderData:{},errors:{[Lt.id]:Dt}}}}let Ee=a||s,[Ye,He]=VS(t.history,w,Z,q,B,d.v7_partialHydration&&xe===!0,d.v7_skipActionErrorRevalidation,te,le,$,Pe,Be,Ce,Ee,c,ee);if(Sc(Ge=>!(Z&&Z.some(Dt=>Dt.route.id===Ge))||Ye&&Ye.some(Dt=>Dt.route.id===Ge)),j=++se,Ye.length===0&&He.length===0){let Ge=st();return de(B,Nt({matches:Z,loaderData:{},errors:ee&&Mr(ee[1])?{[ee[0]]:ee[1].error}:null},zS(ee),Ge?{fetchers:new Map(w.fetchers)}:{}),{flushSync:ke}),{shortCircuited:!0}}if(ue){let Ge={};if(!re){Ge.navigation=M;let Dt=xt(ee);Dt!==void 0&&(Ge.actionData=Dt)}He.length>0&&(Ge.fetchers=Pt(He)),qe(Ge,{flushSync:ke})}He.forEach(Ge=>{z.has(Ge.key)&&Ze(Ge.key),Ge.controller&&z.set(Ge.key,Ge.controller)});let Xt=()=>He.forEach(Ge=>Ze(Ge.key));L&&L.signal.addEventListener("abort",Xt);let{loaderResults:$t,fetcherResults:zr}=await y(w,Z,Ye,He,D);if(D.signal.aborted)return{shortCircuited:!0};L&&L.signal.removeEventListener("abort",Xt),He.forEach(Ge=>z.delete(Ge.key));let Et=Nf($t);if(Et)return await un(D,Et.result,!0,{replace:he}),{shortCircuited:!0};if(Et=Nf(zr),Et)return Ce.add(Et.key),await un(D,Et.result,!0,{replace:he}),{shortCircuited:!0};let{loaderData:Ea,errors:Xr}=ZS(w,Z,Ye,$t,ee,He,zr,Xe);Xe.forEach((Ge,Dt)=>{Ge.subscribe(Sr=>{(Sr||Ge.done)&&Xe.delete(Dt)})}),d.v7_partialHydration&&xe&&w.errors&&Object.entries(w.errors).filter(Ge=>{let[Dt]=Ge;return!Ye.some(Sr=>Sr.route.id===Dt)}).forEach(Ge=>{let[Dt,Sr]=Ge;Xr=Object.assign(Xr||{},{[Dt]:Sr})});let uf=st(),df=rt(j),ff=uf||df||He.length>0;return Nt({matches:Z,loaderData:Ea,errors:Xr},ff?{fetchers:new Map(w.fetchers)}:{})}function xt(D){if(D&&!Mr(D[1]))return{[D[0]]:D[1].data};if(w.actionData)return Object.keys(w.actionData).length===0?null:w.actionData}function Pt(D){return D.forEach(B=>{let Z=w.fetchers.get(B.key),re=au(void 0,Z?Z.data:void 0);w.fetchers.set(B.key,re)}),new Map(w.fetchers)}function Gn(D,B,Z,re){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");z.has(D)&&Ze(D);let ge=(re&&re.unstable_flushSync)===!0,Re=a||s,De=Lv(w.location,w.matches,c,d.v7_prependBasename,Z,d.v7_relativeSplatPath,B,re==null?void 0:re.relative),he=Na(Re,De,c),xe=Aa(he,Re,De);if(xe.active&&xe.matches&&(he=xe.matches),!he){F(D,B,Hn(404,{pathname:De}),{flushSync:ge});return}let{path:ke,submission:ee,error:M}=US(d.v7_normalizeFormMethod,!0,De,re);if(M){F(D,B,M,{flushSync:ge});return}let q=ku(he,ke);if(O=(re&&re.preventScrollReset)===!0,ee&&Si(ee.formMethod)){Ir(D,B,ke,q,he,xe.active,ge,ee);return}Be.set(D,{routeId:B,path:ke}),qt(D,B,ke,q,he,xe.active,ge,ee)}async function Ir(D,B,Z,re,ge,Re,De,he){I(),Be.delete(D);function xe(Lt){if(!Lt.route.action&&!Lt.route.lazy){let ko=Hn(405,{method:he.formMethod,pathname:Z,routeId:B});return F(D,B,ko,{flushSync:De}),!0}return!1}if(!Re&&xe(re))return;let ke=w.fetchers.get(D);x(D,yD(he,ke),{flushSync:De});let ee=new AbortController,M=Ac(t.history,Z,ee.signal,he);if(Re){let Lt=await ka(ge,Z,M.signal);if(Lt.type==="aborted")return;if(Lt.type==="error"){let{error:ko}=Ic(Z,Lt);F(D,B,ko,{flushSync:De});return}else if(Lt.matches){if(ge=Lt.matches,re=ku(ge,Z),xe(re))return}else{F(D,B,Hn(404,{pathname:Z}),{flushSync:De});return}}z.set(D,ee);let q=se,Ee=(await E("action",w,M,[re],ge,D))[re.route.id];if(M.signal.aborted){z.get(D)===ee&&z.delete(D);return}if(d.v7_fetcherPersist&&Pe.has(D)){if(Va(Ee)||Mr(Ee)){x(D,xs(void 0));return}}else{if(Va(Ee))if(z.delete(D),j>q){x(D,xs(void 0));return}else return Ce.add(D),x(D,au(he)),un(M,Ee,!1,{fetcherSubmission:he});if(Mr(Ee)){F(D,B,Ee.error);return}}if(Zs(Ee))throw Hn(400,{type:"defer-action"});let Ye=w.navigation.location||w.location,He=Ac(t.history,Ye,ee.signal),Xt=a||s,$t=w.navigation.state!=="idle"?Na(Xt,w.navigation.location,c):w.matches;Qe($t,"Didn't find any matches after fetcher action");let zr=++se;oe.set(D,zr);let Et=au(he,Ee.data);w.fetchers.set(D,Et);let[Ea,Xr]=VS(t.history,w,$t,he,Ye,!1,d.v7_skipActionErrorRevalidation,te,le,$,Pe,Be,Ce,Xt,c,[re.route.id,Ee]);Xr.filter(Lt=>Lt.key!==D).forEach(Lt=>{let ko=Lt.key,AI=w.fetchers.get(ko),WN=au(void 0,AI?AI.data:void 0);w.fetchers.set(ko,WN),z.has(ko)&&Ze(ko),Lt.controller&&z.set(ko,Lt.controller)}),qe({fetchers:new Map(w.fetchers)});let uf=()=>Xr.forEach(Lt=>Ze(Lt.key));ee.signal.addEventListener("abort",uf);let{loaderResults:df,fetcherResults:ff}=await y(w,$t,Ea,Xr,He);if(ee.signal.aborted)return;ee.signal.removeEventListener("abort",uf),oe.delete(D),z.delete(D),Xr.forEach(Lt=>z.delete(Lt.key));let Ge=Nf(df);if(Ge)return un(He,Ge.result,!1);if(Ge=Nf(ff),Ge)return Ce.add(Ge.key),un(He,Ge.result,!1);let{loaderData:Dt,errors:Sr}=ZS(w,$t,Ea,df,void 0,Xr,ff,Xe);if(w.fetchers.has(D)){let Lt=xs(Ee.data);w.fetchers.set(D,Lt)}rt(zr),w.navigation.state==="loading"&&zr>j?(Qe(_,"Expected pending action"),L&&L.abort(),de(w.navigation.location,{matches:$t,loaderData:Dt,errors:Sr,fetchers:new Map(w.fetchers)})):(qe({errors:Sr,loaderData:HS(w.loaderData,Dt,$t,Sr),fetchers:new Map(w.fetchers)}),te=!1)}async function qt(D,B,Z,re,ge,Re,De,he){let xe=w.fetchers.get(D);x(D,au(he,xe?xe.data:void 0),{flushSync:De});let ke=new AbortController,ee=Ac(t.history,Z,ke.signal);if(Re){let Ee=await ka(ge,Z,ee.signal);if(Ee.type==="aborted")return;if(Ee.type==="error"){let{error:Ye}=Ic(Z,Ee);F(D,B,Ye,{flushSync:De});return}else if(Ee.matches)ge=Ee.matches,re=ku(ge,Z);else{F(D,B,Hn(404,{pathname:Z}),{flushSync:De});return}}z.set(D,ke);let M=se,ue=(await E("loader",w,ee,[re],ge,D))[re.route.id];if(Zs(ue)&&(ue=await iC(ue,ee.signal,!0)||ue),z.get(D)===ke&&z.delete(D),!ee.signal.aborted){if(Pe.has(D)){x(D,xs(void 0));return}if(Va(ue))if(j>M){x(D,xs(void 0));return}else{Ce.add(D),await un(ee,ue,!1);return}if(Mr(ue)){F(D,B,ue.error);return}Qe(!Zs(ue),"Unhandled fetcher deferred data"),x(D,xs(ue.data))}}async function un(D,B,Z,re){let{submission:ge,fetcherSubmission:Re,replace:De}=re===void 0?{}:re;B.response.headers.has("X-Remix-Revalidate")&&(te=!0);let he=B.response.headers.get("Location");Qe(he,"Expected a Location header on the redirect Response"),he=WS(he,new URL(D.url),c);let xe=md(w.location,he,{_isRedirect:!0});if(n){let Ee=!1;if(B.response.headers.has("X-Remix-Reload-Document"))Ee=!0;else if(rC.test(he)){const Ye=t.history.createURL(he);Ee=Ye.origin!==e.location.origin||zd(Ye.pathname,c)==null}if(Ee){De?e.location.replace(he):e.location.assign(he);return}}L=null;let ke=De===!0||B.response.headers.has("X-Remix-Replace")?Jt.Replace:Jt.Push,{formMethod:ee,formAction:M,formEncType:q}=w.navigation;!ge&&!Re&&ee&&M&&q&&(ge=KS(w.navigation));let ue=ge||Re;if(KM.has(B.response.status)&&ue&&Si(ue.formMethod))await Le(ke,xe,{submission:Nt({},ue,{formAction:he}),preventScrollReset:O,enableViewTransition:Z?U:void 0});else{let Ee=tm(xe,ge);await Le(ke,xe,{overrideNavigation:Ee,fetcherSubmission:Re,preventScrollReset:O,enableViewTransition:Z?U:void 0})}}async function E(D,B,Z,re,ge,Re){let De,he={};try{De=await oD(l,D,B,Z,re,ge,Re,o,i)}catch(xe){return re.forEach(ke=>{he[ke.route.id]={type:ut.error,error:xe}}),he}for(let[xe,ke]of Object.entries(De))if(fD(ke)){let ee=ke.result;he[xe]={type:ut.redirect,response:cD(ee,Z,xe,ge,c,d.v7_relativeSplatPath)}}else he[xe]=await aD(ke);return he}async function y(D,B,Z,re,ge){let Re=D.matches,De=E("loader",D,ge,Z,B,null),he=Promise.all(re.map(async ee=>{if(ee.matches&&ee.match&&ee.controller){let q=(await E("loader",D,Ac(t.history,ee.path,ee.controller.signal),[ee.match],ee.matches,ee.key))[ee.match.route.id];return{[ee.key]:q}}else return Promise.resolve({[ee.key]:{type:ut.error,error:Hn(404,{pathname:ee.path})}})})),xe=await De,ke=(await he).reduce((ee,M)=>Object.assign(ee,M),{});return await Promise.all([gD(B,xe,ge.signal,Re,D.loaderData),mD(B,ke,re)]),{loaderResults:xe,fetcherResults:ke}}function I(){te=!0,le.push(...Sc()),Be.forEach((D,B)=>{z.has(B)&&($.add(B),Ze(B))})}function x(D,B,Z){Z===void 0&&(Z={}),w.fetchers.set(D,B),qe({fetchers:new Map(w.fetchers)},{flushSync:(Z&&Z.flushSync)===!0})}function F(D,B,Z,re){re===void 0&&(re={});let ge=jc(w.matches,B);Y(D),qe({errors:{[ge.route.id]:Z},fetchers:new Map(w.fetchers)},{flushSync:(re&&re.flushSync)===!0})}function W(D){return d.v7_fetcherPersist&&(fe.set(D,(fe.get(D)||0)+1),Pe.has(D)&&Pe.delete(D)),w.fetchers.get(D)||JM}function Y(D){let B=w.fetchers.get(D);z.has(D)&&!(B&&B.state==="loading"&&oe.has(D))&&Ze(D),Be.delete(D),oe.delete(D),Ce.delete(D),Pe.delete(D),$.delete(D),w.fetchers.delete(D)}function _e(D){if(d.v7_fetcherPersist){let B=(fe.get(D)||0)-1;B<=0?(fe.delete(D),Pe.add(D)):fe.set(D,B)}else Y(D);qe({fetchers:new Map(w.fetchers)})}function Ze(D){let B=z.get(D);Qe(B,"Expected fetch controller: "+D),B.abort(),z.delete(D)}function ot(D){for(let B of D){let Z=W(B),re=xs(Z.data);w.fetchers.set(B,re)}}function st(){let D=[],B=!1;for(let Z of Ce){let re=w.fetchers.get(Z);Qe(re,"Expected fetcher: "+Z),re.state==="loading"&&(Ce.delete(Z),D.push(Z),B=!0)}return ot(D),B}function rt(D){let B=[];for(let[Z,re]of oe)if(re<D){let ge=w.fetchers.get(Z);Qe(ge,"Expected fetcher: "+Z),ge.state==="loading"&&(Ze(Z),oe.delete(Z),B.push(Z))}return ot(B),B.length>0}function wa(D,B){let Z=w.blockers.get(D)||su;return me.get(D)!==B&&me.set(D,B),Z}function sf(D){w.blockers.delete(D),me.delete(D)}function Cc(D,B){let Z=w.blockers.get(D)||su;Qe(Z.state==="unblocked"&&B.state==="blocked"||Z.state==="blocked"&&B.state==="blocked"||Z.state==="blocked"&&B.state==="proceeding"||Z.state==="blocked"&&B.state==="unblocked"||Z.state==="proceeding"&&B.state==="unblocked","Invalid blocker state transition: "+Z.state+" -> "+B.state);let re=new Map(w.blockers);re.set(D,B),qe({blockers:re})}function Gt(D){let{currentLocation:B,nextLocation:Z,historyAction:re}=D;if(me.size===0)return;me.size>1&&Il(!1,"A router only supports one blocker at a time");let ge=Array.from(me.entries()),[Re,De]=ge[ge.length-1],he=w.blockers.get(Re);if(!(he&&he.state==="proceeding")&&De({currentLocation:B,nextLocation:Z,historyAction:re}))return Re}function Gi(D){let B=Hn(404,{pathname:D}),Z=a||s,{matches:re,route:ge}=XS(Z);return Sc(),{notFoundMatches:re,route:ge,error:B}}function Ic(D,B){return{boundaryId:jc(B.partialMatches).route.id,error:Hn(400,{type:"route-discovery",pathname:D,message:B.error!=null&&"message"in B.error?B.error:String(B.error)})}}function Sc(D){let B=[];return Xe.forEach((Z,re)=>{(!D||D(re))&&(Z.cancel(),B.push(re),Xe.delete(re))}),B}function Jl(D,B,Z){if(C=D,v=B,g=Z||null,!S&&w.navigation===em){S=!0;let re=cf(w.location,w.matches);re!=null&&qe({restoreScrollPosition:re})}return()=>{C=null,v=null,g=null}}function Yl(D,B){return g&&g(D,B.map(re=>kM(re,w.loaderData)))||D.key}function af(D,B){if(C&&v){let Z=Yl(D,B);C[Z]=v()}}function cf(D,B){if(C){let Z=Yl(D,B),re=C[Z];if(typeof re=="number")return re}return null}function Aa(D,B,Z){if(u){if(m.has(Z))return{active:!1,matches:D};if(D){if(Object.keys(D[0].params).length>0)return{active:!0,matches:oh(B,Z,c,!0)}}else return{active:!0,matches:oh(B,Z,c,!0)||[]}}return{active:!1,matches:null}}async function ka(D,B,Z){let re=D;for(;;){let ge=a==null,Re=a||s;try{await nD(u,B,re,Re,o,i,Qt,Z)}catch(xe){return{type:"error",error:xe,partialMatches:re}}finally{ge&&(s=[...s])}if(Z.aborted)return{type:"aborted"};let De=Na(Re,B,c);if(De)return lf(B,m),{type:"success",matches:De};let he=oh(Re,B,c,!0);if(!he||re.length===he.length&&re.every((xe,ke)=>xe.route.id===he[ke].route.id))return lf(B,m),{type:"success",matches:null};re=he}}function lf(D,B){if(B.size>=p){let Z=B.values().next().value;B.delete(Z)}B.add(D)}function Hr(D){o={},a=vd(D,i,void 0,o)}function bc(D,B){let Z=a==null;gE(D,B,a||s,o,i),Z&&(s=[...s],qe({}))}return P={get basename(){return c},get future(){return d},get state(){return w},get routes(){return s},get window(){return e},initialize:Vn,subscribe:Pn,enableScrollRestoration:Jl,navigate:Ie,fetch:Gn,revalidate:We,createHref:D=>t.history.createHref(D),encodeLocation:D=>t.history.encodeLocation(D),getFetcher:W,deleteFetcher:_e,dispose:Vt,getBlocker:wa,deleteBlocker:sf,patchRoutes:bc,_internalFetchControllers:z,_internalActiveDeferreds:Xe,_internalSetRoutes:Hr},P}function qM(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Lv(t,e,n,r,i,o,s,a){let c,l;if(s){c=[];for(let d of e)if(c.push(d),d.route.id===s){l=d;break}}else c=e,l=e[e.length-1];let u=GM(i||".",VM(c,o),zd(t.pathname,n)||t.pathname,a==="path");return i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&l&&l.route.index&&!oC(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:Xa([n,u.pathname])),Hd(u)}function US(t,e,n,r){if(!r||!qM(r))return{path:n};if(r.formMethod&&!pD(r.formMethod))return{path:n,error:Hn(405,{method:r.formMethod})};let i=()=>({path:n,error:Hn(400,{type:"invalid-body"})}),o=r.formMethod||"get",s=t?o.toUpperCase():o.toLowerCase(),a=mE(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Si(s))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[m,C]=p;return""+h+m+"="+C+`
`},""):String(r.body);return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Si(s))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}Qe(typeof FormData=="function","FormData is not available in this environment");let c,l;if(r.formData)c=Fv(r.formData),l=r.formData;else if(r.body instanceof FormData)c=Fv(r.body),l=r.body;else if(r.body instanceof URLSearchParams)c=r.body,l=jS(c);else if(r.body==null)c=new URLSearchParams,l=new FormData;else try{c=new URLSearchParams(r.body),l=jS(c)}catch{return i()}let u={formMethod:s,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(Si(u.formMethod))return{path:n,submission:u};let d=ya(n);return e&&d.search&&oC(d.search)&&c.append("index",""),d.search="?"+c,{path:Hd(d),submission:u}}function eD(t,e){let n=t;if(e){let r=t.findIndex(i=>i.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function VS(t,e,n,r,i,o,s,a,c,l,u,d,f,h,p,m){let C=m?Mr(m[1])?m[1].error:m[1].data:void 0,g=t.createURL(e.location),v=t.createURL(i),S=m&&Mr(m[1])?m[0]:void 0,k=S?eD(n,S):n,A=m?m[1].statusCode:void 0,R=s&&A&&A>=400,P=k.filter((_,O)=>{let{route:L}=_;if(L.lazy)return!0;if(L.loader==null)return!1;if(o)return typeof L.loader!="function"||L.loader.hydrate?!0:e.loaderData[L.id]===void 0&&(!e.errors||e.errors[L.id]===void 0);if(tD(e.loaderData,e.matches[O],_)||c.some(H=>H===_.route.id))return!0;let U=e.matches[O],X=_;return GS(_,Nt({currentUrl:g,currentParams:U.params,nextUrl:v,nextParams:X.params},r,{actionResult:C,actionStatus:A,defaultShouldRevalidate:R?!1:a||g.pathname+g.search===v.pathname+v.search||g.search!==v.search||pE(U,X)}))}),w=[];return d.forEach((_,O)=>{if(o||!n.some(J=>J.route.id===_.routeId)||u.has(O))return;let L=Na(h,_.path,p);if(!L){w.push({key:O,routeId:_.routeId,path:_.path,matches:null,match:null,controller:null});return}let U=e.fetchers.get(O),X=ku(L,_.path),H=!1;f.has(O)?H=!1:l.has(O)?(l.delete(O),H=!0):U&&U.state!=="idle"&&U.data===void 0?H=a:H=GS(X,Nt({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:C,actionStatus:A,defaultShouldRevalidate:R?!1:a})),H&&w.push({key:O,routeId:_.routeId,path:_.path,matches:L,match:X,controller:new AbortController})}),[P,w]}function tD(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function pE(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function GS(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function nD(t,e,n,r,i,o,s,a){let c=[e,...n.map(l=>l.route.id)].join("-");try{let l=s.get(c);l||(l=t({path:e,matches:n,patch:(u,d)=>{a.aborted||gE(u,d,r,i,o)}}),s.set(c,l)),l&&dD(l)&&await l}finally{s.delete(c)}}function gE(t,e,n,r,i){if(t){var o;let s=r[t];Qe(s,"No route found to patch children into: routeId = "+t);let a=vd(e,i,[t,"patch",String(((o=s.children)==null?void 0:o.length)||"0")],r);s.children?s.children.push(...a):s.children=a}else{let s=vd(e,i,["patch",String(n.length||"0")],r);n.push(...s)}}async function rD(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];Qe(i,"No route found in manifest");let o={};for(let s in r){let c=i[s]!==void 0&&s!=="hasErrorBoundary";Il(!c,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!c&&!wM.has(s)&&(o[s]=r[s])}Object.assign(i,o),Object.assign(i,Nt({},e(i),{lazy:void 0}))}async function iD(t){let{matches:e}=t,n=e.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,o,s)=>Object.assign(i,{[n[s].route.id]:o}),{})}async function oD(t,e,n,r,i,o,s,a,c,l){let u=o.map(h=>h.route.lazy?rD(h.route,c,a):void 0),d=o.map((h,p)=>{let m=u[p],C=i.some(v=>v.route.id===h.route.id);return Nt({},h,{shouldLoad:C,resolve:async v=>(v&&r.method==="GET"&&(h.route.lazy||h.route.loader)&&(C=!0),C?sD(e,r,h,m,v,l):Promise.resolve({type:ut.data,result:void 0}))})}),f=await t({matches:d,request:r,params:o[0].params,fetcherKey:s,context:l});try{await Promise.all(u)}catch{}return f}async function sD(t,e,n,r,i,o){let s,a,c=l=>{let u,d=new Promise((p,m)=>u=m);a=()=>u(),e.signal.addEventListener("abort",a);let f=p=>typeof l!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):l({request:e,params:n.params,context:o},...p!==void 0?[p]:[]),h=(async()=>{try{return{type:"data",result:await(i?i(m=>f(m)):f())}}catch(p){return{type:"error",result:p}}})();return Promise.race([h,d])};try{let l=n.route[t];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(f=>{u=f}),r]);if(u!==void 0)throw u;s=d}else if(await r,l=n.route[t],l)s=await c(l);else if(t==="action"){let u=new URL(e.url),d=u.pathname+u.search;throw Hn(405,{method:e.method,pathname:d,routeId:n.route.id})}else return{type:ut.data,result:void 0};else if(l)s=await c(l);else{let u=new URL(e.url),d=u.pathname+u.search;throw Hn(404,{pathname:d})}Qe(s.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(l){return{type:ut.error,result:l}}finally{a&&e.signal.removeEventListener("abort",a)}return s}async function aD(t){let{result:e,type:n}=t;if(vE(e)){let l;try{let u=e.headers.get("Content-Type");u&&/\bapplication\/json\b/.test(u)?e.body==null?l=null:l=await e.json():l=await e.text()}catch(u){return{type:ut.error,error:u}}return n===ut.error?{type:ut.error,error:new np(e.status,e.statusText,l),statusCode:e.status,headers:e.headers}:{type:ut.data,data:l,statusCode:e.status,headers:e.headers}}if(n===ut.error){if($S(e)){var r;if(e.data instanceof Error){var i;return{type:ut.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status}}e=new np(((r=e.init)==null?void 0:r.status)||500,void 0,e.data)}return{type:ut.error,error:e,statusCode:qp(e)?e.status:void 0}}if(hD(e)){var o,s;return{type:ut.deferred,deferredData:e,statusCode:(o=e.init)==null?void 0:o.status,headers:((s=e.init)==null?void 0:s.headers)&&new Headers(e.init.headers)}}if($S(e)){var a,c;return{type:ut.data,data:e.data,statusCode:(a=e.init)==null?void 0:a.status,headers:(c=e.init)!=null&&c.headers?new Headers(e.init.headers):void 0}}return{type:ut.data,data:e}}function cD(t,e,n,r,i,o){let s=t.headers.get("Location");if(Qe(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!rC.test(s)){let a=r.slice(0,r.findIndex(c=>c.route.id===n)+1);s=Lv(new URL(e.url),a,i,!0,s,o),t.headers.set("Location",s)}return t}function WS(t,e,n){if(rC.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=zd(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function Ac(t,e,n,r){let i=t.createURL(mE(e)).toString(),o={signal:n};if(r&&Si(r.formMethod)){let{formMethod:s,formEncType:a}=r;o.method=s.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=Fv(r.formData):o.body=r.formData}return new Request(i,o)}function Fv(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function jS(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function lD(t,e,n,r,i){let o={},s=null,a,c=!1,l={},u=n&&Mr(n[1])?n[1].error:void 0;return t.forEach(d=>{if(!(d.route.id in e))return;let f=d.route.id,h=e[f];if(Qe(!Va(h),"Cannot handle redirect results in processLoaderData"),Mr(h)){let p=h.error;u!==void 0&&(p=u,u=void 0),s=s||{};{let m=jc(t,f);s[m.route.id]==null&&(s[m.route.id]=p)}o[f]=void 0,c||(c=!0,a=qp(h.error)?h.error.status:500),h.headers&&(l[f]=h.headers)}else Zs(h)?(r.set(f,h.deferredData),o[f]=h.deferredData.data,h.statusCode!=null&&h.statusCode!==200&&!c&&(a=h.statusCode),h.headers&&(l[f]=h.headers)):(o[f]=h.data,h.statusCode&&h.statusCode!==200&&!c&&(a=h.statusCode),h.headers&&(l[f]=h.headers))}),u!==void 0&&n&&(s={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:s,statusCode:a||200,loaderHeaders:l}}function ZS(t,e,n,r,i,o,s,a){let{loaderData:c,errors:l}=lD(e,r,i,a);return o.forEach(u=>{let{key:d,match:f,controller:h}=u,p=s[d];if(Qe(p,"Did not find corresponding fetcher result"),!(h&&h.signal.aborted))if(Mr(p)){let m=jc(t.matches,f==null?void 0:f.route.id);l&&l[m.route.id]||(l=Nt({},l,{[m.route.id]:p.error})),t.fetchers.delete(d)}else if(Va(p))Qe(!1,"Unhandled fetcher revalidation redirect");else if(Zs(p))Qe(!1,"Unhandled fetcher deferred data");else{let m=xs(p.data);t.fetchers.set(d,m)}}),{loaderData:c,errors:l}}function HS(t,e,n,r){let i=Nt({},e);for(let o of n){let s=o.route.id;if(e.hasOwnProperty(s)?e[s]!==void 0&&(i[s]=e[s]):t[s]!==void 0&&o.route.loader&&(i[s]=t[s]),r&&r.hasOwnProperty(s))break}return i}function zS(t){return t?Mr(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function jc(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function XS(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Hn(t,e){let{pathname:n,routeId:r,method:i,type:o,message:s}=e===void 0?{}:e,a="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(a="Bad Request",o==="route-discovery"?c='Unable to match URL "'+n+'" - the `unstable_patchRoutesOnNavigation()` '+(`function threw the following error:
`+s):i&&n&&r?c="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?c="defer() is not supported in actions":o==="invalid-body"&&(c="Unable to encode submission body")):t===403?(a="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(a="Not Found",c='No route matches URL "'+n+'"'):t===405&&(a="Method Not Allowed",i&&n&&r?c="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(c='Invalid request method "'+i.toUpperCase()+'"')),new np(t||500,a,new Error(c),!0)}function Nf(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,i]=e[n];if(Va(i))return{key:r,result:i}}}function mE(t){let e=typeof t=="string"?ya(t):t;return Hd(Nt({},e,{hash:""}))}function uD(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function dD(t){return typeof t=="object"&&t!=null&&"then"in t}function fD(t){return vE(t.result)&&$M.has(t.result.status)}function Zs(t){return t.type===ut.deferred}function Mr(t){return t.type===ut.error}function Va(t){return(t&&t.type)===ut.redirect}function $S(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function hD(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function vE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function pD(t){return XM.has(t.toLowerCase())}function Si(t){return HM.has(t.toLowerCase())}async function gD(t,e,n,r,i){let o=Object.entries(e);for(let s=0;s<o.length;s++){let[a,c]=o[s],l=t.find(f=>(f==null?void 0:f.route.id)===a);if(!l)continue;let u=r.find(f=>f.route.id===l.route.id),d=u!=null&&!pE(u,l)&&(i&&i[l.route.id])!==void 0;Zs(c)&&d&&await iC(c,n,!1).then(f=>{f&&(e[a]=f)})}}async function mD(t,e,n){for(let r=0;r<n.length;r++){let{key:i,routeId:o,controller:s}=n[r],a=e[i];t.find(l=>(l==null?void 0:l.route.id)===o)&&Zs(a)&&(Qe(s,"Expected an AbortController for revalidating fetcher deferred result"),await iC(a,s.signal,!0).then(l=>{l&&(e[i]=l)}))}}async function iC(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:ut.data,data:t.deferredData.unwrappedData}}catch(i){return{type:ut.error,error:i}}return{type:ut.data,data:t.deferredData.data}}}function oC(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function ku(t,e){let n=typeof e=="string"?ya(e).search:e.search;if(t[t.length-1].route.index&&oC(n||""))return t[t.length-1];let r=dE(t);return r[r.length-1]}function KS(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:o,json:s}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(s!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}}}function tm(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function vD(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function au(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function yD(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function xs(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function CD(t,e){try{let n=t.sessionStorage.getItem(hE);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function ID(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(hE,JSON.stringify(n))}catch(r){Il(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bv(){return Bv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bv.apply(this,arguments)}const yE=b.createContext(null),CE=b.createContext(null),IE=b.createContext(null),sC=b.createContext(null),eg=b.createContext({outlet:null,matches:[],isDataRoute:!1}),SE=b.createContext(null);function aC(){return b.useContext(sC)!=null}function bE(){return aC()||Qe(!1),b.useContext(sC).location}function SD(t,e,n,r){aC()||Qe(!1);let{navigator:i}=b.useContext(IE),{matches:o}=b.useContext(eg),s=o[o.length-1],a=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let l=bE(),u;u=l;let d=u.pathname||"/",f=d;if(c!=="/"){let m=c.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let h=Na(t,{pathname:f});return ED(h&&h.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:Xa([c,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?c:Xa([c,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),o,n,r)}function bD(){let t=PD(),e=qp(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:i},n):null,null)}const wD=b.createElement(bD,null);class AD extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?b.createElement(eg.Provider,{value:this.props.routeContext},b.createElement(SE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kD(t){let{routeContext:e,match:n,children:r}=t,i=b.useContext(yE);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(eg.Provider,{value:e},r)}function ED(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||Qe(!1),s=s.slice(0,Math.min(s.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){c=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((u,d,f)=>{let h,p=!1,m=null,C=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||wD,c&&(l<0&&f===0?(ND("route-fallback"),p=!0,C=null):l===f&&(p=!0,C=d.route.hydrateFallbackElement||null)));let g=e.concat(s.slice(0,f+1)),v=()=>{let S;return h?S=m:p?S=C:d.route.Component?S=b.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=u,b.createElement(kD,{match:d,routeContext:{outlet:u,matches:g,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?b.createElement(AD,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}var Uv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Uv||{});function TD(t){let e=b.useContext(CE);return e||Qe(!1),e}function RD(t){let e=b.useContext(eg);return e||Qe(!1),e}function xD(t){let e=RD(),n=e.matches[e.matches.length-1];return n.route.id||Qe(!1),n.route.id}function PD(){var t;let e=b.useContext(SE),n=TD(Uv.UseRouteError),r=xD(Uv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const JS={};function ND(t,e,n){JS[t]||(JS[t]=!0)}function _D(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Jt.Pop,navigator:o,static:s=!1,future:a}=t;aC()&&Qe(!1);let c=e.replace(/^\/*/,"/"),l=b.useMemo(()=>({basename:c,navigator:o,static:s,future:Bv({v7_relativeSplatPath:!1},a)}),[c,a,o,s]);typeof r=="string"&&(r=ya(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=b.useMemo(()=>{let C=zd(u,c);return C==null?null:{location:{pathname:C,search:d,hash:f,state:h,key:p},navigationType:i}},[c,u,d,f,h,p,i]);return m==null?null:b.createElement(IE.Provider,{value:l},b.createElement(sC.Provider,{children:n,value:m}))}new Promise(()=>{});function OD(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:b.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:b.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:b.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rp(){return rp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rp.apply(this,arguments)}const MD="6";try{window.__reactRouterVersion=MD}catch{}function DD(t,e){return QM({basename:void 0,future:rp({},void 0,{v7_prependBasename:!0}),history:IM({window:void 0}),hydrationData:LD(),routes:t,mapRouteProperties:OD,unstable_dataStrategy:void 0,unstable_patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function LD(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=rp({},e,{errors:FD(e.errors)})),e}function FD(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new np(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let s=new o(i.message);s.stack="",n[r]=s}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const BD=b.createContext({isTransitioning:!1}),UD=b.createContext(new Map),VD="startTransition",YS=a_[VD],GD="flushSync",QS=CM[GD];function WD(t){YS?YS(t):t()}function cu(t){QS?QS(t):t()}class jD{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function ZD(t){let{fallbackElement:e,router:n,future:r}=t,[i,o]=b.useState(n.state),[s,a]=b.useState(),[c,l]=b.useState({isTransitioning:!1}),[u,d]=b.useState(),[f,h]=b.useState(),[p,m]=b.useState(),C=b.useRef(new Map),{v7_startTransition:g}=r||{},v=b.useCallback(w=>{g?WD(w):w()},[g]),S=b.useCallback((w,_)=>{let{deletedFetchers:O,unstable_flushSync:L,unstable_viewTransitionOpts:U}=_;O.forEach(H=>C.current.delete(H)),w.fetchers.forEach((H,J)=>{H.data!==void 0&&C.current.set(J,H.data)});let X=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!U||X){L?cu(()=>o(w)):v(()=>o(w));return}if(L){cu(()=>{f&&(u&&u.resolve(),f.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:U.currentLocation,nextLocation:U.nextLocation})});let H=n.window.document.startViewTransition(()=>{cu(()=>o(w))});H.finished.finally(()=>{cu(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})})}),cu(()=>h(H));return}f?(u&&u.resolve(),f.skipTransition(),m({state:w,currentLocation:U.currentLocation,nextLocation:U.nextLocation})):(a(w),l({isTransitioning:!0,flushSync:!1,currentLocation:U.currentLocation,nextLocation:U.nextLocation}))},[n.window,f,u,C,v]);b.useLayoutEffect(()=>n.subscribe(S),[n,S]),b.useEffect(()=>{c.isTransitioning&&!c.flushSync&&d(new jD)},[c]),b.useEffect(()=>{if(u&&s&&n.window){let w=s,_=u.promise,O=n.window.document.startViewTransition(async()=>{v(()=>o(w)),await _});O.finished.finally(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})}),h(O)}},[v,s,u,n.window]),b.useEffect(()=>{u&&s&&i.location.key===s.location.key&&u.resolve()},[u,f,i.location,s]),b.useEffect(()=>{!c.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[c.isTransitioning,p]),b.useEffect(()=>{},[]);let k=b.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:w=>n.navigate(w),push:(w,_,O)=>n.navigate(w,{state:_,preventScrollReset:O==null?void 0:O.preventScrollReset}),replace:(w,_,O)=>n.navigate(w,{replace:!0,state:_,preventScrollReset:O==null?void 0:O.preventScrollReset})}),[n]),A=n.basename||"/",R=b.useMemo(()=>({router:n,navigator:k,static:!1,basename:A}),[n,k,A]),P=b.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return b.createElement(b.Fragment,null,b.createElement(yE.Provider,{value:R},b.createElement(CE.Provider,{value:i},b.createElement(UD.Provider,{value:C.current},b.createElement(BD.Provider,{value:c},b.createElement(_D,{basename:A,location:i.location,navigationType:i.historyAction,navigator:k,future:P},i.initialized||n.future.v7_partialHydration?b.createElement(HD,{routes:n.routes,future:n.future,state:i}):e))))),null)}const HD=b.memo(zD);function zD(t){let{routes:e,future:n,state:r}=t;return SD(e,void 0,r,n)}var qS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(qS||(qS={}));var eb;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(eb||(eb={}));const wE=t=>{const e=typeof t=="function",n=b.useRef(t);b.useEffect(()=>{n.current=t}),b.useEffect(()=>{if(e){const r=i=>{const o=n.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])},AE=7e3;let nm=null;function tb(t,e="assertive",n=AE){nm||(nm=new XD),nm.announce(t,e,n)}class XD{createLog(e){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",e),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,n="assertive",r=AE){if(!this.node)return;let i=document.createElement("div");i.textContent=e,n==="assertive"?this.assertiveLog.appendChild(i):this.politeLog.appendChild(i),e!==""&&setTimeout(()=>{i.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&(this.politeLog.innerHTML=""))}constructor(){this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node)}}var nb=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function $D(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Es=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],KD=function(){nb(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){$D(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return nb(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(Es[n][r].color);for(var i=[0,95,135,175,215,255],o=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},s=0;s<6;++s)for(var a=0;a<6;++a)for(var c=0;c<6;++c)this.PALETTE_COLORS.push(o(s,a,c));for(var l=8,u=0;u<24;++u,l+=10)this.PALETTE_COLORS.push(o(l,l,l))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(/(https?:\/\/[^\s]+)/gm,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var o=this,s=this,a=n.split(/\033\[/),c=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var l=a.map(function(d){return o.processChunk(d,r,i)});if(r&&r.json){var u=s.processChunkJson("");return u.content=c,u.clearLine=r.clearLine,l.unshift(u),r.remove_empty&&(l=l.filter(function(d){return!d.isEmpty()})),l}else l.unshift(c);return l.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var o=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,s=r.key=o?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},c=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!c)return a;a.content=c[4];var l=c[2].split(";");if(c[1]!==""||c[3]!=="m"||!i)return a;for(var u=this;l.length>0;){var d=l.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=Es[0][f%10][s];else if(f>=90&&f<98)u.fg=Es[1][f%10][s];else if(f>=40&&f<48)u.bg=Es[0][f%10][s];else if(f>=100&&f<108)u.bg=Es[1][f%10][s];else if(f===38||f===48){var h=f===38;if(l.length>=1){var p=l.shift();if(p==="5"&&l.length>=1){var m=parseInt(l.shift());if(m>=0&&m<=255)if(!o)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[m]:u.bg=this.PALETTE_COLORS[m];else{var C=m>=16?"ansi-palette-"+m:Es[m>7?1:0][m%8].class;h?u.fg=C:u.bg=C}}else if(p==="2"&&l.length>=3){var g=parseInt(l.shift()),v=parseInt(l.shift()),S=parseInt(l.shift());if(g>=0&&g<=255&&v>=0&&v<=255&&S>=0&&S<=255){var k=g+", "+v+", "+S;o?h?(u.fg="ansi-truecolor",u.fg_truecolor=k):(u.bg="ansi-truecolor",u.bg_truecolor=k):h?u.fg=k:u.bg=k}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var o=this;r=r||{};var s=this.processChunkJson(n,r,i),a=r.use_classes;if(s.decorations=s.decorations.filter(function(h){if(h==="reverse"){s.fg||(s.fg=Es[0][7][a?"class":"color"]),s.bg||(s.bg=Es[0][0][a?"class":"color"]);var p=s.fg;s.fg=s.bg,s.bg=p;var m=s.fg_truecolor;return s.fg_truecolor=s.bg_truecolor,s.bg_truecolor=m,s.isInverted=!0,!1}return!0}),r.json)return s;if(s.isEmpty())return"";if(!s.was_processed)return s.content;var c=[],l=[],u=[],d={},f=function(p){var m=[],C=void 0;for(C in p)p.hasOwnProperty(C)&&m.push("data-"+C+'="'+o.escapeForHtml(p[C])+'"');return m.length>0?" "+m.join(" "):""};return s.isInverted&&(d["ansi-is-inverted"]="true"),s.fg&&(a?(c.push(s.fg+"-fg"),s.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=s.fg_truecolor,s.fg_truecolor=null)):c.push("color:rgb("+s.fg+")")),s.bg&&(a?(c.push(s.bg+"-bg"),s.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=s.bg_truecolor,s.bg_truecolor=null)):c.push("background-color:rgb("+s.bg+")")),s.decorations.forEach(function(h){if(a){l.push("ansi-"+h);return}h==="bold"?l.push("font-weight:bold"):h==="dim"?l.push("opacity:0.5"):h==="italic"?l.push("font-style:italic"):h==="hidden"?l.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&l.push("text-decoration:"+u.join(" ")),a?'<span class="'+c.concat(l).join(" ")+'"'+f(d)+">"+s.content+"</span>":'<span style="'+c.concat(l).join(";")+'"'+f(d)+">"+s.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),JD=KD;const YD=Ud(JD);function QD(t,e){let n=[];for(const r of t.split(`\r
`)){const i=YD.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const s of i){const a=n2(s,e);o=[...o,...a]}n=[...n,K.jsx("span",{children:o},n.length)]}return n}const qD=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,e2=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,t2=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function n2(t,e){const n=r2(t),r=[];let i=0,o=0;function s(u,d){let f;for(;(f=u.exec(t.content))!==null;){const h=f.index;h>i&&r.push(t.content.substring(i,h)),r.push(d(f)),i=u.lastIndex}}function a(u){const[,d,f]=u,h=f;return K.jsxs(K.Fragment,{children:[d,K.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:f})]})}function c(u){const d=u.groups.name,f=`mailto:${d}`;return K.jsxs(K.Fragment,{children:[u.groups.slorp1,K.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function l(u){const[,d,f]=u;return K.jsx("a",{onClick:()=>e(d),className:"exit",children:f})}return s(qD,a),s(e2,c),s(t2,l),i<t.content.length&&r.push(t.content.substring(i)),r.map(u=>K.jsx("span",{style:n,children:u},o++))}function r2(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var da={},Ml={},kE=b;function Ue(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sr=Object.prototype.hasOwnProperty,i2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rb={},ib={};function EE(t){return sr.call(ib,t)?!0:sr.call(rb,t)?!1:i2.test(t)?ib[t]=!0:(rb[t]=!0,!1)}function rr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var kn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kn[t]=new rr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kn[e]=new rr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kn[t]=new rr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kn[t]=new rr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kn[t]=new rr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kn[t]=new rr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kn[t]=new rr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kn[t]=new rr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kn[t]=new rr(t,5,!1,t.toLowerCase(),null,!1,!1)});var cC=/[\-:]([a-z])/g;function lC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cC,lC);kn[e]=new rr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cC,lC);kn[e]=new rr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cC,lC);kn[e]=new rr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kn[t]=new rr(t,1,!1,t.toLowerCase(),null,!1,!1)});kn.xlinkHref=new rr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kn[t]=new rr(t,1,!1,t.toLowerCase(),null,!0,!0)});var sh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},o2=["Webkit","ms","Moz","O"];Object.keys(sh).forEach(function(t){o2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sh[e]=sh[t]})});var s2=/["'&<>]/;function Kn(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=s2.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var a2=/([A-Z])/g,c2=/^ms-/,Vv=Array.isArray;function Eo(t,e){return{insertionMode:t,selectedValue:e}}function l2(t,e,n){switch(e){case"select":return Eo(1,n.value!=null?n.value:n.defaultValue);case"svg":return Eo(2,null);case"math":return Eo(3,null);case"foreignObject":return Eo(1,null);case"table":return Eo(4,null);case"thead":case"tbody":case"tfoot":return Eo(5,null);case"colgroup":return Eo(7,null);case"tr":return Eo(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Eo(1,null):t}var ob=new Map;function TE(t,e,n){if(typeof n!="object")throw Error(Ue(62));e=!0;for(var r in n)if(sr.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Kn(r);i=Kn((""+i).trim())}else{o=r;var s=ob.get(o);s!==void 0||(s=Kn(o.replace(a2,"-$1").toLowerCase().replace(c2,"-ms-")),ob.set(o,s)),o=s,i=typeof i=="number"?i===0||sr.call(sh,r)?""+i:i+"px":Kn((""+i).trim())}e?(e=!1,t.push(' style="',o,":",i)):t.push(";",o,":",i)}}e||t.push('"')}function br(t,e,n,r){switch(n){case"style":TE(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=kn.hasOwnProperty(n)?kn[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=e.attributeName,e.type){case 3:r&&t.push(" ",n,'=""');break;case 4:r===!0?t.push(" ",n,'=""'):r!==!1&&t.push(" ",n,'="',Kn(r),'"');break;case 5:isNaN(r)||t.push(" ",n,'="',Kn(r),'"');break;case 6:!isNaN(r)&&1<=r&&t.push(" ",n,'="',Kn(r),'"');break;default:e.sanitizeURL&&(r=""+r),t.push(" ",n,'="',Kn(r),'"')}}else if(EE(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",n,'="',Kn(r),'"')}}}function ah(t,e,n){if(e!=null){if(n!=null)throw Error(Ue(60));if(typeof e!="object"||!("__html"in e))throw Error(Ue(61));e=e.__html,e!=null&&t.push(""+e)}}function u2(t){var e="";return kE.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function rm(t,e,n,r){t.push(ji(n));var i=n=null,o;for(o in e)if(sr.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:br(t,r,o,s)}}return t.push(">"),ah(t,i,n),typeof n=="string"?(t.push(Kn(n)),null):n}var d2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,sb=new Map;function ji(t){var e=sb.get(t);if(e===void 0){if(!d2.test(t))throw Error(Ue(65,t));e="<"+t,sb.set(t,e)}return e}function f2(t,e,n,r,i){switch(e){case"select":t.push(ji("select"));var o=null,s=null;for(u in n)if(sr.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:br(t,r,u,a)}}return t.push(">"),ah(t,s,o),o;case"option":s=i.selectedValue,t.push(ji("option"));var c=a=null,l=null,u=null;for(o in n)if(sr.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:br(t,r,o,d)}}if(s!=null)if(n=c!==null?""+c:u2(a),Vv(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(' selected=""');break}}else""+s===n&&t.push(' selected=""');else l&&t.push(' selected=""');return t.push(">"),ah(t,u,a),a;case"textarea":t.push(ji("textarea")),u=s=o=null;for(a in n)if(sr.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":o=c;break;case"defaultValue":s=c;break;case"dangerouslySetInnerHTML":throw Error(Ue(91));default:br(t,r,a,c)}if(o===null&&s!==null&&(o=s),t.push(">"),u!=null){if(o!=null)throw Error(Ue(92));if(Vv(u)&&1<u.length)throw Error(Ue(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o!==null&&t.push(Kn(""+o)),null;case"input":t.push(ji("input")),c=u=a=o=null;for(s in n)if(sr.call(n,s)&&(l=n[s],l!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(Ue(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":o=l;break;default:br(t,r,s,l)}return u!==null?br(t,r,"checked",u):c!==null&&br(t,r,"checked",c),o!==null?br(t,r,"value",o):a!==null&&br(t,r,"value",a),t.push("/>"),null;case"menuitem":t.push(ji("menuitem"));for(var f in n)if(sr.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Ue(400));default:br(t,r,f,o)}return t.push(">"),null;case"title":t.push(ji("title")),o=null;for(d in n)if(sr.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(Ue(434));default:br(t,r,d,s)}return t.push(">"),o;case"listing":case"pre":t.push(ji(e)),s=o=null;for(c in n)if(sr.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:br(t,r,c,a)}if(t.push(">"),s!=null){if(o!=null)throw Error(Ue(60));if(typeof s!="object"||!("__html"in s))throw Error(Ue(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(`
`,n):t.push(""+n))}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(ji(e));for(var h in n)if(sr.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Ue(399,e));default:br(t,r,h,o)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return rm(t,n,e,r);case"html":return i.insertionMode===0&&t.push("<!DOCTYPE html>"),rm(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return rm(t,n,e,r);t.push(ji(e)),s=o=null;for(l in n)if(sr.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":TE(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:EE(l)&&typeof a!="function"&&typeof a!="symbol"&&t.push(" ",l,'="',Kn(a),'"')}return t.push(">"),ah(t,s,o),o}}function ab(t,e,n){if(t.push('<!--$?--><template id="'),n===null)throw Error(Ue(395));return t.push(n),t.push('"></template>')}function h2(t,e,n,r){switch(n.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');default:throw Error(Ue(397))}}function p2(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(Ue(397))}}var g2=/[<\u2028\u2029]/g;function im(t){return JSON.stringify(t).replace(g2,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function m2(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function cb(t,e,n,r){return n.generateStaticMarkup?(t.push(Kn(e)),!1):(e===""?t=r:(r&&t.push("<!-- -->"),t.push(Kn(e)),t=!0),t)}var Hu=Object.assign,v2=Symbol.for("react.element"),RE=Symbol.for("react.portal"),xE=Symbol.for("react.fragment"),PE=Symbol.for("react.strict_mode"),NE=Symbol.for("react.profiler"),_E=Symbol.for("react.provider"),OE=Symbol.for("react.context"),ME=Symbol.for("react.forward_ref"),DE=Symbol.for("react.suspense"),LE=Symbol.for("react.suspense_list"),FE=Symbol.for("react.memo"),uC=Symbol.for("react.lazy"),y2=Symbol.for("react.scope"),C2=Symbol.for("react.debug_trace_mode"),I2=Symbol.for("react.legacy_hidden"),S2=Symbol.for("react.default_value"),lb=Symbol.iterator;function Gv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xE:return"Fragment";case RE:return"Portal";case NE:return"Profiler";case PE:return"StrictMode";case DE:return"Suspense";case LE:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case OE:return(t.displayName||"Context")+".Consumer";case _E:return(t._context.displayName||"Context")+".Provider";case ME:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case FE:return e=t.displayName||null,e!==null?e:Gv(t.type)||"Memo";case uC:e=t._payload,t=t._init;try{return Gv(t(e))}catch{}}return null}var BE={};function ub(t,e){if(t=t.contextTypes,!t)return BE;var n={},r;for(r in t)n[r]=e[r];return n}var Ga=null;function tg(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Ue(401))}else{if(n===null)throw Error(Ue(401));tg(t,n)}e.context._currentValue2=e.value}}function UE(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&UE(t)}function VE(t){var e=t.parent;e!==null&&VE(e),t.context._currentValue2=t.value}function GE(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(Ue(402));t.depth===e.depth?tg(t,e):GE(t,e)}function WE(t,e){var n=e.parent;if(n===null)throw Error(Ue(402));t.depth===n.depth?tg(t,n):WE(t,n),e.context._currentValue2=e.value}function ip(t){var e=Ga;e!==t&&(e===null?VE(t):t===null?UE(e):e.depth===t.depth?tg(e,t):e.depth>t.depth?GE(e,t):WE(e,t),Ga=t)}var db={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function fb(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=db,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue2:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:Hu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&db.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=Hu({},o,a)):Hu(o,a))}t.state=o}else o.queue=null}var b2={id:1,overflow:""};function Wv(t,e,n){var r=t.id;t=t.overflow;var i=32-ch(r)-1;r&=~(1<<i),n+=1;var o=32-ch(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-ch(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var ch=Math.clz32?Math.clz32:k2,w2=Math.log,A2=Math.LN2;function k2(t){return t>>>=0,t===0?32:31-(w2(t)/A2|0)|0}function E2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var T2=typeof Object.is=="function"?Object.is:E2,ps=null,dC=null,lh=null,pt=null,Eu=!1,op=!1,yd=0,Hs=null,ng=0;function _a(){if(ps===null)throw Error(Ue(321));return ps}function hb(){if(0<ng)throw Error(Ue(312));return{memoizedState:null,queue:null,next:null}}function fC(){return pt===null?lh===null?(Eu=!1,lh=pt=hb()):(Eu=!0,pt=lh):pt.next===null?(Eu=!1,pt=pt.next=hb()):(Eu=!0,pt=pt.next),pt}function hC(){dC=ps=null,op=!1,lh=null,ng=0,pt=Hs=null}function jE(t,e){return typeof e=="function"?e(t):e}function pb(t,e,n){if(ps=_a(),pt=fC(),Eu){var r=pt.queue;if(e=r.dispatch,Hs!==null&&(n=Hs.get(r),n!==void 0)){Hs.delete(r),r=pt.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return pt.memoizedState=r,[r,e]}return[pt.memoizedState,e]}return t=t===jE?typeof e=="function"?e():e:n!==void 0?n(e):e,pt.memoizedState=t,t=pt.queue={last:null,dispatch:null},t=t.dispatch=R2.bind(null,ps,t),[pt.memoizedState,t]}function gb(t,e){if(ps=_a(),pt=fC(),e=e===void 0?null:e,pt!==null){var n=pt.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!T2(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),pt.memoizedState=[t,e],t}function R2(t,e,n){if(25<=ng)throw Error(Ue(301));if(t===ps)if(op=!0,t={action:n,next:null},Hs===null&&(Hs=new Map),n=Hs.get(e),n===void 0)Hs.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function x2(){throw Error(Ue(394))}function _f(){}var mb={readContext:function(t){return t._currentValue2},useContext:function(t){return _a(),t._currentValue2},useMemo:gb,useReducer:pb,useRef:function(t){ps=_a(),pt=fC();var e=pt.memoizedState;return e===null?(t={current:t},pt.memoizedState=t):e},useState:function(t){return pb(jE,t)},useInsertionEffect:_f,useLayoutEffect:function(){},useCallback:function(t,e){return gb(function(){return t},e)},useImperativeHandle:_f,useEffect:_f,useDebugValue:_f,useDeferredValue:function(t){return _a(),t},useTransition:function(){return _a(),[!1,x2]},useId:function(){var t=dC.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-ch(t)-1)).toString(32)+e;var n=uh;if(n===null)throw Error(Ue(404));return e=yd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return _a(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Ue(407));return n()}},uh=null,om=kE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function P2(t){return console.error(t),null}function Tu(){}function N2(t,e,n,r,i,o,s,a,c){var l=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?P2:i,onAllReady:Tu,onShellReady:s===void 0?Tu:s,onShellError:Tu,onFatalError:Tu},n=sp(e,0,null,n,!1,!1),n.parentFlushed=!0,t=pC(e,t,null,n,u,BE,null,b2),l.push(t),e}function pC(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var c={node:e,ping:function(){var l=t.pingedTasks;l.push(c),l.length===1&&zE(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(c),c}function sp(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Cd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function ap(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function vb(t,e,n,r,i){for(ps={},dC=e,yd=0,t=n(r,i);op;)op=!1,yd=0,ng+=1,pt=null,t=n(r,i);return hC(),t}function yb(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(Ue(108,Gv(r)||"Unknown",a));r=Hu({},s,n)}e.legacyContext=r,Pr(t,e,i),e.legacyContext=s}else Pr(t,e,i)}function Cb(t,e){if(t&&t.defaultProps){e=Hu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function jv(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=ub(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue2:i),fb(o,n,r,i),yb(t,e,o,n)}else{o=ub(n,e.legacyContext),i=vb(t,e,n,r,o);var s=yd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)fb(i,n,r,o),yb(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=Wv(r,1,0);try{Pr(t,e,i)}finally{e.treeContext=r}}else Pr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=f2(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=l2(s,n,r),Zv(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case I2:case C2:case PE:case NE:case xE:Pr(t,e,r.children);return;case LE:Pr(t,e,r.children);return;case y2:throw Error(Ue(343));case DE:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},c=sp(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=sp(t,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=l;try{if(Zv(t,e,r),t.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),l.status=1,cp(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=Cd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=pC(t,o,n,c,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ME:if(r=vb(t,e,n.render,r,i),yd!==0){n=e.treeContext,e.treeContext=Wv(n,1,0);try{Pr(t,e,r)}finally{e.treeContext=n}}else Pr(t,e,r);return;case FE:n=n.type,r=Cb(n,r),jv(t,e,n,r,i);return;case _E:if(i=r.children,n=n._context,r=r.value,o=n._currentValue2,n._currentValue2=r,s=Ga,Ga=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Pr(t,e,i),t=Ga,t===null)throw Error(Ue(403));r=t.parentValue,t.context._currentValue2=r===S2?t.context._defaultValue:r,t=Ga=t.parent,e.context=t;return;case OE:r=r.children,r=r(n._currentValue2),Pr(t,e,r);return;case uC:i=n._init,n=i(n._payload),r=Cb(n,r),jv(t,e,n,r,void 0);return}throw Error(Ue(130,n==null?n:typeof n,""))}}function Pr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case v2:jv(t,e,n.type,n.props,n.ref);return;case RE:throw Error(Ue(257));case uC:var r=n._init;n=r(n._payload),Pr(t,e,n);return}if(Vv(n)){Ib(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=lb&&n[lb]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);Ib(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(Ue(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=cb(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=cb(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function Ib(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=Wv(o,r,i);try{Zv(t,e,n[i])}finally{e.treeContext=o}}}function Zv(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Pr(t,e,n)}catch(c){if(hC(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var s=e.blockedSegment,a=sp(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=pC(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,ip(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,ip(o),c}}function _2(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,HE(this,e,t)}function ZE(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(Ue(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return ZE(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function cp(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&cp(t,n)}else t.completedSegments.push(e)}function HE(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(Ue(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=Tu,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&cp(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(_2,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(cp(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function zE(t){if(t.status!==2){var e=Ga,n=om.current;om.current=mb;var r=uh;uh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,c=s.blockedSegment;if(c.status===0){ip(s.context);try{Pr(a,s,s.node),a.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),s.abortSet.delete(s),c.status=1,HE(a,s.blockedBoundary,c)}catch(p){if(hC(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=s.ping;p.then(l,l)}else{s.abortSet.delete(s),c.status=4;var u=s.blockedBoundary,d=p,f=Cd(a,d);if(u===null?ap(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&gC(t,t.destination)}catch(p){Cd(t,p),ap(t,p)}finally{uh=r,om.current=n,n===mb&&ip(e)}}}function Of(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)e.push(r[o]);i=rg(t,e,i)}for(;o<r.length-1;o++)e.push(r[o]);return o<r.length&&(i=e.push(r[o])),i;default:throw Error(Ue(390))}}function rg(t,e,n){var r=n.boundary;if(r===null)return Of(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)return t.responseState.generateStaticMarkup||(r=r.errorDigest,e.push("<!--$!-->"),e.push("<template"),r&&(e.push(' data-dgst="'),r=Kn(r),e.push(r),e.push('"')),e.push("></template>")),Of(t,e,n),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;return i=i.boundaryPrefix+o.toString(16),r=r.id=i,ab(e,t.responseState,r),Of(t,e,n),e.push("<!--/$-->")}if(r.byteSize>t.progressiveChunkSize)return r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),ab(e,t.responseState,r.id),Of(t,e,n),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(Ue(391));return rg(t,e,n[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function Sb(t,e,n){return h2(e,t.responseState,n.formatContext,n.id),rg(t,e,n),p2(e,n.formatContext)}function bb(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)XE(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(Ue(395));return n=n.toString(16),e.push(r),e.push('","'),e.push(t.segmentPrefix),e.push(n),e.push('")<\/script>')}function XE(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Ue(392));return Sb(t,e,r)}return Sb(t,e,r),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),i=i.toString(16),e.push(i),e.push('","'),e.push(t.placeholderPrefix),e.push(i),e.push('")<\/script>')}function gC(t,e){try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){rg(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)e.push(r[n]);n<r.length&&e.push(r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,c=s.id,l=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),c===null)throw Error(Ue(395));if(r.push(c),r.push('"'),l||u||d){r.push(",");var f=im(l||"");r.push(f)}if(u||d){r.push(",");var h=im(u||"");r.push(h)}if(d){r.push(",");var p=im(d);r.push(p)}if(!r.push(")<\/script>")){t.destination=null,o++,i.splice(0,o);return}}i.splice(0,o);var m=t.completedBoundaries;for(o=0;o<m.length;o++)if(!bb(t,e,m[o])){t.destination=null,o++,m.splice(0,o);return}m.splice(0,o);var C=t.partialBoundaries;for(o=0;o<C.length;o++){var g=C[o];e:{i=t,s=e;var v=g.completedSegments;for(a=0;a<v.length;a++)if(!XE(i,s,g,v[a])){a++,v.splice(0,a);var S=!1;break e}v.splice(0,a),S=!0}if(!S){t.destination=null,o++,C.splice(0,o);return}}C.splice(0,o);var k=t.completedBoundaries;for(o=0;o<k.length;o++)if(!bb(t,e,k[o])){t.destination=null,o++,k.splice(0,o);return}k.splice(0,o)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function O2(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return ZE(r,t,e)}),n.clear(),t.destination!==null&&gC(t,t.destination)}catch(r){Cd(t,r),ap(t,r)}}function M2(){}function $E(t,e,n,r){var i=!1,o=null,s="",a={push:function(l){return l!==null&&(s+=l),!0},destroy:function(l){i=!0,o=l}},c=!1;if(t=N2(t,m2(n,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,M2,void 0,function(){c=!0}),zE(t),O2(t,r),t.status===1)t.status=2,a.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=a;try{gC(t,a)}catch(l){Cd(t,l),ap(t,l)}}if(i)throw o;if(!c)throw Error(Ue(426));return s}Ml.renderToNodeStream=function(){throw Error(Ue(207))};Ml.renderToStaticMarkup=function(t,e){return $E(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Ml.renderToStaticNodeStream=function(){throw Error(Ue(208))};Ml.renderToString=function(t,e){return $E(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Ml.version="18.3.1";var mC={},KE=b;function je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nr=null,_r=0;function Te(t,e){if(e.length!==0)if(512<e.length)0<_r&&(t.enqueue(new Uint8Array(Nr.buffer,0,_r)),Nr=new Uint8Array(512),_r=0),t.enqueue(e);else{var n=Nr.length-_r;n<e.length&&(n===0?t.enqueue(Nr):(Nr.set(e.subarray(0,n),_r),t.enqueue(Nr),e=e.subarray(n)),Nr=new Uint8Array(512),_r=0),Nr.set(e,_r),_r+=e.length}}function wt(t,e){return Te(t,e),!0}function wb(t){Nr&&0<_r&&(t.enqueue(new Uint8Array(Nr.buffer,0,_r)),Nr=null,_r=0)}var JE=new TextEncoder;function ze(t){return JE.encode(t)}function ve(t){return JE.encode(t)}function YE(t,e){typeof t.error=="function"?t.error(e):t.close()}var ar=Object.prototype.hasOwnProperty,D2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ab={},kb={};function QE(t){return ar.call(kb,t)?!0:ar.call(Ab,t)?!1:D2.test(t)?kb[t]=!0:(Ab[t]=!0,!1)}function ir(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var En={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){En[t]=new ir(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];En[e]=new ir(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){En[t]=new ir(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){En[t]=new ir(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){En[t]=new ir(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){En[t]=new ir(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){En[t]=new ir(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){En[t]=new ir(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){En[t]=new ir(t,5,!1,t.toLowerCase(),null,!1,!1)});var vC=/[\-:]([a-z])/g;function yC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(vC,yC);En[e]=new ir(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(vC,yC);En[e]=new ir(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(vC,yC);En[e]=new ir(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){En[t]=new ir(t,1,!1,t.toLowerCase(),null,!1,!1)});En.xlinkHref=new ir("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){En[t]=new ir(t,1,!1,t.toLowerCase(),null,!0,!0)});var dh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},L2=["Webkit","ms","Moz","O"];Object.keys(dh).forEach(function(t){L2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dh[e]=dh[t]})});var F2=/["'&<>]/;function In(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=F2.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var B2=/([A-Z])/g,U2=/^ms-/,Hv=Array.isArray,V2=ve("<script>"),G2=ve("<\/script>"),W2=ve('<script src="'),j2=ve('<script type="module" src="'),Eb=ve('" async=""><\/script>'),Z2=/(<\/|<)(s)(cript)/gi;function H2(t,e,n,r){return""+e+(n==="s"?"\\u0073":"\\u0053")+r}function z2(t,e,n,r,i){t=t===void 0?"":t,e=e===void 0?V2:ve('<script nonce="'+In(e)+'">');var o=[];if(n!==void 0&&o.push(e,ze((""+n).replace(Z2,H2)),G2),r!==void 0)for(n=0;n<r.length;n++)o.push(W2,ze(In(r[n])),Eb);if(i!==void 0)for(r=0;r<i.length;r++)o.push(j2,ze(In(i[r])),Eb);return{bootstrapChunks:o,startInlineScript:e,placeholderPrefix:ve(t+"P:"),segmentPrefix:ve(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Zi(t,e){return{insertionMode:t,selectedValue:e}}function X2(t){return Zi(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function $2(t,e,n){switch(e){case"select":return Zi(1,n.value!=null?n.value:n.defaultValue);case"svg":return Zi(2,null);case"math":return Zi(3,null);case"foreignObject":return Zi(1,null);case"table":return Zi(4,null);case"thead":case"tbody":case"tfoot":return Zi(5,null);case"colgroup":return Zi(7,null);case"tr":return Zi(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Zi(1,null):t}var CC=ve("<!-- -->");function Tb(t,e,n,r){return e===""?r:(r&&t.push(CC),t.push(ze(In(e))),!0)}var Rb=new Map,K2=ve(' style="'),xb=ve(":"),J2=ve(";");function qE(t,e,n){if(typeof n!="object")throw Error(je(62));e=!0;for(var r in n)if(ar.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=ze(In(r));i=ze(In((""+i).trim()))}else{o=r;var s=Rb.get(o);s!==void 0||(s=ve(In(o.replace(B2,"-$1").toLowerCase().replace(U2,"-ms-"))),Rb.set(o,s)),o=s,i=typeof i=="number"?i===0||ar.call(dh,r)?ze(""+i):ze(i+"px"):ze(In((""+i).trim()))}e?(e=!1,t.push(K2,o,xb,i)):t.push(J2,o,xb,i)}}e||t.push(Oa)}var Ps=ve(" "),xc=ve('="'),Oa=ve('"'),Pb=ve('=""');function wr(t,e,n,r){switch(n){case"style":qE(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=En.hasOwnProperty(n)?En[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=ze(e.attributeName),e.type){case 3:r&&t.push(Ps,n,Pb);break;case 4:r===!0?t.push(Ps,n,Pb):r!==!1&&t.push(Ps,n,xc,ze(In(r)),Oa);break;case 5:isNaN(r)||t.push(Ps,n,xc,ze(In(r)),Oa);break;case 6:!isNaN(r)&&1<=r&&t.push(Ps,n,xc,ze(In(r)),Oa);break;default:e.sanitizeURL&&(r=""+r),t.push(Ps,n,xc,ze(In(r)),Oa)}}else if(QE(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(Ps,ze(n),xc,ze(In(r)),Oa)}}}var Ns=ve(">"),Nb=ve("/>");function fh(t,e,n){if(e!=null){if(n!=null)throw Error(je(60));if(typeof e!="object"||!("__html"in e))throw Error(je(61));e=e.__html,e!=null&&t.push(ze(""+e))}}function Y2(t){var e="";return KE.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var sm=ve(' selected=""');function am(t,e,n,r){t.push(Hi(n));var i=n=null,o;for(o in e)if(ar.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:wr(t,r,o,s)}}return t.push(Ns),fh(t,i,n),typeof n=="string"?(t.push(ze(In(n))),null):n}var cm=ve(`
`),Q2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,_b=new Map;function Hi(t){var e=_b.get(t);if(e===void 0){if(!Q2.test(t))throw Error(je(65,t));e=ve("<"+t),_b.set(t,e)}return e}var q2=ve("<!DOCTYPE html>");function eL(t,e,n,r,i){switch(e){case"select":t.push(Hi("select"));var o=null,s=null;for(u in n)if(ar.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:wr(t,r,u,a)}}return t.push(Ns),fh(t,s,o),o;case"option":s=i.selectedValue,t.push(Hi("option"));var c=a=null,l=null,u=null;for(o in n)if(ar.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:wr(t,r,o,d)}}if(s!=null)if(n=c!==null?""+c:Y2(a),Hv(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(sm);break}}else""+s===n&&t.push(sm);else l&&t.push(sm);return t.push(Ns),fh(t,u,a),a;case"textarea":t.push(Hi("textarea")),u=s=o=null;for(a in n)if(ar.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":o=c;break;case"defaultValue":s=c;break;case"dangerouslySetInnerHTML":throw Error(je(91));default:wr(t,r,a,c)}if(o===null&&s!==null&&(o=s),t.push(Ns),u!=null){if(o!=null)throw Error(je(92));if(Hv(u)&&1<u.length)throw Error(je(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(cm),o!==null&&t.push(ze(In(""+o))),null;case"input":t.push(Hi("input")),c=u=a=o=null;for(s in n)if(ar.call(n,s)&&(l=n[s],l!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":o=l;break;default:wr(t,r,s,l)}return u!==null?wr(t,r,"checked",u):c!==null&&wr(t,r,"checked",c),o!==null?wr(t,r,"value",o):a!==null&&wr(t,r,"value",a),t.push(Nb),null;case"menuitem":t.push(Hi("menuitem"));for(var f in n)if(ar.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(je(400));default:wr(t,r,f,o)}return t.push(Ns),null;case"title":t.push(Hi("title")),o=null;for(d in n)if(ar.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(je(434));default:wr(t,r,d,s)}return t.push(Ns),o;case"listing":case"pre":t.push(Hi(e)),s=o=null;for(c in n)if(ar.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:wr(t,r,c,a)}if(t.push(Ns),s!=null){if(o!=null)throw Error(je(60));if(typeof s!="object"||!("__html"in s))throw Error(je(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(cm,ze(n)):t.push(ze(""+n)))}return typeof o=="string"&&o[0]===`
`&&t.push(cm),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(Hi(e));for(var h in n)if(ar.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,e));default:wr(t,r,h,o)}return t.push(Nb),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return am(t,n,e,r);case"html":return i.insertionMode===0&&t.push(q2),am(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return am(t,n,e,r);t.push(Hi(e)),s=o=null;for(l in n)if(ar.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":qE(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:QE(l)&&typeof a!="function"&&typeof a!="symbol"&&t.push(Ps,ze(l),xc,ze(In(a)),Oa)}return t.push(Ns),fh(t,s,o),o}}var tL=ve("</"),nL=ve(">"),rL=ve('<template id="'),iL=ve('"></template>'),oL=ve("<!--$-->"),sL=ve('<!--$?--><template id="'),aL=ve('"></template>'),cL=ve("<!--$!-->"),lL=ve("<!--/$-->"),uL=ve("<template"),dL=ve('"'),fL=ve(' data-dgst="');ve(' data-msg="');ve(' data-stck="');var hL=ve("></template>");function Ob(t,e,n){if(Te(t,sL),n===null)throw Error(je(395));return Te(t,n),wt(t,aL)}var pL=ve('<div hidden id="'),gL=ve('">'),mL=ve("</div>"),vL=ve('<svg aria-hidden="true" style="display:none" id="'),yL=ve('">'),CL=ve("</svg>"),IL=ve('<math aria-hidden="true" style="display:none" id="'),SL=ve('">'),bL=ve("</math>"),wL=ve('<table hidden id="'),AL=ve('">'),kL=ve("</table>"),EL=ve('<table hidden><tbody id="'),TL=ve('">'),RL=ve("</tbody></table>"),xL=ve('<table hidden><tr id="'),PL=ve('">'),NL=ve("</tr></table>"),_L=ve('<table hidden><colgroup id="'),OL=ve('">'),ML=ve("</colgroup></table>");function DL(t,e,n,r){switch(n.insertionMode){case 0:case 1:return Te(t,pL),Te(t,e.segmentPrefix),Te(t,ze(r.toString(16))),wt(t,gL);case 2:return Te(t,vL),Te(t,e.segmentPrefix),Te(t,ze(r.toString(16))),wt(t,yL);case 3:return Te(t,IL),Te(t,e.segmentPrefix),Te(t,ze(r.toString(16))),wt(t,SL);case 4:return Te(t,wL),Te(t,e.segmentPrefix),Te(t,ze(r.toString(16))),wt(t,AL);case 5:return Te(t,EL),Te(t,e.segmentPrefix),Te(t,ze(r.toString(16))),wt(t,TL);case 6:return Te(t,xL),Te(t,e.segmentPrefix),Te(t,ze(r.toString(16))),wt(t,PL);case 7:return Te(t,_L),Te(t,e.segmentPrefix),Te(t,ze(r.toString(16))),wt(t,OL);default:throw Error(je(397))}}function LL(t,e){switch(e.insertionMode){case 0:case 1:return wt(t,mL);case 2:return wt(t,CL);case 3:return wt(t,bL);case 4:return wt(t,kL);case 5:return wt(t,RL);case 6:return wt(t,NL);case 7:return wt(t,ML);default:throw Error(je(397))}}var FL=ve('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),BL=ve('$RS("'),UL=ve('","'),VL=ve('")<\/script>'),GL=ve('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),WL=ve('$RC("'),jL=ve('","'),ZL=ve('")<\/script>'),HL=ve('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),zL=ve('$RX("'),XL=ve('"'),$L=ve(")<\/script>"),lm=ve(","),KL=/[<\u2028\u2029]/g;function um(t){return JSON.stringify(t).replace(KL,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var zu=Object.assign,JL=Symbol.for("react.element"),eT=Symbol.for("react.portal"),tT=Symbol.for("react.fragment"),nT=Symbol.for("react.strict_mode"),rT=Symbol.for("react.profiler"),iT=Symbol.for("react.provider"),oT=Symbol.for("react.context"),sT=Symbol.for("react.forward_ref"),aT=Symbol.for("react.suspense"),cT=Symbol.for("react.suspense_list"),lT=Symbol.for("react.memo"),IC=Symbol.for("react.lazy"),YL=Symbol.for("react.scope"),QL=Symbol.for("react.debug_trace_mode"),qL=Symbol.for("react.legacy_hidden"),eF=Symbol.for("react.default_value"),Mb=Symbol.iterator;function zv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case tT:return"Fragment";case eT:return"Portal";case rT:return"Profiler";case nT:return"StrictMode";case aT:return"Suspense";case cT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case oT:return(t.displayName||"Context")+".Consumer";case iT:return(t._context.displayName||"Context")+".Provider";case sT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case lT:return e=t.displayName||null,e!==null?e:zv(t.type)||"Memo";case IC:e=t._payload,t=t._init;try{return zv(t(e))}catch{}}return null}var uT={};function Db(t,e){if(t=t.contextTypes,!t)return uT;var n={},r;for(r in t)n[r]=e[r];return n}var Wa=null;function ig(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(je(401))}else{if(n===null)throw Error(je(401));ig(t,n)}e.context._currentValue=e.value}}function dT(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&dT(t)}function fT(t){var e=t.parent;e!==null&&fT(e),t.context._currentValue=t.value}function hT(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(je(402));t.depth===e.depth?ig(t,e):hT(t,e)}function pT(t,e){var n=e.parent;if(n===null)throw Error(je(402));t.depth===n.depth?ig(t,n):pT(t,n),e.context._currentValue=e.value}function lp(t){var e=Wa;e!==t&&(e===null?fT(t):t===null?dT(e):e.depth===t.depth?ig(e,t):e.depth>t.depth?hT(e,t):pT(e,t),Wa=t)}var Lb={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function Fb(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=Lb,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:zu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&Lb.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=zu({},o,a)):zu(o,a))}t.state=o}else o.queue=null}var tF={id:1,overflow:""};function Xv(t,e,n){var r=t.id;t=t.overflow;var i=32-hh(r)-1;r&=~(1<<i),n+=1;var o=32-hh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-hh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var hh=Math.clz32?Math.clz32:iF,nF=Math.log,rF=Math.LN2;function iF(t){return t>>>=0,t===0?32:31-(nF(t)/rF|0)|0}function oF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sF=typeof Object.is=="function"?Object.is:oF,gs=null,SC=null,ph=null,gt=null,Ru=!1,up=!1,Id=0,zs=null,og=0;function Ma(){if(gs===null)throw Error(je(321));return gs}function Bb(){if(0<og)throw Error(je(312));return{memoizedState:null,queue:null,next:null}}function bC(){return gt===null?ph===null?(Ru=!1,ph=gt=Bb()):(Ru=!0,gt=ph):gt.next===null?(Ru=!1,gt=gt.next=Bb()):(Ru=!0,gt=gt.next),gt}function wC(){SC=gs=null,up=!1,ph=null,og=0,gt=zs=null}function gT(t,e){return typeof e=="function"?e(t):e}function Ub(t,e,n){if(gs=Ma(),gt=bC(),Ru){var r=gt.queue;if(e=r.dispatch,zs!==null&&(n=zs.get(r),n!==void 0)){zs.delete(r),r=gt.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return gt.memoizedState=r,[r,e]}return[gt.memoizedState,e]}return t=t===gT?typeof e=="function"?e():e:n!==void 0?n(e):e,gt.memoizedState=t,t=gt.queue={last:null,dispatch:null},t=t.dispatch=aF.bind(null,gs,t),[gt.memoizedState,t]}function Vb(t,e){if(gs=Ma(),gt=bC(),e=e===void 0?null:e,gt!==null){var n=gt.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!sF(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),gt.memoizedState=[t,e],t}function aF(t,e,n){if(25<=og)throw Error(je(301));if(t===gs)if(up=!0,t={action:n,next:null},zs===null&&(zs=new Map),n=zs.get(e),n===void 0)zs.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function cF(){throw Error(je(394))}function Mf(){}var Gb={readContext:function(t){return t._currentValue},useContext:function(t){return Ma(),t._currentValue},useMemo:Vb,useReducer:Ub,useRef:function(t){gs=Ma(),gt=bC();var e=gt.memoizedState;return e===null?(t={current:t},gt.memoizedState=t):e},useState:function(t){return Ub(gT,t)},useInsertionEffect:Mf,useLayoutEffect:function(){},useCallback:function(t,e){return Vb(function(){return t},e)},useImperativeHandle:Mf,useEffect:Mf,useDebugValue:Mf,useDeferredValue:function(t){return Ma(),t},useTransition:function(){return Ma(),[!1,cF]},useId:function(){var t=SC.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-hh(t)-1)).toString(32)+e;var n=gh;if(n===null)throw Error(je(404));return e=Id++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return Ma(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(je(407));return n()}},gh=null,dm=KE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function lF(t){return console.error(t),null}function xu(){}function uF(t,e,n,r,i,o,s,a,c){var l=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?lF:i,onAllReady:o===void 0?xu:o,onShellReady:s===void 0?xu:s,onShellError:a===void 0?xu:a,onFatalError:c===void 0?xu:c},n=dp(e,0,null,n,!1,!1),n.parentFlushed=!0,t=AC(e,t,null,n,u,uT,null,tF),l.push(t),e}function AC(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var c={node:e,ping:function(){var l=t.pingedTasks;l.push(c),l.length===1&&yT(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(c),c}function dp(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Sd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function fp(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,YE(t.destination,e)):(t.status=1,t.fatalError=e)}function Wb(t,e,n,r,i){for(gs={},SC=e,Id=0,t=n(r,i);up;)up=!1,Id=0,og+=1,gt=null,t=n(r,i);return wC(),t}function jb(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(je(108,zv(r)||"Unknown",a));r=zu({},s,n)}e.legacyContext=r,Or(t,e,i),e.legacyContext=s}else Or(t,e,i)}function Zb(t,e){if(t&&t.defaultProps){e=zu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function $v(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=Db(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue:i),Fb(o,n,r,i),jb(t,e,o,n)}else{o=Db(n,e.legacyContext),i=Wb(t,e,n,r,o);var s=Id!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)Fb(i,n,r,o),jb(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=Xv(r,1,0);try{Or(t,e,i)}finally{e.treeContext=r}}else Or(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=eL(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=$2(s,n,r),Kv(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(tL,ze(n),nL)}i.lastPushedText=!1}else{switch(n){case qL:case QL:case nT:case rT:case tT:Or(t,e,r.children);return;case cT:Or(t,e,r.children);return;case YL:throw Error(je(343));case aT:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},c=dp(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=dp(t,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=l;try{if(Kv(t,e,r),l.lastPushedText&&l.textEmbedded&&l.chunks.push(CC),l.status=1,hp(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=Sd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=AC(t,o,n,c,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case sT:if(r=Wb(t,e,n.render,r,i),Id!==0){n=e.treeContext,e.treeContext=Xv(n,1,0);try{Or(t,e,r)}finally{e.treeContext=n}}else Or(t,e,r);return;case lT:n=n.type,r=Zb(n,r),$v(t,e,n,r,i);return;case iT:if(i=r.children,n=n._context,r=r.value,o=n._currentValue,n._currentValue=r,s=Wa,Wa=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Or(t,e,i),t=Wa,t===null)throw Error(je(403));r=t.parentValue,t.context._currentValue=r===eF?t.context._defaultValue:r,t=Wa=t.parent,e.context=t;return;case oT:r=r.children,r=r(n._currentValue),Or(t,e,r);return;case IC:i=n._init,n=i(n._payload),r=Zb(n,r),$v(t,e,n,r,void 0);return}throw Error(je(130,n==null?n:typeof n,""))}}function Or(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case JL:$v(t,e,n.type,n.props,n.ref);return;case eT:throw Error(je(257));case IC:var r=n._init;n=r(n._payload),Or(t,e,n);return}if(Hv(n)){Hb(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=Mb&&n[Mb]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);Hb(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(je(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=Tb(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=Tb(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function Hb(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=Xv(o,r,i);try{Kv(t,e,n[i])}finally{e.treeContext=o}}}function Kv(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Or(t,e,n)}catch(c){if(wC(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var s=e.blockedSegment,a=dp(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=AC(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,lp(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,lp(o),c}}function dF(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,vT(this,e,t)}function mT(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(je(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return mT(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function hp(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&hp(t,n)}else t.completedSegments.push(e)}function vT(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(je(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=xu,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&hp(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(dF,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(hp(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function yT(t){if(t.status!==2){var e=Wa,n=dm.current;dm.current=Gb;var r=gh;gh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,c=s.blockedSegment;if(c.status===0){lp(s.context);try{Or(a,s,s.node),c.lastPushedText&&c.textEmbedded&&c.chunks.push(CC),s.abortSet.delete(s),c.status=1,vT(a,s.blockedBoundary,c)}catch(p){if(wC(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=s.ping;p.then(l,l)}else{s.abortSet.delete(s),c.status=4;var u=s.blockedBoundary,d=p,f=Sd(a,d);if(u===null?fp(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&kC(t,t.destination)}catch(p){Sd(t,p),fp(t,p)}finally{gh=r,dm.current=n,n===Gb&&lp(e)}}}function Df(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,Te(e,rL),Te(e,t.placeholderPrefix),t=ze(r.toString(16)),Te(e,t),wt(e,iL);case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)Te(e,r[o]);i=sg(t,e,i)}for(;o<r.length-1;o++)Te(e,r[o]);return o<r.length&&(i=wt(e,r[o])),i;default:throw Error(je(390))}}function sg(t,e,n){var r=n.boundary;if(r===null)return Df(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,wt(e,cL),Te(e,uL),r&&(Te(e,fL),Te(e,ze(In(r))),Te(e,dL)),wt(e,hL),Df(t,e,n);else if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;i=ve(i.boundaryPrefix+o.toString(16)),r=r.id=i,Ob(e,t.responseState,r),Df(t,e,n)}else if(r.byteSize>t.progressiveChunkSize)r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),Ob(e,t.responseState,r.id),Df(t,e,n);else{if(wt(e,oL),n=r.completedSegments,n.length!==1)throw Error(je(391));sg(t,e,n[0])}return wt(e,lL)}function zb(t,e,n){return DL(e,t.responseState,n.formatContext,n.id),sg(t,e,n),LL(e,n.formatContext)}function Xb(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)CT(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,Te(e,t.startInlineScript),t.sentCompleteBoundaryFunction?Te(e,WL):(t.sentCompleteBoundaryFunction=!0,Te(e,GL)),r===null)throw Error(je(395));return n=ze(n.toString(16)),Te(e,r),Te(e,jL),Te(e,t.segmentPrefix),Te(e,n),wt(e,ZL)}function CT(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(je(392));return zb(t,e,r)}return zb(t,e,r),t=t.responseState,Te(e,t.startInlineScript),t.sentCompleteSegmentFunction?Te(e,BL):(t.sentCompleteSegmentFunction=!0,Te(e,FL)),Te(e,t.segmentPrefix),i=ze(i.toString(16)),Te(e,i),Te(e,UL),Te(e,t.placeholderPrefix),Te(e,i),wt(e,VL)}function kC(t,e){Nr=new Uint8Array(512),_r=0;try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){sg(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)Te(e,r[n]);n<r.length&&wt(e,r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,c=s.id,l=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(Te(r,a.startInlineScript),a.sentClientRenderFunction?Te(r,zL):(a.sentClientRenderFunction=!0,Te(r,HL)),c===null)throw Error(je(395));Te(r,c),Te(r,XL),(l||u||d)&&(Te(r,lm),Te(r,ze(um(l||"")))),(u||d)&&(Te(r,lm),Te(r,ze(um(u||"")))),d&&(Te(r,lm),Te(r,ze(um(d)))),wt(r,$L)}i.splice(0,o);var f=t.completedBoundaries;for(o=0;o<f.length;o++)Xb(t,e,f[o]);f.splice(0,o),wb(e),Nr=new Uint8Array(512),_r=0;var h=t.partialBoundaries;for(o=0;o<h.length;o++){var p=h[o];e:{i=t,s=e;var m=p.completedSegments;for(a=0;a<m.length;a++)if(!CT(i,s,p,m[a])){a++,m.splice(0,a);var C=!1;break e}m.splice(0,a),C=!0}if(!C){t.destination=null,o++,h.splice(0,o);return}}h.splice(0,o);var g=t.completedBoundaries;for(o=0;o<g.length;o++)Xb(t,e,g[o]);g.splice(0,o)}finally{wb(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function $b(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return mT(r,t,e)}),n.clear(),t.destination!==null&&kC(t,t.destination)}catch(r){Sd(t,r),fp(t,r)}}mC.renderToReadableStream=function(t,e){return new Promise(function(n,r){var i,o,s=new Promise(function(u,d){o=u,i=d}),a=uF(t,z2(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),X2(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,YE(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{kC(a,d)}catch(f){Sd(a,f),fp(a,f)}}},cancel:function(){$b(a)}},{highWaterMark:0});u.allReady=s,n(u)},function(u){s.catch(function(){}),r(u)},i);if(e&&e.signal){var c=e.signal,l=function(){$b(a,c.reason),c.removeEventListener("abort",l)};c.addEventListener("abort",l)}yT(a)})};mC.version="18.3.1";var Dl,IT;Dl=Ml,IT=mC;da.version=Dl.version;da.renderToString=Dl.renderToString;da.renderToStaticMarkup=Dl.renderToStaticMarkup;da.renderToNodeStream=Dl.renderToNodeStream;da.renderToStaticNodeStream=Dl.renderToStaticNodeStream;da.renderToReadableStream=IT.renderToReadableStream;/*! @license DOMPurify 3.1.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.6/LICENSE */const{entries:ST,setPrototypeOf:Kb,isFrozen:fF,getPrototypeOf:hF,getOwnPropertyDescriptor:pF}=Object;let{freeze:er,seal:oi,create:bT}=Object,{apply:Jv,construct:Yv}=typeof Reflect<"u"&&Reflect;er||(er=function(e){return e});oi||(oi=function(e){return e});Jv||(Jv=function(e,n,r){return e.apply(n,r)});Yv||(Yv=function(e,n){return new e(...n)});const Lf=Gr(Array.prototype.forEach),Jb=Gr(Array.prototype.pop),lu=Gr(Array.prototype.push),mh=Gr(String.prototype.toLowerCase),fm=Gr(String.prototype.toString),Yb=Gr(String.prototype.match),uu=Gr(String.prototype.replace),gF=Gr(String.prototype.indexOf),mF=Gr(String.prototype.trim),li=Gr(Object.prototype.hasOwnProperty),Wn=Gr(RegExp.prototype.test),du=vF(TypeError);function Gr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Jv(t,e,r)}}function vF(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Yv(t,n)}}function $e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:mh;Kb&&Kb(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(fF(e)||(e[r]=o),i=o)}t[i]=!0}return t}function yF(t){for(let e=0;e<t.length;e++)li(t,e)||(t[e]=null);return t}function Pa(t){const e=bT(null);for(const[n,r]of ST(t))li(t,n)&&(Array.isArray(r)?e[n]=yF(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Pa(r):e[n]=r);return e}function fu(t,e){for(;t!==null;){const r=pF(t,e);if(r){if(r.get)return Gr(r.get);if(typeof r.value=="function")return Gr(r.value)}t=hF(t)}function n(){return null}return n}const Qb=er(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),hm=er(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),pm=er(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),CF=er(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),gm=er(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),IF=er(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),qb=er(["#text"]),ew=er(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),mm=er(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),tw=er(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ff=er(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),SF=oi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),bF=oi(/<%[\w\W]*|[\w\W]*%>/gm),wF=oi(/\${[\w\W]*}/gm),AF=oi(/^data-[\-\w.\u00B7-\uFFFF]/),kF=oi(/^aria-[\-\w]+$/),wT=oi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),EF=oi(/^(?:\w+script|data):/i),TF=oi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),AT=oi(/^html$/i),RF=oi(/^[a-z][.\w]*(-[.\w]+)+$/i);var nw=Object.freeze({__proto__:null,MUSTACHE_EXPR:SF,ERB_EXPR:bF,TMPLIT_EXPR:wF,DATA_ATTR:AF,ARIA_ATTR:kF,IS_ALLOWED_URI:wT,IS_SCRIPT_OR_DATA:EF,ATTR_WHITESPACE:TF,DOCTYPE_NAME:AT,CUSTOM_ELEMENT:RF});const hu={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},xF=function(){return typeof window>"u"?null:window},PF=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function kT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xF();const e=ee=>kT(ee);if(e.version="3.1.6",e.removed=[],!t||!t.document||t.document.nodeType!==hu.document)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:c,NodeFilter:l,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:h}=t,p=c.prototype,m=fu(p,"cloneNode"),C=fu(p,"remove"),g=fu(p,"nextSibling"),v=fu(p,"childNodes"),S=fu(p,"parentNode");if(typeof s=="function"){const ee=n.createElement("template");ee.content&&ee.content.ownerDocument&&(n=ee.content.ownerDocument)}let k,A="";const{implementation:R,createNodeIterator:P,createDocumentFragment:w,getElementsByTagName:_}=n,{importNode:O}=r;let L={};e.isSupported=typeof ST=="function"&&typeof S=="function"&&R&&R.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:X,TMPLIT_EXPR:H,DATA_ATTR:J,ARIA_ATTR:te,IS_SCRIPT_OR_DATA:le,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:z}=nw;let{IS_ALLOWED_URI:se}=nw,j=null;const oe=$e({},[...Qb,...hm,...pm,...gm,...qb]);let Ce=null;const Be=$e({},[...ew,...mm,...tw,...Ff]);let fe=Object.seal(bT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,Xe=null,me=!0,Qt=!0,zt=!1,Vn=!0,Vt=!1,Pn=!0,qe=!1,de=!1,Ie=!1,We=!1,Le=!1,Me=!1,et=!0,xt=!1;const Pt="user-content-";let Gn=!0,Ir=!1,qt={},un=null;const E=$e({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let y=null;const I=$e({},["audio","video","img","source","image","track"]);let x=null;const F=$e({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),W="http://www.w3.org/1998/Math/MathML",Y="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml";let Ze=_e,ot=!1,st=null;const rt=$e({},[W,Y,_e],fm);let wa=null;const sf=["application/xhtml+xml","text/html"],Cc="text/html";let Gt=null,Gi=null;const Ic=n.createElement("form"),Sc=function(M){return M instanceof RegExp||M instanceof Function},Jl=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Gi&&Gi===M)){if((!M||typeof M!="object")&&(M={}),M=Pa(M),wa=sf.indexOf(M.PARSER_MEDIA_TYPE)===-1?Cc:M.PARSER_MEDIA_TYPE,Gt=wa==="application/xhtml+xml"?fm:mh,j=li(M,"ALLOWED_TAGS")?$e({},M.ALLOWED_TAGS,Gt):oe,Ce=li(M,"ALLOWED_ATTR")?$e({},M.ALLOWED_ATTR,Gt):Be,st=li(M,"ALLOWED_NAMESPACES")?$e({},M.ALLOWED_NAMESPACES,fm):rt,x=li(M,"ADD_URI_SAFE_ATTR")?$e(Pa(F),M.ADD_URI_SAFE_ATTR,Gt):F,y=li(M,"ADD_DATA_URI_TAGS")?$e(Pa(I),M.ADD_DATA_URI_TAGS,Gt):I,un=li(M,"FORBID_CONTENTS")?$e({},M.FORBID_CONTENTS,Gt):E,Pe=li(M,"FORBID_TAGS")?$e({},M.FORBID_TAGS,Gt):{},Xe=li(M,"FORBID_ATTR")?$e({},M.FORBID_ATTR,Gt):{},qt=li(M,"USE_PROFILES")?M.USE_PROFILES:!1,me=M.ALLOW_ARIA_ATTR!==!1,Qt=M.ALLOW_DATA_ATTR!==!1,zt=M.ALLOW_UNKNOWN_PROTOCOLS||!1,Vn=M.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Vt=M.SAFE_FOR_TEMPLATES||!1,Pn=M.SAFE_FOR_XML!==!1,qe=M.WHOLE_DOCUMENT||!1,We=M.RETURN_DOM||!1,Le=M.RETURN_DOM_FRAGMENT||!1,Me=M.RETURN_TRUSTED_TYPE||!1,Ie=M.FORCE_BODY||!1,et=M.SANITIZE_DOM!==!1,xt=M.SANITIZE_NAMED_PROPS||!1,Gn=M.KEEP_CONTENT!==!1,Ir=M.IN_PLACE||!1,se=M.ALLOWED_URI_REGEXP||wT,Ze=M.NAMESPACE||_e,fe=M.CUSTOM_ELEMENT_HANDLING||{},M.CUSTOM_ELEMENT_HANDLING&&Sc(M.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(fe.tagNameCheck=M.CUSTOM_ELEMENT_HANDLING.tagNameCheck),M.CUSTOM_ELEMENT_HANDLING&&Sc(M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(fe.attributeNameCheck=M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),M.CUSTOM_ELEMENT_HANDLING&&typeof M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(fe.allowCustomizedBuiltInElements=M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Vt&&(Qt=!1),Le&&(We=!0),qt&&(j=$e({},qb),Ce=[],qt.html===!0&&($e(j,Qb),$e(Ce,ew)),qt.svg===!0&&($e(j,hm),$e(Ce,mm),$e(Ce,Ff)),qt.svgFilters===!0&&($e(j,pm),$e(Ce,mm),$e(Ce,Ff)),qt.mathMl===!0&&($e(j,gm),$e(Ce,tw),$e(Ce,Ff))),M.ADD_TAGS&&(j===oe&&(j=Pa(j)),$e(j,M.ADD_TAGS,Gt)),M.ADD_ATTR&&(Ce===Be&&(Ce=Pa(Ce)),$e(Ce,M.ADD_ATTR,Gt)),M.ADD_URI_SAFE_ATTR&&$e(x,M.ADD_URI_SAFE_ATTR,Gt),M.FORBID_CONTENTS&&(un===E&&(un=Pa(un)),$e(un,M.FORBID_CONTENTS,Gt)),Gn&&(j["#text"]=!0),qe&&$e(j,["html","head","body"]),j.table&&($e(j,["tbody"]),delete Pe.tbody),M.TRUSTED_TYPES_POLICY){if(typeof M.TRUSTED_TYPES_POLICY.createHTML!="function")throw du('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof M.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw du('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=M.TRUSTED_TYPES_POLICY,A=k.createHTML("")}else k===void 0&&(k=PF(h,i)),k!==null&&typeof A=="string"&&(A=k.createHTML(""));er&&er(M),Gi=M}},Yl=$e({},["mi","mo","mn","ms","mtext"]),af=$e({},["foreignobject","annotation-xml"]),cf=$e({},["title","style","font","a","script"]),Aa=$e({},[...hm,...pm,...CF]),ka=$e({},[...gm,...IF]),lf=function(M){let q=S(M);(!q||!q.tagName)&&(q={namespaceURI:Ze,tagName:"template"});const ue=mh(M.tagName),Ee=mh(q.tagName);return st[M.namespaceURI]?M.namespaceURI===Y?q.namespaceURI===_e?ue==="svg":q.namespaceURI===W?ue==="svg"&&(Ee==="annotation-xml"||Yl[Ee]):!!Aa[ue]:M.namespaceURI===W?q.namespaceURI===_e?ue==="math":q.namespaceURI===Y?ue==="math"&&af[Ee]:!!ka[ue]:M.namespaceURI===_e?q.namespaceURI===Y&&!af[Ee]||q.namespaceURI===W&&!Yl[Ee]?!1:!ka[ue]&&(cf[ue]||!Aa[ue]):!!(wa==="application/xhtml+xml"&&st[M.namespaceURI]):!1},Hr=function(M){lu(e.removed,{element:M});try{S(M).removeChild(M)}catch{C(M)}},bc=function(M,q){try{lu(e.removed,{attribute:q.getAttributeNode(M),from:q})}catch{lu(e.removed,{attribute:null,from:q})}if(q.removeAttribute(M),M==="is"&&!Ce[M])if(We||Le)try{Hr(q)}catch{}else try{q.setAttribute(M,"")}catch{}},D=function(M){let q=null,ue=null;if(Ie)M="<remove></remove>"+M;else{const He=Yb(M,/^[\r\n\t ]+/);ue=He&&He[0]}wa==="application/xhtml+xml"&&Ze===_e&&(M='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+M+"</body></html>");const Ee=k?k.createHTML(M):M;if(Ze===_e)try{q=new f().parseFromString(Ee,wa)}catch{}if(!q||!q.documentElement){q=R.createDocument(Ze,"template",null);try{q.documentElement.innerHTML=ot?A:Ee}catch{}}const Ye=q.body||q.documentElement;return M&&ue&&Ye.insertBefore(n.createTextNode(ue),Ye.childNodes[0]||null),Ze===_e?_.call(q,qe?"html":"body")[0]:qe?q.documentElement:Ye},B=function(M){return P.call(M.ownerDocument||M,M,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},Z=function(M){return M instanceof d&&(typeof M.nodeName!="string"||typeof M.textContent!="string"||typeof M.removeChild!="function"||!(M.attributes instanceof u)||typeof M.removeAttribute!="function"||typeof M.setAttribute!="function"||typeof M.namespaceURI!="string"||typeof M.insertBefore!="function"||typeof M.hasChildNodes!="function")},re=function(M){return typeof a=="function"&&M instanceof a},ge=function(M,q,ue){L[M]&&Lf(L[M],Ee=>{Ee.call(e,q,ue,Gi)})},Re=function(M){let q=null;if(ge("beforeSanitizeElements",M,null),Z(M))return Hr(M),!0;const ue=Gt(M.nodeName);if(ge("uponSanitizeElement",M,{tagName:ue,allowedTags:j}),M.hasChildNodes()&&!re(M.firstElementChild)&&Wn(/<[/\w]/g,M.innerHTML)&&Wn(/<[/\w]/g,M.textContent)||M.nodeType===hu.progressingInstruction||Pn&&M.nodeType===hu.comment&&Wn(/<[/\w]/g,M.data))return Hr(M),!0;if(!j[ue]||Pe[ue]){if(!Pe[ue]&&he(ue)&&(fe.tagNameCheck instanceof RegExp&&Wn(fe.tagNameCheck,ue)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(ue)))return!1;if(Gn&&!un[ue]){const Ee=S(M)||M.parentNode,Ye=v(M)||M.childNodes;if(Ye&&Ee){const He=Ye.length;for(let Xt=He-1;Xt>=0;--Xt){const $t=m(Ye[Xt],!0);$t.__removalCount=(M.__removalCount||0)+1,Ee.insertBefore($t,g(M))}}}return Hr(M),!0}return M instanceof c&&!lf(M)||(ue==="noscript"||ue==="noembed"||ue==="noframes")&&Wn(/<\/no(script|embed|frames)/i,M.innerHTML)?(Hr(M),!0):(Vt&&M.nodeType===hu.text&&(q=M.textContent,Lf([U,X,H],Ee=>{q=uu(q,Ee," ")}),M.textContent!==q&&(lu(e.removed,{element:M.cloneNode()}),M.textContent=q)),ge("afterSanitizeElements",M,null),!1)},De=function(M,q,ue){if(et&&(q==="id"||q==="name")&&(ue in n||ue in Ic))return!1;if(!(Qt&&!Xe[q]&&Wn(J,q))){if(!(me&&Wn(te,q))){if(!Ce[q]||Xe[q]){if(!(he(M)&&(fe.tagNameCheck instanceof RegExp&&Wn(fe.tagNameCheck,M)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(M))&&(fe.attributeNameCheck instanceof RegExp&&Wn(fe.attributeNameCheck,q)||fe.attributeNameCheck instanceof Function&&fe.attributeNameCheck(q))||q==="is"&&fe.allowCustomizedBuiltInElements&&(fe.tagNameCheck instanceof RegExp&&Wn(fe.tagNameCheck,ue)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(ue))))return!1}else if(!x[q]){if(!Wn(se,uu(ue,$,""))){if(!((q==="src"||q==="xlink:href"||q==="href")&&M!=="script"&&gF(ue,"data:")===0&&y[M])){if(!(zt&&!Wn(le,uu(ue,$,"")))){if(ue)return!1}}}}}}return!0},he=function(M){return M!=="annotation-xml"&&Yb(M,z)},xe=function(M){ge("beforeSanitizeAttributes",M,null);const{attributes:q}=M;if(!q)return;const ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ce};let Ee=q.length;for(;Ee--;){const Ye=q[Ee],{name:He,namespaceURI:Xt,value:$t}=Ye,zr=Gt(He);let Et=He==="value"?$t:mF($t);if(ue.attrName=zr,ue.attrValue=Et,ue.keepAttr=!0,ue.forceKeepAttr=void 0,ge("uponSanitizeAttribute",M,ue),Et=ue.attrValue,Pn&&Wn(/((--!?|])>)|<\/(style|title)/i,Et)){bc(He,M);continue}if(ue.forceKeepAttr||(bc(He,M),!ue.keepAttr))continue;if(!Vn&&Wn(/\/>/i,Et)){bc(He,M);continue}Vt&&Lf([U,X,H],Xr=>{Et=uu(Et,Xr," ")});const Ea=Gt(M.nodeName);if(De(Ea,zr,Et)){if(xt&&(zr==="id"||zr==="name")&&(bc(He,M),Et=Pt+Et),k&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!Xt)switch(h.getAttributeType(Ea,zr)){case"TrustedHTML":{Et=k.createHTML(Et);break}case"TrustedScriptURL":{Et=k.createScriptURL(Et);break}}try{Xt?M.setAttributeNS(Xt,He,Et):M.setAttribute(He,Et),Z(M)?Hr(M):Jb(e.removed)}catch{}}}ge("afterSanitizeAttributes",M,null)},ke=function ee(M){let q=null;const ue=B(M);for(ge("beforeSanitizeShadowDOM",M,null);q=ue.nextNode();)ge("uponSanitizeShadowNode",q,null),!Re(q)&&(q.content instanceof o&&ee(q.content),xe(q));ge("afterSanitizeShadowDOM",M,null)};return e.sanitize=function(ee){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},q=null,ue=null,Ee=null,Ye=null;if(ot=!ee,ot&&(ee="<!-->"),typeof ee!="string"&&!re(ee))if(typeof ee.toString=="function"){if(ee=ee.toString(),typeof ee!="string")throw du("dirty is not a string, aborting")}else throw du("toString is not a function");if(!e.isSupported)return ee;if(de||Jl(M),e.removed=[],typeof ee=="string"&&(Ir=!1),Ir){if(ee.nodeName){const $t=Gt(ee.nodeName);if(!j[$t]||Pe[$t])throw du("root node is forbidden and cannot be sanitized in-place")}}else if(ee instanceof a)q=D("<!---->"),ue=q.ownerDocument.importNode(ee,!0),ue.nodeType===hu.element&&ue.nodeName==="BODY"||ue.nodeName==="HTML"?q=ue:q.appendChild(ue);else{if(!We&&!Vt&&!qe&&ee.indexOf("<")===-1)return k&&Me?k.createHTML(ee):ee;if(q=D(ee),!q)return We?null:Me?A:""}q&&Ie&&Hr(q.firstChild);const He=B(Ir?ee:q);for(;Ee=He.nextNode();)Re(Ee)||(Ee.content instanceof o&&ke(Ee.content),xe(Ee));if(Ir)return ee;if(We){if(Le)for(Ye=w.call(q.ownerDocument);q.firstChild;)Ye.appendChild(q.firstChild);else Ye=q;return(Ce.shadowroot||Ce.shadowrootmode)&&(Ye=O.call(r,Ye,!0)),Ye}let Xt=qe?q.outerHTML:q.innerHTML;return qe&&j["!doctype"]&&q.ownerDocument&&q.ownerDocument.doctype&&q.ownerDocument.doctype.name&&Wn(AT,q.ownerDocument.doctype.name)&&(Xt="<!DOCTYPE "+q.ownerDocument.doctype.name+`>
`+Xt),Vt&&Lf([U,X,H],$t=>{Xt=uu(Xt,$t," ")}),k&&Me?k.createHTML(Xt):Xt},e.setConfig=function(){let ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jl(ee),de=!0},e.clearConfig=function(){Gi=null,de=!1},e.isValidAttribute=function(ee,M,q){Gi||Jl({});const ue=Gt(ee),Ee=Gt(M);return De(ue,Ee,q)},e.addHook=function(ee,M){typeof M=="function"&&(L[ee]=L[ee]||[],lu(L[ee],M))},e.removeHook=function(ee){if(L[ee])return Jb(L[ee])},e.removeHooks=function(ee){L[ee]&&(L[ee]=[])},e.removeAllHooks=function(){L={}},e}var NF=kT();const Da=class Da extends ct.Component{constructor(n){super(n);V(this,"outputRef",ct.createRef());V(this,"messageKey",0);V(this,"saveOutput",()=>{const n=this.state.output.map(r=>da.renderToStaticMarkup(r));localStorage.setItem(Da.LOCAL_STORAGE_KEY,JSON.stringify(n))});V(this,"loadOutput",()=>{const n=localStorage.getItem(Da.LOCAL_STORAGE_KEY);return n?JSON.parse(n).map(i=>ct.createElement("div",{dangerouslySetInnerHTML:{__html:i}})):[]});V(this,"addCommand",n=>{this.addToOutput([K.jsx("span",{className:"command","aria-live":"off",children:n})],!1)});V(this,"addError",n=>this.addToOutput([K.jsxs("h2",{children:[" Error: ",n.message]})]));V(this,"handleConnected",()=>this.addToOutput([K.jsx("h2",{children:" Connected"})]));V(this,"handleDisconnected",()=>{this.addToOutput([K.jsx("h2",{children:" Disconnected"})]),this.setState({sidebarVisible:!1})});V(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));V(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});V(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;return n?n.scrollHeight-n.scrollTop<=n.clientHeight+1:!1});V(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});V(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});V(this,"handleMessage",n=>{if(!n)return;const r=QD(n,this.handleExitClick);this.addToOutput(r)});V(this,"handleHtml",n=>{const r=NF.sanitize(n),i=K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i])});V(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0}}getSnapshotBeforeUpdate(n,r){if(this.outputRef.current){const i=this.outputRef.current;return i.scrollHeight-i.scrollTop<=i.clientHeight}return null}componentDidUpdate(n,r,i){i&&this.scrollToBottom(),this.state.output.length>r.output.length&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState({newLinesCount:this.state.newLinesCount+(this.state.output.length-r.output.length)})),this.saveOutput()}componentDidMount(){const{client:n}=this.props;n.on("message",this.handleMessage),n.on("html",this.handleHtml),n.on("connect",this.handleConnected),n.on("disconnect",this.handleDisconnected),n.on("error",this.addError),n.on("command",this.addCommand),n.on("userlist",this.handleUserList)}componentWillUnmount(){const{client:n}=this.props;n.removeListener("message",this.handleMessage),n.removeListener("html",this.handleHtml),n.removeListener("connect",this.handleConnected),n.removeListener("disconnect",this.handleDisconnected),n.removeListener("error",this.addError),n.removeListener("command",this.addCommand),n.removeListener("userlist",this.handleUserList)}sanitizeHtml(n){return new DOMParser().parseFromString(n,"text/html").body.textContent||""}addToOutput(n,r=!0){r&&n.forEach(i=>{if(ct.isValidElement(i)){const o=da.renderToString(i),s=this.sanitizeHtml(o);tb(s)}else typeof i=="string"&&tb(i)}),this.setState(i=>{const o=n.map((c,l)=>K.jsx("div",{children:c},this.messageKey+l));return this.messageKey+=n.length,{output:[...i.output,...o].slice(-Da.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a"),a=new Date,c=a.toLocaleDateString(),l=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${c}-${l}.html`;s.download=d,s.href=o,s.click(),URL.revokeObjectURL(o),s.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return K.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,children:[this.state.output,this.state.newLinesCount>0&&K.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};V(Da,"MAX_OUTPUT_LENGTH",5e3),V(Da,"LOCAL_STORAGE_KEY","outputLog");let Qv=Da;var ET={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||c,f),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,f,h,p){var m=n?n+l:l;if(!this._events[m])return!1;var C=this._events[m],g=arguments.length,v,S;if(C.fn){switch(C.once&&this.removeListener(l,C.fn,void 0,!0),g){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,u),!0;case 3:return C.fn.call(C.context,u,d),!0;case 4:return C.fn.call(C.context,u,d,f),!0;case 5:return C.fn.call(C.context,u,d,f,h),!0;case 6:return C.fn.call(C.context,u,d,f,h,p),!0}for(S=1,v=new Array(g-1);S<g;S++)v[S-1]=arguments[S];C.fn.apply(C.context,v)}else{var k=C.length,A;for(S=0;S<k;S++)switch(C[S].once&&this.removeListener(l,C[S].fn,void 0,!0),g){case 1:C[S].fn.call(C[S].context);break;case 2:C[S].fn.call(C[S].context,u);break;case 3:C[S].fn.call(C[S].context,u,d);break;case 4:C[S].fn.call(C[S].context,u,d,f);break;default:if(!v)for(A=1,v=new Array(g-1);A<g;A++)v[A-1]=arguments[A];C[S].fn.apply(C[S].context,v)}}return!0},a.prototype.on=function(l,u,d){return o(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return o(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,f){var h=n?n+l:l;if(!this._events[h])return this;if(!u)return s(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&s(this,h);else{for(var m=0,C=[],g=p.length;m<g;m++)(p[m].fn!==u||f&&!p[m].once||d&&p[m].context!==d)&&C.push(p[m]);C.length?this._events[h]=C.length===1?C[0]:C:s(this,h)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(ET);var _F=ET.exports;const TT=Ud(_F);var mn={},ag={};ag.byteLength=DF;ag.toByteArray=FF;ag.fromByteArray=VF;var Ki=[],$r=[],OF=typeof Uint8Array<"u"?Uint8Array:Array,vm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var kc=0,MF=vm.length;kc<MF;++kc)Ki[kc]=vm[kc],$r[vm.charCodeAt(kc)]=kc;$r[45]=62;$r[95]=63;function RT(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function DF(t){var e=RT(t),n=e[0],r=e[1];return(n+r)*3/4-r}function LF(t,e,n){return(e+n)*3/4-n}function FF(t){var e,n=RT(t),r=n[0],i=n[1],o=new OF(LF(t,r,i)),s=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=$r[t.charCodeAt(c)]<<18|$r[t.charCodeAt(c+1)]<<12|$r[t.charCodeAt(c+2)]<<6|$r[t.charCodeAt(c+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=$r[t.charCodeAt(c)]<<2|$r[t.charCodeAt(c+1)]>>4,o[s++]=e&255),i===1&&(e=$r[t.charCodeAt(c)]<<10|$r[t.charCodeAt(c+1)]<<4|$r[t.charCodeAt(c+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function BF(t){return Ki[t>>18&63]+Ki[t>>12&63]+Ki[t>>6&63]+Ki[t&63]}function UF(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(BF(r));return i.join("")}function VF(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(UF(t,s,s+o>a?a:s+o));return r===1?(e=t[n-1],i.push(Ki[e>>2]+Ki[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(Ki[e>>10]+Ki[e>>4&63]+Ki[e<<2&63]+"=")),i.join("")}var EC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */EC.read=function(t,e,n,r,i){var o,s,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,o=h&(1<<-u)-1,h>>=-u,u+=a;u>0;o=o*256+t[e+d],d+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+t[e+d],d+=f,u-=8);if(o===0)o=1-l;else{if(o===c)return s?NaN:(h?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-l}return(h?-1:1)*s*Math.pow(2,o-r)};EC.write=function(t,e,n,r,i,o){var s,a,c,l=o*8-i-1,u=(1<<l)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?e+=f/c:e+=f*Math.pow(2,1-d),e*c>=2&&(s++,c/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(e*c-1)*Math.pow(2,i),s=s+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[n+h]=s&255,h+=p,s/=256,l-=8);t[n+h-p]|=m*128};(function(t){const e=ag,n=EC,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const E=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(E,y),E.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(E){if(E>i)throw new RangeError('The value "'+E+'" is invalid for option "size"');const y=new Uint8Array(E);return Object.setPrototypeOf(y,a.prototype),y}function a(E,y,I){if(typeof E=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(E)}return c(E,y,I)}a.poolSize=8192;function c(E,y,I){if(typeof E=="string")return f(E,y);if(ArrayBuffer.isView(E))return p(E);if(E==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E);if(Pt(E,ArrayBuffer)||E&&Pt(E.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Pt(E,SharedArrayBuffer)||E&&Pt(E.buffer,SharedArrayBuffer)))return m(E,y,I);if(typeof E=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const x=E.valueOf&&E.valueOf();if(x!=null&&x!==E)return a.from(x,y,I);const F=C(E);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof E[Symbol.toPrimitive]=="function")return a.from(E[Symbol.toPrimitive]("string"),y,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E)}a.from=function(E,y,I){return c(E,y,I)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(E){if(typeof E!="number")throw new TypeError('"size" argument must be of type number');if(E<0)throw new RangeError('The value "'+E+'" is invalid for option "size"')}function u(E,y,I){return l(E),E<=0?s(E):y!==void 0?typeof I=="string"?s(E).fill(y,I):s(E).fill(y):s(E)}a.alloc=function(E,y,I){return u(E,y,I)};function d(E){return l(E),s(E<0?0:g(E)|0)}a.allocUnsafe=function(E){return d(E)},a.allocUnsafeSlow=function(E){return d(E)};function f(E,y){if((typeof y!="string"||y==="")&&(y="utf8"),!a.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const I=S(E,y)|0;let x=s(I);const F=x.write(E,y);return F!==I&&(x=x.slice(0,F)),x}function h(E){const y=E.length<0?0:g(E.length)|0,I=s(y);for(let x=0;x<y;x+=1)I[x]=E[x]&255;return I}function p(E){if(Pt(E,Uint8Array)){const y=new Uint8Array(E);return m(y.buffer,y.byteOffset,y.byteLength)}return h(E)}function m(E,y,I){if(y<0||E.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(E.byteLength<y+(I||0))throw new RangeError('"length" is outside of buffer bounds');let x;return y===void 0&&I===void 0?x=new Uint8Array(E):I===void 0?x=new Uint8Array(E,y):x=new Uint8Array(E,y,I),Object.setPrototypeOf(x,a.prototype),x}function C(E){if(a.isBuffer(E)){const y=g(E.length)|0,I=s(y);return I.length===0||E.copy(I,0,0,y),I}if(E.length!==void 0)return typeof E.length!="number"||Gn(E.length)?s(0):h(E);if(E.type==="Buffer"&&Array.isArray(E.data))return h(E.data)}function g(E){if(E>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return E|0}function v(E){return+E!=E&&(E=0),a.alloc(+E)}a.isBuffer=function(y){return y!=null&&y._isBuffer===!0&&y!==a.prototype},a.compare=function(y,I){if(Pt(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),Pt(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(y)||!a.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(y===I)return 0;let x=y.length,F=I.length;for(let W=0,Y=Math.min(x,F);W<Y;++W)if(y[W]!==I[W]){x=y[W],F=I[W];break}return x<F?-1:F<x?1:0},a.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(y,I){if(!Array.isArray(y))throw new TypeError('"list" argument must be an Array of Buffers');if(y.length===0)return a.alloc(0);let x;if(I===void 0)for(I=0,x=0;x<y.length;++x)I+=y[x].length;const F=a.allocUnsafe(I);let W=0;for(x=0;x<y.length;++x){let Y=y[x];if(Pt(Y,Uint8Array))W+Y.length>F.length?(a.isBuffer(Y)||(Y=a.from(Y)),Y.copy(F,W)):Uint8Array.prototype.set.call(F,Y,W);else if(a.isBuffer(Y))Y.copy(F,W);else throw new TypeError('"list" argument must be an Array of Buffers');W+=Y.length}return F};function S(E,y){if(a.isBuffer(E))return E.length;if(ArrayBuffer.isView(E)||Pt(E,ArrayBuffer))return E.byteLength;if(typeof E!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof E);const I=E.length,x=arguments.length>2&&arguments[2]===!0;if(!x&&I===0)return 0;let F=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return We(E).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return et(E).length;default:if(F)return x?-1:We(E).length;y=(""+y).toLowerCase(),F=!0}}a.byteLength=S;function k(E,y,I){let x=!1;if((y===void 0||y<0)&&(y=0),y>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,y>>>=0,I<=y))return"";for(E||(E="utf8");;)switch(E){case"hex":return z(this,y,I);case"utf8":case"utf-8":return H(this,y,I);case"ascii":return le(this,y,I);case"latin1":case"binary":return $(this,y,I);case"base64":return X(this,y,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,y,I);default:if(x)throw new TypeError("Unknown encoding: "+E);E=(E+"").toLowerCase(),x=!0}}a.prototype._isBuffer=!0;function A(E,y,I){const x=E[y];E[y]=E[I],E[I]=x}a.prototype.swap16=function(){const y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<y;I+=2)A(this,I,I+1);return this},a.prototype.swap32=function(){const y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<y;I+=4)A(this,I,I+3),A(this,I+1,I+2);return this},a.prototype.swap64=function(){const y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<y;I+=8)A(this,I,I+7),A(this,I+1,I+6),A(this,I+2,I+5),A(this,I+3,I+4);return this},a.prototype.toString=function(){const y=this.length;return y===0?"":arguments.length===0?H(this,0,y):k.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(y){if(!a.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:a.compare(this,y)===0},a.prototype.inspect=function(){let y="";const I=t.INSPECT_MAX_BYTES;return y=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(y+=" ... "),"<Buffer "+y+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(y,I,x,F,W){if(Pt(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),!a.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof y);if(I===void 0&&(I=0),x===void 0&&(x=y?y.length:0),F===void 0&&(F=0),W===void 0&&(W=this.length),I<0||x>y.length||F<0||W>this.length)throw new RangeError("out of range index");if(F>=W&&I>=x)return 0;if(F>=W)return-1;if(I>=x)return 1;if(I>>>=0,x>>>=0,F>>>=0,W>>>=0,this===y)return 0;let Y=W-F,_e=x-I;const Ze=Math.min(Y,_e),ot=this.slice(F,W),st=y.slice(I,x);for(let rt=0;rt<Ze;++rt)if(ot[rt]!==st[rt]){Y=ot[rt],_e=st[rt];break}return Y<_e?-1:_e<Y?1:0};function R(E,y,I,x,F){if(E.length===0)return-1;if(typeof I=="string"?(x=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,Gn(I)&&(I=F?0:E.length-1),I<0&&(I=E.length+I),I>=E.length){if(F)return-1;I=E.length-1}else if(I<0)if(F)I=0;else return-1;if(typeof y=="string"&&(y=a.from(y,x)),a.isBuffer(y))return y.length===0?-1:P(E,y,I,x,F);if(typeof y=="number")return y=y&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(E,y,I):Uint8Array.prototype.lastIndexOf.call(E,y,I):P(E,[y],I,x,F);throw new TypeError("val must be string, number or Buffer")}function P(E,y,I,x,F){let W=1,Y=E.length,_e=y.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(E.length<2||y.length<2)return-1;W=2,Y/=2,_e/=2,I/=2}function Ze(st,rt){return W===1?st[rt]:st.readUInt16BE(rt*W)}let ot;if(F){let st=-1;for(ot=I;ot<Y;ot++)if(Ze(E,ot)===Ze(y,st===-1?0:ot-st)){if(st===-1&&(st=ot),ot-st+1===_e)return st*W}else st!==-1&&(ot-=ot-st),st=-1}else for(I+_e>Y&&(I=Y-_e),ot=I;ot>=0;ot--){let st=!0;for(let rt=0;rt<_e;rt++)if(Ze(E,ot+rt)!==Ze(y,rt)){st=!1;break}if(st)return ot}return-1}a.prototype.includes=function(y,I,x){return this.indexOf(y,I,x)!==-1},a.prototype.indexOf=function(y,I,x){return R(this,y,I,x,!0)},a.prototype.lastIndexOf=function(y,I,x){return R(this,y,I,x,!1)};function w(E,y,I,x){I=Number(I)||0;const F=E.length-I;x?(x=Number(x),x>F&&(x=F)):x=F;const W=y.length;x>W/2&&(x=W/2);let Y;for(Y=0;Y<x;++Y){const _e=parseInt(y.substr(Y*2,2),16);if(Gn(_e))return Y;E[I+Y]=_e}return Y}function _(E,y,I,x){return xt(We(y,E.length-I),E,I,x)}function O(E,y,I,x){return xt(Le(y),E,I,x)}function L(E,y,I,x){return xt(et(y),E,I,x)}function U(E,y,I,x){return xt(Me(y,E.length-I),E,I,x)}a.prototype.write=function(y,I,x,F){if(I===void 0)F="utf8",x=this.length,I=0;else if(x===void 0&&typeof I=="string")F=I,x=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(x)?(x=x>>>0,F===void 0&&(F="utf8")):(F=x,x=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const W=this.length-I;if((x===void 0||x>W)&&(x=W),y.length>0&&(x<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");let Y=!1;for(;;)switch(F){case"hex":return w(this,y,I,x);case"utf8":case"utf-8":return _(this,y,I,x);case"ascii":case"latin1":case"binary":return O(this,y,I,x);case"base64":return L(this,y,I,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,y,I,x);default:if(Y)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),Y=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(E,y,I){return y===0&&I===E.length?e.fromByteArray(E):e.fromByteArray(E.slice(y,I))}function H(E,y,I){I=Math.min(E.length,I);const x=[];let F=y;for(;F<I;){const W=E[F];let Y=null,_e=W>239?4:W>223?3:W>191?2:1;if(F+_e<=I){let Ze,ot,st,rt;switch(_e){case 1:W<128&&(Y=W);break;case 2:Ze=E[F+1],(Ze&192)===128&&(rt=(W&31)<<6|Ze&63,rt>127&&(Y=rt));break;case 3:Ze=E[F+1],ot=E[F+2],(Ze&192)===128&&(ot&192)===128&&(rt=(W&15)<<12|(Ze&63)<<6|ot&63,rt>2047&&(rt<55296||rt>57343)&&(Y=rt));break;case 4:Ze=E[F+1],ot=E[F+2],st=E[F+3],(Ze&192)===128&&(ot&192)===128&&(st&192)===128&&(rt=(W&15)<<18|(Ze&63)<<12|(ot&63)<<6|st&63,rt>65535&&rt<1114112&&(Y=rt))}}Y===null?(Y=65533,_e=1):Y>65535&&(Y-=65536,x.push(Y>>>10&1023|55296),Y=56320|Y&1023),x.push(Y),F+=_e}return te(x)}const J=4096;function te(E){const y=E.length;if(y<=J)return String.fromCharCode.apply(String,E);let I="",x=0;for(;x<y;)I+=String.fromCharCode.apply(String,E.slice(x,x+=J));return I}function le(E,y,I){let x="";I=Math.min(E.length,I);for(let F=y;F<I;++F)x+=String.fromCharCode(E[F]&127);return x}function $(E,y,I){let x="";I=Math.min(E.length,I);for(let F=y;F<I;++F)x+=String.fromCharCode(E[F]);return x}function z(E,y,I){const x=E.length;(!y||y<0)&&(y=0),(!I||I<0||I>x)&&(I=x);let F="";for(let W=y;W<I;++W)F+=Ir[E[W]];return F}function se(E,y,I){const x=E.slice(y,I);let F="";for(let W=0;W<x.length-1;W+=2)F+=String.fromCharCode(x[W]+x[W+1]*256);return F}a.prototype.slice=function(y,I){const x=this.length;y=~~y,I=I===void 0?x:~~I,y<0?(y+=x,y<0&&(y=0)):y>x&&(y=x),I<0?(I+=x,I<0&&(I=0)):I>x&&(I=x),I<y&&(I=y);const F=this.subarray(y,I);return Object.setPrototypeOf(F,a.prototype),F};function j(E,y,I){if(E%1!==0||E<0)throw new RangeError("offset is not uint");if(E+y>I)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(y,I,x){y=y>>>0,I=I>>>0,x||j(y,I,this.length);let F=this[y],W=1,Y=0;for(;++Y<I&&(W*=256);)F+=this[y+Y]*W;return F},a.prototype.readUintBE=a.prototype.readUIntBE=function(y,I,x){y=y>>>0,I=I>>>0,x||j(y,I,this.length);let F=this[y+--I],W=1;for(;I>0&&(W*=256);)F+=this[y+--I]*W;return F},a.prototype.readUint8=a.prototype.readUInt8=function(y,I){return y=y>>>0,I||j(y,1,this.length),this[y]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(y,I){return y=y>>>0,I||j(y,2,this.length),this[y]|this[y+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(y,I){return y=y>>>0,I||j(y,2,this.length),this[y]<<8|this[y+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(y,I){return y=y>>>0,I||j(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(y,I){return y=y>>>0,I||j(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},a.prototype.readBigUInt64LE=qt(function(y){y=y>>>0,Pn(y,"offset");const I=this[y],x=this[y+7];(I===void 0||x===void 0)&&qe(y,this.length-8);const F=I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24,W=this[++y]+this[++y]*2**8+this[++y]*2**16+x*2**24;return BigInt(F)+(BigInt(W)<<BigInt(32))}),a.prototype.readBigUInt64BE=qt(function(y){y=y>>>0,Pn(y,"offset");const I=this[y],x=this[y+7];(I===void 0||x===void 0)&&qe(y,this.length-8);const F=I*2**24+this[++y]*2**16+this[++y]*2**8+this[++y],W=this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+x;return(BigInt(F)<<BigInt(32))+BigInt(W)}),a.prototype.readIntLE=function(y,I,x){y=y>>>0,I=I>>>0,x||j(y,I,this.length);let F=this[y],W=1,Y=0;for(;++Y<I&&(W*=256);)F+=this[y+Y]*W;return W*=128,F>=W&&(F-=Math.pow(2,8*I)),F},a.prototype.readIntBE=function(y,I,x){y=y>>>0,I=I>>>0,x||j(y,I,this.length);let F=I,W=1,Y=this[y+--F];for(;F>0&&(W*=256);)Y+=this[y+--F]*W;return W*=128,Y>=W&&(Y-=Math.pow(2,8*I)),Y},a.prototype.readInt8=function(y,I){return y=y>>>0,I||j(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},a.prototype.readInt16LE=function(y,I){y=y>>>0,I||j(y,2,this.length);const x=this[y]|this[y+1]<<8;return x&32768?x|4294901760:x},a.prototype.readInt16BE=function(y,I){y=y>>>0,I||j(y,2,this.length);const x=this[y+1]|this[y]<<8;return x&32768?x|4294901760:x},a.prototype.readInt32LE=function(y,I){return y=y>>>0,I||j(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},a.prototype.readInt32BE=function(y,I){return y=y>>>0,I||j(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},a.prototype.readBigInt64LE=qt(function(y){y=y>>>0,Pn(y,"offset");const I=this[y],x=this[y+7];(I===void 0||x===void 0)&&qe(y,this.length-8);const F=this[y+4]+this[y+5]*2**8+this[y+6]*2**16+(x<<24);return(BigInt(F)<<BigInt(32))+BigInt(I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24)}),a.prototype.readBigInt64BE=qt(function(y){y=y>>>0,Pn(y,"offset");const I=this[y],x=this[y+7];(I===void 0||x===void 0)&&qe(y,this.length-8);const F=(I<<24)+this[++y]*2**16+this[++y]*2**8+this[++y];return(BigInt(F)<<BigInt(32))+BigInt(this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+x)}),a.prototype.readFloatLE=function(y,I){return y=y>>>0,I||j(y,4,this.length),n.read(this,y,!0,23,4)},a.prototype.readFloatBE=function(y,I){return y=y>>>0,I||j(y,4,this.length),n.read(this,y,!1,23,4)},a.prototype.readDoubleLE=function(y,I){return y=y>>>0,I||j(y,8,this.length),n.read(this,y,!0,52,8)},a.prototype.readDoubleBE=function(y,I){return y=y>>>0,I||j(y,8,this.length),n.read(this,y,!1,52,8)};function oe(E,y,I,x,F,W){if(!a.isBuffer(E))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>F||y<W)throw new RangeError('"value" argument is out of bounds');if(I+x>E.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(y,I,x,F){if(y=+y,I=I>>>0,x=x>>>0,!F){const _e=Math.pow(2,8*x)-1;oe(this,y,I,x,_e,0)}let W=1,Y=0;for(this[I]=y&255;++Y<x&&(W*=256);)this[I+Y]=y/W&255;return I+x},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(y,I,x,F){if(y=+y,I=I>>>0,x=x>>>0,!F){const _e=Math.pow(2,8*x)-1;oe(this,y,I,x,_e,0)}let W=x-1,Y=1;for(this[I+W]=y&255;--W>=0&&(Y*=256);)this[I+W]=y/Y&255;return I+x},a.prototype.writeUint8=a.prototype.writeUInt8=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,1,255,0),this[I]=y&255,I+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,2,65535,0),this[I]=y&255,this[I+1]=y>>>8,I+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,2,65535,0),this[I]=y>>>8,this[I+1]=y&255,I+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,4,4294967295,0),this[I+3]=y>>>24,this[I+2]=y>>>16,this[I+1]=y>>>8,this[I]=y&255,I+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,4,4294967295,0),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4};function Ce(E,y,I,x,F){Vt(y,x,F,E,I,7);let W=Number(y&BigInt(4294967295));E[I++]=W,W=W>>8,E[I++]=W,W=W>>8,E[I++]=W,W=W>>8,E[I++]=W;let Y=Number(y>>BigInt(32)&BigInt(4294967295));return E[I++]=Y,Y=Y>>8,E[I++]=Y,Y=Y>>8,E[I++]=Y,Y=Y>>8,E[I++]=Y,I}function Be(E,y,I,x,F){Vt(y,x,F,E,I,7);let W=Number(y&BigInt(4294967295));E[I+7]=W,W=W>>8,E[I+6]=W,W=W>>8,E[I+5]=W,W=W>>8,E[I+4]=W;let Y=Number(y>>BigInt(32)&BigInt(4294967295));return E[I+3]=Y,Y=Y>>8,E[I+2]=Y,Y=Y>>8,E[I+1]=Y,Y=Y>>8,E[I]=Y,I+8}a.prototype.writeBigUInt64LE=qt(function(y,I=0){return Ce(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=qt(function(y,I=0){return Be(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(y,I,x,F){if(y=+y,I=I>>>0,!F){const Ze=Math.pow(2,8*x-1);oe(this,y,I,x,Ze-1,-Ze)}let W=0,Y=1,_e=0;for(this[I]=y&255;++W<x&&(Y*=256);)y<0&&_e===0&&this[I+W-1]!==0&&(_e=1),this[I+W]=(y/Y>>0)-_e&255;return I+x},a.prototype.writeIntBE=function(y,I,x,F){if(y=+y,I=I>>>0,!F){const Ze=Math.pow(2,8*x-1);oe(this,y,I,x,Ze-1,-Ze)}let W=x-1,Y=1,_e=0;for(this[I+W]=y&255;--W>=0&&(Y*=256);)y<0&&_e===0&&this[I+W+1]!==0&&(_e=1),this[I+W]=(y/Y>>0)-_e&255;return I+x},a.prototype.writeInt8=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,1,127,-128),y<0&&(y=255+y+1),this[I]=y&255,I+1},a.prototype.writeInt16LE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,2,32767,-32768),this[I]=y&255,this[I+1]=y>>>8,I+2},a.prototype.writeInt16BE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,2,32767,-32768),this[I]=y>>>8,this[I+1]=y&255,I+2},a.prototype.writeInt32LE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,4,2147483647,-2147483648),this[I]=y&255,this[I+1]=y>>>8,this[I+2]=y>>>16,this[I+3]=y>>>24,I+4},a.prototype.writeInt32BE=function(y,I,x){return y=+y,I=I>>>0,x||oe(this,y,I,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4},a.prototype.writeBigInt64LE=qt(function(y,I=0){return Ce(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=qt(function(y,I=0){return Be(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function fe(E,y,I,x,F,W){if(I+x>E.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function Pe(E,y,I,x,F){return y=+y,I=I>>>0,F||fe(E,y,I,4),n.write(E,y,I,x,23,4),I+4}a.prototype.writeFloatLE=function(y,I,x){return Pe(this,y,I,!0,x)},a.prototype.writeFloatBE=function(y,I,x){return Pe(this,y,I,!1,x)};function Xe(E,y,I,x,F){return y=+y,I=I>>>0,F||fe(E,y,I,8),n.write(E,y,I,x,52,8),I+8}a.prototype.writeDoubleLE=function(y,I,x){return Xe(this,y,I,!0,x)},a.prototype.writeDoubleBE=function(y,I,x){return Xe(this,y,I,!1,x)},a.prototype.copy=function(y,I,x,F){if(!a.isBuffer(y))throw new TypeError("argument should be a Buffer");if(x||(x=0),!F&&F!==0&&(F=this.length),I>=y.length&&(I=y.length),I||(I=0),F>0&&F<x&&(F=x),F===x||y.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(x<0||x>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),y.length-I<F-x&&(F=y.length-I+x);const W=F-x;return this===y&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,x,F):Uint8Array.prototype.set.call(y,this.subarray(x,F),I),W},a.prototype.fill=function(y,I,x,F){if(typeof y=="string"){if(typeof I=="string"?(F=I,I=0,x=this.length):typeof x=="string"&&(F=x,x=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!a.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(y.length===1){const Y=y.charCodeAt(0);(F==="utf8"&&Y<128||F==="latin1")&&(y=Y)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(I<0||this.length<I||this.length<x)throw new RangeError("Out of range index");if(x<=I)return this;I=I>>>0,x=x===void 0?this.length:x>>>0,y||(y=0);let W;if(typeof y=="number")for(W=I;W<x;++W)this[W]=y;else{const Y=a.isBuffer(y)?y:a.from(y,F),_e=Y.length;if(_e===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for(W=0;W<x-I;++W)this[W+I]=Y[W%_e]}return this};const me={};function Qt(E,y,I){me[E]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${E}]`,this.stack,delete this.name}get code(){return E}set code(F){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:F,writable:!0})}toString(){return`${this.name} [${E}]: ${this.message}`}}}Qt("ERR_BUFFER_OUT_OF_BOUNDS",function(E){return E?`${E} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Qt("ERR_INVALID_ARG_TYPE",function(E,y){return`The "${E}" argument must be of type number. Received type ${typeof y}`},TypeError),Qt("ERR_OUT_OF_RANGE",function(E,y,I){let x=`The value of "${E}" is out of range.`,F=I;return Number.isInteger(I)&&Math.abs(I)>2**32?F=zt(String(I)):typeof I=="bigint"&&(F=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(F=zt(F)),F+="n"),x+=` It must be ${y}. Received ${F}`,x},RangeError);function zt(E){let y="",I=E.length;const x=E[0]==="-"?1:0;for(;I>=x+4;I-=3)y=`_${E.slice(I-3,I)}${y}`;return`${E.slice(0,I)}${y}`}function Vn(E,y,I){Pn(y,"offset"),(E[y]===void 0||E[y+I]===void 0)&&qe(y,E.length-(I+1))}function Vt(E,y,I,x,F,W){if(E>I||E<y){const Y=typeof y=="bigint"?"n":"";let _e;throw y===0||y===BigInt(0)?_e=`>= 0${Y} and < 2${Y} ** ${(W+1)*8}${Y}`:_e=`>= -(2${Y} ** ${(W+1)*8-1}${Y}) and < 2 ** ${(W+1)*8-1}${Y}`,new me.ERR_OUT_OF_RANGE("value",_e,E)}Vn(x,F,W)}function Pn(E,y){if(typeof E!="number")throw new me.ERR_INVALID_ARG_TYPE(y,"number",E)}function qe(E,y,I){throw Math.floor(E)!==E?(Pn(E,I),new me.ERR_OUT_OF_RANGE("offset","an integer",E)):y<0?new me.ERR_BUFFER_OUT_OF_BOUNDS:new me.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${y}`,E)}const de=/[^+/0-9A-Za-z-_]/g;function Ie(E){if(E=E.split("=")[0],E=E.trim().replace(de,""),E.length<2)return"";for(;E.length%4!==0;)E=E+"=";return E}function We(E,y){y=y||1/0;let I;const x=E.length;let F=null;const W=[];for(let Y=0;Y<x;++Y){if(I=E.charCodeAt(Y),I>55295&&I<57344){if(!F){if(I>56319){(y-=3)>-1&&W.push(239,191,189);continue}else if(Y+1===x){(y-=3)>-1&&W.push(239,191,189);continue}F=I;continue}if(I<56320){(y-=3)>-1&&W.push(239,191,189),F=I;continue}I=(F-55296<<10|I-56320)+65536}else F&&(y-=3)>-1&&W.push(239,191,189);if(F=null,I<128){if((y-=1)<0)break;W.push(I)}else if(I<2048){if((y-=2)<0)break;W.push(I>>6|192,I&63|128)}else if(I<65536){if((y-=3)<0)break;W.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((y-=4)<0)break;W.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return W}function Le(E){const y=[];for(let I=0;I<E.length;++I)y.push(E.charCodeAt(I)&255);return y}function Me(E,y){let I,x,F;const W=[];for(let Y=0;Y<E.length&&!((y-=2)<0);++Y)I=E.charCodeAt(Y),x=I>>8,F=I%256,W.push(F),W.push(x);return W}function et(E){return e.toByteArray(Ie(E))}function xt(E,y,I,x){let F;for(F=0;F<x&&!(F+I>=y.length||F>=E.length);++F)y[F+I]=E[F];return F}function Pt(E,y){return E instanceof y||E!=null&&E.constructor!=null&&E.constructor.name!=null&&E.constructor.name===y.name}function Gn(E){return E!==E}const Ir=function(){const E="0123456789abcdef",y=new Array(256);for(let I=0;I<16;++I){const x=I*16;for(let F=0;F<16;++F)y[x+F]=E[I]+E[F]}return y}();function qt(E){return typeof BigInt>"u"?un:E}function un(){throw new Error("BigInt not supported")}})(mn);var Pu=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(Pu||{}),Nu=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(Nu||{});class GF{constructor(e){V(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class WF extends TT{constructor(n){super();V(this,"state");V(this,"buffer");V(this,"subBuffer");V(this,"iacSEBuffer",mn.Buffer.from([255,240]));V(this,"negotiationByte",0);V(this,"stream");this.state=0,this.buffer=mn.Buffer.alloc(0),this.subBuffer=mn.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=mn.Buffer.concat([this.buffer,mn.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=mn.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=mn.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(n,r){this.stream.write(mn.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,o=mn.Buffer.from(i),s=mn.Buffer.concat([mn.Buffer.from([255,250]),mn.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(s)}sendTerminalType(n){const r=mn.Buffer.from(n),i=mn.Buffer.concat([mn.Buffer.from([255,250]),mn.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function jF({onlyFirst:t=!1}={}){const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(n,t?void 0:"g")}const ZF=jF();function HF(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(ZF,"")}class Co{constructor(e){V(this,"packageName");V(this,"packageVersion",1);V(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class zF extends Co{constructor(){super(...arguments);V(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class XF extends Co{constructor(){super(...arguments);V(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class $F extends Co{constructor(n){super(n);V(this,"packageName","Client.Keystrokes");V(this,"bindings",[]);V(this,"boundKeyUpHandler");document.addEventListener("keydown",r=>this.handleKeydown(r))}handleKeydown(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=this.client.getInput(),o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",n=>this.handleKeydown(n))}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"Alt",n.ctrlKey&&"Control",n.shiftKey&&"Shift",n.metaKey&&"Meta"].filter(Boolean));return r.modifiers&&r.modifiers.every(o=>i.has(o))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(o,s)=>{if(s==="*")return r;const a=parseInt(s,10)-1;return a>=0&&a<i.length?i[a]:o})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>!(r.key===n.key&&r.modifiers.length===n.modifiers.length&&r.modifiers.every(i=>n.modifiers.includes(i))))}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}listBindings(){return[...this.bindings]}}const rw=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),iw=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),qv=(t,e)=>({startTime:e,type:"setValue",value:t}),xT=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),PT=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),Zc=t=>t.type==="exponentialRampToValue",pp=t=>t.type==="linearRampToValue",Bs=t=>Zc(t)||pp(t),TC=t=>t.type==="setValue",Ro=t=>t.type==="setValueCurve",gp=(t,e,n,r)=>{const i=t[e];return i===void 0?r:Bs(i)||TC(i)?i.value:Ro(i)?i.values[i.values.length-1]:PT(n,gp(t,e-1,i.startTime,r),i)},ow=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:Bs(n)?[n.endTime,n.value]:TC(n)?[n.startTime,n.value]:Ro(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,gp(t,e-1,n.startTime,i)],e0=t=>t.type==="cancelAndHold",t0=t=>t.type==="cancelScheduledValues",Ts=t=>e0(t)||t0(t)?t.cancelTime:Zc(t)||pp(t)?t.endTime:t.startTime,sw=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,aw=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),KF=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},JF=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return KF(r,i)},Bf=t=>t.type==="setTarget";class YF{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Ts(e);if(e0(e)||t0(e)){const r=this._automationEvents.findIndex(o=>t0(e)&&Ro(o)?o.startTime+o.duration>=n:Ts(o)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),e0(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Bs(i)){if(o!==void 0&&Bf(o))throw new Error("The internal list is malformed.");const s=o===void 0?i.insertTime:Ro(o)?o.startTime+o.duration:Ts(o),a=o===void 0?this._defaultValue:Ro(o)?o.values[o.values.length-1]:o.value,c=Zc(i)?sw(n,s,a,i):aw(n,s,a,i),l=Zc(i)?rw(c,n,this._currenTime):iw(c,n,this._currenTime);this._automationEvents.push(l)}if(o!==void 0&&Bf(o)&&this._automationEvents.push(qv(this.getValue(n),n)),o!==void 0&&Ro(o)&&o.startTime+o.duration>n){const s=n-o.startTime,a=(o.values.length-1)/o.duration,c=Math.max(2,1+Math.ceil(s*a)),l=s/(c-1)*a,u=o.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const f=l*d%1;u[d]=o.values[d-1]*(1-f)+o.values[d]*f}this._automationEvents[this._automationEvents.length-1]=xT(u,o.startTime,s)}}}else{const r=this._automationEvents.findIndex(s=>Ts(s)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Ro(i)&&Ts(i)+i.duration>n)return!1;const o=Zc(e)?rw(e.value,e.endTime,this._currenTime):pp(e)?iw(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(Ro(e)&&n+e.duration>Ts(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>Ts(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];Bf(i)&&r.unshift(qv(gp(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(s=>Ts(s)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(o!==void 0&&Bf(o)&&(r===void 0||!Bs(r)||r.insertTime>e))return PT(e,gp(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&TC(o)&&(r===void 0||!Bs(r)))return o.value;if(o!==void 0&&Ro(o)&&(r===void 0||!Bs(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?JF(e,o):o.values[o.values.length-1];if(o!==void 0&&Bs(o)&&(r===void 0||!Bs(r)))return o.value;if(r!==void 0&&Zc(r)){const[s,a]=ow(this._automationEvents,i,o,r,this._defaultValue);return sw(e,s,a,r)}if(r!==void 0&&pp(r)){const[s,a]=ow(this._automationEvents,i,o,r,this._defaultValue);return aw(e,s,a,r)}return this._defaultValue}}const QF=t=>({cancelTime:t,type:"cancelAndHold"}),qF=t=>({cancelTime:t,type:"cancelScheduledValues"}),eB=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),tB=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),nB=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),rB=()=>new DOMException("","AbortError"),iB=t=>(e,n,[r,i,o],s)=>{t(e[i],[n,r,o],a=>a[0]===n&&a[1]===r,s)},oB=t=>(e,n,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},sB=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Sl=new WeakSet,NT=new WeakMap,_T=new WeakMap,OT=new WeakMap,MT=new WeakMap,DT=new WeakMap,LT=new WeakMap,n0=new WeakMap,r0=new WeakMap,i0=new WeakMap,FT={construct(){return FT}},aB=t=>{try{const e=new Proxy(t,FT);new e}catch{return!1}return!0},cw=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,lw=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(cw);for(;i!==null;){const o=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(cw)}return[n.join(";"),r]},uw=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},dw=t=>{if(!aB(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},cB=(t,e,n,r,i,o,s,a,c,l,u,d,f)=>{let h=0;return(p,m,C={credentials:"omit"})=>{const g=u.get(p);if(g!==void 0&&g.has(m))return Promise.resolve();const v=l.get(p);if(v!==void 0){const A=v.get(m);if(A!==void 0)return A}const S=o(p),k=S.audioWorklet===void 0?i(m).then(([A,R])=>{const[P,w]=lw(A,R),_=`${P};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${w}
})})(window,'_AWGS')`;return n(_)}).then(()=>{const A=f._AWGS.pop();if(A===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>A(class{},void 0,(R,P)=>{if(R.trim()==="")throw e();const w=r0.get(S);if(w!==void 0){if(w.has(R))throw e();dw(P),uw(P.parameterDescriptors),w.set(R,P)}else dw(P),uw(P.parameterDescriptors),r0.set(S,new Map([[R,P]]))},S.sampleRate,void 0,void 0))}):Promise.all([i(m),Promise.resolve(t(d,d))]).then(([[A,R],P])=>{const w=h+1;h=w;const[_,O]=lw(A,R),H=`${_};((AudioWorkletProcessor,registerProcessor)=>{${O}
})(${P?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${P?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${P?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${w}',class extends AudioWorkletProcessor{process(){return !1}})`,J=new Blob([H],{type:"application/javascript; charset=utf-8"}),te=URL.createObjectURL(J);return S.audioWorklet.addModule(te,C).then(()=>{if(a(S))return S;const le=s(S);return le.audioWorklet.addModule(te,C).then(()=>le)}).then(le=>{if(c===null)throw new SyntaxError;try{new c(le,`__sac${w}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(te))});return v===void 0?l.set(p,new Map([[m,k]])):v.set(m,k),k.then(()=>{const A=u.get(p);A===void 0?u.set(p,new Set([m])):A.add(m)}).finally(()=>{const A=l.get(p);A!==void 0&&A.delete(m)}),k}},Di=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},cg=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},BT=(t,e,n,r)=>{const i=Di(t,e),o=cg(i,s=>s[0]===n&&s[1]===r);return i.size===0&&t.delete(e),o},Xd=t=>Di(LT,t),bl=t=>{if(Sl.has(t))throw new Error("The AudioNode is already stored.");Sl.add(t),Xd(t).forEach(e=>e(!0))},UT=t=>"port"in t,$d=t=>{if(!Sl.has(t))throw new Error("The AudioNode is not stored.");Sl.delete(t),Xd(t).forEach(e=>e(!1))},o0=(t,e)=>{!UT(t)&&e.every(n=>n.size===0)&&$d(t)},lB=(t,e,n,r,i,o,s,a,c,l,u,d,f)=>{const h=new WeakMap;return(p,m,C,g,v)=>{const{activeInputs:S,passiveInputs:k}=o(m),{outputs:A}=o(p),R=a(p),P=w=>{const _=c(m),O=c(p);if(w){const L=BT(k,p,C,g);t(S,p,L,!1),!v&&!d(p)&&n(O,_,C,g),f(m)&&bl(m)}else{const L=r(S,p,C,g);e(k,g,L,!1),!v&&!d(p)&&i(O,_,C,g);const U=s(m);if(U===0)u(m)&&o0(m,S);else{const X=h.get(m);X!==void 0&&clearTimeout(X),h.set(m,setTimeout(()=>{u(m)&&o0(m,S)},U*1e3))}}};return l(A,[m,C,g],w=>w[0]===m&&w[1]===C&&w[2]===g,!0)?(R.add(P),u(p)?t(S,p,[C,g,P],!0):e(k,g,[p,C,P],!0),!0):!1}},uB=t=>(e,n,[r,i,o],s)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,o]])):t(a,[i,n,o],c=>c[0]===i&&c[1]===n,s)},dB=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},fB=t=>(e,n)=>{t(e).add(n)},hB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},pB=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...hB,...c},d=r(l,u),f=o(l)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Un=(t,e)=>t.context===e,gB=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Un(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},s0=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Io=()=>new DOMException("","IndexSizeError"),VT=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?Io():r}})(t.getChannelData)},mB={numberOfChannels:1},vB=(t,e,n,r,i,o,s,a)=>{let c=null;return class GT{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...mB,...u};c===null&&(c=new i(1,1,44100));const p=r!==null&&e(o,o)?new r({length:d,numberOfChannels:f,sampleRate:h}):c.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(s(p),VT(p)):e(s0,()=>s0(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===GT.prototype||t.has(u)}}},ur=-34028234663852886e22,Xn=-ur,as=t=>Sl.has(t),yB={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},CB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),f={...yB,...u},h=i(d,f),p=s(d),m=p?e():null;super(l,!1,h,m),this._audioBufferSourceNodeRenderer=m,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,Xn,ur)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){bl(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),as(this)&&$d(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},IB=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Un(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,h),s!==null&&d.start(...s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await i(l,u,d),d};return{set start(l){s=l},set stop(l){a=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},SB=t=>"playbackRate"in t,bB=t=>"frequency"in t&&"gain"in t,wB=t=>"offset"in t,AB=t=>!("frequency"in t)&&"gain"in t,kB=t=>"detune"in t&&"frequency"in t&&!("gain"in t),EB=t=>"pan"in t,Jn=t=>Di(NT,t),Kd=t=>Di(OT,t),a0=(t,e)=>{const{activeInputs:n}=Jn(t);n.forEach(i=>i.forEach(([o])=>{e.includes(t)||a0(o,[...e,t])}));const r=SB(t)?[t.playbackRate]:UT(t)?Array.from(t.parameters.values()):bB(t)?[t.Q,t.detune,t.frequency,t.gain]:wB(t)?[t.offset]:AB(t)?[t.gain]:kB(t)?[t.detune,t.frequency]:EB(t)?[t.pan]:[];for(const i of r){const o=Kd(i);o!==void 0&&o.activeInputs.forEach(([s])=>a0(s,e))}as(t)&&$d(t)},TB=t=>{a0(t.destination,[])},RB=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),xB=(t,e,n,r,i,o,s,a,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!RB(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),TB(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},PB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),f=s(d),h=i(d,u,f),p=f?e(a):null;super(l,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},NB=t=>{const e=new WeakMap,n=async(r,i)=>{const o=i.destination;return e.set(i,o),await t(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):n(r,i)}}},_B=(t,e,n,r,i,o,s,a)=>(c,l)=>{const u=l.listener,d=()=>{const A=new Float32Array(1),R=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),P=s(l);let w=!1,_=[0,0,-1,0,1,0],O=[0,0,0];const L=()=>{if(w)return;w=!0;const J=r(l,256,9,0);J.onaudioprocess=({inputBuffer:te})=>{const le=[o(te,A,0),o(te,A,1),o(te,A,2),o(te,A,3),o(te,A,4),o(te,A,5)];le.some((z,se)=>z!==_[se])&&(u.setOrientation(...le),_=le);const $=[o(te,A,6),o(te,A,7),o(te,A,8)];$.some((z,se)=>z!==O[se])&&(u.setPosition(...$),O=$)},R.connect(J)},U=J=>te=>{te!==_[J]&&(_[J]=te,u.setOrientation(..._))},X=J=>te=>{te!==O[J]&&(O[J]=te,u.setPosition(...O))},H=(J,te,le)=>{const $=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:te});$.connect(R,0,J),$.start(),Object.defineProperty($.offset,"defaultValue",{get(){return te}});const z=t({context:c},P,$.offset,Xn,ur);return a(z,"value",se=>()=>se.call(z),se=>j=>{try{se.call(z,j)}catch(oe){if(oe.code!==9)throw oe}L(),P&&le(j)}),z.cancelAndHoldAtTime=(se=>P?()=>{throw i()}:(...j)=>{const oe=se.apply(z,j);return L(),oe})(z.cancelAndHoldAtTime),z.cancelScheduledValues=(se=>P?()=>{throw i()}:(...j)=>{const oe=se.apply(z,j);return L(),oe})(z.cancelScheduledValues),z.exponentialRampToValueAtTime=(se=>P?()=>{throw i()}:(...j)=>{const oe=se.apply(z,j);return L(),oe})(z.exponentialRampToValueAtTime),z.linearRampToValueAtTime=(se=>P?()=>{throw i()}:(...j)=>{const oe=se.apply(z,j);return L(),oe})(z.linearRampToValueAtTime),z.setTargetAtTime=(se=>P?()=>{throw i()}:(...j)=>{const oe=se.apply(z,j);return L(),oe})(z.setTargetAtTime),z.setValueAtTime=(se=>P?()=>{throw i()}:(...j)=>{const oe=se.apply(z,j);return L(),oe})(z.setValueAtTime),z.setValueCurveAtTime=(se=>P?()=>{throw i()}:(...j)=>{const oe=se.apply(z,j);return L(),oe})(z.setValueCurveAtTime),z};return{forwardX:H(0,0,U(0)),forwardY:H(1,0,U(1)),forwardZ:H(2,-1,U(2)),positionX:H(6,0,X(0)),positionY:H(7,0,X(1)),positionZ:H(8,0,X(2)),upX:H(3,0,U(3)),upY:H(4,1,U(4)),upZ:H(5,0,U(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:m,positionY:C,positionZ:g,upX:v,upY:S,upZ:k}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return m},get positionY(){return C},get positionZ(){return g},get upX(){return v},get upY(){return S},get upZ(){return k}}},mp=t=>"context"in t,Jd=t=>mp(t[0]),pc=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},fw=(t,e,[n,r],i)=>{pc(t,[e,n,r],o=>o[0]===e&&o[1]===n,i)},hw=(t,[e,n,r],i)=>{const o=t.get(e);o===void 0?t.set(e,new Set([[n,r]])):pc(o,[n,r],s=>s[0]===n,i)},Ll=t=>"inputs"in t,vp=(t,e,n,r)=>{if(Ll(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},WT=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},OB=(t,e,n)=>cg(t,r=>r[0]===e&&r[1]===n),jT=(t,e)=>{if(!Xd(t).delete(e))throw new Error("Missing the expected event listener.")},ZT=(t,e,n)=>{const r=Di(t,e),i=cg(r,o=>o[0]===n);return r.size===0&&t.delete(e),i},yp=(t,e,n,r)=>{Ll(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},kt=t=>Di(_T,t),bd=t=>Di(MT,t),rc=t=>n0.has(t),vh=t=>!Sl.has(t),pw=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),o=t.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;const a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),ym=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const o=n.get(i);n.set(i,o===void 0?1:o+1)}n.forEach((r,i)=>e(i,r))},Cp=t=>"context"in t,MB=t=>{const e=new Map;t.connect=(n=>(r,i=0,o=0)=>{const s=Cp(r)?n(r,i,o):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:o,output:i}]):a.every(c=>c.input!==o||c.output!==i)&&a.push({input:o,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(r,i,o)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[s,a]of e){const c=a.filter(l=>l.output!==r);c.length===0?e.delete(s):e.set(s,c)}else if(e.has(r))if(i===void 0)e.delete(r);else{const s=e.get(r);if(s!==void 0){const a=s.filter(c=>c.output!==i&&(c.input!==o||o===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[s,a]of e)a.forEach(c=>{Cp(s)?t.connect(s,c.output,c.input):t.connect(s,c.output)})})(t.disconnect)},DB=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=Kd(e),{outputs:s}=Jn(t),a=Xd(t),c=l=>{const u=kt(t),d=bd(e);if(l){const f=ZT(o,t,n);fw(i,t,f,!1),!r&&!rc(t)&&u.connect(d,n)}else{const f=OB(i,t,n);hw(o,f,!1),!r&&!rc(t)&&u.disconnect(d,n)}};return pc(s,[e,n],l=>l[0]===e&&l[1]===n,!0)?(a.add(c),as(t)?fw(i,t,[n,c],!0):hw(o,[t,n,c],!0),!0):!1},LB=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=Jn(e),s=WT(i[r],t,n);return s===null?[BT(o,t,n,r)[2],!1]:[s[2],!0]},FB=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=Kd(e),o=WT(r,t,n);return o===null?[ZT(i,t,n)[1],!1]:[o[2],!0]},RC=(t,e,n,r,i)=>{const[o,s]=LB(t,n,r,i);if(o!==null&&(jT(t,o),s&&!e&&!rc(t)&&yp(kt(t),kt(n),r,i)),as(n)){const{activeInputs:a}=Jn(n);o0(n,a)}},xC=(t,e,n,r)=>{const[i,o]=FB(t,n,r);i!==null&&(jT(t,i),o&&!e&&!rc(t)&&kt(t).disconnect(bd(n),r))},BB=(t,e)=>{const n=Jn(t),r=[];for(const i of n.outputs)Jd(i)?RC(t,e,...i):xC(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},UB=(t,e,n)=>{const r=Jn(t),i=[];for(const o of r.outputs)o[1]===n&&(Jd(o)?RC(t,e,...o):xC(t,e,...o),i.push(o[0]),r.outputs.delete(o));return i},VB=(t,e,n,r,i)=>{const o=Jn(t);return Array.from(o.outputs).filter(s=>s[0]===n&&(r===void 0||s[1]===r)&&(i===void 0||s[2]===i)).map(s=>(Jd(s)?RC(t,e,...s):xC(t,e,...s),o.outputs.delete(s),s[0]))},GB=(t,e,n,r,i,o,s,a,c,l,u,d,f,h,p,m)=>class extends l{constructor(g,v,S,k){super(S),this._context=g,this._nativeAudioNode=S;const A=u(g);d(A)&&n(pw,()=>pw(A,m))!==!0&&MB(S),_T.set(this,S),LT.set(this,new Set),g.state!=="closed"&&v&&bl(this),t(this,k,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,v=0,S=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const k=u(this._context),A=p(k);if(f(g)||h(g))throw o();if(mp(g)){const w=kt(g);try{const O=vp(this._nativeAudioNode,w,v,S),L=vh(this);(A||L)&&this._nativeAudioNode.disconnect(...O),this.context.state!=="closed"&&!L&&vh(g)&&bl(g)}catch(O){throw O.code===12?o():O}if(e(this,g,v,S,A)){const O=c([this],g);ym(O,r(A))}return g}const R=bd(g);if(R.name==="playbackRate"&&R.maxValue===1024)throw s();try{this._nativeAudioNode.connect(R,v),(A||vh(this))&&this._nativeAudioNode.disconnect(R,v)}catch(w){throw w.code===12?o():w}if(DB(this,g,v,A)){const w=c([this],g);ym(w,r(A))}}disconnect(g,v,S){let k;const A=u(this._context),R=p(A);if(g===void 0)k=BB(this,R);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw i();k=UB(this,R,g)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||mp(g)&&S!==void 0&&(S<0||S>=g.numberOfInputs))throw i();if(k=VB(this,R,g,v,S),k.length===0)throw o()}for(const P of k){const w=c([this],P);ym(w,a)}}},WB=(t,e,n,r,i,o,s,a,c,l,u,d,f)=>(h,p,m,C=null,g=null)=>{const v=m.value,S=new YF(v),k=p?r(S):null,A={get defaultValue(){return v},get maxValue(){return C===null?m.maxValue:C},get minValue(){return g===null?m.minValue:g},get value(){return m.value},set value(R){m.value=R,A.setValueAtTime(R,h.context.currentTime)},cancelAndHoldAtTime(R){if(typeof m.cancelAndHoldAtTime=="function")k===null&&S.flush(h.context.currentTime),S.add(i(R)),m.cancelAndHoldAtTime(R);else{const P=Array.from(S).pop();k===null&&S.flush(h.context.currentTime),S.add(i(R));const w=Array.from(S).pop();m.cancelScheduledValues(R),P!==w&&w!==void 0&&(w.type==="exponentialRampToValue"?m.exponentialRampToValueAtTime(w.value,w.endTime):w.type==="linearRampToValue"?m.linearRampToValueAtTime(w.value,w.endTime):w.type==="setValue"?m.setValueAtTime(w.value,w.startTime):w.type==="setValueCurve"&&m.setValueCurveAtTime(w.values,w.startTime,w.duration))}return A},cancelScheduledValues(R){return k===null&&S.flush(h.context.currentTime),S.add(o(R)),m.cancelScheduledValues(R),A},exponentialRampToValueAtTime(R,P){if(R===0)throw new RangeError;if(!Number.isFinite(P)||P<0)throw new RangeError;const w=h.context.currentTime;return k===null&&S.flush(w),Array.from(S).length===0&&(S.add(l(v,w)),m.setValueAtTime(v,w)),S.add(s(R,P)),m.exponentialRampToValueAtTime(R,P),A},linearRampToValueAtTime(R,P){const w=h.context.currentTime;return k===null&&S.flush(w),Array.from(S).length===0&&(S.add(l(v,w)),m.setValueAtTime(v,w)),S.add(a(R,P)),m.linearRampToValueAtTime(R,P),A},setTargetAtTime(R,P,w){return k===null&&S.flush(h.context.currentTime),S.add(c(R,P,w)),m.setTargetAtTime(R,P,w),A},setValueAtTime(R,P){return k===null&&S.flush(h.context.currentTime),S.add(l(R,P)),m.setValueAtTime(R,P),A},setValueCurveAtTime(R,P,w){const _=R instanceof Float32Array?R:new Float32Array(R);if(d!==null&&d.name==="webkitAudioContext"){const O=P+w,L=h.context.sampleRate,U=Math.ceil(P*L),X=Math.floor(O*L),H=X-U,J=new Float32Array(H);for(let le=0;le<H;le+=1){const $=(_.length-1)/w*((U+le)/L-P),z=Math.floor($),se=Math.ceil($);J[le]=z===se?_[z]:(1-($-z))*_[z]+(1-(se-$))*_[se]}k===null&&S.flush(h.context.currentTime),S.add(u(J,P,w)),m.setValueCurveAtTime(J,P,w);const te=X/L;te<O&&f(A,J[J.length-1],te),f(A,_[_.length-1],O)}else k===null&&S.flush(h.context.currentTime),S.add(u(_,P,w)),m.setValueCurveAtTime(_,P,w);return A}};return n.set(A,m),e.set(A,h),t(A,k),A},jB=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=n;e.setTargetAtTime(i,r,o)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=n;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class HT{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const ZB={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},HB=(t,e,n,r,i,o,s,a,c,l,u,d,f,h)=>class extends e{constructor(m,C,g){var v;const S=a(m),k=c(S),A=u({...ZB,...g});f(A);const R=r0.get(S),P=R==null?void 0:R.get(C),w=k||S.state!=="closed"?S:(v=s(S))!==null&&v!==void 0?v:S,_=i(w,k?null:m.baseLatency,l,C,P,A),O=k?r(C,A,P):null;super(m,!0,_,O);const L=[];_.parameters.forEach((X,H)=>{const J=n(this,k,X);L.push([H,J])}),this._nativeAudioWorkletNode=_,this._onprocessorerror=null,this._parameters=new HT(L),k&&t(S,this);const{activeInputs:U}=o(this);d(_,U)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(m){const C=typeof m=="function"?h(this,m):null;this._nativeAudioWorkletNode.onprocessorerror=C;const g=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=g!==null&&g===C?m:g}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Ip(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const o=t.getChannelData(r);if(e[n].byteLength===0)e[n]=o.slice(i,i+128);else{const s=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(s)}}}const zT=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},Sp=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let s=0;s<o;s+=1)i.push(new Float32Array(128));n.push(i)}return n},zB=(t,e)=>{const n=Di(i0,t),r=kt(e);return Di(n,r)},XB=async(t,e,n,r,i,o,s)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=i.reduce((C,g)=>C+g,0),u=l===0?null:n.createBuffer(l,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=Jn(t),f=await zB(n,t),h=Sp(r.numberOfInputs,r.channelCount),p=Sp(r.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce((C,g)=>({...C,[g]:new Float32Array(128)}),{});for(let C=0;C<a;C+=128){if(r.numberOfInputs>0&&e!==null)for(let g=0;g<r.numberOfInputs;g+=1)for(let v=0;v<r.channelCount;v+=1)Ip(e,h[g],v,v,C);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:g},v)=>{Ip(e,m,g,c+v,C)});for(let g=0;g<r.numberOfInputs;g+=1)for(let v=0;v<i[g];v+=1)p[g][v].byteLength===0&&(p[g][v]=new Float32Array(128));try{const g=h.map((S,k)=>d.activeInputs[k].size===0?[]:S),v=s(C/n.sampleRate,n.sampleRate,()=>f.process(g,p,m));if(u!==null)for(let S=0,k=0;S<r.numberOfOutputs;S+=1){for(let A=0;A<i[S];A+=1)zT(u,p[S],A,k+A,C);k+=i[S]}if(!v)break}catch(g){t.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return u},$B=(t,e,n,r,i,o,s,a,c,l,u,d,f,h,p,m)=>(C,g,v)=>{const S=new WeakMap;let k=null;const A=async(R,P)=>{let w=u(R),_=null;const O=Un(w,P),L=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(d===null){const U=L.reduce((te,le)=>te+le,0),X=i(P,{channelCount:Math.max(1,U),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,U)}),H=[];for(let te=0;te<R.numberOfOutputs;te+=1)H.push(r(P,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:L[te]}));const J=s(P,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});J.connect=e.bind(null,H),J.disconnect=c.bind(null,H),_=[X,H,J]}else O||(w=new d(P,C));if(S.set(P,_===null?w:_[2]),_!==null){if(k===null){if(v===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const le=R.channelCount*R.numberOfInputs,$=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length,z=le+$;k=XB(R,z===0?null:await(async()=>{const j=new f(z,Math.ceil(R.context.length/128)*128,P.sampleRate),oe=[],Ce=[];for(let Pe=0;Pe<g.numberOfInputs;Pe+=1)oe.push(s(j,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),Ce.push(i(j,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const Be=await Promise.all(Array.from(R.parameters.values()).map(async Pe=>{const Xe=o(j,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Pe.value});return await h(j,Pe,Xe.offset),Xe})),fe=r(j,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,le+$)});for(let Pe=0;Pe<g.numberOfInputs;Pe+=1){oe[Pe].connect(Ce[Pe]);for(let Xe=0;Xe<g.channelCount;Xe+=1)Ce[Pe].connect(fe,Xe,Pe*g.channelCount+Xe)}for(const[Pe,Xe]of Be.entries())Xe.connect(fe,0,le+Pe),Xe.start(0);return fe.connect(j.destination),await Promise.all(oe.map(Pe=>p(R,j,Pe))),m(j)})(),P,g,L,v,l)}const U=await k,X=n(P,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[H,J,te]=_;U!==null&&(X.buffer=U,X.start(0)),X.connect(H);for(let le=0,$=0;le<R.numberOfOutputs;le+=1){const z=J[le];for(let se=0;se<L[le];se+=1)H.connect(z,$+se,se);$+=L[le]}return te}if(O)for(const[U,X]of R.parameters.entries())await t(P,X,w.parameters.get(U));else for(const[U,X]of R.parameters.entries())await h(P,X,w.parameters.get(U));return await p(R,P,w),w};return{render(R,P){a(P,R);const w=S.get(P);return w!==void 0?Promise.resolve(w):A(R,P)}}},KB=(t,e,n,r,i,o,s,a,c,l,u,d,f,h,p,m,C,g,v,S)=>class extends p{constructor(A,R){super(A,R),this._nativeContext=A,this._audioWorklet=t===void 0?void 0:{addModule:(P,w)=>t(this,P,w)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(A,R,P){return new n({length:R,numberOfChannels:A,sampleRate:P})}createBufferSource(){return new r(this)}createChannelMerger(A=6){return new o(this,{numberOfInputs:A})}createChannelSplitter(A=6){return new s(this,{numberOfOutputs:A})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(A=1){return new u(this,{maxDelayTime:A})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(A,R){return new h(this,{feedback:R,feedforward:A})}createOscillator(){return new m(this)}createPanner(){return new C(this)}createPeriodicWave(A,R,P={disableNormalization:!1}){return new g(this,{...P,imag:R,real:A})}createStereoPanner(){return new v(this)}createWaveShaper(){return new S(this)}decodeAudioData(A,R,P){return l(this._nativeContext,A).then(w=>(typeof R=="function"&&R(w),w),w=>{throw typeof P=="function"&&P(w),w})}},JB={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},YB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),f={...JB,...u},h=i(d,f),p=s(d),m=p?n():null;super(l,!1,h,m),this._Q=e(this,p,h.Q,Xn,ur),this._detune=e(this,p,h.detune,1200*Math.log2(Xn),-1200*Math.log2(Xn)),this._frequency=e(this,p,h.frequency,l.sampleRate/2,0),this._gain=e(this,p,h.gain,40*Math.log10(Xn),ur),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(f){throw f.code===11?r():f}if(l.length!==u.length||u.length!==d.length)throw r()}},QB=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=Un(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,d)}return o.set(c,l),u?(await t(c,a.Q,l.Q),await t(c,a.detune,l.detune),await t(c,a.frequency,l.frequency),await t(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},qB=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const o=t.get(n);if(o!==void 0)return o;try{const s=r();return s instanceof Promise?(t.set(n,s),s.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,s),s)}catch{return e.set(n,!1),!1}},e3={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},t3=(t,e,n,r,i)=>class extends t{constructor(s,a){const c=r(s),l={...e3,...a},u=n(c,l),d=i(c)?e():null;super(s,!1,u,d)}},n3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Un(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},r3={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},i3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u=o({...r3,...c}),d=n(l,u),f=i(l)?e():null;super(a,!1,d,f)}},o3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Un(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},s3=t=>(e,n,r)=>t(n,e,r),a3=t=>(e,n,r=0,i=0)=>{const o=e[r];if(o===void 0)throw t();return Cp(n)?o.connect(n,0,i):o.connect(n,0)},c3=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},l3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},u3=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...l3,...l},f=r(u,d),h=o(u),p=h?n():null;super(c,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,h,f.offset,Xn,ur),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?s(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){bl(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),as(this)&&$d(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},d3=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Un(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,h),s!==null&&d.start(s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,l.offset,d.offset):await r(u,l.offset,d.offset),await i(l,u,d),d};return{set start(l){s=l},set stop(l){a=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},f3=t=>e=>(t[0]=e,t[0]),h3={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},p3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u={...h3,...c},d=n(l,u),h=i(l)?e():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},g3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Un(a,s)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(s,l)}return r.set(s,a),Ll(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},m3=()=>new DOMException("","DataCloneError"),gw=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},v3=(t,e,n,r,i,o,s,a,c,l,u)=>(d,f)=>{const h=s(d)?d:o(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(c,()=>c(h))?h.decodeAudioData(f).then(p=>(gw(f).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,m)=>{const C=async()=>{try{await gw(f)}catch{}},g=v=>{m(v),C()};try{h.decodeAudioData(f,v=>{typeof v.copyFromChannel!="function"&&(l(v),VT(v)),t.add(v),C().then(()=>p(v))},v=>{g(v===null?r():v)})}catch(v){g(v)}})},y3=(t,e,n,r,i,o,s,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(c.context),f=a(d);if(u===l){if(e.delete(c),!f&&s(c)){const h=r(c),{outputs:p}=n(c);for(const m of p)if(Jd(m)){const C=r(m[0]);t(h,C,m[1],m[2])}else{const C=i(m[0]);h.connect(C,m[1])}}}else e.set(c,u-l)},C3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},I3=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...C3,...l},f=r(u,d),h=o(u),p=h?n(d.maxDelayTime):null;super(c,!1,f,p),this._delayTime=e(this,h,f.delayTime),s(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},S3=(t,e,n,r,i)=>o=>{const s=new WeakMap,a=async(c,l)=>{let u=n(c);const d=Un(u,l);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(l,f)}return s.set(l,u),d?await t(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=s.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},b3=t=>(e,n,r,i)=>t(e[i],o=>o[0]===n&&o[1]===r),w3=t=>(e,n)=>{t(e).delete(n)},A3=t=>"delayTime"in t,k3=(t,e,n)=>function r(i,o){const s=mp(o)?o:n(t,o);if(A3(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=e(s);return Array.from(a).map(c=>r([...i,s],c[0])).reduce((c,l)=>c.concat(l),[])},Uf=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},E3=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(o=>o.disconnect()):typeof n=="number"?Uf(t,e,n).disconnect():Cp(n)?r===void 0?e.forEach(o=>o.disconnect(n)):i===void 0?Uf(t,e,r).disconnect(n,0):Uf(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(o=>o.disconnect(n)):Uf(t,e,r).disconnect(n,0),T3={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},R3=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),f={...T3,...u},h=r(d,f),p=s(d),m=p?n():null;super(l,!1,h,m),this._attack=e(this,p,h.attack),this._knee=e(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,p,h.ratio),this._release=e(this,p,h.release),this._threshold=e(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},x3=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=Un(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,d)}return o.set(c,l),u?(await t(c,a.attack,l.attack),await t(c,a.knee,l.knee),await t(c,a.ratio,l.ratio),await t(c,a.release,l.release),await t(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},P3=()=>new DOMException("","EncodingError"),N3=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const o=t.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(u,d,f,h,p)=>{if(d===a||d===t.location.href&&f===1&&h===1)return l(),r(p),!1;if(c!==null)return c(u,d,f,h,p)},o.onerror=()=>{l(),r(new SyntaxError)},o.onload=()=>{l(),n()},o.src=a,o.type="module",i.appendChild(o)}}),_3=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=t(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,i)}},O3=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},M3=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},D3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},L3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...D3,...c},d=r(l,u),f=o(l),h=f?n():null;super(a,!1,d,h),this._gain=e(this,f,d.gain,Xn,ur)}get gain(){return this._gain}},F3=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=Un(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,d)}return o.set(c,l),u?await t(c,a.gain,l.gain):await r(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},B3=(t,e)=>n=>e(t,n),U3=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},V3=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},G3=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},W3=t=>e=>t.get(e),wn=()=>new DOMException("","InvalidStateError"),j3=t=>e=>{const n=t.get(e);if(n===void 0)throw wn();return n},Z3=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},H3=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},lg=()=>new DOMException("","InvalidAccessError"),z3=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw lg();return e.call(t,n,r,i)})(t.getFrequencyResponse)},X3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},$3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u=i(l),d={...X3,...c},f=e(l,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),z3(f),this._nativeIIRFilterNode=f,o(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},XT=(t,e,n,r,i,o,s,a,c,l,u)=>{const d=l.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*l[h];for(let m=1;m<i;m+=1){const C=f-m&c-1;p+=n[m]*o[C],p-=t[m]*s[C]}for(let m=i;m<r;m+=1)p+=n[m]*o[f-m&c-1];for(let m=i;m<e;m+=1)p-=t[m]*s[f-m&c-1];o[f]=l[h],s[f]=p,f=f+1&c-1,u[h]=p}return f},K3=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,c=Math.min(s,a);if(i[0]!==1){for(let p=0;p<s;p+=1)o[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const m=t.getChannelData(p),C=f.getChannelData(p);u.fill(0),d.fill(0),XT(i,s,o,a,c,u,d,0,l,m,C)}return f},J3=(t,e,n,r,i)=>(o,s)=>{const a=new WeakMap;let c=null;const l=async(u,d)=>{let f=null,h=e(u);const p=Un(h,d);if(d.createIIRFilter===void 0?f=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(s,o)),a.set(d,f===null?h:f),f!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,C,C.destination);const g=await i(C);return K3(g,d,o,s)})()}const m=await c;return f.buffer=m,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},Y3=(t,e,n,r,i,o)=>s=>(a,c)=>{const l=t.get(a);if(l===void 0){if(!s&&o(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(Jd(f)){const h=r(f[0]);e(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}t.set(a,c)}else t.set(a,l+c)},Q3=t=>e=>t!==null&&e instanceof t,q3=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,e5=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,t5=(t,e)=>n=>t(n)||e(n),n5=t=>e=>t!==null&&e instanceof t,r5=t=>t!==null&&t.isSecureContext,i5=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),c=e(a,s);if(r(a))throw TypeError();super(o,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},o5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},s5=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o);if(r(a))throw new TypeError;const c={...o5,...s},l=e(a,c);super(o,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},a5=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),c=e(a,s);if(r(a))throw new TypeError;super(o,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},c5=(t,e,n)=>class extends t{constructor(i,o){const s=n(i),a=e(s,o);super(i,!0,a,null)}},l5=(t,e,n,r,i,o)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,DT.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},c0=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},u5=(t,e)=>(n,r,i)=>{const o=new Set;return n.connect=(s=>(a,c=0,l=0)=>{const u=o.size===0;if(e(a))return s.call(n,a,c,l),t(o,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;s.call(n,a,c),t(o,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(s=>(a,c,l)=>{const u=o.size>0;if(a===void 0)s.apply(n),o.clear();else if(typeof a=="number"){s.call(n,a);for(const f of o)f[1]===a&&o.delete(f)}else{e(a)?s.call(n,a,c,l):s.call(n,a,c);for(const f of o)f[0]===a&&(c===void 0||f[1]===c)&&(l===void 0||f[2]===l)&&o.delete(f)}const d=o.size===0;u&&d&&i()})(n.disconnect),n},Tt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},ln=(t,e)=>{Tt(t,e,"channelCount"),Tt(t,e,"channelCountMode"),Tt(t,e,"channelInterpretation")},mw=t=>typeof t.getFloatTimeDomainData=="function",d5=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},f5=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(ln(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Tt(i,r,"fftSize"),Tt(i,r,"maxDecibels"),Tt(i,r,"minDecibels"),Tt(i,r,"smoothingTimeConstant"),t(mw,()=>mw(i))||d5(i),i},h5=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Ut=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},p5=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw wn();e.call(t,r,i,o),n=!0}})(t.start)},PC=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},NC=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},g5=(t,e,n,r,i,o,s,a,c,l,u)=>(d,f)=>{const h=d.createBufferSource();return ln(h,f),Ut(h,f,"playbackRate"),Tt(h,f,"buffer"),Tt(h,f,"loop"),Tt(h,f,"loopEnd"),Tt(h,f,"loopStart"),e(n,()=>n(d))||p5(h),e(r,()=>r(d))||c(h),e(i,()=>i(d))||l(h,d),e(o,()=>o(d))||PC(h),e(s,()=>s(d))||u(h,d),e(a,()=>a(d))||NC(h),t(d,h),h},m5=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,v5=(t,e)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=t(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>c=>{a.call(s,c);try{o.channelCount=c}catch(l){if(c>o.maxChannelCount)throw l}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>c=>{a.call(s,c),o.channelCountMode=c}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>c=>{a.call(s,c),o.channelInterpretation=c}),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s},y5=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,C5=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},I5=(t,e,n,r,i)=>(o,s,a,c,l,u)=>{if(a!==null)try{const d=new a(o,c,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=typeof m[1]=="function"?m[1]:typeof m[1]=="object"&&m[1]!==null&&typeof m[1].handleEvent=="function"?m[1].handleEvent:null;if(C!==null){const g=f.get(m[1]);g!==void 0?m[1]=g:(m[1]=v=>{v.type==="error"?(Object.defineProperties(v,{type:{value:"processorerror"}}),C(v)):C(new ErrorEvent(m[0],{...v}))},f.set(C,m[1]))}}return p.call(d,"error",m[1],m[2]),p.call(d,...m)})(d.addEventListener),d.removeEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=f.get(m[1]);C!==void 0&&(f.delete(m[1]),m[1]=C)}return p.call(d,"error",m[1],m[2]),p.call(d,m[0],m[1],m[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(o.destination),i(d,()=>p.disconnect(),()=>p.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(l===void 0)throw r();return C5(u),e(o,s,l,u)},$T=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),S5=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),n(o)},i.postMessage(t)}),b5=async(t,e)=>{const n=await S5(e);return new t(n)},w5=(t,e,n,r)=>{let i=i0.get(t);i===void 0&&(i=new WeakMap,i0.set(t,i));const o=b5(n,r);return i.set(e,o),o},A5=(t,e,n,r,i,o,s,a,c,l,u,d,f)=>(h,p,m,C)=>{if(C.numberOfInputs===0&&C.numberOfOutputs===0)throw c();const g=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(g.some(de=>de<1))throw c();if(g.length!==C.numberOfOutputs)throw e();if(C.channelCountMode!=="explicit")throw c();const v=C.channelCount*C.numberOfInputs,S=g.reduce((de,Ie)=>de+Ie,0),k=m.parameterDescriptors===void 0?0:m.parameterDescriptors.length;if(v+k>6||S>6)throw c();const A=new MessageChannel,R=[],P=[];for(let de=0;de<C.numberOfInputs;de+=1)R.push(s(h,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),P.push(i(h,{channelCount:C.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:C.channelCount}));const w=[];if(m.parameterDescriptors!==void 0)for(const{defaultValue:de,maxValue:Ie,minValue:We,name:Le}of m.parameterDescriptors){const Me=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C.parameterData[Le]!==void 0?C.parameterData[Le]:de===void 0?0:de});Object.defineProperties(Me.offset,{defaultValue:{get:()=>de===void 0?0:de},maxValue:{get:()=>Ie===void 0?Xn:Ie},minValue:{get:()=>We===void 0?ur:We}}),w.push(Me)}const _=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+k)}),O=$T(p,h.sampleRate),L=a(h,O,v+k,Math.max(1,S)),U=i(h,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),X=[];for(let de=0;de<C.numberOfOutputs;de+=1)X.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[de]}));for(let de=0;de<C.numberOfInputs;de+=1){R[de].connect(P[de]);for(let Ie=0;Ie<C.channelCount;Ie+=1)P[de].connect(_,Ie,de*C.channelCount+Ie)}const H=new HT(m.parameterDescriptors===void 0?[]:m.parameterDescriptors.map(({name:de},Ie)=>{const We=w[Ie];return We.connect(_,0,v+Ie),We.start(0),[de,We.offset]}));_.connect(L);let J=C.channelInterpretation,te=null;const le=C.numberOfOutputs===0?[L]:X,$={get bufferSize(){return O},get channelCount(){return C.channelCount},set channelCount(de){throw n()},get channelCountMode(){return C.channelCountMode},set channelCountMode(de){throw n()},get channelInterpretation(){return J},set channelInterpretation(de){for(const Ie of R)Ie.channelInterpretation=de;J=de},get context(){return L.context},get inputs(){return R},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get onprocessorerror(){return te},set onprocessorerror(de){typeof te=="function"&&$.removeEventListener("processorerror",te),te=typeof de=="function"?de:null,typeof te=="function"&&$.addEventListener("processorerror",te)},get parameters(){return H},get port(){return A.port2},addEventListener(...de){return L.addEventListener(de[0],de[1],de[2])},connect:t.bind(null,le),disconnect:l.bind(null,le),dispatchEvent(...de){return L.dispatchEvent(de[0])},removeEventListener(...de){return L.removeEventListener(de[0],de[1],de[2])}},z=new Map;A.port1.addEventListener=(de=>(...Ie)=>{if(Ie[0]==="message"){const We=typeof Ie[1]=="function"?Ie[1]:typeof Ie[1]=="object"&&Ie[1]!==null&&typeof Ie[1].handleEvent=="function"?Ie[1].handleEvent:null;if(We!==null){const Le=z.get(Ie[1]);Le!==void 0?Ie[1]=Le:(Ie[1]=Me=>{u(h.currentTime,h.sampleRate,()=>We(Me))},z.set(We,Ie[1]))}}return de.call(A.port1,Ie[0],Ie[1],Ie[2])})(A.port1.addEventListener),A.port1.removeEventListener=(de=>(...Ie)=>{if(Ie[0]==="message"){const We=z.get(Ie[1]);We!==void 0&&(z.delete(Ie[1]),Ie[1]=We)}return de.call(A.port1,Ie[0],Ie[1],Ie[2])})(A.port1.removeEventListener);let se=null;Object.defineProperty(A.port1,"onmessage",{get:()=>se,set:de=>{typeof se=="function"&&A.port1.removeEventListener("message",se),se=typeof de=="function"?de:null,typeof se=="function"&&(A.port1.addEventListener("message",se),A.port1.start())}}),m.prototype.port=A.port1;let j=null;w5(h,$,m,C).then(de=>j=de);const Ce=Sp(C.numberOfInputs,C.channelCount),Be=Sp(C.numberOfOutputs,g),fe=m.parameterDescriptors===void 0?[]:m.parameterDescriptors.reduce((de,{name:Ie})=>({...de,[Ie]:new Float32Array(128)}),{});let Pe=!0;const Xe=()=>{C.numberOfOutputs>0&&L.disconnect(U);for(let de=0,Ie=0;de<C.numberOfOutputs;de+=1){const We=X[de];for(let Le=0;Le<g[de];Le+=1)U.disconnect(We,Ie+Le,Le);Ie+=g[de]}},me=new Map;L.onaudioprocess=({inputBuffer:de,outputBuffer:Ie})=>{if(j!==null){const We=d($);for(let Le=0;Le<O;Le+=128){for(let Me=0;Me<C.numberOfInputs;Me+=1)for(let et=0;et<C.channelCount;et+=1)Ip(de,Ce[Me],et,et,Le);m.parameterDescriptors!==void 0&&m.parameterDescriptors.forEach(({name:Me},et)=>{Ip(de,fe,Me,v+et,Le)});for(let Me=0;Me<C.numberOfInputs;Me+=1)for(let et=0;et<g[Me];et+=1)Be[Me][et].byteLength===0&&(Be[Me][et]=new Float32Array(128));try{const Me=Ce.map((xt,Pt)=>{if(We[Pt].size>0)return me.set(Pt,O/128),xt;const Ir=me.get(Pt);return Ir===void 0?[]:(xt.every(qt=>qt.every(un=>un===0))&&(Ir===1?me.delete(Pt):me.set(Pt,Ir-1)),xt)});Pe=u(h.currentTime+Le/h.sampleRate,h.sampleRate,()=>j.process(Me,Be,fe));for(let xt=0,Pt=0;xt<C.numberOfOutputs;xt+=1){for(let Gn=0;Gn<g[xt];Gn+=1)zT(Ie,Be[xt],Gn,Pt+Gn,Le);Pt+=g[xt]}}catch(Me){Pe=!1,$.dispatchEvent(new ErrorEvent("processorerror",{colno:Me.colno,filename:Me.filename,lineno:Me.lineno,message:Me.message}))}if(!Pe){for(let Me=0;Me<C.numberOfInputs;Me+=1){R[Me].disconnect(P[Me]);for(let et=0;et<C.channelCount;et+=1)P[Le].disconnect(_,et,Me*C.channelCount+et)}if(m.parameterDescriptors!==void 0){const Me=m.parameterDescriptors.length;for(let et=0;et<Me;et+=1){const xt=w[et];xt.disconnect(_,0,v+et),xt.stop()}}_.disconnect(L),L.onaudioprocess=null,Qt?Xe():Vt();break}}}};let Qt=!1;const zt=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Vn=()=>L.connect(zt).connect(h.destination),Vt=()=>{L.disconnect(zt),zt.disconnect()},Pn=()=>{if(Pe){Vt(),C.numberOfOutputs>0&&L.connect(U);for(let de=0,Ie=0;de<C.numberOfOutputs;de+=1){const We=X[de];for(let Le=0;Le<g[de];Le+=1)U.connect(We,Ie+Le,Le);Ie+=g[de]}}Qt=!0},qe=()=>{Pe&&(Vn(),Xe()),Qt=!1};return Vn(),f($,Pn,qe)},KT=(t,e)=>{const n=t.createBiquadFilter();return ln(n,e),Ut(n,e,"Q"),Ut(n,e,"detune"),Ut(n,e,"frequency"),Ut(n,e,"gain"),Tt(n,e,"type"),n},k5=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),ln(i,r),i},E5=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw wn()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw wn()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw wn()}})},Yd=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return ln(n,e),E5(n),n},T5=(t,e,n,r,i)=>(o,s)=>{if(o.createConstantSource===void 0)return n(o,s);const a=o.createConstantSource();return ln(a,s),Ut(a,s,"offset"),e(r,()=>r(o))||PC(a),e(i,()=>i(o))||NC(a),t(o,a),a},Fl=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),R5=(t,e,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},f=()=>c.connect(l),h=()=>c.disconnect(l);return t(i,c),r(Fl(d,l),f,h)},x5=(t,e)=>(n,r)=>{const i=n.createConvolver();if(ln(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Tt(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>s=>{if(s>2)throw t();return o.call(i,s)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",o=>()=>o.call(i),o=>s=>{if(s==="max")throw t();return o.call(i,s)}),i},JT=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return ln(n,e),Ut(n,e,"delayTime"),n},P5=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(ln(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Ut(r,n,"attack"),Ut(r,n,"knee"),Ut(r,n,"ratio"),Ut(r,n,"release"),Ut(r,n,"threshold"),r},yr=(t,e)=>{const n=t.createGain();return ln(n,e),Ut(n,e,"gain"),n},N5=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return ln(i,r),i};function _5(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function O5(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function vw(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=O5(n,e),n[0]+=t[r];return n}const M5=(t,e,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=$T(o,i.sampleRate),f=l instanceof Float64Array?l:new Float64Array(l),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,m=h.length,C=Math.min(p,m);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(m===0||m>20)throw r();if(h[0]===0)throw e();if(f[0]!==1){for(let w=0;w<m;w+=1)h[w]/=f[0];for(let w=1;w<p;w+=1)f[w]/=f[0]}const g=n(i,d,s,s);g.channelCount=s,g.channelCountMode=a,g.channelInterpretation=c;const v=32,S=[],k=[],A=[];for(let w=0;w<s;w+=1){S.push(0);const _=new Float32Array(v),O=new Float32Array(v);_.fill(0),O.fill(0),k.push(_),A.push(O)}g.onaudioprocess=w=>{const _=w.inputBuffer,O=w.outputBuffer,L=_.numberOfChannels;for(let U=0;U<L;U+=1){const X=_.getChannelData(U),H=O.getChannelData(U);S[U]=XT(f,p,h,m,C,k[U],A[U],S[U],v,X,H)}};const R=i.sampleRate/2;return Fl({get bufferSize(){return d},get channelCount(){return g.channelCount},set channelCount(w){g.channelCount=w},get channelCountMode(){return g.channelCountMode},set channelCountMode(w){g.channelCountMode=w},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(w){g.channelInterpretation=w},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(...w){return g.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return g.dispatchEvent(w[0])},getFrequencyResponse(w,_,O){if(w.length!==_.length||_.length!==O.length)throw t();const L=w.length;for(let U=0;U<L;U+=1){const X=-Math.PI*(w[U]/R),H=[Math.cos(X),Math.sin(X)],J=vw(h,H),te=vw(f,H),le=_5(J,te);_[U]=Math.sqrt(le[0]*le[0]+le[1]*le[1]),O[U]=Math.atan2(le[1],le[0])}},removeEventListener(...w){return g.removeEventListener(w[0],w[1],w[2])}},g)},D5=(t,e)=>t.createMediaElementSource(e.mediaElement),L5=(t,e)=>{const n=t.createMediaStreamDestination();return ln(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},F5=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((o,s)=>o.id<s.id?-1:o.id>s.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},B5=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return o},U5=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,V5=(t,e,n,r,i,o)=>(s,a)=>{const c=s.createOscillator();return ln(c,a),Ut(c,a,"detune"),Ut(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):Tt(c,a,"type"),e(n,()=>n(s))||PC(c),e(r,()=>r(s))||o(c,s),e(i,()=>i(s))||NC(c),t(s,c),c},G5=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(ln(r,n),Ut(r,n,"orientationX"),Ut(r,n,"orientationY"),Ut(r,n,"orientationZ"),Ut(r,n,"positionX"),Ut(r,n,"positionY"),Ut(r,n,"positionZ"),Tt(r,n,"coneInnerAngle"),Tt(r,n,"coneOuterAngle"),Tt(r,n,"coneOuterGain"),Tt(r,n,"distanceModel"),Tt(r,n,"maxDistance"),Tt(r,n,"panningModel"),Tt(r,n,"refDistance"),Tt(r,n,"rolloffFactor"),r)},W5=(t,e,n,r,i,o,s,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:m,orientationX:C,orientationY:g,orientationZ:v,panningModel:S,positionX:k,positionY:A,positionZ:R,refDistance:P,rolloffFactor:w,..._})=>{const O=u.createPanner();if(_.channelCount>2||_.channelCountMode==="max")throw s();ln(O,_);const L={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},U=n(u,{...L,channelInterpretation:"speakers",numberOfInputs:6}),X=r(u,{..._,gain:1}),H=r(u,{...L,gain:1}),J=r(u,{...L,gain:0}),te=r(u,{...L,gain:0}),le=r(u,{...L,gain:0}),$=r(u,{...L,gain:0}),z=r(u,{...L,gain:0}),se=i(u,256,6,1),j=o(u,{...L,curve:new Float32Array([1,1]),oversample:"none"});let oe=[C,g,v],Ce=[k,A,R];const Be=new Float32Array(1);se.onaudioprocess=({inputBuffer:me})=>{const Qt=[c(me,Be,0),c(me,Be,1),c(me,Be,2)];Qt.some((Vn,Vt)=>Vn!==oe[Vt])&&(O.setOrientation(...Qt),oe=Qt);const zt=[c(me,Be,3),c(me,Be,4),c(me,Be,5)];zt.some((Vn,Vt)=>Vn!==Ce[Vt])&&(O.setPosition(...zt),Ce=zt)},Object.defineProperty(J.gain,"defaultValue",{get:()=>0}),Object.defineProperty(te.gain,"defaultValue",{get:()=>0}),Object.defineProperty(le.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0});const fe={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(me){if(me>2)throw s();X.channelCount=me,O.channelCount=me},get channelCountMode(){return O.channelCountMode},set channelCountMode(me){if(me==="max")throw s();X.channelCountMode=me,O.channelCountMode=me},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(me){X.channelInterpretation=me,O.channelInterpretation=me},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(me){O.coneInnerAngle=me},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(me){O.coneOuterAngle=me},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(me){if(me<0||me>1)throw e();O.coneOuterGain=me},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(me){O.distanceModel=me},get inputs(){return[X]},get maxDistance(){return O.maxDistance},set maxDistance(me){if(me<0)throw new RangeError;O.maxDistance=me},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return H.gain},get orientationY(){return J.gain},get orientationZ(){return te.gain},get panningModel(){return O.panningModel},set panningModel(me){O.panningModel=me},get positionX(){return le.gain},get positionY(){return $.gain},get positionZ(){return z.gain},get refDistance(){return O.refDistance},set refDistance(me){if(me<0)throw new RangeError;O.refDistance=me},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(me){if(me<0)throw new RangeError;O.rolloffFactor=me},addEventListener(...me){return X.addEventListener(me[0],me[1],me[2])},dispatchEvent(...me){return X.dispatchEvent(me[0])},removeEventListener(...me){return X.removeEventListener(me[0],me[1],me[2])}};d!==fe.coneInnerAngle&&(fe.coneInnerAngle=d),f!==fe.coneOuterAngle&&(fe.coneOuterAngle=f),h!==fe.coneOuterGain&&(fe.coneOuterGain=h),p!==fe.distanceModel&&(fe.distanceModel=p),m!==fe.maxDistance&&(fe.maxDistance=m),C!==fe.orientationX.value&&(fe.orientationX.value=C),g!==fe.orientationY.value&&(fe.orientationY.value=g),v!==fe.orientationZ.value&&(fe.orientationZ.value=v),S!==fe.panningModel&&(fe.panningModel=S),k!==fe.positionX.value&&(fe.positionX.value=k),A!==fe.positionY.value&&(fe.positionY.value=A),R!==fe.positionZ.value&&(fe.positionZ.value=R),P!==fe.refDistance&&(fe.refDistance=P),w!==fe.rolloffFactor&&(fe.rolloffFactor=w),(oe[0]!==1||oe[1]!==0||oe[2]!==0)&&O.setOrientation(...oe),(Ce[0]!==0||Ce[1]!==0||Ce[2]!==0)&&O.setPosition(...Ce);const Pe=()=>{X.connect(O),t(X,j,0,0),j.connect(H).connect(U,0,0),j.connect(J).connect(U,0,1),j.connect(te).connect(U,0,2),j.connect(le).connect(U,0,3),j.connect($).connect(U,0,4),j.connect(z).connect(U,0,5),U.connect(se).connect(u.destination)},Xe=()=>{X.disconnect(O),a(X,j,0,0),j.disconnect(H),H.disconnect(U),j.disconnect(J),J.disconnect(U),j.disconnect(te),te.disconnect(U),j.disconnect(le),le.disconnect(U),j.disconnect($),$.disconnect(U),j.disconnect(z),z.disconnect(U),U.disconnect(se),se.disconnect(u.destination)};return l(Fl(fe,O),Pe,Xe)},j5=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},Qd=(t,e,n,r)=>t.createScriptProcessor(e,n,r),Z5=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const o=n.createStereoPanner();return ln(o,r),Ut(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:s=>{if(s!==i)throw e()}}),o},H5=(t,e,n,r,i,o)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(p,m,C,g)=>{const v=new Float32Array(16385),S=new Float32Array(16385);for(let _=0;_<16385;_+=1){const O=_/16384*c;v[_]=Math.cos(O),S[_]=Math.sin(O)}const k=n(p,{...l,gain:0}),A=r(p,{...u,curve:v}),R=r(p,{...u,curve:a}),P=n(p,{...l,gain:0}),w=r(p,{...u,curve:S});return{connectGraph(){m.connect(k),m.connect(R.inputs===void 0?R:R.inputs[0]),m.connect(P),R.connect(C),C.connect(A.inputs===void 0?A:A.inputs[0]),C.connect(w.inputs===void 0?w:w.inputs[0]),A.connect(k.gain),w.connect(P.gain),k.connect(g,0,0),P.connect(g,0,1)},disconnectGraph(){m.disconnect(k),m.disconnect(R.inputs===void 0?R:R.inputs[0]),m.disconnect(P),R.disconnect(C),C.disconnect(A.inputs===void 0?A:A.inputs[0]),C.disconnect(w.inputs===void 0?w:w.inputs[0]),A.disconnect(k.gain),w.disconnect(P.gain),k.disconnect(g,0,0),P.disconnect(g,0,1)}}},f=(p,m,C,g)=>{const v=new Float32Array(16385),S=new Float32Array(16385),k=new Float32Array(16385),A=new Float32Array(16385),R=Math.floor(16385/2);for(let le=0;le<16385;le+=1)if(le>R){const $=(le-R)/(16384-R)*c;v[le]=Math.cos($),S[le]=Math.sin($),k[le]=0,A[le]=1}else{const $=le/(16384-R)*c;v[le]=1,S[le]=0,k[le]=Math.cos($),A[le]=Math.sin($)}const P=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),w=n(p,{...l,gain:0}),_=r(p,{...u,curve:v}),O=n(p,{...l,gain:0}),L=r(p,{...u,curve:S}),U=r(p,{...u,curve:a}),X=n(p,{...l,gain:0}),H=r(p,{...u,curve:k}),J=n(p,{...l,gain:0}),te=r(p,{...u,curve:A});return{connectGraph(){m.connect(P),m.connect(U.inputs===void 0?U:U.inputs[0]),P.connect(w,0),P.connect(O,0),P.connect(X,1),P.connect(J,1),U.connect(C),C.connect(_.inputs===void 0?_:_.inputs[0]),C.connect(L.inputs===void 0?L:L.inputs[0]),C.connect(H.inputs===void 0?H:H.inputs[0]),C.connect(te.inputs===void 0?te:te.inputs[0]),_.connect(w.gain),L.connect(O.gain),H.connect(X.gain),te.connect(J.gain),w.connect(g,0,0),X.connect(g,0,0),O.connect(g,0,1),J.connect(g,0,1)},disconnectGraph(){m.disconnect(P),m.disconnect(U.inputs===void 0?U:U.inputs[0]),P.disconnect(w,0),P.disconnect(O,0),P.disconnect(X,1),P.disconnect(J,1),U.disconnect(C),C.disconnect(_.inputs===void 0?_:_.inputs[0]),C.disconnect(L.inputs===void 0?L:L.inputs[0]),C.disconnect(H.inputs===void 0?H:H.inputs[0]),C.disconnect(te.inputs===void 0?te:te.inputs[0]),_.disconnect(w.gain),L.disconnect(O.gain),H.disconnect(X.gain),te.disconnect(J.gain),w.disconnect(g,0,0),X.disconnect(g,0,0),O.disconnect(g,0,1),J.disconnect(g,0,1)}}},h=(p,m,C,g,v)=>{if(m===1)return d(p,C,g,v);if(m===2)return f(p,C,g,v);throw i()};return(p,{channelCount:m,channelCountMode:C,pan:g,...v})=>{if(C==="max")throw i();const S=t(p,{...v,channelCount:1,channelCountMode:C,numberOfInputs:2}),k=n(p,{...v,channelCount:m,channelCountMode:C,gain:1}),A=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g});let{connectGraph:R,disconnectGraph:P}=h(p,m,k,A,S);Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"maxValue",{get:()=>1}),Object.defineProperty(A.gain,"minValue",{get:()=>-1});const w={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(U){k.channelCount!==U&&(_&&P(),{connectGraph:R,disconnectGraph:P}=h(p,U,k,A,S),_&&R()),k.channelCount=U},get channelCountMode(){return k.channelCountMode},set channelCountMode(U){if(U==="clamped-max"||U==="max")throw i();k.channelCountMode=U},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(U){k.channelInterpretation=U},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get pan(){return A.gain},addEventListener(...U){return k.addEventListener(U[0],U[1],U[2])},dispatchEvent(...U){return k.dispatchEvent(U[0])},removeEventListener(...U){return k.removeEventListener(U[0],U[1],U[2])}};let _=!1;const O=()=>{R(),_=!0},L=()=>{P(),_=!1};return o(Fl(w,S),O,L)}},z5=(t,e,n,r,i,o,s)=>(a,c)=>{const l=a.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);ln(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Tt(l,{curve:u},"curve"),Tt(l,c,"oversample");let d=null,f=!1;return s(l,"curve",m=>()=>m.call(l),m=>C=>(m.call(l,C),f&&(r(C)&&d===null?d=t(a,l):!r(C)&&d!==null&&(d(),d=null)),C)),i(l,()=>{f=!0,r(l.curve)&&(d=t(a,l))},()=>{f=!1,d!==null&&(d(),d=null)})},X5=(t,e,n,r,i)=>(o,{curve:s,oversample:a,...c})=>{const l=o.createWaveShaper(),u=o.createWaveShaper();ln(l,c),ln(u,c);const d=n(o,{...c,gain:1}),f=n(o,{...c,gain:-1}),h=n(o,{...c,gain:1}),p=n(o,{...c,gain:-1});let m=null,C=!1,g=null;const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(A){d.channelCount=A,f.channelCount=A,l.channelCount=A,h.channelCount=A,u.channelCount=A,p.channelCount=A},get channelCountMode(){return l.channelCountMode},set channelCountMode(A){d.channelCountMode=A,f.channelCountMode=A,l.channelCountMode=A,h.channelCountMode=A,u.channelCountMode=A,p.channelCountMode=A},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(A){d.channelInterpretation=A,f.channelInterpretation=A,l.channelInterpretation=A,h.channelInterpretation=A,u.channelInterpretation=A,p.channelInterpretation=A},get context(){return l.context},get curve(){return g},set curve(A){if(A!==null&&A.length<2)throw e();if(A===null)l.curve=A,u.curve=A;else{const R=A.length,P=new Float32Array(R+2-R%2),w=new Float32Array(R+2-R%2);P[0]=A[0],w[0]=-A[R-1];const _=Math.ceil((R+1)/2),O=(R+1)/2-1;for(let L=1;L<_;L+=1){const U=L/_*O,X=Math.floor(U),H=Math.ceil(U);P[L]=X===H?A[X]:(1-(U-X))*A[X]+(1-(H-U))*A[H],w[L]=X===H?-A[R-1-X]:-((1-(U-X))*A[R-1-X])-(1-(H-U))*A[R-1-H]}P[_]=R%2===1?A[_-1]:(A[_-2]+A[_-1])/2,l.curve=P,u.curve=w}g=A,C&&(r(g)&&m===null?m=t(o,d):m!==null&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(A){l.oversample=A,u.oversample=A},addEventListener(...A){return d.addEventListener(A[0],A[1],A[2])},dispatchEvent(...A){return d.dispatchEvent(A[0])},removeEventListener(...A){return d.removeEventListener(A[0],A[1],A[2])}};s!==null&&(v.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==v.oversample&&(v.oversample=a);const S=()=>{d.connect(l).connect(h),d.connect(f).connect(u).connect(p).connect(h),C=!0,r(g)&&(m=t(o,d))},k=()=>{d.disconnect(l),l.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),C=!1,m!==null&&(m(),m=null)};return i(Fl(v,h),S,k)},Cr=()=>new DOMException("","NotSupportedError"),$5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},K5=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...$5,...l},f=n(u,d),h=o(u),p=h?r():null,m=c.sampleRate/2;super(c,!1,f,p),this._detune=e(this,h,f.detune,153600,-153600),this._frequency=e(this,h,f.frequency,m,-m),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?s(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){bl(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),as(this)&&$d(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},J5=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,c=null;const l=async(u,d)=>{let f=n(u);const h=Un(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:s===null?void 0:s,type:f.type};f=e(d,p),a!==null&&f.start(a),c!==null&&f.stop(c)}return o.set(d,f),h?(await t(d,u.detune,f.detune),await t(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){c=u},render(u,d){const f=o.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},Y5={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Q5=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...Y5,...l},f=n(u,d),h=o(u),p=h?r():null;super(c,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,h,f.orientationX,Xn,ur),this._orientationY=e(this,h,f.orientationY,Xn,ur),this._orientationZ=e(this,h,f.orientationZ,Xn,ur),this._positionX=e(this,h,f.positionX,Xn,ur),this._positionY=e(this,h,f.positionY,Xn,ur),this._positionZ=e(this,h,f.positionZ,Xn,ur),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},q5=(t,e,n,r,i,o,s,a,c,l)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let m=null,C=o(h);const g={channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation},v={...g,coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,panningModel:C.panningModel,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor},S=Un(C,p);if("bufferSize"in C)m=r(p,{...g,gain:1});else if(!S){const k={...v,orientationX:C.orientationX.value,orientationY:C.orientationY.value,orientationZ:C.orientationZ.value,positionX:C.positionX.value,positionY:C.positionY.value,positionZ:C.positionZ.value};C=i(p,k)}if(u.set(p,m===null?C:m),m!==null){if(d===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const L=new s(6,h.context.length,p.sampleRate),U=e(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});U.connect(L.destination),d=(async()=>{const X=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(H,J)=>{const te=n(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:J===0?1:0});return await a(L,H,te.offset),te}));for(let H=0;H<6;H+=1)X[H].connect(U,0,H),X[H].start(0);return l(L)})()}const k=await d,A=r(p,{...g,gain:1});await c(h,p,A);const R=[];for(let L=0;L<k.numberOfChannels;L+=1)R.push(k.getChannelData(L));let P=[R[0][0],R[1][0],R[2][0]],w=[R[3][0],R[4][0],R[5][0]],_=r(p,{...g,gain:1}),O=i(p,{...v,orientationX:P[0],orientationY:P[1],orientationZ:P[2],positionX:w[0],positionY:w[1],positionZ:w[2]});A.connect(_).connect(O.inputs[0]),O.connect(m);for(let L=128;L<k.length;L+=128){const U=[R[0][L],R[1][L],R[2][L]],X=[R[3][L],R[4][L],R[5][L]];if(U.some((H,J)=>H!==P[J])||X.some((H,J)=>H!==w[J])){P=U,w=X;const H=L/p.sampleRate;_.gain.setValueAtTime(0,H),_=r(p,{...g,gain:0}),O=i(p,{...v,orientationX:P[0],orientationY:P[1],orientationZ:P[2],positionX:w[0],positionY:w[1],positionZ:w[2]}),_.gain.setValueAtTime(1,H),A.connect(_).connect(O.inputs[0]),O.connect(m)}}return m}return S?(await t(p,h.orientationX,C.orientationX),await t(p,h.orientationY,C.orientationY),await t(p,h.orientationZ,C.orientationZ),await t(p,h.positionX,C.positionX),await t(p,h.positionY,C.positionY),await t(p,h.positionZ,C.positionZ)):(await a(p,h.orientationX,C.orientationX),await a(p,h.orientationY,C.orientationY),await a(p,h.orientationZ,C.orientationZ),await a(p,h.positionX,C.positionX),await a(p,h.positionY,C.positionY),await a(p,h.positionZ,C.positionZ)),Ll(C)?await c(h,p,C.inputs[0]):await c(h,p,C),C};return{render(h,p){const m=u.get(p);return m!==void 0?Promise.resolve(m):f(h,p)}}},eU={disableNormalization:!1},tU=(t,e,n,r)=>class YT{constructor(o,s){const a=e(o),c=r({...eU,...s}),l=t(a,c);return n.add(l),l}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===YT.prototype||n.has(o)}},nU=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),rU=(t,e,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(s.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const f=await e(l).render(l,i),h=r.context.destination;!n(l)&&(r!==h||!n(r))&&f.connect(o,u,c)})).reduce((a,c)=>[...a,...c],[]))},iU=(t,e,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,c])=>{const u=await t(a).render(a,i);n(a)||u.connect(o,c)}))},oU=(t,e,n,r)=>i=>t(c0,()=>c0(i))?Promise.resolve(t(r,r)).then(o=>{if(!o){const s=n(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{s.disconnect(),o(a.renderedBuffer)},s.connect(i.destination),i.startRendering()}),sU=t=>(e,n)=>{t.set(e,n)},aU=t=>(e,n)=>t.set(e,n),cU={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},lU=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...cU,...c},d=n(l,u),f=o(l),h=f?r():null;super(a,!1,d,h),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},uU=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=Un(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,d)}return o.set(c,l),u?await t(c,a.pan,l.pan):await r(c,a.pan,l.pan),Ll(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},dU=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},fU=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>s=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s},hU=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},pU=()=>new DOMException("","UnknownError"),gU={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},mU=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...gU,...l},f=n(u,d),p=o(u)?r():null;super(c,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},vU=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Un(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(s,l)}return r.set(s,a),Ll(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},yU=()=>typeof window>"u"?null:window,CU=(t,e)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<c&&d<u;d+=1)r[d]=l[d+s]},n.copyToChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<c&&d<u;d+=1)l[d+s]=r[d]}},IU=t=>e=>{e.copyFromChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyToChannel)},SU=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},bU=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},QT=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),qT=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},qd=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:r(s)})},wU=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),AU=t=>({...t,channelCount:t.numberOfOutputs}),kU=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},eR=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;eR(t,e,n+1e-7)}},EU=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},TU=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},RU=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},_C=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},tR=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},OC=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},xU=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},PU=t=>{t.start=(e=>(n=0,r=0,i)=>{const o=t.buffer,s=o===null?r:Math.min(o.duration,r);o!==null&&s>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,i)})(t.start)},nR=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Fl(t,n),t.stop=(i=>{let o=!1;return(s=0)=>{if(o)try{i.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else i.call(t,s),o=!0}})(t.stop)},Bl=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},NU=iB(pc),_U=uB(pc),OU=b3(cg),rR=new WeakMap,MU=V3(rR),Is=qB(new Map,new WeakMap),mo=yU(),iR=f5(Is,Io),oR=U3(Jn),xn=rU(Jn,oR,rc),DU=gB(iR,kt,xn),yt=j3(DT),Ca=U5(mo),ht=n5(Ca),sR=new WeakMap,aR=_3(Bl),ef=m5(mo),cR=Q3(ef),lR=q3(mo),LU=e5(mo),wd=y5(mo),Ht=GB(oB(NT),lB(NU,_U,vp,OU,yp,Jn,MU,Xd,kt,pc,as,rc,vh),Is,Y3(n0,yp,Jn,kt,bd,as),Io,lg,Cr,y3(vp,n0,Jn,kt,bd,yt,as,ht),k3(sR,Jn,Di),aR,yt,cR,lR,LU,ht,wd),FU=pB(Ht,DU,Io,iR,yt,ht),uR=new WeakSet,yw=h5(mo),dR=f3(new Uint32Array(1)),fR=CU(dR,Io),hR=IU(dR),BU=vB(uR,Is,Cr,yw,Ca,dU(yw),fR,hR),ug=dB(yr),pR=iU(oR,Kd,rc),So=s3(pR),Ul=g5(ug,Is,EU,TU,RU,_C,tR,OC,PU,SU(qd),nR),bo=nU(G3(Kd),pR),UU=IB(So,Ul,kt,bo,xn),Ui=WB(sB(OT),sR,MT,jB,QF,qF,eB,tB,nB,qv,xT,ef,eR),VU=CB(Ht,UU,Ui,wn,Ul,yt,ht,Bl),GU=PB(Ht,NB,Io,wn,v5(yr,qd),yt,ht,xn),WU=QB(So,KT,kt,bo,xn),gc=aU(rR),jU=YB(Ht,Ui,WU,lg,KT,yt,ht,gc),Ia=u5(pc,lR),ZU=bU(wn,Ia),Sa=k5(ef,ZU),HU=n3(Sa,kt,xn),zU=t3(Ht,HU,Sa,yt,ht),XU=o3(Yd,kt,xn),$U=i3(Ht,XU,Yd,yt,ht,AU),KU=R5(ug,Ul,yr,Ia),Vl=T5(ug,Is,KU,_C,OC),JU=d3(So,Vl,kt,bo,xn),YU=u3(Ht,Ui,JU,Vl,yt,ht,Bl),gR=x5(Cr,qd),QU=g3(gR,kt,xn),qU=p3(Ht,QU,gR,yt,ht,gc),e4=S3(So,JT,kt,bo,xn),t4=I3(Ht,Ui,e4,JT,yt,ht,gc),mR=P5(Cr),n4=x3(So,mR,kt,bo,xn),r4=R3(Ht,Ui,n4,mR,Cr,yt,ht,gc),i4=F3(So,yr,kt,bo,xn),o4=L3(Ht,Ui,i4,yr,yt,ht),s4=M5(lg,wn,Qd,Cr),MC=oU(Is,yr,Qd,hU(yr,Ca)),a4=J3(Ul,kt,Ca,xn,MC),c4=N5(s4),l4=$3(Ht,c4,a4,yt,ht,gc),u4=_B(Ui,Sa,Vl,Qd,Cr,QT,ht,qd),vR=new WeakMap,d4=l5(GU,u4,aR,ht,vR,Bl),yR=V5(ug,Is,_C,tR,OC,nR),f4=J5(So,yR,kt,bo,xn),h4=K5(Ht,Ui,yR,f4,yt,ht,Bl),CR=c3(Ul),p4=X5(CR,wn,yr,qT,Ia),dg=z5(CR,wn,p4,qT,Ia,ef,qd),g4=W5(vp,wn,Sa,yr,Qd,dg,Cr,yp,QT,Ia),IR=G5(g4),m4=q5(So,Sa,Vl,yr,IR,kt,Ca,bo,xn,MC),v4=Q5(Ht,Ui,IR,m4,yt,ht,gc),y4=j5(Io),C4=tU(y4,yt,new WeakSet,kU),I4=H5(Sa,Yd,yr,dg,Cr,Ia),SR=Z5(I4,Cr),S4=uU(So,SR,kt,bo,xn),b4=lU(Ht,Ui,SR,S4,yt,ht),w4=vU(dg,kt,xn),A4=mU(Ht,wn,dg,w4,yt,ht,gc),bR=r5(mo),DC=O3(mo),wR=new WeakMap,k4=Z3(wR,Ca),E4=bR?cB(Is,Cr,N3(mo),DC,M3(rB),yt,k4,ht,wd,new WeakMap,new WeakMap,fU(wd,Ca),mo):void 0,T4=t5(cR,ht),R4=v3(uR,Is,m3,P3,new WeakSet,yt,T4,s0,c0,fR,hR),x4=KB(E4,FU,BU,VU,jU,zU,$U,YU,qU,R4,t4,r4,o4,l4,d4,h4,v4,C4,b4,A4),P4=i5(Ht,D5,yt,ht),N4=s5(Ht,L5,yt,ht),_4=a5(Ht,F5,yt,ht),O4=B5(wn,ht),M4=c5(Ht,O4,yt),D4=xB(x4,wn,Cr,pU,P4,N4,_4,M4,ef),AR=H3(vR),L4=fB(AR),kR=a3(Io),F4=w3(AR),ER=E3(Io),TR=new WeakMap,B4=B3(TR,Di),U4=A5(kR,Io,wn,Sa,Yd,Vl,yr,Qd,Cr,ER,DC,B4,Ia),V4=I5(wn,U4,yr,Cr,Ia),G4=$B(So,kR,Ul,Sa,Yd,Vl,yr,F4,ER,DC,kt,wd,Ca,bo,xn,MC),W4=W3(wR),j4=sU(TR),Cw=bR?HB(L4,Ht,Ui,G4,V4,Jn,W4,yt,ht,wd,wU,j4,xU,Bl):void 0,Z4="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";class Iw{constructor(e){V(this,"maxSize");V(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}has(e){return this.cache.has(e)}}const Sw=100;class Xu{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getBufferFromCache(e,n){try{const r=await n.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,n,r,i){try{const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const s=await fetch(e,{headers:o}),a=s.clone();if(s.status===200){const c=s.headers.get("ETag")||void 0,l=s.headers.get("Last-Modified")||void 0,u={url:e,etag:c,lastModified:l,timestamp:Date.now()};await n.put(e,a),await n.put(e+":meta",new Response(JSON.stringify(u),{headers:{"Content-Type":"application/json"}}))}else if(s.status===304){const c=await n.match(e);if(c)return await c.arrayBuffer()}return await s.arrayBuffer()}catch(o){throw console.error("Failed to fetch and cache data:",o),o}}static async decodeAudioData(e,n){try{return await e.decodeAudioData(n)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,n){try{const r=await n.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}static async getAudioBuffer(e,n){if(this.decodedBuffers.has(n))return this.decodedBuffers.get(n);if(n.startsWith("data:")){const a=n.split(",")[1],c=Uint8Array.from(atob(a),u=>u.charCodeAt(0)).buffer,l=await this.decodeAudioData(e,c);return this.decodedBuffers.set(n,l),l}const r=await this.openCache();let i=this.pendingRequests.get(n);if(i)return i;const o=await this.getMetadataFromCache(n,r);let s=!o;if(o&&(o.etag||o.lastModified?s=!1:o.timestamp?s=Date.now()-o.timestamp>this.cacheExpirationTime:s=!0),s)return i=this.fetchAndCacheBuffer(n,r,o==null?void 0:o.etag,o==null?void 0:o.lastModified).then(a=>this.decodeAudioData(e,a)).then(a=>(this.decodedBuffers.set(n,a),a)).finally(()=>{this.pendingRequests.delete(n)}),this.pendingRequests.set(n,i),i;{const a=await this.getBufferFromCache(n,r);if(a){const c=await this.decodeAudioData(e,a);return this.decodedBuffers.set(n,c),c}}throw new Error("Failed to retrieve audio buffer")}static clearMemoryCache(){this.decodedBuffers=new Iw(Sw),this.pendingRequests.clear()}}V(Xu,"pendingRequests",new Map),V(Xu,"decodedBuffers",new Iw(Sw)),V(Xu,"cacheExpirationTime",24*60*60*1e3);class bw{constructor(e=[]){V(this,"_position",[0,0,0]);V(this,"loopCount",0);V(this,"playIndex",0);this.sounds=e}preplayRandom(){return this.randomSound().preplay()[0]}playRandom(){const e=this.preplayRandom();return e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)throw new Error("Cannot prepare an ordered sound from an empty group");const n=this.sounds[this.playIndex].preplay()[0];return this.playIndex++,this.playIndex>=this.sounds.length&&(e?this.playIndex=0:this.playIndex=this.sounds.length),n}playOrdered(e=!0){const n=this.preplayOrdered(e);return n.play(),n}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.reduce((e,n)=>(n.loop&&n.loop(this.loopCount),e.concat(n.preplay())),[])}play(){return this.preplay().map(e=>e.play()[0])}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}}let Gl=class{constructor(){V(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(n=>n.frequency.value!==e.frequency.value&&n.type!==e.type&&n.Q.value!==e.Q.value&&n.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((n,r)=>(n.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(n=>this.addFilter(n))}removeFilters(e){e.forEach(n=>this.removeFilter(n))}},H4=class extends Gl{constructor(n,r,i,o=0){super();V(this,"context");V(this,"source");V(this,"gainNode");V(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}},z4=class extends Gl{constructor(n){super();V(this,"context");V(this,"_position",[0,0,0]);V(this,"loopCount",0);V(this,"prevVolume",1);V(this,"microphoneGainNode");V(this,"streamPlayback");V(this,"stream");V(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new H4(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}};function RR(t){class e extends t{constructor(){super(...arguments);V(this,"playbacks",[]);V(this,"_position",[0,0,0]);V(this,"_stereoPan",0);V(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});V(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function xR(t){class e extends t{constructor(){super(...arguments);V(this,"panner");V(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner()}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=ww(i,-1,1),this.panner.pan.setValueAtTime(ww(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,s,a]=i,c=this.panner;c.positionX.value=o,c.positionY.value=s,c.positionZ.value=a}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function ww(t,e,n){return Math.min(Math.max(t,e),n)}function PR(t){class e extends t{constructor(){super(...arguments);V(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}class NR extends xR(PR(Gl)){constructor(){super(...arguments);V(this,"source");V(this,"_playing",!1);V(this,"origin")}get isPlaying(){return this.source?this._playing:!1}}class LC extends NR{constructor(n,r,i){super();V(this,"context");V(this,"loopCount",0);V(this,"currentLoop",0);V(this,"buffer");V(this,"_startTime",0);V(this,"_offset",0);V(this,"_state",0);V(this,"_pauseTime",0);V(this,"loopEnded",()=>{if(this.source&&this._state===1){if(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount)return this.stop();this.buffer?(this.recreateSource(),this.source.start(0)):this.seek(0),this._state=1}});if(this.origin=n,this.context=n.context,this.loopCount=n.loopCount,this.setPanType(n.panType,n.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),"mediaElement"in r&&r.mediaElement)r.mediaElement.onended=this.loopEnded;else if("onended"in r)r.onended=this.loopEnded;else throw new Error("Unsupported source type");this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}get isPlaying(){return this._state===1}get duration(){if(!this.buffer)throw new Error("Cannot get duration of a sound that has been cleaned up");return this.buffer.duration}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(n){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n)}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===2?this._offset+=this.context.currentTime-this._pauseTime:this._state!==1&&this.recreateSource(),"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&this.source.start(0,this._offset),this._startTime=this.context.currentTime-this._offset,this._state=1,[this]}pause(){!this.source||this._state!==1||(this._state=2,this._pauseTime=this.context.currentTime,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop())}seek(n){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const r=this.isPlaying;r&&this.stop(),this._offset=n,r&&this.play()}get currentTime(){switch(this._state){case 0:case 3:return this._offset;case 2:return this._pauseTime-this._startTime+this._offset;case 1:return this.context.currentTime-this._startTime+this._offset}}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&this.source.disconnect(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.refreshFilters()}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=[]}loop(n){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(n!==void 0&&(this.isPlaying&&isFinite(Number(n))&&(n=Number(n)-1),this.loopCount=n,this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||(this._state=3,this._offset=0,this._pauseTime=0,"stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0))}addFilter(n){const r=n.context.createBiquadFilter();r.type=n.type,r.frequency.value=n.frequency.value,r.Q.value=n.Q.value,super.addFilter(r),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}clone(n={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=n.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=new LC(this.origin,o,i);return a.loopCount=s,a.setPanType(r,this.context),a.volume=this.volume,a}}let Vf=class _R extends RR(Gl){constructor(n,r,i,o,s=Ad.Buffer,a="HRTF"){super();V(this,"buffer");V(this,"context");V(this,"loopCount",0);V(this,"_playbackRate",1);this.url=n,this.globalGainNode=o,this.soundType=s,this.panType=a,this.buffer=r,this.context=i}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan,o=n.threeDOptions||this.threeDOptions,s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=n.playbackRate||this.playbackRate,c=n.volume!==void 0?n.volume:this.volume,l=n.position&&n.position.length?n.position:this.position,u=n.filters&&n.filters.length?n.filters:this._filters,d=new _R(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return d.loopCount=s,d._playbackRate=a,d._volume=c,d._position=l,d._stereoPan=i,d._threeDOptions=o,d.addFilters(u),d}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",n=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new LC(this,n,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return((n=this.buffer)==null?void 0:n.duration)||0}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.loop(n)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}};const X4=(t,e)=>{var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer};function $4(t,e){const n=[];let r=0;fetch(t).then(function(o){if(!o.ok)throw new Error("HTTP error, status = "+o.status);if(!o.body)throw new Error("Missing body");var s=o.body.getReader();let a=new ArrayBuffer(0);function c(){return s.read().then(({value:l,done:u})=>{let d=null;if(l){if(a.byteLength?d=X4(a,l.buffer):(a=l.buffer.slice(0,44),d=l.buffer),e.decodeAudioData(d,function(f){n.push(f),n.length&&i()},function(f){console.log("err(decodeAudioData): "+f)}),u){console.log("done");return}c()}})}c()});function i(){for(;n.length;){let o=n.shift();const s=e.createBufferSource();if(!o)return;s.buffer=o,s.connect(e.destination),r==0&&(r=e.currentTime+.02),s.start(r),r+=s.buffer.duration}}}function K4(t){class e extends NR{constructor(){super(...arguments);V(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}class J4 extends K4(xR(PR(Gl))){constructor(n,r,i){super();V(this,"context");this.origin=n,this.source=r,this.context=n.context,this.setPanType(n.panType,n.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}}class FC extends RR(Gl){constructor(n,r,i=Ad.Oscillator,o="HRTF",s={}){super();V(this,"_oscillatorOptions");V(this,"playbacks",[]);this.context=n,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=n,this._oscillatorOptions=s}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan??0,o=n.threeDOptions||this.threeDOptions,s=n.volume!==void 0?n.volume:this.volume,a=n.position&&n.position.length?n.position:this.position,c=n.filters&&n.filters.length?n.filters:this._filters,l=n.oscillatorOptions||this._oscillatorOptions,u=new FC(this.context,this.globalGainNode,this.soundType,r,l);return u._volume=s,u._position=a,u._stereoPan=i,u._threeDOptions=o,u.addFilters(c),u}preplay(){const n=this.context.createOscillator();this.oscillatorOptions.detune&&(n.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(n.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(n.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new J4(this,n,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(n){this._oscillatorOptions=n,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(n){this._oscillatorOptions.frequency=n,this.playbacks.forEach(r=>r.frequency=n)}get detune(){return this.oscillatorOptions.detune}set detune(n){this._oscillatorOptions.detune=n,this.playbacks.forEach(r=>r.detune=n)}get type(){return this.oscillatorOptions.type||"sine"}set type(n){this._oscillatorOptions.type=n,this.playbacks.forEach(r=>r.type=n)}}var Ad=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t.Oscillator="oscillator",t))(Ad||{});class Y4{constructor(e){V(this,"context");V(this,"globalGainNode");V(this,"listener");V(this,"prevVolume",1);V(this,"finalizationRegistry");V(this,"createBiquadFilter",({type:e,frequency:n,gain:r,Q:i})=>{n===void 0&&(n=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=n,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new D4,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",Z4):console.warn("AudioWorklet not supported")}async createWorkletNode(e,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new Cw(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new Cw(this.context,e)}}clearMemoryCache(){Xu.clearMemoryCache()}createOscillator(e,n="HRTF"){return new FC(this.context,this.globalGainNode,"oscillator",n,e)}async createSound(e,n="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new Vf("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(n==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new Vf(i,void 0,this.context,this.globalGainNode,"HTML",r)}return Xu.getAudioBuffer(this.context,i).then(o=>new Vf(i,o,this.context,this.globalGainNode,n,r))}async createGroup(e){const n=new bw;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e,n="Buffer",r="HRTF"){const i=new bw;return(await Promise.all(e.map(o=>this.createSound(o,n,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return await $4(e,this.context),new Vf(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:s,channelCountMode:a,channelInterpretation:c,panningModel:l,refDistance:u,rolloffFactor:d,positionX:f,positionY:h,positionZ:p,orientationX:m,orientationY:C,orientationZ:g}){const v=this.context.createPanner();return v.coneInnerAngle=e||360,v.coneOuterAngle=n||360,v.coneOuterGain=r||0,v.distanceModel=i||"inverse",v.maxDistance=o||1e4,v.channelCount=s||2,v.channelCountMode=a||"clamped-max",v.channelInterpretation=c||"speakers",v.panningModel=l||"HRTF",v.refDistance=u||1,v.rolloffFactor=d||1,v.positionX.value=f||0,v.positionY.value=h||0,v.positionZ.value=p||0,v.orientationX.value=m||0,v.orientationY.value=C||0,v.orientationZ.value=g||0,v}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new z4(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,o,s]=n,[a,c,l]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=s,this.listener.upX.value=a,this.listener.upY.value=c,this.listener.upZ.value=l}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.value=n,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.value=n,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(n,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}}const Q4="https://mongoose.world:9080/?url=";class q4 extends Co{constructor(){super(...arguments);V(this,"packageName","Client.Media");V(this,"sounds",{});V(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let s=await this.client.cacophony.createSound(r);s.key=i,this.sounds[i]=s}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=Q4+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];const o=n.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,Ad.HTML,o):i=await this.client.cacophony.createSound(r,Ad.Buffer,o)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0){const s=n.loops===-1?1/0:n.loops-1;i.loop(s)}if(n.start&&i.seek(n.start),n.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const a=this.sounds[s];a.priority&&a.priority<n.priority&&a.stop()}i.priority=n.priority}if(!i.isPlaying){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}i.key=n.key,this.sounds[i.key]=i}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>this.stopSound(r)),n.type&&this.soundsByType(n.type).forEach(r=>this.stopSound(r)),n.tag&&this.soundsByTag(n.tag).forEach(r=>this.stopSound(r)),n.key&&this.soundsByKey(n.key).forEach(r=>this.stopSound(r)),!n.name&&!n.type&&!n.tag&&!n.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(n){delete this.sounds[n.key],n.stop()}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class eV extends Co{constructor(){super(...arguments);V(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class tV extends Co{constructor(){super(...arguments);V(this,"packageName","Comm.Channel");V(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class nV extends Co{constructor(){super(...arguments);V(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class rV extends Co{constructor(){super(...arguments);V(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class iV extends Co{constructor(){super(...arguments);V(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}class oV extends Co{constructor(n){super(n);V(this,"packageName","Client.Html")}handleAdd_html(n){this.client.emit("html",n.data.join(`
`))}}const Ec=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,OR=new Set,l0=typeof process=="object"&&process?process:{},MR=(t,e,n,r)=>{typeof l0.emitWarning=="function"?l0.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let bp=globalThis.AbortController,Aw=globalThis.AbortSignal;var XA;if(typeof bp>"u"){Aw=class{constructor(){V(this,"onabort");V(this,"_onabort",[]);V(this,"reason");V(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},bp=class{constructor(){V(this,"signal",new Aw);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const s of this.signal._onabort)s(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let t=((XA=l0.env)==null?void 0:XA.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,MR("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const sV=t=>!OR.has(t),_s=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),DR=t=>_s(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?yh:null:null;class yh extends Array{constructor(e){super(e),this.fill(0)}}var ll;const La=class La{constructor(e,n){V(this,"heap");V(this,"length");if(!N(La,ll))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=DR(e);if(!n)return[];Ne(La,ll,!0);const r=new La(e,n);return Ne(La,ll,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};ll=new WeakMap,tt(La,ll,!1);let u0=La;var $A,KA,fi,kr,hi,pi,ul,dl,en,gi,Kt,St,Fe,jn,Er,On,dn,mi,fn,vi,yi,Tr,Ci,Gs,Zn,pe,f0,ja,_o,Fd,Rr,LR,Za,fl,Bd,Os,Ms,h0,Ch,Ih,It,p0,_u,Ds,g0;const wI=class wI{constructor(e){tt(this,pe);tt(this,fi);tt(this,kr);tt(this,hi);tt(this,pi);tt(this,ul);tt(this,dl);V(this,"ttl");V(this,"ttlResolution");V(this,"ttlAutopurge");V(this,"updateAgeOnGet");V(this,"updateAgeOnHas");V(this,"allowStale");V(this,"noDisposeOnSet");V(this,"noUpdateTTL");V(this,"maxEntrySize");V(this,"sizeCalculation");V(this,"noDeleteOnFetchRejection");V(this,"noDeleteOnStaleGet");V(this,"allowStaleOnFetchAbort");V(this,"allowStaleOnFetchRejection");V(this,"ignoreFetchAbort");tt(this,en);tt(this,gi);tt(this,Kt);tt(this,St);tt(this,Fe);tt(this,jn);tt(this,Er);tt(this,On);tt(this,dn);tt(this,mi);tt(this,fn);tt(this,vi);tt(this,yi);tt(this,Tr);tt(this,Ci);tt(this,Gs);tt(this,Zn);tt(this,ja,()=>{});tt(this,_o,()=>{});tt(this,Fd,()=>{});tt(this,Rr,()=>!1);tt(this,Za,e=>{});tt(this,fl,(e,n,r)=>{});tt(this,Bd,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});V(this,$A,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:c,dispose:l,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:m,fetchMethod:C,memoMethod:g,noDeleteOnFetchRejection:v,noDeleteOnStaleGet:S,allowStaleOnFetchRejection:k,allowStaleOnFetchAbort:A,ignoreFetchAbort:R}=e;if(n!==0&&!_s(n))throw new TypeError("max option must be a nonnegative integer");const P=n?DR(n):Array;if(!P)throw new Error("invalid max value: "+n);if(Ne(this,fi,n),Ne(this,kr,h),this.maxEntrySize=p||N(this,kr),this.sizeCalculation=m,this.sizeCalculation){if(!N(this,kr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(g!==void 0&&typeof g!="function")throw new TypeError("memoMethod must be a function if defined");if(Ne(this,dl,g),C!==void 0&&typeof C!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ne(this,ul,C),Ne(this,Gs,!!C),Ne(this,Kt,new Map),Ne(this,St,new Array(n).fill(void 0)),Ne(this,Fe,new Array(n).fill(void 0)),Ne(this,jn,new P(n)),Ne(this,Er,new P(n)),Ne(this,On,0),Ne(this,dn,0),Ne(this,mi,u0.create(n)),Ne(this,en,0),Ne(this,gi,0),typeof l=="function"&&Ne(this,hi,l),typeof u=="function"?(Ne(this,pi,u),Ne(this,fn,[])):(Ne(this,pi,void 0),Ne(this,fn,void 0)),Ne(this,Ci,!!N(this,hi)),Ne(this,Zn,!!N(this,pi)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!v,this.allowStaleOnFetchRejection=!!k,this.allowStaleOnFetchAbort=!!A,this.ignoreFetchAbort=!!R,this.maxEntrySize!==0){if(N(this,kr)!==0&&!_s(N(this,kr)))throw new TypeError("maxSize must be a positive integer if specified");if(!_s(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");we(this,pe,LR).call(this)}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!S,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=_s(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!_s(this.ttl))throw new TypeError("ttl must be a positive integer if specified");we(this,pe,f0).call(this)}if(N(this,fi)===0&&this.ttl===0&&N(this,kr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!N(this,fi)&&!N(this,kr)){const w="LRU_CACHE_UNBOUNDED";sV(w)&&(OR.add(w),MR("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",w,wI))}}static unsafeExposeInternals(e){return{starts:N(e,yi),ttls:N(e,Tr),sizes:N(e,vi),keyMap:N(e,Kt),keyList:N(e,St),valList:N(e,Fe),next:N(e,jn),prev:N(e,Er),get head(){return N(e,On)},get tail(){return N(e,dn)},free:N(e,mi),isBackgroundFetch:n=>{var r;return we(r=e,pe,It).call(r,n)},backgroundFetch:(n,r,i,o)=>{var s;return we(s=e,pe,Ih).call(s,n,r,i,o)},moveToTail:n=>{var r;return we(r=e,pe,_u).call(r,n)},indexes:n=>{var r;return we(r=e,pe,Os).call(r,n)},rindexes:n=>{var r;return we(r=e,pe,Ms).call(r,n)},isStale:n=>{var r;return N(r=e,Rr).call(r,n)}}}get max(){return N(this,fi)}get maxSize(){return N(this,kr)}get calculatedSize(){return N(this,gi)}get size(){return N(this,en)}get fetchMethod(){return N(this,ul)}get memoMethod(){return N(this,dl)}get dispose(){return N(this,hi)}get disposeAfter(){return N(this,pi)}getRemainingTTL(e){return N(this,Kt).has(e)?1/0:0}*entries(){for(const e of we(this,pe,Os).call(this))N(this,Fe)[e]!==void 0&&N(this,St)[e]!==void 0&&!we(this,pe,It).call(this,N(this,Fe)[e])&&(yield[N(this,St)[e],N(this,Fe)[e]])}*rentries(){for(const e of we(this,pe,Ms).call(this))N(this,Fe)[e]!==void 0&&N(this,St)[e]!==void 0&&!we(this,pe,It).call(this,N(this,Fe)[e])&&(yield[N(this,St)[e],N(this,Fe)[e]])}*keys(){for(const e of we(this,pe,Os).call(this)){const n=N(this,St)[e];n!==void 0&&!we(this,pe,It).call(this,N(this,Fe)[e])&&(yield n)}}*rkeys(){for(const e of we(this,pe,Ms).call(this)){const n=N(this,St)[e];n!==void 0&&!we(this,pe,It).call(this,N(this,Fe)[e])&&(yield n)}}*values(){for(const e of we(this,pe,Os).call(this))N(this,Fe)[e]!==void 0&&!we(this,pe,It).call(this,N(this,Fe)[e])&&(yield N(this,Fe)[e])}*rvalues(){for(const e of we(this,pe,Ms).call(this))N(this,Fe)[e]!==void 0&&!we(this,pe,It).call(this,N(this,Fe)[e])&&(yield N(this,Fe)[e])}[(KA=Symbol.iterator,$A=Symbol.toStringTag,KA)](){return this.entries()}find(e,n={}){for(const r of we(this,pe,Os).call(this)){const i=N(this,Fe)[r],o=we(this,pe,It).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,N(this,St)[r],this))return this.get(N(this,St)[r],n)}}forEach(e,n=this){for(const r of we(this,pe,Os).call(this)){const i=N(this,Fe)[r],o=we(this,pe,It).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,St)[r],this)}}rforEach(e,n=this){for(const r of we(this,pe,Ms).call(this)){const i=N(this,Fe)[r],o=we(this,pe,It).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,St)[r],this)}}purgeStale(){let e=!1;for(const n of we(this,pe,Ms).call(this,{allowStale:!0}))N(this,Rr).call(this,n)&&(we(this,pe,Ds).call(this,N(this,St)[n],"expire"),e=!0);return e}info(e){const n=N(this,Kt).get(e);if(n===void 0)return;const r=N(this,Fe)[n],i=we(this,pe,It).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(N(this,Tr)&&N(this,yi)){const s=N(this,Tr)[n],a=N(this,yi)[n];if(s&&a){const c=s-(Ec.now()-a);o.ttl=c,o.start=Date.now()}}return N(this,vi)&&(o.size=N(this,vi)[n]),o}dump(){const e=[];for(const n of we(this,pe,Os).call(this,{allowStale:!0})){const r=N(this,St)[n],i=N(this,Fe)[n],o=we(this,pe,It).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const s={value:o};if(N(this,Tr)&&N(this,yi)){s.ttl=N(this,Tr)[n];const a=Ec.now()-N(this,yi)[n];s.start=Math.floor(Date.now()-a)}N(this,vi)&&(s.size=N(this,vi)[n]),e.unshift([r,s])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=Ec.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var f,h,p,m,C;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:c}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=N(this,Bd).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),we(this,pe,Ds).call(this,e,"set"),this;let d=N(this,en)===0?void 0:N(this,Kt).get(e);if(d===void 0)d=N(this,en)===0?N(this,dn):N(this,mi).length!==0?N(this,mi).pop():N(this,en)===N(this,fi)?we(this,pe,Ch).call(this,!1):N(this,en),N(this,St)[d]=e,N(this,Fe)[d]=n,N(this,Kt).set(e,d),N(this,jn)[N(this,dn)]=d,N(this,Er)[d]=N(this,dn),Ne(this,dn,d),hf(this,en)._++,N(this,fl).call(this,d,u,c),c&&(c.set="add"),l=!1;else{we(this,pe,_u).call(this,d);const g=N(this,Fe)[d];if(n!==g){if(N(this,Gs)&&we(this,pe,It).call(this,g)){g.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=g;v!==void 0&&!s&&(N(this,Ci)&&((f=N(this,hi))==null||f.call(this,v,e,"set")),N(this,Zn)&&((h=N(this,fn))==null||h.push([v,e,"set"])))}else s||(N(this,Ci)&&((p=N(this,hi))==null||p.call(this,g,e,"set")),N(this,Zn)&&((m=N(this,fn))==null||m.push([g,e,"set"])));if(N(this,Za).call(this,d),N(this,fl).call(this,d,u,c),N(this,Fe)[d]=n,c){c.set="replace";const v=g&&we(this,pe,It).call(this,g)?g.__staleWhileFetching:g;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update")}if(i!==0&&!N(this,Tr)&&we(this,pe,f0).call(this),N(this,Tr)&&(l||N(this,Fd).call(this,d,i,o),c&&N(this,_o).call(this,c,d)),!s&&N(this,Zn)&&N(this,fn)){const g=N(this,fn);let v;for(;v=g==null?void 0:g.shift();)(C=N(this,pi))==null||C.call(this,...v)}return this}pop(){var e;try{for(;N(this,en);){const n=N(this,Fe)[N(this,On)];if(we(this,pe,Ch).call(this,!0),we(this,pe,It).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(N(this,Zn)&&N(this,fn)){const n=N(this,fn);let r;for(;r=n==null?void 0:n.shift();)(e=N(this,pi))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,o=N(this,Kt).get(e);if(o!==void 0){const s=N(this,Fe)[o];if(we(this,pe,It).call(this,s)&&s.__staleWhileFetching===void 0)return!1;if(N(this,Rr).call(this,o))i&&(i.has="stale",N(this,_o).call(this,i,o));else return r&&N(this,ja).call(this,o),i&&(i.has="hit",N(this,_o).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=N(this,Kt).get(e);if(i===void 0||!r&&N(this,Rr).call(this,i))return;const o=N(this,Fe)[i];return we(this,pe,It).call(this,o)?o.__staleWhileFetching:o}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:m,forceRefresh:C=!1,status:g,signal:v}=n;if(!N(this,Gs))return g&&(g.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:g});const S={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:g,signal:v};let k=N(this,Kt).get(e);if(k===void 0){g&&(g.fetch="miss");const A=we(this,pe,Ih).call(this,e,k,S,m);return A.__returned=A}else{const A=N(this,Fe)[k];if(we(this,pe,It).call(this,A)){const O=r&&A.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",O&&(g.returnedStale=!0)),O?A.__staleWhileFetching:A.__returned=A}const R=N(this,Rr).call(this,k);if(!C&&!R)return g&&(g.fetch="hit"),we(this,pe,_u).call(this,k),i&&N(this,ja).call(this,k),g&&N(this,_o).call(this,g,k),A;const P=we(this,pe,Ih).call(this,e,k,S,m),_=P.__staleWhileFetching!==void 0&&r;return g&&(g.fetch=R?"stale":"refresh",_&&R&&(g.returnedStale=!0)),_?P.__staleWhileFetching:P.__returned=P}}async forceFetch(e,n={}){const r=await this.fetch(e,n);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,n={}){const r=N(this,dl);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...s}=n,a=this.get(e,s);if(!o&&a!==void 0)return a;const c=r(e,a,{options:s,context:i});return this.set(e,c,s),c}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=n,a=N(this,Kt).get(e);if(a!==void 0){const c=N(this,Fe)[a],l=we(this,pe,It).call(this,c);return s&&N(this,_o).call(this,s,a),N(this,Rr).call(this,a)?(s&&(s.get="stale"),l?(s&&r&&c.__staleWhileFetching!==void 0&&(s.returnedStale=!0),r?c.__staleWhileFetching:void 0):(o||we(this,pe,Ds).call(this,e,"expire"),s&&r&&(s.returnedStale=!0),r?c:void 0)):(s&&(s.get="hit"),l?c.__staleWhileFetching:(we(this,pe,_u).call(this,a),i&&N(this,ja).call(this,a),c))}else s&&(s.get="miss")}delete(e){return we(this,pe,Ds).call(this,e,"delete")}clear(){return we(this,pe,g0).call(this,"delete")}};fi=new WeakMap,kr=new WeakMap,hi=new WeakMap,pi=new WeakMap,ul=new WeakMap,dl=new WeakMap,en=new WeakMap,gi=new WeakMap,Kt=new WeakMap,St=new WeakMap,Fe=new WeakMap,jn=new WeakMap,Er=new WeakMap,On=new WeakMap,dn=new WeakMap,mi=new WeakMap,fn=new WeakMap,vi=new WeakMap,yi=new WeakMap,Tr=new WeakMap,Ci=new WeakMap,Gs=new WeakMap,Zn=new WeakMap,pe=new WeakSet,f0=function(){const e=new yh(N(this,fi)),n=new yh(N(this,fi));Ne(this,Tr,e),Ne(this,yi,n),Ne(this,Fd,(o,s,a=Ec.now())=>{if(n[o]=s!==0?a:0,e[o]=s,s!==0&&this.ttlAutopurge){const c=setTimeout(()=>{N(this,Rr).call(this,o)&&we(this,pe,Ds).call(this,N(this,St)[o],"expire")},s+1);c.unref&&c.unref()}}),Ne(this,ja,o=>{n[o]=e[o]!==0?Ec.now():0}),Ne(this,_o,(o,s)=>{if(e[s]){const a=e[s],c=n[s];if(!a||!c)return;o.ttl=a,o.start=c,o.now=r||i();const l=o.now-c;o.remainingTTL=a-l}});let r=0;const i=()=>{const o=Ec.now();if(this.ttlResolution>0){r=o;const s=setTimeout(()=>r=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{const s=N(this,Kt).get(o);if(s===void 0)return 0;const a=e[s],c=n[s];if(!a||!c)return 1/0;const l=(r||i())-c;return a-l},Ne(this,Rr,o=>{const s=n[o],a=e[o];return!!a&&!!s&&(r||i())-s>a})},ja=new WeakMap,_o=new WeakMap,Fd=new WeakMap,Rr=new WeakMap,LR=function(){const e=new yh(N(this,fi));Ne(this,gi,0),Ne(this,vi,e),Ne(this,Za,n=>{Ne(this,gi,N(this,gi)-e[n]),e[n]=0}),Ne(this,Bd,(n,r,i,o)=>{if(we(this,pe,It).call(this,r))return 0;if(!_s(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,n),!_s(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Ne(this,fl,(n,r,i)=>{if(e[n]=r,N(this,kr)){const o=N(this,kr)-e[n];for(;N(this,gi)>o;)we(this,pe,Ch).call(this,!0)}Ne(this,gi,N(this,gi)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=N(this,gi))})},Za=new WeakMap,fl=new WeakMap,Bd=new WeakMap,Os=function*({allowStale:e=this.allowStale}={}){if(N(this,en))for(let n=N(this,dn);!(!we(this,pe,h0).call(this,n)||((e||!N(this,Rr).call(this,n))&&(yield n),n===N(this,On)));)n=N(this,Er)[n]},Ms=function*({allowStale:e=this.allowStale}={}){if(N(this,en))for(let n=N(this,On);!(!we(this,pe,h0).call(this,n)||((e||!N(this,Rr).call(this,n))&&(yield n),n===N(this,dn)));)n=N(this,jn)[n]},h0=function(e){return e!==void 0&&N(this,Kt).get(N(this,St)[e])===e},Ch=function(e){var o,s;const n=N(this,On),r=N(this,St)[n],i=N(this,Fe)[n];return N(this,Gs)&&we(this,pe,It).call(this,i)?i.__abortController.abort(new Error("evicted")):(N(this,Ci)||N(this,Zn))&&(N(this,Ci)&&((o=N(this,hi))==null||o.call(this,i,r,"evict")),N(this,Zn)&&((s=N(this,fn))==null||s.push([i,r,"evict"]))),N(this,Za).call(this,n),e&&(N(this,St)[n]=void 0,N(this,Fe)[n]=void 0,N(this,mi).push(n)),N(this,en)===1?(Ne(this,On,Ne(this,dn,0)),N(this,mi).length=0):Ne(this,On,N(this,jn)[n]),N(this,Kt).delete(r),hf(this,en)._--,n},Ih=function(e,n,r,i){const o=n===void 0?void 0:N(this,Fe)[n];if(we(this,pe,It).call(this,o))return o;const s=new bp,{signal:a}=r;a==null||a.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});const c={signal:s.signal,options:r,context:i},l=(m,C=!1)=>{const{aborted:g}=s.signal,v=r.ignoreFetchAbort&&m!==void 0;if(r.status&&(g&&!C?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,v&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),g&&!v&&!C)return d(s.signal.reason);const S=h;return N(this,Fe)[n]===h&&(m===void 0?S.__staleWhileFetching?N(this,Fe)[n]=S.__staleWhileFetching:we(this,pe,Ds).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,m,c.options))),m},u=m=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=m),d(m)),d=m=>{const{aborted:C}=s.signal,g=C&&r.allowStaleOnFetchAbort,v=g||r.allowStaleOnFetchRejection,S=v||r.noDeleteOnFetchRejection,k=h;if(N(this,Fe)[n]===h&&(!S||k.__staleWhileFetching===void 0?we(this,pe,Ds).call(this,e,"fetch"):g||(N(this,Fe)[n]=k.__staleWhileFetching)),v)return r.status&&k.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),k.__staleWhileFetching;if(k.__returned===k)throw m},f=(m,C)=>{var v;const g=(v=N(this,ul))==null?void 0:v.call(this,e,o,c);g&&g instanceof Promise&&g.then(S=>m(S===void 0?void 0:S),C),s.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(m(void 0),r.allowStaleOnFetchAbort&&(m=S=>l(S,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(l,u),p=Object.assign(h,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return n===void 0?(this.set(e,p,{...c.options,status:void 0}),n=N(this,Kt).get(e)):N(this,Fe)[n]=p,p},It=function(e){if(!N(this,Gs))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof bp},p0=function(e,n){N(this,Er)[n]=e,N(this,jn)[e]=n},_u=function(e){e!==N(this,dn)&&(e===N(this,On)?Ne(this,On,N(this,jn)[e]):we(this,pe,p0).call(this,N(this,Er)[e],N(this,jn)[e]),we(this,pe,p0).call(this,N(this,dn),e),Ne(this,dn,e))},Ds=function(e,n){var i,o,s,a;let r=!1;if(N(this,en)!==0){const c=N(this,Kt).get(e);if(c!==void 0)if(r=!0,N(this,en)===1)we(this,pe,g0).call(this,n);else{N(this,Za).call(this,c);const l=N(this,Fe)[c];if(we(this,pe,It).call(this,l)?l.__abortController.abort(new Error("deleted")):(N(this,Ci)||N(this,Zn))&&(N(this,Ci)&&((i=N(this,hi))==null||i.call(this,l,e,n)),N(this,Zn)&&((o=N(this,fn))==null||o.push([l,e,n]))),N(this,Kt).delete(e),N(this,St)[c]=void 0,N(this,Fe)[c]=void 0,c===N(this,dn))Ne(this,dn,N(this,Er)[c]);else if(c===N(this,On))Ne(this,On,N(this,jn)[c]);else{const u=N(this,Er)[c];N(this,jn)[u]=N(this,jn)[c];const d=N(this,jn)[c];N(this,Er)[d]=N(this,Er)[c]}hf(this,en)._--,N(this,mi).push(c)}}if(N(this,Zn)&&((s=N(this,fn))!=null&&s.length)){const c=N(this,fn);let l;for(;l=c==null?void 0:c.shift();)(a=N(this,pi))==null||a.call(this,...l)}return r},g0=function(e){var n,r,i;for(const o of we(this,pe,Ms).call(this,{allowStale:!0})){const s=N(this,Fe)[o];if(we(this,pe,It).call(this,s))s.__abortController.abort(new Error("deleted"));else{const a=N(this,St)[o];N(this,Ci)&&((n=N(this,hi))==null||n.call(this,s,a,e)),N(this,Zn)&&((r=N(this,fn))==null||r.push([s,a,e]))}}if(N(this,Kt).clear(),N(this,Fe).fill(void 0),N(this,St).fill(void 0),N(this,Tr)&&N(this,yi)&&(N(this,Tr).fill(0),N(this,yi).fill(0)),N(this,vi)&&N(this,vi).fill(0),Ne(this,On,0),Ne(this,dn,0),N(this,mi).length=0,Ne(this,gi,0),Ne(this,en,0),N(this,Zn)&&N(this,fn)){const o=N(this,fn);let s;for(;s=o==null?void 0:o.shift();)(i=N(this,pi))==null||i.call(this,...s)}};let d0=wI;function aV(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(e[3]);){const a=s[1]||s[3],c=s[2]||s[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=c}return{name:n,authKey:r,keyvals:i}}function kw(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],o=e[3],s={};return s[i]=o,{name:n,authKey:r,keyvals:s}}function m0(){return(Math.random()+1).toString(36).substring(3,9)}class Wl{constructor(e){V(this,"packageName");V(this,"minVersion",1);V(this,"maxVersion",1);V(this,"packageVersion",0);V(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class cV extends Wl{constructor(){super(...arguments);V(this,"packageName","mcp-negotiate");V(this,"minVersion",2);V(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(n=i.minVersion)==null?void 0:n.toFixed(1),s=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":s})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class lV extends Wl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class uV extends Wl{constructor(n){super(n);V(this,"packageName","dns-org-mud-moo-simpleedit");V(this,"sessions",{});V(this,"clientId");this.clientId=m0()}handle(n){if(n.name==="dns-org-mud-moo-simpleedit-content"){const r={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]};this.sessions[n.keyvals["_data-tag"]]=r}else console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){"content"in n.keyvals?this.sessions[n.name].contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.client.openEditorWindow(this.sessions[n.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class dV extends Wl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-getset");V(this,"id",1);V(this,"cache",new d0({max:10}));V(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class fV extends Wl{constructor(){super(...arguments);V(this,"packageName","dns-com-vmoo-userlist");V(this,"maxVersion",1.1);V(this,"player");V(this,"fields",["Object","Name","Icon"]);V(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);V(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=ci(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=ci(n.keyvals.icons.trim())),"d"in n.keyvals){const o=n.keyvals.d[0];switch(o){case"=":var r=ci(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(ci(n.keyvals.d.slice(1))));break;case"-":var i=ci(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const s=this.playerFromArray(ci(n.keyvals.d.slice(1)));this.updatePlayer(s);break;case"<":i=ci(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!0,this.players[c]=a)});break;case">":i=ci(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!1,this.players[c]=a)});break;case"[":i=ci(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!0,this.players[c]=a)});break;case"]":i=ci(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!1,this.players[c]=a)});break;default:console.log(`Unknown userlist mode ${o} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function ci(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let o=0;o<t.length;o++){const s=t[o];if(s==="{")r++;else if(s==="}")r--;else if(s===","&&r===0){i(),n="";continue}n+=s}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(ci(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class hV extends Wl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-ping");V(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}var v0=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(v0||{}),ms=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(ms||{});class pV{constructor(){V(this,"state");V(this,"listeners",new Set);V(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const qc=new pV;class gV extends TT{constructor(n,r){super();V(this,"ws");V(this,"decoder",new TextDecoder("utf8"));V(this,"telnet");V(this,"host");V(this,"port");V(this,"telnetNegotiation",!1);V(this,"telnetBuffer","");V(this,"gmcpHandlers",{});V(this,"mcpHandlers",{});V(this,"mcpMultilines",{});V(this,"mcpAuthKey",null);V(this,"mcp_negotiate");V(this,"mcp_getset");V(this,"gmcp_char");V(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});V(this,"cacophony");V(this,"sendCommand",n=>{qc.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)});this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(cV),this.mcp_getset=this.registerMcpPackage(dV),this.gmcp_char=this.registerGMCPPackage(XF),this.cacophony=new Y4}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new WF(new GF(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===Nu.WILL&&r===Pu.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Nu.DO,Pu.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===Nu.DO&&r===Pu.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Nu.WILL,Pu.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r);try{this.handleGmcpData(n,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=kw(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=kw(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=aV(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=m0(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),o=n.substring(0,i),s=n.substring(i+1);console.log("GMCP Message:",o,s,r);const a=this.gmcpHandlers[o];if(!a){console.log("No handler for GMCP package:",o);return}const c=a["handle"+s];c?(console.log("Calling handler:",c),c.call(a,JSON.parse(r))):console.log("No handler on package:",o,s)}emitMessage(n){const r=qc.getState().speech.autoreadMode;r===v0.All&&this.speak(n),r===v0.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let o="";for(const[s,a]of Object.entries(r))o+=` ${s}: ${a||'""'}`;r=o}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}openEditorWindow(n){console.log(n);const r=new BroadcastChannel("editor"),i=n.reference,o=encodeURIComponent(i),s=window.open(`/editor?reference=${o}`,"_blank");r.onmessage=a=>{console.log("editor window message",a),a.data.id===i&&(a.data.type==="ready"?(console.log("sending editor window session",n),r.postMessage({type:"load",session:n})):a.data.type==="save"?(console.log("saving editor window with session",a.data.session),this.saveEditorWindow(a.data.session)):a.data.type==="close"&&(console.log("closing editor window"),r.close(),r.onmessage=null))},s&&s.focus()}saveEditorWindow(n){const r={reference:n.reference,type:n.type};r["content*"]="",this.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",r,n.contents)}sendMCPMultiline(n,r,i){const o=m0();r["_data-tag"]=o,this.sendMcp(n,r);for(const s of i)this.sendMcpMLLine(o,"content",s);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()})}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(HF(n));r.lang="en-US";const{rate:i,pitch:o,voice:s,volume:a}=qc.getState().speech;r.rate=i,r.pitch=o,r.volume=a;const l=speechSynthesis.getVoices().find(u=>u.name===s);l&&(r.voice=l),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class mV{constructor(){V(this,"history",[]);V(this,"currentIndex",0);V(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&(this.history.push(e.trim()),this.currentIndex=this.history.length),this.unsentInput=""}navigateUp(e){return this.currentIndex===this.history.length&&(this.unsentInput=e),this.history.length>0&&this.currentIndex>0&&this.currentIndex--,this.history.length>0?this.history[Math.max(0,this.currentIndex)]:""}navigateDown(e){return this.currentIndex===this.history.length&&(this.unsentInput=e),this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=this.history.length,this.unsentInput)}getCurrentInput(){return this.currentIndex>=this.history.length?this.unsentInput:this.history[this.currentIndex]}}const vV=({onSend:t,inputRef:e})=>{const[n,r]=b.useState(""),i=b.useRef(new mV),o=s=>{const a=i.current;if(s.key==="Enter"&&!s.shiftKey)s.preventDefault(),t(n),a.addCommand(n),r("");else if(s.key==="ArrowUp"){s.preventDefault();const c=a.navigateUp(n);r(c)}else if(s.key==="ArrowDown"){s.preventDefault();const c=a.navigateDown(n);r(c)}};return K.jsx("textarea",{value:n,onChange:s=>r(s.target.value),onKeyDown:o,id:"command-input",ref:e,autoFocus:!0})},yV="631533b34df127c1dc68879cc21c28a4d09058dd",Ss=()=>{const[,t]=b.useReducer(e=>e+1,0);return b.useEffect(()=>qc.subscribe(t),[]),[qc.getState(),qc.dispatch]},CV=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},IV=({tabs:t})=>{const[e,n]=b.useState(0),r=b.useRef([]);return b.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),b.useEffect(()=>{const i=s=>{switch(s.key){case"ArrowLeft":n(a=>a>0?a-1:t.length-1);break;case"ArrowRight":n(a=>a<t.length-1?a+1:0);break}},o=r.current[e];return o==null||o.addEventListener("keydown",i),()=>{o==null||o.removeEventListener("keydown",i)}},[t.length,e]),b.useEffect(()=>{var i;(i=r.current[e])==null||i.focus()},[e]),K.jsxs("div",{children:[K.jsx("div",{role:"tablist","aria-label":"Tabs",children:t.map((i,o)=>K.jsx("button",{ref:s=>r.current[o]=s,role:"tab","aria-selected":e===o,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(o),tabIndex:e===o?void 0:-1,children:i.label},o))}),t.map((i,o)=>K.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:e!==o,tabIndex:e===o?0:-1,children:i.content},o))]})},SV=()=>{const[t,e]=Ss();return K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:ms.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},bV=()=>{const[t,e]=Ss();return K.jsxs("label",{children:["Auto Read:",K.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:ms.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[K.jsx("option",{value:"off",children:"Off"}),K.jsx("option",{value:"unfocused",children:"Unfocused"}),K.jsx("option",{value:"all",children:"Always"})]})]})},wV=()=>{const[t,e]=Ss(),n=CV();return K.jsxs("label",{children:["Voice:",K.jsx("select",{value:t.speech.voice,onChange:r=>e({type:ms.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>K.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},AV=()=>{const[t,e]=Ss();return K.jsxs("label",{children:["Rate (0.1 - 10.0):",K.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:ms.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},kV=()=>{const[t,e]=Ss();return K.jsxs("label",{children:["Pitch (0 - 2):",K.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:ms.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},EV=()=>{const[t,e]=Ss();return K.jsxs("label",{children:["Volume (0 - 1):",K.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:ms.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},TV=()=>{const[t]=Ss(),[e,n]=b.useState(!1),r=()=>{n(!0),console.log("Preview button clicked");const i=()=>{const o=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),s=speechSynthesis.getVoices();console.log("Available voices:",s.map(c=>c.name));const a=s.find(c=>c.name===t.speech.voice);console.log("Selected voice:",a?a.name:"Not found"),o.voice=a||null,o.rate=t.speech.rate,o.pitch=t.speech.pitch,o.volume=t.speech.volume,console.log("Utterance settings:",{voice:o.voice?o.voice.name:"Default",rate:o.rate,pitch:o.pitch,volume:o.volume}),o.onend=()=>{console.log("Speech ended"),n(!1)},o.onerror=c=>{console.error("Speech synthesis error:",c),n(!1)},speechSynthesis.cancel(),speechSynthesis.speak(o),console.log("Speech started")};speechSynthesis.getVoices().length>0?i():speechSynthesis.onvoiceschanged=()=>{speechSynthesis.onvoiceschanged=null,i()}};return ct.useEffect(()=>()=>{speechSynthesis.cancel()},[]),K.jsx("button",{onClick:r,disabled:e,children:e?"Playing...":"Preview Voice"})},RV=()=>K.jsxs("div",{children:[K.jsx(bV,{}),K.jsx("br",{}),K.jsx(wV,{}),K.jsx("br",{}),K.jsx(AV,{}),K.jsx("br",{}),K.jsx(kV,{}),K.jsx("br",{}),K.jsx(EV,{}),K.jsx("br",{}),K.jsx(TV,{})]}),xV=()=>{const[t,e]=Ss(),n=t.editor,r=o=>{e({type:ms.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:ms.SetEditorAccessibilityMode,data:o.target.checked})};return K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),K.jsx("br",{}),K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),K.jsx("br",{})]})},PV=()=>{const t=[{label:"General",content:K.jsx(SV,{})},{label:"Speech",content:K.jsx(RV,{})},{label:"Editor",content:K.jsx(xV,{})}];return K.jsx(IV,{tabs:t})};function NV(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}function kd(){return kd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kd.apply(null,arguments)}var y0="data-focus-lock",FR="data-focus-lock-disabled",_V="data-no-focus-lock",OV="data-autofocus-inside",MV="data-no-autofocus";function Cm(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function DV(t,e){var n=b.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var LV=typeof window<"u"?b.useLayoutEffect:b.useEffect,Ew=new WeakMap;function FV(t,e){var n=DV(null,function(r){return t.forEach(function(i){return Cm(i,r)})});return LV(function(){var r=Ew.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||Cm(a,null)}),o.forEach(function(a){i.has(a)||Cm(a,s)})}Ew.set(n,t)},[t]),n}var Im={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},C0=function(t,e){return C0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},C0(t,e)};function jl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");C0(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var I0=function(){return I0=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I0.apply(this,arguments)};function BV(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function BR(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function wl(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function S0(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function b0(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function el(t){return this instanceof el?(this.v=t,this):new el(t)}function UV(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){r[h]&&(i[h]=function(m){return new Promise(function(C,g){o.push([h,m,C,g])>1||c(h,m)})},p&&(i[h]=p(i[h])))}function c(h,p){try{l(r[h](p))}catch(m){f(o[0][3],m)}}function l(h){h.value instanceof el?Promise.resolve(h.value.v).then(u,d):f(o[0][2],h)}function u(h){c("next",h)}function d(h){c("throw",h)}function f(h,p){h(p),o.shift(),o.length&&c(o[0][0],o[0][1])}}function VV(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof wl=="function"?wl(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,c){s=t[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}function UR(t){return t}function VR(t,e){e===void 0&&(e=UR);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var c=function(){var u=s;s=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){s.push(u),l()},filter:function(u){return s=s.filter(u),n}}}};return i}function BC(t,e){return e===void 0&&(e=UR),VR(t,e)}function GV(t){t===void 0&&(t={});var e=VR(null);return e.options=I0({async:!0,ssr:!1},t),e}var GR=BC({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),WR=BC(),WV=BC(),jV=GV({async:!0,ssr:typeof document<"u"}),ZV=b.createContext(void 0),HV=[],UC=b.forwardRef(function(e,n){var r,i=b.useState(),o=i[0],s=i[1],a=b.useRef(),c=b.useRef(!1),l=b.useRef(null),u=b.useState({}),d=u[1],f=e.children,h=e.disabled,p=h===void 0?!1:h,m=e.noFocusGuards,C=m===void 0?!1:m,g=e.persistentFocus,v=g===void 0?!1:g,S=e.crossFrame,k=S===void 0?!0:S,A=e.autoFocus,R=A===void 0?!0:A;e.allowTextSelection;var P=e.group,w=e.className,_=e.whiteList,O=e.hasPositiveIndices,L=e.shards,U=L===void 0?HV:L,X=e.as,H=X===void 0?"div":X,J=e.lockProps,te=J===void 0?{}:J,le=e.sideCar,$=e.returnFocus,z=$===void 0?!1:$,se=e.focusOptions,j=e.onActivation,oe=e.onDeactivation,Ce=b.useState({}),Be=Ce[0],fe=b.useCallback(function(Ie){var We=Ie.captureFocusRestore;if(!l.current){var Le,Me=(Le=document)==null?void 0:Le.activeElement;l.current=Me,Me!==document.body&&(l.current=We(Me))}a.current&&j&&j(a.current),c.current=!0,d()},[j]),Pe=b.useCallback(function(){c.current=!1,oe&&oe(a.current),d()},[oe]),Xe=b.useCallback(function(Ie){var We=l.current;if(We){var Le=(typeof We=="function"?We():We)||document.body,Me=typeof z=="function"?z(Le):z;if(Me){var et=typeof Me=="object"?Me:void 0;l.current=null,Ie?Promise.resolve().then(function(){return Le.focus(et)}):Le.focus(et)}}},[z]),me=b.useCallback(function(Ie){c.current&&GR.useMedium(Ie)},[]),Qt=WR.useMedium,zt=b.useCallback(function(Ie){a.current!==Ie&&(a.current=Ie,s(Ie))},[]),Vn=kd((r={},r[FR]=p&&"disabled",r[y0]=P,r),te),Vt=C!==!0,Pn=Vt&&C!=="tail",qe=FV([n,zt]),de=b.useMemo(function(){return{observed:a,shards:U,enabled:!p,active:c.current}},[p,c.current,U,o]);return b.createElement(b.Fragment,null,Vt&&[b.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:p?-1:0,style:Im}),O?b.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:p?-1:1,style:Im}):null],!p&&b.createElement(le,{id:Be,sideCar:jV,observed:o,disabled:p,persistentFocus:v,crossFrame:k,autoFocus:R,whiteList:_,shards:U,onActivation:fe,onDeactivation:Pe,returnFocus:Xe,focusOptions:se,noFocusGuards:C}),b.createElement(H,kd({ref:qe},Vn,{className:w,onBlur:Qt,onFocus:me}),b.createElement(ZV.Provider,{value:de},f)),Pn&&b.createElement("div",{"data-focus-guard":!0,tabIndex:p?-1:0,style:Im}))});UC.propTypes={};function w0(t,e){return w0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},w0(t,e)}function zV(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,w0(t,e)}function Ed(t){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed(t)}function XV(t,e){if(Ed(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ed(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $V(t){var e=XV(t,"string");return Ed(e)=="symbol"?e:e+""}function KV(t,e,n){return(e=$V(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JV(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var o=[],s;function a(){s=t(o.map(function(l){return l.props})),e(s)}var c=function(l){zV(u,l);function u(){return l.apply(this,arguments)||this}u.peek=function(){return s};var d=u.prototype;return d.componentDidMount=function(){o.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=o.indexOf(this);o.splice(h,1),a()},d.render=function(){return ct.createElement(i,this.props)},u}(b.PureComponent);return KV(c,"displayName","SideEffect("+n(i)+")"),c}}var wo=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},ic=function(t){return Array.isArray(t)?t:[t]},jR=function(t){return Array.isArray(t)?t[0]:t},YV=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},ZR=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},HR=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},QV=function(t){return t.hasAttribute("inert")},qV=function(t,e){return!t||HR(t)||!YV(t)&&!QV(t)&&e(ZR(t))},zR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=qV(e,zR.bind(void 0,t));return t.set(e,r),r},eG=function(t,e){return t&&!HR(t)?rG(t)?e(ZR(t)):!1:!0},XR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=eG(e,XR.bind(void 0,t));return t.set(e,r),r},$R=function(t){return t.dataset},tG=function(t){return t.tagName==="BUTTON"},KR=function(t){return t.tagName==="INPUT"},JR=function(t){return KR(t)&&t.type==="radio"},nG=function(t){return!((KR(t)||tG(t))&&(t.type==="hidden"||t.disabled))},rG=function(t){var e=t.getAttribute(MV);return![!0,"true",""].includes(e)},VC=function(t){var e;return!!(t&&(!((e=$R(t))===null||e===void 0)&&e.focusGuard))},A0=function(t){return!VC(t)},iG=function(t){return!!t},oG=function(t,e){var n=Math.max(0,t.tabIndex),r=Math.max(0,e.tabIndex),i=n-r,o=t.index-e.index;if(i){if(!n)return 1;if(!r)return-1}return i||o},sG=function(t){return t.tabIndex<0&&!t.hasAttribute("tabindex")?0:t.tabIndex},GC=function(t,e,n){return wo(t).map(function(r,i){var o=sG(r);return{node:r,index:i,tabIndex:n&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(oG)},aG=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],WC=aG.join(","),cG="".concat(WC,", [data-focus-guard]"),YR=function(t,e){return wo((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?cG:WC)?[r]:[],YR(r))},[])},lG=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?Al([t.contentDocument.body],e):[t]},Al=function(t,e){return t.reduce(function(n,r){var i,o=YR(r,e),s=(i=[]).concat.apply(i,o.map(function(a){return lG(a,e)}));return n.concat(s,r.parentNode?wo(r.parentNode.querySelectorAll(WC)).filter(function(a){return a===r}):[])},[])},uG=function(t){var e=t.querySelectorAll("[".concat(OV,"]"));return wo(e).map(function(n){return Al([n])}).reduce(function(n,r){return n.concat(r)},[])},jC=function(t,e){return wo(t).filter(function(n){return zR(e,n)}).filter(function(n){return nG(n)})},Tw=function(t,e){return e===void 0&&(e=new Map),wo(t).filter(function(n){return XR(e,n)})},ZC=function(t,e,n){return GC(jC(Al(t,n),e),!0,n)},Td=function(t,e){return GC(jC(Al(t),e),!1)},dG=function(t,e){return jC(uG(t),e)},$a=function(t,e){return t.shadowRoot?$a(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:wo(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?$a(i,e):!1}return $a(n,e)})},fG=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=t[r].compareDocumentPosition(t[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(s,a){return!e.has(a)})},QR=function(t){return t.parentNode?QR(t.parentNode):t},HC=function(t){var e=ic(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(y0);return n.push.apply(n,i?fG(wo(QR(r).querySelectorAll("[".concat(y0,'="').concat(i,'"]:not([').concat(FR,'="disabled"])')))):[r]),n},[])},hG=function(t){try{return t()}catch{return}},Rd=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?Rd(e.shadowRoot):e instanceof HTMLIFrameElement&&hG(function(){return e.contentWindow.document})?Rd(e.contentWindow.document):e}},pG=function(t,e){return t===e},gG=function(t,e){return!!wo(t.querySelectorAll("iframe")).some(function(n){return pG(n,e)})},qR=function(t,e){return e===void 0&&(e=Rd(jR(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:HC(t).some(function(n){return $a(n,e)||gG(n,e)})},mG=function(t){t===void 0&&(t=document);var e=Rd(t);return e?wo(t.querySelectorAll("[".concat(_V,"]"))).some(function(n){return $a(n,e)}):!1},vG=function(t,e){return e.filter(JR).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},zC=function(t,e){return JR(t)&&t.name?vG(t,e):t},yG=function(t){var e=new Set;return t.forEach(function(n){return e.add(zC(n,t))}),t.filter(function(n){return e.has(n)})},Rw=function(t){return t[0]&&t.length>1?zC(t[0],t):t[0]},xw=function(t,e){return t.indexOf(zC(e,t))},k0="NEW_FOCUS",CG=function(t,e,n,r,i){var o=t.length,s=t[0],a=t[o-1],c=VC(r);if(!(r&&t.indexOf(r)>=0)){var l=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):l,d=i?t.indexOf(i):-1;if(l===-1)return d!==-1?d:k0;if(d===-1)return k0;var f=l-u,h=n.indexOf(s),p=n.indexOf(a),m=yG(n),C=r!==void 0?m.indexOf(r):-1,g=C-(i?m.indexOf(i):l);if(!f&&d>=0||e.length===0)return d;var v=xw(t,e[0]),S=xw(t,e[e.length-1]);if(l<=h&&c&&Math.abs(f)>1)return S;if(l>=p&&c&&Math.abs(f)>1)return v;if(f&&Math.abs(g)>1)return d;if(l<=h)return S;if(l>p)return v;if(f)return Math.abs(f)>1?d:(o+d+f)%o}},IG=function(t){return function(e){var n,r=(n=$R(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},Pw=function(t,e,n){var r=t.map(function(o){var s=o.node;return s}),i=Tw(r.filter(IG(n)));return i&&i.length?Rw(i):Rw(Tw(e))},E0=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&E0(t.parentNode.host||t.parentNode,e),e},Sm=function(t,e){for(var n=E0(t),r=E0(e),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},ex=function(t,e,n){var r=ic(t),i=ic(e),o=r[0],s=!1;return i.filter(Boolean).forEach(function(a){s=Sm(s||a,a)||s,n.filter(Boolean).forEach(function(c){var l=Sm(o,c);l&&(!s||$a(l,s)?s=l:s=Sm(l,s))})}),s},Nw=function(t,e){return t.reduce(function(n,r){return n.concat(dG(r,e))},[])},SG=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(iG)},bG=function(t,e){var n=Rd(ic(t).length>0?document:jR(t).ownerDocument),r=HC(t).filter(A0),i=ex(n||t,t,r),o=new Map,s=Td(r,o),a=s.filter(function(p){var m=p.node;return A0(m)});if(a[0]){var c=Td([i],o).map(function(p){var m=p.node;return m}),l=SG(c,a),u=l.map(function(p){var m=p.node;return m}),d=l.filter(function(p){var m=p.tabIndex;return m>=0}).map(function(p){var m=p.node;return m}),f=CG(u,d,c,n,e);if(f===k0){var h=Pw(s,d,Nw(r,o))||Pw(s,u,Nw(r,o));if(h)return{node:h};console.warn("focus-lock: cannot find any node to move focus into");return}return f===void 0?f:l[f]}},wG=function(t){var e=HC(t).filter(A0),n=ex(t,t,e),r=GC(Al([n],!0),!0,!0),i=Al(e,!1);return r.map(function(o){var s=o.node,a=o.index;return{node:s,index:a,lockItem:i.indexOf(s)>=0,guard:VC(s)}})},XC=function(t,e){t&&("focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus())},bm=0,wm=!1,tx=function(t,e,n){n===void 0&&(n={});var r=bG(t,e);if(!wm&&r){if(bm>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),wm=!0,setTimeout(function(){wm=!1},1);return}bm++,XC(r.node,n.focusOptions),bm--}};function pu(t){if(!t)return null;if(typeof WeakRef>"u")return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(e==null?void 0:e.deref())||null}}var AG=function(t){if(!t)return null;for(var e=[],n=t;n&&n!==document.body;)e.push({current:pu(n),parent:pu(n.parentElement),left:pu(n.previousElementSibling),right:pu(n.nextElementSibling)}),n=n.parentElement;return{element:pu(t),stack:e,ownerDocument:t.ownerDocument}},kG=function(t){var e,n,r,i,o;if(t)for(var s=t.stack,a=t.ownerDocument,c=new Map,l=0,u=s;l<u.length;l++){var d=u[l],f=(e=d.parent)===null||e===void 0?void 0:e.call(d);if(f&&a.contains(f)){for(var h=(n=d.left)===null||n===void 0?void 0:n.call(d),p=d.current(),m=f.contains(p)?p:void 0,C=(r=d.right)===null||r===void 0?void 0:r.call(d),g=ZC([f],c),v=(o=(i=m??(h==null?void 0:h.nextElementSibling))!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:h;v;){for(var S=0,k=g;S<k.length;S++){var A=k[S];if(v!=null&&v.contains(A.node))return A.node}v=v.nextElementSibling}if(g.length)return g[0].node}}},nx=function(t){var e=AG(t);return function(){return kG(e)}},EG=function(t,e,n){if(!t||!e)return console.error("no element or scope given"),{};var r=ic(e);if(r.every(function(s){return!$a(s,t)}))return console.error("Active element is not contained in the scope"),{};var i=n?ZC(r,new Map):Td(r,new Map),o=i.findIndex(function(s){var a=s.node;return a===t});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},TG=function(t,e){var n=e?ZC(ic(t),new Map):Td(ic(t),new Map);return{first:n[0],last:n[n.length-1]}},RG=function(t){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},t)},rx=function(t,e,n){e===void 0&&(e={});var r=RG(e),i=EG(t,r.scope,r.onlyTabbable);if(i){var o=n(i,r.cycle);o&&XC(o.node,r.focusOptions)}},xG=function(t,e){e===void 0&&(e={}),rx(t,e,function(n,r){var i=n.next,o=n.first;return i||r&&o})},PG=function(t,e){e===void 0&&(e={}),rx(t,e,function(n,r){var i=n.prev,o=n.last;return i||r&&o})},ix=function(t,e,n){var r,i=TG(t,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[n];o&&XC(o.node,e.focusOptions)},NG=function(t,e){e===void 0&&(e={}),ix(t,e,"first")},_G=function(t,e){e===void 0&&(e={}),ix(t,e,"last")};function $C(t){setTimeout(t,1)}var OG=function(e){return e&&"current"in e?e.current:e},ox=function(){return document&&document.activeElement===document.body},MG=function(){return ox()||mG()},tl=null,Ar=null,_w=function(){return null},nl=null,xd=!1,KC=!1,DG=function(){return!0},LG=function(e){return(tl.whiteList||DG)(e)},FG=function(e,n){nl={observerNode:e,portaledElement:n}},BG=function(e){return nl&&nl.portaledElement===e};function Ow(t,e,n,r){var i=null,o=t;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else if(s.lockItem){if(o!==t)return;i=null}else break}while((o+=n)!==e);i&&(i.node.tabIndex=0)}var UG=function(e){return e?!!xd:xd==="meanwhile"},VG=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},GG=function(e,n){return n.some(function(r){return VG(e,r,r)})},sx=function(e){return Td(e,new Map)},WG=function(e){return!sx([e.parentNode]).some(function(n){return n.node===e})},wp=function(){var e=!1;if(tl){var n=tl,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,c=n.focusOptions,l=n.noFocusGuards,u=r||nl&&nl.portaledElement;if(ox()&&Ar&&(!document.body.contains(Ar)||WG(Ar))){Ar=null;var d=_w();d&&d.focus()}var f=document&&document.activeElement;if(u){var h=[u].concat(s.map(OG).filter(Boolean)),p=function(){if(!UG(a)||!l||!Ar||KC)return!1;var S=sx(h),k=S.findIndex(function(A){var R=A.node;return R===Ar});return k===0||k===S.length-1};if((!f||LG(f))&&(i||p()||!MG()||!Ar&&o)&&(u&&!(qR(h)||f&&GG(f,h)||BG(f))&&(document&&!Ar&&f&&!o?(f.blur&&f.blur(),document.body.focus()):(e=tx(h,Ar,{focusOptions:c}),nl={})),xd=!1,Ar=document&&document.activeElement,_w=nx(Ar)),document&&f!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var m=document&&document.activeElement,C=wG(h),g=C.map(function(v){var S=v.node;return S}).indexOf(m);g>-1&&(C.filter(function(v){var S=v.guard,k=v.node;return S&&k.dataset.focusAutoGuard}).forEach(function(v){var S=v.node;return S.removeAttribute("tabIndex")}),Ow(g,C.length,1,C),Ow(g,-1,-1,C))}}}return e},ax=function(e){wp()&&e&&(e.stopPropagation(),e.preventDefault())},JC=function(){return $C(wp)},jG=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||FG(r,n)},ZG=function(){return null},cx=function(){KC=!0},lx=function(){KC=!1,xd="just",$C(function(){xd="meanwhile"})},HG=function(){document.addEventListener("focusin",ax),document.addEventListener("focusout",JC),window.addEventListener("focus",cx),window.addEventListener("blur",lx)},zG=function(){document.removeEventListener("focusin",ax),document.removeEventListener("focusout",JC),window.removeEventListener("focus",cx),window.removeEventListener("blur",lx)};function XG(t){return t.filter(function(e){var n=e.disabled;return!n})}var ux={moveFocusInside:tx,focusInside:qR,focusNextElement:xG,focusPrevElement:PG,focusFirstElement:NG,focusLastElement:_G,captureFocusRestore:nx};function $G(t){var e=t.slice(-1)[0];e&&!tl&&HG();var n=tl,r=n&&e&&e.id===n.id;tl=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var o=i.id;return o===n.id}).length||n.returnFocus(!e)),e?(Ar=null,(!r||n.observed!==e.observed)&&e.onActivation(ux),wp(),$C(wp)):(zG(),Ar=null)}GR.assignSyncMedium(jG);WR.assignMedium(JC);WV.assignMedium(function(t){return t(ux)});const KG=JV(XG,$G)(ZG);var dx=b.forwardRef(function(e,n){return b.createElement(UC,kd({sideCar:KG,ref:n},e))}),fx=UC.propTypes||{};fx.sideCar;NV(fx,["sideCar"]);dx.propTypes={};const JG=ct.forwardRef((t,e)=>{const[n,r]=b.useState(!1),i=b.useRef(null);return ct.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),b.useEffect(()=>{var o;n&&((o=i.current)==null||o.focus())},[n]),b.useEffect(()=>{const o=s=>{s.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),K.jsx(dx,{disabled:!n,children:K.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[K.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&K.jsx(PV,{}),K.jsx("button",{onClick:()=>r(!1),children:"Close"}),K.jsx("br",{}),K.jsxs("span",{id:"commit-hash",children:["Version: ",yV]})]})})});var hx={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Mw=ct.createContext&&ct.createContext(hx),YG=["attr","size","title"];function QG(t,e){if(t==null)return{};var n=qG(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function qG(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Ap(){return Ap=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ap.apply(this,arguments)}function Dw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function kp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Dw(Object(n),!0).forEach(function(r){eW(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dw(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function eW(t,e,n){return e=tW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tW(t){var e=nW(t,"string");return typeof e=="symbol"?e:e+""}function nW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function px(t){return t&&t.map((e,n)=>ct.createElement(e.tag,kp({key:n},e.attr),px(e.child)))}function mc(t){return e=>ct.createElement(rW,Ap({attr:kp({},t.attr)},e),px(t.child))}function rW(t){var e=n=>{var{attr:r,size:i,title:o}=t,s=QG(t,YG),a=i||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),ct.createElement("svg",Ap({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:c,style:kp(kp({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&ct.createElement("title",null,o),t.children)};return Mw!==void 0?ct.createElement(Mw.Consumer,null,n=>e(n)):e(hx)}function iW(t){return mc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(t)}function oW(t){return mc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function sW(t){return mc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(t)}function gx(t){return mc({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function aW(t){return mc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(t)}function cW(t){return mc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(t)}function lW(t){return mc({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}const uW=({client:t,onClearLog:e,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[o,s]=ct.useState(t.cacophony.muted);return K.jsxs("div",{className:"toolbar",children:[K.jsxs("button",{onClick:n,accessKey:"l",children:[K.jsx(gx,{}),"Save Log"]}),K.jsxs("button",{onClick:e,accessKey:"c",children:[K.jsx(sW,{}),"Clear Log"]}),K.jsxs("button",{onClick:i,accessKey:"p",children:[K.jsx(iW,{}),"Preferences"]}),K.jsxs("button",{onClick:()=>{s(!o),t.cacophony.muted=!o},accessKey:"m",children:[o?K.jsx(lW,{}):K.jsx(cW,{}),o?"Unmute":"Mute"]}),K.jsxs("label",{children:["Volume",K.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]}),K.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"}),K.jsxs("label",{children:["Volume",K.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]})]})};class dW extends ct.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return K.jsx("div",{className:"statusbar",children:this.state.statusText})}}const fW=({users:t})=>K.jsxs("div",{className:"sidebar",children:[K.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),K.jsx("div",{className:"sidebar-content",children:K.jsx("ul",{children:t.map(e=>{let n="";return e.away&&(n+=" away"),e.idle&&(n+=" idle"),K.jsx("li",{className:n,children:e.Name},e.Object)})})})]});var Lw={};function hW(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var pW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gW(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var mx={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(pW,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(m,C){var g=m[C];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?s:console[m]!==void 0?o(console,m):console.log!==void 0?o(console,"log"):e}function c(m,C){for(var g=0;g<i.length;g++){var v=i[g];this[v]=g<m?e:this.methodFactory(v,m,C)}this.log=this.debug}function l(m,C,g){return function(){typeof console!==n&&(c.call(this,C,g),this[m].apply(this,arguments))}}function u(m,C,g){return a(m)||l.apply(this,arguments)}function d(m,C,g){var v=this,S;C=C??"WARN";var k="loglevel";typeof m=="string"?k+=":"+m:typeof m=="symbol"&&(k=void 0);function A(_){var O=(i[_]||"silent").toUpperCase();if(!(typeof window===n||!k)){try{window.localStorage[k]=O;return}catch{}try{window.document.cookie=encodeURIComponent(k)+"="+O+";"}catch{}}}function R(){var _;if(!(typeof window===n||!k)){try{_=window.localStorage[k]}catch{}if(typeof _===n)try{var O=window.document.cookie,L=O.indexOf(encodeURIComponent(k)+"=");L!==-1&&(_=/^([^;]+)/.exec(O.slice(L))[1])}catch{}return v.levels[_]===void 0&&(_=void 0),_}}function P(){if(!(typeof window===n||!k)){try{window.localStorage.removeItem(k);return}catch{}try{window.document.cookie=encodeURIComponent(k)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=m,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=g||u,v.getLevel=function(){return S},v.setLevel=function(_,O){if(typeof _=="string"&&v.levels[_.toUpperCase()]!==void 0&&(_=v.levels[_.toUpperCase()]),typeof _=="number"&&_>=0&&_<=v.levels.SILENT){if(S=_,O!==!1&&A(_),c.call(v,_,m),typeof console===n&&_<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+_},v.setDefaultLevel=function(_){C=_,R()||v.setLevel(_,!1)},v.resetLevel=function(){v.setLevel(C,!1),P()},v.enableAll=function(_){v.setLevel(v.levels.TRACE,_)},v.disableAll=function(_){v.setLevel(v.levels.SILENT,_)};var w=R();w==null&&(w=C),v.setLevel(w,!1)}var f=new d,h={};f.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var g=h[C];return g||(g=h[C]=new d(C,f.getLevel(),f.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(mx);var YC=mx.exports,T0;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(T0||(T0={}));var vo;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(vo||(vo={}));let Je=YC.getLogger("livekit");Je.setDefaultLevel(T0.info);function vs(t){const e=YC.getLogger(t);return e.setDefaultLevel(Je.getLevel()),e}YC.getLogger("lk-e2ee");function dr(t,e){if(!t)throw new Error(e)}const mW=34028234663852886e22,vW=-34028234663852886e22,yW=4294967295,CW=2147483647,IW=-2147483648;function Sh(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>CW||t<IW)throw new Error("invalid int 32: "+t)}function R0(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>yW||t<0)throw new Error("invalid uint 32: "+t)}function vx(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>mW||t<vW))throw new Error("invalid float 32: "+t)}const yx=Symbol("@bufbuild/protobuf/enum-type");function SW(t){const e=t[yx];return dr(e,"missing enum type on enum object"),e}function Cx(t,e,n,r){t[yx]=Ix(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function Ix(t,e,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of e){const a=Sx(s);o.push(a),r[s.name]=a,i[s.no]=a}return{typeName:t,values:o,findName(s){return r[s]},findNumber(s){return i[s]}}}function bW(t,e,n){const r={};for(const i of e){const o=Sx(i);r[o.localName]=o.no,r[o.no]=o.localName}return Cx(r,t,e),r}function Sx(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class be{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(n);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(n);return i.readMessage(r,e,o,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function wW(t,e,n,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),s={[o]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new be),Object.assign(s,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new s().fromBinary(a,c)},fromJson(a,c){return new s().fromJson(a,c)},fromJsonString(a,c){return new s().fromJsonString(a,c)},equals(a,c){return t.util.equals(s,a,c)}}),s}function AW(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,o,s){return wW(this,i,o,s)},makeEnum:bW,makeEnumType:Ix,getEnumType:SW}}var ne;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(ne||(ne={}));var oc;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(oc||(oc={}));function kW(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Am(t,e,n){for(let o=0;o<28;o=o+7){const s=t>>>o,a=!(!(s>>>7)&&e==0),c=(a?s|128:s)&255;if(n.push(c),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const s=e>>>o,a=!!(s>>>7),c=(a?s|128:s)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const bh=4294967296;function Fw(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function o(s,a){const c=Number(t.slice(s,a));i*=n,r=r*n+c,r>=bh&&(i=i+(r/bh|0),r=r%bh)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?wx(r,i):QC(r,i)}function EW(t,e){let n=QC(t,e);const r=n.hi&2147483648;r&&(n=wx(n.lo,n.hi));const i=bx(n.lo,n.hi);return r?"-"+i:i}function bx(t,e){if({lo:t,hi:e}=TW(t,e),e<=2097151)return String(bh*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let o=n+r*6777216+i*6710656,s=r+i*8147497,a=i*2;const c=1e7;return o>=c&&(s+=Math.floor(o/c),o%=c),s>=c&&(a+=Math.floor(s/c),s%=c),a.toString()+Bw(s)+Bw(o)}function TW(t,e){return{lo:t>>>0,hi:e>>>0}}function QC(t,e){return{lo:t|0,hi:e|0}}function wx(t,e){return e=~e,t?t=~t+1:e+=1,QC(t,e)}const Bw=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Uw(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function RW(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function xW(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof Lw!="object"||Lw.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>o||l<i)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<s)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}const n=i=>dr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>dr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Fw(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Fw(i)},dec(i,o){return EW(i,o)},uDec(i,o){return bx(i,o)}}}const Ve=xW();var Wt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Wt||(Wt={}));class PW{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(R0(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Sh(e),Uw(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){vx(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){R0(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Sh(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Sh(e),e=(e<<1^e>>31)>>>0,Uw(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ve.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ve.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=Ve.enc(e);return Am(n.lo,n.hi,this.buf),this}sint64(e){let n=Ve.enc(e),r=n.hi>>31,i=n.lo<<1^r,o=(n.hi<<1|n.lo>>>31)^r;return Am(i,o,this.buf),this}uint64(e){let n=Ve.uEnc(e);return Am(n.lo,n.hi,this.buf),this}}class NW{constructor(e,n){this.varint64=kW,this.uint32=RW,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case Wt.Varint:for(;this.buf[this.pos++]&128;);break;case Wt.Bit64:this.pos+=4;case Wt.Bit32:this.pos+=4;break;case Wt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Wt.StartGroup:let i;for(;(i=this.tag()[1])!==Wt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ve.dec(...this.varint64())}uint64(){return Ve.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,Ve.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ve.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ve.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function x0(t,e){return e instanceof be||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}ne.DOUBLE,ne.FLOAT,ne.INT64,ne.UINT64,ne.INT32,ne.UINT32,ne.BOOL,ne.STRING,ne.BYTES;function Rs(t,e,n){if(e===n)return!0;if(t==ne.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return e==n}return!1}function P0(t,e){switch(t){case ne.BOOL:return!1;case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return e==0?Ve.zero:"0";case ne.DOUBLE:case ne.FLOAT:return 0;case ne.BYTES:return new Uint8Array(0);case ne.STRING:return"";default:return 0}}function Ax(t,e){const n=e===void 0;let r=Wt.Varint,i=e===0;switch(t){case ne.STRING:i=n||!e.length,r=Wt.LengthDelimited;break;case ne.BOOL:i=e===!1;break;case ne.DOUBLE:r=Wt.Bit64;break;case ne.FLOAT:r=Wt.Bit32;break;case ne.INT64:i=n||e==0;break;case ne.UINT64:i=n||e==0;break;case ne.FIXED64:i=n||e==0,r=Wt.Bit64;break;case ne.BYTES:i=n||!e.byteLength,r=Wt.LengthDelimited;break;case ne.FIXED32:r=Wt.Bit32;break;case ne.SFIXED32:r=Wt.Bit32;break;case ne.SFIXED64:i=n||e==0,r=Wt.Bit64;break;case ne.SINT64:i=n||e==0;break}const o=ne[t].toLowerCase();return[r,o,n||i]}const Tc=Symbol("@bufbuild/protobuf/unknown-fields"),Vw={readUnknownFields:!0,readerFactory:t=>new NW(t)},Gw={writeUnknownFields:!0,writerFactory:()=>new PW};function _W(t){return t?Object.assign(Object.assign({},Vw),t):Vw}function OW(t){return t?Object.assign(Object.assign({},Gw),t):Gw}function MW(){return{makeReadOptions:_W,makeWriteOptions:OW,listUnknownFields(t){var e;return(e=t[Tc])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Tc]},writeUnknownFields(t,e){const r=t[Tc];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[Tc])||(i[Tc]=[]),i[Tc].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),o=n===void 0?e.len:e.pos+n;for(;e.pos<o;){const[s,a]=e.tag(),c=i.fields.find(s);if(!c){const f=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,s,a,f);continue}let l=t,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":const f=c.kind=="enum"?ne.INT32:c.T;let h=Ep;if(c.kind=="scalar"&&c.L>0&&(h=LW),u){let g=l[d];if(a==Wt.LengthDelimited&&f!=ne.STRING&&f!=ne.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)g.push(h(e,f))}else g.push(h(e,f))}else l[d]=h(e,f);break;case"message":const p=c.T;u?l[d].push(wh(e,new p,r)):l[d]instanceof be?wh(e,l[d],r):(l[d]=wh(e,new p,r),p.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=p.fieldWrapper.unwrapField(l[d])));break;case"map":let[m,C]=DW(c,e,r);l[d][m]=C;break}}}}}function wh(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function DW(t,e,n){const r=e.uint32(),i=e.pos+r;let o,s;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:o=Ep(e,t.K);break;case 2:switch(t.V.kind){case"scalar":s=Ep(e,t.V.T);break;case"enum":s=e.int32();break;case"message":s=wh(e,new t.V.T,n);break}break}}if(o===void 0){let a=P0(t.K,oc.BIGINT);o=t.K==ne.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(t.V.kind){case"scalar":s=P0(t.V.T,oc.BIGINT);break;case"enum":s=0;break;case"message":s=new t.V.T;break}return[o,s]}function LW(t,e){const n=Ep(t,e);return typeof n=="bigint"?n.toString():n}function Ep(t,e){switch(e){case ne.STRING:return t.string();case ne.BOOL:return t.bool();case ne.DOUBLE:return t.double();case ne.FLOAT:return t.float();case ne.INT32:return t.int32();case ne.INT64:return t.int64();case ne.UINT64:return t.uint64();case ne.FIXED64:return t.fixed64();case ne.BYTES:return t.bytes();case ne.FIXED32:return t.fixed32();case ne.SFIXED32:return t.sfixed32();case ne.SFIXED64:return t.sfixed64();case ne.SINT64:return t.sint64();case ne.UINT32:return t.uint32();case ne.SINT32:return t.sint32()}}function FW(t,e,n,r,i){t.tag(n.no,Wt.LengthDelimited),t.fork();let o=r;switch(n.K){case ne.INT32:case ne.FIXED32:case ne.UINT32:case ne.SFIXED32:case ne.SINT32:o=Number.parseInt(r);break;case ne.BOOL:dr(r=="true"||r=="false"),o=r=="true";break}switch($u(t,n.K,1,o,!0),n.V.kind){case"scalar":$u(t,n.V.T,2,i,!0);break;case"enum":$u(t,ne.INT32,2,i,!0);break;case"message":N0(t,e,n.V.T,2,i);break}t.join()}function N0(t,e,n,r,i){if(i!==void 0){const o=x0(n,i);t.tag(r,Wt.LengthDelimited).bytes(o.toBinary(e))}}function $u(t,e,n,r,i){let[o,s,a]=Ax(e,r);(!a||i)&&t.tag(n,o)[s](r)}function BW(t,e,n,r){if(!r.length)return;t.tag(n,Wt.LengthDelimited).fork();let[,i]=Ax(e);for(let o=0;o<r.length;o++)t[i](r[o]);t.join()}function UW(){return Object.assign(Object.assign({},MW()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let o,s=i.repeated,a=i.localName;if(i.oneof){const c=t[i.oneof.localName];if(c.case!==a)continue;o=c.value}else o=t[a];switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?ne.INT32:i.T;if(s)if(i.packed)BW(e,c,i.no,o);else for(const l of o)$u(e,c,i.no,l,!0);else o!==void 0&&$u(e,c,i.no,o,!!i.oneof||i.opt);break;case"message":if(s)for(const l of o)N0(e,n,i.T,i.no,l);else N0(e,n,i.T,i.no,o);break;case"map":for(const[l,u]of Object.entries(o))FW(e,n,i,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let Oo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),fg=[];for(let t=0;t<Oo.length;t++)fg[Oo[t].charCodeAt(0)]=t;fg[45]=Oo.indexOf("+");fg[95]=Oo.indexOf("/");const kx={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,o,s=0;for(let a=0;a<t.length;a++){if(o=fg[t.charCodeAt(a)],o===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:n[r++]=s<<2|(o&48)>>4,s=o,i=2;break;case 2:n[r++]=(s&15)<<4|(o&60)>>2,s=o,i=3;break;case 3:n[r++]=(s&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let o=0;o<t.length;o++)switch(r=t[o],n){case 0:e+=Oo[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=Oo[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=Oo[i|r>>6],e+=Oo[r&63],n=0;break}return n&&(e+=Oo[i],e+="=",n==1&&(e+="=")),e}},Ww={ignoreUnknownFields:!1},jw={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function VW(t){return t?Object.assign(Object.assign({},Ww),t):Ww}function GW(t){return t?Object.assign(Object.assign({},jw),t):jw}function WW(t){const e=t(jW,Zw);return{makeReadOptions:VW,makeWriteOptions:GW,readMessage(n,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));o=o??new n;const s={};for(const[a,c]of Object.entries(r)){const l=n.fields.findJsonName(a);if(!l){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=l.localName,d=o;if(l.oneof){if(c===null&&l.kind=="scalar")continue;const f=s[l.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));s[l.oneof.localName]=a,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const h of c){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h)));let p;switch(l.kind){case"message":p=l.T.fromJson(h,i);break;case"enum":if(p=km(l.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=gu(l.T,h,l.L)}catch(m){let C="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h));throw m instanceof Error&&m.message.length>0&&(C+=": ".concat(m.message)),new Error(C)}break}f.push(p)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const[h,p]of Object.entries(c)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: map value null"));let m;switch(l.V.kind){case"message":m=l.V.T.fromJson(p,i);break;case"enum":if(m=km(l.V.T,p,i.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=gu(l.V.T,p,oc.BIGINT)}catch(C){let g="cannot decode map value for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw C instanceof Error&&C.message.length>0&&(g+=": ".concat(C.message)),new Error(g)}break}try{f[gu(l.K,l.K==ne.BOOL?h=="true"?!0:h=="false"?!1:h:h,oc.BIGINT).toString()]=m}catch(C){let g="cannot decode map key for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw C instanceof Error&&C.message.length>0&&(g+=": ".concat(C.message)),new Error(g)}}}else switch(l.kind){case"message":const f=l.T;if(c===null&&f.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof be?d[u].fromJson(c,i):(d[u]=f.fromJson(c,i),f.fieldWrapper&&!l.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=km(l.T,c,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=gu(l.T,c,l.L)}catch(p){let m="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw p instanceof Error&&p.message.length>0&&(m+=": ".concat(p.message)),new Error(m)}break}}return o},writeMessage(n,r){const i=n.getType(),o={};let s;try{for(const a of i.fields.byMember()){let c;if(a.kind=="oneof"){const l=n[a.localName];if(l.value===void 0)continue;if(s=a.findField(l.case),!s)throw"oneof case not found: "+l.case;c=e(s,l.value,r)}else s=a,c=e(s,n[s.localName],r);c!==void 0&&(o[r.useProtoFieldName?s.name:s.jsonName]=c)}}catch(a){const c=s?"cannot encode field ".concat(i.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),l=a instanceof Error?a.message:String(a);throw new Error(c+(l.length>0?": ".concat(l):""))}return o},readScalar:gu,writeScalar:Zw,debug:Ex}}function Ex(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function gu(t,e,n){switch(t){case ne.DOUBLE:case ne.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==ne.FLOAT&&vx(r),r;case ne.INT32:case ne.FIXED32:case ne.SFIXED32:case ne.SINT32:case ne.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==ne.UINT32?R0(i):Sh(i),i;case ne.INT64:case ne.SFIXED64:case ne.SINT64:if(e===null)return Ve.zero;if(typeof e!="number"&&typeof e!="string")break;const o=Ve.parse(e);return n?o.toString():o;case ne.FIXED64:case ne.UINT64:if(e===null)return Ve.zero;if(typeof e!="number"&&typeof e!="string")break;const s=Ve.uParse(e);return n?s.toString():s;case ne.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case ne.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case ne.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return kx.dec(e)}throw new Error}function km(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(Ex(e)))}function jW(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const o=t.findNumber(e);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:e}function Zw(t,e,n){if(e!==void 0)switch(t){case ne.INT32:case ne.SFIXED32:case ne.SINT32:case ne.FIXED32:case ne.UINT32:return dr(typeof e=="number"),e!=0||n?e:void 0;case ne.FLOAT:case ne.DOUBLE:return dr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case ne.STRING:return dr(typeof e=="string"),e.length>0||n?e:void 0;case ne.BOOL:return dr(typeof e=="boolean"),e||n?e:void 0;case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return dr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case ne.BYTES:return dr(e instanceof Uint8Array),n||e.byteLength>0?kx.enc(e):void 0}}function ZW(){return WW((t,e)=>function(r,i,o){if(r.kind=="map"){const s={};switch(r.V.kind){case"scalar":for(const[c,l]of Object.entries(i)){const u=e(r.V.T,l,!0);dr(u!==void 0),s[c.toString()]=u}break;case"message":for(const[c,l]of Object.entries(i))s[c.toString()]=l.toJson(o);break;case"enum":const a=r.V.T;for(const[c,l]of Object.entries(i)){dr(l===void 0||typeof l=="number");const u=t(a,l,!0,o.enumAsInteger);dr(u!==void 0),s[c.toString()]=u}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(r.repeated){const s=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)s.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)s.push(t(r.T,i[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)s.push(x0(r.T,i[a]).toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?x0(r.T,i).toJson(o):void 0}})}function HW(){return{setEnumType:Cx,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,o=e,s=t;if(s[i]!==void 0)switch(r.kind){case"oneof":const a=s[i].case;if(a===void 0)continue;const c=r.findField(a);let l=s[i].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===ne.BYTES&&(l=mu(l)),o[i]={case:a,value:l};break;case"scalar":case"enum":let u=s[i];r.T===ne.BYTES&&(u=r.repeated?u.map(mu):mu(u)),o[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===ne.BYTES)for(const[h,p]of Object.entries(s[i]))o[i][h]=mu(p);else Object.assign(o[i],s[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(s[i])){let p=s[i][h];f.fieldWrapper||(p=new f(p)),o[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)o[i]=s[i].map(f=>f instanceof d?f:new d(f));else if(s[i]!==void 0){const f=s[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?o[i]=mu(f):o[i]=f:o[i]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],o=n[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((s,a)=>r.T.equals(s,o[a]));case"scalar":return i.every((s,a)=>Rs(r.T,s,o[a]));case"enum":return i.every((s,a)=>Rs(ne.INT32,s,o[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return Rs(ne.INT32,i,o);case"scalar":return Rs(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const s=r.findField(i.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(i.value,o.value);case"enum":return Rs(ne.INT32,i.value,o.value);case"scalar":return Rs(s.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const a=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const c=r.V.T;return a.every(u=>c.equals(i[u],o[u]));case"enum":return a.every(u=>Rs(ne.INT32,i[u],o[u]));case"scalar":const l=r.V.T;return a.every(u=>Rs(l,i[u],o[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const o=t[i.localName];let s;if(i.repeated)s=o.map(Gf);else if(i.kind=="map"){s=r[i.localName];for(const[a,c]of Object.entries(o))s[a]=Gf(c)}else i.kind=="oneof"?s=i.findField(o.case)?{case:o.case,value:Gf(o.value)}:{case:void 0}:s=Gf(o);r[i.localName]=s}return n}}}function Gf(t){if(t===void 0)return t;if(t instanceof be)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function mu(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class zW{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function Tx(t,e){const n=Rx(t);return e?n:QW(YW(n))}function XW(t){return Tx(t,!1)}const $W=Rx;function Rx(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const KW=new Set(["constructor","toString","toJSON","valueOf"]),JW=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),xx=t=>"".concat(t,"$"),YW=t=>JW.has(t)?xx(t):t,QW=t=>KW.has(t)?xx(t):t;class qW{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=XW(e)}addField(e){dr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const T=AW("proto3",ZW(),UW(),Object.assign(Object.assign({},HW()),{newFieldList(t){return new zW(t,e9)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=P0(e.T,e.L);break}}}}));function e9(t){var e,n,r,i;const o=[];let s;for(const a of typeof t=="function"?t():t){const c=a;if(c.localName=Tx(a.name,a.oneof!==void 0),c.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:$W(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(r=a.L)!==null&&r!==void 0?r:oc.BIGINT),c.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=ne.BYTES&&a.T!=ne.STRING,a.oneof!==void 0){const l=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=l)&&(s=new qW(l)),c.oneof=s,s.addField(c)}o.push(c)}return o}class pn extends be{constructor(e){super(),this.seconds=Ve.zero,this.nanos=0,T.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(T.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ve.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return pn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new pn({seconds:Ve.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new pn().fromBinary(e,n)}static fromJson(e,n){return new pn().fromJson(e,n)}static fromJsonString(e,n){return new pn().fromJsonString(e,n)}static equals(e,n){return T.util.equals(pn,e,n)}}pn.runtime=T;pn.typeName="google.protobuf.Timestamp";pn.fields=T.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var _0;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(_0||(_0={}));T.util.setEnumType(_0,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var O0;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(O0||(O0={}));T.util.setEnumType(O0,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var M0;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(M0||(M0={}));T.util.setEnumType(M0,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Dn;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Dn||(Dn={}));T.util.setEnumType(Dn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var jt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(jt||(jt={}));T.util.setEnumType(jt,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var an;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(an||(an={}));T.util.setEnumType(an,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var Lo;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(Lo||(Lo={}));T.util.setEnumType(Lo,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Li;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(Li||(Li={}));T.util.setEnumType(Li,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var cs;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(cs||(cs={}));T.util.setEnumType(cs,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var Po;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(Po||(Po={}));T.util.setEnumType(Po,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Pd;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Pd||(Pd={}));T.util.setEnumType(Pd,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Zl=class Ou extends be{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Ve.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,T.util.initPartial(e,this)}static fromBinary(e,n){return new Ou().fromBinary(e,n)}static fromJson(e,n){return new Ou().fromJson(e,n)}static fromJsonString(e,n){return new Ou().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ou,e,n)}};Zl.runtime=T;Zl.typeName="livekit.Room";Zl.fields=T.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ai,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class Ai extends be{constructor(e){super(),this.mime="",this.fmtpLine="",T.util.initPartial(e,this)}static fromBinary(e,n){return new Ai().fromBinary(e,n)}static fromJson(e,n){return new Ai().fromJson(e,n)}static fromJsonString(e,n){return new Ai().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ai,e,n)}}Ai.runtime=T;Ai.typeName="livekit.Codec";Ai.fields=T.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Xs extends be{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,T.util.initPartial(e,this)}static fromBinary(e,n){return new Xs().fromBinary(e,n)}static fromJson(e,n){return new Xs().fromJson(e,n)}static fromJsonString(e,n){return new Xs().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Xs,e,n)}}Xs.runtime=T;Xs.typeName="livekit.PlayoutDelay";Xs.fields=T.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class Fo extends be{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,T.util.initPartial(e,this)}static fromBinary(e,n){return new Fo().fromBinary(e,n)}static fromJson(e,n){return new Fo().fromJson(e,n)}static fromJsonString(e,n){return new Fo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Fo,e,n)}}Fo.runtime=T;Fo.typeName="livekit.ParticipantPermission";Fo.fields=T.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:T.getEnumType(jt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Fr extends be{constructor(e){super(),this.sid="",this.identity="",this.state=sc.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Ve.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,T.util.initPartial(e,this)}static fromBinary(e,n){return new Fr().fromBinary(e,n)}static fromJson(e,n){return new Fr().fromJson(e,n)}static fromJsonString(e,n){return new Fr().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Fr,e,n)}}Fr.runtime=T;Fr.typeName="livekit.ParticipantInfo";Fr.fields=T.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:T.getEnumType(sc)},{no:4,name:"tracks",kind:"message",T:hr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Fo},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var sc;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(sc||(sc={}));T.util.setEnumType(sc,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class $s extends be{constructor(e){super(),T.util.initPartial(e,this)}static fromBinary(e,n){return new $s().fromBinary(e,n)}static fromJson(e,n){return new $s().fromJson(e,n)}static fromJsonString(e,n){return new $s().fromJsonString(e,n)}static equals(e,n){return T.util.equals($s,e,n)}}$s.runtime=T;$s.typeName="livekit.Encryption";$s.fields=T.util.newFieldList(()=>[]);var Cn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(Cn||(Cn={}));T.util.setEnumType(Cn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Bo extends be{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Bo().fromBinary(e,n)}static fromJson(e,n){return new Bo().fromJson(e,n)}static fromJsonString(e,n){return new Bo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Bo,e,n)}}Bo.runtime=T;Bo.typeName="livekit.SimulcastCodecInfo";Bo.fields=T.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Yn,repeated:!0}]);class hr extends be{constructor(e){super(),this.sid="",this.type=Dn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=jt.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Cn.NONE,this.stream="",T.util.initPartial(e,this)}static fromBinary(e,n){return new hr().fromBinary(e,n)}static fromJson(e,n){return new hr().fromJson(e,n)}static fromJsonString(e,n){return new hr().fromJsonString(e,n)}static equals(e,n){return T.util.equals(hr,e,n)}}hr.runtime=T;hr.typeName="livekit.TrackInfo";hr.fields=T.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:T.getEnumType(Dn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:T.getEnumType(jt)},{no:10,name:"layers",kind:"message",T:Yn,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Bo,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:T.getEnumType(Cn)},{no:17,name:"stream",kind:"scalar",T:9}]);class Yn extends be{constructor(e){super(),this.quality=an.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,T.util.initPartial(e,this)}static fromBinary(e,n){return new Yn().fromBinary(e,n)}static fromJson(e,n){return new Yn().fromJson(e,n)}static fromJsonString(e,n){return new Yn().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Yn,e,n)}}Yn.runtime=T;Yn.typeName="livekit.VideoLayer";Yn.fields=T.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:T.getEnumType(an)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Ji extends be{constructor(e){super(),this.kind=nn.RELIABLE,this.value={case:void 0},T.util.initPartial(e,this)}static fromBinary(e,n){return new Ji().fromBinary(e,n)}static fromJson(e,n){return new Ji().fromJson(e,n)}static fromJsonString(e,n){return new Ji().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ji,e,n)}}Ji.runtime=T;Ji.typeName="livekit.DataPacket";Ji.fields=T.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:T.getEnumType(nn)},{no:2,name:"user",kind:"message",T:Qi,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Uo,oneof:"value"}]);var nn;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(nn||(nn={}));T.util.setEnumType(nn,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Uo extends be{constructor(e){super(),this.speakers=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Uo().fromBinary(e,n)}static fromJson(e,n){return new Uo().fromJson(e,n)}static fromJsonString(e,n){return new Uo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Uo,e,n)}}Uo.runtime=T;Uo.typeName="livekit.ActiveSpeakerUpdate";Uo.fields=T.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Yi,repeated:!0}]);class Yi extends be{constructor(e){super(),this.sid="",this.level=0,this.active=!1,T.util.initPartial(e,this)}static fromBinary(e,n){return new Yi().fromBinary(e,n)}static fromJson(e,n){return new Yi().fromJson(e,n)}static fromJsonString(e,n){return new Yi().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Yi,e,n)}}Yi.runtime=T;Yi.typeName="livekit.SpeakerInfo";Yi.fields=T.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class Qi extends be{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Qi().fromBinary(e,n)}static fromJson(e,n){return new Qi().fromJson(e,n)}static fromJsonString(e,n){return new Qi().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Qi,e,n)}}Qi.runtime=T;Qi.typeName="livekit.UserPacket";Qi.fields=T.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class qi extends be{constructor(e){super(),this.participantSid="",this.trackSids=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new qi().fromBinary(e,n)}static fromJson(e,n){return new qi().fromJson(e,n)}static fromJsonString(e,n){return new qi().fromJsonString(e,n)}static equals(e,n){return T.util.equals(qi,e,n)}}qi.runtime=T;qi.typeName="livekit.ParticipantTracks";qi.fields=T.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class Vo extends be{constructor(e){super(),this.edition=kl.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",T.util.initPartial(e,this)}static fromBinary(e,n){return new Vo().fromBinary(e,n)}static fromJson(e,n){return new Vo().fromJson(e,n)}static fromJsonString(e,n){return new Vo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Vo,e,n)}}Vo.runtime=T;Vo.typeName="livekit.ServerInfo";Vo.fields=T.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:T.getEnumType(kl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var kl;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(kl||(kl={}));T.util.setEnumType(kl,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Go extends be{constructor(e){super(),this.sdk=El.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",T.util.initPartial(e,this)}static fromBinary(e,n){return new Go().fromBinary(e,n)}static fromJson(e,n){return new Go().fromJson(e,n)}static fromJsonString(e,n){return new Go().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Go,e,n)}}Go.runtime=T;Go.typeName="livekit.ClientInfo";Go.fields=T.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:T.getEnumType(El)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var El;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(El||(El={}));T.util.setEnumType(El,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class eo extends be{constructor(e){super(),this.resumeConnection=Li.UNSET,this.forceRelay=Li.UNSET,T.util.initPartial(e,this)}static fromBinary(e,n){return new eo().fromBinary(e,n)}static fromJson(e,n){return new eo().fromJson(e,n)}static fromJsonString(e,n){return new eo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(eo,e,n)}}eo.runtime=T;eo.typeName="livekit.ClientConfiguration";eo.fields=T.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:to},{no:2,name:"screen",kind:"message",T:to},{no:3,name:"resume_connection",kind:"enum",T:T.getEnumType(Li)},{no:4,name:"disabled_codecs",kind:"message",T:Wo},{no:5,name:"force_relay",kind:"enum",T:T.getEnumType(Li)}]);class to extends be{constructor(e){super(),this.hardwareEncoder=Li.UNSET,T.util.initPartial(e,this)}static fromBinary(e,n){return new to().fromBinary(e,n)}static fromJson(e,n){return new to().fromJson(e,n)}static fromJsonString(e,n){return new to().fromJsonString(e,n)}static equals(e,n){return T.util.equals(to,e,n)}}to.runtime=T;to.typeName="livekit.VideoConfiguration";to.fields=T.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:T.getEnumType(Li)}]);class Wo extends be{constructor(e){super(),this.codecs=[],this.publish=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Wo().fromBinary(e,n)}static fromJson(e,n){return new Wo().fromJson(e,n)}static fromJsonString(e,n){return new Wo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Wo,e,n)}}Wo.runtime=T;Wo.typeName="livekit.DisabledCodecs";Wo.fields=T.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Ai,repeated:!0},{no:2,name:"publish",kind:"message",T:Ai,repeated:!0}]);class no extends be{constructor(e){super(),this.duration=0,this.startTimestamp=Ve.zero,this.endTimestamp=Ve.zero,this.rtpClockTicks=Ve.zero,this.driftSamples=Ve.zero,this.driftMs=0,this.clockRate=0,T.util.initPartial(e,this)}static fromBinary(e,n){return new no().fromBinary(e,n)}static fromJson(e,n){return new no().fromJson(e,n)}static fromJsonString(e,n){return new no().fromJsonString(e,n)}static equals(e,n){return T.util.equals(no,e,n)}}no.runtime=T;no.typeName="livekit.RTPDrift";no.fields=T.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:pn},{no:2,name:"end_time",kind:"message",T:pn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Ks extends be{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Ve.zero,this.headerBytes=Ve.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Ve.zero,this.headerBytesDuplicate=Ve.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Ve.zero,this.headerBytesPadding=Ve.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,T.util.initPartial(e,this)}static fromBinary(e,n){return new Ks().fromBinary(e,n)}static fromJson(e,n){return new Ks().fromJson(e,n)}static fromJsonString(e,n){return new Ks().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ks,e,n)}}Ks.runtime=T;Ks.typeName="livekit.RTPStats";Ks.fields=T.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:pn},{no:2,name:"end_time",kind:"message",T:pn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:pn},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:pn},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:pn},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:pn},{no:44,name:"packet_drift",kind:"message",T:no},{no:45,name:"report_drift",kind:"message",T:no}]);class Js extends be{constructor(e){super(),this.unixMicro=Ve.zero,this.ticks=0,T.util.initPartial(e,this)}static fromBinary(e,n){return new Js().fromBinary(e,n)}static fromJson(e,n){return new Js().fromJson(e,n)}static fromJsonString(e,n){return new Js().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Js,e,n)}}Js.runtime=T;Js.typeName="livekit.TimedVersion";Js.fields=T.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const vu=7e3,t9=[0,300,2*2*300,3*3*300,4*4*300,vu,vu,vu,vu,vu];class n9{constructor(e){this._retryDelays=e!==void 0?[...e]:t9}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function G(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(t,[])).next())})}function Hw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Hw=="function"?Hw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,c){s=t[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}var qC={exports:{}},rl=typeof Reflect=="object"?Reflect:null,zw=rl&&typeof rl.apply=="function"?rl.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Ah;rl&&typeof rl.ownKeys=="function"?Ah=rl.ownKeys:Object.getOwnPropertySymbols?Ah=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ah=function(e){return Object.getOwnPropertyNames(e)};function r9(t){console&&console.warn&&console.warn(t)}var Px=Number.isNaN||function(e){return e!==e};function ft(){ft.init.call(this)}qC.exports=ft;qC.exports.once=a9;ft.EventEmitter=ft;ft.prototype._events=void 0;ft.prototype._eventsCount=0;ft.prototype._maxListeners=void 0;var Xw=10;function hg(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ft,"defaultMaxListeners",{enumerable:!0,get:function(){return Xw},set:function(t){if(typeof t!="number"||t<0||Px(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Xw=t}});ft.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ft.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Px(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Nx(t){return t._maxListeners===void 0?ft.defaultMaxListeners:t._maxListeners}ft.prototype.getMaxListeners=function(){return Nx(this)};ft.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")zw(c,this,n);else for(var l=c.length,u=Lx(c,l),r=0;r<l;++r)zw(u[r],this,n);return!0};function _x(t,e,n,r){var i,o,s;if(hg(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),s===void 0)s=o[e]=n,++t._eventsCount;else if(typeof s=="function"?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=Nx(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,r9(a)}return t}ft.prototype.addListener=function(e,n){return _x(this,e,n,!1)};ft.prototype.on=ft.prototype.addListener;ft.prototype.prependListener=function(e,n){return _x(this,e,n,!0)};function i9(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ox(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=i9.bind(r);return i.listener=n,r.wrapFn=i,i}ft.prototype.once=function(e,n){return hg(n),this.on(e,Ox(this,e,n)),this};ft.prototype.prependOnceListener=function(e,n){return hg(n),this.prependListener(e,Ox(this,e,n)),this};ft.prototype.removeListener=function(e,n){var r,i,o,s,a;if(hg(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():o9(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};ft.prototype.off=ft.prototype.removeListener;ft.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function Mx(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?s9(i):Lx(i,i.length)}ft.prototype.listeners=function(e){return Mx(this,e,!0)};ft.prototype.rawListeners=function(e){return Mx(this,e,!1)};ft.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Dx.call(t,e)};ft.prototype.listenerCount=Dx;function Dx(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ft.prototype.eventNames=function(){return this._eventsCount>0?Ah(this._events):[]};function Lx(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function o9(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function s9(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function a9(t,e){return new Promise(function(n,r){function i(s){t.removeListener(e,o),r(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}Fx(t,e,o,{once:!0}),e!=="error"&&c9(t,i,{once:!0})})}function c9(t,e,n){typeof t.on=="function"&&Fx(t,"error",e,n)}function Fx(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Ao=qC.exports;let Bx=!0,Ux=!0;function kh(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function vc(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,a){if(s!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),i.apply(this,[s,c])};const o=r.removeEventListener;r.removeEventListener=function(s,a){if(s!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(a))return o.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(s){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),s&&this.addEventListener(e,this["_on"+e]=s)},enumerable:!0,configurable:!0})}function l9(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Bx=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function u9(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Ux=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Vx(){if(typeof window=="object"){if(Bx)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function eI(t,e){Ux&&console.warn(t+" is deprecated, please use "+e+" instead.")}function d9(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=kh(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=kh(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=kh(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function $w(t){return Object.prototype.toString.call(t)==="[object Object]"}function Gx(t){return $w(t)?Object.keys(t).reduce(function(e,n){const r=$w(t[n]),i=r?Gx(t[n]):t[n],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[n]:i})},{}):t}function D0(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?D0(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{D0(t,t.get(i),n)})}))}function Kw(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return t.forEach(s=>{s.type==="track"&&s.trackIdentifier===e.id&&o.push(s)}),o.forEach(s=>{t.forEach(a=>{a.type===r&&a.trackId===s.id&&D0(t,a,i)})}),i}const Jw=Vx;function Wx(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",l)]=u.ideal,c.optional.push(f),f={},f[d("max",l)]=u.ideal,c.optional.push(f)):(f[d("",l)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(f,l)]=u[f])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(m=>p.label.toLowerCase().includes(m)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=l.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),Jw("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return Jw("chrome: "+JSON.stringify(a)),c(a)},o=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(a,c,l){i(a,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(o(d))})})};if(n.getUserMedia=s.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(o(u))))}}}function f9(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const o=r.video&&r.video.width,s=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(r.video.mandatory.maxWidth=o),s&&(r.video.mandatory.maxHeight=s),t.navigator.mediaDevices.getUserMedia(r)})}}}function jx(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Zx(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):o={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.id):o={track:i};const s=new Event("track");s.track=i,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else vc(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Hx(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){o.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const a=this._senders.find(c=>c.track===s);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function zx(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const s=function(c){const l={};return c.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),l[f.id]=f}),l},a=function(c){return new Map(Object.keys(c).map(l=>[l,c[l]]))};if(arguments.length>=2){const c=function(l){i(a(s(l)))};return e.apply(this,[c,r])}return new Promise((c,l)=>{e.apply(this,[function(u){c(a(s(u)))},l])}).then(i,o)}}function Xx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>Kw(s,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),vc(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>Kw(o,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,o,s;return this.getSenders().forEach(a=>{a.track===r&&(i?s=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(o?s=!0:o=a),a.track===r)),s||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function $x(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[s.id]=[s].concat(c)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(s);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function Kx(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return $x(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(m=>m===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([u]);this._streams[d.id]=m,this._reverseStreams[m.id]=d,this.addStream(m)}return this.getSenders().find(m=>m.track===u)};function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function s(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const m=o(this,p);f[0].apply(null,[m])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>o(this,p))}};t.RTCPeerConnection.prototype[l]=d[l]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=s(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:o(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(m=>u.track===m)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function L0(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Jx(t,e){vc(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var Yw=Object.freeze({__proto__:null,fixNegotiationNeeded:Jx,shimAddTrackRemoveTrack:Kx,shimAddTrackRemoveTrackWithNative:$x,shimGetDisplayMedia:f9,shimGetSendersWithDtmf:Hx,shimGetStats:zx,shimGetUserMedia:Wx,shimMediaStream:jx,shimOnTrack:Zx,shimPeerConnection:L0,shimSenderReceiverGetStats:Xx});function Yx(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,o,s){eI("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(o,s)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(s,a,c){a in s&&!(c in s)&&(s[c]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function h9(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function Qx(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function F0(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=t.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=s[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,s,a]=arguments;return r.apply(this,[o||null]).then(c=>{if(e.version<53&&!s)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,d)=>{c.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(s,a)}}function qx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function eP(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),vc(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function tP(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){eI("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function nP(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function rP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:s}=o,a=s.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function iP(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function oP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function sP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Qw=Object.freeze({__proto__:null,shimAddTransceiver:rP,shimCreateAnswer:sP,shimCreateOffer:oP,shimGetDisplayMedia:h9,shimGetParameters:iP,shimGetUserMedia:Yx,shimOnTrack:Qx,shimPeerConnection:F0,shimRTCDataChannel:nP,shimReceiverGetStats:eP,shimRemoveStream:tP,shimSenderGetStats:qx});function aP(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return o&&o.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function cP(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,r.dispatchEvent(s)})}),e.apply(r,arguments)}}}function lP(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f},e.createAnswer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f};let a=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(c,l,u){const d=s.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=a}function uP(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(dP(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function dP(t){return t&&t.video!==void 0?Object.assign({},t,{video:Gx(t.video)}):t}function fP(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let s=0;s<r.iceServers.length;s++){let a=r.iceServers[s];a.urls===void 0&&a.url?(eI("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(r.iceServers[s])}r.iceServers=o}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function hP(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pP(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function gP(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var qw=Object.freeze({__proto__:null,shimAudioContext:gP,shimCallbacksAPI:lP,shimConstraints:dP,shimCreateOfferLegacy:pP,shimGetUserMedia:uP,shimLocalStreamsAPI:aP,shimRTCIceServerUrls:fP,shimRemoteStreamsAPI:cP,shimTrackEventTransceiver:hP}),mP={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{n.parameters[s]!==void 0?o.push(s+"="+n.parameters[s]):o.push(s)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(i.attribute=n.substring(r+1,o),i.value=n.substring(o+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],o=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");r.profile=o[2];for(let a=3;a<o.length;a++){const c=o[a],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),d=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const s=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{s.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=e.writeRtpMap(s),i+=e.writeFmtp(s),i+=e.writeRtcpFb(s)});let o=0;return r.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=e.writeExtmap(s)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(h.rtx={ssrc:l}),r.push(h),o&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const s=e.matchPrefix(n,"a=rtcp-mux");return r.mux=s.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const s=e.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let o;const s=r!==void 0?r:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(mP);var vP=mP.exports,il=gW(vP),p9=hW({__proto__:null,default:il},[vP]);function Eh(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=il.parseCandidate(r.candidate);for(const s in o)s in i||Object.defineProperty(i,s,{value:o[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,vc(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function B0(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||vc(t,"icecandidate",e=>{if(e.candidate){const n=il.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Th(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=il.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=il.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},o=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=il.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},s=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),l=i(c),u=o(arguments[0],c);let d;l===0&&u===0?d=Number.POSITIVE_INFINITY:l===0||u===0?d=Math.max(l,u):d=Math.min(l,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return s.apply(this,arguments)}}function Rh(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},vc(t,"datachannel",r=>(e(r.channel,r.target),r))}function U0(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function V0(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function xh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ph(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>n.apply(this,[s]))})}var g9=Object.freeze({__proto__:null,removeExtmapAllowMixed:V0,shimAddIceCandidateNullOrEmpty:xh,shimConnectionState:U0,shimMaxMessageSize:Th,shimParameterlessSetLocalDescription:Ph,shimRTCIceCandidate:Eh,shimRTCIceCandidateRelayProtocol:B0,shimSendThrowTypeError:Rh});function m9(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Vx,r=d9(t),i={browserDetails:r,commonShim:g9,extractVersion:kh,disableLog:l9,disableWarnings:u9,sdp:p9};switch(r.browser){case"chrome":if(!Yw||!L0||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Yw,xh(t,r),Ph(t),Wx(t,r),jx(t),L0(t,r),Zx(t),Kx(t,r),Hx(t),zx(t),Xx(t),Jx(t,r),Eh(t),B0(t),U0(t),Th(t,r),Rh(t),V0(t,r);break;case"firefox":if(!Qw||!F0||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Qw,xh(t,r),Ph(t),Yx(t,r),F0(t,r),Qx(t),tP(t),qx(t),eP(t),nP(t),rP(t),iP(t),oP(t),sP(t),Eh(t),U0(t),Th(t,r),Rh(t);break;case"safari":if(!qw||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=qw,xh(t,r),Ph(t),fP(t),pP(t),lP(t),aP(t),cP(t),hP(t),uP(t),gP(t),Eh(t),B0(t),Th(t,r),Rh(t),V0(t,r);break;default:n("Unsupported browser!");break}return i}m9({window:typeof window>"u"?void 0:window});const v9=10,Wf="lk_e2ee",y9="LKFrameEncryptionKey",C9={sharedKey:!1,ratchetSalt:y9,ratchetWindowSize:8,failureTolerance:v9};var aa;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(aa||(aa={}));var eA;(function(t){t.KeyRatcheted="keyRatcheted"})(eA||(eA={}));var Ys;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Ys||(Ys={}));var tA;(function(t){t.Error="cryptorError"})(tA||(tA={}));function I9(){return S9()||G0()}function G0(){return typeof window.RTCRtpScriptTransform<"u"}function S9(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class Nz extends Ao.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{Je.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},C9),e),this.on(aa.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(aa.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(aa.RatchetRequest,e,n)}}class Hl extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class mt extends Hl{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class tI extends Hl{constructor(e){super(21,e??"device is unsupported")}}class Xi extends Hl{constructor(e){super(20,e??"track is invalid")}}class b9 extends Hl{constructor(e){super(10,e??"unsupported server")}}class tn extends Hl{constructor(e){super(12,e??"unexpected connection state")}}class W0 extends Hl{constructor(e){super(13,e??"unable to negotiate")}}var Nd;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(Nd||(Nd={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(Nd||(Nd={}));var ie;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ie||(ie={}));var ae;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(ae||(ae={}));var Ae;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(Ae||(Ae={}));var ye;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(ye||(ye={}));function nI(t,e,n){var r,i,o;e===void 0&&(e=50),n===void 0&&(n={});var s=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var h=Date.now()-l;if(h+e>=c)return c-h}return e}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(m,C){var g=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,l=Date.now(),!s){var S=t.apply(p,h);a&&a(S),u.forEach(function(k){return(0,k.resolve)(S)}),u=[]}},d()),g){var v=t.apply(p,h);return a&&a(v),m(v)}u.push({resolve:m,reject:C})})};return f.cancel=function(h){o!==void 0&&clearTimeout(o),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const w9=/version\/(\d+(\.?_?\d+)+)/i;let Em;function ys(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Em===void 0||e){const r=A9.find(i=>{let{test:o}=i;return o.test(n)});Em=r==null?void 0:r.describe(n)}return Em}const A9=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Tm(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Tm(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Tm(w9,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function Tm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var k9="1.15.13";const E9=k9,T9=11;class Sn{}Sn.setTimeout=function(){return setTimeout(...arguments)};Sn.setInterval=function(){return setInterval(...arguments)};Sn.clearTimeout=function(){return clearTimeout(...arguments)};Sn.clearInterval=function(){return clearInterval(...arguments)};class dt{constructor(e,n,r,i,o){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const R9=["vp8","h264"],yP=["vp8","h264","vp9","av1"];function x9(t){return!!R9.find(e=>e===t)}var Tp;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(Tp||(Tp={}));const _d={h90:new dt(160,90,9e4,20),h180:new dt(320,180,16e4,20),h216:new dt(384,216,18e4,20),h360:new dt(640,360,45e4,20),h540:new dt(960,540,8e5,25),h720:new dt(1280,720,17e5,30),h1080:new dt(1920,1080,3e6,30),h1440:new dt(2560,1440,5e6,30),h2160:new dt(3840,2160,8e6,30)},j0={h120:new dt(160,120,7e4,20),h180:new dt(240,180,125e3,20),h240:new dt(320,240,14e4,20),h360:new dt(480,360,33e4,20),h480:new dt(640,480,5e5,20),h540:new dt(720,540,6e5,25),h720:new dt(960,720,13e5,30),h1080:new dt(1440,1080,23e5,30),h1440:new dt(1920,1440,38e5,30)},rI={h360fps3:new dt(640,360,2e5,3,"medium"),h360fps15:new dt(640,360,4e5,15,"medium"),h720fps5:new dt(1280,720,8e5,5,"medium"),h720fps15:new dt(1280,720,15e5,15,"medium"),h720fps30:new dt(1280,720,2e6,30,"medium"),h1080fps15:new dt(1920,1080,25e5,15,"medium"),h1080fps30:new dt(1920,1080,5e6,30,"medium"),original:new dt(0,0,7e6,30,"medium")};var Ln;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(Ln||(Ln={}));T.util.setEnumType(Ln,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var ac;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(ac||(ac={}));T.util.setEnumType(ac,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var Rp;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(Rp||(Rp={}));T.util.setEnumType(Rp,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class jo extends be{constructor(e){super(),this.message={case:void 0},T.util.initPartial(e,this)}static fromBinary(e,n){return new jo().fromBinary(e,n)}static fromJson(e,n){return new jo().fromJson(e,n)}static fromJsonString(e,n){return new jo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(jo,e,n)}}jo.runtime=T;jo.typeName="livekit.SignalRequest";jo.fields=T.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:Qn,oneof:"message"},{no:2,name:"answer",kind:"message",T:Qn,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Ti,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ei,oneof:"message"},{no:5,name:"mute",kind:"message",T:Ri,oneof:"message"},{no:6,name:"subscription",kind:"message",T:ei,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:io,oneof:"message"},{no:8,name:"leave",kind:"message",T:ti,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:oo,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:lo,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:uo,oneof:"message"},{no:13,name:"simulate",kind:"message",T:yn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:so,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:ho,oneof:"message"}]);class ro extends be{constructor(e){super(),this.message={case:void 0},T.util.initPartial(e,this)}static fromBinary(e,n){return new ro().fromBinary(e,n)}static fromJson(e,n){return new ro().fromJson(e,n)}static fromJsonString(e,n){return new ro().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ro,e,n)}}ro.runtime=T;ro.typeName="livekit.SignalResponse";ro.fields=T.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:Zo,oneof:"message"},{no:2,name:"answer",kind:"message",T:Qn,oneof:"message"},{no:3,name:"offer",kind:"message",T:Qn,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Ti,oneof:"message"},{no:5,name:"update",kind:"message",T:Xo,oneof:"message"},{no:6,name:"track_published",kind:"message",T:xi,oneof:"message"},{no:8,name:"leave",kind:"message",T:ti,oneof:"message"},{no:9,name:"mute",kind:"message",T:Ri,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:$o,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Ko,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Yo,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:qo,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:ts,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:ns,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:zo,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Ho,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:rs,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:os,oneof:"message"}]);class ki extends be{constructor(e){super(),this.codec="",this.cid="",T.util.initPartial(e,this)}static fromBinary(e,n){return new ki().fromBinary(e,n)}static fromJson(e,n){return new ki().fromJson(e,n)}static fromJsonString(e,n){return new ki().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ki,e,n)}}ki.runtime=T;ki.typeName="livekit.SimulcastCodec";ki.fields=T.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Ei extends be{constructor(e){super(),this.cid="",this.name="",this.type=Dn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=jt.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Cn.NONE,this.stream="",T.util.initPartial(e,this)}static fromBinary(e,n){return new Ei().fromBinary(e,n)}static fromJson(e,n){return new Ei().fromJson(e,n)}static fromJsonString(e,n){return new Ei().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ei,e,n)}}Ei.runtime=T;Ei.typeName="livekit.AddTrackRequest";Ei.fields=T.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:T.getEnumType(Dn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:T.getEnumType(jt)},{no:9,name:"layers",kind:"message",T:Yn,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:ki,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:T.getEnumType(Cn)},{no:15,name:"stream",kind:"scalar",T:9}]);class Ti extends be{constructor(e){super(),this.candidateInit="",this.target=Ln.PUBLISHER,T.util.initPartial(e,this)}static fromBinary(e,n){return new Ti().fromBinary(e,n)}static fromJson(e,n){return new Ti().fromJson(e,n)}static fromJsonString(e,n){return new Ti().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ti,e,n)}}Ti.runtime=T;Ti.typeName="livekit.TrickleRequest";Ti.fields=T.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:T.getEnumType(Ln)}]);class Ri extends be{constructor(e){super(),this.sid="",this.muted=!1,T.util.initPartial(e,this)}static fromBinary(e,n){return new Ri().fromBinary(e,n)}static fromJson(e,n){return new Ri().fromJson(e,n)}static fromJsonString(e,n){return new Ri().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ri,e,n)}}Ri.runtime=T;Ri.typeName="livekit.MuteTrackRequest";Ri.fields=T.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class Zo extends be{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),T.util.initPartial(e,this)}static fromBinary(e,n){return new Zo().fromBinary(e,n)}static fromJson(e,n){return new Zo().fromJson(e,n)}static fromJsonString(e,n){return new Zo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Zo,e,n)}}Zo.runtime=T;Zo.typeName="livekit.JoinResponse";Zo.fields=T.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Zl},{no:2,name:"participant",kind:"message",T:Fr},{no:3,name:"other_participants",kind:"message",T:Fr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:ao,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:eo},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Vo},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class Ho extends be{constructor(e){super(),this.iceServers=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Ho().fromBinary(e,n)}static fromJson(e,n){return new Ho().fromJson(e,n)}static fromJsonString(e,n){return new Ho().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ho,e,n)}}Ho.runtime=T;Ho.typeName="livekit.ReconnectResponse";Ho.fields=T.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:ao,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:eo}]);class xi extends be{constructor(e){super(),this.cid="",T.util.initPartial(e,this)}static fromBinary(e,n){return new xi().fromBinary(e,n)}static fromJson(e,n){return new xi().fromJson(e,n)}static fromJsonString(e,n){return new xi().fromJsonString(e,n)}static equals(e,n){return T.util.equals(xi,e,n)}}xi.runtime=T;xi.typeName="livekit.TrackPublishedResponse";xi.fields=T.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:hr}]);class zo extends be{constructor(e){super(),this.trackSid="",T.util.initPartial(e,this)}static fromBinary(e,n){return new zo().fromBinary(e,n)}static fromJson(e,n){return new zo().fromJson(e,n)}static fromJsonString(e,n){return new zo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(zo,e,n)}}zo.runtime=T;zo.typeName="livekit.TrackUnpublishedResponse";zo.fields=T.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class Qn extends be{constructor(e){super(),this.type="",this.sdp="",T.util.initPartial(e,this)}static fromBinary(e,n){return new Qn().fromBinary(e,n)}static fromJson(e,n){return new Qn().fromJson(e,n)}static fromJsonString(e,n){return new Qn().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Qn,e,n)}}Qn.runtime=T;Qn.typeName="livekit.SessionDescription";Qn.fields=T.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class Xo extends be{constructor(e){super(),this.participants=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Xo().fromBinary(e,n)}static fromJson(e,n){return new Xo().fromJson(e,n)}static fromJsonString(e,n){return new Xo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Xo,e,n)}}Xo.runtime=T;Xo.typeName="livekit.ParticipantUpdate";Xo.fields=T.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Fr,repeated:!0}]);class ei extends be{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new ei().fromBinary(e,n)}static fromJson(e,n){return new ei().fromJson(e,n)}static fromJsonString(e,n){return new ei().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ei,e,n)}}ei.runtime=T;ei.typeName="livekit.UpdateSubscription";ei.fields=T.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:qi,repeated:!0}]);class io extends be{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=an.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,T.util.initPartial(e,this)}static fromBinary(e,n){return new io().fromBinary(e,n)}static fromJson(e,n){return new io().fromJson(e,n)}static fromJsonString(e,n){return new io().fromJsonString(e,n)}static equals(e,n){return T.util.equals(io,e,n)}}io.runtime=T;io.typeName="livekit.UpdateTrackSettings";io.fields=T.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:T.getEnumType(an)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class ti extends be{constructor(e){super(),this.canReconnect=!1,this.reason=cs.UNKNOWN_REASON,T.util.initPartial(e,this)}static fromBinary(e,n){return new ti().fromBinary(e,n)}static fromJson(e,n){return new ti().fromJson(e,n)}static fromJsonString(e,n){return new ti().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ti,e,n)}}ti.runtime=T;ti.typeName="livekit.LeaveRequest";ti.fields=T.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:T.getEnumType(cs)}]);class oo extends be{constructor(e){super(),this.trackSid="",this.layers=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new oo().fromBinary(e,n)}static fromJson(e,n){return new oo().fromJson(e,n)}static fromJsonString(e,n){return new oo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(oo,e,n)}}oo.runtime=T;oo.typeName="livekit.UpdateVideoLayers";oo.fields=T.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Yn,repeated:!0}]);class so extends be{constructor(e){super(),this.metadata="",this.name="",T.util.initPartial(e,this)}static fromBinary(e,n){return new so().fromBinary(e,n)}static fromJson(e,n){return new so().fromJson(e,n)}static fromJsonString(e,n){return new so().fromJsonString(e,n)}static equals(e,n){return T.util.equals(so,e,n)}}so.runtime=T;so.typeName="livekit.UpdateParticipantMetadata";so.fields=T.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class ao extends be{constructor(e){super(),this.urls=[],this.username="",this.credential="",T.util.initPartial(e,this)}static fromBinary(e,n){return new ao().fromBinary(e,n)}static fromJson(e,n){return new ao().fromJson(e,n)}static fromJsonString(e,n){return new ao().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ao,e,n)}}ao.runtime=T;ao.typeName="livekit.ICEServer";ao.fields=T.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class $o extends be{constructor(e){super(),this.speakers=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new $o().fromBinary(e,n)}static fromJson(e,n){return new $o().fromJson(e,n)}static fromJsonString(e,n){return new $o().fromJsonString(e,n)}static equals(e,n){return T.util.equals($o,e,n)}}$o.runtime=T;$o.typeName="livekit.SpeakersChanged";$o.fields=T.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Yi,repeated:!0}]);class Ko extends be{constructor(e){super(),T.util.initPartial(e,this)}static fromBinary(e,n){return new Ko().fromBinary(e,n)}static fromJson(e,n){return new Ko().fromJson(e,n)}static fromJsonString(e,n){return new Ko().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Ko,e,n)}}Ko.runtime=T;Ko.typeName="livekit.RoomUpdate";Ko.fields=T.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Zl}]);class Jo extends be{constructor(e){super(),this.participantSid="",this.quality=Lo.POOR,this.score=0,T.util.initPartial(e,this)}static fromBinary(e,n){return new Jo().fromBinary(e,n)}static fromJson(e,n){return new Jo().fromJson(e,n)}static fromJsonString(e,n){return new Jo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Jo,e,n)}}Jo.runtime=T;Jo.typeName="livekit.ConnectionQualityInfo";Jo.fields=T.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:T.getEnumType(Lo)},{no:3,name:"score",kind:"scalar",T:2}]);class Yo extends be{constructor(e){super(),this.updates=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Yo().fromBinary(e,n)}static fromJson(e,n){return new Yo().fromJson(e,n)}static fromJsonString(e,n){return new Yo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Yo,e,n)}}Yo.runtime=T;Yo.typeName="livekit.ConnectionQualityUpdate";Yo.fields=T.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:Jo,repeated:!0}]);class Qo extends be{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=ac.ACTIVE,T.util.initPartial(e,this)}static fromBinary(e,n){return new Qo().fromBinary(e,n)}static fromJson(e,n){return new Qo().fromJson(e,n)}static fromJsonString(e,n){return new Qo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Qo,e,n)}}Qo.runtime=T;Qo.typeName="livekit.StreamStateInfo";Qo.fields=T.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:T.getEnumType(ac)}]);class qo extends be{constructor(e){super(),this.streamStates=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new qo().fromBinary(e,n)}static fromJson(e,n){return new qo().fromJson(e,n)}static fromJsonString(e,n){return new qo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(qo,e,n)}}qo.runtime=T;qo.typeName="livekit.StreamStateUpdate";qo.fields=T.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:Qo,repeated:!0}]);class Pi extends be{constructor(e){super(),this.quality=an.LOW,this.enabled=!1,T.util.initPartial(e,this)}static fromBinary(e,n){return new Pi().fromBinary(e,n)}static fromJson(e,n){return new Pi().fromJson(e,n)}static fromJsonString(e,n){return new Pi().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Pi,e,n)}}Pi.runtime=T;Pi.typeName="livekit.SubscribedQuality";Pi.fields=T.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:T.getEnumType(an)},{no:2,name:"enabled",kind:"scalar",T:8}]);class es extends be{constructor(e){super(),this.codec="",this.qualities=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new es().fromBinary(e,n)}static fromJson(e,n){return new es().fromJson(e,n)}static fromJsonString(e,n){return new es().fromJsonString(e,n)}static equals(e,n){return T.util.equals(es,e,n)}}es.runtime=T;es.typeName="livekit.SubscribedCodec";es.fields=T.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Pi,repeated:!0}]);class ts extends be{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new ts().fromBinary(e,n)}static fromJson(e,n){return new ts().fromJson(e,n)}static fromJsonString(e,n){return new ts().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ts,e,n)}}ts.runtime=T;ts.typeName="livekit.SubscribedQualityUpdate";ts.fields=T.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Pi,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:es,repeated:!0}]);class co extends be{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",T.util.initPartial(e,this)}static fromBinary(e,n){return new co().fromBinary(e,n)}static fromJson(e,n){return new co().fromJson(e,n)}static fromJsonString(e,n){return new co().fromJsonString(e,n)}static equals(e,n){return T.util.equals(co,e,n)}}co.runtime=T;co.typeName="livekit.TrackPermission";co.fields=T.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class lo extends be{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new lo().fromBinary(e,n)}static fromJson(e,n){return new lo().fromJson(e,n)}static fromJsonString(e,n){return new lo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(lo,e,n)}}lo.runtime=T;lo.typeName="livekit.SubscriptionPermission";lo.fields=T.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:co,repeated:!0}]);class ns extends be{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,T.util.initPartial(e,this)}static fromBinary(e,n){return new ns().fromBinary(e,n)}static fromJson(e,n){return new ns().fromJson(e,n)}static fromJsonString(e,n){return new ns().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ns,e,n)}}ns.runtime=T;ns.typeName="livekit.SubscriptionPermissionUpdate";ns.fields=T.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class uo extends be{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new uo().fromBinary(e,n)}static fromJson(e,n){return new uo().fromJson(e,n)}static fromJsonString(e,n){return new uo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(uo,e,n)}}uo.runtime=T;uo.typeName="livekit.SyncState";uo.fields=T.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:Qn},{no:2,name:"subscription",kind:"message",T:ei},{no:3,name:"publish_tracks",kind:"message",T:xi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:fo,repeated:!0},{no:5,name:"offer",kind:"message",T:Qn}]);class fo extends be{constructor(e){super(),this.label="",this.id=0,this.target=Ln.PUBLISHER,T.util.initPartial(e,this)}static fromBinary(e,n){return new fo().fromBinary(e,n)}static fromJson(e,n){return new fo().fromJson(e,n)}static fromJsonString(e,n){return new fo().fromJsonString(e,n)}static equals(e,n){return T.util.equals(fo,e,n)}}fo.runtime=T;fo.typeName="livekit.DataChannelInfo";fo.fields=T.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:T.getEnumType(Ln)}]);class yn extends be{constructor(e){super(),this.scenario={case:void 0},T.util.initPartial(e,this)}static fromBinary(e,n){return new yn().fromBinary(e,n)}static fromJson(e,n){return new yn().fromJson(e,n)}static fromJsonString(e,n){return new yn().fromJsonString(e,n)}static equals(e,n){return T.util.equals(yn,e,n)}}yn.runtime=T;yn.typeName="livekit.SimulateScenario";yn.fields=T.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:T.getEnumType(Rp),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class ho extends be{constructor(e){super(),this.timestamp=Ve.zero,this.rtt=Ve.zero,T.util.initPartial(e,this)}static fromBinary(e,n){return new ho().fromBinary(e,n)}static fromJson(e,n){return new ho().fromJson(e,n)}static fromJsonString(e,n){return new ho().fromJsonString(e,n)}static equals(e,n){return T.util.equals(ho,e,n)}}ho.runtime=T;ho.typeName="livekit.Ping";ho.fields=T.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class rs extends be{constructor(e){super(),this.lastPingTimestamp=Ve.zero,this.timestamp=Ve.zero,T.util.initPartial(e,this)}static fromBinary(e,n){return new rs().fromBinary(e,n)}static fromJson(e,n){return new rs().fromJson(e,n)}static fromJsonString(e,n){return new rs().fromJsonString(e,n)}static equals(e,n){return T.util.equals(rs,e,n)}}rs.runtime=T;rs.typeName="livekit.Pong";rs.fields=T.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class Qs extends be{constructor(e){super(),this.regions=[],T.util.initPartial(e,this)}static fromBinary(e,n){return new Qs().fromBinary(e,n)}static fromJson(e,n){return new Qs().fromJson(e,n)}static fromJsonString(e,n){return new Qs().fromJsonString(e,n)}static equals(e,n){return T.util.equals(Qs,e,n)}}Qs.runtime=T;Qs.typeName="livekit.RegionSettings";Qs.fields=T.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:is,repeated:!0}]);class is extends be{constructor(e){super(),this.region="",this.url="",this.distance=Ve.zero,T.util.initPartial(e,this)}static fromBinary(e,n){return new is().fromBinary(e,n)}static fromJson(e,n){return new is().fromJson(e,n)}static fromJsonString(e,n){return new is().fromJsonString(e,n)}static equals(e,n){return T.util.equals(is,e,n)}}is.runtime=T;is.typeName="livekit.RegionInfo";is.fields=T.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class os extends be{constructor(e){super(),this.trackSid="",this.err=Pd.SE_UNKNOWN,T.util.initPartial(e,this)}static fromBinary(e,n){return new os().fromBinary(e,n)}static fromJson(e,n){return new os().fromJson(e,n)}static fromJsonString(e,n){return new os().fromJsonString(e,n)}static equals(e,n){return T.util.equals(os,e,n)}}os.runtime=T;os.typeName="livekit.SubscriptionResponse";os.fields=T.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:T.getEnumType(Pd)}]);function P9(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const N9=5e3,yu=[];class Q extends Ao.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Q.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Je,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),N9):this.handleAppVisibilityChanged()},this.log=vs((i=r.loggerName)!==null&&i!==void 0?i:vo.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Q.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),bt(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===Q.Kind.Video&&(n="video"),this.attachedElements.length===0&&Q.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(yu.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&yu.splice(yu.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Hc(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?ye.AudioPlaybackStarted:ye.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?ye.AudioPlaybackFailed:ye.VideoPlaybackFailed,o):o.name==="AbortError"?Je.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):Je.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(s=>s.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ye.ElementAttached,e),e}detach(e){try{if(e){ol(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ye.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{ol(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(ye.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=vs(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),yu.forEach(r=>{r.parentElement||(n=!1)}),n&&yu.push(e)}}handleAppVisibilityChanged(){return G(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){vr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){vr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Hc(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!cc()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(cc()||Tl())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function ol(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return Dn.AUDIO;case e.Video:return Dn.VIDEO;default:return Dn.DATA}}t.kindToProto=i;function o(l){switch(l){case Dn.AUDIO:return e.Audio;case Dn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=o;function s(l){switch(l){case n.Camera:return jt.CAMERA;case n.Microphone:return jt.MICROPHONE;case n.ScreenShare:return jt.SCREEN_SHARE;case n.ScreenShareAudio:return jt.SCREEN_SHARE_AUDIO;default:return jt.UNKNOWN}}t.sourceToProto=s;function a(l){switch(l){case jt.CAMERA:return n.Camera;case jt.MICROPHONE:return n.Microphone;case jt.SCREEN_SHARE:return n.ScreenShare;case jt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function c(l){switch(l){case ac.ACTIVE:return r.Active;case ac.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(Q||(Q={}));function CP(t,e,n){var r;const i=(r=P9(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&Z0(i.audio,e),i.video&&Z0(i.video,n),i}function Z0(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function pg(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":Z0(r,i.resolution);break;default:r[o]=i[o]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function _9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return G(this,void 0,void 0,function*(){const n=iI();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield ls(e),r.getByteTimeDomainData(o);const a=o.some(c=>c!==128&&c!==0);return n.close(),!a}return!1})}function iI(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function O9(t){return t===Q.Source.Microphone?"audioinput":t===Q.Source.Camera?"videoinput":void 0}function M9(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,cc()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function IP(t){const e=t.split("/")[1].toLowerCase();if(!yP.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function D9(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new xi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function bt(t){return t instanceof Q?{trackSid:t.sid,trackSource:t.source,trackMuted:t.isMuted,trackEnabled:t.mediaStreamTrack.enabled,trackKind:t.kind}:{trackSid:t.trackSid,trackName:t.trackName,track:t.track?bt(t.track):void 0,trackEnabled:t.isEnabled,trackEncrypted:t.isEncrypted,trackMimeType:t.mimeType}}const L9="|",nA="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function F9(t){const e=t.split(L9);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function ls(t){return G(this,void 0,void 0,function*(){return new Promise(e=>Sn.setTimeout(e,t))})}function rA(){return"addTransceiver"in RTCPeerConnection.prototype}function iA(){return"addTrack"in RTCPeerConnection.prototype}function B9(){if(!("getCapabilities"in RTCRtpSender)||cc())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function U9(){if(!("getCapabilities"in RTCRtpSender)||Tl())return!1;if(cc()){const n=ys();if(n!=null&&n.version&&oI(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Ku(t){return t==="av1"||t==="vp9"}function H0(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const V9={Chrome:"100",Safari:"15",Firefox:"100"};function G9(t){if(!vr()||!("setCodecPreferences"in t))return!1;const e=ys();if(!(e!=null&&e.name)||!e.version)return!1;const n=V9[e.name];return n?oI(e.version,n)>=0:!1}function Tl(){var t;return((t=ys())===null||t===void 0?void 0:t.name)==="Firefox"}function W9(){var t;return((t=ys())===null||t===void 0?void 0:t.name)==="Chrome"}function cc(){var t;return((t=ys())===null||t===void 0?void 0:t.name)==="Safari"}function j9(){const t=ys();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function SP(){return vr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function vr(){return typeof document<"u"}function lc(){return navigator.product=="ReactNative"}function z0(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function bP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function wP(){if(!lc())return;let t=bP();if(t)return t.platform}function oA(){if(vr())return window.devicePixelRatio;if(lc()){let t=bP();if(t)return t.devicePixelRatio}return 1}function oI(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const s=parseInt(n[o],10),a=parseInt(r[o],10);if(s>a)return 1;if(s<a)return-1;if(o===i-1&&s===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function Z9(t){for(const e of t)e.target.handleResize(e)}function H9(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Rm=null;const sA=()=>(Rm||(Rm=new ResizeObserver(Z9)),Rm);let xm=null;const aA=()=>(xm||(xm=new IntersectionObserver(H9,{root:null,rootMargin:"0px"})),xm);function z9(){var t;const e=new Go({sdk:El.JS,protocol:T9,version:E9});return lc()&&(e.os=(t=wP())!==null&&t!==void 0?t:""),e}function cA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(t/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Cu;function Pm(){if(!Cu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Cu]=r.stream.getAudioTracks(),!Cu)throw Error("Could not get empty media stream audio track");Cu.enabled=!1}return Cu.clone()}class AP{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>G(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function X9(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=iI();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:s,cleanup:()=>G(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class Oi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function $9(t){return yP.includes(t)}function Ka(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function K9(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function lA(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const uA="default";class $n{static getInstance(){return this.instance===void 0&&(this.instance=new $n),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return G(this,void 0,void 0,function*(){if(((r=$n.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){Je.debug("awaiting getUserMedia promise");try{e?yield $n.userMediaPromiseMap.get(e):yield Promise.all($n.userMediaPromiseMap.values())}catch{Je.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(cc()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(s=>{const a=s.label==="",c=e?s.kind===e:!0;return a&&c}))){const s={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(s);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(c=>{c.stop()})}return e&&(i=i.filter(o=>o.kind===e)),i})}normalizeDeviceId(e,n,r){return G(this,void 0,void 0,function*(){if(n!==uA)return n;const o=(yield this.getDevices(e)).find(s=>s.groupId===r&&s.deviceId!==uA);return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?$n.userMediaPromiseMap.has(e):$n.userMediaPromiseMap.size>0}}$n.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];$n.userMediaPromiseMap=new Map;const J9=1e3;class Rl extends Q{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,n,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=nI(()=>G(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>G(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ye.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Oi,this.pauseUpstreamLock=new Oi,this.processorLock=new Oi,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Q.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return G(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{ol(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");Hc(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{Hc(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J9;var n;return G(this,void 0,void 0,function*(){if(this.kind===Q.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=ys())===null||n===void 0?void 0:n.os)==="iOS"&&(yield ls(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield ls(50)}throw new Xi("unable to get track dimensions after timeout")})}getDeviceId(){return G(this,void 0,void 0,function*(){if(this.source===Q.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===Q.Kind.Audio?"audioinput":"videoinput";return $n.getInstance().normalizeDeviceId(r,e,n)})}mute(){return G(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return G(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return G(this,void 0,void 0,function*(){if(!this.sender)throw new Xi("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return G(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const n={audio:!1,video:!1};this.kind===Q.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(o=>{ol(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(ye.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ye.Muted:ye.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return G(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),SP()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return G(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ye.UpstreamPaused,this);const n=ys();if((n==null?void 0:n.name)==="Safari"&&oI(n.version,"12.0")<0)throw new tI("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return G(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ye.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return G(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return G(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),Hc(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const s={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(s),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(ol(this._mediaStreamTrack,a),Hc(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return G(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class Y9 extends Ao.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:o,data:s}=n.data;switch(o){case"error":Je.error(s.error.message),this.emit(Ys.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==s.enabled&&s.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Ys.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(s.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(Ys.ParticipantEncryptionStatusChanged,s.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(aa.KeyRatcheted,s.material,s.keyIndex);break}},this.onWorkerError=n=>{Je.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ys.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!I9())throw new tI("tried to setup end-to-end encryption on an unsupported browser");if(Je.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(Je.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Je.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Je.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Ae.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ie.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Cn.NONE,i.identity)),e.on(ie.ConnectionStateChanged,r=>{r===it.Connected&&e.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Cn.NONE,i.identity)})})}).on(ie.TrackUnsubscribed,(r,i,o)=>{var s;const a={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(s=this.worker)===null||s===void 0||s.postMessage(a)}).on(ie.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ie.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(ae.LocalTrackPublished,r=>G(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(aa.SetKey,r=>this.postKey(r)).on(aa.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(s)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?IP(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Rl)||!n){n||Je.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return G(this,void 0,void 0,function*(){if(this.worker){if(G0()){const o={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(Wf in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let o=e.writableStream,s=e.readableStream;if(!o||!s){const c=e.createEncodedStreams();e.writableStream=c.writable,o=c.writable,e.readableStream=c.readable,s=c.readable}const a={kind:"decode",data:{readableStream:s,writableStream:o,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[s,o])}e[Wf]=!0}})}handleSender(e,n,r){var i;if(!(Wf in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(G0()){Je.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{Je.info("initialize encoded streams");const o=e.createEncodedStreams(),s={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s,[o.readable,o.writable])}e[Wf]=!0}}}var Ju;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Ju||(Ju={}));class Q9{constructor(){this.pendingTasks=new Map,this.taskMutex=new Oi,this.nextTaskIndex=0}run(e){return G(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Ju.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Ju.RUNNING,yield e()}finally{n.status=Ju.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return G(this,void 0,void 0,function*(){return this.run(()=>G(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const q9=["syncState","trickle","offer","answer","simulate","leave"];function ej(t){const e=q9.indexOf(t.case)>=0;return Je.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Ft;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Ft||(Ft={}));class sI{get currentState(){return this.state}get isDisconnected(){return this.state===Ft.DISCONNECTING||this.state===Ft.DISCONNECTED}get isEstablishingConnection(){return this.state===Ft.CONNECTING||this.state===Ft.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Ft.DISCONNECTED,this.log=Je,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=vs((r=n.loggerName)!==null&&r!==void 0?r:vo.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new Q9,this.queuedRequests=[],this.closingLock=new Oi,this.connectionLock=new Oi,this.state=Ft.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return G(this,void 0,void 0,function*(){return this.state=Ft.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return G(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Ft.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=K9(e),e=e.replace(/\/$/,""),e+="/rtc";const o=z9(),s=tj(n,o,r);return new Promise((a,c)=>G(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>G(this,void 0,void 0,function*(){this.close(),clearTimeout(d),c(new mt("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),c(new mt("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(e+s),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>G(this,void 0,void 0,function*(){if(this.state!==Ft.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(e.substring(2),"/validate").concat(s));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();c(new mt(p,0,h.status))}else c(new mt("Internal error",2,h.status))}catch{c(new mt("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>G(this,void 0,void 0,function*(){var h,p,m,C;let g;if(typeof f.data=="string"){const v=JSON.parse(f.data);g=ro.fromJson(v)}else if(f.data instanceof ArrayBuffer)g=ro.fromBinary(new Uint8Array(f.data));else{this.log.error("could not decode websocket message: ".concat(typeof f.data),this.logContext);return}if(this.state!==Ft.CONNECTED){let v=!1;if(((h=g.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=Ft.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=g.message.value.pingTimeout,this.pingIntervalDuration=g.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(g.message.value)):this.state===Ft.RECONNECTING&&g.message.case!=="leave"?(this.state=Ft.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=g.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((m=g.message)===null||m===void 0?void 0:m.value):(a(),v=!0)):this.isEstablishingConnection&&g.message.case==="leave"?c(new mt("Received leave request while trying to (re)connect",4)):r.reconnect||c(new mt("did not receive join response, got ".concat((C=g.message)===null||C===void 0?void 0:C.case," instead"))),!v)return}this.signalLatency&&(yield ls(this.signalLatency)),this.handleSignalResponse(g)}),this.ws.onclose=f=>{this.isEstablishingConnection&&c(new mt("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:f.reason,state:this.state})),this.handleOnClose(f.reason)}}finally{l()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return G(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(e&&(this.state=Ft.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,ls(250)])),this.ws=void 0}}finally{e&&(this.state=Ft.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:xp(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:xp(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Ti({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new Ri({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new so({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new oo({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new lo({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ve.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new ho({timestamp:Ve.parse(Date.now()),rtt:Ve.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new ti({canReconnect:!1,reason:cs.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return G(this,void 0,void 0,function*(){if(!n&&!ej(e)&&this.state===Ft.RECONNECTING){this.queuedRequests.push(()=>G(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield ls(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new jo({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const s=dA(i.value);this.onAnswer&&this.onAnswer(s)}else if(i.case==="offer"){const s=dA(i.value);this.onOffer&&this.onOffer(s)}else if(i.case==="trickle"){const s=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(s,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return G(this,void 0,void 0,function*(){if(this.state===Ft.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Sn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Sn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Sn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Sn.clearInterval(this.pingInterval)}}function dA(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function xp(t){return new Qn({sdp:t.sdp,type:t.type})}function tj(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",lc()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var kP={},EP={exports:{}},fA=EP.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(fA).forEach(function(t){var e=fA[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var TP=EP.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=e(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=e(a[d+1]))},r=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},i=TP,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var m=i[f][p];if(m.reg.test(h))return r(m,u,h)}}),c.media=l,c};var s=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(s,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(kP);var Nm=TP,nj=/%[sdv%]/g,rj=function(t){var e=1,n=arguments,r=n.length;return t.replace(nj,function(i){if(e>=r)return i;var o=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},Iu=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var o=0;o<e.names.length;o+=1){var s=e.names[o];e.name?i.push(n[e.name][s]):i.push(n[e.names[o]])}else i.push(n[e.name]);return rj.apply(null,i)},ij=["v","o","s","i","u","e","p","c","b","t","r","z","a"],oj=["i","c","b","a"],sj=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var n=e.outerOrder||ij,r=e.innerOrder||oj,i=[];return n.forEach(function(o){Nm[o].forEach(function(s){s.name in t&&t[s.name]!=null?i.push(Iu(o,s,t)):s.push in t&&t[s.push]!=null&&t[s.push].forEach(function(a){i.push(Iu(o,s,a))})})}),t.media.forEach(function(o){i.push(Iu("m",Nm.m[0],o)),r.forEach(function(s){Nm[s].forEach(function(a){a.name in o&&o[a.name]!=null?i.push(Iu(s,a,o)):a.push in o&&o[a.push]!=null&&o[a.push].forEach(function(c){i.push(Iu(s,a,c))})})})}),i.join(`\r
`)+`\r
`},aj=kP,cj=sj,_m=cj,Mu=aj.parse;const hA=.7,sl={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class pA extends Ao.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=Je,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=nI(o=>G(this,void 0,void 0,function*(){this.emit(sl.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=vs((i=r.loggerName)!==null&&i!==void 0?i:vo.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=W9()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return G(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return G(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:o}=uj(e);this.remoteStereoMids=i,this.remoteNackMids=o}else if(e.type==="answer"){const i=Mu((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||o.mid!=s.transceiver.mid)return!1;let a=0;if(o.rtp.some(l=>l.codec.toUpperCase()===s.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of o.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),c=!0;break}return c||s.maxbr>0&&o.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),r=_m(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(sl.NegotiationComplete),e.sdp&&Mu(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(sl.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){var n;return G(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=Mu((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"?gA(o,[],[]):o.type==="video"&&(lj(o),this.trackBitrates.some(s=>{if(!o.msid||!s.cid||!o.msid.includes(s.cid))return!1;let a=0;if(o.rtp.some(l=>l.codec.toUpperCase()===s.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of o.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(Math.round(s.maxbr*hA))),l.config.includes("x-google-max-bitrate")||(l.config+=";x-google-max-bitrate=".concat(s.maxbr)),c=!0;break}return c||o.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(s.maxbr*hA),";x-google-max-bitrate=").concat(s.maxbr)}),!0}))}),yield this.setMungedSDP(r,_m(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return G(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=Mu((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&gA(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,_m(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new tn("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new tn("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return G(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const s=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return i.get(s)})}setMungedSDP(e,n,r){return G(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const s={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new W0(o)}})}}function gA(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function lj(t){var e,n,r,i;const o=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!Ku(o))return;let s=0;((r=t.ext)===null||r===void 0?void 0:r.some(c=>c.uri===nA?!0:(c.value>s&&(s=c.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:s+1,uri:nA})}function uj(t){var e;const n=[],r=[],i=Mu((e=t.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(s=>{var a;s.type==="audio"&&(s.rtp.some(c=>c.codec==="opus"?(o=c.payload,!0):!1),!((a=s.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===o&&c.type==="nack")&&r.push(s.mid),s.fmtp.some(c=>c.payload===o?(c.config.includes("sprop-stereo=1")&&n.push(s.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const X0="vp8",dj={audioBitrate:Tp.music.maxBitrate,audioPreset:Tp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:rI.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:X0,backupCodec:!0},RP={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},xP={resolution:_d.h720.resolution},fj={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new n9,disconnectOnPageLeave:!0,expWebAudioMix:!1},aI={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var rn;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(rn||(rn={}));class hj{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=aI.peerConnectionTimeout,this.log=Je,this.updateState=()=>{var s;const a=this.state,c=this.requiredTransports.map(l=>l.getConnectionState());c.every(l=>l==="connected")?this.state=rn.CONNECTED:c.some(l=>l==="failed")?this.state=rn.FAILED:c.some(l=>l==="connecting")?this.state=rn.CONNECTING:c.every(l=>l==="closed")?this.state=rn.CLOSED:c.some(l=>l==="closed")?this.state=rn.CLOSING:c.every(l=>l==="new")&&(this.state=rn.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(rn[a]," to ").concat(rn[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=vs((i=r.loggerName)!==null&&i!==void 0?i:vo.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const o={optional:[{googDscp:!0}]};this.publisher=new pA(e,o,r),this.subscriber=new pA(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Ln.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Ln.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,s)},this.subscriber.onTrack=s=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,s)},this.publisher.onOffer=s=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,s)},this.state=rn.NEW,this.connectionLock=new Oi}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return G(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return G(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return G(this,void 0,void 0,function*(){n===Ln.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return G(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return G(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,n)))}finally{i()}})}negotiate(e){return G(this,void 0,void 0,function*(){return new Promise((n,r)=>G(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(sl.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(sl.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(s=>{clearTimeout(i),r(s)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Ln.PUBLISHER?this.publisher.getConnectedAddress():e===Ln.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return G(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((o,s)=>G(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),Sn.clearTimeout(c),s(new mt("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const c=Sn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),s(new mt("could not establish pc connection"))},r);for(;this.state!==rn.CONNECTED;)if(yield ls(50),n!=null&&n.signal.aborted){s(new mt("room connection has been cancelled",3));return}Sn.clearTimeout(c),n==null||n.signal.removeEventListener("abort",a),o()}))})}}const mA="_lossy",vA="_reliable",pj=2*1e3,yA="leave-reconnect";var ui;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(ui||(ui={}));class gj extends Ao.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=aI.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=ui.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Je,this.handleDataChannel=r=>{let{channel:i}=r;return G(this,void 0,void 0,function*(){if(i){if(i.label===vA)this.reliableDCSub=i;else if(i.label===mA)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>G(this,void 0,void 0,function*(){var i,o;const s=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const c=Ji.fromBinary(new Uint8Array(a));((i=c.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(Ae.ActiveSpeakersUpdate,c.value.value.speakers):((o=c.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(Ae.DataPacketReceived,c.value.value,c.kind)}finally{s()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?nn.LOSSY:nn.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(Ae.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(a===null){o(s);return}r===yA&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Sn.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===ui.Connected&&r();const o=()=>{this.off(Ae.Disconnected,s),r()},s=()=>{this.off(Ae.Restarted,o),i()};this.once(Ae.Restarted,o),this.once(Ae.Disconnected,s)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(Ae.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Ft.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Po.RR_SIGNAL_DISCONNECTED))},this.log=vs((n=e.loggerName)!==null&&n!==void 0?n:vo.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new sI(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Oi,this.dataProcessLock=new Oi,this.dcBufferStatus=new Map([[nn.LOSSY,!0],[nn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Ae.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Ae.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Ae.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Ae.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Ae.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Ae.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Ae.StreamStateChanged,r)}get logContext(){var e,n,r,i,o,s;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(s=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||s===void 0?void 0:s.identity}}join(e,n,r,i){return G(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof mt&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw o}})}close(){return G(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(Ae.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return G(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return G(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Xi("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new mt("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),n(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return G(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return G(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==rn.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new hj(r,e.subscriberPrimary,this.loggerOptions),this.emit(Ae.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,s)=>G(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===rn.CONNECTED){const a=this.pcState===ui.New;this.pcState=ui.Connected,a&&this.emit(Ae.Connected,e)}else i===rn.FAILED&&this.pcState===ui.Connected&&(this.pcState=ui.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?Po.RR_SUBSCRIBER_FAILED:Po.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(Ae.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>G(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>G(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Ae.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(Ae.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Ae.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Po.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(yA)):(this.emit(Ae.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const s={urls:o.urls};o.username&&(s.username=o.username),o.credential&&(s.credential=o.credential),i.push(s)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Li.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(mA,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(vA,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(n);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],s=[],a=[];i.codecs.forEach(c=>{const l=c.mimeType.toLowerCase();if(l==="audio/opus"){o.push(c);return}if(!(l==="video/".concat(r))){a.push(c);return}if(r==="h264"){c.sdpFmtpLine&&c.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(c):s.push(c);return}o.push(c)}),G9(e)&&e.setCodecPreferences(o.concat(s,a))}createSender(e,n,r){return G(this,void 0,void 0,function*(){if(rA())return yield this.createTransceiverRTCRtpSender(e,n,r);if(iA())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new tn("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return G(this,void 0,void 0,function*(){if(rA())return this.createSimulcastTransceiverSender(e,n,r,i);if(iA())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new tn("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new tn("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const s=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o);return e.kind===Q.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(s,e.kind,n.videoCodec),e.codec=n.videoCodec),s.sender})}createSimulcastTransceiverSender(e,n,r,i){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new tn("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(s,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,s.sender),s.sender})}createRTCRtpSender(e){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new tn("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return G(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){Je.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Li.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:rn.NEW)===rn.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let s=!0;o instanceof tn?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),s=!1):o instanceof Rc||(this.fullReconnectOnNext=!0),s?this.handleDisconnect("reconnect",Po.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Ae.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){var n,r,i;return G(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new tn("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Ae.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Rc;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(s){throw s instanceof mt&&s.reason===0?new tn("could not reconnect, token might be expired"):new Rc}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Ae.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==Ft.CONNECTED)throw new Rc("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(Ae.Restarted)}catch(o){const s=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(s){yield this.restartConnection(s);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){var n;return G(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new tn("could not reconnect, url or token not saved");if(!this.pcManager)throw new tn("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Ae.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof mt&&r.reason===0?new tn("could not reconnect, token might be expired"):r instanceof mt&&r.reason===4?r:new Rc(i)}if(this.emit(Ae.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Ft.CONNECTED)throw new Rc("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Ae.Resumed)})}waitForPCInitialConnection(e,n){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new tn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return G(this,void 0,void 0,function*(){this.pcState=ui.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield ls(pj),!this.pcManager)throw new tn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=ui.Connected}catch(e){throw this.pcState=ui.Disconnected,new mt("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return G(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new tn("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!i)throw new mt("".concat(o," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const s=this.dataChannelForKind(e,n);if((s==null?void 0:s.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield ls(50)}throw new mt("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return G(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==rn.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return G(this,void 0,void 0,function*(){return new Promise((e,n)=>G(this,void 0,void 0,function*(){if(!this.pcManager){n(new W0("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(Ae.Closing,i),this.pcManager.publisher.once(sl.RTPVideoPayloadTypes,o=>{const s=new Map;o.forEach(a=>{const c=a.codec.toLowerCase();$9(c)&&s.set(a.payload,c)}),this.emit(Ae.RTPVideoMapUpdate,s)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof W0&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Po.RR_UNKNOWN),n(o)}finally{this.off(Ae.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===nn.LOSSY)return this.lossyDCSub;if(e===nn.RELIABLE)return this.reliableDCSub}else{if(e===nn.LOSSY)return this.lossyDC;if(e===nn.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array;e.forEach(l=>{l.isDesired!==a&&c.push(l.trackSid)}),this.client.sendSyncState(new uo({answer:o?xp({sdp:o.sdp,type:o.type}):void 0,offer:s?xp({sdp:s.sdp,type:s.type}):void 0,subscription:new ei({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:D9(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new fo({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(nn.LOSSY),Ln.PUBLISHER),n(this.dataChannelForKind(nn.RELIABLE),Ln.PUBLISHER),n(this.dataChannelForKind(nn.LOSSY,!0),Ln.SUBSCRIBER),n(this.dataChannelForKind(nn.RELIABLE,!0),Ln.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Sn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){vr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){vr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Rc extends Error{}class CA{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return z0(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return G(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),Je.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return G(this,void 0,void 0,function*(){const n=yield fetch("".concat(mj(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new mt("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function mj(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const cI=2e3;function gg(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class cr extends Rl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,Q.Kind.Audio,n,r,o),this.stopOnMute=!1,this.monitorSender=()=>G(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}s&&this.prevStats&&(this._currentBitrate=gg(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return G(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ka(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Q.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Ka(this._constraints.deviceId);return this.source===Q.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return G(this,void 0,void 0,function*(){let n;if(e){const r=pg({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return G(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){vr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},cI)))}setProcessor(e){var n;return G(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return G(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return G(this,void 0,void 0,function*(){const e=yield _9(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(ye.AudioSilenceDetected)),e})}}function PP(t,e,n){switch(t.kind){case"audio":return new cr(t,e,!1,void 0,n);case"video":return new Kr(t,e,!1,n);default:throw new Xi("unsupported track type: ".concat(t.kind))}}const vj=Object.values(_d),yj=Object.values(j0),Cj=Object.values(rI),Ij=[_d.h180,_d.h360],Sj=[j0.h180,j0.h360],bj=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new dt(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),$0=["q","h","f"];function K0(t,e,n,r){var i,o;let s=r==null?void 0:r.videoEncoding;t&&(s=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!s&&!a&&!c||!e||!n)return[{}];s||(s=Aj(t,e,n,l),Je.debug("using video encoding",s));const u=new dt(e,n,s.maxBitrate,s.maxFramerate,s.priority);if(c&&Ku(l)){Je.debug("using svc with scalabilityMode ".concat(c));const h=new NP(c),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let m=0;m<h.spatial;m+=1)p.push({rid:$0[2-m],maxBitrate:s.maxBitrate/Math.pow(3,m),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=c,Je.debug("encodings",p),p}if(!a)return[s];let d=[];t?d=(i=SA(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:IA(t,u):d=(o=SA(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:IA(t,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(e,n);if(p>=960&&f)return Om(e,n,[h,f,u]);if(p>=480)return Om(e,n,[h,u])}return Om(e,n,[u])}function wj(t,e,n){var r,i,o,s;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Je.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),c=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(o=a.height)!==null&&o!==void 0?o:(s=t.dimensions)===null||s===void 0?void 0:s.height;return K0(t.source===Q.Source.ScreenShare,c,l,n)}function Aj(t,e,n,r){const i=kj(t,e,n);let{encoding:o}=i[0];const s=Math.max(e,n);for(let a=0;a<i.length;a+=1){const c=i[a];if(o=c.encoding,c.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function kj(t,e,n){if(t)return Cj;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?vj:yj}function IA(t,e){if(t)return bj(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?Ij:Sj}function Om(t,e,n){const r=[];if(n.forEach((i,o)=>{if(o>=$0.length)return;const s=Math.min(t,e),c={rid:$0[o],scaleResolutionDownBy:Math.max(1,s/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(c.maxFramerate=i.encoding.maxFramerate);const l=Tl()||o===0;i.encoding.priority&&l&&(c.priority=i.encoding.priority,c.networkPriority=i.encoding.priority),r.push(c)}),lc()&&wP()==="ios"){let i;r.forEach(s=>{i?s.maxFramerate&&s.maxFramerate>i&&(i=s.maxFramerate):i=s.maxFramerate});let o=!0;r.forEach(s=>{var a;s.maxFramerate!=i&&(o&&(o=!1,Je.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Je.info('Setting framerate of encoding "'.concat((a=s.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),s.maxFramerate=i)})}return r}function SA(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class NP{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const Ej=5e3;class Kr extends Rl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Q.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>G(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const s=new Map(o.map(a=>[a.rid,a]));if(this.prevStats){let a=0;s.forEach((c,l)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(l);a+=gg(c,d)}),this._currentBitrate=a}this.prevStats=s}),this.senderLock=new Oi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!vr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},cI))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,o,s;return G(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,c=Pc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)o=l.value,a=!1,yield(s=o.sender)===null||s===void 0?void 0:s.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,o,s;return G(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,c=Pc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){o=l.value,a=!1;const u=o;yield(s=u.sender)===null||s===void 0?void 0:s.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return G(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const s={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(s.jitter=a.jitter,s.packetsLost=a.packetsLost,s.roundTripTime=a.roundTripTime),n.push(s)}}),n})}setPublishingQuality(e){const n=[];for(let r=an.LOW;r<=an.HIGH;r+=1)n.push(new Pi({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}setDeviceId(e){return G(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Ka(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ka(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,o;return G(this,void 0,void 0,function*(){let s;if(e){const u=pg({video:e});typeof u.video!="boolean"&&(s=u.video)}yield this.restart(s);try{for(var a=!0,c=Pc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){o=l.value,a=!1;const u=o;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,s,a,c,l;return G(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((c=this.processor)===null||c===void 0)&&c.processedTrack)try{for(var u=!0,d=Pc(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(this.processor.processedTrack)}catch(h){o={error:h}}finally{try{!u&&!i&&(s=d.return)&&(yield s.call(d))}finally{if(o)throw o.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Ej))}setPublishingCodecs(e){var n,r,i,o,s,a,c;return G(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=Pc(e);i=yield r.next(),o=i.done,!o;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const f of u.qualities)if(f.enabled){l.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield bA(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){s={error:u}}finally{try{!n&&!o&&(a=r.return)&&(yield a.call(r))}finally{if(s)throw s.error}}return l})}setPublishingLayers(e){return G(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield bA(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return G(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),SP()&&this.isInBackground&&this.source===Q.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function bA(t,e,n,r,i,o){return G(this,void 0,void 0,function*(){const s=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:c}=a;if(!c)return;if(c.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let l=!1;!1&&c[0].scalabilityMode||c.forEach((d,f)=>{var h;let p=(h=d.rid)!==null&&h!==void 0?h:"";p===""&&(p="q");const m=_P(p),C=n.find(g=>g.quality===m);C&&d.active!==C.enabled&&(l=!0,d.active=C.enabled,i.debug("setting layer ".concat(C.quality," to ").concat(d.active?"enabled":"disabled"),o),Tl()&&(C.enabled?(d.scaleResolutionDownBy=e[f].scaleResolutionDownBy,d.maxBitrate=e[f].maxBitrate,d.maxFrameRate=e[f].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),l&&(a.encodings=c,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:a.encodings})),yield t.setParameters(a))}finally{s()}})}function _P(t){switch(t){case"f":return an.HIGH;case"h":return an.MEDIUM;case"q":return an.LOW;default:return an.HIGH}}function wA(t,e,n,r){if(!n)return[new Yn({quality:an.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,o=new NP(i),s=[];for(let a=0;a<o.spatial;a+=1)s.push(new Yn({quality:an.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return s}return n.map(i=>{var o,s,a;const c=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let l=_P((s=i.rid)!==null&&s!==void 0?s:"");return new Yn({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class OP extends Q{constructor(e,n,r,i,o){super(e,r,o),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ye.Muted:ye.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(ye.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return G(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),cI))}}class Ja extends OP{constructor(e,n,r,i,o,s){super(e,n,Q.Kind.Audio,r,s),this.monitorReceiver=()=>G(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=gg(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;lc()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(lc())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return G(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(H0(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&H0(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ye.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(ye.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return G(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Mm=100;class Yu extends OP{constructor(e,n,r,i,o){super(e,n,Q.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>G(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=gg(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=nI(()=>{this.updateDimensions()},Mm),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?ol(this._mediaStreamTrack,n):Hc(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new Tj(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return G(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,n={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return G(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,o=this.elementInfos.some(a=>a.pictureInPicture),s=this.elementInfos.some(a=>a.visible)&&!i||o;if(this.lastVisible!==s){if(!s&&Date.now()-r<Mm){Sn.setTimeout(()=>{this.updateVisibility()},Mm);return}this.lastVisible=s,this.emit(ye.VisibilityChanged,s,this)}}updateDimensions(){var e,n;let r=0,i=0;const o=this.getPixelDensity();for(const s of this.elementInfos){const a=s.width()*o,c=s.height()*o;a+c>r+i&&(r=a,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(ye.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?oA():n||(oA()>2?2:1)}}class Tj{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:s}=r;o===this.element&&(this.isIntersecting=s,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??AA(e),this.isPiP=vr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=AA(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,aA().observe(this.element),sA().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=aA())===null||e===void 0||e.unobserve(this.element),(n=sA())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function AA(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:o}=t,{opacity:s,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(s!==""?parseFloat(s)>0:!0)&&a!=="none"}class No extends Ao.EventEmitter{constructor(e,n,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Cn.NONE,this.log=Je,this.handleMuted=()=>{this.emit(ye.Muted)},this.handleUnmuted=()=>{this.emit(ye.Unmuted)},this.log=vs((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:vo.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=Q.Source.Unknown}setTrack(e){this.track&&(this.track.off(ye.Muted,this.handleMuted),this.track.off(ye.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ye.Muted,this.handleMuted),e.on(ye.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),bt(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Cn.NONE}get audioTrack(){if(this.track instanceof cr||this.track instanceof Ja)return this.track}get videoTrack(){if(this.track instanceof Kr||this.track instanceof Yu)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Q.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Q.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(No||(No={}));class Od extends No{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ye.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(ye.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(ye.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return G(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return G(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return G(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return G(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var Qr;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Qr||(Qr={}));function Rj(t){switch(t){case Lo.EXCELLENT:return Qr.Excellent;case Lo.GOOD:return Qr.Good;case Lo.POOR:return Qr.Poor;case Lo.LOST:return Qr.Lost;default:return Qr.Unknown}}class MP extends Ao.EventEmitter{get logContext(){var e,n;return Object.assign(Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i,o){var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Qr.Unknown,this.log=Je,this.log=vs((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:vo.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(Q.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(Q.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Q.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(ae.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(ae.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,o,s;const a=this.permissions,c=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((s=this.permissions)===null||s===void 0?void 0:s.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((l,u)=>{var d;return l!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,c&&this.emit(ae.ParticipantPermissionsChanged,a),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ae.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=Rj(e),n!==this._connectionQuality&&this.emit(ae.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Ja||n.track instanceof cr)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ye.Muted,()=>{this.emit(ae.TrackMuted,e)}),e.on(ye.Unmuted,()=>{this.emit(ae.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Q.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Q.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function xj(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new co({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class lI extends No{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=an.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(ye.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new ei({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new qi({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ye.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?No.SubscriptionStatus.Unsubscribed:super.isSubscribed?No.SubscriptionStatus.Subscribed:No.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?No.PermissionStatus.Allowed:No.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof Yu&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Yu&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(ye.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(ye.VisibilityChanged,this.handleVisibilityChange),i.off(ye.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(ye.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ye.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ye.VisibilityChanged,this.handleVisibilityChange),e.on(ye.Ended,this.handleEnded),this.emit(ye.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ye.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ye.Muted:ye.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ye.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ye.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Q.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof Yu&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new io({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=an.HIGH,this.emit(ye.UpdateSettings,e)}}class Md extends MP{static fromParticipantInfo(e,n){return new Md(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,o,s){super(n,r||"",i,o,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ye.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),bt(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ye.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ye.SubscriptionPermissionChanged,n=>{this.emit(ae.TrackSubscriptionPermissionChanged,e,n)}),e.on(ye.SubscriptionStatusChanged,n=>{this.emit(ae.TrackSubscriptionStatusChanged,e,n)}),e.on(ye.Subscribed,n=>{this.emit(ae.TrackSubscribed,n,e)}),e.on(ye.Unsubscribed,n=>{this.emit(ae.TrackUnsubscribed,n,e)}),e.on(ye.SubscriptionFailed,n=>{this.emit(ae.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,o,s){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(s===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(ae.TrackSubscriptionFailed,n);return}s===void 0&&(s=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,o,s-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),bt(a))),this.emit(ae.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new Yu(e,n,i,o):l=new Ja(e,n,i,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(r),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof Ja&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var o,s;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const c=Q.kindFromProto(i.type);if(!c)return;a=new lI(c,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(s=this.loggerOptions)===null||s===void 0?void 0:s.loggerName}),a.updateInfo(i),r.set(i.sid,a);const l=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));l&&a.source!==Q.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:bt(l),newTrack:bt(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),bt(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(ae.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case Q.Kind.Audio:this.audioTracks.delete(e);break;case Q.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(ae.TrackUnpublished,r)}setAudioOutput(e){return G(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Ja&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class J0 extends MP{constructor(e,n,r,i){super(e,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Cn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new AP)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>xj(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),bt(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),bt(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),bt(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>G(this,void 0,void 0,function*(){var s,a,c,l,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(o.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!f.videoTrack)return;const C=yield f.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var h=!0,p=Pc(C),m;m=yield p.next(),s=m.done,!s;h=!0){l=m.value,h=!1;const g=l;x9(g)&&(this.log.debug("publish ".concat(g," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),bt(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,g,f.options))}}catch(g){a={error:g}}finally{try{!h&&!s&&(c=p.return)&&(yield c.call(p))}finally{if(a)throw a.error}}}else o.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.tracks.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>G(this,void 0,void 0,function*(){if(o.source===Q.Source.ScreenShare||o.source===Q.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),bt(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof cr||o instanceof Kr)try{if(vr())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===Q.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),bt(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),bt(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),bt(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Cn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(Ae.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(Ae.Connected,this.handleReconnected).on(Ae.SignalRestarted,this.handleReconnected).on(Ae.SignalResumed,this.handleReconnected).on(Ae.Restarting,this.handleReconnecting).on(Ae.Resuming,this.handleReconnecting).on(Ae.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Ae.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Ae.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(Q.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(Q.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(Q.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(ae.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return G(this,void 0,void 0,function*(){this.encryptionType=e?Cn.GCM:Cn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var o,s;return G(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n}));let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case Q.Source.Camera:c=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case Q.Source.Microphone:c=yield this.createTracks({audio:(s=r)!==null&&s!==void 0?s:!0});break;case Q.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Xi(e)}const l=[];for(const d of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),bt(d))),l.push(this.publishTrack(d,i));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&!(l instanceof Xi)&&this.emit(ae.MediaDevicesError,l),l}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===Q.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrack(Q.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return G(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Q.Source.Camera)||this.pendingPublishing.has(Q.Source.Microphone))){this.pendingPublishing.add(Q.Source.Camera),this.pendingPublishing.add(Q.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Q.Source.Camera),this.pendingPublishing.delete(Q.Source.Microphone)}}})}createTracks(e){var n,r;return G(this,void 0,void 0,function*(){const i=CP(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=pg(i);let s;try{s=yield navigator.mediaDevices.getUserMedia(o)}catch(a){throw a instanceof Error&&(o.audio&&(this.microphoneError=a),o.video&&(this.cameraError=a)),a}return o.audio&&(this.microphoneError=void 0,this.emit(ae.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),s.getTracks().map(a=>{const c=a.kind==="audio";c?e.audio:e.video;let l;const u=c?o.audio:o.video;typeof u!="boolean"&&(l=u);const d=PP(a,l,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===Q.Kind.Video?d.source=Q.Source.Camera:d.kind===Q.Kind.Audio&&(d.source=Q.Source.Microphone),d.mediaStream=s,d})})}createScreenTracks(e){return G(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new tI("getDisplayMedia not supported");e.resolution===void 0&&!j9()&&(e.resolution=rI.h1080fps30.resolution);const n=M9(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new Xi("no video track found");const o=new Kr(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=Q.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const s=[o];if(r.getAudioTracks().length>0){this.emit(ae.AudioStreamAcquired);const a=new cr(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=Q.Source.ScreenShareAudio,s.push(a)}return s})}publishTrack(e,n){var r,i,o,s;return G(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Rl&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case Q.Source.Microphone:h="audioinput";break;case Q.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new cr(e,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new Kr(e,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new Xi("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof cr&&e.setAudioContext(this.audioContext);let c;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(c=h)}),c)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),bt(c))),c;const l="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:l;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),bt(e))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=n.dtx)!==null&&o!==void 0||(n.dtx=!1),(s=n.red)!==null&&s!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);cc()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(e.source=d.source);const f=this.publish(e,d,u);this.pendingPublishPromises.set(e,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,o,s,a,c,l,u,d,f,h,p,m,C;return G(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(w=>e instanceof Rl&&w.source===e.source)&&e.source!==Q.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),bt(e))),n.stopMicTrackOnMute&&e instanceof cr&&(e.stopOnMute=!0),e.source===Q.Source.ScreenShare&&Tl()&&(n.simulcast=!1),n.videoCodec==="av1"&&!B9()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!U9()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=X0);const v=n.videoCodec;e.on(ye.Muted,this.onTrackMuted),e.on(ye.Unmuted,this.onTrackUnmuted),e.on(ye.Ended,this.handleTrackEnded),e.on(ye.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ye.UpstreamResumed,this.onTrackUpstreamResumed);const S=new Ei({cid:e.mediaStreamTrack.id,name:n.name,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n==null?void 0:n.stream});let k;if(e.kind===Q.Kind.Video){let w={width:0,height:0};try{w=yield e.waitForDimensions()}catch{const O=(a=(s=this.roomOptions.videoCaptureDefaults)===null||s===void 0?void 0:s.resolution)!==null&&a!==void 0?a:_d.h720.resolution;w={width:O.width,height:O.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),bt(e)),{dims:w}))}S.width=w.width,S.height=w.height,e instanceof Kr&&(Ku(v)&&(e.source===Q.Source.ScreenShare&&v==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),S.simulcastCodecs=[new ki({codec:v,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:X0}),n.backupCodec&&v!==n.backupCodec.codec&&S.encryption===Cn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),S.simulcastCodecs.push(new ki({codec:n.backupCodec.codec,cid:""})))),k=K0(e.source===Q.Source.ScreenShare,S.width,S.height,n),S.layers=wA(S.width,S.height,k,Ku(n.videoCodec))}else e.kind===Q.Kind.Audio&&(k=[{maxBitrate:(u=(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new tn("cannot publish track when not connected");const A=yield this.engine.addTrack(S);let R;if(A.codecs.forEach(w=>{R===void 0&&(R=w.mimeType)}),R&&e.kind===Q.Kind.Video){const w=IP(R);w!==v&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),bt(e)),{codec:w})),n.videoCodec=w,k=K0(e.source===Q.Source.ScreenShare,S.width,S.height,n))}const P=new Od(e.kind,A,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(P.options=n,e.sid=A.sid,!this.engine.pcManager)throw new tn("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:k,trackInfo:A})),e.sender=yield this.engine.createSender(e,n,k),k)if(Tl()&&e.kind===Q.Kind.Audio){let w;for(const _ of this.engine.pcManager.publisher.getTransceivers())if(_.sender===e.sender){w=_;break}w&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:w,codec:"opus",maxbr:!((m=k[0])===null||m===void 0)&&m.maxBitrate?k[0].maxBitrate/1e3:0})}else e.codec&&Ku(e.codec)&&(!((C=k[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:S.cid,codec:e.codec,maxbr:k[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof Kr?e.startMonitor(this.engine.client):e instanceof cr&&e.startMonitor(),this.addTrackPublication(P),this.emit(ae.LocalTrackPublished,P),P})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return G(this,void 0,void 0,function*(){if(this.encryptionType!==Cn.NONE)return;let o;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(o=d)}),!o)throw new Xi("track is not published");if(!(e instanceof Kr))throw new Xi("track is not a video track");const s=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=wj(e,n,s);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),bt(e)));return}const c=e.addSimulcastTrack(n,a),l=new Ei({cid:c.mediaStreamTrack.id,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:s.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=wA(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new tn("cannot publish track when not connected");const u=yield this.engine.addTrack(l);yield this.engine.createSimulcastSender(e,c,s,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(e,n){var r,i;return G(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(e),s=o?bt(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),s)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),s));return}e=o.track,e.off(ye.Muted,this.onTrackMuted),e.off(ye.Unmuted,this.onTrackUnmuted),e.off(ye.Ended,this.handleTrackEnded),e.off(ye.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ye.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let a=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<rn.FAILED&&c)try{for(const l of this.engine.pcManager.publisher.getTransceivers())l.sender===c&&(l.direction="inactive",a=!0);if(this.engine.removeTrack(c)&&(a=!0),e instanceof Kr){for(const[,l]of e.simulcastCodecs)l.sender&&(this.engine.removeTrack(l.sender)&&(a=!0),l.sender=void 0);e.simulcastCodecs.clear()}}catch(l){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),s),{error:l}))}switch(this.tracks.delete(o.trackSid),o.kind){case Q.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case Q.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(ae.LocalTrackUnpublished,o),o.setTrack(void 0),a&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return G(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Od)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return G(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>G(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),n&&!o.isMuted&&o.source!==Q.Source.ScreenShare&&o.source!==Q.Source.ScreenShareAudio&&(o instanceof cr||o instanceof Kr)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return G(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],s=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(c=>{c instanceof Md?o.push(c.sid):o.push(c)});const a=new Ji({kind:n,value:{case:"user",value:new Qi({participantSid:this.sid,payload:e,destinationSids:o,topic:s})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const o=this.tracks.get(n.sid);if(o){const s=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);s!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),bt(o)),{mutedOnServer:s})),this.engine.client.sendMuteTrack(n.sid,s))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof cr||i instanceof Kr)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var it;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(it||(it={}));const Pj=2*1e3;class Pp extends Ao.EventEmitter{constructor(e){var n,r,i;super(),n=this,this.state=it.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Je,this.bufferedEvents=[],this.connect=(o,s,a)=>G(this,void 0,void 0,function*(){var c;const l=yield this.disconnectLock.lock();if(this.state===it.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),l(),Promise.resolve();if(this.connectFuture)return l(),this.connectFuture.promise;this.setAndEmitConnectionState(it.Connecting),((c=this.regionUrlProvider)===null||c===void 0?void 0:c.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),z0(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new CA(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(f=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:f}))}));const u=(f,h,p)=>G(this,void 0,void 0,function*(){var m;this.abortController&&this.abortController.abort();const C=new AbortController;this.abortController=C,l==null||l();try{yield this.attemptConnection(p??o,s,a,C),this.abortController=void 0,f()}catch(g){if(this.regionUrlProvider&&g instanceof mt&&g.reason!==3&&g.reason!==0){let v=null;try{v=yield this.regionUrlProvider.getNextBestRegionUrl((m=this.abortController)===null||m===void 0?void 0:m.signal)}catch(S){if(S instanceof mt&&(S.status===401||S.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(S);return}}v?(this.log.info("Initial connection failed with ConnectionError: ".concat(g.message,". Retrying with another region: ").concat(v),this.logContext),yield u(f,h,v)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(g))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(g)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new AP((f,h)=>{u(f,h,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,a,c,l,u)=>G(this,void 0,void 0,function*(){var d,f,h;const p=yield a.join(o,s,{autoSubscribe:c.autoSubscribe,publishOnly:c.publishOnly,adaptiveStream:typeof l.adaptiveStream=="object"?!0:l.adaptiveStream,maxRetries:c.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:c.websocketTimeout},u.signal);let m=p.serverInfo;if(m||(m={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(m).map(C=>{let[g,v]=C;return"".concat(g,": ").concat(v)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(f=p.room)===null||f===void 0?void 0:f.sid,identity:(h=p.participant)===null||h===void 0?void 0:h.identity}),!p.serverVersion)throw new b9("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),l.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,s,a,c)=>G(this,void 0,void 0,function*(){var l,u;this.state===it.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((l=this.regionUrlProvider)===null||l===void 0)&&l.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},aI),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,c);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(ie.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const f=new mt("could not establish signal connection");throw d instanceof Error&&(f.message="".concat(f.message,": ").concat(d.message)),d instanceof mt&&(f.reason=d.reason,f.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),f}if(c.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new mt("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,c)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}vr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),vr()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(it.Connected),this.emit(ie.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return G(n,void 0,void 0,function*(){var s,a,c,l;const u=yield this.disconnectLock.lock();try{if(this.state===it.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===it.Connecting||this.state===it.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(s=this.abortController)===null||s===void 0||s.abort(),(c=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||c===void 0||c.call(a,new mt("Client initiated disconnect")),this.connectFuture=void 0),!((l=this.engine)===null||l===void 0)&&l.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,cs.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>G(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>G(this,void 0,void 0,function*(){const o=[],s=ys();if(s&&s.os==="iOS"){const a="livekit-dummy-audio-el";let c=document.getElementById(a);if(!c){c=document.createElement("audio"),c.id=a,c.autoplay=!0,c.hidden=!0;const l=Pm();l.enabled=!0;const u=new MediaStream([l]);c.srcObject=u,document.addEventListener("visibilitychange",()=>{c&&(c.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(c),this.once(ie.Disconnected,()=>{c==null||c.remove(),c=null})}o.push(c)}this.participants.forEach(a=>{a.audioTracks.forEach(c=>{c.track&&c.track.attachedElements.forEach(l=>{o.push(l)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>G(this,void 0,void 0,function*(){const o=[];for(const s of this.participants.values())s.videoTracks.forEach(a=>{var c;(c=a.track)===null||c===void 0||c.attachedElements.forEach(l=>{o.includes(l)||o.push(l)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(it.Reconnecting)&&this.emit(ie.Reconnecting)},this.handleSignalRestarted=o=>G(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(it.Connected),this.emit(ie.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const a=this.identityToSid.get(s.identity);a&&a!==s.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let c=this.participants.get(s.sid);const l=!c;s.state===sc.DISCONNECTED?this.handleParticipantDisconnected(s.sid,c):(c=this.getOrCreateParticipant(s.sid,s),l||c.updateInfo(s))})},this.handleActiveSpeakersUpdate=o=>{const s=[],a={};o.forEach(c=>{if(a[c.sid]=!0,c.sid===this.localParticipant.sid)this.localParticipant.audioLevel=c.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const l=this.participants.get(c.sid);l&&(l.audioLevel=c.level,l.setIsSpeaking(!0),s.push(l))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(c=>{a[c.sid]||(c.audioLevel=0,c.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ie.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(c=>{s.set(c.sid,c)}),o.forEach(c=>{let l=this.participants.get(c.sid);c.sid===this.localParticipant.sid&&(l=this.localParticipant),l&&(l.audioLevel=c.level,l.setIsSpeaking(c.active),c.active?s.set(c.sid,l):s.delete(c.sid))});const a=Array.from(s.values());a.sort((c,l)=>l.audioLevel-c.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(ie.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const a=this.participants.get(s.participantSid);if(!a)return;const c=a.getTrackPublication(s.trackSid);!c||!c.track||(c.track.streamState=Q.streamStateFromProto(s.state),a.emit(ae.TrackStreamStateChanged,c,c.track.streamState),this.emitWhenConnected(ie.TrackStreamStateChanged,c,c.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.participants.get(o.participantSid);if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.participants.values()).find(c=>c.tracks.has(o.trackSid));if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const a=this.participants.get(o.participantSid);this.emit(ie.DataReceived,o.payload,a,s,o.topic),a==null||a.emit(ae.DataReceived,o.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ie.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ie.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ie.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ie.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>G(this,void 0,void 0,function*(){this.emit(ie.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(ie.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(ie.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const a=this.participants.get(s.participantSid);a&&a.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(ie.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(ie.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(ie.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(ie.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>G(this,void 0,void 0,function*(){var s;this.emit(ie.LocalTrackPublished,o,this.localParticipant),o.track instanceof cr&&(yield o.track.checkForSilence())&&this.emit(ie.LocalAudioSilenceDetected,o);const a=yield(s=o.track)===null||s===void 0?void 0:s.getDeviceId(),c=O9(o.source);c&&a&&a!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,a),this.emit(ie.ActiveDeviceChanged,c,a))}),this.onLocalTrackUnpublished=o=>{this.emit(ie.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(ie.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(ie.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(ie.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},fj),e),this.log=vs((r=this.options.loggerName)!==null&&r!==void 0?r:vo.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},RP),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},xP),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},dj),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Oi,this.localParticipant=new J0("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Ka(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Ka(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",Ka(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return G(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new Y9(this.options.e2ee),this.e2eeManager.on(Ys.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof J0&&(this.isE2EEEnabled=n),this.emit(ie.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Ys.EncryptionError,n=>this.emit(ie.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new gj(this.options),this.engine.on(Ae.ParticipantUpdate,this.handleParticipantUpdates).on(Ae.RoomUpdate,this.handleRoomUpdate).on(Ae.SpeakersChanged,this.handleSpeakersChanged).on(Ae.StreamStateChanged,this.handleStreamStateUpdate).on(Ae.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Ae.SubscriptionError,this.handleSubscriptionError).on(Ae.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Ae.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(Ae.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Ae.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Ae.DataPacketReceived,this.handleDataPacket).on(Ae.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(it.Reconnecting)&&this.emit(ie.Reconnecting)}).on(Ae.Resumed,()=>{this.setAndEmitConnectionState(it.Connected),this.emit(ie.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(Ae.SignalResumed,()=>{this.bufferedEvents=[],this.state===it.Reconnecting&&this.sendSyncState()}).on(Ae.Restarting,this.handleRestarting).on(Ae.SignalRestarted,this.handleSignalRestarted).on(Ae.DCBufferStatusChanged,(e,n)=>{this.emit(ie.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return $n.getInstance().getDevices(e,n)}prepareConnection(e,n){return G(this,void 0,void 0,function*(){if(this.state===it.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(z0(new URL(e))&&n){this.regionUrlProvider=new CA(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===it.Disconnected&&(this.regionUrl=r,yield fetch(lA(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(lA(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return G(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new yn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new yn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new yn({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new yn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>G(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new yn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>G(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new yn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new yn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>G(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new ti({reason:cs.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new yn({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,s;return G(this,void 0,void 0,function*(){let a=!1,c=!0;const l=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===Q.Source.Microphone);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===Q.Source.Camera);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(e==="audiooutput"){if(!H0()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(s=this.options).audioOutput)!==null&&i!==void 0||(s.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==l;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&c&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ie.ActiveDeviceChanged,e,n)),c})}setupLocalParticipantEvents(){this.localParticipant.on(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ae.TrackMuted,this.onLocalTrackMuted).on(ae.TrackUnmuted,this.onLocalTrackUnmuted).on(ae.LocalTrackPublished,this.onLocalTrackPublished).on(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ae.MediaDevicesError,this.onMediaDevicesError).on(ae.AudioStreamAcquired,this.startAudio).on(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===it.Connecting||this.state===it.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ie.Reconnected,u),this.off(ie.Connected,u),this.off(ie.Disconnected,d)};this.once(ie.Reconnected,u),this.once(ie.Connected,u),this.once(ie.Disconnected,d);return}if(this.state===it.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=F9(n.id),o=i[0];let s=i[1],a=e.id;if(s&&s.startsWith("TR")&&(a=s),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=this.participants.get(o);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,a,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==it.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((o=i.track)===null||o===void 0||o.detach(),(s=i.track)===null||s===void 0||s.stop())}),this.localParticipant.off(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ae.TrackMuted,this.onLocalTrackMuted).off(ae.TrackUnmuted,this.onLocalTrackUnmuted).off(ae.LocalTrackPublished,this.onLocalTrackPublished).off(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ae.MediaDevicesError,this.onMediaDevicesError).off(ae.AudioStreamAcquired,this.startAudio).off(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),vr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(it.Disconnected),this.emit(ie.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ie.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return G(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=iI())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ie.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=Md.fromParticipantInfo(this.engine.client,n):i=new Md(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ie.ParticipantConnected,r),r.on(ae.TrackPublished,i=>{this.emitWhenConnected(ie.TrackPublished,i,r)}).on(ae.TrackSubscribed,(i,o)=>{i.kind===Q.Kind.Audio?(i.on(ye.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(ye.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Q.Kind.Video&&(i.on(ye.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(ye.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ie.TrackSubscribed,i,o,r)}).on(ae.TrackUnpublished,i=>{this.emit(ie.TrackUnpublished,i,r)}).on(ae.TrackUnsubscribed,(i,o)=>{this.emit(ie.TrackUnsubscribed,i,o,r)}).on(ae.TrackSubscriptionFailed,i=>{this.emit(ie.TrackSubscriptionFailed,i,r)}).on(ae.TrackMuted,i=>{this.emitWhenConnected(ie.TrackMuted,i,r)}).on(ae.TrackUnmuted,i=>{this.emitWhenConnected(ie.TrackUnmuted,i,r)}).on(ae.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ie.ParticipantMetadataChanged,i,r)}).on(ae.ParticipantNameChanged,i=>{this.emitWhenConnected(ie.ParticipantNameChanged,i,r)}).on(ae.ConnectionQualityChanged,i=>{this.emitWhenConnected(ie.ConnectionQualityChanged,i,r)}).on(ae.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ie.ParticipantPermissionsChanged,i,r)}).on(ae.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ie.TrackSubscriptionStatusChanged,i,o,r)}).on(ae.TrackSubscriptionFailed,(i,o)=>{this.emit(ie.TrackSubscriptionFailed,i,r,o)}).on(ae.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ie.TrackSubscriptionPermissionChanged,i,o,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof lI&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Sn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,cs.STATE_MISMATCH))):e=0},Pj)}clearConnectionReconcile(){this.connectionReconcileInterval&&Sn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ie.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===it.Connected?this.emit(e,...r):(this.state===it.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var n,r;return G(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Zl({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ve.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Fr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ie.SignalConnected),this.emit(ie.Connected),this.setAndEmitConnectionState(it.Connected),i.video){const s=new Od(Q.Kind.Video,new hr({source:jt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Dn.AUDIO,name:"video-dummy"}),new Kr(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:cA(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(ae.LocalTrackPublished,s)}if(i.audio){const s=new Od(Q.Kind.Audio,new hr({source:jt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Dn.AUDIO}),new cr(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Pm(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(ae.LocalTrackPublished,s)}for(let s=0;s<o.count-1;s+=1){let a=new Fr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(s),state:sc.ACTIVE,tracks:[],joinedAt:Ve.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(o.video){const l=cA(160*((r=o.aspectRatios[s%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new hr({source:jt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Dn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}if(o.audio){const l=Pm(),u=new hr({source:jt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Dn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==ie.ActiveSpeakersChanged){const o=DP(r).filter(s=>s!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}function DP(t){return t.map(e=>{if(e)return Array.isArray(e)?DP(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var bi;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(bi||(bi={}));class zl extends Ao.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=bi.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Pp(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return G(this,void 0,void 0,function*(){if(this.status!==bi.IDLE)throw Error("check is running already");this.setStatus(bi.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==bi.SKIPPED&&this.setStatus(this.isSuccess()?bi.SUCCESS:bi.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return G(this,void 0,void 0,function*(){return this.room.state===it.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return G(this,void 0,void 0,function*(){this.room&&this.room.state!==it.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(bi.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function LP(t){var e,n;return G(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=CP(t,RP,xP),i=pg(r),o=navigator.mediaDevices.getUserMedia(i);t.audio&&($n.userMediaPromiseMap.set("audioinput",o),o.catch(()=>$n.userMediaPromiseMap.delete("audioinput"))),t.video&&($n.userMediaPromiseMap.set("videoinput",o),o.catch(()=>$n.userMediaPromiseMap.delete("videoinput")));const s=yield o;return s.getTracks().map(a=>{const c=a.kind==="audio";c?t.audio:t.video;let l;const u=c?i.audio:i.video;typeof u!="boolean"&&(l=u),l?l.deviceId=a.getSettings().deviceId:l={deviceId:a.getSettings().deviceId};const d=PP(a,l);return d.kind===Q.Kind.Video?d.source=Q.Source.Camera:d.kind===Q.Kind.Audio&&(d.source=Q.Source.Microphone),d.mediaStream=s,d})})}function Nj(t){return G(this,void 0,void 0,function*(){return(yield LP({audio:!1,video:t}))[0]})}function _j(t){return G(this,void 0,void 0,function*(){return(yield LP({audio:t,video:!1}))[0]})}class Oj extends zl{get description(){return"Can publish audio"}perform(){var e;return G(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield _j();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="audio"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class Mj extends zl{get description(){return"Can publish video"}perform(){var e;return G(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield Nj();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="video"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class Dj extends zl{get description(){return"Resuming connection after interruption"}perform(){var e;return G(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,o;const s=new Promise(c=>{setTimeout(c,5e3),o=c});n.on(ie.Reconnecting,()=>{r=!0}).on(ie.Reconnected,()=>{i=!0,o(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield s,r){if(!i||n.state!==it.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Lj extends zl{get description(){return"Can connect via TURN"}perform(){var e,n;return G(this,void 0,void 0,function*(){const r=new sI,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,s=!1,a=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(s=!0,a=!0):l.startsWith("turns:")&&(s=!0,a=!0,o=!0),l.startsWith("stun:")&&(a=!0);a?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class Fj extends zl{get description(){return"Establishing WebRTC connection"}perform(){return G(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ie.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const s=new RTCIceCandidate(i);let a="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&(Bj(s.address)?a+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(e=!0,a+=" (passive)"):s.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),Je.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Bj(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class Uj extends zl{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return G(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new sI;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===kl.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class _z extends Ao.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:bi.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==bi.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return G(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=s=>{this.updateCheck(n,s)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Uj)})}checkWebRTC(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Fj)})}checkTURN(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Lj)})}checkReconnect(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Dj)})}checkPublishAudio(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Oj)})}checkPublishVideo(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Mj)})}}function Vj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof Rl?t.mediaStreamTrack:t,i=r.getSettings();let o={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const s=i.facingMode;Je.debug("rawFacingMode",{rawFacingMode:s}),s&&typeof s=="string"&&jj(s)&&(o={facingMode:s,confidence:"high"})}if(["low","medium"].includes(o.confidence)){Je.debug("Try to get facing mode from device label: (".concat(r.label,")"));const s=Wj(r.label);s!==void 0&&(o=s)}return o}const kA=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),Gj=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function Wj(t){var e;const n=t.trim().toLowerCase();if(n!=="")return kA.has(n)?kA.get(n):(e=Array.from(Gj.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function jj(t){return t===void 0||["user","environment","left","right"].includes(t)}const Y0=Math.min,al=Math.max,Np=Math.round,fa=t=>({x:t,y:t}),Zj={left:"right",right:"left",bottom:"top",top:"bottom"},Hj={start:"end",end:"start"};function EA(t,e,n){return al(t,Y0(e,n))}function mg(t,e){return typeof t=="function"?t(e):t}function uc(t){return t.split("-")[0]}function vg(t){return t.split("-")[1]}function FP(t){return t==="x"?"y":"x"}function BP(t){return t==="y"?"height":"width"}function xl(t){return["top","bottom"].includes(uc(t))?"y":"x"}function UP(t){return FP(xl(t))}function zj(t,e,n){n===void 0&&(n=!1);const r=vg(t),i=UP(t),o=BP(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=_p(s)),[s,_p(s)]}function Xj(t){const e=_p(t);return[Q0(t),e,Q0(e)]}function Q0(t){return t.replace(/start|end/g,e=>Hj[e])}function $j(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function Kj(t,e,n,r){const i=vg(t);let o=$j(uc(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(Q0)))),o}function _p(t){return t.replace(/left|right|bottom|top/g,e=>Zj[e])}function Jj(t){return{top:0,right:0,bottom:0,left:0,...t}}function Yj(t){return typeof t!="number"?Jj(t):{top:t,right:t,bottom:t,left:t}}function Op(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function TA(t,e,n){let{reference:r,floating:i}=t;const o=xl(e),s=UP(e),a=BP(s),c=uc(e),l=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(c){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(vg(e)){case"start":h[s]-=f*(n&&l?-1:1);break;case"end":h[s]+=f*(n&&l?-1:1);break}return h}const Qj=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(e));let l=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=TA(l,r,c),f=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:C,fn:g}=a[m],{x:v,y:S,data:k,reset:A}=await g({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:l,platform:s,elements:{reference:t,floating:e}});u=v??u,d=S??d,h={...h,[C]:{...h[C],...k}},A&&p<=50&&(p++,typeof A=="object"&&(A.placement&&(f=A.placement),A.rects&&(l=A.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):A.rects),{x:u,y:d}=TA(l,f,c)),m=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function VP(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=mg(e,t),p=Yj(h),C=a[f?d==="floating"?"reference":"floating":d],g=Op(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),k=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},A=Op(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:S,strategy:c}):v);return{top:(g.top-A.top+p.top)/k.y,bottom:(A.bottom-g.bottom+p.bottom)/k.y,left:(g.left-A.left+p.left)/k.x,right:(A.right-g.right+p.right)/k.x}}const qj=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...C}=mg(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const g=uc(i),v=xl(a),S=uc(a)===a,k=await(c.isRTL==null?void 0:c.isRTL(l.floating)),A=f||(S||!m?[_p(a)]:Xj(a)),R=p!=="none";!f&&R&&A.push(...Kj(a,m,p,k));const P=[a,...A],w=await VP(e,C),_=[];let O=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&_.push(w[g]),d){const H=zj(i,s,k);_.push(w[H[0]],w[H[1]])}if(O=[...O,{placement:i,overflows:_}],!_.every(H=>H<=0)){var L,U;const H=(((L=o.flip)==null?void 0:L.index)||0)+1,J=P[H];if(J)return{data:{index:H,overflows:O},reset:{placement:J}};let te=(U=O.filter(le=>le.overflows[0]<=0).sort((le,$)=>le.overflows[1]-$.overflows[1])[0])==null?void 0:U.placement;if(!te)switch(h){case"bestFit":{var X;const le=(X=O.filter($=>{if(R){const z=xl($.placement);return z===v||z==="y"}return!0}).map($=>[$.placement,$.overflows.filter(z=>z>0).reduce((z,se)=>z+se,0)]).sort(($,z)=>$[1]-z[1])[0])==null?void 0:X[0];le&&(te=le);break}case"initialPlacement":te=a;break}if(i!==te)return{reset:{placement:te}}}return{}}}};async function e6(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=uc(n),a=vg(n),c=xl(n)==="y",l=["left","top"].includes(s)?-1:1,u=o&&c?-1:1,d=mg(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),c?{x:h*u,y:f*l}:{x:f*l,y:h*u}}const t6=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,c=await e6(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:o+c.y,data:{...c,placement:s}}}}},n6=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:C=>{let{x:g,y:v}=C;return{x:g,y:v}}},...c}=mg(t,e),l={x:n,y:r},u=await VP(e,c),d=xl(uc(i)),f=FP(d);let h=l[f],p=l[d];if(o){const C=f==="y"?"top":"left",g=f==="y"?"bottom":"right",v=h+u[C],S=h-u[g];h=EA(v,h,S)}if(s){const C=d==="y"?"top":"left",g=d==="y"?"bottom":"right",v=p+u[C],S=p-u[g];p=EA(v,p,S)}const m=a.fn({...e,[f]:h,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[f]:o,[d]:s}}}}}};function yg(){return typeof window<"u"}function Xl(t){return GP(t)?(t.nodeName||"").toLowerCase():"#document"}function Ur(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function bs(t){var e;return(e=(GP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function GP(t){return yg()?t instanceof Node||t instanceof Ur(t).Node:!1}function Fi(t){return yg()?t instanceof Element||t instanceof Ur(t).Element:!1}function yo(t){return yg()?t instanceof HTMLElement||t instanceof Ur(t).HTMLElement:!1}function RA(t){return!yg()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ur(t).ShadowRoot}function tf(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Bi(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function r6(t){return["table","td","th"].includes(Xl(t))}function Cg(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function uI(t){const e=dI(),n=Fi(t)?Bi(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function i6(t){let e=ha(t);for(;yo(e)&&!Pl(e);){if(uI(e))return e;if(Cg(e))return null;e=ha(e)}return null}function dI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Pl(t){return["html","body","#document"].includes(Xl(t))}function Bi(t){return Ur(t).getComputedStyle(t)}function Ig(t){return Fi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ha(t){if(Xl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||RA(t)&&t.host||bs(t);return RA(e)?e.host:e}function WP(t){const e=ha(t);return Pl(e)?t.ownerDocument?t.ownerDocument.body:t.body:yo(e)&&tf(e)?e:WP(e)}function q0(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=WP(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=Ur(i);if(o){const a=ey(s);return e.concat(s,s.visualViewport||[],tf(i)?i:[],a&&n?q0(a):[])}return e.concat(i,q0(i,[],n))}function ey(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function jP(t){const e=Bi(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=yo(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=Np(n)!==o||Np(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function ZP(t){return Fi(t)?t:t.contextElement}function cl(t){const e=ZP(t);if(!yo(e))return fa(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=jP(e);let s=(o?Np(n.width):n.width)/r,a=(o?Np(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const o6=fa(0);function HP(t){const e=Ur(t);return!dI()||!e.visualViewport?o6:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function s6(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ur(t)?!1:e}function Dd(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=ZP(t);let s=fa(1);e&&(r?Fi(r)&&(s=cl(r)):s=cl(t));const a=s6(o,n,r)?HP(o):fa(0);let c=(i.left+a.x)/s.x,l=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const f=Ur(o),h=r&&Fi(r)?Ur(r):r;let p=f,m=ey(p);for(;m&&r&&h!==p;){const C=cl(m),g=m.getBoundingClientRect(),v=Bi(m),S=g.left+(m.clientLeft+parseFloat(v.paddingLeft))*C.x,k=g.top+(m.clientTop+parseFloat(v.paddingTop))*C.y;c*=C.x,l*=C.y,u*=C.x,d*=C.y,c+=S,l+=k,p=Ur(m),m=ey(p)}}return Op({width:u,height:d,x:c,y:l})}function a6(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=bs(r),a=e?Cg(e.floating):!1;if(r===s||a&&o)return n;let c={scrollLeft:0,scrollTop:0},l=fa(1);const u=fa(0),d=yo(r);if((d||!d&&!o)&&((Xl(r)!=="body"||tf(s))&&(c=Ig(r)),yo(r))){const f=Dd(r);l=cl(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function c6(t){return Array.from(t.getClientRects())}function ty(t,e){const n=Ig(t).scrollLeft;return e?e.left+n:Dd(bs(t)).left+n}function l6(t){const e=bs(t),n=Ig(t),r=t.ownerDocument.body,i=al(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=al(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+ty(t);const a=-n.scrollTop;return Bi(r).direction==="rtl"&&(s+=al(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function u6(t,e){const n=Ur(t),r=bs(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,c=0;if(i){o=i.width,s=i.height;const l=dI();(!l||l&&e==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:o,height:s,x:a,y:c}}function d6(t,e){const n=Dd(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=yo(t)?cl(t):fa(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,c=i*o.x,l=r*o.y;return{width:s,height:a,x:c,y:l}}function xA(t,e,n){let r;if(e==="viewport")r=u6(t,n);else if(e==="document")r=l6(bs(t));else if(Fi(e))r=d6(e,n);else{const i=HP(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Op(r)}function zP(t,e){const n=ha(t);return n===e||!Fi(n)||Pl(n)?!1:Bi(n).position==="fixed"||zP(n,e)}function f6(t,e){const n=e.get(t);if(n)return n;let r=q0(t,[],!1).filter(a=>Fi(a)&&Xl(a)!=="body"),i=null;const o=Bi(t).position==="fixed";let s=o?ha(t):t;for(;Fi(s)&&!Pl(s);){const a=Bi(s),c=uI(s);!c&&a.position==="fixed"&&(i=null),(o?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||tf(s)&&!c&&zP(t,s))?r=r.filter(u=>u!==s):i=a,s=ha(s)}return e.set(t,r),r}function h6(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?Cg(e)?[]:f6(e,this._c):[].concat(n),r],a=s[0],c=s.reduce((l,u)=>{const d=xA(e,u,i);return l.top=al(d.top,l.top),l.right=Y0(d.right,l.right),l.bottom=Y0(d.bottom,l.bottom),l.left=al(d.left,l.left),l},xA(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function p6(t){const{width:e,height:n}=jP(t);return{width:e,height:n}}function g6(t,e,n){const r=yo(e),i=bs(e),o=n==="fixed",s=Dd(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const c=fa(0);if(r||!r&&!o)if((Xl(e)!=="body"||tf(i))&&(a=Ig(e)),r){const h=Dd(e,!0,o,e);c.x=h.x+e.clientLeft,c.y=h.y+e.clientTop}else i&&(c.x=ty(i));let l=0,u=0;if(i&&!r&&!o){const h=i.getBoundingClientRect();u=h.top+a.scrollTop,l=h.left+a.scrollLeft-ty(i,h)}const d=s.left+a.scrollLeft-c.x-l,f=s.top+a.scrollTop-c.y-u;return{x:d,y:f,width:s.width,height:s.height}}function Dm(t){return Bi(t).position==="static"}function PA(t,e){if(!yo(t)||Bi(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return bs(t)===n&&(n=n.ownerDocument.body),n}function XP(t,e){const n=Ur(t);if(Cg(t))return n;if(!yo(t)){let i=ha(t);for(;i&&!Pl(i);){if(Fi(i)&&!Dm(i))return i;i=ha(i)}return n}let r=PA(t,e);for(;r&&r6(r)&&Dm(r);)r=PA(r,e);return r&&Pl(r)&&Dm(r)&&!uI(r)?n:r||i6(t)||n}const m6=async function(t){const e=this.getOffsetParent||XP,n=this.getDimensions,r=await n(t.floating);return{reference:g6(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function v6(t){return Bi(t).direction==="rtl"}const y6={convertOffsetParentRelativeRectToViewportRelativeRect:a6,getDocumentElement:bs,getClippingRect:h6,getOffsetParent:XP,getElementRects:m6,getClientRects:c6,getDimensions:p6,getScale:cl,isElement:Fi,isRTL:v6},C6=t6,I6=n6,S6=qj,b6=(t,e,n)=>{const r=new Map,i={platform:y6,...n},o={...i.platform,_c:r};return Qj(t,e,{...i,platform:o})};var $P={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(HN,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},s=null;function a(m,C){var g=m[C];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?c:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function u(){for(var m=this.getLevel(),C=0;C<i.length;C++){var g=i[C];this[g]=C<m?e:this.methodFactory(g,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(u.call(this),this[m].apply(this,arguments))}}function f(m,C,g){return l(m)||d.apply(this,arguments)}function h(m,C){var g=this,v,S,k,A="loglevel";typeof m=="string"?A+=":"+m:typeof m=="symbol"&&(A=void 0);function R(L){var U=(i[L]||"silent").toUpperCase();if(!(typeof window===n||!A)){try{window.localStorage[A]=U;return}catch{}try{window.document.cookie=encodeURIComponent(A)+"="+U+";"}catch{}}}function P(){var L;if(!(typeof window===n||!A)){try{L=window.localStorage[A]}catch{}if(typeof L===n)try{var U=window.document.cookie,X=encodeURIComponent(A),H=U.indexOf(X+"=");H!==-1&&(L=/^([^;]+)/.exec(U.slice(H+X.length+1))[1])}catch{}return g.levels[L]===void 0&&(L=void 0),L}}function w(){if(!(typeof window===n||!A)){try{window.localStorage.removeItem(A)}catch{}try{window.document.cookie=encodeURIComponent(A)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function _(L){var U=L;if(typeof U=="string"&&g.levels[U.toUpperCase()]!==void 0&&(U=g.levels[U.toUpperCase()]),typeof U=="number"&&U>=0&&U<=g.levels.SILENT)return U;throw new TypeError("log.setLevel() called with invalid level: "+L)}g.name=m,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=C||f,g.getLevel=function(){return k??S??v},g.setLevel=function(L,U){return k=_(L),U!==!1&&R(k),u.call(g)},g.setDefaultLevel=function(L){S=_(L),P()||g.setLevel(L,!1)},g.resetLevel=function(){k=null,w(),u.call(g)},g.enableAll=function(L){g.setLevel(g.levels.TRACE,L)},g.disableAll=function(L){g.setLevel(g.levels.SILENT,L)},g.rebuild=function(){if(s!==g&&(v=_(s.getLevel())),u.call(g),s===g)for(var L in o)o[L].rebuild()},v=_(s?s.getLevel():"WARN");var O=P();O!=null&&(k=_(O)),u.call(g)}s=new h,s.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var g=o[C];return g||(g=o[C]=new h(C,s.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return s.noConflict=function(){return typeof window!==n&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return o},s.default=s,s})})($P);var w6=$P.exports;const A6=Ud(w6);function cn(t){return typeof t=="function"}function KP(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Lm=KP(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function ny(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Sg=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=wl(s),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(m){e={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var u=this.initialTeardown;if(cn(u))try{u()}catch(m){o=m instanceof Lm?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=wl(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{NA(p)}catch(m){o=o??[],m instanceof Lm?o=b0(b0([],S0(o)),S0(m.errors)):o.push(m)}}}catch(m){r={error:m}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(o)throw new Lm(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)NA(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&ny(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&ny(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),JP=Sg.EMPTY;function YP(t){return t instanceof Sg||t&&"closed"in t&&cn(t.remove)&&cn(t.add)&&cn(t.unsubscribe)}function NA(t){cn(t)?t():t.unsubscribe()}var QP={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},qP={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,b0([t,e],S0(n)))},clearTimeout:function(t){var e=qP.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function eN(t){qP.setTimeout(function(){throw t})}function ry(){}function Nh(t){t()}var fI=function(t){jl(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,YP(n)&&n.add(r)):r.destination=R6,r}return e.create=function(n,r,i){return new iy(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Sg),k6=Function.prototype.bind;function Fm(t,e){return k6.call(t,e)}var E6=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){jf(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){jf(r)}else jf(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){jf(n)}},t}(),iy=function(t){jl(e,t);function e(n,r,i){var o=t.call(this)||this,s;if(cn(n)||!n)s={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;o&&QP.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return o.unsubscribe()},s={next:n.next&&Fm(n.next,a),error:n.error&&Fm(n.error,a),complete:n.complete&&Fm(n.complete,a)}):s=n}return o.destination=new E6(s),o}return e}(fI);function jf(t){eN(t)}function T6(t){throw t}var R6={closed:!0,next:ry,error:T6,complete:ry},hI=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function tN(t){return t}function x6(t){return t.length===0?tN:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Tn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=N6(e)?e:new iy(e,n,r);return Nh(function(){var s=i,a=s.operator,c=s.source;o.add(a?a.call(o,c):c?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=_A(n),new n(function(i,o){var s=new iy({next:function(a){try{e(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[hI]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return x6(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=_A(e),new e(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function _A(t){var e;return(e=t??QP.Promise)!==null&&e!==void 0?e:Promise}function P6(t){return t&&cn(t.next)&&cn(t.error)&&cn(t.complete)}function N6(t){return t&&t instanceof fI||P6(t)&&YP(t)}function _6(t){return cn(t==null?void 0:t.lift)}function ws(t){return function(e){if(_6(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function dc(t,e,n,r,i){return new O6(t,e,n,r,i)}var O6=function(t){jl(e,t);function e(n,r,i,o,s,a){var c=t.call(this,n)||this;return c.onFinalize=s,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){n.error(u)}}:t.prototype._next,c._error=o?function(l){try{o(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(fI),M6=KP(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),pa=function(t){jl(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new OA(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new M6},e.prototype.next=function(n){var r=this;Nh(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=wl(r.currentObservers),a=s.next();!a.done;a=s.next()){var c=a.value;c.next(n)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;Nh(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;Nh(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?JP:(this.currentObservers=null,a.push(n),new Sg(function(){r.currentObservers=null,ny(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},e.prototype.asObservable=function(){var n=new Tn;return n.source=this,n},e.create=function(n,r){return new OA(n,r)},e}(Tn),OA=function(t){jl(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:JP},e}(pa),nN=function(t){jl(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(pa);function D6(t){return t&&cn(t.schedule)}function L6(t){return t[t.length-1]}function rN(t){return D6(L6(t))?t.pop():void 0}var iN=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function oN(t){return cn(t==null?void 0:t.then)}function sN(t){return cn(t[hI])}function aN(t){return Symbol.asyncIterator&&cn(t==null?void 0:t[Symbol.asyncIterator])}function cN(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function F6(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var lN=F6();function uN(t){return cn(t==null?void 0:t[lN])}function dN(t){return UV(this,arguments,function(){var n,r,i,o;return BR(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,el(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,el(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,el(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function fN(t){return cn(t==null?void 0:t.getReader)}function $l(t){if(t instanceof Tn)return t;if(t!=null){if(sN(t))return B6(t);if(iN(t))return U6(t);if(oN(t))return V6(t);if(aN(t))return hN(t);if(uN(t))return G6(t);if(fN(t))return W6(t)}throw cN(t)}function B6(t){return new Tn(function(e){var n=t[hI]();if(cn(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function U6(t){return new Tn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function V6(t){return new Tn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,eN)})}function G6(t){return new Tn(function(e){var n,r;try{for(var i=wl(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function hN(t){return new Tn(function(e){j6(t,e).catch(function(n){return e.error(n)})})}function W6(t){return hN(dN(t))}function j6(t,e){var n,r,i,o;return BV(this,void 0,void 0,function(){var s,a;return BR(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=VV(t),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Ya(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function pN(t,e){return e===void 0&&(e=0),ws(function(n,r){n.subscribe(dc(r,function(i){return Ya(r,t,function(){return r.next(i)},e)},function(){return Ya(r,t,function(){return r.complete()},e)},function(i){return Ya(r,t,function(){return r.error(i)},e)}))})}function gN(t,e){return e===void 0&&(e=0),ws(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function Z6(t,e){return $l(t).pipe(gN(e),pN(e))}function H6(t,e){return $l(t).pipe(gN(e),pN(e))}function z6(t,e){return new Tn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function X6(t,e){return new Tn(function(n){var r;return Ya(n,e,function(){r=t[lN](),Ya(n,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return cn(r==null?void 0:r.return)&&r.return()}})}function mN(t,e){if(!t)throw new Error("Iterable cannot be null");return new Tn(function(n){Ya(n,e,function(){var r=t[Symbol.asyncIterator]();Ya(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function $6(t,e){return mN(dN(t),e)}function K6(t,e){if(t!=null){if(sN(t))return Z6(t,e);if(iN(t))return z6(t,e);if(oN(t))return H6(t,e);if(aN(t))return mN(t,e);if(uN(t))return X6(t,e);if(fN(t))return $6(t,e)}throw cN(t)}function J6(t,e){return e?K6(t,e):$l(t)}function or(t,e){return ws(function(n,r){var i=0;n.subscribe(dc(r,function(o){r.next(t.call(e,o,i++))}))})}function Y6(t,e,n,r,i,o,s,a){var c=[],l=0,u=0,d=!1,f=function(){d&&!c.length&&!l&&e.complete()},h=function(m){return l<r?p(m):c.push(m)},p=function(m){l++;var C=!1;$l(n(m,u++)).subscribe(dc(e,function(g){e.next(g)},function(){C=!0},void 0,function(){if(C)try{l--;for(var g=function(){var v=c.shift();s||p(v)};c.length&&l<r;)g();f()}catch(v){e.error(v)}}))};return t.subscribe(dc(e,h,function(){d=!0,f()})),function(){}}function vN(t,e,n){return n===void 0&&(n=1/0),cn(e)?vN(function(r,i){return or(function(o,s){return e(r,o,i,s)})($l(t(r,i)))},n):(typeof e=="number"&&(n=e),ws(function(r,i){return Y6(r,i,t,n)}))}function Q6(t){return vN(tN,t)}function q6(){return Q6(1)}function oy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return q6()(J6(t,rN(t)))}function yN(t,e){return ws(function(n,r){var i=0;n.subscribe(dc(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function eZ(t,e,n,r,i){return function(o,s){var a=n,c=e,l=0;o.subscribe(dc(s,function(u){var d=l++;c=a?t(c,u,d):(a=!0,u),s.next(c)},i))}}function tZ(t){return ws(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function nZ(t,e){return ws(eZ(t,e,arguments.length>=2,!0))}function Vi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=rN(t);return ws(function(r,i){(n?oy(t,r,n):oy(t,r)).subscribe(i)})}function MA(t){return ws(function(e,n){$l(t).subscribe(dc(n,function(){return n.complete()},ry)),!n.closed&&e.subscribe(n)})}var rZ=Object.defineProperty,iZ=Object.defineProperties,oZ=Object.getOwnPropertyDescriptors,Mp=Object.getOwnPropertySymbols,CN=Object.prototype.hasOwnProperty,IN=Object.prototype.propertyIsEnumerable,DA=(t,e,n)=>e in t?rZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sy=(t,e)=>{for(var n in e||(e={}))CN.call(e,n)&&DA(t,n,e[n]);if(Mp)for(var n of Mp(e))IN.call(e,n)&&DA(t,n,e[n]);return t},sZ=(t,e)=>iZ(t,oZ(e)),aZ=(t,e)=>{var n={};for(var r in t)CN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Mp)for(var r of Mp(t))e.indexOf(r)<0&&IN.call(t,r)&&(n[r]=t[r]);return n},As=(t,e,n)=>new Promise((r,i)=>{var o=c=>{try{a(n.next(c))}catch(l){i(l)}},s=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((n=n.apply(t,e)).next())}),SN="lk";function pI(t){return typeof t>"u"?!1:cZ(t)||lZ(t)}function cZ(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function lZ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function uZ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function bN(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(uZ(t))return`${t.participant.identity}_${t.source}_placeholder`;if(pI(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function dZ(t){return t instanceof J0}function fZ(t,e){return As(this,null,function*(){const{x:n,y:r}=yield b6(t,e,{placement:"top",middleware:[C6(6),S6(),I6({padding:5})]});return{x:n,y:r}})}function hZ(t,e){return!t.contains(e.target)}var pZ=[ie.ConnectionStateChanged,ie.RoomMetadataChanged,ie.ActiveSpeakersChanged,ie.ConnectionQualityChanged,ie.ParticipantConnected,ie.ParticipantDisconnected,ie.ParticipantPermissionsChanged,ie.ParticipantMetadataChanged,ie.TrackMuted,ie.TrackUnmuted,ie.TrackPublished,ie.TrackUnpublished,ie.TrackStreamStateChanged,ie.TrackSubscriptionFailed,ie.TrackSubscriptionPermissionChanged,ie.TrackSubscriptionStatusChanged],gZ=[...pZ,ie.LocalTrackPublished,ie.LocalTrackUnpublished],mZ=[ae.ConnectionQualityChanged,ae.IsSpeakingChanged,ae.ParticipantMetadataChanged,ae.ParticipantPermissionsChanged,ae.TrackMuted,ae.TrackUnmuted,ae.TrackPublished,ae.TrackUnpublished,ae.TrackStreamStateChanged,ae.TrackSubscriptionFailed,ae.TrackSubscriptionPermissionChanged,ae.TrackSubscriptionStatusChanged];[...mZ,ae.LocalTrackPublished,ae.LocalTrackUnpublished];var at=A6.getLogger("lk-components-js");at.setDefaultLevel("WARN");function vZ(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var yZ=[],CZ={showChat:!1,unreadMessages:0};function gI(t,...e){return new Tn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(Vi(t))}function mI(t,e){return new Tn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function IZ(t){return mI(t,ie.ConnectionStateChanged).pipe(or(([e])=>e),Vi(t.state))}function SZ(t,e,n=!0){var r;const i=()=>As(this,null,function*(){try{const a=yield Pp.getLocalDevices(t,n);o.next(a)}catch(a){e==null||e(a)}}),o=new pa,s=o.pipe(tZ(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return oy(Pp.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),s)}function bZ(t){return mI(t,ie.DataReceived)}function wZ(t){return gI(t,ie.AudioPlaybackStatusChanged).pipe(or(n=>({canPlayAudio:n.canPlaybackAudio})))}function AZ(t){return gI(t,ie.VideoPlaybackStatusChanged).pipe(or(n=>({canPlayVideo:n.canPlaybackVideo})))}function kZ(t,e){return mI(t,ie.ActiveDeviceChanged).pipe(yN(([n])=>n===e),or(([n,r])=>(at.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),Vi(t.getActiveDevice(e)))}function si(t){return`${SN}-${t}`}function EZ(t){const e=ay(t),n=yI(t.participant).pipe(or(()=>ay(t)),Vi(e));return{className:si(t.source===Q.Source.Camera||t.source===Q.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function ay(t){if(pI(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function vI(t,...e){return new Tn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(Vi(t))}function yI(t){return vI(t,ae.TrackMuted,ae.TrackUnmuted,ae.ParticipantPermissionsChanged,ae.TrackPublished,ae.TrackUnpublished,ae.LocalTrackPublished,ae.LocalTrackUnpublished,ae.MediaDevicesError,ae.TrackSubscriptionStatusChanged).pipe(or(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=n,s=n.getTrack(Q.Source.Microphone),a=n.getTrack(Q.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:a,microphoneTrack:s,participant:n}}))}function TZ(t){return vI(t,ae.ParticipantMetadataChanged).pipe(or(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),Vi({name:t.name,identity:t.identity,metadata:t.metadata}))}function RZ(t){return CI(t,ae.ConnectionQualityChanged).pipe(or(([n])=>n),Vi(t.connectionQuality))}function CI(t,e){return new Tn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function wN(t){var e,n,r,i;return vI(t.participant,ae.TrackMuted,ae.TrackUnmuted,ae.TrackSubscribed,ae.TrackUnsubscribed,ae.LocalTrackPublished,ae.LocalTrackUnpublished).pipe(or(o=>{var s,a;const c=(s=t.publication)!=null?s:o.getTrack(t.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),Vi((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function xZ(t){return CI(t,ae.IsSpeakingChanged).pipe(or(([e])=>e))}function PZ(t,e={}){var n;let r;const i=new Tn(c=>(r=c,()=>a.unsubscribe())).pipe(Vi(Array.from(t.participants.values()))),o=(n=e.additionalRoomEvents)!=null?n:gZ,s=Array.from(new Set([ie.ParticipantConnected,ie.ParticipantDisconnected,ie.ConnectionStateChanged,...o])),a=gI(t,...s).subscribe(c=>r==null?void 0:r.next(Array.from(c.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function NZ(t){return CI(t,ae.ParticipantPermissionsChanged).pipe(or(()=>t.permissions),Vi(t.permissions))}function _Z(t,e,n){const{localParticipant:r}=e,i=(l,u)=>{let d=!1;switch(l){case Q.Source.Camera:d=u.isCameraEnabled;break;case Q.Source.Microphone:d=u.isMicrophoneEnabled;break;case Q.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},o=yI(r).pipe(or(l=>i(t,l.participant)),Vi(i(t,r))),s=new pa,a=(l,u)=>As(this,null,function*(){try{switch(u??(u=n),s.next(!0),t){case Q.Source.Camera:yield r.setCameraEnabled(l??!r.isCameraEnabled,u);break;case Q.Source.Microphone:yield r.setMicrophoneEnabled(l??!r.isMicrophoneEnabled,u);break;case Q.Source.ScreenShare:yield r.setScreenShareEnabled(l??!r.isScreenShareEnabled,u);break;default:break}}finally{s.next(!1)}});return{className:si("button"),toggle:a,enabledObserver:o,pendingObserver:s.asObservable()}}function OZ(){let t=!1;const e=new pa,n=new pa,r=o=>{n.next(!0),t=o??!t,e.next(t),n.next(!1)};return{className:si("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function MZ(t,e,n){const r=new nN(void 0),i=e?kZ(e,t):r.asObservable(),o=(a,...c)=>As(this,[a,...c],function*(l,u={}){var d,f,h;if(e){at.debug(`Switching active device of kind "${t}" with id ${l}.`),yield e.switchActiveDevice(t,l,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:l;p!==l&&l!=="default"&&at.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let m;t==="audioinput"?m=(f=e.localParticipant.getTrack(Q.Source.Microphone))==null?void 0:f.track:t==="videoinput"&&(m=(h=e.localParticipant.getTrack(Q.Source.Camera))==null?void 0:h.track);const C=l==="default"&&!m||l==="default"&&(m==null?void 0:m.mediaStreamTrack.label.startsWith("Default"));r.next(C?l:p)}else if(n){yield n.setDeviceId(u.exact?{exact:l}:l);const p=yield n.getDeviceId();r.next(l==="default"&&n.mediaStreamTrack.label.startsWith("Default")?l:p)}else r.value!==l&&(at.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(l))});return{className:si("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function DZ(t){const e=r=>{t.disconnect(r)};return{className:si("disconnect-button"),disconnect:e}}function LZ(t){const e=si("connection-quality"),n=RZ(t);return{className:e,connectionQualityObserver:n}}function FZ(t){let e="track-muted-indicator-camera";switch(t.source){case Q.Source.Camera:e="track-muted-indicator-camera";break;case Q.Source.Microphone:e="track-muted-indicator-microphone";break}const n=si(e),r=wN(t);return{className:n,mediaMutedObserver:r}}function BZ(t){return{className:"lk-participant-name",infoObserver:TZ(t)}}function UZ(){return{className:si("participant-tile")}}var VZ={CHAT:"lk-chat-topic"};function AN(t,e,n){return As(this,arguments,function*(r,i,o,s={}){const{kind:a,destination:c}=s;yield r.publishData(i,a??nn.RELIABLE,{destination:c,topic:o})})}function GZ(t,e,n){const r=bZ(t).pipe(yN(([,,,a])=>e===void 0||a===e),or(([a,c,,l])=>({payload:a,topic:l,from:c})));let i;const o=new Tn(a=>{i=a});return{messageObservable:r,isSendingObservable:o,send:(a,...c)=>As(this,[a,...c],function*(l,u={}){i.next(!0);try{yield AN(t.localParticipant,l,e,u)}finally{i.next(!1)}})}}var WZ=new TextEncoder,jZ=new TextDecoder,Zf=new Map,ZZ=t=>WZ.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),HZ=t=>JSON.parse(jZ.decode(t));function zZ(t,e){var n,r;const i=new pa,{messageDecoder:o,messageEncoder:s,channelTopic:a}=e??{},c=a??VZ.CHAT;let l=!1;Zf.has(t)||(l=!0);const u=(n=Zf.get(t))!=null?n:new Map,d=(r=u.get(c))!=null?r:new pa;if(u.set(c,d),Zf.set(t,u),l){const{messageObservable:v}=GZ(t,c);v.pipe(MA(i)).subscribe(d)}const f=o??HZ,h=d.pipe(or(v=>{const S=f(v.payload);return sZ(sy({},S),{from:v.from})}),nZ((v,S)=>[...v,S],[]),MA(i)),p=new nN(!1),m=s??ZZ,C=v=>As(this,null,function*(){const S=Date.now(),k=m({message:v,timestamp:S});p.next(!0);try{yield AN(t.localParticipant,k,c,{kind:nn.RELIABLE}),d.next({payload:k,topic:c,from:t.localParticipant})}finally{p.next(!1)}});function g(){i.next(),i.complete(),Zf.clear()}return t.once(ie.Disconnected,g),{messageObservable:h,isSendingObservable:p,send:C}}function XZ(){const t=n=>As(this,null,function*(){at.info("Start Audio for room: ",n),yield n.startAudio()});return{className:si("start-audio-button"),roomAudioPlaybackAllowedObservable:wZ,handleStartAudioPlayback:t}}function $Z(){const t=n=>As(this,null,function*(){at.info("Start Video for room: ",n),yield n.startVideo()});return{className:si("start-audio-button"),roomVideoPlaybackAllowedObservable:AZ,handleStartVideoPlayback:t}}function KZ(){return{className:[si("button"),si("chat-toggle")].join(" ")}}function JZ(){return{className:"lk-room-container"}}function YZ(t,e){if(typeof localStorage>"u"){at.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){at.error(`Error setting item to local storage: ${n}`)}}function QZ(t){if(typeof localStorage>"u"){at.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){at.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){at.error(`Error getting item from local storage: ${e}`);return}}function qZ(t){return{load:()=>QZ(t),save:e=>YZ(t,e)}}var e8=`${SN}-user-choices`,Ta={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:t8,save:n8}=qZ(e8);function r8(t,e=!1){if(e===!0)return;const n=t,r=aZ(n,["e2ee","sharedPassphrase"]);n8(r)}function i8(t,e=!1){var n,r,i,o,s,a,c;const l={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:Ta.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:Ta.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:Ta.videoDeviceId,audioDeviceId:(o=t==null?void 0:t.audioDeviceId)!=null?o:Ta.audioDeviceId,username:(s=t==null?void 0:t.username)!=null?s:Ta.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:Ta.e2ee,sharedPassphrase:(c=t==null?void 0:t.sharedPassphrase)!=null?c:Ta.sharedPassphrase};if(e)return l;{const u=t8();return sy(sy({},l),u??{})}}function kN(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=kN(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function o8(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=kN(t))&&(r&&(r+=" "),r+=e);return r}var s8=Object.defineProperty,a8=Object.defineProperties,c8=Object.getOwnPropertyDescriptors,Dp=Object.getOwnPropertySymbols,EN=Object.prototype.hasOwnProperty,TN=Object.prototype.propertyIsEnumerable,LA=(t,e,n)=>e in t?s8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Oe=(t,e)=>{for(var n in e||(e={}))EN.call(e,n)&&LA(t,n,e[n]);if(Dp)for(var n of Dp(e))TN.call(e,n)&&LA(t,n,e[n]);return t},Fn=(t,e)=>a8(t,c8(e)),Rn=(t,e)=>{var n={};for(var r in t)EN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Dp)for(var r of Dp(t))e.indexOf(r)<0&&TN.call(t,r)&&(n[r]=t[r]);return n},RN=(t,e,n)=>new Promise((r,i)=>{var o=c=>{try{a(n.next(c))}catch(l){i(l)}},s=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((n=n.apply(t,e)).next())});function Wr(t,e){const[n,r]=b.useState(e);return b.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function l8(t){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,r]=b.useState(e(t));function i(){r(e(t))}return b.useEffect(()=>{const o=window.matchMedia(t);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[t]),n}function u8(t,e){if(e.msg==="show_chat")return Fn(Oe({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Fn(Oe({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Fn(Oe({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Fn(Oe({},t),{unreadMessages:e.count}):Oe({},t)}function d8(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:Oe({},t)}var II=b.createContext(void 0);function f8(){const t=b.useContext(II);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function h8(t){const[e,n]=b.useReducer(d8,yZ),[r,i]=b.useReducer(u8,CZ);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function xN(){return b.useContext(II)}var p8=b.createContext(void 0);function nf(){return b.useContext(p8)}var SI=b.createContext(void 0);function bg(){return b.useContext(SI)}function yc(t){var e;const n=bg(),r=nf(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var bI=b.createContext(void 0);function wg(){const t=b.useContext(bI);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function Ag(){return b.useContext(bI)}function rf(t){const e=Ag(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var g8=b.createContext(void 0);function m8(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function ba(...t){const e=Oe({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const o=e[i],s=r[i];typeof o=="function"&&typeof s=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=m8(o,s):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?e[i]=o8(o,s):e[i]=s!==void 0?s:o}}return e}function v8(t={}){const e=yc(t.participant),{className:n,connectionQualityObserver:r}=b.useMemo(()=>LZ(e),[e]),i=Wr(r,Qr.Unknown);return{className:n,quality:i}}function y8(t){const e=rf(t),n=b.useMemo(()=>IZ(e),[e]);return Wr(n,e.state)}function C8(t){const e=wg(),n=y8(e);return{buttonProps:b.useMemo(()=>{const{className:i,disconnect:o}=DZ(e);return ba(t,{className:i,onClick:()=>{var a;return o((a=t.stopTracks)!=null?a:!0)},disabled:n===it.Disconnected})},[e,t,n])}}function I8(t){if(t.publication instanceof Od){const e=t.publication.track;if(e){const{facingMode:n}=Vj(e);return n}}return"undefined"}function FA(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,o=yc(i),s=typeof t=="string"?{participant:o,source:t}:t,[a,c]=b.useState(!!((n=s.publication)!=null&&n.isMuted||(r=o.getTrack(s.source))!=null&&r.isMuted));return b.useEffect(()=>{const l=wN(s).subscribe(c);return()=>l.unsubscribe()},[bN(s)]),a}function S8(t){const e=yc(t),n=b.useMemo(()=>xZ(e),[e]);return Wr(n,e.isSpeaking)}var b8={connect:!0,audio:!1,video:!1};function w8(t){const e=Oe(Oe({},b8),t),{token:n,serverUrl:r,options:i,room:o,connectOptions:s,connect:a,audio:c,video:l,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:m,simulateParticipants:C}=e,g=Rn(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&at.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,S]=b.useState();b.useEffect(()=>{S(o??new Pp(i))},[o]);const k=b.useMemo(()=>{const{className:A}=JZ();return ba(g,{className:A})},[g]);return b.useEffect(()=>{if(!v)return;const A=()=>{const w=v.localParticipant;at.debug("trying to publish local tracks"),Promise.all([w.setMicrophoneEnabled(!!c,typeof c!="boolean"?c:void 0),w.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),w.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(_=>{at.warn(_),h==null||h(_)})},R=w=>{const _=Nd.getFailure(w);p==null||p(_)},P=w=>{m==null||m(w)};return v.on(ie.SignalConnected,A).on(ie.MediaDevicesError,R).on(ie.EncryptionError,P),()=>{v.off(ie.SignalConnected,A).off(ie.MediaDevicesError,R).off(ie.EncryptionError,P)}},[v,c,l,u,h,m,p]),b.useEffect(()=>{if(v){if(C){v.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(!n){at.debug("no token yet");return}if(!r){at.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(at.debug("connecting"),v.connect(r,n,s).catch(A=>{at.warn(A),h==null||h(A)})):(at.debug("disconnecting because connect is false"),v.disconnect())}},[a,n,JSON.stringify(s),v,h,r,C]),b.useEffect(()=>{if(!v)return;const A=R=>{switch(R){case it.Disconnected:f&&f();break;case it.Connected:d&&d();break}};return v.on(ie.ConnectionStateChanged,A),()=>{v.off(ie.ConnectionStateChanged,A)}},[n,d,f,v]),b.useEffect(()=>{if(v)return()=>{at.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:k}}function A8(t={}){const e=rf(t.room),[n,r]=b.useState(e.localParticipant),[i,o]=b.useState(n.isMicrophoneEnabled),[s,a]=b.useState(n.isMicrophoneEnabled),[c,l]=b.useState(n.lastMicrophoneError),[u,d]=b.useState(n.lastCameraError),[f,h]=b.useState(n.isMicrophoneEnabled),[p,m]=b.useState(void 0),[C,g]=b.useState(void 0),v=S=>{a(S.isCameraEnabled),o(S.isMicrophoneEnabled),h(S.isScreenShareEnabled),g(S.cameraTrack),m(S.microphoneTrack),l(S.participant.lastMicrophoneError),d(S.participant.lastCameraError),r(S.participant)};return b.useEffect(()=>{const S=yI(n).subscribe(v);return()=>S.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:s,microphoneTrack:p,cameraTrack:C,lastMicrophoneError:c,lastCameraError:u,localParticipant:n}}function k8(){const t=wg(),e=b.useMemo(()=>NZ(t.localParticipant),[t]);return Wr(e,t.localParticipant.permissions)}function E8({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const o=Ag(),s=b.useMemo(()=>SZ(t,i,r),[t,r,i]),a=Wr(s,[]),[c,l]=b.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=b.useMemo(()=>MZ(t,e??o,n),[t,e,o,n]);return b.useEffect(()=>{const h=d.subscribe(p=>{at.info("setCurrentDeviceId",p),p&&l(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:f}}function T8(t){return t!==void 0}function Kl(...t){return ba(...t.filter(T8))}function PN(t,e,n){return b.Children.map(t,r=>b.isValidElement(r)&&b.Children.only(t)?b.cloneElement(r,Fn(Oe({},e),{key:n})):r)}function NN(t,e={}){var n;const[r,i]=b.useState(ay(t)),[o,s]=b.useState(r==null?void 0:r.isMuted),[a,c]=b.useState(r==null?void 0:r.isSubscribed),[l,u]=b.useState(r==null?void 0:r.track),[d,f]=b.useState("landscape"),h=b.useRef(),{className:p,trackObserver:m}=b.useMemo(()=>EZ(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,pI(t)&&t.publication.trackSid]);return b.useEffect(()=>{const C=m.subscribe(g=>{at.debug("update track",g),i(g),s(g==null?void 0:g.isMuted),c(g==null?void 0:g.isSubscribed),u(g==null?void 0:g.track)});return()=>C==null?void 0:C.unsubscribe()},[m]),b.useEffect(()=>{var C,g;return l&&(h.current&&l.detach(h.current),(C=e.element)!=null&&C.current&&!(dZ(t.participant)&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),h.current=(g=e.element)==null?void 0:g.current,()=>{h.current&&(l==null||l.detach(h.current))}},[l,e.element]),b.useEffect(()=>{var C,g;if(typeof((C=r==null?void 0:r.dimensions)==null?void 0:C.width)=="number"&&typeof((g=r==null?void 0:r.dimensions)==null?void 0:g.height)=="number"){const v=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(v)}},[r]),{publication:r,isMuted:o,isSubscribed:a,track:l,elementProps:Kl(e.props,Oe({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function R8({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:s}){const a=nf(),c=yc(e),l=b.useMemo(()=>{var m,C,g,v,S,k;const A=(C=(m=t==null?void 0:t.source)!=null?m:a==null?void 0:a.source)!=null?C:n;if(A===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(v=(g=t==null?void 0:t.participant)!=null?g:a==null?void 0:a.participant)!=null?v:c,publication:(k=(S=t==null?void 0:t.publication)!=null?S:a==null?void 0:a.publication)!=null?k:r,source:A}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,c,n,r]),u=b.useMemo(()=>{const{className:m}=UZ();return ba(s,{className:m,onClick:C=>{var g,v;if((g=s.onClick)==null||g.call(s,C),typeof i=="function"){const S=(v=l.publication)!=null?v:l.participant.getTrack(l.source);i({participant:l.participant,track:S})}}})},[s,i,l.publication,l.source,l.participant]),d=FA(Q.Source.Camera,{participant:l.participant}),f=FA(Q.Source.Microphone,{participant:l.participant}),h=S8(l.participant),p=I8(l);return{elementProps:Oe({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":o===!0?!1:h,"data-lk-local-participant":l.participant.isLocal,"data-lk-source":l.source,"data-lk-facing-mode":p},u)}}function x8(t={}){const e=rf(t.room),[n,r]=b.useState([]);return b.useEffect(()=>{const i=PZ(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function P8(t={}){const e=x8(t),{localParticipant:n}=A8(t);return[n,...e]}function N8({room:t,props:e}){const n=rf(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=b.useMemo(()=>XZ(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=Wr(s,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:b.useMemo(()=>ba(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayAudio:a}}function _8({room:t,props:e}){const n=rf(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=b.useMemo(()=>$Z(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=Wr(s,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:b.useMemo(()=>ba(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayVideo:a}}function O8({props:t}){const{dispatch:e,state:n}=f8().widget,{className:r}=b.useMemo(()=>KZ(),[]);return{mergedProps:b.useMemo(()=>ba(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function M8(t,e={}){var n,r,i,o;let s=nf();const a=(r=(n=bg())!=null?n:e.participant)!=null?r:s==null?void 0:s.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:a,source:t}}else if(t)s=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:c,mediaMutedObserver:l}=b.useMemo(()=>FZ(s),[bN(s)]);return{isMuted:Wr(l,!!((i=s.publication)!=null&&i.isMuted||(o=s.participant.getTrack(s.source))!=null&&o.isMuted)),className:c}}function D8(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:o}=e,s=Rn(e,["source","onChange","initialState","captureOptions"]),a;const c=Ag(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=b.useMemo(()=>c?_Z(n,c,o):OZ(),[c,n,JSON.stringify(o)]),p=Wr(f,!1),m=Wr(h,i??!!(l!=null&&l.isEnabled));b.useEffect(()=>{r==null||r(m)},[m,r]),b.useEffect(()=>{i!==void 0&&(at.debug("forcing initial toggle state",n,i),u(i))},[]);const C=b.useMemo(()=>ba(s,{className:d}),[s,d]),g=b.useCallback(v=>{var S;u(),(S=s.onClick)==null||S.call(s,v)},[s,u]);return{toggle:u,enabled:m,pending:p,track:l,buttonProps:Fn(Oe({},C),{"aria-pressed":m,"data-lk-source":n,"data-lk-enabled":m,disabled:p,onClick:g})}}function L8(t,e={}){return NN(t,e)}function F8(t){const e=wg(),[n,r]=b.useState(),i=Wr(n==null?void 0:n.isSendingObservable,!1),o=Wr(n==null?void 0:n.messageObservable,[]);return b.useEffect(()=>{const s=zZ(e,t);r(s)},[e,t]),{send:n==null?void 0:n.send,chatMessages:o,isSending:i}}function B8(t={}){var e;const[n,r]=b.useState(i8(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=b.useCallback(l=>{r(u=>Fn(Oe({},u),{audioEnabled:l}))},[]),o=b.useCallback(l=>{r(u=>Fn(Oe({},u),{videoEnabled:l}))},[]),s=b.useCallback(l=>{r(u=>Fn(Oe({},u),{audioDeviceId:l}))},[]),a=b.useCallback(l=>{r(u=>Fn(Oe({},u),{videoDeviceId:l}))},[]),c=b.useCallback(l=>{r(u=>Fn(Oe({},u),{username:l}))},[]);return b.useEffect(()=>{var l;r8(n,(l=t.preventSave)!=null?l:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:s,saveVideoInputDeviceId:a,saveUsername:c}}function U8(t){const{mergedProps:e}=O8({props:t});return b.createElement("button",Oe({},e),t.children)}function V8(t){const{buttonProps:e}=C8(t);return b.createElement("button",Oe({},e),t.children)}var G8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),b.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),W8=G8,j8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Z8=j8,H8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),z8=H8,X8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),$8=X8,K8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),b.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),J8=K8,Y8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),b.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),Q8=Y8,q8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),e7=q8,t7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),n7=t7,r7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),i7=r7,o7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),s7=o7,a7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),c7=a7,l7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("g",{fill:"currentColor"},b.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),b.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),u7=l7;function Bm(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:s,exactMatch:a,track:c,requestPermissions:l,onError:u}=e,d=Rn(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=Ag(),h=b.useCallback(A=>{f&&f.emit(ie.MediaDevicesError,A),u==null||u(A)},[f,u]),{devices:p,activeDeviceId:m,setActiveMediaDevice:C,className:g}=E8({kind:n,room:f,track:c,requestPermissions:l,onError:h});b.useEffect(()=>{r!==void 0&&C(r)},[C]),b.useEffect(()=>{typeof o=="function"&&o(p)},[o,p]),b.useEffect(()=>{m&&m!==""&&(i==null||i(m))},[m]);const v=A=>RN(this,null,function*(){try{yield C(A,{exact:a})}catch(R){if(R instanceof Error)s==null||s(R);else throw R}}),S=b.useMemo(()=>Kl(d,{className:g},{className:"lk-list"}),[g,d]);function k(A,R,P){return A===R||P===0&&R==="default"}return b.createElement("ul",Oe({},S),p.map((A,R)=>b.createElement("li",{key:A.deviceId,id:A.deviceId,"data-lk-active":k(A.deviceId,m,R),"aria-selected":k(A.deviceId,m,R),role:"option"},b.createElement("button",{className:"lk-button",onClick:()=>v(A.deviceId)},A.label))))}function _N(t,e){switch(t){case Q.Source.Microphone:return e?b.createElement(Q8,null):b.createElement(J8,null);case Q.Source.Camera:return e?b.createElement(Z8,null):b.createElement(W8,null);case Q.Source.ScreenShare:return e?b.createElement(u7,null):b.createElement(c7,null);default:return}}function d7(t){switch(t){case Qr.Excellent:return b.createElement(e7,null);case Qr.Good:return b.createElement(n7,null);case Qr.Poor:return b.createElement(i7,null);default:return b.createElement(s7,null)}}function Um(t){var e=t,{showIcon:n}=e,r=Rn(e,["showIcon"]);const{buttonProps:i,enabled:o}=D8(r);return b.createElement("button",Oe({},i),(n??!0)&&_N(r.source,o),r.children)}function f7(t){var e;const{className:n,quality:r}=v8(t),i=b.useMemo(()=>Fn(Oe({},Kl(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return b.createElement("div",Oe({},i),(e=t.children)!=null?e:d7(r))}function h7(t){var e=t,{participant:n}=e,r=Rn(e,["participant"]);const i=yc(n),{className:o,infoObserver:s}=b.useMemo(()=>BZ(i),[i]),{identity:a,name:c}=Wr(s,{name:i.name,identity:i.identity,metadata:i.metadata}),l=b.useMemo(()=>Kl(r,{className:o,"data-lk-participant-name":c}),[r,o,c]);return b.createElement("span",Oe({},l),c!==""?c:a,r.children)}function p7(t){var e=t,{source:n,participant:r,trackRef:i,show:o="always"}=e,s=Rn(e,["source","participant","trackRef","show"]),a,c;const{className:l,isMuted:u}=M8(i??n,{participant:r}),d=o==="always"||o==="muted"&&u||o==="unmuted"&&!u,f=b.useMemo(()=>Kl(s,{className:l}),[l,s]);return d?b.createElement("div",Fn(Oe({},f),{"data-lk-muted":u}),(c=s.children)!=null?c:_N((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function g7(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:o,name:s,publication:a,participant:c}=e,l=Rn(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,m,C,g,v,S;const k=nf(),A=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=k==null?void 0:k.publication)==null?void 0:d.trackName)!=null?h:s,R=(m=(p=n==null?void 0:n.source)!=null?p:k==null?void 0:k.source)!=null?m:o,P=(g=(C=n==null?void 0:n.publication)!=null?C:k==null?void 0:k.publication)!=null?g:a,w=(S=(v=n==null?void 0:n.participant)!=null?v:k==null?void 0:k.participant)!=null?S:c;if(R===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const _=b.useRef(null),O=yc(w),{elementProps:L,isSubscribed:U,track:X,publication:H}=NN({source:R,name:A,participant:O,publication:P},{element:_,props:l});return b.useEffect(()=>{r==null||r(!!U)},[U,r]),b.useEffect(()=>{X===void 0||i===void 0||(X instanceof Ja?X.setVolume(i):at.warn("Volume can only be set on remote audio tracks."))},[i,X]),b.useEffect(()=>{H===void 0||l.muted===void 0||(H instanceof lI?H.setEnabled(!l.muted):at.warn("Can only call setEnabled on remote track publications."))},[l.muted,H,X]),b.createElement("audio",Oe({ref:_},L))}function m7(t){const e=!!bg();return t.participant&&!e?b.createElement(SI.Provider,{value:t.participant},t.children):b.createElement(b.Fragment,null,t.children)}function v7({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=h8(t);return b.useEffect(()=>{at.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),b.useEffect(()=>{at.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),b.createElement(II.Provider,{value:i},r)}function y7(t){const{room:e,htmlProps:n}=w8(t);return b.createElement("div",Oe({},n),e&&b.createElement(bI.Provider,{value:e},b.createElement(g8.Provider,{value:t.featureFlags},t.children)))}function C7(t){var e=t,{participant:n,trackRef:r}=e,i=Rn(e,["participant","trackRef"]),o,s;const[a,c]=b.useState([]),l=200,u=90,d=6,f=4,h=50,p=7,m=(o=bg())!=null?o:n;let C=(s=nf())!=null?s:r;if(!C){if(!m)throw Error("Participant missing, provide it directly or within a context");C={participant:m,source:Q.Source.Microphone}}const{track:g}=L8(C);return b.useEffect(()=>{if(!g||!(g instanceof cr||g instanceof Ja))return;const{analyser:v,cleanup:S}=X9(g,{smoothingTimeConstant:.8,fftSize:64}),k=new Uint8Array(v.frequencyBinCount),A=()=>{v.getByteFrequencyData(k);const P=new Array(p).fill(0);k.slice(1);const w=6;for(let _=0;_<p/2;_+=1){const O=Math.floor(p/2-_);for(let L=0;L<w;L+=1)P[O]+=Math.pow(k[_*w+L]/255,2);P[O]/=w}for(let _=0;_<p/2;_+=1){const O=Math.floor(p/2+_);if(P[O]===0){for(let L=0;L<w;L+=1)P[O]+=Math.pow(k[_*w+L]/255,2);P[O]/=w}}return P.map(_=>_*h)},R=setInterval(()=>{const P=A();c(P)},100);return()=>{clearInterval(R),S()}},[g]),b.createElement("svg",Fn(Oe({width:"100%",height:"100%",viewBox:`0 0 ${l} ${u}`},i),{className:"lk-audio-visualizer"}),b.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),b.createElement("g",{style:{transform:`translate(${(l-p*(d+f))/2}px, 0)`}},a.map((v,S)=>b.createElement("rect",{key:S,x:S*(d+f),y:u/2-v/2,width:d,height:v}))))}function I7(t){var e=t,{participants:n}=e,r=Rn(e,["participants"]);return b.createElement(b.Fragment,null,n.map(i=>b.createElement(SI.Provider,{value:i,key:i.identity},PN(r.children))))}function S7(t){var e=t,{participant:n,children:r,source:i,publication:o,disableSpeakingIndicator:s,onParticipantClick:a}=e,c=Rn(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const l=yc(n),{elementProps:u}=R8({participant:l,htmlProps:c,disableSpeakingIndicator:s,source:Q.Source.Microphone,publication:o,onParticipantClick:a});return b.createElement("div",Oe({style:{position:"relative"}},u),b.createElement(m7,{participant:l},r??b.createElement(b.Fragment,null,b.createElement(g7,{source:i??Q.Source.Microphone}),b.createElement(C7,null),b.createElement("div",{className:"lk-participant-metadata"},b.createElement("div",{className:"lk-participant-metadata-item"},b.createElement(p7,{source:Q.Source.Microphone}),b.createElement(h7,null)),b.createElement(f7,{className:"lk-participant-metadata-item"})))))}function b7(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=e,s=Rn(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,c,l,u;const d=b.useMemo(()=>o?o(n.message):n.message,[n.message,o]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return b.createElement("li",Oe({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},s),(!i||!r)&&b.createElement("span",{className:"lk-meta-data"},!r&&b.createElement("strong",{className:"lk-participant-name"},(u=(c=n.from)==null?void 0:c.name)!=null?u:(l=n.from)==null?void 0:l.identity),!i&&b.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),b.createElement("span",{className:"lk-message-body"},d))}function w7(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:o}=e,s=Rn(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=b.useRef(null),c=b.useRef(null),l=b.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:u,chatMessages:d,isSending:f}=F8(l),h=xN(),p=b.useRef(0);function m(C){return RN(this,null,function*(){C.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return b.useEffect(()=>{var C;c&&((C=c.current)==null||C.scrollTo({top:c.current.scrollHeight}))},[c,d]),b.useEffect(()=>{var C,g,v,S,k;if(!h||d.length===0)return;if((C=h.widget.state)!=null&&C.showChat&&d.length>0&&p.current!==((g=d[d.length-1])==null?void 0:g.timestamp)){p.current=(v=d[d.length-1])==null?void 0:v.timestamp;return}const A=d.filter(P=>!p.current||P.timestamp>p.current).length,{widget:R}=h;A>0&&((S=R.state)==null?void 0:S.unreadMessages)!==A&&((k=R.dispatch)==null||k.call(R,{msg:"unread_msg",count:A}))},[d,h==null?void 0:h.widget]),b.createElement("div",Fn(Oe({},s),{className:"lk-chat"}),b.createElement("ul",{className:"lk-list lk-chat-messages",ref:c},s.children?d.map((C,g)=>PN(s.children,{entry:C,key:g,messageFormatter:n})):d.map((C,g,v)=>{const S=g>=1&&v[g-1].from===C.from,k=g>=1&&C.timestamp-v[g-1].timestamp<6e4;return b.createElement(b7,{key:g,hideName:S,hideTimestamp:S===!1?!1:k,entry:C,messageFormatter:n})})),b.createElement("form",{className:"lk-chat-form",onSubmit:m},b.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),b.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function BA(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:s=!1}=e,a=Rn(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[c,l]=b.useState(!1),[u,d]=b.useState([]),[f,h]=b.useState(!0),p=(v,S)=>{at.debug("handle device change"),l(!1),i==null||i(v,S)},m=b.useRef(null),C=b.useRef(null);b.useLayoutEffect(()=>{m.current&&C.current&&(u||f)&&fZ(m.current,C.current).then(({x:v,y:S})=>{C.current&&Object.assign(C.current.style,{left:`${v}px`,top:`${S}px`})}),h(!1)},[m,C,u,f]);const g=b.useCallback(v=>{C.current&&v.target!==m.current&&c&&hZ(C.current,v)&&l(!1)},[c,C,m]);return b.useEffect(()=>(document.addEventListener("click",g),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",g),window.removeEventListener("resize",()=>h(!0))}),[g,h]),b.createElement(b.Fragment,null,b.createElement("button",Fn(Oe({className:"lk-button lk-button-menu","aria-pressed":c},a),{onClick:()=>l(!c),ref:m}),a.children),!a.disabled&&b.createElement("div",{className:"lk-device-menu",ref:C,style:{visibility:c?"visible":"hidden"}},n?b.createElement(Bm,{initialSelection:r,onActiveDeviceChange:v=>p(n,v),onDeviceListChange:d,kind:n,track:o==null?void 0:o[n],requestPermissions:s}):b.createElement(b.Fragment,null,b.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),b.createElement(Bm,{kind:"audioinput",onActiveDeviceChange:v=>p("audioinput",v),onDeviceListChange:d,track:o==null?void 0:o.audioinput,requestPermissions:s}),b.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),b.createElement(Bm,{kind:"videoinput",onActiveDeviceChange:v=>p("videoinput",v),onDeviceListChange:d,track:o==null?void 0:o.videoinput,requestPermissions:s}))))}function A7(t){var e=t,{label:n}=e,r=Rn(e,["label"]);const i=wg(),{mergedProps:o,canPlayAudio:s}=N8({room:i,props:r}),{mergedProps:a,canPlayVideo:c}=_8({room:i,props:o}),l=a,{style:u}=l,d=Rn(l,["style"]);return u.display=s&&c?"none":"block",b.createElement("button",Oe({style:u},d),n??`Start ${s?"Video":"Audio"}`)}function k7(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,o=Rn(e,["variation","controls","saveUserChoices"]),s,a,c,l,u;const[d,f]=b.useState(!1),h=xN();b.useEffect(()=>{var X,H;((X=h==null?void 0:h.widget.state)==null?void 0:X.showChat)!==void 0&&f((H=h==null?void 0:h.widget.state)==null?void 0:H.showChat)},[(s=h==null?void 0:h.widget.state)==null?void 0:s.showChat]);const m=l8(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=m);const C=Oe({leave:!0},r),g=k8();g?((a=C.camera)!=null||(C.camera=g.canPublish),(c=C.microphone)!=null||(C.microphone=g.canPublish),(l=C.screenShare)!=null||(C.screenShare=g.canPublish),(u=C.chat)!=null||(C.chat=g.canPublishData&&(r==null?void 0:r.chat))):(C.camera=!1,C.chat=!1,C.microphone=!1,C.screenShare=!1);const v=b.useMemo(()=>n==="minimal"||n==="verbose",[n]),S=b.useMemo(()=>n==="textOnly"||n==="verbose",[n]),k=vZ(),[A,R]=b.useState(!1),P=X=>{R(X)},w=Kl({className:"lk-control-bar"},o),{saveAudioInputEnabled:_,saveVideoInputEnabled:O,saveAudioInputDeviceId:L,saveVideoInputDeviceId:U}=B8({preventSave:!i});return b.createElement("div",Oe({},w),C.microphone&&b.createElement("div",{className:"lk-button-group"},b.createElement(Um,{source:Q.Source.Microphone,showIcon:v,onChange:_},S&&"Microphone"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(BA,{kind:"audioinput",onActiveDeviceChange:(X,H)=>L(H??"")}))),C.camera&&b.createElement("div",{className:"lk-button-group"},b.createElement(Um,{source:Q.Source.Camera,showIcon:v,onChange:O},S&&"Camera"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(BA,{kind:"videoinput",onActiveDeviceChange:(X,H)=>U(H??"")}))),C.screenShare&&k&&b.createElement(Um,{source:Q.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:v,onChange:P},S&&(A?"Stop screen share":"Share screen")),C.chat&&b.createElement(U8,null,v&&b.createElement(z8,null),S&&"Chat"),C.leave&&b.createElement(V8,null,v&&b.createElement($8,null),S&&"Leave"),b.createElement(A7,null))}function E7(t){var e=Rn(t,[]);const[n,r]=b.useState({showChat:!1,unreadMessages:0}),i=P8();return b.createElement(v7,{onWidgetChange:r},b.createElement("div",Oe({className:"lk-audio-conference"},e),b.createElement("div",{className:"lk-audio-conference-stage"},b.createElement(I7,{participants:i},b.createElement(S7,null))),b.createElement(k7,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&b.createElement(w7,null)))}const T7="wss://mongoose-67t79p35.livekit.cloud",R7=({client:t})=>{const[e,n]=b.useState([]),[r,i]=b.useState(!1);return b.useEffect(()=>{const o=a=>{n(c=>[...c,a]),i(!0)},s=a=>{n(c=>{const l=c.filter(u=>u!==a);return l.length===0&&i(!1),l})};return t.on("livekitToken",o),t.on("livekitLeave",s),()=>{t.off("livekitToken",o),t.off("livekitLeave",s)}},[t]),e.length?K.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,s)=>K.jsx(y7,{video:!1,audio:!0,token:o,serverUrl:T7,connect:!0,onDisconnected:()=>t.emit("livekitLeave",o),children:K.jsx(E7,{})},s)),K.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null};function x7(){const[t,e]=b.useState(null),[n,r]=b.useState(!1),[i,o]=b.useState([]),s=ct.useRef(null),a=ct.useRef(null),c=ct.useRef(null),l=b.useRef(!1),u=()=>{s.current&&s.current.saveLog()},d=()=>{s.current&&s.current.clearLog()},f=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return b.useEffect(()=>{if(l.current)return;const h=new gV("mongoose.moo.mud.org",8765);h.registerGMCPPackage(rV),h.registerGMCPPackage(q4),h.registerGMCPPackage(eV),h.registerGMCPPackage($F),h.registerGMCPPackage(iV),h.registerGMCPPackage(tV),h.registerGMCPPackage(nV),h.registerGMCPPackage(zF),h.registerGMCPPackage(oV),h.registerMcpPackage(lV),h.registerMcpPackage(uV),h.registerMcpPackage(fV),h.registerMcpPackage(hV),h.connect(),h.requestNotificationPermission(),e(h),r(!f),window.mudClient=h,l.current=!0;const p=C=>{h&&(C.key==="Control"&&h.cancelSpeech(),C.key==="Escape"&&h.stopAllSounds())};window.addEventListener("keydown",p);const m=()=>{var C;(C=a.current)==null||C.focus()};return document.addEventListener("focus",m),()=>{window.removeEventListener("keydown",p),document.removeEventListener("focus",m)}},[f]),b.useEffect(()=>{if(t){const h=m=>{o(m)},p=()=>{o([])};return t.on("userlist",h),t.on("disconnect",p),()=>{t.off("userlist",h),t.off("disconnect",p)}}},[t]),wE(h=>{t&&t.shutdown()}),t?K.jsxs("div",{className:"App",children:[K.jsx("header",{className:"App-header"}),K.jsx(uW,{client:t,onSaveLog:u,onClearLog:d,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var h;return(h=c.current)==null?void 0:h.open()}}),K.jsxs("div",{children:[K.jsx(Qv,{client:t,ref:s}),n&&K.jsx(fW,{users:i}),K.jsx(R7,{client:t})]}),K.jsx(vV,{onSend:t.sendCommand,inputRef:a}),K.jsx(dW,{client:t}),K.jsx(JG,{ref:c})]}):null}function P7(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function VA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UA(Object(n),!0).forEach(function(r){P7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function N7(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function _7(t,e){if(t==null)return{};var n=N7(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function O7(t,e){return M7(t)||D7(t,e)||L7(t,e)||F7()}function M7(t){if(Array.isArray(t))return t}function D7(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var s=t[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(c){i=!0,o=c}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw o}}return n}}function L7(t,e){if(t){if(typeof t=="string")return GA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GA(t,e)}}function GA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function F7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B7(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function jA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WA(Object(n),!0).forEach(function(r){B7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function U7(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function Du(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function Lp(t){return{}.toString.call(t).includes("Object")}function V7(t){return!Object.keys(t).length}function Ld(t){return typeof t=="function"}function G7(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function W7(t,e){return Lp(e)||ca("changeType"),Object.keys(e).some(function(n){return!G7(t,n)})&&ca("changeField"),e}function j7(t){Ld(t)||ca("selectorType")}function Z7(t){Ld(t)||Lp(t)||ca("handlerType"),Lp(t)&&Object.values(t).some(function(e){return!Ld(e)})&&ca("handlersType")}function H7(t){t||ca("initialIsRequired"),Lp(t)||ca("initialType"),V7(t)&&ca("initialContent")}function z7(t,e){throw new Error(t[e]||t.default)}var X7={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},ca=Du(z7)(X7),Hf={changes:W7,selector:j7,handler:Z7,initial:H7};function $7(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Hf.initial(t),Hf.handler(e);var n={current:t},r=Du(Y7)(n,e),i=Du(J7)(n),o=Du(Hf.changes)(t),s=Du(K7)(n);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return Hf.selector(l),l(n.current)}function c(l){U7(r,i,o,s)(l)}return[a,c]}function K7(t,e){return Ld(e)?e(t.current):e}function J7(t,e){return t.current=jA(jA({},t.current),e),e}function Y7(t,e,n){return Ld(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var Q7={create:$7},q7={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function eH(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function tH(t){return{}.toString.call(t).includes("Object")}function nH(t){return t||ZA("configIsRequired"),tH(t)||ZA("configType"),t.urls?(rH(),{paths:{vs:t.urls.monacoBase}}):t}function rH(){console.warn(ON.deprecation)}function iH(t,e){throw new Error(t[e]||t.default)}var ON={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},ZA=eH(iH)(ON),oH={config:nH},sH=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(o,s){return s(o)},i)}};function MN(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],MN(t[n],e[n]))}),VA(VA({},t),e)}var aH={type:"cancelation",msg:"operation is manually canceled"};function Vm(t){var e=!1,n=new Promise(function(r,i){t.then(function(o){return e?i(aH):r(o)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var cH=Q7.create({config:q7,isInitialized:!1,resolve:null,reject:null,monaco:null}),DN=O7(cH,2),of=DN[0],kg=DN[1];function lH(t){var e=oH.config(t),n=e.monaco,r=_7(e,["monaco"]);kg(function(i){return{config:MN(i.config,r),monaco:n}})}function uH(){var t=of(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(kg({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Vm(Gm);if(window.monaco&&window.monaco.editor)return LN(window.monaco),t.resolve(window.monaco),Vm(Gm);sH(dH,hH)(pH)}return Vm(Gm)}function dH(t){return document.body.appendChild(t)}function fH(t){var e=document.createElement("script");return t&&(e.src=t),e}function hH(t){var e=of(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),n=fH("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function pH(){var t=of(function(n){var r=n.config,i=n.resolve,o=n.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){LN(n),t.resolve(n)},function(n){t.reject(n)})}function LN(t){of().monaco||kg({monaco:t})}function gH(){return of(function(t){var e=t.monaco;return e})}var Gm=new Promise(function(t,e){return kg({resolve:t,reject:e})}),FN={config:lH,init:uH,__getMonacoInstance:gH},mH={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Wm=mH,vH={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},yH=vH;function CH({children:t}){return ct.createElement("div",{style:yH.container},t)}var IH=CH,SH=IH;function bH({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:o,wrapperProps:s}){return ct.createElement("section",{style:{...Wm.wrapper,width:t,height:e},...s},!n&&ct.createElement(SH,null,r),ct.createElement("div",{ref:i,style:{...Wm.fullWidth,...!n&&Wm.hide},className:o}))}var wH=bH,BN=b.memo(wH);function AH(t){b.useEffect(t,[])}var UN=AH;function kH(t,e,n=!0){let r=b.useRef(!0);b.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var Dr=kH;function Qu(){}function zc(t,e,n,r){return EH(t,r)||TH(t,e,n,r)}function EH(t,e){return t.editor.getModel(VN(t,e))}function TH(t,e,n,r){return t.editor.createModel(e,n,r?VN(t,r):void 0)}function VN(t,e){return t.Uri.parse(e)}function RH({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:c=!1,theme:l="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:m={},beforeMount:C=Qu,onMount:g=Qu}){let[v,S]=b.useState(!1),[k,A]=b.useState(!0),R=b.useRef(null),P=b.useRef(null),w=b.useRef(null),_=b.useRef(g),O=b.useRef(C),L=b.useRef(!1);UN(()=>{let J=FN.init();return J.then(te=>(P.current=te)&&A(!1)).catch(te=>(te==null?void 0:te.type)!=="cancelation"&&console.error("Monaco initialization: error:",te)),()=>R.current?H():J.cancel()}),Dr(()=>{if(R.current&&P.current){let J=R.current.getOriginalEditor(),te=zc(P.current,t||"",r||n||"text",o||"");te!==J.getModel()&&J.setModel(te)}},[o],v),Dr(()=>{if(R.current&&P.current){let J=R.current.getModifiedEditor(),te=zc(P.current,e||"",i||n||"text",s||"");te!==J.getModel()&&J.setModel(te)}},[s],v),Dr(()=>{let J=R.current.getModifiedEditor();J.getOption(P.current.editor.EditorOption.readOnly)?J.setValue(e||""):e!==J.getValue()&&(J.executeEdits("",[{range:J.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),J.pushUndoStop())},[e],v),Dr(()=>{var J,te;(te=(J=R.current)==null?void 0:J.getModel())==null||te.original.setValue(t||"")},[t],v),Dr(()=>{let{original:J,modified:te}=R.current.getModel();P.current.editor.setModelLanguage(J,r||n||"text"),P.current.editor.setModelLanguage(te,i||n||"text")},[n,r,i],v),Dr(()=>{var J;(J=P.current)==null||J.editor.setTheme(l)},[l],v),Dr(()=>{var J;(J=R.current)==null||J.updateOptions(d)},[d],v);let U=b.useCallback(()=>{var le;if(!P.current)return;O.current(P.current);let J=zc(P.current,t||"",r||n||"text",o||""),te=zc(P.current,e||"",i||n||"text",s||"");(le=R.current)==null||le.setModel({original:J,modified:te})},[n,e,i,t,r,o,s]),X=b.useCallback(()=>{var J;!L.current&&w.current&&(R.current=P.current.editor.createDiffEditor(w.current,{automaticLayout:!0,...d}),U(),(J=P.current)==null||J.editor.setTheme(l),S(!0),L.current=!0)},[d,l,U]);b.useEffect(()=>{v&&_.current(R.current,P.current)},[v]),b.useEffect(()=>{!k&&!v&&X()},[k,v,X]);function H(){var te,le,$,z;let J=(te=R.current)==null?void 0:te.getModel();a||((le=J==null?void 0:J.original)==null||le.dispose()),c||(($=J==null?void 0:J.modified)==null||$.dispose()),(z=R.current)==null||z.dispose()}return ct.createElement(BN,{width:h,height:f,isEditorReady:v,loading:u,_ref:w,className:p,wrapperProps:m})}var xH=RH;b.memo(xH);function PH(t){let e=b.useRef();return b.useEffect(()=>{e.current=t},[t]),e.current}var NH=PH,zf=new Map;function _H({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:o,theme:s="light",line:a,loading:c="Loading...",options:l={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:m,wrapperProps:C={},beforeMount:g=Qu,onMount:v=Qu,onChange:S,onValidate:k=Qu}){let[A,R]=b.useState(!1),[P,w]=b.useState(!0),_=b.useRef(null),O=b.useRef(null),L=b.useRef(null),U=b.useRef(v),X=b.useRef(g),H=b.useRef(),J=b.useRef(r),te=NH(o),le=b.useRef(!1),$=b.useRef(!1);UN(()=>{let j=FN.init();return j.then(oe=>(_.current=oe)&&w(!1)).catch(oe=>(oe==null?void 0:oe.type)!=="cancelation"&&console.error("Monaco initialization: error:",oe)),()=>O.current?se():j.cancel()}),Dr(()=>{var oe,Ce,Be,fe;let j=zc(_.current,t||r||"",e||i||"",o||n||"");j!==((oe=O.current)==null?void 0:oe.getModel())&&(d&&zf.set(te,(Ce=O.current)==null?void 0:Ce.saveViewState()),(Be=O.current)==null||Be.setModel(j),d&&((fe=O.current)==null||fe.restoreViewState(zf.get(o))))},[o],A),Dr(()=>{var j;(j=O.current)==null||j.updateOptions(l)},[l],A),Dr(()=>{!O.current||r===void 0||(O.current.getOption(_.current.editor.EditorOption.readOnly)?O.current.setValue(r):r!==O.current.getValue()&&($.current=!0,O.current.executeEdits("",[{range:O.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),O.current.pushUndoStop(),$.current=!1))},[r],A),Dr(()=>{var oe,Ce;let j=(oe=O.current)==null?void 0:oe.getModel();j&&i&&((Ce=_.current)==null||Ce.editor.setModelLanguage(j,i))},[i],A),Dr(()=>{var j;a!==void 0&&((j=O.current)==null||j.revealLine(a))},[a],A),Dr(()=>{var j;(j=_.current)==null||j.editor.setTheme(s)},[s],A);let z=b.useCallback(()=>{var j;if(!(!L.current||!_.current)&&!le.current){X.current(_.current);let oe=o||n,Ce=zc(_.current,r||t||"",e||i||"",oe||"");O.current=(j=_.current)==null?void 0:j.editor.create(L.current,{model:Ce,automaticLayout:!0,...l},u),d&&O.current.restoreViewState(zf.get(oe)),_.current.editor.setTheme(s),a!==void 0&&O.current.revealLine(a),R(!0),le.current=!0}},[t,e,n,r,i,o,l,u,d,s,a]);b.useEffect(()=>{A&&U.current(O.current,_.current)},[A]),b.useEffect(()=>{!P&&!A&&z()},[P,A,z]),J.current=r,b.useEffect(()=>{var j,oe;A&&S&&((j=H.current)==null||j.dispose(),H.current=(oe=O.current)==null?void 0:oe.onDidChangeModelContent(Ce=>{$.current||S(O.current.getValue(),Ce)}))},[A,S]),b.useEffect(()=>{if(A){let j=_.current.editor.onDidChangeMarkers(oe=>{var Be;let Ce=(Be=O.current.getModel())==null?void 0:Be.uri;if(Ce&&oe.find(fe=>fe.path===Ce.path)){let fe=_.current.editor.getModelMarkers({resource:Ce});k==null||k(fe)}});return()=>{j==null||j.dispose()}}return()=>{}},[A,k]);function se(){var j,oe;(j=H.current)==null||j.dispose(),f?d&&zf.set(o,O.current.saveViewState()):(oe=O.current.getModel())==null||oe.dispose(),O.current.dispose()}return ct.createElement(BN,{width:h,height:p,isEditorReady:A,loading:c,_ref:L,className:m,wrapperProps:C})}var OH=_H,MH=b.memo(OH),DH=MH,LH={restoreOnUnmount:!1};function FH(t,e){e===void 0&&(e=LH);var n=b.useRef(document.title);document.title!==t&&(document.title=t),b.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const BH=typeof document<"u"?FH:function(t){};function UH({onSave:t,onRevert:e,onDownload:n}){return K.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:K.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[K.jsxs("button",{onClick:t,accessKey:"s",children:[K.jsx(gx,{}),"Save"]}),K.jsxs("button",{onClick:e,accessKey:"r",children:[K.jsx(aW,{}),"Revert"]}),K.jsxs("button",{onClick:n,accessKey:"d",children:[K.jsx(oW,{}),"Download"]})]})})}const VH=({docstate:t,session:e})=>K.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[K.jsx("span",{children:t}),K.jsx("span",{children:"|"}),K.jsx("span",{children:e.reference}),K.jsx("span",{children:"|"}),K.jsx("span",{children:e.type})]});function GH(){const t=bE(),e=ct.useRef(null),[n,r]=b.useState(""),[i,o]=b.useState(""),[s,a]=b.useState(""),[c,l]=b.useState(0),[u,d]=b.useState({name:"none",contents:[],reference:"",type:""}),f=(X,H)=>{e.current=X},[h,p]=Ss();console.log(h);const m=h.editor.accessibilityMode,C=h.editor.autocompleteEnabled;wE(X=>{A.postMessage({type:"close",id:P}),c===1&&X.preventDefault()});const[g,v]=b.useState(!1),S=g?`${u.name} - Mongoose Editor`:"Mongoose Editor";BH(S);const k=b.useMemo(()=>{switch(c){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[c]),A=b.useMemo(()=>new BroadcastChannel("editor"),[]),R=new URLSearchParams(t.search),P=decodeURIComponent(R.get("reference")||"");b.useEffect(()=>{if(!P)return;console.log("ID: "+P),console.log("Sending ready message"),A.postMessage({type:"ready",id:P});const X=H=>{if(console.log(H.data),H.data.type==="load"){if(n!=="")return;const J=H.data.session.contents.join(`
`);o(J),a(J),d(H.data.session),l(0),r(H.data.clientId),setTimeout(U,100)}else if(H.data.type==="shutdown"){if(H.data.clientId!==n)return;A.close(),window.close()}};return A.addEventListener("message",X),()=>A.removeEventListener("message",X)},[A,n,P]);const w=()=>{o(s),l(0)},_=X=>{const H=i.split(/\r\n|\r|\n/),J={...u,contents:H};A.postMessage({type:"save",session:J,id:P}),l(2),U(),X.preventDefault()},O=X=>{X!==void 0&&(console.log("Original: "+s),console.log("New: "+X),o(X),X.split(/\r\n|\r|\n/).join(`
`)!==s?l(1):l(0),g||v(!0))},L=()=>{const X=new Blob([i],{type:"text/plain"}),H=URL.createObjectURL(X),J=document.createElement("a"),te=new Date,le=te.toLocaleDateString().replace(/\//g,"-"),$=te.toLocaleTimeString().replace(/:/g,"-"),z=`${u.name}-${le}-${$}.txt`;J.download=z,J.href=H,J.click(),URL.revokeObjectURL(H),J.remove()};return K.jsxs("div",{id:"editor",children:[K.jsx(UH,{onSave:_,onRevert:w,onDownload:L}),K.jsx(DH,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:O,options:{wordWrap:"on",accessibilitySupport:m?"on":"off",quickSuggestions:C},onMount:f,path:u.reference}),K.jsx(VH,{docstate:k,session:u})]});function U(){e.current!==null&&e.current.focus()}}const WH="modulepreload",jH=function(t){return"/"+t},HA={},ZH=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=jH(c),c in HA)return;HA[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":WH,l||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),l)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},HH=t=>{t&&t instanceof Function&&ZH(async()=>{const{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-DdRmOIVa.js");return{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{e(t),n(t),r(t),i(t),o(t)})};var zA={};const zH=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function XH(t){if("serviceWorker"in navigator){if(new URL(zA.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${zA.PUBLIC_URL}/service-worker.js`;zH?($H(n),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):GN(n)})}}function GN(t,e){navigator.serviceWorker.register(t).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."):console.log("Content is cached for offline use."))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function $H(t,e){fetch(t).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):GN(t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}const KH=DD([{path:"/",element:K.jsx(x7,{})},{path:"/editor",element:K.jsx(GH,{})}]),JH=jm.createRoot(document.getElementById("root"));JH.render(K.jsx(ct.StrictMode,{children:K.jsx(ZD,{router:KH})}));HH(console.log);XH();

var WN=Object.defineProperty;var II=t=>{throw TypeError(t)};var jN=(t,e,n)=>e in t?WN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var V=(t,e,n)=>jN(t,typeof e!="symbol"?e+"":e,n),wg=(t,e,n)=>e.has(t)||II("Cannot "+n);var N=(t,e,n)=>(wg(t,e,"read from private field"),n?n.call(t):e.get(t)),et=(t,e,n)=>e.has(t)?II("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ne=(t,e,n,r)=>(wg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ae=(t,e,n)=>(wg(t,e,"access private method"),n);var sh=(t,e,n,r)=>({set _(i){Ne(t,e,i,n)},get _(){return N(t,e,r)}});function $A(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var ZN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ud(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var KA={exports:{}},_p={},JA={exports:{}},ze={},Vd=Symbol.for("react.element"),HN=Symbol.for("react.portal"),zN=Symbol.for("react.fragment"),XN=Symbol.for("react.strict_mode"),$N=Symbol.for("react.profiler"),KN=Symbol.for("react.provider"),JN=Symbol.for("react.context"),YN=Symbol.for("react.forward_ref"),QN=Symbol.for("react.suspense"),qN=Symbol.for("react.memo"),e_=Symbol.for("react.lazy"),SI=Symbol.iterator;function t_(t){return t===null||typeof t!="object"?null:(t=SI&&t[SI]||t["@@iterator"],typeof t=="function"?t:null)}var YA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QA=Object.assign,qA={};function Pl(t,e,n){this.props=t,this.context=e,this.refs=qA,this.updater=n||YA}Pl.prototype.isReactComponent={};Pl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Pl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function e1(){}e1.prototype=Pl.prototype;function iy(t,e,n){this.props=t,this.context=e,this.refs=qA,this.updater=n||YA}var oy=iy.prototype=new e1;oy.constructor=iy;QA(oy,Pl.prototype);oy.isPureReactComponent=!0;var bI=Array.isArray,t1=Object.prototype.hasOwnProperty,sy={current:null},n1={key:!0,ref:!0,__self:!0,__source:!0};function r1(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)t1.call(e,r)&&!n1.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Vd,type:t,key:o,ref:s,props:i,_owner:sy.current}}function n_(t,e){return{$$typeof:Vd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ay(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vd}function r_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var wI=/\/+/g;function Ag(t,e){return typeof t=="object"&&t!==null&&t.key!=null?r_(""+t.key):e.toString(36)}function Vh(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Vd:case HN:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Ag(s,0):r,bI(i)?(n="",t!=null&&(n=t.replace(wI,"$&/")+"/"),Vh(i,e,n,"",function(l){return l})):i!=null&&(ay(i)&&(i=n_(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(wI,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",bI(t))for(var a=0;a<t.length;a++){o=t[a];var c=r+Ag(o,a);s+=Vh(o,e,n,c,i)}else if(c=t_(t),typeof c=="function")for(t=c.call(t),a=0;!(o=t.next()).done;)o=o.value,c=r+Ag(o,a++),s+=Vh(o,e,n,c,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function ah(t,e,n){if(t==null)return t;var r=[],i=0;return Vh(t,r,"","",function(o){return e.call(n,o,i++)}),r}function i_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var or={current:null},Gh={transition:null},o_={ReactCurrentDispatcher:or,ReactCurrentBatchConfig:Gh,ReactCurrentOwner:sy};function i1(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:ah,forEach:function(t,e,n){ah(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ah(t,function(){e++}),e},toArray:function(t){return ah(t,function(e){return e})||[]},only:function(t){if(!ay(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ze.Component=Pl;ze.Fragment=zN;ze.Profiler=$N;ze.PureComponent=iy;ze.StrictMode=XN;ze.Suspense=QN;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o_;ze.act=i1;ze.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=QA({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=sy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)t1.call(e,c)&&!n1.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Vd,type:t.type,key:i,ref:o,props:r,_owner:s}};ze.createContext=function(t){return t={$$typeof:JN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KN,_context:t},t.Consumer=t};ze.createElement=r1;ze.createFactory=function(t){var e=r1.bind(null,t);return e.type=t,e};ze.createRef=function(){return{current:null}};ze.forwardRef=function(t){return{$$typeof:YN,render:t}};ze.isValidElement=ay;ze.lazy=function(t){return{$$typeof:e_,_payload:{_status:-1,_result:t},_init:i_}};ze.memo=function(t,e){return{$$typeof:qN,type:t,compare:e===void 0?null:e}};ze.startTransition=function(t){var e=Gh.transition;Gh.transition={};try{t()}finally{Gh.transition=e}};ze.unstable_act=i1;ze.useCallback=function(t,e){return or.current.useCallback(t,e)};ze.useContext=function(t){return or.current.useContext(t)};ze.useDebugValue=function(){};ze.useDeferredValue=function(t){return or.current.useDeferredValue(t)};ze.useEffect=function(t,e){return or.current.useEffect(t,e)};ze.useId=function(){return or.current.useId()};ze.useImperativeHandle=function(t,e,n){return or.current.useImperativeHandle(t,e,n)};ze.useInsertionEffect=function(t,e){return or.current.useInsertionEffect(t,e)};ze.useLayoutEffect=function(t,e){return or.current.useLayoutEffect(t,e)};ze.useMemo=function(t,e){return or.current.useMemo(t,e)};ze.useReducer=function(t,e,n){return or.current.useReducer(t,e,n)};ze.useRef=function(t){return or.current.useRef(t)};ze.useState=function(t){return or.current.useState(t)};ze.useSyncExternalStore=function(t,e,n){return or.current.useSyncExternalStore(t,e,n)};ze.useTransition=function(){return or.current.useTransition()};ze.version="18.3.1";JA.exports=ze;var b=JA.exports;const lt=Ud(b),s_=$A({__proto__:null,default:lt},[b]);var a_=b,c_=Symbol.for("react.element"),l_=Symbol.for("react.fragment"),u_=Object.prototype.hasOwnProperty,d_=a_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h_={key:!0,ref:!0,__self:!0,__source:!0};function o1(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)u_.call(e,r)&&!h_.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:c_,type:t,key:o,ref:s,props:i,_owner:d_.current}}_p.Fragment=l_;_p.jsx=o1;_p.jsxs=o1;KA.exports=_p;var K=KA.exports,Um={},s1={exports:{}},Xr={},a1={exports:{}},c1={};(function(t){function e(X,$){var ie=X.length;X.push($);e:for(;0<ie;){var j=ie-1>>>1,oe=X[j];if(0<i(oe,$))X[j]=$,X[ie]=oe,ie=j;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var $=X[0],ie=X.pop();if(ie!==$){X[0]=ie;e:for(var j=0,oe=X.length,ke=oe>>>1;j<ke;){var Le=2*(j+1)-1,de=X[Le],Pe=Le+1,Ye=X[Pe];if(0>i(de,ie))Pe<oe&&0>i(Ye,de)?(X[j]=Ye,X[Pe]=ie,j=Pe):(X[j]=de,X[Le]=ie,j=Le);else if(Pe<oe&&0>i(Ye,ie))X[j]=Ye,X[Pe]=ie,j=Pe;else break e}}return $}function i(X,$){var ie=X.sortIndex-$.sortIndex;return ie!==0?ie:X.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var c=[],l=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,C=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(X){for(var $=n(l);$!==null;){if($.callback===null)r(l);else if($.startTime<=X)r(l),$.sortIndex=$.expirationTime,e(c,$);else break;$=n(l)}}function k(X){if(m=!1,S(X),!p)if(n(c)!==null)p=!0,ee(w);else{var $=n(l);$!==null&&re(k,$.startTime-X)}}function w(X,$){p=!1,m&&(m=!1,g(T),T=-1),f=!0;var ie=h;try{for(S($),d=n(c);d!==null&&(!(d.expirationTime>$)||X&&!L());){var j=d.callback;if(typeof j=="function"){d.callback=null,h=d.priorityLevel;var oe=j(d.expirationTime<=$);$=t.unstable_now(),typeof oe=="function"?d.callback=oe:d===n(c)&&r(c),S($)}else r(c);d=n(c)}if(d!==null)var ke=!0;else{var Le=n(l);Le!==null&&re(k,Le.startTime-$),ke=!1}return ke}finally{d=null,h=ie,f=!1}}var A=!1,x=null,T=-1,_=5,O=-1;function L(){return!(t.unstable_now()-O<_)}function U(){if(x!==null){var X=t.unstable_now();O=X;var $=!0;try{$=x(!0,X)}finally{$?z():(A=!1,x=null)}}else A=!1}var z;if(typeof v=="function")z=function(){v(U)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,J=Z.port2;Z.port1.onmessage=U,z=function(){J.postMessage(null)}}else z=function(){C(U,0)};function ee(X){x=X,A||(A=!0,z())}function re(X,$){T=C(function(){X(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,ee(w))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(X){switch(h){case 1:case 2:case 3:var $=3;break;default:$=h}var ie=h;h=$;try{return X()}finally{h=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,$){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ie=h;h=X;try{return $()}finally{h=ie}},t.unstable_scheduleCallback=function(X,$,ie){var j=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?j+ie:j):ie=j,X){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=ie+oe,X={id:u++,callback:$,priorityLevel:X,startTime:ie,expirationTime:oe,sortIndex:-1},ie>j?(X.sortIndex=ie,e(l,X),n(c)===null&&X===n(l)&&(m?(g(T),T=-1):m=!0,re(k,ie-j))):(X.sortIndex=oe,e(c,X),p||f||(p=!0,ee(w))),X},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(X){var $=h;return function(){var ie=h;h=$;try{return X.apply(this,arguments)}finally{h=ie}}}})(c1);a1.exports=c1;var f_=a1.exports,p_=b,Zr=f_;function ce(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l1=new Set,ed={};function pc(t,e){hl(t,e),hl(t+"Capture",e)}function hl(t,e){for(ed[t]=e,t=0;t<e.length;t++)l1.add(e[t])}var hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vm=Object.prototype.hasOwnProperty,g_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,AI={},kI={};function m_(t){return Vm.call(kI,t)?!0:Vm.call(AI,t)?!1:g_.test(t)?kI[t]=!0:(AI[t]=!0,!1)}function v_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function y_(t,e,n,r){if(e===null||typeof e>"u"||v_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var _n={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_n[t]=new sr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_n[e]=new sr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_n[t]=new sr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_n[t]=new sr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_n[t]=new sr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_n[t]=new sr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_n[t]=new sr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_n[t]=new sr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_n[t]=new sr(t,5,!1,t.toLowerCase(),null,!1,!1)});var cy=/[\-:]([a-z])/g;function ly(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cy,ly);_n[e]=new sr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cy,ly);_n[e]=new sr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cy,ly);_n[e]=new sr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_n[t]=new sr(t,1,!1,t.toLowerCase(),null,!1,!1)});_n.xlinkHref=new sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_n[t]=new sr(t,1,!1,t.toLowerCase(),null,!0,!0)});function uy(t,e,n,r){var i=_n.hasOwnProperty(e)?_n[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(y_(e,n,i,r)&&(n=null),r||i===null?m_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ss=p_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ch=Symbol.for("react.element"),Nc=Symbol.for("react.portal"),_c=Symbol.for("react.fragment"),dy=Symbol.for("react.strict_mode"),Gm=Symbol.for("react.profiler"),u1=Symbol.for("react.provider"),d1=Symbol.for("react.context"),hy=Symbol.for("react.forward_ref"),Wm=Symbol.for("react.suspense"),jm=Symbol.for("react.suspense_list"),fy=Symbol.for("react.memo"),Vs=Symbol.for("react.lazy"),h1=Symbol.for("react.offscreen"),EI=Symbol.iterator;function ql(t){return t===null||typeof t!="object"?null:(t=EI&&t[EI]||t["@@iterator"],typeof t=="function"?t:null)}var Ft=Object.assign,kg;function bu(t){if(kg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);kg=e&&e[1]||""}return`
`+kg+t}var Eg=!1;function Tg(t,e){if(!t||Eg)return"";Eg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var c=`
`+i[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=a);break}}}finally{Eg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?bu(t):""}function C_(t){switch(t.tag){case 5:return bu(t.type);case 16:return bu("Lazy");case 13:return bu("Suspense");case 19:return bu("SuspenseList");case 0:case 2:case 15:return t=Tg(t.type,!1),t;case 11:return t=Tg(t.type.render,!1),t;case 1:return t=Tg(t.type,!0),t;default:return""}}function Zm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _c:return"Fragment";case Nc:return"Portal";case Gm:return"Profiler";case dy:return"StrictMode";case Wm:return"Suspense";case jm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case d1:return(t.displayName||"Context")+".Consumer";case u1:return(t._context.displayName||"Context")+".Provider";case hy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case fy:return e=t.displayName||null,e!==null?e:Zm(t.type)||"Memo";case Vs:e=t._payload,t=t._init;try{return Zm(t(e))}catch{}}return null}function I_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zm(e);case 8:return e===dy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function fa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function f1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function S_(t){var e=f1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function lh(t){t._valueTracker||(t._valueTracker=S_(t))}function p1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=f1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ef(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hm(t,e){var n=e.checked;return Ft({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function TI(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=fa(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function g1(t,e){e=e.checked,e!=null&&uy(t,"checked",e,!1)}function zm(t,e){g1(t,e);var n=fa(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Xm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Xm(t,e.type,fa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function RI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Xm(t,e,n){(e!=="number"||Ef(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var wu=Array.isArray;function zc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+fa(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function $m(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Ft({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ce(92));if(wu(n)){if(1<n.length)throw Error(ce(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:fa(n)}}function m1(t,e){var n=fa(e.value),r=fa(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function PI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function v1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Km(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?v1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var uh,y1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(uh=uh||document.createElement("div"),uh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=uh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function td(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},b_=["Webkit","ms","Moz","O"];Object.keys(Fu).forEach(function(t){b_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fu[e]=Fu[t]})});function C1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fu.hasOwnProperty(t)&&Fu[t]?(""+e).trim():e+"px"}function I1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=C1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var w_=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jm(t,e){if(e){if(w_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function Ym(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qm=null;function py(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qm=null,Xc=null,$c=null;function NI(t){if(t=jd(t)){if(typeof qm!="function")throw Error(ce(280));var e=t.stateNode;e&&(e=Fp(e),qm(t.stateNode,t.type,e))}}function S1(t){Xc?$c?$c.push(t):$c=[t]:Xc=t}function b1(){if(Xc){var t=Xc,e=$c;if($c=Xc=null,NI(t),e)for(t=0;t<e.length;t++)NI(e[t])}}function w1(t,e){return t(e)}function A1(){}var Rg=!1;function k1(t,e,n){if(Rg)return t(e,n);Rg=!0;try{return w1(t,e,n)}finally{Rg=!1,(Xc!==null||$c!==null)&&(A1(),b1())}}function nd(t,e){var n=t.stateNode;if(n===null)return null;var r=Fp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ce(231,e,typeof n));return n}var ev=!1;if(hs)try{var eu={};Object.defineProperty(eu,"passive",{get:function(){ev=!0}}),window.addEventListener("test",eu,eu),window.removeEventListener("test",eu,eu)}catch{ev=!1}function A_(t,e,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var Bu=!1,Tf=null,Rf=!1,tv=null,k_={onError:function(t){Bu=!0,Tf=t}};function E_(t,e,n,r,i,o,s,a,c){Bu=!1,Tf=null,A_.apply(k_,arguments)}function T_(t,e,n,r,i,o,s,a,c){if(E_.apply(this,arguments),Bu){if(Bu){var l=Tf;Bu=!1,Tf=null}else throw Error(ce(198));Rf||(Rf=!0,tv=l)}}function gc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function E1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _I(t){if(gc(t)!==t)throw Error(ce(188))}function R_(t){var e=t.alternate;if(!e){if(e=gc(t),e===null)throw Error(ce(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return _I(i),t;if(o===r)return _I(i),e;o=o.sibling}throw Error(ce(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ce(189))}}if(n.alternate!==r)throw Error(ce(190))}if(n.tag!==3)throw Error(ce(188));return n.stateNode.current===n?t:e}function T1(t){return t=R_(t),t!==null?R1(t):null}function R1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=R1(t);if(e!==null)return e;t=t.sibling}return null}var x1=Zr.unstable_scheduleCallback,OI=Zr.unstable_cancelCallback,x_=Zr.unstable_shouldYield,P_=Zr.unstable_requestPaint,zt=Zr.unstable_now,N_=Zr.unstable_getCurrentPriorityLevel,gy=Zr.unstable_ImmediatePriority,P1=Zr.unstable_UserBlockingPriority,xf=Zr.unstable_NormalPriority,__=Zr.unstable_LowPriority,N1=Zr.unstable_IdlePriority,Op=null,mo=null;function O_(t){if(mo&&typeof mo.onCommitFiberRoot=="function")try{mo.onCommitFiberRoot(Op,t,void 0,(t.current.flags&128)===128)}catch{}}var _i=Math.clz32?Math.clz32:L_,M_=Math.log,D_=Math.LN2;function L_(t){return t>>>=0,t===0?32:31-(M_(t)/D_|0)|0}var dh=64,hh=4194304;function Au(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Pf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Au(a):(o&=s,o!==0&&(r=Au(o)))}else s=n&~i,s!==0?r=Au(s):o!==0&&(r=Au(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_i(e),i=1<<n,r|=t[n],e&=~i;return r}function F_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-_i(o),a=1<<s,c=i[s];c===-1?(!(a&n)||a&r)&&(i[s]=F_(a,e)):c<=e&&(t.expiredLanes|=a),o&=~a}}function nv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _1(){var t=dh;return dh<<=1,!(dh&4194240)&&(dh=64),t}function xg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Gd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_i(e),t[e]=n}function U_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-_i(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function my(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_i(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ut=0;function O1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var M1,vy,D1,L1,F1,rv=!1,fh=[],ra=null,ia=null,oa=null,rd=new Map,id=new Map,js=[],V_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function MI(t,e){switch(t){case"focusin":case"focusout":ra=null;break;case"dragenter":case"dragleave":ia=null;break;case"mouseover":case"mouseout":oa=null;break;case"pointerover":case"pointerout":rd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":id.delete(e.pointerId)}}function tu(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=jd(e),e!==null&&vy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function G_(t,e,n,r,i){switch(e){case"focusin":return ra=tu(ra,t,e,n,r,i),!0;case"dragenter":return ia=tu(ia,t,e,n,r,i),!0;case"mouseover":return oa=tu(oa,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return rd.set(o,tu(rd.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,id.set(o,tu(id.get(o)||null,t,e,n,r,i)),!0}return!1}function B1(t){var e=Ua(t.target);if(e!==null){var n=gc(e);if(n!==null){if(e=n.tag,e===13){if(e=E1(n),e!==null){t.blockedOn=e,F1(t.priority,function(){D1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=iv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Qm=r,n.target.dispatchEvent(r),Qm=null}else return e=jd(n),e!==null&&vy(e),t.blockedOn=n,!1;e.shift()}return!0}function DI(t,e,n){Wh(t)&&n.delete(e)}function W_(){rv=!1,ra!==null&&Wh(ra)&&(ra=null),ia!==null&&Wh(ia)&&(ia=null),oa!==null&&Wh(oa)&&(oa=null),rd.forEach(DI),id.forEach(DI)}function nu(t,e){t.blockedOn===e&&(t.blockedOn=null,rv||(rv=!0,Zr.unstable_scheduleCallback(Zr.unstable_NormalPriority,W_)))}function od(t){function e(i){return nu(i,t)}if(0<fh.length){nu(fh[0],t);for(var n=1;n<fh.length;n++){var r=fh[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ra!==null&&nu(ra,t),ia!==null&&nu(ia,t),oa!==null&&nu(oa,t),rd.forEach(e),id.forEach(e),n=0;n<js.length;n++)r=js[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<js.length&&(n=js[0],n.blockedOn===null);)B1(n),n.blockedOn===null&&js.shift()}var Kc=Ss.ReactCurrentBatchConfig,Nf=!0;function j_(t,e,n,r){var i=ut,o=Kc.transition;Kc.transition=null;try{ut=1,yy(t,e,n,r)}finally{ut=i,Kc.transition=o}}function Z_(t,e,n,r){var i=ut,o=Kc.transition;Kc.transition=null;try{ut=4,yy(t,e,n,r)}finally{ut=i,Kc.transition=o}}function yy(t,e,n,r){if(Nf){var i=iv(t,e,n,r);if(i===null)Ug(t,e,r,_f,n),MI(t,r);else if(G_(i,t,e,n,r))r.stopPropagation();else if(MI(t,r),e&4&&-1<V_.indexOf(t)){for(;i!==null;){var o=jd(i);if(o!==null&&M1(o),o=iv(t,e,n,r),o===null&&Ug(t,e,r,_f,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Ug(t,e,r,null,n)}}var _f=null;function iv(t,e,n,r){if(_f=null,t=py(r),t=Ua(t),t!==null)if(e=gc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=E1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _f=t,null}function U1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(N_()){case gy:return 1;case P1:return 4;case xf:case __:return 16;case N1:return 536870912;default:return 16}default:return 16}}var zs=null,Cy=null,jh=null;function V1(){if(jh)return jh;var t,e=Cy,n=e.length,r,i="value"in zs?zs.value:zs.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return jh=i.slice(t,1<r?1-r:void 0)}function Zh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ph(){return!0}function LI(){return!1}function $r(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ph:LI,this.isPropagationStopped=LI,this}return Ft(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ph)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ph)},persist:function(){},isPersistent:ph}),e}var Nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Iy=$r(Nl),Wd=Ft({},Nl,{view:0,detail:0}),H_=$r(Wd),Pg,Ng,ru,Mp=Ft({},Wd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ru&&(ru&&t.type==="mousemove"?(Pg=t.screenX-ru.screenX,Ng=t.screenY-ru.screenY):Ng=Pg=0,ru=t),Pg)},movementY:function(t){return"movementY"in t?t.movementY:Ng}}),FI=$r(Mp),z_=Ft({},Mp,{dataTransfer:0}),X_=$r(z_),$_=Ft({},Wd,{relatedTarget:0}),_g=$r($_),K_=Ft({},Nl,{animationName:0,elapsedTime:0,pseudoElement:0}),J_=$r(K_),Y_=Ft({},Nl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Q_=$r(Y_),q_=Ft({},Nl,{data:0}),BI=$r(q_),eO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nO[t])?!!e[t]:!1}function Sy(){return rO}var iO=Ft({},Wd,{key:function(t){if(t.key){var e=eO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Zh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sy,charCode:function(t){return t.type==="keypress"?Zh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),oO=$r(iO),sO=Ft({},Mp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),UI=$r(sO),aO=Ft({},Wd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sy}),cO=$r(aO),lO=Ft({},Nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),uO=$r(lO),dO=Ft({},Mp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hO=$r(dO),fO=[9,13,27,32],by=hs&&"CompositionEvent"in window,Uu=null;hs&&"documentMode"in document&&(Uu=document.documentMode);var pO=hs&&"TextEvent"in window&&!Uu,G1=hs&&(!by||Uu&&8<Uu&&11>=Uu),VI=" ",GI=!1;function W1(t,e){switch(t){case"keyup":return fO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Oc=!1;function gO(t,e){switch(t){case"compositionend":return j1(e);case"keypress":return e.which!==32?null:(GI=!0,VI);case"textInput":return t=e.data,t===VI&&GI?null:t;default:return null}}function mO(t,e){if(Oc)return t==="compositionend"||!by&&W1(t,e)?(t=V1(),jh=Cy=zs=null,Oc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return G1&&e.locale!=="ko"?null:e.data;default:return null}}var vO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function WI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!vO[t.type]:e==="textarea"}function Z1(t,e,n,r){S1(r),e=Of(e,"onChange"),0<e.length&&(n=new Iy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Vu=null,sd=null;function yO(t){tk(t,0)}function Dp(t){var e=Lc(t);if(p1(e))return t}function CO(t,e){if(t==="change")return e}var H1=!1;if(hs){var Og;if(hs){var Mg="oninput"in document;if(!Mg){var jI=document.createElement("div");jI.setAttribute("oninput","return;"),Mg=typeof jI.oninput=="function"}Og=Mg}else Og=!1;H1=Og&&(!document.documentMode||9<document.documentMode)}function ZI(){Vu&&(Vu.detachEvent("onpropertychange",z1),sd=Vu=null)}function z1(t){if(t.propertyName==="value"&&Dp(sd)){var e=[];Z1(e,sd,t,py(t)),k1(yO,e)}}function IO(t,e,n){t==="focusin"?(ZI(),Vu=e,sd=n,Vu.attachEvent("onpropertychange",z1)):t==="focusout"&&ZI()}function SO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dp(sd)}function bO(t,e){if(t==="click")return Dp(e)}function wO(t,e){if(t==="input"||t==="change")return Dp(e)}function AO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Di=typeof Object.is=="function"?Object.is:AO;function ad(t,e){if(Di(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Vm.call(e,i)||!Di(t[i],e[i]))return!1}return!0}function HI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zI(t,e){var n=HI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=HI(n)}}function X1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?X1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function $1(){for(var t=window,e=Ef();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ef(t.document)}return e}function wy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function kO(t){var e=$1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&X1(n.ownerDocument.documentElement,n)){if(r!==null&&wy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=zI(n,o);var s=zI(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EO=hs&&"documentMode"in document&&11>=document.documentMode,Mc=null,ov=null,Gu=null,sv=!1;function XI(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sv||Mc==null||Mc!==Ef(r)||(r=Mc,"selectionStart"in r&&wy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gu&&ad(Gu,r)||(Gu=r,r=Of(ov,"onSelect"),0<r.length&&(e=new Iy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mc)))}function gh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Dc={animationend:gh("Animation","AnimationEnd"),animationiteration:gh("Animation","AnimationIteration"),animationstart:gh("Animation","AnimationStart"),transitionend:gh("Transition","TransitionEnd")},Dg={},K1={};hs&&(K1=document.createElement("div").style,"AnimationEvent"in window||(delete Dc.animationend.animation,delete Dc.animationiteration.animation,delete Dc.animationstart.animation),"TransitionEvent"in window||delete Dc.transitionend.transition);function Lp(t){if(Dg[t])return Dg[t];if(!Dc[t])return t;var e=Dc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in K1)return Dg[t]=e[n];return t}var J1=Lp("animationend"),Y1=Lp("animationiteration"),Q1=Lp("animationstart"),q1=Lp("transitionend"),ek=new Map,$I="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ca(t,e){ek.set(t,e),pc(e,[t])}for(var Lg=0;Lg<$I.length;Lg++){var Fg=$I[Lg],TO=Fg.toLowerCase(),RO=Fg[0].toUpperCase()+Fg.slice(1);Ca(TO,"on"+RO)}Ca(J1,"onAnimationEnd");Ca(Y1,"onAnimationIteration");Ca(Q1,"onAnimationStart");Ca("dblclick","onDoubleClick");Ca("focusin","onFocus");Ca("focusout","onBlur");Ca(q1,"onTransitionEnd");hl("onMouseEnter",["mouseout","mouseover"]);hl("onMouseLeave",["mouseout","mouseover"]);hl("onPointerEnter",["pointerout","pointerover"]);hl("onPointerLeave",["pointerout","pointerover"]);pc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pc("onBeforeInput",["compositionend","keypress","textInput","paste"]);pc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xO=new Set("cancel close invalid load scroll toggle".split(" ").concat(ku));function KI(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,T_(r,e,void 0,t),t.currentTarget=null}function tk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;KI(i,a,l),o=c}else for(s=0;s<r.length;s++){if(a=r[s],c=a.instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;KI(i,a,l),o=c}}}if(Rf)throw t=tv,Rf=!1,tv=null,t}function At(t,e){var n=e[dv];n===void 0&&(n=e[dv]=new Set);var r=t+"__bubble";n.has(r)||(nk(e,t,2,!1),n.add(r))}function Bg(t,e,n){var r=0;e&&(r|=4),nk(n,t,r,e)}var mh="_reactListening"+Math.random().toString(36).slice(2);function cd(t){if(!t[mh]){t[mh]=!0,l1.forEach(function(n){n!=="selectionchange"&&(xO.has(n)||Bg(n,!1,t),Bg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[mh]||(e[mh]=!0,Bg("selectionchange",!1,e))}}function nk(t,e,n,r){switch(U1(e)){case 1:var i=j_;break;case 4:i=Z_;break;default:i=yy}n=i.bind(null,e,n,t),i=void 0,!ev||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ug(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Ua(a),s===null)return;if(c=s.tag,c===5||c===6){r=o=s;continue e}a=a.parentNode}}r=r.return}k1(function(){var l=o,u=py(n),d=[];e:{var h=ek.get(t);if(h!==void 0){var f=Iy,p=t;switch(t){case"keypress":if(Zh(n)===0)break e;case"keydown":case"keyup":f=oO;break;case"focusin":p="focus",f=_g;break;case"focusout":p="blur",f=_g;break;case"beforeblur":case"afterblur":f=_g;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=FI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=X_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=cO;break;case J1:case Y1:case Q1:f=J_;break;case q1:f=uO;break;case"scroll":f=H_;break;case"wheel":f=hO;break;case"copy":case"cut":case"paste":f=Q_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=UI}var m=(e&4)!==0,C=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var v=l,S;v!==null;){S=v;var k=S.stateNode;if(S.tag===5&&k!==null&&(S=k,g!==null&&(k=nd(v,g),k!=null&&m.push(ld(v,k,S)))),C)break;v=v.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Qm&&(p=n.relatedTarget||n.fromElement)&&(Ua(p)||p[fs]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=l,p=p?Ua(p):null,p!==null&&(C=gc(p),p!==C||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=l),f!==p)){if(m=FI,k="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=UI,k="onPointerLeave",g="onPointerEnter",v="pointer"),C=f==null?h:Lc(f),S=p==null?h:Lc(p),h=new m(k,v+"leave",f,n,u),h.target=C,h.relatedTarget=S,k=null,Ua(u)===l&&(m=new m(g,v+"enter",p,n,u),m.target=S,m.relatedTarget=C,k=m),C=k,f&&p)t:{for(m=f,g=p,v=0,S=m;S;S=wc(S))v++;for(S=0,k=g;k;k=wc(k))S++;for(;0<v-S;)m=wc(m),v--;for(;0<S-v;)g=wc(g),S--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=wc(m),g=wc(g)}m=null}else m=null;f!==null&&JI(d,h,f,m,!1),p!==null&&C!==null&&JI(d,C,p,m,!0)}}e:{if(h=l?Lc(l):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var w=CO;else if(WI(h))if(H1)w=wO;else{w=SO;var A=IO}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=bO);if(w&&(w=w(t,l))){Z1(d,w,n,u);break e}A&&A(t,h,l),t==="focusout"&&(A=h._wrapperState)&&A.controlled&&h.type==="number"&&Xm(h,"number",h.value)}switch(A=l?Lc(l):window,t){case"focusin":(WI(A)||A.contentEditable==="true")&&(Mc=A,ov=l,Gu=null);break;case"focusout":Gu=ov=Mc=null;break;case"mousedown":sv=!0;break;case"contextmenu":case"mouseup":case"dragend":sv=!1,XI(d,n,u);break;case"selectionchange":if(EO)break;case"keydown":case"keyup":XI(d,n,u)}var x;if(by)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Oc?W1(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(G1&&n.locale!=="ko"&&(Oc||T!=="onCompositionStart"?T==="onCompositionEnd"&&Oc&&(x=V1()):(zs=u,Cy="value"in zs?zs.value:zs.textContent,Oc=!0)),A=Of(l,T),0<A.length&&(T=new BI(T,t,null,n,u),d.push({event:T,listeners:A}),x?T.data=x:(x=j1(n),x!==null&&(T.data=x)))),(x=pO?gO(t,n):mO(t,n))&&(l=Of(l,"onBeforeInput"),0<l.length&&(u=new BI("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=x))}tk(d,e)})}function ld(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Of(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=nd(t,n),o!=null&&r.unshift(ld(t,o,i)),o=nd(t,e),o!=null&&r.push(ld(t,o,i))),t=t.return}return r}function wc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function JI(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=nd(n,o),c!=null&&s.unshift(ld(n,c,a))):i||(c=nd(n,o),c!=null&&s.push(ld(n,c,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var PO=/\r\n?/g,NO=/\u0000|\uFFFD/g;function YI(t){return(typeof t=="string"?t:""+t).replace(PO,`
`).replace(NO,"")}function vh(t,e,n){if(e=YI(e),YI(t)!==e&&n)throw Error(ce(425))}function Mf(){}var av=null,cv=null;function lv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var uv=typeof setTimeout=="function"?setTimeout:void 0,_O=typeof clearTimeout=="function"?clearTimeout:void 0,QI=typeof Promise=="function"?Promise:void 0,OO=typeof queueMicrotask=="function"?queueMicrotask:typeof QI<"u"?function(t){return QI.resolve(null).then(t).catch(MO)}:uv;function MO(t){setTimeout(function(){throw t})}function Vg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),od(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);od(e)}function sa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _l=Math.random().toString(36).slice(2),Ji="__reactFiber$"+_l,ud="__reactProps$"+_l,fs="__reactContainer$"+_l,dv="__reactEvents$"+_l,DO="__reactListeners$"+_l,LO="__reactHandles$"+_l;function Ua(t){var e=t[Ji];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fs]||n[Ji]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qI(t);t!==null;){if(n=t[Ji])return n;t=qI(t)}return e}t=n,n=t.parentNode}return null}function jd(t){return t=t[Ji]||t[fs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Lc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ce(33))}function Fp(t){return t[ud]||null}var hv=[],Fc=-1;function Ia(t){return{current:t}}function xt(t){0>Fc||(t.current=hv[Fc],hv[Fc]=null,Fc--)}function St(t,e){Fc++,hv[Fc]=t.current,t.current=e}var pa={},Hn=Ia(pa),Ir=Ia(!1),ec=pa;function fl(t,e){var n=t.type.contextTypes;if(!n)return pa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Sr(t){return t=t.childContextTypes,t!=null}function Df(){xt(Ir),xt(Hn)}function eS(t,e,n){if(Hn.current!==pa)throw Error(ce(168));St(Hn,e),St(Ir,n)}function rk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ce(108,I_(t)||"Unknown",i));return Ft({},n,r)}function Lf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||pa,ec=Hn.current,St(Hn,t),St(Ir,Ir.current),!0}function tS(t,e,n){var r=t.stateNode;if(!r)throw Error(ce(169));n?(t=rk(t,e,ec),r.__reactInternalMemoizedMergedChildContext=t,xt(Ir),xt(Hn),St(Hn,t)):xt(Ir),St(Ir,n)}var No=null,Bp=!1,Gg=!1;function ik(t){No===null?No=[t]:No.push(t)}function FO(t){Bp=!0,ik(t)}function Sa(){if(!Gg&&No!==null){Gg=!0;var t=0,e=ut;try{var n=No;for(ut=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}No=null,Bp=!1}catch(i){throw No!==null&&(No=No.slice(t+1)),x1(gy,Sa),i}finally{ut=e,Gg=!1}}return null}var Bc=[],Uc=0,Ff=null,Bf=0,Yr=[],Qr=0,tc=null,Lo=1,Fo="";function xa(t,e){Bc[Uc++]=Bf,Bc[Uc++]=Ff,Ff=t,Bf=e}function ok(t,e,n){Yr[Qr++]=Lo,Yr[Qr++]=Fo,Yr[Qr++]=tc,tc=t;var r=Lo;t=Fo;var i=32-_i(r)-1;r&=~(1<<i),n+=1;var o=32-_i(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Lo=1<<32-_i(e)+i|n<<i|r,Fo=o+t}else Lo=1<<o|n<<i|r,Fo=t}function Ay(t){t.return!==null&&(xa(t,1),ok(t,1,0))}function ky(t){for(;t===Ff;)Ff=Bc[--Uc],Bc[Uc]=null,Bf=Bc[--Uc],Bc[Uc]=null;for(;t===tc;)tc=Yr[--Qr],Yr[Qr]=null,Fo=Yr[--Qr],Yr[Qr]=null,Lo=Yr[--Qr],Yr[Qr]=null}var Wr=null,Vr=null,Ot=!1,Ai=null;function sk(t,e){var n=ei(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wr=t,Vr=sa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wr=t,Vr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=tc!==null?{id:Lo,overflow:Fo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ei(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wr=t,Vr=null,!0):!1;default:return!1}}function fv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function pv(t){if(Ot){var e=Vr;if(e){var n=e;if(!nS(t,e)){if(fv(t))throw Error(ce(418));e=sa(n.nextSibling);var r=Wr;e&&nS(t,e)?sk(r,n):(t.flags=t.flags&-4097|2,Ot=!1,Wr=t)}}else{if(fv(t))throw Error(ce(418));t.flags=t.flags&-4097|2,Ot=!1,Wr=t}}}function rS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wr=t}function yh(t){if(t!==Wr)return!1;if(!Ot)return rS(t),Ot=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!lv(t.type,t.memoizedProps)),e&&(e=Vr)){if(fv(t))throw ak(),Error(ce(418));for(;e;)sk(t,e),e=sa(e.nextSibling)}if(rS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ce(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Vr=sa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Vr=null}}else Vr=Wr?sa(t.stateNode.nextSibling):null;return!0}function ak(){for(var t=Vr;t;)t=sa(t.nextSibling)}function pl(){Vr=Wr=null,Ot=!1}function Ey(t){Ai===null?Ai=[t]:Ai.push(t)}var BO=Ss.ReactCurrentBatchConfig;function iu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ce(309));var r=n.stateNode}if(!r)throw Error(ce(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(ce(284));if(!n._owner)throw Error(ce(290,t))}return t}function Ch(t,e){throw t=Object.prototype.toString.call(e),Error(ce(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function iS(t){var e=t._init;return e(t._payload)}function ck(t){function e(g,v){if(t){var S=g.deletions;S===null?(g.deletions=[v],g.flags|=16):S.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function i(g,v){return g=ua(g,v),g.index=0,g.sibling=null,g}function o(g,v,S){return g.index=S,t?(S=g.alternate,S!==null?(S=S.index,S<v?(g.flags|=2,v):S):(g.flags|=2,v)):(g.flags|=1048576,v)}function s(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,v,S,k){return v===null||v.tag!==6?(v=$g(S,g.mode,k),v.return=g,v):(v=i(v,S),v.return=g,v)}function c(g,v,S,k){var w=S.type;return w===_c?u(g,v,S.props.children,k,S.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Vs&&iS(w)===v.type)?(k=i(v,S.props),k.ref=iu(g,v,S),k.return=g,k):(k=Yh(S.type,S.key,S.props,null,g.mode,k),k.ref=iu(g,v,S),k.return=g,k)}function l(g,v,S,k){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=Kg(S,g.mode,k),v.return=g,v):(v=i(v,S.children||[]),v.return=g,v)}function u(g,v,S,k,w){return v===null||v.tag!==7?(v=$a(S,g.mode,k,w),v.return=g,v):(v=i(v,S),v.return=g,v)}function d(g,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=$g(""+v,g.mode,S),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ch:return S=Yh(v.type,v.key,v.props,null,g.mode,S),S.ref=iu(g,null,v),S.return=g,S;case Nc:return v=Kg(v,g.mode,S),v.return=g,v;case Vs:var k=v._init;return d(g,k(v._payload),S)}if(wu(v)||ql(v))return v=$a(v,g.mode,S,null),v.return=g,v;Ch(g,v)}return null}function h(g,v,S,k){var w=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return w!==null?null:a(g,v,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ch:return S.key===w?c(g,v,S,k):null;case Nc:return S.key===w?l(g,v,S,k):null;case Vs:return w=S._init,h(g,v,w(S._payload),k)}if(wu(S)||ql(S))return w!==null?null:u(g,v,S,k,null);Ch(g,S)}return null}function f(g,v,S,k,w){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(S)||null,a(v,g,""+k,w);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ch:return g=g.get(k.key===null?S:k.key)||null,c(v,g,k,w);case Nc:return g=g.get(k.key===null?S:k.key)||null,l(v,g,k,w);case Vs:var A=k._init;return f(g,v,S,A(k._payload),w)}if(wu(k)||ql(k))return g=g.get(S)||null,u(v,g,k,w,null);Ch(v,k)}return null}function p(g,v,S,k){for(var w=null,A=null,x=v,T=v=0,_=null;x!==null&&T<S.length;T++){x.index>T?(_=x,x=null):_=x.sibling;var O=h(g,x,S[T],k);if(O===null){x===null&&(x=_);break}t&&x&&O.alternate===null&&e(g,x),v=o(O,v,T),A===null?w=O:A.sibling=O,A=O,x=_}if(T===S.length)return n(g,x),Ot&&xa(g,T),w;if(x===null){for(;T<S.length;T++)x=d(g,S[T],k),x!==null&&(v=o(x,v,T),A===null?w=x:A.sibling=x,A=x);return Ot&&xa(g,T),w}for(x=r(g,x);T<S.length;T++)_=f(x,g,T,S[T],k),_!==null&&(t&&_.alternate!==null&&x.delete(_.key===null?T:_.key),v=o(_,v,T),A===null?w=_:A.sibling=_,A=_);return t&&x.forEach(function(L){return e(g,L)}),Ot&&xa(g,T),w}function m(g,v,S,k){var w=ql(S);if(typeof w!="function")throw Error(ce(150));if(S=w.call(S),S==null)throw Error(ce(151));for(var A=w=null,x=v,T=v=0,_=null,O=S.next();x!==null&&!O.done;T++,O=S.next()){x.index>T?(_=x,x=null):_=x.sibling;var L=h(g,x,O.value,k);if(L===null){x===null&&(x=_);break}t&&x&&L.alternate===null&&e(g,x),v=o(L,v,T),A===null?w=L:A.sibling=L,A=L,x=_}if(O.done)return n(g,x),Ot&&xa(g,T),w;if(x===null){for(;!O.done;T++,O=S.next())O=d(g,O.value,k),O!==null&&(v=o(O,v,T),A===null?w=O:A.sibling=O,A=O);return Ot&&xa(g,T),w}for(x=r(g,x);!O.done;T++,O=S.next())O=f(x,g,T,O.value,k),O!==null&&(t&&O.alternate!==null&&x.delete(O.key===null?T:O.key),v=o(O,v,T),A===null?w=O:A.sibling=O,A=O);return t&&x.forEach(function(U){return e(g,U)}),Ot&&xa(g,T),w}function C(g,v,S,k){if(typeof S=="object"&&S!==null&&S.type===_c&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ch:e:{for(var w=S.key,A=v;A!==null;){if(A.key===w){if(w=S.type,w===_c){if(A.tag===7){n(g,A.sibling),v=i(A,S.props.children),v.return=g,g=v;break e}}else if(A.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Vs&&iS(w)===A.type){n(g,A.sibling),v=i(A,S.props),v.ref=iu(g,A,S),v.return=g,g=v;break e}n(g,A);break}else e(g,A);A=A.sibling}S.type===_c?(v=$a(S.props.children,g.mode,k,S.key),v.return=g,g=v):(k=Yh(S.type,S.key,S.props,null,g.mode,k),k.ref=iu(g,v,S),k.return=g,g=k)}return s(g);case Nc:e:{for(A=S.key;v!==null;){if(v.key===A)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){n(g,v.sibling),v=i(v,S.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=Kg(S,g.mode,k),v.return=g,g=v}return s(g);case Vs:return A=S._init,C(g,v,A(S._payload),k)}if(wu(S))return p(g,v,S,k);if(ql(S))return m(g,v,S,k);Ch(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(n(g,v.sibling),v=i(v,S),v.return=g,g=v):(n(g,v),v=$g(S,g.mode,k),v.return=g,g=v),s(g)):n(g,v)}return C}var gl=ck(!0),lk=ck(!1),Uf=Ia(null),Vf=null,Vc=null,Ty=null;function Ry(){Ty=Vc=Vf=null}function xy(t){var e=Uf.current;xt(Uf),t._currentValue=e}function gv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Jc(t,e){Vf=t,Ty=Vc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yr=!0),t.firstContext=null)}function ii(t){var e=t._currentValue;if(Ty!==t)if(t={context:t,memoizedValue:e,next:null},Vc===null){if(Vf===null)throw Error(ce(308));Vc=t,Vf.dependencies={lanes:0,firstContext:t}}else Vc=Vc.next=t;return e}var Va=null;function Py(t){Va===null?Va=[t]:Va.push(t)}function uk(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Py(e)):(n.next=i.next,i.next=n),e.interleaved=n,ps(t,r)}function ps(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Gs=!1;function Ny(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function cs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function aa(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,nt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ps(t,n)}return i=r.interleaved,i===null?(e.next=e,Py(r)):(e.next=i.next,i.next=e),r.interleaved=e,ps(t,n)}function Hh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,my(t,n)}}function oS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Gf(t,e,n,r){var i=t.updateQueue;Gs=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,s===null?o=l:s.next=l,s=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(o!==null){var d=i.baseState;s=0,u=l=c=null,a=o;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Ft({},d,h);break e;case 2:Gs=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=f,c=d):u=u.next=f,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);rc|=s,t.lanes=s,t.memoizedState=d}}function sS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ce(191,i));i.call(r)}}}var Zd={},vo=Ia(Zd),dd=Ia(Zd),hd=Ia(Zd);function Ga(t){if(t===Zd)throw Error(ce(174));return t}function _y(t,e){switch(St(hd,e),St(dd,t),St(vo,Zd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Km(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Km(e,t)}xt(vo),St(vo,e)}function ml(){xt(vo),xt(dd),xt(hd)}function hk(t){Ga(hd.current);var e=Ga(vo.current),n=Km(e,t.type);e!==n&&(St(dd,t),St(vo,n))}function Oy(t){dd.current===t&&(xt(vo),xt(dd))}var Dt=Ia(0);function Wf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Wg=[];function My(){for(var t=0;t<Wg.length;t++)Wg[t]._workInProgressVersionPrimary=null;Wg.length=0}var zh=Ss.ReactCurrentDispatcher,jg=Ss.ReactCurrentBatchConfig,nc=0,Lt=null,un=null,yn=null,jf=!1,Wu=!1,fd=0,UO=0;function Bn(){throw Error(ce(321))}function Dy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Di(t[n],e[n]))return!1;return!0}function Ly(t,e,n,r,i,o){if(nc=o,Lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zh.current=t===null||t.memoizedState===null?jO:ZO,t=n(r,i),Wu){o=0;do{if(Wu=!1,fd=0,25<=o)throw Error(ce(301));o+=1,yn=un=null,e.updateQueue=null,zh.current=HO,t=n(r,i)}while(Wu)}if(zh.current=Zf,e=un!==null&&un.next!==null,nc=0,yn=un=Lt=null,jf=!1,e)throw Error(ce(300));return t}function Fy(){var t=fd!==0;return fd=0,t}function $i(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?Lt.memoizedState=yn=t:yn=yn.next=t,yn}function oi(){if(un===null){var t=Lt.alternate;t=t!==null?t.memoizedState:null}else t=un.next;var e=yn===null?Lt.memoizedState:yn.next;if(e!==null)yn=e,un=t;else{if(t===null)throw Error(ce(310));un=t,t={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},yn===null?Lt.memoizedState=yn=t:yn=yn.next=t}return yn}function pd(t,e){return typeof e=="function"?e(t):e}function Zg(t){var e=oi(),n=e.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=t;var r=un,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,c=null,l=o;do{var u=l.lane;if((nc&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,s=r):c=c.next=d,Lt.lanes|=u,rc|=u}l=l.next}while(l!==null&&l!==o);c===null?s=r:c.next=a,Di(r,e.memoizedState)||(yr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Lt.lanes|=o,rc|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Hg(t){var e=oi(),n=e.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Di(o,e.memoizedState)||(yr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function fk(){}function pk(t,e){var n=Lt,r=oi(),i=e(),o=!Di(r.memoizedState,i);if(o&&(r.memoizedState=i,yr=!0),r=r.queue,By(vk.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||yn!==null&&yn.memoizedState.tag&1){if(n.flags|=2048,gd(9,mk.bind(null,n,r,i,e),void 0,null),In===null)throw Error(ce(349));nc&30||gk(n,e,i)}return i}function gk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Lt.updateQueue,e===null?(e={lastEffect:null,stores:null},Lt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function mk(t,e,n,r){e.value=n,e.getSnapshot=r,yk(e)&&Ck(t)}function vk(t,e,n){return n(function(){yk(e)&&Ck(t)})}function yk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Di(t,n)}catch{return!0}}function Ck(t){var e=ps(t,1);e!==null&&Oi(e,t,1,-1)}function aS(t){var e=$i();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pd,lastRenderedState:t},e.queue=t,t=t.dispatch=WO.bind(null,Lt,t),[e.memoizedState,t]}function gd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Lt.updateQueue,e===null?(e={lastEffect:null,stores:null},Lt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ik(){return oi().memoizedState}function Xh(t,e,n,r){var i=$i();Lt.flags|=t,i.memoizedState=gd(1|e,n,void 0,r===void 0?null:r)}function Up(t,e,n,r){var i=oi();r=r===void 0?null:r;var o=void 0;if(un!==null){var s=un.memoizedState;if(o=s.destroy,r!==null&&Dy(r,s.deps)){i.memoizedState=gd(e,n,o,r);return}}Lt.flags|=t,i.memoizedState=gd(1|e,n,o,r)}function cS(t,e){return Xh(8390656,8,t,e)}function By(t,e){return Up(2048,8,t,e)}function Sk(t,e){return Up(4,2,t,e)}function bk(t,e){return Up(4,4,t,e)}function wk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ak(t,e,n){return n=n!=null?n.concat([t]):null,Up(4,4,wk.bind(null,e,t),n)}function Uy(){}function kk(t,e){var n=oi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ek(t,e){var n=oi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Tk(t,e,n){return nc&21?(Di(n,e)||(n=_1(),Lt.lanes|=n,rc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yr=!0),t.memoizedState=n)}function VO(t,e){var n=ut;ut=n!==0&&4>n?n:4,t(!0);var r=jg.transition;jg.transition={};try{t(!1),e()}finally{ut=n,jg.transition=r}}function Rk(){return oi().memoizedState}function GO(t,e,n){var r=la(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xk(t))Pk(e,n);else if(n=uk(t,e,n,r),n!==null){var i=rr();Oi(n,t,r,i),Nk(n,e,r)}}function WO(t,e,n){var r=la(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xk(t))Pk(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Di(a,s)){var c=e.interleaved;c===null?(i.next=i,Py(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=uk(t,e,i,r),n!==null&&(i=rr(),Oi(n,t,r,i),Nk(n,e,r))}}function xk(t){var e=t.alternate;return t===Lt||e!==null&&e===Lt}function Pk(t,e){Wu=jf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Nk(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,my(t,n)}}var Zf={readContext:ii,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},jO={readContext:ii,useCallback:function(t,e){return $i().memoizedState=[t,e===void 0?null:e],t},useContext:ii,useEffect:cS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Xh(4194308,4,wk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Xh(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xh(4,2,t,e)},useMemo:function(t,e){var n=$i();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=$i();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=GO.bind(null,Lt,t),[r.memoizedState,t]},useRef:function(t){var e=$i();return t={current:t},e.memoizedState=t},useState:aS,useDebugValue:Uy,useDeferredValue:function(t){return $i().memoizedState=t},useTransition:function(){var t=aS(!1),e=t[0];return t=VO.bind(null,t[1]),$i().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Lt,i=$i();if(Ot){if(n===void 0)throw Error(ce(407));n=n()}else{if(n=e(),In===null)throw Error(ce(349));nc&30||gk(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,cS(vk.bind(null,r,o,t),[t]),r.flags|=2048,gd(9,mk.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=$i(),e=In.identifierPrefix;if(Ot){var n=Fo,r=Lo;n=(r&~(1<<32-_i(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=UO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ZO={readContext:ii,useCallback:kk,useContext:ii,useEffect:By,useImperativeHandle:Ak,useInsertionEffect:Sk,useLayoutEffect:bk,useMemo:Ek,useReducer:Zg,useRef:Ik,useState:function(){return Zg(pd)},useDebugValue:Uy,useDeferredValue:function(t){var e=oi();return Tk(e,un.memoizedState,t)},useTransition:function(){var t=Zg(pd)[0],e=oi().memoizedState;return[t,e]},useMutableSource:fk,useSyncExternalStore:pk,useId:Rk,unstable_isNewReconciler:!1},HO={readContext:ii,useCallback:kk,useContext:ii,useEffect:By,useImperativeHandle:Ak,useInsertionEffect:Sk,useLayoutEffect:bk,useMemo:Ek,useReducer:Hg,useRef:Ik,useState:function(){return Hg(pd)},useDebugValue:Uy,useDeferredValue:function(t){var e=oi();return un===null?e.memoizedState=t:Tk(e,un.memoizedState,t)},useTransition:function(){var t=Hg(pd)[0],e=oi().memoizedState;return[t,e]},useMutableSource:fk,useSyncExternalStore:pk,useId:Rk,unstable_isNewReconciler:!1};function hi(t,e){if(t&&t.defaultProps){e=Ft({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function mv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ft({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Vp={isMounted:function(t){return(t=t._reactInternals)?gc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=rr(),i=la(t),o=cs(r,i);o.payload=e,n!=null&&(o.callback=n),e=aa(t,o,i),e!==null&&(Oi(e,t,i,r),Hh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=rr(),i=la(t),o=cs(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=aa(t,o,i),e!==null&&(Oi(e,t,i,r),Hh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rr(),r=la(t),i=cs(n,r);i.tag=2,e!=null&&(i.callback=e),e=aa(t,i,r),e!==null&&(Oi(e,t,r,n),Hh(e,t,r))}};function lS(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!ad(n,r)||!ad(i,o):!0}function _k(t,e,n){var r=!1,i=pa,o=e.contextType;return typeof o=="object"&&o!==null?o=ii(o):(i=Sr(e)?ec:Hn.current,r=e.contextTypes,o=(r=r!=null)?fl(t,i):pa),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Vp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function uS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Vp.enqueueReplaceState(e,e.state,null)}function vv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Ny(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=ii(o):(o=Sr(e)?ec:Hn.current,i.context=fl(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(mv(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Vp.enqueueReplaceState(i,i.state,null),Gf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function vl(t,e){try{var n="",r=e;do n+=C_(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function zg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function yv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var zO=typeof WeakMap=="function"?WeakMap:Map;function Ok(t,e,n){n=cs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zf||(zf=!0,Rv=r),yv(t,e)},n}function Mk(t,e,n){n=cs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){yv(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){yv(t,e),typeof r!="function"&&(ca===null?ca=new Set([this]):ca.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function dS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new zO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=sM.bind(null,t,e,n),e.then(t,t))}function hS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fS(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=cs(-1,1),e.tag=2,aa(n,e,1))),n.lanes|=1),t)}var XO=Ss.ReactCurrentOwner,yr=!1;function Jn(t,e,n,r){e.child=t===null?lk(e,null,n,r):gl(e,t.child,n,r)}function pS(t,e,n,r,i){n=n.render;var o=e.ref;return Jc(e,i),r=Ly(t,e,n,r,o,i),n=Fy(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gs(t,e,i)):(Ot&&n&&Ay(e),e.flags|=1,Jn(t,e,r,i),e.child)}function gS(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Xy(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Dk(t,e,o,r,i)):(t=Yh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:ad,n(s,r)&&t.ref===e.ref)return gs(t,e,i)}return e.flags|=1,t=ua(o,r),t.ref=e.ref,t.return=e,e.child=t}function Dk(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(ad(o,r)&&t.ref===e.ref)if(yr=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(yr=!0);else return e.lanes=t.lanes,gs(t,e,i)}return Cv(t,e,n,r,i)}function Lk(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(Wc,Or),Or|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,St(Wc,Or),Or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,St(Wc,Or),Or|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,St(Wc,Or),Or|=r;return Jn(t,e,i,n),e.child}function Fk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Cv(t,e,n,r,i){var o=Sr(n)?ec:Hn.current;return o=fl(e,o),Jc(e,i),n=Ly(t,e,n,r,o,i),r=Fy(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gs(t,e,i)):(Ot&&r&&Ay(e),e.flags|=1,Jn(t,e,n,i),e.child)}function mS(t,e,n,r,i){if(Sr(n)){var o=!0;Lf(e)}else o=!1;if(Jc(e,i),e.stateNode===null)$h(t,e),_k(e,n,r),vv(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var c=s.context,l=n.contextType;typeof l=="object"&&l!==null?l=ii(l):(l=Sr(n)?ec:Hn.current,l=fl(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||c!==l)&&uS(e,s,r,l),Gs=!1;var h=e.memoizedState;s.state=h,Gf(e,r,s,i),c=e.memoizedState,a!==r||h!==c||Ir.current||Gs?(typeof u=="function"&&(mv(e,n,u,r),c=e.memoizedState),(a=Gs||lS(e,n,a,r,h,c,l))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,dk(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:hi(e.type,a),s.props=l,d=e.pendingProps,h=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=ii(c):(c=Sr(n)?ec:Hn.current,c=fl(e,c));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==c)&&uS(e,s,r,c),Gs=!1,h=e.memoizedState,s.state=h,Gf(e,r,s,i);var p=e.memoizedState;a!==d||h!==p||Ir.current||Gs?(typeof f=="function"&&(mv(e,n,f,r),p=e.memoizedState),(l=Gs||lS(e,n,l,r,h,p,c)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=c,r=l):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Iv(t,e,n,r,o,i)}function Iv(t,e,n,r,i,o){Fk(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&tS(e,n,!1),gs(t,e,o);r=e.stateNode,XO.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=gl(e,t.child,null,o),e.child=gl(e,null,a,o)):Jn(t,e,a,o),e.memoizedState=r.state,i&&tS(e,n,!0),e.child}function Bk(t){var e=t.stateNode;e.pendingContext?eS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eS(t,e.context,!1),_y(t,e.containerInfo)}function vS(t,e,n,r,i){return pl(),Ey(i),e.flags|=256,Jn(t,e,n,r),e.child}var Sv={dehydrated:null,treeContext:null,retryLane:0};function bv(t){return{baseLanes:t,cachePool:null,transitions:null}}function Uk(t,e,n){var r=e.pendingProps,i=Dt.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),St(Dt,i&1),t===null)return pv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=jp(s,r,0,null),t=$a(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=bv(n),e.memoizedState=Sv,t):Vy(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return $O(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ua(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=ua(a,o):(o=$a(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?bv(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Sv,r}return o=t.child,t=o.sibling,r=ua(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Vy(t,e){return e=jp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ih(t,e,n,r){return r!==null&&Ey(r),gl(e,t.child,null,n),t=Vy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $O(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=zg(Error(ce(422))),Ih(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=jp({mode:"visible",children:r.children},i,0,null),o=$a(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&gl(e,t.child,null,s),e.child.memoizedState=bv(s),e.memoizedState=Sv,o);if(!(e.mode&1))return Ih(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ce(419)),r=zg(o,r,void 0),Ih(t,e,s,r)}if(a=(s&t.childLanes)!==0,yr||a){if(r=In,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,ps(t,i),Oi(r,t,i,-1))}return zy(),r=zg(Error(ce(421))),Ih(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=aM.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Vr=sa(i.nextSibling),Wr=e,Ot=!0,Ai=null,t!==null&&(Yr[Qr++]=Lo,Yr[Qr++]=Fo,Yr[Qr++]=tc,Lo=t.id,Fo=t.overflow,tc=e),e=Vy(e,r.children),e.flags|=4096,e)}function yS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),gv(t.return,e,n)}function Xg(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Vk(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Jn(t,e,r.children,n),r=Dt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yS(t,n,e);else if(t.tag===19)yS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(St(Dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Wf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xg(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Wf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xg(e,!0,n,null,o);break;case"together":Xg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $h(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),rc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ce(153));if(e.child!==null){for(t=e.child,n=ua(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ua(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KO(t,e,n){switch(e.tag){case 3:Bk(e),pl();break;case 5:hk(e);break;case 1:Sr(e.type)&&Lf(e);break;case 4:_y(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;St(Uf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(St(Dt,Dt.current&1),e.flags|=128,null):n&e.child.childLanes?Uk(t,e,n):(St(Dt,Dt.current&1),t=gs(t,e,n),t!==null?t.sibling:null);St(Dt,Dt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Vk(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),St(Dt,Dt.current),r)break;return null;case 22:case 23:return e.lanes=0,Lk(t,e,n)}return gs(t,e,n)}var Gk,wv,Wk,jk;Gk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wv=function(){};Wk=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ga(vo.current);var o=null;switch(n){case"input":i=Hm(t,i),r=Hm(t,r),o=[];break;case"select":i=Ft({},i,{value:void 0}),r=Ft({},r,{value:void 0}),o=[];break;case"textarea":i=$m(t,i),r=$m(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Mf)}Jm(n,r);var s;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ed.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&a[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(ed.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&At("scroll",t),o||a===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(e.updateQueue=l)&&(e.flags|=4)}};jk=function(t,e,n,r){n!==r&&(e.flags|=4)};function ou(t,e){if(!Ot)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Un(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function JO(t,e,n){var r=e.pendingProps;switch(ky(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Un(e),null;case 1:return Sr(e.type)&&Df(),Un(e),null;case 3:return r=e.stateNode,ml(),xt(Ir),xt(Hn),My(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(yh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ai!==null&&(Nv(Ai),Ai=null))),wv(t,e),Un(e),null;case 5:Oy(e);var i=Ga(hd.current);if(n=e.type,t!==null&&e.stateNode!=null)Wk(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ce(166));return Un(e),null}if(t=Ga(vo.current),yh(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Ji]=e,r[ud]=o,t=(e.mode&1)!==0,n){case"dialog":At("cancel",r),At("close",r);break;case"iframe":case"object":case"embed":At("load",r);break;case"video":case"audio":for(i=0;i<ku.length;i++)At(ku[i],r);break;case"source":At("error",r);break;case"img":case"image":case"link":At("error",r),At("load",r);break;case"details":At("toggle",r);break;case"input":TI(r,o),At("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},At("invalid",r);break;case"textarea":xI(r,o),At("invalid",r)}Jm(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&vh(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&vh(r.textContent,a,t),i=["children",""+a]):ed.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&At("scroll",r)}switch(n){case"input":lh(r),RI(r,o,!0);break;case"textarea":lh(r),PI(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Mf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=v1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Ji]=e,t[ud]=r,Gk(t,e,!1,!1),e.stateNode=t;e:{switch(s=Ym(n,r),n){case"dialog":At("cancel",t),At("close",t),i=r;break;case"iframe":case"object":case"embed":At("load",t),i=r;break;case"video":case"audio":for(i=0;i<ku.length;i++)At(ku[i],t);i=r;break;case"source":At("error",t),i=r;break;case"img":case"image":case"link":At("error",t),At("load",t),i=r;break;case"details":At("toggle",t),i=r;break;case"input":TI(t,r),i=Hm(t,r),At("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ft({},r,{value:void 0}),At("invalid",t);break;case"textarea":xI(t,r),i=$m(t,r),At("invalid",t);break;default:i=r}Jm(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?I1(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&y1(t,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&td(t,c):typeof c=="number"&&td(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ed.hasOwnProperty(o)?c!=null&&o==="onScroll"&&At("scroll",t):c!=null&&uy(t,o,c,s))}switch(n){case"input":lh(t),RI(t,r,!1);break;case"textarea":lh(t),PI(t);break;case"option":r.value!=null&&t.setAttribute("value",""+fa(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?zc(t,!!r.multiple,o,!1):r.defaultValue!=null&&zc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Mf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Un(e),null;case 6:if(t&&e.stateNode!=null)jk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ce(166));if(n=Ga(hd.current),Ga(vo.current),yh(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ji]=e,(o=r.nodeValue!==n)&&(t=Wr,t!==null))switch(t.tag){case 3:vh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vh(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ji]=e,e.stateNode=r}return Un(e),null;case 13:if(xt(Dt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ot&&Vr!==null&&e.mode&1&&!(e.flags&128))ak(),pl(),e.flags|=98560,o=!1;else if(o=yh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ce(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ce(317));o[Ji]=e}else pl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Un(e),o=!1}else Ai!==null&&(Nv(Ai),Ai=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Dt.current&1?dn===0&&(dn=3):zy())),e.updateQueue!==null&&(e.flags|=4),Un(e),null);case 4:return ml(),wv(t,e),t===null&&cd(e.stateNode.containerInfo),Un(e),null;case 10:return xy(e.type._context),Un(e),null;case 17:return Sr(e.type)&&Df(),Un(e),null;case 19:if(xt(Dt),o=e.memoizedState,o===null)return Un(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)ou(o,!1);else{if(dn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Wf(t),s!==null){for(e.flags|=128,ou(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return St(Dt,Dt.current&1|2),e.child}t=t.sibling}o.tail!==null&&zt()>yl&&(e.flags|=128,r=!0,ou(o,!1),e.lanes=4194304)}else{if(!r)if(t=Wf(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ou(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ot)return Un(e),null}else 2*zt()-o.renderingStartTime>yl&&n!==1073741824&&(e.flags|=128,r=!0,ou(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=zt(),e.sibling=null,n=Dt.current,St(Dt,r?n&1|2:n&1),e):(Un(e),null);case 22:case 23:return Hy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Or&1073741824&&(Un(e),e.subtreeFlags&6&&(e.flags|=8192)):Un(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function YO(t,e){switch(ky(e),e.tag){case 1:return Sr(e.type)&&Df(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ml(),xt(Ir),xt(Hn),My(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Oy(e),null;case 13:if(xt(Dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));pl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xt(Dt),null;case 4:return ml(),null;case 10:return xy(e.type._context),null;case 22:case 23:return Hy(),null;case 24:return null;default:return null}}var Sh=!1,Gn=!1,QO=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function Gc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Vt(t,e,r)}else n.current=null}function Av(t,e,n){try{n()}catch(r){Vt(t,e,r)}}var CS=!1;function qO(t,e){if(av=Nf,t=$1(),wy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,c=-1,l=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(c=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++l===i&&(a=s),h===o&&++u===r&&(c=s),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(cv={focusedElem:t,selectionRange:n},Nf=!1,Ie=e;Ie!==null;)if(e=Ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ie=t;else for(;Ie!==null;){e=Ie;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,C=p.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:hi(e.type,m),C);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(k){Vt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Ie=t;break}Ie=e.return}return p=CS,CS=!1,p}function ju(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Av(e,n,o)}i=i.next}while(i!==r)}}function Gp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function kv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Zk(t){var e=t.alternate;e!==null&&(t.alternate=null,Zk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ji],delete e[ud],delete e[dv],delete e[DO],delete e[LO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Hk(t){return t.tag===5||t.tag===3||t.tag===4}function IS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Hk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ev(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Mf));else if(r!==4&&(t=t.child,t!==null))for(Ev(t,e,n),t=t.sibling;t!==null;)Ev(t,e,n),t=t.sibling}function Tv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Tv(t,e,n),t=t.sibling;t!==null;)Tv(t,e,n),t=t.sibling}var kn=null,Si=!1;function xs(t,e,n){for(n=n.child;n!==null;)zk(t,e,n),n=n.sibling}function zk(t,e,n){if(mo&&typeof mo.onCommitFiberUnmount=="function")try{mo.onCommitFiberUnmount(Op,n)}catch{}switch(n.tag){case 5:Gn||Gc(n,e);case 6:var r=kn,i=Si;kn=null,xs(t,e,n),kn=r,Si=i,kn!==null&&(Si?(t=kn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):kn.removeChild(n.stateNode));break;case 18:kn!==null&&(Si?(t=kn,n=n.stateNode,t.nodeType===8?Vg(t.parentNode,n):t.nodeType===1&&Vg(t,n),od(t)):Vg(kn,n.stateNode));break;case 4:r=kn,i=Si,kn=n.stateNode.containerInfo,Si=!0,xs(t,e,n),kn=r,Si=i;break;case 0:case 11:case 14:case 15:if(!Gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Av(n,e,s),i=i.next}while(i!==r)}xs(t,e,n);break;case 1:if(!Gn&&(Gc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Vt(n,e,a)}xs(t,e,n);break;case 21:xs(t,e,n);break;case 22:n.mode&1?(Gn=(r=Gn)||n.memoizedState!==null,xs(t,e,n),Gn=r):xs(t,e,n);break;default:xs(t,e,n)}}function SS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new QO),e.forEach(function(r){var i=cM.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ci(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:kn=a.stateNode,Si=!1;break e;case 3:kn=a.stateNode.containerInfo,Si=!0;break e;case 4:kn=a.stateNode.containerInfo,Si=!0;break e}a=a.return}if(kn===null)throw Error(ce(160));zk(o,s,i),kn=null,Si=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Vt(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Xk(e,t),e=e.sibling}function Xk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ci(e,t),ji(t),r&4){try{ju(3,t,t.return),Gp(3,t)}catch(m){Vt(t,t.return,m)}try{ju(5,t,t.return)}catch(m){Vt(t,t.return,m)}}break;case 1:ci(e,t),ji(t),r&512&&n!==null&&Gc(n,n.return);break;case 5:if(ci(e,t),ji(t),r&512&&n!==null&&Gc(n,n.return),t.flags&32){var i=t.stateNode;try{td(i,"")}catch(m){Vt(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&g1(i,o),Ym(a,s);var l=Ym(a,o);for(s=0;s<c.length;s+=2){var u=c[s],d=c[s+1];u==="style"?I1(i,d):u==="dangerouslySetInnerHTML"?y1(i,d):u==="children"?td(i,d):uy(i,u,d,l)}switch(a){case"input":zm(i,o);break;case"textarea":m1(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?zc(i,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?zc(i,!!o.multiple,o.defaultValue,!0):zc(i,!!o.multiple,o.multiple?[]:"",!1))}i[ud]=o}catch(m){Vt(t,t.return,m)}}break;case 6:if(ci(e,t),ji(t),r&4){if(t.stateNode===null)throw Error(ce(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(m){Vt(t,t.return,m)}}break;case 3:if(ci(e,t),ji(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{od(e.containerInfo)}catch(m){Vt(t,t.return,m)}break;case 4:ci(e,t),ji(t);break;case 13:ci(e,t),ji(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(jy=zt())),r&4&&SS(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Gn=(l=Gn)||u,ci(e,t),Gn=l):ci(e,t),ji(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(Ie=t,u=t.child;u!==null;){for(d=Ie=u;Ie!==null;){switch(h=Ie,f=h.child,h.tag){case 0:case 11:case 14:case 15:ju(4,h,h.return);break;case 1:Gc(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Vt(r,n,m)}}break;case 5:Gc(h,h.return);break;case 22:if(h.memoizedState!==null){wS(d);continue}}f!==null?(f.return=h,Ie=f):wS(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,c=d.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=C1("display",s))}catch(m){Vt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){Vt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ci(e,t),ji(t),r&4&&SS(t);break;case 21:break;default:ci(e,t),ji(t)}}function ji(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Hk(n)){var r=n;break e}n=n.return}throw Error(ce(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(td(i,""),r.flags&=-33);var o=IS(t);Tv(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=IS(t);Ev(t,a,s);break;default:throw Error(ce(161))}}catch(c){Vt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function eM(t,e,n){Ie=t,$k(t)}function $k(t,e,n){for(var r=(t.mode&1)!==0;Ie!==null;){var i=Ie,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Sh;if(!s){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Gn;a=Sh;var l=Gn;if(Sh=s,(Gn=c)&&!l)for(Ie=i;Ie!==null;)s=Ie,c=s.child,s.tag===22&&s.memoizedState!==null?AS(i):c!==null?(c.return=s,Ie=c):AS(i);for(;o!==null;)Ie=o,$k(o),o=o.sibling;Ie=i,Sh=a,Gn=l}bS(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ie=o):bS(t)}}function bS(t){for(;Ie!==null;){var e=Ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gn||Gp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:hi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&sS(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}sS(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&od(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Gn||e.flags&512&&kv(e)}catch(h){Vt(e,e.return,h)}}if(e===t){Ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function wS(t){for(;Ie!==null;){var e=Ie;if(e===t){Ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function AS(t){for(;Ie!==null;){var e=Ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Gp(4,e)}catch(c){Vt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Vt(e,i,c)}}var o=e.return;try{kv(e)}catch(c){Vt(e,o,c)}break;case 5:var s=e.return;try{kv(e)}catch(c){Vt(e,s,c)}}}catch(c){Vt(e,e.return,c)}if(e===t){Ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ie=a;break}Ie=e.return}}var tM=Math.ceil,Hf=Ss.ReactCurrentDispatcher,Gy=Ss.ReactCurrentOwner,ri=Ss.ReactCurrentBatchConfig,nt=0,In=null,nn=null,Pn=0,Or=0,Wc=Ia(0),dn=0,md=null,rc=0,Wp=0,Wy=0,Zu=null,gr=null,jy=0,yl=1/0,xo=null,zf=!1,Rv=null,ca=null,bh=!1,Xs=null,Xf=0,Hu=0,xv=null,Kh=-1,Jh=0;function rr(){return nt&6?zt():Kh!==-1?Kh:Kh=zt()}function la(t){return t.mode&1?nt&2&&Pn!==0?Pn&-Pn:BO.transition!==null?(Jh===0&&(Jh=_1()),Jh):(t=ut,t!==0||(t=window.event,t=t===void 0?16:U1(t.type)),t):1}function Oi(t,e,n,r){if(50<Hu)throw Hu=0,xv=null,Error(ce(185));Gd(t,n,r),(!(nt&2)||t!==In)&&(t===In&&(!(nt&2)&&(Wp|=n),dn===4&&Zs(t,Pn)),br(t,r),n===1&&nt===0&&!(e.mode&1)&&(yl=zt()+500,Bp&&Sa()))}function br(t,e){var n=t.callbackNode;B_(t,e);var r=Pf(t,t===In?Pn:0);if(r===0)n!==null&&OI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&OI(n),e===1)t.tag===0?FO(kS.bind(null,t)):ik(kS.bind(null,t)),OO(function(){!(nt&6)&&Sa()}),n=null;else{switch(O1(r)){case 1:n=gy;break;case 4:n=P1;break;case 16:n=xf;break;case 536870912:n=N1;break;default:n=xf}n=nE(n,Kk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Kk(t,e){if(Kh=-1,Jh=0,nt&6)throw Error(ce(327));var n=t.callbackNode;if(Yc()&&t.callbackNode!==n)return null;var r=Pf(t,t===In?Pn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=$f(t,r);else{e=r;var i=nt;nt|=2;var o=Yk();(In!==t||Pn!==e)&&(xo=null,yl=zt()+500,Xa(t,e));do try{iM();break}catch(a){Jk(t,a)}while(!0);Ry(),Hf.current=o,nt=i,nn!==null?e=0:(In=null,Pn=0,e=dn)}if(e!==0){if(e===2&&(i=nv(t),i!==0&&(r=i,e=Pv(t,i))),e===1)throw n=md,Xa(t,0),Zs(t,r),br(t,zt()),n;if(e===6)Zs(t,r);else{if(i=t.current.alternate,!(r&30)&&!nM(i)&&(e=$f(t,r),e===2&&(o=nv(t),o!==0&&(r=o,e=Pv(t,o))),e===1))throw n=md,Xa(t,0),Zs(t,r),br(t,zt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ce(345));case 2:Pa(t,gr,xo);break;case 3:if(Zs(t,r),(r&130023424)===r&&(e=jy+500-zt(),10<e)){if(Pf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){rr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=uv(Pa.bind(null,t,gr,xo),e);break}Pa(t,gr,xo);break;case 4:if(Zs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-_i(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=zt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*tM(r/1960))-r,10<r){t.timeoutHandle=uv(Pa.bind(null,t,gr,xo),r);break}Pa(t,gr,xo);break;case 5:Pa(t,gr,xo);break;default:throw Error(ce(329))}}}return br(t,zt()),t.callbackNode===n?Kk.bind(null,t):null}function Pv(t,e){var n=Zu;return t.current.memoizedState.isDehydrated&&(Xa(t,e).flags|=256),t=$f(t,e),t!==2&&(e=gr,gr=n,e!==null&&Nv(e)),t}function Nv(t){gr===null?gr=t:gr.push.apply(gr,t)}function nM(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Di(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zs(t,e){for(e&=~Wy,e&=~Wp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_i(e),r=1<<n;t[n]=-1,e&=~r}}function kS(t){if(nt&6)throw Error(ce(327));Yc();var e=Pf(t,0);if(!(e&1))return br(t,zt()),null;var n=$f(t,e);if(t.tag!==0&&n===2){var r=nv(t);r!==0&&(e=r,n=Pv(t,r))}if(n===1)throw n=md,Xa(t,0),Zs(t,e),br(t,zt()),n;if(n===6)throw Error(ce(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Pa(t,gr,xo),br(t,zt()),null}function Zy(t,e){var n=nt;nt|=1;try{return t(e)}finally{nt=n,nt===0&&(yl=zt()+500,Bp&&Sa())}}function ic(t){Xs!==null&&Xs.tag===0&&!(nt&6)&&Yc();var e=nt;nt|=1;var n=ri.transition,r=ut;try{if(ri.transition=null,ut=1,t)return t()}finally{ut=r,ri.transition=n,nt=e,!(nt&6)&&Sa()}}function Hy(){Or=Wc.current,xt(Wc)}function Xa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_O(n)),nn!==null)for(n=nn.return;n!==null;){var r=n;switch(ky(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Df();break;case 3:ml(),xt(Ir),xt(Hn),My();break;case 5:Oy(r);break;case 4:ml();break;case 13:xt(Dt);break;case 19:xt(Dt);break;case 10:xy(r.type._context);break;case 22:case 23:Hy()}n=n.return}if(In=t,nn=t=ua(t.current,null),Pn=Or=e,dn=0,md=null,Wy=Wp=rc=0,gr=Zu=null,Va!==null){for(e=0;e<Va.length;e++)if(n=Va[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Va=null}return t}function Jk(t,e){do{var n=nn;try{if(Ry(),zh.current=Zf,jf){for(var r=Lt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}jf=!1}if(nc=0,yn=un=Lt=null,Wu=!1,fd=0,Gy.current=null,n===null||n.return===null){dn=1,md=e,nn=null;break}e:{var o=t,s=n.return,a=n,c=e;if(e=Pn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=hS(s);if(f!==null){f.flags&=-257,fS(f,s,a,o,e),f.mode&1&&dS(o,l,e),e=f,c=l;var p=e.updateQueue;if(p===null){var m=new Set;m.add(c),e.updateQueue=m}else p.add(c);break e}else{if(!(e&1)){dS(o,l,e),zy();break e}c=Error(ce(426))}}else if(Ot&&a.mode&1){var C=hS(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),fS(C,s,a,o,e),Ey(vl(c,a));break e}}o=c=vl(c,a),dn!==4&&(dn=2),Zu===null?Zu=[o]:Zu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=Ok(o,c,e);oS(o,g);break e;case 1:a=c;var v=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ca===null||!ca.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var k=Mk(o,a,e);oS(o,k);break e}}o=o.return}while(o!==null)}qk(n)}catch(w){e=w,nn===n&&n!==null&&(nn=n=n.return);continue}break}while(!0)}function Yk(){var t=Hf.current;return Hf.current=Zf,t===null?Zf:t}function zy(){(dn===0||dn===3||dn===2)&&(dn=4),In===null||!(rc&268435455)&&!(Wp&268435455)||Zs(In,Pn)}function $f(t,e){var n=nt;nt|=2;var r=Yk();(In!==t||Pn!==e)&&(xo=null,Xa(t,e));do try{rM();break}catch(i){Jk(t,i)}while(!0);if(Ry(),nt=n,Hf.current=r,nn!==null)throw Error(ce(261));return In=null,Pn=0,dn}function rM(){for(;nn!==null;)Qk(nn)}function iM(){for(;nn!==null&&!x_();)Qk(nn)}function Qk(t){var e=tE(t.alternate,t,Or);t.memoizedProps=t.pendingProps,e===null?qk(t):nn=e,Gy.current=null}function qk(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=YO(n,e),n!==null){n.flags&=32767,nn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{dn=6,nn=null;return}}else if(n=JO(n,e,Or),n!==null){nn=n;return}if(e=e.sibling,e!==null){nn=e;return}nn=e=t}while(e!==null);dn===0&&(dn=5)}function Pa(t,e,n){var r=ut,i=ri.transition;try{ri.transition=null,ut=1,oM(t,e,n,r)}finally{ri.transition=i,ut=r}return null}function oM(t,e,n,r){do Yc();while(Xs!==null);if(nt&6)throw Error(ce(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ce(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(U_(t,o),t===In&&(nn=In=null,Pn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||bh||(bh=!0,nE(xf,function(){return Yc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ri.transition,ri.transition=null;var s=ut;ut=1;var a=nt;nt|=4,Gy.current=null,qO(t,n),Xk(n,t),kO(cv),Nf=!!av,cv=av=null,t.current=n,eM(n),P_(),nt=a,ut=s,ri.transition=o}else t.current=n;if(bh&&(bh=!1,Xs=t,Xf=i),o=t.pendingLanes,o===0&&(ca=null),O_(n.stateNode),br(t,zt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(zf)throw zf=!1,t=Rv,Rv=null,t;return Xf&1&&t.tag!==0&&Yc(),o=t.pendingLanes,o&1?t===xv?Hu++:(Hu=0,xv=t):Hu=0,Sa(),null}function Yc(){if(Xs!==null){var t=O1(Xf),e=ri.transition,n=ut;try{if(ri.transition=null,ut=16>t?16:t,Xs===null)var r=!1;else{if(t=Xs,Xs=null,Xf=0,nt&6)throw Error(ce(331));var i=nt;for(nt|=4,Ie=t.current;Ie!==null;){var o=Ie,s=o.child;if(Ie.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(Ie=l;Ie!==null;){var u=Ie;switch(u.tag){case 0:case 11:case 15:ju(8,u,o)}var d=u.child;if(d!==null)d.return=u,Ie=d;else for(;Ie!==null;){u=Ie;var h=u.sibling,f=u.return;if(Zk(u),u===l){Ie=null;break}if(h!==null){h.return=f,Ie=h;break}Ie=f}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var C=m.sibling;m.sibling=null,m=C}while(m!==null)}}Ie=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Ie=s;else e:for(;Ie!==null;){if(o=Ie,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ju(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,Ie=g;break e}Ie=o.return}}var v=t.current;for(Ie=v;Ie!==null;){s=Ie;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,Ie=S;else e:for(s=v;Ie!==null;){if(a=Ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Gp(9,a)}}catch(w){Vt(a,a.return,w)}if(a===s){Ie=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,Ie=k;break e}Ie=a.return}}if(nt=i,Sa(),mo&&typeof mo.onPostCommitFiberRoot=="function")try{mo.onPostCommitFiberRoot(Op,t)}catch{}r=!0}return r}finally{ut=n,ri.transition=e}}return!1}function ES(t,e,n){e=vl(n,e),e=Ok(t,e,1),t=aa(t,e,1),e=rr(),t!==null&&(Gd(t,1,e),br(t,e))}function Vt(t,e,n){if(t.tag===3)ES(t,t,n);else for(;e!==null;){if(e.tag===3){ES(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ca===null||!ca.has(r))){t=vl(n,t),t=Mk(e,t,1),e=aa(e,t,1),t=rr(),e!==null&&(Gd(e,1,t),br(e,t));break}}e=e.return}}function sM(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=rr(),t.pingedLanes|=t.suspendedLanes&n,In===t&&(Pn&n)===n&&(dn===4||dn===3&&(Pn&130023424)===Pn&&500>zt()-jy?Xa(t,0):Wy|=n),br(t,e)}function eE(t,e){e===0&&(t.mode&1?(e=hh,hh<<=1,!(hh&130023424)&&(hh=4194304)):e=1);var n=rr();t=ps(t,e),t!==null&&(Gd(t,e,n),br(t,n))}function aM(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),eE(t,n)}function cM(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ce(314))}r!==null&&r.delete(e),eE(t,n)}var tE;tE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ir.current)yr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yr=!1,KO(t,e,n);yr=!!(t.flags&131072)}else yr=!1,Ot&&e.flags&1048576&&ok(e,Bf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$h(t,e),t=e.pendingProps;var i=fl(e,Hn.current);Jc(e,n),i=Ly(null,e,r,t,i,n);var o=Fy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Sr(r)?(o=!0,Lf(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ny(e),i.updater=Vp,e.stateNode=i,i._reactInternals=e,vv(e,r,t,n),e=Iv(null,e,r,!0,o,n)):(e.tag=0,Ot&&o&&Ay(e),Jn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch($h(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=uM(r),t=hi(r,t),i){case 0:e=Cv(null,e,r,t,n);break e;case 1:e=mS(null,e,r,t,n);break e;case 11:e=pS(null,e,r,t,n);break e;case 14:e=gS(null,e,r,hi(r.type,t),n);break e}throw Error(ce(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hi(r,i),Cv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hi(r,i),mS(t,e,r,i,n);case 3:e:{if(Bk(e),t===null)throw Error(ce(387));r=e.pendingProps,o=e.memoizedState,i=o.element,dk(t,e),Gf(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=vl(Error(ce(423)),e),e=vS(t,e,r,n,i);break e}else if(r!==i){i=vl(Error(ce(424)),e),e=vS(t,e,r,n,i);break e}else for(Vr=sa(e.stateNode.containerInfo.firstChild),Wr=e,Ot=!0,Ai=null,n=lk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(pl(),r===i){e=gs(t,e,n);break e}Jn(t,e,r,n)}e=e.child}return e;case 5:return hk(e),t===null&&pv(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,lv(r,i)?s=null:o!==null&&lv(r,o)&&(e.flags|=32),Fk(t,e),Jn(t,e,s,n),e.child;case 6:return t===null&&pv(e),null;case 13:return Uk(t,e,n);case 4:return _y(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=gl(e,null,r,n):Jn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hi(r,i),pS(t,e,r,i,n);case 7:return Jn(t,e,e.pendingProps,n),e.child;case 8:return Jn(t,e,e.pendingProps.children,n),e.child;case 12:return Jn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,St(Uf,r._currentValue),r._currentValue=s,o!==null)if(Di(o.value,s)){if(o.children===i.children&&!Ir.current){e=gs(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=cs(-1,n&-n),c.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),gv(o.return,n,e),a.lanes|=n;break}c=c.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ce(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),gv(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Jn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Jc(e,n),i=ii(i),r=r(i),e.flags|=1,Jn(t,e,r,n),e.child;case 14:return r=e.type,i=hi(r,e.pendingProps),i=hi(r.type,i),gS(t,e,r,i,n);case 15:return Dk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hi(r,i),$h(t,e),e.tag=1,Sr(r)?(t=!0,Lf(e)):t=!1,Jc(e,n),_k(e,r,i),vv(e,r,i,n),Iv(null,e,r,!0,t,n);case 19:return Vk(t,e,n);case 22:return Lk(t,e,n)}throw Error(ce(156,e.tag))};function nE(t,e){return x1(t,e)}function lM(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(t,e,n,r){return new lM(t,e,n,r)}function Xy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uM(t){if(typeof t=="function")return Xy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hy)return 11;if(t===fy)return 14}return 2}function ua(t,e){var n=t.alternate;return n===null?(n=ei(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Yh(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")Xy(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case _c:return $a(n.children,i,o,e);case dy:s=8,i|=8;break;case Gm:return t=ei(12,n,e,i|2),t.elementType=Gm,t.lanes=o,t;case Wm:return t=ei(13,n,e,i),t.elementType=Wm,t.lanes=o,t;case jm:return t=ei(19,n,e,i),t.elementType=jm,t.lanes=o,t;case h1:return jp(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case u1:s=10;break e;case d1:s=9;break e;case hy:s=11;break e;case fy:s=14;break e;case Vs:s=16,r=null;break e}throw Error(ce(130,t==null?t:typeof t,""))}return e=ei(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function $a(t,e,n,r){return t=ei(7,t,r,e),t.lanes=n,t}function jp(t,e,n,r){return t=ei(22,t,r,e),t.elementType=h1,t.lanes=n,t.stateNode={isHidden:!1},t}function $g(t,e,n){return t=ei(6,t,null,e),t.lanes=n,t}function Kg(t,e,n){return e=ei(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function dM(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xg(0),this.expirationTimes=xg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $y(t,e,n,r,i,o,s,a,c){return t=new dM(t,e,n,a,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ei(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ny(o),t}function hM(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function rE(t){if(!t)return pa;t=t._reactInternals;e:{if(gc(t)!==t||t.tag!==1)throw Error(ce(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Sr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(t.tag===1){var n=t.type;if(Sr(n))return rk(t,n,e)}return e}function iE(t,e,n,r,i,o,s,a,c){return t=$y(n,r,!0,t,i,o,s,a,c),t.context=rE(null),n=t.current,r=rr(),i=la(n),o=cs(r,i),o.callback=e??null,aa(n,o,i),t.current.lanes=i,Gd(t,i,r),br(t,r),t}function Zp(t,e,n,r){var i=e.current,o=rr(),s=la(i);return n=rE(n),e.context===null?e.context=n:e.pendingContext=n,e=cs(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=aa(i,e,s),t!==null&&(Oi(t,i,s,o),Hh(t,i,s)),s}function Kf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function TS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ky(t,e){TS(t,e),(t=t.alternate)&&TS(t,e)}function fM(){return null}var oE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jy(t){this._internalRoot=t}Hp.prototype.render=Jy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ce(409));Zp(t,e,null,null)};Hp.prototype.unmount=Jy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ic(function(){Zp(null,t,null,null)}),e[fs]=null}};function Hp(t){this._internalRoot=t}Hp.prototype.unstable_scheduleHydration=function(t){if(t){var e=L1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<js.length&&e!==0&&e<js[n].priority;n++);js.splice(n,0,t),n===0&&B1(t)}};function Yy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function zp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function RS(){}function pM(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=Kf(s);o.call(l)}}var s=iE(e,r,t,0,null,!1,!1,"",RS);return t._reactRootContainer=s,t[fs]=s.current,cd(t.nodeType===8?t.parentNode:t),ic(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=Kf(c);a.call(l)}}var c=$y(t,0,!1,null,null,!1,!1,"",RS);return t._reactRootContainer=c,t[fs]=c.current,cd(t.nodeType===8?t.parentNode:t),ic(function(){Zp(e,c,n,r)}),c}function Xp(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var c=Kf(s);a.call(c)}}Zp(e,s,t,i)}else s=pM(n,e,t,i,r);return Kf(s)}M1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Au(e.pendingLanes);n!==0&&(my(e,n|1),br(e,zt()),!(nt&6)&&(yl=zt()+500,Sa()))}break;case 13:ic(function(){var r=ps(t,1);if(r!==null){var i=rr();Oi(r,t,1,i)}}),Ky(t,1)}};vy=function(t){if(t.tag===13){var e=ps(t,134217728);if(e!==null){var n=rr();Oi(e,t,134217728,n)}Ky(t,134217728)}};D1=function(t){if(t.tag===13){var e=la(t),n=ps(t,e);if(n!==null){var r=rr();Oi(n,t,e,r)}Ky(t,e)}};L1=function(){return ut};F1=function(t,e){var n=ut;try{return ut=t,e()}finally{ut=n}};qm=function(t,e,n){switch(e){case"input":if(zm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Fp(r);if(!i)throw Error(ce(90));p1(r),zm(r,i)}}}break;case"textarea":m1(t,n);break;case"select":e=n.value,e!=null&&zc(t,!!n.multiple,e,!1)}};w1=Zy;A1=ic;var gM={usingClientEntryPoint:!1,Events:[jd,Lc,Fp,S1,b1,Zy]},su={findFiberByHostInstance:Ua,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mM={bundleType:su.bundleType,version:su.version,rendererPackageName:su.rendererPackageName,rendererConfig:su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=T1(t),t===null?null:t.stateNode},findFiberByHostInstance:su.findFiberByHostInstance||fM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wh.isDisabled&&wh.supportsFiber)try{Op=wh.inject(mM),mo=wh}catch{}}Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gM;Xr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yy(e))throw Error(ce(200));return hM(t,e,null,n)};Xr.createRoot=function(t,e){if(!Yy(t))throw Error(ce(299));var n=!1,r="",i=oE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=$y(t,1,!1,null,null,n,!1,r,i),t[fs]=e.current,cd(t.nodeType===8?t.parentNode:t),new Jy(e)};Xr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ce(188)):(t=Object.keys(t).join(","),Error(ce(268,t)));return t=T1(e),t=t===null?null:t.stateNode,t};Xr.flushSync=function(t){return ic(t)};Xr.hydrate=function(t,e,n){if(!zp(e))throw Error(ce(200));return Xp(null,t,e,!0,n)};Xr.hydrateRoot=function(t,e,n){if(!Yy(t))throw Error(ce(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=oE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=iE(e,null,t,1,n??null,i,!1,o,s),t[fs]=e.current,cd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Hp(e)};Xr.render=function(t,e,n){if(!zp(e))throw Error(ce(200));return Xp(null,t,e,!1,n)};Xr.unmountComponentAtNode=function(t){if(!zp(t))throw Error(ce(40));return t._reactRootContainer?(ic(function(){Xp(null,null,t,!1,function(){t._reactRootContainer=null,t[fs]=null})}),!0):!1};Xr.unstable_batchedUpdates=Zy;Xr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!zp(n))throw Error(ce(200));if(t==null||t._reactInternals===void 0)throw Error(ce(38));return Xp(t,e,n,!1,r)};Xr.version="18.3.1-next-f1338f8080-20240426";function sE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sE)}catch(t){console.error(t)}}sE(),s1.exports=Xr;var Qy=s1.exports;const vM=Ud(Qy),yM=$A({__proto__:null,default:vM},[Qy]);var xS=Qy;Um.createRoot=xS.createRoot,Um.hydrateRoot=xS.hydrateRoot;/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nt(){return Nt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Nt.apply(this,arguments)}var tn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(tn||(tn={}));const PS="popstate";function CM(t){t===void 0&&(t={});function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return vd("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Hd(i)}return SM(e,n,null,t)}function tt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Cl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IM(){return Math.random().toString(36).substr(2,8)}function NS(t,e){return{usr:t.state,key:t.key,idx:e}}function vd(t,e,n,r){return n===void 0&&(n=null),Nt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ba(e):e,{state:n,key:e&&e.key||r||IM()})}function Hd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ba(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function SM(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=tn.Pop,c=null,l=u();l==null&&(l=0,s.replaceState(Nt({},s.state,{idx:l}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=tn.Pop;let C=u(),g=C==null?null:C-l;l=C,c&&c({action:a,location:m.location,delta:g})}function h(C,g){a=tn.Push;let v=vd(m.location,C,g);l=u()+1;let S=NS(v,l),k=m.createHref(v);try{s.pushState(S,"",k)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;i.location.assign(k)}o&&c&&c({action:a,location:m.location,delta:1})}function f(C,g){a=tn.Replace;let v=vd(m.location,C,g);l=u();let S=NS(v,l),k=m.createHref(v);s.replaceState(S,"",k),o&&c&&c({action:a,location:m.location,delta:0})}function p(C){let g=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof C=="string"?C:Hd(C);return v=v.replace(/ $/,"%20"),tt(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let m={get action(){return a},get location(){return t(i,s)},listen(C){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(PS,d),c=C,()=>{i.removeEventListener(PS,d),c=null}},createHref(C){return e(i,C)},createURL:p,encodeLocation(C){let g=p(C);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:f,go(C){return s.go(C)}};return m}var ht;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ht||(ht={}));const bM=new Set(["lazy","caseSensitive","path","id","index","children"]);function wM(t){return t.index===!0}function Jf(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,o)=>{let s=[...n,String(o)],a=typeof i.id=="string"?i.id:s.join("-");if(tt(i.index!==!0||!i.children,"Cannot specify children on an index route"),tt(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),wM(i)){let c=Nt({},i,e(i),{id:a});return r[a]=c,c}else{let c=Nt({},i,e(i),{id:a,children:void 0});return r[a]=c,i.children&&(c.children=Jf(i.children,e,s,r)),c}})}function _a(t,e,n){return n===void 0&&(n="/"),Qh(t,e,n,!1)}function Qh(t,e,n,r){let i=typeof e=="string"?ba(e):e,o=zd(i.pathname||"/",n);if(o==null)return null;let s=aE(t);kM(s);let a=null;for(let c=0;a==null&&c<s.length;++c){let l=LM(o);a=MM(s[c],l,r)}return a}function AM(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function aE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let c={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};c.relativePath.startsWith("/")&&(tt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=Ka([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(tt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),aE(o.children,e,u,l)),!(o.path==null&&!o.index)&&e.push({path:l,score:_M(l,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let c of cE(o.path))i(o,s,c)}),e}function cE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=cE(r.join("/")),a=[];return a.push(...s.map(c=>c===""?o:[o,c].join("/"))),i&&a.push(...s),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function kM(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:OM(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const EM=/^:[\w-]+$/,TM=3,RM=2,xM=1,PM=10,NM=-2,_S=t=>t==="*";function _M(t,e){let n=t.split("/"),r=n.length;return n.some(_S)&&(r+=NM),e&&(r+=RM),n.filter(i=>!_S(i)).reduce((i,o)=>i+(EM.test(o)?TM:o===""?xM:PM),r)}function OM(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function MM(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let c=r[a],l=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=OS({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),h=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=OS({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:Ka([o,d.pathname]),pathnameBase:GM(Ka([o,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(o=Ka([o,d.pathnameBase]))}return s}function OS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=DM(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let m=a[d]||"";s=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return f&&!p?l[h]=void 0:l[h]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:o,pathnameBase:s,pattern:t}}function DM(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Cl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function LM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Cl(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function zd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function FM(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?ba(t):t;return{pathname:n?n.startsWith("/")?n:BM(n,e):e,search:WM(r),hash:jM(i)}}function BM(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Jg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function lE(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function UM(t,e){let n=lE(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function VM(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=ba(t):(i=Nt({},t),tt(!i.pathname||!i.pathname.includes("?"),Jg("?","pathname","search",i)),tt(!i.pathname||!i.pathname.includes("#"),Jg("#","pathname","hash",i)),tt(!i.search||!i.search.includes("#"),Jg("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?e[d]:"/"}let c=FM(i,a),l=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Ka=t=>t.join("/").replace(/\/\/+/g,"/"),GM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),WM=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,jM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Yf{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function $p(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const uE=["post","put","patch","delete"],ZM=new Set(uE),HM=["get",...uE],zM=new Set(HM),XM=new Set([301,302,303,307,308]),$M=new Set([307,308]),Yg={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},KM={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},au={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},qy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,JM=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),dE="remix-router-transitions";function YM(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;tt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let D=t.detectErrorBoundary;i=B=>({hasErrorBoundary:D(B)})}else i=JM;let o={},s=Jf(t.routes,i,void 0,o),a,c=t.basename||"/",l=t.dataStrategy||tD,u=t.patchRoutesOnNavigation,d=Nt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),h=null,f=new Set,p=null,m=null,C=null,g=t.hydrationData!=null,v=_a(s,t.history.location,c),S=null;if(v==null&&!u){let D=dr(404,{pathname:t.history.location.pathname}),{matches:B,route:H}=ZS(s);v=B,S={[H.id]:D}}v&&!t.hydrationData&&Rs(v,s,t.history.location.pathname).active&&(v=null);let k;if(v)if(v.some(D=>D.route.lazy))k=!1;else if(!v.some(D=>D.route.loader))k=!0;else if(d.v7_partialHydration){let D=t.hydrationData?t.hydrationData.loaderData:null,B=t.hydrationData?t.hydrationData.errors:null;if(B){let H=v.findIndex(q=>B[q.route.id]!==void 0);k=v.slice(0,H+1).every(q=>!Ov(q.route,D,B))}else k=v.every(H=>!Ov(H.route,D,B))}else k=t.hydrationData!=null;else if(k=!1,v=[],d.v7_partialHydration){let D=Rs(null,s,t.history.location.pathname);D.active&&D.matches&&(v=D.matches)}let w,A={historyAction:t.history.action,location:t.history.location,matches:v,initialized:k,navigation:Yg,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||S,fetchers:new Map,blockers:new Map},x=tn.Pop,T=!1,_,O=!1,L=new Map,U=null,z=!1,Z=!1,J=[],ee=new Set,re=new Map,X=0,$=-1,ie=new Map,j=new Set,oe=new Map,ke=new Map,Le=new Set,de=new Map,Pe=new Map,Ye;function ve(){if(h=t.history.listen(D=>{let{action:B,location:H,delta:q}=D;if(Ye){Ye(),Ye=void 0;return}Cl(Pe.size===0||q!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let me=Ts({currentLocation:A.location,nextLocation:H,historyAction:B});if(me&&q!=null){let Re=new Promise(De=>{Ye=De});t.history.go(q*-1),Qe(me,{state:"blocked",location:H,proceed(){Qe(me,{state:"proceeding",proceed:void 0,reset:void 0,location:H}),Re.then(()=>t.history.go(q))},reset(){let De=new Map(A.blockers);De.set(me,au),st({blockers:De})}});return}return ue(B,H)}),n){gD(e,L);let D=()=>mD(e,L);e.addEventListener("pagehide",D),U=()=>e.removeEventListener("pagehide",D)}return A.initialized||ue(tn.Pop,A.location,{initialHydration:!0}),w}function rn(){h&&h(),U&&U(),f.clear(),_&&_.abort(),A.fetchers.forEach((D,B)=>P(B)),A.blockers.forEach((D,B)=>at(B))}function Sn(D){return f.add(D),()=>f.delete(D)}function st(D,B){B===void 0&&(B={}),A=Nt({},A,D);let H=[],q=[];d.v7_fetcherPersist&&A.fetchers.forEach((me,Re)=>{me.state==="idle"&&(Le.has(Re)?q.push(Re):H.push(Re))}),[...f].forEach(me=>me(A,{deletedFetchers:q,viewTransitionOpts:B.viewTransitionOpts,flushSync:B.flushSync===!0})),d.v7_fetcherPersist&&(H.forEach(me=>A.fetchers.delete(me)),q.forEach(me=>P(me)))}function vt(D,B,H){var q,me;let{flushSync:Re}=H===void 0?{}:H,De=A.actionData!=null&&A.navigation.formMethod!=null&&bi(A.navigation.formMethod)&&A.navigation.state==="loading"&&((q=D.state)==null?void 0:q._isRedirect)!==!0,ye;B.actionData?Object.keys(B.actionData).length>0?ye=B.actionData:ye=null:De?ye=A.actionData:ye=null;let we=B.loaderData?WS(A.loaderData,B.loaderData,B.matches||[],B.errors):A.loaderData,fe=A.blockers;fe.size>0&&(fe=new Map(fe),fe.forEach((Xe,Jt)=>fe.set(Jt,au)));let xe=T===!0||A.navigation.formMethod!=null&&bi(A.navigation.formMethod)&&((me=D.state)==null?void 0:me._isRedirect)!==!0;a&&(s=a,a=void 0),z||x===tn.Pop||(x===tn.Push?t.history.push(D,D.state):x===tn.Replace&&t.history.replace(D,D.state));let We;if(x===tn.Pop){let Xe=L.get(A.location.pathname);Xe&&Xe.has(D.pathname)?We={currentLocation:A.location,nextLocation:D}:L.has(D.pathname)&&(We={currentLocation:D,nextLocation:A.location})}else if(O){let Xe=L.get(A.location.pathname);Xe?Xe.add(D.pathname):(Xe=new Set([D.pathname]),L.set(A.location.pathname,Xe)),We={currentLocation:A.location,nextLocation:D}}st(Nt({},B,{actionData:ye,loaderData:we,historyAction:x,location:D,initialized:!0,navigation:Yg,revalidation:"idle",restoreScrollPosition:Yl(D,B.matches||A.matches),preventScrollReset:xe,blockers:fe}),{viewTransitionOpts:We,flushSync:Re===!0}),x=tn.Pop,T=!1,O=!1,z=!1,Z=!1,J=[]}async function bn(D,B){if(typeof D=="number"){t.history.go(D);return}let H=_v(A.location,A.matches,c,d.v7_prependBasename,D,d.v7_relativeSplatPath,B==null?void 0:B.fromRouteId,B==null?void 0:B.relative),{path:q,submission:me,error:Re}=MS(d.v7_normalizeFormMethod,!1,H,B),De=A.location,ye=vd(A.location,q,B&&B.state);ye=Nt({},ye,t.history.encodeLocation(ye));let we=B&&B.replace!=null?B.replace:void 0,fe=tn.Push;we===!0?fe=tn.Replace:we===!1||me!=null&&bi(me.formMethod)&&me.formAction===A.location.pathname+A.location.search&&(fe=tn.Replace);let xe=B&&"preventScrollReset"in B?B.preventScrollReset===!0:void 0,We=(B&&B.flushSync)===!0,Xe=Ts({currentLocation:De,nextLocation:ye,historyAction:fe});if(Xe){Qe(Xe,{state:"blocked",location:ye,proceed(){Qe(Xe,{state:"proceeding",proceed:void 0,reset:void 0,location:ye}),bn(D,B)},reset(){let Jt=new Map(A.blockers);Jt.set(Xe,au),st({blockers:Jt})}});return}return await ue(fe,ye,{submission:me,pendingError:Re,preventScrollReset:xe,replace:B&&B.replace,enableViewTransition:B&&B.viewTransition,flushSync:We})}function on(){if(ur(),st({revalidation:"loading"}),A.navigation.state!=="submitting"){if(A.navigation.state==="idle"){ue(A.historyAction,A.location,{startUninterruptedRevalidation:!0});return}ue(x||A.historyAction,A.navigation.location,{overrideNavigation:A.navigation,enableViewTransition:O===!0})}}async function ue(D,B,H){_&&_.abort(),_=null,x=D,z=(H&&H.startUninterruptedRevalidation)===!0,Sg(A.location,A.matches),T=(H&&H.preventScrollReset)===!0,O=(H&&H.enableViewTransition)===!0;let q=a||s,me=H&&H.overrideNavigation,Re=_a(q,B,c),De=(H&&H.flushSync)===!0,ye=Rs(Re,q,B.pathname);if(ye.active&&ye.matches&&(Re=ye.matches),!Re){let{error:dt,notFoundMatches:le,route:M}=Kl(B.pathname);vt(B,{matches:le,loaderData:{},errors:{[M.id]:dt}},{flushSync:De});return}if(A.initialized&&!Z&&aD(A.location,B)&&!(H&&H.submission&&bi(H.submission.formMethod))){vt(B,{matches:Re},{flushSync:De});return}_=new AbortController;let we=Ac(t.history,B,_.signal,H&&H.submission),fe;if(H&&H.pendingError)fe=[Oa(Re).route.id,{type:ht.error,error:H.pendingError}];else if(H&&H.submission&&bi(H.submission.formMethod)){let dt=await be(we,B,H.submission,Re,ye.active,{replace:H.replace,flushSync:De});if(dt.shortCircuited)return;if(dt.pendingActionResult){let[le,M]=dt.pendingActionResult;if(Br(M)&&$p(M.error)&&M.error.status===404){_=null,vt(B,{matches:dt.matches,loaderData:{},errors:{[le]:M.error}});return}}Re=dt.matches||Re,fe=dt.pendingActionResult,me=Qg(B,H.submission),De=!1,ye.active=!1,we=Ac(t.history,we.url,we.signal)}let{shortCircuited:xe,matches:We,loaderData:Xe,errors:Jt}=await Ge(we,B,Re,ye.active,me,H&&H.submission,H&&H.fetcherSubmission,H&&H.replace,H&&H.initialHydration===!0,De,fe);xe||(_=null,vt(B,Nt({matches:We||Re},jS(fe),{loaderData:Xe,errors:Jt})))}async function be(D,B,H,q,me,Re){Re===void 0&&(Re={}),ur();let De=fD(B,H);if(st({navigation:De},{flushSync:Re.flushSync===!0}),me){let fe=await Ta(q,B.pathname,D.signal);if(fe.type==="aborted")return{shortCircuited:!0};if(fe.type==="error"){let xe=Oa(fe.partialMatches).route.id;return{matches:fe.partialMatches,pendingActionResult:[xe,{type:ht.error,error:fe.error}]}}else if(fe.matches)q=fe.matches;else{let{notFoundMatches:xe,error:We,route:Xe}=Kl(B.pathname);return{matches:xe,pendingActionResult:[Xe.id,{type:ht.error,error:We}]}}}let ye,we=Eu(q,B);if(!we.route.action&&!we.route.lazy)ye={type:ht.error,error:dr(405,{method:D.method,pathname:B.pathname,routeId:we.route.id})};else if(ye=(await wn("action",A,D,[we],q,null))[we.route.id],D.signal.aborted)return{shortCircuited:!0};if(Wa(ye)){let fe;return Re&&Re.replace!=null?fe=Re.replace:fe=US(ye.response.headers.get("Location"),new URL(D.url),c)===A.location.pathname+A.location.search,await Wt(D,ye,!0,{submission:H,replace:fe}),{shortCircuited:!0}}if($s(ye))throw dr(400,{type:"defer-action"});if(Br(ye)){let fe=Oa(q,we.route.id);return(Re&&Re.replace)!==!0&&(x=tn.Push),{matches:q,pendingActionResult:[fe.route.id,ye]}}return{matches:q,pendingActionResult:[we.route.id,ye]}}async function Ge(D,B,H,q,me,Re,De,ye,we,fe,xe){let We=me||Qg(B,Re),Xe=Re||De||zS(We),Jt=!z&&(!d.v7_partialHydration||!we);if(q){if(Jt){let wt=Ve(xe);st(Nt({navigation:We},wt!==void 0?{actionData:wt}:{}),{flushSync:fe})}let Je=await Ta(H,B.pathname,D.signal);if(Je.type==="aborted")return{shortCircuited:!0};if(Je.type==="error"){let wt=Oa(Je.partialMatches).route.id;return{matches:Je.partialMatches,loaderData:{},errors:{[wt]:Je.error}}}else if(Je.matches)H=Je.matches;else{let{error:wt,notFoundMatches:Sc,route:Ql}=Kl(B.pathname);return{matches:Sc,loaderData:{},errors:{[Ql.id]:wt}}}}let dt=a||s,[le,M]=LS(t.history,A,H,Xe,B,d.v7_partialHydration&&we===!0,d.v7_skipActionErrorRevalidation,Z,J,ee,Le,oe,j,dt,c,xe);if(Jl(Je=>!(H&&H.some(wt=>wt.route.id===Je))||le&&le.some(wt=>wt.route.id===Je)),$=++X,le.length===0&&M.length===0){let Je=_e();return vt(B,Nt({matches:H,loaderData:{},errors:xe&&Br(xe[1])?{[xe[0]]:xe[1].error}:null},jS(xe),Je?{fetchers:new Map(A.fetchers)}:{}),{flushSync:fe}),{shortCircuited:!0}}if(Jt){let Je={};if(!q){Je.navigation=We;let wt=Ve(xe);wt!==void 0&&(Je.actionData=wt)}M.length>0&&(Je.fetchers=Me(M)),st(Je,{flushSync:fe})}M.forEach(Je=>{W(Je.key),Je.controller&&re.set(Je.key,Je.controller)});let ae=()=>M.forEach(Je=>W(Je.key));_&&_.signal.addEventListener("abort",ae);let{loaderResults:Ce,fetcherResults:$e}=await $t(A,H,le,M,D);if(D.signal.aborted)return{shortCircuited:!0};_&&_.signal.removeEventListener("abort",ae),M.forEach(Je=>re.delete(Je.key));let gt=Ah(Ce);if(gt)return await Wt(D,gt.result,!0,{replace:ye}),{shortCircuited:!0};if(gt=Ah($e),gt)return j.add(gt.key),await Wt(D,gt.result,!0,{replace:ye}),{shortCircuited:!0};let{loaderData:jt,errors:Yt}=GS(A,H,Ce,xe,M,$e,de);de.forEach((Je,wt)=>{Je.subscribe(Sc=>{(Sc||Je.done)&&de.delete(wt)})}),d.v7_partialHydration&&we&&A.errors&&(Yt=Nt({},A.errors,Yt));let gn=_e(),Wi=rt($),Qt=gn||Wi||M.length>0;return Nt({matches:H,loaderData:jt,errors:Yt},Qt?{fetchers:new Map(A.fetchers)}:{})}function Ve(D){if(D&&!Br(D[1]))return{[D[0]]:D[1].data};if(A.actionData)return Object.keys(A.actionData).length===0?null:A.actionData}function Me(D){return D.forEach(B=>{let H=A.fetchers.get(B.key),q=cu(void 0,H?H.data:void 0);A.fetchers.set(B.key,q)}),new Map(A.fetchers)}function qe(D,B,H,q){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");W(D);let me=(q&&q.flushSync)===!0,Re=a||s,De=_v(A.location,A.matches,c,d.v7_prependBasename,H,d.v7_relativeSplatPath,B,q==null?void 0:q.relative),ye=_a(Re,De,c),we=Rs(ye,Re,De);if(we.active&&we.matches&&(ye=we.matches),!ye){y(D,B,dr(404,{pathname:De}),{flushSync:me});return}let{path:fe,submission:xe,error:We}=MS(d.v7_normalizeFormMethod,!0,De,q);if(We){y(D,B,We,{flushSync:me});return}let Xe=Eu(ye,fe),Jt=(q&&q.preventScrollReset)===!0;if(xe&&bi(xe.formMethod)){Bt(D,B,fe,Xe,ye,we.active,me,Jt,xe);return}oe.set(D,{routeId:B,path:fe}),Mt(D,B,fe,Xe,ye,we.active,me,Jt,xe)}async function Bt(D,B,H,q,me,Re,De,ye,we){ur(),oe.delete(D);function fe(qt){if(!qt.route.action&&!qt.route.lazy){let bc=dr(405,{method:we.formMethod,pathname:H,routeId:B});return y(D,B,bc,{flushSync:De}),!0}return!1}if(!Re&&fe(q))return;let xe=A.fetchers.get(D);E(D,pD(we,xe),{flushSync:De});let We=new AbortController,Xe=Ac(t.history,H,We.signal,we);if(Re){let qt=await Ta(me,H,Xe.signal);if(qt.type==="aborted")return;if(qt.type==="error"){y(D,B,qt.error,{flushSync:De});return}else if(qt.matches){if(me=qt.matches,q=Eu(me,H),fe(q))return}else{y(D,B,dr(404,{pathname:H}),{flushSync:De});return}}re.set(D,We);let Jt=X,le=(await wn("action",A,Xe,[q],me,D))[q.route.id];if(Xe.signal.aborted){re.get(D)===We&&re.delete(D);return}if(d.v7_fetcherPersist&&Le.has(D)){if(Wa(le)||Br(le)){E(D,Os(void 0));return}}else{if(Wa(le))if(re.delete(D),$>Jt){E(D,Os(void 0));return}else return j.add(D),E(D,cu(we)),Wt(Xe,le,!1,{fetcherSubmission:we,preventScrollReset:ye});if(Br(le)){y(D,B,le.error);return}}if($s(le))throw dr(400,{type:"defer-action"});let M=A.navigation.location||A.location,ae=Ac(t.history,M,We.signal),Ce=a||s,$e=A.navigation.state!=="idle"?_a(Ce,A.navigation.location,c):A.matches;tt($e,"Didn't find any matches after fetcher action");let gt=++X;ie.set(D,gt);let jt=cu(we,le.data);A.fetchers.set(D,jt);let[Yt,gn]=LS(t.history,A,$e,we,M,!1,d.v7_skipActionErrorRevalidation,Z,J,ee,Le,oe,j,Ce,c,[q.route.id,le]);gn.filter(qt=>qt.key!==D).forEach(qt=>{let bc=qt.key,CI=A.fetchers.get(bc),GN=cu(void 0,CI?CI.data:void 0);A.fetchers.set(bc,GN),W(bc),qt.controller&&re.set(bc,qt.controller)}),st({fetchers:new Map(A.fetchers)});let Wi=()=>gn.forEach(qt=>W(qt.key));We.signal.addEventListener("abort",Wi);let{loaderResults:Qt,fetcherResults:Je}=await $t(A,$e,Yt,gn,ae);if(We.signal.aborted)return;We.signal.removeEventListener("abort",Wi),ie.delete(D),re.delete(D),gn.forEach(qt=>re.delete(qt.key));let wt=Ah(Qt);if(wt)return Wt(ae,wt.result,!1,{preventScrollReset:ye});if(wt=Ah(Je),wt)return j.add(wt.key),Wt(ae,wt.result,!1,{preventScrollReset:ye});let{loaderData:Sc,errors:Ql}=GS(A,$e,Qt,void 0,gn,Je,de);if(A.fetchers.has(D)){let qt=Os(le.data);A.fetchers.set(D,qt)}rt(gt),A.navigation.state==="loading"&&gt>$?(tt(x,"Expected pending action"),_&&_.abort(),vt(A.navigation.location,{matches:$e,loaderData:Sc,errors:Ql,fetchers:new Map(A.fetchers)})):(st({errors:Ql,loaderData:WS(A.loaderData,Sc,$e,Ql),fetchers:new Map(A.fetchers)}),Z=!1)}async function Mt(D,B,H,q,me,Re,De,ye,we){let fe=A.fetchers.get(D);E(D,cu(we,fe?fe.data:void 0),{flushSync:De});let xe=new AbortController,We=Ac(t.history,H,xe.signal);if(Re){let le=await Ta(me,H,We.signal);if(le.type==="aborted")return;if(le.type==="error"){y(D,B,le.error,{flushSync:De});return}else if(le.matches)me=le.matches,q=Eu(me,H);else{y(D,B,dr(404,{pathname:H}),{flushSync:De});return}}re.set(D,xe);let Xe=X,dt=(await wn("loader",A,We,[q],me,D))[q.route.id];if($s(dt)&&(dt=await eC(dt,We.signal,!0)||dt),re.get(D)===xe&&re.delete(D),!We.signal.aborted){if(Le.has(D)){E(D,Os(void 0));return}if(Wa(dt))if($>Xe){E(D,Os(void 0));return}else{j.add(D),await Wt(We,dt,!1,{preventScrollReset:ye});return}if(Br(dt)){y(D,B,dt.error);return}tt(!$s(dt),"Unhandled fetcher deferred data"),E(D,Os(dt.data))}}async function Wt(D,B,H,q){let{submission:me,fetcherSubmission:Re,preventScrollReset:De,replace:ye}=q===void 0?{}:q;B.response.headers.has("X-Remix-Revalidate")&&(Z=!0);let we=B.response.headers.get("Location");tt(we,"Expected a Location header on the redirect Response"),we=US(we,new URL(D.url),c);let fe=vd(A.location,we,{_isRedirect:!0});if(n){let le=!1;if(B.response.headers.has("X-Remix-Reload-Document"))le=!0;else if(qy.test(we)){const M=t.history.createURL(we);le=M.origin!==e.location.origin||zd(M.pathname,c)==null}if(le){ye?e.location.replace(we):e.location.assign(we);return}}_=null;let xe=ye===!0||B.response.headers.has("X-Remix-Replace")?tn.Replace:tn.Push,{formMethod:We,formAction:Xe,formEncType:Jt}=A.navigation;!me&&!Re&&We&&Xe&&Jt&&(me=zS(A.navigation));let dt=me||Re;if($M.has(B.response.status)&&dt&&bi(dt.formMethod))await ue(xe,fe,{submission:Nt({},dt,{formAction:we}),preventScrollReset:De||T,enableViewTransition:H?O:void 0});else{let le=Qg(fe,me);await ue(xe,fe,{overrideNavigation:le,fetcherSubmission:Re,preventScrollReset:De||T,enableViewTransition:H?O:void 0})}}async function wn(D,B,H,q,me,Re){let De,ye={};try{De=await nD(l,D,B,H,q,me,Re,o,i)}catch(we){return q.forEach(fe=>{ye[fe.route.id]={type:ht.error,error:we}}),ye}for(let[we,fe]of Object.entries(De))if(cD(fe)){let xe=fe.result;ye[we]={type:ht.redirect,response:oD(xe,H,we,me,c,d.v7_relativeSplatPath)}}else ye[we]=await iD(fe);return ye}async function $t(D,B,H,q,me){let Re=D.matches,De=wn("loader",D,me,H,B,null),ye=Promise.all(q.map(async xe=>{if(xe.matches&&xe.match&&xe.controller){let Xe=(await wn("loader",D,Ac(t.history,xe.path,xe.controller.signal),[xe.match],xe.matches,xe.key))[xe.match.route.id];return{[xe.key]:Xe}}else return Promise.resolve({[xe.key]:{type:ht.error,error:dr(404,{pathname:xe.path})}})})),we=await De,fe=(await ye).reduce((xe,We)=>Object.assign(xe,We),{});return await Promise.all([dD(B,we,me.signal,Re,D.loaderData),hD(B,fe,q)]),{loaderResults:we,fetcherResults:fe}}function ur(){Z=!0,J.push(...Jl()),oe.forEach((D,B)=>{re.has(B)&&ee.add(B),W(B)})}function E(D,B,H){H===void 0&&(H={}),A.fetchers.set(D,B),st({fetchers:new Map(A.fetchers)},{flushSync:(H&&H.flushSync)===!0})}function y(D,B,H,q){q===void 0&&(q={});let me=Oa(A.matches,B);P(D),st({errors:{[me.route.id]:H},fetchers:new Map(A.fetchers)},{flushSync:(q&&q.flushSync)===!0})}function I(D){return d.v7_fetcherPersist&&(ke.set(D,(ke.get(D)||0)+1),Le.has(D)&&Le.delete(D)),A.fetchers.get(D)||KM}function P(D){let B=A.fetchers.get(D);re.has(D)&&!(B&&B.state==="loading"&&ie.has(D))&&W(D),oe.delete(D),ie.delete(D),j.delete(D),Le.delete(D),ee.delete(D),A.fetchers.delete(D)}function F(D){if(d.v7_fetcherPersist){let B=(ke.get(D)||0)-1;B<=0?(ke.delete(D),Le.add(D)):ke.set(D,B)}else P(D);st({fetchers:new Map(A.fetchers)})}function W(D){let B=re.get(D);B&&(B.abort(),re.delete(D))}function Q(D){for(let B of D){let H=I(B),q=Os(H.data);A.fetchers.set(B,q)}}function _e(){let D=[],B=!1;for(let H of j){let q=A.fetchers.get(H);tt(q,"Expected fetcher: "+H),q.state==="loading"&&(j.delete(H),D.push(H),B=!0)}return Q(D),B}function rt(D){let B=[];for(let[H,q]of ie)if(q<D){let me=A.fetchers.get(H);tt(me,"Expected fetcher: "+H),me.state==="loading"&&(W(H),ie.delete(H),B.push(H))}return Q(B),B.length>0}function ot(D,B){let H=A.blockers.get(D)||au;return Pe.get(D)!==B&&Pe.set(D,B),H}function at(D){A.blockers.delete(D),Pe.delete(D)}function Qe(D,B){let H=A.blockers.get(D)||au;tt(H.state==="unblocked"&&B.state==="blocked"||H.state==="blocked"&&B.state==="blocked"||H.state==="blocked"&&B.state==="proceeding"||H.state==="blocked"&&B.state==="unblocked"||H.state==="proceeding"&&B.state==="unblocked","Invalid blocker state transition: "+H.state+" -> "+B.state);let q=new Map(A.blockers);q.set(D,B),st({blockers:q})}function Ts(D){let{currentLocation:B,nextLocation:H,historyAction:q}=D;if(Pe.size===0)return;Pe.size>1&&Cl(!1,"A router only supports one blocker at a time");let me=Array.from(Pe.entries()),[Re,De]=me[me.length-1],ye=A.blockers.get(Re);if(!(ye&&ye.state==="proceeding")&&De({currentLocation:B,nextLocation:H,historyAction:q}))return Re}function Kl(D){let B=dr(404,{pathname:D}),H=a||s,{matches:q,route:me}=ZS(H);return Jl(),{notFoundMatches:q,route:me,error:B}}function Jl(D){let B=[];return de.forEach((H,q)=>{(!D||D(q))&&(H.cancel(),B.push(q),de.delete(q))}),B}function Kt(D,B,H){if(p=D,C=B,m=H||null,!g&&A.navigation===Yg){g=!0;let q=Yl(A.location,A.matches);q!=null&&st({restoreScrollPosition:q})}return()=>{p=null,C=null,m=null}}function To(D,B){return m&&m(D,B.map(q=>AM(q,A.loaderData)))||D.key}function Sg(D,B){if(p&&C){let H=To(D,B);p[H]=C()}}function Yl(D,B){if(p){let H=To(D,B),q=p[H];if(typeof q=="number")return q}return null}function Rs(D,B,H){if(u)if(D){if(Object.keys(D[0].params).length>0)return{active:!0,matches:Qh(B,H,c,!0)}}else return{active:!0,matches:Qh(B,H,c,!0)||[]};return{active:!1,matches:null}}async function Ta(D,B,H){if(!u)return{type:"success",matches:D};let q=D;for(;;){let me=a==null,Re=a||s,De=o;try{await u({path:B,matches:q,patch:(fe,xe)=>{H.aborted||BS(fe,xe,Re,De,i)}})}catch(fe){return{type:"error",error:fe,partialMatches:q}}finally{me&&!H.aborted&&(s=[...s])}if(H.aborted)return{type:"aborted"};let ye=_a(Re,B,c);if(ye)return{type:"success",matches:ye};let we=Qh(Re,B,c,!0);if(!we||q.length===we.length&&q.every((fe,xe)=>fe.route.id===we[xe].route.id))return{type:"success",matches:null};q=we}}function oh(D){o={},a=Jf(D,i,void 0,o)}function bg(D,B){let H=a==null;BS(D,B,a||s,o,i),H&&(s=[...s],st({}))}return w={get basename(){return c},get future(){return d},get state(){return A},get routes(){return s},get window(){return e},initialize:ve,subscribe:Sn,enableScrollRestoration:Kt,navigate:bn,fetch:qe,revalidate:on,createHref:D=>t.history.createHref(D),encodeLocation:D=>t.history.encodeLocation(D),getFetcher:I,deleteFetcher:F,dispose:rn,getBlocker:ot,deleteBlocker:at,patchRoutes:bg,_internalFetchControllers:re,_internalActiveDeferreds:de,_internalSetRoutes:oh},w}function QM(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function _v(t,e,n,r,i,o,s,a){let c,l;if(s){c=[];for(let d of e)if(c.push(d),d.route.id===s){l=d;break}}else c=e,l=e[e.length-1];let u=VM(i||".",UM(c,o),zd(t.pathname,n)||t.pathname,a==="path");if(i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&l){let d=tC(u.search);if(l.route.index&&!d)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!l.route.index&&d){let h=new URLSearchParams(u.search),f=h.getAll("index");h.delete("index"),f.filter(m=>m).forEach(m=>h.append("index",m));let p=h.toString();u.search=p?"?"+p:""}}return r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:Ka([n,u.pathname])),Hd(u)}function MS(t,e,n,r){if(!r||!QM(r))return{path:n};if(r.formMethod&&!uD(r.formMethod))return{path:n,error:dr(405,{method:r.formMethod})};let i=()=>({path:n,error:dr(400,{type:"invalid-body"})}),o=r.formMethod||"get",s=t?o.toUpperCase():o.toLowerCase(),a=pE(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!bi(s))return i();let h=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((f,p)=>{let[m,C]=p;return""+f+m+"="+C+`
`},""):String(r.body);return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:h}}}else if(r.formEncType==="application/json"){if(!bi(s))return i();try{let h=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:h,text:void 0}}}catch{return i()}}}tt(typeof FormData=="function","FormData is not available in this environment");let c,l;if(r.formData)c=Mv(r.formData),l=r.formData;else if(r.body instanceof FormData)c=Mv(r.body),l=r.body;else if(r.body instanceof URLSearchParams)c=r.body,l=VS(c);else if(r.body==null)c=new URLSearchParams,l=new FormData;else try{c=new URLSearchParams(r.body),l=VS(c)}catch{return i()}let u={formMethod:s,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(bi(u.formMethod))return{path:n,submission:u};let d=ba(n);return e&&d.search&&tC(d.search)&&c.append("index",""),d.search="?"+c,{path:Hd(d),submission:u}}function DS(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(i=>i.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function LS(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m){let C=m?Br(m[1])?m[1].error:m[1].data:void 0,g=t.createURL(e.location),v=t.createURL(i),S=n;o&&e.errors?S=DS(n,Object.keys(e.errors)[0],!0):m&&Br(m[1])&&(S=DS(n,m[0]));let k=m?m[1].statusCode:void 0,w=s&&k&&k>=400,A=S.filter((T,_)=>{let{route:O}=T;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return Ov(O,e.loaderData,e.errors);if(qM(e.loaderData,e.matches[_],T)||c.some(z=>z===T.route.id))return!0;let L=e.matches[_],U=T;return FS(T,Nt({currentUrl:g,currentParams:L.params,nextUrl:v,nextParams:U.params},r,{actionResult:C,actionStatus:k,defaultShouldRevalidate:w?!1:a||g.pathname+g.search===v.pathname+v.search||g.search!==v.search||hE(L,U)}))}),x=[];return d.forEach((T,_)=>{if(o||!n.some(Z=>Z.route.id===T.routeId)||u.has(_))return;let O=_a(f,T.path,p);if(!O){x.push({key:_,routeId:T.routeId,path:T.path,matches:null,match:null,controller:null});return}let L=e.fetchers.get(_),U=Eu(O,T.path),z=!1;h.has(_)?z=!1:l.has(_)?(l.delete(_),z=!0):L&&L.state!=="idle"&&L.data===void 0?z=a:z=FS(U,Nt({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:C,actionStatus:k,defaultShouldRevalidate:w?!1:a})),z&&x.push({key:_,routeId:T.routeId,path:T.path,matches:O,match:U,controller:new AbortController})}),[A,x]}function Ov(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,i=n!=null&&n[t.id]!==void 0;return!r&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!i}function qM(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function hE(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function FS(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function BS(t,e,n,r,i){var o;let s;if(t){let l=r[t];tt(l,"No route found to patch children into: routeId = "+t),l.children||(l.children=[]),s=l.children}else s=n;let a=e.filter(l=>!s.some(u=>fE(l,u))),c=Jf(a,i,[t||"_","patch",String(((o=s)==null?void 0:o.length)||"0")],r);s.push(...c)}function fE(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var i;return(i=e.children)==null?void 0:i.some(o=>fE(n,o))}):!1}async function eD(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];tt(i,"No route found in manifest");let o={};for(let s in r){let c=i[s]!==void 0&&s!=="hasErrorBoundary";Cl(!c,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!c&&!bM.has(s)&&(o[s]=r[s])}Object.assign(i,o),Object.assign(i,Nt({},e(i),{lazy:void 0}))}async function tD(t){let{matches:e}=t,n=e.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,o,s)=>Object.assign(i,{[n[s].route.id]:o}),{})}async function nD(t,e,n,r,i,o,s,a,c,l){let u=o.map(f=>f.route.lazy?eD(f.route,c,a):void 0),d=o.map((f,p)=>{let m=u[p],C=i.some(v=>v.route.id===f.route.id);return Nt({},f,{shouldLoad:C,resolve:async v=>(v&&r.method==="GET"&&(f.route.lazy||f.route.loader)&&(C=!0),C?rD(e,r,f,m,v,l):Promise.resolve({type:ht.data,result:void 0}))})}),h=await t({matches:d,request:r,params:o[0].params,fetcherKey:s,context:l});try{await Promise.all(u)}catch{}return h}async function rD(t,e,n,r,i,o){let s,a,c=l=>{let u,d=new Promise((p,m)=>u=m);a=()=>u(),e.signal.addEventListener("abort",a);let h=p=>typeof l!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):l({request:e,params:n.params,context:o},...p!==void 0?[p]:[]),f=(async()=>{try{return{type:"data",result:await(i?i(m=>h(m)):h())}}catch(p){return{type:"error",result:p}}})();return Promise.race([f,d])};try{let l=n.route[t];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(h=>{u=h}),r]);if(u!==void 0)throw u;s=d}else if(await r,l=n.route[t],l)s=await c(l);else if(t==="action"){let u=new URL(e.url),d=u.pathname+u.search;throw dr(405,{method:e.method,pathname:d,routeId:n.route.id})}else return{type:ht.data,result:void 0};else if(l)s=await c(l);else{let u=new URL(e.url),d=u.pathname+u.search;throw dr(404,{pathname:d})}tt(s.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(l){return{type:ht.error,result:l}}finally{a&&e.signal.removeEventListener("abort",a)}return s}async function iD(t){let{result:e,type:n}=t;if(gE(e)){let l;try{let u=e.headers.get("Content-Type");u&&/\bapplication\/json\b/.test(u)?e.body==null?l=null:l=await e.json():l=await e.text()}catch(u){return{type:ht.error,error:u}}return n===ht.error?{type:ht.error,error:new Yf(e.status,e.statusText,l),statusCode:e.status,headers:e.headers}:{type:ht.data,data:l,statusCode:e.status,headers:e.headers}}if(n===ht.error){if(HS(e)){var r;if(e.data instanceof Error){var i;return{type:ht.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status}}e=new Yf(((r=e.init)==null?void 0:r.status)||500,void 0,e.data)}return{type:ht.error,error:e,statusCode:$p(e)?e.status:void 0}}if(lD(e)){var o,s;return{type:ht.deferred,deferredData:e,statusCode:(o=e.init)==null?void 0:o.status,headers:((s=e.init)==null?void 0:s.headers)&&new Headers(e.init.headers)}}if(HS(e)){var a,c;return{type:ht.data,data:e.data,statusCode:(a=e.init)==null?void 0:a.status,headers:(c=e.init)!=null&&c.headers?new Headers(e.init.headers):void 0}}return{type:ht.data,data:e}}function oD(t,e,n,r,i,o){let s=t.headers.get("Location");if(tt(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!qy.test(s)){let a=r.slice(0,r.findIndex(c=>c.route.id===n)+1);s=_v(new URL(e.url),a,i,!0,s,o),t.headers.set("Location",s)}return t}function US(t,e,n){if(qy.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=zd(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function Ac(t,e,n,r){let i=t.createURL(pE(e)).toString(),o={signal:n};if(r&&bi(r.formMethod)){let{formMethod:s,formEncType:a}=r;o.method=s.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=Mv(r.formData):o.body=r.formData}return new Request(i,o)}function Mv(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function VS(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function sD(t,e,n,r,i){let o={},s=null,a,c=!1,l={},u=n&&Br(n[1])?n[1].error:void 0;return t.forEach(d=>{if(!(d.route.id in e))return;let h=d.route.id,f=e[h];if(tt(!Wa(f),"Cannot handle redirect results in processLoaderData"),Br(f)){let p=f.error;u!==void 0&&(p=u,u=void 0),s=s||{};{let m=Oa(t,h);s[m.route.id]==null&&(s[m.route.id]=p)}o[h]=void 0,c||(c=!0,a=$p(f.error)?f.error.status:500),f.headers&&(l[h]=f.headers)}else $s(f)?(r.set(h,f.deferredData),o[h]=f.deferredData.data,f.statusCode!=null&&f.statusCode!==200&&!c&&(a=f.statusCode),f.headers&&(l[h]=f.headers)):(o[h]=f.data,f.statusCode&&f.statusCode!==200&&!c&&(a=f.statusCode),f.headers&&(l[h]=f.headers))}),u!==void 0&&n&&(s={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:s,statusCode:a||200,loaderHeaders:l}}function GS(t,e,n,r,i,o,s){let{loaderData:a,errors:c}=sD(e,n,r,s);return i.forEach(l=>{let{key:u,match:d,controller:h}=l,f=o[u];if(tt(f,"Did not find corresponding fetcher result"),!(h&&h.signal.aborted))if(Br(f)){let p=Oa(t.matches,d==null?void 0:d.route.id);c&&c[p.route.id]||(c=Nt({},c,{[p.route.id]:f.error})),t.fetchers.delete(u)}else if(Wa(f))tt(!1,"Unhandled fetcher revalidation redirect");else if($s(f))tt(!1,"Unhandled fetcher deferred data");else{let p=Os(f.data);t.fetchers.set(u,p)}}),{loaderData:a,errors:c}}function WS(t,e,n,r){let i=Nt({},e);for(let o of n){let s=o.route.id;if(e.hasOwnProperty(s)?e[s]!==void 0&&(i[s]=e[s]):t[s]!==void 0&&o.route.loader&&(i[s]=t[s]),r&&r.hasOwnProperty(s))break}return i}function jS(t){return t?Br(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Oa(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function ZS(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function dr(t,e){let{pathname:n,routeId:r,method:i,type:o,message:s}=e===void 0?{}:e,a="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(a="Bad Request",i&&n&&r?c="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?c="defer() is not supported in actions":o==="invalid-body"&&(c="Unable to encode submission body")):t===403?(a="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(a="Not Found",c='No route matches URL "'+n+'"'):t===405&&(a="Method Not Allowed",i&&n&&r?c="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(c='Invalid request method "'+i.toUpperCase()+'"')),new Yf(t||500,a,new Error(c),!0)}function Ah(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,i]=e[n];if(Wa(i))return{key:r,result:i}}}function pE(t){let e=typeof t=="string"?ba(t):t;return Hd(Nt({},e,{hash:""}))}function aD(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function cD(t){return gE(t.result)&&XM.has(t.result.status)}function $s(t){return t.type===ht.deferred}function Br(t){return t.type===ht.error}function Wa(t){return(t&&t.type)===ht.redirect}function HS(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function lD(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function gE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function uD(t){return zM.has(t.toLowerCase())}function bi(t){return ZM.has(t.toLowerCase())}async function dD(t,e,n,r,i){let o=Object.entries(e);for(let s=0;s<o.length;s++){let[a,c]=o[s],l=t.find(h=>(h==null?void 0:h.route.id)===a);if(!l)continue;let u=r.find(h=>h.route.id===l.route.id),d=u!=null&&!hE(u,l)&&(i&&i[l.route.id])!==void 0;$s(c)&&d&&await eC(c,n,!1).then(h=>{h&&(e[a]=h)})}}async function hD(t,e,n){for(let r=0;r<n.length;r++){let{key:i,routeId:o,controller:s}=n[r],a=e[i];t.find(l=>(l==null?void 0:l.route.id)===o)&&$s(a)&&(tt(s,"Expected an AbortController for revalidating fetcher deferred result"),await eC(a,s.signal,!0).then(l=>{l&&(e[i]=l)}))}}async function eC(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:ht.data,data:t.deferredData.unwrappedData}}catch(i){return{type:ht.error,error:i}}return{type:ht.data,data:t.deferredData.data}}}function tC(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Eu(t,e){let n=typeof e=="string"?ba(e).search:e.search;if(t[t.length-1].route.index&&tC(n||""))return t[t.length-1];let r=lE(t);return r[r.length-1]}function zS(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:o,json:s}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(s!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}}}function Qg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function fD(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function cu(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function pD(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Os(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function gD(t,e){try{let n=t.sessionStorage.getItem(dE);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function mD(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(dE,JSON.stringify(n))}catch(r){Cl(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dv(){return Dv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dv.apply(this,arguments)}const mE=b.createContext(null),vE=b.createContext(null),yE=b.createContext(null),nC=b.createContext(null),Kp=b.createContext({outlet:null,matches:[],isDataRoute:!1}),CE=b.createContext(null);function rC(){return b.useContext(nC)!=null}function IE(){return rC()||tt(!1),b.useContext(nC).location}function vD(t,e,n,r){rC()||tt(!1);let{navigator:i}=b.useContext(yE),{matches:o}=b.useContext(Kp),s=o[o.length-1],a=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let l=IE(),u;u=l;let d=u.pathname||"/",h=d;if(c!=="/"){let m=c.replace(/^\//,"").split("/");h="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let f=_a(t,{pathname:h});return bD(f&&f.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:Ka([c,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?c:Ka([c,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),o,n,r)}function yD(){let t=ED(),e=$p(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:i},n):null,null)}const CD=b.createElement(yD,null);class ID extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?b.createElement(Kp.Provider,{value:this.props.routeContext},b.createElement(CE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function SD(t){let{routeContext:e,match:n,children:r}=t,i=b.useContext(mE);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(Kp.Provider,{value:e},r)}function bD(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||tt(!1),s=s.slice(0,Math.min(s.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:h,errors:f}=n,p=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){c=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((u,d,h)=>{let f,p=!1,m=null,C=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||CD,c&&(l<0&&h===0?(TD("route-fallback"),p=!0,C=null):l===h&&(p=!0,C=d.route.hydrateFallbackElement||null)));let g=e.concat(s.slice(0,h+1)),v=()=>{let S;return f?S=m:p?S=C:d.route.Component?S=b.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=u,b.createElement(SD,{match:d,routeContext:{outlet:u,matches:g,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?b.createElement(ID,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}var Lv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Lv||{});function wD(t){let e=b.useContext(vE);return e||tt(!1),e}function AD(t){let e=b.useContext(Kp);return e||tt(!1),e}function kD(t){let e=AD(),n=e.matches[e.matches.length-1];return n.route.id||tt(!1),n.route.id}function ED(){var t;let e=b.useContext(CE),n=wD(Lv.UseRouteError),r=kD(Lv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const XS={};function TD(t,e,n){XS[t]||(XS[t]=!0)}function RD(t){let{basename:e="/",children:n=null,location:r,navigationType:i=tn.Pop,navigator:o,static:s=!1,future:a}=t;rC()&&tt(!1);let c=e.replace(/^\/*/,"/"),l=b.useMemo(()=>({basename:c,navigator:o,static:s,future:Dv({v7_relativeSplatPath:!1},a)}),[c,a,o,s]);typeof r=="string"&&(r=ba(r));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=r,m=b.useMemo(()=>{let C=zd(u,c);return C==null?null:{location:{pathname:C,search:d,hash:h,state:f,key:p},navigationType:i}},[c,u,d,h,f,p,i]);return m==null?null:b.createElement(yE.Provider,{value:l},b.createElement(nC.Provider,{children:n,value:m}))}new Promise(()=>{});function xD(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:b.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:b.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:b.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qf(){return Qf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qf.apply(this,arguments)}const PD="6";try{window.__reactRouterVersion=PD}catch{}function ND(t,e){return YM({basename:void 0,future:Qf({},void 0,{v7_prependBasename:!0}),history:CM({window:void 0}),hydrationData:_D(),routes:t,mapRouteProperties:xD,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function _D(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Qf({},e,{errors:OD(e.errors)})),e}function OD(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new Yf(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let s=new o(i.message);s.stack="",n[r]=s}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const MD=b.createContext({isTransitioning:!1}),DD=b.createContext(new Map),LD="startTransition",$S=s_[LD],FD="flushSync",KS=yM[FD];function BD(t){$S?$S(t):t()}function lu(t){KS?KS(t):t()}class UD{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function VD(t){let{fallbackElement:e,router:n,future:r}=t,[i,o]=b.useState(n.state),[s,a]=b.useState(),[c,l]=b.useState({isTransitioning:!1}),[u,d]=b.useState(),[h,f]=b.useState(),[p,m]=b.useState(),C=b.useRef(new Map),{v7_startTransition:g}=r||{},v=b.useCallback(T=>{g?BD(T):T()},[g]),S=b.useCallback((T,_)=>{let{deletedFetchers:O,flushSync:L,viewTransitionOpts:U}=_;O.forEach(Z=>C.current.delete(Z)),T.fetchers.forEach((Z,J)=>{Z.data!==void 0&&C.current.set(J,Z.data)});let z=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!U||z){L?lu(()=>o(T)):v(()=>o(T));return}if(L){lu(()=>{h&&(u&&u.resolve(),h.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:U.currentLocation,nextLocation:U.nextLocation})});let Z=n.window.document.startViewTransition(()=>{lu(()=>o(T))});Z.finished.finally(()=>{lu(()=>{d(void 0),f(void 0),a(void 0),l({isTransitioning:!1})})}),lu(()=>f(Z));return}h?(u&&u.resolve(),h.skipTransition(),m({state:T,currentLocation:U.currentLocation,nextLocation:U.nextLocation})):(a(T),l({isTransitioning:!0,flushSync:!1,currentLocation:U.currentLocation,nextLocation:U.nextLocation}))},[n.window,h,u,C,v]);b.useLayoutEffect(()=>n.subscribe(S),[n,S]),b.useEffect(()=>{c.isTransitioning&&!c.flushSync&&d(new UD)},[c]),b.useEffect(()=>{if(u&&s&&n.window){let T=s,_=u.promise,O=n.window.document.startViewTransition(async()=>{v(()=>o(T)),await _});O.finished.finally(()=>{d(void 0),f(void 0),a(void 0),l({isTransitioning:!1})}),f(O)}},[v,s,u,n.window]),b.useEffect(()=>{u&&s&&i.location.key===s.location.key&&u.resolve()},[u,h,i.location,s]),b.useEffect(()=>{!c.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[c.isTransitioning,p]),b.useEffect(()=>{},[]);let k=b.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:T=>n.navigate(T),push:(T,_,O)=>n.navigate(T,{state:_,preventScrollReset:O==null?void 0:O.preventScrollReset}),replace:(T,_,O)=>n.navigate(T,{replace:!0,state:_,preventScrollReset:O==null?void 0:O.preventScrollReset})}),[n]),w=n.basename||"/",A=b.useMemo(()=>({router:n,navigator:k,static:!1,basename:w}),[n,k,w]),x=b.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return b.createElement(b.Fragment,null,b.createElement(mE.Provider,{value:A},b.createElement(vE.Provider,{value:i},b.createElement(DD.Provider,{value:C.current},b.createElement(MD.Provider,{value:c},b.createElement(RD,{basename:w,location:i.location,navigationType:i.historyAction,navigator:k,future:x},i.initialized||n.future.v7_partialHydration?b.createElement(GD,{routes:n.routes,future:n.future,state:i}):e))))),null)}const GD=b.memo(WD);function WD(t){let{routes:e,future:n,state:r}=t;return vD(e,void 0,r,n)}var JS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(JS||(JS={}));var YS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(YS||(YS={}));const SE=t=>{const e=typeof t=="function",n=b.useRef(t);b.useEffect(()=>{n.current=t}),b.useEffect(()=>{if(e){const r=i=>{const o=n.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])},bE=7e3;let Zi=null;function QS(t,e="assertive",n=bE){Zi?Zi.announce(t,e,n):(Zi=new jD,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?Zi.announce(t,e,n):setTimeout(()=>{Zi!=null&&Zi.isAttached()&&(Zi==null||Zi.announce(t,e,n))},100))}class jD{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",e),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,n="assertive",r=bE){var i,o;if(!this.node)return;let s=document.createElement("div");typeof e=="object"?(s.setAttribute("role","img"),s.setAttribute("aria-labelledby",e["aria-labelledby"])):s.textContent=e,n==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(s):(o=this.politeLog)===null||o===void 0||o.appendChild(s),e!==""&&setTimeout(()=>{s.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var qS=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function ZD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ps=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],HD=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,zD=function(){qS(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){ZD(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return qS(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(Ps[n][r].color);for(var i=[0,95,135,175,215,255],o=function(h,f,p){return i[h]+", "+i[f]+", "+i[p]},s=0;s<6;++s)for(var a=0;a<6;++a)for(var c=0;c<6;++c)this.PALETTE_COLORS.push(o(s,a,c));for(var l=8,u=0;u<24;++u,l+=10)this.PALETTE_COLORS.push(o(l,l,l))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(HD,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var o=this,s=this,a=n.split(/\033\[/),c=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var l=a.map(function(d){return o.processChunk(d,r,i)});if(r&&r.json){var u=s.processChunkJson("");return u.content=c,u.clearLine=r.clearLine,l.unshift(u),r.remove_empty&&(l=l.filter(function(d){return!d.isEmpty()})),l}else l.unshift(c);return l.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var o=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,s=r.key=o?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},c=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!c)return a;a.content=c[4];var l=c[2].split(";");if(c[1]!==""||c[3]!=="m"||!i)return a;for(var u=this;l.length>0;){var d=l.shift(),h=parseInt(d);if(isNaN(h)||h===0)u.fg=u.bg=null,u.decorations=[];else if(h===1)u.decorations.push("bold");else if(h===2)u.decorations.push("dim");else if(h===3)u.decorations.push("italic");else if(h===4)u.decorations.push("underline");else if(h===5)u.decorations.push("blink");else if(h===7)u.decorations.push("reverse");else if(h===8)u.decorations.push("hidden");else if(h===9)u.decorations.push("strikethrough");else if(h===21)u.removeDecoration("bold");else if(h===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(h===23)u.removeDecoration("italic");else if(h===24)u.removeDecoration("underline");else if(h===25)u.removeDecoration("blink");else if(h===27)u.removeDecoration("reverse");else if(h===28)u.removeDecoration("hidden");else if(h===29)u.removeDecoration("strikethrough");else if(h===39)u.fg=null;else if(h===49)u.bg=null;else if(h>=30&&h<38)u.fg=Ps[0][h%10][s];else if(h>=90&&h<98)u.fg=Ps[1][h%10][s];else if(h>=40&&h<48)u.bg=Ps[0][h%10][s];else if(h>=100&&h<108)u.bg=Ps[1][h%10][s];else if(h===38||h===48){var f=h===38;if(l.length>=1){var p=l.shift();if(p==="5"&&l.length>=1){var m=parseInt(l.shift());if(m>=0&&m<=255)if(!o)this.PALETTE_COLORS||u.setupPalette(),f?u.fg=this.PALETTE_COLORS[m]:u.bg=this.PALETTE_COLORS[m];else{var C=m>=16?"ansi-palette-"+m:Ps[m>7?1:0][m%8].class;f?u.fg=C:u.bg=C}}else if(p==="2"&&l.length>=3){var g=parseInt(l.shift()),v=parseInt(l.shift()),S=parseInt(l.shift());if(g>=0&&g<=255&&v>=0&&v<=255&&S>=0&&S<=255){var k=g+", "+v+", "+S;o?f?(u.fg="ansi-truecolor",u.fg_truecolor=k):(u.bg="ansi-truecolor",u.bg_truecolor=k):f?u.fg=k:u.bg=k}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var o=this;r=r||{};var s=this.processChunkJson(n,r,i),a=r.use_classes;if(s.decorations=s.decorations.filter(function(f){if(f==="reverse"){s.fg||(s.fg=Ps[0][7][a?"class":"color"]),s.bg||(s.bg=Ps[0][0][a?"class":"color"]);var p=s.fg;s.fg=s.bg,s.bg=p;var m=s.fg_truecolor;return s.fg_truecolor=s.bg_truecolor,s.bg_truecolor=m,s.isInverted=!0,!1}return!0}),r.json)return s;if(s.isEmpty())return"";if(!s.was_processed)return s.content;var c=[],l=[],u=[],d={},h=function(p){var m=[],C=void 0;for(C in p)p.hasOwnProperty(C)&&m.push("data-"+C+'="'+o.escapeForHtml(p[C])+'"');return m.length>0?" "+m.join(" "):""};return s.isInverted&&(d["ansi-is-inverted"]="true"),s.fg&&(a?(c.push(s.fg+"-fg"),s.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=s.fg_truecolor,s.fg_truecolor=null)):c.push("color:rgb("+s.fg+")")),s.bg&&(a?(c.push(s.bg+"-bg"),s.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=s.bg_truecolor,s.bg_truecolor=null)):c.push("background-color:rgb("+s.bg+")")),s.decorations.forEach(function(f){if(a){l.push("ansi-"+f);return}f==="bold"?l.push("font-weight:bold"):f==="dim"?l.push("opacity:0.5"):f==="italic"?l.push("font-style:italic"):f==="hidden"?l.push("visibility:hidden"):f==="strikethrough"?u.push("line-through"):u.push(f)}),u.length&&l.push("text-decoration:"+u.join(" ")),a?'<span class="'+c.concat(l).join(" ")+'"'+h(d)+">"+s.content+"</span>":'<span style="'+c.concat(l).join(";")+'"'+h(d)+">"+s.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),XD=zD;const $D=Ud(XD);function KD(t,e){let n=[];for(const r of t.split(`\r
`)){const i=$D.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const s of i){const a=qD(s,e);o=[...o,...a]}n=[...n,K.jsx("span",{children:o},n.length)]}return n}const JD=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,YD=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,QD=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function qD(t,e){const n=e2(t),r=[];let i=0,o=0;function s(u,d){let h;for(;(h=u.exec(t.content))!==null;){const f=h.index;f>i&&r.push(t.content.substring(i,f)),r.push(d(h)),i=u.lastIndex}}function a(u){const[,d,h]=u,f=h;return K.jsxs(K.Fragment,{children:[d,K.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:h})]})}function c(u){const d=u.groups.name,h=`mailto:${d}`;return K.jsxs(K.Fragment,{children:[u.groups.slorp1,K.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function l(u){const[,d,h]=u;return K.jsx("a",{onClick:()=>e(d),className:"exit",children:h})}return s(JD,a),s(YD,c),s(QD,l),i<t.content.length&&r.push(t.content.substring(i)),r.map(u=>K.jsx("span",{style:n,children:u},o++))}function e2(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var ga={},Ol={},wE=b;function Be(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hr=Object.prototype.hasOwnProperty,t2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,eb={},tb={};function AE(t){return hr.call(tb,t)?!0:hr.call(eb,t)?!1:t2.test(t)?tb[t]=!0:(eb[t]=!0,!1)}function ar(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var On={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){On[t]=new ar(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];On[e]=new ar(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){On[t]=new ar(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){On[t]=new ar(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){On[t]=new ar(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){On[t]=new ar(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){On[t]=new ar(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){On[t]=new ar(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){On[t]=new ar(t,5,!1,t.toLowerCase(),null,!1,!1)});var iC=/[\-:]([a-z])/g;function oC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(iC,oC);On[e]=new ar(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(iC,oC);On[e]=new ar(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(iC,oC);On[e]=new ar(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){On[t]=new ar(t,1,!1,t.toLowerCase(),null,!1,!1)});On.xlinkHref=new ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){On[t]=new ar(t,1,!1,t.toLowerCase(),null,!0,!0)});var qh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},n2=["Webkit","ms","Moz","O"];Object.keys(qh).forEach(function(t){n2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qh[e]=qh[t]})});var r2=/["'&<>]/;function qn(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=r2.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var i2=/([A-Z])/g,o2=/^ms-/,Fv=Array.isArray;function Ro(t,e){return{insertionMode:t,selectedValue:e}}function s2(t,e,n){switch(e){case"select":return Ro(1,n.value!=null?n.value:n.defaultValue);case"svg":return Ro(2,null);case"math":return Ro(3,null);case"foreignObject":return Ro(1,null);case"table":return Ro(4,null);case"thead":case"tbody":case"tfoot":return Ro(5,null);case"colgroup":return Ro(7,null);case"tr":return Ro(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Ro(1,null):t}var nb=new Map;function kE(t,e,n){if(typeof n!="object")throw Error(Be(62));e=!0;for(var r in n)if(hr.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=qn(r);i=qn((""+i).trim())}else{o=r;var s=nb.get(o);s!==void 0||(s=qn(o.replace(i2,"-$1").toLowerCase().replace(o2,"-ms-")),nb.set(o,s)),o=s,i=typeof i=="number"?i===0||hr.call(qh,r)?""+i:i+"px":qn((""+i).trim())}e?(e=!1,t.push(' style="',o,":",i)):t.push(";",o,":",i)}}e||t.push('"')}function Er(t,e,n,r){switch(n){case"style":kE(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=On.hasOwnProperty(n)?On[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=e.attributeName,e.type){case 3:r&&t.push(" ",n,'=""');break;case 4:r===!0?t.push(" ",n,'=""'):r!==!1&&t.push(" ",n,'="',qn(r),'"');break;case 5:isNaN(r)||t.push(" ",n,'="',qn(r),'"');break;case 6:!isNaN(r)&&1<=r&&t.push(" ",n,'="',qn(r),'"');break;default:e.sanitizeURL&&(r=""+r),t.push(" ",n,'="',qn(r),'"')}}else if(AE(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",n,'="',qn(r),'"')}}}function ef(t,e,n){if(e!=null){if(n!=null)throw Error(Be(60));if(typeof e!="object"||!("__html"in e))throw Error(Be(61));e=e.__html,e!=null&&t.push(""+e)}}function a2(t){var e="";return wE.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function qg(t,e,n,r){t.push(Hi(n));var i=n=null,o;for(o in e)if(hr.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Er(t,r,o,s)}}return t.push(">"),ef(t,i,n),typeof n=="string"?(t.push(qn(n)),null):n}var c2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,rb=new Map;function Hi(t){var e=rb.get(t);if(e===void 0){if(!c2.test(t))throw Error(Be(65,t));e="<"+t,rb.set(t,e)}return e}function l2(t,e,n,r,i){switch(e){case"select":t.push(Hi("select"));var o=null,s=null;for(u in n)if(hr.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Er(t,r,u,a)}}return t.push(">"),ef(t,s,o),o;case"option":s=i.selectedValue,t.push(Hi("option"));var c=a=null,l=null,u=null;for(o in n)if(hr.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:Er(t,r,o,d)}}if(s!=null)if(n=c!==null?""+c:a2(a),Fv(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(' selected=""');break}}else""+s===n&&t.push(' selected=""');else l&&t.push(' selected=""');return t.push(">"),ef(t,u,a),a;case"textarea":t.push(Hi("textarea")),u=s=o=null;for(a in n)if(hr.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":o=c;break;case"defaultValue":s=c;break;case"dangerouslySetInnerHTML":throw Error(Be(91));default:Er(t,r,a,c)}if(o===null&&s!==null&&(o=s),t.push(">"),u!=null){if(o!=null)throw Error(Be(92));if(Fv(u)&&1<u.length)throw Error(Be(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o!==null&&t.push(qn(""+o)),null;case"input":t.push(Hi("input")),c=u=a=o=null;for(s in n)if(hr.call(n,s)&&(l=n[s],l!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(Be(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":o=l;break;default:Er(t,r,s,l)}return u!==null?Er(t,r,"checked",u):c!==null&&Er(t,r,"checked",c),o!==null?Er(t,r,"value",o):a!==null&&Er(t,r,"value",a),t.push("/>"),null;case"menuitem":t.push(Hi("menuitem"));for(var h in n)if(hr.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Be(400));default:Er(t,r,h,o)}return t.push(">"),null;case"title":t.push(Hi("title")),o=null;for(d in n)if(hr.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(Be(434));default:Er(t,r,d,s)}return t.push(">"),o;case"listing":case"pre":t.push(Hi(e)),s=o=null;for(c in n)if(hr.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Er(t,r,c,a)}if(t.push(">"),s!=null){if(o!=null)throw Error(Be(60));if(typeof s!="object"||!("__html"in s))throw Error(Be(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(`
`,n):t.push(""+n))}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(Hi(e));for(var f in n)if(hr.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Be(399,e));default:Er(t,r,f,o)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return qg(t,n,e,r);case"html":return i.insertionMode===0&&t.push("<!DOCTYPE html>"),qg(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return qg(t,n,e,r);t.push(Hi(e)),s=o=null;for(l in n)if(hr.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":kE(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:AE(l)&&typeof a!="function"&&typeof a!="symbol"&&t.push(" ",l,'="',qn(a),'"')}return t.push(">"),ef(t,s,o),o}}function ib(t,e,n){if(t.push('<!--$?--><template id="'),n===null)throw Error(Be(395));return t.push(n),t.push('"></template>')}function u2(t,e,n,r){switch(n.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');default:throw Error(Be(397))}}function d2(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(Be(397))}}var h2=/[<\u2028\u2029]/g;function em(t){return JSON.stringify(t).replace(h2,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function f2(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function ob(t,e,n,r){return n.generateStaticMarkup?(t.push(qn(e)),!1):(e===""?t=r:(r&&t.push("<!-- -->"),t.push(qn(e)),t=!0),t)}var zu=Object.assign,p2=Symbol.for("react.element"),EE=Symbol.for("react.portal"),TE=Symbol.for("react.fragment"),RE=Symbol.for("react.strict_mode"),xE=Symbol.for("react.profiler"),PE=Symbol.for("react.provider"),NE=Symbol.for("react.context"),_E=Symbol.for("react.forward_ref"),OE=Symbol.for("react.suspense"),ME=Symbol.for("react.suspense_list"),DE=Symbol.for("react.memo"),sC=Symbol.for("react.lazy"),g2=Symbol.for("react.scope"),m2=Symbol.for("react.debug_trace_mode"),v2=Symbol.for("react.legacy_hidden"),y2=Symbol.for("react.default_value"),sb=Symbol.iterator;function Bv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case TE:return"Fragment";case EE:return"Portal";case xE:return"Profiler";case RE:return"StrictMode";case OE:return"Suspense";case ME:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case NE:return(t.displayName||"Context")+".Consumer";case PE:return(t._context.displayName||"Context")+".Provider";case _E:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case DE:return e=t.displayName||null,e!==null?e:Bv(t.type)||"Memo";case sC:e=t._payload,t=t._init;try{return Bv(t(e))}catch{}}return null}var LE={};function ab(t,e){if(t=t.contextTypes,!t)return LE;var n={},r;for(r in t)n[r]=e[r];return n}var ja=null;function Jp(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Be(401))}else{if(n===null)throw Error(Be(401));Jp(t,n)}e.context._currentValue2=e.value}}function FE(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&FE(t)}function BE(t){var e=t.parent;e!==null&&BE(e),t.context._currentValue2=t.value}function UE(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(Be(402));t.depth===e.depth?Jp(t,e):UE(t,e)}function VE(t,e){var n=e.parent;if(n===null)throw Error(Be(402));t.depth===n.depth?Jp(t,n):VE(t,n),e.context._currentValue2=e.value}function qf(t){var e=ja;e!==t&&(e===null?BE(t):t===null?FE(e):e.depth===t.depth?Jp(e,t):e.depth>t.depth?UE(e,t):VE(e,t),ja=t)}var cb={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function lb(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=cb,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue2:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:zu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&cb.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=zu({},o,a)):zu(o,a))}t.state=o}else o.queue=null}var C2={id:1,overflow:""};function Uv(t,e,n){var r=t.id;t=t.overflow;var i=32-tf(r)-1;r&=~(1<<i),n+=1;var o=32-tf(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-tf(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var tf=Math.clz32?Math.clz32:b2,I2=Math.log,S2=Math.LN2;function b2(t){return t>>>=0,t===0?32:31-(I2(t)/S2|0)|0}function w2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var A2=typeof Object.is=="function"?Object.is:w2,ms=null,aC=null,nf=null,yt=null,Tu=!1,ep=!1,yd=0,Ks=null,Yp=0;function Ma(){if(ms===null)throw Error(Be(321));return ms}function ub(){if(0<Yp)throw Error(Be(312));return{memoizedState:null,queue:null,next:null}}function cC(){return yt===null?nf===null?(Tu=!1,nf=yt=ub()):(Tu=!0,yt=nf):yt.next===null?(Tu=!1,yt=yt.next=ub()):(Tu=!0,yt=yt.next),yt}function lC(){aC=ms=null,ep=!1,nf=null,Yp=0,yt=Ks=null}function GE(t,e){return typeof e=="function"?e(t):e}function db(t,e,n){if(ms=Ma(),yt=cC(),Tu){var r=yt.queue;if(e=r.dispatch,Ks!==null&&(n=Ks.get(r),n!==void 0)){Ks.delete(r),r=yt.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return yt.memoizedState=r,[r,e]}return[yt.memoizedState,e]}return t=t===GE?typeof e=="function"?e():e:n!==void 0?n(e):e,yt.memoizedState=t,t=yt.queue={last:null,dispatch:null},t=t.dispatch=k2.bind(null,ms,t),[yt.memoizedState,t]}function hb(t,e){if(ms=Ma(),yt=cC(),e=e===void 0?null:e,yt!==null){var n=yt.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!A2(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),yt.memoizedState=[t,e],t}function k2(t,e,n){if(25<=Yp)throw Error(Be(301));if(t===ms)if(ep=!0,t={action:n,next:null},Ks===null&&(Ks=new Map),n=Ks.get(e),n===void 0)Ks.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function E2(){throw Error(Be(394))}function kh(){}var fb={readContext:function(t){return t._currentValue2},useContext:function(t){return Ma(),t._currentValue2},useMemo:hb,useReducer:db,useRef:function(t){ms=Ma(),yt=cC();var e=yt.memoizedState;return e===null?(t={current:t},yt.memoizedState=t):e},useState:function(t){return db(GE,t)},useInsertionEffect:kh,useLayoutEffect:function(){},useCallback:function(t,e){return hb(function(){return t},e)},useImperativeHandle:kh,useEffect:kh,useDebugValue:kh,useDeferredValue:function(t){return Ma(),t},useTransition:function(){return Ma(),[!1,E2]},useId:function(){var t=aC.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-tf(t)-1)).toString(32)+e;var n=rf;if(n===null)throw Error(Be(404));return e=yd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return Ma(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Be(407));return n()}},rf=null,tm=wE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function T2(t){return console.error(t),null}function Ru(){}function R2(t,e,n,r,i,o,s,a,c){var l=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?T2:i,onAllReady:Ru,onShellReady:s===void 0?Ru:s,onShellError:Ru,onFatalError:Ru},n=tp(e,0,null,n,!1,!1),n.parentFlushed=!0,t=uC(e,t,null,n,u,LE,null,C2),l.push(t),e}function uC(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var c={node:e,ping:function(){var l=t.pingedTasks;l.push(c),l.length===1&&ZE(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(c),c}function tp(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Cd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function np(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function pb(t,e,n,r,i){for(ms={},aC=e,yd=0,t=n(r,i);ep;)ep=!1,yd=0,Yp+=1,yt=null,t=n(r,i);return lC(),t}function gb(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(Be(108,Bv(r)||"Unknown",a));r=zu({},s,n)}e.legacyContext=r,Mr(t,e,i),e.legacyContext=s}else Mr(t,e,i)}function mb(t,e){if(t&&t.defaultProps){e=zu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Vv(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=ab(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue2:i),lb(o,n,r,i),gb(t,e,o,n)}else{o=ab(n,e.legacyContext),i=pb(t,e,n,r,o);var s=yd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)lb(i,n,r,o),gb(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=Uv(r,1,0);try{Mr(t,e,i)}finally{e.treeContext=r}}else Mr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=l2(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=s2(s,n,r),Gv(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case v2:case m2:case RE:case xE:case TE:Mr(t,e,r.children);return;case ME:Mr(t,e,r.children);return;case g2:throw Error(Be(343));case OE:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},c=tp(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=tp(t,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=l;try{if(Gv(t,e,r),t.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),l.status=1,rp(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=Cd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=uC(t,o,n,c,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case _E:if(r=pb(t,e,n.render,r,i),yd!==0){n=e.treeContext,e.treeContext=Uv(n,1,0);try{Mr(t,e,r)}finally{e.treeContext=n}}else Mr(t,e,r);return;case DE:n=n.type,r=mb(n,r),Vv(t,e,n,r,i);return;case PE:if(i=r.children,n=n._context,r=r.value,o=n._currentValue2,n._currentValue2=r,s=ja,ja=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Mr(t,e,i),t=ja,t===null)throw Error(Be(403));r=t.parentValue,t.context._currentValue2=r===y2?t.context._defaultValue:r,t=ja=t.parent,e.context=t;return;case NE:r=r.children,r=r(n._currentValue2),Mr(t,e,r);return;case sC:i=n._init,n=i(n._payload),r=mb(n,r),Vv(t,e,n,r,void 0);return}throw Error(Be(130,n==null?n:typeof n,""))}}function Mr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case p2:Vv(t,e,n.type,n.props,n.ref);return;case EE:throw Error(Be(257));case sC:var r=n._init;n=r(n._payload),Mr(t,e,n);return}if(Fv(n)){vb(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=sb&&n[sb]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);vb(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(Be(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=ob(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=ob(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function vb(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=Uv(o,r,i);try{Gv(t,e,n[i])}finally{e.treeContext=o}}}function Gv(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Mr(t,e,n)}catch(c){if(lC(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var s=e.blockedSegment,a=tp(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=uC(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,qf(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,qf(o),c}}function x2(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,jE(this,e,t)}function WE(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(Be(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return WE(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function rp(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&rp(t,n)}else t.completedSegments.push(e)}function jE(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(Be(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=Ru,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&rp(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(x2,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(rp(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function ZE(t){if(t.status!==2){var e=ja,n=tm.current;tm.current=fb;var r=rf;rf=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,c=s.blockedSegment;if(c.status===0){qf(s.context);try{Mr(a,s,s.node),a.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),s.abortSet.delete(s),c.status=1,jE(a,s.blockedBoundary,c)}catch(p){if(lC(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=s.ping;p.then(l,l)}else{s.abortSet.delete(s),c.status=4;var u=s.blockedBoundary,d=p,h=Cd(a,d);if(u===null?np(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=h,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var f=a.onAllReady;f()}}}finally{}}}i.splice(0,o),t.destination!==null&&dC(t,t.destination)}catch(p){Cd(t,p),np(t,p)}finally{rf=r,tm.current=n,n===fb&&qf(e)}}}function Eh(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)e.push(r[o]);i=Qp(t,e,i)}for(;o<r.length-1;o++)e.push(r[o]);return o<r.length&&(i=e.push(r[o])),i;default:throw Error(Be(390))}}function Qp(t,e,n){var r=n.boundary;if(r===null)return Eh(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)return t.responseState.generateStaticMarkup||(r=r.errorDigest,e.push("<!--$!-->"),e.push("<template"),r&&(e.push(' data-dgst="'),r=qn(r),e.push(r),e.push('"')),e.push("></template>")),Eh(t,e,n),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;return i=i.boundaryPrefix+o.toString(16),r=r.id=i,ib(e,t.responseState,r),Eh(t,e,n),e.push("<!--/$-->")}if(r.byteSize>t.progressiveChunkSize)return r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),ib(e,t.responseState,r.id),Eh(t,e,n),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(Be(391));return Qp(t,e,n[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function yb(t,e,n){return u2(e,t.responseState,n.formatContext,n.id),Qp(t,e,n),d2(e,n.formatContext)}function Cb(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)HE(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(Be(395));return n=n.toString(16),e.push(r),e.push('","'),e.push(t.segmentPrefix),e.push(n),e.push('")<\/script>')}function HE(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Be(392));return yb(t,e,r)}return yb(t,e,r),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),i=i.toString(16),e.push(i),e.push('","'),e.push(t.placeholderPrefix),e.push(i),e.push('")<\/script>')}function dC(t,e){try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){Qp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)e.push(r[n]);n<r.length&&e.push(r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,c=s.id,l=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),c===null)throw Error(Be(395));if(r.push(c),r.push('"'),l||u||d){r.push(",");var h=em(l||"");r.push(h)}if(u||d){r.push(",");var f=em(u||"");r.push(f)}if(d){r.push(",");var p=em(d);r.push(p)}if(!r.push(")<\/script>")){t.destination=null,o++,i.splice(0,o);return}}i.splice(0,o);var m=t.completedBoundaries;for(o=0;o<m.length;o++)if(!Cb(t,e,m[o])){t.destination=null,o++,m.splice(0,o);return}m.splice(0,o);var C=t.partialBoundaries;for(o=0;o<C.length;o++){var g=C[o];e:{i=t,s=e;var v=g.completedSegments;for(a=0;a<v.length;a++)if(!HE(i,s,g,v[a])){a++,v.splice(0,a);var S=!1;break e}v.splice(0,a),S=!0}if(!S){t.destination=null,o++,C.splice(0,o);return}}C.splice(0,o);var k=t.completedBoundaries;for(o=0;o<k.length;o++)if(!Cb(t,e,k[o])){t.destination=null,o++,k.splice(0,o);return}k.splice(0,o)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function P2(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return WE(r,t,e)}),n.clear(),t.destination!==null&&dC(t,t.destination)}catch(r){Cd(t,r),np(t,r)}}function N2(){}function zE(t,e,n,r){var i=!1,o=null,s="",a={push:function(l){return l!==null&&(s+=l),!0},destroy:function(l){i=!0,o=l}},c=!1;if(t=R2(t,f2(n,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,N2,void 0,function(){c=!0}),ZE(t),P2(t,r),t.status===1)t.status=2,a.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=a;try{dC(t,a)}catch(l){Cd(t,l),np(t,l)}}if(i)throw o;if(!c)throw Error(Be(426));return s}Ol.renderToNodeStream=function(){throw Error(Be(207))};Ol.renderToStaticMarkup=function(t,e){return zE(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Ol.renderToStaticNodeStream=function(){throw Error(Be(208))};Ol.renderToString=function(t,e){return zE(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Ol.version="18.3.1";var hC={},XE=b;function je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dr=null,Lr=0;function Te(t,e){if(e.length!==0)if(512<e.length)0<Lr&&(t.enqueue(new Uint8Array(Dr.buffer,0,Lr)),Dr=new Uint8Array(512),Lr=0),t.enqueue(e);else{var n=Dr.length-Lr;n<e.length&&(n===0?t.enqueue(Dr):(Dr.set(e.subarray(0,n),Lr),t.enqueue(Dr),e=e.subarray(n)),Dr=new Uint8Array(512),Lr=0),Dr.set(e,Lr),Lr+=e.length}}function Rt(t,e){return Te(t,e),!0}function Ib(t){Dr&&0<Lr&&(t.enqueue(new Uint8Array(Dr.buffer,0,Lr)),Dr=null,Lr=0)}var $E=new TextEncoder;function Ze(t){return $E.encode(t)}function pe(t){return $E.encode(t)}function KE(t,e){typeof t.error=="function"?t.error(e):t.close()}var fr=Object.prototype.hasOwnProperty,_2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sb={},bb={};function JE(t){return fr.call(bb,t)?!0:fr.call(Sb,t)?!1:_2.test(t)?bb[t]=!0:(Sb[t]=!0,!1)}function cr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Mn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Mn[t]=new cr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Mn[e]=new cr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Mn[t]=new cr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Mn[t]=new cr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Mn[t]=new cr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Mn[t]=new cr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Mn[t]=new cr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Mn[t]=new cr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Mn[t]=new cr(t,5,!1,t.toLowerCase(),null,!1,!1)});var fC=/[\-:]([a-z])/g;function pC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fC,pC);Mn[e]=new cr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fC,pC);Mn[e]=new cr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fC,pC);Mn[e]=new cr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Mn[t]=new cr(t,1,!1,t.toLowerCase(),null,!1,!1)});Mn.xlinkHref=new cr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Mn[t]=new cr(t,1,!1,t.toLowerCase(),null,!0,!0)});var of={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},O2=["Webkit","ms","Moz","O"];Object.keys(of).forEach(function(t){O2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),of[e]=of[t]})});var M2=/["'&<>]/;function Rn(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=M2.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var D2=/([A-Z])/g,L2=/^ms-/,Wv=Array.isArray,F2=pe("<script>"),B2=pe("<\/script>"),U2=pe('<script src="'),V2=pe('<script type="module" src="'),wb=pe('" async=""><\/script>'),G2=/(<\/|<)(s)(cript)/gi;function W2(t,e,n,r){return""+e+(n==="s"?"\\u0073":"\\u0053")+r}function j2(t,e,n,r,i){t=t===void 0?"":t,e=e===void 0?F2:pe('<script nonce="'+Rn(e)+'">');var o=[];if(n!==void 0&&o.push(e,Ze((""+n).replace(G2,W2)),B2),r!==void 0)for(n=0;n<r.length;n++)o.push(U2,Ze(Rn(r[n])),wb);if(i!==void 0)for(r=0;r<i.length;r++)o.push(V2,Ze(Rn(i[r])),wb);return{bootstrapChunks:o,startInlineScript:e,placeholderPrefix:pe(t+"P:"),segmentPrefix:pe(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function zi(t,e){return{insertionMode:t,selectedValue:e}}function Z2(t){return zi(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function H2(t,e,n){switch(e){case"select":return zi(1,n.value!=null?n.value:n.defaultValue);case"svg":return zi(2,null);case"math":return zi(3,null);case"foreignObject":return zi(1,null);case"table":return zi(4,null);case"thead":case"tbody":case"tfoot":return zi(5,null);case"colgroup":return zi(7,null);case"tr":return zi(6,null)}return 4<=t.insertionMode||t.insertionMode===0?zi(1,null):t}var gC=pe("<!-- -->");function Ab(t,e,n,r){return e===""?r:(r&&t.push(gC),t.push(Ze(Rn(e))),!0)}var kb=new Map,z2=pe(' style="'),Eb=pe(":"),X2=pe(";");function YE(t,e,n){if(typeof n!="object")throw Error(je(62));e=!0;for(var r in n)if(fr.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Ze(Rn(r));i=Ze(Rn((""+i).trim()))}else{o=r;var s=kb.get(o);s!==void 0||(s=pe(Rn(o.replace(D2,"-$1").toLowerCase().replace(L2,"-ms-"))),kb.set(o,s)),o=s,i=typeof i=="number"?i===0||fr.call(of,r)?Ze(""+i):Ze(i+"px"):Ze(Rn((""+i).trim()))}e?(e=!1,t.push(z2,o,Eb,i)):t.push(X2,o,Eb,i)}}e||t.push(Da)}var Ms=pe(" "),xc=pe('="'),Da=pe('"'),Tb=pe('=""');function Tr(t,e,n,r){switch(n){case"style":YE(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Mn.hasOwnProperty(n)?Mn[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=Ze(e.attributeName),e.type){case 3:r&&t.push(Ms,n,Tb);break;case 4:r===!0?t.push(Ms,n,Tb):r!==!1&&t.push(Ms,n,xc,Ze(Rn(r)),Da);break;case 5:isNaN(r)||t.push(Ms,n,xc,Ze(Rn(r)),Da);break;case 6:!isNaN(r)&&1<=r&&t.push(Ms,n,xc,Ze(Rn(r)),Da);break;default:e.sanitizeURL&&(r=""+r),t.push(Ms,n,xc,Ze(Rn(r)),Da)}}else if(JE(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(Ms,Ze(n),xc,Ze(Rn(r)),Da)}}}var Ds=pe(">"),Rb=pe("/>");function sf(t,e,n){if(e!=null){if(n!=null)throw Error(je(60));if(typeof e!="object"||!("__html"in e))throw Error(je(61));e=e.__html,e!=null&&t.push(Ze(""+e))}}function $2(t){var e="";return XE.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var nm=pe(' selected=""');function rm(t,e,n,r){t.push(Xi(n));var i=n=null,o;for(o in e)if(fr.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Tr(t,r,o,s)}}return t.push(Ds),sf(t,i,n),typeof n=="string"?(t.push(Ze(Rn(n))),null):n}var im=pe(`
`),K2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,xb=new Map;function Xi(t){var e=xb.get(t);if(e===void 0){if(!K2.test(t))throw Error(je(65,t));e=pe("<"+t),xb.set(t,e)}return e}var J2=pe("<!DOCTYPE html>");function Y2(t,e,n,r,i){switch(e){case"select":t.push(Xi("select"));var o=null,s=null;for(u in n)if(fr.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Tr(t,r,u,a)}}return t.push(Ds),sf(t,s,o),o;case"option":s=i.selectedValue,t.push(Xi("option"));var c=a=null,l=null,u=null;for(o in n)if(fr.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:Tr(t,r,o,d)}}if(s!=null)if(n=c!==null?""+c:$2(a),Wv(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(nm);break}}else""+s===n&&t.push(nm);else l&&t.push(nm);return t.push(Ds),sf(t,u,a),a;case"textarea":t.push(Xi("textarea")),u=s=o=null;for(a in n)if(fr.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":o=c;break;case"defaultValue":s=c;break;case"dangerouslySetInnerHTML":throw Error(je(91));default:Tr(t,r,a,c)}if(o===null&&s!==null&&(o=s),t.push(Ds),u!=null){if(o!=null)throw Error(je(92));if(Wv(u)&&1<u.length)throw Error(je(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(im),o!==null&&t.push(Ze(Rn(""+o))),null;case"input":t.push(Xi("input")),c=u=a=o=null;for(s in n)if(fr.call(n,s)&&(l=n[s],l!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":o=l;break;default:Tr(t,r,s,l)}return u!==null?Tr(t,r,"checked",u):c!==null&&Tr(t,r,"checked",c),o!==null?Tr(t,r,"value",o):a!==null&&Tr(t,r,"value",a),t.push(Rb),null;case"menuitem":t.push(Xi("menuitem"));for(var h in n)if(fr.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(je(400));default:Tr(t,r,h,o)}return t.push(Ds),null;case"title":t.push(Xi("title")),o=null;for(d in n)if(fr.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(je(434));default:Tr(t,r,d,s)}return t.push(Ds),o;case"listing":case"pre":t.push(Xi(e)),s=o=null;for(c in n)if(fr.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Tr(t,r,c,a)}if(t.push(Ds),s!=null){if(o!=null)throw Error(je(60));if(typeof s!="object"||!("__html"in s))throw Error(je(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(im,Ze(n)):t.push(Ze(""+n)))}return typeof o=="string"&&o[0]===`
`&&t.push(im),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(Xi(e));for(var f in n)if(fr.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,e));default:Tr(t,r,f,o)}return t.push(Rb),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return rm(t,n,e,r);case"html":return i.insertionMode===0&&t.push(J2),rm(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return rm(t,n,e,r);t.push(Xi(e)),s=o=null;for(l in n)if(fr.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":YE(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:JE(l)&&typeof a!="function"&&typeof a!="symbol"&&t.push(Ms,Ze(l),xc,Ze(Rn(a)),Da)}return t.push(Ds),sf(t,s,o),o}}var Q2=pe("</"),q2=pe(">"),eL=pe('<template id="'),tL=pe('"></template>'),nL=pe("<!--$-->"),rL=pe('<!--$?--><template id="'),iL=pe('"></template>'),oL=pe("<!--$!-->"),sL=pe("<!--/$-->"),aL=pe("<template"),cL=pe('"'),lL=pe(' data-dgst="');pe(' data-msg="');pe(' data-stck="');var uL=pe("></template>");function Pb(t,e,n){if(Te(t,rL),n===null)throw Error(je(395));return Te(t,n),Rt(t,iL)}var dL=pe('<div hidden id="'),hL=pe('">'),fL=pe("</div>"),pL=pe('<svg aria-hidden="true" style="display:none" id="'),gL=pe('">'),mL=pe("</svg>"),vL=pe('<math aria-hidden="true" style="display:none" id="'),yL=pe('">'),CL=pe("</math>"),IL=pe('<table hidden id="'),SL=pe('">'),bL=pe("</table>"),wL=pe('<table hidden><tbody id="'),AL=pe('">'),kL=pe("</tbody></table>"),EL=pe('<table hidden><tr id="'),TL=pe('">'),RL=pe("</tr></table>"),xL=pe('<table hidden><colgroup id="'),PL=pe('">'),NL=pe("</colgroup></table>");function _L(t,e,n,r){switch(n.insertionMode){case 0:case 1:return Te(t,dL),Te(t,e.segmentPrefix),Te(t,Ze(r.toString(16))),Rt(t,hL);case 2:return Te(t,pL),Te(t,e.segmentPrefix),Te(t,Ze(r.toString(16))),Rt(t,gL);case 3:return Te(t,vL),Te(t,e.segmentPrefix),Te(t,Ze(r.toString(16))),Rt(t,yL);case 4:return Te(t,IL),Te(t,e.segmentPrefix),Te(t,Ze(r.toString(16))),Rt(t,SL);case 5:return Te(t,wL),Te(t,e.segmentPrefix),Te(t,Ze(r.toString(16))),Rt(t,AL);case 6:return Te(t,EL),Te(t,e.segmentPrefix),Te(t,Ze(r.toString(16))),Rt(t,TL);case 7:return Te(t,xL),Te(t,e.segmentPrefix),Te(t,Ze(r.toString(16))),Rt(t,PL);default:throw Error(je(397))}}function OL(t,e){switch(e.insertionMode){case 0:case 1:return Rt(t,fL);case 2:return Rt(t,mL);case 3:return Rt(t,CL);case 4:return Rt(t,bL);case 5:return Rt(t,kL);case 6:return Rt(t,RL);case 7:return Rt(t,NL);default:throw Error(je(397))}}var ML=pe('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),DL=pe('$RS("'),LL=pe('","'),FL=pe('")<\/script>'),BL=pe('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),UL=pe('$RC("'),VL=pe('","'),GL=pe('")<\/script>'),WL=pe('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),jL=pe('$RX("'),ZL=pe('"'),HL=pe(")<\/script>"),om=pe(","),zL=/[<\u2028\u2029]/g;function sm(t){return JSON.stringify(t).replace(zL,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Xu=Object.assign,XL=Symbol.for("react.element"),QE=Symbol.for("react.portal"),qE=Symbol.for("react.fragment"),eT=Symbol.for("react.strict_mode"),tT=Symbol.for("react.profiler"),nT=Symbol.for("react.provider"),rT=Symbol.for("react.context"),iT=Symbol.for("react.forward_ref"),oT=Symbol.for("react.suspense"),sT=Symbol.for("react.suspense_list"),aT=Symbol.for("react.memo"),mC=Symbol.for("react.lazy"),$L=Symbol.for("react.scope"),KL=Symbol.for("react.debug_trace_mode"),JL=Symbol.for("react.legacy_hidden"),YL=Symbol.for("react.default_value"),Nb=Symbol.iterator;function jv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qE:return"Fragment";case QE:return"Portal";case tT:return"Profiler";case eT:return"StrictMode";case oT:return"Suspense";case sT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rT:return(t.displayName||"Context")+".Consumer";case nT:return(t._context.displayName||"Context")+".Provider";case iT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case aT:return e=t.displayName||null,e!==null?e:jv(t.type)||"Memo";case mC:e=t._payload,t=t._init;try{return jv(t(e))}catch{}}return null}var cT={};function _b(t,e){if(t=t.contextTypes,!t)return cT;var n={},r;for(r in t)n[r]=e[r];return n}var Za=null;function qp(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(je(401))}else{if(n===null)throw Error(je(401));qp(t,n)}e.context._currentValue=e.value}}function lT(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&lT(t)}function uT(t){var e=t.parent;e!==null&&uT(e),t.context._currentValue=t.value}function dT(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(je(402));t.depth===e.depth?qp(t,e):dT(t,e)}function hT(t,e){var n=e.parent;if(n===null)throw Error(je(402));t.depth===n.depth?qp(t,n):hT(t,n),e.context._currentValue=e.value}function ip(t){var e=Za;e!==t&&(e===null?uT(t):t===null?lT(e):e.depth===t.depth?qp(e,t):e.depth>t.depth?dT(e,t):hT(e,t),Za=t)}var Ob={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function Mb(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=Ob,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:Xu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&Ob.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=Xu({},o,a)):Xu(o,a))}t.state=o}else o.queue=null}var QL={id:1,overflow:""};function Zv(t,e,n){var r=t.id;t=t.overflow;var i=32-af(r)-1;r&=~(1<<i),n+=1;var o=32-af(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-af(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var af=Math.clz32?Math.clz32:tF,qL=Math.log,eF=Math.LN2;function tF(t){return t>>>=0,t===0?32:31-(qL(t)/eF|0)|0}function nF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rF=typeof Object.is=="function"?Object.is:nF,vs=null,vC=null,cf=null,Ct=null,xu=!1,op=!1,Id=0,Js=null,eg=0;function La(){if(vs===null)throw Error(je(321));return vs}function Db(){if(0<eg)throw Error(je(312));return{memoizedState:null,queue:null,next:null}}function yC(){return Ct===null?cf===null?(xu=!1,cf=Ct=Db()):(xu=!0,Ct=cf):Ct.next===null?(xu=!1,Ct=Ct.next=Db()):(xu=!0,Ct=Ct.next),Ct}function CC(){vC=vs=null,op=!1,cf=null,eg=0,Ct=Js=null}function fT(t,e){return typeof e=="function"?e(t):e}function Lb(t,e,n){if(vs=La(),Ct=yC(),xu){var r=Ct.queue;if(e=r.dispatch,Js!==null&&(n=Js.get(r),n!==void 0)){Js.delete(r),r=Ct.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return Ct.memoizedState=r,[r,e]}return[Ct.memoizedState,e]}return t=t===fT?typeof e=="function"?e():e:n!==void 0?n(e):e,Ct.memoizedState=t,t=Ct.queue={last:null,dispatch:null},t=t.dispatch=iF.bind(null,vs,t),[Ct.memoizedState,t]}function Fb(t,e){if(vs=La(),Ct=yC(),e=e===void 0?null:e,Ct!==null){var n=Ct.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!rF(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),Ct.memoizedState=[t,e],t}function iF(t,e,n){if(25<=eg)throw Error(je(301));if(t===vs)if(op=!0,t={action:n,next:null},Js===null&&(Js=new Map),n=Js.get(e),n===void 0)Js.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function oF(){throw Error(je(394))}function Th(){}var Bb={readContext:function(t){return t._currentValue},useContext:function(t){return La(),t._currentValue},useMemo:Fb,useReducer:Lb,useRef:function(t){vs=La(),Ct=yC();var e=Ct.memoizedState;return e===null?(t={current:t},Ct.memoizedState=t):e},useState:function(t){return Lb(fT,t)},useInsertionEffect:Th,useLayoutEffect:function(){},useCallback:function(t,e){return Fb(function(){return t},e)},useImperativeHandle:Th,useEffect:Th,useDebugValue:Th,useDeferredValue:function(t){return La(),t},useTransition:function(){return La(),[!1,oF]},useId:function(){var t=vC.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-af(t)-1)).toString(32)+e;var n=lf;if(n===null)throw Error(je(404));return e=Id++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return La(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(je(407));return n()}},lf=null,am=XE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function sF(t){return console.error(t),null}function Pu(){}function aF(t,e,n,r,i,o,s,a,c){var l=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?sF:i,onAllReady:o===void 0?Pu:o,onShellReady:s===void 0?Pu:s,onShellError:a===void 0?Pu:a,onFatalError:c===void 0?Pu:c},n=sp(e,0,null,n,!1,!1),n.parentFlushed=!0,t=IC(e,t,null,n,u,cT,null,QL),l.push(t),e}function IC(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var c={node:e,ping:function(){var l=t.pingedTasks;l.push(c),l.length===1&&mT(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(c),c}function sp(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Sd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function ap(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,KE(t.destination,e)):(t.status=1,t.fatalError=e)}function Ub(t,e,n,r,i){for(vs={},vC=e,Id=0,t=n(r,i);op;)op=!1,Id=0,eg+=1,Ct=null,t=n(r,i);return CC(),t}function Vb(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(je(108,jv(r)||"Unknown",a));r=Xu({},s,n)}e.legacyContext=r,Fr(t,e,i),e.legacyContext=s}else Fr(t,e,i)}function Gb(t,e){if(t&&t.defaultProps){e=Xu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Hv(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=_b(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue:i),Mb(o,n,r,i),Vb(t,e,o,n)}else{o=_b(n,e.legacyContext),i=Ub(t,e,n,r,o);var s=Id!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)Mb(i,n,r,o),Vb(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=Zv(r,1,0);try{Fr(t,e,i)}finally{e.treeContext=r}}else Fr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=Y2(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=H2(s,n,r),zv(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(Q2,Ze(n),q2)}i.lastPushedText=!1}else{switch(n){case JL:case KL:case eT:case tT:case qE:Fr(t,e,r.children);return;case sT:Fr(t,e,r.children);return;case $L:throw Error(je(343));case oT:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},c=sp(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=sp(t,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=l;try{if(zv(t,e,r),l.lastPushedText&&l.textEmbedded&&l.chunks.push(gC),l.status=1,cp(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=Sd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=IC(t,o,n,c,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case iT:if(r=Ub(t,e,n.render,r,i),Id!==0){n=e.treeContext,e.treeContext=Zv(n,1,0);try{Fr(t,e,r)}finally{e.treeContext=n}}else Fr(t,e,r);return;case aT:n=n.type,r=Gb(n,r),Hv(t,e,n,r,i);return;case nT:if(i=r.children,n=n._context,r=r.value,o=n._currentValue,n._currentValue=r,s=Za,Za=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Fr(t,e,i),t=Za,t===null)throw Error(je(403));r=t.parentValue,t.context._currentValue=r===YL?t.context._defaultValue:r,t=Za=t.parent,e.context=t;return;case rT:r=r.children,r=r(n._currentValue),Fr(t,e,r);return;case mC:i=n._init,n=i(n._payload),r=Gb(n,r),Hv(t,e,n,r,void 0);return}throw Error(je(130,n==null?n:typeof n,""))}}function Fr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case XL:Hv(t,e,n.type,n.props,n.ref);return;case QE:throw Error(je(257));case mC:var r=n._init;n=r(n._payload),Fr(t,e,n);return}if(Wv(n)){Wb(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=Nb&&n[Nb]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);Wb(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(je(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=Ab(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=Ab(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function Wb(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=Zv(o,r,i);try{zv(t,e,n[i])}finally{e.treeContext=o}}}function zv(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Fr(t,e,n)}catch(c){if(CC(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var s=e.blockedSegment,a=sp(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=IC(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,ip(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,ip(o),c}}function cF(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,gT(this,e,t)}function pT(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(je(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return pT(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function cp(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&cp(t,n)}else t.completedSegments.push(e)}function gT(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(je(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=Pu,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&cp(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(cF,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(cp(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function mT(t){if(t.status!==2){var e=Za,n=am.current;am.current=Bb;var r=lf;lf=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,c=s.blockedSegment;if(c.status===0){ip(s.context);try{Fr(a,s,s.node),c.lastPushedText&&c.textEmbedded&&c.chunks.push(gC),s.abortSet.delete(s),c.status=1,gT(a,s.blockedBoundary,c)}catch(p){if(CC(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=s.ping;p.then(l,l)}else{s.abortSet.delete(s),c.status=4;var u=s.blockedBoundary,d=p,h=Sd(a,d);if(u===null?ap(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=h,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var f=a.onAllReady;f()}}}finally{}}}i.splice(0,o),t.destination!==null&&SC(t,t.destination)}catch(p){Sd(t,p),ap(t,p)}finally{lf=r,am.current=n,n===Bb&&ip(e)}}}function Rh(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,Te(e,eL),Te(e,t.placeholderPrefix),t=Ze(r.toString(16)),Te(e,t),Rt(e,tL);case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)Te(e,r[o]);i=tg(t,e,i)}for(;o<r.length-1;o++)Te(e,r[o]);return o<r.length&&(i=Rt(e,r[o])),i;default:throw Error(je(390))}}function tg(t,e,n){var r=n.boundary;if(r===null)return Rh(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,Rt(e,oL),Te(e,aL),r&&(Te(e,lL),Te(e,Ze(Rn(r))),Te(e,cL)),Rt(e,uL),Rh(t,e,n);else if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;i=pe(i.boundaryPrefix+o.toString(16)),r=r.id=i,Pb(e,t.responseState,r),Rh(t,e,n)}else if(r.byteSize>t.progressiveChunkSize)r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),Pb(e,t.responseState,r.id),Rh(t,e,n);else{if(Rt(e,nL),n=r.completedSegments,n.length!==1)throw Error(je(391));tg(t,e,n[0])}return Rt(e,sL)}function jb(t,e,n){return _L(e,t.responseState,n.formatContext,n.id),tg(t,e,n),OL(e,n.formatContext)}function Zb(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)vT(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,Te(e,t.startInlineScript),t.sentCompleteBoundaryFunction?Te(e,UL):(t.sentCompleteBoundaryFunction=!0,Te(e,BL)),r===null)throw Error(je(395));return n=Ze(n.toString(16)),Te(e,r),Te(e,VL),Te(e,t.segmentPrefix),Te(e,n),Rt(e,GL)}function vT(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(je(392));return jb(t,e,r)}return jb(t,e,r),t=t.responseState,Te(e,t.startInlineScript),t.sentCompleteSegmentFunction?Te(e,DL):(t.sentCompleteSegmentFunction=!0,Te(e,ML)),Te(e,t.segmentPrefix),i=Ze(i.toString(16)),Te(e,i),Te(e,LL),Te(e,t.placeholderPrefix),Te(e,i),Rt(e,FL)}function SC(t,e){Dr=new Uint8Array(512),Lr=0;try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){tg(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)Te(e,r[n]);n<r.length&&Rt(e,r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,c=s.id,l=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(Te(r,a.startInlineScript),a.sentClientRenderFunction?Te(r,jL):(a.sentClientRenderFunction=!0,Te(r,WL)),c===null)throw Error(je(395));Te(r,c),Te(r,ZL),(l||u||d)&&(Te(r,om),Te(r,Ze(sm(l||"")))),(u||d)&&(Te(r,om),Te(r,Ze(sm(u||"")))),d&&(Te(r,om),Te(r,Ze(sm(d)))),Rt(r,HL)}i.splice(0,o);var h=t.completedBoundaries;for(o=0;o<h.length;o++)Zb(t,e,h[o]);h.splice(0,o),Ib(e),Dr=new Uint8Array(512),Lr=0;var f=t.partialBoundaries;for(o=0;o<f.length;o++){var p=f[o];e:{i=t,s=e;var m=p.completedSegments;for(a=0;a<m.length;a++)if(!vT(i,s,p,m[a])){a++,m.splice(0,a);var C=!1;break e}m.splice(0,a),C=!0}if(!C){t.destination=null,o++,f.splice(0,o);return}}f.splice(0,o);var g=t.completedBoundaries;for(o=0;o<g.length;o++)Zb(t,e,g[o]);g.splice(0,o)}finally{Ib(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function Hb(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return pT(r,t,e)}),n.clear(),t.destination!==null&&SC(t,t.destination)}catch(r){Sd(t,r),ap(t,r)}}hC.renderToReadableStream=function(t,e){return new Promise(function(n,r){var i,o,s=new Promise(function(u,d){o=u,i=d}),a=aF(t,j2(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),Z2(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,KE(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{SC(a,d)}catch(h){Sd(a,h),ap(a,h)}}},cancel:function(){Hb(a)}},{highWaterMark:0});u.allReady=s,n(u)},function(u){s.catch(function(){}),r(u)},i);if(e&&e.signal){var c=e.signal,l=function(){Hb(a,c.reason),c.removeEventListener("abort",l)};c.addEventListener("abort",l)}mT(a)})};hC.version="18.3.1";var Ml,yT;Ml=Ol,yT=hC;ga.version=Ml.version;ga.renderToString=Ml.renderToString;ga.renderToStaticMarkup=Ml.renderToStaticMarkup;ga.renderToNodeStream=Ml.renderToNodeStream;ga.renderToStaticNodeStream=Ml.renderToStaticNodeStream;ga.renderToReadableStream=yT.renderToReadableStream;/*! @license DOMPurify 3.1.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.7/LICENSE */const{entries:CT,setPrototypeOf:zb,isFrozen:lF,getPrototypeOf:uF,getOwnPropertyDescriptor:dF}=Object;let{freeze:ir,seal:si,create:IT}=Object,{apply:Xv,construct:$v}=typeof Reflect<"u"&&Reflect;ir||(ir=function(e){return e});si||(si=function(e){return e});Xv||(Xv=function(e,n,r){return e.apply(n,r)});$v||($v=function(e,n){return new e(...n)});const xh=Hr(Array.prototype.forEach),Xb=Hr(Array.prototype.pop),uu=Hr(Array.prototype.push),uf=Hr(String.prototype.toLowerCase),cm=Hr(String.prototype.toString),$b=Hr(String.prototype.match),du=Hr(String.prototype.replace),hF=Hr(String.prototype.indexOf),fF=Hr(String.prototype.trim),ui=Hr(Object.prototype.hasOwnProperty),Xn=Hr(RegExp.prototype.test),hu=pF(TypeError);function Hr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Xv(t,e,r)}}function pF(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return $v(t,n)}}function He(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uf;zb&&zb(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(lF(e)||(e[r]=o),i=o)}t[i]=!0}return t}function gF(t){for(let e=0;e<t.length;e++)ui(t,e)||(t[e]=null);return t}function Na(t){const e=IT(null);for(const[n,r]of CT(t))ui(t,n)&&(Array.isArray(r)?e[n]=gF(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Na(r):e[n]=r);return e}function fu(t,e){for(;t!==null;){const r=dF(t,e);if(r){if(r.get)return Hr(r.get);if(typeof r.value=="function")return Hr(r.value)}t=uF(t)}function n(){return null}return n}const Kb=ir(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),lm=ir(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),um=ir(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),mF=ir(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),dm=ir(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),vF=ir(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Jb=ir(["#text"]),Yb=ir(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),hm=ir(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Qb=ir(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ph=ir(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),yF=si(/\{\{[\w\W]*|[\w\W]*\}\}/gm),CF=si(/<%[\w\W]*|[\w\W]*%>/gm),IF=si(/\${[\w\W]*}/gm),SF=si(/^data-[\-\w.\u00B7-\uFFFF]/),bF=si(/^aria-[\-\w]+$/),ST=si(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wF=si(/^(?:\w+script|data):/i),AF=si(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),bT=si(/^html$/i),kF=si(/^[a-z][.\w]*(-[.\w]+)+$/i);var qb=Object.freeze({__proto__:null,MUSTACHE_EXPR:yF,ERB_EXPR:CF,TMPLIT_EXPR:IF,DATA_ATTR:SF,ARIA_ATTR:bF,IS_ALLOWED_URI:ST,IS_SCRIPT_OR_DATA:wF,ATTR_WHITESPACE:AF,DOCTYPE_NAME:bT,CUSTOM_ELEMENT:kF});const pu={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},EF=function(){return typeof window>"u"?null:window},TF=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function wT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:EF();const e=le=>wT(le);if(e.version="3.1.7",e.removed=[],!t||!t.document||t.document.nodeType!==pu.document)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:c,NodeFilter:l,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:f}=t,p=c.prototype,m=fu(p,"cloneNode"),C=fu(p,"remove"),g=fu(p,"nextSibling"),v=fu(p,"childNodes"),S=fu(p,"parentNode");if(typeof s=="function"){const le=n.createElement("template");le.content&&le.content.ownerDocument&&(n=le.content.ownerDocument)}let k,w="";const{implementation:A,createNodeIterator:x,createDocumentFragment:T,getElementsByTagName:_}=n,{importNode:O}=r;let L={};e.isSupported=typeof CT=="function"&&typeof S=="function"&&A&&A.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:z,TMPLIT_EXPR:Z,DATA_ATTR:J,ARIA_ATTR:ee,IS_SCRIPT_OR_DATA:re,ATTR_WHITESPACE:X,CUSTOM_ELEMENT:$}=qb;let{IS_ALLOWED_URI:ie}=qb,j=null;const oe=He({},[...Kb,...lm,...um,...dm,...Jb]);let ke=null;const Le=He({},[...Yb,...hm,...Qb,...Ph]);let de=Object.seal(IT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,Ye=null,ve=!0,rn=!0,Sn=!1,st=!0,vt=!1,bn=!0,on=!1,ue=!1,be=!1,Ge=!1,Ve=!1,Me=!1,qe=!0,Bt=!1;const Mt="user-content-";let Wt=!0,wn=!1,$t={},ur=null;const E=He({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let y=null;const I=He({},["audio","video","img","source","image","track"]);let P=null;const F=He({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),W="http://www.w3.org/1998/Math/MathML",Q="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml";let rt=_e,ot=!1,at=null;const Qe=He({},[W,Q,_e],cm);let Ts=null;const Kl=["application/xhtml+xml","text/html"],Jl="text/html";let Kt=null,To=null;const Sg=n.createElement("form"),Yl=function(M){return M instanceof RegExp||M instanceof Function},Rs=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(To&&To===M)){if((!M||typeof M!="object")&&(M={}),M=Na(M),Ts=Kl.indexOf(M.PARSER_MEDIA_TYPE)===-1?Jl:M.PARSER_MEDIA_TYPE,Kt=Ts==="application/xhtml+xml"?cm:uf,j=ui(M,"ALLOWED_TAGS")?He({},M.ALLOWED_TAGS,Kt):oe,ke=ui(M,"ALLOWED_ATTR")?He({},M.ALLOWED_ATTR,Kt):Le,at=ui(M,"ALLOWED_NAMESPACES")?He({},M.ALLOWED_NAMESPACES,cm):Qe,P=ui(M,"ADD_URI_SAFE_ATTR")?He(Na(F),M.ADD_URI_SAFE_ATTR,Kt):F,y=ui(M,"ADD_DATA_URI_TAGS")?He(Na(I),M.ADD_DATA_URI_TAGS,Kt):I,ur=ui(M,"FORBID_CONTENTS")?He({},M.FORBID_CONTENTS,Kt):E,Pe=ui(M,"FORBID_TAGS")?He({},M.FORBID_TAGS,Kt):{},Ye=ui(M,"FORBID_ATTR")?He({},M.FORBID_ATTR,Kt):{},$t=ui(M,"USE_PROFILES")?M.USE_PROFILES:!1,ve=M.ALLOW_ARIA_ATTR!==!1,rn=M.ALLOW_DATA_ATTR!==!1,Sn=M.ALLOW_UNKNOWN_PROTOCOLS||!1,st=M.ALLOW_SELF_CLOSE_IN_ATTR!==!1,vt=M.SAFE_FOR_TEMPLATES||!1,bn=M.SAFE_FOR_XML!==!1,on=M.WHOLE_DOCUMENT||!1,Ge=M.RETURN_DOM||!1,Ve=M.RETURN_DOM_FRAGMENT||!1,Me=M.RETURN_TRUSTED_TYPE||!1,be=M.FORCE_BODY||!1,qe=M.SANITIZE_DOM!==!1,Bt=M.SANITIZE_NAMED_PROPS||!1,Wt=M.KEEP_CONTENT!==!1,wn=M.IN_PLACE||!1,ie=M.ALLOWED_URI_REGEXP||ST,rt=M.NAMESPACE||_e,de=M.CUSTOM_ELEMENT_HANDLING||{},M.CUSTOM_ELEMENT_HANDLING&&Yl(M.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(de.tagNameCheck=M.CUSTOM_ELEMENT_HANDLING.tagNameCheck),M.CUSTOM_ELEMENT_HANDLING&&Yl(M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(de.attributeNameCheck=M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),M.CUSTOM_ELEMENT_HANDLING&&typeof M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(de.allowCustomizedBuiltInElements=M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),vt&&(rn=!1),Ve&&(Ge=!0),$t&&(j=He({},Jb),ke=[],$t.html===!0&&(He(j,Kb),He(ke,Yb)),$t.svg===!0&&(He(j,lm),He(ke,hm),He(ke,Ph)),$t.svgFilters===!0&&(He(j,um),He(ke,hm),He(ke,Ph)),$t.mathMl===!0&&(He(j,dm),He(ke,Qb),He(ke,Ph))),M.ADD_TAGS&&(j===oe&&(j=Na(j)),He(j,M.ADD_TAGS,Kt)),M.ADD_ATTR&&(ke===Le&&(ke=Na(ke)),He(ke,M.ADD_ATTR,Kt)),M.ADD_URI_SAFE_ATTR&&He(P,M.ADD_URI_SAFE_ATTR,Kt),M.FORBID_CONTENTS&&(ur===E&&(ur=Na(ur)),He(ur,M.FORBID_CONTENTS,Kt)),Wt&&(j["#text"]=!0),on&&He(j,["html","head","body"]),j.table&&(He(j,["tbody"]),delete Pe.tbody),M.TRUSTED_TYPES_POLICY){if(typeof M.TRUSTED_TYPES_POLICY.createHTML!="function")throw hu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof M.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw hu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=M.TRUSTED_TYPES_POLICY,w=k.createHTML("")}else k===void 0&&(k=TF(f,i)),k!==null&&typeof w=="string"&&(w=k.createHTML(""));ir&&ir(M),To=M}},Ta=He({},["mi","mo","mn","ms","mtext"]),oh=He({},["annotation-xml"]),bg=He({},["title","style","font","a","script"]),D=He({},[...lm,...um,...mF]),B=He({},[...dm,...vF]),H=function(M){let ae=S(M);(!ae||!ae.tagName)&&(ae={namespaceURI:rt,tagName:"template"});const Ce=uf(M.tagName),$e=uf(ae.tagName);return at[M.namespaceURI]?M.namespaceURI===Q?ae.namespaceURI===_e?Ce==="svg":ae.namespaceURI===W?Ce==="svg"&&($e==="annotation-xml"||Ta[$e]):!!D[Ce]:M.namespaceURI===W?ae.namespaceURI===_e?Ce==="math":ae.namespaceURI===Q?Ce==="math"&&oh[$e]:!!B[Ce]:M.namespaceURI===_e?ae.namespaceURI===Q&&!oh[$e]||ae.namespaceURI===W&&!Ta[$e]?!1:!B[Ce]&&(bg[Ce]||!D[Ce]):!!(Ts==="application/xhtml+xml"&&at[M.namespaceURI]):!1},q=function(M){uu(e.removed,{element:M});try{S(M).removeChild(M)}catch{C(M)}},me=function(M,ae){try{uu(e.removed,{attribute:ae.getAttributeNode(M),from:ae})}catch{uu(e.removed,{attribute:null,from:ae})}if(ae.removeAttribute(M),M==="is"&&!ke[M])if(Ge||Ve)try{q(ae)}catch{}else try{ae.setAttribute(M,"")}catch{}},Re=function(M){let ae=null,Ce=null;if(be)M="<remove></remove>"+M;else{const jt=$b(M,/^[\r\n\t ]+/);Ce=jt&&jt[0]}Ts==="application/xhtml+xml"&&rt===_e&&(M='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+M+"</body></html>");const $e=k?k.createHTML(M):M;if(rt===_e)try{ae=new h().parseFromString($e,Ts)}catch{}if(!ae||!ae.documentElement){ae=A.createDocument(rt,"template",null);try{ae.documentElement.innerHTML=ot?w:$e}catch{}}const gt=ae.body||ae.documentElement;return M&&Ce&&gt.insertBefore(n.createTextNode(Ce),gt.childNodes[0]||null),rt===_e?_.call(ae,on?"html":"body")[0]:on?ae.documentElement:gt},De=function(M){return x.call(M.ownerDocument||M,M,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},ye=function(M){return M instanceof d&&(typeof M.nodeName!="string"||typeof M.textContent!="string"||typeof M.removeChild!="function"||!(M.attributes instanceof u)||typeof M.removeAttribute!="function"||typeof M.setAttribute!="function"||typeof M.namespaceURI!="string"||typeof M.insertBefore!="function"||typeof M.hasChildNodes!="function")},we=function(M){return typeof a=="function"&&M instanceof a},fe=function(M,ae,Ce){L[M]&&xh(L[M],$e=>{$e.call(e,ae,Ce,To)})},xe=function(M){let ae=null;if(fe("beforeSanitizeElements",M,null),ye(M))return q(M),!0;const Ce=Kt(M.nodeName);if(fe("uponSanitizeElement",M,{tagName:Ce,allowedTags:j}),M.hasChildNodes()&&!we(M.firstElementChild)&&Xn(/<[/\w]/g,M.innerHTML)&&Xn(/<[/\w]/g,M.textContent)||M.nodeType===pu.progressingInstruction||bn&&M.nodeType===pu.comment&&Xn(/<[/\w]/g,M.data))return q(M),!0;if(!j[Ce]||Pe[Ce]){if(!Pe[Ce]&&Xe(Ce)&&(de.tagNameCheck instanceof RegExp&&Xn(de.tagNameCheck,Ce)||de.tagNameCheck instanceof Function&&de.tagNameCheck(Ce)))return!1;if(Wt&&!ur[Ce]){const $e=S(M)||M.parentNode,gt=v(M)||M.childNodes;if(gt&&$e){const jt=gt.length;for(let Yt=jt-1;Yt>=0;--Yt){const gn=m(gt[Yt],!0);gn.__removalCount=(M.__removalCount||0)+1,$e.insertBefore(gn,g(M))}}}return q(M),!0}return M instanceof c&&!H(M)||(Ce==="noscript"||Ce==="noembed"||Ce==="noframes")&&Xn(/<\/no(script|embed|frames)/i,M.innerHTML)?(q(M),!0):(vt&&M.nodeType===pu.text&&(ae=M.textContent,xh([U,z,Z],$e=>{ae=du(ae,$e," ")}),M.textContent!==ae&&(uu(e.removed,{element:M.cloneNode()}),M.textContent=ae)),fe("afterSanitizeElements",M,null),!1)},We=function(M,ae,Ce){if(qe&&(ae==="id"||ae==="name")&&(Ce in n||Ce in Sg))return!1;if(!(rn&&!Ye[ae]&&Xn(J,ae))){if(!(ve&&Xn(ee,ae))){if(!ke[ae]||Ye[ae]){if(!(Xe(M)&&(de.tagNameCheck instanceof RegExp&&Xn(de.tagNameCheck,M)||de.tagNameCheck instanceof Function&&de.tagNameCheck(M))&&(de.attributeNameCheck instanceof RegExp&&Xn(de.attributeNameCheck,ae)||de.attributeNameCheck instanceof Function&&de.attributeNameCheck(ae))||ae==="is"&&de.allowCustomizedBuiltInElements&&(de.tagNameCheck instanceof RegExp&&Xn(de.tagNameCheck,Ce)||de.tagNameCheck instanceof Function&&de.tagNameCheck(Ce))))return!1}else if(!P[ae]){if(!Xn(ie,du(Ce,X,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&M!=="script"&&hF(Ce,"data:")===0&&y[M])){if(!(Sn&&!Xn(re,du(Ce,X,"")))){if(Ce)return!1}}}}}}return!0},Xe=function(M){return M!=="annotation-xml"&&$b(M,$)},Jt=function(M){fe("beforeSanitizeAttributes",M,null);const{attributes:ae}=M;if(!ae)return;const Ce={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ke};let $e=ae.length;for(;$e--;){const gt=ae[$e],{name:jt,namespaceURI:Yt,value:gn}=gt,Wi=Kt(jt);let Qt=jt==="value"?gn:fF(gn);if(Ce.attrName=Wi,Ce.attrValue=Qt,Ce.keepAttr=!0,Ce.forceKeepAttr=void 0,fe("uponSanitizeAttribute",M,Ce),Qt=Ce.attrValue,Ce.forceKeepAttr||(me(jt,M),!Ce.keepAttr))continue;if(!st&&Xn(/\/>/i,Qt)){me(jt,M);continue}vt&&xh([U,z,Z],wt=>{Qt=du(Qt,wt," ")});const Je=Kt(M.nodeName);if(We(Je,Wi,Qt)){if(Bt&&(Wi==="id"||Wi==="name")&&(me(jt,M),Qt=Mt+Qt),bn&&Xn(/((--!?|])>)|<\/(style|title)/i,Qt)){me(jt,M);continue}if(k&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Yt)switch(f.getAttributeType(Je,Wi)){case"TrustedHTML":{Qt=k.createHTML(Qt);break}case"TrustedScriptURL":{Qt=k.createScriptURL(Qt);break}}try{Yt?M.setAttributeNS(Yt,jt,Qt):M.setAttribute(jt,Qt),ye(M)?q(M):Xb(e.removed)}catch{}}}fe("afterSanitizeAttributes",M,null)},dt=function le(M){let ae=null;const Ce=De(M);for(fe("beforeSanitizeShadowDOM",M,null);ae=Ce.nextNode();)fe("uponSanitizeShadowNode",ae,null),!xe(ae)&&(ae.content instanceof o&&le(ae.content),Jt(ae));fe("afterSanitizeShadowDOM",M,null)};return e.sanitize=function(le){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae=null,Ce=null,$e=null,gt=null;if(ot=!le,ot&&(le="<!-->"),typeof le!="string"&&!we(le))if(typeof le.toString=="function"){if(le=le.toString(),typeof le!="string")throw hu("dirty is not a string, aborting")}else throw hu("toString is not a function");if(!e.isSupported)return le;if(ue||Rs(M),e.removed=[],typeof le=="string"&&(wn=!1),wn){if(le.nodeName){const gn=Kt(le.nodeName);if(!j[gn]||Pe[gn])throw hu("root node is forbidden and cannot be sanitized in-place")}}else if(le instanceof a)ae=Re("<!---->"),Ce=ae.ownerDocument.importNode(le,!0),Ce.nodeType===pu.element&&Ce.nodeName==="BODY"||Ce.nodeName==="HTML"?ae=Ce:ae.appendChild(Ce);else{if(!Ge&&!vt&&!on&&le.indexOf("<")===-1)return k&&Me?k.createHTML(le):le;if(ae=Re(le),!ae)return Ge?null:Me?w:""}ae&&be&&q(ae.firstChild);const jt=De(wn?le:ae);for(;$e=jt.nextNode();)xe($e)||($e.content instanceof o&&dt($e.content),Jt($e));if(wn)return le;if(Ge){if(Ve)for(gt=T.call(ae.ownerDocument);ae.firstChild;)gt.appendChild(ae.firstChild);else gt=ae;return(ke.shadowroot||ke.shadowrootmode)&&(gt=O.call(r,gt,!0)),gt}let Yt=on?ae.outerHTML:ae.innerHTML;return on&&j["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&Xn(bT,ae.ownerDocument.doctype.name)&&(Yt="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+Yt),vt&&xh([U,z,Z],gn=>{Yt=du(Yt,gn," ")}),k&&Me?k.createHTML(Yt):Yt},e.setConfig=function(){let le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rs(le),ue=!0},e.clearConfig=function(){To=null,ue=!1},e.isValidAttribute=function(le,M,ae){To||Rs({});const Ce=Kt(le),$e=Kt(M);return We(Ce,$e,ae)},e.addHook=function(le,M){typeof M=="function"&&(L[le]=L[le]||[],uu(L[le],M))},e.removeHook=function(le){if(L[le])return Xb(L[le])},e.removeHooks=function(le){L[le]&&(L[le]=[])},e.removeAllHooks=function(){L={}},e}var RF=wT();const Fa=class Fa extends lt.Component{constructor(n){super(n);V(this,"outputRef",lt.createRef());V(this,"messageKey",0);V(this,"saveOutput",()=>{const n=this.state.output.map(r=>ga.renderToStaticMarkup(r));localStorage.setItem(Fa.LOCAL_STORAGE_KEY,JSON.stringify(n))});V(this,"loadOutput",()=>{const n=localStorage.getItem(Fa.LOCAL_STORAGE_KEY);return n?JSON.parse(n).map(i=>lt.createElement("div",{dangerouslySetInnerHTML:{__html:i}})):[]});V(this,"addCommand",n=>{this.addToOutput([K.jsx("span",{className:"command","aria-live":"off",children:n})],!1)});V(this,"addError",n=>this.addToOutput([K.jsxs("h2",{children:[" Error: ",n.message]})]));V(this,"handleConnected",()=>this.addToOutput([K.jsx("h2",{children:" Connected"})]));V(this,"handleDisconnected",()=>{this.addToOutput([K.jsx("h2",{children:" Disconnected"})]),this.setState({sidebarVisible:!1})});V(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));V(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});V(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;return n?n.scrollHeight-n.scrollTop<=n.clientHeight+1:!1});V(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});V(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});V(this,"handleMessage",n=>{if(!n)return;const r=KD(n,this.handleExitClick);this.addToOutput(r)});V(this,"handleHtml",n=>{const r=RF.sanitize(n),i=K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i])});V(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0}}getSnapshotBeforeUpdate(n,r){if(this.outputRef.current){const i=this.outputRef.current;return i.scrollHeight-i.scrollTop<=i.clientHeight}return null}componentDidUpdate(n,r,i){i&&this.scrollToBottom(),this.state.output.length>r.output.length&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState({newLinesCount:this.state.newLinesCount+(this.state.output.length-r.output.length)})),this.saveOutput()}componentDidMount(){const{client:n}=this.props;n.on("message",this.handleMessage),n.on("html",this.handleHtml),n.on("connect",this.handleConnected),n.on("disconnect",this.handleDisconnected),n.on("error",this.addError),n.on("command",this.addCommand),n.on("userlist",this.handleUserList)}componentWillUnmount(){const{client:n}=this.props;n.removeListener("message",this.handleMessage),n.removeListener("html",this.handleHtml),n.removeListener("connect",this.handleConnected),n.removeListener("disconnect",this.handleDisconnected),n.removeListener("error",this.addError),n.removeListener("command",this.addCommand),n.removeListener("userlist",this.handleUserList)}sanitizeHtml(n){return new DOMParser().parseFromString(n,"text/html").body.textContent||""}addToOutput(n,r=!0){r&&n.forEach(i=>{if(lt.isValidElement(i)){const o=ga.renderToString(i),s=this.sanitizeHtml(o);QS(s)}else typeof i=="string"&&QS(i)}),this.setState(i=>{const o=n.map((c,l)=>K.jsx("div",{children:c},this.messageKey+l));return this.messageKey+=n.length,{output:[...i.output,...o].slice(-Fa.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a"),a=new Date,c=a.toLocaleDateString(),l=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${c}-${l}.html`;s.download=d,s.href=o,s.click(),URL.revokeObjectURL(o),s.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return K.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,children:[this.state.output,this.state.newLinesCount>0&&K.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};V(Fa,"MAX_OUTPUT_LENGTH",5e3),V(Fa,"LOCAL_STORAGE_KEY","outputLog");let Kv=Fa;var AT={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,d||c,h),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,f,p){var m=n?n+l:l;if(!this._events[m])return!1;var C=this._events[m],g=arguments.length,v,S;if(C.fn){switch(C.once&&this.removeListener(l,C.fn,void 0,!0),g){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,u),!0;case 3:return C.fn.call(C.context,u,d),!0;case 4:return C.fn.call(C.context,u,d,h),!0;case 5:return C.fn.call(C.context,u,d,h,f),!0;case 6:return C.fn.call(C.context,u,d,h,f,p),!0}for(S=1,v=new Array(g-1);S<g;S++)v[S-1]=arguments[S];C.fn.apply(C.context,v)}else{var k=C.length,w;for(S=0;S<k;S++)switch(C[S].once&&this.removeListener(l,C[S].fn,void 0,!0),g){case 1:C[S].fn.call(C[S].context);break;case 2:C[S].fn.call(C[S].context,u);break;case 3:C[S].fn.call(C[S].context,u,d);break;case 4:C[S].fn.call(C[S].context,u,d,h);break;default:if(!v)for(w=1,v=new Array(g-1);w<g;w++)v[w-1]=arguments[w];C[S].fn.apply(C[S].context,v)}}return!0},a.prototype.on=function(l,u,d){return o(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return o(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var f=n?n+l:l;if(!this._events[f])return this;if(!u)return s(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&s(this,f);else{for(var m=0,C=[],g=p.length;m<g;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&C.push(p[m]);C.length?this._events[f]=C.length===1?C[0]:C:s(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(AT);var xF=AT.exports;const kT=Ud(xF);var An={},ng={};ng.byteLength=_F;ng.toByteArray=MF;ng.fromByteArray=FF;var Yi=[],Kr=[],PF=typeof Uint8Array<"u"?Uint8Array:Array,fm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var kc=0,NF=fm.length;kc<NF;++kc)Yi[kc]=fm[kc],Kr[fm.charCodeAt(kc)]=kc;Kr[45]=62;Kr[95]=63;function ET(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function _F(t){var e=ET(t),n=e[0],r=e[1];return(n+r)*3/4-r}function OF(t,e,n){return(e+n)*3/4-n}function MF(t){var e,n=ET(t),r=n[0],i=n[1],o=new PF(OF(t,r,i)),s=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=Kr[t.charCodeAt(c)]<<18|Kr[t.charCodeAt(c+1)]<<12|Kr[t.charCodeAt(c+2)]<<6|Kr[t.charCodeAt(c+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=Kr[t.charCodeAt(c)]<<2|Kr[t.charCodeAt(c+1)]>>4,o[s++]=e&255),i===1&&(e=Kr[t.charCodeAt(c)]<<10|Kr[t.charCodeAt(c+1)]<<4|Kr[t.charCodeAt(c+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function DF(t){return Yi[t>>18&63]+Yi[t>>12&63]+Yi[t>>6&63]+Yi[t&63]}function LF(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(DF(r));return i.join("")}function FF(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(LF(t,s,s+o>a?a:s+o));return r===1?(e=t[n-1],i.push(Yi[e>>2]+Yi[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(Yi[e>>10]+Yi[e>>4&63]+Yi[e<<2&63]+"=")),i.join("")}var bC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */bC.read=function(t,e,n,r,i){var o,s,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,h=n?-1:1,f=t[e+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=o*256+t[e+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+t[e+d],d+=h,u-=8);if(o===0)o=1-l;else{if(o===c)return s?NaN:(f?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-l}return(f?-1:1)*s*Math.pow(2,o-r)};bC.write=function(t,e,n,r,i,o){var s,a,c,l=o*8-i-1,u=(1<<l)-1,d=u>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(s++,c/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(e*c-1)*Math.pow(2,i),s=s+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=a&255,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[n+f]=s&255,f+=p,s/=256,l-=8);t[n+f-p]|=m*128};(function(t){const e=ng,n=bC,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const E=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(E,y),E.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(E){if(E>i)throw new RangeError('The value "'+E+'" is invalid for option "size"');const y=new Uint8Array(E);return Object.setPrototypeOf(y,a.prototype),y}function a(E,y,I){if(typeof E=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(E)}return c(E,y,I)}a.poolSize=8192;function c(E,y,I){if(typeof E=="string")return h(E,y);if(ArrayBuffer.isView(E))return p(E);if(E==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E);if(Mt(E,ArrayBuffer)||E&&Mt(E.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Mt(E,SharedArrayBuffer)||E&&Mt(E.buffer,SharedArrayBuffer)))return m(E,y,I);if(typeof E=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const P=E.valueOf&&E.valueOf();if(P!=null&&P!==E)return a.from(P,y,I);const F=C(E);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof E[Symbol.toPrimitive]=="function")return a.from(E[Symbol.toPrimitive]("string"),y,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E)}a.from=function(E,y,I){return c(E,y,I)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(E){if(typeof E!="number")throw new TypeError('"size" argument must be of type number');if(E<0)throw new RangeError('The value "'+E+'" is invalid for option "size"')}function u(E,y,I){return l(E),E<=0?s(E):y!==void 0?typeof I=="string"?s(E).fill(y,I):s(E).fill(y):s(E)}a.alloc=function(E,y,I){return u(E,y,I)};function d(E){return l(E),s(E<0?0:g(E)|0)}a.allocUnsafe=function(E){return d(E)},a.allocUnsafeSlow=function(E){return d(E)};function h(E,y){if((typeof y!="string"||y==="")&&(y="utf8"),!a.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const I=S(E,y)|0;let P=s(I);const F=P.write(E,y);return F!==I&&(P=P.slice(0,F)),P}function f(E){const y=E.length<0?0:g(E.length)|0,I=s(y);for(let P=0;P<y;P+=1)I[P]=E[P]&255;return I}function p(E){if(Mt(E,Uint8Array)){const y=new Uint8Array(E);return m(y.buffer,y.byteOffset,y.byteLength)}return f(E)}function m(E,y,I){if(y<0||E.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(E.byteLength<y+(I||0))throw new RangeError('"length" is outside of buffer bounds');let P;return y===void 0&&I===void 0?P=new Uint8Array(E):I===void 0?P=new Uint8Array(E,y):P=new Uint8Array(E,y,I),Object.setPrototypeOf(P,a.prototype),P}function C(E){if(a.isBuffer(E)){const y=g(E.length)|0,I=s(y);return I.length===0||E.copy(I,0,0,y),I}if(E.length!==void 0)return typeof E.length!="number"||Wt(E.length)?s(0):f(E);if(E.type==="Buffer"&&Array.isArray(E.data))return f(E.data)}function g(E){if(E>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return E|0}function v(E){return+E!=E&&(E=0),a.alloc(+E)}a.isBuffer=function(y){return y!=null&&y._isBuffer===!0&&y!==a.prototype},a.compare=function(y,I){if(Mt(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),Mt(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(y)||!a.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(y===I)return 0;let P=y.length,F=I.length;for(let W=0,Q=Math.min(P,F);W<Q;++W)if(y[W]!==I[W]){P=y[W],F=I[W];break}return P<F?-1:F<P?1:0},a.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(y,I){if(!Array.isArray(y))throw new TypeError('"list" argument must be an Array of Buffers');if(y.length===0)return a.alloc(0);let P;if(I===void 0)for(I=0,P=0;P<y.length;++P)I+=y[P].length;const F=a.allocUnsafe(I);let W=0;for(P=0;P<y.length;++P){let Q=y[P];if(Mt(Q,Uint8Array))W+Q.length>F.length?(a.isBuffer(Q)||(Q=a.from(Q)),Q.copy(F,W)):Uint8Array.prototype.set.call(F,Q,W);else if(a.isBuffer(Q))Q.copy(F,W);else throw new TypeError('"list" argument must be an Array of Buffers');W+=Q.length}return F};function S(E,y){if(a.isBuffer(E))return E.length;if(ArrayBuffer.isView(E)||Mt(E,ArrayBuffer))return E.byteLength;if(typeof E!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof E);const I=E.length,P=arguments.length>2&&arguments[2]===!0;if(!P&&I===0)return 0;let F=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return Ge(E).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return qe(E).length;default:if(F)return P?-1:Ge(E).length;y=(""+y).toLowerCase(),F=!0}}a.byteLength=S;function k(E,y,I){let P=!1;if((y===void 0||y<0)&&(y=0),y>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,y>>>=0,I<=y))return"";for(E||(E="utf8");;)switch(E){case"hex":return $(this,y,I);case"utf8":case"utf-8":return Z(this,y,I);case"ascii":return re(this,y,I);case"latin1":case"binary":return X(this,y,I);case"base64":return z(this,y,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,y,I);default:if(P)throw new TypeError("Unknown encoding: "+E);E=(E+"").toLowerCase(),P=!0}}a.prototype._isBuffer=!0;function w(E,y,I){const P=E[y];E[y]=E[I],E[I]=P}a.prototype.swap16=function(){const y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<y;I+=2)w(this,I,I+1);return this},a.prototype.swap32=function(){const y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<y;I+=4)w(this,I,I+3),w(this,I+1,I+2);return this},a.prototype.swap64=function(){const y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<y;I+=8)w(this,I,I+7),w(this,I+1,I+6),w(this,I+2,I+5),w(this,I+3,I+4);return this},a.prototype.toString=function(){const y=this.length;return y===0?"":arguments.length===0?Z(this,0,y):k.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(y){if(!a.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:a.compare(this,y)===0},a.prototype.inspect=function(){let y="";const I=t.INSPECT_MAX_BYTES;return y=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(y+=" ... "),"<Buffer "+y+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(y,I,P,F,W){if(Mt(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),!a.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof y);if(I===void 0&&(I=0),P===void 0&&(P=y?y.length:0),F===void 0&&(F=0),W===void 0&&(W=this.length),I<0||P>y.length||F<0||W>this.length)throw new RangeError("out of range index");if(F>=W&&I>=P)return 0;if(F>=W)return-1;if(I>=P)return 1;if(I>>>=0,P>>>=0,F>>>=0,W>>>=0,this===y)return 0;let Q=W-F,_e=P-I;const rt=Math.min(Q,_e),ot=this.slice(F,W),at=y.slice(I,P);for(let Qe=0;Qe<rt;++Qe)if(ot[Qe]!==at[Qe]){Q=ot[Qe],_e=at[Qe];break}return Q<_e?-1:_e<Q?1:0};function A(E,y,I,P,F){if(E.length===0)return-1;if(typeof I=="string"?(P=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,Wt(I)&&(I=F?0:E.length-1),I<0&&(I=E.length+I),I>=E.length){if(F)return-1;I=E.length-1}else if(I<0)if(F)I=0;else return-1;if(typeof y=="string"&&(y=a.from(y,P)),a.isBuffer(y))return y.length===0?-1:x(E,y,I,P,F);if(typeof y=="number")return y=y&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(E,y,I):Uint8Array.prototype.lastIndexOf.call(E,y,I):x(E,[y],I,P,F);throw new TypeError("val must be string, number or Buffer")}function x(E,y,I,P,F){let W=1,Q=E.length,_e=y.length;if(P!==void 0&&(P=String(P).toLowerCase(),P==="ucs2"||P==="ucs-2"||P==="utf16le"||P==="utf-16le")){if(E.length<2||y.length<2)return-1;W=2,Q/=2,_e/=2,I/=2}function rt(at,Qe){return W===1?at[Qe]:at.readUInt16BE(Qe*W)}let ot;if(F){let at=-1;for(ot=I;ot<Q;ot++)if(rt(E,ot)===rt(y,at===-1?0:ot-at)){if(at===-1&&(at=ot),ot-at+1===_e)return at*W}else at!==-1&&(ot-=ot-at),at=-1}else for(I+_e>Q&&(I=Q-_e),ot=I;ot>=0;ot--){let at=!0;for(let Qe=0;Qe<_e;Qe++)if(rt(E,ot+Qe)!==rt(y,Qe)){at=!1;break}if(at)return ot}return-1}a.prototype.includes=function(y,I,P){return this.indexOf(y,I,P)!==-1},a.prototype.indexOf=function(y,I,P){return A(this,y,I,P,!0)},a.prototype.lastIndexOf=function(y,I,P){return A(this,y,I,P,!1)};function T(E,y,I,P){I=Number(I)||0;const F=E.length-I;P?(P=Number(P),P>F&&(P=F)):P=F;const W=y.length;P>W/2&&(P=W/2);let Q;for(Q=0;Q<P;++Q){const _e=parseInt(y.substr(Q*2,2),16);if(Wt(_e))return Q;E[I+Q]=_e}return Q}function _(E,y,I,P){return Bt(Ge(y,E.length-I),E,I,P)}function O(E,y,I,P){return Bt(Ve(y),E,I,P)}function L(E,y,I,P){return Bt(qe(y),E,I,P)}function U(E,y,I,P){return Bt(Me(y,E.length-I),E,I,P)}a.prototype.write=function(y,I,P,F){if(I===void 0)F="utf8",P=this.length,I=0;else if(P===void 0&&typeof I=="string")F=I,P=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(P)?(P=P>>>0,F===void 0&&(F="utf8")):(F=P,P=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const W=this.length-I;if((P===void 0||P>W)&&(P=W),y.length>0&&(P<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");let Q=!1;for(;;)switch(F){case"hex":return T(this,y,I,P);case"utf8":case"utf-8":return _(this,y,I,P);case"ascii":case"latin1":case"binary":return O(this,y,I,P);case"base64":return L(this,y,I,P);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,y,I,P);default:if(Q)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),Q=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function z(E,y,I){return y===0&&I===E.length?e.fromByteArray(E):e.fromByteArray(E.slice(y,I))}function Z(E,y,I){I=Math.min(E.length,I);const P=[];let F=y;for(;F<I;){const W=E[F];let Q=null,_e=W>239?4:W>223?3:W>191?2:1;if(F+_e<=I){let rt,ot,at,Qe;switch(_e){case 1:W<128&&(Q=W);break;case 2:rt=E[F+1],(rt&192)===128&&(Qe=(W&31)<<6|rt&63,Qe>127&&(Q=Qe));break;case 3:rt=E[F+1],ot=E[F+2],(rt&192)===128&&(ot&192)===128&&(Qe=(W&15)<<12|(rt&63)<<6|ot&63,Qe>2047&&(Qe<55296||Qe>57343)&&(Q=Qe));break;case 4:rt=E[F+1],ot=E[F+2],at=E[F+3],(rt&192)===128&&(ot&192)===128&&(at&192)===128&&(Qe=(W&15)<<18|(rt&63)<<12|(ot&63)<<6|at&63,Qe>65535&&Qe<1114112&&(Q=Qe))}}Q===null?(Q=65533,_e=1):Q>65535&&(Q-=65536,P.push(Q>>>10&1023|55296),Q=56320|Q&1023),P.push(Q),F+=_e}return ee(P)}const J=4096;function ee(E){const y=E.length;if(y<=J)return String.fromCharCode.apply(String,E);let I="",P=0;for(;P<y;)I+=String.fromCharCode.apply(String,E.slice(P,P+=J));return I}function re(E,y,I){let P="";I=Math.min(E.length,I);for(let F=y;F<I;++F)P+=String.fromCharCode(E[F]&127);return P}function X(E,y,I){let P="";I=Math.min(E.length,I);for(let F=y;F<I;++F)P+=String.fromCharCode(E[F]);return P}function $(E,y,I){const P=E.length;(!y||y<0)&&(y=0),(!I||I<0||I>P)&&(I=P);let F="";for(let W=y;W<I;++W)F+=wn[E[W]];return F}function ie(E,y,I){const P=E.slice(y,I);let F="";for(let W=0;W<P.length-1;W+=2)F+=String.fromCharCode(P[W]+P[W+1]*256);return F}a.prototype.slice=function(y,I){const P=this.length;y=~~y,I=I===void 0?P:~~I,y<0?(y+=P,y<0&&(y=0)):y>P&&(y=P),I<0?(I+=P,I<0&&(I=0)):I>P&&(I=P),I<y&&(I=y);const F=this.subarray(y,I);return Object.setPrototypeOf(F,a.prototype),F};function j(E,y,I){if(E%1!==0||E<0)throw new RangeError("offset is not uint");if(E+y>I)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(y,I,P){y=y>>>0,I=I>>>0,P||j(y,I,this.length);let F=this[y],W=1,Q=0;for(;++Q<I&&(W*=256);)F+=this[y+Q]*W;return F},a.prototype.readUintBE=a.prototype.readUIntBE=function(y,I,P){y=y>>>0,I=I>>>0,P||j(y,I,this.length);let F=this[y+--I],W=1;for(;I>0&&(W*=256);)F+=this[y+--I]*W;return F},a.prototype.readUint8=a.prototype.readUInt8=function(y,I){return y=y>>>0,I||j(y,1,this.length),this[y]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(y,I){return y=y>>>0,I||j(y,2,this.length),this[y]|this[y+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(y,I){return y=y>>>0,I||j(y,2,this.length),this[y]<<8|this[y+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(y,I){return y=y>>>0,I||j(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(y,I){return y=y>>>0,I||j(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},a.prototype.readBigUInt64LE=$t(function(y){y=y>>>0,bn(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&on(y,this.length-8);const F=I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24,W=this[++y]+this[++y]*2**8+this[++y]*2**16+P*2**24;return BigInt(F)+(BigInt(W)<<BigInt(32))}),a.prototype.readBigUInt64BE=$t(function(y){y=y>>>0,bn(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&on(y,this.length-8);const F=I*2**24+this[++y]*2**16+this[++y]*2**8+this[++y],W=this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+P;return(BigInt(F)<<BigInt(32))+BigInt(W)}),a.prototype.readIntLE=function(y,I,P){y=y>>>0,I=I>>>0,P||j(y,I,this.length);let F=this[y],W=1,Q=0;for(;++Q<I&&(W*=256);)F+=this[y+Q]*W;return W*=128,F>=W&&(F-=Math.pow(2,8*I)),F},a.prototype.readIntBE=function(y,I,P){y=y>>>0,I=I>>>0,P||j(y,I,this.length);let F=I,W=1,Q=this[y+--F];for(;F>0&&(W*=256);)Q+=this[y+--F]*W;return W*=128,Q>=W&&(Q-=Math.pow(2,8*I)),Q},a.prototype.readInt8=function(y,I){return y=y>>>0,I||j(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},a.prototype.readInt16LE=function(y,I){y=y>>>0,I||j(y,2,this.length);const P=this[y]|this[y+1]<<8;return P&32768?P|4294901760:P},a.prototype.readInt16BE=function(y,I){y=y>>>0,I||j(y,2,this.length);const P=this[y+1]|this[y]<<8;return P&32768?P|4294901760:P},a.prototype.readInt32LE=function(y,I){return y=y>>>0,I||j(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},a.prototype.readInt32BE=function(y,I){return y=y>>>0,I||j(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},a.prototype.readBigInt64LE=$t(function(y){y=y>>>0,bn(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&on(y,this.length-8);const F=this[y+4]+this[y+5]*2**8+this[y+6]*2**16+(P<<24);return(BigInt(F)<<BigInt(32))+BigInt(I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24)}),a.prototype.readBigInt64BE=$t(function(y){y=y>>>0,bn(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&on(y,this.length-8);const F=(I<<24)+this[++y]*2**16+this[++y]*2**8+this[++y];return(BigInt(F)<<BigInt(32))+BigInt(this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+P)}),a.prototype.readFloatLE=function(y,I){return y=y>>>0,I||j(y,4,this.length),n.read(this,y,!0,23,4)},a.prototype.readFloatBE=function(y,I){return y=y>>>0,I||j(y,4,this.length),n.read(this,y,!1,23,4)},a.prototype.readDoubleLE=function(y,I){return y=y>>>0,I||j(y,8,this.length),n.read(this,y,!0,52,8)},a.prototype.readDoubleBE=function(y,I){return y=y>>>0,I||j(y,8,this.length),n.read(this,y,!1,52,8)};function oe(E,y,I,P,F,W){if(!a.isBuffer(E))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>F||y<W)throw new RangeError('"value" argument is out of bounds');if(I+P>E.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(y,I,P,F){if(y=+y,I=I>>>0,P=P>>>0,!F){const _e=Math.pow(2,8*P)-1;oe(this,y,I,P,_e,0)}let W=1,Q=0;for(this[I]=y&255;++Q<P&&(W*=256);)this[I+Q]=y/W&255;return I+P},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(y,I,P,F){if(y=+y,I=I>>>0,P=P>>>0,!F){const _e=Math.pow(2,8*P)-1;oe(this,y,I,P,_e,0)}let W=P-1,Q=1;for(this[I+W]=y&255;--W>=0&&(Q*=256);)this[I+W]=y/Q&255;return I+P},a.prototype.writeUint8=a.prototype.writeUInt8=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,1,255,0),this[I]=y&255,I+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,2,65535,0),this[I]=y&255,this[I+1]=y>>>8,I+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,2,65535,0),this[I]=y>>>8,this[I+1]=y&255,I+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,4,4294967295,0),this[I+3]=y>>>24,this[I+2]=y>>>16,this[I+1]=y>>>8,this[I]=y&255,I+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,4,4294967295,0),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4};function ke(E,y,I,P,F){vt(y,P,F,E,I,7);let W=Number(y&BigInt(4294967295));E[I++]=W,W=W>>8,E[I++]=W,W=W>>8,E[I++]=W,W=W>>8,E[I++]=W;let Q=Number(y>>BigInt(32)&BigInt(4294967295));return E[I++]=Q,Q=Q>>8,E[I++]=Q,Q=Q>>8,E[I++]=Q,Q=Q>>8,E[I++]=Q,I}function Le(E,y,I,P,F){vt(y,P,F,E,I,7);let W=Number(y&BigInt(4294967295));E[I+7]=W,W=W>>8,E[I+6]=W,W=W>>8,E[I+5]=W,W=W>>8,E[I+4]=W;let Q=Number(y>>BigInt(32)&BigInt(4294967295));return E[I+3]=Q,Q=Q>>8,E[I+2]=Q,Q=Q>>8,E[I+1]=Q,Q=Q>>8,E[I]=Q,I+8}a.prototype.writeBigUInt64LE=$t(function(y,I=0){return ke(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=$t(function(y,I=0){return Le(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(y,I,P,F){if(y=+y,I=I>>>0,!F){const rt=Math.pow(2,8*P-1);oe(this,y,I,P,rt-1,-rt)}let W=0,Q=1,_e=0;for(this[I]=y&255;++W<P&&(Q*=256);)y<0&&_e===0&&this[I+W-1]!==0&&(_e=1),this[I+W]=(y/Q>>0)-_e&255;return I+P},a.prototype.writeIntBE=function(y,I,P,F){if(y=+y,I=I>>>0,!F){const rt=Math.pow(2,8*P-1);oe(this,y,I,P,rt-1,-rt)}let W=P-1,Q=1,_e=0;for(this[I+W]=y&255;--W>=0&&(Q*=256);)y<0&&_e===0&&this[I+W+1]!==0&&(_e=1),this[I+W]=(y/Q>>0)-_e&255;return I+P},a.prototype.writeInt8=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,1,127,-128),y<0&&(y=255+y+1),this[I]=y&255,I+1},a.prototype.writeInt16LE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,2,32767,-32768),this[I]=y&255,this[I+1]=y>>>8,I+2},a.prototype.writeInt16BE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,2,32767,-32768),this[I]=y>>>8,this[I+1]=y&255,I+2},a.prototype.writeInt32LE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,4,2147483647,-2147483648),this[I]=y&255,this[I+1]=y>>>8,this[I+2]=y>>>16,this[I+3]=y>>>24,I+4},a.prototype.writeInt32BE=function(y,I,P){return y=+y,I=I>>>0,P||oe(this,y,I,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4},a.prototype.writeBigInt64LE=$t(function(y,I=0){return ke(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=$t(function(y,I=0){return Le(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function de(E,y,I,P,F,W){if(I+P>E.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function Pe(E,y,I,P,F){return y=+y,I=I>>>0,F||de(E,y,I,4),n.write(E,y,I,P,23,4),I+4}a.prototype.writeFloatLE=function(y,I,P){return Pe(this,y,I,!0,P)},a.prototype.writeFloatBE=function(y,I,P){return Pe(this,y,I,!1,P)};function Ye(E,y,I,P,F){return y=+y,I=I>>>0,F||de(E,y,I,8),n.write(E,y,I,P,52,8),I+8}a.prototype.writeDoubleLE=function(y,I,P){return Ye(this,y,I,!0,P)},a.prototype.writeDoubleBE=function(y,I,P){return Ye(this,y,I,!1,P)},a.prototype.copy=function(y,I,P,F){if(!a.isBuffer(y))throw new TypeError("argument should be a Buffer");if(P||(P=0),!F&&F!==0&&(F=this.length),I>=y.length&&(I=y.length),I||(I=0),F>0&&F<P&&(F=P),F===P||y.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(P<0||P>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),y.length-I<F-P&&(F=y.length-I+P);const W=F-P;return this===y&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,P,F):Uint8Array.prototype.set.call(y,this.subarray(P,F),I),W},a.prototype.fill=function(y,I,P,F){if(typeof y=="string"){if(typeof I=="string"?(F=I,I=0,P=this.length):typeof P=="string"&&(F=P,P=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!a.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(y.length===1){const Q=y.charCodeAt(0);(F==="utf8"&&Q<128||F==="latin1")&&(y=Q)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(I<0||this.length<I||this.length<P)throw new RangeError("Out of range index");if(P<=I)return this;I=I>>>0,P=P===void 0?this.length:P>>>0,y||(y=0);let W;if(typeof y=="number")for(W=I;W<P;++W)this[W]=y;else{const Q=a.isBuffer(y)?y:a.from(y,F),_e=Q.length;if(_e===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for(W=0;W<P-I;++W)this[W+I]=Q[W%_e]}return this};const ve={};function rn(E,y,I){ve[E]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${E}]`,this.stack,delete this.name}get code(){return E}set code(F){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:F,writable:!0})}toString(){return`${this.name} [${E}]: ${this.message}`}}}rn("ERR_BUFFER_OUT_OF_BOUNDS",function(E){return E?`${E} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),rn("ERR_INVALID_ARG_TYPE",function(E,y){return`The "${E}" argument must be of type number. Received type ${typeof y}`},TypeError),rn("ERR_OUT_OF_RANGE",function(E,y,I){let P=`The value of "${E}" is out of range.`,F=I;return Number.isInteger(I)&&Math.abs(I)>2**32?F=Sn(String(I)):typeof I=="bigint"&&(F=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(F=Sn(F)),F+="n"),P+=` It must be ${y}. Received ${F}`,P},RangeError);function Sn(E){let y="",I=E.length;const P=E[0]==="-"?1:0;for(;I>=P+4;I-=3)y=`_${E.slice(I-3,I)}${y}`;return`${E.slice(0,I)}${y}`}function st(E,y,I){bn(y,"offset"),(E[y]===void 0||E[y+I]===void 0)&&on(y,E.length-(I+1))}function vt(E,y,I,P,F,W){if(E>I||E<y){const Q=typeof y=="bigint"?"n":"";let _e;throw y===0||y===BigInt(0)?_e=`>= 0${Q} and < 2${Q} ** ${(W+1)*8}${Q}`:_e=`>= -(2${Q} ** ${(W+1)*8-1}${Q}) and < 2 ** ${(W+1)*8-1}${Q}`,new ve.ERR_OUT_OF_RANGE("value",_e,E)}st(P,F,W)}function bn(E,y){if(typeof E!="number")throw new ve.ERR_INVALID_ARG_TYPE(y,"number",E)}function on(E,y,I){throw Math.floor(E)!==E?(bn(E,I),new ve.ERR_OUT_OF_RANGE("offset","an integer",E)):y<0?new ve.ERR_BUFFER_OUT_OF_BOUNDS:new ve.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${y}`,E)}const ue=/[^+/0-9A-Za-z-_]/g;function be(E){if(E=E.split("=")[0],E=E.trim().replace(ue,""),E.length<2)return"";for(;E.length%4!==0;)E=E+"=";return E}function Ge(E,y){y=y||1/0;let I;const P=E.length;let F=null;const W=[];for(let Q=0;Q<P;++Q){if(I=E.charCodeAt(Q),I>55295&&I<57344){if(!F){if(I>56319){(y-=3)>-1&&W.push(239,191,189);continue}else if(Q+1===P){(y-=3)>-1&&W.push(239,191,189);continue}F=I;continue}if(I<56320){(y-=3)>-1&&W.push(239,191,189),F=I;continue}I=(F-55296<<10|I-56320)+65536}else F&&(y-=3)>-1&&W.push(239,191,189);if(F=null,I<128){if((y-=1)<0)break;W.push(I)}else if(I<2048){if((y-=2)<0)break;W.push(I>>6|192,I&63|128)}else if(I<65536){if((y-=3)<0)break;W.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((y-=4)<0)break;W.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return W}function Ve(E){const y=[];for(let I=0;I<E.length;++I)y.push(E.charCodeAt(I)&255);return y}function Me(E,y){let I,P,F;const W=[];for(let Q=0;Q<E.length&&!((y-=2)<0);++Q)I=E.charCodeAt(Q),P=I>>8,F=I%256,W.push(F),W.push(P);return W}function qe(E){return e.toByteArray(be(E))}function Bt(E,y,I,P){let F;for(F=0;F<P&&!(F+I>=y.length||F>=E.length);++F)y[F+I]=E[F];return F}function Mt(E,y){return E instanceof y||E!=null&&E.constructor!=null&&E.constructor.name!=null&&E.constructor.name===y.name}function Wt(E){return E!==E}const wn=function(){const E="0123456789abcdef",y=new Array(256);for(let I=0;I<16;++I){const P=I*16;for(let F=0;F<16;++F)y[P+F]=E[I]+E[F]}return y}();function $t(E){return typeof BigInt>"u"?ur:E}function ur(){throw new Error("BigInt not supported")}})(An);var Nu=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(Nu||{}),_u=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(_u||{});class BF{constructor(e){V(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class UF extends kT{constructor(n){super();V(this,"state");V(this,"buffer");V(this,"subBuffer");V(this,"iacSEBuffer",An.Buffer.from([255,240]));V(this,"negotiationByte",0);V(this,"stream");this.state=0,this.buffer=An.Buffer.alloc(0),this.subBuffer=An.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=An.Buffer.concat([this.buffer,An.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=An.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=An.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(n,r){this.stream.write(An.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,o=An.Buffer.from(i),s=An.Buffer.concat([An.Buffer.from([255,250]),An.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(s)}sendTerminalType(n){const r=An.Buffer.from(n),i=An.Buffer.concat([An.Buffer.from([255,250]),An.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function VF({onlyFirst:t=!1}={}){const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(n,t?void 0:"g")}const GF=VF();function WF(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(GF,"")}class jF{constructor(e){V(this,"editors");V(this,"channel");this.client=e,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(e){console.log("Opening editor window for session:",e);const n=e.reference,r=this.editors.get(n);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(n),o=window.open(`/editor?reference=${i}`,"_blank"),s={...e,window:o,state:0};this.editors.set(n,s),o&&o.focus()}}saveEditorWindow(e){const n={reference:e.reference,type:e.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",n,e.contents)}setupChannelListeners(){this.channel.onmessage=e=>{console.log("Editor window message:",e);const{type:n,id:r,session:i}=e.data;switch(n){case"ready":console.log("Editor window ready, id:",r);const o=this.editors.get(r);if(o){o.state=1;const{window:a,...c}=o;this.channel.postMessage({type:"load",session:c})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const s=this.editors.get(r);s&&(s.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((e,n)=>{try{e.state===1&&e.window&&(console.log(`Closing editor window for ${n}`),e.window.close(),this.channel.postMessage({type:"shutdown",id:n}))}catch(r){console.error(`Error closing editor window ${n}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class So{constructor(e){V(this,"packageName");V(this,"packageVersion",1);V(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class ZF extends So{constructor(){super(...arguments);V(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class HF extends So{constructor(){super(...arguments);V(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class zF extends So{constructor(n){super(n);V(this,"packageName","Client.Keystrokes");V(this,"bindings",[]);V(this,"boundKeyUpHandler");document.addEventListener("keydown",r=>this.handleKeydown(r))}handleKeydown(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=this.client.getInput(),o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",n=>this.handleKeydown(n))}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"Alt",n.ctrlKey&&"Control",n.shiftKey&&"Shift",n.metaKey&&"Meta"].filter(Boolean));return r.modifiers&&r.modifiers.every(o=>i.has(o))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(o,s)=>{if(s==="*")return r;const a=parseInt(s,10)-1;return a>=0&&a<i.length?i[a]:o})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>!(r.key===n.key&&r.modifiers.length===n.modifiers.length&&r.modifiers.every(i=>n.modifiers.includes(i))))}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}listBindings(){return[...this.bindings]}}const ew=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),tw=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),Jv=(t,e)=>({startTime:e,type:"setValue",value:t}),TT=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),RT=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),jc=t=>t.type==="exponentialRampToValue",lp=t=>t.type==="linearRampToValue",Ws=t=>jc(t)||lp(t),wC=t=>t.type==="setValue",Po=t=>t.type==="setValueCurve",up=(t,e,n,r)=>{const i=t[e];return i===void 0?r:Ws(i)||wC(i)?i.value:Po(i)?i.values[i.values.length-1]:RT(n,up(t,e-1,i.startTime,r),i)},nw=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:Ws(n)?[n.endTime,n.value]:wC(n)?[n.startTime,n.value]:Po(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,up(t,e-1,n.startTime,i)],Yv=t=>t.type==="cancelAndHold",Qv=t=>t.type==="cancelScheduledValues",Ns=t=>Yv(t)||Qv(t)?t.cancelTime:jc(t)||lp(t)?t.endTime:t.startTime,rw=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,iw=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),XF=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},$F=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return XF(r,i)},Nh=t=>t.type==="setTarget";class KF{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Ns(e);if(Yv(e)||Qv(e)){const r=this._automationEvents.findIndex(o=>Qv(e)&&Po(o)?o.startTime+o.duration>=n:Ns(o)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Yv(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Ws(i)){if(o!==void 0&&Nh(o))throw new Error("The internal list is malformed.");const s=o===void 0?i.insertTime:Po(o)?o.startTime+o.duration:Ns(o),a=o===void 0?this._defaultValue:Po(o)?o.values[o.values.length-1]:o.value,c=jc(i)?rw(n,s,a,i):iw(n,s,a,i),l=jc(i)?ew(c,n,this._currenTime):tw(c,n,this._currenTime);this._automationEvents.push(l)}if(o!==void 0&&Nh(o)&&this._automationEvents.push(Jv(this.getValue(n),n)),o!==void 0&&Po(o)&&o.startTime+o.duration>n){const s=n-o.startTime,a=(o.values.length-1)/o.duration,c=Math.max(2,1+Math.ceil(s*a)),l=s/(c-1)*a,u=o.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const h=l*d%1;u[d]=o.values[d-1]*(1-h)+o.values[d]*h}this._automationEvents[this._automationEvents.length-1]=TT(u,o.startTime,s)}}}else{const r=this._automationEvents.findIndex(s=>Ns(s)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Po(i)&&Ns(i)+i.duration>n)return!1;const o=jc(e)?ew(e.value,e.endTime,this._currenTime):lp(e)?tw(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(Po(e)&&n+e.duration>Ns(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>Ns(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];Nh(i)&&r.unshift(Jv(up(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(s=>Ns(s)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(o!==void 0&&Nh(o)&&(r===void 0||!Ws(r)||r.insertTime>e))return RT(e,up(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&wC(o)&&(r===void 0||!Ws(r)))return o.value;if(o!==void 0&&Po(o)&&(r===void 0||!Ws(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?$F(e,o):o.values[o.values.length-1];if(o!==void 0&&Ws(o)&&(r===void 0||!Ws(r)))return o.value;if(r!==void 0&&jc(r)){const[s,a]=nw(this._automationEvents,i,o,r,this._defaultValue);return rw(e,s,a,r)}if(r!==void 0&&lp(r)){const[s,a]=nw(this._automationEvents,i,o,r,this._defaultValue);return iw(e,s,a,r)}return this._defaultValue}}const JF=t=>({cancelTime:t,type:"cancelAndHold"}),YF=t=>({cancelTime:t,type:"cancelScheduledValues"}),QF=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),qF=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),eB=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),tB=()=>new DOMException("","AbortError"),nB=t=>(e,n,[r,i,o],s)=>{t(e[i],[n,r,o],a=>a[0]===n&&a[1]===r,s)},rB=t=>(e,n,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},iB=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Il=new WeakSet,xT=new WeakMap,PT=new WeakMap,NT=new WeakMap,_T=new WeakMap,OT=new WeakMap,MT=new WeakMap,qv=new WeakMap,e0=new WeakMap,t0=new WeakMap,DT={construct(){return DT}},oB=t=>{try{const e=new Proxy(t,DT);new e}catch{return!1}return!0},ow=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,sw=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(ow);for(;i!==null;){const o=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(ow)}return[n.join(";"),r]},aw=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},cw=t=>{if(!oB(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},sB=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>{let f=0;return(p,m,C={credentials:"omit"})=>{const g=u.get(p);if(g!==void 0&&g.has(m))return Promise.resolve();const v=l.get(p);if(v!==void 0){const w=v.get(m);if(w!==void 0)return w}const S=o(p),k=S.audioWorklet===void 0?i(m).then(([w,A])=>{const[x,T]=sw(w,A),_=`${x};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${T}
})})(window,'_AWGS')`;return n(_)}).then(()=>{const w=h._AWGS.pop();if(w===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>w(class{},void 0,(A,x)=>{if(A.trim()==="")throw e();const T=e0.get(S);if(T!==void 0){if(T.has(A))throw e();cw(x),aw(x.parameterDescriptors),T.set(A,x)}else cw(x),aw(x.parameterDescriptors),e0.set(S,new Map([[A,x]]))},S.sampleRate,void 0,void 0))}):Promise.all([i(m),Promise.resolve(t(d,d))]).then(([[w,A],x])=>{const T=f+1;f=T;const[_,O]=sw(w,A),Z=`${_};((AudioWorkletProcessor,registerProcessor)=>{${O}
})(${x?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${x?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${x?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${T}',class extends AudioWorkletProcessor{process(){return !1}})`,J=new Blob([Z],{type:"application/javascript; charset=utf-8"}),ee=URL.createObjectURL(J);return S.audioWorklet.addModule(ee,C).then(()=>{if(a(S))return S;const re=s(S);return re.audioWorklet.addModule(ee,C).then(()=>re)}).then(re=>{if(c===null)throw new SyntaxError;try{new c(re,`__sac${T}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(ee))});return v===void 0?l.set(p,new Map([[m,k]])):v.set(m,k),k.then(()=>{const w=u.get(p);w===void 0?u.set(p,new Set([m])):w.add(m)}).finally(()=>{const w=l.get(p);w!==void 0&&w.delete(m)}),k}},Li=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},rg=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},LT=(t,e,n,r)=>{const i=Li(t,e),o=rg(i,s=>s[0]===n&&s[1]===r);return i.size===0&&t.delete(e),o},Xd=t=>Li(MT,t),Sl=t=>{if(Il.has(t))throw new Error("The AudioNode is already stored.");Il.add(t),Xd(t).forEach(e=>e(!0))},FT=t=>"port"in t,$d=t=>{if(!Il.has(t))throw new Error("The AudioNode is not stored.");Il.delete(t),Xd(t).forEach(e=>e(!1))},n0=(t,e)=>{!FT(t)&&e.every(n=>n.size===0)&&$d(t)},aB=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>{const f=new WeakMap;return(p,m,C,g,v)=>{const{activeInputs:S,passiveInputs:k}=o(m),{outputs:w}=o(p),A=a(p),x=T=>{const _=c(m),O=c(p);if(T){const L=LT(k,p,C,g);t(S,p,L,!1),!v&&!d(p)&&n(O,_,C,g),h(m)&&Sl(m)}else{const L=r(S,p,C,g);e(k,g,L,!1),!v&&!d(p)&&i(O,_,C,g);const U=s(m);if(U===0)u(m)&&n0(m,S);else{const z=f.get(m);z!==void 0&&clearTimeout(z),f.set(m,setTimeout(()=>{u(m)&&n0(m,S)},U*1e3))}}};return l(w,[m,C,g],T=>T[0]===m&&T[1]===C&&T[2]===g,!0)?(A.add(x),u(p)?t(S,p,[C,g,x],!0):e(k,g,[p,C,x],!0),!0):!1}},cB=t=>(e,n,[r,i,o],s)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,o]])):t(a,[i,n,o],c=>c[0]===i&&c[1]===n,s)},lB=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},uB=t=>(e,n)=>{t(e).add(n)},dB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},hB=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...dB,...c},d=r(l,u),h=o(l)?e():null;super(a,!1,d,h),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},zn=(t,e)=>t.context===e,fB=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!zn(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},r0=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},bo=()=>new DOMException("","IndexSizeError"),BT=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?bo():r}})(t.getChannelData)},pB={numberOfChannels:1},gB=(t,e,n,r,i,o,s,a)=>{let c=null;return class UT{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:h,sampleRate:f}={...pB,...u};c===null&&(c=new i(1,1,44100));const p=r!==null&&e(o,o)?new r({length:d,numberOfChannels:h,sampleRate:f}):c.createBuffer(h,d,f);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(s(p),BT(p)):e(r0,()=>r0(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===UT.prototype||t.has(u)}}},mr=-34028234663852886e22,Yn=-mr,ls=t=>Il.has(t),mB={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},vB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h={...mB,...u},f=i(d,h),p=s(d),m=p?e():null;super(l,!1,f,m),this._audioBufferSourceNodeRenderer=m,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=f,this._onended=null,this._playbackRate=n(this,p,f.playbackRate,Yn,mr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){Sl(this);const h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),ls(this)&&$d(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},yB=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const c=async(l,u)=>{let d=n(l);const h=zn(d,u);if(!h){const f={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,f),s!==null&&d.start(...s),a!==null&&d.stop(a)}return o.set(u,d),h?await t(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await i(l,u,d),d};return{set start(l){s=l},set stop(l){a=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},CB=t=>"playbackRate"in t,IB=t=>"frequency"in t&&"gain"in t,SB=t=>"offset"in t,bB=t=>!("frequency"in t)&&"gain"in t,wB=t=>"detune"in t&&"frequency"in t&&!("gain"in t),AB=t=>"pan"in t,er=t=>Li(xT,t),Kd=t=>Li(NT,t),i0=(t,e)=>{const{activeInputs:n}=er(t);n.forEach(i=>i.forEach(([o])=>{e.includes(t)||i0(o,[...e,t])}));const r=CB(t)?[t.playbackRate]:FT(t)?Array.from(t.parameters.values()):IB(t)?[t.Q,t.detune,t.frequency,t.gain]:SB(t)?[t.offset]:bB(t)?[t.gain]:wB(t)?[t.detune,t.frequency]:AB(t)?[t.pan]:[];for(const i of r){const o=Kd(i);o!==void 0&&o.activeInputs.forEach(([s])=>i0(s,e))}ls(t)&&$d(t)},kB=t=>{i0(t.destination,[])},EB=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),TB=(t,e,n,r,i,o,s,a,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!EB(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:h}=u,{sampleRate:f}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:h==="balanced"?512/f:h==="interactive"||h===void 0?256/f:h==="playback"?1024/f:Math.max(2,Math.min(128,Math.round(h*f/128)))*128/f,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),kB(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const h=()=>{this._nativeAudioContext.removeEventListener("statechange",h),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",h)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},RB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h=s(d),f=i(d,u,h),p=h?e(a):null;super(l,!1,f,p),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=f}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},xB=t=>{const e=new WeakMap,n=async(r,i)=>{const o=i.destination;return e.set(i,o),await t(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):n(r,i)}}},PB=(t,e,n,r,i,o,s,a)=>(c,l)=>{const u=l.listener,d=()=>{const w=new Float32Array(1),A=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),x=s(l);let T=!1,_=[0,0,-1,0,1,0],O=[0,0,0];const L=()=>{if(T)return;T=!0;const J=r(l,256,9,0);J.onaudioprocess=({inputBuffer:ee})=>{const re=[o(ee,w,0),o(ee,w,1),o(ee,w,2),o(ee,w,3),o(ee,w,4),o(ee,w,5)];re.some(($,ie)=>$!==_[ie])&&(u.setOrientation(...re),_=re);const X=[o(ee,w,6),o(ee,w,7),o(ee,w,8)];X.some(($,ie)=>$!==O[ie])&&(u.setPosition(...X),O=X)},A.connect(J)},U=J=>ee=>{ee!==_[J]&&(_[J]=ee,u.setOrientation(..._))},z=J=>ee=>{ee!==O[J]&&(O[J]=ee,u.setPosition(...O))},Z=(J,ee,re)=>{const X=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ee});X.connect(A,0,J),X.start(),Object.defineProperty(X.offset,"defaultValue",{get(){return ee}});const $=t({context:c},x,X.offset,Yn,mr);return a($,"value",ie=>()=>ie.call($),ie=>j=>{try{ie.call($,j)}catch(oe){if(oe.code!==9)throw oe}L(),x&&re(j)}),$.cancelAndHoldAtTime=(ie=>x?()=>{throw i()}:(...j)=>{const oe=ie.apply($,j);return L(),oe})($.cancelAndHoldAtTime),$.cancelScheduledValues=(ie=>x?()=>{throw i()}:(...j)=>{const oe=ie.apply($,j);return L(),oe})($.cancelScheduledValues),$.exponentialRampToValueAtTime=(ie=>x?()=>{throw i()}:(...j)=>{const oe=ie.apply($,j);return L(),oe})($.exponentialRampToValueAtTime),$.linearRampToValueAtTime=(ie=>x?()=>{throw i()}:(...j)=>{const oe=ie.apply($,j);return L(),oe})($.linearRampToValueAtTime),$.setTargetAtTime=(ie=>x?()=>{throw i()}:(...j)=>{const oe=ie.apply($,j);return L(),oe})($.setTargetAtTime),$.setValueAtTime=(ie=>x?()=>{throw i()}:(...j)=>{const oe=ie.apply($,j);return L(),oe})($.setValueAtTime),$.setValueCurveAtTime=(ie=>x?()=>{throw i()}:(...j)=>{const oe=ie.apply($,j);return L(),oe})($.setValueCurveAtTime),$};return{forwardX:Z(0,0,U(0)),forwardY:Z(1,0,U(1)),forwardZ:Z(2,-1,U(2)),positionX:Z(6,0,z(0)),positionY:Z(7,0,z(1)),positionZ:Z(8,0,z(2)),upX:Z(3,0,U(3)),upY:Z(4,1,U(4)),upZ:Z(5,0,U(5))}},{forwardX:h,forwardY:f,forwardZ:p,positionX:m,positionY:C,positionZ:g,upX:v,upY:S,upZ:k}=u.forwardX===void 0?d():u;return{get forwardX(){return h},get forwardY(){return f},get forwardZ(){return p},get positionX(){return m},get positionY(){return C},get positionZ(){return g},get upX(){return v},get upY(){return S},get upZ(){return k}}},dp=t=>"context"in t,Jd=t=>dp(t[0]),mc=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},lw=(t,e,[n,r],i)=>{mc(t,[e,n,r],o=>o[0]===e&&o[1]===n,i)},uw=(t,[e,n,r],i)=>{const o=t.get(e);o===void 0?t.set(e,new Set([[n,r]])):mc(o,[n,r],s=>s[0]===n,i)},Dl=t=>"inputs"in t,hp=(t,e,n,r)=>{if(Dl(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},VT=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},NB=(t,e,n)=>rg(t,r=>r[0]===e&&r[1]===n),GT=(t,e)=>{if(!Xd(t).delete(e))throw new Error("Missing the expected event listener.")},WT=(t,e,n)=>{const r=Li(t,e),i=rg(r,o=>o[0]===n);return r.size===0&&t.delete(e),i},fp=(t,e,n,r)=>{Dl(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},Pt=t=>Li(PT,t),bd=t=>Li(_T,t),oc=t=>qv.has(t),df=t=>!Il.has(t),dw=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),o=t.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;const a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),pm=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const o=n.get(i);n.set(i,o===void 0?1:o+1)}n.forEach((r,i)=>e(i,r))},pp=t=>"context"in t,_B=t=>{const e=new Map;t.connect=(n=>(r,i=0,o=0)=>{const s=pp(r)?n(r,i,o):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:o,output:i}]):a.every(c=>c.input!==o||c.output!==i)&&a.push({input:o,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(r,i,o)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[s,a]of e){const c=a.filter(l=>l.output!==r);c.length===0?e.delete(s):e.set(s,c)}else if(e.has(r))if(i===void 0)e.delete(r);else{const s=e.get(r);if(s!==void 0){const a=s.filter(c=>c.output!==i&&(c.input!==o||o===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[s,a]of e)a.forEach(c=>{pp(s)?t.connect(s,c.output,c.input):t.connect(s,c.output)})})(t.disconnect)},OB=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=Kd(e),{outputs:s}=er(t),a=Xd(t),c=l=>{const u=Pt(t),d=bd(e);if(l){const h=WT(o,t,n);lw(i,t,h,!1),!r&&!oc(t)&&u.connect(d,n)}else{const h=NB(i,t,n);uw(o,h,!1),!r&&!oc(t)&&u.disconnect(d,n)}};return mc(s,[e,n],l=>l[0]===e&&l[1]===n,!0)?(a.add(c),ls(t)?lw(i,t,[n,c],!0):uw(o,[t,n,c],!0),!0):!1},MB=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=er(e),s=VT(i[r],t,n);return s===null?[LT(o,t,n,r)[2],!1]:[s[2],!0]},DB=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=Kd(e),o=VT(r,t,n);return o===null?[WT(i,t,n)[1],!1]:[o[2],!0]},AC=(t,e,n,r,i)=>{const[o,s]=MB(t,n,r,i);if(o!==null&&(GT(t,o),s&&!e&&!oc(t)&&fp(Pt(t),Pt(n),r,i)),ls(n)){const{activeInputs:a}=er(n);n0(n,a)}},kC=(t,e,n,r)=>{const[i,o]=DB(t,n,r);i!==null&&(GT(t,i),o&&!e&&!oc(t)&&Pt(t).disconnect(bd(n),r))},LB=(t,e)=>{const n=er(t),r=[];for(const i of n.outputs)Jd(i)?AC(t,e,...i):kC(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},FB=(t,e,n)=>{const r=er(t),i=[];for(const o of r.outputs)o[1]===n&&(Jd(o)?AC(t,e,...o):kC(t,e,...o),i.push(o[0]),r.outputs.delete(o));return i},BB=(t,e,n,r,i)=>{const o=er(t);return Array.from(o.outputs).filter(s=>s[0]===n&&(r===void 0||s[1]===r)&&(i===void 0||s[2]===i)).map(s=>(Jd(s)?AC(t,e,...s):kC(t,e,...s),o.outputs.delete(s),s[0]))},UB=(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m)=>class extends l{constructor(g,v,S,k){super(S),this._context=g,this._nativeAudioNode=S;const w=u(g);d(w)&&n(dw,()=>dw(w,m))!==!0&&_B(S),PT.set(this,S),MT.set(this,new Set),g.state!=="closed"&&v&&Sl(this),t(this,k,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,v=0,S=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const k=u(this._context),w=p(k);if(h(g)||f(g))throw o();if(dp(g)){const T=Pt(g);try{const O=hp(this._nativeAudioNode,T,v,S),L=df(this);(w||L)&&this._nativeAudioNode.disconnect(...O),this.context.state!=="closed"&&!L&&df(g)&&Sl(g)}catch(O){throw O.code===12?o():O}if(e(this,g,v,S,w)){const O=c([this],g);pm(O,r(w))}return g}const A=bd(g);if(A.name==="playbackRate"&&A.maxValue===1024)throw s();try{this._nativeAudioNode.connect(A,v),(w||df(this))&&this._nativeAudioNode.disconnect(A,v)}catch(T){throw T.code===12?o():T}if(OB(this,g,v,w)){const T=c([this],g);pm(T,r(w))}}disconnect(g,v,S){let k;const w=u(this._context),A=p(w);if(g===void 0)k=LB(this,A);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw i();k=FB(this,A,g)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||dp(g)&&S!==void 0&&(S<0||S>=g.numberOfInputs))throw i();if(k=BB(this,A,g,v,S),k.length===0)throw o()}for(const x of k){const T=c([this],x);pm(T,a)}}},VB=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>(f,p,m,C=null,g=null)=>{const v=m.value,S=new KF(v),k=p?r(S):null,w={get defaultValue(){return v},get maxValue(){return C===null?m.maxValue:C},get minValue(){return g===null?m.minValue:g},get value(){return m.value},set value(A){m.value=A,w.setValueAtTime(A,f.context.currentTime)},cancelAndHoldAtTime(A){if(typeof m.cancelAndHoldAtTime=="function")k===null&&S.flush(f.context.currentTime),S.add(i(A)),m.cancelAndHoldAtTime(A);else{const x=Array.from(S).pop();k===null&&S.flush(f.context.currentTime),S.add(i(A));const T=Array.from(S).pop();m.cancelScheduledValues(A),x!==T&&T!==void 0&&(T.type==="exponentialRampToValue"?m.exponentialRampToValueAtTime(T.value,T.endTime):T.type==="linearRampToValue"?m.linearRampToValueAtTime(T.value,T.endTime):T.type==="setValue"?m.setValueAtTime(T.value,T.startTime):T.type==="setValueCurve"&&m.setValueCurveAtTime(T.values,T.startTime,T.duration))}return w},cancelScheduledValues(A){return k===null&&S.flush(f.context.currentTime),S.add(o(A)),m.cancelScheduledValues(A),w},exponentialRampToValueAtTime(A,x){if(A===0)throw new RangeError;if(!Number.isFinite(x)||x<0)throw new RangeError;const T=f.context.currentTime;return k===null&&S.flush(T),Array.from(S).length===0&&(S.add(l(v,T)),m.setValueAtTime(v,T)),S.add(s(A,x)),m.exponentialRampToValueAtTime(A,x),w},linearRampToValueAtTime(A,x){const T=f.context.currentTime;return k===null&&S.flush(T),Array.from(S).length===0&&(S.add(l(v,T)),m.setValueAtTime(v,T)),S.add(a(A,x)),m.linearRampToValueAtTime(A,x),w},setTargetAtTime(A,x,T){return k===null&&S.flush(f.context.currentTime),S.add(c(A,x,T)),m.setTargetAtTime(A,x,T),w},setValueAtTime(A,x){return k===null&&S.flush(f.context.currentTime),S.add(l(A,x)),m.setValueAtTime(A,x),w},setValueCurveAtTime(A,x,T){const _=A instanceof Float32Array?A:new Float32Array(A);if(d!==null&&d.name==="webkitAudioContext"){const O=x+T,L=f.context.sampleRate,U=Math.ceil(x*L),z=Math.floor(O*L),Z=z-U,J=new Float32Array(Z);for(let re=0;re<Z;re+=1){const X=(_.length-1)/T*((U+re)/L-x),$=Math.floor(X),ie=Math.ceil(X);J[re]=$===ie?_[$]:(1-(X-$))*_[$]+(1-(ie-X))*_[ie]}k===null&&S.flush(f.context.currentTime),S.add(u(J,x,T)),m.setValueCurveAtTime(J,x,T);const ee=z/L;ee<O&&h(w,J[J.length-1],ee),h(w,_[_.length-1],O)}else k===null&&S.flush(f.context.currentTime),S.add(u(_,x,T)),m.setValueCurveAtTime(_,x,T);return w}};return n.set(w,m),e.set(w,f),t(w,k),w},GB=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=n;e.setTargetAtTime(i,r,o)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=n;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class jT{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const WB={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},jB=(t,e,n,r,i,o,s,a,c,l,u,d,h,f)=>class extends e{constructor(m,C,g){var v;const S=a(m),k=c(S),w=u({...WB,...g});h(w);const A=e0.get(S),x=A==null?void 0:A.get(C),T=k||S.state!=="closed"?S:(v=s(S))!==null&&v!==void 0?v:S,_=i(T,k?null:m.baseLatency,l,C,x,w),O=k?r(C,w,x):null;super(m,!0,_,O);const L=[];_.parameters.forEach((z,Z)=>{const J=n(this,k,z);L.push([Z,J])}),this._nativeAudioWorkletNode=_,this._onprocessorerror=null,this._parameters=new jT(L),k&&t(S,this);const{activeInputs:U}=o(this);d(_,U)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(m){const C=typeof m=="function"?f(this,m):null;this._nativeAudioWorkletNode.onprocessorerror=C;const g=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=g!==null&&g===C?m:g}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function gp(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const o=t.getChannelData(r);if(e[n].byteLength===0)e[n]=o.slice(i,i+128);else{const s=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(s)}}}const ZT=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},mp=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let s=0;s<o;s+=1)i.push(new Float32Array(128));n.push(i)}return n},ZB=(t,e)=>{const n=Li(t0,t),r=Pt(e);return Li(n,r)},HB=async(t,e,n,r,i,o,s)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=i.reduce((C,g)=>C+g,0),u=l===0?null:n.createBuffer(l,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=er(t),h=await ZB(n,t),f=mp(r.numberOfInputs,r.channelCount),p=mp(r.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce((C,g)=>({...C,[g]:new Float32Array(128)}),{});for(let C=0;C<a;C+=128){if(r.numberOfInputs>0&&e!==null)for(let g=0;g<r.numberOfInputs;g+=1)for(let v=0;v<r.channelCount;v+=1)gp(e,f[g],v,v,C);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:g},v)=>{gp(e,m,g,c+v,C)});for(let g=0;g<r.numberOfInputs;g+=1)for(let v=0;v<i[g];v+=1)p[g][v].byteLength===0&&(p[g][v]=new Float32Array(128));try{const g=f.map((S,k)=>d.activeInputs[k].size===0?[]:S),v=s(C/n.sampleRate,n.sampleRate,()=>h.process(g,p,m));if(u!==null)for(let S=0,k=0;S<r.numberOfOutputs;S+=1){for(let w=0;w<i[S];w+=1)ZT(u,p[S],w,k+w,C);k+=i[S]}if(!v)break}catch(g){t.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return u},zB=(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m)=>(C,g,v)=>{const S=new WeakMap;let k=null;const w=async(A,x)=>{let T=u(A),_=null;const O=zn(T,x),L=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(d===null){const U=L.reduce((ee,re)=>ee+re,0),z=i(x,{channelCount:Math.max(1,U),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,U)}),Z=[];for(let ee=0;ee<A.numberOfOutputs;ee+=1)Z.push(r(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:L[ee]}));const J=s(x,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});J.connect=e.bind(null,Z),J.disconnect=c.bind(null,Z),_=[z,Z,J]}else O||(T=new d(x,C));if(S.set(x,_===null?T:_[2]),_!==null){if(k===null){if(v===void 0)throw new Error("Missing the processor constructor.");if(h===null)throw new Error("Missing the native OfflineAudioContext constructor.");const re=A.channelCount*A.numberOfInputs,X=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length,$=re+X;k=HB(A,$===0?null:await(async()=>{const j=new h($,Math.ceil(A.context.length/128)*128,x.sampleRate),oe=[],ke=[];for(let Pe=0;Pe<g.numberOfInputs;Pe+=1)oe.push(s(j,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),ke.push(i(j,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const Le=await Promise.all(Array.from(A.parameters.values()).map(async Pe=>{const Ye=o(j,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Pe.value});return await f(j,Pe,Ye.offset),Ye})),de=r(j,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,re+X)});for(let Pe=0;Pe<g.numberOfInputs;Pe+=1){oe[Pe].connect(ke[Pe]);for(let Ye=0;Ye<g.channelCount;Ye+=1)ke[Pe].connect(de,Ye,Pe*g.channelCount+Ye)}for(const[Pe,Ye]of Le.entries())Ye.connect(de,0,re+Pe),Ye.start(0);return de.connect(j.destination),await Promise.all(oe.map(Pe=>p(A,j,Pe))),m(j)})(),x,g,L,v,l)}const U=await k,z=n(x,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[Z,J,ee]=_;U!==null&&(z.buffer=U,z.start(0)),z.connect(Z);for(let re=0,X=0;re<A.numberOfOutputs;re+=1){const $=J[re];for(let ie=0;ie<L[re];ie+=1)Z.connect($,X+ie,ie);X+=L[re]}return ee}if(O)for(const[U,z]of A.parameters.entries())await t(x,z,T.parameters.get(U));else for(const[U,z]of A.parameters.entries())await f(x,z,T.parameters.get(U));return await p(A,x,T),T};return{render(A,x){a(x,A);const T=S.get(x);return T!==void 0?Promise.resolve(T):w(A,x)}}},XB=(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m,C,g,v,S)=>class extends p{constructor(w,A){super(w,A),this._nativeContext=w,this._audioWorklet=t===void 0?void 0:{addModule:(x,T)=>t(this,x,T)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(w,A,x){return new n({length:A,numberOfChannels:w,sampleRate:x})}createBufferSource(){return new r(this)}createChannelMerger(w=6){return new o(this,{numberOfInputs:w})}createChannelSplitter(w=6){return new s(this,{numberOfOutputs:w})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(w=1){return new u(this,{maxDelayTime:w})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(w,A){return new f(this,{feedback:A,feedforward:w})}createOscillator(){return new m(this)}createPanner(){return new C(this)}createPeriodicWave(w,A,x={disableNormalization:!1}){return new g(this,{...x,imag:A,real:w})}createStereoPanner(){return new v(this)}createWaveShaper(){return new S(this)}decodeAudioData(w,A,x){return l(this._nativeContext,w).then(T=>(typeof A=="function"&&A(T),T),T=>{throw typeof x=="function"&&x(T),T})}},$B={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},KB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h={...$B,...u},f=i(d,h),p=s(d),m=p?n():null;super(l,!1,f,m),this._Q=e(this,p,f.Q,Yn,mr),this._detune=e(this,p,f.detune,1200*Math.log2(Yn),-1200*Math.log2(Yn)),this._frequency=e(this,p,f.frequency,l.sampleRate/2,0),this._gain=e(this,p,f.gain,40*Math.log10(Yn),mr),this._nativeBiquadFilterNode=f,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(h){throw h.code===11?r():h}if(l.length!==u.length||u.length!==d.length)throw r()}},JB=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=zn(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,d)}return o.set(c,l),u?(await t(c,a.Q,l.Q),await t(c,a.detune,l.detune),await t(c,a.frequency,l.frequency),await t(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},YB=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const o=t.get(n);if(o!==void 0)return o;try{const s=r();return s instanceof Promise?(t.set(n,s),s.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,s),s)}catch{return e.set(n,!1),!1}},QB={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},qB=(t,e,n,r,i)=>class extends t{constructor(s,a){const c=r(s),l={...QB,...a},u=n(c,l),d=i(c)?e():null;super(s,!1,u,d)}},e3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!zn(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},t3={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},n3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u=o({...t3,...c}),d=n(l,u),h=i(l)?e():null;super(a,!1,d,h)}},r3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!zn(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},i3=t=>(e,n,r)=>t(n,e,r),o3=t=>(e,n,r=0,i=0)=>{const o=e[r];if(o===void 0)throw t();return pp(n)?o.connect(n,0,i):o.connect(n,0)},s3=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},a3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},c3=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...a3,...l},h=r(u,d),f=o(u),p=f?n():null;super(c,!1,h,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=h,this._offset=e(this,f,h.offset,Yn,mr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?s(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){Sl(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),ls(this)&&$d(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},l3=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const c=async(l,u)=>{let d=n(l);const h=zn(d,u);if(!h){const f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,f),s!==null&&d.start(s),a!==null&&d.stop(a)}return o.set(u,d),h?await t(u,l.offset,d.offset):await r(u,l.offset,d.offset),await i(l,u,d),d};return{set start(l){s=l},set stop(l){a=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},u3=t=>e=>(t[0]=e,t[0]),d3={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},h3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u={...d3,...c},d=n(l,u),f=i(l)?e():null;super(a,!1,d,f),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},f3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!zn(a,s)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(s,l)}return r.set(s,a),Dl(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},p3=()=>new DOMException("","DataCloneError"),hw=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},g3=(t,e,n,r,i,o,s,a,c,l,u)=>(d,h)=>{const f=s(d)?d:o(d);if(i.has(h)){const p=n();return Promise.reject(p)}try{i.add(h)}catch{}return e(c,()=>c(f))?f.decodeAudioData(h).then(p=>(hw(h).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,m)=>{const C=async()=>{try{await hw(h)}catch{}},g=v=>{m(v),C()};try{f.decodeAudioData(h,v=>{typeof v.copyFromChannel!="function"&&(l(v),BT(v)),t.add(v),C().then(()=>p(v))},v=>{g(v===null?r():v)})}catch(v){g(v)}})},m3=(t,e,n,r,i,o,s,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(c.context),h=a(d);if(u===l){if(e.delete(c),!h&&s(c)){const f=r(c),{outputs:p}=n(c);for(const m of p)if(Jd(m)){const C=r(m[0]);t(f,C,m[1],m[2])}else{const C=i(m[0]);f.connect(C,m[1])}}}else e.set(c,u-l)},v3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},y3=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...v3,...l},h=r(u,d),f=o(u),p=f?n(d.maxDelayTime):null;super(c,!1,h,p),this._delayTime=e(this,f,h.delayTime),s(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},C3=(t,e,n,r,i)=>o=>{const s=new WeakMap,a=async(c,l)=>{let u=n(c);const d=zn(u,l);if(!d){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(l,h)}return s.set(l,u),d?await t(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=s.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},I3=t=>(e,n,r,i)=>t(e[i],o=>o[0]===n&&o[1]===r),S3=t=>(e,n)=>{t(e).delete(n)},b3=t=>"delayTime"in t,w3=(t,e,n)=>function r(i,o){const s=dp(o)?o:n(t,o);if(b3(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=e(s);return Array.from(a).map(c=>r([...i,s],c[0])).reduce((c,l)=>c.concat(l),[])},_h=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},A3=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(o=>o.disconnect()):typeof n=="number"?_h(t,e,n).disconnect():pp(n)?r===void 0?e.forEach(o=>o.disconnect(n)):i===void 0?_h(t,e,r).disconnect(n,0):_h(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(o=>o.disconnect(n)):_h(t,e,r).disconnect(n,0),k3={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},E3=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h={...k3,...u},f=r(d,h),p=s(d),m=p?n():null;super(l,!1,f,m),this._attack=e(this,p,f.attack),this._knee=e(this,p,f.knee),this._nativeDynamicsCompressorNode=f,this._ratio=e(this,p,f.ratio),this._release=e(this,p,f.release),this._threshold=e(this,p,f.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},T3=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=zn(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,d)}return o.set(c,l),u?(await t(c,a.attack,l.attack),await t(c,a.knee,l.knee),await t(c,a.ratio,l.ratio),await t(c,a.release,l.release),await t(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},R3=()=>new DOMException("","EncodingError"),x3=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const o=t.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(u,d,h,f,p)=>{if(d===a||d===t.location.href&&h===1&&f===1)return l(),r(p),!1;if(c!==null)return c(u,d,h,f,p)},o.onerror=()=>{l(),r(new SyntaxError)},o.onload=()=>{l(),n()},o.src=a,o.type="module",i.appendChild(o)}}),P3=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=t(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,i)}},N3=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},_3=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},O3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},M3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...O3,...c},d=r(l,u),h=o(l),f=h?n():null;super(a,!1,d,f),this._gain=e(this,h,d.gain,Yn,mr)}get gain(){return this._gain}},D3=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=zn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,d)}return o.set(c,l),u?await t(c,a.gain,l.gain):await r(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},L3=(t,e)=>n=>e(t,n),F3=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},B3=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},U3=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},V3=t=>e=>t.get(e),Nn=()=>new DOMException("","InvalidStateError"),G3=t=>e=>{const n=t.get(e);if(n===void 0)throw Nn();return n},W3=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},j3=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},ig=()=>new DOMException("","InvalidAccessError"),Z3=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw ig();return e.call(t,n,r,i)})(t.getFrequencyResponse)},H3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},z3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u=i(l),d={...H3,...c},h=e(l,u?null:a.baseLatency,d),f=u?n(d.feedback,d.feedforward):null;super(a,!1,h,f),Z3(h),this._nativeIIRFilterNode=h,o(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},HT=(t,e,n,r,i,o,s,a,c,l,u)=>{const d=l.length;let h=a;for(let f=0;f<d;f+=1){let p=n[0]*l[f];for(let m=1;m<i;m+=1){const C=h-m&c-1;p+=n[m]*o[C],p-=t[m]*s[C]}for(let m=i;m<r;m+=1)p+=n[m]*o[h-m&c-1];for(let m=i;m<e;m+=1)p-=t[m]*s[h-m&c-1];o[h]=l[f],s[h]=p,h=h+1&c-1,u[f]=p}return h},X3=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,c=Math.min(s,a);if(i[0]!==1){for(let p=0;p<s;p+=1)o[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),f=t.numberOfChannels;for(let p=0;p<f;p+=1){const m=t.getChannelData(p),C=h.getChannelData(p);u.fill(0),d.fill(0),HT(i,s,o,a,c,u,d,0,l,m,C)}return h},$3=(t,e,n,r,i)=>(o,s)=>{const a=new WeakMap;let c=null;const l=async(u,d)=>{let h=null,f=e(u);const p=zn(f,d);if(d.createIIRFilter===void 0?h=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(f=d.createIIRFilter(s,o)),a.set(d,h===null?f:h),h!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,C,C.destination);const g=await i(C);return X3(g,d,o,s)})()}const m=await c;return h.buffer=m,h.start(0),h}return await r(u,d,f),f};return{render(u,d){const h=a.get(d);return h!==void 0?Promise.resolve(h):l(u,d)}}},K3=(t,e,n,r,i,o)=>s=>(a,c)=>{const l=t.get(a);if(l===void 0){if(!s&&o(a)){const u=r(a),{outputs:d}=n(a);for(const h of d)if(Jd(h)){const f=r(h[0]);e(u,f,h[1],h[2])}else{const f=i(h[0]);u.disconnect(f,h[1])}}t.set(a,c)}else t.set(a,l+c)},J3=t=>e=>t!==null&&e instanceof t,Y3=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,Q3=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,q3=(t,e)=>n=>t(n)||e(n),e5=t=>e=>t!==null&&e instanceof t,t5=t=>t!==null&&t.isSecureContext,n5=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),c=e(a,s);if(r(a))throw TypeError();super(o,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},r5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},i5=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o);if(r(a))throw new TypeError;const c={...r5,...s},l=e(a,c);super(o,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},o5=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),c=e(a,s);if(r(a))throw new TypeError;super(o,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},s5=(t,e,n)=>class extends t{constructor(i,o){const s=n(i),a=e(s,o);super(i,!0,a,null)}},a5=(t,e,n,r,i,o)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,OT.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},o0=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},c5=(t,e)=>(n,r,i)=>{const o=new Set;return n.connect=(s=>(a,c=0,l=0)=>{const u=o.size===0;if(e(a))return s.call(n,a,c,l),t(o,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;s.call(n,a,c),t(o,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(s=>(a,c,l)=>{const u=o.size>0;if(a===void 0)s.apply(n),o.clear();else if(typeof a=="number"){s.call(n,a);for(const h of o)h[1]===a&&o.delete(h)}else{e(a)?s.call(n,a,c,l):s.call(n,a,c);for(const h of o)h[0]===a&&(c===void 0||h[1]===c)&&(l===void 0||h[2]===l)&&o.delete(h)}const d=o.size===0;u&&d&&i()})(n.disconnect),n},_t=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},pn=(t,e)=>{_t(t,e,"channelCount"),_t(t,e,"channelCountMode"),_t(t,e,"channelInterpretation")},fw=t=>typeof t.getFloatTimeDomainData=="function",l5=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},u5=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(pn(i,r),!(r.maxDecibels>r.minDecibels))throw e();return _t(i,r,"fftSize"),_t(i,r,"maxDecibels"),_t(i,r,"minDecibels"),_t(i,r,"smoothingTimeConstant"),t(fw,()=>fw(i))||l5(i),i},d5=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Gt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},h5=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw Nn();e.call(t,r,i,o),n=!0}})(t.start)},EC=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},TC=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},f5=(t,e,n,r,i,o,s,a,c,l,u)=>(d,h)=>{const f=d.createBufferSource();return pn(f,h),Gt(f,h,"playbackRate"),_t(f,h,"buffer"),_t(f,h,"loop"),_t(f,h,"loopEnd"),_t(f,h,"loopStart"),e(n,()=>n(d))||h5(f),e(r,()=>r(d))||c(f),e(i,()=>i(d))||l(f,d),e(o,()=>o(d))||EC(f),e(s,()=>s(d))||u(f,d),e(a,()=>a(d))||TC(f),t(d,f),f},p5=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,g5=(t,e)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=t(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>c=>{a.call(s,c);try{o.channelCount=c}catch(l){if(c>o.maxChannelCount)throw l}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>c=>{a.call(s,c),o.channelCountMode=c}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>c=>{a.call(s,c),o.channelInterpretation=c}),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s},m5=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,v5=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},y5=(t,e,n,r,i)=>(o,s,a,c,l,u)=>{if(a!==null)try{const d=new a(o,c,u),h=new Map;let f=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>f,set:p=>{typeof f=="function"&&d.removeEventListener("processorerror",f),f=typeof p=="function"?p:null,typeof f=="function"&&d.addEventListener("processorerror",f)}}}),d.addEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=typeof m[1]=="function"?m[1]:typeof m[1]=="object"&&m[1]!==null&&typeof m[1].handleEvent=="function"?m[1].handleEvent:null;if(C!==null){const g=h.get(m[1]);g!==void 0?m[1]=g:(m[1]=v=>{v.type==="error"?(Object.defineProperties(v,{type:{value:"processorerror"}}),C(v)):C(new ErrorEvent(m[0],{...v}))},h.set(C,m[1]))}}return p.call(d,"error",m[1],m[2]),p.call(d,...m)})(d.addEventListener),d.removeEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=h.get(m[1]);C!==void 0&&(h.delete(m[1]),m[1]=C)}return p.call(d,"error",m[1],m[2]),p.call(d,m[0],m[1],m[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(o.destination),i(d,()=>p.disconnect(),()=>p.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(l===void 0)throw r();return v5(u),e(o,s,l,u)},zT=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),C5=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),n(o)},i.postMessage(t)}),I5=async(t,e)=>{const n=await C5(e);return new t(n)},S5=(t,e,n,r)=>{let i=t0.get(t);i===void 0&&(i=new WeakMap,t0.set(t,i));const o=I5(n,r);return i.set(e,o),o},b5=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>(f,p,m,C)=>{if(C.numberOfInputs===0&&C.numberOfOutputs===0)throw c();const g=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(g.some(ue=>ue<1))throw c();if(g.length!==C.numberOfOutputs)throw e();if(C.channelCountMode!=="explicit")throw c();const v=C.channelCount*C.numberOfInputs,S=g.reduce((ue,be)=>ue+be,0),k=m.parameterDescriptors===void 0?0:m.parameterDescriptors.length;if(v+k>6||S>6)throw c();const w=new MessageChannel,A=[],x=[];for(let ue=0;ue<C.numberOfInputs;ue+=1)A.push(s(f,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),x.push(i(f,{channelCount:C.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:C.channelCount}));const T=[];if(m.parameterDescriptors!==void 0)for(const{defaultValue:ue,maxValue:be,minValue:Ge,name:Ve}of m.parameterDescriptors){const Me=o(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C.parameterData[Ve]!==void 0?C.parameterData[Ve]:ue===void 0?0:ue});Object.defineProperties(Me.offset,{defaultValue:{get:()=>ue===void 0?0:ue},maxValue:{get:()=>be===void 0?Yn:be},minValue:{get:()=>Ge===void 0?mr:Ge}}),T.push(Me)}const _=r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+k)}),O=zT(p,f.sampleRate),L=a(f,O,v+k,Math.max(1,S)),U=i(f,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),z=[];for(let ue=0;ue<C.numberOfOutputs;ue+=1)z.push(r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[ue]}));for(let ue=0;ue<C.numberOfInputs;ue+=1){A[ue].connect(x[ue]);for(let be=0;be<C.channelCount;be+=1)x[ue].connect(_,be,ue*C.channelCount+be)}const Z=new jT(m.parameterDescriptors===void 0?[]:m.parameterDescriptors.map(({name:ue},be)=>{const Ge=T[be];return Ge.connect(_,0,v+be),Ge.start(0),[ue,Ge.offset]}));_.connect(L);let J=C.channelInterpretation,ee=null;const re=C.numberOfOutputs===0?[L]:z,X={get bufferSize(){return O},get channelCount(){return C.channelCount},set channelCount(ue){throw n()},get channelCountMode(){return C.channelCountMode},set channelCountMode(ue){throw n()},get channelInterpretation(){return J},set channelInterpretation(ue){for(const be of A)be.channelInterpretation=ue;J=ue},get context(){return L.context},get inputs(){return A},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get onprocessorerror(){return ee},set onprocessorerror(ue){typeof ee=="function"&&X.removeEventListener("processorerror",ee),ee=typeof ue=="function"?ue:null,typeof ee=="function"&&X.addEventListener("processorerror",ee)},get parameters(){return Z},get port(){return w.port2},addEventListener(...ue){return L.addEventListener(ue[0],ue[1],ue[2])},connect:t.bind(null,re),disconnect:l.bind(null,re),dispatchEvent(...ue){return L.dispatchEvent(ue[0])},removeEventListener(...ue){return L.removeEventListener(ue[0],ue[1],ue[2])}},$=new Map;w.port1.addEventListener=(ue=>(...be)=>{if(be[0]==="message"){const Ge=typeof be[1]=="function"?be[1]:typeof be[1]=="object"&&be[1]!==null&&typeof be[1].handleEvent=="function"?be[1].handleEvent:null;if(Ge!==null){const Ve=$.get(be[1]);Ve!==void 0?be[1]=Ve:(be[1]=Me=>{u(f.currentTime,f.sampleRate,()=>Ge(Me))},$.set(Ge,be[1]))}}return ue.call(w.port1,be[0],be[1],be[2])})(w.port1.addEventListener),w.port1.removeEventListener=(ue=>(...be)=>{if(be[0]==="message"){const Ge=$.get(be[1]);Ge!==void 0&&($.delete(be[1]),be[1]=Ge)}return ue.call(w.port1,be[0],be[1],be[2])})(w.port1.removeEventListener);let ie=null;Object.defineProperty(w.port1,"onmessage",{get:()=>ie,set:ue=>{typeof ie=="function"&&w.port1.removeEventListener("message",ie),ie=typeof ue=="function"?ue:null,typeof ie=="function"&&(w.port1.addEventListener("message",ie),w.port1.start())}}),m.prototype.port=w.port1;let j=null;S5(f,X,m,C).then(ue=>j=ue);const ke=mp(C.numberOfInputs,C.channelCount),Le=mp(C.numberOfOutputs,g),de=m.parameterDescriptors===void 0?[]:m.parameterDescriptors.reduce((ue,{name:be})=>({...ue,[be]:new Float32Array(128)}),{});let Pe=!0;const Ye=()=>{C.numberOfOutputs>0&&L.disconnect(U);for(let ue=0,be=0;ue<C.numberOfOutputs;ue+=1){const Ge=z[ue];for(let Ve=0;Ve<g[ue];Ve+=1)U.disconnect(Ge,be+Ve,Ve);be+=g[ue]}},ve=new Map;L.onaudioprocess=({inputBuffer:ue,outputBuffer:be})=>{if(j!==null){const Ge=d(X);for(let Ve=0;Ve<O;Ve+=128){for(let Me=0;Me<C.numberOfInputs;Me+=1)for(let qe=0;qe<C.channelCount;qe+=1)gp(ue,ke[Me],qe,qe,Ve);m.parameterDescriptors!==void 0&&m.parameterDescriptors.forEach(({name:Me},qe)=>{gp(ue,de,Me,v+qe,Ve)});for(let Me=0;Me<C.numberOfInputs;Me+=1)for(let qe=0;qe<g[Me];qe+=1)Le[Me][qe].byteLength===0&&(Le[Me][qe]=new Float32Array(128));try{const Me=ke.map((Bt,Mt)=>{if(Ge[Mt].size>0)return ve.set(Mt,O/128),Bt;const wn=ve.get(Mt);return wn===void 0?[]:(Bt.every($t=>$t.every(ur=>ur===0))&&(wn===1?ve.delete(Mt):ve.set(Mt,wn-1)),Bt)});Pe=u(f.currentTime+Ve/f.sampleRate,f.sampleRate,()=>j.process(Me,Le,de));for(let Bt=0,Mt=0;Bt<C.numberOfOutputs;Bt+=1){for(let Wt=0;Wt<g[Bt];Wt+=1)ZT(be,Le[Bt],Wt,Mt+Wt,Ve);Mt+=g[Bt]}}catch(Me){Pe=!1,X.dispatchEvent(new ErrorEvent("processorerror",{colno:Me.colno,filename:Me.filename,lineno:Me.lineno,message:Me.message}))}if(!Pe){for(let Me=0;Me<C.numberOfInputs;Me+=1){A[Me].disconnect(x[Me]);for(let qe=0;qe<C.channelCount;qe+=1)x[Ve].disconnect(_,qe,Me*C.channelCount+qe)}if(m.parameterDescriptors!==void 0){const Me=m.parameterDescriptors.length;for(let qe=0;qe<Me;qe+=1){const Bt=T[qe];Bt.disconnect(_,0,v+qe),Bt.stop()}}_.disconnect(L),L.onaudioprocess=null,rn?Ye():vt();break}}}};let rn=!1;const Sn=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),st=()=>L.connect(Sn).connect(f.destination),vt=()=>{L.disconnect(Sn),Sn.disconnect()},bn=()=>{if(Pe){vt(),C.numberOfOutputs>0&&L.connect(U);for(let ue=0,be=0;ue<C.numberOfOutputs;ue+=1){const Ge=z[ue];for(let Ve=0;Ve<g[ue];Ve+=1)U.connect(Ge,be+Ve,Ve);be+=g[ue]}}rn=!0},on=()=>{Pe&&(st(),Ye()),rn=!1};return st(),h(X,bn,on)},XT=(t,e)=>{const n=t.createBiquadFilter();return pn(n,e),Gt(n,e,"Q"),Gt(n,e,"detune"),Gt(n,e,"frequency"),Gt(n,e,"gain"),_t(n,e,"type"),n},w5=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),pn(i,r),i},A5=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw Nn()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Nn()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Nn()}})},Yd=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return pn(n,e),A5(n),n},k5=(t,e,n,r,i)=>(o,s)=>{if(o.createConstantSource===void 0)return n(o,s);const a=o.createConstantSource();return pn(a,s),Gt(a,s,"offset"),e(r,()=>r(o))||EC(a),e(i,()=>i(o))||TC(a),t(o,a),a},Ll=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),E5=(t,e,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},h=()=>c.connect(l),f=()=>c.disconnect(l);return t(i,c),r(Ll(d,l),h,f)},T5=(t,e)=>(n,r)=>{const i=n.createConvolver();if(pn(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),_t(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>s=>{if(s>2)throw t();return o.call(i,s)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",o=>()=>o.call(i),o=>s=>{if(s==="max")throw t();return o.call(i,s)}),i},$T=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return pn(n,e),Gt(n,e,"delayTime"),n},R5=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(pn(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Gt(r,n,"attack"),Gt(r,n,"knee"),Gt(r,n,"ratio"),Gt(r,n,"release"),Gt(r,n,"threshold"),r},Ar=(t,e)=>{const n=t.createGain();return pn(n,e),Gt(n,e,"gain"),n},x5=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return pn(i,r),i};function P5(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function N5(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function pw(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=N5(n,e),n[0]+=t[r];return n}const _5=(t,e,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=zT(o,i.sampleRate),h=l instanceof Float64Array?l:new Float64Array(l),f=u instanceof Float64Array?u:new Float64Array(u),p=h.length,m=f.length,C=Math.min(p,m);if(p===0||p>20)throw r();if(h[0]===0)throw e();if(m===0||m>20)throw r();if(f[0]===0)throw e();if(h[0]!==1){for(let T=0;T<m;T+=1)f[T]/=h[0];for(let T=1;T<p;T+=1)h[T]/=h[0]}const g=n(i,d,s,s);g.channelCount=s,g.channelCountMode=a,g.channelInterpretation=c;const v=32,S=[],k=[],w=[];for(let T=0;T<s;T+=1){S.push(0);const _=new Float32Array(v),O=new Float32Array(v);_.fill(0),O.fill(0),k.push(_),w.push(O)}g.onaudioprocess=T=>{const _=T.inputBuffer,O=T.outputBuffer,L=_.numberOfChannels;for(let U=0;U<L;U+=1){const z=_.getChannelData(U),Z=O.getChannelData(U);S[U]=HT(h,p,f,m,C,k[U],w[U],S[U],v,z,Z)}};const A=i.sampleRate/2;return Ll({get bufferSize(){return d},get channelCount(){return g.channelCount},set channelCount(T){g.channelCount=T},get channelCountMode(){return g.channelCountMode},set channelCountMode(T){g.channelCountMode=T},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(T){g.channelInterpretation=T},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(...T){return g.addEventListener(T[0],T[1],T[2])},dispatchEvent(...T){return g.dispatchEvent(T[0])},getFrequencyResponse(T,_,O){if(T.length!==_.length||_.length!==O.length)throw t();const L=T.length;for(let U=0;U<L;U+=1){const z=-Math.PI*(T[U]/A),Z=[Math.cos(z),Math.sin(z)],J=pw(f,Z),ee=pw(h,Z),re=P5(J,ee);_[U]=Math.sqrt(re[0]*re[0]+re[1]*re[1]),O[U]=Math.atan2(re[1],re[0])}},removeEventListener(...T){return g.removeEventListener(T[0],T[1],T[2])}},g)},O5=(t,e)=>t.createMediaElementSource(e.mediaElement),M5=(t,e)=>{const n=t.createMediaStreamDestination();return pn(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},D5=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((o,s)=>o.id<s.id?-1:o.id>s.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},L5=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return o},F5=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,B5=(t,e,n,r,i,o)=>(s,a)=>{const c=s.createOscillator();return pn(c,a),Gt(c,a,"detune"),Gt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):_t(c,a,"type"),e(n,()=>n(s))||EC(c),e(r,()=>r(s))||o(c,s),e(i,()=>i(s))||TC(c),t(s,c),c},U5=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(pn(r,n),Gt(r,n,"orientationX"),Gt(r,n,"orientationY"),Gt(r,n,"orientationZ"),Gt(r,n,"positionX"),Gt(r,n,"positionY"),Gt(r,n,"positionZ"),_t(r,n,"coneInnerAngle"),_t(r,n,"coneOuterAngle"),_t(r,n,"coneOuterGain"),_t(r,n,"distanceModel"),_t(r,n,"maxDistance"),_t(r,n,"panningModel"),_t(r,n,"refDistance"),_t(r,n,"rolloffFactor"),r)},V5=(t,e,n,r,i,o,s,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:h,coneOuterGain:f,distanceModel:p,maxDistance:m,orientationX:C,orientationY:g,orientationZ:v,panningModel:S,positionX:k,positionY:w,positionZ:A,refDistance:x,rolloffFactor:T,..._})=>{const O=u.createPanner();if(_.channelCount>2||_.channelCountMode==="max")throw s();pn(O,_);const L={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},U=n(u,{...L,channelInterpretation:"speakers",numberOfInputs:6}),z=r(u,{..._,gain:1}),Z=r(u,{...L,gain:1}),J=r(u,{...L,gain:0}),ee=r(u,{...L,gain:0}),re=r(u,{...L,gain:0}),X=r(u,{...L,gain:0}),$=r(u,{...L,gain:0}),ie=i(u,256,6,1),j=o(u,{...L,curve:new Float32Array([1,1]),oversample:"none"});let oe=[C,g,v],ke=[k,w,A];const Le=new Float32Array(1);ie.onaudioprocess=({inputBuffer:ve})=>{const rn=[c(ve,Le,0),c(ve,Le,1),c(ve,Le,2)];rn.some((st,vt)=>st!==oe[vt])&&(O.setOrientation(...rn),oe=rn);const Sn=[c(ve,Le,3),c(ve,Le,4),c(ve,Le,5)];Sn.some((st,vt)=>st!==ke[vt])&&(O.setPosition(...Sn),ke=Sn)},Object.defineProperty(J.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0}),Object.defineProperty(re.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0});const de={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(ve){if(ve>2)throw s();z.channelCount=ve,O.channelCount=ve},get channelCountMode(){return O.channelCountMode},set channelCountMode(ve){if(ve==="max")throw s();z.channelCountMode=ve,O.channelCountMode=ve},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(ve){z.channelInterpretation=ve,O.channelInterpretation=ve},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(ve){O.coneInnerAngle=ve},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(ve){O.coneOuterAngle=ve},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(ve){if(ve<0||ve>1)throw e();O.coneOuterGain=ve},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(ve){O.distanceModel=ve},get inputs(){return[z]},get maxDistance(){return O.maxDistance},set maxDistance(ve){if(ve<0)throw new RangeError;O.maxDistance=ve},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return Z.gain},get orientationY(){return J.gain},get orientationZ(){return ee.gain},get panningModel(){return O.panningModel},set panningModel(ve){O.panningModel=ve},get positionX(){return re.gain},get positionY(){return X.gain},get positionZ(){return $.gain},get refDistance(){return O.refDistance},set refDistance(ve){if(ve<0)throw new RangeError;O.refDistance=ve},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(ve){if(ve<0)throw new RangeError;O.rolloffFactor=ve},addEventListener(...ve){return z.addEventListener(ve[0],ve[1],ve[2])},dispatchEvent(...ve){return z.dispatchEvent(ve[0])},removeEventListener(...ve){return z.removeEventListener(ve[0],ve[1],ve[2])}};d!==de.coneInnerAngle&&(de.coneInnerAngle=d),h!==de.coneOuterAngle&&(de.coneOuterAngle=h),f!==de.coneOuterGain&&(de.coneOuterGain=f),p!==de.distanceModel&&(de.distanceModel=p),m!==de.maxDistance&&(de.maxDistance=m),C!==de.orientationX.value&&(de.orientationX.value=C),g!==de.orientationY.value&&(de.orientationY.value=g),v!==de.orientationZ.value&&(de.orientationZ.value=v),S!==de.panningModel&&(de.panningModel=S),k!==de.positionX.value&&(de.positionX.value=k),w!==de.positionY.value&&(de.positionY.value=w),A!==de.positionZ.value&&(de.positionZ.value=A),x!==de.refDistance&&(de.refDistance=x),T!==de.rolloffFactor&&(de.rolloffFactor=T),(oe[0]!==1||oe[1]!==0||oe[2]!==0)&&O.setOrientation(...oe),(ke[0]!==0||ke[1]!==0||ke[2]!==0)&&O.setPosition(...ke);const Pe=()=>{z.connect(O),t(z,j,0,0),j.connect(Z).connect(U,0,0),j.connect(J).connect(U,0,1),j.connect(ee).connect(U,0,2),j.connect(re).connect(U,0,3),j.connect(X).connect(U,0,4),j.connect($).connect(U,0,5),U.connect(ie).connect(u.destination)},Ye=()=>{z.disconnect(O),a(z,j,0,0),j.disconnect(Z),Z.disconnect(U),j.disconnect(J),J.disconnect(U),j.disconnect(ee),ee.disconnect(U),j.disconnect(re),re.disconnect(U),j.disconnect(X),X.disconnect(U),j.disconnect($),$.disconnect(U),U.disconnect(ie),ie.disconnect(u.destination)};return l(Ll(de,O),Pe,Ye)},G5=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},Qd=(t,e,n,r)=>t.createScriptProcessor(e,n,r),W5=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const o=n.createStereoPanner();return pn(o,r),Gt(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:s=>{if(s!==i)throw e()}}),o},j5=(t,e,n,r,i,o)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(p,m,C,g)=>{const v=new Float32Array(16385),S=new Float32Array(16385);for(let _=0;_<16385;_+=1){const O=_/16384*c;v[_]=Math.cos(O),S[_]=Math.sin(O)}const k=n(p,{...l,gain:0}),w=r(p,{...u,curve:v}),A=r(p,{...u,curve:a}),x=n(p,{...l,gain:0}),T=r(p,{...u,curve:S});return{connectGraph(){m.connect(k),m.connect(A.inputs===void 0?A:A.inputs[0]),m.connect(x),A.connect(C),C.connect(w.inputs===void 0?w:w.inputs[0]),C.connect(T.inputs===void 0?T:T.inputs[0]),w.connect(k.gain),T.connect(x.gain),k.connect(g,0,0),x.connect(g,0,1)},disconnectGraph(){m.disconnect(k),m.disconnect(A.inputs===void 0?A:A.inputs[0]),m.disconnect(x),A.disconnect(C),C.disconnect(w.inputs===void 0?w:w.inputs[0]),C.disconnect(T.inputs===void 0?T:T.inputs[0]),w.disconnect(k.gain),T.disconnect(x.gain),k.disconnect(g,0,0),x.disconnect(g,0,1)}}},h=(p,m,C,g)=>{const v=new Float32Array(16385),S=new Float32Array(16385),k=new Float32Array(16385),w=new Float32Array(16385),A=Math.floor(16385/2);for(let re=0;re<16385;re+=1)if(re>A){const X=(re-A)/(16384-A)*c;v[re]=Math.cos(X),S[re]=Math.sin(X),k[re]=0,w[re]=1}else{const X=re/(16384-A)*c;v[re]=1,S[re]=0,k[re]=Math.cos(X),w[re]=Math.sin(X)}const x=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),T=n(p,{...l,gain:0}),_=r(p,{...u,curve:v}),O=n(p,{...l,gain:0}),L=r(p,{...u,curve:S}),U=r(p,{...u,curve:a}),z=n(p,{...l,gain:0}),Z=r(p,{...u,curve:k}),J=n(p,{...l,gain:0}),ee=r(p,{...u,curve:w});return{connectGraph(){m.connect(x),m.connect(U.inputs===void 0?U:U.inputs[0]),x.connect(T,0),x.connect(O,0),x.connect(z,1),x.connect(J,1),U.connect(C),C.connect(_.inputs===void 0?_:_.inputs[0]),C.connect(L.inputs===void 0?L:L.inputs[0]),C.connect(Z.inputs===void 0?Z:Z.inputs[0]),C.connect(ee.inputs===void 0?ee:ee.inputs[0]),_.connect(T.gain),L.connect(O.gain),Z.connect(z.gain),ee.connect(J.gain),T.connect(g,0,0),z.connect(g,0,0),O.connect(g,0,1),J.connect(g,0,1)},disconnectGraph(){m.disconnect(x),m.disconnect(U.inputs===void 0?U:U.inputs[0]),x.disconnect(T,0),x.disconnect(O,0),x.disconnect(z,1),x.disconnect(J,1),U.disconnect(C),C.disconnect(_.inputs===void 0?_:_.inputs[0]),C.disconnect(L.inputs===void 0?L:L.inputs[0]),C.disconnect(Z.inputs===void 0?Z:Z.inputs[0]),C.disconnect(ee.inputs===void 0?ee:ee.inputs[0]),_.disconnect(T.gain),L.disconnect(O.gain),Z.disconnect(z.gain),ee.disconnect(J.gain),T.disconnect(g,0,0),z.disconnect(g,0,0),O.disconnect(g,0,1),J.disconnect(g,0,1)}}},f=(p,m,C,g,v)=>{if(m===1)return d(p,C,g,v);if(m===2)return h(p,C,g,v);throw i()};return(p,{channelCount:m,channelCountMode:C,pan:g,...v})=>{if(C==="max")throw i();const S=t(p,{...v,channelCount:1,channelCountMode:C,numberOfInputs:2}),k=n(p,{...v,channelCount:m,channelCountMode:C,gain:1}),w=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g});let{connectGraph:A,disconnectGraph:x}=f(p,m,k,w,S);Object.defineProperty(w.gain,"defaultValue",{get:()=>0}),Object.defineProperty(w.gain,"maxValue",{get:()=>1}),Object.defineProperty(w.gain,"minValue",{get:()=>-1});const T={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(U){k.channelCount!==U&&(_&&x(),{connectGraph:A,disconnectGraph:x}=f(p,U,k,w,S),_&&A()),k.channelCount=U},get channelCountMode(){return k.channelCountMode},set channelCountMode(U){if(U==="clamped-max"||U==="max")throw i();k.channelCountMode=U},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(U){k.channelInterpretation=U},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get pan(){return w.gain},addEventListener(...U){return k.addEventListener(U[0],U[1],U[2])},dispatchEvent(...U){return k.dispatchEvent(U[0])},removeEventListener(...U){return k.removeEventListener(U[0],U[1],U[2])}};let _=!1;const O=()=>{A(),_=!0},L=()=>{x(),_=!1};return o(Ll(T,S),O,L)}},Z5=(t,e,n,r,i,o,s)=>(a,c)=>{const l=a.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);pn(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();_t(l,{curve:u},"curve"),_t(l,c,"oversample");let d=null,h=!1;return s(l,"curve",m=>()=>m.call(l),m=>C=>(m.call(l,C),h&&(r(C)&&d===null?d=t(a,l):!r(C)&&d!==null&&(d(),d=null)),C)),i(l,()=>{h=!0,r(l.curve)&&(d=t(a,l))},()=>{h=!1,d!==null&&(d(),d=null)})},H5=(t,e,n,r,i)=>(o,{curve:s,oversample:a,...c})=>{const l=o.createWaveShaper(),u=o.createWaveShaper();pn(l,c),pn(u,c);const d=n(o,{...c,gain:1}),h=n(o,{...c,gain:-1}),f=n(o,{...c,gain:1}),p=n(o,{...c,gain:-1});let m=null,C=!1,g=null;const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(w){d.channelCount=w,h.channelCount=w,l.channelCount=w,f.channelCount=w,u.channelCount=w,p.channelCount=w},get channelCountMode(){return l.channelCountMode},set channelCountMode(w){d.channelCountMode=w,h.channelCountMode=w,l.channelCountMode=w,f.channelCountMode=w,u.channelCountMode=w,p.channelCountMode=w},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(w){d.channelInterpretation=w,h.channelInterpretation=w,l.channelInterpretation=w,f.channelInterpretation=w,u.channelInterpretation=w,p.channelInterpretation=w},get context(){return l.context},get curve(){return g},set curve(w){if(w!==null&&w.length<2)throw e();if(w===null)l.curve=w,u.curve=w;else{const A=w.length,x=new Float32Array(A+2-A%2),T=new Float32Array(A+2-A%2);x[0]=w[0],T[0]=-w[A-1];const _=Math.ceil((A+1)/2),O=(A+1)/2-1;for(let L=1;L<_;L+=1){const U=L/_*O,z=Math.floor(U),Z=Math.ceil(U);x[L]=z===Z?w[z]:(1-(U-z))*w[z]+(1-(Z-U))*w[Z],T[L]=z===Z?-w[A-1-z]:-((1-(U-z))*w[A-1-z])-(1-(Z-U))*w[A-1-Z]}x[_]=A%2===1?w[_-1]:(w[_-2]+w[_-1])/2,l.curve=x,u.curve=T}g=w,C&&(r(g)&&m===null?m=t(o,d):m!==null&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(w){l.oversample=w,u.oversample=w},addEventListener(...w){return d.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return d.dispatchEvent(w[0])},removeEventListener(...w){return d.removeEventListener(w[0],w[1],w[2])}};s!==null&&(v.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==v.oversample&&(v.oversample=a);const S=()=>{d.connect(l).connect(f),d.connect(h).connect(u).connect(p).connect(f),C=!0,r(g)&&(m=t(o,d))},k=()=>{d.disconnect(l),l.disconnect(f),d.disconnect(h),h.disconnect(u),u.disconnect(p),p.disconnect(f),C=!1,m!==null&&(m(),m=null)};return i(Ll(v,f),S,k)},kr=()=>new DOMException("","NotSupportedError"),z5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},X5=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...z5,...l},h=n(u,d),f=o(u),p=f?r():null,m=c.sampleRate/2;super(c,!1,h,p),this._detune=e(this,f,h.detune,153600,-153600),this._frequency=e(this,f,h.frequency,m,-m),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?s(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){Sl(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),ls(this)&&$d(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},$5=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,c=null;const l=async(u,d)=>{let h=n(u);const f=zn(h,d);if(!f){const p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:s===null?void 0:s,type:h.type};h=e(d,p),a!==null&&h.start(a),c!==null&&h.stop(c)}return o.set(d,h),f?(await t(d,u.detune,h.detune),await t(d,u.frequency,h.frequency)):(await r(d,u.detune,h.detune),await r(d,u.frequency,h.frequency)),await i(u,d,h),h};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){c=u},render(u,d){const h=o.get(d);return h!==void 0?Promise.resolve(h):l(u,d)}}},K5={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},J5=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...K5,...l},h=n(u,d),f=o(u),p=f?r():null;super(c,!1,h,p),this._nativePannerNode=h,this._orientationX=e(this,f,h.orientationX,Yn,mr),this._orientationY=e(this,f,h.orientationY,Yn,mr),this._orientationZ=e(this,f,h.orientationZ,Yn,mr),this._positionX=e(this,f,h.positionX,Yn,mr),this._positionY=e(this,f,h.positionY,Yn,mr),this._positionZ=e(this,f,h.positionZ,Yn,mr),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},Y5=(t,e,n,r,i,o,s,a,c,l)=>()=>{const u=new WeakMap;let d=null;const h=async(f,p)=>{let m=null,C=o(f);const g={channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation},v={...g,coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,panningModel:C.panningModel,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor},S=zn(C,p);if("bufferSize"in C)m=r(p,{...g,gain:1});else if(!S){const k={...v,orientationX:C.orientationX.value,orientationY:C.orientationY.value,orientationZ:C.orientationZ.value,positionX:C.positionX.value,positionY:C.positionY.value,positionZ:C.positionZ.value};C=i(p,k)}if(u.set(p,m===null?C:m),m!==null){if(d===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const L=new s(6,f.context.length,p.sampleRate),U=e(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});U.connect(L.destination),d=(async()=>{const z=await Promise.all([f.orientationX,f.orientationY,f.orientationZ,f.positionX,f.positionY,f.positionZ].map(async(Z,J)=>{const ee=n(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:J===0?1:0});return await a(L,Z,ee.offset),ee}));for(let Z=0;Z<6;Z+=1)z[Z].connect(U,0,Z),z[Z].start(0);return l(L)})()}const k=await d,w=r(p,{...g,gain:1});await c(f,p,w);const A=[];for(let L=0;L<k.numberOfChannels;L+=1)A.push(k.getChannelData(L));let x=[A[0][0],A[1][0],A[2][0]],T=[A[3][0],A[4][0],A[5][0]],_=r(p,{...g,gain:1}),O=i(p,{...v,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:T[0],positionY:T[1],positionZ:T[2]});w.connect(_).connect(O.inputs[0]),O.connect(m);for(let L=128;L<k.length;L+=128){const U=[A[0][L],A[1][L],A[2][L]],z=[A[3][L],A[4][L],A[5][L]];if(U.some((Z,J)=>Z!==x[J])||z.some((Z,J)=>Z!==T[J])){x=U,T=z;const Z=L/p.sampleRate;_.gain.setValueAtTime(0,Z),_=r(p,{...g,gain:0}),O=i(p,{...v,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:T[0],positionY:T[1],positionZ:T[2]}),_.gain.setValueAtTime(1,Z),w.connect(_).connect(O.inputs[0]),O.connect(m)}}return m}return S?(await t(p,f.orientationX,C.orientationX),await t(p,f.orientationY,C.orientationY),await t(p,f.orientationZ,C.orientationZ),await t(p,f.positionX,C.positionX),await t(p,f.positionY,C.positionY),await t(p,f.positionZ,C.positionZ)):(await a(p,f.orientationX,C.orientationX),await a(p,f.orientationY,C.orientationY),await a(p,f.orientationZ,C.orientationZ),await a(p,f.positionX,C.positionX),await a(p,f.positionY,C.positionY),await a(p,f.positionZ,C.positionZ)),Dl(C)?await c(f,p,C.inputs[0]):await c(f,p,C),C};return{render(f,p){const m=u.get(p);return m!==void 0?Promise.resolve(m):h(f,p)}}},Q5={disableNormalization:!1},q5=(t,e,n,r)=>class KT{constructor(o,s){const a=e(o),c=r({...Q5,...s}),l=t(a,c);return n.add(l),l}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===KT.prototype||n.has(o)}},eU=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),tU=(t,e,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(s.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const h=await e(l).render(l,i),f=r.context.destination;!n(l)&&(r!==f||!n(r))&&h.connect(o,u,c)})).reduce((a,c)=>[...a,...c],[]))},nU=(t,e,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,c])=>{const u=await t(a).render(a,i);n(a)||u.connect(o,c)}))},rU=(t,e,n,r)=>i=>t(o0,()=>o0(i))?Promise.resolve(t(r,r)).then(o=>{if(!o){const s=n(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{s.disconnect(),o(a.renderedBuffer)},s.connect(i.destination),i.startRendering()}),iU=t=>(e,n)=>{t.set(e,n)},oU=t=>(e,n)=>t.set(e,n),sU={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},aU=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...sU,...c},d=n(l,u),h=o(l),f=h?r():null;super(a,!1,d,f),this._pan=e(this,h,d.pan)}get pan(){return this._pan}},cU=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=zn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,d)}return o.set(c,l),u?await t(c,a.pan,l.pan):await r(c,a.pan,l.pan),Dl(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},lU=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},uU=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>s=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s},dU=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},hU=()=>new DOMException("","UnknownError"),fU={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},pU=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...fU,...l},h=n(u,d),p=o(u)?r():null;super(c,!0,h,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},gU=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!zn(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(s,l)}return r.set(s,a),Dl(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},mU=()=>typeof window>"u"?null:window,vU=(t,e)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<c&&d<u;d+=1)r[d]=l[d+s]},n.copyToChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<c&&d<u;d+=1)l[d+s]=r[d]}},yU=t=>e=>{e.copyFromChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyToChannel)},CU=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},IU=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},JT=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),YT=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},qd=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:r(s)})},SU=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),bU=t=>({...t,channelCount:t.numberOfOutputs}),wU=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},QT=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;QT(t,e,n+1e-7)}},AU=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},kU=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},EU=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},RC=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},qT=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},xC=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},TU=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},RU=t=>{t.start=(e=>(n=0,r=0,i)=>{const o=t.buffer,s=o===null?r:Math.min(o.duration,r);o!==null&&s>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,i)})(t.start)},eR=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Ll(t,n),t.stop=(i=>{let o=!1;return(s=0)=>{if(o)try{i.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else i.call(t,s),o=!0}})(t.stop)},Fl=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},xU=nB(mc),PU=cB(mc),NU=I3(rg),tR=new WeakMap,_U=B3(tR),bs=YB(new Map,new WeakMap),yo=mU(),nR=u5(bs,bo),rR=F3(er),Fn=tU(er,rR,oc),OU=fB(nR,Pt,Fn),bt=G3(OT),wa=F5(yo),mt=e5(wa),iR=new WeakMap,oR=P3(Fl),eh=p5(yo),sR=J3(eh),aR=Y3(yo),MU=Q3(yo),wd=m5(yo),Xt=UB(rB(xT),aB(xU,PU,hp,NU,fp,er,_U,Xd,Pt,mc,ls,oc,df),bs,K3(qv,fp,er,Pt,bd,ls),bo,ig,kr,m3(hp,qv,er,Pt,bd,bt,ls,mt),w3(iR,er,Li),oR,bt,sR,aR,MU,mt,wd),DU=hB(Xt,OU,bo,nR,bt,mt),cR=new WeakSet,gw=d5(yo),lR=u3(new Uint32Array(1)),uR=vU(lR,bo),dR=yU(lR),LU=gB(cR,bs,kr,gw,wa,lU(gw),uR,dR),og=lB(Ar),hR=nU(rR,Kd,oc),wo=i3(hR),Bl=f5(og,bs,AU,kU,EU,RC,qT,xC,RU,CU(qd),eR),Ao=eU(U3(Kd),hR),FU=yB(wo,Bl,Pt,Ao,Fn),Vi=VB(iB(NT),iR,_T,GB,JF,YF,QF,qF,eB,Jv,TT,eh,QT),BU=vB(Xt,FU,Vi,Nn,Bl,bt,mt,Fl),UU=RB(Xt,xB,bo,Nn,g5(Ar,qd),bt,mt,Fn),VU=JB(wo,XT,Pt,Ao,Fn),vc=oU(tR),GU=KB(Xt,Vi,VU,ig,XT,bt,mt,vc),Aa=c5(mc,aR),WU=IU(Nn,Aa),ka=w5(eh,WU),jU=e3(ka,Pt,Fn),ZU=qB(Xt,jU,ka,bt,mt),HU=r3(Yd,Pt,Fn),zU=n3(Xt,HU,Yd,bt,mt,bU),XU=E5(og,Bl,Ar,Aa),Ul=k5(og,bs,XU,RC,xC),$U=l3(wo,Ul,Pt,Ao,Fn),KU=c3(Xt,Vi,$U,Ul,bt,mt,Fl),fR=T5(kr,qd),JU=f3(fR,Pt,Fn),YU=h3(Xt,JU,fR,bt,mt,vc),QU=C3(wo,$T,Pt,Ao,Fn),qU=y3(Xt,Vi,QU,$T,bt,mt,vc),pR=R5(kr),e4=T3(wo,pR,Pt,Ao,Fn),t4=E3(Xt,Vi,e4,pR,kr,bt,mt,vc),n4=D3(wo,Ar,Pt,Ao,Fn),r4=M3(Xt,Vi,n4,Ar,bt,mt),i4=_5(ig,Nn,Qd,kr),PC=rU(bs,Ar,Qd,dU(Ar,wa)),o4=$3(Bl,Pt,wa,Fn,PC),s4=x5(i4),a4=z3(Xt,s4,o4,bt,mt,vc),c4=PB(Vi,ka,Ul,Qd,kr,JT,mt,qd),gR=new WeakMap,l4=a5(UU,c4,oR,mt,gR,Fl),mR=B5(og,bs,RC,qT,xC,eR),u4=$5(wo,mR,Pt,Ao,Fn),d4=X5(Xt,Vi,mR,u4,bt,mt,Fl),vR=s3(Bl),h4=H5(vR,Nn,Ar,YT,Aa),sg=Z5(vR,Nn,h4,YT,Aa,eh,qd),f4=V5(hp,Nn,ka,Ar,Qd,sg,kr,fp,JT,Aa),yR=U5(f4),p4=Y5(wo,ka,Ul,Ar,yR,Pt,wa,Ao,Fn,PC),g4=J5(Xt,Vi,yR,p4,bt,mt,vc),m4=G5(bo),v4=q5(m4,bt,new WeakSet,wU),y4=j5(ka,Yd,Ar,sg,kr,Aa),CR=W5(y4,kr),C4=cU(wo,CR,Pt,Ao,Fn),I4=aU(Xt,Vi,CR,C4,bt,mt),S4=gU(sg,Pt,Fn),b4=pU(Xt,Nn,sg,S4,bt,mt,vc),IR=t5(yo),NC=N3(yo),SR=new WeakMap,w4=W3(SR,wa),A4=IR?sB(bs,kr,x3(yo),NC,_3(tB),bt,w4,mt,wd,new WeakMap,new WeakMap,uU(wd,wa),yo):void 0,k4=q3(sR,mt),E4=g3(cR,bs,p3,R3,new WeakSet,bt,k4,r0,o0,uR,dR),T4=XB(A4,DU,LU,BU,GU,ZU,zU,KU,YU,E4,qU,t4,r4,a4,l4,d4,g4,v4,I4,b4),R4=n5(Xt,O5,bt,mt),x4=i5(Xt,M5,bt,mt),P4=o5(Xt,D5,bt,mt),N4=L5(Nn,mt),_4=s5(Xt,N4,bt),O4=TB(T4,Nn,kr,hU,R4,x4,P4,_4,eh),bR=j3(gR),M4=uB(bR),wR=o3(bo),D4=S3(bR),AR=A3(bo),kR=new WeakMap,L4=L3(kR,Li),F4=b5(wR,bo,Nn,ka,Yd,Ul,Ar,Qd,kr,AR,NC,L4,Aa),B4=y5(Nn,F4,Ar,kr,Aa),U4=zB(wo,wR,Bl,ka,Yd,Ul,Ar,D4,AR,NC,Pt,wd,wa,Ao,Fn,PC),V4=V3(SR),G4=iU(kR),mw=IR?jB(M4,Xt,Vi,U4,B4,er,V4,bt,mt,wd,SU,G4,TU,Fl):void 0,W4="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";class vw{constructor(e){V(this,"maxSize");V(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}has(e){return this.cache.has(e)}}const yw=100;class $u{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getBufferFromCache(e,n){try{const r=await n.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,n,r,i){try{const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const s=await fetch(e,{headers:o}),a=s.clone();if(s.status===200){const c=s.headers.get("ETag")||void 0,l=s.headers.get("Last-Modified")||void 0,u={url:e,etag:c,lastModified:l,timestamp:Date.now()};await n.put(e,a),await n.put(e+":meta",new Response(JSON.stringify(u),{headers:{"Content-Type":"application/json"}}))}else if(s.status===304){const c=await n.match(e);if(c)return await c.arrayBuffer()}return await s.arrayBuffer()}catch(o){throw console.error("Failed to fetch and cache data:",o),o}}static async decodeAudioData(e,n){try{return await e.decodeAudioData(n)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,n){try{const r=await n.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}static async getAudioBuffer(e,n){if(this.decodedBuffers.has(n))return this.decodedBuffers.get(n);if(n.startsWith("data:")){const a=n.split(",")[1],c=Uint8Array.from(atob(a),u=>u.charCodeAt(0)).buffer,l=await this.decodeAudioData(e,c);return this.decodedBuffers.set(n,l),l}const r=await this.openCache();let i=this.pendingRequests.get(n);if(i)return i;const o=await this.getMetadataFromCache(n,r);let s=!o;if(o&&(o.etag||o.lastModified?s=!1:o.timestamp?s=Date.now()-o.timestamp>this.cacheExpirationTime:s=!0),s)return i=this.fetchAndCacheBuffer(n,r,o==null?void 0:o.etag,o==null?void 0:o.lastModified).then(a=>this.decodeAudioData(e,a)).then(a=>(this.decodedBuffers.set(n,a),a)).finally(()=>{this.pendingRequests.delete(n)}),this.pendingRequests.set(n,i),i;{const a=await this.getBufferFromCache(n,r);if(a){const c=await this.decodeAudioData(e,a);return this.decodedBuffers.set(n,c),c}}throw new Error("Failed to retrieve audio buffer")}static clearMemoryCache(){this.decodedBuffers=new vw(yw),this.pendingRequests.clear()}}V($u,"pendingRequests",new Map),V($u,"decodedBuffers",new vw(yw)),V($u,"cacheExpirationTime",24*60*60*1e3);class Cw{constructor(e=[]){V(this,"_position",[0,0,0]);V(this,"loopCount",0);V(this,"playIndex",0);this.sounds=e}preplayRandom(){return this.randomSound().preplay()[0]}playRandom(){const e=this.preplayRandom();return e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)throw new Error("Cannot prepare an ordered sound from an empty group");const n=this.sounds[this.playIndex].preplay()[0];return this.playIndex++,this.playIndex>=this.sounds.length&&(e?this.playIndex=0:this.playIndex=this.sounds.length),n}playOrdered(e=!0){const n=this.preplayOrdered(e);return n.play(),n}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.reduce((e,n)=>(n.loop&&n.loop(this.loopCount),e.concat(n.preplay())),[])}play(){return this.preplay().map(e=>e.play()[0])}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}}let Vl=class{constructor(){V(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(n=>n.frequency.value!==e.frequency.value&&n.type!==e.type&&n.Q.value!==e.Q.value&&n.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((n,r)=>(n.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(n=>this.addFilter(n))}removeFilters(e){e.forEach(n=>this.removeFilter(n))}},j4=class extends Vl{constructor(n,r,i,o=0){super();V(this,"context");V(this,"source");V(this,"gainNode");V(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}};class Z4 extends Vl{constructor(n){super();V(this,"context");V(this,"_position",[0,0,0]);V(this,"loopCount",0);V(this,"prevVolume",1);V(this,"microphoneGainNode");V(this,"streamPlayback");V(this,"stream");V(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new j4(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}}function ER(t){class e extends t{constructor(){super(...arguments);V(this,"playbacks",[]);V(this,"_position",[0,0,0]);V(this,"_stereoPan",0);V(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});V(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function TR(t){class e extends t{constructor(){super(...arguments);V(this,"panner");V(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=Iw(i,-1,1),this.panner.pan.setValueAtTime(Iw(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,s,a]=i,c=this.panner;c.positionX.value=o,c.positionY.value=s,c.positionZ.value=a}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function Iw(t,e,n){return Math.min(Math.max(t,e),n)}function RR(t){class e extends t{constructor(){super(...arguments);V(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}class xR extends TR(RR(Vl)){constructor(){super(...arguments);V(this,"source");V(this,"_playing",!1);V(this,"origin")}get isPlaying(){return this.source?this._playing:!1}}let H4=class PR extends xR{constructor(n,r,i){super();V(this,"context");V(this,"loopCount",0);V(this,"currentLoop",0);V(this,"buffer");V(this,"_offset",0);V(this,"_startTime",0);V(this,"_state",0);V(this,"_playbackRate",1);V(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),this._state=1,"start"in this.source&&this.source.start?this.source.start(0,this._offset):"mediaElement"in this.source&&this.source.mediaElement&&this.source.mediaElement.play()))});this.origin=n,this.context=n.context,this.loopCount=n.loopCount,this.setPanType(n.panType,n.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(n){if("mediaElement"in n&&n.mediaElement)n.mediaElement.onended=this.loopEnded;else if("onended"in n)n.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(n){if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=n,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const n=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=n,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():this.recreateSource(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(n){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(n)||n<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=n,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.currentTime=n:this.recreateSource(),r&&this.play()}get currentTime(){if(this._state===1){const n=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+n}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&this.source.disconnect(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=[]}loop(n){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(n!==void 0&&(this.loopCount=n==="infinite"?"infinite":Math.max(0,n),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(n){this._filters.forEach(i=>{i.disconnect()}),this._filters=[];const r=n.context.createBiquadFilter();r.type=n.type,r.frequency.value=n.frequency.value,r.Q.value=n.Q.value,r.gain.value=n.gain.value,super.addFilter(r),this.refreshFilters()}removeFilter(n){const r=this._filters.indexOf(n);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}clone(n={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=n.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=new PR(this.origin,o,i);return a.loopCount=s,a.currentLoop=this.currentLoop,a.setPanType(r,this.context),a.volume=this.volume,a.playbackRate=this._playbackRate,a._offset=this._offset,a._state=this._state,this._filters.forEach(c=>{const l=this.context.createBiquadFilter();l.type=c.type,l.frequency.value=c.frequency.value,l.Q.value=c.Q.value,l.gain.value=c.gain.value,a.addFilter(l)}),this._state===1&&a.play(),a}},Oh=class NR extends ER(Vl){constructor(n,r,i,o,s=Ad.Buffer,a="HRTF"){super();V(this,"buffer");V(this,"context");V(this,"loopCount",0);V(this,"_playbackRate",1);this.url=n,this.globalGainNode=o,this.soundType=s,this.panType=a,this.buffer=r,this.context=i}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan,o=n.threeDOptions||this.threeDOptions,s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=n.playbackRate||this.playbackRate,c=n.volume!==void 0?n.volume:this.volume,l=n.position&&n.position.length?n.position:this.position,u=n.filters&&n.filters.length?n.filters:this._filters,d=new NR(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return d.loopCount=s,d._playbackRate=a,d._volume=c,d._position=l,d._stereoPan=i,d._threeDOptions=o,d.addFilters(u),d}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",n=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new H4(this,n,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return this.playbacks.length>0?this.playbacks[0].duration:((n=this.buffer)==null?void 0:n.duration)||NaN}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.loop(n)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}};function z4(t){class e extends xR{constructor(){super(...arguments);V(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}class X4 extends z4(TR(RR(Vl))){constructor(n,r,i){super();V(this,"context");this.origin=n,this.source=r,this.context=n.context,this.setPanType(n.panType,n.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}}class _C extends ER(Vl){constructor(n,r,i=Ad.Oscillator,o="HRTF",s={}){super();V(this,"_oscillatorOptions");V(this,"playbacks",[]);this.context=n,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=n,this._oscillatorOptions=s}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan??0,o=n.threeDOptions||this.threeDOptions,s=n.volume!==void 0?n.volume:this.volume,a=n.position&&n.position.length?n.position:this.position,c=n.filters&&n.filters.length?n.filters:this._filters,l=n.oscillatorOptions||this._oscillatorOptions,u=new _C(this.context,this.globalGainNode,this.soundType,r,l);return u._volume=s,u._position=a,u._stereoPan=i,u._threeDOptions=o,u.addFilters(c),u}preplay(){const n=this.context.createOscillator();this.oscillatorOptions.detune&&(n.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(n.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(n.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new X4(this,n,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(n){this._oscillatorOptions=n,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(n){this._oscillatorOptions.frequency=n,this.playbacks.forEach(r=>r.frequency=n)}get detune(){return this.oscillatorOptions.detune}set detune(n){this._oscillatorOptions.detune=n,this.playbacks.forEach(r=>r.detune=n)}get type(){return this.oscillatorOptions.type||"sine"}set type(n){this._oscillatorOptions.type=n,this.playbacks.forEach(r=>r.type=n)}}var Ad=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t.Oscillator="oscillator",t))(Ad||{});class $4{constructor(e){V(this,"context");V(this,"globalGainNode");V(this,"listener");V(this,"prevVolume",1);V(this,"finalizationRegistry");V(this,"createBiquadFilter",({type:e,frequency:n,gain:r,Q:i})=>{n===void 0&&(n=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=n,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new O4,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",W4):console.warn("AudioWorklet not supported")}async createWorkletNode(e,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new mw(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new mw(this.context,e)}}clearMemoryCache(){$u.clearMemoryCache()}createOscillator(e,n="HRTF"){return new _C(this.context,this.globalGainNode,"oscillator",n,e)}async createSound(e,n="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new Oh("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(n==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new Oh(i,void 0,this.context,this.globalGainNode,"HTML",r)}return $u.getAudioBuffer(this.context,i).then(o=>new Oh(i,o,this.context,this.globalGainNode,n,r))}async createGroup(e){const n=new Cw;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e,n="Buffer",r="HRTF"){const i=new Cw;return(await Promise.all(e.map(o=>this.createSound(o,n,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return new Oh(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:s,channelCountMode:a,channelInterpretation:c,panningModel:l,refDistance:u,rolloffFactor:d,positionX:h,positionY:f,positionZ:p,orientationX:m,orientationY:C,orientationZ:g}){const v=this.context.createPanner();return v.coneInnerAngle=e||360,v.coneOuterAngle=n||360,v.coneOuterGain=r||0,v.distanceModel=i||"inverse",v.maxDistance=o||1e4,v.channelCount=s||2,v.channelCountMode=a||"clamped-max",v.channelInterpretation=c||"speakers",v.panningModel=l||"HRTF",v.refDistance=u||1,v.rolloffFactor=d||1,v.positionX.value=h||0,v.positionY.value=f||0,v.positionZ.value=p||0,v.orientationX.value=m||0,v.orientationY.value=C||0,v.orientationZ.value=g||0,v}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new Z4(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,o,s]=n,[a,c,l]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=s,this.listener.upX.value=a,this.listener.upY.value=c,this.listener.upZ.value=l}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.value=n,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.value=n,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(n,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}}const K4="https://mongoose.world:9080/?url=";class J4 extends So{constructor(){super(...arguments);V(this,"packageName","Client.Media");V(this,"sounds",{});V(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let s=await this.client.cacophony.createSound(r);s.key=i,this.sounds[i]=s}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=K4+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];const o=n.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,Ad.HTML,o):i=await this.client.cacophony.createSound(r,Ad.Buffer,o)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0){const s=n.loops===-1?1/0:n.loops-1;i.loop(s)}if(n.start&&i.seek(n.start),n.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const a=this.sounds[s];a.priority&&a.priority<n.priority&&a.stop()}i.priority=n.priority}if(!i.isPlaying){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}i.key=n.key,this.sounds[i.key]=i}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>this.stopSound(r)),n.type&&this.soundsByType(n.type).forEach(r=>this.stopSound(r)),n.tag&&this.soundsByTag(n.tag).forEach(r=>this.stopSound(r)),n.key&&this.soundsByKey(n.key).forEach(r=>this.stopSound(r)),!n.name&&!n.type&&!n.tag&&!n.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(n){delete this.sounds[n.key],n.stop()}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class Y4 extends So{constructor(){super(...arguments);V(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class Q4 extends So{constructor(){super(...arguments);V(this,"packageName","Comm.Channel");V(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class q4 extends So{constructor(){super(...arguments);V(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class eV extends So{constructor(){super(...arguments);V(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class tV extends So{constructor(){super(...arguments);V(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}class nV extends So{constructor(n){super(n);V(this,"packageName","Client.Html")}handleAdd_html(n){this.client.emit("html",n.data.join(`
`))}}const Ec=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,_R=new Set,s0=typeof process=="object"&&process?process:{},OR=(t,e,n,r)=>{typeof s0.emitWarning=="function"?s0.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let vp=globalThis.AbortController,Sw=globalThis.AbortSignal;var HA;if(typeof vp>"u"){Sw=class{constructor(){V(this,"onabort");V(this,"_onabort",[]);V(this,"reason");V(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},vp=class{constructor(){V(this,"signal",new Sw);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const s of this.signal._onabort)s(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let t=((HA=s0.env)==null?void 0:HA.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,OR("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const rV=t=>!_R.has(t),Ls=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),MR=t=>Ls(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?hf:null:null;class hf extends Array{constructor(e){super(e),this.fill(0)}}var cl;const Ba=class Ba{constructor(e,n){V(this,"heap");V(this,"length");if(!N(Ba,cl))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=MR(e);if(!n)return[];Ne(Ba,cl,!0);const r=new Ba(e,n);return Ne(Ba,cl,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};cl=new WeakMap,et(Ba,cl,!1);let a0=Ba;var zA,XA,fi,xr,pi,gi,ll,ul,sn,mi,en,Et,Fe,$n,Pr,Vn,mn,vi,vn,yi,Ci,Nr,Ii,Hs,Kn,he,l0,Ha,Mo,Fd,_r,DR,za,dl,Bd,Fs,Bs,u0,ff,pf,kt,d0,Ou,Us,h0;const yI=class yI{constructor(e){et(this,he);et(this,fi);et(this,xr);et(this,pi);et(this,gi);et(this,ll);et(this,ul);V(this,"ttl");V(this,"ttlResolution");V(this,"ttlAutopurge");V(this,"updateAgeOnGet");V(this,"updateAgeOnHas");V(this,"allowStale");V(this,"noDisposeOnSet");V(this,"noUpdateTTL");V(this,"maxEntrySize");V(this,"sizeCalculation");V(this,"noDeleteOnFetchRejection");V(this,"noDeleteOnStaleGet");V(this,"allowStaleOnFetchAbort");V(this,"allowStaleOnFetchRejection");V(this,"ignoreFetchAbort");et(this,sn);et(this,mi);et(this,en);et(this,Et);et(this,Fe);et(this,$n);et(this,Pr);et(this,Vn);et(this,mn);et(this,vi);et(this,vn);et(this,yi);et(this,Ci);et(this,Nr);et(this,Ii);et(this,Hs);et(this,Kn);et(this,Ha,()=>{});et(this,Mo,()=>{});et(this,Fd,()=>{});et(this,_r,()=>!1);et(this,za,e=>{});et(this,dl,(e,n,r)=>{});et(this,Bd,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});V(this,zA,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:c,dispose:l,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:h,maxSize:f=0,maxEntrySize:p=0,sizeCalculation:m,fetchMethod:C,memoMethod:g,noDeleteOnFetchRejection:v,noDeleteOnStaleGet:S,allowStaleOnFetchRejection:k,allowStaleOnFetchAbort:w,ignoreFetchAbort:A}=e;if(n!==0&&!Ls(n))throw new TypeError("max option must be a nonnegative integer");const x=n?MR(n):Array;if(!x)throw new Error("invalid max value: "+n);if(Ne(this,fi,n),Ne(this,xr,f),this.maxEntrySize=p||N(this,xr),this.sizeCalculation=m,this.sizeCalculation){if(!N(this,xr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(g!==void 0&&typeof g!="function")throw new TypeError("memoMethod must be a function if defined");if(Ne(this,ul,g),C!==void 0&&typeof C!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ne(this,ll,C),Ne(this,Hs,!!C),Ne(this,en,new Map),Ne(this,Et,new Array(n).fill(void 0)),Ne(this,Fe,new Array(n).fill(void 0)),Ne(this,$n,new x(n)),Ne(this,Pr,new x(n)),Ne(this,Vn,0),Ne(this,mn,0),Ne(this,vi,a0.create(n)),Ne(this,sn,0),Ne(this,mi,0),typeof l=="function"&&Ne(this,pi,l),typeof u=="function"?(Ne(this,gi,u),Ne(this,vn,[])):(Ne(this,gi,void 0),Ne(this,vn,void 0)),Ne(this,Ii,!!N(this,pi)),Ne(this,Kn,!!N(this,gi)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!h,this.noDeleteOnFetchRejection=!!v,this.allowStaleOnFetchRejection=!!k,this.allowStaleOnFetchAbort=!!w,this.ignoreFetchAbort=!!A,this.maxEntrySize!==0){if(N(this,xr)!==0&&!Ls(N(this,xr)))throw new TypeError("maxSize must be a positive integer if specified");if(!Ls(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ae(this,he,DR).call(this)}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!S,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=Ls(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!Ls(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ae(this,he,l0).call(this)}if(N(this,fi)===0&&this.ttl===0&&N(this,xr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!N(this,fi)&&!N(this,xr)){const T="LRU_CACHE_UNBOUNDED";rV(T)&&(_R.add(T),OR("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",T,yI))}}static unsafeExposeInternals(e){return{starts:N(e,Ci),ttls:N(e,Nr),sizes:N(e,yi),keyMap:N(e,en),keyList:N(e,Et),valList:N(e,Fe),next:N(e,$n),prev:N(e,Pr),get head(){return N(e,Vn)},get tail(){return N(e,mn)},free:N(e,vi),isBackgroundFetch:n=>{var r;return Ae(r=e,he,kt).call(r,n)},backgroundFetch:(n,r,i,o)=>{var s;return Ae(s=e,he,pf).call(s,n,r,i,o)},moveToTail:n=>{var r;return Ae(r=e,he,Ou).call(r,n)},indexes:n=>{var r;return Ae(r=e,he,Fs).call(r,n)},rindexes:n=>{var r;return Ae(r=e,he,Bs).call(r,n)},isStale:n=>{var r;return N(r=e,_r).call(r,n)}}}get max(){return N(this,fi)}get maxSize(){return N(this,xr)}get calculatedSize(){return N(this,mi)}get size(){return N(this,sn)}get fetchMethod(){return N(this,ll)}get memoMethod(){return N(this,ul)}get dispose(){return N(this,pi)}get disposeAfter(){return N(this,gi)}getRemainingTTL(e){return N(this,en).has(e)?1/0:0}*entries(){for(const e of Ae(this,he,Fs).call(this))N(this,Fe)[e]!==void 0&&N(this,Et)[e]!==void 0&&!Ae(this,he,kt).call(this,N(this,Fe)[e])&&(yield[N(this,Et)[e],N(this,Fe)[e]])}*rentries(){for(const e of Ae(this,he,Bs).call(this))N(this,Fe)[e]!==void 0&&N(this,Et)[e]!==void 0&&!Ae(this,he,kt).call(this,N(this,Fe)[e])&&(yield[N(this,Et)[e],N(this,Fe)[e]])}*keys(){for(const e of Ae(this,he,Fs).call(this)){const n=N(this,Et)[e];n!==void 0&&!Ae(this,he,kt).call(this,N(this,Fe)[e])&&(yield n)}}*rkeys(){for(const e of Ae(this,he,Bs).call(this)){const n=N(this,Et)[e];n!==void 0&&!Ae(this,he,kt).call(this,N(this,Fe)[e])&&(yield n)}}*values(){for(const e of Ae(this,he,Fs).call(this))N(this,Fe)[e]!==void 0&&!Ae(this,he,kt).call(this,N(this,Fe)[e])&&(yield N(this,Fe)[e])}*rvalues(){for(const e of Ae(this,he,Bs).call(this))N(this,Fe)[e]!==void 0&&!Ae(this,he,kt).call(this,N(this,Fe)[e])&&(yield N(this,Fe)[e])}[(XA=Symbol.iterator,zA=Symbol.toStringTag,XA)](){return this.entries()}find(e,n={}){for(const r of Ae(this,he,Fs).call(this)){const i=N(this,Fe)[r],o=Ae(this,he,kt).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,N(this,Et)[r],this))return this.get(N(this,Et)[r],n)}}forEach(e,n=this){for(const r of Ae(this,he,Fs).call(this)){const i=N(this,Fe)[r],o=Ae(this,he,kt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,Et)[r],this)}}rforEach(e,n=this){for(const r of Ae(this,he,Bs).call(this)){const i=N(this,Fe)[r],o=Ae(this,he,kt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,Et)[r],this)}}purgeStale(){let e=!1;for(const n of Ae(this,he,Bs).call(this,{allowStale:!0}))N(this,_r).call(this,n)&&(Ae(this,he,Us).call(this,N(this,Et)[n],"expire"),e=!0);return e}info(e){const n=N(this,en).get(e);if(n===void 0)return;const r=N(this,Fe)[n],i=Ae(this,he,kt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(N(this,Nr)&&N(this,Ci)){const s=N(this,Nr)[n],a=N(this,Ci)[n];if(s&&a){const c=s-(Ec.now()-a);o.ttl=c,o.start=Date.now()}}return N(this,yi)&&(o.size=N(this,yi)[n]),o}dump(){const e=[];for(const n of Ae(this,he,Fs).call(this,{allowStale:!0})){const r=N(this,Et)[n],i=N(this,Fe)[n],o=Ae(this,he,kt).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const s={value:o};if(N(this,Nr)&&N(this,Ci)){s.ttl=N(this,Nr)[n];const a=Ec.now()-N(this,Ci)[n];s.start=Math.floor(Date.now()-a)}N(this,yi)&&(s.size=N(this,yi)[n]),e.unshift([r,s])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=Ec.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var h,f,p,m,C;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:c}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=N(this,Bd).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),Ae(this,he,Us).call(this,e,"set"),this;let d=N(this,sn)===0?void 0:N(this,en).get(e);if(d===void 0)d=N(this,sn)===0?N(this,mn):N(this,vi).length!==0?N(this,vi).pop():N(this,sn)===N(this,fi)?Ae(this,he,ff).call(this,!1):N(this,sn),N(this,Et)[d]=e,N(this,Fe)[d]=n,N(this,en).set(e,d),N(this,$n)[N(this,mn)]=d,N(this,Pr)[d]=N(this,mn),Ne(this,mn,d),sh(this,sn)._++,N(this,dl).call(this,d,u,c),c&&(c.set="add"),l=!1;else{Ae(this,he,Ou).call(this,d);const g=N(this,Fe)[d];if(n!==g){if(N(this,Hs)&&Ae(this,he,kt).call(this,g)){g.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=g;v!==void 0&&!s&&(N(this,Ii)&&((h=N(this,pi))==null||h.call(this,v,e,"set")),N(this,Kn)&&((f=N(this,vn))==null||f.push([v,e,"set"])))}else s||(N(this,Ii)&&((p=N(this,pi))==null||p.call(this,g,e,"set")),N(this,Kn)&&((m=N(this,vn))==null||m.push([g,e,"set"])));if(N(this,za).call(this,d),N(this,dl).call(this,d,u,c),N(this,Fe)[d]=n,c){c.set="replace";const v=g&&Ae(this,he,kt).call(this,g)?g.__staleWhileFetching:g;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update")}if(i!==0&&!N(this,Nr)&&Ae(this,he,l0).call(this),N(this,Nr)&&(l||N(this,Fd).call(this,d,i,o),c&&N(this,Mo).call(this,c,d)),!s&&N(this,Kn)&&N(this,vn)){const g=N(this,vn);let v;for(;v=g==null?void 0:g.shift();)(C=N(this,gi))==null||C.call(this,...v)}return this}pop(){var e;try{for(;N(this,sn);){const n=N(this,Fe)[N(this,Vn)];if(Ae(this,he,ff).call(this,!0),Ae(this,he,kt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(N(this,Kn)&&N(this,vn)){const n=N(this,vn);let r;for(;r=n==null?void 0:n.shift();)(e=N(this,gi))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,o=N(this,en).get(e);if(o!==void 0){const s=N(this,Fe)[o];if(Ae(this,he,kt).call(this,s)&&s.__staleWhileFetching===void 0)return!1;if(N(this,_r).call(this,o))i&&(i.has="stale",N(this,Mo).call(this,i,o));else return r&&N(this,Ha).call(this,o),i&&(i.has="hit",N(this,Mo).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=N(this,en).get(e);if(i===void 0||!r&&N(this,_r).call(this,i))return;const o=N(this,Fe)[i];return Ae(this,he,kt).call(this,o)?o.__staleWhileFetching:o}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:h=this.allowStaleOnFetchRejection,ignoreFetchAbort:f=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:m,forceRefresh:C=!1,status:g,signal:v}=n;if(!N(this,Hs))return g&&(g.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:g});const S={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:h,allowStaleOnFetchAbort:p,ignoreFetchAbort:f,status:g,signal:v};let k=N(this,en).get(e);if(k===void 0){g&&(g.fetch="miss");const w=Ae(this,he,pf).call(this,e,k,S,m);return w.__returned=w}else{const w=N(this,Fe)[k];if(Ae(this,he,kt).call(this,w)){const O=r&&w.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",O&&(g.returnedStale=!0)),O?w.__staleWhileFetching:w.__returned=w}const A=N(this,_r).call(this,k);if(!C&&!A)return g&&(g.fetch="hit"),Ae(this,he,Ou).call(this,k),i&&N(this,Ha).call(this,k),g&&N(this,Mo).call(this,g,k),w;const x=Ae(this,he,pf).call(this,e,k,S,m),_=x.__staleWhileFetching!==void 0&&r;return g&&(g.fetch=A?"stale":"refresh",_&&A&&(g.returnedStale=!0)),_?x.__staleWhileFetching:x.__returned=x}}async forceFetch(e,n={}){const r=await this.fetch(e,n);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,n={}){const r=N(this,ul);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...s}=n,a=this.get(e,s);if(!o&&a!==void 0)return a;const c=r(e,a,{options:s,context:i});return this.set(e,c,s),c}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=n,a=N(this,en).get(e);if(a!==void 0){const c=N(this,Fe)[a],l=Ae(this,he,kt).call(this,c);return s&&N(this,Mo).call(this,s,a),N(this,_r).call(this,a)?(s&&(s.get="stale"),l?(s&&r&&c.__staleWhileFetching!==void 0&&(s.returnedStale=!0),r?c.__staleWhileFetching:void 0):(o||Ae(this,he,Us).call(this,e,"expire"),s&&r&&(s.returnedStale=!0),r?c:void 0)):(s&&(s.get="hit"),l?c.__staleWhileFetching:(Ae(this,he,Ou).call(this,a),i&&N(this,Ha).call(this,a),c))}else s&&(s.get="miss")}delete(e){return Ae(this,he,Us).call(this,e,"delete")}clear(){return Ae(this,he,h0).call(this,"delete")}};fi=new WeakMap,xr=new WeakMap,pi=new WeakMap,gi=new WeakMap,ll=new WeakMap,ul=new WeakMap,sn=new WeakMap,mi=new WeakMap,en=new WeakMap,Et=new WeakMap,Fe=new WeakMap,$n=new WeakMap,Pr=new WeakMap,Vn=new WeakMap,mn=new WeakMap,vi=new WeakMap,vn=new WeakMap,yi=new WeakMap,Ci=new WeakMap,Nr=new WeakMap,Ii=new WeakMap,Hs=new WeakMap,Kn=new WeakMap,he=new WeakSet,l0=function(){const e=new hf(N(this,fi)),n=new hf(N(this,fi));Ne(this,Nr,e),Ne(this,Ci,n),Ne(this,Fd,(o,s,a=Ec.now())=>{if(n[o]=s!==0?a:0,e[o]=s,s!==0&&this.ttlAutopurge){const c=setTimeout(()=>{N(this,_r).call(this,o)&&Ae(this,he,Us).call(this,N(this,Et)[o],"expire")},s+1);c.unref&&c.unref()}}),Ne(this,Ha,o=>{n[o]=e[o]!==0?Ec.now():0}),Ne(this,Mo,(o,s)=>{if(e[s]){const a=e[s],c=n[s];if(!a||!c)return;o.ttl=a,o.start=c,o.now=r||i();const l=o.now-c;o.remainingTTL=a-l}});let r=0;const i=()=>{const o=Ec.now();if(this.ttlResolution>0){r=o;const s=setTimeout(()=>r=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{const s=N(this,en).get(o);if(s===void 0)return 0;const a=e[s],c=n[s];if(!a||!c)return 1/0;const l=(r||i())-c;return a-l},Ne(this,_r,o=>{const s=n[o],a=e[o];return!!a&&!!s&&(r||i())-s>a})},Ha=new WeakMap,Mo=new WeakMap,Fd=new WeakMap,_r=new WeakMap,DR=function(){const e=new hf(N(this,fi));Ne(this,mi,0),Ne(this,yi,e),Ne(this,za,n=>{Ne(this,mi,N(this,mi)-e[n]),e[n]=0}),Ne(this,Bd,(n,r,i,o)=>{if(Ae(this,he,kt).call(this,r))return 0;if(!Ls(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,n),!Ls(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Ne(this,dl,(n,r,i)=>{if(e[n]=r,N(this,xr)){const o=N(this,xr)-e[n];for(;N(this,mi)>o;)Ae(this,he,ff).call(this,!0)}Ne(this,mi,N(this,mi)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=N(this,mi))})},za=new WeakMap,dl=new WeakMap,Bd=new WeakMap,Fs=function*({allowStale:e=this.allowStale}={}){if(N(this,sn))for(let n=N(this,mn);!(!Ae(this,he,u0).call(this,n)||((e||!N(this,_r).call(this,n))&&(yield n),n===N(this,Vn)));)n=N(this,Pr)[n]},Bs=function*({allowStale:e=this.allowStale}={}){if(N(this,sn))for(let n=N(this,Vn);!(!Ae(this,he,u0).call(this,n)||((e||!N(this,_r).call(this,n))&&(yield n),n===N(this,mn)));)n=N(this,$n)[n]},u0=function(e){return e!==void 0&&N(this,en).get(N(this,Et)[e])===e},ff=function(e){var o,s;const n=N(this,Vn),r=N(this,Et)[n],i=N(this,Fe)[n];return N(this,Hs)&&Ae(this,he,kt).call(this,i)?i.__abortController.abort(new Error("evicted")):(N(this,Ii)||N(this,Kn))&&(N(this,Ii)&&((o=N(this,pi))==null||o.call(this,i,r,"evict")),N(this,Kn)&&((s=N(this,vn))==null||s.push([i,r,"evict"]))),N(this,za).call(this,n),e&&(N(this,Et)[n]=void 0,N(this,Fe)[n]=void 0,N(this,vi).push(n)),N(this,sn)===1?(Ne(this,Vn,Ne(this,mn,0)),N(this,vi).length=0):Ne(this,Vn,N(this,$n)[n]),N(this,en).delete(r),sh(this,sn)._--,n},pf=function(e,n,r,i){const o=n===void 0?void 0:N(this,Fe)[n];if(Ae(this,he,kt).call(this,o))return o;const s=new vp,{signal:a}=r;a==null||a.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});const c={signal:s.signal,options:r,context:i},l=(m,C=!1)=>{const{aborted:g}=s.signal,v=r.ignoreFetchAbort&&m!==void 0;if(r.status&&(g&&!C?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,v&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),g&&!v&&!C)return d(s.signal.reason);const S=f;return N(this,Fe)[n]===f&&(m===void 0?S.__staleWhileFetching?N(this,Fe)[n]=S.__staleWhileFetching:Ae(this,he,Us).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,m,c.options))),m},u=m=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=m),d(m)),d=m=>{const{aborted:C}=s.signal,g=C&&r.allowStaleOnFetchAbort,v=g||r.allowStaleOnFetchRejection,S=v||r.noDeleteOnFetchRejection,k=f;if(N(this,Fe)[n]===f&&(!S||k.__staleWhileFetching===void 0?Ae(this,he,Us).call(this,e,"fetch"):g||(N(this,Fe)[n]=k.__staleWhileFetching)),v)return r.status&&k.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),k.__staleWhileFetching;if(k.__returned===k)throw m},h=(m,C)=>{var v;const g=(v=N(this,ll))==null?void 0:v.call(this,e,o,c);g&&g instanceof Promise&&g.then(S=>m(S===void 0?void 0:S),C),s.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(m(void 0),r.allowStaleOnFetchAbort&&(m=S=>l(S,!0)))})};r.status&&(r.status.fetchDispatched=!0);const f=new Promise(h).then(l,u),p=Object.assign(f,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return n===void 0?(this.set(e,p,{...c.options,status:void 0}),n=N(this,en).get(e)):N(this,Fe)[n]=p,p},kt=function(e){if(!N(this,Hs))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof vp},d0=function(e,n){N(this,Pr)[n]=e,N(this,$n)[e]=n},Ou=function(e){e!==N(this,mn)&&(e===N(this,Vn)?Ne(this,Vn,N(this,$n)[e]):Ae(this,he,d0).call(this,N(this,Pr)[e],N(this,$n)[e]),Ae(this,he,d0).call(this,N(this,mn),e),Ne(this,mn,e))},Us=function(e,n){var i,o,s,a;let r=!1;if(N(this,sn)!==0){const c=N(this,en).get(e);if(c!==void 0)if(r=!0,N(this,sn)===1)Ae(this,he,h0).call(this,n);else{N(this,za).call(this,c);const l=N(this,Fe)[c];if(Ae(this,he,kt).call(this,l)?l.__abortController.abort(new Error("deleted")):(N(this,Ii)||N(this,Kn))&&(N(this,Ii)&&((i=N(this,pi))==null||i.call(this,l,e,n)),N(this,Kn)&&((o=N(this,vn))==null||o.push([l,e,n]))),N(this,en).delete(e),N(this,Et)[c]=void 0,N(this,Fe)[c]=void 0,c===N(this,mn))Ne(this,mn,N(this,Pr)[c]);else if(c===N(this,Vn))Ne(this,Vn,N(this,$n)[c]);else{const u=N(this,Pr)[c];N(this,$n)[u]=N(this,$n)[c];const d=N(this,$n)[c];N(this,Pr)[d]=N(this,Pr)[c]}sh(this,sn)._--,N(this,vi).push(c)}}if(N(this,Kn)&&((s=N(this,vn))!=null&&s.length)){const c=N(this,vn);let l;for(;l=c==null?void 0:c.shift();)(a=N(this,gi))==null||a.call(this,...l)}return r},h0=function(e){var n,r,i;for(const o of Ae(this,he,Bs).call(this,{allowStale:!0})){const s=N(this,Fe)[o];if(Ae(this,he,kt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const a=N(this,Et)[o];N(this,Ii)&&((n=N(this,pi))==null||n.call(this,s,a,e)),N(this,Kn)&&((r=N(this,vn))==null||r.push([s,a,e]))}}if(N(this,en).clear(),N(this,Fe).fill(void 0),N(this,Et).fill(void 0),N(this,Nr)&&N(this,Ci)&&(N(this,Nr).fill(0),N(this,Ci).fill(0)),N(this,yi)&&N(this,yi).fill(0),Ne(this,Vn,0),Ne(this,mn,0),N(this,vi).length=0,Ne(this,mi,0),Ne(this,sn,0),N(this,Kn)&&N(this,vn)){const o=N(this,vn);let s;for(;s=o==null?void 0:o.shift();)(i=N(this,gi))==null||i.call(this,...s)}};let c0=yI;function iV(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(e[3]);){const a=s[1]||s[3],c=s[2]||s[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=c}return{name:n,authKey:r,keyvals:i}}function bw(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],o=e[3],s={};return s[i]=o,{name:n,authKey:r,keyvals:s}}function ww(){return(Math.random()+1).toString(36).substring(3,9)}class Gl{constructor(e){V(this,"packageName");V(this,"minVersion",1);V(this,"maxVersion",1);V(this,"packageVersion",0);V(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class oV extends Gl{constructor(){super(...arguments);V(this,"packageName","mcp-negotiate");V(this,"minVersion",2);V(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(n=i.minVersion)==null?void 0:n.toFixed(1),s=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":s})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class sV extends Gl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class aV extends Gl{constructor(n){super(n);V(this,"packageName","dns-org-mud-moo-simpleedit");V(this,"currentSession",null)}handle(n){n.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){this.currentSession&&"content"in n.keyvals?this.currentSession.contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class cV extends Gl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-getset");V(this,"id",1);V(this,"cache",new c0({max:10}));V(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class lV extends Gl{constructor(){super(...arguments);V(this,"packageName","dns-com-vmoo-userlist");V(this,"maxVersion",1.1);V(this,"player");V(this,"fields",["Object","Name","Icon"]);V(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);V(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=li(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=li(n.keyvals.icons.trim())),"d"in n.keyvals){const o=n.keyvals.d[0];switch(o){case"=":var r=li(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(li(n.keyvals.d.slice(1))));break;case"-":var i=li(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const s=this.playerFromArray(li(n.keyvals.d.slice(1)));this.updatePlayer(s);break;case"<":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!0,this.players[c]=a)});break;case">":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!1,this.players[c]=a)});break;case"[":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!0,this.players[c]=a)});break;case"]":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!1,this.players[c]=a)});break;default:console.log(`Unknown userlist mode ${o} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function li(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let o=0;o<t.length;o++){const s=t[o];if(s==="{")r++;else if(s==="}")r--;else if(s===","&&r===0){i(),n="";continue}n+=s}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(li(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class uV extends Gl{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-ping");V(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}var f0=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(f0||{}),ys=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(ys||{});class dV{constructor(){V(this,"state");V(this,"listeners",new Set);V(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const Qc=new dV;class hV extends kT{constructor(n,r){super();V(this,"ws");V(this,"decoder",new TextDecoder("utf8"));V(this,"telnet");V(this,"host");V(this,"port");V(this,"telnetNegotiation",!1);V(this,"telnetBuffer","");V(this,"gmcpHandlers",{});V(this,"mcpHandlers",{});V(this,"mcpMultilines",{});V(this,"mcpAuthKey",null);V(this,"mcp_negotiate");V(this,"mcp_getset");V(this,"gmcp_char");V(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});V(this,"cacophony");V(this,"editors");V(this,"sendCommand",n=>{Qc.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)});this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(oV),this.mcp_getset=this.registerMcpPackage(cV),this.gmcp_char=this.registerGMCPPackage(HF),this.cacophony=new $4,this.editors=new jF(this)}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new UF(new BF(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===_u.WILL&&r===Nu.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(_u.DO,Nu.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===_u.DO&&r===Nu.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(_u.WILL,Nu.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r);try{this.handleGmcpData(n,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=bw(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=bw(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=iV(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=ww(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),o=n.substring(0,i),s=n.substring(i+1);console.log("GMCP Message:",o,s,r);const a=this.gmcpHandlers[o];if(!a){console.log("No handler for GMCP package:",o);return}const c=a["handle"+s];c?(console.log("Calling handler:",c),c.call(a,JSON.parse(r))):console.log("No handler on package:",o,s)}emitMessage(n){const r=Qc.getState().speech.autoreadMode;r===f0.All&&this.speak(n),r===f0.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let o="";for(const[s,a]of Object.entries(r))o+=` ${s}: ${a||'""'}`;r=o}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}sendMCPMultiline(n,r,i){const o=ww();r["_data-tag"]=o,this.sendMcp(n,r);for(const s of i)this.sendMcpMLLine(o,"content",s);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()}),this.editors.shutdown()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(WF(n));r.lang="en-US";const{rate:i,pitch:o,voice:s,volume:a}=Qc.getState().speech;r.rate=i,r.pitch=o,r.volume=a;const l=speechSynthesis.getVoices().find(u=>u.name===s);l&&(r.voice=l),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class fV{constructor(){V(this,"history",[]);V(this,"currentIndex",-1);V(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&this.history.push(e.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(e){return this.currentIndex===-1&&(this.unsentInput=e),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(e){return this.currentIndex===-1&&(this.unsentInput=e),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}}const pV=({onSend:t,inputRef:e})=>{const[n,r]=b.useState(""),i=b.useRef(new fV),o=s=>{const a=i.current;if(s.key==="Enter"&&!s.shiftKey)s.preventDefault(),t(n),a.addCommand(n),r("");else if(s.key==="ArrowUp"){s.preventDefault();const c=a.navigateUp(n);r(c)}else if(s.key==="ArrowDown"){s.preventDefault();const c=a.navigateDown(n);r(c)}};return K.jsx("textarea",{value:n,onChange:s=>r(s.target.value),onKeyDown:o,id:"command-input",ref:e,autoFocus:!0})},gV="a2eaeeaa9f6ad7953b1297eb98c8a6432a97d3d0-dirty",ws=()=>{const[,t]=b.useReducer(e=>e+1,0);return b.useEffect(()=>Qc.subscribe(t),[]),[Qc.getState(),Qc.dispatch]},mV=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},vV=({tabs:t})=>{const[e,n]=b.useState(0),r=b.useRef([]);return b.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),b.useEffect(()=>{const i=s=>{switch(s.key){case"ArrowLeft":n(a=>a>0?a-1:t.length-1);break;case"ArrowRight":n(a=>a<t.length-1?a+1:0);break}},o=r.current[e];return o==null||o.addEventListener("keydown",i),()=>{o==null||o.removeEventListener("keydown",i)}},[t.length,e]),b.useEffect(()=>{var i;(i=r.current[e])==null||i.focus()},[e]),K.jsxs("div",{children:[K.jsx("div",{role:"tablist","aria-label":"Tabs",children:t.map((i,o)=>K.jsx("button",{ref:s=>r.current[o]=s,role:"tab","aria-selected":e===o,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(o),tabIndex:e===o?void 0:-1,children:i.label},o))}),t.map((i,o)=>K.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:e!==o,tabIndex:e===o?0:-1,children:i.content},o))]})},yV=()=>{const[t,e]=ws();return K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:ys.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},CV=()=>{const[t,e]=ws();return K.jsxs("label",{children:["Auto Read:",K.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:ys.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[K.jsx("option",{value:"off",children:"Off"}),K.jsx("option",{value:"unfocused",children:"Unfocused"}),K.jsx("option",{value:"all",children:"Always"})]})]})},IV=()=>{const[t,e]=ws(),n=mV();return K.jsxs("label",{children:["Voice:",K.jsx("select",{value:t.speech.voice,onChange:r=>e({type:ys.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>K.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},SV=()=>{const[t,e]=ws();return K.jsxs("label",{children:["Rate (0.1 - 10.0):",K.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:ys.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},bV=()=>{const[t,e]=ws();return K.jsxs("label",{children:["Pitch (0 - 2):",K.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:ys.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},wV=()=>{const[t,e]=ws();return K.jsxs("label",{children:["Volume (0 - 1):",K.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:ys.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},AV=()=>{const[t]=ws(),[e,n]=b.useState(!1),r=()=>{n(!0),console.log("Preview button clicked");const i=()=>{const o=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),s=speechSynthesis.getVoices();console.log("Available voices:",s.map(c=>c.name));const a=s.find(c=>c.name===t.speech.voice);console.log("Selected voice:",a?a.name:"Not found"),o.voice=a||null,o.rate=t.speech.rate,o.pitch=t.speech.pitch,o.volume=t.speech.volume,console.log("Utterance settings:",{voice:o.voice?o.voice.name:"Default",rate:o.rate,pitch:o.pitch,volume:o.volume}),o.onend=()=>{console.log("Speech ended"),n(!1)},o.onerror=c=>{console.error("Speech synthesis error:",c),n(!1)},speechSynthesis.cancel(),speechSynthesis.speak(o),console.log("Speech started")};speechSynthesis.getVoices().length>0?i():speechSynthesis.onvoiceschanged=()=>{speechSynthesis.onvoiceschanged=null,i()}};return lt.useEffect(()=>()=>{speechSynthesis.cancel()},[]),K.jsx("button",{onClick:r,disabled:e,children:e?"Playing...":"Preview Voice"})},kV=()=>K.jsxs("div",{children:[K.jsx(CV,{}),K.jsx("br",{}),K.jsx(IV,{}),K.jsx("br",{}),K.jsx(SV,{}),K.jsx("br",{}),K.jsx(bV,{}),K.jsx("br",{}),K.jsx(wV,{}),K.jsx("br",{}),K.jsx(AV,{})]}),EV=()=>{const[t,e]=ws(),n=t.editor,r=o=>{e({type:ys.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:ys.SetEditorAccessibilityMode,data:o.target.checked})};return K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),K.jsx("br",{}),K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),K.jsx("br",{})]})},TV=()=>{const t=[{label:"General",content:K.jsx(yV,{})},{label:"Speech",content:K.jsx(kV,{})},{label:"Editor",content:K.jsx(EV,{})}];return K.jsx(vV,{tabs:t})};function RV(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}function kd(){return kd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kd.apply(null,arguments)}var p0="data-focus-lock",LR="data-focus-lock-disabled",xV="data-no-focus-lock",PV="data-autofocus-inside",NV="data-no-autofocus";function gm(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function _V(t,e){var n=b.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var OV=typeof window<"u"?b.useLayoutEffect:b.useEffect,Aw=new WeakMap;function MV(t,e){var n=_V(null,function(r){return t.forEach(function(i){return gm(i,r)})});return OV(function(){var r=Aw.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||gm(a,null)}),o.forEach(function(a){i.has(a)||gm(a,s)})}Aw.set(n,t)},[t]),n}var mm={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},g0=function(t,e){return g0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},g0(t,e)};function Wl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");g0(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var m0=function(){return m0=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},m0.apply(this,arguments)};function DV(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function FR(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function bl(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v0(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function y0(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function qc(t){return this instanceof qc?(this.v=t,this):new qc(t)}function LV(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){r[f]&&(i[f]=function(m){return new Promise(function(C,g){o.push([f,m,C,g])>1||c(f,m)})},p&&(i[f]=p(i[f])))}function c(f,p){try{l(r[f](p))}catch(m){h(o[0][3],m)}}function l(f){f.value instanceof qc?Promise.resolve(f.value.v).then(u,d):h(o[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),o.shift(),o.length&&c(o[0][0],o[0][1])}}function FV(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof bl=="function"?bl(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,c){s=t[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}function BR(t){return t}function UR(t,e){e===void 0&&(e=BR);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var c=function(){var u=s;s=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){s.push(u),l()},filter:function(u){return s=s.filter(u),n}}}};return i}function OC(t,e){return e===void 0&&(e=BR),UR(t,e)}function BV(t){t===void 0&&(t={});var e=UR(null);return e.options=m0({async:!0,ssr:!1},t),e}var VR=OC({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),GR=OC(),UV=OC(),VV=BV({async:!0,ssr:typeof document<"u"}),GV=b.createContext(void 0),WV=[],MC=b.forwardRef(function(e,n){var r,i=b.useState(),o=i[0],s=i[1],a=b.useRef(),c=b.useRef(!1),l=b.useRef(null),u=b.useState({}),d=u[1],h=e.children,f=e.disabled,p=f===void 0?!1:f,m=e.noFocusGuards,C=m===void 0?!1:m,g=e.persistentFocus,v=g===void 0?!1:g,S=e.crossFrame,k=S===void 0?!0:S,w=e.autoFocus,A=w===void 0?!0:w;e.allowTextSelection;var x=e.group,T=e.className,_=e.whiteList,O=e.hasPositiveIndices,L=e.shards,U=L===void 0?WV:L,z=e.as,Z=z===void 0?"div":z,J=e.lockProps,ee=J===void 0?{}:J,re=e.sideCar,X=e.returnFocus,$=X===void 0?!1:X,ie=e.focusOptions,j=e.onActivation,oe=e.onDeactivation,ke=b.useState({}),Le=ke[0],de=b.useCallback(function(be){var Ge=be.captureFocusRestore;if(!l.current){var Ve,Me=(Ve=document)==null?void 0:Ve.activeElement;l.current=Me,Me!==document.body&&(l.current=Ge(Me))}a.current&&j&&j(a.current),c.current=!0,d()},[j]),Pe=b.useCallback(function(){c.current=!1,oe&&oe(a.current),d()},[oe]),Ye=b.useCallback(function(be){var Ge=l.current;if(Ge){var Ve=(typeof Ge=="function"?Ge():Ge)||document.body,Me=typeof $=="function"?$(Ve):$;if(Me){var qe=typeof Me=="object"?Me:void 0;l.current=null,be?Promise.resolve().then(function(){return Ve.focus(qe)}):Ve.focus(qe)}}},[$]),ve=b.useCallback(function(be){c.current&&VR.useMedium(be)},[]),rn=GR.useMedium,Sn=b.useCallback(function(be){a.current!==be&&(a.current=be,s(be))},[]),st=kd((r={},r[LR]=p&&"disabled",r[p0]=x,r),ee),vt=C!==!0,bn=vt&&C!=="tail",on=MV([n,Sn]),ue=b.useMemo(function(){return{observed:a,shards:U,enabled:!p,active:c.current}},[p,c.current,U,o]);return b.createElement(b.Fragment,null,vt&&[b.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:p?-1:0,style:mm}),O?b.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:p?-1:1,style:mm}):null],!p&&b.createElement(re,{id:Le,sideCar:VV,observed:o,disabled:p,persistentFocus:v,crossFrame:k,autoFocus:A,whiteList:_,shards:U,onActivation:de,onDeactivation:Pe,returnFocus:Ye,focusOptions:ie,noFocusGuards:C}),b.createElement(Z,kd({ref:on},st,{className:T,onBlur:rn,onFocus:ve}),b.createElement(GV.Provider,{value:ue},h)),bn&&b.createElement("div",{"data-focus-guard":!0,tabIndex:p?-1:0,style:mm}))});MC.propTypes={};function C0(t,e){return C0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},C0(t,e)}function jV(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,C0(t,e)}function Ed(t){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed(t)}function ZV(t,e){if(Ed(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ed(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HV(t){var e=ZV(t,"string");return Ed(e)=="symbol"?e:e+""}function zV(t,e,n){return(e=HV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XV(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var o=[],s;function a(){s=t(o.map(function(l){return l.props})),e(s)}var c=function(l){jV(u,l);function u(){return l.apply(this,arguments)||this}u.peek=function(){return s};var d=u.prototype;return d.componentDidMount=function(){o.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var f=o.indexOf(this);o.splice(f,1),a()},d.render=function(){return lt.createElement(i,this.props)},u}(b.PureComponent);return zV(c,"displayName","SideEffect("+n(i)+")"),c}}var ko=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},sc=function(t){return Array.isArray(t)?t:[t]},WR=function(t){return Array.isArray(t)?t[0]:t},$V=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},jR=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},ZR=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},KV=function(t){return t.hasAttribute("inert")},JV=function(t,e){return!t||ZR(t)||!$V(t)&&!KV(t)&&e(jR(t))},HR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=JV(e,HR.bind(void 0,t));return t.set(e,r),r},YV=function(t,e){return t&&!ZR(t)?eG(t)?e(jR(t)):!1:!0},zR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=YV(e,zR.bind(void 0,t));return t.set(e,r),r},XR=function(t){return t.dataset},QV=function(t){return t.tagName==="BUTTON"},$R=function(t){return t.tagName==="INPUT"},KR=function(t){return $R(t)&&t.type==="radio"},qV=function(t){return!(($R(t)||QV(t))&&(t.type==="hidden"||t.disabled))},eG=function(t){var e=t.getAttribute(NV);return![!0,"true",""].includes(e)},DC=function(t){var e;return!!(t&&(!((e=XR(t))===null||e===void 0)&&e.focusGuard))},I0=function(t){return!DC(t)},tG=function(t){return!!t},nG=function(t,e){var n=Math.max(0,t.tabIndex),r=Math.max(0,e.tabIndex),i=n-r,o=t.index-e.index;if(i){if(!n)return 1;if(!r)return-1}return i||o},rG=function(t){return t.tabIndex<0&&!t.hasAttribute("tabindex")?0:t.tabIndex},LC=function(t,e,n){return ko(t).map(function(r,i){var o=rG(r);return{node:r,index:i,tabIndex:n&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(nG)},iG=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],FC=iG.join(","),oG="".concat(FC,", [data-focus-guard]"),JR=function(t,e){return ko((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?oG:FC)?[r]:[],JR(r))},[])},sG=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?wl([t.contentDocument.body],e):[t]},wl=function(t,e){return t.reduce(function(n,r){var i,o=JR(r,e),s=(i=[]).concat.apply(i,o.map(function(a){return sG(a,e)}));return n.concat(s,r.parentNode?ko(r.parentNode.querySelectorAll(FC)).filter(function(a){return a===r}):[])},[])},aG=function(t){var e=t.querySelectorAll("[".concat(PV,"]"));return ko(e).map(function(n){return wl([n])}).reduce(function(n,r){return n.concat(r)},[])},BC=function(t,e){return ko(t).filter(function(n){return HR(e,n)}).filter(function(n){return qV(n)})},kw=function(t,e){return e===void 0&&(e=new Map),ko(t).filter(function(n){return zR(e,n)})},UC=function(t,e,n){return LC(BC(wl(t,n),e),!0,n)},Td=function(t,e){return LC(BC(wl(t),e),!1)},cG=function(t,e){return BC(aG(t),e)},Ja=function(t,e){return t.shadowRoot?Ja(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:ko(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?Ja(i,e):!1}return Ja(n,e)})},lG=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=t[r].compareDocumentPosition(t[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(s,a){return!e.has(a)})},YR=function(t){return t.parentNode?YR(t.parentNode):t},VC=function(t){var e=sc(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(p0);return n.push.apply(n,i?lG(ko(YR(r).querySelectorAll("[".concat(p0,'="').concat(i,'"]:not([').concat(LR,'="disabled"])')))):[r]),n},[])},uG=function(t){try{return t()}catch{return}},Rd=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?Rd(e.shadowRoot):e instanceof HTMLIFrameElement&&uG(function(){return e.contentWindow.document})?Rd(e.contentWindow.document):e}},dG=function(t,e){return t===e},hG=function(t,e){return!!ko(t.querySelectorAll("iframe")).some(function(n){return dG(n,e)})},QR=function(t,e){return e===void 0&&(e=Rd(WR(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:VC(t).some(function(n){return Ja(n,e)||hG(n,e)})},fG=function(t){t===void 0&&(t=document);var e=Rd(t);return e?ko(t.querySelectorAll("[".concat(xV,"]"))).some(function(n){return Ja(n,e)}):!1},pG=function(t,e){return e.filter(KR).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},GC=function(t,e){return KR(t)&&t.name?pG(t,e):t},gG=function(t){var e=new Set;return t.forEach(function(n){return e.add(GC(n,t))}),t.filter(function(n){return e.has(n)})},Ew=function(t){return t[0]&&t.length>1?GC(t[0],t):t[0]},Tw=function(t,e){return t.indexOf(GC(e,t))},S0="NEW_FOCUS",mG=function(t,e,n,r,i){var o=t.length,s=t[0],a=t[o-1],c=DC(r);if(!(r&&t.indexOf(r)>=0)){var l=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):l,d=i?t.indexOf(i):-1;if(l===-1)return d!==-1?d:S0;if(d===-1)return S0;var h=l-u,f=n.indexOf(s),p=n.indexOf(a),m=gG(n),C=r!==void 0?m.indexOf(r):-1,g=C-(i?m.indexOf(i):l);if(!h&&d>=0||e.length===0)return d;var v=Tw(t,e[0]),S=Tw(t,e[e.length-1]);if(l<=f&&c&&Math.abs(h)>1)return S;if(l>=p&&c&&Math.abs(h)>1)return v;if(h&&Math.abs(g)>1)return d;if(l<=f)return S;if(l>p)return v;if(h)return Math.abs(h)>1?d:(o+d+h)%o}},vG=function(t){return function(e){var n,r=(n=XR(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},Rw=function(t,e,n){var r=t.map(function(o){var s=o.node;return s}),i=kw(r.filter(vG(n)));return i&&i.length?Ew(i):Ew(kw(e))},b0=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&b0(t.parentNode.host||t.parentNode,e),e},vm=function(t,e){for(var n=b0(t),r=b0(e),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},qR=function(t,e,n){var r=sc(t),i=sc(e),o=r[0],s=!1;return i.filter(Boolean).forEach(function(a){s=vm(s||a,a)||s,n.filter(Boolean).forEach(function(c){var l=vm(o,c);l&&(!s||Ja(l,s)?s=l:s=vm(l,s))})}),s},xw=function(t,e){return t.reduce(function(n,r){return n.concat(cG(r,e))},[])},yG=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(tG)},CG=function(t,e){var n=Rd(sc(t).length>0?document:WR(t).ownerDocument),r=VC(t).filter(I0),i=qR(n||t,t,r),o=new Map,s=Td(r,o),a=s.filter(function(p){var m=p.node;return I0(m)});if(a[0]){var c=Td([i],o).map(function(p){var m=p.node;return m}),l=yG(c,a),u=l.map(function(p){var m=p.node;return m}),d=l.filter(function(p){var m=p.tabIndex;return m>=0}).map(function(p){var m=p.node;return m}),h=mG(u,d,c,n,e);if(h===S0){var f=Rw(s,d,xw(r,o))||Rw(s,u,xw(r,o));if(f)return{node:f};console.warn("focus-lock: cannot find any node to move focus into");return}return h===void 0?h:l[h]}},IG=function(t){var e=VC(t).filter(I0),n=qR(t,t,e),r=LC(wl([n],!0),!0,!0),i=wl(e,!1);return r.map(function(o){var s=o.node,a=o.index;return{node:s,index:a,lockItem:i.indexOf(s)>=0,guard:DC(s)}})},WC=function(t,e){t&&("focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus())},ym=0,Cm=!1,ex=function(t,e,n){n===void 0&&(n={});var r=CG(t,e);if(!Cm&&r){if(ym>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Cm=!0,setTimeout(function(){Cm=!1},1);return}ym++,WC(r.node,n.focusOptions),ym--}};function gu(t){if(!t)return null;if(typeof WeakRef>"u")return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(e==null?void 0:e.deref())||null}}var SG=function(t){if(!t)return null;for(var e=[],n=t;n&&n!==document.body;)e.push({current:gu(n),parent:gu(n.parentElement),left:gu(n.previousElementSibling),right:gu(n.nextElementSibling)}),n=n.parentElement;return{element:gu(t),stack:e,ownerDocument:t.ownerDocument}},bG=function(t){var e,n,r,i,o;if(t)for(var s=t.stack,a=t.ownerDocument,c=new Map,l=0,u=s;l<u.length;l++){var d=u[l],h=(e=d.parent)===null||e===void 0?void 0:e.call(d);if(h&&a.contains(h)){for(var f=(n=d.left)===null||n===void 0?void 0:n.call(d),p=d.current(),m=h.contains(p)?p:void 0,C=(r=d.right)===null||r===void 0?void 0:r.call(d),g=UC([h],c),v=(o=(i=m??(f==null?void 0:f.nextElementSibling))!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:f;v;){for(var S=0,k=g;S<k.length;S++){var w=k[S];if(v!=null&&v.contains(w.node))return w.node}v=v.nextElementSibling}if(g.length)return g[0].node}}},tx=function(t){var e=SG(t);return function(){return bG(e)}},wG=function(t,e,n){if(!t||!e)return console.error("no element or scope given"),{};var r=sc(e);if(r.every(function(s){return!Ja(s,t)}))return console.error("Active element is not contained in the scope"),{};var i=n?UC(r,new Map):Td(r,new Map),o=i.findIndex(function(s){var a=s.node;return a===t});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},AG=function(t,e){var n=e?UC(sc(t),new Map):Td(sc(t),new Map);return{first:n[0],last:n[n.length-1]}},kG=function(t){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},t)},nx=function(t,e,n){e===void 0&&(e={});var r=kG(e),i=wG(t,r.scope,r.onlyTabbable);if(i){var o=n(i,r.cycle);o&&WC(o.node,r.focusOptions)}},EG=function(t,e){e===void 0&&(e={}),nx(t,e,function(n,r){var i=n.next,o=n.first;return i||r&&o})},TG=function(t,e){e===void 0&&(e={}),nx(t,e,function(n,r){var i=n.prev,o=n.last;return i||r&&o})},rx=function(t,e,n){var r,i=AG(t,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[n];o&&WC(o.node,e.focusOptions)},RG=function(t,e){e===void 0&&(e={}),rx(t,e,"first")},xG=function(t,e){e===void 0&&(e={}),rx(t,e,"last")};function jC(t){setTimeout(t,1)}var PG=function(e){return e&&"current"in e?e.current:e},ix=function(){return document&&document.activeElement===document.body},NG=function(){return ix()||fG()},el=null,Rr=null,Pw=function(){return null},tl=null,xd=!1,ZC=!1,_G=function(){return!0},OG=function(e){return(el.whiteList||_G)(e)},MG=function(e,n){tl={observerNode:e,portaledElement:n}},DG=function(e){return tl&&tl.portaledElement===e};function Nw(t,e,n,r){var i=null,o=t;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else if(s.lockItem){if(o!==t)return;i=null}else break}while((o+=n)!==e);i&&(i.node.tabIndex=0)}var LG=function(e){return e?!!xd:xd==="meanwhile"},FG=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},BG=function(e,n){return n.some(function(r){return FG(e,r,r)})},ox=function(e){return Td(e,new Map)},UG=function(e){return!ox([e.parentNode]).some(function(n){return n.node===e})},yp=function(){var e=!1;if(el){var n=el,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,c=n.focusOptions,l=n.noFocusGuards,u=r||tl&&tl.portaledElement;if(ix()&&Rr&&(!document.body.contains(Rr)||UG(Rr))){Rr=null;var d=Pw();d&&d.focus()}var h=document&&document.activeElement;if(u){var f=[u].concat(s.map(PG).filter(Boolean)),p=function(){if(!LG(a)||!l||!Rr||ZC)return!1;var S=ox(f),k=S.findIndex(function(w){var A=w.node;return A===Rr});return k===0||k===S.length-1};if((!h||OG(h))&&(i||p()||!NG()||!Rr&&o)&&(u&&!(QR(f)||h&&BG(h,f)||DG(h))&&(document&&!Rr&&h&&!o?(h.blur&&h.blur(),document.body.focus()):(e=ex(f,Rr,{focusOptions:c}),tl={})),xd=!1,Rr=document&&document.activeElement,Pw=tx(Rr)),document&&h!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var m=document&&document.activeElement,C=IG(f),g=C.map(function(v){var S=v.node;return S}).indexOf(m);g>-1&&(C.filter(function(v){var S=v.guard,k=v.node;return S&&k.dataset.focusAutoGuard}).forEach(function(v){var S=v.node;return S.removeAttribute("tabIndex")}),Nw(g,C.length,1,C),Nw(g,-1,-1,C))}}}return e},sx=function(e){yp()&&e&&(e.stopPropagation(),e.preventDefault())},HC=function(){return jC(yp)},VG=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||MG(r,n)},GG=function(){return null},ax=function(){ZC=!0},cx=function(){ZC=!1,xd="just",jC(function(){xd="meanwhile"})},WG=function(){document.addEventListener("focusin",sx),document.addEventListener("focusout",HC),window.addEventListener("focus",ax),window.addEventListener("blur",cx)},jG=function(){document.removeEventListener("focusin",sx),document.removeEventListener("focusout",HC),window.removeEventListener("focus",ax),window.removeEventListener("blur",cx)};function ZG(t){return t.filter(function(e){var n=e.disabled;return!n})}var lx={moveFocusInside:ex,focusInside:QR,focusNextElement:EG,focusPrevElement:TG,focusFirstElement:RG,focusLastElement:xG,captureFocusRestore:tx};function HG(t){var e=t.slice(-1)[0];e&&!el&&WG();var n=el,r=n&&e&&e.id===n.id;el=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var o=i.id;return o===n.id}).length||n.returnFocus(!e)),e?(Rr=null,(!r||n.observed!==e.observed)&&e.onActivation(lx),yp(),jC(yp)):(jG(),Rr=null)}VR.assignSyncMedium(VG);GR.assignMedium(HC);UV.assignMedium(function(t){return t(lx)});const zG=XV(ZG,HG)(GG);var ux=b.forwardRef(function(e,n){return b.createElement(MC,kd({sideCar:zG,ref:n},e))}),dx=MC.propTypes||{};dx.sideCar;RV(dx,["sideCar"]);ux.propTypes={};const XG=lt.forwardRef((t,e)=>{const[n,r]=b.useState(!1),i=b.useRef(null);return lt.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),b.useEffect(()=>{var o;n&&((o=i.current)==null||o.focus())},[n]),b.useEffect(()=>{const o=s=>{s.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),K.jsx(ux,{disabled:!n,children:K.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[K.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&K.jsx(TV,{}),K.jsx("button",{onClick:()=>r(!1),children:"Close"}),K.jsx("br",{}),K.jsxs("span",{id:"commit-hash",children:["Version: ",gV]})]})})});var hx={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},_w=lt.createContext&&lt.createContext(hx),$G=["attr","size","title"];function KG(t,e){if(t==null)return{};var n=JG(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function JG(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Cp(){return Cp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Cp.apply(this,arguments)}function Ow(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ip(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ow(Object(n),!0).forEach(function(r){YG(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ow(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function YG(t,e,n){return e=QG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QG(t){var e=qG(t,"string");return typeof e=="symbol"?e:e+""}function qG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fx(t){return t&&t.map((e,n)=>lt.createElement(e.tag,Ip({key:n},e.attr),fx(e.child)))}function yc(t){return e=>lt.createElement(eW,Cp({attr:Ip({},t.attr)},e),fx(t.child))}function eW(t){var e=n=>{var{attr:r,size:i,title:o}=t,s=KG(t,$G),a=i||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),lt.createElement("svg",Cp({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:c,style:Ip(Ip({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&lt.createElement("title",null,o),t.children)};return _w!==void 0?lt.createElement(_w.Consumer,null,n=>e(n)):e(hx)}function tW(t){return yc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(t)}function nW(t){return yc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function rW(t){return yc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(t)}function px(t){return yc({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function iW(t){return yc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(t)}function oW(t){return yc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(t)}function sW(t){return yc({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}const aW=({client:t,onClearLog:e,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[o,s]=lt.useState(t.cacophony.muted);return K.jsxs("div",{className:"toolbar",children:[K.jsxs("button",{onClick:n,accessKey:"l",children:[K.jsx(px,{}),"Save Log"]}),K.jsxs("button",{onClick:e,accessKey:"c",children:[K.jsx(rW,{}),"Clear Log"]}),K.jsxs("button",{onClick:i,accessKey:"p",children:[K.jsx(tW,{}),"Preferences"]}),K.jsxs("button",{onClick:()=>{s(!o),t.cacophony.muted=!o},accessKey:"m",children:[o?K.jsx(sW,{}):K.jsx(oW,{}),o?"Unmute":"Mute"]}),K.jsxs("label",{children:["Volume",K.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]}),K.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"})]})};class cW extends lt.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return K.jsx("div",{className:"statusbar",children:this.state.statusText})}}const lW=({users:t})=>K.jsxs("div",{className:"sidebar",children:[K.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),K.jsx("div",{className:"sidebar-content",children:K.jsx("ul",{children:t.map(e=>{let n="";return e.away&&(n+=" away"),e.idle&&(n+=" idle"),K.jsx("li",{className:n,children:e.Name},e.Object)})})})]});var Mw={};function uW(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var dW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hW(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var gx={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(dW,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(m,C){var g=m[C];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?s:console[m]!==void 0?o(console,m):console.log!==void 0?o(console,"log"):e}function c(m,C){for(var g=0;g<i.length;g++){var v=i[g];this[v]=g<m?e:this.methodFactory(v,m,C)}this.log=this.debug}function l(m,C,g){return function(){typeof console!==n&&(c.call(this,C,g),this[m].apply(this,arguments))}}function u(m,C,g){return a(m)||l.apply(this,arguments)}function d(m,C,g){var v=this,S;C=C??"WARN";var k="loglevel";typeof m=="string"?k+=":"+m:typeof m=="symbol"&&(k=void 0);function w(_){var O=(i[_]||"silent").toUpperCase();if(!(typeof window===n||!k)){try{window.localStorage[k]=O;return}catch{}try{window.document.cookie=encodeURIComponent(k)+"="+O+";"}catch{}}}function A(){var _;if(!(typeof window===n||!k)){try{_=window.localStorage[k]}catch{}if(typeof _===n)try{var O=window.document.cookie,L=O.indexOf(encodeURIComponent(k)+"=");L!==-1&&(_=/^([^;]+)/.exec(O.slice(L))[1])}catch{}return v.levels[_]===void 0&&(_=void 0),_}}function x(){if(!(typeof window===n||!k)){try{window.localStorage.removeItem(k);return}catch{}try{window.document.cookie=encodeURIComponent(k)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=m,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=g||u,v.getLevel=function(){return S},v.setLevel=function(_,O){if(typeof _=="string"&&v.levels[_.toUpperCase()]!==void 0&&(_=v.levels[_.toUpperCase()]),typeof _=="number"&&_>=0&&_<=v.levels.SILENT){if(S=_,O!==!1&&w(_),c.call(v,_,m),typeof console===n&&_<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+_},v.setDefaultLevel=function(_){C=_,A()||v.setLevel(_,!1)},v.resetLevel=function(){v.setLevel(C,!1),x()},v.enableAll=function(_){v.setLevel(v.levels.TRACE,_)},v.disableAll=function(_){v.setLevel(v.levels.SILENT,_)};var T=A();T==null&&(T=C),v.setLevel(T,!1)}var h=new d,f={};h.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var g=f[C];return g||(g=f[C]=new d(C,h.getLevel(),h.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return h.noConflict=function(){return typeof window!==n&&window.log===h&&(window.log=p),h},h.getLoggers=function(){return f},h.default=h,h})})(gx);var zC=gx.exports,w0;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(w0||(w0={}));var Co;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Co||(Co={}));let Ke=zC.getLogger("livekit");Ke.setDefaultLevel(w0.info);function Cs(t){const e=zC.getLogger(t);return e.setDefaultLevel(Ke.getLevel()),e}zC.getLogger("lk-e2ee");function vr(t,e){if(!t)throw new Error(e)}const fW=34028234663852886e22,pW=-34028234663852886e22,gW=4294967295,mW=2147483647,vW=-2147483648;function gf(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>mW||t<vW)throw new Error("invalid int 32: "+t)}function A0(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>gW||t<0)throw new Error("invalid uint 32: "+t)}function mx(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>fW||t<pW))throw new Error("invalid float 32: "+t)}const vx=Symbol("@bufbuild/protobuf/enum-type");function yW(t){const e=t[vx];return vr(e,"missing enum type on enum object"),e}function yx(t,e,n,r){t[vx]=Cx(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function Cx(t,e,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of e){const a=Ix(s);o.push(a),r[s.name]=a,i[s.no]=a}return{typeName:t,values:o,findName(s){return r[s]},findNumber(s){return i[s]}}}function CW(t,e,n){const r={};for(const i of e){const o=Ix(i);r[o.localName]=o.no,r[o.no]=o.localName}return yx(r,t,e),r}function Ix(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class Se{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(n);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(n);return i.readMessage(r,e,o,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function IW(t,e,n,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),s={[o]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new Se),Object.assign(s,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new s().fromBinary(a,c)},fromJson(a,c){return new s().fromJson(a,c)},fromJsonString(a,c){return new s().fromJsonString(a,c)},equals(a,c){return t.util.equals(s,a,c)}}),s}function SW(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,o,s){return IW(this,i,o,s)},makeEnum:CW,makeEnumType:Cx,getEnumType:yW}}var te;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(te||(te={}));var ac;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(ac||(ac={}));function bW(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Im(t,e,n){for(let o=0;o<28;o=o+7){const s=t>>>o,a=!(!(s>>>7)&&e==0),c=(a?s|128:s)&255;if(n.push(c),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const s=e>>>o,a=!!(s>>>7),c=(a?s|128:s)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const mf=4294967296;function Dw(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function o(s,a){const c=Number(t.slice(s,a));i*=n,r=r*n+c,r>=mf&&(i=i+(r/mf|0),r=r%mf)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?bx(r,i):XC(r,i)}function wW(t,e){let n=XC(t,e);const r=n.hi&2147483648;r&&(n=bx(n.lo,n.hi));const i=Sx(n.lo,n.hi);return r?"-"+i:i}function Sx(t,e){if({lo:t,hi:e}=AW(t,e),e<=2097151)return String(mf*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let o=n+r*6777216+i*6710656,s=r+i*8147497,a=i*2;const c=1e7;return o>=c&&(s+=Math.floor(o/c),o%=c),s>=c&&(a+=Math.floor(s/c),s%=c),a.toString()+Lw(s)+Lw(o)}function AW(t,e){return{lo:t>>>0,hi:e>>>0}}function XC(t,e){return{lo:t|0,hi:e|0}}function bx(t,e){return e=~e,t?t=~t+1:e+=1,XC(t,e)}const Lw=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Fw(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function kW(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function EW(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof Mw!="object"||Mw.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>o||l<i)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<s)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}const n=i=>vr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>vr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Dw(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Dw(i)},dec(i,o){return wW(i,o)},uDec(i,o){return Sx(i,o)}}}const Ue=EW();var Zt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Zt||(Zt={}));class TW{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(A0(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return gf(e),Fw(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){mx(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){A0(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){gf(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return gf(e),e=(e<<1^e>>31)>>>0,Fw(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ue.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ue.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=Ue.enc(e);return Im(n.lo,n.hi,this.buf),this}sint64(e){let n=Ue.enc(e),r=n.hi>>31,i=n.lo<<1^r,o=(n.hi<<1|n.lo>>>31)^r;return Im(i,o,this.buf),this}uint64(e){let n=Ue.uEnc(e);return Im(n.lo,n.hi,this.buf),this}}class RW{constructor(e,n){this.varint64=bW,this.uint32=kW,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case Zt.Varint:for(;this.buf[this.pos++]&128;);break;case Zt.Bit64:this.pos+=4;case Zt.Bit32:this.pos+=4;break;case Zt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Zt.StartGroup:let i;for(;(i=this.tag()[1])!==Zt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ue.dec(...this.varint64())}uint64(){return Ue.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,Ue.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ue.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ue.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function k0(t,e){return e instanceof Se||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}te.DOUBLE,te.FLOAT,te.INT64,te.UINT64,te.INT32,te.UINT32,te.BOOL,te.STRING,te.BYTES;function _s(t,e,n){if(e===n)return!0;if(t==te.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return e==n}return!1}function E0(t,e){switch(t){case te.BOOL:return!1;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return e==0?Ue.zero:"0";case te.DOUBLE:case te.FLOAT:return 0;case te.BYTES:return new Uint8Array(0);case te.STRING:return"";default:return 0}}function wx(t,e){const n=e===void 0;let r=Zt.Varint,i=e===0;switch(t){case te.STRING:i=n||!e.length,r=Zt.LengthDelimited;break;case te.BOOL:i=e===!1;break;case te.DOUBLE:r=Zt.Bit64;break;case te.FLOAT:r=Zt.Bit32;break;case te.INT64:i=n||e==0;break;case te.UINT64:i=n||e==0;break;case te.FIXED64:i=n||e==0,r=Zt.Bit64;break;case te.BYTES:i=n||!e.byteLength,r=Zt.LengthDelimited;break;case te.FIXED32:r=Zt.Bit32;break;case te.SFIXED32:r=Zt.Bit32;break;case te.SFIXED64:i=n||e==0,r=Zt.Bit64;break;case te.SINT64:i=n||e==0;break}const o=te[t].toLowerCase();return[r,o,n||i]}const Tc=Symbol("@bufbuild/protobuf/unknown-fields"),Bw={readUnknownFields:!0,readerFactory:t=>new RW(t)},Uw={writeUnknownFields:!0,writerFactory:()=>new TW};function xW(t){return t?Object.assign(Object.assign({},Bw),t):Bw}function PW(t){return t?Object.assign(Object.assign({},Uw),t):Uw}function NW(){return{makeReadOptions:xW,makeWriteOptions:PW,listUnknownFields(t){var e;return(e=t[Tc])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Tc]},writeUnknownFields(t,e){const r=t[Tc];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[Tc])||(i[Tc]=[]),i[Tc].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),o=n===void 0?e.len:e.pos+n;for(;e.pos<o;){const[s,a]=e.tag(),c=i.fields.find(s);if(!c){const h=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,s,a,h);continue}let l=t,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":const h=c.kind=="enum"?te.INT32:c.T;let f=Sp;if(c.kind=="scalar"&&c.L>0&&(f=OW),u){let g=l[d];if(a==Zt.LengthDelimited&&h!=te.STRING&&h!=te.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)g.push(f(e,h))}else g.push(f(e,h))}else l[d]=f(e,h);break;case"message":const p=c.T;u?l[d].push(vf(e,new p,r)):l[d]instanceof Se?vf(e,l[d],r):(l[d]=vf(e,new p,r),p.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=p.fieldWrapper.unwrapField(l[d])));break;case"map":let[m,C]=_W(c,e,r);l[d][m]=C;break}}}}}function vf(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function _W(t,e,n){const r=e.uint32(),i=e.pos+r;let o,s;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:o=Sp(e,t.K);break;case 2:switch(t.V.kind){case"scalar":s=Sp(e,t.V.T);break;case"enum":s=e.int32();break;case"message":s=vf(e,new t.V.T,n);break}break}}if(o===void 0){let a=E0(t.K,ac.BIGINT);o=t.K==te.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(t.V.kind){case"scalar":s=E0(t.V.T,ac.BIGINT);break;case"enum":s=0;break;case"message":s=new t.V.T;break}return[o,s]}function OW(t,e){const n=Sp(t,e);return typeof n=="bigint"?n.toString():n}function Sp(t,e){switch(e){case te.STRING:return t.string();case te.BOOL:return t.bool();case te.DOUBLE:return t.double();case te.FLOAT:return t.float();case te.INT32:return t.int32();case te.INT64:return t.int64();case te.UINT64:return t.uint64();case te.FIXED64:return t.fixed64();case te.BYTES:return t.bytes();case te.FIXED32:return t.fixed32();case te.SFIXED32:return t.sfixed32();case te.SFIXED64:return t.sfixed64();case te.SINT64:return t.sint64();case te.UINT32:return t.uint32();case te.SINT32:return t.sint32()}}function MW(t,e,n,r,i){t.tag(n.no,Zt.LengthDelimited),t.fork();let o=r;switch(n.K){case te.INT32:case te.FIXED32:case te.UINT32:case te.SFIXED32:case te.SINT32:o=Number.parseInt(r);break;case te.BOOL:vr(r=="true"||r=="false"),o=r=="true";break}switch(Ku(t,n.K,1,o,!0),n.V.kind){case"scalar":Ku(t,n.V.T,2,i,!0);break;case"enum":Ku(t,te.INT32,2,i,!0);break;case"message":T0(t,e,n.V.T,2,i);break}t.join()}function T0(t,e,n,r,i){if(i!==void 0){const o=k0(n,i);t.tag(r,Zt.LengthDelimited).bytes(o.toBinary(e))}}function Ku(t,e,n,r,i){let[o,s,a]=wx(e,r);(!a||i)&&t.tag(n,o)[s](r)}function DW(t,e,n,r){if(!r.length)return;t.tag(n,Zt.LengthDelimited).fork();let[,i]=wx(e);for(let o=0;o<r.length;o++)t[i](r[o]);t.join()}function LW(){return Object.assign(Object.assign({},NW()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let o,s=i.repeated,a=i.localName;if(i.oneof){const c=t[i.oneof.localName];if(c.case!==a)continue;o=c.value}else o=t[a];switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?te.INT32:i.T;if(s)if(i.packed)DW(e,c,i.no,o);else for(const l of o)Ku(e,c,i.no,l,!0);else o!==void 0&&Ku(e,c,i.no,o,!!i.oneof||i.opt);break;case"message":if(s)for(const l of o)T0(e,n,i.T,i.no,l);else T0(e,n,i.T,i.no,o);break;case"map":for(const[l,u]of Object.entries(o))MW(e,n,i,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let Do="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),ag=[];for(let t=0;t<Do.length;t++)ag[Do[t].charCodeAt(0)]=t;ag[45]=Do.indexOf("+");ag[95]=Do.indexOf("/");const Ax={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,o,s=0;for(let a=0;a<t.length;a++){if(o=ag[t.charCodeAt(a)],o===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:n[r++]=s<<2|(o&48)>>4,s=o,i=2;break;case 2:n[r++]=(s&15)<<4|(o&60)>>2,s=o,i=3;break;case 3:n[r++]=(s&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let o=0;o<t.length;o++)switch(r=t[o],n){case 0:e+=Do[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=Do[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=Do[i|r>>6],e+=Do[r&63],n=0;break}return n&&(e+=Do[i],e+="=",n==1&&(e+="=")),e}},Vw={ignoreUnknownFields:!1},Gw={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function FW(t){return t?Object.assign(Object.assign({},Vw),t):Vw}function BW(t){return t?Object.assign(Object.assign({},Gw),t):Gw}function UW(t){const e=t(VW,Ww);return{makeReadOptions:FW,makeWriteOptions:BW,readMessage(n,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));o=o??new n;const s={};for(const[a,c]of Object.entries(r)){const l=n.fields.findJsonName(a);if(!l){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=l.localName,d=o;if(l.oneof){if(c===null&&l.kind=="scalar")continue;const h=s[l.oneof.localName];if(h)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(h,'", "').concat(a,'"'));s[l.oneof.localName]=a,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const h=d[u];for(const f of c){if(f===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f)));let p;switch(l.kind){case"message":p=l.T.fromJson(f,i);break;case"enum":if(p=Sm(l.T,f,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=mu(l.T,f,l.L)}catch(m){let C="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f));throw m instanceof Error&&m.message.length>0&&(C+=": ".concat(m.message)),new Error(C)}break}h.push(p)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const h=d[u];for(const[f,p]of Object.entries(c)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: map value null"));let m;switch(l.V.kind){case"message":m=l.V.T.fromJson(p,i);break;case"enum":if(m=Sm(l.V.T,p,i.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=mu(l.V.T,p,ac.BIGINT)}catch(C){let g="cannot decode map value for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw C instanceof Error&&C.message.length>0&&(g+=": ".concat(C.message)),new Error(g)}break}try{h[mu(l.K,l.K==te.BOOL?f=="true"?!0:f=="false"?!1:f:f,ac.BIGINT).toString()]=m}catch(C){let g="cannot decode map key for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw C instanceof Error&&C.message.length>0&&(g+=": ".concat(C.message)),new Error(g)}}}else switch(l.kind){case"message":const h=l.T;if(c===null&&h.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof Se?d[u].fromJson(c,i):(d[u]=h.fromJson(c,i),h.fieldWrapper&&!l.oneof&&(d[u]=h.fieldWrapper.unwrapField(d[u])));break;case"enum":const f=Sm(l.T,c,i.ignoreUnknownFields);f!==void 0&&(d[u]=f);break;case"scalar":try{d[u]=mu(l.T,c,l.L)}catch(p){let m="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw p instanceof Error&&p.message.length>0&&(m+=": ".concat(p.message)),new Error(m)}break}}return o},writeMessage(n,r){const i=n.getType(),o={};let s;try{for(const a of i.fields.byMember()){let c;if(a.kind=="oneof"){const l=n[a.localName];if(l.value===void 0)continue;if(s=a.findField(l.case),!s)throw"oneof case not found: "+l.case;c=e(s,l.value,r)}else s=a,c=e(s,n[s.localName],r);c!==void 0&&(o[r.useProtoFieldName?s.name:s.jsonName]=c)}}catch(a){const c=s?"cannot encode field ".concat(i.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),l=a instanceof Error?a.message:String(a);throw new Error(c+(l.length>0?": ".concat(l):""))}return o},readScalar:mu,writeScalar:Ww,debug:kx}}function kx(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function mu(t,e,n){switch(t){case te.DOUBLE:case te.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==te.FLOAT&&mx(r),r;case te.INT32:case te.FIXED32:case te.SFIXED32:case te.SINT32:case te.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==te.UINT32?A0(i):gf(i),i;case te.INT64:case te.SFIXED64:case te.SINT64:if(e===null)return Ue.zero;if(typeof e!="number"&&typeof e!="string")break;const o=Ue.parse(e);return n?o.toString():o;case te.FIXED64:case te.UINT64:if(e===null)return Ue.zero;if(typeof e!="number"&&typeof e!="string")break;const s=Ue.uParse(e);return n?s.toString():s;case te.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case te.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case te.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return Ax.dec(e)}throw new Error}function Sm(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(kx(e)))}function VW(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const o=t.findNumber(e);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:e}function Ww(t,e,n){if(e!==void 0)switch(t){case te.INT32:case te.SFIXED32:case te.SINT32:case te.FIXED32:case te.UINT32:return vr(typeof e=="number"),e!=0||n?e:void 0;case te.FLOAT:case te.DOUBLE:return vr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case te.STRING:return vr(typeof e=="string"),e.length>0||n?e:void 0;case te.BOOL:return vr(typeof e=="boolean"),e||n?e:void 0;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return vr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case te.BYTES:return vr(e instanceof Uint8Array),n||e.byteLength>0?Ax.enc(e):void 0}}function GW(){return UW((t,e)=>function(r,i,o){if(r.kind=="map"){const s={};switch(r.V.kind){case"scalar":for(const[c,l]of Object.entries(i)){const u=e(r.V.T,l,!0);vr(u!==void 0),s[c.toString()]=u}break;case"message":for(const[c,l]of Object.entries(i))s[c.toString()]=l.toJson(o);break;case"enum":const a=r.V.T;for(const[c,l]of Object.entries(i)){vr(l===void 0||typeof l=="number");const u=t(a,l,!0,o.enumAsInteger);vr(u!==void 0),s[c.toString()]=u}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(r.repeated){const s=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)s.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)s.push(t(r.T,i[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)s.push(k0(r.T,i[a]).toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?k0(r.T,i).toJson(o):void 0}})}function WW(){return{setEnumType:yx,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,o=e,s=t;if(s[i]!==void 0)switch(r.kind){case"oneof":const a=s[i].case;if(a===void 0)continue;const c=r.findField(a);let l=s[i].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===te.BYTES&&(l=vu(l)),o[i]={case:a,value:l};break;case"scalar":case"enum":let u=s[i];r.T===te.BYTES&&(u=r.repeated?u.map(vu):vu(u)),o[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===te.BYTES)for(const[f,p]of Object.entries(s[i]))o[i][f]=vu(p);else Object.assign(o[i],s[i]);break;case"message":const h=r.V.T;for(const f of Object.keys(s[i])){let p=s[i][f];h.fieldWrapper||(p=new h(p)),o[i][f]=p}break}break;case"message":const d=r.T;if(r.repeated)o[i]=s[i].map(h=>h instanceof d?h:new d(h));else if(s[i]!==void 0){const h=s[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?o[i]=vu(h):o[i]=h:o[i]=h instanceof d?h:new d(h)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],o=n[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((s,a)=>r.T.equals(s,o[a]));case"scalar":return i.every((s,a)=>_s(r.T,s,o[a]));case"enum":return i.every((s,a)=>_s(te.INT32,s,o[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return _s(te.INT32,i,o);case"scalar":return _s(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const s=r.findField(i.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(i.value,o.value);case"enum":return _s(te.INT32,i.value,o.value);case"scalar":return _s(s.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const a=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const c=r.V.T;return a.every(u=>c.equals(i[u],o[u]));case"enum":return a.every(u=>_s(te.INT32,i[u],o[u]));case"scalar":const l=r.V.T;return a.every(u=>_s(l,i[u],o[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const o=t[i.localName];let s;if(i.repeated)s=o.map(Mh);else if(i.kind=="map"){s=r[i.localName];for(const[a,c]of Object.entries(o))s[a]=Mh(c)}else i.kind=="oneof"?s=i.findField(o.case)?{case:o.case,value:Mh(o.value)}:{case:void 0}:s=Mh(o);r[i.localName]=s}return n}}}function Mh(t){if(t===void 0)return t;if(t instanceof Se)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function vu(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class jW{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function Ex(t,e){const n=Tx(t);return e?n:KW($W(n))}function ZW(t){return Ex(t,!1)}const HW=Tx;function Tx(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const zW=new Set(["constructor","toString","toJSON","valueOf"]),XW=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Rx=t=>"".concat(t,"$"),$W=t=>XW.has(t)?Rx(t):t,KW=t=>zW.has(t)?Rx(t):t;class JW{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=ZW(e)}addField(e){vr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const R=SW("proto3",GW(),LW(),Object.assign(Object.assign({},WW()),{newFieldList(t){return new jW(t,YW)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=E0(e.T,e.L);break}}}}));function YW(t){var e,n,r,i;const o=[];let s;for(const a of typeof t=="function"?t():t){const c=a;if(c.localName=Ex(a.name,a.oneof!==void 0),c.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:HW(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(r=a.L)!==null&&r!==void 0?r:ac.BIGINT),c.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=te.BYTES&&a.T!=te.STRING,a.oneof!==void 0){const l=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=l)&&(s=new JW(l)),c.oneof=s,s.addField(c)}o.push(c)}return o}class Cn extends Se{constructor(e){super(),this.seconds=Ue.zero,this.nanos=0,R.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(R.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ue.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Cn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new Cn({seconds:Ue.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new Cn().fromBinary(e,n)}static fromJson(e,n){return new Cn().fromJson(e,n)}static fromJsonString(e,n){return new Cn().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Cn,e,n)}}Cn.runtime=R;Cn.typeName="google.protobuf.Timestamp";Cn.fields=R.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var R0;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(R0||(R0={}));R.util.setEnumType(R0,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var x0;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(x0||(x0={}));R.util.setEnumType(x0,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var P0;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(P0||(P0={}));R.util.setEnumType(P0,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Wn;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Wn||(Wn={}));R.util.setEnumType(Wn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Ht;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Ht||(Ht={}));R.util.setEnumType(Ht,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var hn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(hn||(hn={}));R.util.setEnumType(hn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var Bo;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(Bo||(Bo={}));R.util.setEnumType(Bo,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Fi;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(Fi||(Fi={}));R.util.setEnumType(Fi,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var us;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(us||(us={}));R.util.setEnumType(us,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var _o;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(_o||(_o={}));R.util.setEnumType(_o,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Pd;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Pd||(Pd={}));R.util.setEnumType(Pd,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let jl=class Mu extends Se{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Ue.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Mu().fromBinary(e,n)}static fromJson(e,n){return new Mu().fromJson(e,n)}static fromJsonString(e,n){return new Mu().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Mu,e,n)}};jl.runtime=R;jl.typeName="livekit.Room";jl.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:ki,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class ki extends Se{constructor(e){super(),this.mime="",this.fmtpLine="",R.util.initPartial(e,this)}static fromBinary(e,n){return new ki().fromBinary(e,n)}static fromJson(e,n){return new ki().fromJson(e,n)}static fromJsonString(e,n){return new ki().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ki,e,n)}}ki.runtime=R;ki.typeName="livekit.Codec";ki.fields=R.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Ys extends Se{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ys().fromBinary(e,n)}static fromJson(e,n){return new Ys().fromJson(e,n)}static fromJsonString(e,n){return new Ys().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ys,e,n)}}Ys.runtime=R;Ys.typeName="livekit.PlayoutDelay";Ys.fields=R.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class Uo extends Se{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Uo().fromBinary(e,n)}static fromJson(e,n){return new Uo().fromJson(e,n)}static fromJsonString(e,n){return new Uo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Uo,e,n)}}Uo.runtime=R;Uo.typeName="livekit.ParticipantPermission";Uo.fields=R.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:R.getEnumType(Ht),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Gr extends Se{constructor(e){super(),this.sid="",this.identity="",this.state=cc.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Ue.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Gr().fromBinary(e,n)}static fromJson(e,n){return new Gr().fromJson(e,n)}static fromJsonString(e,n){return new Gr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Gr,e,n)}}Gr.runtime=R;Gr.typeName="livekit.ParticipantInfo";Gr.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(cc)},{no:4,name:"tracks",kind:"message",T:Cr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Uo},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var cc;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(cc||(cc={}));R.util.setEnumType(cc,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class Qs extends Se{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,n){return new Qs().fromBinary(e,n)}static fromJson(e,n){return new Qs().fromJson(e,n)}static fromJsonString(e,n){return new Qs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Qs,e,n)}}Qs.runtime=R;Qs.typeName="livekit.Encryption";Qs.fields=R.util.newFieldList(()=>[]);var Tn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(Tn||(Tn={}));R.util.setEnumType(Tn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Vo extends Se{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Vo().fromBinary(e,n)}static fromJson(e,n){return new Vo().fromJson(e,n)}static fromJsonString(e,n){return new Vo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Vo,e,n)}}Vo.runtime=R;Vo.typeName="livekit.SimulcastCodecInfo";Vo.fields=R.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:tr,repeated:!0}]);class Cr extends Se{constructor(e){super(),this.sid="",this.type=Wn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Ht.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Tn.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Cr().fromBinary(e,n)}static fromJson(e,n){return new Cr().fromJson(e,n)}static fromJsonString(e,n){return new Cr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Cr,e,n)}}Cr.runtime=R;Cr.typeName="livekit.TrackInfo";Cr.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:R.getEnumType(Wn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:R.getEnumType(Ht)},{no:10,name:"layers",kind:"message",T:tr,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Vo,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:R.getEnumType(Tn)},{no:17,name:"stream",kind:"scalar",T:9}]);class tr extends Se{constructor(e){super(),this.quality=hn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new tr().fromBinary(e,n)}static fromJson(e,n){return new tr().fromJson(e,n)}static fromJsonString(e,n){return new tr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(tr,e,n)}}tr.runtime=R;tr.typeName="livekit.VideoLayer";tr.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(hn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Qi extends Se{constructor(e){super(),this.kind=cn.RELIABLE,this.value={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Qi().fromBinary(e,n)}static fromJson(e,n){return new Qi().fromJson(e,n)}static fromJsonString(e,n){return new Qi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Qi,e,n)}}Qi.runtime=R;Qi.typeName="livekit.DataPacket";Qi.fields=R.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:R.getEnumType(cn)},{no:2,name:"user",kind:"message",T:eo,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Go,oneof:"value"}]);var cn;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(cn||(cn={}));R.util.setEnumType(cn,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Go extends Se{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Go().fromBinary(e,n)}static fromJson(e,n){return new Go().fromJson(e,n)}static fromJsonString(e,n){return new Go().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Go,e,n)}}Go.runtime=R;Go.typeName="livekit.ActiveSpeakerUpdate";Go.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:qi,repeated:!0}]);class qi extends Se{constructor(e){super(),this.sid="",this.level=0,this.active=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new qi().fromBinary(e,n)}static fromJson(e,n){return new qi().fromJson(e,n)}static fromJsonString(e,n){return new qi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(qi,e,n)}}qi.runtime=R;qi.typeName="livekit.SpeakerInfo";qi.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class eo extends Se{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new eo().fromBinary(e,n)}static fromJson(e,n){return new eo().fromJson(e,n)}static fromJsonString(e,n){return new eo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(eo,e,n)}}eo.runtime=R;eo.typeName="livekit.UserPacket";eo.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class to extends Se{constructor(e){super(),this.participantSid="",this.trackSids=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new to().fromBinary(e,n)}static fromJson(e,n){return new to().fromJson(e,n)}static fromJsonString(e,n){return new to().fromJsonString(e,n)}static equals(e,n){return R.util.equals(to,e,n)}}to.runtime=R;to.typeName="livekit.ParticipantTracks";to.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class Wo extends Se{constructor(e){super(),this.edition=Al.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Wo().fromBinary(e,n)}static fromJson(e,n){return new Wo().fromJson(e,n)}static fromJsonString(e,n){return new Wo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Wo,e,n)}}Wo.runtime=R;Wo.typeName="livekit.ServerInfo";Wo.fields=R.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:R.getEnumType(Al)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Al;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(Al||(Al={}));R.util.setEnumType(Al,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class jo extends Se{constructor(e){super(),this.sdk=kl.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",R.util.initPartial(e,this)}static fromBinary(e,n){return new jo().fromBinary(e,n)}static fromJson(e,n){return new jo().fromJson(e,n)}static fromJsonString(e,n){return new jo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(jo,e,n)}}jo.runtime=R;jo.typeName="livekit.ClientInfo";jo.fields=R.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:R.getEnumType(kl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var kl;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(kl||(kl={}));R.util.setEnumType(kl,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class no extends Se{constructor(e){super(),this.resumeConnection=Fi.UNSET,this.forceRelay=Fi.UNSET,R.util.initPartial(e,this)}static fromBinary(e,n){return new no().fromBinary(e,n)}static fromJson(e,n){return new no().fromJson(e,n)}static fromJsonString(e,n){return new no().fromJsonString(e,n)}static equals(e,n){return R.util.equals(no,e,n)}}no.runtime=R;no.typeName="livekit.ClientConfiguration";no.fields=R.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:ro},{no:2,name:"screen",kind:"message",T:ro},{no:3,name:"resume_connection",kind:"enum",T:R.getEnumType(Fi)},{no:4,name:"disabled_codecs",kind:"message",T:Zo},{no:5,name:"force_relay",kind:"enum",T:R.getEnumType(Fi)}]);class ro extends Se{constructor(e){super(),this.hardwareEncoder=Fi.UNSET,R.util.initPartial(e,this)}static fromBinary(e,n){return new ro().fromBinary(e,n)}static fromJson(e,n){return new ro().fromJson(e,n)}static fromJsonString(e,n){return new ro().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ro,e,n)}}ro.runtime=R;ro.typeName="livekit.VideoConfiguration";ro.fields=R.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:R.getEnumType(Fi)}]);class Zo extends Se{constructor(e){super(),this.codecs=[],this.publish=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Zo().fromBinary(e,n)}static fromJson(e,n){return new Zo().fromJson(e,n)}static fromJsonString(e,n){return new Zo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Zo,e,n)}}Zo.runtime=R;Zo.typeName="livekit.DisabledCodecs";Zo.fields=R.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:ki,repeated:!0},{no:2,name:"publish",kind:"message",T:ki,repeated:!0}]);class io extends Se{constructor(e){super(),this.duration=0,this.startTimestamp=Ue.zero,this.endTimestamp=Ue.zero,this.rtpClockTicks=Ue.zero,this.driftSamples=Ue.zero,this.driftMs=0,this.clockRate=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new io().fromBinary(e,n)}static fromJson(e,n){return new io().fromJson(e,n)}static fromJsonString(e,n){return new io().fromJsonString(e,n)}static equals(e,n){return R.util.equals(io,e,n)}}io.runtime=R;io.typeName="livekit.RTPDrift";io.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Cn},{no:2,name:"end_time",kind:"message",T:Cn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class qs extends Se{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Ue.zero,this.headerBytes=Ue.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Ue.zero,this.headerBytesDuplicate=Ue.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Ue.zero,this.headerBytesPadding=Ue.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new qs().fromBinary(e,n)}static fromJson(e,n){return new qs().fromJson(e,n)}static fromJsonString(e,n){return new qs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(qs,e,n)}}qs.runtime=R;qs.typeName="livekit.RTPStats";qs.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Cn},{no:2,name:"end_time",kind:"message",T:Cn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:Cn},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:Cn},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:Cn},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:Cn},{no:44,name:"packet_drift",kind:"message",T:io},{no:45,name:"report_drift",kind:"message",T:io}]);class ea extends Se{constructor(e){super(),this.unixMicro=Ue.zero,this.ticks=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new ea().fromBinary(e,n)}static fromJson(e,n){return new ea().fromJson(e,n)}static fromJsonString(e,n){return new ea().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ea,e,n)}}ea.runtime=R;ea.typeName="livekit.TimedVersion";ea.fields=R.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const yu=7e3,QW=[0,300,2*2*300,3*3*300,4*4*300,yu,yu,yu,yu,yu];class qW{constructor(e){this._retryDelays=e!==void 0?[...e]:QW}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function G(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(t,[])).next())})}function jw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof jw=="function"?jw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,c){s=t[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}var $C={exports:{}},nl=typeof Reflect=="object"?Reflect:null,Zw=nl&&typeof nl.apply=="function"?nl.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},yf;nl&&typeof nl.ownKeys=="function"?yf=nl.ownKeys:Object.getOwnPropertySymbols?yf=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:yf=function(e){return Object.getOwnPropertyNames(e)};function e9(t){console&&console.warn&&console.warn(t)}var xx=Number.isNaN||function(e){return e!==e};function pt(){pt.init.call(this)}$C.exports=pt;$C.exports.once=i9;pt.EventEmitter=pt;pt.prototype._events=void 0;pt.prototype._eventsCount=0;pt.prototype._maxListeners=void 0;var Hw=10;function cg(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(pt,"defaultMaxListeners",{enumerable:!0,get:function(){return Hw},set:function(t){if(typeof t!="number"||t<0||xx(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Hw=t}});pt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};pt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||xx(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Px(t){return t._maxListeners===void 0?pt.defaultMaxListeners:t._maxListeners}pt.prototype.getMaxListeners=function(){return Px(this)};pt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Zw(c,this,n);else for(var l=c.length,u=Dx(c,l),r=0;r<l;++r)Zw(u[r],this,n);return!0};function Nx(t,e,n,r){var i,o,s;if(cg(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),s===void 0)s=o[e]=n,++t._eventsCount;else if(typeof s=="function"?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=Px(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,e9(a)}return t}pt.prototype.addListener=function(e,n){return Nx(this,e,n,!1)};pt.prototype.on=pt.prototype.addListener;pt.prototype.prependListener=function(e,n){return Nx(this,e,n,!0)};function t9(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _x(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=t9.bind(r);return i.listener=n,r.wrapFn=i,i}pt.prototype.once=function(e,n){return cg(n),this.on(e,_x(this,e,n)),this};pt.prototype.prependOnceListener=function(e,n){return cg(n),this.prependListener(e,_x(this,e,n)),this};pt.prototype.removeListener=function(e,n){var r,i,o,s,a;if(cg(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():n9(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};pt.prototype.off=pt.prototype.removeListener;pt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function Ox(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?r9(i):Dx(i,i.length)}pt.prototype.listeners=function(e){return Ox(this,e,!0)};pt.prototype.rawListeners=function(e){return Ox(this,e,!1)};pt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Mx.call(t,e)};pt.prototype.listenerCount=Mx;function Mx(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}pt.prototype.eventNames=function(){return this._eventsCount>0?yf(this._events):[]};function Dx(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function n9(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function r9(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function i9(t,e){return new Promise(function(n,r){function i(s){t.removeListener(e,o),r(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}Lx(t,e,o,{once:!0}),e!=="error"&&o9(t,i,{once:!0})})}function o9(t,e,n){typeof t.on=="function"&&Lx(t,"error",e,n)}function Lx(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Eo=$C.exports;let Fx=!0,Bx=!0;function Cf(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function Cc(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,a){if(s!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),i.apply(this,[s,c])};const o=r.removeEventListener;r.removeEventListener=function(s,a){if(s!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(a))return o.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(s){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),s&&this.addEventListener(e,this["_on"+e]=s)},enumerable:!0,configurable:!0})}function s9(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Fx=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function a9(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Bx=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Ux(){if(typeof window=="object"){if(Fx)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function KC(t,e){Bx&&console.warn(t+" is deprecated, please use "+e+" instead.")}function c9(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=Cf(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Cf(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Cf(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function zw(t){return Object.prototype.toString.call(t)==="[object Object]"}function Vx(t){return zw(t)?Object.keys(t).reduce(function(e,n){const r=zw(t[n]),i=r?Vx(t[n]):t[n],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[n]:i})},{}):t}function N0(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?N0(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{N0(t,t.get(i),n)})}))}function Xw(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return t.forEach(s=>{s.type==="track"&&s.trackIdentifier===e.id&&o.push(s)}),o.forEach(s=>{t.forEach(a=>{a.type===r&&a.trackId===s.id&&N0(t,a,i)})}),i}const $w=Ux;function Gx(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(h,f){return h?h+f.charAt(0).toUpperCase()+f.slice(1):f==="deviceId"?"sourceId":f};if(u.ideal!==void 0){c.optional=c.optional||[];let h={};typeof u.ideal=="number"?(h[d("min",l)]=u.ideal,c.optional.push(h),h={},h[d("max",l)]=u.ideal,c.optional.push(h)):(h[d("",l)]=u.ideal,c.optional.push(h))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(h=>{u[h]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(h,l)]=u[h])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,d,h){d in u&&!(h in u)&&(u[h]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(h=>{h=h.filter(p=>p.kind==="videoinput");let f=h.find(p=>d.some(m=>p.label.toLowerCase().includes(m)));return!f&&h.length&&d.includes("back")&&(f=h[h.length-1]),f&&(a.video.deviceId=l.exact?{exact:f.deviceId}:{ideal:f.deviceId}),a.video=r(a.video),$w("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return $w("chrome: "+JSON.stringify(a)),c(a)},o=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(a,c,l){i(a,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(o(d))})})};if(n.getUserMedia=s.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(o(u))))}}}function l9(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const o=r.video&&r.video.width,s=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(r.video.mandatory.maxWidth=o),s&&(r.video.mandatory.maxHeight=s),t.navigator.mediaDevices.getUserMedia(r)})}}}function Wx(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function jx(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):o={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.id):o={track:i};const s=new Event("track");s.track=i,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Cc(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Zx(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){o.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const a=this._senders.find(c=>c.track===s);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Hx(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const s=function(c){const l={};return c.result().forEach(d=>{const h={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(f=>{h[f]=d.stat(f)}),l[h.id]=h}),l},a=function(c){return new Map(Object.keys(c).map(l=>[l,c[l]]))};if(arguments.length>=2){const c=function(l){i(a(s(l)))};return e.apply(this,[c,r])}return new Promise((c,l)=>{e.apply(this,[function(u){c(a(s(u)))},l])}).then(i,o)}}function zx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>Xw(s,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Cc(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>Xw(o,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,o,s;return this.getSenders().forEach(a=>{a.track===r&&(i?s=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(o?s=!0:o=a),a.track===r)),s||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Xx(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[s.id]=[s].concat(c)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(s);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function $x(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Xx(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(f=>f.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(m=>m===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([u]);this._streams[d.id]=m,this._reverseStreams[m.id]=d,this.addStream(m)}return this.getSenders().find(m=>m.track===u)};function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const f=l._reverseStreams[h],p=l._streams[f.id];d=d.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function s(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const f=l._reverseStreams[h],p=l._streams[f.id];d=d.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const m=o(this,p);h[0].apply(null,[m])},p=>{h[1]&&h[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>o(this,p))}};t.RTCPeerConnection.prototype[l]=d[l]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=s(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:o(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let h;Object.keys(this._streams).forEach(f=>{this._streams[f].getTracks().find(m=>u.track===m)&&(h=this._streams[f])}),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _0(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Kx(t,e){Cc(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var Kw=Object.freeze({__proto__:null,fixNegotiationNeeded:Kx,shimAddTrackRemoveTrack:$x,shimAddTrackRemoveTrackWithNative:Xx,shimGetDisplayMedia:l9,shimGetSendersWithDtmf:Zx,shimGetStats:Hx,shimGetUserMedia:Gx,shimMediaStream:Wx,shimOnTrack:jx,shimPeerConnection:_0,shimSenderReceiverGetStats:zx});function Jx(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,o,s){KC("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(o,s)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(s,a,c){a in s&&!(c in s)&&(s[c]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function u9(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function Yx(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function O0(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=t.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=s[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,s,a]=arguments;return r.apply(this,[o||null]).then(c=>{if(e.version<53&&!s)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,d)=>{c.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(s,a)}}function Qx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function qx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Cc(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function eP(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){KC("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function tP(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function nP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:s}=o,a=s.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function rP(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function iP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function oP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Jw=Object.freeze({__proto__:null,shimAddTransceiver:nP,shimCreateAnswer:oP,shimCreateOffer:iP,shimGetDisplayMedia:u9,shimGetParameters:rP,shimGetUserMedia:Jx,shimOnTrack:Yx,shimPeerConnection:O0,shimRTCDataChannel:tP,shimReceiverGetStats:qx,shimRemoveStream:eP,shimSenderGetStats:Qx});function sP(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return o&&o.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function aP(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,r.dispatchEvent(s)})}),e.apply(r,arguments)}}}function cP(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],h=n.apply(this,[d]);return u?(h.then(l,u),Promise.resolve()):h},e.createAnswer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],h=r.apply(this,[d]);return u?(h.then(l,u),Promise.resolve()):h};let a=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(c,l,u){const d=s.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=a}function lP(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(uP(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function uP(t){return t&&t.video!==void 0?Object.assign({},t,{video:Vx(t.video)}):t}function dP(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let s=0;s<r.iceServers.length;s++){let a=r.iceServers[s];a.urls===void 0&&a.url?(KC("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(r.iceServers[s])}r.iceServers=o}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function hP(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fP(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function pP(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var Yw=Object.freeze({__proto__:null,shimAudioContext:pP,shimCallbacksAPI:cP,shimConstraints:uP,shimCreateOfferLegacy:fP,shimGetUserMedia:lP,shimLocalStreamsAPI:sP,shimRTCIceServerUrls:dP,shimRemoteStreamsAPI:aP,shimTrackEventTransceiver:hP}),gP={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{n.parameters[s]!==void 0?o.push(s+"="+n.parameters[s]):o.push(s)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(i.attribute=n.substring(r+1,o),i.value=n.substring(o+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],o=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");r.profile=o[2];for(let a=3;a<o.length;a++){const c=o[a],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),d=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const s=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{s.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=e.writeRtpMap(s),i+=e.writeFmtp(s),i+=e.writeRtcpFb(s)});let o=0;return r.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=e.writeExtmap(s)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let f={ssrc:c,codecPayloadType:parseInt(h.parameters.apt,10)};c&&l&&(f.rtx={ssrc:l}),r.push(f),o&&(f=JSON.parse(JSON.stringify(f)),f.fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(f))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(h=>{h.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const s=e.matchPrefix(n,"a=rtcp-mux");return r.mux=s.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const s=e.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let o;const s=r!==void 0?r:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(gP);var mP=gP.exports,rl=hW(mP),d9=uW({__proto__:null,default:rl},[mP]);function If(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=rl.parseCandidate(r.candidate);for(const s in o)s in i||Object.defineProperty(i,s,{value:o[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,Cc(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function M0(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Cc(t,"icecandidate",e=>{if(e.candidate){const n=rl.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Sf(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=rl.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=rl.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},o=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=rl.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},s=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),l=i(c),u=o(arguments[0],c);let d;l===0&&u===0?d=Number.POSITIVE_INFINITY:l===0||u===0?d=Math.max(l,u):d=Math.min(l,u);const h={};Object.defineProperty(h,"maxMessageSize",{get(){return d}}),this._sctp=h}return s.apply(this,arguments)}}function bf(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},Cc(t,"datachannel",r=>(e(r.channel,r.target),r))}function D0(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function L0(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function wf(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Af(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>n.apply(this,[s]))})}var h9=Object.freeze({__proto__:null,removeExtmapAllowMixed:L0,shimAddIceCandidateNullOrEmpty:wf,shimConnectionState:D0,shimMaxMessageSize:Sf,shimParameterlessSetLocalDescription:Af,shimRTCIceCandidate:If,shimRTCIceCandidateRelayProtocol:M0,shimSendThrowTypeError:bf});function f9(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Ux,r=c9(t),i={browserDetails:r,commonShim:h9,extractVersion:Cf,disableLog:s9,disableWarnings:a9,sdp:d9};switch(r.browser){case"chrome":if(!Kw||!_0||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Kw,wf(t,r),Af(t),Gx(t,r),Wx(t),_0(t,r),jx(t),$x(t,r),Zx(t),Hx(t),zx(t),Kx(t,r),If(t),M0(t),D0(t),Sf(t,r),bf(t),L0(t,r);break;case"firefox":if(!Jw||!O0||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Jw,wf(t,r),Af(t),Jx(t,r),O0(t,r),Yx(t),eP(t),Qx(t),qx(t),tP(t),nP(t),rP(t),iP(t),oP(t),If(t),D0(t),Sf(t,r),bf(t);break;case"safari":if(!Yw||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=Yw,wf(t,r),Af(t),dP(t),fP(t),cP(t),sP(t),aP(t),hP(t),lP(t),pP(t),If(t),M0(t),Sf(t,r),bf(t),L0(t,r);break;default:n("Unsupported browser!");break}return i}f9({window:typeof window>"u"?void 0:window});const p9=10,Dh="lk_e2ee",g9="LKFrameEncryptionKey",m9={sharedKey:!1,ratchetSalt:g9,ratchetWindowSize:8,failureTolerance:p9};var da;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(da||(da={}));var Qw;(function(t){t.KeyRatcheted="keyRatcheted"})(Qw||(Qw={}));var ta;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(ta||(ta={}));var qw;(function(t){t.Error="cryptorError"})(qw||(qw={}));function v9(){return y9()||F0()}function F0(){return typeof window.RTCRtpScriptTransform<"u"}function y9(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class Tz extends Eo.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{Ke.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},m9),e),this.on(da.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(da.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(da.RatchetRequest,e,n)}}class Zl extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class It extends Zl{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class JC extends Zl{constructor(e){super(21,e??"device is unsupported")}}class Ki extends Zl{constructor(e){super(20,e??"track is invalid")}}class C9 extends Zl{constructor(e){super(10,e??"unsupported server")}}class an extends Zl{constructor(e){super(12,e??"unexpected connection state")}}class B0 extends Zl{constructor(e){super(13,e??"unable to negotiate")}}var Nd;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(Nd||(Nd={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(Nd||(Nd={}));var ne;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ne||(ne={}));var se;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(se||(se={}));var Ee;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(Ee||(Ee={}));var ge;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(ge||(ge={}));function YC(t,e,n){var r,i,o;e===void 0&&(e=50),n===void 0&&(n={});var s=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var f=Date.now()-l;if(f+e>=c)return c-f}return e}var h=function(){var f=[].slice.call(arguments),p=this;return new Promise(function(m,C){var g=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,l=Date.now(),!s){var S=t.apply(p,f);a&&a(S),u.forEach(function(k){return(0,k.resolve)(S)}),u=[]}},d()),g){var v=t.apply(p,f);return a&&a(v),m(v)}u.push({resolve:m,reject:C})})};return h.cancel=function(f){o!==void 0&&clearTimeout(o),u.forEach(function(p){return(0,p.reject)(f)}),u=[]},h}const I9=/version\/(\d+(\.?_?\d+)+)/i;let bm;function Is(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(bm===void 0||e){const r=S9.find(i=>{let{test:o}=i;return o.test(n)});bm=r==null?void 0:r.describe(n)}return bm}const S9=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:wm(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:wm(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:wm(I9,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function wm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var b9="1.15.13";const w9=b9,A9=11;class xn{}xn.setTimeout=function(){return setTimeout(...arguments)};xn.setInterval=function(){return setInterval(...arguments)};xn.clearTimeout=function(){return clearTimeout(...arguments)};xn.clearInterval=function(){return clearInterval(...arguments)};class ft{constructor(e,n,r,i,o){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const k9=["vp8","h264"],vP=["vp8","h264","vp9","av1"];function E9(t){return!!k9.find(e=>e===t)}var bp;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(bp||(bp={}));const _d={h90:new ft(160,90,9e4,20),h180:new ft(320,180,16e4,20),h216:new ft(384,216,18e4,20),h360:new ft(640,360,45e4,20),h540:new ft(960,540,8e5,25),h720:new ft(1280,720,17e5,30),h1080:new ft(1920,1080,3e6,30),h1440:new ft(2560,1440,5e6,30),h2160:new ft(3840,2160,8e6,30)},U0={h120:new ft(160,120,7e4,20),h180:new ft(240,180,125e3,20),h240:new ft(320,240,14e4,20),h360:new ft(480,360,33e4,20),h480:new ft(640,480,5e5,20),h540:new ft(720,540,6e5,25),h720:new ft(960,720,13e5,30),h1080:new ft(1440,1080,23e5,30),h1440:new ft(1920,1440,38e5,30)},QC={h360fps3:new ft(640,360,2e5,3,"medium"),h360fps15:new ft(640,360,4e5,15,"medium"),h720fps5:new ft(1280,720,8e5,5,"medium"),h720fps15:new ft(1280,720,15e5,15,"medium"),h720fps30:new ft(1280,720,2e6,30,"medium"),h1080fps15:new ft(1920,1080,25e5,15,"medium"),h1080fps30:new ft(1920,1080,5e6,30,"medium"),original:new ft(0,0,7e6,30,"medium")};var jn;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(jn||(jn={}));R.util.setEnumType(jn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var lc;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(lc||(lc={}));R.util.setEnumType(lc,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var wp;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(wp||(wp={}));R.util.setEnumType(wp,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Ho extends Se{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Ho().fromBinary(e,n)}static fromJson(e,n){return new Ho().fromJson(e,n)}static fromJsonString(e,n){return new Ho().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ho,e,n)}}Ho.runtime=R;Ho.typeName="livekit.SignalRequest";Ho.fields=R.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:nr,oneof:"message"},{no:2,name:"answer",kind:"message",T:nr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Ri,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ti,oneof:"message"},{no:5,name:"mute",kind:"message",T:xi,oneof:"message"},{no:6,name:"subscription",kind:"message",T:ti,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:so,oneof:"message"},{no:8,name:"leave",kind:"message",T:ni,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:ao,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:ho,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:fo,oneof:"message"},{no:13,name:"simulate",kind:"message",T:En,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:co,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:go,oneof:"message"}]);class oo extends Se{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new oo().fromBinary(e,n)}static fromJson(e,n){return new oo().fromJson(e,n)}static fromJsonString(e,n){return new oo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(oo,e,n)}}oo.runtime=R;oo.typeName="livekit.SignalResponse";oo.fields=R.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:zo,oneof:"message"},{no:2,name:"answer",kind:"message",T:nr,oneof:"message"},{no:3,name:"offer",kind:"message",T:nr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Ri,oneof:"message"},{no:5,name:"update",kind:"message",T:Ko,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Pi,oneof:"message"},{no:8,name:"leave",kind:"message",T:ni,oneof:"message"},{no:9,name:"mute",kind:"message",T:xi,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Jo,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Yo,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:qo,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:ts,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:rs,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:is,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:$o,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Xo,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:os,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:as,oneof:"message"}]);class Ei extends Se{constructor(e){super(),this.codec="",this.cid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Ei().fromBinary(e,n)}static fromJson(e,n){return new Ei().fromJson(e,n)}static fromJsonString(e,n){return new Ei().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ei,e,n)}}Ei.runtime=R;Ei.typeName="livekit.SimulcastCodec";Ei.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Ti extends Se{constructor(e){super(),this.cid="",this.name="",this.type=Wn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Ht.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Tn.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Ti().fromBinary(e,n)}static fromJson(e,n){return new Ti().fromJson(e,n)}static fromJsonString(e,n){return new Ti().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ti,e,n)}}Ti.runtime=R;Ti.typeName="livekit.AddTrackRequest";Ti.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:R.getEnumType(Wn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:R.getEnumType(Ht)},{no:9,name:"layers",kind:"message",T:tr,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Ei,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:R.getEnumType(Tn)},{no:15,name:"stream",kind:"scalar",T:9}]);class Ri extends Se{constructor(e){super(),this.candidateInit="",this.target=jn.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ri().fromBinary(e,n)}static fromJson(e,n){return new Ri().fromJson(e,n)}static fromJsonString(e,n){return new Ri().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ri,e,n)}}Ri.runtime=R;Ri.typeName="livekit.TrickleRequest";Ri.fields=R.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:R.getEnumType(jn)}]);class xi extends Se{constructor(e){super(),this.sid="",this.muted=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new xi().fromBinary(e,n)}static fromJson(e,n){return new xi().fromJson(e,n)}static fromJsonString(e,n){return new xi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(xi,e,n)}}xi.runtime=R;xi.typeName="livekit.MuteTrackRequest";xi.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class zo extends Se{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),R.util.initPartial(e,this)}static fromBinary(e,n){return new zo().fromBinary(e,n)}static fromJson(e,n){return new zo().fromJson(e,n)}static fromJsonString(e,n){return new zo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(zo,e,n)}}zo.runtime=R;zo.typeName="livekit.JoinResponse";zo.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:jl},{no:2,name:"participant",kind:"message",T:Gr},{no:3,name:"other_participants",kind:"message",T:Gr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:lo,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:no},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Wo},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class Xo extends Se{constructor(e){super(),this.iceServers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Xo().fromBinary(e,n)}static fromJson(e,n){return new Xo().fromJson(e,n)}static fromJsonString(e,n){return new Xo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Xo,e,n)}}Xo.runtime=R;Xo.typeName="livekit.ReconnectResponse";Xo.fields=R.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:lo,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:no}]);class Pi extends Se{constructor(e){super(),this.cid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Pi().fromBinary(e,n)}static fromJson(e,n){return new Pi().fromJson(e,n)}static fromJsonString(e,n){return new Pi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Pi,e,n)}}Pi.runtime=R;Pi.typeName="livekit.TrackPublishedResponse";Pi.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Cr}]);class $o extends Se{constructor(e){super(),this.trackSid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new $o().fromBinary(e,n)}static fromJson(e,n){return new $o().fromJson(e,n)}static fromJsonString(e,n){return new $o().fromJsonString(e,n)}static equals(e,n){return R.util.equals($o,e,n)}}$o.runtime=R;$o.typeName="livekit.TrackUnpublishedResponse";$o.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class nr extends Se{constructor(e){super(),this.type="",this.sdp="",R.util.initPartial(e,this)}static fromBinary(e,n){return new nr().fromBinary(e,n)}static fromJson(e,n){return new nr().fromJson(e,n)}static fromJsonString(e,n){return new nr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(nr,e,n)}}nr.runtime=R;nr.typeName="livekit.SessionDescription";nr.fields=R.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class Ko extends Se{constructor(e){super(),this.participants=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Ko().fromBinary(e,n)}static fromJson(e,n){return new Ko().fromJson(e,n)}static fromJsonString(e,n){return new Ko().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ko,e,n)}}Ko.runtime=R;Ko.typeName="livekit.ParticipantUpdate";Ko.fields=R.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Gr,repeated:!0}]);class ti extends Se{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ti().fromBinary(e,n)}static fromJson(e,n){return new ti().fromJson(e,n)}static fromJsonString(e,n){return new ti().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ti,e,n)}}ti.runtime=R;ti.typeName="livekit.UpdateSubscription";ti.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:to,repeated:!0}]);class so extends Se{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=hn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new so().fromBinary(e,n)}static fromJson(e,n){return new so().fromJson(e,n)}static fromJsonString(e,n){return new so().fromJsonString(e,n)}static equals(e,n){return R.util.equals(so,e,n)}}so.runtime=R;so.typeName="livekit.UpdateTrackSettings";so.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:R.getEnumType(hn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class ni extends Se{constructor(e){super(),this.canReconnect=!1,this.reason=us.UNKNOWN_REASON,R.util.initPartial(e,this)}static fromBinary(e,n){return new ni().fromBinary(e,n)}static fromJson(e,n){return new ni().fromJson(e,n)}static fromJsonString(e,n){return new ni().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ni,e,n)}}ni.runtime=R;ni.typeName="livekit.LeaveRequest";ni.fields=R.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:R.getEnumType(us)}]);class ao extends Se{constructor(e){super(),this.trackSid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ao().fromBinary(e,n)}static fromJson(e,n){return new ao().fromJson(e,n)}static fromJsonString(e,n){return new ao().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ao,e,n)}}ao.runtime=R;ao.typeName="livekit.UpdateVideoLayers";ao.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:tr,repeated:!0}]);class co extends Se{constructor(e){super(),this.metadata="",this.name="",R.util.initPartial(e,this)}static fromBinary(e,n){return new co().fromBinary(e,n)}static fromJson(e,n){return new co().fromJson(e,n)}static fromJsonString(e,n){return new co().fromJsonString(e,n)}static equals(e,n){return R.util.equals(co,e,n)}}co.runtime=R;co.typeName="livekit.UpdateParticipantMetadata";co.fields=R.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class lo extends Se{constructor(e){super(),this.urls=[],this.username="",this.credential="",R.util.initPartial(e,this)}static fromBinary(e,n){return new lo().fromBinary(e,n)}static fromJson(e,n){return new lo().fromJson(e,n)}static fromJsonString(e,n){return new lo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(lo,e,n)}}lo.runtime=R;lo.typeName="livekit.ICEServer";lo.fields=R.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Jo extends Se{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Jo().fromBinary(e,n)}static fromJson(e,n){return new Jo().fromJson(e,n)}static fromJsonString(e,n){return new Jo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Jo,e,n)}}Jo.runtime=R;Jo.typeName="livekit.SpeakersChanged";Jo.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:qi,repeated:!0}]);class Yo extends Se{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,n){return new Yo().fromBinary(e,n)}static fromJson(e,n){return new Yo().fromJson(e,n)}static fromJsonString(e,n){return new Yo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Yo,e,n)}}Yo.runtime=R;Yo.typeName="livekit.RoomUpdate";Yo.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:jl}]);class Qo extends Se{constructor(e){super(),this.participantSid="",this.quality=Bo.POOR,this.score=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Qo().fromBinary(e,n)}static fromJson(e,n){return new Qo().fromJson(e,n)}static fromJsonString(e,n){return new Qo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Qo,e,n)}}Qo.runtime=R;Qo.typeName="livekit.ConnectionQualityInfo";Qo.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:R.getEnumType(Bo)},{no:3,name:"score",kind:"scalar",T:2}]);class qo extends Se{constructor(e){super(),this.updates=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new qo().fromBinary(e,n)}static fromJson(e,n){return new qo().fromJson(e,n)}static fromJsonString(e,n){return new qo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(qo,e,n)}}qo.runtime=R;qo.typeName="livekit.ConnectionQualityUpdate";qo.fields=R.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:Qo,repeated:!0}]);class es extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=lc.ACTIVE,R.util.initPartial(e,this)}static fromBinary(e,n){return new es().fromBinary(e,n)}static fromJson(e,n){return new es().fromJson(e,n)}static fromJsonString(e,n){return new es().fromJsonString(e,n)}static equals(e,n){return R.util.equals(es,e,n)}}es.runtime=R;es.typeName="livekit.StreamStateInfo";es.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(lc)}]);class ts extends Se{constructor(e){super(),this.streamStates=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ts().fromBinary(e,n)}static fromJson(e,n){return new ts().fromJson(e,n)}static fromJsonString(e,n){return new ts().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ts,e,n)}}ts.runtime=R;ts.typeName="livekit.StreamStateUpdate";ts.fields=R.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:es,repeated:!0}]);class Ni extends Se{constructor(e){super(),this.quality=hn.LOW,this.enabled=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ni().fromBinary(e,n)}static fromJson(e,n){return new Ni().fromJson(e,n)}static fromJsonString(e,n){return new Ni().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ni,e,n)}}Ni.runtime=R;Ni.typeName="livekit.SubscribedQuality";Ni.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(hn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class ns extends Se{constructor(e){super(),this.codec="",this.qualities=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ns().fromBinary(e,n)}static fromJson(e,n){return new ns().fromJson(e,n)}static fromJsonString(e,n){return new ns().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ns,e,n)}}ns.runtime=R;ns.typeName="livekit.SubscribedCodec";ns.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Ni,repeated:!0}]);class rs extends Se{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new rs().fromBinary(e,n)}static fromJson(e,n){return new rs().fromJson(e,n)}static fromJsonString(e,n){return new rs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(rs,e,n)}}rs.runtime=R;rs.typeName="livekit.SubscribedQualityUpdate";rs.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Ni,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:ns,repeated:!0}]);class uo extends Se{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",R.util.initPartial(e,this)}static fromBinary(e,n){return new uo().fromBinary(e,n)}static fromJson(e,n){return new uo().fromJson(e,n)}static fromJsonString(e,n){return new uo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(uo,e,n)}}uo.runtime=R;uo.typeName="livekit.TrackPermission";uo.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class ho extends Se{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ho().fromBinary(e,n)}static fromJson(e,n){return new ho().fromJson(e,n)}static fromJsonString(e,n){return new ho().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ho,e,n)}}ho.runtime=R;ho.typeName="livekit.SubscriptionPermission";ho.fields=R.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:uo,repeated:!0}]);class is extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new is().fromBinary(e,n)}static fromJson(e,n){return new is().fromJson(e,n)}static fromJsonString(e,n){return new is().fromJsonString(e,n)}static equals(e,n){return R.util.equals(is,e,n)}}is.runtime=R;is.typeName="livekit.SubscriptionPermissionUpdate";is.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class fo extends Se{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new fo().fromBinary(e,n)}static fromJson(e,n){return new fo().fromJson(e,n)}static fromJsonString(e,n){return new fo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(fo,e,n)}}fo.runtime=R;fo.typeName="livekit.SyncState";fo.fields=R.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:nr},{no:2,name:"subscription",kind:"message",T:ti},{no:3,name:"publish_tracks",kind:"message",T:Pi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:po,repeated:!0},{no:5,name:"offer",kind:"message",T:nr}]);class po extends Se{constructor(e){super(),this.label="",this.id=0,this.target=jn.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,n){return new po().fromBinary(e,n)}static fromJson(e,n){return new po().fromJson(e,n)}static fromJsonString(e,n){return new po().fromJsonString(e,n)}static equals(e,n){return R.util.equals(po,e,n)}}po.runtime=R;po.typeName="livekit.DataChannelInfo";po.fields=R.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:R.getEnumType(jn)}]);class En extends Se{constructor(e){super(),this.scenario={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new En().fromBinary(e,n)}static fromJson(e,n){return new En().fromJson(e,n)}static fromJsonString(e,n){return new En().fromJsonString(e,n)}static equals(e,n){return R.util.equals(En,e,n)}}En.runtime=R;En.typeName="livekit.SimulateScenario";En.fields=R.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:R.getEnumType(wp),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class go extends Se{constructor(e){super(),this.timestamp=Ue.zero,this.rtt=Ue.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new go().fromBinary(e,n)}static fromJson(e,n){return new go().fromJson(e,n)}static fromJsonString(e,n){return new go().fromJsonString(e,n)}static equals(e,n){return R.util.equals(go,e,n)}}go.runtime=R;go.typeName="livekit.Ping";go.fields=R.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class os extends Se{constructor(e){super(),this.lastPingTimestamp=Ue.zero,this.timestamp=Ue.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new os().fromBinary(e,n)}static fromJson(e,n){return new os().fromJson(e,n)}static fromJsonString(e,n){return new os().fromJsonString(e,n)}static equals(e,n){return R.util.equals(os,e,n)}}os.runtime=R;os.typeName="livekit.Pong";os.fields=R.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class na extends Se{constructor(e){super(),this.regions=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new na().fromBinary(e,n)}static fromJson(e,n){return new na().fromJson(e,n)}static fromJsonString(e,n){return new na().fromJsonString(e,n)}static equals(e,n){return R.util.equals(na,e,n)}}na.runtime=R;na.typeName="livekit.RegionSettings";na.fields=R.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:ss,repeated:!0}]);class ss extends Se{constructor(e){super(),this.region="",this.url="",this.distance=Ue.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new ss().fromBinary(e,n)}static fromJson(e,n){return new ss().fromJson(e,n)}static fromJsonString(e,n){return new ss().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ss,e,n)}}ss.runtime=R;ss.typeName="livekit.RegionInfo";ss.fields=R.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class as extends Se{constructor(e){super(),this.trackSid="",this.err=Pd.SE_UNKNOWN,R.util.initPartial(e,this)}static fromBinary(e,n){return new as().fromBinary(e,n)}static fromJson(e,n){return new as().fromJson(e,n)}static fromJsonString(e,n){return new as().fromJsonString(e,n)}static equals(e,n){return R.util.equals(as,e,n)}}as.runtime=R;as.typeName="livekit.SubscriptionResponse";as.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:R.getEnumType(Pd)}]);function T9(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const R9=5e3,Cu=[];class Y extends Eo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Y.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Ke,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),R9):this.handleAppVisibilityChanged()},this.log=Cs((i=r.loggerName)!==null&&i!==void 0?i:Co.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Y.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Tt(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===Y.Kind.Video&&(n="video"),this.attachedElements.length===0&&Y.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(Cu.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&Cu.splice(Cu.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Zc(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?ge.AudioPlaybackStarted:ge.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?ge.AudioPlaybackFailed:ge.VideoPlaybackFailed,o):o.name==="AbortError"?Ke.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):Ke.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(s=>s.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ge.ElementAttached,e),e}detach(e){try{if(e){il(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ge.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{il(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(ge.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=Cs(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),Cu.forEach(r=>{r.parentElement||(n=!1)}),n&&Cu.push(e)}}handleAppVisibilityChanged(){return G(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){wr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){wr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Zc(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!uc()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(uc()||El())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function il(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return Wn.AUDIO;case e.Video:return Wn.VIDEO;default:return Wn.DATA}}t.kindToProto=i;function o(l){switch(l){case Wn.AUDIO:return e.Audio;case Wn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=o;function s(l){switch(l){case n.Camera:return Ht.CAMERA;case n.Microphone:return Ht.MICROPHONE;case n.ScreenShare:return Ht.SCREEN_SHARE;case n.ScreenShareAudio:return Ht.SCREEN_SHARE_AUDIO;default:return Ht.UNKNOWN}}t.sourceToProto=s;function a(l){switch(l){case Ht.CAMERA:return n.Camera;case Ht.MICROPHONE:return n.Microphone;case Ht.SCREEN_SHARE:return n.ScreenShare;case Ht.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function c(l){switch(l){case lc.ACTIVE:return r.Active;case lc.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(Y||(Y={}));function yP(t,e,n){var r;const i=(r=T9(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&V0(i.audio,e),i.video&&V0(i.video,n),i}function V0(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function lg(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":V0(r,i.resolution);break;default:r[o]=i[o]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function x9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return G(this,void 0,void 0,function*(){const n=qC();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield ds(e),r.getByteTimeDomainData(o);const a=o.some(c=>c!==128&&c!==0);return n.close(),!a}return!1})}function qC(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function P9(t){return t===Y.Source.Microphone?"audioinput":t===Y.Source.Camera?"videoinput":void 0}function N9(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,uc()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function CP(t){const e=t.split("/")[1].toLowerCase();if(!vP.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function _9(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new Pi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Tt(t){return t instanceof Y?{trackSid:t.sid,trackSource:t.source,trackMuted:t.isMuted,trackEnabled:t.mediaStreamTrack.enabled,trackKind:t.kind}:{trackSid:t.trackSid,trackName:t.trackName,track:t.track?Tt(t.track):void 0,trackEnabled:t.isEnabled,trackEncrypted:t.isEncrypted,trackMimeType:t.mimeType}}const O9="|",eA="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function M9(t){const e=t.split(O9);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function ds(t){return G(this,void 0,void 0,function*(){return new Promise(e=>xn.setTimeout(e,t))})}function tA(){return"addTransceiver"in RTCPeerConnection.prototype}function nA(){return"addTrack"in RTCPeerConnection.prototype}function D9(){if(!("getCapabilities"in RTCRtpSender)||uc())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function L9(){if(!("getCapabilities"in RTCRtpSender)||El())return!1;if(uc()){const n=Is();if(n!=null&&n.version&&eI(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Ju(t){return t==="av1"||t==="vp9"}function G0(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const F9={Chrome:"100",Safari:"15",Firefox:"100"};function B9(t){if(!wr()||!("setCodecPreferences"in t))return!1;const e=Is();if(!(e!=null&&e.name)||!e.version)return!1;const n=F9[e.name];return n?eI(e.version,n)>=0:!1}function El(){var t;return((t=Is())===null||t===void 0?void 0:t.name)==="Firefox"}function U9(){var t;return((t=Is())===null||t===void 0?void 0:t.name)==="Chrome"}function uc(){var t;return((t=Is())===null||t===void 0?void 0:t.name)==="Safari"}function V9(){const t=Is();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function IP(){return wr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function wr(){return typeof document<"u"}function dc(){return navigator.product=="ReactNative"}function W0(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function SP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function bP(){if(!dc())return;let t=SP();if(t)return t.platform}function rA(){if(wr())return window.devicePixelRatio;if(dc()){let t=SP();if(t)return t.devicePixelRatio}return 1}function eI(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const s=parseInt(n[o],10),a=parseInt(r[o],10);if(s>a)return 1;if(s<a)return-1;if(o===i-1&&s===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function G9(t){for(const e of t)e.target.handleResize(e)}function W9(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Am=null;const iA=()=>(Am||(Am=new ResizeObserver(G9)),Am);let km=null;const oA=()=>(km||(km=new IntersectionObserver(W9,{root:null,rootMargin:"0px"})),km);function j9(){var t;const e=new jo({sdk:kl.JS,protocol:A9,version:w9});return dc()&&(e.os=(t=bP())!==null&&t!==void 0?t:""),e}function sA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(t/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Iu;function Em(){if(!Iu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Iu]=r.stream.getAudioTracks(),!Iu)throw Error("Could not get empty media stream audio track");Iu.enabled=!1}return Iu.clone()}class wP{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>G(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function Z9(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=qC();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let u=0;for(const h of a)u+=Math.pow(h/255,2);return Math.sqrt(u/a.length)},analyser:s,cleanup:()=>G(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class Mi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function H9(t){return vP.includes(t)}function Ya(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function z9(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function aA(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const cA="default";class Qn{static getInstance(){return this.instance===void 0&&(this.instance=new Qn),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return G(this,void 0,void 0,function*(){if(((r=Qn.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){Ke.debug("awaiting getUserMedia promise");try{e?yield Qn.userMediaPromiseMap.get(e):yield Promise.all(Qn.userMediaPromiseMap.values())}catch{Ke.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(uc()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(s=>{const a=s.label==="",c=e?s.kind===e:!0;return a&&c}))){const s={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(s);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(c=>{c.stop()})}return e&&(i=i.filter(o=>o.kind===e)),i})}normalizeDeviceId(e,n,r){return G(this,void 0,void 0,function*(){if(n!==cA)return n;const o=(yield this.getDevices(e)).find(s=>s.groupId===r&&s.deviceId!==cA);return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?Qn.userMediaPromiseMap.has(e):Qn.userMediaPromiseMap.size>0}}Qn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Qn.userMediaPromiseMap=new Map;const X9=1e3;class Tl extends Y{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,n,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=YC(()=>G(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>G(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ge.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Mi,this.pauseUpstreamLock=new Mi,this.processorLock=new Mi,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Y.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return G(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{il(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");Zc(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{Zc(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:X9;var n;return G(this,void 0,void 0,function*(){if(this.kind===Y.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=Is())===null||n===void 0?void 0:n.os)==="iOS"&&(yield ds(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield ds(50)}throw new Ki("unable to get track dimensions after timeout")})}getDeviceId(){return G(this,void 0,void 0,function*(){if(this.source===Y.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===Y.Kind.Audio?"audioinput":"videoinput";return Qn.getInstance().normalizeDeviceId(r,e,n)})}mute(){return G(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return G(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return G(this,void 0,void 0,function*(){if(!this.sender)throw new Ki("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return G(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const n={audio:!1,video:!1};this.kind===Y.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(o=>{il(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(ge.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ge.Muted:ge.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return G(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),IP()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return G(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ge.UpstreamPaused,this);const n=Is();if((n==null?void 0:n.name)==="Safari"&&eI(n.version,"12.0")<0)throw new JC("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return G(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ge.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return G(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return G(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),Zc(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const s={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(s),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(il(this._mediaStreamTrack,a),Zc(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return G(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class $9 extends Eo.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:o,data:s}=n.data;switch(o){case"error":Ke.error(s.error.message),this.emit(ta.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==s.enabled&&s.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(ta.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(s.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(ta.ParticipantEncryptionStatusChanged,s.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(da.KeyRatcheted,s.material,s.keyIndex);break}},this.onWorkerError=n=>{Ke.error("e2ee worker encountered an error:",{error:n.error}),this.emit(ta.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!v9())throw new JC("tried to setup end-to-end encryption on an unsupported browser");if(Ke.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(Ke.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Ke.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Ke.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Ee.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ne.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Tn.NONE,i.identity)),e.on(ne.ConnectionStateChanged,r=>{r===it.Connected&&e.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Tn.NONE,i.identity)})})}).on(ne.TrackUnsubscribed,(r,i,o)=>{var s;const a={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(s=this.worker)===null||s===void 0||s.postMessage(a)}).on(ne.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ne.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(se.LocalTrackPublished,r=>G(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(da.SetKey,r=>this.postKey(r)).on(da.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(s)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?CP(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Tl)||!n){n||Ke.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return G(this,void 0,void 0,function*(){if(this.worker){if(F0()){const o={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(Dh in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let o=e.writableStream,s=e.readableStream;if(!o||!s){const c=e.createEncodedStreams();e.writableStream=c.writable,o=c.writable,e.readableStream=c.readable,s=c.readable}const a={kind:"decode",data:{readableStream:s,writableStream:o,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[s,o])}e[Dh]=!0}})}handleSender(e,n,r){var i;if(!(Dh in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(F0()){Ke.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{Ke.info("initialize encoded streams");const o=e.createEncodedStreams(),s={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s,[o.readable,o.writable])}e[Dh]=!0}}}var Yu;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Yu||(Yu={}));class K9{constructor(){this.pendingTasks=new Map,this.taskMutex=new Mi,this.nextTaskIndex=0}run(e){return G(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Yu.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Yu.RUNNING,yield e()}finally{n.status=Yu.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return G(this,void 0,void 0,function*(){return this.run(()=>G(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const J9=["syncState","trickle","offer","answer","simulate","leave"];function Y9(t){const e=J9.indexOf(t.case)>=0;return Ke.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Ut;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Ut||(Ut={}));class tI{get currentState(){return this.state}get isDisconnected(){return this.state===Ut.DISCONNECTING||this.state===Ut.DISCONNECTED}get isEstablishingConnection(){return this.state===Ut.CONNECTING||this.state===Ut.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Ut.DISCONNECTED,this.log=Ke,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Cs((r=n.loggerName)!==null&&r!==void 0?r:Co.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new K9,this.queuedRequests=[],this.closingLock=new Mi,this.connectionLock=new Mi,this.state=Ut.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return G(this,void 0,void 0,function*(){return this.state=Ut.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return G(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Ut.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=z9(e),e=e.replace(/\/$/,""),e+="/rtc";const o=j9(),s=Q9(n,o,r);return new Promise((a,c)=>G(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>G(this,void 0,void 0,function*(){this.close(),clearTimeout(d),c(new It("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),c(new It("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(e+s),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=h=>G(this,void 0,void 0,function*(){if(this.state!==Ut.CONNECTED){clearTimeout(d);try{const f=yield fetch("http".concat(e.substring(2),"/validate").concat(s));if(f.status.toFixed(0).startsWith("4")){const p=yield f.text();c(new It(p,0,f.status))}else c(new It("Internal error",2,f.status))}catch{c(new It("server was not reachable",1))}return}this.handleWSError(h)}),this.ws.onmessage=h=>G(this,void 0,void 0,function*(){var f,p,m,C;let g;if(typeof h.data=="string"){const v=JSON.parse(h.data);g=oo.fromJson(v)}else if(h.data instanceof ArrayBuffer)g=oo.fromBinary(new Uint8Array(h.data));else{this.log.error("could not decode websocket message: ".concat(typeof h.data),this.logContext);return}if(this.state!==Ut.CONNECTED){let v=!1;if(((f=g.message)===null||f===void 0?void 0:f.case)==="join"?(this.state=Ut.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=g.message.value.pingTimeout,this.pingIntervalDuration=g.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(g.message.value)):this.state===Ut.RECONNECTING&&g.message.case!=="leave"?(this.state=Ut.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=g.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((m=g.message)===null||m===void 0?void 0:m.value):(a(),v=!0)):this.isEstablishingConnection&&g.message.case==="leave"?c(new It("Received leave request while trying to (re)connect",4)):r.reconnect||c(new It("did not receive join response, got ".concat((C=g.message)===null||C===void 0?void 0:C.case," instead"))),!v)return}this.signalLatency&&(yield ds(this.signalLatency)),this.handleSignalResponse(g)}),this.ws.onclose=h=>{this.isEstablishingConnection&&c(new It("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:h.reason,state:this.state})),this.handleOnClose(h.reason)}}finally{l()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return G(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(e&&(this.state=Ut.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,ds(250)])),this.ws=void 0}}finally{e&&(this.state=Ut.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Ap(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Ap(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Ri({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new xi({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new co({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new ao({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new ho({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ue.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new go({timestamp:Ue.parse(Date.now()),rtt:Ue.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new ni({canReconnect:!1,reason:us.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return G(this,void 0,void 0,function*(){if(!n&&!Y9(e)&&this.state===Ut.RECONNECTING){this.queuedRequests.push(()=>G(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield ds(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new Ho({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const s=lA(i.value);this.onAnswer&&this.onAnswer(s)}else if(i.case==="offer"){const s=lA(i.value);this.onOffer&&this.onOffer(s)}else if(i.case==="trickle"){const s=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(s,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return G(this,void 0,void 0,function*(){if(this.state===Ut.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=xn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&xn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=xn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&xn.clearInterval(this.pingInterval)}}function lA(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Ap(t){return new nr({sdp:t.sdp,type:t.type})}function Q9(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",dc()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var AP={},kP={exports:{}},uA=kP.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(uA).forEach(function(t){var e=uA[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var EP=kP.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=e(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=e(a[d+1]))},r=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},i=EP,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(d){var h=d[0],f=d.slice(2);h==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var p=0;p<(i[h]||[]).length;p+=1){var m=i[h][p];if(m.reg.test(f))return r(m,u,f)}}),c.media=l,c};var s=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(s,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(AP);var Tm=EP,q9=/%[sdv%]/g,ej=function(t){var e=1,n=arguments,r=n.length;return t.replace(q9,function(i){if(e>=r)return i;var o=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},Su=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var o=0;o<e.names.length;o+=1){var s=e.names[o];e.name?i.push(n[e.name][s]):i.push(n[e.names[o]])}else i.push(n[e.name]);return ej.apply(null,i)},tj=["v","o","s","i","u","e","p","c","b","t","r","z","a"],nj=["i","c","b","a"],rj=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var n=e.outerOrder||tj,r=e.innerOrder||nj,i=[];return n.forEach(function(o){Tm[o].forEach(function(s){s.name in t&&t[s.name]!=null?i.push(Su(o,s,t)):s.push in t&&t[s.push]!=null&&t[s.push].forEach(function(a){i.push(Su(o,s,a))})})}),t.media.forEach(function(o){i.push(Su("m",Tm.m[0],o)),r.forEach(function(s){Tm[s].forEach(function(a){a.name in o&&o[a.name]!=null?i.push(Su(s,a,o)):a.push in o&&o[a.push]!=null&&o[a.push].forEach(function(c){i.push(Su(s,a,c))})})})}),i.join(`\r
`)+`\r
`},ij=AP,oj=rj,Rm=oj,Du=ij.parse;const dA=.7,ol={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class hA extends Eo.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=Ke,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=YC(o=>G(this,void 0,void 0,function*(){this.emit(ol.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Cs((i=r.loggerName)!==null&&i!==void 0?i:Co.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=U9()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return G(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return G(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:o}=aj(e);this.remoteStereoMids=i,this.remoteNackMids=o}else if(e.type==="answer"){const i=Du((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||o.mid!=s.transceiver.mid)return!1;let a=0;if(o.rtp.some(l=>l.codec.toUpperCase()===s.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of o.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),c=!0;break}return c||s.maxbr>0&&o.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),r=Rm(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(ol.NegotiationComplete),e.sdp&&Du(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(ol.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){var n;return G(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=Du((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"?fA(o,[],[]):o.type==="video"&&(sj(o),this.trackBitrates.some(s=>{if(!o.msid||!s.cid||!o.msid.includes(s.cid))return!1;let a=0;if(o.rtp.some(l=>l.codec.toUpperCase()===s.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of o.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(Math.round(s.maxbr*dA))),l.config.includes("x-google-max-bitrate")||(l.config+=";x-google-max-bitrate=".concat(s.maxbr)),c=!0;break}return c||o.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(s.maxbr*dA),";x-google-max-bitrate=").concat(s.maxbr)}),!0}))}),yield this.setMungedSDP(r,Rm(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return G(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=Du((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&fA(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Rm(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new an("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new an("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return G(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const s=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return i.get(s)})}setMungedSDP(e,n,r){return G(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const s={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new B0(o)}})}}function fA(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function sj(t){var e,n,r,i;const o=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!Ju(o))return;let s=0;((r=t.ext)===null||r===void 0?void 0:r.some(c=>c.uri===eA?!0:(c.value>s&&(s=c.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:s+1,uri:eA})}function aj(t){var e;const n=[],r=[],i=Du((e=t.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(s=>{var a;s.type==="audio"&&(s.rtp.some(c=>c.codec==="opus"?(o=c.payload,!0):!1),!((a=s.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===o&&c.type==="nack")&&r.push(s.mid),s.fmtp.some(c=>c.payload===o?(c.config.includes("sprop-stereo=1")&&n.push(s.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const j0="vp8",cj={audioBitrate:bp.music.maxBitrate,audioPreset:bp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:QC.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:j0,backupCodec:!0},TP={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},RP={resolution:_d.h720.resolution},lj={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new qW,disconnectOnPageLeave:!0,expWebAudioMix:!1},nI={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var ln;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(ln||(ln={}));class uj{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=nI.peerConnectionTimeout,this.log=Ke,this.updateState=()=>{var s;const a=this.state,c=this.requiredTransports.map(l=>l.getConnectionState());c.every(l=>l==="connected")?this.state=ln.CONNECTED:c.some(l=>l==="failed")?this.state=ln.FAILED:c.some(l=>l==="connecting")?this.state=ln.CONNECTING:c.every(l=>l==="closed")?this.state=ln.CLOSED:c.some(l=>l==="closed")?this.state=ln.CLOSING:c.every(l=>l==="new")&&(this.state=ln.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(ln[a]," to ").concat(ln[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Cs((i=r.loggerName)!==null&&i!==void 0?i:Co.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const o={optional:[{googDscp:!0}]};this.publisher=new hA(e,o,r),this.subscriber=new hA(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,jn.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,jn.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,s)},this.subscriber.onTrack=s=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,s)},this.publisher.onOffer=s=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,s)},this.state=ln.NEW,this.connectionLock=new Mi}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return G(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return G(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return G(this,void 0,void 0,function*(){n===jn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return G(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return G(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,n)))}finally{i()}})}negotiate(e){return G(this,void 0,void 0,function*(){return new Promise((n,r)=>G(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(ol.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(ol.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(s=>{clearTimeout(i),r(s)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===jn.PUBLISHER?this.publisher.getConnectedAddress():e===jn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return G(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((o,s)=>G(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),xn.clearTimeout(c),s(new It("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const c=xn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),s(new It("could not establish pc connection"))},r);for(;this.state!==ln.CONNECTED;)if(yield ds(50),n!=null&&n.signal.aborted){s(new It("room connection has been cancelled",3));return}xn.clearTimeout(c),n==null||n.signal.removeEventListener("abort",a),o()}))})}}const pA="_lossy",gA="_reliable",dj=2*1e3,mA="leave-reconnect";var di;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(di||(di={}));class hj extends Eo.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=nI.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=di.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Ke,this.handleDataChannel=r=>{let{channel:i}=r;return G(this,void 0,void 0,function*(){if(i){if(i.label===gA)this.reliableDCSub=i;else if(i.label===pA)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>G(this,void 0,void 0,function*(){var i,o;const s=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const c=Qi.fromBinary(new Uint8Array(a));((i=c.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(Ee.ActiveSpeakersUpdate,c.value.value.speakers):((o=c.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(Ee.DataPacketReceived,c.value.value,c.kind)}finally{s()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?cn.LOSSY:cn.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(Ee.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(a===null){o(s);return}r===mA&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=xn.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===di.Connected&&r();const o=()=>{this.off(Ee.Disconnected,s),r()},s=()=>{this.off(Ee.Restarted,o),i()};this.once(Ee.Restarted,o),this.once(Ee.Disconnected,s)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(Ee.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Ut.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(_o.RR_SIGNAL_DISCONNECTED))},this.log=Cs((n=e.loggerName)!==null&&n!==void 0?n:Co.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new tI(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Mi,this.dataProcessLock=new Mi,this.dcBufferStatus=new Map([[cn.LOSSY,!0],[cn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Ee.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Ee.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Ee.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Ee.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Ee.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Ee.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Ee.StreamStateChanged,r)}get logContext(){var e,n,r,i,o,s;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(s=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||s===void 0?void 0:s.identity}}join(e,n,r,i){return G(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof It&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw o}})}close(){return G(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(Ee.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return G(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return G(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Ki("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new It("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),n(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return G(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return G(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==ln.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new uj(r,e.subscriberPrimary,this.loggerOptions),this.emit(Ee.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,s)=>G(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===ln.CONNECTED){const a=this.pcState===di.New;this.pcState=di.Connected,a&&this.emit(Ee.Connected,e)}else i===ln.FAILED&&this.pcState===di.Connected&&(this.pcState=di.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?_o.RR_SUBSCRIBER_FAILED:_o.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(Ee.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>G(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>G(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Ee.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(Ee.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Ee.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",_o.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(mA)):(this.emit(Ee.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const s={urls:o.urls};o.username&&(s.username=o.username),o.credential&&(s.credential=o.credential),i.push(s)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Fi.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(pA,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(gA,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(n);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],s=[],a=[];i.codecs.forEach(c=>{const l=c.mimeType.toLowerCase();if(l==="audio/opus"){o.push(c);return}if(!(l==="video/".concat(r))){a.push(c);return}if(r==="h264"){c.sdpFmtpLine&&c.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(c):s.push(c);return}o.push(c)}),B9(e)&&e.setCodecPreferences(o.concat(s,a))}createSender(e,n,r){return G(this,void 0,void 0,function*(){if(tA())return yield this.createTransceiverRTCRtpSender(e,n,r);if(nA())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new an("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return G(this,void 0,void 0,function*(){if(tA())return this.createSimulcastTransceiverSender(e,n,r,i);if(nA())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new an("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new an("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const s=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o);return e.kind===Y.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(s,e.kind,n.videoCodec),e.codec=n.videoCodec),s.sender})}createSimulcastTransceiverSender(e,n,r,i){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new an("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(s,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,s.sender),s.sender})}createRTCRtpSender(e){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new an("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return G(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){Ke.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Fi.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:ln.NEW)===ln.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let s=!0;o instanceof an?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),s=!1):o instanceof Rc||(this.fullReconnectOnNext=!0),s?this.handleDisconnect("reconnect",_o.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Ee.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){var n,r,i;return G(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new an("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Ee.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Rc;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(s){throw s instanceof It&&s.reason===0?new an("could not reconnect, token might be expired"):new Rc}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Ee.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==Ut.CONNECTED)throw new Rc("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(Ee.Restarted)}catch(o){const s=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(s){yield this.restartConnection(s);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){var n;return G(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new an("could not reconnect, url or token not saved");if(!this.pcManager)throw new an("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Ee.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof It&&r.reason===0?new an("could not reconnect, token might be expired"):r instanceof It&&r.reason===4?r:new Rc(i)}if(this.emit(Ee.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Ut.CONNECTED)throw new Rc("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Ee.Resumed)})}waitForPCInitialConnection(e,n){return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new an("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return G(this,void 0,void 0,function*(){this.pcState=di.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield ds(dj),!this.pcManager)throw new an("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=di.Connected}catch(e){throw this.pcState=di.Disconnected,new It("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return G(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return G(this,void 0,void 0,function*(){if(!this.pcManager)throw new an("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!i)throw new It("".concat(o," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const s=this.dataChannelForKind(e,n);if((s==null?void 0:s.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield ds(50)}throw new It("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return G(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==ln.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return G(this,void 0,void 0,function*(){return new Promise((e,n)=>G(this,void 0,void 0,function*(){if(!this.pcManager){n(new B0("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(Ee.Closing,i),this.pcManager.publisher.once(ol.RTPVideoPayloadTypes,o=>{const s=new Map;o.forEach(a=>{const c=a.codec.toLowerCase();H9(c)&&s.set(a.payload,c)}),this.emit(Ee.RTPVideoMapUpdate,s)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof B0&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",_o.RR_UNKNOWN),n(o)}finally{this.off(Ee.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===cn.LOSSY)return this.lossyDCSub;if(e===cn.RELIABLE)return this.reliableDCSub}else{if(e===cn.LOSSY)return this.lossyDC;if(e===cn.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array;e.forEach(l=>{l.isDesired!==a&&c.push(l.trackSid)}),this.client.sendSyncState(new fo({answer:o?Ap({sdp:o.sdp,type:o.type}):void 0,offer:s?Ap({sdp:s.sdp,type:s.type}):void 0,subscription:new ti({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:_9(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new po({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(cn.LOSSY),jn.PUBLISHER),n(this.dataChannelForKind(cn.RELIABLE),jn.PUBLISHER),n(this.dataChannelForKind(cn.LOSSY,!0),jn.SUBSCRIBER),n(this.dataChannelForKind(cn.RELIABLE,!0),jn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&xn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){wr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){wr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Rc extends Error{}class vA{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return W0(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return G(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),Ke.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return G(this,void 0,void 0,function*(){const n=yield fetch("".concat(fj(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new It("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function fj(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const rI=2e3;function ug(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class pr extends Tl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,Y.Kind.Audio,n,r,o),this.stopOnMute=!1,this.monitorSender=()=>G(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}s&&this.prevStats&&(this._currentBitrate=ug(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return G(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ya(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Ya(this._constraints.deviceId);return this.source===Y.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return G(this,void 0,void 0,function*(){let n;if(e){const r=lg({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return G(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){wr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},rI)))}setProcessor(e){var n;return G(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return G(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return G(this,void 0,void 0,function*(){const e=yield x9(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(ge.AudioSilenceDetected)),e})}}function xP(t,e,n){switch(t.kind){case"audio":return new pr(t,e,!1,void 0,n);case"video":return new Jr(t,e,!1,n);default:throw new Ki("unsupported track type: ".concat(t.kind))}}const pj=Object.values(_d),gj=Object.values(U0),mj=Object.values(QC),vj=[_d.h180,_d.h360],yj=[U0.h180,U0.h360],Cj=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new ft(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),Z0=["q","h","f"];function H0(t,e,n,r){var i,o;let s=r==null?void 0:r.videoEncoding;t&&(s=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!s&&!a&&!c||!e||!n)return[{}];s||(s=Sj(t,e,n,l),Ke.debug("using video encoding",s));const u=new ft(e,n,s.maxBitrate,s.maxFramerate,s.priority);if(c&&Ju(l)){Ke.debug("using svc with scalabilityMode ".concat(c));const f=new PP(c),p=[];if(f.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let m=0;m<f.spatial;m+=1)p.push({rid:Z0[2-m],maxBitrate:s.maxBitrate/Math.pow(3,m),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=c,Ke.debug("encodings",p),p}if(!a)return[s];let d=[];t?d=(i=CA(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:yA(t,u):d=(o=CA(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:yA(t,u);let h;if(d.length>0){const f=d[0];d.length>1&&([,h]=d);const p=Math.max(e,n);if(p>=960&&h)return xm(e,n,[f,h,u]);if(p>=480)return xm(e,n,[f,u])}return xm(e,n,[u])}function Ij(t,e,n){var r,i,o,s;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Ke.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),c=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(o=a.height)!==null&&o!==void 0?o:(s=t.dimensions)===null||s===void 0?void 0:s.height;return H0(t.source===Y.Source.ScreenShare,c,l,n)}function Sj(t,e,n,r){const i=bj(t,e,n);let{encoding:o}=i[0];const s=Math.max(e,n);for(let a=0;a<i.length;a+=1){const c=i[a];if(o=c.encoding,c.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function bj(t,e,n){if(t)return mj;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?pj:gj}function yA(t,e){if(t)return Cj(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?vj:yj}function xm(t,e,n){const r=[];if(n.forEach((i,o)=>{if(o>=Z0.length)return;const s=Math.min(t,e),c={rid:Z0[o],scaleResolutionDownBy:Math.max(1,s/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(c.maxFramerate=i.encoding.maxFramerate);const l=El()||o===0;i.encoding.priority&&l&&(c.priority=i.encoding.priority,c.networkPriority=i.encoding.priority),r.push(c)}),dc()&&bP()==="ios"){let i;r.forEach(s=>{i?s.maxFramerate&&s.maxFramerate>i&&(i=s.maxFramerate):i=s.maxFramerate});let o=!0;r.forEach(s=>{var a;s.maxFramerate!=i&&(o&&(o=!1,Ke.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Ke.info('Setting framerate of encoding "'.concat((a=s.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),s.maxFramerate=i)})}return r}function CA(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class PP{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const wj=5e3;class Jr extends Tl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Y.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>G(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const s=new Map(o.map(a=>[a.rid,a]));if(this.prevStats){let a=0;s.forEach((c,l)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(l);a+=ug(c,d)}),this._currentBitrate=a}this.prevStats=s}),this.senderLock=new Mi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!wr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},rI))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,o,s;return G(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,c=Pc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)o=l.value,a=!1,yield(s=o.sender)===null||s===void 0?void 0:s.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,o,s;return G(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,c=Pc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){o=l.value,a=!1;const u=o;yield(s=u.sender)===null||s===void 0?void 0:s.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return G(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return G(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const s={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(s.jitter=a.jitter,s.packetsLost=a.packetsLost,s.roundTripTime=a.roundTripTime),n.push(s)}}),n})}setPublishingQuality(e){const n=[];for(let r=hn.LOW;r<=hn.HIGH;r+=1)n.push(new Ni({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}setDeviceId(e){return G(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Ya(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ya(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,o;return G(this,void 0,void 0,function*(){let s;if(e){const u=lg({video:e});typeof u.video!="boolean"&&(s=u.video)}yield this.restart(s);try{for(var a=!0,c=Pc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){o=l.value,a=!1;const u=o;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,s,a,c,l;return G(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((c=this.processor)===null||c===void 0)&&c.processedTrack)try{for(var u=!0,d=Pc(this.simulcastCodecs.values()),h;h=yield d.next(),i=h.done,!i;u=!0)a=h.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(this.processor.processedTrack)}catch(f){o={error:f}}finally{try{!u&&!i&&(s=d.return)&&(yield s.call(d))}finally{if(o)throw o.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},wj))}setPublishingCodecs(e){var n,r,i,o,s,a,c;return G(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=Pc(e);i=yield r.next(),o=i.done,!o;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const h of u.qualities)if(h.enabled){l.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield IA(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){s={error:u}}finally{try{!n&&!o&&(a=r.return)&&(yield a.call(r))}finally{if(s)throw s.error}}return l})}setPublishingLayers(e){return G(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield IA(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return G(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),IP()&&this.isInBackground&&this.source===Y.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function IA(t,e,n,r,i,o){return G(this,void 0,void 0,function*(){const s=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:c}=a;if(!c)return;if(c.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let l=!1;!1&&c[0].scalabilityMode||c.forEach((d,h)=>{var f;let p=(f=d.rid)!==null&&f!==void 0?f:"";p===""&&(p="q");const m=NP(p),C=n.find(g=>g.quality===m);C&&d.active!==C.enabled&&(l=!0,d.active=C.enabled,i.debug("setting layer ".concat(C.quality," to ").concat(d.active?"enabled":"disabled"),o),El()&&(C.enabled?(d.scaleResolutionDownBy=e[h].scaleResolutionDownBy,d.maxBitrate=e[h].maxBitrate,d.maxFrameRate=e[h].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),l&&(a.encodings=c,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:a.encodings})),yield t.setParameters(a))}finally{s()}})}function NP(t){switch(t){case"f":return hn.HIGH;case"h":return hn.MEDIUM;case"q":return hn.LOW;default:return hn.HIGH}}function SA(t,e,n,r){if(!n)return[new tr({quality:hn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,o=new PP(i),s=[];for(let a=0;a<o.spatial;a+=1)s.push(new tr({quality:hn.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return s}return n.map(i=>{var o,s,a;const c=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let l=NP((s=i.rid)!==null&&s!==void 0?s:"");return new tr({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class _P extends Y{constructor(e,n,r,i,o){super(e,r,o),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ge.Muted:ge.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(ge.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return G(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),rI))}}class Qa extends _P{constructor(e,n,r,i,o,s){super(e,n,Y.Kind.Audio,r,s),this.monitorReceiver=()=>G(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=ug(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;dc()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(dc())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return G(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(G0(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&G0(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ge.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(ge.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return G(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Pm=100;class Qu extends _P{constructor(e,n,r,i,o){super(e,n,Y.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>G(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=ug(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=YC(()=>{this.updateDimensions()},Pm),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?il(this._mediaStreamTrack,n):Zc(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new Aj(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return G(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,n={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return G(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,o=this.elementInfos.some(a=>a.pictureInPicture),s=this.elementInfos.some(a=>a.visible)&&!i||o;if(this.lastVisible!==s){if(!s&&Date.now()-r<Pm){xn.setTimeout(()=>{this.updateVisibility()},Pm);return}this.lastVisible=s,this.emit(ge.VisibilityChanged,s,this)}}updateDimensions(){var e,n;let r=0,i=0;const o=this.getPixelDensity();for(const s of this.elementInfos){const a=s.width()*o,c=s.height()*o;a+c>r+i&&(r=a,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(ge.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?rA():n||(rA()>2?2:1)}}class Aj{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:s}=r;o===this.element&&(this.isIntersecting=s,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??bA(e),this.isPiP=wr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=bA(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,oA().observe(this.element),iA().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=oA())===null||e===void 0||e.unobserve(this.element),(n=iA())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function bA(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:o}=t,{opacity:s,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(s!==""?parseFloat(s)>0:!0)&&a!=="none"}class Oo extends Eo.EventEmitter{constructor(e,n,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Tn.NONE,this.log=Ke,this.handleMuted=()=>{this.emit(ge.Muted)},this.handleUnmuted=()=>{this.emit(ge.Unmuted)},this.log=Cs((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:Co.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=Y.Source.Unknown}setTrack(e){this.track&&(this.track.off(ge.Muted,this.handleMuted),this.track.off(ge.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ge.Muted,this.handleMuted),e.on(ge.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Tt(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Tn.NONE}get audioTrack(){if(this.track instanceof pr||this.track instanceof Qa)return this.track}get videoTrack(){if(this.track instanceof Jr||this.track instanceof Qu)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Y.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Y.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(Oo||(Oo={}));class Od extends Oo{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ge.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(ge.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(ge.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return G(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return G(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return G(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return G(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var qr;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(qr||(qr={}));function kj(t){switch(t){case Bo.EXCELLENT:return qr.Excellent;case Bo.GOOD:return qr.Good;case Bo.POOR:return qr.Poor;case Bo.LOST:return qr.Lost;default:return qr.Unknown}}class OP extends Eo.EventEmitter{get logContext(){var e,n;return Object.assign(Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i,o){var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=qr.Unknown,this.log=Ke,this.log=Cs((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:Co.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(Y.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(Y.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Y.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(se.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(se.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,o,s;const a=this.permissions,c=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((s=this.permissions)===null||s===void 0?void 0:s.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((l,u)=>{var d;return l!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,c&&this.emit(se.ParticipantPermissionsChanged,a),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(se.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=kj(e),n!==this._connectionQuality&&this.emit(se.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Qa||n.track instanceof pr)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ge.Muted,()=>{this.emit(se.TrackMuted,e)}),e.on(ge.Unmuted,()=>{this.emit(se.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Y.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Y.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function Ej(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new uo({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class iI extends Oo{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=hn.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(ge.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new ti({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new to({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ge.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?Oo.SubscriptionStatus.Unsubscribed:super.isSubscribed?Oo.SubscriptionStatus.Subscribed:Oo.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Oo.PermissionStatus.Allowed:Oo.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof Qu&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Qu&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(ge.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(ge.VisibilityChanged,this.handleVisibilityChange),i.off(ge.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(ge.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ge.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ge.VisibilityChanged,this.handleVisibilityChange),e.on(ge.Ended,this.handleEnded),this.emit(ge.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ge.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ge.Muted:ge.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ge.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ge.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Y.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof Qu&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new so({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=hn.HIGH,this.emit(ge.UpdateSettings,e)}}class Md extends OP{static fromParticipantInfo(e,n){return new Md(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,o,s){super(n,r||"",i,o,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ge.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Tt(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ge.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ge.SubscriptionPermissionChanged,n=>{this.emit(se.TrackSubscriptionPermissionChanged,e,n)}),e.on(ge.SubscriptionStatusChanged,n=>{this.emit(se.TrackSubscriptionStatusChanged,e,n)}),e.on(ge.Subscribed,n=>{this.emit(se.TrackSubscribed,n,e)}),e.on(ge.Unsubscribed,n=>{this.emit(se.TrackUnsubscribed,n,e)}),e.on(ge.SubscriptionFailed,n=>{this.emit(se.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,o,s){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(s===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(se.TrackSubscriptionFailed,n);return}s===void 0&&(s=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,o,s-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Tt(a))),this.emit(se.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new Qu(e,n,i,o):l=new Qa(e,n,i,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(r),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof Qa&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var o,s;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const c=Y.kindFromProto(i.type);if(!c)return;a=new iI(c,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(s=this.loggerOptions)===null||s===void 0?void 0:s.loggerName}),a.updateInfo(i),r.set(i.sid,a);const l=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));l&&a.source!==Y.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Tt(l),newTrack:Tt(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Tt(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(se.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case Y.Kind.Audio:this.audioTracks.delete(e);break;case Y.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(se.TrackUnpublished,r)}setAudioOutput(e){return G(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Qa&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class z0 extends OP{constructor(e,n,r,i){super(e,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Tn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new wP)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>Ej(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Tt(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Tt(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Tt(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>G(this,void 0,void 0,function*(){var s,a,c,l,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const h=this.videoTracks.get(o.trackSid);if(!h){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!h.videoTrack)return;const C=yield h.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var f=!0,p=Pc(C),m;m=yield p.next(),s=m.done,!s;f=!0){l=m.value,f=!1;const g=l;E9(g)&&(this.log.debug("publish ".concat(g," for ").concat(h.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Tt(h))),yield this.publishAdditionalCodecForTrack(h.videoTrack,g,h.options))}}catch(g){a={error:g}}finally{try{!f&&!s&&(c=p.return)&&(yield c.call(p))}finally{if(a)throw a.error}}}else o.subscribedQualities.length>0&&(yield(d=h.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.tracks.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>G(this,void 0,void 0,function*(){if(o.source===Y.Source.ScreenShare||o.source===Y.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Tt(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof pr||o instanceof Jr)try{if(wr())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===Y.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),Tt(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Tt(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Tt(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Tn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(Ee.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(Ee.Connected,this.handleReconnected).on(Ee.SignalRestarted,this.handleReconnected).on(Ee.SignalResumed,this.handleReconnected).on(Ee.Restarting,this.handleReconnecting).on(Ee.Resuming,this.handleReconnecting).on(Ee.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Ee.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Ee.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(Y.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(Y.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(Y.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(se.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return G(this,void 0,void 0,function*(){this.encryptionType=e?Tn.GCM:Tn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var o,s;return G(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n}));let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case Y.Source.Camera:c=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case Y.Source.Microphone:c=yield this.createTracks({audio:(s=r)!==null&&s!==void 0?s:!0});break;case Y.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Ki(e)}const l=[];for(const d of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Tt(d))),l.push(this.publishTrack(d,i));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&!(l instanceof Ki)&&this.emit(se.MediaDevicesError,l),l}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===Y.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrack(Y.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return G(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Y.Source.Camera)||this.pendingPublishing.has(Y.Source.Microphone))){this.pendingPublishing.add(Y.Source.Camera),this.pendingPublishing.add(Y.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Y.Source.Camera),this.pendingPublishing.delete(Y.Source.Microphone)}}})}createTracks(e){var n,r;return G(this,void 0,void 0,function*(){const i=yP(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=lg(i);let s;try{s=yield navigator.mediaDevices.getUserMedia(o)}catch(a){throw a instanceof Error&&(o.audio&&(this.microphoneError=a),o.video&&(this.cameraError=a)),a}return o.audio&&(this.microphoneError=void 0,this.emit(se.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),s.getTracks().map(a=>{const c=a.kind==="audio";c?e.audio:e.video;let l;const u=c?o.audio:o.video;typeof u!="boolean"&&(l=u);const d=xP(a,l,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=s,d})})}createScreenTracks(e){return G(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new JC("getDisplayMedia not supported");e.resolution===void 0&&!V9()&&(e.resolution=QC.h1080fps30.resolution);const n=N9(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new Ki("no video track found");const o=new Jr(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=Y.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const s=[o];if(r.getAudioTracks().length>0){this.emit(se.AudioStreamAcquired);const a=new pr(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=Y.Source.ScreenShareAudio,s.push(a)}return s})}publishTrack(e,n){var r,i,o,s;return G(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Tl&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let f;switch(e.source){case Y.Source.Microphone:f="audioinput";break;case Y.Source.Camera:f="videoinput"}f&&this.activeDeviceMap.has(f)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(f)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new pr(e,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new Jr(e,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new Ki("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof pr&&e.setAudioContext(this.audioContext);let c;if(this.tracks.forEach(f=>{f.track&&f.track===e&&(c=f)}),c)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),Tt(c))),c;const l="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:l;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),Tt(e))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=n.dtx)!==null&&o!==void 0||(n.dtx=!1),(s=n.red)!==null&&s!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);uc()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(e.source=d.source);const h=this.publish(e,d,u);this.pendingPublishPromises.set(e,h);try{return yield h}catch(f){throw f}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,o,s,a,c,l,u,d,h,f,p,m,C;return G(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(T=>e instanceof Tl&&T.source===e.source)&&e.source!==Y.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Tt(e))),n.stopMicTrackOnMute&&e instanceof pr&&(e.stopOnMute=!0),e.source===Y.Source.ScreenShare&&El()&&(n.simulcast=!1),n.videoCodec==="av1"&&!D9()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!L9()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=j0);const v=n.videoCodec;e.on(ge.Muted,this.onTrackMuted),e.on(ge.Unmuted,this.onTrackUnmuted),e.on(ge.Ended,this.handleTrackEnded),e.on(ge.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ge.UpstreamResumed,this.onTrackUpstreamResumed);const S=new Ti({cid:e.mediaStreamTrack.id,name:n.name,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n==null?void 0:n.stream});let k;if(e.kind===Y.Kind.Video){let T={width:0,height:0};try{T=yield e.waitForDimensions()}catch{const O=(a=(s=this.roomOptions.videoCaptureDefaults)===null||s===void 0?void 0:s.resolution)!==null&&a!==void 0?a:_d.h720.resolution;T={width:O.width,height:O.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Tt(e)),{dims:T}))}S.width=T.width,S.height=T.height,e instanceof Jr&&(Ju(v)&&(e.source===Y.Source.ScreenShare&&v==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),S.simulcastCodecs=[new Ei({codec:v,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:j0}),n.backupCodec&&v!==n.backupCodec.codec&&S.encryption===Tn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),S.simulcastCodecs.push(new Ei({codec:n.backupCodec.codec,cid:""})))),k=H0(e.source===Y.Source.ScreenShare,S.width,S.height,n),S.layers=SA(S.width,S.height,k,Ju(n.videoCodec))}else e.kind===Y.Kind.Audio&&(k=[{maxBitrate:(u=(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(h=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&h!==void 0?h:"high",networkPriority:(p=(f=n.audioPreset)===null||f===void 0?void 0:f.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new an("cannot publish track when not connected");const w=yield this.engine.addTrack(S);let A;if(w.codecs.forEach(T=>{A===void 0&&(A=T.mimeType)}),A&&e.kind===Y.Kind.Video){const T=CP(A);T!==v&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Tt(e)),{codec:T})),n.videoCodec=T,k=H0(e.source===Y.Source.ScreenShare,S.width,S.height,n))}const x=new Od(e.kind,w,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(x.options=n,e.sid=w.sid,!this.engine.pcManager)throw new an("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:k,trackInfo:w})),e.sender=yield this.engine.createSender(e,n,k),k)if(El()&&e.kind===Y.Kind.Audio){let T;for(const _ of this.engine.pcManager.publisher.getTransceivers())if(_.sender===e.sender){T=_;break}T&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:T,codec:"opus",maxbr:!((m=k[0])===null||m===void 0)&&m.maxBitrate?k[0].maxBitrate/1e3:0})}else e.codec&&Ju(e.codec)&&(!((C=k[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:S.cid,codec:e.codec,maxbr:k[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof Jr?e.startMonitor(this.engine.client):e instanceof pr&&e.startMonitor(),this.addTrackPublication(x),this.emit(se.LocalTrackPublished,x),x})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return G(this,void 0,void 0,function*(){if(this.encryptionType!==Tn.NONE)return;let o;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(o=d)}),!o)throw new Ki("track is not published");if(!(e instanceof Jr))throw new Ki("track is not a video track");const s=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=Ij(e,n,s);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Tt(e)));return}const c=e.addSimulcastTrack(n,a),l=new Ti({cid:c.mediaStreamTrack.id,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:s.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=SA(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new an("cannot publish track when not connected");const u=yield this.engine.addTrack(l);yield this.engine.createSimulcastSender(e,c,s,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(e,n){var r,i;return G(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(e),s=o?Tt(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),s)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),s));return}e=o.track,e.off(ge.Muted,this.onTrackMuted),e.off(ge.Unmuted,this.onTrackUnmuted),e.off(ge.Ended,this.handleTrackEnded),e.off(ge.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ge.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let a=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<ln.FAILED&&c)try{for(const l of this.engine.pcManager.publisher.getTransceivers())l.sender===c&&(l.direction="inactive",a=!0);if(this.engine.removeTrack(c)&&(a=!0),e instanceof Jr){for(const[,l]of e.simulcastCodecs)l.sender&&(this.engine.removeTrack(l.sender)&&(a=!0),l.sender=void 0);e.simulcastCodecs.clear()}}catch(l){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),s),{error:l}))}switch(this.tracks.delete(o.trackSid),o.kind){case Y.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case Y.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(se.LocalTrackUnpublished,o),o.setTrack(void 0),a&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return G(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Od)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return G(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>G(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),n&&!o.isMuted&&o.source!==Y.Source.ScreenShare&&o.source!==Y.Source.ScreenShareAudio&&(o instanceof pr||o instanceof Jr)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return G(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],s=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(c=>{c instanceof Md?o.push(c.sid):o.push(c)});const a=new Qi({kind:n,value:{case:"user",value:new eo({participantSid:this.sid,payload:e,destinationSids:o,topic:s})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const o=this.tracks.get(n.sid);if(o){const s=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);s!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Tt(o)),{mutedOnServer:s})),this.engine.client.sendMuteTrack(n.sid,s))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof pr||i instanceof Jr)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var it;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(it||(it={}));const Tj=2*1e3;class kp extends Eo.EventEmitter{constructor(e){var n,r,i;super(),n=this,this.state=it.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Ke,this.bufferedEvents=[],this.connect=(o,s,a)=>G(this,void 0,void 0,function*(){var c;const l=yield this.disconnectLock.lock();if(this.state===it.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),l(),Promise.resolve();if(this.connectFuture)return l(),this.connectFuture.promise;this.setAndEmitConnectionState(it.Connecting),((c=this.regionUrlProvider)===null||c===void 0?void 0:c.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),W0(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new vA(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(h=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:h}))}));const u=(h,f,p)=>G(this,void 0,void 0,function*(){var m;this.abortController&&this.abortController.abort();const C=new AbortController;this.abortController=C,l==null||l();try{yield this.attemptConnection(p??o,s,a,C),this.abortController=void 0,h()}catch(g){if(this.regionUrlProvider&&g instanceof It&&g.reason!==3&&g.reason!==0){let v=null;try{v=yield this.regionUrlProvider.getNextBestRegionUrl((m=this.abortController)===null||m===void 0?void 0:m.signal)}catch(S){if(S instanceof It&&(S.status===401||S.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(S);return}}v?(this.log.info("Initial connection failed with ConnectionError: ".concat(g.message,". Retrying with another region: ").concat(v),this.logContext),yield u(h,f,v)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(g))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(g)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new wP((h,f)=>{u(h,f,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,a,c,l,u)=>G(this,void 0,void 0,function*(){var d,h,f;const p=yield a.join(o,s,{autoSubscribe:c.autoSubscribe,publishOnly:c.publishOnly,adaptiveStream:typeof l.adaptiveStream=="object"?!0:l.adaptiveStream,maxRetries:c.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:c.websocketTimeout},u.signal);let m=p.serverInfo;if(m||(m={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(m).map(C=>{let[g,v]=C;return"".concat(g,": ").concat(v)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(h=p.room)===null||h===void 0?void 0:h.sid,identity:(f=p.participant)===null||f===void 0?void 0:f.identity}),!p.serverVersion)throw new C9("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),l.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,s,a,c)=>G(this,void 0,void 0,function*(){var l,u;this.state===it.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((l=this.regionUrlProvider)===null||l===void 0)&&l.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},nI),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,c);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const h=new It("could not establish signal connection");throw d instanceof Error&&(h.message="".concat(h.message,": ").concat(d.message)),d instanceof It&&(h.reason=d.reason,h.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),h}if(c.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new It("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,c)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}wr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),wr()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(it.Connected),this.emit(ne.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return G(n,void 0,void 0,function*(){var s,a,c,l;const u=yield this.disconnectLock.lock();try{if(this.state===it.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===it.Connecting||this.state===it.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(s=this.abortController)===null||s===void 0||s.abort(),(c=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||c===void 0||c.call(a,new It("Client initiated disconnect")),this.connectFuture=void 0),!((l=this.engine)===null||l===void 0)&&l.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,us.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>G(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>G(this,void 0,void 0,function*(){const o=[],s=Is();if(s&&s.os==="iOS"){const a="livekit-dummy-audio-el";let c=document.getElementById(a);if(!c){c=document.createElement("audio"),c.id=a,c.autoplay=!0,c.hidden=!0;const l=Em();l.enabled=!0;const u=new MediaStream([l]);c.srcObject=u,document.addEventListener("visibilitychange",()=>{c&&(c.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(c),this.once(ne.Disconnected,()=>{c==null||c.remove(),c=null})}o.push(c)}this.participants.forEach(a=>{a.audioTracks.forEach(c=>{c.track&&c.track.attachedElements.forEach(l=>{o.push(l)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>G(this,void 0,void 0,function*(){const o=[];for(const s of this.participants.values())s.videoTracks.forEach(a=>{var c;(c=a.track)===null||c===void 0||c.attachedElements.forEach(l=>{o.includes(l)||o.push(l)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(it.Reconnecting)&&this.emit(ne.Reconnecting)},this.handleSignalRestarted=o=>G(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(it.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const a=this.identityToSid.get(s.identity);a&&a!==s.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let c=this.participants.get(s.sid);const l=!c;s.state===cc.DISCONNECTED?this.handleParticipantDisconnected(s.sid,c):(c=this.getOrCreateParticipant(s.sid,s),l||c.updateInfo(s))})},this.handleActiveSpeakersUpdate=o=>{const s=[],a={};o.forEach(c=>{if(a[c.sid]=!0,c.sid===this.localParticipant.sid)this.localParticipant.audioLevel=c.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const l=this.participants.get(c.sid);l&&(l.audioLevel=c.level,l.setIsSpeaking(!0),s.push(l))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(c=>{a[c.sid]||(c.audioLevel=0,c.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ne.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(c=>{s.set(c.sid,c)}),o.forEach(c=>{let l=this.participants.get(c.sid);c.sid===this.localParticipant.sid&&(l=this.localParticipant),l&&(l.audioLevel=c.level,l.setIsSpeaking(c.active),c.active?s.set(c.sid,l):s.delete(c.sid))});const a=Array.from(s.values());a.sort((c,l)=>l.audioLevel-c.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(ne.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const a=this.participants.get(s.participantSid);if(!a)return;const c=a.getTrackPublication(s.trackSid);!c||!c.track||(c.track.streamState=Y.streamStateFromProto(s.state),a.emit(se.TrackStreamStateChanged,c,c.track.streamState),this.emitWhenConnected(ne.TrackStreamStateChanged,c,c.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.participants.get(o.participantSid);if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.participants.values()).find(c=>c.tracks.has(o.trackSid));if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const a=this.participants.get(o.participantSid);this.emit(ne.DataReceived,o.payload,a,s,o.topic),a==null||a.emit(se.DataReceived,o.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ne.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ne.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ne.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ne.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>G(this,void 0,void 0,function*(){this.emit(ne.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(ne.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(ne.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const a=this.participants.get(s.participantSid);a&&a.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(ne.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(ne.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(ne.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(ne.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>G(this,void 0,void 0,function*(){var s;this.emit(ne.LocalTrackPublished,o,this.localParticipant),o.track instanceof pr&&(yield o.track.checkForSilence())&&this.emit(ne.LocalAudioSilenceDetected,o);const a=yield(s=o.track)===null||s===void 0?void 0:s.getDeviceId(),c=P9(o.source);c&&a&&a!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,a),this.emit(ne.ActiveDeviceChanged,c,a))}),this.onLocalTrackUnpublished=o=>{this.emit(ne.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(ne.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(ne.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(ne.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},lj),e),this.log=Cs((r=this.options.loggerName)!==null&&r!==void 0?r:Co.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},TP),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},RP),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},cj),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Mi,this.localParticipant=new z0("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Ya(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Ya(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",Ya(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return G(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new $9(this.options.e2ee),this.e2eeManager.on(ta.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof z0&&(this.isE2EEEnabled=n),this.emit(ne.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(ta.EncryptionError,n=>this.emit(ne.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new hj(this.options),this.engine.on(Ee.ParticipantUpdate,this.handleParticipantUpdates).on(Ee.RoomUpdate,this.handleRoomUpdate).on(Ee.SpeakersChanged,this.handleSpeakersChanged).on(Ee.StreamStateChanged,this.handleStreamStateUpdate).on(Ee.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Ee.SubscriptionError,this.handleSubscriptionError).on(Ee.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Ee.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(Ee.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Ee.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Ee.DataPacketReceived,this.handleDataPacket).on(Ee.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(it.Reconnecting)&&this.emit(ne.Reconnecting)}).on(Ee.Resumed,()=>{this.setAndEmitConnectionState(it.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(Ee.SignalResumed,()=>{this.bufferedEvents=[],this.state===it.Reconnecting&&this.sendSyncState()}).on(Ee.Restarting,this.handleRestarting).on(Ee.SignalRestarted,this.handleSignalRestarted).on(Ee.DCBufferStatusChanged,(e,n)=>{this.emit(ne.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Qn.getInstance().getDevices(e,n)}prepareConnection(e,n){return G(this,void 0,void 0,function*(){if(this.state===it.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(W0(new URL(e))&&n){this.regionUrlProvider=new vA(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===it.Disconnected&&(this.regionUrl=r,yield fetch(aA(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(aA(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return G(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new En({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new En({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new En({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new En({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>G(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new En({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>G(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new En({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new En({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>G(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new ni({reason:us.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new En({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,s;return G(this,void 0,void 0,function*(){let a=!1,c=!0;const l=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.audioTracks.values()).filter(h=>h.source===Y.Source.Microphone);try{c=(yield Promise.all(d.map(h=>{var f;return(f=h.audioTrack)===null||f===void 0?void 0:f.setDeviceId(l)}))).every(h=>h===!0)}catch(h){throw this.options.audioCaptureDefaults.deviceId=u,h}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.videoTracks.values()).filter(h=>h.source===Y.Source.Camera);try{c=(yield Promise.all(d.map(h=>{var f;return(f=h.videoTrack)===null||f===void 0?void 0:f.setDeviceId(l)}))).every(h=>h===!0)}catch(h){throw this.options.videoCaptureDefaults.deviceId=u,h}}else if(e==="audiooutput"){if(!G0()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(s=this.options).audioOutput)!==null&&i!==void 0||(s.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==l;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&c&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ne.ActiveDeviceChanged,e,n)),c})}setupLocalParticipantEvents(){this.localParticipant.on(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(se.TrackMuted,this.onLocalTrackMuted).on(se.TrackUnmuted,this.onLocalTrackUnmuted).on(se.LocalTrackPublished,this.onLocalTrackPublished).on(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(se.MediaDevicesError,this.onMediaDevicesError).on(se.AudioStreamAcquired,this.startAudio).on(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===it.Connecting||this.state===it.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ne.Reconnected,u),this.off(ne.Connected,u),this.off(ne.Disconnected,d)};this.once(ne.Reconnected,u),this.once(ne.Connected,u),this.once(ne.Disconnected,d);return}if(this.state===it.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=M9(n.id),o=i[0];let s=i[1],a=e.id;if(s&&s.startsWith("TR")&&(a=s),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=this.participants.get(o);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,a,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==it.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((o=i.track)===null||o===void 0||o.detach(),(s=i.track)===null||s===void 0||s.stop())}),this.localParticipant.off(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(se.TrackMuted,this.onLocalTrackMuted).off(se.TrackUnmuted,this.onLocalTrackUnmuted).off(se.LocalTrackPublished,this.onLocalTrackPublished).off(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(se.MediaDevicesError,this.onMediaDevicesError).off(se.AudioStreamAcquired,this.startAudio).off(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),wr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(it.Disconnected),this.emit(ne.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ne.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return G(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=qC())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ne.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=Md.fromParticipantInfo(this.engine.client,n):i=new Md(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ne.ParticipantConnected,r),r.on(se.TrackPublished,i=>{this.emitWhenConnected(ne.TrackPublished,i,r)}).on(se.TrackSubscribed,(i,o)=>{i.kind===Y.Kind.Audio?(i.on(ge.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(ge.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Y.Kind.Video&&(i.on(ge.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(ge.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ne.TrackSubscribed,i,o,r)}).on(se.TrackUnpublished,i=>{this.emit(ne.TrackUnpublished,i,r)}).on(se.TrackUnsubscribed,(i,o)=>{this.emit(ne.TrackUnsubscribed,i,o,r)}).on(se.TrackSubscriptionFailed,i=>{this.emit(ne.TrackSubscriptionFailed,i,r)}).on(se.TrackMuted,i=>{this.emitWhenConnected(ne.TrackMuted,i,r)}).on(se.TrackUnmuted,i=>{this.emitWhenConnected(ne.TrackUnmuted,i,r)}).on(se.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ne.ParticipantMetadataChanged,i,r)}).on(se.ParticipantNameChanged,i=>{this.emitWhenConnected(ne.ParticipantNameChanged,i,r)}).on(se.ConnectionQualityChanged,i=>{this.emitWhenConnected(ne.ConnectionQualityChanged,i,r)}).on(se.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ne.ParticipantPermissionsChanged,i,r)}).on(se.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ne.TrackSubscriptionStatusChanged,i,o,r)}).on(se.TrackSubscriptionFailed,(i,o)=>{this.emit(ne.TrackSubscriptionFailed,i,r,o)}).on(se.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ne.TrackSubscriptionPermissionChanged,i,o,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof iI&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=xn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,us.STATE_MISMATCH))):e=0},Tj)}clearConnectionReconcile(){this.connectionReconcileInterval&&xn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ne.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===it.Connected?this.emit(e,...r):(this.state===it.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var n,r;return G(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new jl({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ue.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Gr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected),this.emit(ne.Connected),this.setAndEmitConnectionState(it.Connected),i.video){const s=new Od(Y.Kind.Video,new Cr({source:Ht.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO,name:"video-dummy"}),new Jr(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:sA(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(se.LocalTrackPublished,s)}if(i.audio){const s=new Od(Y.Kind.Audio,new Cr({source:Ht.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO}),new pr(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Em(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(se.LocalTrackPublished,s)}for(let s=0;s<o.count-1;s+=1){let a=new Gr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(s),state:cc.ACTIVE,tracks:[],joinedAt:Ue.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(o.video){const l=sA(160*((r=o.aspectRatios[s%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new Cr({source:Ht.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}if(o.audio){const l=Em(),u=new Cr({source:Ht.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==ne.ActiveSpeakersChanged){const o=MP(r).filter(s=>s!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}function MP(t){return t.map(e=>{if(e)return Array.isArray(e)?MP(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var wi;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(wi||(wi={}));class Hl extends Eo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=wi.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new kp(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return G(this,void 0,void 0,function*(){if(this.status!==wi.IDLE)throw Error("check is running already");this.setStatus(wi.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==wi.SKIPPED&&this.setStatus(this.isSuccess()?wi.SUCCESS:wi.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return G(this,void 0,void 0,function*(){return this.room.state===it.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return G(this,void 0,void 0,function*(){this.room&&this.room.state!==it.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(wi.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function DP(t){var e,n;return G(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=yP(t,TP,RP),i=lg(r),o=navigator.mediaDevices.getUserMedia(i);t.audio&&(Qn.userMediaPromiseMap.set("audioinput",o),o.catch(()=>Qn.userMediaPromiseMap.delete("audioinput"))),t.video&&(Qn.userMediaPromiseMap.set("videoinput",o),o.catch(()=>Qn.userMediaPromiseMap.delete("videoinput")));const s=yield o;return s.getTracks().map(a=>{const c=a.kind==="audio";c?t.audio:t.video;let l;const u=c?i.audio:i.video;typeof u!="boolean"&&(l=u),l?l.deviceId=a.getSettings().deviceId:l={deviceId:a.getSettings().deviceId};const d=xP(a,l);return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=s,d})})}function Rj(t){return G(this,void 0,void 0,function*(){return(yield DP({audio:!1,video:t}))[0]})}function xj(t){return G(this,void 0,void 0,function*(){return(yield DP({audio:t,video:!1}))[0]})}class Pj extends Hl{get description(){return"Can publish audio"}perform(){var e;return G(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield xj();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="audio"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class Nj extends Hl{get description(){return"Can publish video"}perform(){var e;return G(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield Rj();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="video"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class _j extends Hl{get description(){return"Resuming connection after interruption"}perform(){var e;return G(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,o;const s=new Promise(c=>{setTimeout(c,5e3),o=c});n.on(ne.Reconnecting,()=>{r=!0}).on(ne.Reconnected,()=>{i=!0,o(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield s,r){if(!i||n.state!==it.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Oj extends Hl{get description(){return"Can connect via TURN"}perform(){var e,n;return G(this,void 0,void 0,function*(){const r=new tI,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,s=!1,a=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(s=!0,a=!0):l.startsWith("turns:")&&(s=!0,a=!0,o=!0),l.startsWith("stun:")&&(a=!0);a?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class Mj extends Hl{get description(){return"Establishing WebRTC connection"}perform(){return G(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ne.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const s=new RTCIceCandidate(i);let a="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&(Dj(s.address)?a+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(e=!0,a+=" (passive)"):s.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),Ke.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Dj(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class Lj extends Hl{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return G(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new tI;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===Al.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class Rz extends Eo.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:wi.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==wi.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return G(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=s=>{this.updateCheck(n,s)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Lj)})}checkWebRTC(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Mj)})}checkTURN(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Oj)})}checkReconnect(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(_j)})}checkPublishAudio(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Pj)})}checkPublishVideo(){return G(this,void 0,void 0,function*(){return this.createAndRunCheck(Nj)})}}function Fj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof Tl?t.mediaStreamTrack:t,i=r.getSettings();let o={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const s=i.facingMode;Ke.debug("rawFacingMode",{rawFacingMode:s}),s&&typeof s=="string"&&Vj(s)&&(o={facingMode:s,confidence:"high"})}if(["low","medium"].includes(o.confidence)){Ke.debug("Try to get facing mode from device label: (".concat(r.label,")"));const s=Uj(r.label);s!==void 0&&(o=s)}return o}const wA=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),Bj=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function Uj(t){var e;const n=t.trim().toLowerCase();if(n!=="")return wA.has(n)?wA.get(n):(e=Array.from(Bj.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function Vj(t){return t===void 0||["user","environment","left","right"].includes(t)}const X0=Math.min,sl=Math.max,Ep=Math.round,ma=t=>({x:t,y:t}),Gj={left:"right",right:"left",bottom:"top",top:"bottom"},Wj={start:"end",end:"start"};function AA(t,e,n){return sl(t,X0(e,n))}function dg(t,e){return typeof t=="function"?t(e):t}function hc(t){return t.split("-")[0]}function hg(t){return t.split("-")[1]}function LP(t){return t==="x"?"y":"x"}function FP(t){return t==="y"?"height":"width"}function Rl(t){return["top","bottom"].includes(hc(t))?"y":"x"}function BP(t){return LP(Rl(t))}function jj(t,e,n){n===void 0&&(n=!1);const r=hg(t),i=BP(t),o=FP(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=Tp(s)),[s,Tp(s)]}function Zj(t){const e=Tp(t);return[$0(t),e,$0(e)]}function $0(t){return t.replace(/start|end/g,e=>Wj[e])}function Hj(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function zj(t,e,n,r){const i=hg(t);let o=Hj(hc(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map($0)))),o}function Tp(t){return t.replace(/left|right|bottom|top/g,e=>Gj[e])}function Xj(t){return{top:0,right:0,bottom:0,left:0,...t}}function $j(t){return typeof t!="number"?Xj(t):{top:t,right:t,bottom:t,left:t}}function Rp(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function kA(t,e,n){let{reference:r,floating:i}=t;const o=Rl(e),s=BP(e),a=FP(s),c=hc(e),l=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let f;switch(c){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-i.width,y:d};break;default:f={x:r.x,y:r.y}}switch(hg(e)){case"start":f[s]-=h*(n&&l?-1:1);break;case"end":f[s]+=h*(n&&l?-1:1);break}return f}const Kj=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(e));let l=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=kA(l,r,c),h=r,f={},p=0;for(let m=0;m<a.length;m++){const{name:C,fn:g}=a[m],{x:v,y:S,data:k,reset:w}=await g({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:l,platform:s,elements:{reference:t,floating:e}});u=v??u,d=S??d,f={...f,[C]:{...f[C],...k}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(h=w.placement),w.rects&&(l=w.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):w.rects),{x:u,y:d}=kA(l,h,c)),m=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:f}};async function UP(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=dg(e,t),p=$j(f),C=a[h?d==="floating"?"reference":"floating":d],g=Rp(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),k=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},w=Rp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:S,strategy:c}):v);return{top:(g.top-w.top+p.top)/k.y,bottom:(w.bottom-g.bottom+p.bottom)/k.y,left:(g.left-w.left+p.left)/k.x,right:(w.right-g.right+p.right)/k.x}}const Jj=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...C}=dg(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const g=hc(i),v=Rl(a),S=hc(a)===a,k=await(c.isRTL==null?void 0:c.isRTL(l.floating)),w=h||(S||!m?[Tp(a)]:Zj(a)),A=p!=="none";!h&&A&&w.push(...zj(a,m,p,k));const x=[a,...w],T=await UP(e,C),_=[];let O=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&_.push(T[g]),d){const Z=jj(i,s,k);_.push(T[Z[0]],T[Z[1]])}if(O=[...O,{placement:i,overflows:_}],!_.every(Z=>Z<=0)){var L,U;const Z=(((L=o.flip)==null?void 0:L.index)||0)+1,J=x[Z];if(J)return{data:{index:Z,overflows:O},reset:{placement:J}};let ee=(U=O.filter(re=>re.overflows[0]<=0).sort((re,X)=>re.overflows[1]-X.overflows[1])[0])==null?void 0:U.placement;if(!ee)switch(f){case"bestFit":{var z;const re=(z=O.filter(X=>{if(A){const $=Rl(X.placement);return $===v||$==="y"}return!0}).map(X=>[X.placement,X.overflows.filter($=>$>0).reduce(($,ie)=>$+ie,0)]).sort((X,$)=>X[1]-$[1])[0])==null?void 0:z[0];re&&(ee=re);break}case"initialPlacement":ee=a;break}if(i!==ee)return{reset:{placement:ee}}}return{}}}};async function Yj(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=hc(n),a=hg(n),c=Rl(n)==="y",l=["left","top"].includes(s)?-1:1,u=o&&c?-1:1,d=dg(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),c?{x:f*u,y:h*l}:{x:h*l,y:f*u}}const Qj=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,c=await Yj(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:o+c.y,data:{...c,placement:s}}}}},qj=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:C=>{let{x:g,y:v}=C;return{x:g,y:v}}},...c}=dg(t,e),l={x:n,y:r},u=await UP(e,c),d=Rl(hc(i)),h=LP(d);let f=l[h],p=l[d];if(o){const C=h==="y"?"top":"left",g=h==="y"?"bottom":"right",v=f+u[C],S=f-u[g];f=AA(v,f,S)}if(s){const C=d==="y"?"top":"left",g=d==="y"?"bottom":"right",v=p+u[C],S=p-u[g];p=AA(v,p,S)}const m=a.fn({...e,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[h]:o,[d]:s}}}}}};function fg(){return typeof window<"u"}function zl(t){return VP(t)?(t.nodeName||"").toLowerCase():"#document"}function jr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function As(t){var e;return(e=(VP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function VP(t){return fg()?t instanceof Node||t instanceof jr(t).Node:!1}function Bi(t){return fg()?t instanceof Element||t instanceof jr(t).Element:!1}function Io(t){return fg()?t instanceof HTMLElement||t instanceof jr(t).HTMLElement:!1}function EA(t){return!fg()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof jr(t).ShadowRoot}function th(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Ui(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function e6(t){return["table","td","th"].includes(zl(t))}function pg(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function oI(t){const e=sI(),n=Bi(t)?Ui(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function t6(t){let e=va(t);for(;Io(e)&&!xl(e);){if(oI(e))return e;if(pg(e))return null;e=va(e)}return null}function sI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function xl(t){return["html","body","#document"].includes(zl(t))}function Ui(t){return jr(t).getComputedStyle(t)}function gg(t){return Bi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function va(t){if(zl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||EA(t)&&t.host||As(t);return EA(e)?e.host:e}function GP(t){const e=va(t);return xl(e)?t.ownerDocument?t.ownerDocument.body:t.body:Io(e)&&th(e)?e:GP(e)}function K0(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=GP(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=jr(i);if(o){const a=J0(s);return e.concat(s,s.visualViewport||[],th(i)?i:[],a&&n?K0(a):[])}return e.concat(i,K0(i,[],n))}function J0(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function WP(t){const e=Ui(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Io(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=Ep(n)!==o||Ep(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function jP(t){return Bi(t)?t:t.contextElement}function al(t){const e=jP(t);if(!Io(e))return ma(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=WP(e);let s=(o?Ep(n.width):n.width)/r,a=(o?Ep(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const n6=ma(0);function ZP(t){const e=jr(t);return!sI()||!e.visualViewport?n6:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function r6(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==jr(t)?!1:e}function Dd(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=jP(t);let s=ma(1);e&&(r?Bi(r)&&(s=al(r)):s=al(t));const a=r6(o,n,r)?ZP(o):ma(0);let c=(i.left+a.x)/s.x,l=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const h=jr(o),f=r&&Bi(r)?jr(r):r;let p=h,m=J0(p);for(;m&&r&&f!==p;){const C=al(m),g=m.getBoundingClientRect(),v=Ui(m),S=g.left+(m.clientLeft+parseFloat(v.paddingLeft))*C.x,k=g.top+(m.clientTop+parseFloat(v.paddingTop))*C.y;c*=C.x,l*=C.y,u*=C.x,d*=C.y,c+=S,l+=k,p=jr(m),m=J0(p)}}return Rp({width:u,height:d,x:c,y:l})}function i6(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=As(r),a=e?pg(e.floating):!1;if(r===s||a&&o)return n;let c={scrollLeft:0,scrollTop:0},l=ma(1);const u=ma(0),d=Io(r);if((d||!d&&!o)&&((zl(r)!=="body"||th(s))&&(c=gg(r)),Io(r))){const h=Dd(r);l=al(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function o6(t){return Array.from(t.getClientRects())}function Y0(t,e){const n=gg(t).scrollLeft;return e?e.left+n:Dd(As(t)).left+n}function s6(t){const e=As(t),n=gg(t),r=t.ownerDocument.body,i=sl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=sl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Y0(t);const a=-n.scrollTop;return Ui(r).direction==="rtl"&&(s+=sl(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function a6(t,e){const n=jr(t),r=As(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,c=0;if(i){o=i.width,s=i.height;const l=sI();(!l||l&&e==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:o,height:s,x:a,y:c}}function c6(t,e){const n=Dd(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Io(t)?al(t):ma(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,c=i*o.x,l=r*o.y;return{width:s,height:a,x:c,y:l}}function TA(t,e,n){let r;if(e==="viewport")r=a6(t,n);else if(e==="document")r=s6(As(t));else if(Bi(e))r=c6(e,n);else{const i=ZP(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Rp(r)}function HP(t,e){const n=va(t);return n===e||!Bi(n)||xl(n)?!1:Ui(n).position==="fixed"||HP(n,e)}function l6(t,e){const n=e.get(t);if(n)return n;let r=K0(t,[],!1).filter(a=>Bi(a)&&zl(a)!=="body"),i=null;const o=Ui(t).position==="fixed";let s=o?va(t):t;for(;Bi(s)&&!xl(s);){const a=Ui(s),c=oI(s);!c&&a.position==="fixed"&&(i=null),(o?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||th(s)&&!c&&HP(t,s))?r=r.filter(u=>u!==s):i=a,s=va(s)}return e.set(t,r),r}function u6(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?pg(e)?[]:l6(e,this._c):[].concat(n),r],a=s[0],c=s.reduce((l,u)=>{const d=TA(e,u,i);return l.top=sl(d.top,l.top),l.right=X0(d.right,l.right),l.bottom=X0(d.bottom,l.bottom),l.left=sl(d.left,l.left),l},TA(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function d6(t){const{width:e,height:n}=WP(t);return{width:e,height:n}}function h6(t,e,n){const r=Io(e),i=As(e),o=n==="fixed",s=Dd(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const c=ma(0);if(r||!r&&!o)if((zl(e)!=="body"||th(i))&&(a=gg(e)),r){const f=Dd(e,!0,o,e);c.x=f.x+e.clientLeft,c.y=f.y+e.clientTop}else i&&(c.x=Y0(i));let l=0,u=0;if(i&&!r&&!o){const f=i.getBoundingClientRect();u=f.top+a.scrollTop,l=f.left+a.scrollLeft-Y0(i,f)}const d=s.left+a.scrollLeft-c.x-l,h=s.top+a.scrollTop-c.y-u;return{x:d,y:h,width:s.width,height:s.height}}function Nm(t){return Ui(t).position==="static"}function RA(t,e){if(!Io(t)||Ui(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return As(t)===n&&(n=n.ownerDocument.body),n}function zP(t,e){const n=jr(t);if(pg(t))return n;if(!Io(t)){let i=va(t);for(;i&&!xl(i);){if(Bi(i)&&!Nm(i))return i;i=va(i)}return n}let r=RA(t,e);for(;r&&e6(r)&&Nm(r);)r=RA(r,e);return r&&xl(r)&&Nm(r)&&!oI(r)?n:r||t6(t)||n}const f6=async function(t){const e=this.getOffsetParent||zP,n=this.getDimensions,r=await n(t.floating);return{reference:h6(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function p6(t){return Ui(t).direction==="rtl"}const g6={convertOffsetParentRelativeRectToViewportRelativeRect:i6,getDocumentElement:As,getClippingRect:u6,getOffsetParent:zP,getElementRects:f6,getClientRects:o6,getDimensions:d6,getScale:al,isElement:Bi,isRTL:p6},m6=Qj,v6=qj,y6=Jj,C6=(t,e,n)=>{const r=new Map,i={platform:g6,...n},o={...i.platform,_c:r};return Kj(t,e,{...i,platform:o})};var XP={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(ZN,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},s=null;function a(m,C){var g=m[C];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?c:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function u(){for(var m=this.getLevel(),C=0;C<i.length;C++){var g=i[C];this[g]=C<m?e:this.methodFactory(g,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(u.call(this),this[m].apply(this,arguments))}}function h(m,C,g){return l(m)||d.apply(this,arguments)}function f(m,C){var g=this,v,S,k,w="loglevel";typeof m=="string"?w+=":"+m:typeof m=="symbol"&&(w=void 0);function A(L){var U=(i[L]||"silent").toUpperCase();if(!(typeof window===n||!w)){try{window.localStorage[w]=U;return}catch{}try{window.document.cookie=encodeURIComponent(w)+"="+U+";"}catch{}}}function x(){var L;if(!(typeof window===n||!w)){try{L=window.localStorage[w]}catch{}if(typeof L===n)try{var U=window.document.cookie,z=encodeURIComponent(w),Z=U.indexOf(z+"=");Z!==-1&&(L=/^([^;]+)/.exec(U.slice(Z+z.length+1))[1])}catch{}return g.levels[L]===void 0&&(L=void 0),L}}function T(){if(!(typeof window===n||!w)){try{window.localStorage.removeItem(w)}catch{}try{window.document.cookie=encodeURIComponent(w)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function _(L){var U=L;if(typeof U=="string"&&g.levels[U.toUpperCase()]!==void 0&&(U=g.levels[U.toUpperCase()]),typeof U=="number"&&U>=0&&U<=g.levels.SILENT)return U;throw new TypeError("log.setLevel() called with invalid level: "+L)}g.name=m,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=C||h,g.getLevel=function(){return k??S??v},g.setLevel=function(L,U){return k=_(L),U!==!1&&A(k),u.call(g)},g.setDefaultLevel=function(L){S=_(L),x()||g.setLevel(L,!1)},g.resetLevel=function(){k=null,T(),u.call(g)},g.enableAll=function(L){g.setLevel(g.levels.TRACE,L)},g.disableAll=function(L){g.setLevel(g.levels.SILENT,L)},g.rebuild=function(){if(s!==g&&(v=_(s.getLevel())),u.call(g),s===g)for(var L in o)o[L].rebuild()},v=_(s?s.getLevel():"WARN");var O=x();O!=null&&(k=_(O)),u.call(g)}s=new f,s.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var g=o[C];return g||(g=o[C]=new f(C,s.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return s.noConflict=function(){return typeof window!==n&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return o},s.default=s,s})})(XP);var I6=XP.exports;const S6=Ud(I6);function fn(t){return typeof t=="function"}function $P(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var _m=$P(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Q0(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var mg=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=bl(s),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(m){e={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var u=this.initialTeardown;if(fn(u))try{u()}catch(m){o=m instanceof _m?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=bl(d),f=h.next();!f.done;f=h.next()){var p=f.value;try{xA(p)}catch(m){o=o??[],m instanceof _m?o=y0(y0([],v0(o)),v0(m.errors)):o.push(m)}}}catch(m){r={error:m}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(o)throw new _m(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)xA(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&Q0(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&Q0(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),KP=mg.EMPTY;function JP(t){return t instanceof mg||t&&"closed"in t&&fn(t.remove)&&fn(t.add)&&fn(t.unsubscribe)}function xA(t){fn(t)?t():t.unsubscribe()}var YP={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},QP={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,y0([t,e],v0(n)))},clearTimeout:function(t){var e=QP.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function qP(t){QP.setTimeout(function(){throw t})}function q0(){}function kf(t){t()}var aI=function(t){Wl(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,JP(n)&&n.add(r)):r.destination=k6,r}return e.create=function(n,r,i){return new ey(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(mg),b6=Function.prototype.bind;function Om(t,e){return b6.call(t,e)}var w6=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Lh(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Lh(r)}else Lh(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Lh(n)}},t}(),ey=function(t){Wl(e,t);function e(n,r,i){var o=t.call(this)||this,s;if(fn(n)||!n)s={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;o&&YP.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return o.unsubscribe()},s={next:n.next&&Om(n.next,a),error:n.error&&Om(n.error,a),complete:n.complete&&Om(n.complete,a)}):s=n}return o.destination=new w6(s),o}return e}(aI);function Lh(t){qP(t)}function A6(t){throw t}var k6={closed:!0,next:q0,error:A6,complete:q0},cI=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function eN(t){return t}function E6(t){return t.length===0?eN:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Dn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=R6(e)?e:new ey(e,n,r);return kf(function(){var s=i,a=s.operator,c=s.source;o.add(a?a.call(o,c):c?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=PA(n),new n(function(i,o){var s=new ey({next:function(a){try{e(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[cI]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return E6(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=PA(e),new e(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function PA(t){var e;return(e=t??YP.Promise)!==null&&e!==void 0?e:Promise}function T6(t){return t&&fn(t.next)&&fn(t.error)&&fn(t.complete)}function R6(t){return t&&t instanceof aI||T6(t)&&JP(t)}function x6(t){return fn(t==null?void 0:t.lift)}function ks(t){return function(e){if(x6(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function fc(t,e,n,r,i){return new P6(t,e,n,r,i)}var P6=function(t){Wl(e,t);function e(n,r,i,o,s,a){var c=t.call(this,n)||this;return c.onFinalize=s,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){n.error(u)}}:t.prototype._next,c._error=o?function(l){try{o(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(aI),N6=$P(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ya=function(t){Wl(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new NA(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new N6},e.prototype.next=function(n){var r=this;kf(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=bl(r.currentObservers),a=s.next();!a.done;a=s.next()){var c=a.value;c.next(n)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;kf(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;kf(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?KP:(this.currentObservers=null,a.push(n),new mg(function(){r.currentObservers=null,Q0(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},e.prototype.asObservable=function(){var n=new Dn;return n.source=this,n},e.create=function(n,r){return new NA(n,r)},e}(Dn),NA=function(t){Wl(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:KP},e}(ya),tN=function(t){Wl(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(ya);function _6(t){return t&&fn(t.schedule)}function O6(t){return t[t.length-1]}function nN(t){return _6(O6(t))?t.pop():void 0}var rN=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function iN(t){return fn(t==null?void 0:t.then)}function oN(t){return fn(t[cI])}function sN(t){return Symbol.asyncIterator&&fn(t==null?void 0:t[Symbol.asyncIterator])}function aN(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function M6(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var cN=M6();function lN(t){return fn(t==null?void 0:t[cN])}function uN(t){return LV(this,arguments,function(){var n,r,i,o;return FR(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,qc(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,qc(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,qc(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function dN(t){return fn(t==null?void 0:t.getReader)}function Xl(t){if(t instanceof Dn)return t;if(t!=null){if(oN(t))return D6(t);if(rN(t))return L6(t);if(iN(t))return F6(t);if(sN(t))return hN(t);if(lN(t))return B6(t);if(dN(t))return U6(t)}throw aN(t)}function D6(t){return new Dn(function(e){var n=t[cI]();if(fn(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function L6(t){return new Dn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function F6(t){return new Dn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,qP)})}function B6(t){return new Dn(function(e){var n,r;try{for(var i=bl(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function hN(t){return new Dn(function(e){V6(t,e).catch(function(n){return e.error(n)})})}function U6(t){return hN(uN(t))}function V6(t,e){var n,r,i,o;return DV(this,void 0,void 0,function(){var s,a;return FR(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=FV(t),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function qa(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function fN(t,e){return e===void 0&&(e=0),ks(function(n,r){n.subscribe(fc(r,function(i){return qa(r,t,function(){return r.next(i)},e)},function(){return qa(r,t,function(){return r.complete()},e)},function(i){return qa(r,t,function(){return r.error(i)},e)}))})}function pN(t,e){return e===void 0&&(e=0),ks(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function G6(t,e){return Xl(t).pipe(pN(e),fN(e))}function W6(t,e){return Xl(t).pipe(pN(e),fN(e))}function j6(t,e){return new Dn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Z6(t,e){return new Dn(function(n){var r;return qa(n,e,function(){r=t[cN](),qa(n,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return fn(r==null?void 0:r.return)&&r.return()}})}function gN(t,e){if(!t)throw new Error("Iterable cannot be null");return new Dn(function(n){qa(n,e,function(){var r=t[Symbol.asyncIterator]();qa(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function H6(t,e){return gN(uN(t),e)}function z6(t,e){if(t!=null){if(oN(t))return G6(t,e);if(rN(t))return j6(t,e);if(iN(t))return W6(t,e);if(sN(t))return gN(t,e);if(lN(t))return Z6(t,e);if(dN(t))return H6(t,e)}throw aN(t)}function X6(t,e){return e?z6(t,e):Xl(t)}function lr(t,e){return ks(function(n,r){var i=0;n.subscribe(fc(r,function(o){r.next(t.call(e,o,i++))}))})}function $6(t,e,n,r,i,o,s,a){var c=[],l=0,u=0,d=!1,h=function(){d&&!c.length&&!l&&e.complete()},f=function(m){return l<r?p(m):c.push(m)},p=function(m){l++;var C=!1;Xl(n(m,u++)).subscribe(fc(e,function(g){e.next(g)},function(){C=!0},void 0,function(){if(C)try{l--;for(var g=function(){var v=c.shift();s||p(v)};c.length&&l<r;)g();h()}catch(v){e.error(v)}}))};return t.subscribe(fc(e,f,function(){d=!0,h()})),function(){}}function mN(t,e,n){return n===void 0&&(n=1/0),fn(e)?mN(function(r,i){return lr(function(o,s){return e(r,o,i,s)})(Xl(t(r,i)))},n):(typeof e=="number"&&(n=e),ks(function(r,i){return $6(r,i,t,n)}))}function K6(t){return mN(eN,t)}function J6(){return K6(1)}function ty(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return J6()(X6(t,nN(t)))}function vN(t,e){return ks(function(n,r){var i=0;n.subscribe(fc(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function Y6(t,e,n,r,i){return function(o,s){var a=n,c=e,l=0;o.subscribe(fc(s,function(u){var d=l++;c=a?t(c,u,d):(a=!0,u),s.next(c)},i))}}function Q6(t){return ks(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function q6(t,e){return ks(Y6(t,e,arguments.length>=2,!0))}function Gi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nN(t);return ks(function(r,i){(n?ty(t,r,n):ty(t,r)).subscribe(i)})}function _A(t){return ks(function(e,n){Xl(t).subscribe(fc(n,function(){return n.complete()},q0)),!n.closed&&e.subscribe(n)})}var eZ=Object.defineProperty,tZ=Object.defineProperties,nZ=Object.getOwnPropertyDescriptors,xp=Object.getOwnPropertySymbols,yN=Object.prototype.hasOwnProperty,CN=Object.prototype.propertyIsEnumerable,OA=(t,e,n)=>e in t?eZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ny=(t,e)=>{for(var n in e||(e={}))yN.call(e,n)&&OA(t,n,e[n]);if(xp)for(var n of xp(e))CN.call(e,n)&&OA(t,n,e[n]);return t},rZ=(t,e)=>tZ(t,nZ(e)),iZ=(t,e)=>{var n={};for(var r in t)yN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&xp)for(var r of xp(t))e.indexOf(r)<0&&CN.call(t,r)&&(n[r]=t[r]);return n},Es=(t,e,n)=>new Promise((r,i)=>{var o=c=>{try{a(n.next(c))}catch(l){i(l)}},s=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((n=n.apply(t,e)).next())}),IN="lk";function lI(t){return typeof t>"u"?!1:oZ(t)||sZ(t)}function oZ(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function sZ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function aZ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function SN(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(aZ(t))return`${t.participant.identity}_${t.source}_placeholder`;if(lI(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function cZ(t){return t instanceof z0}function lZ(t,e){return Es(this,null,function*(){const{x:n,y:r}=yield C6(t,e,{placement:"top",middleware:[m6(6),y6(),v6({padding:5})]});return{x:n,y:r}})}function uZ(t,e){return!t.contains(e.target)}var dZ=[ne.ConnectionStateChanged,ne.RoomMetadataChanged,ne.ActiveSpeakersChanged,ne.ConnectionQualityChanged,ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ParticipantPermissionsChanged,ne.ParticipantMetadataChanged,ne.TrackMuted,ne.TrackUnmuted,ne.TrackPublished,ne.TrackUnpublished,ne.TrackStreamStateChanged,ne.TrackSubscriptionFailed,ne.TrackSubscriptionPermissionChanged,ne.TrackSubscriptionStatusChanged],hZ=[...dZ,ne.LocalTrackPublished,ne.LocalTrackUnpublished],fZ=[se.ConnectionQualityChanged,se.IsSpeakingChanged,se.ParticipantMetadataChanged,se.ParticipantPermissionsChanged,se.TrackMuted,se.TrackUnmuted,se.TrackPublished,se.TrackUnpublished,se.TrackStreamStateChanged,se.TrackSubscriptionFailed,se.TrackSubscriptionPermissionChanged,se.TrackSubscriptionStatusChanged];[...fZ,se.LocalTrackPublished,se.LocalTrackUnpublished];var ct=S6.getLogger("lk-components-js");ct.setDefaultLevel("WARN");function pZ(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var gZ=[],mZ={showChat:!1,unreadMessages:0};function uI(t,...e){return new Dn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(Gi(t))}function dI(t,e){return new Dn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function vZ(t){return dI(t,ne.ConnectionStateChanged).pipe(lr(([e])=>e),Gi(t.state))}function yZ(t,e,n=!0){var r;const i=()=>Es(this,null,function*(){try{const a=yield kp.getLocalDevices(t,n);o.next(a)}catch(a){e==null||e(a)}}),o=new ya,s=o.pipe(Q6(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return ty(kp.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),s)}function CZ(t){return dI(t,ne.DataReceived)}function IZ(t){return uI(t,ne.AudioPlaybackStatusChanged).pipe(lr(n=>({canPlayAudio:n.canPlaybackAudio})))}function SZ(t){return uI(t,ne.VideoPlaybackStatusChanged).pipe(lr(n=>({canPlayVideo:n.canPlaybackVideo})))}function bZ(t,e){return dI(t,ne.ActiveDeviceChanged).pipe(vN(([n])=>n===e),lr(([n,r])=>(ct.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),Gi(t.getActiveDevice(e)))}function ai(t){return`${IN}-${t}`}function wZ(t){const e=ry(t),n=fI(t.participant).pipe(lr(()=>ry(t)),Gi(e));return{className:ai(t.source===Y.Source.Camera||t.source===Y.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function ry(t){if(lI(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function hI(t,...e){return new Dn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(Gi(t))}function fI(t){return hI(t,se.TrackMuted,se.TrackUnmuted,se.ParticipantPermissionsChanged,se.TrackPublished,se.TrackUnpublished,se.LocalTrackPublished,se.LocalTrackUnpublished,se.MediaDevicesError,se.TrackSubscriptionStatusChanged).pipe(lr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=n,s=n.getTrack(Y.Source.Microphone),a=n.getTrack(Y.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:a,microphoneTrack:s,participant:n}}))}function AZ(t){return hI(t,se.ParticipantMetadataChanged).pipe(lr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),Gi({name:t.name,identity:t.identity,metadata:t.metadata}))}function kZ(t){return pI(t,se.ConnectionQualityChanged).pipe(lr(([n])=>n),Gi(t.connectionQuality))}function pI(t,e){return new Dn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function bN(t){var e,n,r,i;return hI(t.participant,se.TrackMuted,se.TrackUnmuted,se.TrackSubscribed,se.TrackUnsubscribed,se.LocalTrackPublished,se.LocalTrackUnpublished).pipe(lr(o=>{var s,a;const c=(s=t.publication)!=null?s:o.getTrack(t.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),Gi((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function EZ(t){return pI(t,se.IsSpeakingChanged).pipe(lr(([e])=>e))}function TZ(t,e={}){var n;let r;const i=new Dn(c=>(r=c,()=>a.unsubscribe())).pipe(Gi(Array.from(t.participants.values()))),o=(n=e.additionalRoomEvents)!=null?n:hZ,s=Array.from(new Set([ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ConnectionStateChanged,...o])),a=uI(t,...s).subscribe(c=>r==null?void 0:r.next(Array.from(c.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function RZ(t){return pI(t,se.ParticipantPermissionsChanged).pipe(lr(()=>t.permissions),Gi(t.permissions))}function xZ(t,e,n){const{localParticipant:r}=e,i=(l,u)=>{let d=!1;switch(l){case Y.Source.Camera:d=u.isCameraEnabled;break;case Y.Source.Microphone:d=u.isMicrophoneEnabled;break;case Y.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},o=fI(r).pipe(lr(l=>i(t,l.participant)),Gi(i(t,r))),s=new ya,a=(l,u)=>Es(this,null,function*(){try{switch(u??(u=n),s.next(!0),t){case Y.Source.Camera:yield r.setCameraEnabled(l??!r.isCameraEnabled,u);break;case Y.Source.Microphone:yield r.setMicrophoneEnabled(l??!r.isMicrophoneEnabled,u);break;case Y.Source.ScreenShare:yield r.setScreenShareEnabled(l??!r.isScreenShareEnabled,u);break;default:break}}finally{s.next(!1)}});return{className:ai("button"),toggle:a,enabledObserver:o,pendingObserver:s.asObservable()}}function PZ(){let t=!1;const e=new ya,n=new ya,r=o=>{n.next(!0),t=o??!t,e.next(t),n.next(!1)};return{className:ai("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function NZ(t,e,n){const r=new tN(void 0),i=e?bZ(e,t):r.asObservable(),o=(a,...c)=>Es(this,[a,...c],function*(l,u={}){var d,h,f;if(e){ct.debug(`Switching active device of kind "${t}" with id ${l}.`),yield e.switchActiveDevice(t,l,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:l;p!==l&&l!=="default"&&ct.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let m;t==="audioinput"?m=(h=e.localParticipant.getTrack(Y.Source.Microphone))==null?void 0:h.track:t==="videoinput"&&(m=(f=e.localParticipant.getTrack(Y.Source.Camera))==null?void 0:f.track);const C=l==="default"&&!m||l==="default"&&(m==null?void 0:m.mediaStreamTrack.label.startsWith("Default"));r.next(C?l:p)}else if(n){yield n.setDeviceId(u.exact?{exact:l}:l);const p=yield n.getDeviceId();r.next(l==="default"&&n.mediaStreamTrack.label.startsWith("Default")?l:p)}else r.value!==l&&(ct.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(l))});return{className:ai("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function _Z(t){const e=r=>{t.disconnect(r)};return{className:ai("disconnect-button"),disconnect:e}}function OZ(t){const e=ai("connection-quality"),n=kZ(t);return{className:e,connectionQualityObserver:n}}function MZ(t){let e="track-muted-indicator-camera";switch(t.source){case Y.Source.Camera:e="track-muted-indicator-camera";break;case Y.Source.Microphone:e="track-muted-indicator-microphone";break}const n=ai(e),r=bN(t);return{className:n,mediaMutedObserver:r}}function DZ(t){return{className:"lk-participant-name",infoObserver:AZ(t)}}function LZ(){return{className:ai("participant-tile")}}var FZ={CHAT:"lk-chat-topic"};function wN(t,e,n){return Es(this,arguments,function*(r,i,o,s={}){const{kind:a,destination:c}=s;yield r.publishData(i,a??cn.RELIABLE,{destination:c,topic:o})})}function BZ(t,e,n){const r=CZ(t).pipe(vN(([,,,a])=>e===void 0||a===e),lr(([a,c,,l])=>({payload:a,topic:l,from:c})));let i;const o=new Dn(a=>{i=a});return{messageObservable:r,isSendingObservable:o,send:(a,...c)=>Es(this,[a,...c],function*(l,u={}){i.next(!0);try{yield wN(t.localParticipant,l,e,u)}finally{i.next(!1)}})}}var UZ=new TextEncoder,VZ=new TextDecoder,Fh=new Map,GZ=t=>UZ.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),WZ=t=>JSON.parse(VZ.decode(t));function jZ(t,e){var n,r;const i=new ya,{messageDecoder:o,messageEncoder:s,channelTopic:a}=e??{},c=a??FZ.CHAT;let l=!1;Fh.has(t)||(l=!0);const u=(n=Fh.get(t))!=null?n:new Map,d=(r=u.get(c))!=null?r:new ya;if(u.set(c,d),Fh.set(t,u),l){const{messageObservable:v}=BZ(t,c);v.pipe(_A(i)).subscribe(d)}const h=o??WZ,f=d.pipe(lr(v=>{const S=h(v.payload);return rZ(ny({},S),{from:v.from})}),q6((v,S)=>[...v,S],[]),_A(i)),p=new tN(!1),m=s??GZ,C=v=>Es(this,null,function*(){const S=Date.now(),k=m({message:v,timestamp:S});p.next(!0);try{yield wN(t.localParticipant,k,c,{kind:cn.RELIABLE}),d.next({payload:k,topic:c,from:t.localParticipant})}finally{p.next(!1)}});function g(){i.next(),i.complete(),Fh.clear()}return t.once(ne.Disconnected,g),{messageObservable:f,isSendingObservable:p,send:C}}function ZZ(){const t=n=>Es(this,null,function*(){ct.info("Start Audio for room: ",n),yield n.startAudio()});return{className:ai("start-audio-button"),roomAudioPlaybackAllowedObservable:IZ,handleStartAudioPlayback:t}}function HZ(){const t=n=>Es(this,null,function*(){ct.info("Start Video for room: ",n),yield n.startVideo()});return{className:ai("start-audio-button"),roomVideoPlaybackAllowedObservable:SZ,handleStartVideoPlayback:t}}function zZ(){return{className:[ai("button"),ai("chat-toggle")].join(" ")}}function XZ(){return{className:"lk-room-container"}}function $Z(t,e){if(typeof localStorage>"u"){ct.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){ct.error(`Error setting item to local storage: ${n}`)}}function KZ(t){if(typeof localStorage>"u"){ct.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){ct.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){ct.error(`Error getting item from local storage: ${e}`);return}}function JZ(t){return{load:()=>KZ(t),save:e=>$Z(t,e)}}var YZ=`${IN}-user-choices`,Ra={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:QZ,save:qZ}=JZ(YZ);function e8(t,e=!1){if(e===!0)return;const n=t,r=iZ(n,["e2ee","sharedPassphrase"]);qZ(r)}function t8(t,e=!1){var n,r,i,o,s,a,c;const l={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:Ra.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:Ra.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:Ra.videoDeviceId,audioDeviceId:(o=t==null?void 0:t.audioDeviceId)!=null?o:Ra.audioDeviceId,username:(s=t==null?void 0:t.username)!=null?s:Ra.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:Ra.e2ee,sharedPassphrase:(c=t==null?void 0:t.sharedPassphrase)!=null?c:Ra.sharedPassphrase};if(e)return l;{const u=QZ();return ny(ny({},l),u??{})}}function AN(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=AN(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function n8(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=AN(t))&&(r&&(r+=" "),r+=e);return r}var r8=Object.defineProperty,i8=Object.defineProperties,o8=Object.getOwnPropertyDescriptors,Pp=Object.getOwnPropertySymbols,kN=Object.prototype.hasOwnProperty,EN=Object.prototype.propertyIsEnumerable,MA=(t,e,n)=>e in t?r8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Oe=(t,e)=>{for(var n in e||(e={}))kN.call(e,n)&&MA(t,n,e[n]);if(Pp)for(var n of Pp(e))EN.call(e,n)&&MA(t,n,e[n]);return t},Zn=(t,e)=>i8(t,o8(e)),Ln=(t,e)=>{var n={};for(var r in t)kN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Pp)for(var r of Pp(t))e.indexOf(r)<0&&EN.call(t,r)&&(n[r]=t[r]);return n},TN=(t,e,n)=>new Promise((r,i)=>{var o=c=>{try{a(n.next(c))}catch(l){i(l)}},s=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((n=n.apply(t,e)).next())});function zr(t,e){const[n,r]=b.useState(e);return b.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function s8(t){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,r]=b.useState(e(t));function i(){r(e(t))}return b.useEffect(()=>{const o=window.matchMedia(t);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[t]),n}function a8(t,e){if(e.msg==="show_chat")return Zn(Oe({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Zn(Oe({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Zn(Oe({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Zn(Oe({},t),{unreadMessages:e.count}):Oe({},t)}function c8(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:Oe({},t)}var gI=b.createContext(void 0);function l8(){const t=b.useContext(gI);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function u8(t){const[e,n]=b.useReducer(c8,gZ),[r,i]=b.useReducer(a8,mZ);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function RN(){return b.useContext(gI)}var d8=b.createContext(void 0);function nh(){return b.useContext(d8)}var mI=b.createContext(void 0);function vg(){return b.useContext(mI)}function Ic(t){var e;const n=vg(),r=nh(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var vI=b.createContext(void 0);function yg(){const t=b.useContext(vI);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function Cg(){return b.useContext(vI)}function rh(t){const e=Cg(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var h8=b.createContext(void 0);function f8(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function Ea(...t){const e=Oe({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const o=e[i],s=r[i];typeof o=="function"&&typeof s=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=f8(o,s):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?e[i]=n8(o,s):e[i]=s!==void 0?s:o}}return e}function p8(t={}){const e=Ic(t.participant),{className:n,connectionQualityObserver:r}=b.useMemo(()=>OZ(e),[e]),i=zr(r,qr.Unknown);return{className:n,quality:i}}function g8(t){const e=rh(t),n=b.useMemo(()=>vZ(e),[e]);return zr(n,e.state)}function m8(t){const e=yg(),n=g8(e);return{buttonProps:b.useMemo(()=>{const{className:i,disconnect:o}=_Z(e);return Ea(t,{className:i,onClick:()=>{var a;return o((a=t.stopTracks)!=null?a:!0)},disabled:n===it.Disconnected})},[e,t,n])}}function v8(t){if(t.publication instanceof Od){const e=t.publication.track;if(e){const{facingMode:n}=Fj(e);return n}}return"undefined"}function DA(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,o=Ic(i),s=typeof t=="string"?{participant:o,source:t}:t,[a,c]=b.useState(!!((n=s.publication)!=null&&n.isMuted||(r=o.getTrack(s.source))!=null&&r.isMuted));return b.useEffect(()=>{const l=bN(s).subscribe(c);return()=>l.unsubscribe()},[SN(s)]),a}function y8(t){const e=Ic(t),n=b.useMemo(()=>EZ(e),[e]);return zr(n,e.isSpeaking)}var C8={connect:!0,audio:!1,video:!1};function I8(t){const e=Oe(Oe({},C8),t),{token:n,serverUrl:r,options:i,room:o,connectOptions:s,connect:a,audio:c,video:l,screen:u,onConnected:d,onDisconnected:h,onError:f,onMediaDeviceFailure:p,onEncryptionError:m,simulateParticipants:C}=e,g=Ln(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&ct.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,S]=b.useState();b.useEffect(()=>{S(o??new kp(i))},[o]);const k=b.useMemo(()=>{const{className:w}=XZ();return Ea(g,{className:w})},[g]);return b.useEffect(()=>{if(!v)return;const w=()=>{const T=v.localParticipant;ct.debug("trying to publish local tracks"),Promise.all([T.setMicrophoneEnabled(!!c,typeof c!="boolean"?c:void 0),T.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),T.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(_=>{ct.warn(_),f==null||f(_)})},A=T=>{const _=Nd.getFailure(T);p==null||p(_)},x=T=>{m==null||m(T)};return v.on(ne.SignalConnected,w).on(ne.MediaDevicesError,A).on(ne.EncryptionError,x),()=>{v.off(ne.SignalConnected,w).off(ne.MediaDevicesError,A).off(ne.EncryptionError,x)}},[v,c,l,u,f,m,p]),b.useEffect(()=>{if(v){if(C){v.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(!n){ct.debug("no token yet");return}if(!r){ct.warn("no livekit url provided"),f==null||f(Error("no livekit url provided"));return}a?(ct.debug("connecting"),v.connect(r,n,s).catch(w=>{ct.warn(w),f==null||f(w)})):(ct.debug("disconnecting because connect is false"),v.disconnect())}},[a,n,JSON.stringify(s),v,f,r,C]),b.useEffect(()=>{if(!v)return;const w=A=>{switch(A){case it.Disconnected:h&&h();break;case it.Connected:d&&d();break}};return v.on(ne.ConnectionStateChanged,w),()=>{v.off(ne.ConnectionStateChanged,w)}},[n,d,h,v]),b.useEffect(()=>{if(v)return()=>{ct.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:k}}function S8(t={}){const e=rh(t.room),[n,r]=b.useState(e.localParticipant),[i,o]=b.useState(n.isMicrophoneEnabled),[s,a]=b.useState(n.isMicrophoneEnabled),[c,l]=b.useState(n.lastMicrophoneError),[u,d]=b.useState(n.lastCameraError),[h,f]=b.useState(n.isMicrophoneEnabled),[p,m]=b.useState(void 0),[C,g]=b.useState(void 0),v=S=>{a(S.isCameraEnabled),o(S.isMicrophoneEnabled),f(S.isScreenShareEnabled),g(S.cameraTrack),m(S.microphoneTrack),l(S.participant.lastMicrophoneError),d(S.participant.lastCameraError),r(S.participant)};return b.useEffect(()=>{const S=fI(n).subscribe(v);return()=>S.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:h,isCameraEnabled:s,microphoneTrack:p,cameraTrack:C,lastMicrophoneError:c,lastCameraError:u,localParticipant:n}}function b8(){const t=yg(),e=b.useMemo(()=>RZ(t.localParticipant),[t]);return zr(e,t.localParticipant.permissions)}function w8({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const o=Cg(),s=b.useMemo(()=>yZ(t,i,r),[t,r,i]),a=zr(s,[]),[c,l]=b.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:h}=b.useMemo(()=>NZ(t,e??o,n),[t,e,o,n]);return b.useEffect(()=>{const f=d.subscribe(p=>{ct.info("setCurrentDeviceId",p),p&&l(p)});return()=>{f==null||f.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:h}}function A8(t){return t!==void 0}function $l(...t){return Ea(...t.filter(A8))}function xN(t,e,n){return b.Children.map(t,r=>b.isValidElement(r)&&b.Children.only(t)?b.cloneElement(r,Zn(Oe({},e),{key:n})):r)}function PN(t,e={}){var n;const[r,i]=b.useState(ry(t)),[o,s]=b.useState(r==null?void 0:r.isMuted),[a,c]=b.useState(r==null?void 0:r.isSubscribed),[l,u]=b.useState(r==null?void 0:r.track),[d,h]=b.useState("landscape"),f=b.useRef(),{className:p,trackObserver:m}=b.useMemo(()=>wZ(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,lI(t)&&t.publication.trackSid]);return b.useEffect(()=>{const C=m.subscribe(g=>{ct.debug("update track",g),i(g),s(g==null?void 0:g.isMuted),c(g==null?void 0:g.isSubscribed),u(g==null?void 0:g.track)});return()=>C==null?void 0:C.unsubscribe()},[m]),b.useEffect(()=>{var C,g;return l&&(f.current&&l.detach(f.current),(C=e.element)!=null&&C.current&&!(cZ(t.participant)&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),f.current=(g=e.element)==null?void 0:g.current,()=>{f.current&&(l==null||l.detach(f.current))}},[l,e.element]),b.useEffect(()=>{var C,g;if(typeof((C=r==null?void 0:r.dimensions)==null?void 0:C.width)=="number"&&typeof((g=r==null?void 0:r.dimensions)==null?void 0:g.height)=="number"){const v=r.dimensions.width>r.dimensions.height?"landscape":"portrait";h(v)}},[r]),{publication:r,isMuted:o,isSubscribed:a,track:l,elementProps:$l(e.props,Oe({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function k8({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:s}){const a=nh(),c=Ic(e),l=b.useMemo(()=>{var m,C,g,v,S,k;const w=(C=(m=t==null?void 0:t.source)!=null?m:a==null?void 0:a.source)!=null?C:n;if(w===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(v=(g=t==null?void 0:t.participant)!=null?g:a==null?void 0:a.participant)!=null?v:c,publication:(k=(S=t==null?void 0:t.publication)!=null?S:a==null?void 0:a.publication)!=null?k:r,source:w}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,c,n,r]),u=b.useMemo(()=>{const{className:m}=LZ();return Ea(s,{className:m,onClick:C=>{var g,v;if((g=s.onClick)==null||g.call(s,C),typeof i=="function"){const S=(v=l.publication)!=null?v:l.participant.getTrack(l.source);i({participant:l.participant,track:S})}}})},[s,i,l.publication,l.source,l.participant]),d=DA(Y.Source.Camera,{participant:l.participant}),h=DA(Y.Source.Microphone,{participant:l.participant}),f=y8(l.participant),p=v8(l);return{elementProps:Oe({"data-lk-audio-muted":h,"data-lk-video-muted":d,"data-lk-speaking":o===!0?!1:f,"data-lk-local-participant":l.participant.isLocal,"data-lk-source":l.source,"data-lk-facing-mode":p},u)}}function E8(t={}){const e=rh(t.room),[n,r]=b.useState([]);return b.useEffect(()=>{const i=TZ(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function T8(t={}){const e=E8(t),{localParticipant:n}=S8(t);return[n,...e]}function R8({room:t,props:e}){const n=rh(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=b.useMemo(()=>ZZ(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=zr(s,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:b.useMemo(()=>Ea(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayAudio:a}}function x8({room:t,props:e}){const n=rh(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=b.useMemo(()=>HZ(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=zr(s,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:b.useMemo(()=>Ea(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayVideo:a}}function P8({props:t}){const{dispatch:e,state:n}=l8().widget,{className:r}=b.useMemo(()=>zZ(),[]);return{mergedProps:b.useMemo(()=>Ea(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function N8(t,e={}){var n,r,i,o;let s=nh();const a=(r=(n=vg())!=null?n:e.participant)!=null?r:s==null?void 0:s.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:a,source:t}}else if(t)s=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:c,mediaMutedObserver:l}=b.useMemo(()=>MZ(s),[SN(s)]);return{isMuted:zr(l,!!((i=s.publication)!=null&&i.isMuted||(o=s.participant.getTrack(s.source))!=null&&o.isMuted)),className:c}}function _8(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:o}=e,s=Ln(e,["source","onChange","initialState","captureOptions"]),a;const c=Cg(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:h,enabledObserver:f}=b.useMemo(()=>c?xZ(n,c,o):PZ(),[c,n,JSON.stringify(o)]),p=zr(h,!1),m=zr(f,i??!!(l!=null&&l.isEnabled));b.useEffect(()=>{r==null||r(m)},[m,r]),b.useEffect(()=>{i!==void 0&&(ct.debug("forcing initial toggle state",n,i),u(i))},[]);const C=b.useMemo(()=>Ea(s,{className:d}),[s,d]),g=b.useCallback(v=>{var S;u(),(S=s.onClick)==null||S.call(s,v)},[s,u]);return{toggle:u,enabled:m,pending:p,track:l,buttonProps:Zn(Oe({},C),{"aria-pressed":m,"data-lk-source":n,"data-lk-enabled":m,disabled:p,onClick:g})}}function O8(t,e={}){return PN(t,e)}function M8(t){const e=yg(),[n,r]=b.useState(),i=zr(n==null?void 0:n.isSendingObservable,!1),o=zr(n==null?void 0:n.messageObservable,[]);return b.useEffect(()=>{const s=jZ(e,t);r(s)},[e,t]),{send:n==null?void 0:n.send,chatMessages:o,isSending:i}}function D8(t={}){var e;const[n,r]=b.useState(t8(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=b.useCallback(l=>{r(u=>Zn(Oe({},u),{audioEnabled:l}))},[]),o=b.useCallback(l=>{r(u=>Zn(Oe({},u),{videoEnabled:l}))},[]),s=b.useCallback(l=>{r(u=>Zn(Oe({},u),{audioDeviceId:l}))},[]),a=b.useCallback(l=>{r(u=>Zn(Oe({},u),{videoDeviceId:l}))},[]),c=b.useCallback(l=>{r(u=>Zn(Oe({},u),{username:l}))},[]);return b.useEffect(()=>{var l;e8(n,(l=t.preventSave)!=null?l:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:s,saveVideoInputDeviceId:a,saveUsername:c}}function L8(t){const{mergedProps:e}=P8({props:t});return b.createElement("button",Oe({},e),t.children)}function F8(t){const{buttonProps:e}=m8(t);return b.createElement("button",Oe({},e),t.children)}var B8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),b.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),U8=B8,V8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),G8=V8,W8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),j8=W8,Z8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),H8=Z8,z8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),b.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),X8=z8,$8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),b.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),K8=$8,J8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),Y8=J8,Q8=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),q8=Q8,e7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),t7=e7,n7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),r7=n7,i7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),o7=i7,s7=t=>b.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("g",{fill:"currentColor"},b.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),b.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),a7=s7;function Mm(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:s,exactMatch:a,track:c,requestPermissions:l,onError:u}=e,d=Ln(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const h=Cg(),f=b.useCallback(w=>{h&&h.emit(ne.MediaDevicesError,w),u==null||u(w)},[h,u]),{devices:p,activeDeviceId:m,setActiveMediaDevice:C,className:g}=w8({kind:n,room:h,track:c,requestPermissions:l,onError:f});b.useEffect(()=>{r!==void 0&&C(r)},[C]),b.useEffect(()=>{typeof o=="function"&&o(p)},[o,p]),b.useEffect(()=>{m&&m!==""&&(i==null||i(m))},[m]);const v=w=>TN(this,null,function*(){try{yield C(w,{exact:a})}catch(A){if(A instanceof Error)s==null||s(A);else throw A}}),S=b.useMemo(()=>$l(d,{className:g},{className:"lk-list"}),[g,d]);function k(w,A,x){return w===A||x===0&&A==="default"}return b.createElement("ul",Oe({},S),p.map((w,A)=>b.createElement("li",{key:w.deviceId,id:w.deviceId,"data-lk-active":k(w.deviceId,m,A),"aria-selected":k(w.deviceId,m,A),role:"option"},b.createElement("button",{className:"lk-button",onClick:()=>v(w.deviceId)},w.label))))}function NN(t,e){switch(t){case Y.Source.Microphone:return e?b.createElement(K8,null):b.createElement(X8,null);case Y.Source.Camera:return e?b.createElement(G8,null):b.createElement(U8,null);case Y.Source.ScreenShare:return e?b.createElement(a7,null):b.createElement(o7,null);default:return}}function c7(t){switch(t){case qr.Excellent:return b.createElement(Y8,null);case qr.Good:return b.createElement(q8,null);case qr.Poor:return b.createElement(t7,null);default:return b.createElement(r7,null)}}function Dm(t){var e=t,{showIcon:n}=e,r=Ln(e,["showIcon"]);const{buttonProps:i,enabled:o}=_8(r);return b.createElement("button",Oe({},i),(n??!0)&&NN(r.source,o),r.children)}function l7(t){var e;const{className:n,quality:r}=p8(t),i=b.useMemo(()=>Zn(Oe({},$l(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return b.createElement("div",Oe({},i),(e=t.children)!=null?e:c7(r))}function u7(t){var e=t,{participant:n}=e,r=Ln(e,["participant"]);const i=Ic(n),{className:o,infoObserver:s}=b.useMemo(()=>DZ(i),[i]),{identity:a,name:c}=zr(s,{name:i.name,identity:i.identity,metadata:i.metadata}),l=b.useMemo(()=>$l(r,{className:o,"data-lk-participant-name":c}),[r,o,c]);return b.createElement("span",Oe({},l),c!==""?c:a,r.children)}function d7(t){var e=t,{source:n,participant:r,trackRef:i,show:o="always"}=e,s=Ln(e,["source","participant","trackRef","show"]),a,c;const{className:l,isMuted:u}=N8(i??n,{participant:r}),d=o==="always"||o==="muted"&&u||o==="unmuted"&&!u,h=b.useMemo(()=>$l(s,{className:l}),[l,s]);return d?b.createElement("div",Zn(Oe({},h),{"data-lk-muted":u}),(c=s.children)!=null?c:NN((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function h7(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:o,name:s,publication:a,participant:c}=e,l=Ln(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,h,f,p,m,C,g,v,S;const k=nh(),w=(f=(h=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?h:(d=k==null?void 0:k.publication)==null?void 0:d.trackName)!=null?f:s,A=(m=(p=n==null?void 0:n.source)!=null?p:k==null?void 0:k.source)!=null?m:o,x=(g=(C=n==null?void 0:n.publication)!=null?C:k==null?void 0:k.publication)!=null?g:a,T=(S=(v=n==null?void 0:n.participant)!=null?v:k==null?void 0:k.participant)!=null?S:c;if(A===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const _=b.useRef(null),O=Ic(T),{elementProps:L,isSubscribed:U,track:z,publication:Z}=PN({source:A,name:w,participant:O,publication:x},{element:_,props:l});return b.useEffect(()=>{r==null||r(!!U)},[U,r]),b.useEffect(()=>{z===void 0||i===void 0||(z instanceof Qa?z.setVolume(i):ct.warn("Volume can only be set on remote audio tracks."))},[i,z]),b.useEffect(()=>{Z===void 0||l.muted===void 0||(Z instanceof iI?Z.setEnabled(!l.muted):ct.warn("Can only call setEnabled on remote track publications."))},[l.muted,Z,z]),b.createElement("audio",Oe({ref:_},L))}function f7(t){const e=!!vg();return t.participant&&!e?b.createElement(mI.Provider,{value:t.participant},t.children):b.createElement(b.Fragment,null,t.children)}function p7({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=u8(t);return b.useEffect(()=>{ct.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),b.useEffect(()=>{ct.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),b.createElement(gI.Provider,{value:i},r)}function g7(t){const{room:e,htmlProps:n}=I8(t);return b.createElement("div",Oe({},n),e&&b.createElement(vI.Provider,{value:e},b.createElement(h8.Provider,{value:t.featureFlags},t.children)))}function m7(t){var e=t,{participant:n,trackRef:r}=e,i=Ln(e,["participant","trackRef"]),o,s;const[a,c]=b.useState([]),l=200,u=90,d=6,h=4,f=50,p=7,m=(o=vg())!=null?o:n;let C=(s=nh())!=null?s:r;if(!C){if(!m)throw Error("Participant missing, provide it directly or within a context");C={participant:m,source:Y.Source.Microphone}}const{track:g}=O8(C);return b.useEffect(()=>{if(!g||!(g instanceof pr||g instanceof Qa))return;const{analyser:v,cleanup:S}=Z9(g,{smoothingTimeConstant:.8,fftSize:64}),k=new Uint8Array(v.frequencyBinCount),w=()=>{v.getByteFrequencyData(k);const x=new Array(p).fill(0);k.slice(1);const T=6;for(let _=0;_<p/2;_+=1){const O=Math.floor(p/2-_);for(let L=0;L<T;L+=1)x[O]+=Math.pow(k[_*T+L]/255,2);x[O]/=T}for(let _=0;_<p/2;_+=1){const O=Math.floor(p/2+_);if(x[O]===0){for(let L=0;L<T;L+=1)x[O]+=Math.pow(k[_*T+L]/255,2);x[O]/=T}}return x.map(_=>_*f)},A=setInterval(()=>{const x=w();c(x)},100);return()=>{clearInterval(A),S()}},[g]),b.createElement("svg",Zn(Oe({width:"100%",height:"100%",viewBox:`0 0 ${l} ${u}`},i),{className:"lk-audio-visualizer"}),b.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),b.createElement("g",{style:{transform:`translate(${(l-p*(d+h))/2}px, 0)`}},a.map((v,S)=>b.createElement("rect",{key:S,x:S*(d+h),y:u/2-v/2,width:d,height:v}))))}function v7(t){var e=t,{participants:n}=e,r=Ln(e,["participants"]);return b.createElement(b.Fragment,null,n.map(i=>b.createElement(mI.Provider,{value:i,key:i.identity},xN(r.children))))}function y7(t){var e=t,{participant:n,children:r,source:i,publication:o,disableSpeakingIndicator:s,onParticipantClick:a}=e,c=Ln(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const l=Ic(n),{elementProps:u}=k8({participant:l,htmlProps:c,disableSpeakingIndicator:s,source:Y.Source.Microphone,publication:o,onParticipantClick:a});return b.createElement("div",Oe({style:{position:"relative"}},u),b.createElement(f7,{participant:l},r??b.createElement(b.Fragment,null,b.createElement(h7,{source:i??Y.Source.Microphone}),b.createElement(m7,null),b.createElement("div",{className:"lk-participant-metadata"},b.createElement("div",{className:"lk-participant-metadata-item"},b.createElement(d7,{source:Y.Source.Microphone}),b.createElement(u7,null)),b.createElement(l7,{className:"lk-participant-metadata-item"})))))}function C7(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=e,s=Ln(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,c,l,u;const d=b.useMemo(()=>o?o(n.message):n.message,[n.message,o]),h=new Date(n.timestamp),f=navigator?navigator.language:"en-US";return b.createElement("li",Oe({className:"lk-chat-entry",title:h.toLocaleTimeString(f,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},s),(!i||!r)&&b.createElement("span",{className:"lk-meta-data"},!r&&b.createElement("strong",{className:"lk-participant-name"},(u=(c=n.from)==null?void 0:c.name)!=null?u:(l=n.from)==null?void 0:l.identity),!i&&b.createElement("span",{className:"lk-timestamp"},h.toLocaleTimeString(f,{timeStyle:"short"}))),b.createElement("span",{className:"lk-message-body"},d))}function I7(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:o}=e,s=Ln(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=b.useRef(null),c=b.useRef(null),l=b.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:u,chatMessages:d,isSending:h}=M8(l),f=RN(),p=b.useRef(0);function m(C){return TN(this,null,function*(){C.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return b.useEffect(()=>{var C;c&&((C=c.current)==null||C.scrollTo({top:c.current.scrollHeight}))},[c,d]),b.useEffect(()=>{var C,g,v,S,k;if(!f||d.length===0)return;if((C=f.widget.state)!=null&&C.showChat&&d.length>0&&p.current!==((g=d[d.length-1])==null?void 0:g.timestamp)){p.current=(v=d[d.length-1])==null?void 0:v.timestamp;return}const w=d.filter(x=>!p.current||x.timestamp>p.current).length,{widget:A}=f;w>0&&((S=A.state)==null?void 0:S.unreadMessages)!==w&&((k=A.dispatch)==null||k.call(A,{msg:"unread_msg",count:w}))},[d,f==null?void 0:f.widget]),b.createElement("div",Zn(Oe({},s),{className:"lk-chat"}),b.createElement("ul",{className:"lk-list lk-chat-messages",ref:c},s.children?d.map((C,g)=>xN(s.children,{entry:C,key:g,messageFormatter:n})):d.map((C,g,v)=>{const S=g>=1&&v[g-1].from===C.from,k=g>=1&&C.timestamp-v[g-1].timestamp<6e4;return b.createElement(C7,{key:g,hideName:S,hideTimestamp:S===!1?!1:k,entry:C,messageFormatter:n})})),b.createElement("form",{className:"lk-chat-form",onSubmit:m},b.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:h,ref:a,type:"text",placeholder:"Enter a message..."}),b.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:h},"Send")))}function LA(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:s=!1}=e,a=Ln(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[c,l]=b.useState(!1),[u,d]=b.useState([]),[h,f]=b.useState(!0),p=(v,S)=>{ct.debug("handle device change"),l(!1),i==null||i(v,S)},m=b.useRef(null),C=b.useRef(null);b.useLayoutEffect(()=>{m.current&&C.current&&(u||h)&&lZ(m.current,C.current).then(({x:v,y:S})=>{C.current&&Object.assign(C.current.style,{left:`${v}px`,top:`${S}px`})}),f(!1)},[m,C,u,h]);const g=b.useCallback(v=>{C.current&&v.target!==m.current&&c&&uZ(C.current,v)&&l(!1)},[c,C,m]);return b.useEffect(()=>(document.addEventListener("click",g),window.addEventListener("resize",()=>f(!0)),()=>{document.removeEventListener("click",g),window.removeEventListener("resize",()=>f(!0))}),[g,f]),b.createElement(b.Fragment,null,b.createElement("button",Zn(Oe({className:"lk-button lk-button-menu","aria-pressed":c},a),{onClick:()=>l(!c),ref:m}),a.children),!a.disabled&&b.createElement("div",{className:"lk-device-menu",ref:C,style:{visibility:c?"visible":"hidden"}},n?b.createElement(Mm,{initialSelection:r,onActiveDeviceChange:v=>p(n,v),onDeviceListChange:d,kind:n,track:o==null?void 0:o[n],requestPermissions:s}):b.createElement(b.Fragment,null,b.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),b.createElement(Mm,{kind:"audioinput",onActiveDeviceChange:v=>p("audioinput",v),onDeviceListChange:d,track:o==null?void 0:o.audioinput,requestPermissions:s}),b.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),b.createElement(Mm,{kind:"videoinput",onActiveDeviceChange:v=>p("videoinput",v),onDeviceListChange:d,track:o==null?void 0:o.videoinput,requestPermissions:s}))))}function S7(t){var e=t,{label:n}=e,r=Ln(e,["label"]);const i=yg(),{mergedProps:o,canPlayAudio:s}=R8({room:i,props:r}),{mergedProps:a,canPlayVideo:c}=x8({room:i,props:o}),l=a,{style:u}=l,d=Ln(l,["style"]);return u.display=s&&c?"none":"block",b.createElement("button",Oe({style:u},d),n??`Start ${s?"Video":"Audio"}`)}function b7(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,o=Ln(e,["variation","controls","saveUserChoices"]),s,a,c,l,u;const[d,h]=b.useState(!1),f=RN();b.useEffect(()=>{var z,Z;((z=f==null?void 0:f.widget.state)==null?void 0:z.showChat)!==void 0&&h((Z=f==null?void 0:f.widget.state)==null?void 0:Z.showChat)},[(s=f==null?void 0:f.widget.state)==null?void 0:s.showChat]);const m=s8(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=m);const C=Oe({leave:!0},r),g=b8();g?((a=C.camera)!=null||(C.camera=g.canPublish),(c=C.microphone)!=null||(C.microphone=g.canPublish),(l=C.screenShare)!=null||(C.screenShare=g.canPublish),(u=C.chat)!=null||(C.chat=g.canPublishData&&(r==null?void 0:r.chat))):(C.camera=!1,C.chat=!1,C.microphone=!1,C.screenShare=!1);const v=b.useMemo(()=>n==="minimal"||n==="verbose",[n]),S=b.useMemo(()=>n==="textOnly"||n==="verbose",[n]),k=pZ(),[w,A]=b.useState(!1),x=z=>{A(z)},T=$l({className:"lk-control-bar"},o),{saveAudioInputEnabled:_,saveVideoInputEnabled:O,saveAudioInputDeviceId:L,saveVideoInputDeviceId:U}=D8({preventSave:!i});return b.createElement("div",Oe({},T),C.microphone&&b.createElement("div",{className:"lk-button-group"},b.createElement(Dm,{source:Y.Source.Microphone,showIcon:v,onChange:_},S&&"Microphone"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(LA,{kind:"audioinput",onActiveDeviceChange:(z,Z)=>L(Z??"")}))),C.camera&&b.createElement("div",{className:"lk-button-group"},b.createElement(Dm,{source:Y.Source.Camera,showIcon:v,onChange:O},S&&"Camera"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(LA,{kind:"videoinput",onActiveDeviceChange:(z,Z)=>U(Z??"")}))),C.screenShare&&k&&b.createElement(Dm,{source:Y.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:v,onChange:x},S&&(w?"Stop screen share":"Share screen")),C.chat&&b.createElement(L8,null,v&&b.createElement(j8,null),S&&"Chat"),C.leave&&b.createElement(F8,null,v&&b.createElement(H8,null),S&&"Leave"),b.createElement(S7,null))}function w7(t){var e=Ln(t,[]);const[n,r]=b.useState({showChat:!1,unreadMessages:0}),i=T8();return b.createElement(p7,{onWidgetChange:r},b.createElement("div",Oe({className:"lk-audio-conference"},e),b.createElement("div",{className:"lk-audio-conference-stage"},b.createElement(v7,{participants:i},b.createElement(y7,null))),b.createElement(b7,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&b.createElement(I7,null)))}const A7="wss://mongoose-67t79p35.livekit.cloud",k7=({client:t})=>{const[e,n]=b.useState([]),[r,i]=b.useState(!1);return b.useEffect(()=>{const o=a=>{n(c=>[...c,a]),i(!0)},s=a=>{n(c=>{const l=c.filter(u=>u!==a);return l.length===0&&i(!1),l})};return t.on("livekitToken",o),t.on("livekitLeave",s),()=>{t.off("livekitToken",o),t.off("livekitLeave",s)}},[t]),e.length?K.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,s)=>K.jsx(g7,{video:!1,audio:!0,token:o,serverUrl:A7,connect:!0,onDisconnected:()=>t.emit("livekitLeave",o),children:K.jsx(w7,{})},s)),K.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null};function E7(){const[t,e]=b.useState(null),[n,r]=b.useState(!1),[i,o]=b.useState([]),s=lt.useRef(null),a=lt.useRef(null),c=lt.useRef(null),l=b.useRef(!1),u=()=>{s.current&&s.current.saveLog()},d=()=>{s.current&&s.current.clearLog()},h=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return b.useEffect(()=>{if(l.current)return;const f=new hV("mongoose.moo.mud.org",8765);f.registerGMCPPackage(eV),f.registerGMCPPackage(J4),f.registerGMCPPackage(Y4),f.registerGMCPPackage(zF),f.registerGMCPPackage(tV),f.registerGMCPPackage(Q4),f.registerGMCPPackage(q4),f.registerGMCPPackage(ZF),f.registerGMCPPackage(nV),f.registerMcpPackage(sV),f.registerMcpPackage(aV),f.registerMcpPackage(lV),f.registerMcpPackage(uV),f.connect(),f.requestNotificationPermission(),e(f),r(!h),window.mudClient=f,l.current=!0;const p=C=>{f&&(C.key==="Control"&&f.cancelSpeech(),C.key==="Escape"&&f.stopAllSounds())};window.addEventListener("keydown",p);const m=()=>{var C;(C=a.current)==null||C.focus()};return document.addEventListener("focus",m),()=>{window.removeEventListener("keydown",p),document.removeEventListener("focus",m)}},[h]),b.useEffect(()=>{if(t){const f=m=>{o(m)},p=()=>{o([])};return t.on("userlist",f),t.on("disconnect",p),()=>{t.off("userlist",f),t.off("disconnect",p)}}},[t]),SE(f=>{t&&t.shutdown()}),t?K.jsxs("div",{className:"App",children:[K.jsx("header",{className:"App-header"}),K.jsx(aW,{client:t,onSaveLog:u,onClearLog:d,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var f;return(f=c.current)==null?void 0:f.open()}}),K.jsxs("div",{children:[K.jsx(Kv,{client:t,ref:s}),n&&K.jsx(lW,{users:i}),K.jsx(k7,{client:t})]}),K.jsx(pV,{onSend:t.sendCommand,inputRef:a}),K.jsx(cW,{client:t}),K.jsx(XG,{ref:c})]}):null}function T7(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function BA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?FA(Object(n),!0).forEach(function(r){T7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function R7(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function x7(t,e){if(t==null)return{};var n=R7(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function P7(t,e){return N7(t)||_7(t,e)||O7(t,e)||M7()}function N7(t){if(Array.isArray(t))return t}function _7(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var s=t[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(c){i=!0,o=c}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw o}}return n}}function O7(t,e){if(t){if(typeof t=="string")return UA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UA(t,e)}}function UA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function M7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D7(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function GA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?VA(Object(n),!0).forEach(function(r){D7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):VA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function L7(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function Lu(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function Np(t){return{}.toString.call(t).includes("Object")}function F7(t){return!Object.keys(t).length}function Ld(t){return typeof t=="function"}function B7(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function U7(t,e){return Np(e)||ha("changeType"),Object.keys(e).some(function(n){return!B7(t,n)})&&ha("changeField"),e}function V7(t){Ld(t)||ha("selectorType")}function G7(t){Ld(t)||Np(t)||ha("handlerType"),Np(t)&&Object.values(t).some(function(e){return!Ld(e)})&&ha("handlersType")}function W7(t){t||ha("initialIsRequired"),Np(t)||ha("initialType"),F7(t)&&ha("initialContent")}function j7(t,e){throw new Error(t[e]||t.default)}var Z7={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},ha=Lu(j7)(Z7),Bh={changes:U7,selector:V7,handler:G7,initial:W7};function H7(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Bh.initial(t),Bh.handler(e);var n={current:t},r=Lu($7)(n,e),i=Lu(X7)(n),o=Lu(Bh.changes)(t),s=Lu(z7)(n);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return Bh.selector(l),l(n.current)}function c(l){L7(r,i,o,s)(l)}return[a,c]}function z7(t,e){return Ld(e)?e(t.current):e}function X7(t,e){return t.current=GA(GA({},t.current),e),e}function $7(t,e,n){return Ld(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var K7={create:H7},J7={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function Y7(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function Q7(t){return{}.toString.call(t).includes("Object")}function q7(t){return t||WA("configIsRequired"),Q7(t)||WA("configType"),t.urls?(eH(),{paths:{vs:t.urls.monacoBase}}):t}function eH(){console.warn(_N.deprecation)}function tH(t,e){throw new Error(t[e]||t.default)}var _N={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},WA=Y7(tH)(_N),nH={config:q7},rH=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(o,s){return s(o)},i)}};function ON(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],ON(t[n],e[n]))}),BA(BA({},t),e)}var iH={type:"cancelation",msg:"operation is manually canceled"};function Lm(t){var e=!1,n=new Promise(function(r,i){t.then(function(o){return e?i(iH):r(o)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var oH=K7.create({config:J7,isInitialized:!1,resolve:null,reject:null,monaco:null}),MN=P7(oH,2),ih=MN[0],Ig=MN[1];function sH(t){var e=nH.config(t),n=e.monaco,r=x7(e,["monaco"]);Ig(function(i){return{config:ON(i.config,r),monaco:n}})}function aH(){var t=ih(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(Ig({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Lm(Fm);if(window.monaco&&window.monaco.editor)return DN(window.monaco),t.resolve(window.monaco),Lm(Fm);rH(cH,uH)(dH)}return Lm(Fm)}function cH(t){return document.body.appendChild(t)}function lH(t){var e=document.createElement("script");return t&&(e.src=t),e}function uH(t){var e=ih(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),n=lH("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function dH(){var t=ih(function(n){var r=n.config,i=n.resolve,o=n.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){DN(n),t.resolve(n)},function(n){t.reject(n)})}function DN(t){ih().monaco||Ig({monaco:t})}function hH(){return ih(function(t){var e=t.monaco;return e})}var Fm=new Promise(function(t,e){return Ig({resolve:t,reject:e})}),LN={config:sH,init:aH,__getMonacoInstance:hH},fH={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Bm=fH,pH={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},gH=pH;function mH({children:t}){return lt.createElement("div",{style:gH.container},t)}var vH=mH,yH=vH;function CH({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:o,wrapperProps:s}){return lt.createElement("section",{style:{...Bm.wrapper,width:t,height:e},...s},!n&&lt.createElement(yH,null,r),lt.createElement("div",{ref:i,style:{...Bm.fullWidth,...!n&&Bm.hide},className:o}))}var IH=CH,FN=b.memo(IH);function SH(t){b.useEffect(t,[])}var BN=SH;function bH(t,e,n=!0){let r=b.useRef(!0);b.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var Ur=bH;function qu(){}function Hc(t,e,n,r){return wH(t,r)||AH(t,e,n,r)}function wH(t,e){return t.editor.getModel(UN(t,e))}function AH(t,e,n,r){return t.editor.createModel(e,n,r?UN(t,r):void 0)}function UN(t,e){return t.Uri.parse(e)}function kH({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:c=!1,theme:l="light",loading:u="Loading...",options:d={},height:h="100%",width:f="100%",className:p,wrapperProps:m={},beforeMount:C=qu,onMount:g=qu}){let[v,S]=b.useState(!1),[k,w]=b.useState(!0),A=b.useRef(null),x=b.useRef(null),T=b.useRef(null),_=b.useRef(g),O=b.useRef(C),L=b.useRef(!1);BN(()=>{let J=LN.init();return J.then(ee=>(x.current=ee)&&w(!1)).catch(ee=>(ee==null?void 0:ee.type)!=="cancelation"&&console.error("Monaco initialization: error:",ee)),()=>A.current?Z():J.cancel()}),Ur(()=>{if(A.current&&x.current){let J=A.current.getOriginalEditor(),ee=Hc(x.current,t||"",r||n||"text",o||"");ee!==J.getModel()&&J.setModel(ee)}},[o],v),Ur(()=>{if(A.current&&x.current){let J=A.current.getModifiedEditor(),ee=Hc(x.current,e||"",i||n||"text",s||"");ee!==J.getModel()&&J.setModel(ee)}},[s],v),Ur(()=>{let J=A.current.getModifiedEditor();J.getOption(x.current.editor.EditorOption.readOnly)?J.setValue(e||""):e!==J.getValue()&&(J.executeEdits("",[{range:J.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),J.pushUndoStop())},[e],v),Ur(()=>{var J,ee;(ee=(J=A.current)==null?void 0:J.getModel())==null||ee.original.setValue(t||"")},[t],v),Ur(()=>{let{original:J,modified:ee}=A.current.getModel();x.current.editor.setModelLanguage(J,r||n||"text"),x.current.editor.setModelLanguage(ee,i||n||"text")},[n,r,i],v),Ur(()=>{var J;(J=x.current)==null||J.editor.setTheme(l)},[l],v),Ur(()=>{var J;(J=A.current)==null||J.updateOptions(d)},[d],v);let U=b.useCallback(()=>{var re;if(!x.current)return;O.current(x.current);let J=Hc(x.current,t||"",r||n||"text",o||""),ee=Hc(x.current,e||"",i||n||"text",s||"");(re=A.current)==null||re.setModel({original:J,modified:ee})},[n,e,i,t,r,o,s]),z=b.useCallback(()=>{var J;!L.current&&T.current&&(A.current=x.current.editor.createDiffEditor(T.current,{automaticLayout:!0,...d}),U(),(J=x.current)==null||J.editor.setTheme(l),S(!0),L.current=!0)},[d,l,U]);b.useEffect(()=>{v&&_.current(A.current,x.current)},[v]),b.useEffect(()=>{!k&&!v&&z()},[k,v,z]);function Z(){var ee,re,X,$;let J=(ee=A.current)==null?void 0:ee.getModel();a||((re=J==null?void 0:J.original)==null||re.dispose()),c||((X=J==null?void 0:J.modified)==null||X.dispose()),($=A.current)==null||$.dispose()}return lt.createElement(FN,{width:f,height:h,isEditorReady:v,loading:u,_ref:T,className:p,wrapperProps:m})}var EH=kH;b.memo(EH);function TH(t){let e=b.useRef();return b.useEffect(()=>{e.current=t},[t]),e.current}var RH=TH,Uh=new Map;function xH({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:o,theme:s="light",line:a,loading:c="Loading...",options:l={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:h=!1,width:f="100%",height:p="100%",className:m,wrapperProps:C={},beforeMount:g=qu,onMount:v=qu,onChange:S,onValidate:k=qu}){let[w,A]=b.useState(!1),[x,T]=b.useState(!0),_=b.useRef(null),O=b.useRef(null),L=b.useRef(null),U=b.useRef(v),z=b.useRef(g),Z=b.useRef(),J=b.useRef(r),ee=RH(o),re=b.useRef(!1),X=b.useRef(!1);BN(()=>{let j=LN.init();return j.then(oe=>(_.current=oe)&&T(!1)).catch(oe=>(oe==null?void 0:oe.type)!=="cancelation"&&console.error("Monaco initialization: error:",oe)),()=>O.current?ie():j.cancel()}),Ur(()=>{var oe,ke,Le,de;let j=Hc(_.current,t||r||"",e||i||"",o||n||"");j!==((oe=O.current)==null?void 0:oe.getModel())&&(d&&Uh.set(ee,(ke=O.current)==null?void 0:ke.saveViewState()),(Le=O.current)==null||Le.setModel(j),d&&((de=O.current)==null||de.restoreViewState(Uh.get(o))))},[o],w),Ur(()=>{var j;(j=O.current)==null||j.updateOptions(l)},[l],w),Ur(()=>{!O.current||r===void 0||(O.current.getOption(_.current.editor.EditorOption.readOnly)?O.current.setValue(r):r!==O.current.getValue()&&(X.current=!0,O.current.executeEdits("",[{range:O.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),O.current.pushUndoStop(),X.current=!1))},[r],w),Ur(()=>{var oe,ke;let j=(oe=O.current)==null?void 0:oe.getModel();j&&i&&((ke=_.current)==null||ke.editor.setModelLanguage(j,i))},[i],w),Ur(()=>{var j;a!==void 0&&((j=O.current)==null||j.revealLine(a))},[a],w),Ur(()=>{var j;(j=_.current)==null||j.editor.setTheme(s)},[s],w);let $=b.useCallback(()=>{var j;if(!(!L.current||!_.current)&&!re.current){z.current(_.current);let oe=o||n,ke=Hc(_.current,r||t||"",e||i||"",oe||"");O.current=(j=_.current)==null?void 0:j.editor.create(L.current,{model:ke,automaticLayout:!0,...l},u),d&&O.current.restoreViewState(Uh.get(oe)),_.current.editor.setTheme(s),a!==void 0&&O.current.revealLine(a),A(!0),re.current=!0}},[t,e,n,r,i,o,l,u,d,s,a]);b.useEffect(()=>{w&&U.current(O.current,_.current)},[w]),b.useEffect(()=>{!x&&!w&&$()},[x,w,$]),J.current=r,b.useEffect(()=>{var j,oe;w&&S&&((j=Z.current)==null||j.dispose(),Z.current=(oe=O.current)==null?void 0:oe.onDidChangeModelContent(ke=>{X.current||S(O.current.getValue(),ke)}))},[w,S]),b.useEffect(()=>{if(w){let j=_.current.editor.onDidChangeMarkers(oe=>{var Le;let ke=(Le=O.current.getModel())==null?void 0:Le.uri;if(ke&&oe.find(de=>de.path===ke.path)){let de=_.current.editor.getModelMarkers({resource:ke});k==null||k(de)}});return()=>{j==null||j.dispose()}}return()=>{}},[w,k]);function ie(){var j,oe;(j=Z.current)==null||j.dispose(),h?d&&Uh.set(o,O.current.saveViewState()):(oe=O.current.getModel())==null||oe.dispose(),O.current.dispose()}return lt.createElement(FN,{width:f,height:p,isEditorReady:w,loading:c,_ref:L,className:m,wrapperProps:C})}var PH=xH,NH=b.memo(PH),_H=NH,OH={restoreOnUnmount:!1};function MH(t,e){e===void 0&&(e=OH);var n=b.useRef(document.title);document.title!==t&&(document.title=t),b.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const DH=typeof document<"u"?MH:function(t){};function LH({onSave:t,onRevert:e,onDownload:n}){return K.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:K.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[K.jsxs("button",{onClick:t,accessKey:"s",children:[K.jsx(px,{}),"Save"]}),K.jsxs("button",{onClick:e,accessKey:"r",children:[K.jsx(iW,{}),"Revert"]}),K.jsxs("button",{onClick:n,accessKey:"d",children:[K.jsx(nW,{}),"Download"]})]})})}const FH=({docstate:t,session:e})=>K.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[K.jsx("span",{children:t}),K.jsx("span",{children:"|"}),K.jsx("span",{children:e.reference}),K.jsx("span",{children:"|"}),K.jsx("span",{children:e.type})]});function BH(){const t=IE(),e=lt.useRef(null),[n,r]=b.useState(""),[i,o]=b.useState(""),[s,a]=b.useState(""),[c,l]=b.useState(0),[u,d]=b.useState({name:"none",contents:[],reference:"",type:""}),h=(z,Z)=>{e.current=z},[f,p]=ws();console.log(f);const m=f.editor.accessibilityMode,C=f.editor.autocompleteEnabled;SE(z=>{w.postMessage({type:"close",id:x}),c===1&&z.preventDefault()});const[g,v]=b.useState(!1),S=g?`${u.name} - Mongoose Editor`:"Mongoose Editor";DH(S);const k=b.useMemo(()=>{switch(c){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[c]),w=b.useMemo(()=>new BroadcastChannel("editor"),[]),A=new URLSearchParams(t.search),x=decodeURIComponent(A.get("reference")||"");b.useEffect(()=>{if(!x)return;console.log("ID: "+x),console.log("Sending ready message"),w.postMessage({type:"ready",id:x});const z=Z=>{switch(console.log(Z.data),Z.data.type){case"load":if(n!=="")return;const J=Z.data.session.contents.join(`
`);o(J),a(J),d(Z.data.session),l(0),r(Z.data.clientId),v(!0),setTimeout(U,100);break;case"shutdown":if(console.log("Received shutdown message"),c===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;w.close(),window.close();break;default:console.warn("Unknown message type received",Z.data.type)}};return w.addEventListener("message",z),()=>{w.removeEventListener("message",z),w.postMessage({type:"close",id:x})}},[w,n,x,c]);const T=()=>{o(s),l(0)},_=z=>{const Z=i.split(/\r\n|\r|\n/),J={...u,contents:Z};w.postMessage({type:"save",session:J,id:x}),l(2),U(),z.preventDefault()},O=z=>{z!==void 0&&(console.log("Original: "+s),console.log("New: "+z),o(z),z.split(/\r\n|\r|\n/).join(`
`)!==s?l(1):l(0),g||v(!0))},L=()=>{const z=new Blob([i],{type:"text/plain"}),Z=URL.createObjectURL(z),J=document.createElement("a"),ee=new Date,re=ee.toLocaleDateString().replace(/\//g,"-"),X=ee.toLocaleTimeString().replace(/:/g,"-"),$=`${u.name}-${re}-${X}.txt`;J.download=$,J.href=Z,J.click(),URL.revokeObjectURL(Z),J.remove()};return K.jsxs("div",{id:"editor",children:[K.jsx(LH,{onSave:_,onRevert:T,onDownload:L}),K.jsx(_H,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:O,options:{wordWrap:"on",accessibilitySupport:m?"on":"off",quickSuggestions:C},onMount:h,path:u.reference}),K.jsx(FH,{docstate:k,session:u})]});function U(){e.current!==null&&e.current.focus()}}const UH="modulepreload",VH=function(t){return"/"+t},jA={},GH=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=VH(c),c in jA)return;jA[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":UH,l||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),l)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},WH=t=>{t&&t instanceof Function&&GH(async()=>{const{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-DdRmOIVa.js");return{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{e(t),n(t),r(t),i(t),o(t)})};var ZA={};const jH=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ZH(t){if("serviceWorker"in navigator){if(new URL(ZA.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${ZA.PUBLIC_URL}/service-worker.js`;jH?(HH(n),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):VN(n)})}}function VN(t,e){navigator.serviceWorker.register(t).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."):console.log("Content is cached for offline use."))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function HH(t,e){fetch(t).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):VN(t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}const zH=ND([{path:"/",element:K.jsx(E7,{})},{path:"/editor",element:K.jsx(BH,{})}]),XH=Um.createRoot(document.getElementById("root"));XH.render(K.jsx(lt.StrictMode,{children:K.jsx(VD,{router:zH})}));WH(console.log);ZH();

var F3=Object.defineProperty;var Qx=t=>{throw TypeError(t)};var M3=(t,e,n)=>e in t?F3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var M=(t,e,n)=>M3(t,typeof e!="symbol"?e+"":e,n),og=(t,e,n)=>e.has(t)||Qx("Cannot "+n);var F=(t,e,n)=>(og(t,e,"read from private field"),n?n.call(t):e.get(t)),ct=(t,e,n)=>e.has(t)?Qx("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Oe=(t,e,n,r)=>(og(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ee=(t,e,n)=>(og(t,e,"access private method"),n);var Ff=(t,e,n,r)=>({set _(i){Oe(t,e,i,n)},get _(){return F(t,e,r)}});function vk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function L3(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Ck={exports:{}},hp={},yk={exports:{}},qe={},mf=Symbol.for("react.element"),U3=Symbol.for("react.portal"),V3=Symbol.for("react.fragment"),G3=Symbol.for("react.strict_mode"),W3=Symbol.for("react.profiler"),j3=Symbol.for("react.provider"),z3=Symbol.for("react.context"),H3=Symbol.for("react.forward_ref"),Z3=Symbol.for("react.suspense"),$3=Symbol.for("react.memo"),X3=Symbol.for("react.lazy"),eI=Symbol.iterator;function K3(t){return t===null||typeof t!="object"?null:(t=eI&&t[eI]||t["@@iterator"],typeof t=="function"?t:null)}var xk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ik=Object.assign,bk={};function nu(t,e,n){this.props=t,this.context=e,this.refs=bk,this.updater=n||xk}nu.prototype.isReactComponent={};nu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};nu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ak(){}Ak.prototype=nu.prototype;function by(t,e,n){this.props=t,this.context=e,this.refs=bk,this.updater=n||xk}var Ay=by.prototype=new Ak;Ay.constructor=by;Ik(Ay,nu.prototype);Ay.isPureReactComponent=!0;var tI=Array.isArray,wk=Object.prototype.hasOwnProperty,wy={current:null},Sk={key:!0,ref:!0,__self:!0,__source:!0};function kk(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)wk.call(e,r)&&!Sk.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:mf,type:t,key:o,ref:s,props:i,_owner:wy.current}}function J3(t,e){return{$$typeof:mf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sy(t){return typeof t=="object"&&t!==null&&t.$$typeof===mf}function Y3(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var nI=/\/+/g;function sg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Y3(""+t.key):e.toString(36)}function vh(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case mf:case U3:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+sg(s,0):r,tI(i)?(n="",t!=null&&(n=t.replace(nI,"$&/")+"/"),vh(i,e,n,"",function(c){return c})):i!=null&&(Sy(i)&&(i=J3(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(nI,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",tI(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+sg(o,a);s+=vh(o,e,n,l,i)}else if(l=K3(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+sg(o,a++),s+=vh(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Mf(t,e,n){if(t==null)return t;var r=[],i=0;return vh(t,r,"","",function(o){return e.call(n,o,i++)}),r}function q3(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gr={current:null},Ch={transition:null},Q3={ReactCurrentDispatcher:gr,ReactCurrentBatchConfig:Ch,ReactCurrentOwner:wy};function Ek(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:Mf,forEach:function(t,e,n){Mf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Mf(t,function(){e++}),e},toArray:function(t){return Mf(t,function(e){return e})||[]},only:function(t){if(!Sy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=nu;qe.Fragment=V3;qe.Profiler=W3;qe.PureComponent=by;qe.StrictMode=G3;qe.Suspense=Z3;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q3;qe.act=Ek;qe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ik({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=wy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)wk.call(e,l)&&!Sk.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:mf,type:t.type,key:i,ref:o,props:r,_owner:s}};qe.createContext=function(t){return t={$$typeof:z3,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:j3,_context:t},t.Consumer=t};qe.createElement=kk;qe.createFactory=function(t){var e=kk.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:H3,render:t}};qe.isValidElement=Sy;qe.lazy=function(t){return{$$typeof:X3,_payload:{_status:-1,_result:t},_init:q3}};qe.memo=function(t,e){return{$$typeof:$3,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=Ch.transition;Ch.transition={};try{t()}finally{Ch.transition=e}};qe.unstable_act=Ek;qe.useCallback=function(t,e){return gr.current.useCallback(t,e)};qe.useContext=function(t){return gr.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return gr.current.useDeferredValue(t)};qe.useEffect=function(t,e){return gr.current.useEffect(t,e)};qe.useId=function(){return gr.current.useId()};qe.useImperativeHandle=function(t,e,n){return gr.current.useImperativeHandle(t,e,n)};qe.useInsertionEffect=function(t,e){return gr.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return gr.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return gr.current.useMemo(t,e)};qe.useReducer=function(t,e,n){return gr.current.useReducer(t,e,n)};qe.useRef=function(t){return gr.current.useRef(t)};qe.useState=function(t){return gr.current.useState(t)};qe.useSyncExternalStore=function(t,e,n){return gr.current.useSyncExternalStore(t,e,n)};qe.useTransition=function(){return gr.current.useTransition()};qe.version="18.3.1";yk.exports=qe;var S=yk.exports;const We=tu(S),eN=vk({__proto__:null,default:We},[S]);var tN=S,nN=Symbol.for("react.element"),rN=Symbol.for("react.fragment"),iN=Object.prototype.hasOwnProperty,oN=tN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sN={key:!0,ref:!0,__self:!0,__source:!0};function Tk(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)iN.call(e,r)&&!sN.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:nN,type:t,key:o,ref:s,props:i,_owner:oN.current}}hp.Fragment=rN;hp.jsx=Tk;hp.jsxs=Tk;Ck.exports=hp;var z=Ck.exports,iv={},Rk={exports:{}},ni={},_k={exports:{}},Dk={};(function(t){function e($,Q){var ne=$.length;$.push(Q);e:for(;0<ne;){var O=ne-1>>>1,j=$[O];if(0<i(j,Q))$[O]=Q,$[ne]=j,ne=O;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var Q=$[0],ne=$.pop();if(ne!==Q){$[0]=ne;e:for(var O=0,j=$.length,J=j>>>1;O<J;){var ee=2*(O+1)-1,se=$[ee],me=ee+1,Be=$[me];if(0>i(se,ne))me<j&&0>i(Be,se)?($[O]=Be,$[me]=ne,O=me):($[O]=se,$[ee]=ne,O=ee);else if(me<j&&0>i(Be,ne))$[O]=Be,$[me]=ne,O=me;else break e}}return Q}function i($,Q){var ne=$.sortIndex-Q.sortIndex;return ne!==0?ne:$.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,f=3,h=!1,p=!1,g=!1,C=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y($){for(var Q=n(c);Q!==null;){if(Q.callback===null)r(c);else if(Q.startTime<=$)r(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=n(c)}}function x($){if(g=!1,y($),!p)if(n(l)!==null)p=!0,q(b);else{var Q=n(c);Q!==null&&ie(x,Q.startTime-$)}}function b($,Q){p=!1,g&&(g=!1,v(k),k=-1),h=!0;var ne=f;try{for(y(Q),d=n(l);d!==null&&(!(d.expirationTime>Q)||$&&!R());){var O=d.callback;if(typeof O=="function"){d.callback=null,f=d.priorityLevel;var j=O(d.expirationTime<=Q);Q=t.unstable_now(),typeof j=="function"?d.callback=j:d===n(l)&&r(l),y(Q)}else r(l);d=n(l)}if(d!==null)var J=!0;else{var ee=n(c);ee!==null&&ie(x,ee.startTime-Q),J=!1}return J}finally{d=null,f=ne,h=!1}}var E=!1,A=null,k=-1,D=5,T=-1;function R(){return!(t.unstable_now()-T<D)}function P(){if(A!==null){var $=t.unstable_now();T=$;var Q=!0;try{Q=A(!0,$)}finally{Q?L():(E=!1,A=null)}}else E=!1}var L;if(typeof m=="function")L=function(){m(P)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Z=G.port2;G.port1.onmessage=P,L=function(){Z.postMessage(null)}}else L=function(){C(P,0)};function q($){A=$,E||(E=!0,L())}function ie($,Q){k=C(function(){$(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,q(b))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function($){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var ne=f;f=Q;try{return $()}finally{f=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,Q){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ne=f;f=$;try{return Q()}finally{f=ne}},t.unstable_scheduleCallback=function($,Q,ne){var O=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?O+ne:O):ne=O,$){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ne+j,$={id:u++,callback:Q,priorityLevel:$,startTime:ne,expirationTime:j,sortIndex:-1},ne>O?($.sortIndex=ne,e(c,$),n(l)===null&&$===n(c)&&(g?(v(k),k=-1):g=!0,ie(x,ne-O))):($.sortIndex=j,e(l,$),p||h||(p=!0,q(b))),$},t.unstable_shouldYield=R,t.unstable_wrapCallback=function($){var Q=f;return function(){var ne=f;f=Q;try{return $.apply(this,arguments)}finally{f=ne}}}})(Dk);_k.exports=Dk;var aN=_k.exports,lN=S,ei=aN;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Pk=new Set,Td={};function Ol(t,e){Mc(t,e),Mc(t+"Capture",e)}function Mc(t,e){for(Td[t]=e,t=0;t<e.length;t++)Pk.add(e[t])}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ov=Object.prototype.hasOwnProperty,cN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rI={},iI={};function uN(t){return ov.call(iI,t)?!0:ov.call(rI,t)?!1:cN.test(t)?iI[t]=!0:(rI[t]=!0,!1)}function dN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fN(t,e,n,r){if(e===null||typeof e>"u"||dN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ln[t]=new mr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ln[e]=new mr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ln[t]=new mr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ln[t]=new mr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ln[t]=new mr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ln[t]=new mr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ln[t]=new mr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ln[t]=new mr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ln[t]=new mr(t,5,!1,t.toLowerCase(),null,!1,!1)});var ky=/[\-:]([a-z])/g;function Ey(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ky,Ey);Ln[e]=new mr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ky,Ey);Ln[e]=new mr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ky,Ey);Ln[e]=new mr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ln[t]=new mr(t,1,!1,t.toLowerCase(),null,!1,!1)});Ln.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ln[t]=new mr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ty(t,e,n,r){var i=Ln.hasOwnProperty(e)?Ln[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(fN(e,n,i,r)&&(n=null),r||i===null?uN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gs=lN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lf=Symbol.for("react.element"),nc=Symbol.for("react.portal"),rc=Symbol.for("react.fragment"),Ry=Symbol.for("react.strict_mode"),sv=Symbol.for("react.profiler"),Nk=Symbol.for("react.provider"),Bk=Symbol.for("react.context"),_y=Symbol.for("react.forward_ref"),av=Symbol.for("react.suspense"),lv=Symbol.for("react.suspense_list"),Dy=Symbol.for("react.memo"),sa=Symbol.for("react.lazy"),Ok=Symbol.for("react.offscreen"),oI=Symbol.iterator;function Au(t){return t===null||typeof t!="object"?null:(t=oI&&t[oI]||t["@@iterator"],typeof t=="function"?t:null)}var Kt=Object.assign,ag;function Xu(t){if(ag===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ag=e&&e[1]||""}return`
`+ag+t}var lg=!1;function cg(t,e){if(!t||lg)return"";lg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{lg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xu(t):""}function hN(t){switch(t.tag){case 5:return Xu(t.type);case 16:return Xu("Lazy");case 13:return Xu("Suspense");case 19:return Xu("SuspenseList");case 0:case 2:case 15:return t=cg(t.type,!1),t;case 11:return t=cg(t.type.render,!1),t;case 1:return t=cg(t.type,!0),t;default:return""}}function cv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case rc:return"Fragment";case nc:return"Portal";case sv:return"Profiler";case Ry:return"StrictMode";case av:return"Suspense";case lv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Bk:return(t.displayName||"Context")+".Consumer";case Nk:return(t._context.displayName||"Context")+".Provider";case _y:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Dy:return e=t.displayName||null,e!==null?e:cv(t.type)||"Memo";case sa:e=t._payload,t=t._init;try{return cv(t(e))}catch{}}return null}function pN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cv(e);case 8:return e===Ry?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Na(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Fk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function gN(t){var e=Fk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uf(t){t._valueTracker||(t._valueTracker=gN(t))}function Mk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Fk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function n0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function uv(t,e){var n=e.checked;return Kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function sI(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Na(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Lk(t,e){e=e.checked,e!=null&&Ty(t,"checked",e,!1)}function dv(t,e){Lk(t,e);var n=Na(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?fv(t,e.type,n):e.hasOwnProperty("defaultValue")&&fv(t,e.type,Na(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function aI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function fv(t,e,n){(e!=="number"||n0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ku=Array.isArray;function vc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Na(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function hv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return Kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(fe(92));if(Ku(n)){if(1<n.length)throw Error(fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Na(n)}}function Uk(t,e){var n=Na(e.value),r=Na(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function cI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Vk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Vk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Vf,Gk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Vf=Vf||document.createElement("div"),Vf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Vf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Rd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var cd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mN=["Webkit","ms","Moz","O"];Object.keys(cd).forEach(function(t){mN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),cd[e]=cd[t]})});function Wk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||cd.hasOwnProperty(t)&&cd[t]?(""+e).trim():e+"px"}function jk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Wk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var vN=Kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gv(t,e){if(e){if(vN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function mv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vv=null;function Py(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Cv=null,Cc=null,yc=null;function uI(t){if(t=yf(t)){if(typeof Cv!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=Cp(e),Cv(t.stateNode,t.type,e))}}function zk(t){Cc?yc?yc.push(t):yc=[t]:Cc=t}function Hk(){if(Cc){var t=Cc,e=yc;if(yc=Cc=null,uI(t),e)for(t=0;t<e.length;t++)uI(e[t])}}function Zk(t,e){return t(e)}function $k(){}var ug=!1;function Xk(t,e,n){if(ug)return t(e,n);ug=!0;try{return Zk(t,e,n)}finally{ug=!1,(Cc!==null||yc!==null)&&($k(),Hk())}}function _d(t,e){var n=t.stateNode;if(n===null)return null;var r=Cp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(fe(231,e,typeof n));return n}var yv=!1;if(Ns)try{var wu={};Object.defineProperty(wu,"passive",{get:function(){yv=!0}}),window.addEventListener("test",wu,wu),window.removeEventListener("test",wu,wu)}catch{yv=!1}function CN(t,e,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var ud=!1,r0=null,i0=!1,xv=null,yN={onError:function(t){ud=!0,r0=t}};function xN(t,e,n,r,i,o,s,a,l){ud=!1,r0=null,CN.apply(yN,arguments)}function IN(t,e,n,r,i,o,s,a,l){if(xN.apply(this,arguments),ud){if(ud){var c=r0;ud=!1,r0=null}else throw Error(fe(198));i0||(i0=!0,xv=c)}}function Fl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Kk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function dI(t){if(Fl(t)!==t)throw Error(fe(188))}function bN(t){var e=t.alternate;if(!e){if(e=Fl(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return dI(i),t;if(o===r)return dI(i),e;o=o.sibling}throw Error(fe(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(fe(189))}}if(n.alternate!==r)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?t:e}function Jk(t){return t=bN(t),t!==null?Yk(t):null}function Yk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Yk(t);if(e!==null)return e;t=t.sibling}return null}var qk=ei.unstable_scheduleCallback,fI=ei.unstable_cancelCallback,AN=ei.unstable_shouldYield,wN=ei.unstable_requestPaint,rn=ei.unstable_now,SN=ei.unstable_getCurrentPriorityLevel,Ny=ei.unstable_ImmediatePriority,Qk=ei.unstable_UserBlockingPriority,o0=ei.unstable_NormalPriority,kN=ei.unstable_LowPriority,eE=ei.unstable_IdlePriority,pp=null,Oo=null;function EN(t){if(Oo&&typeof Oo.onCommitFiberRoot=="function")try{Oo.onCommitFiberRoot(pp,t,void 0,(t.current.flags&128)===128)}catch{}}var $i=Math.clz32?Math.clz32:_N,TN=Math.log,RN=Math.LN2;function _N(t){return t>>>=0,t===0?32:31-(TN(t)/RN|0)|0}var Gf=64,Wf=4194304;function Ju(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function s0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Ju(a):(o&=s,o!==0&&(r=Ju(o)))}else s=n&~i,s!==0?r=Ju(s):o!==0&&(r=Ju(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-$i(e),i=1<<n,r|=t[n],e&=~i;return r}function DN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-$i(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=DN(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function Iv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function tE(){var t=Gf;return Gf<<=1,!(Gf&4194240)&&(Gf=64),t}function dg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function vf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$i(e),t[e]=n}function NN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-$i(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function By(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-$i(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var yt=0;function nE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var rE,Oy,iE,oE,sE,bv=!1,jf=[],Aa=null,wa=null,Sa=null,Dd=new Map,Pd=new Map,ca=[],BN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hI(t,e){switch(t){case"focusin":case"focusout":Aa=null;break;case"dragenter":case"dragleave":wa=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":Dd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pd.delete(e.pointerId)}}function Su(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=yf(e),e!==null&&Oy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ON(t,e,n,r,i){switch(e){case"focusin":return Aa=Su(Aa,t,e,n,r,i),!0;case"dragenter":return wa=Su(wa,t,e,n,r,i),!0;case"mouseover":return Sa=Su(Sa,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Dd.set(o,Su(Dd.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Pd.set(o,Su(Pd.get(o)||null,t,e,n,r,i)),!0}return!1}function aE(t){var e=ol(t.target);if(e!==null){var n=Fl(e);if(n!==null){if(e=n.tag,e===13){if(e=Kk(n),e!==null){t.blockedOn=e,sE(t.priority,function(){iE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Av(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);vv=r,n.target.dispatchEvent(r),vv=null}else return e=yf(n),e!==null&&Oy(e),t.blockedOn=n,!1;e.shift()}return!0}function pI(t,e,n){yh(t)&&n.delete(e)}function FN(){bv=!1,Aa!==null&&yh(Aa)&&(Aa=null),wa!==null&&yh(wa)&&(wa=null),Sa!==null&&yh(Sa)&&(Sa=null),Dd.forEach(pI),Pd.forEach(pI)}function ku(t,e){t.blockedOn===e&&(t.blockedOn=null,bv||(bv=!0,ei.unstable_scheduleCallback(ei.unstable_NormalPriority,FN)))}function Nd(t){function e(i){return ku(i,t)}if(0<jf.length){ku(jf[0],t);for(var n=1;n<jf.length;n++){var r=jf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Aa!==null&&ku(Aa,t),wa!==null&&ku(wa,t),Sa!==null&&ku(Sa,t),Dd.forEach(e),Pd.forEach(e),n=0;n<ca.length;n++)r=ca[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ca.length&&(n=ca[0],n.blockedOn===null);)aE(n),n.blockedOn===null&&ca.shift()}var xc=Gs.ReactCurrentBatchConfig,a0=!0;function MN(t,e,n,r){var i=yt,o=xc.transition;xc.transition=null;try{yt=1,Fy(t,e,n,r)}finally{yt=i,xc.transition=o}}function LN(t,e,n,r){var i=yt,o=xc.transition;xc.transition=null;try{yt=4,Fy(t,e,n,r)}finally{yt=i,xc.transition=o}}function Fy(t,e,n,r){if(a0){var i=Av(t,e,n,r);if(i===null)Ig(t,e,r,l0,n),hI(t,r);else if(ON(i,t,e,n,r))r.stopPropagation();else if(hI(t,r),e&4&&-1<BN.indexOf(t)){for(;i!==null;){var o=yf(i);if(o!==null&&rE(o),o=Av(t,e,n,r),o===null&&Ig(t,e,r,l0,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Ig(t,e,r,null,n)}}var l0=null;function Av(t,e,n,r){if(l0=null,t=Py(r),t=ol(t),t!==null)if(e=Fl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Kk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return l0=t,null}function lE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(SN()){case Ny:return 1;case Qk:return 4;case o0:case kN:return 16;case eE:return 536870912;default:return 16}default:return 16}}var fa=null,My=null,xh=null;function cE(){if(xh)return xh;var t,e=My,n=e.length,r,i="value"in fa?fa.value:fa.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return xh=i.slice(t,1<r?1-r:void 0)}function Ih(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zf(){return!0}function gI(){return!1}function ri(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?zf:gI,this.isPropagationStopped=gI,this}return Kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zf)},persist:function(){},isPersistent:zf}),e}var ru={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ly=ri(ru),Cf=Kt({},ru,{view:0,detail:0}),UN=ri(Cf),fg,hg,Eu,gp=Kt({},Cf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Eu&&(Eu&&t.type==="mousemove"?(fg=t.screenX-Eu.screenX,hg=t.screenY-Eu.screenY):hg=fg=0,Eu=t),fg)},movementY:function(t){return"movementY"in t?t.movementY:hg}}),mI=ri(gp),VN=Kt({},gp,{dataTransfer:0}),GN=ri(VN),WN=Kt({},Cf,{relatedTarget:0}),pg=ri(WN),jN=Kt({},ru,{animationName:0,elapsedTime:0,pseudoElement:0}),zN=ri(jN),HN=Kt({},ru,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ZN=ri(HN),$N=Kt({},ru,{data:0}),vI=ri($N),XN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},JN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function YN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=JN[t])?!!e[t]:!1}function Uy(){return YN}var qN=Kt({},Cf,{key:function(t){if(t.key){var e=XN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ih(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?KN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uy,charCode:function(t){return t.type==="keypress"?Ih(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ih(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),QN=ri(qN),eB=Kt({},gp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),CI=ri(eB),tB=Kt({},Cf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uy}),nB=ri(tB),rB=Kt({},ru,{propertyName:0,elapsedTime:0,pseudoElement:0}),iB=ri(rB),oB=Kt({},gp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sB=ri(oB),aB=[9,13,27,32],Vy=Ns&&"CompositionEvent"in window,dd=null;Ns&&"documentMode"in document&&(dd=document.documentMode);var lB=Ns&&"TextEvent"in window&&!dd,uE=Ns&&(!Vy||dd&&8<dd&&11>=dd),yI=" ",xI=!1;function dE(t,e){switch(t){case"keyup":return aB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ic=!1;function cB(t,e){switch(t){case"compositionend":return fE(e);case"keypress":return e.which!==32?null:(xI=!0,yI);case"textInput":return t=e.data,t===yI&&xI?null:t;default:return null}}function uB(t,e){if(ic)return t==="compositionend"||!Vy&&dE(t,e)?(t=cE(),xh=My=fa=null,ic=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uE&&e.locale!=="ko"?null:e.data;default:return null}}var dB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function II(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dB[t.type]:e==="textarea"}function hE(t,e,n,r){zk(r),e=c0(e,"onChange"),0<e.length&&(n=new Ly("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var fd=null,Bd=null;function fB(t){wE(t,0)}function mp(t){var e=ac(t);if(Mk(e))return t}function hB(t,e){if(t==="change")return e}var pE=!1;if(Ns){var gg;if(Ns){var mg="oninput"in document;if(!mg){var bI=document.createElement("div");bI.setAttribute("oninput","return;"),mg=typeof bI.oninput=="function"}gg=mg}else gg=!1;pE=gg&&(!document.documentMode||9<document.documentMode)}function AI(){fd&&(fd.detachEvent("onpropertychange",gE),Bd=fd=null)}function gE(t){if(t.propertyName==="value"&&mp(Bd)){var e=[];hE(e,Bd,t,Py(t)),Xk(fB,e)}}function pB(t,e,n){t==="focusin"?(AI(),fd=e,Bd=n,fd.attachEvent("onpropertychange",gE)):t==="focusout"&&AI()}function gB(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mp(Bd)}function mB(t,e){if(t==="click")return mp(e)}function vB(t,e){if(t==="input"||t==="change")return mp(e)}function CB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ji=typeof Object.is=="function"?Object.is:CB;function Od(t,e){if(Ji(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ov.call(e,i)||!Ji(t[i],e[i]))return!1}return!0}function wI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function SI(t,e){var n=wI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wI(n)}}function mE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vE(){for(var t=window,e=n0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=n0(t.document)}return e}function Gy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function yB(t){var e=vE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&mE(n.ownerDocument.documentElement,n)){if(r!==null&&Gy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=SI(n,o);var s=SI(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var xB=Ns&&"documentMode"in document&&11>=document.documentMode,oc=null,wv=null,hd=null,Sv=!1;function kI(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Sv||oc==null||oc!==n0(r)||(r=oc,"selectionStart"in r&&Gy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hd&&Od(hd,r)||(hd=r,r=c0(wv,"onSelect"),0<r.length&&(e=new Ly("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=oc)))}function Hf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var sc={animationend:Hf("Animation","AnimationEnd"),animationiteration:Hf("Animation","AnimationIteration"),animationstart:Hf("Animation","AnimationStart"),transitionend:Hf("Transition","TransitionEnd")},vg={},CE={};Ns&&(CE=document.createElement("div").style,"AnimationEvent"in window||(delete sc.animationend.animation,delete sc.animationiteration.animation,delete sc.animationstart.animation),"TransitionEvent"in window||delete sc.transitionend.transition);function vp(t){if(vg[t])return vg[t];if(!sc[t])return t;var e=sc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in CE)return vg[t]=e[n];return t}var yE=vp("animationend"),xE=vp("animationiteration"),IE=vp("animationstart"),bE=vp("transitionend"),AE=new Map,EI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function La(t,e){AE.set(t,e),Ol(e,[t])}for(var Cg=0;Cg<EI.length;Cg++){var yg=EI[Cg],IB=yg.toLowerCase(),bB=yg[0].toUpperCase()+yg.slice(1);La(IB,"on"+bB)}La(yE,"onAnimationEnd");La(xE,"onAnimationIteration");La(IE,"onAnimationStart");La("dblclick","onDoubleClick");La("focusin","onFocus");La("focusout","onBlur");La(bE,"onTransitionEnd");Mc("onMouseEnter",["mouseout","mouseover"]);Mc("onMouseLeave",["mouseout","mouseover"]);Mc("onPointerEnter",["pointerout","pointerover"]);Mc("onPointerLeave",["pointerout","pointerover"]);Ol("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ol("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ol("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ol("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ol("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ol("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AB=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yu));function TI(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,IN(r,e,void 0,t),t.currentTarget=null}function wE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;TI(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;TI(i,a,c),o=l}}}if(i0)throw t=xv,i0=!1,xv=null,t}function Nt(t,e){var n=e[_v];n===void 0&&(n=e[_v]=new Set);var r=t+"__bubble";n.has(r)||(SE(e,t,2,!1),n.add(r))}function xg(t,e,n){var r=0;e&&(r|=4),SE(n,t,r,e)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function Fd(t){if(!t[Zf]){t[Zf]=!0,Pk.forEach(function(n){n!=="selectionchange"&&(AB.has(n)||xg(n,!1,t),xg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zf]||(e[Zf]=!0,xg("selectionchange",!1,e))}}function SE(t,e,n,r){switch(lE(e)){case 1:var i=MN;break;case 4:i=LN;break;default:i=Fy}n=i.bind(null,e,n,t),i=void 0,!yv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ig(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=ol(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}Xk(function(){var c=o,u=Py(n),d=[];e:{var f=AE.get(t);if(f!==void 0){var h=Ly,p=t;switch(t){case"keypress":if(Ih(n)===0)break e;case"keydown":case"keyup":h=QN;break;case"focusin":p="focus",h=pg;break;case"focusout":p="blur",h=pg;break;case"beforeblur":case"afterblur":h=pg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=mI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=GN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=nB;break;case yE:case xE:case IE:h=zN;break;case bE:h=iB;break;case"scroll":h=UN;break;case"wheel":h=sB;break;case"copy":case"cut":case"paste":h=ZN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=CI}var g=(e&4)!==0,C=!g&&t==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var m=c,y;m!==null;){y=m;var x=y.stateNode;if(y.tag===5&&x!==null&&(y=x,v!==null&&(x=_d(m,v),x!=null&&g.push(Md(m,x,y)))),C)break;m=m.return}0<g.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==vv&&(p=n.relatedTarget||n.fromElement)&&(ol(p)||p[Bs]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=c,p=p?ol(p):null,p!==null&&(C=Fl(p),p!==C||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(g=mI,x="onMouseLeave",v="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(g=CI,x="onPointerLeave",v="onPointerEnter",m="pointer"),C=h==null?f:ac(h),y=p==null?f:ac(p),f=new g(x,m+"leave",h,n,u),f.target=C,f.relatedTarget=y,x=null,ol(u)===c&&(g=new g(v,m+"enter",p,n,u),g.target=y,g.relatedTarget=C,x=g),C=x,h&&p)t:{for(g=h,v=p,m=0,y=g;y;y=Xl(y))m++;for(y=0,x=v;x;x=Xl(x))y++;for(;0<m-y;)g=Xl(g),m--;for(;0<y-m;)v=Xl(v),y--;for(;m--;){if(g===v||v!==null&&g===v.alternate)break t;g=Xl(g),v=Xl(v)}g=null}else g=null;h!==null&&RI(d,f,h,g,!1),p!==null&&C!==null&&RI(d,C,p,g,!0)}}e:{if(f=c?ac(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=hB;else if(II(f))if(pE)b=vB;else{b=gB;var E=pB}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=mB);if(b&&(b=b(t,c))){hE(d,b,n,u);break e}E&&E(t,f,c),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&fv(f,"number",f.value)}switch(E=c?ac(c):window,t){case"focusin":(II(E)||E.contentEditable==="true")&&(oc=E,wv=c,hd=null);break;case"focusout":hd=wv=oc=null;break;case"mousedown":Sv=!0;break;case"contextmenu":case"mouseup":case"dragend":Sv=!1,kI(d,n,u);break;case"selectionchange":if(xB)break;case"keydown":case"keyup":kI(d,n,u)}var A;if(Vy)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else ic?dE(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(uE&&n.locale!=="ko"&&(ic||k!=="onCompositionStart"?k==="onCompositionEnd"&&ic&&(A=cE()):(fa=u,My="value"in fa?fa.value:fa.textContent,ic=!0)),E=c0(c,k),0<E.length&&(k=new vI(k,t,null,n,u),d.push({event:k,listeners:E}),A?k.data=A:(A=fE(n),A!==null&&(k.data=A)))),(A=lB?cB(t,n):uB(t,n))&&(c=c0(c,"onBeforeInput"),0<c.length&&(u=new vI("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=A))}wE(d,e)})}function Md(t,e,n){return{instance:t,listener:e,currentTarget:n}}function c0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=_d(t,n),o!=null&&r.unshift(Md(t,o,i)),o=_d(t,e),o!=null&&r.push(Md(t,o,i))),t=t.return}return r}function Xl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function RI(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=_d(n,o),l!=null&&s.unshift(Md(n,l,a))):i||(l=_d(n,o),l!=null&&s.push(Md(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var wB=/\r\n?/g,SB=/\u0000|\uFFFD/g;function _I(t){return(typeof t=="string"?t:""+t).replace(wB,`
`).replace(SB,"")}function $f(t,e,n){if(e=_I(e),_I(t)!==e&&n)throw Error(fe(425))}function u0(){}var kv=null,Ev=null;function Tv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Rv=typeof setTimeout=="function"?setTimeout:void 0,kB=typeof clearTimeout=="function"?clearTimeout:void 0,DI=typeof Promise=="function"?Promise:void 0,EB=typeof queueMicrotask=="function"?queueMicrotask:typeof DI<"u"?function(t){return DI.resolve(null).then(t).catch(TB)}:Rv;function TB(t){setTimeout(function(){throw t})}function bg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Nd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Nd(e)}function ka(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function PI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var iu=Math.random().toString(36).slice(2),go="__reactFiber$"+iu,Ld="__reactProps$"+iu,Bs="__reactContainer$"+iu,_v="__reactEvents$"+iu,RB="__reactListeners$"+iu,_B="__reactHandles$"+iu;function ol(t){var e=t[go];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Bs]||n[go]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=PI(t);t!==null;){if(n=t[go])return n;t=PI(t)}return e}t=n,n=t.parentNode}return null}function yf(t){return t=t[go]||t[Bs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ac(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function Cp(t){return t[Ld]||null}var Dv=[],lc=-1;function Ua(t){return{current:t}}function Lt(t){0>lc||(t.current=Dv[lc],Dv[lc]=null,lc--)}function _t(t,e){lc++,Dv[lc]=t.current,t.current=e}var Ba={},qn=Ua(Ba),Rr=Ua(!1),xl=Ba;function Lc(t,e){var n=t.type.contextTypes;if(!n)return Ba;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function _r(t){return t=t.childContextTypes,t!=null}function d0(){Lt(Rr),Lt(qn)}function NI(t,e,n){if(qn.current!==Ba)throw Error(fe(168));_t(qn,e),_t(Rr,n)}function kE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(fe(108,pN(t)||"Unknown",i));return Kt({},n,r)}function f0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ba,xl=qn.current,_t(qn,t),_t(Rr,Rr.current),!0}function BI(t,e,n){var r=t.stateNode;if(!r)throw Error(fe(169));n?(t=kE(t,e,xl),r.__reactInternalMemoizedMergedChildContext=t,Lt(Rr),Lt(qn),_t(qn,t)):Lt(Rr),_t(Rr,n)}var qo=null,yp=!1,Ag=!1;function EE(t){qo===null?qo=[t]:qo.push(t)}function DB(t){yp=!0,EE(t)}function Va(){if(!Ag&&qo!==null){Ag=!0;var t=0,e=yt;try{var n=qo;for(yt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}qo=null,yp=!1}catch(i){throw qo!==null&&(qo=qo.slice(t+1)),qk(Ny,Va),i}finally{yt=e,Ag=!1}}return null}var cc=[],uc=0,h0=null,p0=0,ci=[],ui=0,Il=null,rs=1,is="";function Ja(t,e){cc[uc++]=p0,cc[uc++]=h0,h0=t,p0=e}function TE(t,e,n){ci[ui++]=rs,ci[ui++]=is,ci[ui++]=Il,Il=t;var r=rs;t=is;var i=32-$i(r)-1;r&=~(1<<i),n+=1;var o=32-$i(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,rs=1<<32-$i(e)+i|n<<i|r,is=o+t}else rs=1<<o|n<<i|r,is=t}function Wy(t){t.return!==null&&(Ja(t,1),TE(t,1,0))}function jy(t){for(;t===h0;)h0=cc[--uc],cc[uc]=null,p0=cc[--uc],cc[uc]=null;for(;t===Il;)Il=ci[--ui],ci[ui]=null,is=ci[--ui],ci[ui]=null,rs=ci[--ui],ci[ui]=null}var qr=null,Jr=null,Zt=!1,Ui=null;function RE(t,e){var n=fi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function OI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,qr=t,Jr=ka(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,qr=t,Jr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Il!==null?{id:rs,overflow:is}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,qr=t,Jr=null,!0):!1;default:return!1}}function Pv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Nv(t){if(Zt){var e=Jr;if(e){var n=e;if(!OI(t,e)){if(Pv(t))throw Error(fe(418));e=ka(n.nextSibling);var r=qr;e&&OI(t,e)?RE(r,n):(t.flags=t.flags&-4097|2,Zt=!1,qr=t)}}else{if(Pv(t))throw Error(fe(418));t.flags=t.flags&-4097|2,Zt=!1,qr=t}}}function FI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qr=t}function Xf(t){if(t!==qr)return!1;if(!Zt)return FI(t),Zt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Tv(t.type,t.memoizedProps)),e&&(e=Jr)){if(Pv(t))throw _E(),Error(fe(418));for(;e;)RE(t,e),e=ka(e.nextSibling)}if(FI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Jr=ka(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Jr=null}}else Jr=qr?ka(t.stateNode.nextSibling):null;return!0}function _E(){for(var t=Jr;t;)t=ka(t.nextSibling)}function Uc(){Jr=qr=null,Zt=!1}function zy(t){Ui===null?Ui=[t]:Ui.push(t)}var PB=Gs.ReactCurrentBatchConfig;function Tu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var r=n.stateNode}if(!r)throw Error(fe(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,t))}return t}function Kf(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function MI(t){var e=t._init;return e(t._payload)}function DE(t){function e(v,m){if(t){var y=v.deletions;y===null?(v.deletions=[m],v.flags|=16):y.push(m)}}function n(v,m){if(!t)return null;for(;m!==null;)e(v,m),m=m.sibling;return null}function r(v,m){for(v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function i(v,m){return v=_a(v,m),v.index=0,v.sibling=null,v}function o(v,m,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<m?(v.flags|=2,m):y):(v.flags|=2,m)):(v.flags|=1048576,m)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,m,y,x){return m===null||m.tag!==6?(m=_g(y,v.mode,x),m.return=v,m):(m=i(m,y),m.return=v,m)}function l(v,m,y,x){var b=y.type;return b===rc?u(v,m,y.props.children,x,y.key):m!==null&&(m.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===sa&&MI(b)===m.type)?(x=i(m,y.props),x.ref=Tu(v,m,y),x.return=v,x):(x=Th(y.type,y.key,y.props,null,v.mode,x),x.ref=Tu(v,m,y),x.return=v,x)}function c(v,m,y,x){return m===null||m.tag!==4||m.stateNode.containerInfo!==y.containerInfo||m.stateNode.implementation!==y.implementation?(m=Dg(y,v.mode,x),m.return=v,m):(m=i(m,y.children||[]),m.return=v,m)}function u(v,m,y,x,b){return m===null||m.tag!==7?(m=pl(y,v.mode,x,b),m.return=v,m):(m=i(m,y),m.return=v,m)}function d(v,m,y){if(typeof m=="string"&&m!==""||typeof m=="number")return m=_g(""+m,v.mode,y),m.return=v,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Lf:return y=Th(m.type,m.key,m.props,null,v.mode,y),y.ref=Tu(v,null,m),y.return=v,y;case nc:return m=Dg(m,v.mode,y),m.return=v,m;case sa:var x=m._init;return d(v,x(m._payload),y)}if(Ku(m)||Au(m))return m=pl(m,v.mode,y,null),m.return=v,m;Kf(v,m)}return null}function f(v,m,y,x){var b=m!==null?m.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:a(v,m,""+y,x);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Lf:return y.key===b?l(v,m,y,x):null;case nc:return y.key===b?c(v,m,y,x):null;case sa:return b=y._init,f(v,m,b(y._payload),x)}if(Ku(y)||Au(y))return b!==null?null:u(v,m,y,x,null);Kf(v,y)}return null}function h(v,m,y,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return v=v.get(y)||null,a(m,v,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Lf:return v=v.get(x.key===null?y:x.key)||null,l(m,v,x,b);case nc:return v=v.get(x.key===null?y:x.key)||null,c(m,v,x,b);case sa:var E=x._init;return h(v,m,y,E(x._payload),b)}if(Ku(x)||Au(x))return v=v.get(y)||null,u(m,v,x,b,null);Kf(m,x)}return null}function p(v,m,y,x){for(var b=null,E=null,A=m,k=m=0,D=null;A!==null&&k<y.length;k++){A.index>k?(D=A,A=null):D=A.sibling;var T=f(v,A,y[k],x);if(T===null){A===null&&(A=D);break}t&&A&&T.alternate===null&&e(v,A),m=o(T,m,k),E===null?b=T:E.sibling=T,E=T,A=D}if(k===y.length)return n(v,A),Zt&&Ja(v,k),b;if(A===null){for(;k<y.length;k++)A=d(v,y[k],x),A!==null&&(m=o(A,m,k),E===null?b=A:E.sibling=A,E=A);return Zt&&Ja(v,k),b}for(A=r(v,A);k<y.length;k++)D=h(A,v,k,y[k],x),D!==null&&(t&&D.alternate!==null&&A.delete(D.key===null?k:D.key),m=o(D,m,k),E===null?b=D:E.sibling=D,E=D);return t&&A.forEach(function(R){return e(v,R)}),Zt&&Ja(v,k),b}function g(v,m,y,x){var b=Au(y);if(typeof b!="function")throw Error(fe(150));if(y=b.call(y),y==null)throw Error(fe(151));for(var E=b=null,A=m,k=m=0,D=null,T=y.next();A!==null&&!T.done;k++,T=y.next()){A.index>k?(D=A,A=null):D=A.sibling;var R=f(v,A,T.value,x);if(R===null){A===null&&(A=D);break}t&&A&&R.alternate===null&&e(v,A),m=o(R,m,k),E===null?b=R:E.sibling=R,E=R,A=D}if(T.done)return n(v,A),Zt&&Ja(v,k),b;if(A===null){for(;!T.done;k++,T=y.next())T=d(v,T.value,x),T!==null&&(m=o(T,m,k),E===null?b=T:E.sibling=T,E=T);return Zt&&Ja(v,k),b}for(A=r(v,A);!T.done;k++,T=y.next())T=h(A,v,k,T.value,x),T!==null&&(t&&T.alternate!==null&&A.delete(T.key===null?k:T.key),m=o(T,m,k),E===null?b=T:E.sibling=T,E=T);return t&&A.forEach(function(P){return e(v,P)}),Zt&&Ja(v,k),b}function C(v,m,y,x){if(typeof y=="object"&&y!==null&&y.type===rc&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Lf:e:{for(var b=y.key,E=m;E!==null;){if(E.key===b){if(b=y.type,b===rc){if(E.tag===7){n(v,E.sibling),m=i(E,y.props.children),m.return=v,v=m;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===sa&&MI(b)===E.type){n(v,E.sibling),m=i(E,y.props),m.ref=Tu(v,E,y),m.return=v,v=m;break e}n(v,E);break}else e(v,E);E=E.sibling}y.type===rc?(m=pl(y.props.children,v.mode,x,y.key),m.return=v,v=m):(x=Th(y.type,y.key,y.props,null,v.mode,x),x.ref=Tu(v,m,y),x.return=v,v=x)}return s(v);case nc:e:{for(E=y.key;m!==null;){if(m.key===E)if(m.tag===4&&m.stateNode.containerInfo===y.containerInfo&&m.stateNode.implementation===y.implementation){n(v,m.sibling),m=i(m,y.children||[]),m.return=v,v=m;break e}else{n(v,m);break}else e(v,m);m=m.sibling}m=Dg(y,v.mode,x),m.return=v,v=m}return s(v);case sa:return E=y._init,C(v,m,E(y._payload),x)}if(Ku(y))return p(v,m,y,x);if(Au(y))return g(v,m,y,x);Kf(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,m!==null&&m.tag===6?(n(v,m.sibling),m=i(m,y),m.return=v,v=m):(n(v,m),m=_g(y,v.mode,x),m.return=v,v=m),s(v)):n(v,m)}return C}var Vc=DE(!0),PE=DE(!1),g0=Ua(null),m0=null,dc=null,Hy=null;function Zy(){Hy=dc=m0=null}function $y(t){var e=g0.current;Lt(g0),t._currentValue=e}function Bv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ic(t,e){m0=t,Hy=dc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Er=!0),t.firstContext=null)}function Ci(t){var e=t._currentValue;if(Hy!==t)if(t={context:t,memoizedValue:e,next:null},dc===null){if(m0===null)throw Error(fe(308));dc=t,m0.dependencies={lanes:0,firstContext:t}}else dc=dc.next=t;return e}var sl=null;function Xy(t){sl===null?sl=[t]:sl.push(t)}function NE(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Xy(e)):(n.next=i.next,i.next=n),e.interleaved=n,Os(t,r)}function Os(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var aa=!1;function Ky(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function BE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Rs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ea(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,dt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Os(t,n)}return i=r.interleaved,i===null?(e.next=e,Xy(r)):(e.next=i.next,i.next=e),r.interleaved=e,Os(t,n)}function bh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,By(t,n)}}function LI(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function v0(t,e,n,r){var i=t.updateQueue;aa=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(f=e,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Kt({},d,f);break e;case 2:aa=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Al|=s,t.lanes=s,t.memoizedState=d}}function UI(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(fe(191,i));i.call(r)}}}var xf={},Fo=Ua(xf),Ud=Ua(xf),Vd=Ua(xf);function al(t){if(t===xf)throw Error(fe(174));return t}function Jy(t,e){switch(_t(Vd,e),_t(Ud,t),_t(Fo,xf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pv(e,t)}Lt(Fo),_t(Fo,e)}function Gc(){Lt(Fo),Lt(Ud),Lt(Vd)}function OE(t){al(Vd.current);var e=al(Fo.current),n=pv(e,t.type);e!==n&&(_t(Ud,t),_t(Fo,n))}function Yy(t){Ud.current===t&&(Lt(Fo),Lt(Ud))}var $t=Ua(0);function C0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wg=[];function qy(){for(var t=0;t<wg.length;t++)wg[t]._workInProgressVersionPrimary=null;wg.length=0}var Ah=Gs.ReactCurrentDispatcher,Sg=Gs.ReactCurrentBatchConfig,bl=0,Xt=null,Cn=null,kn=null,y0=!1,pd=!1,Gd=0,NB=0;function Hn(){throw Error(fe(321))}function Qy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ji(t[n],e[n]))return!1;return!0}function e1(t,e,n,r,i,o){if(bl=o,Xt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ah.current=t===null||t.memoizedState===null?MB:LB,t=n(r,i),pd){o=0;do{if(pd=!1,Gd=0,25<=o)throw Error(fe(301));o+=1,kn=Cn=null,e.updateQueue=null,Ah.current=UB,t=n(r,i)}while(pd)}if(Ah.current=x0,e=Cn!==null&&Cn.next!==null,bl=0,kn=Cn=Xt=null,y0=!1,e)throw Error(fe(300));return t}function t1(){var t=Gd!==0;return Gd=0,t}function ho(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?Xt.memoizedState=kn=t:kn=kn.next=t,kn}function yi(){if(Cn===null){var t=Xt.alternate;t=t!==null?t.memoizedState:null}else t=Cn.next;var e=kn===null?Xt.memoizedState:kn.next;if(e!==null)kn=e,Cn=t;else{if(t===null)throw Error(fe(310));Cn=t,t={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},kn===null?Xt.memoizedState=kn=t:kn=kn.next=t}return kn}function Wd(t,e){return typeof e=="function"?e(t):e}function kg(t){var e=yi(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=Cn,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((bl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Xt.lanes|=u,Al|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,Ji(r,e.memoizedState)||(Er=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Xt.lanes|=o,Al|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Eg(t){var e=yi(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Ji(o,e.memoizedState)||(Er=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function FE(){}function ME(t,e){var n=Xt,r=yi(),i=e(),o=!Ji(r.memoizedState,i);if(o&&(r.memoizedState=i,Er=!0),r=r.queue,n1(VE.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||kn!==null&&kn.memoizedState.tag&1){if(n.flags|=2048,jd(9,UE.bind(null,n,r,i,e),void 0,null),Tn===null)throw Error(fe(349));bl&30||LE(n,e,i)}return i}function LE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Xt.updateQueue,e===null?(e={lastEffect:null,stores:null},Xt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function UE(t,e,n,r){e.value=n,e.getSnapshot=r,GE(e)&&WE(t)}function VE(t,e,n){return n(function(){GE(e)&&WE(t)})}function GE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ji(t,n)}catch{return!0}}function WE(t){var e=Os(t,1);e!==null&&Xi(e,t,1,-1)}function VI(t){var e=ho();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wd,lastRenderedState:t},e.queue=t,t=t.dispatch=FB.bind(null,Xt,t),[e.memoizedState,t]}function jd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Xt.updateQueue,e===null?(e={lastEffect:null,stores:null},Xt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function jE(){return yi().memoizedState}function wh(t,e,n,r){var i=ho();Xt.flags|=t,i.memoizedState=jd(1|e,n,void 0,r===void 0?null:r)}function xp(t,e,n,r){var i=yi();r=r===void 0?null:r;var o=void 0;if(Cn!==null){var s=Cn.memoizedState;if(o=s.destroy,r!==null&&Qy(r,s.deps)){i.memoizedState=jd(e,n,o,r);return}}Xt.flags|=t,i.memoizedState=jd(1|e,n,o,r)}function GI(t,e){return wh(8390656,8,t,e)}function n1(t,e){return xp(2048,8,t,e)}function zE(t,e){return xp(4,2,t,e)}function HE(t,e){return xp(4,4,t,e)}function ZE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $E(t,e,n){return n=n!=null?n.concat([t]):null,xp(4,4,ZE.bind(null,e,t),n)}function r1(){}function XE(t,e){var n=yi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function KE(t,e){var n=yi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function JE(t,e,n){return bl&21?(Ji(n,e)||(n=tE(),Xt.lanes|=n,Al|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Er=!0),t.memoizedState=n)}function BB(t,e){var n=yt;yt=n!==0&&4>n?n:4,t(!0);var r=Sg.transition;Sg.transition={};try{t(!1),e()}finally{yt=n,Sg.transition=r}}function YE(){return yi().memoizedState}function OB(t,e,n){var r=Ra(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qE(t))QE(e,n);else if(n=NE(t,e,n,r),n!==null){var i=fr();Xi(n,t,r,i),eT(n,e,r)}}function FB(t,e,n){var r=Ra(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qE(t))QE(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Ji(a,s)){var l=e.interleaved;l===null?(i.next=i,Xy(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=NE(t,e,i,r),n!==null&&(i=fr(),Xi(n,t,r,i),eT(n,e,r))}}function qE(t){var e=t.alternate;return t===Xt||e!==null&&e===Xt}function QE(t,e){pd=y0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function eT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,By(t,n)}}var x0={readContext:Ci,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},MB={readContext:Ci,useCallback:function(t,e){return ho().memoizedState=[t,e===void 0?null:e],t},useContext:Ci,useEffect:GI,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wh(4194308,4,ZE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wh(4194308,4,t,e)},useInsertionEffect:function(t,e){return wh(4,2,t,e)},useMemo:function(t,e){var n=ho();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ho();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=OB.bind(null,Xt,t),[r.memoizedState,t]},useRef:function(t){var e=ho();return t={current:t},e.memoizedState=t},useState:VI,useDebugValue:r1,useDeferredValue:function(t){return ho().memoizedState=t},useTransition:function(){var t=VI(!1),e=t[0];return t=BB.bind(null,t[1]),ho().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Xt,i=ho();if(Zt){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=e(),Tn===null)throw Error(fe(349));bl&30||LE(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,GI(VE.bind(null,r,o,t),[t]),r.flags|=2048,jd(9,UE.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=ho(),e=Tn.identifierPrefix;if(Zt){var n=is,r=rs;n=(r&~(1<<32-$i(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Gd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=NB++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},LB={readContext:Ci,useCallback:XE,useContext:Ci,useEffect:n1,useImperativeHandle:$E,useInsertionEffect:zE,useLayoutEffect:HE,useMemo:KE,useReducer:kg,useRef:jE,useState:function(){return kg(Wd)},useDebugValue:r1,useDeferredValue:function(t){var e=yi();return JE(e,Cn.memoizedState,t)},useTransition:function(){var t=kg(Wd)[0],e=yi().memoizedState;return[t,e]},useMutableSource:FE,useSyncExternalStore:ME,useId:YE,unstable_isNewReconciler:!1},UB={readContext:Ci,useCallback:XE,useContext:Ci,useEffect:n1,useImperativeHandle:$E,useInsertionEffect:zE,useLayoutEffect:HE,useMemo:KE,useReducer:Eg,useRef:jE,useState:function(){return Eg(Wd)},useDebugValue:r1,useDeferredValue:function(t){var e=yi();return Cn===null?e.memoizedState=t:JE(e,Cn.memoizedState,t)},useTransition:function(){var t=Eg(Wd)[0],e=yi().memoizedState;return[t,e]},useMutableSource:FE,useSyncExternalStore:ME,useId:YE,unstable_isNewReconciler:!1};function Ei(t,e){if(t&&t.defaultProps){e=Kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ov(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ip={isMounted:function(t){return(t=t._reactInternals)?Fl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fr(),i=Ra(t),o=Rs(r,i);o.payload=e,n!=null&&(o.callback=n),e=Ea(t,o,i),e!==null&&(Xi(e,t,i,r),bh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fr(),i=Ra(t),o=Rs(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Ea(t,o,i),e!==null&&(Xi(e,t,i,r),bh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fr(),r=Ra(t),i=Rs(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ea(t,i,r),e!==null&&(Xi(e,t,r,n),bh(e,t,r))}};function WI(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Od(n,r)||!Od(i,o):!0}function tT(t,e,n){var r=!1,i=Ba,o=e.contextType;return typeof o=="object"&&o!==null?o=Ci(o):(i=_r(e)?xl:qn.current,r=e.contextTypes,o=(r=r!=null)?Lc(t,i):Ba),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ip,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function jI(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ip.enqueueReplaceState(e,e.state,null)}function Fv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Ky(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Ci(o):(o=_r(e)?xl:qn.current,i.context=Lc(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Ov(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ip.enqueueReplaceState(i,i.state,null),v0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Wc(t,e){try{var n="",r=e;do n+=hN(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Tg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Mv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var VB=typeof WeakMap=="function"?WeakMap:Map;function nT(t,e,n){n=Rs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){b0||(b0=!0,$v=r),Mv(t,e)},n}function rT(t,e,n){n=Rs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Mv(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Mv(t,e),typeof r!="function"&&(Ta===null?Ta=new Set([this]):Ta.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function zI(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new VB;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=e5.bind(null,t,e,n),e.then(t,t))}function HI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ZI(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Rs(-1,1),e.tag=2,Ea(n,e,1))),n.lanes|=1),t)}var GB=Gs.ReactCurrentOwner,Er=!1;function ir(t,e,n,r){e.child=t===null?PE(e,null,n,r):Vc(e,t.child,n,r)}function $I(t,e,n,r,i){n=n.render;var o=e.ref;return Ic(e,i),r=e1(t,e,n,r,o,i),n=t1(),t!==null&&!Er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Fs(t,e,i)):(Zt&&n&&Wy(e),e.flags|=1,ir(t,e,r,i),e.child)}function XI(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!d1(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,iT(t,e,o,r,i)):(t=Th(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Od,n(s,r)&&t.ref===e.ref)return Fs(t,e,i)}return e.flags|=1,t=_a(o,r),t.ref=e.ref,t.return=e,e.child=t}function iT(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Od(o,r)&&t.ref===e.ref)if(Er=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Er=!0);else return e.lanes=t.lanes,Fs(t,e,i)}return Lv(t,e,n,r,i)}function oT(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(hc,Wr),Wr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(hc,Wr),Wr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,_t(hc,Wr),Wr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,_t(hc,Wr),Wr|=r;return ir(t,e,i,n),e.child}function sT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Lv(t,e,n,r,i){var o=_r(n)?xl:qn.current;return o=Lc(e,o),Ic(e,i),n=e1(t,e,n,r,o,i),r=t1(),t!==null&&!Er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Fs(t,e,i)):(Zt&&r&&Wy(e),e.flags|=1,ir(t,e,n,i),e.child)}function KI(t,e,n,r,i){if(_r(n)){var o=!0;f0(e)}else o=!1;if(Ic(e,i),e.stateNode===null)Sh(t,e),tT(e,n,r),Fv(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=Ci(c):(c=_r(n)?xl:qn.current,c=Lc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&jI(e,s,r,c),aa=!1;var f=e.memoizedState;s.state=f,v0(e,r,s,i),l=e.memoizedState,a!==r||f!==l||Rr.current||aa?(typeof u=="function"&&(Ov(e,n,u,r),l=e.memoizedState),(a=aa||WI(e,n,a,r,f,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,BE(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ei(e.type,a),s.props=c,d=e.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ci(l):(l=_r(n)?xl:qn.current,l=Lc(e,l));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||f!==l)&&jI(e,s,r,l),aa=!1,f=e.memoizedState,s.state=f,v0(e,r,s,i);var p=e.memoizedState;a!==d||f!==p||Rr.current||aa?(typeof h=="function"&&(Ov(e,n,h,r),p=e.memoizedState),(c=aa||WI(e,n,c,r,f,p,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Uv(t,e,n,r,o,i)}function Uv(t,e,n,r,i,o){sT(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&BI(e,n,!1),Fs(t,e,o);r=e.stateNode,GB.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Vc(e,t.child,null,o),e.child=Vc(e,null,a,o)):ir(t,e,a,o),e.memoizedState=r.state,i&&BI(e,n,!0),e.child}function aT(t){var e=t.stateNode;e.pendingContext?NI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&NI(t,e.context,!1),Jy(t,e.containerInfo)}function JI(t,e,n,r,i){return Uc(),zy(i),e.flags|=256,ir(t,e,n,r),e.child}var Vv={dehydrated:null,treeContext:null,retryLane:0};function Gv(t){return{baseLanes:t,cachePool:null,transitions:null}}function lT(t,e,n){var r=e.pendingProps,i=$t.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),_t($t,i&1),t===null)return Nv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=wp(s,r,0,null),t=pl(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Gv(n),e.memoizedState=Vv,t):i1(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return WB(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=_a(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=_a(a,o):(o=pl(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Gv(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Vv,r}return o=t.child,t=o.sibling,r=_a(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function i1(t,e){return e=wp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Jf(t,e,n,r){return r!==null&&zy(r),Vc(e,t.child,null,n),t=i1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function WB(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Tg(Error(fe(422))),Jf(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=wp({mode:"visible",children:r.children},i,0,null),o=pl(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Vc(e,t.child,null,s),e.child.memoizedState=Gv(s),e.memoizedState=Vv,o);if(!(e.mode&1))return Jf(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(fe(419)),r=Tg(o,r,void 0),Jf(t,e,s,r)}if(a=(s&t.childLanes)!==0,Er||a){if(r=Tn,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Os(t,i),Xi(r,t,i,-1))}return u1(),r=Tg(Error(fe(421))),Jf(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=t5.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Jr=ka(i.nextSibling),qr=e,Zt=!0,Ui=null,t!==null&&(ci[ui++]=rs,ci[ui++]=is,ci[ui++]=Il,rs=t.id,is=t.overflow,Il=e),e=i1(e,r.children),e.flags|=4096,e)}function YI(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Bv(t.return,e,n)}function Rg(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function cT(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(ir(t,e,r.children,n),r=$t.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&YI(t,n,e);else if(t.tag===19)YI(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_t($t,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&C0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Rg(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&C0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Rg(e,!0,n,null,o);break;case"together":Rg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Fs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Al|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,n=_a(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_a(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function jB(t,e,n){switch(e.tag){case 3:aT(e),Uc();break;case 5:OE(e);break;case 1:_r(e.type)&&f0(e);break;case 4:Jy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;_t(g0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_t($t,$t.current&1),e.flags|=128,null):n&e.child.childLanes?lT(t,e,n):(_t($t,$t.current&1),t=Fs(t,e,n),t!==null?t.sibling:null);_t($t,$t.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return cT(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),_t($t,$t.current),r)break;return null;case 22:case 23:return e.lanes=0,oT(t,e,n)}return Fs(t,e,n)}var uT,Wv,dT,fT;uT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Wv=function(){};dT=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,al(Fo.current);var o=null;switch(n){case"input":i=uv(t,i),r=uv(t,r),o=[];break;case"select":i=Kt({},i,{value:void 0}),r=Kt({},r,{value:void 0}),o=[];break;case"textarea":i=hv(t,i),r=hv(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=u0)}gv(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Td.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Td.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Nt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};fT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ru(t,e){if(!Zt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Zn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function zB(t,e,n){var r=e.pendingProps;switch(jy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(e),null;case 1:return _r(e.type)&&d0(),Zn(e),null;case 3:return r=e.stateNode,Gc(),Lt(Rr),Lt(qn),qy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Xf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ui!==null&&(Jv(Ui),Ui=null))),Wv(t,e),Zn(e),null;case 5:Yy(e);var i=al(Vd.current);if(n=e.type,t!==null&&e.stateNode!=null)dT(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(fe(166));return Zn(e),null}if(t=al(Fo.current),Xf(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[go]=e,r[Ld]=o,t=(e.mode&1)!==0,n){case"dialog":Nt("cancel",r),Nt("close",r);break;case"iframe":case"object":case"embed":Nt("load",r);break;case"video":case"audio":for(i=0;i<Yu.length;i++)Nt(Yu[i],r);break;case"source":Nt("error",r);break;case"img":case"image":case"link":Nt("error",r),Nt("load",r);break;case"details":Nt("toggle",r);break;case"input":sI(r,o),Nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Nt("invalid",r);break;case"textarea":lI(r,o),Nt("invalid",r)}gv(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&$f(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&$f(r.textContent,a,t),i=["children",""+a]):Td.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Nt("scroll",r)}switch(n){case"input":Uf(r),aI(r,o,!0);break;case"textarea":Uf(r),cI(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=u0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Vk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[go]=e,t[Ld]=r,uT(t,e,!1,!1),e.stateNode=t;e:{switch(s=mv(n,r),n){case"dialog":Nt("cancel",t),Nt("close",t),i=r;break;case"iframe":case"object":case"embed":Nt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Yu.length;i++)Nt(Yu[i],t);i=r;break;case"source":Nt("error",t),i=r;break;case"img":case"image":case"link":Nt("error",t),Nt("load",t),i=r;break;case"details":Nt("toggle",t),i=r;break;case"input":sI(t,r),i=uv(t,r),Nt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Kt({},r,{value:void 0}),Nt("invalid",t);break;case"textarea":lI(t,r),i=hv(t,r),Nt("invalid",t);break;default:i=r}gv(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?jk(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Gk(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Rd(t,l):typeof l=="number"&&Rd(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Td.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Nt("scroll",t):l!=null&&Ty(t,o,l,s))}switch(n){case"input":Uf(t),aI(t,r,!1);break;case"textarea":Uf(t),cI(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Na(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?vc(t,!!r.multiple,o,!1):r.defaultValue!=null&&vc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=u0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zn(e),null;case 6:if(t&&e.stateNode!=null)fT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(fe(166));if(n=al(Vd.current),al(Fo.current),Xf(e)){if(r=e.stateNode,n=e.memoizedProps,r[go]=e,(o=r.nodeValue!==n)&&(t=qr,t!==null))switch(t.tag){case 3:$f(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$f(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[go]=e,e.stateNode=r}return Zn(e),null;case 13:if(Lt($t),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Zt&&Jr!==null&&e.mode&1&&!(e.flags&128))_E(),Uc(),e.flags|=98560,o=!1;else if(o=Xf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(fe(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(fe(317));o[go]=e}else Uc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zn(e),o=!1}else Ui!==null&&(Jv(Ui),Ui=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||$t.current&1?yn===0&&(yn=3):u1())),e.updateQueue!==null&&(e.flags|=4),Zn(e),null);case 4:return Gc(),Wv(t,e),t===null&&Fd(e.stateNode.containerInfo),Zn(e),null;case 10:return $y(e.type._context),Zn(e),null;case 17:return _r(e.type)&&d0(),Zn(e),null;case 19:if(Lt($t),o=e.memoizedState,o===null)return Zn(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Ru(o,!1);else{if(yn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=C0(t),s!==null){for(e.flags|=128,Ru(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t($t,$t.current&1|2),e.child}t=t.sibling}o.tail!==null&&rn()>jc&&(e.flags|=128,r=!0,Ru(o,!1),e.lanes=4194304)}else{if(!r)if(t=C0(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ru(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Zt)return Zn(e),null}else 2*rn()-o.renderingStartTime>jc&&n!==1073741824&&(e.flags|=128,r=!0,Ru(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=rn(),e.sibling=null,n=$t.current,_t($t,r?n&1|2:n&1),e):(Zn(e),null);case 22:case 23:return c1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Wr&1073741824&&(Zn(e),e.subtreeFlags&6&&(e.flags|=8192)):Zn(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function HB(t,e){switch(jy(e),e.tag){case 1:return _r(e.type)&&d0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Gc(),Lt(Rr),Lt(qn),qy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yy(e),null;case 13:if(Lt($t),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));Uc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Lt($t),null;case 4:return Gc(),null;case 10:return $y(e.type._context),null;case 22:case 23:return c1(),null;case 24:return null;default:return null}}var Yf=!1,Xn=!1,ZB=typeof WeakSet=="function"?WeakSet:Set,we=null;function fc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qt(t,e,r)}else n.current=null}function jv(t,e,n){try{n()}catch(r){Qt(t,e,r)}}var qI=!1;function $B(t,e){if(kv=a0,t=vE(),Gy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++c===i&&(a=s),f===o&&++u===r&&(l=s),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ev={focusedElem:t,selectionRange:n},a0=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,C=p.memoizedState,v=e.stateNode,m=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:Ei(e.type,g),C);v.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(x){Qt(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return p=qI,qI=!1,p}function gd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&jv(e,n,o)}i=i.next}while(i!==r)}}function bp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function zv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function hT(t){var e=t.alternate;e!==null&&(t.alternate=null,hT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[go],delete e[Ld],delete e[_v],delete e[RB],delete e[_B])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function pT(t){return t.tag===5||t.tag===3||t.tag===4}function QI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||pT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Hv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=u0));else if(r!==4&&(t=t.child,t!==null))for(Hv(t,e,n),t=t.sibling;t!==null;)Hv(t,e,n),t=t.sibling}function Zv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Zv(t,e,n),t=t.sibling;t!==null;)Zv(t,e,n),t=t.sibling}var Dn=null,Fi=!1;function Ks(t,e,n){for(n=n.child;n!==null;)gT(t,e,n),n=n.sibling}function gT(t,e,n){if(Oo&&typeof Oo.onCommitFiberUnmount=="function")try{Oo.onCommitFiberUnmount(pp,n)}catch{}switch(n.tag){case 5:Xn||fc(n,e);case 6:var r=Dn,i=Fi;Dn=null,Ks(t,e,n),Dn=r,Fi=i,Dn!==null&&(Fi?(t=Dn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dn.removeChild(n.stateNode));break;case 18:Dn!==null&&(Fi?(t=Dn,n=n.stateNode,t.nodeType===8?bg(t.parentNode,n):t.nodeType===1&&bg(t,n),Nd(t)):bg(Dn,n.stateNode));break;case 4:r=Dn,i=Fi,Dn=n.stateNode.containerInfo,Fi=!0,Ks(t,e,n),Dn=r,Fi=i;break;case 0:case 11:case 14:case 15:if(!Xn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&jv(n,e,s),i=i.next}while(i!==r)}Ks(t,e,n);break;case 1:if(!Xn&&(fc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Qt(n,e,a)}Ks(t,e,n);break;case 21:Ks(t,e,n);break;case 22:n.mode&1?(Xn=(r=Xn)||n.memoizedState!==null,Ks(t,e,n),Xn=r):Ks(t,e,n);break;default:Ks(t,e,n)}}function eb(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ZB),e.forEach(function(r){var i=n5.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ai(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Dn=a.stateNode,Fi=!1;break e;case 3:Dn=a.stateNode.containerInfo,Fi=!0;break e;case 4:Dn=a.stateNode.containerInfo,Fi=!0;break e}a=a.return}if(Dn===null)throw Error(fe(160));gT(o,s,i),Dn=null,Fi=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Qt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mT(e,t),e=e.sibling}function mT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ai(e,t),oo(t),r&4){try{gd(3,t,t.return),bp(3,t)}catch(g){Qt(t,t.return,g)}try{gd(5,t,t.return)}catch(g){Qt(t,t.return,g)}}break;case 1:Ai(e,t),oo(t),r&512&&n!==null&&fc(n,n.return);break;case 5:if(Ai(e,t),oo(t),r&512&&n!==null&&fc(n,n.return),t.flags&32){var i=t.stateNode;try{Rd(i,"")}catch(g){Qt(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Lk(i,o),mv(a,s);var c=mv(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?jk(i,d):u==="dangerouslySetInnerHTML"?Gk(i,d):u==="children"?Rd(i,d):Ty(i,u,d,c)}switch(a){case"input":dv(i,o);break;case"textarea":Uk(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?vc(i,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?vc(i,!!o.multiple,o.defaultValue,!0):vc(i,!!o.multiple,o.multiple?[]:"",!1))}i[Ld]=o}catch(g){Qt(t,t.return,g)}}break;case 6:if(Ai(e,t),oo(t),r&4){if(t.stateNode===null)throw Error(fe(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(g){Qt(t,t.return,g)}}break;case 3:if(Ai(e,t),oo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Nd(e.containerInfo)}catch(g){Qt(t,t.return,g)}break;case 4:Ai(e,t),oo(t);break;case 13:Ai(e,t),oo(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(a1=rn())),r&4&&eb(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Xn=(c=Xn)||u,Ai(e,t),Xn=c):Ai(e,t),oo(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(we=t,u=t.child;u!==null;){for(d=we=u;we!==null;){switch(f=we,h=f.child,f.tag){case 0:case 11:case 14:case 15:gd(4,f,f.return);break;case 1:fc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Qt(r,n,g)}}break;case 5:fc(f,f.return);break;case 22:if(f.memoizedState!==null){nb(d);continue}}h!==null?(h.return=f,we=h):nb(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Wk("display",s))}catch(g){Qt(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Qt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ai(e,t),oo(t),r&4&&eb(t);break;case 21:break;default:Ai(e,t),oo(t)}}function oo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(pT(n)){var r=n;break e}n=n.return}throw Error(fe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Rd(i,""),r.flags&=-33);var o=QI(t);Zv(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=QI(t);Hv(t,a,s);break;default:throw Error(fe(161))}}catch(l){Qt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function XB(t,e,n){we=t,vT(t)}function vT(t,e,n){for(var r=(t.mode&1)!==0;we!==null;){var i=we,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Yf;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Xn;a=Yf;var c=Xn;if(Yf=s,(Xn=l)&&!c)for(we=i;we!==null;)s=we,l=s.child,s.tag===22&&s.memoizedState!==null?rb(i):l!==null?(l.return=s,we=l):rb(i);for(;o!==null;)we=o,vT(o),o=o.sibling;we=i,Yf=a,Xn=c}tb(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,we=o):tb(t)}}function tb(t){for(;we!==null;){var e=we;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xn||bp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Xn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ei(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&UI(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}UI(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Nd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}Xn||e.flags&512&&zv(e)}catch(f){Qt(e,e.return,f)}}if(e===t){we=null;break}if(n=e.sibling,n!==null){n.return=e.return,we=n;break}we=e.return}}function nb(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var n=e.sibling;if(n!==null){n.return=e.return,we=n;break}we=e.return}}function rb(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bp(4,e)}catch(l){Qt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Qt(e,i,l)}}var o=e.return;try{zv(e)}catch(l){Qt(e,o,l)}break;case 5:var s=e.return;try{zv(e)}catch(l){Qt(e,s,l)}}}catch(l){Qt(e,e.return,l)}if(e===t){we=null;break}var a=e.sibling;if(a!==null){a.return=e.return,we=a;break}we=e.return}}var KB=Math.ceil,I0=Gs.ReactCurrentDispatcher,o1=Gs.ReactCurrentOwner,vi=Gs.ReactCurrentBatchConfig,dt=0,Tn=null,dn=null,Fn=0,Wr=0,hc=Ua(0),yn=0,zd=null,Al=0,Ap=0,s1=0,md=null,Sr=null,a1=0,jc=1/0,Ko=null,b0=!1,$v=null,Ta=null,qf=!1,ha=null,A0=0,vd=0,Xv=null,kh=-1,Eh=0;function fr(){return dt&6?rn():kh!==-1?kh:kh=rn()}function Ra(t){return t.mode&1?dt&2&&Fn!==0?Fn&-Fn:PB.transition!==null?(Eh===0&&(Eh=tE()),Eh):(t=yt,t!==0||(t=window.event,t=t===void 0?16:lE(t.type)),t):1}function Xi(t,e,n,r){if(50<vd)throw vd=0,Xv=null,Error(fe(185));vf(t,n,r),(!(dt&2)||t!==Tn)&&(t===Tn&&(!(dt&2)&&(Ap|=n),yn===4&&ua(t,Fn)),Dr(t,r),n===1&&dt===0&&!(e.mode&1)&&(jc=rn()+500,yp&&Va()))}function Dr(t,e){var n=t.callbackNode;PN(t,e);var r=s0(t,t===Tn?Fn:0);if(r===0)n!==null&&fI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&fI(n),e===1)t.tag===0?DB(ib.bind(null,t)):EE(ib.bind(null,t)),EB(function(){!(dt&6)&&Va()}),n=null;else{switch(nE(r)){case 1:n=Ny;break;case 4:n=Qk;break;case 16:n=o0;break;case 536870912:n=eE;break;default:n=o0}n=ST(n,CT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function CT(t,e){if(kh=-1,Eh=0,dt&6)throw Error(fe(327));var n=t.callbackNode;if(bc()&&t.callbackNode!==n)return null;var r=s0(t,t===Tn?Fn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=w0(t,r);else{e=r;var i=dt;dt|=2;var o=xT();(Tn!==t||Fn!==e)&&(Ko=null,jc=rn()+500,hl(t,e));do try{qB();break}catch(a){yT(t,a)}while(!0);Zy(),I0.current=o,dt=i,dn!==null?e=0:(Tn=null,Fn=0,e=yn)}if(e!==0){if(e===2&&(i=Iv(t),i!==0&&(r=i,e=Kv(t,i))),e===1)throw n=zd,hl(t,0),ua(t,r),Dr(t,rn()),n;if(e===6)ua(t,r);else{if(i=t.current.alternate,!(r&30)&&!JB(i)&&(e=w0(t,r),e===2&&(o=Iv(t),o!==0&&(r=o,e=Kv(t,o))),e===1))throw n=zd,hl(t,0),ua(t,r),Dr(t,rn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(fe(345));case 2:Ya(t,Sr,Ko);break;case 3:if(ua(t,r),(r&130023424)===r&&(e=a1+500-rn(),10<e)){if(s0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){fr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Rv(Ya.bind(null,t,Sr,Ko),e);break}Ya(t,Sr,Ko);break;case 4:if(ua(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-$i(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=rn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*KB(r/1960))-r,10<r){t.timeoutHandle=Rv(Ya.bind(null,t,Sr,Ko),r);break}Ya(t,Sr,Ko);break;case 5:Ya(t,Sr,Ko);break;default:throw Error(fe(329))}}}return Dr(t,rn()),t.callbackNode===n?CT.bind(null,t):null}function Kv(t,e){var n=md;return t.current.memoizedState.isDehydrated&&(hl(t,e).flags|=256),t=w0(t,e),t!==2&&(e=Sr,Sr=n,e!==null&&Jv(e)),t}function Jv(t){Sr===null?Sr=t:Sr.push.apply(Sr,t)}function JB(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ji(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ua(t,e){for(e&=~s1,e&=~Ap,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-$i(e),r=1<<n;t[n]=-1,e&=~r}}function ib(t){if(dt&6)throw Error(fe(327));bc();var e=s0(t,0);if(!(e&1))return Dr(t,rn()),null;var n=w0(t,e);if(t.tag!==0&&n===2){var r=Iv(t);r!==0&&(e=r,n=Kv(t,r))}if(n===1)throw n=zd,hl(t,0),ua(t,e),Dr(t,rn()),n;if(n===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ya(t,Sr,Ko),Dr(t,rn()),null}function l1(t,e){var n=dt;dt|=1;try{return t(e)}finally{dt=n,dt===0&&(jc=rn()+500,yp&&Va())}}function wl(t){ha!==null&&ha.tag===0&&!(dt&6)&&bc();var e=dt;dt|=1;var n=vi.transition,r=yt;try{if(vi.transition=null,yt=1,t)return t()}finally{yt=r,vi.transition=n,dt=e,!(dt&6)&&Va()}}function c1(){Wr=hc.current,Lt(hc)}function hl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kB(n)),dn!==null)for(n=dn.return;n!==null;){var r=n;switch(jy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&d0();break;case 3:Gc(),Lt(Rr),Lt(qn),qy();break;case 5:Yy(r);break;case 4:Gc();break;case 13:Lt($t);break;case 19:Lt($t);break;case 10:$y(r.type._context);break;case 22:case 23:c1()}n=n.return}if(Tn=t,dn=t=_a(t.current,null),Fn=Wr=e,yn=0,zd=null,s1=Ap=Al=0,Sr=md=null,sl!==null){for(e=0;e<sl.length;e++)if(n=sl[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}sl=null}return t}function yT(t,e){do{var n=dn;try{if(Zy(),Ah.current=x0,y0){for(var r=Xt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}y0=!1}if(bl=0,kn=Cn=Xt=null,pd=!1,Gd=0,o1.current=null,n===null||n.return===null){yn=1,zd=e,dn=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=Fn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=HI(s);if(h!==null){h.flags&=-257,ZI(h,s,a,o,e),h.mode&1&&zI(o,c,e),e=h,l=c;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){zI(o,c,e),u1();break e}l=Error(fe(426))}}else if(Zt&&a.mode&1){var C=HI(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),ZI(C,s,a,o,e),zy(Wc(l,a));break e}}o=l=Wc(l,a),yn!==4&&(yn=2),md===null?md=[o]:md.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=nT(o,l,e);LI(o,v);break e;case 1:a=l;var m=o.type,y=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ta===null||!Ta.has(y)))){o.flags|=65536,e&=-e,o.lanes|=e;var x=rT(o,a,e);LI(o,x);break e}}o=o.return}while(o!==null)}bT(n)}catch(b){e=b,dn===n&&n!==null&&(dn=n=n.return);continue}break}while(!0)}function xT(){var t=I0.current;return I0.current=x0,t===null?x0:t}function u1(){(yn===0||yn===3||yn===2)&&(yn=4),Tn===null||!(Al&268435455)&&!(Ap&268435455)||ua(Tn,Fn)}function w0(t,e){var n=dt;dt|=2;var r=xT();(Tn!==t||Fn!==e)&&(Ko=null,hl(t,e));do try{YB();break}catch(i){yT(t,i)}while(!0);if(Zy(),dt=n,I0.current=r,dn!==null)throw Error(fe(261));return Tn=null,Fn=0,yn}function YB(){for(;dn!==null;)IT(dn)}function qB(){for(;dn!==null&&!AN();)IT(dn)}function IT(t){var e=wT(t.alternate,t,Wr);t.memoizedProps=t.pendingProps,e===null?bT(t):dn=e,o1.current=null}function bT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HB(n,e),n!==null){n.flags&=32767,dn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yn=6,dn=null;return}}else if(n=zB(n,e,Wr),n!==null){dn=n;return}if(e=e.sibling,e!==null){dn=e;return}dn=e=t}while(e!==null);yn===0&&(yn=5)}function Ya(t,e,n){var r=yt,i=vi.transition;try{vi.transition=null,yt=1,QB(t,e,n,r)}finally{vi.transition=i,yt=r}return null}function QB(t,e,n,r){do bc();while(ha!==null);if(dt&6)throw Error(fe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(NN(t,o),t===Tn&&(dn=Tn=null,Fn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qf||(qf=!0,ST(o0,function(){return bc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=vi.transition,vi.transition=null;var s=yt;yt=1;var a=dt;dt|=4,o1.current=null,$B(t,n),mT(n,t),yB(Ev),a0=!!kv,Ev=kv=null,t.current=n,XB(n),wN(),dt=a,yt=s,vi.transition=o}else t.current=n;if(qf&&(qf=!1,ha=t,A0=i),o=t.pendingLanes,o===0&&(Ta=null),EN(n.stateNode),Dr(t,rn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(b0)throw b0=!1,t=$v,$v=null,t;return A0&1&&t.tag!==0&&bc(),o=t.pendingLanes,o&1?t===Xv?vd++:(vd=0,Xv=t):vd=0,Va(),null}function bc(){if(ha!==null){var t=nE(A0),e=vi.transition,n=yt;try{if(vi.transition=null,yt=16>t?16:t,ha===null)var r=!1;else{if(t=ha,ha=null,A0=0,dt&6)throw Error(fe(331));var i=dt;for(dt|=4,we=t.current;we!==null;){var o=we,s=o.child;if(we.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(we=c;we!==null;){var u=we;switch(u.tag){case 0:case 11:case 15:gd(8,u,o)}var d=u.child;if(d!==null)d.return=u,we=d;else for(;we!==null;){u=we;var f=u.sibling,h=u.return;if(hT(u),u===c){we=null;break}if(f!==null){f.return=h,we=f;break}we=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var C=g.sibling;g.sibling=null,g=C}while(g!==null)}}we=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,we=s;else e:for(;we!==null;){if(o=we,o.flags&2048)switch(o.tag){case 0:case 11:case 15:gd(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,we=v;break e}we=o.return}}var m=t.current;for(we=m;we!==null;){s=we;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,we=y;else e:for(s=m;we!==null;){if(a=we,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bp(9,a)}}catch(b){Qt(a,a.return,b)}if(a===s){we=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,we=x;break e}we=a.return}}if(dt=i,Va(),Oo&&typeof Oo.onPostCommitFiberRoot=="function")try{Oo.onPostCommitFiberRoot(pp,t)}catch{}r=!0}return r}finally{yt=n,vi.transition=e}}return!1}function ob(t,e,n){e=Wc(n,e),e=nT(t,e,1),t=Ea(t,e,1),e=fr(),t!==null&&(vf(t,1,e),Dr(t,e))}function Qt(t,e,n){if(t.tag===3)ob(t,t,n);else for(;e!==null;){if(e.tag===3){ob(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ta===null||!Ta.has(r))){t=Wc(n,t),t=rT(e,t,1),e=Ea(e,t,1),t=fr(),e!==null&&(vf(e,1,t),Dr(e,t));break}}e=e.return}}function e5(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fr(),t.pingedLanes|=t.suspendedLanes&n,Tn===t&&(Fn&n)===n&&(yn===4||yn===3&&(Fn&130023424)===Fn&&500>rn()-a1?hl(t,0):s1|=n),Dr(t,e)}function AT(t,e){e===0&&(t.mode&1?(e=Wf,Wf<<=1,!(Wf&130023424)&&(Wf=4194304)):e=1);var n=fr();t=Os(t,e),t!==null&&(vf(t,e,n),Dr(t,n))}function t5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),AT(t,n)}function n5(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(fe(314))}r!==null&&r.delete(e),AT(t,n)}var wT;wT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rr.current)Er=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Er=!1,jB(t,e,n);Er=!!(t.flags&131072)}else Er=!1,Zt&&e.flags&1048576&&TE(e,p0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Sh(t,e),t=e.pendingProps;var i=Lc(e,qn.current);Ic(e,n),i=e1(null,e,r,t,i,n);var o=t1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_r(r)?(o=!0,f0(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ky(e),i.updater=Ip,e.stateNode=i,i._reactInternals=e,Fv(e,r,t,n),e=Uv(null,e,r,!0,o,n)):(e.tag=0,Zt&&o&&Wy(e),ir(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Sh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=i5(r),t=Ei(r,t),i){case 0:e=Lv(null,e,r,t,n);break e;case 1:e=KI(null,e,r,t,n);break e;case 11:e=$I(null,e,r,t,n);break e;case 14:e=XI(null,e,r,Ei(r.type,t),n);break e}throw Error(fe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ei(r,i),Lv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ei(r,i),KI(t,e,r,i,n);case 3:e:{if(aT(e),t===null)throw Error(fe(387));r=e.pendingProps,o=e.memoizedState,i=o.element,BE(t,e),v0(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Wc(Error(fe(423)),e),e=JI(t,e,r,n,i);break e}else if(r!==i){i=Wc(Error(fe(424)),e),e=JI(t,e,r,n,i);break e}else for(Jr=ka(e.stateNode.containerInfo.firstChild),qr=e,Zt=!0,Ui=null,n=PE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Uc(),r===i){e=Fs(t,e,n);break e}ir(t,e,r,n)}e=e.child}return e;case 5:return OE(e),t===null&&Nv(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Tv(r,i)?s=null:o!==null&&Tv(r,o)&&(e.flags|=32),sT(t,e),ir(t,e,s,n),e.child;case 6:return t===null&&Nv(e),null;case 13:return lT(t,e,n);case 4:return Jy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Vc(e,null,r,n):ir(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ei(r,i),$I(t,e,r,i,n);case 7:return ir(t,e,e.pendingProps,n),e.child;case 8:return ir(t,e,e.pendingProps.children,n),e.child;case 12:return ir(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,_t(g0,r._currentValue),r._currentValue=s,o!==null)if(Ji(o.value,s)){if(o.children===i.children&&!Rr.current){e=Fs(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=Rs(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Bv(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(fe(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Bv(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}ir(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ic(e,n),i=Ci(i),r=r(i),e.flags|=1,ir(t,e,r,n),e.child;case 14:return r=e.type,i=Ei(r,e.pendingProps),i=Ei(r.type,i),XI(t,e,r,i,n);case 15:return iT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ei(r,i),Sh(t,e),e.tag=1,_r(r)?(t=!0,f0(e)):t=!1,Ic(e,n),tT(e,r,i),Fv(e,r,i,n),Uv(null,e,r,!0,t,n);case 19:return cT(t,e,n);case 22:return oT(t,e,n)}throw Error(fe(156,e.tag))};function ST(t,e){return qk(t,e)}function r5(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(t,e,n,r){return new r5(t,e,n,r)}function d1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function i5(t){if(typeof t=="function")return d1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_y)return 11;if(t===Dy)return 14}return 2}function _a(t,e){var n=t.alternate;return n===null?(n=fi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Th(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")d1(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case rc:return pl(n.children,i,o,e);case Ry:s=8,i|=8;break;case sv:return t=fi(12,n,e,i|2),t.elementType=sv,t.lanes=o,t;case av:return t=fi(13,n,e,i),t.elementType=av,t.lanes=o,t;case lv:return t=fi(19,n,e,i),t.elementType=lv,t.lanes=o,t;case Ok:return wp(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Nk:s=10;break e;case Bk:s=9;break e;case _y:s=11;break e;case Dy:s=14;break e;case sa:s=16,r=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=fi(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function pl(t,e,n,r){return t=fi(7,t,r,e),t.lanes=n,t}function wp(t,e,n,r){return t=fi(22,t,r,e),t.elementType=Ok,t.lanes=n,t.stateNode={isHidden:!1},t}function _g(t,e,n){return t=fi(6,t,null,e),t.lanes=n,t}function Dg(t,e,n){return e=fi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function o5(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dg(0),this.expirationTimes=dg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function f1(t,e,n,r,i,o,s,a,l){return t=new o5(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=fi(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ky(o),t}function s5(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function kT(t){if(!t)return Ba;t=t._reactInternals;e:{if(Fl(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_r(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var n=t.type;if(_r(n))return kE(t,n,e)}return e}function ET(t,e,n,r,i,o,s,a,l){return t=f1(n,r,!0,t,i,o,s,a,l),t.context=kT(null),n=t.current,r=fr(),i=Ra(n),o=Rs(r,i),o.callback=e??null,Ea(n,o,i),t.current.lanes=i,vf(t,i,r),Dr(t,r),t}function Sp(t,e,n,r){var i=e.current,o=fr(),s=Ra(i);return n=kT(n),e.context===null?e.context=n:e.pendingContext=n,e=Rs(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ea(i,e,s),t!==null&&(Xi(t,i,s,o),bh(t,i,s)),s}function S0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function h1(t,e){sb(t,e),(t=t.alternate)&&sb(t,e)}function a5(){return null}var TT=typeof reportError=="function"?reportError:function(t){console.error(t)};function p1(t){this._internalRoot=t}kp.prototype.render=p1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));Sp(t,e,null,null)};kp.prototype.unmount=p1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wl(function(){Sp(null,t,null,null)}),e[Bs]=null}};function kp(t){this._internalRoot=t}kp.prototype.unstable_scheduleHydration=function(t){if(t){var e=oE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ca.length&&e!==0&&e<ca[n].priority;n++);ca.splice(n,0,t),n===0&&aE(t)}};function g1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ep(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ab(){}function l5(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=S0(s);o.call(c)}}var s=ET(e,r,t,0,null,!1,!1,"",ab);return t._reactRootContainer=s,t[Bs]=s.current,Fd(t.nodeType===8?t.parentNode:t),wl(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=S0(l);a.call(c)}}var l=f1(t,0,!1,null,null,!1,!1,"",ab);return t._reactRootContainer=l,t[Bs]=l.current,Fd(t.nodeType===8?t.parentNode:t),wl(function(){Sp(e,l,n,r)}),l}function Tp(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=S0(s);a.call(l)}}Sp(e,s,t,i)}else s=l5(n,e,t,i,r);return S0(s)}rE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ju(e.pendingLanes);n!==0&&(By(e,n|1),Dr(e,rn()),!(dt&6)&&(jc=rn()+500,Va()))}break;case 13:wl(function(){var r=Os(t,1);if(r!==null){var i=fr();Xi(r,t,1,i)}}),h1(t,1)}};Oy=function(t){if(t.tag===13){var e=Os(t,134217728);if(e!==null){var n=fr();Xi(e,t,134217728,n)}h1(t,134217728)}};iE=function(t){if(t.tag===13){var e=Ra(t),n=Os(t,e);if(n!==null){var r=fr();Xi(n,t,e,r)}h1(t,e)}};oE=function(){return yt};sE=function(t,e){var n=yt;try{return yt=t,e()}finally{yt=n}};Cv=function(t,e,n){switch(e){case"input":if(dv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Cp(r);if(!i)throw Error(fe(90));Mk(r),dv(r,i)}}}break;case"textarea":Uk(t,n);break;case"select":e=n.value,e!=null&&vc(t,!!n.multiple,e,!1)}};Zk=l1;$k=wl;var c5={usingClientEntryPoint:!1,Events:[yf,ac,Cp,zk,Hk,l1]},_u={findFiberByHostInstance:ol,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},u5={bundleType:_u.bundleType,version:_u.version,rendererPackageName:_u.rendererPackageName,rendererConfig:_u.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Jk(t),t===null?null:t.stateNode},findFiberByHostInstance:_u.findFiberByHostInstance||a5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qf.isDisabled&&Qf.supportsFiber)try{pp=Qf.inject(u5),Oo=Qf}catch{}}ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=c5;ni.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g1(e))throw Error(fe(200));return s5(t,e,null,n)};ni.createRoot=function(t,e){if(!g1(t))throw Error(fe(299));var n=!1,r="",i=TT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=f1(t,1,!1,null,null,n,!1,r,i),t[Bs]=e.current,Fd(t.nodeType===8?t.parentNode:t),new p1(e)};ni.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=Jk(e),t=t===null?null:t.stateNode,t};ni.flushSync=function(t){return wl(t)};ni.hydrate=function(t,e,n){if(!Ep(e))throw Error(fe(200));return Tp(null,t,e,!0,n)};ni.hydrateRoot=function(t,e,n){if(!g1(t))throw Error(fe(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=TT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=ET(e,null,t,1,n??null,i,!1,o,s),t[Bs]=e.current,Fd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new kp(e)};ni.render=function(t,e,n){if(!Ep(e))throw Error(fe(200));return Tp(null,t,e,!1,n)};ni.unmountComponentAtNode=function(t){if(!Ep(t))throw Error(fe(40));return t._reactRootContainer?(wl(function(){Tp(null,null,t,!1,function(){t._reactRootContainer=null,t[Bs]=null})}),!0):!1};ni.unstable_batchedUpdates=l1;ni.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ep(n))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return Tp(t,e,n,!1,r)};ni.version="18.3.1-next-f1338f8080-20240426";function RT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(RT)}catch(t){console.error(t)}}RT(),Rk.exports=ni;var m1=Rk.exports;const d5=tu(m1),f5=vk({__proto__:null,default:d5},[m1]);var lb=m1;iv.createRoot=lb.createRoot,iv.hydrateRoot=lb.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zt(){return zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zt.apply(this,arguments)}var un;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(un||(un={}));const cb="popstate";function h5(t){t===void 0&&(t={});function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return Hd("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:If(i)}return g5(e,n,null,t)}function ut(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function p5(){return Math.random().toString(36).substr(2,8)}function ub(t,e){return{usr:t.state,key:t.key,idx:e}}function Hd(t,e,n,r){return n===void 0&&(n=null),zt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ga(e):e,{state:n,key:e&&e.key||r||p5()})}function If(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ga(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function g5(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=un.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(zt({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=un.Pop;let C=u(),v=C==null?null:C-c;c=C,l&&l({action:a,location:g.location,delta:v})}function f(C,v){a=un.Push;let m=Hd(g.location,C,v);c=u()+1;let y=ub(m,c),x=g.createHref(m);try{s.pushState(y,"",x)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(x)}o&&l&&l({action:a,location:g.location,delta:1})}function h(C,v){a=un.Replace;let m=Hd(g.location,C,v);c=u();let y=ub(m,c),x=g.createHref(m);s.replaceState(y,"",x),o&&l&&l({action:a,location:g.location,delta:0})}function p(C){let v=i.location.origin!=="null"?i.location.origin:i.location.href,m=typeof C=="string"?C:If(C);return m=m.replace(/ $/,"%20"),ut(v,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,v)}let g={get action(){return a},get location(){return t(i,s)},listen(C){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(cb,d),l=C,()=>{i.removeEventListener(cb,d),l=null}},createHref(C){return e(i,C)},createURL:p,encodeLocation(C){let v=p(C);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(C){return s.go(C)}};return g}var mt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(mt||(mt={}));const m5=new Set(["lazy","caseSensitive","path","id","index","children"]);function v5(t){return t.index===!0}function k0(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,o)=>{let s=[...n,String(o)],a=typeof i.id=="string"?i.id:s.join("-");if(ut(i.index!==!0||!i.children,"Cannot specify children on an index route"),ut(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),v5(i)){let l=zt({},i,e(i),{id:a});return r[a]=l,l}else{let l=zt({},i,e(i),{id:a,children:void 0});return r[a]=l,i.children&&(l.children=k0(i.children,e,s,r)),l}})}function Qa(t,e,n){return n===void 0&&(n="/"),Rh(t,e,n,!1)}function Rh(t,e,n,r){let i=typeof e=="string"?Ga(e):e,o=bf(i.pathname||"/",n);if(o==null)return null;let s=_T(t);y5(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let c=_5(o);a=T5(s[l],c,r)}return a}function C5(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function _T(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};l.relativePath.startsWith("/")&&(ut(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=gl([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(ut(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),_T(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:k5(c,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let l of DT(o.path))i(o,s,l)}),e}function DT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=DT(r.join("/")),a=[];return a.push(...s.map(l=>l===""?o:[o,l].join("/"))),i&&a.push(...s),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function y5(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:E5(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const x5=/^:[\w-]+$/,I5=3,b5=2,A5=1,w5=10,S5=-2,db=t=>t==="*";function k5(t,e){let n=t.split("/"),r=n.length;return n.some(db)&&(r+=S5),e&&(r+=b5),n.filter(i=>!db(i)).reduce((i,o)=>i+(x5.test(o)?I5:o===""?A5:w5),r)}function E5(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function T5(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=fb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=fb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:gl([o,d.pathname]),pathnameBase:O5(gl([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=gl([o,d.pathnameBase]))}return s}function fb(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=R5(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let g=a[d]||"";s=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:s,pattern:t}}function R5(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),zc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function _5(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function bf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function D5(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Ga(t):t;return{pathname:n?n.startsWith("/")?n:P5(n,e):e,search:F5(r),hash:M5(i)}}function P5(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Pg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function PT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function N5(t,e){let n=PT(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function B5(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Ga(t):(i=zt({},t),ut(!i.pathname||!i.pathname.includes("?"),Pg("?","pathname","search",i)),ut(!i.pathname||!i.pathname.includes("#"),Pg("#","pathname","hash",i)),ut(!i.search||!i.search.includes("#"),Pg("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let f=s.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=D5(i,a),c=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const gl=t=>t.join("/").replace(/\/\/+/g,"/"),O5=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),F5=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,M5=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class E0{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Zd(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const NT=["post","put","patch","delete"],L5=new Set(NT),U5=["get",...NT],V5=new Set(U5),G5=new Set([301,302,303,307,308]),W5=new Set([307,308]),Ng={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},j5={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Du={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},v1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,z5=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),BT="remix-router-transitions";function H5(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;ut(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let V=t.detectErrorBoundary;i=H=>({hasErrorBoundary:V(H)})}else i=z5;let o={},s=k0(t.routes,i,void 0,o),a,l=t.basename||"/",c=t.dataStrategy||K5,u=t.patchRoutesOnNavigation,d=zt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,h=new Set,p=null,g=null,C=null,v=t.hydrationData!=null,m=Qa(s,t.history.location,l),y=!1,x=null;if(m==null&&!u){let V=Ir(404,{pathname:t.history.location.pathname}),{matches:H,route:K}=Ab(s);m=H,x={[K.id]:V}}m&&!t.hydrationData&&$s(m,s,t.history.location.pathname).active&&(m=null);let b;if(m)if(m.some(V=>V.route.lazy))b=!1;else if(!m.some(V=>V.route.loader))b=!0;else if(d.v7_partialHydration){let V=t.hydrationData?t.hydrationData.loaderData:null,H=t.hydrationData?t.hydrationData.errors:null;if(H){let K=m.findIndex(ce=>H[ce.route.id]!==void 0);b=m.slice(0,K+1).every(ce=>!qv(ce.route,V,H))}else b=m.every(K=>!qv(K.route,V,H))}else b=t.hydrationData!=null;else if(b=!1,m=[],d.v7_partialHydration){let V=$s(null,s,t.history.location.pathname);V.active&&V.matches&&(y=!0,m=V.matches)}let E,A={historyAction:t.history.action,location:t.history.location,matches:m,initialized:b,navigation:Ng,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||x,fetchers:new Map,blockers:new Map},k=un.Pop,D=!1,T,R=!1,P=new Map,L=null,G=!1,Z=!1,q=[],ie=new Set,$=new Map,Q=0,ne=-1,O=new Map,j=new Set,J=new Map,ee=new Map,se=new Set,me=new Map,Be=new Map,ae;function Pt(){if(f=t.history.listen(V=>{let{action:H,location:K,delta:ce}=V;if(ae){ae(),ae=void 0;return}zc(Be.size===0||ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ge=io({currentLocation:A.location,nextLocation:K,historyAction:H});if(ge&&ce!=null){let De=new Promise(Fe=>{ae=Fe});t.history.go(ce*-1),bi(ge,{state:"blocked",location:K,proceed(){bi(ge,{state:"proceeding",proceed:void 0,reset:void 0,location:K}),De.then(()=>t.history.go(ce))},reset(){let Fe=new Map(A.blockers);Fe.set(ge,Du),ze({blockers:Fe})}});return}return Ce(H,K)}),n){c4(e,P);let V=()=>u4(e,P);e.addEventListener("pagehide",V),L=()=>e.removeEventListener("pagehide",V)}return A.initialized||Ce(un.Pop,A.location,{initialHydration:!0}),E}function Gt(){f&&f(),L&&L(),h.clear(),T&&T.abort(),A.fetchers.forEach((V,H)=>W(H)),A.blockers.forEach((V,H)=>nt(H))}function fn(V){return h.add(V),()=>h.delete(V)}function ze(V,H){H===void 0&&(H={}),A=zt({},A,V);let K=[],ce=[];d.v7_fetcherPersist&&A.fetchers.forEach((ge,De)=>{ge.state==="idle"&&(se.has(De)?ce.push(De):K.push(De))}),se.forEach(ge=>{!A.fetchers.has(ge)&&!$.has(ge)&&ce.push(ge)}),[...h].forEach(ge=>ge(A,{deletedFetchers:ce,viewTransitionOpts:H.viewTransitionOpts,flushSync:H.flushSync===!0})),d.v7_fetcherPersist?(K.forEach(ge=>A.fetchers.delete(ge)),ce.forEach(ge=>W(ge))):ce.forEach(ge=>se.delete(ge))}function at(V,H,K){var ce,ge;let{flushSync:De}=K===void 0?{}:K,Fe=A.actionData!=null&&A.navigation.formMethod!=null&&Mi(A.navigation.formMethod)&&A.navigation.state==="loading"&&((ce=V.state)==null?void 0:ce._isRedirect)!==!0,ke;H.actionData?Object.keys(H.actionData).length>0?ke=H.actionData:ke=null:Fe?ke=A.actionData:ke=null;let Ie=H.loaderData?Ib(A.loaderData,H.loaderData,H.matches||[],H.errors):A.loaderData,be=A.blockers;be.size>0&&(be=new Map(be),be.forEach((Je,hn)=>be.set(hn,Du)));let Re=D===!0||A.navigation.formMethod!=null&&Mi(A.navigation.formMethod)&&((ge=V.state)==null?void 0:ge._isRedirect)!==!0;a&&(s=a,a=void 0),G||k===un.Pop||(k===un.Push?t.history.push(V,V.state):k===un.Replace&&t.history.replace(V,V.state));let Ve;if(k===un.Pop){let Je=P.get(A.location.pathname);Je&&Je.has(V.pathname)?Ve={currentLocation:A.location,nextLocation:V}:P.has(V.pathname)&&(Ve={currentLocation:V,nextLocation:A.location})}else if(R){let Je=P.get(A.location.pathname);Je?Je.add(V.pathname):(Je=new Set([V.pathname]),P.set(A.location.pathname,Je)),Ve={currentLocation:A.location,nextLocation:V}}ze(zt({},H,{actionData:ke,loaderData:Ie,historyAction:k,location:V,initialized:!0,navigation:Ng,revalidation:"idle",restoreScrollPosition:oi(V,H.matches||A.matches),preventScrollReset:Re,blockers:be}),{viewTransitionOpts:Ve,flushSync:De===!0}),k=un.Pop,D=!1,R=!1,G=!1,Z=!1,q=[]}async function ot(V,H){if(typeof V=="number"){t.history.go(V);return}let K=Yv(A.location,A.matches,l,d.v7_prependBasename,V,d.v7_relativeSplatPath,H==null?void 0:H.fromRouteId,H==null?void 0:H.relative),{path:ce,submission:ge,error:De}=hb(d.v7_normalizeFormMethod,!1,K,H),Fe=A.location,ke=Hd(A.location,ce,H&&H.state);ke=zt({},ke,t.history.encodeLocation(ke));let Ie=H&&H.replace!=null?H.replace:void 0,be=un.Push;Ie===!0?be=un.Replace:Ie===!1||ge!=null&&Mi(ge.formMethod)&&ge.formAction===A.location.pathname+A.location.search&&(be=un.Replace);let Re=H&&"preventScrollReset"in H?H.preventScrollReset===!0:void 0,Ve=(H&&H.flushSync)===!0,Je=io({currentLocation:Fe,nextLocation:ke,historyAction:be});if(Je){bi(Je,{state:"blocked",location:ke,proceed(){bi(Je,{state:"proceeding",proceed:void 0,reset:void 0,location:ke}),ot(V,H)},reset(){let hn=new Map(A.blockers);hn.set(Je,Du),ze({blockers:hn})}});return}return await Ce(be,ke,{submission:ge,pendingError:De,preventScrollReset:Re,replace:H&&H.replace,enableViewTransition:H&&H.viewTransition,flushSync:Ve})}function he(){if(_(),ze({revalidation:"loading"}),A.navigation.state!=="submitting"){if(A.navigation.state==="idle"){Ce(A.historyAction,A.location,{startUninterruptedRevalidation:!0});return}Ce(k||A.historyAction,A.navigation.location,{overrideNavigation:A.navigation,enableViewTransition:R===!0})}}async function Ce(V,H,K){T&&T.abort(),T=null,k=V,G=(K&&K.startUninterruptedRevalidation)===!0,Jt(A.location,A.matches),D=(K&&K.preventScrollReset)===!0,R=(K&&K.enableViewTransition)===!0;let ce=a||s,ge=K&&K.overrideNavigation,De=K!=null&&K.initialHydration&&A.matches&&A.matches.length>0&&!y?A.matches:Qa(ce,H,l),Fe=(K&&K.flushSync)===!0;if(De&&A.initialized&&!Z&&t4(A.location,H)&&!(K&&K.submission&&Mi(K.submission.formMethod))){at(H,{matches:De},{flushSync:Fe});return}let ke=$s(De,ce,H.pathname);if(ke.active&&ke.matches&&(De=ke.matches),!De){let{error:pe,notFoundMatches:U,route:oe}=$a(H.pathname);at(H,{matches:U,loaderData:{},errors:{[oe.id]:pe}},{flushSync:Fe});return}T=new AbortController;let Ie=Kl(t.history,H,T.signal,K&&K.submission),be;if(K&&K.pendingError)be=[el(De).route.id,{type:mt.error,error:K.pendingError}];else if(K&&K.submission&&Mi(K.submission.formMethod)){let pe=await Ue(Ie,H,K.submission,De,ke.active,{replace:K.replace,flushSync:Fe});if(pe.shortCircuited)return;if(pe.pendingActionResult){let[U,oe]=pe.pendingActionResult;if($r(oe)&&Zd(oe.error)&&oe.error.status===404){T=null,at(H,{matches:pe.matches,loaderData:{},errors:{[U]:oe.error}});return}}De=pe.matches||De,be=pe.pendingActionResult,ge=Bg(H,K.submission),Fe=!1,ke.active=!1,Ie=Kl(t.history,Ie.url,Ie.signal)}let{shortCircuited:Re,matches:Ve,loaderData:Je,errors:hn}=await Le(Ie,H,De,ke.active,ge,K&&K.submission,K&&K.fetcherSubmission,K&&K.replace,K&&K.initialHydration===!0,Fe,be);Re||(T=null,at(H,zt({matches:Ve||De},bb(be),{loaderData:Je,errors:hn})))}async function Ue(V,H,K,ce,ge,De){De===void 0&&(De={}),_();let Fe=a4(H,K);if(ze({navigation:Fe},{flushSync:De.flushSync===!0}),ge){let be=await $o(ce,H.pathname,V.signal);if(be.type==="aborted")return{shortCircuited:!0};if(be.type==="error"){let Re=el(be.partialMatches).route.id;return{matches:be.partialMatches,pendingActionResult:[Re,{type:mt.error,error:be.error}]}}else if(be.matches)ce=be.matches;else{let{notFoundMatches:Re,error:Ve,route:Je}=$a(H.pathname);return{matches:Re,pendingActionResult:[Je.id,{type:mt.error,error:Ve}]}}}let ke,Ie=qu(ce,H);if(!Ie.route.action&&!Ie.route.lazy)ke={type:mt.error,error:Ir(405,{method:V.method,pathname:H.pathname,routeId:Ie.route.id})};else if(ke=(await wt("action",A,V,[Ie],ce,null))[Ie.route.id],V.signal.aborted)return{shortCircuited:!0};if(ll(ke)){let be;return De&&De.replace!=null?be=De.replace:be=Cb(ke.response.headers.get("Location"),new URL(V.url),l)===A.location.pathname+A.location.search,await jt(V,ke,!0,{submission:K,replace:be}),{shortCircuited:!0}}if(pa(ke))throw Ir(400,{type:"defer-action"});if($r(ke)){let be=el(ce,Ie.route.id);return(De&&De.replace)!==!0&&(k=un.Push),{matches:ce,pendingActionResult:[be.route.id,ke]}}return{matches:ce,pendingActionResult:[Ie.route.id,ke]}}async function Le(V,H,K,ce,ge,De,Fe,ke,Ie,be,Re){let Ve=ge||Bg(H,De),Je=De||Fe||Sb(Ve),hn=!G&&(!d.v7_partialHydration||!Ie);if(ce){if(hn){let Yt=Pe(Re);ze(zt({navigation:Ve},Yt!==void 0?{actionData:Yt}:{}),{flushSync:be})}let rt=await $o(K,H.pathname,V.signal);if(rt.type==="aborted")return{shortCircuited:!0};if(rt.type==="error"){let Yt=el(rt.partialMatches).route.id;return{matches:rt.partialMatches,loaderData:{},errors:{[Yt]:rt.error}}}else if(rt.matches)K=rt.matches;else{let{error:Yt,notFoundMatches:Zl,route:bu}=$a(H.pathname);return{matches:Zl,loaderData:{},errors:{[bu.id]:Yt}}}}let pe=a||s,[U,oe]=gb(t.history,A,K,Je,H,d.v7_partialHydration&&Ie===!0,d.v7_skipActionErrorRevalidation,Z,q,ie,se,J,j,pe,l,Re);if(ii(rt=>!(K&&K.some(Yt=>Yt.route.id===rt))||U&&U.some(Yt=>Yt.route.id===rt)),ne=++Q,U.length===0&&oe.length===0){let rt=tt();return at(H,zt({matches:K,loaderData:{},errors:Re&&$r(Re[1])?{[Re[0]]:Re[1].error}:null},bb(Re),rt?{fetchers:new Map(A.fetchers)}:{}),{flushSync:be}),{shortCircuited:!0}}if(hn){let rt={};if(!ce){rt.navigation=Ve;let Yt=Pe(Re);Yt!==void 0&&(rt.actionData=Yt)}oe.length>0&&(rt.fetchers=$e(oe)),ze(rt,{flushSync:be})}oe.forEach(rt=>{te(rt.key),rt.controller&&$.set(rt.key,rt.controller)});let Ae=()=>oe.forEach(rt=>te(rt.key));T&&T.signal.addEventListener("abort",Ae);let{loaderResults:pt,fetcherResults:St}=await sn(A,K,U,oe,V);if(V.signal.aborted)return{shortCircuited:!0};T&&T.signal.removeEventListener("abort",Ae),oe.forEach(rt=>$.delete(rt.key));let xt=eh(pt);if(xt)return await jt(V,xt.result,!0,{replace:ke}),{shortCircuited:!0};if(xt=eh(St),xt)return j.add(xt.key),await jt(V,xt.result,!0,{replace:ke}),{shortCircuited:!0};let{loaderData:An,errors:zn}=xb(A,K,pt,Re,oe,St,me);me.forEach((rt,Yt)=>{rt.subscribe(Zl=>{(Zl||rt.done)&&me.delete(Yt)})}),d.v7_partialHydration&&Ie&&A.errors&&(zn=zt({},A.errors,zn));let Or=tt(),an=lt(ne),Xa=Or||an||oe.length>0;return zt({matches:K,loaderData:An,errors:zn},Xa?{fetchers:new Map(A.fetchers)}:{})}function Pe(V){if(V&&!$r(V[1]))return{[V[0]]:V[1].data};if(A.actionData)return Object.keys(A.actionData).length===0?null:A.actionData}function $e(V){return V.forEach(H=>{let K=A.fetchers.get(H.key),ce=Pu(void 0,K?K.data:void 0);A.fetchers.set(H.key,ce)}),new Map(A.fetchers)}function st(V,H,K,ce){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");te(V);let ge=(ce&&ce.flushSync)===!0,De=a||s,Fe=Yv(A.location,A.matches,l,d.v7_prependBasename,K,d.v7_relativeSplatPath,H,ce==null?void 0:ce.relative),ke=Qa(De,Fe,l),Ie=$s(ke,De,Fe);if(Ie.active&&Ie.matches&&(ke=Ie.matches),!ke){w(V,H,Ir(404,{pathname:Fe}),{flushSync:ge});return}let{path:be,submission:Re,error:Ve}=hb(d.v7_normalizeFormMethod,!0,Fe,ce);if(Ve){w(V,H,Ve,{flushSync:ge});return}let Je=qu(ke,be),hn=(ce&&ce.preventScrollReset)===!0;if(Re&&Mi(Re.formMethod)){Qe(V,H,be,Je,ke,Ie.active,ge,hn,Re);return}J.set(V,{routeId:H,path:be}),Wt(V,H,be,Je,ke,Ie.active,ge,hn,Re)}async function Qe(V,H,K,ce,ge,De,Fe,ke,Ie){_(),J.delete(V);function be(ln){if(!ln.route.action&&!ln.route.lazy){let $l=Ir(405,{method:Ie.formMethod,pathname:K,routeId:H});return w(V,H,$l,{flushSync:Fe}),!0}return!1}if(!De&&be(ce))return;let Re=A.fetchers.get(V);I(V,l4(Ie,Re),{flushSync:Fe});let Ve=new AbortController,Je=Kl(t.history,K,Ve.signal,Ie);if(De){let ln=await $o(ge,new URL(Je.url).pathname,Je.signal,V);if(ln.type==="aborted")return;if(ln.type==="error"){w(V,H,ln.error,{flushSync:Fe});return}else if(ln.matches){if(ge=ln.matches,ce=qu(ge,K),be(ce))return}else{w(V,H,Ir(404,{pathname:K}),{flushSync:Fe});return}}$.set(V,Ve);let hn=Q,U=(await wt("action",A,Je,[ce],ge,V))[ce.route.id];if(Je.signal.aborted){$.get(V)===Ve&&$.delete(V);return}if(d.v7_fetcherPersist&&se.has(V)){if(ll(U)||$r(U)){I(V,Qs(void 0));return}}else{if(ll(U))if($.delete(V),ne>hn){I(V,Qs(void 0));return}else return j.add(V),I(V,Pu(Ie)),jt(Je,U,!1,{fetcherSubmission:Ie,preventScrollReset:ke});if($r(U)){w(V,H,U.error);return}}if(pa(U))throw Ir(400,{type:"defer-action"});let oe=A.navigation.location||A.location,Ae=Kl(t.history,oe,Ve.signal),pt=a||s,St=A.navigation.state!=="idle"?Qa(pt,A.navigation.location,l):A.matches;ut(St,"Didn't find any matches after fetcher action");let xt=++Q;O.set(V,xt);let An=Pu(Ie,U.data);A.fetchers.set(V,An);let[zn,Or]=gb(t.history,A,St,Ie,oe,!1,d.v7_skipActionErrorRevalidation,Z,q,ie,se,J,j,pt,l,[ce.route.id,U]);Or.filter(ln=>ln.key!==V).forEach(ln=>{let $l=ln.key,qx=A.fetchers.get($l),O3=Pu(void 0,qx?qx.data:void 0);A.fetchers.set($l,O3),te($l),ln.controller&&$.set($l,ln.controller)}),ze({fetchers:new Map(A.fetchers)});let an=()=>Or.forEach(ln=>te(ln.key));Ve.signal.addEventListener("abort",an);let{loaderResults:Xa,fetcherResults:rt}=await sn(A,St,zn,Or,Ae);if(Ve.signal.aborted)return;Ve.signal.removeEventListener("abort",an),O.delete(V),$.delete(V),Or.forEach(ln=>$.delete(ln.key));let Yt=eh(Xa);if(Yt)return jt(Ae,Yt.result,!1,{preventScrollReset:ke});if(Yt=eh(rt),Yt)return j.add(Yt.key),jt(Ae,Yt.result,!1,{preventScrollReset:ke});let{loaderData:Zl,errors:bu}=xb(A,St,Xa,void 0,Or,rt,me);if(A.fetchers.has(V)){let ln=Qs(U.data);A.fetchers.set(V,ln)}lt(xt),A.navigation.state==="loading"&&xt>ne?(ut(k,"Expected pending action"),T&&T.abort(),at(A.navigation.location,{matches:St,loaderData:Zl,errors:bu,fetchers:new Map(A.fetchers)})):(ze({errors:bu,loaderData:Ib(A.loaderData,Zl,St,bu),fetchers:new Map(A.fetchers)}),Z=!1)}async function Wt(V,H,K,ce,ge,De,Fe,ke,Ie){let be=A.fetchers.get(V);I(V,Pu(Ie,be?be.data:void 0),{flushSync:Fe});let Re=new AbortController,Ve=Kl(t.history,K,Re.signal);if(De){let U=await $o(ge,new URL(Ve.url).pathname,Ve.signal,V);if(U.type==="aborted")return;if(U.type==="error"){w(V,H,U.error,{flushSync:Fe});return}else if(U.matches)ge=U.matches,ce=qu(ge,K);else{w(V,H,Ir(404,{pathname:K}),{flushSync:Fe});return}}$.set(V,Re);let Je=Q,pe=(await wt("loader",A,Ve,[ce],ge,V))[ce.route.id];if(pa(pe)&&(pe=await C1(pe,Ve.signal,!0)||pe),$.get(V)===Re&&$.delete(V),!Ve.signal.aborted){if(se.has(V)){I(V,Qs(void 0));return}if(ll(pe))if(ne>Je){I(V,Qs(void 0));return}else{j.add(V),await jt(Ve,pe,!1,{preventScrollReset:ke});return}if($r(pe)){w(V,H,pe.error);return}ut(!pa(pe),"Unhandled fetcher deferred data"),I(V,Qs(pe.data))}}async function jt(V,H,K,ce){let{submission:ge,fetcherSubmission:De,preventScrollReset:Fe,replace:ke}=ce===void 0?{}:ce;H.response.headers.has("X-Remix-Revalidate")&&(Z=!0);let Ie=H.response.headers.get("Location");ut(Ie,"Expected a Location header on the redirect Response"),Ie=Cb(Ie,new URL(V.url),l);let be=Hd(A.location,Ie,{_isRedirect:!0});if(n){let U=!1;if(H.response.headers.has("X-Remix-Reload-Document"))U=!0;else if(v1.test(Ie)){const oe=t.history.createURL(Ie);U=oe.origin!==e.location.origin||bf(oe.pathname,l)==null}if(U){ke?e.location.replace(Ie):e.location.assign(Ie);return}}T=null;let Re=ke===!0||H.response.headers.has("X-Remix-Replace")?un.Replace:un.Push,{formMethod:Ve,formAction:Je,formEncType:hn}=A.navigation;!ge&&!De&&Ve&&Je&&hn&&(ge=Sb(A.navigation));let pe=ge||De;if(W5.has(H.response.status)&&pe&&Mi(pe.formMethod))await Ce(Re,be,{submission:zt({},pe,{formAction:Ie}),preventScrollReset:Fe||D,enableViewTransition:K?R:void 0});else{let U=Bg(be,ge);await Ce(Re,be,{overrideNavigation:U,fetcherSubmission:De,preventScrollReset:Fe||D,enableViewTransition:K?R:void 0})}}async function wt(V,H,K,ce,ge,De){let Fe,ke={};try{Fe=await J5(c,V,H,K,ce,ge,De,o,i)}catch(Ie){return ce.forEach(be=>{ke[be.route.id]={type:mt.error,error:Ie}}),ke}for(let[Ie,be]of Object.entries(Fe))if(n4(be)){let Re=be.result;ke[Ie]={type:mt.redirect,response:Q5(Re,K,Ie,ge,l,d.v7_relativeSplatPath)}}else ke[Ie]=await q5(be);return ke}async function sn(V,H,K,ce,ge){let De=V.matches,Fe=wt("loader",V,ge,K,H,null),ke=Promise.all(ce.map(async Re=>{if(Re.matches&&Re.match&&Re.controller){let Je=(await wt("loader",V,Kl(t.history,Re.path,Re.controller.signal),[Re.match],Re.matches,Re.key))[Re.match.route.id];return{[Re.key]:Je}}else return Promise.resolve({[Re.key]:{type:mt.error,error:Ir(404,{pathname:Re.path})}})})),Ie=await Fe,be=(await ke).reduce((Re,Ve)=>Object.assign(Re,Ve),{});return await Promise.all([o4(H,Ie,ge.signal,De,V.loaderData),s4(H,be,ce)]),{loaderResults:Ie,fetcherResults:be}}function _(){Z=!0,q.push(...ii()),J.forEach((V,H)=>{$.has(H)&&ie.add(H),te(H)})}function I(V,H,K){K===void 0&&(K={}),A.fetchers.set(V,H),ze({fetchers:new Map(A.fetchers)},{flushSync:(K&&K.flushSync)===!0})}function w(V,H,K,ce){ce===void 0&&(ce={});let ge=el(A.matches,H);W(V),ze({errors:{[ge.route.id]:K},fetchers:new Map(A.fetchers)},{flushSync:(ce&&ce.flushSync)===!0})}function B(V){return ee.set(V,(ee.get(V)||0)+1),se.has(V)&&se.delete(V),A.fetchers.get(V)||j5}function W(V){let H=A.fetchers.get(V);$.has(V)&&!(H&&H.state==="loading"&&O.has(V))&&te(V),J.delete(V),O.delete(V),j.delete(V),d.v7_fetcherPersist&&se.delete(V),ie.delete(V),A.fetchers.delete(V)}function Y(V){let H=(ee.get(V)||0)-1;H<=0?(ee.delete(V),se.add(V),d.v7_fetcherPersist||W(V)):ee.set(V,H),ze({fetchers:new Map(A.fetchers)})}function te(V){let H=$.get(V);H&&(H.abort(),$.delete(V))}function Ne(V){for(let H of V){let K=B(H),ce=Qs(K.data);A.fetchers.set(H,ce)}}function tt(){let V=[],H=!1;for(let K of j){let ce=A.fetchers.get(K);ut(ce,"Expected fetcher: "+K),ce.state==="loading"&&(j.delete(K),V.push(K),H=!0)}return Ne(V),H}function lt(V){let H=[];for(let[K,ce]of O)if(ce<V){let ge=A.fetchers.get(K);ut(ge,"Expected fetcher: "+K),ge.state==="loading"&&(te(K),O.delete(K),H.push(K))}return Ne(H),H.length>0}function ht(V,H){let K=A.blockers.get(V)||Du;return Be.get(V)!==H&&Be.set(V,H),K}function nt(V){A.blockers.delete(V),Be.delete(V)}function bi(V,H){let K=A.blockers.get(V)||Du;ut(K.state==="unblocked"&&H.state==="blocked"||K.state==="blocked"&&H.state==="blocked"||K.state==="blocked"&&H.state==="proceeding"||K.state==="blocked"&&H.state==="unblocked"||K.state==="proceeding"&&H.state==="unblocked","Invalid blocker state transition: "+K.state+" -> "+H.state);let ce=new Map(A.blockers);ce.set(V,H),ze({blockers:ce})}function io(V){let{currentLocation:H,nextLocation:K,historyAction:ce}=V;if(Be.size===0)return;Be.size>1&&zc(!1,"A router only supports one blocker at a time");let ge=Array.from(Be.entries()),[De,Fe]=ge[ge.length-1],ke=A.blockers.get(De);if(!(ke&&ke.state==="proceeding")&&Fe({currentLocation:H,nextLocation:K,historyAction:ce}))return De}function $a(V){let H=Ir(404,{pathname:V}),K=a||s,{matches:ce,route:ge}=Ab(K);return ii(),{notFoundMatches:ce,route:ge,error:H}}function ii(V){let H=[];return me.forEach((K,ce)=>{(!V||V(ce))&&(K.cancel(),H.push(ce),me.delete(ce))}),H}function Iu(V,H,K){if(p=V,C=H,g=K||null,!v&&A.navigation===Ng){v=!0;let ce=oi(A.location,A.matches);ce!=null&&ze({restoreScrollPosition:ce})}return()=>{p=null,C=null,g=null}}function zl(V,H){return g&&g(V,H.map(ce=>C5(ce,A.loaderData)))||V.key}function Jt(V,H){if(p&&C){let K=zl(V,H);p[K]=C()}}function oi(V,H){if(p){let K=zl(V,H),ce=p[K];if(typeof ce=="number")return ce}return null}function $s(V,H,K){if(u)if(V){if(Object.keys(V[0].params).length>0)return{active:!0,matches:Rh(H,K,l,!0)}}else return{active:!0,matches:Rh(H,K,l,!0)||[]};return{active:!1,matches:null}}async function $o(V,H,K,ce){if(!u)return{type:"success",matches:V};let ge=V;for(;;){let De=a==null,Fe=a||s,ke=o;try{await u({signal:K,path:H,matches:ge,fetcherKey:ce,patch:(Re,Ve)=>{K.aborted||vb(Re,Ve,Fe,ke,i)}})}catch(Re){return{type:"error",error:Re,partialMatches:ge}}finally{De&&!K.aborted&&(s=[...s])}if(K.aborted)return{type:"aborted"};let Ie=Qa(Fe,H,l);if(Ie)return{type:"success",matches:Ie};let be=Rh(Fe,H,l,!0);if(!be||ge.length===be.length&&ge.every((Re,Ve)=>Re.route.id===be[Ve].route.id))return{type:"success",matches:null};ge=be}}function Xs(V){o={},a=k0(V,i,void 0,o)}function Hl(V,H){let K=a==null;vb(V,H,a||s,o,i),K&&(s=[...s],ze({}))}return E={get basename(){return l},get future(){return d},get state(){return A},get routes(){return s},get window(){return e},initialize:Pt,subscribe:fn,enableScrollRestoration:Iu,navigate:ot,fetch:st,revalidate:he,createHref:V=>t.history.createHref(V),encodeLocation:V=>t.history.encodeLocation(V),getFetcher:B,deleteFetcher:Y,dispose:Gt,getBlocker:ht,deleteBlocker:nt,patchRoutes:Hl,_internalFetchControllers:$,_internalActiveDeferreds:me,_internalSetRoutes:Xs},E}function Z5(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Yv(t,e,n,r,i,o,s,a){let l,c;if(s){l=[];for(let d of e)if(l.push(d),d.route.id===s){c=d;break}}else l=e,c=e[e.length-1];let u=B5(i||".",N5(l,o),bf(t.pathname,n)||t.pathname,a==="path");if(i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&c){let d=y1(u.search);if(c.route.index&&!d)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&d){let f=new URLSearchParams(u.search),h=f.getAll("index");f.delete("index"),h.filter(g=>g).forEach(g=>f.append("index",g));let p=f.toString();u.search=p?"?"+p:""}}return r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:gl([n,u.pathname])),If(u)}function hb(t,e,n,r){if(!r||!Z5(r))return{path:n};if(r.formMethod&&!i4(r.formMethod))return{path:n,error:Ir(405,{method:r.formMethod})};let i=()=>({path:n,error:Ir(400,{type:"invalid-body"})}),o=r.formMethod||"get",s=t?o.toUpperCase():o.toLowerCase(),a=MT(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Mi(s))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[g,C]=p;return""+h+g+"="+C+`
`},""):String(r.body);return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Mi(s))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}ut(typeof FormData=="function","FormData is not available in this environment");let l,c;if(r.formData)l=Qv(r.formData),c=r.formData;else if(r.body instanceof FormData)l=Qv(r.body),c=r.body;else if(r.body instanceof URLSearchParams)l=r.body,c=yb(l);else if(r.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(r.body),c=yb(l)}catch{return i()}let u={formMethod:s,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Mi(u.formMethod))return{path:n,submission:u};let d=Ga(n);return e&&d.search&&y1(d.search)&&l.append("index",""),d.search="?"+l,{path:If(d),submission:u}}function pb(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(i=>i.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function gb(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g){let C=g?$r(g[1])?g[1].error:g[1].data:void 0,v=t.createURL(e.location),m=t.createURL(i),y=n;o&&e.errors?y=pb(n,Object.keys(e.errors)[0],!0):g&&$r(g[1])&&(y=pb(n,g[0]));let x=g?g[1].statusCode:void 0,b=s&&x&&x>=400,E=y.filter((k,D)=>{let{route:T}=k;if(T.lazy)return!0;if(T.loader==null)return!1;if(o)return qv(T,e.loaderData,e.errors);if($5(e.loaderData,e.matches[D],k)||l.some(L=>L===k.route.id))return!0;let R=e.matches[D],P=k;return mb(k,zt({currentUrl:v,currentParams:R.params,nextUrl:m,nextParams:P.params},r,{actionResult:C,actionStatus:x,defaultShouldRevalidate:b?!1:a||v.pathname+v.search===m.pathname+m.search||v.search!==m.search||OT(R,P)}))}),A=[];return d.forEach((k,D)=>{if(o||!n.some(G=>G.route.id===k.routeId)||u.has(D))return;let T=Qa(h,k.path,p);if(!T){A.push({key:D,routeId:k.routeId,path:k.path,matches:null,match:null,controller:null});return}let R=e.fetchers.get(D),P=qu(T,k.path),L=!1;f.has(D)?L=!1:c.has(D)?(c.delete(D),L=!0):R&&R.state!=="idle"&&R.data===void 0?L=a:L=mb(P,zt({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:m,nextParams:n[n.length-1].params},r,{actionResult:C,actionStatus:x,defaultShouldRevalidate:b?!1:a})),L&&A.push({key:D,routeId:k.routeId,path:k.path,matches:T,match:P,controller:new AbortController})}),[E,A]}function qv(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,i=n!=null&&n[t.id]!==void 0;return!r&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!i}function $5(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function OT(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function mb(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function vb(t,e,n,r,i){var o;let s;if(t){let c=r[t];ut(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),s=c.children}else s=n;let a=e.filter(c=>!s.some(u=>FT(c,u))),l=k0(a,i,[t||"_","patch",String(((o=s)==null?void 0:o.length)||"0")],r);s.push(...l)}function FT(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var i;return(i=e.children)==null?void 0:i.some(o=>FT(n,o))}):!1}async function X5(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];ut(i,"No route found in manifest");let o={};for(let s in r){let l=i[s]!==void 0&&s!=="hasErrorBoundary";zc(!l,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!l&&!m5.has(s)&&(o[s]=r[s])}Object.assign(i,o),Object.assign(i,zt({},e(i),{lazy:void 0}))}async function K5(t){let{matches:e}=t,n=e.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,o,s)=>Object.assign(i,{[n[s].route.id]:o}),{})}async function J5(t,e,n,r,i,o,s,a,l,c){let u=o.map(h=>h.route.lazy?X5(h.route,l,a):void 0),d=o.map((h,p)=>{let g=u[p],C=i.some(m=>m.route.id===h.route.id);return zt({},h,{shouldLoad:C,resolve:async m=>(m&&r.method==="GET"&&(h.route.lazy||h.route.loader)&&(C=!0),C?Y5(e,r,h,g,m,c):Promise.resolve({type:mt.data,result:void 0}))})}),f=await t({matches:d,request:r,params:o[0].params,fetcherKey:s,context:c});try{await Promise.all(u)}catch{}return f}async function Y5(t,e,n,r,i,o){let s,a,l=c=>{let u,d=new Promise((p,g)=>u=g);a=()=>u(),e.signal.addEventListener("abort",a);let f=p=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):c({request:e,params:n.params,context:o},...p!==void 0?[p]:[]),h=(async()=>{try{return{type:"data",result:await(i?i(g=>f(g)):f())}}catch(p){return{type:"error",result:p}}})();return Promise.race([h,d])};try{let c=n.route[t];if(r)if(c){let u,[d]=await Promise.all([l(c).catch(f=>{u=f}),r]);if(u!==void 0)throw u;s=d}else if(await r,c=n.route[t],c)s=await l(c);else if(t==="action"){let u=new URL(e.url),d=u.pathname+u.search;throw Ir(405,{method:e.method,pathname:d,routeId:n.route.id})}else return{type:mt.data,result:void 0};else if(c)s=await l(c);else{let u=new URL(e.url),d=u.pathname+u.search;throw Ir(404,{pathname:d})}ut(s.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:mt.error,result:c}}finally{a&&e.signal.removeEventListener("abort",a)}return s}async function q5(t){let{result:e,type:n}=t;if(LT(e)){let d;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?d=null:d=await e.json():d=await e.text()}catch(f){return{type:mt.error,error:f}}return n===mt.error?{type:mt.error,error:new E0(e.status,e.statusText,d),statusCode:e.status,headers:e.headers}:{type:mt.data,data:d,statusCode:e.status,headers:e.headers}}if(n===mt.error){if(wb(e)){var r,i;if(e.data instanceof Error){var o,s;return{type:mt.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:mt.error,error:new E0(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Zd(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:mt.error,error:e,statusCode:Zd(e)?e.status:void 0}}if(r4(e)){var a,l;return{type:mt.deferred,deferredData:e,statusCode:(a=e.init)==null?void 0:a.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(wb(e)){var c,u;return{type:mt.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:mt.data,data:e}}function Q5(t,e,n,r,i,o){let s=t.headers.get("Location");if(ut(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!v1.test(s)){let a=r.slice(0,r.findIndex(l=>l.route.id===n)+1);s=Yv(new URL(e.url),a,i,!0,s,o),t.headers.set("Location",s)}return t}function Cb(t,e,n){if(v1.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=bf(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function Kl(t,e,n,r){let i=t.createURL(MT(e)).toString(),o={signal:n};if(r&&Mi(r.formMethod)){let{formMethod:s,formEncType:a}=r;o.method=s.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=Qv(r.formData):o.body=r.formData}return new Request(i,o)}function Qv(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function yb(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function e4(t,e,n,r,i){let o={},s=null,a,l=!1,c={},u=n&&$r(n[1])?n[1].error:void 0;return t.forEach(d=>{if(!(d.route.id in e))return;let f=d.route.id,h=e[f];if(ut(!ll(h),"Cannot handle redirect results in processLoaderData"),$r(h)){let p=h.error;u!==void 0&&(p=u,u=void 0),s=s||{};{let g=el(t,f);s[g.route.id]==null&&(s[g.route.id]=p)}o[f]=void 0,l||(l=!0,a=Zd(h.error)?h.error.status:500),h.headers&&(c[f]=h.headers)}else pa(h)?(r.set(f,h.deferredData),o[f]=h.deferredData.data,h.statusCode!=null&&h.statusCode!==200&&!l&&(a=h.statusCode),h.headers&&(c[f]=h.headers)):(o[f]=h.data,h.statusCode&&h.statusCode!==200&&!l&&(a=h.statusCode),h.headers&&(c[f]=h.headers))}),u!==void 0&&n&&(s={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:s,statusCode:a||200,loaderHeaders:c}}function xb(t,e,n,r,i,o,s){let{loaderData:a,errors:l}=e4(e,n,r,s);return i.forEach(c=>{let{key:u,match:d,controller:f}=c,h=o[u];if(ut(h,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if($r(h)){let p=el(t.matches,d==null?void 0:d.route.id);l&&l[p.route.id]||(l=zt({},l,{[p.route.id]:h.error})),t.fetchers.delete(u)}else if(ll(h))ut(!1,"Unhandled fetcher revalidation redirect");else if(pa(h))ut(!1,"Unhandled fetcher deferred data");else{let p=Qs(h.data);t.fetchers.set(u,p)}}),{loaderData:a,errors:l}}function Ib(t,e,n,r){let i=zt({},e);for(let o of n){let s=o.route.id;if(e.hasOwnProperty(s)?e[s]!==void 0&&(i[s]=e[s]):t[s]!==void 0&&o.route.loader&&(i[s]=t[s]),r&&r.hasOwnProperty(s))break}return i}function bb(t){return t?$r(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function el(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function Ab(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Ir(t,e){let{pathname:n,routeId:r,method:i,type:o,message:s}=e===void 0?{}:e,a="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(a="Bad Request",i&&n&&r?l="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?l="defer() is not supported in actions":o==="invalid-body"&&(l="Unable to encode submission body")):t===403?(a="Forbidden",l='Route "'+r+'" does not match URL "'+n+'"'):t===404?(a="Not Found",l='No route matches URL "'+n+'"'):t===405&&(a="Method Not Allowed",i&&n&&r?l="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new E0(t||500,a,new Error(l),!0)}function eh(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,i]=e[n];if(ll(i))return{key:r,result:i}}}function MT(t){let e=typeof t=="string"?Ga(t):t;return If(zt({},e,{hash:""}))}function t4(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function n4(t){return LT(t.result)&&G5.has(t.result.status)}function pa(t){return t.type===mt.deferred}function $r(t){return t.type===mt.error}function ll(t){return(t&&t.type)===mt.redirect}function wb(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function r4(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function LT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function i4(t){return V5.has(t.toLowerCase())}function Mi(t){return L5.has(t.toLowerCase())}async function o4(t,e,n,r,i){let o=Object.entries(e);for(let s=0;s<o.length;s++){let[a,l]=o[s],c=t.find(f=>(f==null?void 0:f.route.id)===a);if(!c)continue;let u=r.find(f=>f.route.id===c.route.id),d=u!=null&&!OT(u,c)&&(i&&i[c.route.id])!==void 0;pa(l)&&d&&await C1(l,n,!1).then(f=>{f&&(e[a]=f)})}}async function s4(t,e,n){for(let r=0;r<n.length;r++){let{key:i,routeId:o,controller:s}=n[r],a=e[i];t.find(c=>(c==null?void 0:c.route.id)===o)&&pa(a)&&(ut(s,"Expected an AbortController for revalidating fetcher deferred result"),await C1(a,s.signal,!0).then(c=>{c&&(e[i]=c)}))}}async function C1(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:mt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:mt.error,error:i}}return{type:mt.data,data:t.deferredData.data}}}function y1(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function qu(t,e){let n=typeof e=="string"?Ga(e).search:e.search;if(t[t.length-1].route.index&&y1(n||""))return t[t.length-1];let r=PT(t);return r[r.length-1]}function Sb(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:o,json:s}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(s!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}}}function Bg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function a4(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Pu(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function l4(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Qs(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function c4(t,e){try{let n=t.sessionStorage.getItem(BT);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function u4(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(BT,JSON.stringify(n))}catch(r){zc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eC(){return eC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},eC.apply(this,arguments)}const UT=S.createContext(null),VT=S.createContext(null),GT=S.createContext(null),x1=S.createContext(null),Rp=S.createContext({outlet:null,matches:[],isDataRoute:!1}),WT=S.createContext(null);function I1(){return S.useContext(x1)!=null}function jT(){return I1()||ut(!1),S.useContext(x1).location}function d4(t,e,n,r){I1()||ut(!1);let{navigator:i,static:o}=S.useContext(GT),{matches:s}=S.useContext(Rp),a=s[s.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=jT(),d;d=u;let f=d.pathname||"/",h=f;if(c!=="/"){let C=c.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(C.length).join("/")}let p=!o&&n&&n.matches&&n.matches.length>0?n.matches:Qa(t,{pathname:h});return m4(p&&p.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:gl([c,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:gl([c,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),s,n,r)}function f4(){let t=x4(),e=Zd(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),n?S.createElement("pre",{style:i},n):null,null)}const h4=S.createElement(f4,null);class p4 extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?S.createElement(Rp.Provider,{value:this.props.routeContext},S.createElement(WT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function g4(t){let{routeContext:e,match:n,children:r}=t,i=S.useContext(UT);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(Rp.Provider,{value:e},r)}function m4(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||ut(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,d,f)=>{let h,p=!1,g=null,C=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||h4,l&&(c<0&&f===0?(I4("route-fallback"),p=!0,C=null):c===f&&(p=!0,C=d.route.hydrateFallbackElement||null)));let v=e.concat(s.slice(0,f+1)),m=()=>{let y;return h?y=g:p?y=C:d.route.Component?y=S.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=u,S.createElement(g4,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:n!=null},children:y})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?S.createElement(p4,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:m(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):m()},null)}var zT=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(zT||{});function v4(t){let e=S.useContext(VT);return e||ut(!1),e}function C4(t){let e=S.useContext(Rp);return e||ut(!1),e}function y4(t){let e=C4(),n=e.matches[e.matches.length-1];return n.route.id||ut(!1),n.route.id}function x4(){var t;let e=S.useContext(WT),n=v4(zT.UseRouteError),r=y4();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const kb={};function I4(t,e,n){kb[t]||(kb[t]=!0)}function b4(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function A4(t){let{basename:e="/",children:n=null,location:r,navigationType:i=un.Pop,navigator:o,static:s=!1,future:a}=t;I1()&&ut(!1);let l=e.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:l,navigator:o,static:s,future:eC({v7_relativeSplatPath:!1},a)}),[l,a,o,s]);typeof r=="string"&&(r=Ga(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,g=S.useMemo(()=>{let C=bf(u,l);return C==null?null:{location:{pathname:C,search:d,hash:f,state:h,key:p},navigationType:i}},[l,u,d,f,h,p,i]);return g==null?null:S.createElement(GT.Provider,{value:c},S.createElement(x1.Provider,{children:n,value:g}))}new Promise(()=>{});function w4(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:S.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:S.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:S.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T0(){return T0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},T0.apply(this,arguments)}const S4="6";try{window.__reactRouterVersion=S4}catch{}function k4(t,e){return H5({basename:void 0,future:T0({},void 0,{v7_prependBasename:!0}),history:h5({window:void 0}),hydrationData:E4(),routes:t,mapRouteProperties:w4,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function E4(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=T0({},e,{errors:T4(e.errors)})),e}function T4(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new E0(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let s=new o(i.message);s.stack="",n[r]=s}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const R4=S.createContext({isTransitioning:!1}),_4=S.createContext(new Map),D4="startTransition",Eb=eN[D4],P4="flushSync",Tb=f5[P4];function N4(t){Eb?Eb(t):t()}function Nu(t){Tb?Tb(t):t()}class B4{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function O4(t){let{fallbackElement:e,router:n,future:r}=t,[i,o]=S.useState(n.state),[s,a]=S.useState(),[l,c]=S.useState({isTransitioning:!1}),[u,d]=S.useState(),[f,h]=S.useState(),[p,g]=S.useState(),C=S.useRef(new Map),{v7_startTransition:v}=r||{},m=S.useCallback(k=>{v?N4(k):k()},[v]),y=S.useCallback((k,D)=>{let{deletedFetchers:T,flushSync:R,viewTransitionOpts:P}=D;k.fetchers.forEach((G,Z)=>{G.data!==void 0&&C.current.set(Z,G.data)}),T.forEach(G=>C.current.delete(G));let L=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!P||L){R?Nu(()=>o(k)):m(()=>o(k));return}if(R){Nu(()=>{f&&(u&&u.resolve(),f.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let G=n.window.document.startViewTransition(()=>{Nu(()=>o(k))});G.finished.finally(()=>{Nu(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})})}),Nu(()=>h(G));return}f?(u&&u.resolve(),f.skipTransition(),g({state:k,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(a(k),c({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[n.window,f,u,C,m]);S.useLayoutEffect(()=>n.subscribe(y),[n,y]),S.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new B4)},[l]),S.useEffect(()=>{if(u&&s&&n.window){let k=s,D=u.promise,T=n.window.document.startViewTransition(async()=>{m(()=>o(k)),await D});T.finished.finally(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})}),h(T)}},[m,s,u,n.window]),S.useEffect(()=>{u&&s&&i.location.key===s.location.key&&u.resolve()},[u,f,i.location,s]),S.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),c({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),g(void 0))},[l.isTransitioning,p]),S.useEffect(()=>{},[]);let x=S.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:k=>n.navigate(k),push:(k,D,T)=>n.navigate(k,{state:D,preventScrollReset:T==null?void 0:T.preventScrollReset}),replace:(k,D,T)=>n.navigate(k,{replace:!0,state:D,preventScrollReset:T==null?void 0:T.preventScrollReset})}),[n]),b=n.basename||"/",E=S.useMemo(()=>({router:n,navigator:x,static:!1,basename:b}),[n,x,b]),A=S.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return S.useEffect(()=>b4(r,n.future),[r,n.future]),S.createElement(S.Fragment,null,S.createElement(UT.Provider,{value:E},S.createElement(VT.Provider,{value:i},S.createElement(_4.Provider,{value:C.current},S.createElement(R4.Provider,{value:l},S.createElement(A4,{basename:b,location:i.location,navigationType:i.historyAction,navigator:x,future:A},i.initialized||n.future.v7_partialHydration?S.createElement(F4,{routes:n.routes,future:n.future,state:i}):e))))),null)}const F4=S.memo(M4);function M4(t){let{routes:e,future:n,state:r}=t;return d4(e,void 0,r,n)}var Rb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Rb||(Rb={}));var _b;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(_b||(_b={}));const HT=t=>{const e=typeof t=="function",n=S.useRef(t);S.useEffect(()=>{n.current=t}),S.useEffect(()=>{if(e){const r=i=>{const o=n.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var ZT={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function o(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||l,f),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,h,p){var g=n?n+c:c;if(!this._events[g])return!1;var C=this._events[g],v=arguments.length,m,y;if(C.fn){switch(C.once&&this.removeListener(c,C.fn,void 0,!0),v){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,u),!0;case 3:return C.fn.call(C.context,u,d),!0;case 4:return C.fn.call(C.context,u,d,f),!0;case 5:return C.fn.call(C.context,u,d,f,h),!0;case 6:return C.fn.call(C.context,u,d,f,h,p),!0}for(y=1,m=new Array(v-1);y<v;y++)m[y-1]=arguments[y];C.fn.apply(C.context,m)}else{var x=C.length,b;for(y=0;y<x;y++)switch(C[y].once&&this.removeListener(c,C[y].fn,void 0,!0),v){case 1:C[y].fn.call(C[y].context);break;case 2:C[y].fn.call(C[y].context,u);break;case 3:C[y].fn.call(C[y].context,u,d);break;case 4:C[y].fn.call(C[y].context,u,d,f);break;default:if(!m)for(b=1,m=new Array(v-1);b<v;b++)m[b-1]=arguments[b];C[y].fn.apply(C[y].context,m)}}return!0},a.prototype.on=function(c,u,d){return o(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return o(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var h=n?n+c:c;if(!this._events[h])return this;if(!u)return s(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&s(this,h);else{for(var g=0,C=[],v=p.length;g<v;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&C.push(p[g]);C.length?this._events[h]=C.length===1?C[0]:C:s(this,h)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(ZT);var L4=ZT.exports;const _p=tu(L4);var _n={},Dp={};Dp.byteLength=G4;Dp.toByteArray=j4;Dp.fromByteArray=Z4;var mo=[],ai=[],U4=typeof Uint8Array<"u"?Uint8Array:Array,Og="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Jl=0,V4=Og.length;Jl<V4;++Jl)mo[Jl]=Og[Jl],ai[Og.charCodeAt(Jl)]=Jl;ai[45]=62;ai[95]=63;function $T(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function G4(t){var e=$T(t),n=e[0],r=e[1];return(n+r)*3/4-r}function W4(t,e,n){return(e+n)*3/4-n}function j4(t){var e,n=$T(t),r=n[0],i=n[1],o=new U4(W4(t,r,i)),s=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)e=ai[t.charCodeAt(l)]<<18|ai[t.charCodeAt(l+1)]<<12|ai[t.charCodeAt(l+2)]<<6|ai[t.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=ai[t.charCodeAt(l)]<<2|ai[t.charCodeAt(l+1)]>>4,o[s++]=e&255),i===1&&(e=ai[t.charCodeAt(l)]<<10|ai[t.charCodeAt(l+1)]<<4|ai[t.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function z4(t){return mo[t>>18&63]+mo[t>>12&63]+mo[t>>6&63]+mo[t&63]}function H4(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(z4(r));return i.join("")}function Z4(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(H4(t,s,s+o>a?a:s+o));return r===1?(e=t[n-1],i.push(mo[e>>2]+mo[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(mo[e>>10]+mo[e>>4&63]+mo[e<<2&63]+"=")),i.join("")}var b1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */b1.read=function(t,e,n,r,i){var o,s,a=i*8-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,o=h&(1<<-u)-1,h>>=-u,u+=a;u>0;o=o*256+t[e+d],d+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+t[e+d],d+=f,u-=8);if(o===0)o=1-c;else{if(o===l)return s?NaN:(h?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-c}return(h?-1:1)*s*Math.pow(2,o-r)};b1.write=function(t,e,n,r,i,o){var s,a,l,c=o*8-i-1,u=(1<<c)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?e+=f/l:e+=f*Math.pow(2,1-d),e*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(e*l-1)*Math.pow(2,i),s=s+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+h]=s&255,h+=p,s/=256,c-=8);t[n+h-p]|=g*128};(function(t){const e=Dp,n=b1,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const _=new Uint8Array(1),I={foo:function(){return 42}};return Object.setPrototypeOf(I,Uint8Array.prototype),Object.setPrototypeOf(_,I),_.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(_){if(_>i)throw new RangeError('The value "'+_+'" is invalid for option "size"');const I=new Uint8Array(_);return Object.setPrototypeOf(I,a.prototype),I}function a(_,I,w){if(typeof _=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(_)}return l(_,I,w)}a.poolSize=8192;function l(_,I,w){if(typeof _=="string")return f(_,I);if(ArrayBuffer.isView(_))return p(_);if(_==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(Qe(_,ArrayBuffer)||_&&Qe(_.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Qe(_,SharedArrayBuffer)||_&&Qe(_.buffer,SharedArrayBuffer)))return g(_,I,w);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const B=_.valueOf&&_.valueOf();if(B!=null&&B!==_)return a.from(B,I,w);const W=C(_);if(W)return W;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return a.from(_[Symbol.toPrimitive]("string"),I,w);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}a.from=function(_,I,w){return l(_,I,w)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(_<0)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function u(_,I,w){return c(_),_<=0?s(_):I!==void 0?typeof w=="string"?s(_).fill(I,w):s(_).fill(I):s(_)}a.alloc=function(_,I,w){return u(_,I,w)};function d(_){return c(_),s(_<0?0:v(_)|0)}a.allocUnsafe=function(_){return d(_)},a.allocUnsafeSlow=function(_){return d(_)};function f(_,I){if((typeof I!="string"||I==="")&&(I="utf8"),!a.isEncoding(I))throw new TypeError("Unknown encoding: "+I);const w=y(_,I)|0;let B=s(w);const W=B.write(_,I);return W!==w&&(B=B.slice(0,W)),B}function h(_){const I=_.length<0?0:v(_.length)|0,w=s(I);for(let B=0;B<I;B+=1)w[B]=_[B]&255;return w}function p(_){if(Qe(_,Uint8Array)){const I=new Uint8Array(_);return g(I.buffer,I.byteOffset,I.byteLength)}return h(_)}function g(_,I,w){if(I<0||_.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<I+(w||0))throw new RangeError('"length" is outside of buffer bounds');let B;return I===void 0&&w===void 0?B=new Uint8Array(_):w===void 0?B=new Uint8Array(_,I):B=new Uint8Array(_,I,w),Object.setPrototypeOf(B,a.prototype),B}function C(_){if(a.isBuffer(_)){const I=v(_.length)|0,w=s(I);return w.length===0||_.copy(w,0,0,I),w}if(_.length!==void 0)return typeof _.length!="number"||Wt(_.length)?s(0):h(_);if(_.type==="Buffer"&&Array.isArray(_.data))return h(_.data)}function v(_){if(_>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return _|0}function m(_){return+_!=_&&(_=0),a.alloc(+_)}a.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==a.prototype},a.compare=function(I,w){if(Qe(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),Qe(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),!a.isBuffer(I)||!a.isBuffer(w))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===w)return 0;let B=I.length,W=w.length;for(let Y=0,te=Math.min(B,W);Y<te;++Y)if(I[Y]!==w[Y]){B=I[Y],W=w[Y];break}return B<W?-1:W<B?1:0},a.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(I,w){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return a.alloc(0);let B;if(w===void 0)for(w=0,B=0;B<I.length;++B)w+=I[B].length;const W=a.allocUnsafe(w);let Y=0;for(B=0;B<I.length;++B){let te=I[B];if(Qe(te,Uint8Array))Y+te.length>W.length?(a.isBuffer(te)||(te=a.from(te)),te.copy(W,Y)):Uint8Array.prototype.set.call(W,te,Y);else if(a.isBuffer(te))te.copy(W,Y);else throw new TypeError('"list" argument must be an Array of Buffers');Y+=te.length}return W};function y(_,I){if(a.isBuffer(_))return _.length;if(ArrayBuffer.isView(_)||Qe(_,ArrayBuffer))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);const w=_.length,B=arguments.length>2&&arguments[2]===!0;if(!B&&w===0)return 0;let W=!1;for(;;)switch(I){case"ascii":case"latin1":case"binary":return w;case"utf8":case"utf-8":return Ue(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w*2;case"hex":return w>>>1;case"base64":return $e(_).length;default:if(W)return B?-1:Ue(_).length;I=(""+I).toLowerCase(),W=!0}}a.byteLength=y;function x(_,I,w){let B=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((w===void 0||w>this.length)&&(w=this.length),w<=0)||(w>>>=0,I>>>=0,w<=I))return"";for(_||(_="utf8");;)switch(_){case"hex":return Q(this,I,w);case"utf8":case"utf-8":return G(this,I,w);case"ascii":return ie(this,I,w);case"latin1":case"binary":return $(this,I,w);case"base64":return L(this,I,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,I,w);default:if(B)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),B=!0}}a.prototype._isBuffer=!0;function b(_,I,w){const B=_[I];_[I]=_[w],_[w]=B}a.prototype.swap16=function(){const I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let w=0;w<I;w+=2)b(this,w,w+1);return this},a.prototype.swap32=function(){const I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let w=0;w<I;w+=4)b(this,w,w+3),b(this,w+1,w+2);return this},a.prototype.swap64=function(){const I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let w=0;w<I;w+=8)b(this,w,w+7),b(this,w+1,w+6),b(this,w+2,w+5),b(this,w+3,w+4);return this},a.prototype.toString=function(){const I=this.length;return I===0?"":arguments.length===0?G(this,0,I):x.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(I){if(!a.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:a.compare(this,I)===0},a.prototype.inspect=function(){let I="";const w=t.INSPECT_MAX_BYTES;return I=this.toString("hex",0,w).replace(/(.{2})/g,"$1 ").trim(),this.length>w&&(I+=" ... "),"<Buffer "+I+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(I,w,B,W,Y){if(Qe(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(w===void 0&&(w=0),B===void 0&&(B=I?I.length:0),W===void 0&&(W=0),Y===void 0&&(Y=this.length),w<0||B>I.length||W<0||Y>this.length)throw new RangeError("out of range index");if(W>=Y&&w>=B)return 0;if(W>=Y)return-1;if(w>=B)return 1;if(w>>>=0,B>>>=0,W>>>=0,Y>>>=0,this===I)return 0;let te=Y-W,Ne=B-w;const tt=Math.min(te,Ne),lt=this.slice(W,Y),ht=I.slice(w,B);for(let nt=0;nt<tt;++nt)if(lt[nt]!==ht[nt]){te=lt[nt],Ne=ht[nt];break}return te<Ne?-1:Ne<te?1:0};function E(_,I,w,B,W){if(_.length===0)return-1;if(typeof w=="string"?(B=w,w=0):w>2147483647?w=2147483647:w<-2147483648&&(w=-2147483648),w=+w,Wt(w)&&(w=W?0:_.length-1),w<0&&(w=_.length+w),w>=_.length){if(W)return-1;w=_.length-1}else if(w<0)if(W)w=0;else return-1;if(typeof I=="string"&&(I=a.from(I,B)),a.isBuffer(I))return I.length===0?-1:A(_,I,w,B,W);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?W?Uint8Array.prototype.indexOf.call(_,I,w):Uint8Array.prototype.lastIndexOf.call(_,I,w):A(_,[I],w,B,W);throw new TypeError("val must be string, number or Buffer")}function A(_,I,w,B,W){let Y=1,te=_.length,Ne=I.length;if(B!==void 0&&(B=String(B).toLowerCase(),B==="ucs2"||B==="ucs-2"||B==="utf16le"||B==="utf-16le")){if(_.length<2||I.length<2)return-1;Y=2,te/=2,Ne/=2,w/=2}function tt(ht,nt){return Y===1?ht[nt]:ht.readUInt16BE(nt*Y)}let lt;if(W){let ht=-1;for(lt=w;lt<te;lt++)if(tt(_,lt)===tt(I,ht===-1?0:lt-ht)){if(ht===-1&&(ht=lt),lt-ht+1===Ne)return ht*Y}else ht!==-1&&(lt-=lt-ht),ht=-1}else for(w+Ne>te&&(w=te-Ne),lt=w;lt>=0;lt--){let ht=!0;for(let nt=0;nt<Ne;nt++)if(tt(_,lt+nt)!==tt(I,nt)){ht=!1;break}if(ht)return lt}return-1}a.prototype.includes=function(I,w,B){return this.indexOf(I,w,B)!==-1},a.prototype.indexOf=function(I,w,B){return E(this,I,w,B,!0)},a.prototype.lastIndexOf=function(I,w,B){return E(this,I,w,B,!1)};function k(_,I,w,B){w=Number(w)||0;const W=_.length-w;B?(B=Number(B),B>W&&(B=W)):B=W;const Y=I.length;B>Y/2&&(B=Y/2);let te;for(te=0;te<B;++te){const Ne=parseInt(I.substr(te*2,2),16);if(Wt(Ne))return te;_[w+te]=Ne}return te}function D(_,I,w,B){return st(Ue(I,_.length-w),_,w,B)}function T(_,I,w,B){return st(Le(I),_,w,B)}function R(_,I,w,B){return st($e(I),_,w,B)}function P(_,I,w,B){return st(Pe(I,_.length-w),_,w,B)}a.prototype.write=function(I,w,B,W){if(w===void 0)W="utf8",B=this.length,w=0;else if(B===void 0&&typeof w=="string")W=w,B=this.length,w=0;else if(isFinite(w))w=w>>>0,isFinite(B)?(B=B>>>0,W===void 0&&(W="utf8")):(W=B,B=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Y=this.length-w;if((B===void 0||B>Y)&&(B=Y),I.length>0&&(B<0||w<0)||w>this.length)throw new RangeError("Attempt to write outside buffer bounds");W||(W="utf8");let te=!1;for(;;)switch(W){case"hex":return k(this,I,w,B);case"utf8":case"utf-8":return D(this,I,w,B);case"ascii":case"latin1":case"binary":return T(this,I,w,B);case"base64":return R(this,I,w,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,I,w,B);default:if(te)throw new TypeError("Unknown encoding: "+W);W=(""+W).toLowerCase(),te=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(_,I,w){return I===0&&w===_.length?e.fromByteArray(_):e.fromByteArray(_.slice(I,w))}function G(_,I,w){w=Math.min(_.length,w);const B=[];let W=I;for(;W<w;){const Y=_[W];let te=null,Ne=Y>239?4:Y>223?3:Y>191?2:1;if(W+Ne<=w){let tt,lt,ht,nt;switch(Ne){case 1:Y<128&&(te=Y);break;case 2:tt=_[W+1],(tt&192)===128&&(nt=(Y&31)<<6|tt&63,nt>127&&(te=nt));break;case 3:tt=_[W+1],lt=_[W+2],(tt&192)===128&&(lt&192)===128&&(nt=(Y&15)<<12|(tt&63)<<6|lt&63,nt>2047&&(nt<55296||nt>57343)&&(te=nt));break;case 4:tt=_[W+1],lt=_[W+2],ht=_[W+3],(tt&192)===128&&(lt&192)===128&&(ht&192)===128&&(nt=(Y&15)<<18|(tt&63)<<12|(lt&63)<<6|ht&63,nt>65535&&nt<1114112&&(te=nt))}}te===null?(te=65533,Ne=1):te>65535&&(te-=65536,B.push(te>>>10&1023|55296),te=56320|te&1023),B.push(te),W+=Ne}return q(B)}const Z=4096;function q(_){const I=_.length;if(I<=Z)return String.fromCharCode.apply(String,_);let w="",B=0;for(;B<I;)w+=String.fromCharCode.apply(String,_.slice(B,B+=Z));return w}function ie(_,I,w){let B="";w=Math.min(_.length,w);for(let W=I;W<w;++W)B+=String.fromCharCode(_[W]&127);return B}function $(_,I,w){let B="";w=Math.min(_.length,w);for(let W=I;W<w;++W)B+=String.fromCharCode(_[W]);return B}function Q(_,I,w){const B=_.length;(!I||I<0)&&(I=0),(!w||w<0||w>B)&&(w=B);let W="";for(let Y=I;Y<w;++Y)W+=jt[_[Y]];return W}function ne(_,I,w){const B=_.slice(I,w);let W="";for(let Y=0;Y<B.length-1;Y+=2)W+=String.fromCharCode(B[Y]+B[Y+1]*256);return W}a.prototype.slice=function(I,w){const B=this.length;I=~~I,w=w===void 0?B:~~w,I<0?(I+=B,I<0&&(I=0)):I>B&&(I=B),w<0?(w+=B,w<0&&(w=0)):w>B&&(w=B),w<I&&(w=I);const W=this.subarray(I,w);return Object.setPrototypeOf(W,a.prototype),W};function O(_,I,w){if(_%1!==0||_<0)throw new RangeError("offset is not uint");if(_+I>w)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=this[I],Y=1,te=0;for(;++te<w&&(Y*=256);)W+=this[I+te]*Y;return W},a.prototype.readUintBE=a.prototype.readUIntBE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=this[I+--w],Y=1;for(;w>0&&(Y*=256);)W+=this[I+--w]*Y;return W},a.prototype.readUint8=a.prototype.readUInt8=function(I,w){return I=I>>>0,w||O(I,1,this.length),this[I]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(I,w){return I=I>>>0,w||O(I,2,this.length),this[I]|this[I+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(I,w){return I=I>>>0,w||O(I,2,this.length),this[I]<<8|this[I+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(I,w){return I=I>>>0,w||O(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(I,w){return I=I>>>0,w||O(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},a.prototype.readBigUInt64LE=wt(function(I){I=I>>>0,at(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&ot(I,this.length-8);const W=w+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24,Y=this[++I]+this[++I]*2**8+this[++I]*2**16+B*2**24;return BigInt(W)+(BigInt(Y)<<BigInt(32))}),a.prototype.readBigUInt64BE=wt(function(I){I=I>>>0,at(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&ot(I,this.length-8);const W=w*2**24+this[++I]*2**16+this[++I]*2**8+this[++I],Y=this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+B;return(BigInt(W)<<BigInt(32))+BigInt(Y)}),a.prototype.readIntLE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=this[I],Y=1,te=0;for(;++te<w&&(Y*=256);)W+=this[I+te]*Y;return Y*=128,W>=Y&&(W-=Math.pow(2,8*w)),W},a.prototype.readIntBE=function(I,w,B){I=I>>>0,w=w>>>0,B||O(I,w,this.length);let W=w,Y=1,te=this[I+--W];for(;W>0&&(Y*=256);)te+=this[I+--W]*Y;return Y*=128,te>=Y&&(te-=Math.pow(2,8*w)),te},a.prototype.readInt8=function(I,w){return I=I>>>0,w||O(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},a.prototype.readInt16LE=function(I,w){I=I>>>0,w||O(I,2,this.length);const B=this[I]|this[I+1]<<8;return B&32768?B|4294901760:B},a.prototype.readInt16BE=function(I,w){I=I>>>0,w||O(I,2,this.length);const B=this[I+1]|this[I]<<8;return B&32768?B|4294901760:B},a.prototype.readInt32LE=function(I,w){return I=I>>>0,w||O(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},a.prototype.readInt32BE=function(I,w){return I=I>>>0,w||O(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},a.prototype.readBigInt64LE=wt(function(I){I=I>>>0,at(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&ot(I,this.length-8);const W=this[I+4]+this[I+5]*2**8+this[I+6]*2**16+(B<<24);return(BigInt(W)<<BigInt(32))+BigInt(w+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24)}),a.prototype.readBigInt64BE=wt(function(I){I=I>>>0,at(I,"offset");const w=this[I],B=this[I+7];(w===void 0||B===void 0)&&ot(I,this.length-8);const W=(w<<24)+this[++I]*2**16+this[++I]*2**8+this[++I];return(BigInt(W)<<BigInt(32))+BigInt(this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+B)}),a.prototype.readFloatLE=function(I,w){return I=I>>>0,w||O(I,4,this.length),n.read(this,I,!0,23,4)},a.prototype.readFloatBE=function(I,w){return I=I>>>0,w||O(I,4,this.length),n.read(this,I,!1,23,4)},a.prototype.readDoubleLE=function(I,w){return I=I>>>0,w||O(I,8,this.length),n.read(this,I,!0,52,8)},a.prototype.readDoubleBE=function(I,w){return I=I>>>0,w||O(I,8,this.length),n.read(this,I,!1,52,8)};function j(_,I,w,B,W,Y){if(!a.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>W||I<Y)throw new RangeError('"value" argument is out of bounds');if(w+B>_.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(I,w,B,W){if(I=+I,w=w>>>0,B=B>>>0,!W){const Ne=Math.pow(2,8*B)-1;j(this,I,w,B,Ne,0)}let Y=1,te=0;for(this[w]=I&255;++te<B&&(Y*=256);)this[w+te]=I/Y&255;return w+B},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(I,w,B,W){if(I=+I,w=w>>>0,B=B>>>0,!W){const Ne=Math.pow(2,8*B)-1;j(this,I,w,B,Ne,0)}let Y=B-1,te=1;for(this[w+Y]=I&255;--Y>=0&&(te*=256);)this[w+Y]=I/te&255;return w+B},a.prototype.writeUint8=a.prototype.writeUInt8=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,1,255,0),this[w]=I&255,w+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,65535,0),this[w]=I&255,this[w+1]=I>>>8,w+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,65535,0),this[w]=I>>>8,this[w+1]=I&255,w+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,4294967295,0),this[w+3]=I>>>24,this[w+2]=I>>>16,this[w+1]=I>>>8,this[w]=I&255,w+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,4294967295,0),this[w]=I>>>24,this[w+1]=I>>>16,this[w+2]=I>>>8,this[w+3]=I&255,w+4};function J(_,I,w,B,W){ze(I,B,W,_,w,7);let Y=Number(I&BigInt(4294967295));_[w++]=Y,Y=Y>>8,_[w++]=Y,Y=Y>>8,_[w++]=Y,Y=Y>>8,_[w++]=Y;let te=Number(I>>BigInt(32)&BigInt(4294967295));return _[w++]=te,te=te>>8,_[w++]=te,te=te>>8,_[w++]=te,te=te>>8,_[w++]=te,w}function ee(_,I,w,B,W){ze(I,B,W,_,w,7);let Y=Number(I&BigInt(4294967295));_[w+7]=Y,Y=Y>>8,_[w+6]=Y,Y=Y>>8,_[w+5]=Y,Y=Y>>8,_[w+4]=Y;let te=Number(I>>BigInt(32)&BigInt(4294967295));return _[w+3]=te,te=te>>8,_[w+2]=te,te=te>>8,_[w+1]=te,te=te>>8,_[w]=te,w+8}a.prototype.writeBigUInt64LE=wt(function(I,w=0){return J(this,I,w,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=wt(function(I,w=0){return ee(this,I,w,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(I,w,B,W){if(I=+I,w=w>>>0,!W){const tt=Math.pow(2,8*B-1);j(this,I,w,B,tt-1,-tt)}let Y=0,te=1,Ne=0;for(this[w]=I&255;++Y<B&&(te*=256);)I<0&&Ne===0&&this[w+Y-1]!==0&&(Ne=1),this[w+Y]=(I/te>>0)-Ne&255;return w+B},a.prototype.writeIntBE=function(I,w,B,W){if(I=+I,w=w>>>0,!W){const tt=Math.pow(2,8*B-1);j(this,I,w,B,tt-1,-tt)}let Y=B-1,te=1,Ne=0;for(this[w+Y]=I&255;--Y>=0&&(te*=256);)I<0&&Ne===0&&this[w+Y+1]!==0&&(Ne=1),this[w+Y]=(I/te>>0)-Ne&255;return w+B},a.prototype.writeInt8=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,1,127,-128),I<0&&(I=255+I+1),this[w]=I&255,w+1},a.prototype.writeInt16LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,32767,-32768),this[w]=I&255,this[w+1]=I>>>8,w+2},a.prototype.writeInt16BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,2,32767,-32768),this[w]=I>>>8,this[w+1]=I&255,w+2},a.prototype.writeInt32LE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,2147483647,-2147483648),this[w]=I&255,this[w+1]=I>>>8,this[w+2]=I>>>16,this[w+3]=I>>>24,w+4},a.prototype.writeInt32BE=function(I,w,B){return I=+I,w=w>>>0,B||j(this,I,w,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[w]=I>>>24,this[w+1]=I>>>16,this[w+2]=I>>>8,this[w+3]=I&255,w+4},a.prototype.writeBigInt64LE=wt(function(I,w=0){return J(this,I,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=wt(function(I,w=0){return ee(this,I,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function se(_,I,w,B,W,Y){if(w+B>_.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("Index out of range")}function me(_,I,w,B,W){return I=+I,w=w>>>0,W||se(_,I,w,4),n.write(_,I,w,B,23,4),w+4}a.prototype.writeFloatLE=function(I,w,B){return me(this,I,w,!0,B)},a.prototype.writeFloatBE=function(I,w,B){return me(this,I,w,!1,B)};function Be(_,I,w,B,W){return I=+I,w=w>>>0,W||se(_,I,w,8),n.write(_,I,w,B,52,8),w+8}a.prototype.writeDoubleLE=function(I,w,B){return Be(this,I,w,!0,B)},a.prototype.writeDoubleBE=function(I,w,B){return Be(this,I,w,!1,B)},a.prototype.copy=function(I,w,B,W){if(!a.isBuffer(I))throw new TypeError("argument should be a Buffer");if(B||(B=0),!W&&W!==0&&(W=this.length),w>=I.length&&(w=I.length),w||(w=0),W>0&&W<B&&(W=B),W===B||I.length===0||this.length===0)return 0;if(w<0)throw new RangeError("targetStart out of bounds");if(B<0||B>=this.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("sourceEnd out of bounds");W>this.length&&(W=this.length),I.length-w<W-B&&(W=I.length-w+B);const Y=W-B;return this===I&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(w,B,W):Uint8Array.prototype.set.call(I,this.subarray(B,W),w),Y},a.prototype.fill=function(I,w,B,W){if(typeof I=="string"){if(typeof w=="string"?(W=w,w=0,B=this.length):typeof B=="string"&&(W=B,B=this.length),W!==void 0&&typeof W!="string")throw new TypeError("encoding must be a string");if(typeof W=="string"&&!a.isEncoding(W))throw new TypeError("Unknown encoding: "+W);if(I.length===1){const te=I.charCodeAt(0);(W==="utf8"&&te<128||W==="latin1")&&(I=te)}}else typeof I=="number"?I=I&255:typeof I=="boolean"&&(I=Number(I));if(w<0||this.length<w||this.length<B)throw new RangeError("Out of range index");if(B<=w)return this;w=w>>>0,B=B===void 0?this.length:B>>>0,I||(I=0);let Y;if(typeof I=="number")for(Y=w;Y<B;++Y)this[Y]=I;else{const te=a.isBuffer(I)?I:a.from(I,W),Ne=te.length;if(Ne===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(Y=0;Y<B-w;++Y)this[Y+w]=te[Y%Ne]}return this};const ae={};function Pt(_,I,w){ae[_]=class extends w{constructor(){super(),Object.defineProperty(this,"message",{value:I.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_}]`,this.stack,delete this.name}get code(){return _}set code(W){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:W,writable:!0})}toString(){return`${this.name} [${_}]: ${this.message}`}}}Pt("ERR_BUFFER_OUT_OF_BOUNDS",function(_){return _?`${_} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Pt("ERR_INVALID_ARG_TYPE",function(_,I){return`The "${_}" argument must be of type number. Received type ${typeof I}`},TypeError),Pt("ERR_OUT_OF_RANGE",function(_,I,w){let B=`The value of "${_}" is out of range.`,W=w;return Number.isInteger(w)&&Math.abs(w)>2**32?W=Gt(String(w)):typeof w=="bigint"&&(W=String(w),(w>BigInt(2)**BigInt(32)||w<-(BigInt(2)**BigInt(32)))&&(W=Gt(W)),W+="n"),B+=` It must be ${I}. Received ${W}`,B},RangeError);function Gt(_){let I="",w=_.length;const B=_[0]==="-"?1:0;for(;w>=B+4;w-=3)I=`_${_.slice(w-3,w)}${I}`;return`${_.slice(0,w)}${I}`}function fn(_,I,w){at(I,"offset"),(_[I]===void 0||_[I+w]===void 0)&&ot(I,_.length-(w+1))}function ze(_,I,w,B,W,Y){if(_>w||_<I){const te=typeof I=="bigint"?"n":"";let Ne;throw I===0||I===BigInt(0)?Ne=`>= 0${te} and < 2${te} ** ${(Y+1)*8}${te}`:Ne=`>= -(2${te} ** ${(Y+1)*8-1}${te}) and < 2 ** ${(Y+1)*8-1}${te}`,new ae.ERR_OUT_OF_RANGE("value",Ne,_)}fn(B,W,Y)}function at(_,I){if(typeof _!="number")throw new ae.ERR_INVALID_ARG_TYPE(I,"number",_)}function ot(_,I,w){throw Math.floor(_)!==_?(at(_,w),new ae.ERR_OUT_OF_RANGE("offset","an integer",_)):I<0?new ae.ERR_BUFFER_OUT_OF_BOUNDS:new ae.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${I}`,_)}const he=/[^+/0-9A-Za-z-_]/g;function Ce(_){if(_=_.split("=")[0],_=_.trim().replace(he,""),_.length<2)return"";for(;_.length%4!==0;)_=_+"=";return _}function Ue(_,I){I=I||1/0;let w;const B=_.length;let W=null;const Y=[];for(let te=0;te<B;++te){if(w=_.charCodeAt(te),w>55295&&w<57344){if(!W){if(w>56319){(I-=3)>-1&&Y.push(239,191,189);continue}else if(te+1===B){(I-=3)>-1&&Y.push(239,191,189);continue}W=w;continue}if(w<56320){(I-=3)>-1&&Y.push(239,191,189),W=w;continue}w=(W-55296<<10|w-56320)+65536}else W&&(I-=3)>-1&&Y.push(239,191,189);if(W=null,w<128){if((I-=1)<0)break;Y.push(w)}else if(w<2048){if((I-=2)<0)break;Y.push(w>>6|192,w&63|128)}else if(w<65536){if((I-=3)<0)break;Y.push(w>>12|224,w>>6&63|128,w&63|128)}else if(w<1114112){if((I-=4)<0)break;Y.push(w>>18|240,w>>12&63|128,w>>6&63|128,w&63|128)}else throw new Error("Invalid code point")}return Y}function Le(_){const I=[];for(let w=0;w<_.length;++w)I.push(_.charCodeAt(w)&255);return I}function Pe(_,I){let w,B,W;const Y=[];for(let te=0;te<_.length&&!((I-=2)<0);++te)w=_.charCodeAt(te),B=w>>8,W=w%256,Y.push(W),Y.push(B);return Y}function $e(_){return e.toByteArray(Ce(_))}function st(_,I,w,B){let W;for(W=0;W<B&&!(W+w>=I.length||W>=_.length);++W)I[W+w]=_[W];return W}function Qe(_,I){return _ instanceof I||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===I.name}function Wt(_){return _!==_}const jt=function(){const _="0123456789abcdef",I=new Array(256);for(let w=0;w<16;++w){const B=w*16;for(let W=0;W<16;++W)I[B+W]=_[w]+_[W]}return I}();function wt(_){return typeof BigInt>"u"?sn:_}function sn(){throw new Error("BigInt not supported")}})(_n);var Qu=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(Qu||{}),ed=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(ed||{});class $4{constructor(e){M(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class X4 extends _p{constructor(n){super();M(this,"state");M(this,"buffer");M(this,"subBuffer");M(this,"iacSEBuffer",_n.Buffer.from([255,240]));M(this,"negotiationByte",0);M(this,"stream");this.state=0,this.buffer=_n.Buffer.alloc(0),this.subBuffer=_n.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=_n.Buffer.concat([this.buffer,_n.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=_n.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=_n.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(n,r){this.stream.write(_n.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,o=_n.Buffer.from(i),s=_n.Buffer.concat([_n.Buffer.from([255,250]),_n.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(s)}sendTerminalType(n){const r=_n.Buffer.from(n),i=_n.Buffer.concat([_n.Buffer.from([255,250]),_n.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function K4({onlyFirst:t=!1}={}){const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(n,t?void 0:"g")}const J4=K4();function Y4(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(J4,"")}class q4{constructor(e){M(this,"editors");M(this,"channel");this.client=e,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(e){console.log("Opening editor window for session:",e);const n=e.reference,r=this.editors.get(n);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(n),o=window.open(`/editor?reference=${i}`,"_blank"),s={...e,window:o,state:0};this.editors.set(n,s),o&&o.focus()}}saveEditorWindow(e){const n={reference:e.reference,type:e.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",n,e.contents)}setupChannelListeners(){this.channel.onmessage=e=>{console.log("Editor window message:",e);const{type:n,id:r,session:i}=e.data;switch(n){case"ready":console.log("Editor window ready, id:",r);const o=this.editors.get(r);if(o){o.state=1;const{window:a,...l}=o;this.channel.postMessage({type:"load",session:l})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const s=this.editors.get(r);s&&(s.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((e,n)=>{try{e.state===1&&e.window&&(console.log(`Closing editor window for ${n}`),e.window.close(),this.channel.postMessage({type:"shutdown",id:n}))}catch(r){console.error(`Error closing editor window ${n}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class Vt{constructor(e){M(this,"packageName");M(this,"packageVersion",1);M(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class Q4 extends Vt{constructor(){super(...arguments);M(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class XT extends Vt{constructor(){super(...arguments);M(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}handleVitals(n){console.log("Received Char.Vitals:",n),this.client.emit("vitals",n)}handleStatusVars(n){console.log("Received Char.StatusVars:",n),this.client.emit("statusVars",n)}handleStatus(n){console.log("Received Char.Status:",n),this.client.emit("statusUpdate",n)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class eO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Offer")}handleOffer(n){console.log("Received Char.Offer:",n),this.client.emit("offer",n)}sendOfferRequest(){this.sendData("Offer",{})}}class tO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Prompt")}handlePrompt(n){console.log("Received Char.Prompt:",n),this.client.emit("prompt",n)}sendPromptRequest(){this.sendData("Prompt",{})}}class nO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status")}handleStatus(n){console.log("Received Char.Status:",n),this.client.emit("status",n)}sendStatusRequest(){this.sendData("Status",{})}}class rO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status.AffectedBy")}handleAffectedBy(n){console.log("Received Char.Status.AffectedBy:",n),this.client.emit("statusAffectedBy",n)}sendAffectedByRequest(){this.sendData("AffectedBy",{})}}class iO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status.Conditions")}handleConditions(n){console.log("Received Char.Status.Conditions:",n),this.client.emit("statusConditions",n)}sendConditionsRequest(){this.sendData("Conditions",{})}}class oO extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Status.Timers")}handleTimers(n){console.log("Received Char.Status.Timers:",n),this.client.emit("statusTimers",n)}sendTimersRequest(){this.sendData("Timers",{})}}class KT extends Vt{constructor(){super(...arguments);M(this,"packageName","Client.FileTransfer")}sendCandidate(n,r){this.sendData("Candidate",{recipient:n,candidate:JSON.stringify(r)})}handleCandidate(n){const r=JSON.parse(n.candidate);this.client.webRTCService.handleIceCandidate(r)}handleOffer(n){console.log("[GMCPClientFileTransfer] Received offer:",n),this.client.fileTransferManager.pendingOffers.set(`${n.hash}`,n),this.client.onFileTransferOffer(n.sender,n.hash,n.filename,n.filesize,n.offerSdp)}handleAccept(n){this.client.onFileTransferAccept(n.sender,n.hash,n.filename,n.answerSdp)}handleReject(n){this.client.onFileTransferReject(n.sender,n.hash)}handleCancel(n){this.client.onFileTransferCancel(n.sender,n.hash)}sendOffer(n,r,i,o,s){this.sendData("Offer",{recipient:n,filename:r,filesize:i,offerSdp:o,hash:s})}sendAccept(n,r,i,o){this.sendData("Accept",{sender:n,hash:r,filename:i,answerSdp:o})}sendReject(n,r){this.sendData("Reject",{sender:n,hash:r})}sendCancel(n,r){this.sendData("Cancel",{recipient:n,hash:r})}sendRequestResend(n,r){this.sendData("RequestResend",{sender:n,hash:r})}}function A1(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ml=A1();function JT(t){Ml=t}const Cd={exec:()=>null};function gt(t,e=""){let n=typeof t=="string"?t:t.source;const r={replace:(i,o)=>{let s=typeof o=="string"?o:o.source;return s=s.replace(lr.caret,"$1"),n=n.replace(i,s),r},getRegex:()=>new RegExp(n,e)};return r}const lr={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},sO=/^(?:[ \t]*(?:\n|$))+/,aO=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,lO=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Af=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,cO=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,w1=/(?:[*+-]|\d{1,9}[.)])/,YT=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,qT=gt(YT).replace(/bull/g,w1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),uO=gt(YT).replace(/bull/g,w1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),S1=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,dO=/^[^\n]+/,k1=/(?!\s*\])(?:\\.|[^\[\]\\])+/,fO=gt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",k1).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),hO=gt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,w1).getRegex(),Pp="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",E1=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,pO=gt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",E1).replace("tag",Pp).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),QT=gt(S1).replace("hr",Af).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex(),gO=gt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",QT).getRegex(),T1={blockquote:gO,code:aO,def:fO,fences:lO,heading:cO,hr:Af,html:pO,lheading:qT,list:hO,newline:sO,paragraph:QT,table:Cd,text:dO},Db=gt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Af).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex(),mO={...T1,lheading:uO,table:Db,paragraph:gt(S1).replace("hr",Af).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Db).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex()},vO={...T1,html:gt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",E1).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Cd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:gt(S1).replace("hr",Af).replace("heading",` *#{1,6} *[^
]`).replace("lheading",qT).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},CO=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yO=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,e2=/^( {2,}|\\)\n(?!\s*$)/,xO=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Np=/[\p{P}\p{S}]/u,R1=/[\s\p{P}\p{S}]/u,t2=/[^\s\p{P}\p{S}]/u,IO=gt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,R1).getRegex(),n2=/(?!~)[\p{P}\p{S}]/u,bO=/(?!~)[\s\p{P}\p{S}]/u,AO=/(?:[^\s\p{P}\p{S}]|~)/u,wO=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,r2=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,SO=gt(r2,"u").replace(/punct/g,Np).getRegex(),kO=gt(r2,"u").replace(/punct/g,n2).getRegex(),i2="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",EO=gt(i2,"gu").replace(/notPunctSpace/g,t2).replace(/punctSpace/g,R1).replace(/punct/g,Np).getRegex(),TO=gt(i2,"gu").replace(/notPunctSpace/g,AO).replace(/punctSpace/g,bO).replace(/punct/g,n2).getRegex(),RO=gt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,t2).replace(/punctSpace/g,R1).replace(/punct/g,Np).getRegex(),_O=gt(/\\(punct)/,"gu").replace(/punct/g,Np).getRegex(),DO=gt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),PO=gt(E1).replace("(?:-->|$)","-->").getRegex(),NO=gt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",PO).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),R0=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,BO=gt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",R0).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),o2=gt(/^!?\[(label)\]\[(ref)\]/).replace("label",R0).replace("ref",k1).getRegex(),s2=gt(/^!?\[(ref)\](?:\[\])?/).replace("ref",k1).getRegex(),OO=gt("reflink|nolink(?!\\()","g").replace("reflink",o2).replace("nolink",s2).getRegex(),_1={_backpedal:Cd,anyPunctuation:_O,autolink:DO,blockSkip:wO,br:e2,code:yO,del:Cd,emStrongLDelim:SO,emStrongRDelimAst:EO,emStrongRDelimUnd:RO,escape:CO,link:BO,nolink:s2,punctuation:IO,reflink:o2,reflinkSearch:OO,tag:NO,text:xO,url:Cd},FO={..._1,link:gt(/^!?\[(label)\]\((.*?)\)/).replace("label",R0).getRegex(),reflink:gt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",R0).getRegex()},tC={..._1,emStrongRDelimAst:TO,emStrongLDelim:kO,url:gt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},MO={...tC,br:gt(e2).replace("{2,}","*").getRegex(),text:gt(tC.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},th={normal:T1,gfm:mO,pedantic:vO},Bu={normal:_1,gfm:tC,breaks:MO,pedantic:FO},LO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Pb=t=>LO[t];function lo(t,e){if(e){if(lr.escapeTest.test(t))return t.replace(lr.escapeReplace,Pb)}else if(lr.escapeTestNoEncode.test(t))return t.replace(lr.escapeReplaceNoEncode,Pb);return t}function Nb(t){try{t=encodeURI(t).replace(lr.percentDecode,"%")}catch{return null}return t}function Bb(t,e){var o;const n=t.replace(lr.findPipe,(s,a,l)=>{let c=!1,u=a;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(lr.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(lr.slashPipe,"|");return r}function Ou(t,e,n){const r=t.length;if(r===0)return"";let i=0;for(;i<r&&t.charAt(r-i-1)===e;)i++;return t.slice(0,r-i)}function UO(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return-1}function Ob(t,e,n,r,i){const o=e.href,s=e.title||null,a=t[1].replace(i.other.outputLinkReplace,"$1");if(t[0].charAt(0)!=="!"){r.state.inLink=!0;const l={type:"link",raw:n,href:o,title:s,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,l}return{type:"image",raw:n,href:o,title:s,text:a}}function VO(t,e,n){const r=t.match(n.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(o=>{const s=o.match(n.other.beginningSpace);if(s===null)return o;const[a]=s;return a.length>=i.length?o.slice(i.length):o}).join(`
`)}class _0{constructor(e){M(this,"options");M(this,"rules");M(this,"lexer");this.options=e||Ml}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const r=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ou(r,`
`)}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const r=n[0],i=VO(r,n[3]||"",this.rules);return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:i}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let r=n[2].trim();if(this.rules.other.endingHash.test(r)){const i=Ou(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:Ou(n[0],`
`)}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){let r=Ou(n[0],`
`).split(`
`),i="",o="";const s=[];for(;r.length>0;){let a=!1;const l=[];let c;for(c=0;c<r.length;c++)if(this.rules.other.blockquoteStart.test(r[c]))l.push(r[c]),a=!0;else if(!a)l.push(r[c]);else break;r=r.slice(c);const u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,o=o?`${o}
${d}`:d;const f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,s,!0),this.lexer.state.top=f,r.length===0)break;const h=s.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const p=h,g=p.raw+`
`+r.join(`
`),C=this.blockquote(g);s[s.length-1]=C,i=i.substring(0,i.length-p.raw.length)+C.raw,o=o.substring(0,o.length-p.text.length)+C.text;break}else if((h==null?void 0:h.type)==="list"){const p=h,g=p.raw+`
`+r.join(`
`),C=this.list(g);s[s.length-1]=C,i=i.substring(0,i.length-h.raw.length)+C.raw,o=o.substring(0,o.length-p.raw.length)+C.raw,r=g.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:o}}}list(e){let n=this.rules.block.list.exec(e);if(n){let r=n[1].trim();const i=r.length>1,o={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const s=this.rules.other.listItemRegex(r);let a=!1;for(;e;){let c=!1,u="",d="";if(!(n=s.exec(e))||this.rules.block.hr.test(e))break;u=n[0],e=e.substring(u.length);let f=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,m=>" ".repeat(3*m.length)),h=e.split(`
`,1)[0],p=!f.trim(),g=0;if(this.options.pedantic?(g=2,d=f.trimStart()):p?g=n[1].length+1:(g=n[2].search(this.rules.other.nonSpaceChar),g=g>4?1:g,d=f.slice(g),g+=n[1].length),p&&this.rules.other.blankLine.test(h)&&(u+=h+`
`,e=e.substring(h.length+1),c=!0),!c){const m=this.rules.other.nextBulletRegex(g),y=this.rules.other.hrRegex(g),x=this.rules.other.fencesBeginRegex(g),b=this.rules.other.headingBeginRegex(g),E=this.rules.other.htmlBeginRegex(g);for(;e;){const A=e.split(`
`,1)[0];let k;if(h=A,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),k=h):k=h.replace(this.rules.other.tabCharGlobal,"    "),x.test(h)||b.test(h)||E.test(h)||m.test(h)||y.test(h))break;if(k.search(this.rules.other.nonSpaceChar)>=g||!h.trim())d+=`
`+k.slice(g);else{if(p||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||x.test(f)||b.test(f)||y.test(f))break;d+=`
`+h}!p&&!h.trim()&&(p=!0),u+=A+`
`,e=e.substring(A.length+1),f=k.slice(g)}}o.loose||(a?o.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(a=!0));let C=null,v;this.options.gfm&&(C=this.rules.other.listIsTask.exec(d),C&&(v=C[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:u,task:!!C,checked:v,loose:!1,text:d,tokens:[]}),o.raw+=u}const l=o.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){const u=o.items[c].tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));o.loose=d}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}html(e){const n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){const n=this.rules.block.def.exec(e);if(n){const r=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:i,title:o}}}table(e){var a;const n=this.rules.block.table.exec(e);if(!n||!this.rules.other.tableDelimiter.test(n[2]))return;const r=Bb(n[1]),i=n[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=(a=n[3])!=null&&a.trim()?n[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:n[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const l of i)this.rules.other.tableAlignRight.test(l)?s.align.push("right"):this.rules.other.tableAlignCenter.test(l)?s.align.push("center"):this.rules.other.tableAlignLeft.test(l)?s.align.push("left"):s.align.push(null);for(let l=0;l<r.length;l++)s.header.push({text:r[l],tokens:this.lexer.inline(r[l]),header:!0,align:s.align[l]});for(const l of o)s.rows.push(Bb(l,s.header.length).map((c,u)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:s.align[u]})));return s}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const r=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const s=Ou(r.slice(0,-1),"\\");if((r.length-s.length)%2===0)return}else{const s=UO(n[2],"()");if(s>-1){const l=(n[0].indexOf("!")===0?5:4)+n[1].length+s;n[2]=n[2].substring(0,s),n[0]=n[0].substring(0,l).trim(),n[3]=""}}let i=n[2],o="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],o=s[3])}else o=n[3]?n[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i=i.slice(1):i=i.slice(1,-1)),Ob(n,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(e,n){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=n[i.toLowerCase()];if(!o){const s=r[0].charAt(0);return{type:"text",raw:s,text:s}}return Ob(r,o,r[0],this.lexer,this.rules)}}emStrong(e,n,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const s=[...i[0]].length-1;let a,l,c=s,u=0;const d=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,n=n.slice(-1*e.length+s);(i=d.exec(n))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(l=[...a].length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&s%3&&!((s+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);const f=[...i[0]][0].length,h=e.slice(0,s+i.index+f+l);if(Math.min(s,l)%2){const g=h.slice(1,-1);return{type:"em",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}const p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let r=n[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(r),o=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&o&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:n[0],text:r}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){const n=this.rules.inline.autolink.exec(e);if(n){let r,i;return n[2]==="@"?(r=n[1],i="mailto:"+r):(r=n[1],i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let n;if(n=this.rules.inline.url.exec(e)){let i,o;if(n[2]==="@")i=n[0],o="mailto:"+i;else{let s;do s=n[0],n[0]=((r=this.rules.inline._backpedal.exec(n[0]))==null?void 0:r[0])??"";while(s!==n[0]);i=n[0],n[1]==="www."?o="http://"+n[0]:o=n[0]}return{type:"link",raw:n[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const n=this.rules.inline.text.exec(e);if(n){const r=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:r}}}}class hi{constructor(e){M(this,"tokens");M(this,"options");M(this,"state");M(this,"tokenizer");M(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ml,this.options.tokenizer=this.options.tokenizer||new _0,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:lr,block:th.normal,inline:Bu.normal};this.options.pedantic?(n.block=th.pedantic,n.inline=Bu.pedantic):this.options.gfm&&(n.block=th.gfm,this.options.breaks?n.inline=Bu.breaks:n.inline=Bu.gfm),this.tokenizer.rules=n}static get rules(){return{block:th,inline:Bu}}static lex(e,n){return new hi(n).lex(e)}static lexInline(e,n){return new hi(n).inlineTokens(e)}lex(e){e=e.replace(lr.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var i,o,s;for(this.options.pedantic&&(e=e.replace(lr.tabCharGlobal,"    ").replace(lr.spaceLine,""));e;){let a;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(c=>(a=c.call({lexer:this},e,n))?(e=e.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);const c=n.at(-1);a.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),n.push(a);continue}let l=e;if((s=this.options.extensions)!=null&&s.startBlock){let c=1/0;const u=e.slice(1);let d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(this.state.top&&(a=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a),r=l.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var a,l,c;let r=e,i=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,s="";for(;e;){o||(s=""),o=!1;let u;if((l=(a=this.options.extensions)==null?void 0:a.inline)!=null&&l.some(f=>(u=f.call({lexer:this},e,n))?(e=e.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);const f=n.at(-1);u.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(e,r,s)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),n.push(u);continue}let d=e;if((c=this.options.extensions)!=null&&c.startInline){let f=1/0;const h=e.slice(1);let p;this.options.extensions.startInline.forEach(g=>{p=g.call({lexer:this},h),typeof p=="number"&&p>=0&&(f=Math.min(f,p))}),f<1/0&&f>=0&&(d=e.substring(0,f+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(s=u.raw.slice(-1)),o=!0;const f=n.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):n.push(u);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}}class D0{constructor(e){M(this,"options");M(this,"parser");this.options=e||Ml}space(e){return""}code({text:e,lang:n,escaped:r}){var s;const i=(s=(n||"").match(lr.notSpaceStart))==null?void 0:s[0],o=e.replace(lr.endingNewline,"")+`
`;return i?'<pre><code class="language-'+lo(i)+'">'+(r?o:lo(o,!0))+`</code></pre>
`:"<pre><code>"+(r?o:lo(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:n}){return`<h${n}>${this.parser.parseInline(e)}</h${n}>
`}hr(e){return`<hr>
`}list(e){const n=e.ordered,r=e.start;let i="";for(let a=0;a<e.items.length;a++){const l=e.items[a];i+=this.listitem(l)}const o=n?"ol":"ul",s=n&&r!==1?' start="'+r+'"':"";return"<"+o+s+`>
`+i+"</"+o+`>
`}listitem(e){var r;let n="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?((r=e.tokens[0])==null?void 0:r.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+lo(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):n+=i+" "}return n+=this.parser.parse(e.tokens,!!e.loose),`<li>${n}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let n="",r="";for(let o=0;o<e.header.length;o++)r+=this.tablecell(e.header[o]);n+=this.tablerow({text:r});let i="";for(let o=0;o<e.rows.length;o++){const s=e.rows[o];r="";for(let a=0;a<s.length;a++)r+=this.tablecell(s[a]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const n=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+n+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${lo(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:n,tokens:r}){const i=this.parser.parseInline(r),o=Nb(e);if(o===null)return i;e=o;let s='<a href="'+e+'"';return n&&(s+=' title="'+lo(n)+'"'),s+=">"+i+"</a>",s}image({href:e,title:n,text:r}){const i=Nb(e);if(i===null)return lo(r);e=i;let o=`<img src="${e}" alt="${r}"`;return n&&(o+=` title="${lo(n)}"`),o+=">",o}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:lo(e.text)}}class D1{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class pi{constructor(e){M(this,"options");M(this,"renderer");M(this,"textRenderer");this.options=e||Ml,this.options.renderer=this.options.renderer||new D0,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new D1}static parse(e,n){return new pi(n).parse(e)}static parseInline(e,n){return new pi(n).parseInline(e)}parse(e,n=!0){var i,o;let r="";for(let s=0;s<e.length;s++){const a=e[s];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[a.type]){const c=a,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=a;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;s+1<e.length&&e[s+1].type==="text";)c=e[++s],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(e,n=this.renderer){var i,o;let r="";for(let s=0;s<e.length;s++){const a=e[s];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[a.type]){const c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=c||"";continue}}const l=a;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}}class yd{constructor(e){M(this,"options");M(this,"block");this.options=e||Ml}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?hi.lex:hi.lexInline}provideParser(){return this.block?pi.parse:pi.parseInline}}M(yd,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class GO{constructor(...e){M(this,"defaults",A1());M(this,"options",this.setOptions);M(this,"parse",this.parseMarkdown(!0));M(this,"parseInline",this.parseMarkdown(!1));M(this,"Parser",pi);M(this,"Renderer",D0);M(this,"TextRenderer",D1);M(this,"Lexer",hi);M(this,"Tokenizer",_0);M(this,"Hooks",yd);this.use(...e)}walkTokens(e,n){var i,o;let r=[];for(const s of e)switch(r=r.concat(n.call(this,s)),s.type){case"table":{const a=s;for(const l of a.header)r=r.concat(this.walkTokens(l.tokens,n));for(const l of a.rows)for(const c of l)r=r.concat(this.walkTokens(c.tokens,n));break}case"list":{const a=s;r=r.concat(this.walkTokens(a.items,n));break}default:{const a=s;(o=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&o[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const c=a[l].flat(1/0);r=r.concat(this.walkTokens(c,n))}):a.tokens&&(r=r.concat(this.walkTokens(a.tokens,n)))}}return r}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){const s=n.renderers[o.name];s?n.renderers[o.name]=function(...a){let l=o.renderer.apply(this,a);return l===!1&&(l=s.apply(this,a)),l}:n.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=n[o.level];s?s.unshift(o.tokenizer):n[o.level]=[o.tokenizer],o.start&&(o.level==="block"?n.startBlock?n.startBlock.push(o.start):n.startBlock=[o.start]:o.level==="inline"&&(n.startInline?n.startInline.push(o.start):n.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(n.childTokens[o.name]=o.childTokens)}),i.extensions=n),r.renderer){const o=this.defaults.renderer||new D0(this.defaults);for(const s in r.renderer){if(!(s in o))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const a=s,l=r.renderer[a],c=o[a];o[a]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d||""}}i.renderer=o}if(r.tokenizer){const o=this.defaults.tokenizer||new _0(this.defaults);for(const s in r.tokenizer){if(!(s in o))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const a=s,l=r.tokenizer[a],c=o[a];o[a]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d}}i.tokenizer=o}if(r.hooks){const o=this.defaults.hooks||new yd;for(const s in r.hooks){if(!(s in o))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const a=s,l=r.hooks[a],c=o[a];yd.passThroughHooks.has(s)?o[a]=u=>{if(this.defaults.async)return Promise.resolve(l.call(o,u)).then(f=>c.call(o,f));const d=l.call(o,u);return c.call(o,d)}:o[a]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d}}i.hooks=o}if(r.walkTokens){const o=this.defaults.walkTokens,s=r.walkTokens;i.walkTokens=function(a){let l=[];return l.push(s.call(this,a)),o&&(l=l.concat(o.call(this,a))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return hi.lex(e,n??this.defaults)}parser(e,n){return pi.parse(e,n??this.defaults)}parseMarkdown(e){return(r,i)=>{const o={...i},s={...this.defaults,...o},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&o.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const l=s.hooks?s.hooks.provideLexer():e?hi.lex:hi.lexInline,c=s.hooks?s.hooks.provideParser():e?pi.parse:pi.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(r):r).then(u=>l(u,s)).then(u=>s.hooks?s.hooks.processAllTokens(u):u).then(u=>s.walkTokens?Promise.all(this.walkTokens(u,s.walkTokens)).then(()=>u):u).then(u=>c(u,s)).then(u=>s.hooks?s.hooks.postprocess(u):u).catch(a);try{s.hooks&&(r=s.hooks.preprocess(r));let u=l(r,s);s.hooks&&(u=s.hooks.processAllTokens(u)),s.walkTokens&&this.walkTokens(u,s.walkTokens);let d=c(u,s);return s.hooks&&(d=s.hooks.postprocess(d)),d}catch(u){return a(u)}}}onError(e,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+lo(r.message+"",!0)+"</pre>";return n?Promise.resolve(i):i}if(n)return Promise.reject(r);throw r}}}const Sl=new GO;function Ct(t,e){return Sl.parse(t,e)}Ct.options=Ct.setOptions=function(t){return Sl.setOptions(t),Ct.defaults=Sl.defaults,JT(Ct.defaults),Ct};Ct.getDefaults=A1;Ct.defaults=Ml;Ct.use=function(...t){return Sl.use(...t),Ct.defaults=Sl.defaults,JT(Ct.defaults),Ct};Ct.walkTokens=function(t,e){return Sl.walkTokens(t,e)};Ct.parseInline=Sl.parseInline;Ct.Parser=pi;Ct.parser=pi.parse;Ct.Renderer=D0;Ct.TextRenderer=D1;Ct.Lexer=hi;Ct.lexer=hi.lex;Ct.Tokenizer=_0;Ct.Hooks=yd;Ct.parse=Ct;Ct.options;Ct.setOptions;Ct.use;Ct.walkTokens;Ct.parseInline;pi.parse;hi.lex;class WO extends Vt{constructor(n){super(n);M(this,"packageName","Client.Html")}handleAdd_html(n){this.client.emit("html",n.data.join(`
`))}handleAdd_markdown(n){const r=n.data.join(`
`),i=Ct(r);this.client.emit("html",i)}}class jO{constructor(){M(this,"state",{text:""});M(this,"listeners",new Set);M(this,"dispatch",e=>{const n=this.state;this.state=this.reducer(this.state,e),this.state!==n&&this.listeners.forEach(r=>r())})}reducer(e,n){switch(n.type){case"SET_INPUT":return e.text!==n.data?{...e,text:n.data}:e;case"CLEAR_INPUT":return e.text!==""?{...e,text:""}:e;default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const Ac=new jO,xd=t=>{Ac.dispatch({type:"SET_INPUT",data:t})},zO=()=>{Ac.dispatch({type:"CLEAR_INPUT"})};class HO extends Vt{constructor(n){super(n);M(this,"packageName","Client.Keystrokes");M(this,"bindings",[]);M(this,"boundKeyDownHandler");this.boundKeyDownHandler=this.handleKeydown.bind(this),document.addEventListener("keydown",this.boundKeyDownHandler)}handleKeydown(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=Ac.getState().text,o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",this.boundKeyDownHandler)}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"alt",n.ctrlKey&&"control",n.shiftKey&&"shift",n.metaKey&&"meta"].filter(Boolean)),o=new Set((r.modifiers||[]).map(s=>s.toLowerCase()));return i.size!==o.size?!1:Array.from(o).every(s=>i.has(s))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(o,s)=>{if(s==="*")return r;const a=parseInt(s,10)-1;return a>=0&&a<i.length?i[a]:o})}placeInInputField(n){xd(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){const r=new Set((n.modifiers||[]).map(i=>i.toLowerCase()));this.bindings=this.bindings.filter(i=>{const o=new Set((i.modifiers||[]).map(a=>a.toLowerCase()));return i.key.toLowerCase()!==n.key.toLowerCase()||o.size!==r.size?!0:!Array.from(r).every(a=>o.has(a))})}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}handleUnbindAll(n){console.log("Received Client.Keystrokes.UnbindAll, clearing all bindings."),this.unbindAll()}handleListBindings(n){console.log("Received Client.Keystrokes.ListBindings request, sending current bindings.");const r=this.listBindings();this.sendData("BindingsList",r)}listBindings(){return[...this.bindings]}}const Fb=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),Mb=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),nC=(t,e)=>({startTime:e,type:"setValue",value:t}),a2=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),l2=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),pc=t=>t.type==="exponentialRampToValue",P0=t=>t.type==="linearRampToValue",la=t=>pc(t)||P0(t),P1=t=>t.type==="setValue",Jo=t=>t.type==="setValueCurve",N0=(t,e,n,r)=>{const i=t[e];return i===void 0?r:la(i)||P1(i)?i.value:Jo(i)?i.values[i.values.length-1]:l2(n,N0(t,e-1,i.startTime,r),i)},Lb=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:la(n)?[n.endTime,n.value]:P1(n)?[n.startTime,n.value]:Jo(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,N0(t,e-1,n.startTime,i)],rC=t=>t.type==="cancelAndHold",iC=t=>t.type==="cancelScheduledValues",Js=t=>rC(t)||iC(t)?t.cancelTime:pc(t)||P0(t)?t.endTime:t.startTime,Ub=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,Vb=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),ZO=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},$O=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return ZO(r,i)},nh=t=>t.type==="setTarget";class XO{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Js(e);if(rC(e)||iC(e)){const r=this._automationEvents.findIndex(o=>iC(e)&&Jo(o)?o.startTime+o.duration>=n:Js(o)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),rC(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&la(i)){if(o!==void 0&&nh(o))throw new Error("The internal list is malformed.");const s=o===void 0?i.insertTime:Jo(o)?o.startTime+o.duration:Js(o),a=o===void 0?this._defaultValue:Jo(o)?o.values[o.values.length-1]:o.value,l=pc(i)?Ub(n,s,a,i):Vb(n,s,a,i),c=pc(i)?Fb(l,n,this._currenTime):Mb(l,n,this._currenTime);this._automationEvents.push(c)}if(o!==void 0&&nh(o)&&this._automationEvents.push(nC(this.getValue(n),n)),o!==void 0&&Jo(o)&&o.startTime+o.duration>n){const s=n-o.startTime,a=(o.values.length-1)/o.duration,l=Math.max(2,1+Math.ceil(s*a)),c=s/(l-1)*a,u=o.values.slice(0,l);if(c<1)for(let d=1;d<l;d+=1){const f=c*d%1;u[d]=o.values[d-1]*(1-f)+o.values[d]*f}this._automationEvents[this._automationEvents.length-1]=a2(u,o.startTime,s)}}}else{const r=this._automationEvents.findIndex(s=>Js(s)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Jo(i)&&Js(i)+i.duration>n)return!1;const o=pc(e)?Fb(e.value,e.endTime,this._currenTime):P0(e)?Mb(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(Jo(e)&&n+e.duration>Js(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>Js(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];nh(i)&&r.unshift(nC(N0(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(s=>Js(s)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(o!==void 0&&nh(o)&&(r===void 0||!la(r)||r.insertTime>e))return l2(e,N0(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&P1(o)&&(r===void 0||!la(r)))return o.value;if(o!==void 0&&Jo(o)&&(r===void 0||!la(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?$O(e,o):o.values[o.values.length-1];if(o!==void 0&&la(o)&&(r===void 0||!la(r)))return o.value;if(r!==void 0&&pc(r)){const[s,a]=Lb(this._automationEvents,i,o,r,this._defaultValue);return Ub(e,s,a,r)}if(r!==void 0&&P0(r)){const[s,a]=Lb(this._automationEvents,i,o,r,this._defaultValue);return Vb(e,s,a,r)}return this._defaultValue}}const KO=t=>({cancelTime:t,type:"cancelAndHold"}),JO=t=>({cancelTime:t,type:"cancelScheduledValues"}),YO=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),qO=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),QO=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),eF=()=>new DOMException("","AbortError"),tF=t=>(e,n,[r,i,o],s)=>{t(e[i],[n,r,o],a=>a[0]===n&&a[1]===r,s)},nF=t=>(e,n,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},rF=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Hc=new WeakSet,c2=new WeakMap,u2=new WeakMap,d2=new WeakMap,f2=new WeakMap,h2=new WeakMap,p2=new WeakMap,oC=new WeakMap,sC=new WeakMap,aC=new WeakMap,g2={construct(){return g2}},iF=t=>{try{const e=new Proxy(t,g2);new e}catch{return!1}return!0},Gb=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Wb=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(Gb);for(;i!==null;){const o=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(Gb)}return[n.join(";"),r]},jb=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},zb=t=>{if(!iF(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},oF=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>{let h=0;return(p,g,C={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(g))return Promise.resolve();const m=c.get(p);if(m!==void 0){const b=m.get(g);if(b!==void 0)return b}const y=o(p),x=y.audioWorklet===void 0?i(g).then(([b,E])=>{const[A,k]=Wb(b,E),D=`${A};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return n(D)}).then(()=>{const b=f._AWGS.pop();if(b===void 0)throw new SyntaxError;r(y.currentTime,y.sampleRate,()=>b(class{},void 0,(E,A)=>{if(E.trim()==="")throw e();const k=sC.get(y);if(k!==void 0){if(k.has(E))throw e();zb(A),jb(A.parameterDescriptors),k.set(E,A)}else zb(A),jb(A.parameterDescriptors),sC.set(y,new Map([[E,A]]))},y.sampleRate,void 0,void 0))}):Promise.all([i(g),Promise.resolve(t(d,d))]).then(([[b,E],A])=>{const k=h+1;h=k;const[D,T]=Wb(b,E),G=`${D};((AudioWorkletProcessor,registerProcessor)=>{${T}
})(${A?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${A?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${A?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,Z=new Blob([G],{type:"application/javascript; charset=utf-8"}),q=URL.createObjectURL(Z);return y.audioWorklet.addModule(q,C).then(()=>{if(a(y))return y;const ie=s(y);return ie.audioWorklet.addModule(q,C).then(()=>ie)}).then(ie=>{if(l===null)throw new SyntaxError;try{new l(ie,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(q))});return m===void 0?c.set(p,new Map([[g,x]])):m.set(g,x),x.then(()=>{const b=u.get(p);b===void 0?u.set(p,new Set([g])):b.add(g)}).finally(()=>{const b=c.get(p);b!==void 0&&b.delete(g)}),x}},Yi=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},Bp=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},m2=(t,e,n,r)=>{const i=Yi(t,e),o=Bp(i,s=>s[0]===n&&s[1]===r);return i.size===0&&t.delete(e),o},wf=t=>Yi(p2,t),Zc=t=>{if(Hc.has(t))throw new Error("The AudioNode is already stored.");Hc.add(t),wf(t).forEach(e=>e(!0))},v2=t=>"port"in t,Sf=t=>{if(!Hc.has(t))throw new Error("The AudioNode is not stored.");Hc.delete(t),wf(t).forEach(e=>e(!1))},lC=(t,e)=>{!v2(t)&&e.every(n=>n.size===0)&&Sf(t)},sF=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>{const h=new WeakMap;return(p,g,C,v,m)=>{const{activeInputs:y,passiveInputs:x}=o(g),{outputs:b}=o(p),E=a(p),A=k=>{const D=l(g),T=l(p);if(k){const R=m2(x,p,C,v);t(y,p,R,!1),!m&&!d(p)&&n(T,D,C,v),f(g)&&Zc(g)}else{const R=r(y,p,C,v);e(x,v,R,!1),!m&&!d(p)&&i(T,D,C,v);const P=s(g);if(P===0)u(g)&&lC(g,y);else{const L=h.get(g);L!==void 0&&clearTimeout(L),h.set(g,setTimeout(()=>{u(g)&&lC(g,y)},P*1e3))}}};return c(b,[g,C,v],k=>k[0]===g&&k[1]===C&&k[2]===v,!0)?(E.add(A),u(p)?t(y,p,[C,v,A],!0):e(x,v,[p,C,A],!0),!0):!1}},aF=t=>(e,n,[r,i,o],s)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,o]])):t(a,[i,n,o],l=>l[0]===i&&l[1]===n,s)},lF=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},cF=t=>(e,n)=>{t(e).add(n)},uF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},dF=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...uF,...l},d=r(c,u),f=o(c)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Qn=(t,e)=>t.context===e,fF=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},cC=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Wo=()=>new DOMException("","IndexSizeError"),C2=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?Wo():r}})(t.getChannelData)},hF={numberOfChannels:1},pF=(t,e,n,r,i,o,s,a)=>{let l=null;return class y2{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...hF,...u};l===null&&(l=new i(1,1,44100));const p=r!==null&&e(o,o)?new r({length:d,numberOfChannels:f,sampleRate:h}):l.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(s(p),C2(p)):e(cC,()=>cC(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===y2.prototype||t.has(u)}}},Kr=-34028234663852886e22,or=34028234663852886e22,_s=t=>Hc.has(t),gF={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},mF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...gF,...u},h=i(d,f),p=s(d),g=p?e():null;super(c,!1,h,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,or,Kr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?c:d}get playbackRate(){return this._playbackRate}start(c=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(c,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[c,u]:[c,u,d]),this.context.state!=="closed"){Zc(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),_s(this)&&Sf(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},vF=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=Qn(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,h),s!==null&&d.start(...s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,c.playbackRate,d.playbackRate):await r(u,c.playbackRate,d.playbackRate),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},CF=t=>"playbackRate"in t,yF=t=>"frequency"in t&&"gain"in t,xF=t=>"offset"in t,IF=t=>!("frequency"in t)&&"gain"in t,bF=t=>"detune"in t&&"frequency"in t&&!("gain"in t),AF=t=>"pan"in t,cr=t=>Yi(c2,t),kf=t=>Yi(d2,t),uC=(t,e)=>{const{activeInputs:n}=cr(t);n.forEach(i=>i.forEach(([o])=>{e.includes(t)||uC(o,[...e,t])}));const r=CF(t)?[t.playbackRate]:v2(t)?Array.from(t.parameters.values()):yF(t)?[t.Q,t.detune,t.frequency,t.gain]:xF(t)?[t.offset]:IF(t)?[t.gain]:bF(t)?[t.detune,t.frequency]:AF(t)?[t.pan]:[];for(const i of r){const o=kf(i);o!==void 0&&o.activeInputs.forEach(([s])=>uC(s,e))}_s(t)&&Sf(t)},wF=t=>{uC(t.destination,[])},SF=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),kF=(t,e,n,r,i,o,s,a,l)=>class extends t{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new l(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!SF(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,l.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),wF(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},EF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f=s(d),h=i(d,u,f),p=f?e(a):null;super(c,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},TF=t=>{const e=new WeakMap,n=async(r,i)=>{const o=i.destination;return e.set(i,o),await t(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):n(r,i)}}},RF=(t,e,n,r,i,o,s,a)=>(l,c)=>{const u=c.listener,d=()=>{const b=new Float32Array(1),E=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),A=s(c);let k=!1,D=[0,0,-1,0,1,0],T=[0,0,0];const R=()=>{if(k)return;k=!0;const Z=r(c,256,9,0);Z.onaudioprocess=({inputBuffer:q})=>{const ie=[o(q,b,0),o(q,b,1),o(q,b,2),o(q,b,3),o(q,b,4),o(q,b,5)];ie.some((Q,ne)=>Q!==D[ne])&&(u.setOrientation(...ie),D=ie);const $=[o(q,b,6),o(q,b,7),o(q,b,8)];$.some((Q,ne)=>Q!==T[ne])&&(u.setPosition(...$),T=$)},E.connect(Z)},P=Z=>q=>{q!==D[Z]&&(D[Z]=q,u.setOrientation(...D))},L=Z=>q=>{q!==T[Z]&&(T[Z]=q,u.setPosition(...T))},G=(Z,q,ie)=>{const $=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:q});$.connect(E,0,Z),$.start(),Object.defineProperty($.offset,"defaultValue",{get(){return q}});const Q=t({context:l},A,$.offset,or,Kr);return a(Q,"value",ne=>()=>ne.call(Q),ne=>O=>{try{ne.call(Q,O)}catch(j){if(j.code!==9)throw j}R(),A&&ie(O)}),Q.cancelAndHoldAtTime=(ne=>A?()=>{throw i()}:(...O)=>{const j=ne.apply(Q,O);return R(),j})(Q.cancelAndHoldAtTime),Q.cancelScheduledValues=(ne=>A?()=>{throw i()}:(...O)=>{const j=ne.apply(Q,O);return R(),j})(Q.cancelScheduledValues),Q.exponentialRampToValueAtTime=(ne=>A?()=>{throw i()}:(...O)=>{const j=ne.apply(Q,O);return R(),j})(Q.exponentialRampToValueAtTime),Q.linearRampToValueAtTime=(ne=>A?()=>{throw i()}:(...O)=>{const j=ne.apply(Q,O);return R(),j})(Q.linearRampToValueAtTime),Q.setTargetAtTime=(ne=>A?()=>{throw i()}:(...O)=>{const j=ne.apply(Q,O);return R(),j})(Q.setTargetAtTime),Q.setValueAtTime=(ne=>A?()=>{throw i()}:(...O)=>{const j=ne.apply(Q,O);return R(),j})(Q.setValueAtTime),Q.setValueCurveAtTime=(ne=>A?()=>{throw i()}:(...O)=>{const j=ne.apply(Q,O);return R(),j})(Q.setValueCurveAtTime),Q};return{forwardX:G(0,0,P(0)),forwardY:G(1,0,P(1)),forwardZ:G(2,-1,P(2)),positionX:G(6,0,L(0)),positionY:G(7,0,L(1)),positionZ:G(8,0,L(2)),upX:G(3,0,P(3)),upY:G(4,1,P(4)),upZ:G(5,0,P(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:g,positionY:C,positionZ:v,upX:m,upY:y,upZ:x}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return g},get positionY(){return C},get positionZ(){return v},get upX(){return m},get upY(){return y},get upZ(){return x}}},B0=t=>"context"in t,Ef=t=>B0(t[0]),Ll=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Hb=(t,e,[n,r],i)=>{Ll(t,[e,n,r],o=>o[0]===e&&o[1]===n,i)},Zb=(t,[e,n,r],i)=>{const o=t.get(e);o===void 0?t.set(e,new Set([[n,r]])):Ll(o,[n,r],s=>s[0]===n,i)},ou=t=>"inputs"in t,O0=(t,e,n,r)=>{if(ou(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},x2=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},_F=(t,e,n)=>Bp(t,r=>r[0]===e&&r[1]===n),I2=(t,e)=>{if(!wf(t).delete(e))throw new Error("Missing the expected event listener.")},b2=(t,e,n)=>{const r=Yi(t,e),i=Bp(r,o=>o[0]===n);return r.size===0&&t.delete(e),i},F0=(t,e,n,r)=>{ou(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},Ut=t=>Yi(u2,t),$d=t=>Yi(f2,t),kl=t=>oC.has(t),_h=t=>!Hc.has(t),$b=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),o=t.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;const a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),Fg=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const o=n.get(i);n.set(i,o===void 0?1:o+1)}n.forEach((r,i)=>e(i,r))},M0=t=>"context"in t,DF=t=>{const e=new Map;t.connect=(n=>(r,i=0,o=0)=>{const s=M0(r)?n(r,i,o):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:o,output:i}]):a.every(l=>l.input!==o||l.output!==i)&&a.push({input:o,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(r,i,o)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[s,a]of e){const l=a.filter(c=>c.output!==r);l.length===0?e.delete(s):e.set(s,l)}else if(e.has(r))if(i===void 0)e.delete(r);else{const s=e.get(r);if(s!==void 0){const a=s.filter(l=>l.output!==i&&(l.input!==o||o===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[s,a]of e)a.forEach(l=>{M0(s)?t.connect(s,l.output,l.input):t.connect(s,l.output)})})(t.disconnect)},PF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=kf(e),{outputs:s}=cr(t),a=wf(t),l=c=>{const u=Ut(t),d=$d(e);if(c){const f=b2(o,t,n);Hb(i,t,f,!1),!r&&!kl(t)&&u.connect(d,n)}else{const f=_F(i,t,n);Zb(o,f,!1),!r&&!kl(t)&&u.disconnect(d,n)}};return Ll(s,[e,n],c=>c[0]===e&&c[1]===n,!0)?(a.add(l),_s(t)?Hb(i,t,[n,l],!0):Zb(o,[t,n,l],!0),!0):!1},NF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=cr(e),s=x2(i[r],t,n);return s===null?[m2(o,t,n,r)[2],!1]:[s[2],!0]},BF=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=kf(e),o=x2(r,t,n);return o===null?[b2(i,t,n)[1],!1]:[o[2],!0]},N1=(t,e,n,r,i)=>{const[o,s]=NF(t,n,r,i);if(o!==null&&(I2(t,o),s&&!e&&!kl(t)&&F0(Ut(t),Ut(n),r,i)),_s(n)){const{activeInputs:a}=cr(n);lC(n,a)}},B1=(t,e,n,r)=>{const[i,o]=BF(t,n,r);i!==null&&(I2(t,i),o&&!e&&!kl(t)&&Ut(t).disconnect($d(n),r))},OF=(t,e)=>{const n=cr(t),r=[];for(const i of n.outputs)Ef(i)?N1(t,e,...i):B1(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},FF=(t,e,n)=>{const r=cr(t),i=[];for(const o of r.outputs)o[1]===n&&(Ef(o)?N1(t,e,...o):B1(t,e,...o),i.push(o[0]),r.outputs.delete(o));return i},MF=(t,e,n,r,i)=>{const o=cr(t);return Array.from(o.outputs).filter(s=>s[0]===n&&(r===void 0||s[1]===r)&&(i===void 0||s[2]===i)).map(s=>(Ef(s)?N1(t,e,...s):B1(t,e,...s),o.outputs.delete(s),s[0]))},LF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g)=>class extends c{constructor(v,m,y,x){super(y),this._context=v,this._nativeAudioNode=y;const b=u(v);d(b)&&n($b,()=>$b(b,g))!==!0&&DF(y),u2.set(this,y),p2.set(this,new Set),v.state!=="closed"&&m&&Zc(this),t(this,x,y)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,m=0,y=0){if(m<0||m>=this._nativeAudioNode.numberOfOutputs)throw i();const x=u(this._context),b=p(x);if(f(v)||h(v))throw o();if(B0(v)){const k=Ut(v);try{const T=O0(this._nativeAudioNode,k,m,y),R=_h(this);(b||R)&&this._nativeAudioNode.disconnect(...T),this.context.state!=="closed"&&!R&&_h(v)&&Zc(v)}catch(T){throw T.code===12?o():T}if(e(this,v,m,y,b)){const T=l([this],v);Fg(T,r(b))}return v}const E=$d(v);if(E.name==="playbackRate"&&E.maxValue===1024)throw s();try{this._nativeAudioNode.connect(E,m),(b||_h(this))&&this._nativeAudioNode.disconnect(E,m)}catch(k){throw k.code===12?o():k}if(PF(this,v,m,b)){const k=l([this],v);Fg(k,r(b))}}disconnect(v,m,y){let x;const b=u(this._context),E=p(b);if(v===void 0)x=OF(this,E);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw i();x=FF(this,E,v)}else{if(m!==void 0&&(m<0||m>=this.numberOfOutputs)||B0(v)&&y!==void 0&&(y<0||y>=v.numberOfInputs))throw i();if(x=MF(this,E,v,m,y),x.length===0)throw o()}for(const A of x){const k=l([this],A);Fg(k,a)}}},UF=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,g,C=null,v=null)=>{const m=g.value,y=new XO(m),x=p?r(y):null,b={get defaultValue(){return m},get maxValue(){return C===null?g.maxValue:C},get minValue(){return v===null?g.minValue:v},get value(){return g.value},set value(E){g.value=E,b.setValueAtTime(E,h.context.currentTime)},cancelAndHoldAtTime(E){if(typeof g.cancelAndHoldAtTime=="function")x===null&&y.flush(h.context.currentTime),y.add(i(E)),g.cancelAndHoldAtTime(E);else{const A=Array.from(y).pop();x===null&&y.flush(h.context.currentTime),y.add(i(E));const k=Array.from(y).pop();g.cancelScheduledValues(E),A!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?g.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?g.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&g.setValueCurveAtTime(k.values,k.startTime,k.duration))}return b},cancelScheduledValues(E){return x===null&&y.flush(h.context.currentTime),y.add(o(E)),g.cancelScheduledValues(E),b},exponentialRampToValueAtTime(E,A){if(E===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;const k=h.context.currentTime;return x===null&&y.flush(k),Array.from(y).length===0&&(y.add(c(m,k)),g.setValueAtTime(m,k)),y.add(s(E,A)),g.exponentialRampToValueAtTime(E,A),b},linearRampToValueAtTime(E,A){const k=h.context.currentTime;return x===null&&y.flush(k),Array.from(y).length===0&&(y.add(c(m,k)),g.setValueAtTime(m,k)),y.add(a(E,A)),g.linearRampToValueAtTime(E,A),b},setTargetAtTime(E,A,k){return x===null&&y.flush(h.context.currentTime),y.add(l(E,A,k)),g.setTargetAtTime(E,A,k),b},setValueAtTime(E,A){return x===null&&y.flush(h.context.currentTime),y.add(c(E,A)),g.setValueAtTime(E,A),b},setValueCurveAtTime(E,A,k){const D=E instanceof Float32Array?E:new Float32Array(E);if(d!==null&&d.name==="webkitAudioContext"){const T=A+k,R=h.context.sampleRate,P=Math.ceil(A*R),L=Math.floor(T*R),G=L-P,Z=new Float32Array(G);for(let ie=0;ie<G;ie+=1){const $=(D.length-1)/k*((P+ie)/R-A),Q=Math.floor($),ne=Math.ceil($);Z[ie]=Q===ne?D[Q]:(1-($-Q))*D[Q]+(1-(ne-$))*D[ne]}x===null&&y.flush(h.context.currentTime),y.add(u(Z,A,k)),g.setValueCurveAtTime(Z,A,k);const q=L/R;q<T&&f(b,Z[Z.length-1],q),f(b,D[D.length-1],T)}else x===null&&y.flush(h.context.currentTime),y.add(u(D,A,k)),g.setValueCurveAtTime(D,A,k);return b}};return n.set(b,g),e.set(b,h),t(b,x),b},VF=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=n;e.setTargetAtTime(i,r,o)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=n;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class A2{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const GF={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},WF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h)=>class extends e{constructor(g,C,v){var m;const y=a(g),x=l(y),b=u({...GF,...v});f(b);const E=sC.get(y),A=E==null?void 0:E.get(C),k=x||y.state!=="closed"?y:(m=s(y))!==null&&m!==void 0?m:y,D=i(k,x?null:g.baseLatency,c,C,A,b),T=x?r(C,b,A):null;super(g,!0,D,T);const R=[];D.parameters.forEach((L,G)=>{const Z=n(this,x,L);R.push([G,Z])}),this._nativeAudioWorkletNode=D,this._onprocessorerror=null,this._parameters=new A2(R),x&&t(y,this);const{activeInputs:P}=o(this);d(D,P)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const C=typeof g=="function"?h(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=C;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===C?g:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function L0(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const o=t.getChannelData(r);if(e[n].byteLength===0)e[n]=o.slice(i,i+128);else{const s=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(s)}}}const w2=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},U0=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let s=0;s<o;s+=1)i.push(new Float32Array(128));n.push(i)}return n},jF=(t,e)=>{const n=Yi(aC,t),r=Ut(e);return Yi(n,r)},zF=async(t,e,n,r,i,o,s)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,c=i.reduce((C,v)=>C+v,0),u=c===0?null:n.createBuffer(c,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=cr(t),f=await jF(n,t),h=U0(r.numberOfInputs,r.channelCount),p=U0(r.numberOfOutputs,i),g=Array.from(t.parameters.keys()).reduce((C,v)=>({...C,[v]:new Float32Array(128)}),{});for(let C=0;C<a;C+=128){if(r.numberOfInputs>0&&e!==null)for(let v=0;v<r.numberOfInputs;v+=1)for(let m=0;m<r.channelCount;m+=1)L0(e,h[v],m,m,C);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:v},m)=>{L0(e,g,v,l+m,C)});for(let v=0;v<r.numberOfInputs;v+=1)for(let m=0;m<i[v];m+=1)p[v][m].byteLength===0&&(p[v][m]=new Float32Array(128));try{const v=h.map((y,x)=>d.activeInputs[x].size===0?[]:y),m=s(C/n.sampleRate,n.sampleRate,()=>f.process(v,p,g));if(u!==null)for(let y=0,x=0;y<r.numberOfOutputs;y+=1){for(let b=0;b<i[y];b+=1)w2(u,p[y],b,x+b,C);x+=i[y]}if(!m)break}catch(v){t.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},HF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g)=>(C,v,m)=>{const y=new WeakMap;let x=null;const b=async(E,A)=>{let k=u(E),D=null;const T=Qn(k,A),R=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(d===null){const P=R.reduce((q,ie)=>q+ie,0),L=i(A,{channelCount:Math.max(1,P),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,P)}),G=[];for(let q=0;q<E.numberOfOutputs;q+=1)G.push(r(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:R[q]}));const Z=s(A,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});Z.connect=e.bind(null,G),Z.disconnect=l.bind(null,G),D=[L,G,Z]}else T||(k=new d(A,C));if(y.set(A,D===null?k:D[2]),D!==null){if(x===null){if(m===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const ie=E.channelCount*E.numberOfInputs,$=m.parameterDescriptors===void 0?0:m.parameterDescriptors.length,Q=ie+$;x=zF(E,Q===0?null:await(async()=>{const O=new f(Q,Math.ceil(E.context.length/128)*128,A.sampleRate),j=[],J=[];for(let me=0;me<v.numberOfInputs;me+=1)j.push(s(O,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),J.push(i(O,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const ee=await Promise.all(Array.from(E.parameters.values()).map(async me=>{const Be=o(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:me.value});return await h(O,me,Be.offset),Be})),se=r(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,ie+$)});for(let me=0;me<v.numberOfInputs;me+=1){j[me].connect(J[me]);for(let Be=0;Be<v.channelCount;Be+=1)J[me].connect(se,Be,me*v.channelCount+Be)}for(const[me,Be]of ee.entries())Be.connect(se,0,ie+me),Be.start(0);return se.connect(O.destination),await Promise.all(j.map(me=>p(E,O,me))),g(O)})(),A,v,R,m,c)}const P=await x,L=n(A,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[G,Z,q]=D;P!==null&&(L.buffer=P,L.start(0)),L.connect(G);for(let ie=0,$=0;ie<E.numberOfOutputs;ie+=1){const Q=Z[ie];for(let ne=0;ne<R[ie];ne+=1)G.connect(Q,$+ne,ne);$+=R[ie]}return q}if(T)for(const[P,L]of E.parameters.entries())await t(A,L,k.parameters.get(P));else for(const[P,L]of E.parameters.entries())await h(A,L,k.parameters.get(P));return await p(E,A,k),k};return{render(E,A){a(A,E);const k=y.get(A);return k!==void 0?Promise.resolve(k):b(E,A)}}},ZF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g,C,v,m,y)=>class extends p{constructor(b,E){super(b,E),this._nativeContext=b,this._audioWorklet=t===void 0?void 0:{addModule:(A,k)=>t(this,A,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(b,E,A){return new n({length:E,numberOfChannels:b,sampleRate:A})}createBufferSource(){return new r(this)}createChannelMerger(b=6){return new o(this,{numberOfInputs:b})}createChannelSplitter(b=6){return new s(this,{numberOfOutputs:b})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(b=1){return new u(this,{maxDelayTime:b})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(b,E){return new h(this,{feedback:E,feedforward:b})}createOscillator(){return new g(this)}createPanner(){return new C(this)}createPeriodicWave(b,E,A={disableNormalization:!1}){return new v(this,{...A,imag:E,real:b})}createStereoPanner(){return new m(this)}createWaveShaper(){return new y(this)}decodeAudioData(b,E,A){return c(this._nativeContext,b).then(k=>(typeof E=="function"&&E(k),k),k=>{throw typeof A=="function"&&A(k),k})}},$F={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},XF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...$F,...u},h=i(d,f),p=s(d),g=p?n():null;super(c,!1,h,g),this._Q=e(this,p,h.Q,or,Kr),this._detune=e(this,p,h.detune,1200*Math.log2(or),-1200*Math.log2(or)),this._frequency=e(this,p,h.frequency,c.sampleRate/2,0),this._gain=e(this,p,h.gain,40*Math.log10(or),Kr),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,d)}catch(f){throw f.code===11?r():f}if(c.length!==u.length||u.length!==d.length)throw r()}},KF=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=Qn(c,l);if(!u){const d={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(l,d)}return o.set(l,c),u?(await t(l,a.Q,c.Q),await t(l,a.detune,c.detune),await t(l,a.frequency,c.frequency),await t(l,a.gain,c.gain)):(await r(l,a.Q,c.Q),await r(l,a.detune,c.detune),await r(l,a.frequency,c.frequency),await r(l,a.gain,c.gain)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},JF=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const o=t.get(n);if(o!==void 0)return o;try{const s=r();return s instanceof Promise?(t.set(n,s),s.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,s),s)}catch{return e.set(n,!1),!1}},YF={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},qF=(t,e,n,r,i)=>class extends t{constructor(s,a){const l=r(s),c={...YF,...a},u=n(l,c),d=i(l)?e():null;super(s,!1,u,d)}},QF=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},eM={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},tM=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u=o({...eM,...l}),d=n(c,u),f=i(c)?e():null;super(a,!1,d,f)}},nM=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},rM=t=>(e,n,r)=>t(n,e,r),iM=t=>(e,n,r=0,i=0)=>{const o=e[r];if(o===void 0)throw t();return M0(n)?o.connect(n,0,i):o.connect(n,0)},oM=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},sM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},aM=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...sM,...c},f=r(u,d),h=o(u),p=h?n():null;super(l,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,h,f.offset,or,Kr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Zc(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),_s(this)&&Sf(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},lM=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=Qn(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,h),s!==null&&d.start(s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,c.offset,d.offset):await r(u,c.offset,d.offset),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},cM=t=>e=>(t[0]=e,t[0]),uM={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},dM=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u={...uM,...l},d=n(c,u),h=i(c)?e():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},fM=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Qn(a,s)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(s,c)}return r.set(s,a),ou(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},hM=()=>new DOMException("","DataCloneError"),Xb=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},pM=(t,e,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=s(d)?d:o(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(l,()=>l(h))?h.decodeAudioData(f).then(p=>(Xb(f).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,g)=>{const C=async()=>{try{await Xb(f)}catch{}},v=m=>{g(m),C()};try{h.decodeAudioData(f,m=>{typeof m.copyFromChannel!="function"&&(c(m),C2(m)),t.add(m),C().then(()=>p(m))},m=>{v(m===null?r():m)})}catch(m){v(m)}})},gM=(t,e,n,r,i,o,s,a)=>(l,c)=>{const u=e.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(l.context),f=a(d);if(u===c){if(e.delete(l),!f&&s(l)){const h=r(l),{outputs:p}=n(l);for(const g of p)if(Ef(g)){const C=r(g[0]);t(h,C,g[1],g[2])}else{const C=i(g[0]);h.connect(C,g[1])}}}else e.set(l,u-c)},mM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},vM=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...mM,...c},f=r(u,d),h=o(u),p=h?n(d.maxDelayTime):null;super(l,!1,f,p),this._delayTime=e(this,h,f.delayTime),s(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},CM=(t,e,n,r,i)=>o=>{const s=new WeakMap,a=async(l,c)=>{let u=n(l);const d=Qn(u,c);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,f)}return s.set(c,u),d?await t(c,l.delayTime,u.delayTime):await r(c,l.delayTime,u.delayTime),await i(l,c,u),u};return{render(l,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):a(l,c)}}},yM=t=>(e,n,r,i)=>t(e[i],o=>o[0]===n&&o[1]===r),xM=t=>(e,n)=>{t(e).delete(n)},IM=t=>"delayTime"in t,bM=(t,e,n)=>function r(i,o){const s=B0(o)?o:n(t,o);if(IM(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=e(s);return Array.from(a).map(l=>r([...i,s],l[0])).reduce((l,c)=>l.concat(c),[])},rh=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},AM=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(o=>o.disconnect()):typeof n=="number"?rh(t,e,n).disconnect():M0(n)?r===void 0?e.forEach(o=>o.disconnect(n)):i===void 0?rh(t,e,r).disconnect(n,0):rh(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(o=>o.disconnect(n)):rh(t,e,r).disconnect(n,0),wM={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},SM=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...wM,...u},h=r(d,f),p=s(d),g=p?n():null;super(c,!1,h,g),this._attack=e(this,p,h.attack),this._knee=e(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,p,h.ratio),this._release=e(this,p,h.release),this._threshold=e(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},kM=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=Qn(c,l);if(!u){const d={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(l,d)}return o.set(l,c),u?(await t(l,a.attack,c.attack),await t(l,a.knee,c.knee),await t(l,a.ratio,c.ratio),await t(l,a.release,c.release),await t(l,a.threshold,c.threshold)):(await r(l,a.attack,c.attack),await r(l,a.knee,c.knee),await r(l,a.ratio,c.ratio),await r(l,a.release,c.release),await r(l,a.threshold,c.threshold)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},EM=()=>new DOMException("","EncodingError"),TM=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const o=t.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),l=t.onerror,c=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(u,d,f,h,p)=>{if(d===a||d===t.location.href&&f===1&&h===1)return c(),r(p),!1;if(l!==null)return l(u,d,f,h,p)},o.onerror=()=>{c(),r(new SyntaxError)},o.onload=()=>{c(),n()},o.src=a,o.type="module",i.appendChild(o)}}),RM=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=t(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,i)}},_M=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},DM=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},PM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},NM=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...PM,...l},d=r(c,u),f=o(c),h=f?n():null;super(a,!1,d,h),this._gain=e(this,f,d.gain,or,Kr)}get gain(){return this._gain}},BM=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=Qn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(l,d)}return o.set(l,c),u?await t(l,a.gain,c.gain):await r(l,a.gain,c.gain),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},OM=(t,e)=>n=>e(t,n),FM=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},MM=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},LM=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},UM=t=>e=>t.get(e),Mn=()=>new DOMException("","InvalidStateError"),VM=t=>e=>{const n=t.get(e);if(n===void 0)throw Mn();return n},GM=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},WM=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},Op=()=>new DOMException("","InvalidAccessError"),jM=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw Op();return e.call(t,n,r,i)})(t.getFrequencyResponse)},zM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},HM=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u=i(c),d={...zM,...l},f=e(c,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),jM(f),this._nativeIIRFilterNode=f,o(this,1)}getFrequencyResponse(a,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,c)}},S2=(t,e,n,r,i,o,s,a,l,c,u)=>{const d=c.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*c[h];for(let g=1;g<i;g+=1){const C=f-g&l-1;p+=n[g]*o[C],p-=t[g]*s[C]}for(let g=i;g<r;g+=1)p+=n[g]*o[f-g&l-1];for(let g=i;g<e;g+=1)p-=t[g]*s[f-g&l-1];o[f]=c[h],s[f]=p,f=f+1&l-1,u[h]=p}return f},ZM=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,l=Math.min(s,a);if(i[0]!==1){for(let p=0;p<s;p+=1)o[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const c=32,u=new Float32Array(c),d=new Float32Array(c),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const g=t.getChannelData(p),C=f.getChannelData(p);u.fill(0),d.fill(0),S2(i,s,o,a,l,u,d,0,c,g,C)}return f},$M=(t,e,n,r,i)=>(o,s)=>{const a=new WeakMap;let l=null;const c=async(u,d)=>{let f=null,h=e(u);const p=Qn(h,d);if(d.createIIRFilter===void 0?f=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(s,o)),a.set(d,f===null?h:f),f!==null){if(l===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);l=(async()=>{await r(u,C,C.destination);const v=await i(C);return ZM(v,d,o,s)})()}const g=await l;return f.buffer=g,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},XM=(t,e,n,r,i,o)=>s=>(a,l)=>{const c=t.get(a);if(c===void 0){if(!s&&o(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(Ef(f)){const h=r(f[0]);e(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}t.set(a,l)}else t.set(a,c+l)},KM=t=>e=>t!==null&&e instanceof t,JM=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,YM=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,qM=(t,e)=>n=>t(n)||e(n),QM=t=>e=>t!==null&&e instanceof t,e8=t=>t!==null&&t.isSecureContext,t8=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),l=e(a,s);if(r(a))throw TypeError();super(o,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},n8={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},r8=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o);if(r(a))throw new TypeError;const l={...n8,...s},c=e(a,l);super(o,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},i8=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),l=e(a,s);if(r(a))throw new TypeError;super(o,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},o8=(t,e,n)=>class extends t{constructor(i,o){const s=n(i),a=e(s,o);super(i,!0,a,null)}},s8=(t,e,n,r,i,o)=>class extends n{constructor(a,l){super(a),this._nativeContext=a,h2.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,l),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},dC=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},a8=(t,e)=>(n,r,i)=>{const o=new Set;return n.connect=(s=>(a,l=0,c=0)=>{const u=o.size===0;if(e(a))return s.call(n,a,l,c),t(o,[a,l,c],d=>d[0]===a&&d[1]===l&&d[2]===c,!0),u&&r(),a;s.call(n,a,l),t(o,[a,l],d=>d[0]===a&&d[1]===l,!0),u&&r()})(n.connect),n.disconnect=(s=>(a,l,c)=>{const u=o.size>0;if(a===void 0)s.apply(n),o.clear();else if(typeof a=="number"){s.call(n,a);for(const f of o)f[1]===a&&o.delete(f)}else{e(a)?s.call(n,a,l,c):s.call(n,a,l);for(const f of o)f[0]===a&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&o.delete(f)}const d=o.size===0;u&&d&&i()})(n.disconnect),n},Ht=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},bn=(t,e)=>{Ht(t,e,"channelCount"),Ht(t,e,"channelCountMode"),Ht(t,e,"channelInterpretation")},Kb=t=>typeof t.getFloatTimeDomainData=="function",l8=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},c8=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(bn(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Ht(i,r,"fftSize"),Ht(i,r,"maxDecibels"),Ht(i,r,"minDecibels"),Ht(i,r,"smoothingTimeConstant"),t(Kb,()=>Kb(i))||l8(i),i},u8=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,en=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},d8=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw Mn();e.call(t,r,i,o),n=!0}})(t.start)},O1=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},F1=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},f8=(t,e,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=d.createBufferSource();return bn(h,f),en(h,f,"playbackRate"),Ht(h,f,"buffer"),Ht(h,f,"loop"),Ht(h,f,"loopEnd"),Ht(h,f,"loopStart"),e(n,()=>n(d))||d8(h),e(r,()=>r(d))||l(h),e(i,()=>i(d))||c(h,d),e(o,()=>o(d))||O1(h),e(s,()=>s(d))||u(h,d),e(a,()=>a(d))||F1(h),t(d,h),h},h8=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,p8=(t,e)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=t(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>l=>{a.call(s,l);try{o.channelCount=l}catch(c){if(l>o.maxChannelCount)throw c}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelCountMode=l}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelInterpretation=l}),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s},g8=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,m8=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},v8=(t,e,n,r,i)=>(o,s,a,l,c,u)=>{if(a!==null)try{const d=new a(o,l,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const C=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(C!==null){const v=f.get(g[1]);v!==void 0?g[1]=v:(g[1]=m=>{m.type==="error"?(Object.defineProperties(m,{type:{value:"processorerror"}}),C(m)):C(new ErrorEvent(g[0],{...m}))},f.set(C,g[1]))}}return p.call(d,"error",g[1],g[2]),p.call(d,...g)})(d.addEventListener),d.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const C=f.get(g[1]);C!==void 0&&(f.delete(g[1]),g[1]=C)}return p.call(d,"error",g[1],g[2]),p.call(d,g[0],g[1],g[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(o.destination),i(d,()=>p.disconnect(),()=>p.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(c===void 0)throw r();return m8(u),e(o,s,c,u)},k2=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),C8=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),n(o)},i.postMessage(t)}),y8=async(t,e)=>{const n=await C8(e);return new t(n)},x8=(t,e,n,r)=>{let i=aC.get(t);i===void 0&&(i=new WeakMap,aC.set(t,i));const o=y8(n,r);return i.set(e,o),o},I8=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,g,C)=>{if(C.numberOfInputs===0&&C.numberOfOutputs===0)throw l();const v=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(v.some(he=>he<1))throw l();if(v.length!==C.numberOfOutputs)throw e();if(C.channelCountMode!=="explicit")throw l();const m=C.channelCount*C.numberOfInputs,y=v.reduce((he,Ce)=>he+Ce,0),x=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(m+x>6||y>6)throw l();const b=new MessageChannel,E=[],A=[];for(let he=0;he<C.numberOfInputs;he+=1)E.push(s(h,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),A.push(i(h,{channelCount:C.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:C.channelCount}));const k=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:he,maxValue:Ce,minValue:Ue,name:Le}of g.parameterDescriptors){const Pe=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C.parameterData[Le]!==void 0?C.parameterData[Le]:he===void 0?0:he});Object.defineProperties(Pe.offset,{defaultValue:{get:()=>he===void 0?0:he},maxValue:{get:()=>Ce===void 0?or:Ce},minValue:{get:()=>Ue===void 0?Kr:Ue}}),k.push(Pe)}const D=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,m+x)}),T=k2(p,h.sampleRate),R=a(h,T,m+x,Math.max(1,y)),P=i(h,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),L=[];for(let he=0;he<C.numberOfOutputs;he+=1)L.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[he]}));for(let he=0;he<C.numberOfInputs;he+=1){E[he].connect(A[he]);for(let Ce=0;Ce<C.channelCount;Ce+=1)A[he].connect(D,Ce,he*C.channelCount+Ce)}const G=new A2(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:he},Ce)=>{const Ue=k[Ce];return Ue.connect(D,0,m+Ce),Ue.start(0),[he,Ue.offset]}));D.connect(R);let Z=C.channelInterpretation,q=null;const ie=C.numberOfOutputs===0?[R]:L,$={get bufferSize(){return T},get channelCount(){return C.channelCount},set channelCount(he){throw n()},get channelCountMode(){return C.channelCountMode},set channelCountMode(he){throw n()},get channelInterpretation(){return Z},set channelInterpretation(he){for(const Ce of E)Ce.channelInterpretation=he;Z=he},get context(){return R.context},get inputs(){return E},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get onprocessorerror(){return q},set onprocessorerror(he){typeof q=="function"&&$.removeEventListener("processorerror",q),q=typeof he=="function"?he:null,typeof q=="function"&&$.addEventListener("processorerror",q)},get parameters(){return G},get port(){return b.port2},addEventListener(...he){return R.addEventListener(he[0],he[1],he[2])},connect:t.bind(null,ie),disconnect:c.bind(null,ie),dispatchEvent(...he){return R.dispatchEvent(he[0])},removeEventListener(...he){return R.removeEventListener(he[0],he[1],he[2])}},Q=new Map;b.port1.addEventListener=(he=>(...Ce)=>{if(Ce[0]==="message"){const Ue=typeof Ce[1]=="function"?Ce[1]:typeof Ce[1]=="object"&&Ce[1]!==null&&typeof Ce[1].handleEvent=="function"?Ce[1].handleEvent:null;if(Ue!==null){const Le=Q.get(Ce[1]);Le!==void 0?Ce[1]=Le:(Ce[1]=Pe=>{u(h.currentTime,h.sampleRate,()=>Ue(Pe))},Q.set(Ue,Ce[1]))}}return he.call(b.port1,Ce[0],Ce[1],Ce[2])})(b.port1.addEventListener),b.port1.removeEventListener=(he=>(...Ce)=>{if(Ce[0]==="message"){const Ue=Q.get(Ce[1]);Ue!==void 0&&(Q.delete(Ce[1]),Ce[1]=Ue)}return he.call(b.port1,Ce[0],Ce[1],Ce[2])})(b.port1.removeEventListener);let ne=null;Object.defineProperty(b.port1,"onmessage",{get:()=>ne,set:he=>{typeof ne=="function"&&b.port1.removeEventListener("message",ne),ne=typeof he=="function"?he:null,typeof ne=="function"&&(b.port1.addEventListener("message",ne),b.port1.start())}}),g.prototype.port=b.port1;let O=null;x8(h,$,g,C).then(he=>O=he);const J=U0(C.numberOfInputs,C.channelCount),ee=U0(C.numberOfOutputs,v),se=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((he,{name:Ce})=>({...he,[Ce]:new Float32Array(128)}),{});let me=!0;const Be=()=>{C.numberOfOutputs>0&&R.disconnect(P);for(let he=0,Ce=0;he<C.numberOfOutputs;he+=1){const Ue=L[he];for(let Le=0;Le<v[he];Le+=1)P.disconnect(Ue,Ce+Le,Le);Ce+=v[he]}},ae=new Map;R.onaudioprocess=({inputBuffer:he,outputBuffer:Ce})=>{if(O!==null){const Ue=d($);for(let Le=0;Le<T;Le+=128){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<C.channelCount;$e+=1)L0(he,J[Pe],$e,$e,Le);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:Pe},$e)=>{L0(he,se,Pe,m+$e,Le)});for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<v[Pe];$e+=1)ee[Pe][$e].byteLength===0&&(ee[Pe][$e]=new Float32Array(128));try{const Pe=J.map((st,Qe)=>{if(Ue[Qe].size>0)return ae.set(Qe,T/128),st;const jt=ae.get(Qe);return jt===void 0?[]:(st.every(wt=>wt.every(sn=>sn===0))&&(jt===1?ae.delete(Qe):ae.set(Qe,jt-1)),st)});me=u(h.currentTime+Le/h.sampleRate,h.sampleRate,()=>O.process(Pe,ee,se));for(let st=0,Qe=0;st<C.numberOfOutputs;st+=1){for(let Wt=0;Wt<v[st];Wt+=1)w2(Ce,ee[st],Wt,Qe+Wt,Le);Qe+=v[st]}}catch(Pe){me=!1,$.dispatchEvent(new ErrorEvent("processorerror",{colno:Pe.colno,filename:Pe.filename,lineno:Pe.lineno,message:Pe.message}))}if(!me){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1){E[Pe].disconnect(A[Pe]);for(let $e=0;$e<C.channelCount;$e+=1)A[Le].disconnect(D,$e,Pe*C.channelCount+$e)}if(g.parameterDescriptors!==void 0){const Pe=g.parameterDescriptors.length;for(let $e=0;$e<Pe;$e+=1){const st=k[$e];st.disconnect(D,0,m+$e),st.stop()}}D.disconnect(R),R.onaudioprocess=null,Pt?Be():ze();break}}}};let Pt=!1;const Gt=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),fn=()=>R.connect(Gt).connect(h.destination),ze=()=>{R.disconnect(Gt),Gt.disconnect()},at=()=>{if(me){ze(),C.numberOfOutputs>0&&R.connect(P);for(let he=0,Ce=0;he<C.numberOfOutputs;he+=1){const Ue=L[he];for(let Le=0;Le<v[he];Le+=1)P.connect(Ue,Ce+Le,Le);Ce+=v[he]}}Pt=!0},ot=()=>{me&&(fn(),Be()),Pt=!1};return fn(),f($,at,ot)},E2=(t,e)=>{const n=t.createBiquadFilter();return bn(n,e),en(n,e,"Q"),en(n,e,"detune"),en(n,e,"frequency"),en(n,e,"gain"),Ht(n,e,"type"),n},b8=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),bn(i,r),i},A8=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw Mn()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Mn()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Mn()}})},Tf=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return bn(n,e),A8(n),n},w8=(t,e,n,r,i)=>(o,s)=>{if(o.createConstantSource===void 0)return n(o,s);const a=o.createConstantSource();return bn(a,s),en(a,s,"offset"),e(r,()=>r(o))||O1(a),e(i,()=>i(o))||F1(a),t(o,a),a},su=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),S8=(t,e,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,l.buffer=a,l.loop=!0;const d={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},f=()=>l.connect(c),h=()=>l.disconnect(c);return t(i,l),r(su(d,c),f,h)},k8=(t,e)=>(n,r)=>{const i=n.createConvolver();if(bn(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Ht(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>s=>{if(s>2)throw t();return o.call(i,s)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",o=>()=>o.call(i),o=>s=>{if(s==="max")throw t();return o.call(i,s)}),i},T2=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return bn(n,e),en(n,e,"delayTime"),n},E8=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(bn(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return en(r,n,"attack"),en(r,n,"knee"),en(r,n,"ratio"),en(r,n,"release"),en(r,n,"threshold"),r},Nr=(t,e)=>{const n=t.createGain();return bn(n,e),en(n,e,"gain"),n},T8=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return bn(i,r),i};function R8(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function _8(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function Jb(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=_8(n,e),n[0]+=t[r];return n}const D8=(t,e,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:u})=>{const d=k2(o,i.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,g=h.length,C=Math.min(p,g);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(g===0||g>20)throw r();if(h[0]===0)throw e();if(f[0]!==1){for(let k=0;k<g;k+=1)h[k]/=f[0];for(let k=1;k<p;k+=1)f[k]/=f[0]}const v=n(i,d,s,s);v.channelCount=s,v.channelCountMode=a,v.channelInterpretation=l;const m=32,y=[],x=[],b=[];for(let k=0;k<s;k+=1){y.push(0);const D=new Float32Array(m),T=new Float32Array(m);D.fill(0),T.fill(0),x.push(D),b.push(T)}v.onaudioprocess=k=>{const D=k.inputBuffer,T=k.outputBuffer,R=D.numberOfChannels;for(let P=0;P<R;P+=1){const L=D.getChannelData(P),G=T.getChannelData(P);y[P]=S2(f,p,h,g,C,x[P],b[P],y[P],m,L,G)}};const E=i.sampleRate/2;return su({get bufferSize(){return d},get channelCount(){return v.channelCount},set channelCount(k){v.channelCount=k},get channelCountMode(){return v.channelCountMode},set channelCountMode(k){v.channelCountMode=k},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(k){v.channelInterpretation=k},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...k){return v.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return v.dispatchEvent(k[0])},getFrequencyResponse(k,D,T){if(k.length!==D.length||D.length!==T.length)throw t();const R=k.length;for(let P=0;P<R;P+=1){const L=-Math.PI*(k[P]/E),G=[Math.cos(L),Math.sin(L)],Z=Jb(h,G),q=Jb(f,G),ie=R8(Z,q);D[P]=Math.sqrt(ie[0]*ie[0]+ie[1]*ie[1]),T[P]=Math.atan2(ie[1],ie[0])}},removeEventListener(...k){return v.removeEventListener(k[0],k[1],k[2])}},v)},P8=(t,e)=>t.createMediaElementSource(e.mediaElement),N8=(t,e)=>{const n=t.createMediaStreamDestination();return bn(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},B8=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((o,s)=>o.id<s.id?-1:o.id>s.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},O8=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return o},F8=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,M8=(t,e,n,r,i,o)=>(s,a)=>{const l=s.createOscillator();return bn(l,a),en(l,a,"detune"),en(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):Ht(l,a,"type"),e(n,()=>n(s))||O1(l),e(r,()=>r(s))||o(l,s),e(i,()=>i(s))||F1(l),t(s,l),l},L8=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(bn(r,n),en(r,n,"orientationX"),en(r,n,"orientationY"),en(r,n,"orientationZ"),en(r,n,"positionX"),en(r,n,"positionY"),en(r,n,"positionZ"),Ht(r,n,"coneInnerAngle"),Ht(r,n,"coneOuterAngle"),Ht(r,n,"coneOuterGain"),Ht(r,n,"distanceModel"),Ht(r,n,"maxDistance"),Ht(r,n,"panningModel"),Ht(r,n,"refDistance"),Ht(r,n,"rolloffFactor"),r)},U8=(t,e,n,r,i,o,s,a,l,c)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:g,orientationX:C,orientationY:v,orientationZ:m,panningModel:y,positionX:x,positionY:b,positionZ:E,refDistance:A,rolloffFactor:k,...D})=>{const T=u.createPanner();if(D.channelCount>2||D.channelCountMode==="max")throw s();bn(T,D);const R={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},P=n(u,{...R,channelInterpretation:"speakers",numberOfInputs:6}),L=r(u,{...D,gain:1}),G=r(u,{...R,gain:1}),Z=r(u,{...R,gain:0}),q=r(u,{...R,gain:0}),ie=r(u,{...R,gain:0}),$=r(u,{...R,gain:0}),Q=r(u,{...R,gain:0}),ne=i(u,256,6,1),O=o(u,{...R,curve:new Float32Array([1,1]),oversample:"none"});let j=[C,v,m],J=[x,b,E];const ee=new Float32Array(1);ne.onaudioprocess=({inputBuffer:ae})=>{const Pt=[l(ae,ee,0),l(ae,ee,1),l(ae,ee,2)];Pt.some((fn,ze)=>fn!==j[ze])&&(T.setOrientation(...Pt),j=Pt);const Gt=[l(ae,ee,3),l(ae,ee,4),l(ae,ee,5)];Gt.some((fn,ze)=>fn!==J[ze])&&(T.setPosition(...Gt),J=Gt)},Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ie.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Q.gain,"defaultValue",{get:()=>0});const se={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(ae){if(ae>2)throw s();L.channelCount=ae,T.channelCount=ae},get channelCountMode(){return T.channelCountMode},set channelCountMode(ae){if(ae==="max")throw s();L.channelCountMode=ae,T.channelCountMode=ae},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(ae){L.channelInterpretation=ae,T.channelInterpretation=ae},get coneInnerAngle(){return T.coneInnerAngle},set coneInnerAngle(ae){T.coneInnerAngle=ae},get coneOuterAngle(){return T.coneOuterAngle},set coneOuterAngle(ae){T.coneOuterAngle=ae},get coneOuterGain(){return T.coneOuterGain},set coneOuterGain(ae){if(ae<0||ae>1)throw e();T.coneOuterGain=ae},get context(){return T.context},get distanceModel(){return T.distanceModel},set distanceModel(ae){T.distanceModel=ae},get inputs(){return[L]},get maxDistance(){return T.maxDistance},set maxDistance(ae){if(ae<0)throw new RangeError;T.maxDistance=ae},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get orientationX(){return G.gain},get orientationY(){return Z.gain},get orientationZ(){return q.gain},get panningModel(){return T.panningModel},set panningModel(ae){T.panningModel=ae},get positionX(){return ie.gain},get positionY(){return $.gain},get positionZ(){return Q.gain},get refDistance(){return T.refDistance},set refDistance(ae){if(ae<0)throw new RangeError;T.refDistance=ae},get rolloffFactor(){return T.rolloffFactor},set rolloffFactor(ae){if(ae<0)throw new RangeError;T.rolloffFactor=ae},addEventListener(...ae){return L.addEventListener(ae[0],ae[1],ae[2])},dispatchEvent(...ae){return L.dispatchEvent(ae[0])},removeEventListener(...ae){return L.removeEventListener(ae[0],ae[1],ae[2])}};d!==se.coneInnerAngle&&(se.coneInnerAngle=d),f!==se.coneOuterAngle&&(se.coneOuterAngle=f),h!==se.coneOuterGain&&(se.coneOuterGain=h),p!==se.distanceModel&&(se.distanceModel=p),g!==se.maxDistance&&(se.maxDistance=g),C!==se.orientationX.value&&(se.orientationX.value=C),v!==se.orientationY.value&&(se.orientationY.value=v),m!==se.orientationZ.value&&(se.orientationZ.value=m),y!==se.panningModel&&(se.panningModel=y),x!==se.positionX.value&&(se.positionX.value=x),b!==se.positionY.value&&(se.positionY.value=b),E!==se.positionZ.value&&(se.positionZ.value=E),A!==se.refDistance&&(se.refDistance=A),k!==se.rolloffFactor&&(se.rolloffFactor=k),(j[0]!==1||j[1]!==0||j[2]!==0)&&T.setOrientation(...j),(J[0]!==0||J[1]!==0||J[2]!==0)&&T.setPosition(...J);const me=()=>{L.connect(T),t(L,O,0,0),O.connect(G).connect(P,0,0),O.connect(Z).connect(P,0,1),O.connect(q).connect(P,0,2),O.connect(ie).connect(P,0,3),O.connect($).connect(P,0,4),O.connect(Q).connect(P,0,5),P.connect(ne).connect(u.destination)},Be=()=>{L.disconnect(T),a(L,O,0,0),O.disconnect(G),G.disconnect(P),O.disconnect(Z),Z.disconnect(P),O.disconnect(q),q.disconnect(P),O.disconnect(ie),ie.disconnect(P),O.disconnect($),$.disconnect(P),O.disconnect(Q),Q.disconnect(P),P.disconnect(ne),ne.disconnect(u.destination)};return c(su(se,T),me,Be)},V8=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},Rf=(t,e,n,r)=>t.createScriptProcessor(e,n,r),G8=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const o=n.createStereoPanner();return bn(o,r),en(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:s=>{if(s!==i)throw e()}}),o},W8=(t,e,n,r,i,o)=>{const a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},d=(p,g,C,v)=>{const m=new Float32Array(16385),y=new Float32Array(16385);for(let D=0;D<16385;D+=1){const T=D/16384*l;m[D]=Math.cos(T),y[D]=Math.sin(T)}const x=n(p,{...c,gain:0}),b=r(p,{...u,curve:m}),E=r(p,{...u,curve:a}),A=n(p,{...c,gain:0}),k=r(p,{...u,curve:y});return{connectGraph(){g.connect(x),g.connect(E.inputs===void 0?E:E.inputs[0]),g.connect(A),E.connect(C),C.connect(b.inputs===void 0?b:b.inputs[0]),C.connect(k.inputs===void 0?k:k.inputs[0]),b.connect(x.gain),k.connect(A.gain),x.connect(v,0,0),A.connect(v,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(E.inputs===void 0?E:E.inputs[0]),g.disconnect(A),E.disconnect(C),C.disconnect(b.inputs===void 0?b:b.inputs[0]),C.disconnect(k.inputs===void 0?k:k.inputs[0]),b.disconnect(x.gain),k.disconnect(A.gain),x.disconnect(v,0,0),A.disconnect(v,0,1)}}},f=(p,g,C,v)=>{const m=new Float32Array(16385),y=new Float32Array(16385),x=new Float32Array(16385),b=new Float32Array(16385),E=Math.floor(16385/2);for(let ie=0;ie<16385;ie+=1)if(ie>E){const $=(ie-E)/(16384-E)*l;m[ie]=Math.cos($),y[ie]=Math.sin($),x[ie]=0,b[ie]=1}else{const $=ie/(16384-E)*l;m[ie]=1,y[ie]=0,x[ie]=Math.cos($),b[ie]=Math.sin($)}const A=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=n(p,{...c,gain:0}),D=r(p,{...u,curve:m}),T=n(p,{...c,gain:0}),R=r(p,{...u,curve:y}),P=r(p,{...u,curve:a}),L=n(p,{...c,gain:0}),G=r(p,{...u,curve:x}),Z=n(p,{...c,gain:0}),q=r(p,{...u,curve:b});return{connectGraph(){g.connect(A),g.connect(P.inputs===void 0?P:P.inputs[0]),A.connect(k,0),A.connect(T,0),A.connect(L,1),A.connect(Z,1),P.connect(C),C.connect(D.inputs===void 0?D:D.inputs[0]),C.connect(R.inputs===void 0?R:R.inputs[0]),C.connect(G.inputs===void 0?G:G.inputs[0]),C.connect(q.inputs===void 0?q:q.inputs[0]),D.connect(k.gain),R.connect(T.gain),G.connect(L.gain),q.connect(Z.gain),k.connect(v,0,0),L.connect(v,0,0),T.connect(v,0,1),Z.connect(v,0,1)},disconnectGraph(){g.disconnect(A),g.disconnect(P.inputs===void 0?P:P.inputs[0]),A.disconnect(k,0),A.disconnect(T,0),A.disconnect(L,1),A.disconnect(Z,1),P.disconnect(C),C.disconnect(D.inputs===void 0?D:D.inputs[0]),C.disconnect(R.inputs===void 0?R:R.inputs[0]),C.disconnect(G.inputs===void 0?G:G.inputs[0]),C.disconnect(q.inputs===void 0?q:q.inputs[0]),D.disconnect(k.gain),R.disconnect(T.gain),G.disconnect(L.gain),q.disconnect(Z.gain),k.disconnect(v,0,0),L.disconnect(v,0,0),T.disconnect(v,0,1),Z.disconnect(v,0,1)}}},h=(p,g,C,v,m)=>{if(g===1)return d(p,C,v,m);if(g===2)return f(p,C,v,m);throw i()};return(p,{channelCount:g,channelCountMode:C,pan:v,...m})=>{if(C==="max")throw i();const y=t(p,{...m,channelCount:1,channelCountMode:C,numberOfInputs:2}),x=n(p,{...m,channelCount:g,channelCountMode:C,gain:1}),b=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:E,disconnectGraph:A}=h(p,g,x,b,y);Object.defineProperty(b.gain,"defaultValue",{get:()=>0}),Object.defineProperty(b.gain,"maxValue",{get:()=>1}),Object.defineProperty(b.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount(P){x.channelCount!==P&&(D&&A(),{connectGraph:E,disconnectGraph:A}=h(p,P,x,b,y),D&&E()),x.channelCount=P},get channelCountMode(){return x.channelCountMode},set channelCountMode(P){if(P==="clamped-max"||P==="max")throw i();x.channelCountMode=P},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation(P){x.channelInterpretation=P},get context(){return x.context},get inputs(){return[x]},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get pan(){return b.gain},addEventListener(...P){return x.addEventListener(P[0],P[1],P[2])},dispatchEvent(...P){return x.dispatchEvent(P[0])},removeEventListener(...P){return x.removeEventListener(P[0],P[1],P[2])}};let D=!1;const T=()=>{E(),D=!0},R=()=>{A(),D=!1};return o(su(k,y),T,R)}},j8=(t,e,n,r,i,o,s)=>(a,l)=>{const c=a.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,l);bn(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw e();Ht(c,{curve:u},"curve"),Ht(c,l,"oversample");let d=null,f=!1;return s(c,"curve",g=>()=>g.call(c),g=>C=>(g.call(c,C),f&&(r(C)&&d===null?d=t(a,c):!r(C)&&d!==null&&(d(),d=null)),C)),i(c,()=>{f=!0,r(c.curve)&&(d=t(a,c))},()=>{f=!1,d!==null&&(d(),d=null)})},z8=(t,e,n,r,i)=>(o,{curve:s,oversample:a,...l})=>{const c=o.createWaveShaper(),u=o.createWaveShaper();bn(c,l),bn(u,l);const d=n(o,{...l,gain:1}),f=n(o,{...l,gain:-1}),h=n(o,{...l,gain:1}),p=n(o,{...l,gain:-1});let g=null,C=!1,v=null;const m={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(b){d.channelCount=b,f.channelCount=b,c.channelCount=b,h.channelCount=b,u.channelCount=b,p.channelCount=b},get channelCountMode(){return c.channelCountMode},set channelCountMode(b){d.channelCountMode=b,f.channelCountMode=b,c.channelCountMode=b,h.channelCountMode=b,u.channelCountMode=b,p.channelCountMode=b},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(b){d.channelInterpretation=b,f.channelInterpretation=b,c.channelInterpretation=b,h.channelInterpretation=b,u.channelInterpretation=b,p.channelInterpretation=b},get context(){return c.context},get curve(){return v},set curve(b){if(b!==null&&b.length<2)throw e();if(b===null)c.curve=b,u.curve=b;else{const E=b.length,A=new Float32Array(E+2-E%2),k=new Float32Array(E+2-E%2);A[0]=b[0],k[0]=-b[E-1];const D=Math.ceil((E+1)/2),T=(E+1)/2-1;for(let R=1;R<D;R+=1){const P=R/D*T,L=Math.floor(P),G=Math.ceil(P);A[R]=L===G?b[L]:(1-(P-L))*b[L]+(1-(G-P))*b[G],k[R]=L===G?-b[E-1-L]:-((1-(P-L))*b[E-1-L])-(1-(G-P))*b[E-1-G]}A[D]=E%2===1?b[D-1]:(b[D-2]+b[D-1])/2,c.curve=A,u.curve=k}v=b,C&&(r(v)&&g===null?g=t(o,d):g!==null&&(g(),g=null))},get inputs(){return[d]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(b){c.oversample=b,u.oversample=b},addEventListener(...b){return d.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return d.dispatchEvent(b[0])},removeEventListener(...b){return d.removeEventListener(b[0],b[1],b[2])}};s!==null&&(m.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==m.oversample&&(m.oversample=a);const y=()=>{d.connect(c).connect(h),d.connect(f).connect(u).connect(p).connect(h),C=!0,r(v)&&(g=t(o,d))},x=()=>{d.disconnect(c),c.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),C=!1,g!==null&&(g(),g=null)};return i(su(m,h),y,x)},Br=()=>new DOMException("","NotSupportedError"),H8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Z8=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...H8,...c},f=n(u,d),h=o(u),p=h?r():null,g=l.sampleRate/2;super(l,!1,f,p),this._detune=e(this,h,f.detune,153600,-153600),this._frequency=e(this,h,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Zc(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),_s(this)&&Sf(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},$8=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,l=null;const c=async(u,d)=>{let f=n(u);const h=Qn(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:s===null?void 0:s,type:f.type};f=e(d,p),a!==null&&f.start(a),l!==null&&f.stop(l)}return o.set(d,f),h?(await t(d,u.detune,f.detune),await t(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){l=u},render(u,d){const f=o.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},X8={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},K8=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...X8,...c},f=n(u,d),h=o(u),p=h?r():null;super(l,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,h,f.orientationX,or,Kr),this._orientationY=e(this,h,f.orientationY,or,Kr),this._orientationZ=e(this,h,f.orientationZ,or,Kr),this._positionX=e(this,h,f.positionX,or,Kr),this._positionY=e(this,h,f.positionY,or,Kr),this._positionZ=e(this,h,f.positionZ,or,Kr),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},J8=(t,e,n,r,i,o,s,a,l,c)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let g=null,C=o(h);const v={channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation},m={...v,coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,panningModel:C.panningModel,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor},y=Qn(C,p);if("bufferSize"in C)g=r(p,{...v,gain:1});else if(!y){const x={...m,orientationX:C.orientationX.value,orientationY:C.orientationY.value,orientationZ:C.orientationZ.value,positionX:C.positionX.value,positionY:C.positionY.value,positionZ:C.positionZ.value};C=i(p,x)}if(u.set(p,g===null?C:g),g!==null){if(d===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const R=new s(6,h.context.length,p.sampleRate),P=e(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});P.connect(R.destination),d=(async()=>{const L=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(G,Z)=>{const q=n(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Z===0?1:0});return await a(R,G,q.offset),q}));for(let G=0;G<6;G+=1)L[G].connect(P,0,G),L[G].start(0);return c(R)})()}const x=await d,b=r(p,{...v,gain:1});await l(h,p,b);const E=[];for(let R=0;R<x.numberOfChannels;R+=1)E.push(x.getChannelData(R));let A=[E[0][0],E[1][0],E[2][0]],k=[E[3][0],E[4][0],E[5][0]],D=r(p,{...v,gain:1}),T=i(p,{...m,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:k[0],positionY:k[1],positionZ:k[2]});b.connect(D).connect(T.inputs[0]),T.connect(g);for(let R=128;R<x.length;R+=128){const P=[E[0][R],E[1][R],E[2][R]],L=[E[3][R],E[4][R],E[5][R]];if(P.some((G,Z)=>G!==A[Z])||L.some((G,Z)=>G!==k[Z])){A=P,k=L;const G=R/p.sampleRate;D.gain.setValueAtTime(0,G),D=r(p,{...v,gain:0}),T=i(p,{...m,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),D.gain.setValueAtTime(1,G),b.connect(D).connect(T.inputs[0]),T.connect(g)}}return g}return y?(await t(p,h.orientationX,C.orientationX),await t(p,h.orientationY,C.orientationY),await t(p,h.orientationZ,C.orientationZ),await t(p,h.positionX,C.positionX),await t(p,h.positionY,C.positionY),await t(p,h.positionZ,C.positionZ)):(await a(p,h.orientationX,C.orientationX),await a(p,h.orientationY,C.orientationY),await a(p,h.orientationZ,C.orientationZ),await a(p,h.positionX,C.positionX),await a(p,h.positionY,C.positionY),await a(p,h.positionZ,C.positionZ)),ou(C)?await l(h,p,C.inputs[0]):await l(h,p,C),C};return{render(h,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):f(h,p)}}},Y8={disableNormalization:!1},q8=(t,e,n,r)=>class R2{constructor(o,s){const a=e(o),l=r({...Y8,...s}),c=t(a,l);return n.add(c),c}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===R2.prototype||n.has(o)}},Q8=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),eL=(t,e,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(s.activeInputs.map((a,l)=>Array.from(a).map(async([c,u])=>{const f=await e(c).render(c,i),h=r.context.destination;!n(c)&&(r!==h||!n(r))&&f.connect(o,u,l)})).reduce((a,l)=>[...a,...l],[]))},tL=(t,e,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,l])=>{const u=await t(a).render(a,i);n(a)||u.connect(o,l)}))},nL=(t,e,n,r)=>i=>t(dC,()=>dC(i))?Promise.resolve(t(r,r)).then(o=>{if(!o){const s=n(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{s.disconnect(),o(a.renderedBuffer)},s.connect(i.destination),i.startRendering()}),rL=t=>(e,n)=>{t.set(e,n)},iL=t=>(e,n)=>t.set(e,n),oL={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},sL=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...oL,...l},d=n(c,u),f=o(c),h=f?r():null;super(a,!1,d,h),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},aL=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=Qn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(l,d)}return o.set(l,c),u?await t(l,a.pan,c.pan):await r(l,a.pan,c.pan),ou(c)?await i(a,l,c.inputs[0]):await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},lL=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},cL=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),l=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>s=!0,l.connect(a),l.start(0),await r.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s},uL=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},dL=()=>new DOMException("","UnknownError"),fL={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},hL=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...fL,...c},f=n(u,d),p=o(u)?r():null;super(l,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},pL=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!Qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(s,c)}return r.set(s,a),ou(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},gL=()=>typeof window>"u"?null:window,mL=(t,e)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)r[d]=c[d+s]},n.copyToChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)c[d+s]=r[d]}},vL=t=>e=>{e.copyFromChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyToChannel)},CL=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},yL=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let l=0;l<a;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},_2=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),D2=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},_f=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:r(s)})},xL=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),IL=t=>({...t,channelCount:t.numberOfOutputs}),bL=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},P2=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;P2(t,e,n+1e-7)}},AL=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},wL=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},SL=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},M1=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},N2=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},L1=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},kL=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},EL=t=>{t.start=(e=>(n=0,r=0,i)=>{const o=t.buffer,s=o===null?r:Math.min(o.duration,r);o!==null&&s>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,i)})(t.start)},B2=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),su(t,n),t.stop=(i=>{let o=!1;return(s=0)=>{if(o)try{i.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else i.call(t,s),o=!0}})(t.stop)},au=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},TL=tF(Ll),RL=aF(Ll),_L=yM(Bp),O2=new WeakMap,DL=MM(O2),Ws=JF(new Map,new WeakMap),Lo=gL(),F2=c8(Ws,Wo),M2=FM(cr),jn=eL(cr,M2,kl),PL=fF(F2,Ut,jn),Dt=VM(h2),Wa=F8(Lo),At=QM(Wa),L2=new WeakMap,U2=RM(au),Df=h8(Lo),V2=KM(Df),G2=JM(Lo),NL=YM(Lo),Xd=g8(Lo),on=LF(nF(c2),sF(TL,RL,O0,_L,F0,cr,DL,wf,Ut,Ll,_s,kl,_h),Ws,XM(oC,F0,cr,Ut,$d,_s),Wo,Op,Br,gM(O0,oC,cr,Ut,$d,Dt,_s,At),bM(L2,cr,Yi),U2,Dt,V2,G2,NL,At,Xd),BL=dF(on,PL,Wo,F2,Dt,At),W2=new WeakSet,Yb=u8(Lo),j2=cM(new Uint32Array(1)),z2=mL(j2,Wo),H2=vL(j2),OL=pF(W2,Ws,Br,Yb,Wa,lL(Yb),z2,H2),Fp=lF(Nr),Z2=tL(M2,kf,kl),jo=rM(Z2),lu=f8(Fp,Ws,AL,wL,SL,M1,N2,L1,EL,CL(_f),B2),zo=Q8(LM(kf),Z2),FL=vF(jo,lu,Ut,zo,jn),to=UF(rF(d2),L2,f2,VF,KO,JO,YO,qO,QO,nC,a2,Df,P2),ML=mF(on,FL,to,Mn,lu,Dt,At,au),LL=EF(on,TF,Wo,Mn,p8(Nr,_f),Dt,At,jn),UL=KF(jo,E2,Ut,zo,jn),Ul=iL(O2),VL=XF(on,to,UL,Op,E2,Dt,At,Ul),ja=a8(Ll,G2),GL=yL(Mn,ja),za=b8(Df,GL),WL=QF(za,Ut,jn),jL=qF(on,WL,za,Dt,At),zL=nM(Tf,Ut,jn),HL=tM(on,zL,Tf,Dt,At,IL),ZL=S8(Fp,lu,Nr,ja),cu=w8(Fp,Ws,ZL,M1,L1),$L=lM(jo,cu,Ut,zo,jn),XL=aM(on,to,$L,cu,Dt,At,au),$2=k8(Br,_f),KL=fM($2,Ut,jn),JL=dM(on,KL,$2,Dt,At,Ul),YL=CM(jo,T2,Ut,zo,jn),qL=vM(on,to,YL,T2,Dt,At,Ul),X2=E8(Br),QL=kM(jo,X2,Ut,zo,jn),e6=SM(on,to,QL,X2,Br,Dt,At,Ul),t6=BM(jo,Nr,Ut,zo,jn),n6=NM(on,to,t6,Nr,Dt,At),r6=D8(Op,Mn,Rf,Br),U1=nL(Ws,Nr,Rf,uL(Nr,Wa)),i6=$M(lu,Ut,Wa,jn,U1),o6=T8(r6),s6=HM(on,o6,i6,Dt,At,Ul),a6=RF(to,za,cu,Rf,Br,_2,At,_f),K2=new WeakMap,l6=s8(LL,a6,U2,At,K2,au),J2=M8(Fp,Ws,M1,N2,L1,B2),c6=$8(jo,J2,Ut,zo,jn),u6=Z8(on,to,J2,c6,Dt,At,au),Y2=oM(lu),d6=z8(Y2,Mn,Nr,D2,ja),Mp=j8(Y2,Mn,d6,D2,ja,Df,_f),f6=U8(O0,Mn,za,Nr,Rf,Mp,Br,F0,_2,ja),q2=L8(f6),h6=J8(jo,za,cu,Nr,q2,Ut,Wa,zo,jn,U1),p6=K8(on,to,q2,h6,Dt,At,Ul),g6=V8(Wo),m6=q8(g6,Dt,new WeakSet,bL),v6=W8(za,Tf,Nr,Mp,Br,ja),Q2=G8(v6,Br),C6=aL(jo,Q2,Ut,zo,jn),y6=sL(on,to,Q2,C6,Dt,At),x6=pL(Mp,Ut,jn),I6=hL(on,Mn,Mp,x6,Dt,At,Ul),eR=e8(Lo),V1=_M(Lo),tR=new WeakMap,b6=GM(tR,Wa),A6=eR?oF(Ws,Br,TM(Lo),V1,DM(eF),Dt,b6,At,Xd,new WeakMap,new WeakMap,cL(Xd,Wa),Lo):void 0,w6=qM(V2,At),S6=pM(W2,Ws,hM,EM,new WeakSet,Dt,w6,cC,dC,z2,H2),k6=ZF(A6,BL,OL,ML,VL,jL,HL,XL,JL,S6,qL,e6,n6,s6,l6,u6,p6,m6,y6,I6),E6=t8(on,P8,Dt,At),T6=r8(on,N8,Dt,At),R6=i8(on,B8,Dt,At),_6=O8(Mn,At),D6=o8(on,_6,Dt),P6=kF(k6,Mn,Br,dL,E6,T6,R6,D6,Df),nR=WM(K2),N6=cF(nR),rR=iM(Wo),B6=xM(nR),iR=AM(Wo),oR=new WeakMap,O6=OM(oR,Yi),F6=I8(rR,Wo,Mn,za,Tf,cu,Nr,Rf,Br,iR,V1,O6,ja),M6=v8(Mn,F6,Nr,Br,ja),L6=HF(jo,rR,lu,za,Tf,cu,Nr,B6,iR,V1,Ut,Xd,Wa,zo,jn,U1),U6=UM(tR),V6=rL(oR),qb=eR?WF(N6,on,to,L6,M6,cr,U6,Dt,At,Xd,xL,V6,kL,au):void 0,G6="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";let Qb=class{constructor(e){M(this,"maxSize");M(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}has(e){return this.cache.has(e)}};const eA=100;var kt;let W6=(kt=class{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getBufferFromCache(e,n){try{const r=await n.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,n,r,i){try{const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const s=await fetch(e,{headers:o}),a=s.clone();if(s.status===200){const l=s.headers.get("ETag")||void 0,c=s.headers.get("Last-Modified")||void 0,u={url:e,etag:l,lastModified:c,timestamp:Date.now()};await n.put(e,a),await n.put(e+":meta",new Response(JSON.stringify(u),{headers:{"Content-Type":"application/json"}}))}else if(s.status===304){const l=await n.match(e);if(l)return await l.arrayBuffer()}return await s.arrayBuffer()}catch(o){throw console.error("Failed to fetch and cache data:",o),o}}static async decodeAudioData(e,n){try{return await e.decodeAudioData(n)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,n){try{const r=await n.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}async getAudioBuffer(e,n){if(kt.decodedBuffers.has(n))return kt.decodedBuffers.get(n);if(n.startsWith("data:")){const a=n.split(",")[1],l=Uint8Array.from(atob(a),u=>u.charCodeAt(0)).buffer,c=await kt.decodeAudioData(e,l);return kt.decodedBuffers.set(n,c),c}const r=await kt.openCache();let i=kt.pendingRequests.get(n);if(i)return i;const o=await kt.getMetadataFromCache(n,r);let s=!o;if(o&&(o.etag||o.lastModified?s=!1:o.timestamp?s=Date.now()-o.timestamp>kt.cacheExpirationTime:s=!0),s)return i=kt.fetchAndCacheBuffer(n,r,o==null?void 0:o.etag,o==null?void 0:o.lastModified).then(a=>kt.decodeAudioData(e,a)).then(a=>(kt.decodedBuffers.set(n,a),a)).finally(()=>{kt.pendingRequests.delete(n)}),kt.pendingRequests.set(n,i),i;{const a=await kt.getBufferFromCache(n,r);if(a){const l=await kt.decodeAudioData(e,a);return kt.decodedBuffers.set(n,l),l}}throw new Error("Failed to retrieve audio buffer")}clearMemoryCache(){kt.decodedBuffers=new Qb(eA),kt.pendingRequests.clear()}},M(kt,"pendingRequests",new Map),M(kt,"decodedBuffers",new Qb(eA)),M(kt,"cacheExpirationTime",24*60*60*1e3),kt),tA=class{constructor(e=[]){M(this,"_position",[0,0,0]);M(this,"loopCount",0);M(this,"playIndex",0);this.sounds=e}preplayRandom(){if(this.sounds.length===0)return;const e=this.randomSound().preplay();return e.length>0?e[0]:void 0}playRandom(){const e=this.preplayRandom();return e&&e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)return;const n=this.sounds[this.playIndex].preplay();if(n.length!==0)return this.playIndex=(this.playIndex+1)%this.sounds.length,!e&&this.playIndex===0&&(this.playIndex=this.sounds.length),n[0]}playOrdered(e=!0){const n=this.preplayOrdered(e);return n&&n.play(),n}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.map(e=>e.preplay()).flat()}play(){const e=[];return this.preplay().forEach(n=>{n.play(),e.push(n)}),e}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}},uu=class{constructor(){M(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(n=>n.frequency.value!==e.frequency.value&&n.type!==e.type&&n.Q.value!==e.Q.value&&n.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((n,r)=>(n.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(n=>this.addFilter(n))}removeFilters(e){e.forEach(n=>this.removeFilter(n))}},j6=class extends uu{constructor(n,r,i,o=0){super();M(this,"context");M(this,"source");M(this,"gainNode");M(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}},z6=class extends uu{constructor(n){super();M(this,"context");M(this,"_position",[0,0,0]);M(this,"loopCount",0);M(this,"prevVolume",1);M(this,"microphoneGainNode");M(this,"streamPlayback");M(this,"stream");M(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new j6(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}};function sR(t){class e extends t{constructor(){super(...arguments);M(this,"playbacks",[]);M(this,"_position",[0,0,0]);M(this,"_stereoPan",0);M(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});M(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function aR(t){class e extends t{constructor(){super(...arguments);M(this,"panner");M(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=nA(i,-1,1),this.panner.pan.setValueAtTime(nA(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,s,a]=i,l=this.panner;l.positionX.value=o,l.positionY.value=s,l.positionZ.value=a}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function nA(t,e,n){return Math.min(Math.max(t,e),n)}function lR(t){class e extends t{constructor(){super(...arguments);M(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}let cR=class extends aR(lR(uu)){constructor(){super(...arguments);M(this,"source");M(this,"_playing",!1);M(this,"origin")}get isPlaying(){return this.source?this._playing:!1}};class G1 extends cR{constructor(n,r,i){super();M(this,"context");M(this,"loopCount",0);M(this,"currentLoop",0);M(this,"buffer");M(this,"_offset",0);M(this,"_startTime",0);M(this,"_state",0);M(this,"_playbackRate",1);M(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),this._state=1,"start"in this.source&&this.source.start?this.source.start(0,this._offset):"mediaElement"in this.source&&this.source.mediaElement&&this.source.mediaElement.play()))});this.origin=n,this.context=n.context,this.loopCount=n.loopCount,this.setPanType(n.panType,n.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(n){if("mediaElement"in n&&n.mediaElement)n.mediaElement.onended=this.loopEnded;else if("onended"in n)n.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(n){if(n<=0)throw new Error("Playback rate must be greater than 0");if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=n,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const n=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=n,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():this.recreateSource(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(n){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(n)||n<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=n,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.currentTime=n:this.recreateSource(),r&&this.play()}get currentTime(){if(this._state===1){const n=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+n}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&this.source.disconnect(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=[]}loop(n){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(n!==void 0&&(this.loopCount=n==="infinite"?"infinite":Math.max(0,n),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(n){const r=this.context.createBiquadFilter();r.type=n.type,r.frequency.value=n.frequency.value,r.Q.value=n.Q.value,r.gain.value=n.gain.value,this._filters.push(r),this.refreshFilters()}removeFilter(n){const r=this._filters.indexOf(n);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}clone(n={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=n.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=new G1(this.origin,o,i);return a.loopCount=s,a.currentLoop=this.currentLoop,a.setPanType(r,this.context),a.volume=this.volume,a.playbackRate=this._playbackRate,a._offset=this._offset,a._state=this._state,this._filters.forEach(l=>{const c=this.context.createBiquadFilter();c.type=l.type,c.frequency.value=l.frequency.value,c.Q.value=l.Q.value,c.gain.value=l.gain.value,a.addFilter(c)}),this._state===1&&a.play(),a}}let ih=class uR extends sR(uu){constructor(n,r,i,o,s=Kd.Buffer,a="HRTF"){super();M(this,"buffer");M(this,"context");M(this,"loopCount",0);M(this,"_playbackRate",1);this.url=n,this.globalGainNode=o,this.soundType=s,this.panType=a,this.buffer=r,this.context=i}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan,o=n.threeDOptions||this.threeDOptions,s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=n.playbackRate||this.playbackRate,l=n.volume!==void 0?n.volume:this.volume,c=n.position!==void 0?n.position:this.position,u=n.filters&&n.filters.length?n.filters:this._filters,d=new uR(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return d.loop(s),d.playbackRate=a,d.volume=l,r==="HRTF"?(d.threeDOptions=o,d.position=c):d.stereoPan=i,d.addFilters(u),d}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",n=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new G1(this,n,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return this.playbacks.length>0?this.playbacks[0].duration:((n=this.buffer)==null?void 0:n.duration)||NaN}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.loop(n)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}};function H6(t){class e extends cR{constructor(){super(...arguments);M(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}let Z6=class extends H6(aR(lR(uu))){constructor(n,r,i){super();M(this,"context");this.origin=n,this.source=r,this.context=n.context,this.setPanType(n.panType,n.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}},$6=class dR extends sR(uu){constructor(n,r,i=Kd.Oscillator,o="HRTF",s={}){super();M(this,"_oscillatorOptions");M(this,"playbacks",[]);this.context=n,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=n,this._oscillatorOptions=s}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan??0,o=n.threeDOptions||this.threeDOptions,s=n.volume!==void 0?n.volume:this.volume,a=n.position&&n.position.length?n.position:this.position,l=n.filters&&n.filters.length?n.filters:this._filters,c=n.oscillatorOptions||this._oscillatorOptions,u=new dR(this.context,this.globalGainNode,this.soundType,r,c);return u._volume=s,u._position=a,u._stereoPan=i,u._threeDOptions=o,u.addFilters(l),u}preplay(){const n=this.context.createOscillator();this.oscillatorOptions.detune&&(n.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(n.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(n.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new Z6(this,n,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(n){this._oscillatorOptions=n,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(n){this._oscillatorOptions.frequency=n,this.playbacks.forEach(r=>r.frequency=n)}get detune(){return this.oscillatorOptions.detune}set detune(n){this._oscillatorOptions.detune=n,this.playbacks.forEach(r=>r.detune=n)}get type(){return this.oscillatorOptions.type||"sine"}set type(n){this._oscillatorOptions.type=n,this.playbacks.forEach(r=>r.type=n)}};var Kd=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t.Oscillator="oscillator",t))(Kd||{});let X6=class{constructor(e,n){M(this,"context");M(this,"globalGainNode");M(this,"listener");M(this,"prevVolume",1);M(this,"finalizationRegistry");M(this,"cache");M(this,"createBiquadFilter",({type:e,frequency:n,gain:r,Q:i})=>{n===void 0&&(n=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=n,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new P6,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.cache=n||new W6,this.finalizationRegistry=new FinalizationRegistry(r=>{r.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",G6):console.warn("AudioWorklet not supported")}async createWorkletNode(e,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new qb(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new qb(this.context,e)}}clearMemoryCache(){this.cache.clearMemoryCache()}createOscillator(e,n="HRTF"){return new $6(this.context,this.globalGainNode,"oscillator",n,e)}async createSound(e,n="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new ih("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(n==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new ih(i,void 0,this.context,this.globalGainNode,"HTML",r)}return this.cache.getAudioBuffer(this.context,i).then(o=>new ih(i,o,this.context,this.globalGainNode,n,r))}async createGroup(e){const n=new tA;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e,n="Buffer",r="HRTF"){const i=new tA;return(await Promise.all(e.map(o=>this.createSound(o,n,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return new ih(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:s,channelCountMode:a,channelInterpretation:l,panningModel:c,refDistance:u,rolloffFactor:d,positionX:f,positionY:h,positionZ:p,orientationX:g,orientationY:C,orientationZ:v}){const m=this.context.createPanner();return m.coneInnerAngle=e||360,m.coneOuterAngle=n||360,m.coneOuterGain=r||0,m.distanceModel=i||"inverse",m.maxDistance=o||1e4,m.channelCount=s||2,m.channelCountMode=a||"clamped-max",m.channelInterpretation=l||"speakers",m.panningModel=c||"HRTF",m.refDistance=u||1,m.rolloffFactor=d||1,m.positionX.value=f||0,m.positionY.value=h||0,m.positionZ.value=p||0,m.orientationX.value=g||0,m.orientationY.value=C||0,m.orientationZ.value=v||0,m}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new z6(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,o,s]=n,[a,l,c]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=s,this.listener.upX.value=a,this.listener.upY.value=l,this.listener.upZ.value=c}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.value=n,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.value=n,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(n,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}};const K6="https://mongoose.world:9080/?url=";class J6 extends Vt{constructor(){super(...arguments);M(this,"packageName","Client.Media");M(this,"sounds",{});M(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let s=await this.client.cacophony.createSound(r);s.key=i,this.sounds[i]=s}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=K6+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];const o=n.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,Kd.HTML,o):i=await this.client.cacophony.createSound(r,Kd.Buffer,o)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0){const s=n.loops===-1?1/0:n.loops-1;i.loop(s)}if(n.start&&i.seek(n.start/1e3),n.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const a=this.sounds[s];a.priority&&a.priority<n.priority&&a.stop()}i.priority=n.priority}i.isPlaying||(i.play()[0],n.fadein,n.fadeout),i.key=n.key,this.sounds[i.key]=i}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>this.stopSound(r)),n.type&&this.soundsByType(n.type).forEach(r=>this.stopSound(r)),n.tag&&this.soundsByTag(n.tag).forEach(r=>this.stopSound(r)),n.key&&this.soundsByKey(n.key).forEach(r=>this.stopSound(r)),!n.name&&!n.type&&!n.tag&&!n.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(n){delete this.sounds[n.key],n.stop()}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class Y6 extends Vt{constructor(){super(...arguments);M(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class q6 extends Vt{constructor(){super(...arguments);M(this,"packageName","Comm.Channel");M(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){console.log(`Received Comm.Channel.Text on ${n.channel} from ${n.talker}: ${n.text}`),this.client.emit("channelText",n),n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}handlePlayers(n){console.log("Received Comm.Channel.Players:",n),this.client.emit("channelPlayers",n)}sendPlayersRequest(){this.sendData("Players","")}sendEnable(n){this.sendData("Enable",n)}handleStart(n){console.log(`Received Comm.Channel.Start for ${n}`),this.client.emit("channelStart",n)}handleEnd(n){console.log(`Received Comm.Channel.End for ${n}`),this.client.emit("channelEnd",n)}}class Q6 extends Vt{constructor(){super(...arguments);M(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class e9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}sendKeepAlive(){this.sendData("KeepAlive")}sendPing(n){this.sendData("Ping",n)}handlePing(){console.log("Received Core.Ping response from server."),this.client.emit("corePing")}handleGoodbye(n){console.log(`Server sent Core.Goodbye: ${n}`),this.client.emit("coreGoodbye",n)}}class t9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).filter(r=>r.packageName&&r.packageVersion).map(r=>`${r.packageName} ${r.packageVersion.toString()}`);this.sendData("Set",n)}sendAdd(n){const r=n.map(i=>`${i.name} ${i.version}`);this.sendData("Add",r)}sendRemove(n){this.sendData("Remove",n)}}class n9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Afflictions")}handleList(n){console.log("Received Char.Afflictions.List:",n),this.client.emit("afflictionsList",n)}handleAdd(n){console.log("Received Char.Afflictions.Add:",n),this.client.emit("afflictionAdd",n)}handleRemove(n){console.log("Received Char.Afflictions.Remove:",n),this.client.emit("afflictionRemove",n)}}class r9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Defences")}handleList(n){console.log("Received Char.Defences.List:",n),this.client.emit("defencesList",n)}handleAdd(n){console.log("Received Char.Defences.Add:",n),this.client.emit("defenceAdd",n)}handleRemove(n){console.log("Received Char.Defences.Remove:",n),this.client.emit("defenceRemove",n)}}class i9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Items")}handleList(n){console.log(`Received Char.Items.List for ${n.location}:`,n.items),this.client.emit("itemsList",n)}handleAdd(n){console.log(`Received Char.Items.Add for ${n.location}:`,n.item),this.client.emit("itemAdd",n)}handleRemove(n){console.log(`Received Char.Items.Remove for ${n.location}:`,n.item),this.client.emit("itemRemove",n)}handleUpdate(n){console.log(`Received Char.Items.Update for ${n.location}:`,n.item),this.client.emit("itemUpdate",n)}sendContentsRequest(n){this.sendData("Contents",n)}sendInventoryRequest(){this.sendData("Inv","")}sendRoomRequest(){this.sendData("Room","")}}class o9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Char.Skills")}handleGroups(n){console.log("Received Char.Skills.Groups:",n),this.client.emit("skillGroups",n)}handleList(n){console.log(`Received Char.Skills.List for ${n.group}:`,n),this.client.emit("skillList",n)}handleInfo(n){console.log(`Received Char.Skills.Info for ${n.group}.${n.skill}:`,n.info),this.client.emit("skillInfo",n)}sendGetRequest(n,r){const i={};n&&(i.group=n),r&&(i.name=r),this.sendData("Get",i)}}class s9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Group")}handleInfo(n){console.log("Received Group.Info:",n),this.client.emit("groupInfo",n)}sendInfoRequest(){this.sendData("Info",{})}}class a9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Logging")}handleError(n){console.error("Received Logging.Error from server:",n),this.client.emit("gmcpError",n)}}class l9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Redirect")}handleWindow(n){const r=n||"main";console.log(`Received Redirect.Window: ${r}`),this.client.emit("redirectWindow",r)}}class c9 extends Vt{constructor(){super(...arguments);M(this,"packageName","Room");M(this,"name","");M(this,"id","");M(this,"exits",[]);M(this,"people",[])}handleInfo(n){this.name=n.name,this.name=n.name,this.id=n.num.toString(),this.client.worldData.roomId=this.id,this.client.currentRoomInfo=n,console.log("Received Room.Info:",n),this.client.emit("roomInfo",n)}handleWrongDir(n){console.log(`Received Room.WrongDir: ${n}`),this.client.emit("roomWrongDir",n)}handlePlayers(n){console.log("Received Room.Players:",n),this.client.emit("roomPlayers",n)}handleAddPlayer(n){console.log("Received Room.AddPlayer:",n),this.client.emit("roomAddPlayer",n)}handleRemovePlayer(n){console.log("Received Room.RemovePlayer:",n),this.client.emit("roomRemovePlayer",n)}}const Yl=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,fR=new Set,fC=typeof process=="object"&&process?process:{},hR=(t,e,n,r)=>{typeof fC.emitWarning=="function"?fC.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let V0=globalThis.AbortController,rA=globalThis.AbortSignal;var pk;if(typeof V0>"u"){rA=class{constructor(){M(this,"onabort");M(this,"_onabort",[]);M(this,"reason");M(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},V0=class{constructor(){M(this,"signal",new rA);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const s of this.signal._onabort)s(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let t=((pk=fC.env)==null?void 0:pk.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,hR("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const u9=t=>!fR.has(t),ea=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),pR=t=>ea(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?Dh:null:null;class Dh extends Array{constructor(e){super(e),this.fill(0)}}var Nc;const il=class il{constructor(e,n){M(this,"heap");M(this,"length");if(!F(il,Nc))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=pR(e);if(!n)return[];Oe(il,Nc,!0);const r=new il(e,n);return Oe(il,Nc,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};Nc=new WeakMap,ct(il,Nc,!1);let hC=il;var gk,mk,Ti,Lr,Ri,_i,Bc,Oc,pn,Di,cn,Ot,Ge,nr,Ur,$n,wn,Pi,Sn,Ni,Bi,Vr,Oi,da,rr,ve,gC,dl,ts,pf,Gr,gR,fl,Fc,gf,ta,na,mC,Ph,Nh,Bt,vC,td,ra,CC;const Yx=class Yx{constructor(e){ct(this,ve);ct(this,Ti);ct(this,Lr);ct(this,Ri);ct(this,_i);ct(this,Bc);ct(this,Oc);M(this,"ttl");M(this,"ttlResolution");M(this,"ttlAutopurge");M(this,"updateAgeOnGet");M(this,"updateAgeOnHas");M(this,"allowStale");M(this,"noDisposeOnSet");M(this,"noUpdateTTL");M(this,"maxEntrySize");M(this,"sizeCalculation");M(this,"noDeleteOnFetchRejection");M(this,"noDeleteOnStaleGet");M(this,"allowStaleOnFetchAbort");M(this,"allowStaleOnFetchRejection");M(this,"ignoreFetchAbort");ct(this,pn);ct(this,Di);ct(this,cn);ct(this,Ot);ct(this,Ge);ct(this,nr);ct(this,Ur);ct(this,$n);ct(this,wn);ct(this,Pi);ct(this,Sn);ct(this,Ni);ct(this,Bi);ct(this,Vr);ct(this,Oi);ct(this,da);ct(this,rr);ct(this,dl,()=>{});ct(this,ts,()=>{});ct(this,pf,()=>{});ct(this,Gr,()=>!1);ct(this,fl,e=>{});ct(this,Fc,(e,n,r)=>{});ct(this,gf,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});M(this,gk,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:l,dispose:c,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:g,fetchMethod:C,memoMethod:v,noDeleteOnFetchRejection:m,noDeleteOnStaleGet:y,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:b,ignoreFetchAbort:E}=e;if(n!==0&&!ea(n))throw new TypeError("max option must be a nonnegative integer");const A=n?pR(n):Array;if(!A)throw new Error("invalid max value: "+n);if(Oe(this,Ti,n),Oe(this,Lr,h),this.maxEntrySize=p||F(this,Lr),this.sizeCalculation=g,this.sizeCalculation){if(!F(this,Lr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("memoMethod must be a function if defined");if(Oe(this,Oc,v),C!==void 0&&typeof C!="function")throw new TypeError("fetchMethod must be a function if specified");if(Oe(this,Bc,C),Oe(this,da,!!C),Oe(this,cn,new Map),Oe(this,Ot,new Array(n).fill(void 0)),Oe(this,Ge,new Array(n).fill(void 0)),Oe(this,nr,new A(n)),Oe(this,Ur,new A(n)),Oe(this,$n,0),Oe(this,wn,0),Oe(this,Pi,hC.create(n)),Oe(this,pn,0),Oe(this,Di,0),typeof c=="function"&&Oe(this,Ri,c),typeof u=="function"?(Oe(this,_i,u),Oe(this,Sn,[])):(Oe(this,_i,void 0),Oe(this,Sn,void 0)),Oe(this,Oi,!!F(this,Ri)),Oe(this,rr,!!F(this,_i)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!m,this.allowStaleOnFetchRejection=!!x,this.allowStaleOnFetchAbort=!!b,this.ignoreFetchAbort=!!E,this.maxEntrySize!==0){if(F(this,Lr)!==0&&!ea(F(this,Lr)))throw new TypeError("maxSize must be a positive integer if specified");if(!ea(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ee(this,ve,gR).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!y,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=ea(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!ea(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ee(this,ve,gC).call(this)}if(F(this,Ti)===0&&this.ttl===0&&F(this,Lr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!F(this,Ti)&&!F(this,Lr)){const k="LRU_CACHE_UNBOUNDED";u9(k)&&(fR.add(k),hR("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",k,Yx))}}static unsafeExposeInternals(e){return{starts:F(e,Bi),ttls:F(e,Vr),sizes:F(e,Ni),keyMap:F(e,cn),keyList:F(e,Ot),valList:F(e,Ge),next:F(e,nr),prev:F(e,Ur),get head(){return F(e,$n)},get tail(){return F(e,wn)},free:F(e,Pi),isBackgroundFetch:n=>{var r;return Ee(r=e,ve,Bt).call(r,n)},backgroundFetch:(n,r,i,o)=>{var s;return Ee(s=e,ve,Nh).call(s,n,r,i,o)},moveToTail:n=>{var r;return Ee(r=e,ve,td).call(r,n)},indexes:n=>{var r;return Ee(r=e,ve,ta).call(r,n)},rindexes:n=>{var r;return Ee(r=e,ve,na).call(r,n)},isStale:n=>{var r;return F(r=e,Gr).call(r,n)}}}get max(){return F(this,Ti)}get maxSize(){return F(this,Lr)}get calculatedSize(){return F(this,Di)}get size(){return F(this,pn)}get fetchMethod(){return F(this,Bc)}get memoMethod(){return F(this,Oc)}get dispose(){return F(this,Ri)}get disposeAfter(){return F(this,_i)}getRemainingTTL(e){return F(this,cn).has(e)?1/0:0}*entries(){for(const e of Ee(this,ve,ta).call(this))F(this,Ge)[e]!==void 0&&F(this,Ot)[e]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,Ge)[e])&&(yield[F(this,Ot)[e],F(this,Ge)[e]])}*rentries(){for(const e of Ee(this,ve,na).call(this))F(this,Ge)[e]!==void 0&&F(this,Ot)[e]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,Ge)[e])&&(yield[F(this,Ot)[e],F(this,Ge)[e]])}*keys(){for(const e of Ee(this,ve,ta).call(this)){const n=F(this,Ot)[e];n!==void 0&&!Ee(this,ve,Bt).call(this,F(this,Ge)[e])&&(yield n)}}*rkeys(){for(const e of Ee(this,ve,na).call(this)){const n=F(this,Ot)[e];n!==void 0&&!Ee(this,ve,Bt).call(this,F(this,Ge)[e])&&(yield n)}}*values(){for(const e of Ee(this,ve,ta).call(this))F(this,Ge)[e]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,Ge)[e])&&(yield F(this,Ge)[e])}*rvalues(){for(const e of Ee(this,ve,na).call(this))F(this,Ge)[e]!==void 0&&!Ee(this,ve,Bt).call(this,F(this,Ge)[e])&&(yield F(this,Ge)[e])}[(mk=Symbol.iterator,gk=Symbol.toStringTag,mk)](){return this.entries()}find(e,n={}){for(const r of Ee(this,ve,ta).call(this)){const i=F(this,Ge)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,F(this,Ot)[r],this))return this.get(F(this,Ot)[r],n)}}forEach(e,n=this){for(const r of Ee(this,ve,ta).call(this)){const i=F(this,Ge)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,F(this,Ot)[r],this)}}rforEach(e,n=this){for(const r of Ee(this,ve,na).call(this)){const i=F(this,Ge)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,F(this,Ot)[r],this)}}purgeStale(){let e=!1;for(const n of Ee(this,ve,na).call(this,{allowStale:!0}))F(this,Gr).call(this,n)&&(Ee(this,ve,ra).call(this,F(this,Ot)[n],"expire"),e=!0);return e}info(e){const n=F(this,cn).get(e);if(n===void 0)return;const r=F(this,Ge)[n],i=Ee(this,ve,Bt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(F(this,Vr)&&F(this,Bi)){const s=F(this,Vr)[n],a=F(this,Bi)[n];if(s&&a){const l=s-(Yl.now()-a);o.ttl=l,o.start=Date.now()}}return F(this,Ni)&&(o.size=F(this,Ni)[n]),o}dump(){const e=[];for(const n of Ee(this,ve,ta).call(this,{allowStale:!0})){const r=F(this,Ot)[n],i=F(this,Ge)[n],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const s={value:o};if(F(this,Vr)&&F(this,Bi)){s.ttl=F(this,Vr)[n];const a=Yl.now()-F(this,Bi)[n];s.start=Math.floor(Date.now()-a)}F(this,Ni)&&(s.size=F(this,Ni)[n]),e.unshift([r,s])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=Yl.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var f,h,p,g,C;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:l}=r;let{noUpdateTTL:c=this.noUpdateTTL}=r;const u=F(this,gf).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),Ee(this,ve,ra).call(this,e,"set"),this;let d=F(this,pn)===0?void 0:F(this,cn).get(e);if(d===void 0)d=F(this,pn)===0?F(this,wn):F(this,Pi).length!==0?F(this,Pi).pop():F(this,pn)===F(this,Ti)?Ee(this,ve,Ph).call(this,!1):F(this,pn),F(this,Ot)[d]=e,F(this,Ge)[d]=n,F(this,cn).set(e,d),F(this,nr)[F(this,wn)]=d,F(this,Ur)[d]=F(this,wn),Oe(this,wn,d),Ff(this,pn)._++,F(this,Fc).call(this,d,u,l),l&&(l.set="add"),c=!1;else{Ee(this,ve,td).call(this,d);const v=F(this,Ge)[d];if(n!==v){if(F(this,da)&&Ee(this,ve,Bt).call(this,v)){v.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:m}=v;m!==void 0&&!s&&(F(this,Oi)&&((f=F(this,Ri))==null||f.call(this,m,e,"set")),F(this,rr)&&((h=F(this,Sn))==null||h.push([m,e,"set"])))}else s||(F(this,Oi)&&((p=F(this,Ri))==null||p.call(this,v,e,"set")),F(this,rr)&&((g=F(this,Sn))==null||g.push([v,e,"set"])));if(F(this,fl).call(this,d),F(this,Fc).call(this,d,u,l),F(this,Ge)[d]=n,l){l.set="replace";const m=v&&Ee(this,ve,Bt).call(this,v)?v.__staleWhileFetching:v;m!==void 0&&(l.oldValue=m)}}else l&&(l.set="update")}if(i!==0&&!F(this,Vr)&&Ee(this,ve,gC).call(this),F(this,Vr)&&(c||F(this,pf).call(this,d,i,o),l&&F(this,ts).call(this,l,d)),!s&&F(this,rr)&&F(this,Sn)){const v=F(this,Sn);let m;for(;m=v==null?void 0:v.shift();)(C=F(this,_i))==null||C.call(this,...m)}return this}pop(){var e;try{for(;F(this,pn);){const n=F(this,Ge)[F(this,$n)];if(Ee(this,ve,Ph).call(this,!0),Ee(this,ve,Bt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(F(this,rr)&&F(this,Sn)){const n=F(this,Sn);let r;for(;r=n==null?void 0:n.shift();)(e=F(this,_i))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,o=F(this,cn).get(e);if(o!==void 0){const s=F(this,Ge)[o];if(Ee(this,ve,Bt).call(this,s)&&s.__staleWhileFetching===void 0)return!1;if(F(this,Gr).call(this,o))i&&(i.has="stale",F(this,ts).call(this,i,o));else return r&&F(this,dl).call(this,o),i&&(i.has="hit",F(this,ts).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=F(this,cn).get(e);if(i===void 0||!r&&F(this,Gr).call(this,i))return;const o=F(this,Ge)[i];return Ee(this,ve,Bt).call(this,o)?o.__staleWhileFetching:o}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:l=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:g,forceRefresh:C=!1,status:v,signal:m}=n;if(!F(this,da))return v&&(v.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:v});const y={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:l,sizeCalculation:c,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:v,signal:m};let x=F(this,cn).get(e);if(x===void 0){v&&(v.fetch="miss");const b=Ee(this,ve,Nh).call(this,e,x,y,g);return b.__returned=b}else{const b=F(this,Ge)[x];if(Ee(this,ve,Bt).call(this,b)){const T=r&&b.__staleWhileFetching!==void 0;return v&&(v.fetch="inflight",T&&(v.returnedStale=!0)),T?b.__staleWhileFetching:b.__returned=b}const E=F(this,Gr).call(this,x);if(!C&&!E)return v&&(v.fetch="hit"),Ee(this,ve,td).call(this,x),i&&F(this,dl).call(this,x),v&&F(this,ts).call(this,v,x),b;const A=Ee(this,ve,Nh).call(this,e,x,y,g),D=A.__staleWhileFetching!==void 0&&r;return v&&(v.fetch=E?"stale":"refresh",D&&E&&(v.returnedStale=!0)),D?A.__staleWhileFetching:A.__returned=A}}async forceFetch(e,n={}){const r=await this.fetch(e,n);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,n={}){const r=F(this,Oc);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...s}=n,a=this.get(e,s);if(!o&&a!==void 0)return a;const l=r(e,a,{options:s,context:i});return this.set(e,l,s),l}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=n,a=F(this,cn).get(e);if(a!==void 0){const l=F(this,Ge)[a],c=Ee(this,ve,Bt).call(this,l);return s&&F(this,ts).call(this,s,a),F(this,Gr).call(this,a)?(s&&(s.get="stale"),c?(s&&r&&l.__staleWhileFetching!==void 0&&(s.returnedStale=!0),r?l.__staleWhileFetching:void 0):(o||Ee(this,ve,ra).call(this,e,"expire"),s&&r&&(s.returnedStale=!0),r?l:void 0)):(s&&(s.get="hit"),c?l.__staleWhileFetching:(Ee(this,ve,td).call(this,a),i&&F(this,dl).call(this,a),l))}else s&&(s.get="miss")}delete(e){return Ee(this,ve,ra).call(this,e,"delete")}clear(){return Ee(this,ve,CC).call(this,"delete")}};Ti=new WeakMap,Lr=new WeakMap,Ri=new WeakMap,_i=new WeakMap,Bc=new WeakMap,Oc=new WeakMap,pn=new WeakMap,Di=new WeakMap,cn=new WeakMap,Ot=new WeakMap,Ge=new WeakMap,nr=new WeakMap,Ur=new WeakMap,$n=new WeakMap,wn=new WeakMap,Pi=new WeakMap,Sn=new WeakMap,Ni=new WeakMap,Bi=new WeakMap,Vr=new WeakMap,Oi=new WeakMap,da=new WeakMap,rr=new WeakMap,ve=new WeakSet,gC=function(){const e=new Dh(F(this,Ti)),n=new Dh(F(this,Ti));Oe(this,Vr,e),Oe(this,Bi,n),Oe(this,pf,(o,s,a=Yl.now())=>{if(n[o]=s!==0?a:0,e[o]=s,s!==0&&this.ttlAutopurge){const l=setTimeout(()=>{F(this,Gr).call(this,o)&&Ee(this,ve,ra).call(this,F(this,Ot)[o],"expire")},s+1);l.unref&&l.unref()}}),Oe(this,dl,o=>{n[o]=e[o]!==0?Yl.now():0}),Oe(this,ts,(o,s)=>{if(e[s]){const a=e[s],l=n[s];if(!a||!l)return;o.ttl=a,o.start=l,o.now=r||i();const c=o.now-l;o.remainingTTL=a-c}});let r=0;const i=()=>{const o=Yl.now();if(this.ttlResolution>0){r=o;const s=setTimeout(()=>r=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{const s=F(this,cn).get(o);if(s===void 0)return 0;const a=e[s],l=n[s];if(!a||!l)return 1/0;const c=(r||i())-l;return a-c},Oe(this,Gr,o=>{const s=n[o],a=e[o];return!!a&&!!s&&(r||i())-s>a})},dl=new WeakMap,ts=new WeakMap,pf=new WeakMap,Gr=new WeakMap,gR=function(){const e=new Dh(F(this,Ti));Oe(this,Di,0),Oe(this,Ni,e),Oe(this,fl,n=>{Oe(this,Di,F(this,Di)-e[n]),e[n]=0}),Oe(this,gf,(n,r,i,o)=>{if(Ee(this,ve,Bt).call(this,r))return 0;if(!ea(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,n),!ea(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Oe(this,Fc,(n,r,i)=>{if(e[n]=r,F(this,Lr)){const o=F(this,Lr)-e[n];for(;F(this,Di)>o;)Ee(this,ve,Ph).call(this,!0)}Oe(this,Di,F(this,Di)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=F(this,Di))})},fl=new WeakMap,Fc=new WeakMap,gf=new WeakMap,ta=function*({allowStale:e=this.allowStale}={}){if(F(this,pn))for(let n=F(this,wn);!(!Ee(this,ve,mC).call(this,n)||((e||!F(this,Gr).call(this,n))&&(yield n),n===F(this,$n)));)n=F(this,Ur)[n]},na=function*({allowStale:e=this.allowStale}={}){if(F(this,pn))for(let n=F(this,$n);!(!Ee(this,ve,mC).call(this,n)||((e||!F(this,Gr).call(this,n))&&(yield n),n===F(this,wn)));)n=F(this,nr)[n]},mC=function(e){return e!==void 0&&F(this,cn).get(F(this,Ot)[e])===e},Ph=function(e){var o,s;const n=F(this,$n),r=F(this,Ot)[n],i=F(this,Ge)[n];return F(this,da)&&Ee(this,ve,Bt).call(this,i)?i.__abortController.abort(new Error("evicted")):(F(this,Oi)||F(this,rr))&&(F(this,Oi)&&((o=F(this,Ri))==null||o.call(this,i,r,"evict")),F(this,rr)&&((s=F(this,Sn))==null||s.push([i,r,"evict"]))),F(this,fl).call(this,n),e&&(F(this,Ot)[n]=void 0,F(this,Ge)[n]=void 0,F(this,Pi).push(n)),F(this,pn)===1?(Oe(this,$n,Oe(this,wn,0)),F(this,Pi).length=0):Oe(this,$n,F(this,nr)[n]),F(this,cn).delete(r),Ff(this,pn)._--,n},Nh=function(e,n,r,i){const o=n===void 0?void 0:F(this,Ge)[n];if(Ee(this,ve,Bt).call(this,o))return o;const s=new V0,{signal:a}=r;a==null||a.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});const l={signal:s.signal,options:r,context:i},c=(g,C=!1)=>{const{aborted:v}=s.signal,m=r.ignoreFetchAbort&&g!==void 0;if(r.status&&(v&&!C?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,m&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),v&&!m&&!C)return d(s.signal.reason);const y=h;return F(this,Ge)[n]===h&&(g===void 0?y.__staleWhileFetching?F(this,Ge)[n]=y.__staleWhileFetching:Ee(this,ve,ra).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,g,l.options))),g},u=g=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=g),d(g)),d=g=>{const{aborted:C}=s.signal,v=C&&r.allowStaleOnFetchAbort,m=v||r.allowStaleOnFetchRejection,y=m||r.noDeleteOnFetchRejection,x=h;if(F(this,Ge)[n]===h&&(!y||x.__staleWhileFetching===void 0?Ee(this,ve,ra).call(this,e,"fetch"):v||(F(this,Ge)[n]=x.__staleWhileFetching)),m)return r.status&&x.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),x.__staleWhileFetching;if(x.__returned===x)throw g},f=(g,C)=>{var m;const v=(m=F(this,Bc))==null?void 0:m.call(this,e,o,l);v&&v instanceof Promise&&v.then(y=>g(y===void 0?void 0:y),C),s.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(g(void 0),r.allowStaleOnFetchAbort&&(g=y=>c(y,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(c,u),p=Object.assign(h,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return n===void 0?(this.set(e,p,{...l.options,status:void 0}),n=F(this,cn).get(e)):F(this,Ge)[n]=p,p},Bt=function(e){if(!F(this,da))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof V0},vC=function(e,n){F(this,Ur)[n]=e,F(this,nr)[e]=n},td=function(e){e!==F(this,wn)&&(e===F(this,$n)?Oe(this,$n,F(this,nr)[e]):Ee(this,ve,vC).call(this,F(this,Ur)[e],F(this,nr)[e]),Ee(this,ve,vC).call(this,F(this,wn),e),Oe(this,wn,e))},ra=function(e,n){var i,o,s,a;let r=!1;if(F(this,pn)!==0){const l=F(this,cn).get(e);if(l!==void 0)if(r=!0,F(this,pn)===1)Ee(this,ve,CC).call(this,n);else{F(this,fl).call(this,l);const c=F(this,Ge)[l];if(Ee(this,ve,Bt).call(this,c)?c.__abortController.abort(new Error("deleted")):(F(this,Oi)||F(this,rr))&&(F(this,Oi)&&((i=F(this,Ri))==null||i.call(this,c,e,n)),F(this,rr)&&((o=F(this,Sn))==null||o.push([c,e,n]))),F(this,cn).delete(e),F(this,Ot)[l]=void 0,F(this,Ge)[l]=void 0,l===F(this,wn))Oe(this,wn,F(this,Ur)[l]);else if(l===F(this,$n))Oe(this,$n,F(this,nr)[l]);else{const u=F(this,Ur)[l];F(this,nr)[u]=F(this,nr)[l];const d=F(this,nr)[l];F(this,Ur)[d]=F(this,Ur)[l]}Ff(this,pn)._--,F(this,Pi).push(l)}}if(F(this,rr)&&((s=F(this,Sn))!=null&&s.length)){const l=F(this,Sn);let c;for(;c=l==null?void 0:l.shift();)(a=F(this,_i))==null||a.call(this,...c)}return r},CC=function(e){var n,r,i;for(const o of Ee(this,ve,na).call(this,{allowStale:!0})){const s=F(this,Ge)[o];if(Ee(this,ve,Bt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const a=F(this,Ot)[o];F(this,Oi)&&((n=F(this,Ri))==null||n.call(this,s,a,e)),F(this,rr)&&((r=F(this,Sn))==null||r.push([s,a,e]))}}if(F(this,cn).clear(),F(this,Ge).fill(void 0),F(this,Ot).fill(void 0),F(this,Vr)&&F(this,Bi)&&(F(this,Vr).fill(0),F(this,Bi).fill(0)),F(this,Ni)&&F(this,Ni).fill(0),Oe(this,$n,0),Oe(this,wn,0),F(this,Pi).length=0,Oe(this,Di,0),Oe(this,pn,0),F(this,rr)&&F(this,Sn)){const o=F(this,Sn);let s;for(;s=o==null?void 0:o.shift();)(i=F(this,_i))==null||i.call(this,...s)}};let pC=Yx;function d9(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(e[3]);){const a=s[1]||s[3],l=s[2]||s[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=l}return{name:n,authKey:r,keyvals:i}}function iA(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],o=e[3],s={};return s[i]=o,{name:n,authKey:r,keyvals:s}}function oA(){return(Math.random()+1).toString(36).substring(3,9)}class du{constructor(e){M(this,"packageName");M(this,"minVersion",1);M(this,"maxVersion",1);M(this,"packageVersion",0);M(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class f9 extends du{constructor(){super(...arguments);M(this,"packageName","mcp-negotiate");M(this,"minVersion",2);M(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(n=i.minVersion)==null?void 0:n.toFixed(1),s=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":s})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class h9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class p9 extends du{constructor(n){super(n);M(this,"packageName","dns-org-mud-moo-simpleedit");M(this,"currentSession",null)}handle(n){n.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){this.currentSession&&"content"in n.keyvals?this.currentSession.contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class g9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-awns-getset");M(this,"id",1);M(this,"cache",new pC({max:10}));M(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class m9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-vmoo-userlist");M(this,"maxVersion",1.1);M(this,"player");M(this,"fields",["Object","Name","Icon"]);M(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);M(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=wi(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=wi(n.keyvals.icons.trim())),"d"in n.keyvals){const o=n.keyvals.d[0];switch(o){case"=":var r=wi(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(wi(n.keyvals.d.slice(1))));break;case"-":var i=wi(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const s=this.playerFromArray(wi(n.keyvals.d.slice(1)));this.updatePlayer(s);break;case"<":i=wi(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!0,this.players[l]=a)});break;case">":i=wi(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!1,this.players[l]=a)});break;case"[":i=wi(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!0,this.players[l]=a)});break;case"]":i=wi(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!1,this.players[l]=a)});break;default:console.log(`Unknown userlist mode ${o} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function wi(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let o=0;o<t.length;o++){const s=t[o];if(s==="{")r++;else if(s==="}")r--;else if(s===","&&r===0){i(),n="";continue}n+=s}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(wi(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class v9 extends du{constructor(){super(...arguments);M(this,"packageName","dns-com-awns-ping");M(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}var yC=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(yC||{}),Uo=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(Uo||{});class C9{constructor(){M(this,"state");M(this,"listeners",new Set);M(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1,volume:1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const vo=new C9;class y9 extends _p{constructor(n){super();M(this,"peerConnection",null);M(this,"dataChannel",null);M(this,"client");M(this,"connectionTimeout",3e5);M(this,"connectionTimeoutId");M(this,"recipient","");M(this,"pendingCandidates",[]);M(this,"remoteOfferReceived",!1);this.client=n}isDataChannelOpen(){return this.dataChannel!==null&&this.dataChannel.readyState==="open"}async createPeerConnection(){try{const n={iceServers:[{urls:["turn:mongoose.world:3478","stun:mongoose.world:3478"],username:"p2p",credential:"p2p"},{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(n),this.peerConnection.onconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.connectionState;switch(console.log("[WebRTCService] Connection state changed to:",r),this.emit("webRTCStateChange",`Connection: ${r}`),r){case"connected":console.log("[WebRTCService] Peer connection established successfully"),this.emit("webRTCConnected");break;case"disconnected":console.log("[WebRTCService] Connection temporarily disconnected"),this.emit("webRTCDisconnected"),setTimeout(()=>{var o;((o=this.peerConnection)==null?void 0:o.connectionState)==="disconnected"&&this.attemptRecovery()},5e3);break;case"failed":console.log("[WebRTCService] Connection failed - attempting immediate recovery"),this.attemptRecovery();break}},this.peerConnection.oniceconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceConnectionState;console.log("[WebRTCService] ICE connection state changed to:",r),this.emit("webRTCStateChange",`ICE: ${r}`),r==="failed"&&(console.log("[WebRTCService] ICE connection failed"),this.attemptRecovery())},this.peerConnection.onsignalingstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.signalingState;console.log("[WebRTCService] Signaling state changed to:",r),this.emit("webRTCStateChange",`Signaling: ${r}`),r==="stable"&&console.log("[WebRTCService] Signaling completed successfully")},this.peerConnection.onicegatheringstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceGatheringState;console.log("[WebRTCService] ICE gathering state changed to:",r),this.emit("webRTCStateChange",`ICE Gathering: ${r}`),r==="complete"&&(console.log("[WebRTCService] ICE gathering completed"),this.emit("iceGatheringComplete"))},this.peerConnection.onicecandidate=r=>{r.candidate?(console.debug("[WebRTCService] New ICE candidate:",{type:r.candidate.type,protocol:r.candidate.protocol,address:r.candidate.address,port:r.candidate.port}),this.recipient&&this.client.gmcp_fileTransfer.sendCandidate(this.recipient,r.candidate)):console.log("[WebRTCService] ICE gathering complete")},this.peerConnection.ondatachannel=r=>{console.log("[WebRTCService] Received data channel"),this.dataChannel=r.channel,this.setupDataChannel()},this.dataChannel||(console.log("[WebRTCService] Creating data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(n){throw console.error("Error creating peer connection:",n),n}}setupDataChannel(){this.dataChannel&&(this.dataChannel.onopen=()=>{var n;console.log("[WebRTCService] Data channel opened with state:",(n=this.dataChannel)==null?void 0:n.readyState),this.emit("dataChannelOpen")},this.dataChannel.onclose=()=>{console.log("[WebRTCService] Data channel closed"),this.emit("dataChannelClose")},this.dataChannel.onerror=n=>{console.error("[WebRTCService] Data channel error:",n),this.emit("dataChannelError",n)},this.dataChannel.onmessage=n=>{n.data instanceof ArrayBuffer&&this.emit("dataChannelMessage",n.data)})}async attemptRecovery(){try{console.log("[WebRTCService] Attempting connection recovery"),this.close(),await new Promise(n=>setTimeout(n,1e3)),await this.createPeerConnection(),console.log("[WebRTCService] Recovery attempt completed")}catch(n){console.error("[WebRTCService] Recovery attempt failed:",n)}}async attemptChannelRecovery(){var n;try{this.dataChannel=((n=this.peerConnection)==null?void 0:n.createDataChannel("fileTransfer"))??null,this.setupDataChannel()}catch(r){console.error("Failed to recover data channel:",r),this.emit("dataChannelRecoveryFailed",r)}}async sendData(n){if(!this.dataChannel)throw new Error("Data channel not initialized");if(this.dataChannel.readyState!=="open")throw new Error("Data channel is not open");try{for(;this.dataChannel.bufferedAmount>1048576;)await new Promise(i=>{var s;const o=()=>{var a;(a=this.dataChannel)==null||a.removeEventListener("bufferedamountlow",o),i()};(s=this.dataChannel)==null||s.addEventListener("bufferedamountlow",o),this.dataChannel.bufferedAmountLowThreshold=1048576/2});this.dataChannel.send(n)}catch(r){throw console.error("[WebRTCService] Error sending data:",r),r}}async createOffer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const n=await this.peerConnection.createOffer();return await this.peerConnection.setLocalDescription(n),n}catch(n){throw console.error("Error creating offer:",n),n}}async createAnswer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const n=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(n),n}catch(n){throw console.error("Error creating answer:",n),n}}async handleAnswer(n){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{console.log("[WebRTCService] Received WebRTC answer:",n),console.log("[WebRTCService] Current connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Current signaling state:",this.peerConnection.signalingState),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),console.log("[WebRTCService] Remote description set successfully"),console.log("[WebRTCService] Updated connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Updated signaling state:",this.peerConnection.signalingState),this.pendingCandidates.length>0?(console.log(`[WebRTCService] Adding ${this.pendingCandidates.length} pending ICE candidates`),await Promise.all(this.pendingCandidates.map(async(r,i)=>{console.log(`[WebRTCService] Adding ICE candidate ${i+1}/${this.pendingCandidates.length}`),await this.peerConnection.addIceCandidate(new RTCIceCandidate(r))})),console.log("[WebRTCService] All pending ICE candidates added successfully"),this.pendingCandidates=[]):console.log("[WebRTCService] No pending ICE candidates to add")}catch(r){throw console.error("Error handling answer:",r),r}}async handleIceCandidate(n){if(!this.peerConnection||!this.peerConnection.remoteDescription){console.log("[WebRTCService] Storing ICE candidate until peer connection is ready"),this.pendingCandidates.push(n);return}try{console.log("[WebRTCService] Adding ICE candidate immediately"),await this.peerConnection.addIceCandidate(new RTCIceCandidate(n))}catch(r){throw console.error("Error handling ICE candidate:",r),r}}async reconnect(){this.close(),await this.createPeerConnection(),this.emit("webRTCReconnecting")}cleanup(){this.connectionTimeoutId&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0),this.close()}close(){this.pendingCandidates=[],this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.emit("webRTCClosed")}async waitForConnection(){return new Promise((n,r)=>{if(this.connectionTimeoutId=window.setTimeout(()=>{s(),r(new Error("Connection timeout"))},this.connectionTimeout),this.isDataChannelOpen())return clearTimeout(this.connectionTimeoutId),n();const i=()=>{clearTimeout(this.connectionTimeoutId),s(),n()},o=()=>{var l;((l=this.peerConnection)==null?void 0:l.connectionState)==="failed"&&(clearTimeout(this.connectionTimeoutId),s(),r(new Error("Connection failed")))},s=()=>{this.dataChannel&&this.dataChannel.removeEventListener("open",i),this.peerConnection&&this.peerConnection.removeEventListener("connectionstatechange",o),this.off("dataChannelOpen",i),this.off("webRTCFailed",a)},a=()=>{clearTimeout(this.connectionTimeoutId),s(),r(new Error("Connection failed"))};this.dataChannel&&this.dataChannel.addEventListener("open",i),this.peerConnection&&this.peerConnection.addEventListener("connectionstatechange",o),this.on("dataChannelOpen",i),this.on("webRTCFailed",a)})}isPeerConnectionInitialized(){var n;return console.log("[WebRTCService] Peer connection state:",(n=this.peerConnection)==null?void 0:n.connectionState),this.peerConnection!==null&&this.peerConnection.connectionState!=="closed"}hasRemoteOffer(){return this.remoteOfferReceived}async waitForRemoteOffer(n=3e4){return console.log("[WebRTCService] Waiting for remote offer..."),new Promise((r,i)=>{const o=setTimeout(()=>{a(),console.log("[WebRTCService] Timeout waiting for remote offer"),i(new Error("Timeout waiting for remote offer"))},n),s=()=>{console.log("[WebRTCService] Remote offer received"),clearTimeout(o),a(),r()},a=()=>{this.client.off("remoteOfferReceived",s)};if(this.remoteOfferReceived){console.log("[WebRTCService] Remote offer already received"),clearTimeout(o),r();return}this.client.on("remoteOfferReceived",s)})}async handleOffer(n){console.log("[WebRTCService] Handling WebRTC offer:",n),this.peerConnection||(console.log("[WebRTCService] Creating new peer connection for offer"),await this.createPeerConnection());try{if(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),this.remoteOfferReceived=!0,this.client.emit("remoteOfferReceived"),console.log("[WebRTCService] Remote offer set successfully"),this.pendingCandidates.length>0){console.log(`[WebRTCService] Processing ${this.pendingCandidates.length} pending ICE candidates`);const r=[...this.pendingCandidates];this.pendingCandidates=[];for(const i of r)try{await this.peerConnection.addIceCandidate(new RTCIceCandidate(i)),console.log("[WebRTCService] Successfully added pending ICE candidate")}catch(o){console.warn("[WebRTCService] Failed to add pending ICE candidate:",o)}}}catch(r){throw console.error("[WebRTCService] Error handling offer:",r),r}}}var mR={exports:{}};function x9(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Mg={exports:{}};const I9={},b9=Object.freeze(Object.defineProperty({__proto__:null,default:I9},Symbol.toStringTag,{value:"Module"})),A9=L3(b9);var sA;function it(){return sA||(sA=1,function(t,e){(function(n,r){t.exports=r()})(Ze,function(){var n=n||function(r,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Ze<"u"&&Ze.crypto&&(o=Ze.crypto),!o&&typeof x9=="function")try{o=A9}catch{}var s=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function m(){}return function(y){var x;return m.prototype=y,x=new m,m.prototype=null,x}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(m){var y=a(this);return m&&y.mixIn(m),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var m=this.extend();return m.init.apply(m,arguments),m},init:function(){},mixIn:function(m){for(var y in m)m.hasOwnProperty(y)&&(this[y]=m[y]);m.hasOwnProperty("toString")&&(this.toString=m.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=c.WordArray=u.extend({init:function(m,y){m=this.words=m||[],y!=i?this.sigBytes=y:this.sigBytes=m.length*4},toString:function(m){return(m||h).stringify(this)},concat:function(m){var y=this.words,x=m.words,b=this.sigBytes,E=m.sigBytes;if(this.clamp(),b%4)for(var A=0;A<E;A++){var k=x[A>>>2]>>>24-A%4*8&255;y[b+A>>>2]|=k<<24-(b+A)%4*8}else for(var D=0;D<E;D+=4)y[b+D>>>2]=x[D>>>2];return this.sigBytes+=E,this},clamp:function(){var m=this.words,y=this.sigBytes;m[y>>>2]&=4294967295<<32-y%4*8,m.length=r.ceil(y/4)},clone:function(){var m=u.clone.call(this);return m.words=this.words.slice(0),m},random:function(m){for(var y=[],x=0;x<m;x+=4)y.push(s());return new d.init(y,m)}}),f=l.enc={},h=f.Hex={stringify:function(m){for(var y=m.words,x=m.sigBytes,b=[],E=0;E<x;E++){var A=y[E>>>2]>>>24-E%4*8&255;b.push((A>>>4).toString(16)),b.push((A&15).toString(16))}return b.join("")},parse:function(m){for(var y=m.length,x=[],b=0;b<y;b+=2)x[b>>>3]|=parseInt(m.substr(b,2),16)<<24-b%8*4;return new d.init(x,y/2)}},p=f.Latin1={stringify:function(m){for(var y=m.words,x=m.sigBytes,b=[],E=0;E<x;E++){var A=y[E>>>2]>>>24-E%4*8&255;b.push(String.fromCharCode(A))}return b.join("")},parse:function(m){for(var y=m.length,x=[],b=0;b<y;b++)x[b>>>2]|=(m.charCodeAt(b)&255)<<24-b%4*8;return new d.init(x,y)}},g=f.Utf8={stringify:function(m){try{return decodeURIComponent(escape(p.stringify(m)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(m){return p.parse(unescape(encodeURIComponent(m)))}},C=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(m){typeof m=="string"&&(m=g.parse(m)),this._data.concat(m),this._nDataBytes+=m.sigBytes},_process:function(m){var y,x=this._data,b=x.words,E=x.sigBytes,A=this.blockSize,k=A*4,D=E/k;m?D=r.ceil(D):D=r.max((D|0)-this._minBufferSize,0);var T=D*A,R=r.min(T*4,E);if(T){for(var P=0;P<T;P+=A)this._doProcessBlock(b,P);y=b.splice(0,T),x.sigBytes-=R}return new d.init(y,R)},clone:function(){var m=u.clone.call(this);return m._data=this._data.clone(),m},_minBufferSize:0});c.Hasher=C.extend({cfg:u.extend(),init:function(m){this.cfg=this.cfg.extend(m),this.reset()},reset:function(){C.reset.call(this),this._doReset()},update:function(m){return this._append(m),this._process(),this},finalize:function(m){m&&this._append(m);var y=this._doFinalize();return y},blockSize:16,_createHelper:function(m){return function(y,x){return new m.init(x).finalize(y)}},_createHmacHelper:function(m){return function(y,x){return new v.HMAC.init(m,x).finalize(y)}}});var v=l.algo={};return l}(Math);return n})}(Mg)),Mg.exports}var Lg={exports:{}},aA;function Lp(){return aA||(aA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.Base,a=o.WordArray,l=i.x64={};l.Word=s.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=s.extend({init:function(c,u){c=this.words=c||[],u!=r?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,d=[],f=0;f<u;f++){var h=c[f];d.push(h.high),d.push(h.low)}return a.create(d,this.sigBytes)},clone:function(){for(var c=s.clone.call(this),u=c.words=this.words.slice(0),d=u.length,f=0;f<d;f++)u[f]=u[f].clone();return c}})}(),n})}(Lg)),Lg.exports}var Ug={exports:{}},lA;function w9(){return lA||(lA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){if(typeof ArrayBuffer=="function"){var r=n,i=r.lib,o=i.WordArray,s=o.init,a=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],d=0;d<c;d++)u[d>>>2]|=l[d]<<24-d%4*8;s.call(this,u,c)}else s.apply(this,arguments)};a.prototype=o}}(),n.lib.WordArray})}(Ug)),Ug.exports}var Vg={exports:{}},cA;function S9(){return cA||(cA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Utf16=s.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],f=0;f<u;f+=2){var h=c[f>>>2]>>>16-f%4*8&65535;d.push(String.fromCharCode(h))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=l.charCodeAt(d)<<16-d%2*16;return o.create(u,c*2)}},s.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],f=0;f<u;f+=2){var h=a(c[f>>>2]>>>16-f%4*8&65535);d.push(String.fromCharCode(h))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=a(l.charCodeAt(d)<<16-d%2*16);return o.create(u,c*2)}};function a(l){return l<<8&4278255360|l>>>8&16711935}}(),n.enc.Utf16})}(Vg)),Vg.exports}var Gg={exports:{}},uA;function Vl(){return uA||(uA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,d=this._map;l.clamp();for(var f=[],h=0;h<u;h+=3)for(var p=c[h>>>2]>>>24-h%4*8&255,g=c[h+1>>>2]>>>24-(h+1)%4*8&255,C=c[h+2>>>2]>>>24-(h+2)%4*8&255,v=p<<16|g<<8|C,m=0;m<4&&h+m*.75<u;m++)f.push(d.charAt(v>>>6*(3-m)&63));var y=d.charAt(64);if(y)for(;f.length%4;)f.push(y);return f.join("")},parse:function(l){var c=l.length,u=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var f=0;f<u.length;f++)d[u.charCodeAt(f)]=f}var h=u.charAt(64);if(h){var p=l.indexOf(h);p!==-1&&(c=p)}return a(l,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(l,c,u){for(var d=[],f=0,h=0;h<c;h++)if(h%4){var p=u[l.charCodeAt(h-1)]<<h%4*2,g=u[l.charCodeAt(h)]>>>6-h%4*2,C=p|g;d[f>>>2]|=C<<24-f%4*8,f++}return o.create(d,f)}}(),n.enc.Base64})}(Gg)),Gg.exports}var Wg={exports:{}},dA;function k9(){return dA||(dA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,d=l.sigBytes,f=c?this._safe_map:this._map;l.clamp();for(var h=[],p=0;p<d;p+=3)for(var g=u[p>>>2]>>>24-p%4*8&255,C=u[p+1>>>2]>>>24-(p+1)%4*8&255,v=u[p+2>>>2]>>>24-(p+2)%4*8&255,m=g<<16|C<<8|v,y=0;y<4&&p+y*.75<d;y++)h.push(f.charAt(m>>>6*(3-y)&63));var x=f.charAt(64);if(x)for(;h.length%4;)h.push(x);return h.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,d=c?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<d.length;h++)f[d.charCodeAt(h)]=h}var p=d.charAt(64);if(p){var g=l.indexOf(p);g!==-1&&(u=g)}return a(l,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(l,c,u){for(var d=[],f=0,h=0;h<c;h++)if(h%4){var p=u[l.charCodeAt(h-1)]<<h%4*2,g=u[l.charCodeAt(h)]>>>6-h%4*2,C=p|g;d[f>>>2]|=C<<24-f%4*8,f++}return o.create(d,f)}}(),n.enc.Base64url})}(Wg)),Wg.exports}var jg={exports:{}},fA;function Gl(){return fA||(fA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=[];(function(){for(var g=0;g<64;g++)c[g]=r.abs(r.sin(g+1))*4294967296|0})();var u=l.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,C){for(var v=0;v<16;v++){var m=C+v,y=g[m];g[m]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var x=this._hash.words,b=g[C+0],E=g[C+1],A=g[C+2],k=g[C+3],D=g[C+4],T=g[C+5],R=g[C+6],P=g[C+7],L=g[C+8],G=g[C+9],Z=g[C+10],q=g[C+11],ie=g[C+12],$=g[C+13],Q=g[C+14],ne=g[C+15],O=x[0],j=x[1],J=x[2],ee=x[3];O=d(O,j,J,ee,b,7,c[0]),ee=d(ee,O,j,J,E,12,c[1]),J=d(J,ee,O,j,A,17,c[2]),j=d(j,J,ee,O,k,22,c[3]),O=d(O,j,J,ee,D,7,c[4]),ee=d(ee,O,j,J,T,12,c[5]),J=d(J,ee,O,j,R,17,c[6]),j=d(j,J,ee,O,P,22,c[7]),O=d(O,j,J,ee,L,7,c[8]),ee=d(ee,O,j,J,G,12,c[9]),J=d(J,ee,O,j,Z,17,c[10]),j=d(j,J,ee,O,q,22,c[11]),O=d(O,j,J,ee,ie,7,c[12]),ee=d(ee,O,j,J,$,12,c[13]),J=d(J,ee,O,j,Q,17,c[14]),j=d(j,J,ee,O,ne,22,c[15]),O=f(O,j,J,ee,E,5,c[16]),ee=f(ee,O,j,J,R,9,c[17]),J=f(J,ee,O,j,q,14,c[18]),j=f(j,J,ee,O,b,20,c[19]),O=f(O,j,J,ee,T,5,c[20]),ee=f(ee,O,j,J,Z,9,c[21]),J=f(J,ee,O,j,ne,14,c[22]),j=f(j,J,ee,O,D,20,c[23]),O=f(O,j,J,ee,G,5,c[24]),ee=f(ee,O,j,J,Q,9,c[25]),J=f(J,ee,O,j,k,14,c[26]),j=f(j,J,ee,O,L,20,c[27]),O=f(O,j,J,ee,$,5,c[28]),ee=f(ee,O,j,J,A,9,c[29]),J=f(J,ee,O,j,P,14,c[30]),j=f(j,J,ee,O,ie,20,c[31]),O=h(O,j,J,ee,T,4,c[32]),ee=h(ee,O,j,J,L,11,c[33]),J=h(J,ee,O,j,q,16,c[34]),j=h(j,J,ee,O,Q,23,c[35]),O=h(O,j,J,ee,E,4,c[36]),ee=h(ee,O,j,J,D,11,c[37]),J=h(J,ee,O,j,P,16,c[38]),j=h(j,J,ee,O,Z,23,c[39]),O=h(O,j,J,ee,$,4,c[40]),ee=h(ee,O,j,J,b,11,c[41]),J=h(J,ee,O,j,k,16,c[42]),j=h(j,J,ee,O,R,23,c[43]),O=h(O,j,J,ee,G,4,c[44]),ee=h(ee,O,j,J,ie,11,c[45]),J=h(J,ee,O,j,ne,16,c[46]),j=h(j,J,ee,O,A,23,c[47]),O=p(O,j,J,ee,b,6,c[48]),ee=p(ee,O,j,J,P,10,c[49]),J=p(J,ee,O,j,Q,15,c[50]),j=p(j,J,ee,O,T,21,c[51]),O=p(O,j,J,ee,ie,6,c[52]),ee=p(ee,O,j,J,k,10,c[53]),J=p(J,ee,O,j,Z,15,c[54]),j=p(j,J,ee,O,E,21,c[55]),O=p(O,j,J,ee,L,6,c[56]),ee=p(ee,O,j,J,ne,10,c[57]),J=p(J,ee,O,j,R,15,c[58]),j=p(j,J,ee,O,$,21,c[59]),O=p(O,j,J,ee,D,6,c[60]),ee=p(ee,O,j,J,q,10,c[61]),J=p(J,ee,O,j,A,15,c[62]),j=p(j,J,ee,O,G,21,c[63]),x[0]=x[0]+O|0,x[1]=x[1]+j|0,x[2]=x[2]+J|0,x[3]=x[3]+ee|0},_doFinalize:function(){var g=this._data,C=g.words,v=this._nDataBytes*8,m=g.sigBytes*8;C[m>>>5]|=128<<24-m%32;var y=r.floor(v/4294967296),x=v;C[(m+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,C[(m+64>>>9<<4)+14]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,g.sigBytes=(C.length+1)*4,this._process();for(var b=this._hash,E=b.words,A=0;A<4;A++){var k=E[A];E[A]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return b},clone:function(){var g=a.clone.call(this);return g._hash=this._hash.clone(),g}});function d(g,C,v,m,y,x,b){var E=g+(C&v|~C&m)+y+b;return(E<<x|E>>>32-x)+C}function f(g,C,v,m,y,x,b){var E=g+(C&m|v&~m)+y+b;return(E<<x|E>>>32-x)+C}function h(g,C,v,m,y,x,b){var E=g+(C^v^m)+y+b;return(E<<x|E>>>32-x)+C}function p(g,C,v,m,y,x,b){var E=g+(v^(C|~m))+y+b;return(E<<x|E>>>32-x)+C}i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),n.MD5})}(jg)),jg.exports}var zg={exports:{}},hA;function vR(){return hA||(hA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=i.Hasher,a=r.algo,l=[],c=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,d){for(var f=this._hash.words,h=f[0],p=f[1],g=f[2],C=f[3],v=f[4],m=0;m<80;m++){if(m<16)l[m]=u[d+m]|0;else{var y=l[m-3]^l[m-8]^l[m-14]^l[m-16];l[m]=y<<1|y>>>31}var x=(h<<5|h>>>27)+v+l[m];m<20?x+=(p&g|~p&C)+1518500249:m<40?x+=(p^g^C)+1859775393:m<60?x+=(p&g|p&C|g&C)-1894007588:x+=(p^g^C)-899497514,v=C,C=g,g=p<<30|p>>>2,p=h,h=x}f[0]=f[0]+h|0,f[1]=f[1]+p|0,f[2]=f[2]+g|0,f[3]=f[3]+C|0,f[4]=f[4]+v|0},_doFinalize:function(){var u=this._data,d=u.words,f=this._nDataBytes*8,h=u.sigBytes*8;return d[h>>>5]|=128<<24-h%32,d[(h+64>>>9<<4)+14]=Math.floor(f/4294967296),d[(h+64>>>9<<4)+15]=f,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=s.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=s._createHelper(c),r.HmacSHA1=s._createHmacHelper(c)}(),n.SHA1})}(zg)),zg.exports}var Hg={exports:{}},pA;function W1(){return pA||(pA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=[],u=[];(function(){function h(v){for(var m=r.sqrt(v),y=2;y<=m;y++)if(!(v%y))return!1;return!0}function p(v){return(v-(v|0))*4294967296|0}for(var g=2,C=0;C<64;)h(g)&&(C<8&&(c[C]=p(r.pow(g,1/2))),u[C]=p(r.pow(g,1/3)),C++),g++})();var d=[],f=l.SHA256=a.extend({_doReset:function(){this._hash=new s.init(c.slice(0))},_doProcessBlock:function(h,p){for(var g=this._hash.words,C=g[0],v=g[1],m=g[2],y=g[3],x=g[4],b=g[5],E=g[6],A=g[7],k=0;k<64;k++){if(k<16)d[k]=h[p+k]|0;else{var D=d[k-15],T=(D<<25|D>>>7)^(D<<14|D>>>18)^D>>>3,R=d[k-2],P=(R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10;d[k]=T+d[k-7]+P+d[k-16]}var L=x&b^~x&E,G=C&v^C&m^v&m,Z=(C<<30|C>>>2)^(C<<19|C>>>13)^(C<<10|C>>>22),q=(x<<26|x>>>6)^(x<<21|x>>>11)^(x<<7|x>>>25),ie=A+q+L+u[k]+d[k],$=Z+G;A=E,E=b,b=x,x=y+ie|0,y=m,m=v,v=C,C=ie+$|0}g[0]=g[0]+C|0,g[1]=g[1]+v|0,g[2]=g[2]+m|0,g[3]=g[3]+y|0,g[4]=g[4]+x|0,g[5]=g[5]+b|0,g[6]=g[6]+E|0,g[7]=g[7]+A|0},_doFinalize:function(){var h=this._data,p=h.words,g=this._nDataBytes*8,C=h.sigBytes*8;return p[C>>>5]|=128<<24-C%32,p[(C+64>>>9<<4)+14]=r.floor(g/4294967296),p[(C+64>>>9<<4)+15]=g,h.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var h=a.clone.call(this);return h._hash=this._hash.clone(),h}});i.SHA256=a._createHelper(f),i.HmacSHA256=a._createHmacHelper(f)}(Math),n.SHA256})}(Hg)),Hg.exports}var Zg={exports:{}},gA;function E9(){return gA||(gA=1,function(t,e){(function(n,r,i){t.exports=r(it(),W1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.algo,a=s.SHA256,l=s.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=a._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=a._createHelper(l),r.HmacSHA224=a._createHmacHelper(l)}(),n.SHA224})}(Zg)),Zg.exports}var $g={exports:{}},mA;function CR(){return mA||(mA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Lp())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Hasher,s=r.x64,a=s.Word,l=s.WordArray,c=r.algo;function u(){return a.create.apply(a,arguments)}var d=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],f=[];(function(){for(var p=0;p<80;p++)f[p]=u()})();var h=c.SHA512=o.extend({_doReset:function(){this._hash=new l.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(p,g){for(var C=this._hash.words,v=C[0],m=C[1],y=C[2],x=C[3],b=C[4],E=C[5],A=C[6],k=C[7],D=v.high,T=v.low,R=m.high,P=m.low,L=y.high,G=y.low,Z=x.high,q=x.low,ie=b.high,$=b.low,Q=E.high,ne=E.low,O=A.high,j=A.low,J=k.high,ee=k.low,se=D,me=T,Be=R,ae=P,Pt=L,Gt=G,fn=Z,ze=q,at=ie,ot=$,he=Q,Ce=ne,Ue=O,Le=j,Pe=J,$e=ee,st=0;st<80;st++){var Qe,Wt,jt=f[st];if(st<16)Wt=jt.high=p[g+st*2]|0,Qe=jt.low=p[g+st*2+1]|0;else{var wt=f[st-15],sn=wt.high,_=wt.low,I=(sn>>>1|_<<31)^(sn>>>8|_<<24)^sn>>>7,w=(_>>>1|sn<<31)^(_>>>8|sn<<24)^(_>>>7|sn<<25),B=f[st-2],W=B.high,Y=B.low,te=(W>>>19|Y<<13)^(W<<3|Y>>>29)^W>>>6,Ne=(Y>>>19|W<<13)^(Y<<3|W>>>29)^(Y>>>6|W<<26),tt=f[st-7],lt=tt.high,ht=tt.low,nt=f[st-16],bi=nt.high,io=nt.low;Qe=w+ht,Wt=I+lt+(Qe>>>0<w>>>0?1:0),Qe=Qe+Ne,Wt=Wt+te+(Qe>>>0<Ne>>>0?1:0),Qe=Qe+io,Wt=Wt+bi+(Qe>>>0<io>>>0?1:0),jt.high=Wt,jt.low=Qe}var $a=at&he^~at&Ue,ii=ot&Ce^~ot&Le,Iu=se&Be^se&Pt^Be&Pt,zl=me&ae^me&Gt^ae&Gt,Jt=(se>>>28|me<<4)^(se<<30|me>>>2)^(se<<25|me>>>7),oi=(me>>>28|se<<4)^(me<<30|se>>>2)^(me<<25|se>>>7),$s=(at>>>14|ot<<18)^(at>>>18|ot<<14)^(at<<23|ot>>>9),$o=(ot>>>14|at<<18)^(ot>>>18|at<<14)^(ot<<23|at>>>9),Xs=d[st],Hl=Xs.high,V=Xs.low,H=$e+$o,K=Pe+$s+(H>>>0<$e>>>0?1:0),H=H+ii,K=K+$a+(H>>>0<ii>>>0?1:0),H=H+V,K=K+Hl+(H>>>0<V>>>0?1:0),H=H+Qe,K=K+Wt+(H>>>0<Qe>>>0?1:0),ce=oi+zl,ge=Jt+Iu+(ce>>>0<oi>>>0?1:0);Pe=Ue,$e=Le,Ue=he,Le=Ce,he=at,Ce=ot,ot=ze+H|0,at=fn+K+(ot>>>0<ze>>>0?1:0)|0,fn=Pt,ze=Gt,Pt=Be,Gt=ae,Be=se,ae=me,me=H+ce|0,se=K+ge+(me>>>0<H>>>0?1:0)|0}T=v.low=T+me,v.high=D+se+(T>>>0<me>>>0?1:0),P=m.low=P+ae,m.high=R+Be+(P>>>0<ae>>>0?1:0),G=y.low=G+Gt,y.high=L+Pt+(G>>>0<Gt>>>0?1:0),q=x.low=q+ze,x.high=Z+fn+(q>>>0<ze>>>0?1:0),$=b.low=$+ot,b.high=ie+at+($>>>0<ot>>>0?1:0),ne=E.low=ne+Ce,E.high=Q+he+(ne>>>0<Ce>>>0?1:0),j=A.low=j+Le,A.high=O+Ue+(j>>>0<Le>>>0?1:0),ee=k.low=ee+$e,k.high=J+Pe+(ee>>>0<$e>>>0?1:0)},_doFinalize:function(){var p=this._data,g=p.words,C=this._nDataBytes*8,v=p.sigBytes*8;g[v>>>5]|=128<<24-v%32,g[(v+128>>>10<<5)+30]=Math.floor(C/4294967296),g[(v+128>>>10<<5)+31]=C,p.sigBytes=g.length*4,this._process();var m=this._hash.toX32();return m},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});r.SHA512=o._createHelper(h),r.HmacSHA512=o._createHmacHelper(h)}(),n.SHA512})}($g)),$g.exports}var Xg={exports:{}},vA;function T9(){return vA||(vA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Lp(),CR())})(Ze,function(n){return function(){var r=n,i=r.x64,o=i.Word,s=i.WordArray,a=r.algo,l=a.SHA512,c=a.SHA384=l.extend({_doReset:function(){this._hash=new s.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=l._createHelper(c),r.HmacSHA384=l._createHmacHelper(c)}(),n.SHA384})}(Xg)),Xg.exports}var Kg={exports:{}},CA;function R9(){return CA||(CA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Lp())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.x64,c=l.Word,u=i.algo,d=[],f=[],h=[];(function(){for(var C=1,v=0,m=0;m<24;m++){d[C+5*v]=(m+1)*(m+2)/2%64;var y=v%5,x=(2*C+3*v)%5;C=y,v=x}for(var C=0;C<5;C++)for(var v=0;v<5;v++)f[C+5*v]=v+(2*C+3*v)%5*5;for(var b=1,E=0;E<24;E++){for(var A=0,k=0,D=0;D<7;D++){if(b&1){var T=(1<<D)-1;T<32?k^=1<<T:A^=1<<T-32}b&128?b=b<<1^113:b<<=1}h[E]=c.create(A,k)}})();var p=[];(function(){for(var C=0;C<25;C++)p[C]=c.create()})();var g=u.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var C=this._state=[],v=0;v<25;v++)C[v]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(C,v){for(var m=this._state,y=this.blockSize/2,x=0;x<y;x++){var b=C[v+2*x],E=C[v+2*x+1];b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var A=m[x];A.high^=E,A.low^=b}for(var k=0;k<24;k++){for(var D=0;D<5;D++){for(var T=0,R=0,P=0;P<5;P++){var A=m[D+5*P];T^=A.high,R^=A.low}var L=p[D];L.high=T,L.low=R}for(var D=0;D<5;D++)for(var G=p[(D+4)%5],Z=p[(D+1)%5],q=Z.high,ie=Z.low,T=G.high^(q<<1|ie>>>31),R=G.low^(ie<<1|q>>>31),P=0;P<5;P++){var A=m[D+5*P];A.high^=T,A.low^=R}for(var $=1;$<25;$++){var T,R,A=m[$],Q=A.high,ne=A.low,O=d[$];O<32?(T=Q<<O|ne>>>32-O,R=ne<<O|Q>>>32-O):(T=ne<<O-32|Q>>>64-O,R=Q<<O-32|ne>>>64-O);var j=p[f[$]];j.high=T,j.low=R}var J=p[0],ee=m[0];J.high=ee.high,J.low=ee.low;for(var D=0;D<5;D++)for(var P=0;P<5;P++){var $=D+5*P,A=m[$],se=p[$],me=p[(D+1)%5+5*P],Be=p[(D+2)%5+5*P];A.high=se.high^~me.high&Be.high,A.low=se.low^~me.low&Be.low}var A=m[0],ae=h[k];A.high^=ae.high,A.low^=ae.low}},_doFinalize:function(){var C=this._data,v=C.words;this._nDataBytes*8;var m=C.sigBytes*8,y=this.blockSize*32;v[m>>>5]|=1<<24-m%32,v[(r.ceil((m+1)/y)*y>>>5)-1]|=128,C.sigBytes=v.length*4,this._process();for(var x=this._state,b=this.cfg.outputLength/8,E=b/8,A=[],k=0;k<E;k++){var D=x[k],T=D.high,R=D.low;T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,A.push(R),A.push(T)}return new s.init(A,b)},clone:function(){for(var C=a.clone.call(this),v=C._state=this._state.slice(0),m=0;m<25;m++)v[m]=v[m].clone();return C}});i.SHA3=a._createHelper(g),i.HmacSHA3=a._createHmacHelper(g)}(Math),n.SHA3})}(Kg)),Kg.exports}var Jg={exports:{}},yA;function _9(){return yA||(yA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=s.create([0,1518500249,1859775393,2400959708,2840853838]),p=s.create([1352829926,1548603684,1836072691,2053994217,0]),g=l.RIPEMD160=a.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,A){for(var k=0;k<16;k++){var D=A+k,T=E[D];E[D]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var R=this._hash.words,P=h.words,L=p.words,G=c.words,Z=u.words,q=d.words,ie=f.words,$,Q,ne,O,j,J,ee,se,me,Be;J=$=R[0],ee=Q=R[1],se=ne=R[2],me=O=R[3],Be=j=R[4];for(var ae,k=0;k<80;k+=1)ae=$+E[A+G[k]]|0,k<16?ae+=C(Q,ne,O)+P[0]:k<32?ae+=v(Q,ne,O)+P[1]:k<48?ae+=m(Q,ne,O)+P[2]:k<64?ae+=y(Q,ne,O)+P[3]:ae+=x(Q,ne,O)+P[4],ae=ae|0,ae=b(ae,q[k]),ae=ae+j|0,$=j,j=O,O=b(ne,10),ne=Q,Q=ae,ae=J+E[A+Z[k]]|0,k<16?ae+=x(ee,se,me)+L[0]:k<32?ae+=y(ee,se,me)+L[1]:k<48?ae+=m(ee,se,me)+L[2]:k<64?ae+=v(ee,se,me)+L[3]:ae+=C(ee,se,me)+L[4],ae=ae|0,ae=b(ae,ie[k]),ae=ae+Be|0,J=Be,Be=me,me=b(se,10),se=ee,ee=ae;ae=R[1]+ne+me|0,R[1]=R[2]+O+Be|0,R[2]=R[3]+j+J|0,R[3]=R[4]+$+ee|0,R[4]=R[0]+Q+se|0,R[0]=ae},_doFinalize:function(){var E=this._data,A=E.words,k=this._nDataBytes*8,D=E.sigBytes*8;A[D>>>5]|=128<<24-D%32,A[(D+64>>>9<<4)+14]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,E.sigBytes=(A.length+1)*4,this._process();for(var T=this._hash,R=T.words,P=0;P<5;P++){var L=R[P];R[P]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}return T},clone:function(){var E=a.clone.call(this);return E._hash=this._hash.clone(),E}});function C(E,A,k){return E^A^k}function v(E,A,k){return E&A|~E&k}function m(E,A,k){return(E|~A)^k}function y(E,A,k){return E&k|A&~k}function x(E,A,k){return E^(A|~k)}function b(E,A){return E<<A|E>>>32-A}i.RIPEMD160=a._createHelper(g),i.HmacRIPEMD160=a._createHmacHelper(g)}(),n.RIPEMD160})}(Jg)),Jg.exports}var Yg={exports:{}},xA;function j1(){return xA||(xA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){(function(){var r=n,i=r.lib,o=i.Base,s=r.enc,a=s.Utf8,l=r.algo;l.HMAC=o.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=a.parse(u));var d=c.blockSize,f=d*4;u.sigBytes>f&&(u=c.finalize(u)),u.clamp();for(var h=this._oKey=u.clone(),p=this._iKey=u.clone(),g=h.words,C=p.words,v=0;v<d;v++)g[v]^=1549556828,C[v]^=909522486;h.sigBytes=p.sigBytes=f,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,d=u.finalize(c);u.reset();var f=u.finalize(this._oKey.clone().concat(d));return f}})})()})}(Yg)),Yg.exports}var qg={exports:{}},IA;function D9(){return IA||(IA=1,function(t,e){(function(n,r,i){t.exports=r(it(),W1(),j1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Base,s=i.WordArray,a=r.algo,l=a.SHA256,c=a.HMAC,u=a.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,f){for(var h=this.cfg,p=c.create(h.hasher,d),g=s.create(),C=s.create([1]),v=g.words,m=C.words,y=h.keySize,x=h.iterations;v.length<y;){var b=p.update(f).finalize(C);p.reset();for(var E=b.words,A=E.length,k=b,D=1;D<x;D++){k=p.finalize(k),p.reset();for(var T=k.words,R=0;R<A;R++)E[R]^=T[R]}g.concat(b),m[0]++}return g.sigBytes=y*4,g}});r.PBKDF2=function(d,f,h){return u.create(h).compute(d,f)}}(),n.PBKDF2})}(qg)),qg.exports}var Qg={exports:{}},bA;function Ha(){return bA||(bA=1,function(t,e){(function(n,r,i){t.exports=r(it(),vR(),j1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Base,s=i.WordArray,a=r.algo,l=a.MD5,c=a.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,d){for(var f,h=this.cfg,p=h.hasher.create(),g=s.create(),C=g.words,v=h.keySize,m=h.iterations;C.length<v;){f&&p.update(f),f=p.update(u).finalize(d),p.reset();for(var y=1;y<m;y++)f=p.finalize(f),p.reset();g.concat(f)}return g.sigBytes=v*4,g}});r.EvpKDF=function(u,d,f){return c.create(f).compute(u,d)}}(),n.EvpKDF})}(Qg)),Qg.exports}var em={exports:{}},AA;function Rn(){return AA||(AA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Ha())})(Ze,function(n){n.lib.Cipher||function(r){var i=n,o=i.lib,s=o.Base,a=o.WordArray,l=o.BufferedBlockAlgorithm,c=i.enc;c.Utf8;var u=c.Base64,d=i.algo,f=d.EvpKDF,h=o.Cipher=l.extend({cfg:s.extend(),createEncryptor:function(T,R){return this.create(this._ENC_XFORM_MODE,T,R)},createDecryptor:function(T,R){return this.create(this._DEC_XFORM_MODE,T,R)},init:function(T,R,P){this.cfg=this.cfg.extend(P),this._xformMode=T,this._key=R,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(T){return this._append(T),this._process()},finalize:function(T){T&&this._append(T);var R=this._doFinalize();return R},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function T(R){return typeof R=="string"?D:E}return function(R){return{encrypt:function(P,L,G){return T(L).encrypt(R,P,L,G)},decrypt:function(P,L,G){return T(L).decrypt(R,P,L,G)}}}}()});o.StreamCipher=h.extend({_doFinalize:function(){var T=this._process(!0);return T},blockSize:1});var p=i.mode={},g=o.BlockCipherMode=s.extend({createEncryptor:function(T,R){return this.Encryptor.create(T,R)},createDecryptor:function(T,R){return this.Decryptor.create(T,R)},init:function(T,R){this._cipher=T,this._iv=R}}),C=p.CBC=function(){var T=g.extend();T.Encryptor=T.extend({processBlock:function(P,L){var G=this._cipher,Z=G.blockSize;R.call(this,P,L,Z),G.encryptBlock(P,L),this._prevBlock=P.slice(L,L+Z)}}),T.Decryptor=T.extend({processBlock:function(P,L){var G=this._cipher,Z=G.blockSize,q=P.slice(L,L+Z);G.decryptBlock(P,L),R.call(this,P,L,Z),this._prevBlock=q}});function R(P,L,G){var Z,q=this._iv;q?(Z=q,this._iv=r):Z=this._prevBlock;for(var ie=0;ie<G;ie++)P[L+ie]^=Z[ie]}return T}(),v=i.pad={},m=v.Pkcs7={pad:function(T,R){for(var P=R*4,L=P-T.sigBytes%P,G=L<<24|L<<16|L<<8|L,Z=[],q=0;q<L;q+=4)Z.push(G);var ie=a.create(Z,L);T.concat(ie)},unpad:function(T){var R=T.words[T.sigBytes-1>>>2]&255;T.sigBytes-=R}};o.BlockCipher=h.extend({cfg:h.cfg.extend({mode:C,padding:m}),reset:function(){var T;h.reset.call(this);var R=this.cfg,P=R.iv,L=R.mode;this._xformMode==this._ENC_XFORM_MODE?T=L.createEncryptor:(T=L.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==T?this._mode.init(this,P&&P.words):(this._mode=T.call(L,this,P&&P.words),this._mode.__creator=T)},_doProcessBlock:function(T,R){this._mode.processBlock(T,R)},_doFinalize:function(){var T,R=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(R.pad(this._data,this.blockSize),T=this._process(!0)):(T=this._process(!0),R.unpad(T)),T},blockSize:128/32});var y=o.CipherParams=s.extend({init:function(T){this.mixIn(T)},toString:function(T){return(T||this.formatter).stringify(this)}}),x=i.format={},b=x.OpenSSL={stringify:function(T){var R,P=T.ciphertext,L=T.salt;return L?R=a.create([1398893684,1701076831]).concat(L).concat(P):R=P,R.toString(u)},parse:function(T){var R,P=u.parse(T),L=P.words;return L[0]==1398893684&&L[1]==1701076831&&(R=a.create(L.slice(2,4)),L.splice(0,4),P.sigBytes-=16),y.create({ciphertext:P,salt:R})}},E=o.SerializableCipher=s.extend({cfg:s.extend({format:b}),encrypt:function(T,R,P,L){L=this.cfg.extend(L);var G=T.createEncryptor(P,L),Z=G.finalize(R),q=G.cfg;return y.create({ciphertext:Z,key:P,iv:q.iv,algorithm:T,mode:q.mode,padding:q.padding,blockSize:T.blockSize,formatter:L.format})},decrypt:function(T,R,P,L){L=this.cfg.extend(L),R=this._parse(R,L.format);var G=T.createDecryptor(P,L).finalize(R.ciphertext);return G},_parse:function(T,R){return typeof T=="string"?R.parse(T,this):T}}),A=i.kdf={},k=A.OpenSSL={execute:function(T,R,P,L,G){if(L||(L=a.random(64/8)),G)var Z=f.create({keySize:R+P,hasher:G}).compute(T,L);else var Z=f.create({keySize:R+P}).compute(T,L);var q=a.create(Z.words.slice(R),P*4);return Z.sigBytes=R*4,y.create({key:Z,iv:q,salt:L})}},D=o.PasswordBasedCipher=E.extend({cfg:E.cfg.extend({kdf:k}),encrypt:function(T,R,P,L){L=this.cfg.extend(L);var G=L.kdf.execute(P,T.keySize,T.ivSize,L.salt,L.hasher);L.iv=G.iv;var Z=E.encrypt.call(this,T,R,G.key,L);return Z.mixIn(G),Z},decrypt:function(T,R,P,L){L=this.cfg.extend(L),R=this._parse(R,L.format);var G=L.kdf.execute(P,T.keySize,T.ivSize,R.salt,L.hasher);L.iv=G.iv;var Z=E.decrypt.call(this,T,R,G.key,L);return Z}})}()})}(em)),em.exports}var tm={exports:{}},wA;function P9(){return wA||(wA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.mode.CFB=function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize;i.call(this,o,s,l,a),this._prevBlock=o.slice(s,s+l)}}),r.Decryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=o.slice(s,s+l);i.call(this,o,s,l,a),this._prevBlock=c}});function i(o,s,a,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var d=0;d<a;d++)o[s+d]^=c[d]}return r}(),n.mode.CFB})}(tm)),tm.exports}var nm={exports:{}},SA;function N9(){return SA||(SA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.mode.CTR=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var d=u.slice(0);a.encryptBlock(d,0),u[l-1]=u[l-1]+1|0;for(var f=0;f<l;f++)o[s+f]^=d[f]}});return r.Decryptor=i,r}(),n.mode.CTR})}(nm)),nm.exports}var rm={exports:{}},kA;function B9(){return kA||(kA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var r=n.lib.BlockCipherMode.extend();function i(a){if((a>>24&255)===255){var l=a>>16&255,c=a>>8&255,u=a&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,a=0,a+=l<<16,a+=c<<8,a+=u}else a+=1<<24;return a}function o(a){return(a[0]=i(a[0]))===0&&(a[1]=i(a[1])),a}var s=r.Encryptor=r.extend({processBlock:function(a,l){var c=this._cipher,u=c.blockSize,d=this._iv,f=this._counter;d&&(f=this._counter=d.slice(0),this._iv=void 0),o(f);var h=f.slice(0);c.encryptBlock(h,0);for(var p=0;p<u;p++)a[l+p]^=h[p]}});return r.Decryptor=s,r}(),n.mode.CTRGladman})}(rm)),rm.exports}var im={exports:{}},EA;function O9(){return EA||(EA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.mode.OFB=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),a.encryptBlock(u,0);for(var d=0;d<l;d++)o[s+d]^=u[d]}});return r.Decryptor=i,r}(),n.mode.OFB})}(im)),im.exports}var om={exports:{}},TA;function F9(){return TA||(TA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.mode.ECB=function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),r.Decryptor=r.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),r}(),n.mode.ECB})}(om)),om.exports}var sm={exports:{}},RA;function M9(){return RA||(RA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.pad.AnsiX923={pad:function(r,i){var o=r.sigBytes,s=i*4,a=s-o%s,l=o+a-1;r.clamp(),r.words[l>>>2]|=a<<24-l%4*8,r.sigBytes+=a},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Ansix923})}(sm)),sm.exports}var am={exports:{}},_A;function L9(){return _A||(_A=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.pad.Iso10126={pad:function(r,i){var o=i*4,s=o-r.sigBytes%o;r.concat(n.lib.WordArray.random(s-1)).concat(n.lib.WordArray.create([s<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Iso10126})}(am)),am.exports}var lm={exports:{}},DA;function U9(){return DA||(DA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.pad.Iso97971={pad:function(r,i){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,i)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})}(lm)),lm.exports}var cm={exports:{}},PA;function V9(){return PA||(PA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.pad.ZeroPadding={pad:function(r,i){var o=i*4;r.clamp(),r.sigBytes+=o-(r.sigBytes%o||o)},unpad:function(r){for(var i=r.words,o=r.sigBytes-1,o=r.sigBytes-1;o>=0;o--)if(i[o>>>2]>>>24-o%4*8&255){r.sigBytes=o+1;break}}},n.pad.ZeroPadding})}(cm)),cm.exports}var um={exports:{}},NA;function G9(){return NA||(NA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(um)),um.exports}var dm={exports:{}},BA;function W9(){return BA||(BA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Rn())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.CipherParams,a=i.enc,l=a.Hex,c=i.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var d=l.parse(u);return s.create({ciphertext:d})}}}(),n.format.Hex})}(dm)),dm.exports}var fm={exports:{}},OA;function j9(){return OA||(OA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Vl(),Gl(),Ha(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.BlockCipher,s=r.algo,a=[],l=[],c=[],u=[],d=[],f=[],h=[],p=[],g=[],C=[];(function(){for(var y=[],x=0;x<256;x++)x<128?y[x]=x<<1:y[x]=x<<1^283;for(var b=0,E=0,x=0;x<256;x++){var A=E^E<<1^E<<2^E<<3^E<<4;A=A>>>8^A&255^99,a[b]=A,l[A]=b;var k=y[b],D=y[k],T=y[D],R=y[A]*257^A*16843008;c[b]=R<<24|R>>>8,u[b]=R<<16|R>>>16,d[b]=R<<8|R>>>24,f[b]=R;var R=T*16843009^D*65537^k*257^b*16843008;h[A]=R<<24|R>>>8,p[A]=R<<16|R>>>16,g[A]=R<<8|R>>>24,C[A]=R,b?(b=k^y[y[y[T^k]]],E^=y[y[E]]):b=E=1}})();var v=[0,1,2,4,8,16,32,64,128,27,54],m=s.AES=o.extend({_doReset:function(){var y;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var x=this._keyPriorReset=this._key,b=x.words,E=x.sigBytes/4,A=this._nRounds=E+6,k=(A+1)*4,D=this._keySchedule=[],T=0;T<k;T++)T<E?D[T]=b[T]:(y=D[T-1],T%E?E>6&&T%E==4&&(y=a[y>>>24]<<24|a[y>>>16&255]<<16|a[y>>>8&255]<<8|a[y&255]):(y=y<<8|y>>>24,y=a[y>>>24]<<24|a[y>>>16&255]<<16|a[y>>>8&255]<<8|a[y&255],y^=v[T/E|0]<<24),D[T]=D[T-E]^y);for(var R=this._invKeySchedule=[],P=0;P<k;P++){var T=k-P;if(P%4)var y=D[T];else var y=D[T-4];P<4||T<=4?R[P]=y:R[P]=h[a[y>>>24]]^p[a[y>>>16&255]]^g[a[y>>>8&255]]^C[a[y&255]]}}},encryptBlock:function(y,x){this._doCryptBlock(y,x,this._keySchedule,c,u,d,f,a)},decryptBlock:function(y,x){var b=y[x+1];y[x+1]=y[x+3],y[x+3]=b,this._doCryptBlock(y,x,this._invKeySchedule,h,p,g,C,l);var b=y[x+1];y[x+1]=y[x+3],y[x+3]=b},_doCryptBlock:function(y,x,b,E,A,k,D,T){for(var R=this._nRounds,P=y[x]^b[0],L=y[x+1]^b[1],G=y[x+2]^b[2],Z=y[x+3]^b[3],q=4,ie=1;ie<R;ie++){var $=E[P>>>24]^A[L>>>16&255]^k[G>>>8&255]^D[Z&255]^b[q++],Q=E[L>>>24]^A[G>>>16&255]^k[Z>>>8&255]^D[P&255]^b[q++],ne=E[G>>>24]^A[Z>>>16&255]^k[P>>>8&255]^D[L&255]^b[q++],O=E[Z>>>24]^A[P>>>16&255]^k[L>>>8&255]^D[G&255]^b[q++];P=$,L=Q,G=ne,Z=O}var $=(T[P>>>24]<<24|T[L>>>16&255]<<16|T[G>>>8&255]<<8|T[Z&255])^b[q++],Q=(T[L>>>24]<<24|T[G>>>16&255]<<16|T[Z>>>8&255]<<8|T[P&255])^b[q++],ne=(T[G>>>24]<<24|T[Z>>>16&255]<<16|T[P>>>8&255]<<8|T[L&255])^b[q++],O=(T[Z>>>24]<<24|T[P>>>16&255]<<16|T[L>>>8&255]<<8|T[G&255])^b[q++];y[x]=$,y[x+1]=Q,y[x+2]=ne,y[x+3]=O},keySize:256/32});r.AES=o._createHelper(m)}(),n.AES})}(fm)),fm.exports}var hm={exports:{}},FA;function z9(){return FA||(FA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Vl(),Gl(),Ha(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=i.BlockCipher,a=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=a.DES=s.extend({_doReset:function(){for(var v=this._key,m=v.words,y=[],x=0;x<56;x++){var b=l[x]-1;y[x]=m[b>>>5]>>>31-b%32&1}for(var E=this._subKeys=[],A=0;A<16;A++){for(var k=E[A]=[],D=u[A],x=0;x<24;x++)k[x/6|0]|=y[(c[x]-1+D)%28]<<31-x%6,k[4+(x/6|0)]|=y[28+(c[x+24]-1+D)%28]<<31-x%6;k[0]=k[0]<<1|k[0]>>>31;for(var x=1;x<7;x++)k[x]=k[x]>>>(x-1)*4+3;k[7]=k[7]<<5|k[7]>>>27}for(var T=this._invSubKeys=[],x=0;x<16;x++)T[x]=E[15-x]},encryptBlock:function(v,m){this._doCryptBlock(v,m,this._subKeys)},decryptBlock:function(v,m){this._doCryptBlock(v,m,this._invSubKeys)},_doCryptBlock:function(v,m,y){this._lBlock=v[m],this._rBlock=v[m+1],p.call(this,4,252645135),p.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),p.call(this,1,1431655765);for(var x=0;x<16;x++){for(var b=y[x],E=this._lBlock,A=this._rBlock,k=0,D=0;D<8;D++)k|=d[D][((A^b[D])&f[D])>>>0];this._lBlock=A,this._rBlock=E^k}var T=this._lBlock;this._lBlock=this._rBlock,this._rBlock=T,p.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),v[m]=this._lBlock,v[m+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(v,m){var y=(this._lBlock>>>v^this._rBlock)&m;this._rBlock^=y,this._lBlock^=y<<v}function g(v,m){var y=(this._rBlock>>>v^this._lBlock)&m;this._lBlock^=y,this._rBlock^=y<<v}r.DES=s._createHelper(h);var C=a.TripleDES=s.extend({_doReset:function(){var v=this._key,m=v.words;if(m.length!==2&&m.length!==4&&m.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var y=m.slice(0,2),x=m.length<4?m.slice(0,2):m.slice(2,4),b=m.length<6?m.slice(0,2):m.slice(4,6);this._des1=h.createEncryptor(o.create(y)),this._des2=h.createEncryptor(o.create(x)),this._des3=h.createEncryptor(o.create(b))},encryptBlock:function(v,m){this._des1.encryptBlock(v,m),this._des2.decryptBlock(v,m),this._des3.encryptBlock(v,m)},decryptBlock:function(v,m){this._des3.decryptBlock(v,m),this._des2.encryptBlock(v,m),this._des1.decryptBlock(v,m)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=s._createHelper(C)}(),n.TripleDES})}(hm)),hm.exports}var pm={exports:{}},MA;function H9(){return MA||(MA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Vl(),Gl(),Ha(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=s.RC4=o.extend({_doReset:function(){for(var u=this._key,d=u.words,f=u.sigBytes,h=this._S=[],p=0;p<256;p++)h[p]=p;for(var p=0,g=0;p<256;p++){var C=p%f,v=d[C>>>2]>>>24-C%4*8&255;g=(g+h[p]+v)%256;var m=h[p];h[p]=h[g],h[g]=m}this._i=this._j=0},_doProcessBlock:function(u,d){u[d]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,d=this._i,f=this._j,h=0,p=0;p<4;p++){d=(d+1)%256,f=(f+u[d])%256;var g=u[d];u[d]=u[f],u[f]=g,h|=u[(u[d]+u[f])%256]<<24-p*8}return this._i=d,this._j=f,h}r.RC4=o._createHelper(a);var c=s.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});r.RC4Drop=o._createHelper(c)}(),n.RC4})}(pm)),pm.exports}var gm={exports:{}},LA;function Z9(){return LA||(LA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Vl(),Gl(),Ha(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=[],l=[],c=[],u=s.Rabbit=o.extend({_doReset:function(){for(var f=this._key.words,h=this.cfg.iv,p=0;p<4;p++)f[p]=(f[p]<<8|f[p]>>>24)&16711935|(f[p]<<24|f[p]>>>8)&4278255360;var g=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],C=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var p=0;p<4;p++)d.call(this);for(var p=0;p<8;p++)C[p]^=g[p+4&7];if(h){var v=h.words,m=v[0],y=v[1],x=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=x>>>16|b&4294901760,A=b<<16|x&65535;C[0]^=x,C[1]^=E,C[2]^=b,C[3]^=A,C[4]^=x,C[5]^=E,C[6]^=b,C[7]^=A;for(var p=0;p<4;p++)d.call(this)}},_doProcessBlock:function(f,h){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,f[h+g]^=a[g]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var g=f[p]+h[p],C=g&65535,v=g>>>16,m=((C*C>>>17)+C*v>>>15)+v*v,y=((g&4294901760)*g|0)+((g&65535)*g|0);c[p]=m^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=o._createHelper(u)}(),n.Rabbit})}(gm)),gm.exports}var mm={exports:{}},UA;function $9(){return UA||(UA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Vl(),Gl(),Ha(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=[],l=[],c=[],u=s.RabbitLegacy=o.extend({_doReset:function(){var f=this._key.words,h=this.cfg.iv,p=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],g=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var C=0;C<4;C++)d.call(this);for(var C=0;C<8;C++)g[C]^=p[C+4&7];if(h){var v=h.words,m=v[0],y=v[1],x=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=x>>>16|b&4294901760,A=b<<16|x&65535;g[0]^=x,g[1]^=E,g[2]^=b,g[3]^=A,g[4]^=x,g[5]^=E,g[6]^=b,g[7]^=A;for(var C=0;C<4;C++)d.call(this)}},_doProcessBlock:function(f,h){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,f[h+g]^=a[g]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var g=f[p]+h[p],C=g&65535,v=g>>>16,m=((C*C>>>17)+C*v>>>15)+v*v,y=((g&4294901760)*g|0)+((g&65535)*g|0);c[p]=m^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=o._createHelper(u)}(),n.RabbitLegacy})}(mm)),mm.exports}var vm={exports:{}},VA;function X9(){return VA||(VA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Vl(),Gl(),Ha(),Rn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.BlockCipher,s=r.algo;const a=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function d(C,v){let m=v>>24&255,y=v>>16&255,x=v>>8&255,b=v&255,E=C.sbox[0][m]+C.sbox[1][y];return E=E^C.sbox[2][x],E=E+C.sbox[3][b],E}function f(C,v,m){let y=v,x=m,b;for(let E=0;E<a;++E)y=y^C.pbox[E],x=d(C,y)^x,b=y,y=x,x=b;return b=y,y=x,x=b,x=x^C.pbox[a],y=y^C.pbox[a+1],{left:y,right:x}}function h(C,v,m){let y=v,x=m,b;for(let E=a+1;E>1;--E)y=y^C.pbox[E],x=d(C,y)^x,b=y,y=x,x=b;return b=y,y=x,x=b,x=x^C.pbox[1],y=y^C.pbox[0],{left:y,right:x}}function p(C,v,m){for(let A=0;A<4;A++){C.sbox[A]=[];for(let k=0;k<256;k++)C.sbox[A][k]=c[A][k]}let y=0;for(let A=0;A<a+2;A++)C.pbox[A]=l[A]^v[y],y++,y>=m&&(y=0);let x=0,b=0,E=0;for(let A=0;A<a+2;A+=2)E=f(C,x,b),x=E.left,b=E.right,C.pbox[A]=x,C.pbox[A+1]=b;for(let A=0;A<4;A++)for(let k=0;k<256;k+=2)E=f(C,x,b),x=E.left,b=E.right,C.sbox[A][k]=x,C.sbox[A][k+1]=b;return!0}var g=s.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var C=this._keyPriorReset=this._key,v=C.words,m=C.sigBytes/4;p(u,v,m)}},encryptBlock:function(C,v){var m=f(u,C[v],C[v+1]);C[v]=m.left,C[v+1]=m.right},decryptBlock:function(C,v){var m=h(u,C[v],C[v+1]);C[v]=m.left,C[v+1]=m.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=o._createHelper(g)}(),n.Blowfish})}(vm)),vm.exports}(function(t,e){(function(n,r,i){t.exports=r(it(),Lp(),w9(),S9(),Vl(),k9(),Gl(),vR(),W1(),E9(),CR(),T9(),R9(),_9(),j1(),D9(),Ha(),Rn(),P9(),N9(),B9(),O9(),F9(),M9(),L9(),U9(),V9(),G9(),W9(),j9(),z9(),H9(),Z9(),$9(),X9())})(Ze,function(n){return n})})(mR);var K9=mR.exports;const GA=tu(K9);class si extends Error{constructor(e,n){super(n),this.code=e,this.name="FileTransferError"}}const so={CONNECTION_FAILED:"CONNECTION_FAILED",TRANSFER_TIMEOUT:"TRANSFER_TIMEOUT",INVALID_FILE:"INVALID_FILE",DATA_CHANNEL_ERROR:"DATA_CHANNEL_ERROR"};class J9 extends _p{constructor(n,r){super();M(this,"webRTCService");M(this,"client");M(this,"gmcpFileTransfer");M(this,"chunkSize",16384);M(this,"transferTimeoutInterval");M(this,"incomingTransfers",new Map);M(this,"outgoingTransfers",new Map);M(this,"maxFileSize",100*1024*1024);M(this,"transferTimeout",3e4);M(this,"pendingOffers",new Map);this.client=n,this.gmcpFileTransfer=r,this.webRTCService=n.webRTCService,this.setupListeners()}isDataChannelReady(){return this.webRTCService.isDataChannelOpen()}setupListeners(){this.webRTCService.on("dataChannelMessage",this.handleIncomingChunk.bind(this)),this.client.on("fileTransferAccepted",this.handleAcceptedTransfer.bind(this)),this.transferTimeoutInterval=window.setInterval(()=>this.checkTransferTimeouts(),5e3)}async initializeWebRTC(){this.webRTCService.isDataChannelOpen()||await this.webRTCService.createPeerConnection()}async sendFile(n,r){if(n.size>this.maxFileSize)throw new si(so.INVALID_FILE,`File size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);const i=await this.computeFileHash(n);console.log(`[FileTransferManager] Computed hash for ${n.name}: ${i}`),console.log(`[FileTransferManager] Registering outgoing transfer for file: ${n.name}`),this.outgoingTransfers.set(i,{file:n,filename:n.name,hash:i,lastActivityTimestamp:Date.now()});try{await this.initializeWebRTC(),this.webRTCService.recipient=r;const o=await this.webRTCService.createOffer();console.log(`[FileTransferManager] Sending offer for file: ${n.name}`),await this.gmcpFileTransfer.sendOffer(r,n.name,n.size,JSON.stringify(o),i),await this.webRTCService.waitForConnection()}catch(o){console.error(`[FileTransferManager] Failed to send file ${n.name}:`,o),this.handleTransferError(i,n.name,"send",o instanceof si?o:new si(so.CONNECTION_FAILED,"Failed to establish connection")),this.cleanupTransfer(i)}}async computeFileHash(n){return new Promise((r,i)=>{const o=new FileReader;o.onload=()=>{if(o.result instanceof ArrayBuffer){const s=GA.lib.WordArray.create(o.result),a=GA.SHA256(s).toString();r(a)}else i(new Error("Failed to read file for hashing"))},o.onerror=()=>i(o.error),o.readAsArrayBuffer(n)})}async startFileTransfer(n,r){let i=0;const o=new FileReader;for(;i<n.size;){const s=n.slice(i,i+this.chunkSize),a=await new Promise((c,u)=>{o.onload=()=>{o.result instanceof ArrayBuffer?c(o.result):u(new si(so.INVALID_FILE,"Failed to read file chunk"))},o.onerror=()=>u(new si(so.INVALID_FILE,"Error reading file")),o.readAsArrayBuffer(s)});await this.sendChunk(n.name,r,a,i,n.size),i+=a.byteLength;const l={hash:r,filename:n.name,sentBytes:i,totalBytes:n.size};this.emit("fileSendProgress",l)}}async sendChunk(n,r,i,o,s){try{const a={hash:r,filename:n,chunkIndex:Math.floor(o/this.chunkSize),totalChunks:Math.ceil(s/this.chunkSize),chunkSize:i.byteLength,totalSize:s},l=JSON.stringify(a),c=new TextEncoder().encode(l),u=new ArrayBuffer(4);new DataView(u).setUint32(0,c.byteLength,!0);const d=new Uint8Array(4+c.byteLength+i.byteLength);d.set(new Uint8Array(u),0),d.set(c,4),d.set(new Uint8Array(i),4+c.byteLength),await this.webRTCService.sendData(d.buffer)}catch{throw new si(so.DATA_CHANNEL_ERROR,"Failed to send chunk")}}async handleAcceptedTransfer(n){console.log("[FileTransferManager] Handling accepted transfer for file transfer request ",n);const{sender:r,hash:i,filename:o,answerSdp:s}=n,a=this.outgoingTransfers.get(i);if(!a){const l=`No outgoing transfer found for hash: ${i} (${o}). Active transfers: ${Array.from(this.outgoingTransfers.keys()).join(", ")}`;console.error(`[FileTransferManager] ${l}`),this.client.onFileTransferError(i,o,"send",l);return}try{console.log(`[FileTransferManager] Processing WebRTC answer for file: ${o}`);const l=JSON.parse(s);console.log(`[FileTransferManager] Answer object for file: ${o}`,l),await this.webRTCService.handleAnswer(l),console.log(`[FileTransferManager] Waiting for data channel to open for file: ${o}`),await this.waitForDataChannel(i),console.log(`[FileTransferManager] Data channel ready for outgoing transfer of: ${o}`),await this.startFileTransfer(a.file,a.hash),console.log(`[FileTransferManager] File transfer completed successfully: ${o}`),this.client.onFileSendComplete(i,o)}catch(l){console.error(`[FileTransferManager] Error in accepted transfer for ${o}:`,l),this.handleTransferError(i,o,"send",l)}finally{console.log(`[FileTransferManager] Cleaning up successful transfer: ${o} (${i})`),this.outgoingTransfers.delete(i)}}async waitForDataChannel(n){return new Promise((r,i)=>{if(this.isDataChannelReady()){r();return}let o=0;const s=50,a=setInterval(()=>{o++,this.isDataChannelReady()?(clearInterval(a),r()):o>=s&&(clearInterval(a),i(new si(so.CONNECTION_FAILED,`Data channel failed to open for transfer ${n} after ${o} attempts`)))},100)})}async handleIncomingChunk(n){try{if(n.byteLength<4)throw new Error("Received data is too short to contain header size");const r=new Uint8Array(n.slice(0,4)),i=new DataView(r.buffer).getUint32(0,!0);if(n.byteLength<4+i)throw new Error("Received data is too short to contain header");const o=new TextDecoder().decode(n.slice(4,4+i)),s=JSON.parse(o);if(n.byteLength<4+i+s.chunkSize)throw new Error("Received data is too short to contain chunk data");const a=this.pendingOffers.get(s.hash),l=(a==null?void 0:a.sender)||"unknown";if(typeof s.chunkIndex!="number"||s.chunkIndex<0||s.chunkIndex>=s.totalChunks)throw new Error("Invalid chunk index in header");if(typeof s.totalChunks!="number"||s.totalChunks<=0)throw new Error("Invalid total chunks in header");const c=n.slice(4+i,4+i+s.chunkSize);let u=this.incomingTransfers.get(s.hash);if(!u){if(s.totalSize>this.maxFileSize){this.client.onFileTransferError(s.hash,s.filename,"receive",`Incoming file size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);return}u={hash:s.hash,filename:s.filename,totalSize:s.totalSize,receivedSize:0,chunks:new Array(s.totalChunks),lastActivityTimestamp:Date.now(),sender:l},this.incomingTransfers.set(s.hash,u)}u.chunks[s.chunkIndex]=c,u.receivedSize+=c.byteLength,u.lastActivityTimestamp=Date.now();const d={hash:s.hash,filename:s.filename,receivedBytes:u.receivedSize,totalBytes:u.totalSize};if(this.emit("fileReceiveProgress",d),u.receivedSize===u.totalSize)if(u.chunks.every(f=>f)){const f=new Blob(u.chunks),h=new File([f],u.filename,{type:f.type});if(await this.computeFileHash(h)!==u.hash){this.client.onFileTransferError(u.hash,s.filename,"receive","File integrity check failed - hash mismatch"),this.incomingTransfers.delete(u.hash);return}const g=window.URL.createObjectURL(f),C=document.createElement("a");C.href=g,C.download=s.filename,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(g);const v={hash:u.hash,filename:s.filename,file:f};this.emit("fileReceiveComplete",v),this.incomingTransfers.delete(u.hash)}else this.client.onFileTransferError(u.hash,s.filename,"receive","Missing chunks in received file")}catch(r){this.handleTransferError("unknown","unknown_file","receive",new si("UNKNOWN_ERROR",r instanceof Error?r.message:"Unknown error"))}}handleTransferError(n,r,i,o){console.error(`Error ${i}ing file ${r} (${n}):`,o);const s=o instanceof Error?o.message:"Unknown error";this.client.onFileTransferError(n,r,i,s),this.cleanupTransfer(n),this.attemptRecovery(n,r,i)}cleanupTransfer(n){console.log(`[FileTransferManager] Starting cleanup for hash: ${n}`);const r=this.outgoingTransfers.get(n);r&&(console.log(`[FileTransferManager] Cleaning up outgoing transfer for: ${r.filename} (${n})`),this.outgoingTransfers.delete(n));const i=this.incomingTransfers.get(n);if(i&&(console.log(`[FileTransferManager] Cleaning up incoming transfer for: ${i.filename} (${n})`),this.incomingTransfers.delete(n)),this.pendingOffers.has(n)){const o=this.pendingOffers.get(n);console.log(`[FileTransferManager] Removing pending offer for: ${o==null?void 0:o.filename} (${n})`),this.pendingOffers.delete(n)}console.log(`[FileTransferManager] Cleanup complete for hash: ${n}`)}async attemptRecovery(n,r,i){try{if(await this.webRTCService.createPeerConnection(),this.client.onConnectionRecovered({hash:n,filename:r,direction:i}),i==="send"){const o=this.outgoingTransfers.get(n);o&&await this.startFileTransfer(o.file,o.hash)}else if(i==="receive"){const o=this.incomingTransfers.get(n);o&&this.gmcpFileTransfer.sendRequestResend(o.sender,n)}}catch(o){console.error("Failed to recover connection:",o),this.client.onRecoveryFailed({filename:r,direction:i,error:o instanceof Error?o.message:"Unknown error"})}}checkTransferTimeouts(){const n=Date.now();this.incomingTransfers.forEach((r,i)=>{n-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"receive",new si(so.TRANSFER_TIMEOUT,"Transfer timeout - no data received"))}),this.outgoingTransfers.forEach((r,i)=>{n-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"send",new si(so.TRANSFER_TIMEOUT,"Transfer timeout - no activity"))})}cleanup(){this.transferTimeoutInterval&&(clearInterval(this.transferTimeoutInterval),this.transferTimeoutInterval=void 0),[...this.outgoingTransfers.keys()].forEach(n=>this.cancelTransfer(n)),[...this.incomingTransfers.keys()].forEach(n=>this.cancelTransfer(n)),this.incomingTransfers.clear(),this.outgoingTransfers.clear(),this.pendingOffers.clear(),this.webRTCService.cleanup()}cancelTransfer(n){const r=this.outgoingTransfers.get(n)||this.incomingTransfers.get(n);r?(console.log(`[FileTransferManager] Cancelling transfer for hash: ${n} (${r.filename})`),this.cleanupTransfer(n),this.client.onFileTransferCancel(this.client.worldData.playerId,n),this.gmcpFileTransfer.sendCancel(this.client.worldData.playerId,n)):console.log(`[FileTransferManager] No active transfer found for hash: ${n}`)}async acceptTransfer(n,r){if(console.log("[FileTransferManager] Accepting transfer",n,r),this.incomingTransfers.has(r))throw new Error("Already receiving this file");const i=this.pendingOffers.get(r);if(console.log("[FileTransferManager] Checking pending offers:",Array.from(this.pendingOffers.entries())),!i)throw new si(so.INVALID_FILE,`No pending offer found for transfer with hash: ${r}`);console.log("[FileTransferManager] Found pending offer for transfer:",{sender:n,hash:r,filename:i.filename,filesize:i.filesize});try{await this.initializeWebRTC(),this.webRTCService.recipient=n,console.log("[FileTransferManager] Setting remote description with offer"),await this.webRTCService.handleOffer(JSON.parse(i.offerSdp)),console.log("[FileTransferManager] Creating WebRTC answer");const o=await this.webRTCService.createAnswer();if(console.log("[FileTransferManager] WebRTC answer created successfully"),this.pendingOffers.has(r))await this.gmcpFileTransfer.sendAccept(n,r,i.filename,JSON.stringify(o)),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready for incoming transfer"),this.pendingOffers.delete(r);else throw new Error("Transfer was cancelled during setup")}catch(o){throw console.error("Failed to accept transfer:",o),this.cleanupTransfer(r),new si(so.CONNECTION_FAILED,`Failed to accept transfer: ${o instanceof Error?o.message:"Unknown error"}`)}}}class Y9 extends _p{constructor(n,r){super();M(this,"ws");M(this,"decoder",new TextDecoder("utf8"));M(this,"telnet");M(this,"_connected",!1);M(this,"intentionalDisconnect",!1);M(this,"host");M(this,"port");M(this,"telnetNegotiation",!1);M(this,"telnetBuffer","");M(this,"gmcpHandlers",{});M(this,"mcpHandlers",{});M(this,"mcpMultilines",{});M(this,"mcpAuthKey",null);M(this,"mcp_negotiate");M(this,"mcp_getset");M(this,"gmcp_char");M(this,"gmcp_fileTransfer");M(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});M(this,"cacophony");M(this,"editors");M(this,"webRTCService");M(this,"fileTransferManager");M(this,"currentRoomInfo",null);M(this,"_autosay",!1);this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(f9),this.mcp_getset=this.registerMcpPackage(g9),this.gmcp_char=this.registerGMCPPackage(XT),this.gmcp_fileTransfer=this.registerGMCPPackage(KT),this.cacophony=new X6,this.cacophony.setGlobalVolume(vo.getState().general.volume),this.editors=new q4(this),this.webRTCService=new y9(this),this.fileTransferManager=new J9(this,this.gmcp_fileTransfer)}get connected(){return this._connected}get autosay(){return this._autosay}set autosay(n){this._autosay=n,this.emit("autosayChanged",n)}async sendFile(n,r){await this.fileTransferManager.sendFile(n,r)}cancelTransfer(n){this.fileTransferManager.cancelTransfer(n)}acceptTransfer(n,r){this.fileTransferManager.acceptTransfer(n,r)}rejectTransfer(n,r){this.gmcp_fileTransfer.sendReject(n,r)}onFileTransferOffer(n,r,i,o,s){console.log("[MudClient] Emitting fileTransferOffer event:",{sender:n,hash:r,filename:i,filesize:o,offerSdp:s}),this.emit("fileTransferOffer",{sender:n,hash:r,filename:i,filesize:o,offerSdp:s})}onFileTransferAccept(n,r,i,o){console.log("[MudClient] Emitting fileTransferAccepted event:",{sender:n,hash:r,filename:i,answerSdp:o}),this.emit("fileTransferAccepted",{sender:n,hash:r,filename:i,answerSdp:o})}onFileTransferReject(n,r){this.emit("fileTransferRejected",{sender:n,hash:r})}onFileTransferCancel(n,r){this.emit("fileTransferCancelled",{sender:n,hash:r})}onFileSendComplete(n,r){this.emit("fileSendComplete",{hash:n,filename:r})}onFileTransferError(n,r,i,o){this.emit("fileTransferError",{hash:n,filename:r,direction:i,error:o})}onConnectionRecovered(n){this.emit("connectionRecovered",n)}onRecoveryFailed(n){this.emit("recoveryFailed",n)}sendFileTransferOffer(n,r,i,o,s){this.gmcp_fileTransfer.sendOffer(n,r,o,s,i)}sendFileTransferAccept(n,r,i,o){this.gmcp_fileTransfer.sendAccept(n,i,r,o)}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.intentionalDisconnect=!1,this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new X4(new $4(this.ws)),this.ws.onopen=()=>{this._connected=!0,this.emit("connect"),this.emit("connectionChange",!0)},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===ed.WILL&&r===Qu.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(ed.DO,Qu.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===ed.DO&&r===Qu.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(ed.WILL,Qu.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r);try{this.handleGmcpData(n,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.cleanupConnection(),this.intentionalDisconnect||setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}cleanupConnection(){this._connected=!1,this.mcpAuthKey=null,this.telnetBuffer="",this.telnetNegotiation=!1,this.currentRoomInfo=null,this.webRTCService.cleanup(),this.fileTransferManager.cleanup(),this.emit("disconnect"),this.emit("connectionChange",!1)}close(){this.intentionalDisconnect=!0,this.ws&&this.ws.close(),this.cleanupConnection()}sendCommand(n){vo.getState().general.localEcho&&this.emit("command",n),this.autosay&&!n.startsWith("-")&&!n.startsWith("'")&&(n="say "+n),this.send(n+`\r
`),console.log("> "+n)}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=iA(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=iA(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=d9(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=oA(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),o=n.substring(0,i),s=n.substring(i+1);console.log("GMCP Message:",o,s,r);const a=this.gmcpHandlers[o];if(!a){console.log("No handler for GMCP package:",o);return}const l=a["handle"+s];if(l){console.log("Calling handler for:",s,l);let c;typeof r=="string"&&r.trim()!==""?c=r:(console.warn(`GMCP message data for ${o}.${s} is missing or empty. Defaulting to {}. Original data:`,r),c="{}");try{const u=JSON.parse(c);l.call(a,u)}catch(u){console.error(`Error parsing GMCP JSON for ${o}.${s}:`,u),console.error("Attempted to parse:",c)}}else console.log("No handler on package:",o,s)}emitMessage(n){const r=vo.getState().speech.autoreadMode;r===yC.All&&this.speak(n),r===yC.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let o="";for(const[s,a]of Object.entries(r))o+=` ${s}: ${a||'""'}`;r=o}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}sendMCPMultiline(n,r,i){const o=oA();r["_data-tag"]=o,this.sendMcp(n,r);for(const s of i)this.sendMcpMLLine(o,"content",s);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()}),this.editors.shutdown(),this.webRTCService.cleanup(),this.fileTransferManager.cleanup()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(Y4(n));r.lang="en-US";const{rate:i,pitch:o,voice:s,volume:a}=vo.getState().speech;r.rate=i,r.pitch=o,r.volume=a;const c=speechSynthesis.getVoices().find(u=>u.name===s);c&&(r.voice=c),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}}class q9{constructor(){M(this,"history",[]);M(this,"currentIndex",-1);M(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&this.history.push(e.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(e){return this.currentIndex===-1&&(this.unsentInput=e),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(e){return this.currentIndex===-1&&(this.unsentInput=e),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}getHistory(){return[...this.history]}}const Q9=()=>{const[,t]=S.useReducer(e=>e+1,0);return S.useEffect(()=>Ac.subscribe(t),[]),[Ac.getState(),Ac.dispatch]},WA="command_history",e7=1e3,t7=({onSend:t,inputRef:e})=>{const n=S.useRef(new q9),[r,i]=Q9();S.useEffect(()=>{const l=localStorage.getItem(WA);l&&JSON.parse(l).forEach(u=>{n.current.addCommand(u)})},[]);const o=()=>{try{const c=n.current.getHistory().slice(-e7);localStorage.setItem(WA,JSON.stringify(c))}catch(l){console.warn("Failed to save command history:",l)}},s=S.useCallback(l=>{const c=n.current,u=r.text;if(l.key==="Enter"&&!l.shiftKey)l.preventDefault(),a();else if(l.key==="ArrowUp"){l.preventDefault();const d=c.navigateUp(u);xd(d)}else if(l.key==="ArrowDown"){l.preventDefault();const d=c.navigateDown(u);xd(d)}},[r.text]),a=S.useCallback(()=>{var c;const l=r.text;l.trim()&&(t(l),n.current.addCommand(l),o(),zO(),(c=e.current)==null||c.focus())},[r.text,t,e]);return z.jsxs("div",{className:"command-input-container",children:[z.jsx("textarea",{value:r.text,onChange:l=>xd(l.target.value),onKeyDown:s,id:"command-input",ref:e,autoFocus:!0}),z.jsx("button",{onClick:a,className:"send-button",children:"Send"})]})},yR=7e3;let ao=null;function jA(t,e="assertive",n=yR){ao?ao.announce(t,e,n):(ao=new n7,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?ao.announce(t,e,n):setTimeout(()=>{ao!=null&&ao.isAttached()&&(ao==null||ao.announce(t,e,n))},100))}class n7{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",e),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,n="assertive",r=yR){var i,o;if(!this.node)return;let s=document.createElement("div");typeof e=="object"?(s.setAttribute("role","img"),s.setAttribute("aria-labelledby",e["aria-labelledby"])):s.textContent=e,n==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(s):(o=this.politeLog)===null||o===void 0||o.appendChild(s),e!==""&&setTimeout(()=>{s.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var zA=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function r7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ys=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],i7=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,o7=function(){zA(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){r7(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return zA(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(Ys[n][r].color);for(var i=[0,95,135,175,215,255],o=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},s=0;s<6;++s)for(var a=0;a<6;++a)for(var l=0;l<6;++l)this.PALETTE_COLORS.push(o(s,a,l));for(var c=8,u=0;u<24;++u,c+=10)this.PALETTE_COLORS.push(o(c,c,c))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(i7,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var o=this,s=this,a=n.split(/\033\[/),l=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var c=a.map(function(d){return o.processChunk(d,r,i)});if(r&&r.json){var u=s.processChunkJson("");return u.content=l,u.clearLine=r.clearLine,c.unshift(u),r.remove_empty&&(c=c.filter(function(d){return!d.isEmpty()})),c}else c.unshift(l);return c.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var o=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,s=r.key=o?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},l=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!l)return a;a.content=l[4];var c=l[2].split(";");if(l[1]!==""||l[3]!=="m"||!i)return a;for(var u=this;c.length>0;){var d=c.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=Ys[0][f%10][s];else if(f>=90&&f<98)u.fg=Ys[1][f%10][s];else if(f>=40&&f<48)u.bg=Ys[0][f%10][s];else if(f>=100&&f<108)u.bg=Ys[1][f%10][s];else if(f===38||f===48){var h=f===38;if(c.length>=1){var p=c.shift();if(p==="5"&&c.length>=1){var g=parseInt(c.shift());if(g>=0&&g<=255)if(!o)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[g]:u.bg=this.PALETTE_COLORS[g];else{var C=g>=16?"ansi-palette-"+g:Ys[g>7?1:0][g%8].class;h?u.fg=C:u.bg=C}}else if(p==="2"&&c.length>=3){var v=parseInt(c.shift()),m=parseInt(c.shift()),y=parseInt(c.shift());if(v>=0&&v<=255&&m>=0&&m<=255&&y>=0&&y<=255){var x=v+", "+m+", "+y;o?h?(u.fg="ansi-truecolor",u.fg_truecolor=x):(u.bg="ansi-truecolor",u.bg_truecolor=x):h?u.fg=x:u.bg=x}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var o=this;r=r||{};var s=this.processChunkJson(n,r,i),a=r.use_classes;if(s.decorations=s.decorations.filter(function(h){if(h==="reverse"){s.fg||(s.fg=Ys[0][7][a?"class":"color"]),s.bg||(s.bg=Ys[0][0][a?"class":"color"]);var p=s.fg;s.fg=s.bg,s.bg=p;var g=s.fg_truecolor;return s.fg_truecolor=s.bg_truecolor,s.bg_truecolor=g,s.isInverted=!0,!1}return!0}),r.json)return s;if(s.isEmpty())return"";if(!s.was_processed)return s.content;var l=[],c=[],u=[],d={},f=function(p){var g=[],C=void 0;for(C in p)p.hasOwnProperty(C)&&g.push("data-"+C+'="'+o.escapeForHtml(p[C])+'"');return g.length>0?" "+g.join(" "):""};return s.isInverted&&(d["ansi-is-inverted"]="true"),s.fg&&(a?(l.push(s.fg+"-fg"),s.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=s.fg_truecolor,s.fg_truecolor=null)):l.push("color:rgb("+s.fg+")")),s.bg&&(a?(l.push(s.bg+"-bg"),s.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=s.bg_truecolor,s.bg_truecolor=null)):l.push("background-color:rgb("+s.bg+")")),s.decorations.forEach(function(h){if(a){c.push("ansi-"+h);return}h==="bold"?c.push("font-weight:bold"):h==="dim"?c.push("opacity:0.5"):h==="italic"?c.push("font-style:italic"):h==="hidden"?c.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&c.push("text-decoration:"+u.join(" ")),a?'<span class="'+l.concat(c).join(" ")+'"'+f(d)+">"+s.content+"</span>":'<span style="'+l.concat(c).join(";")+'"'+f(d)+">"+s.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),s7=o7;const a7=tu(s7);function l7(t,e){let n=[];for(const r of t.split(`\r
`)){const i=a7.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const s of i){const a=f7(s,e);o=[...o,...a]}n=[...n,z.jsx("span",{children:o},n.length)]}return n}const c7=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,u7=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,d7=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function f7(t,e){const n=h7(t),r=[];let i=0,o=0;function s(u,d){let f;for(;(f=u.exec(t.content))!==null;){const h=f.index;h>i&&r.push(t.content.substring(i,h)),r.push(d(f)),i=u.lastIndex}}function a(u){const[,d,f]=u,h=f;return z.jsxs(z.Fragment,{children:[d,z.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:f})]})}function l(u){const d=u.groups.name,f=`mailto:${d}`;return z.jsxs(z.Fragment,{children:[u.groups.slorp1,z.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function c(u){const[,d,f]=u;return z.jsx("a",{onClick:()=>e(d),className:"exit",children:f})}return s(c7,a),s(u7,l),s(d7,c),i<t.content.length&&r.push(t.content.substring(i)),r.map(u=>z.jsx("span",{style:n,children:u},o++))}function h7(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var Oa={},fu={},xR=S;function je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var br=Object.prototype.hasOwnProperty,p7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HA={},ZA={};function IR(t){return br.call(ZA,t)?!0:br.call(HA,t)?!1:p7.test(t)?ZA[t]=!0:(HA[t]=!0,!1)}function vr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Un[t]=new vr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Un[e]=new vr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Un[t]=new vr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Un[t]=new vr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Un[t]=new vr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Un[t]=new vr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Un[t]=new vr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Un[t]=new vr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Un[t]=new vr(t,5,!1,t.toLowerCase(),null,!1,!1)});var z1=/[\-:]([a-z])/g;function H1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(z1,H1);Un[e]=new vr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(z1,H1);Un[e]=new vr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(z1,H1);Un[e]=new vr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Un[t]=new vr(t,1,!1,t.toLowerCase(),null,!1,!1)});Un.xlinkHref=new vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Un[t]=new vr(t,1,!1,t.toLowerCase(),null,!0,!0)});var Bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},g7=["Webkit","ms","Moz","O"];Object.keys(Bh).forEach(function(t){g7.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Bh[e]=Bh[t]})});var m7=/["'&<>]/;function ar(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=m7.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var v7=/([A-Z])/g,C7=/^ms-/,xC=Array.isArray;function Xo(t,e){return{insertionMode:t,selectedValue:e}}function y7(t,e,n){switch(e){case"select":return Xo(1,n.value!=null?n.value:n.defaultValue);case"svg":return Xo(2,null);case"math":return Xo(3,null);case"foreignObject":return Xo(1,null);case"table":return Xo(4,null);case"thead":case"tbody":case"tfoot":return Xo(5,null);case"colgroup":return Xo(7,null);case"tr":return Xo(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Xo(1,null):t}var $A=new Map;function bR(t,e,n){if(typeof n!="object")throw Error(je(62));e=!0;for(var r in n)if(br.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=ar(r);i=ar((""+i).trim())}else{o=r;var s=$A.get(o);s!==void 0||(s=ar(o.replace(v7,"-$1").toLowerCase().replace(C7,"-ms-")),$A.set(o,s)),o=s,i=typeof i=="number"?i===0||br.call(Bh,r)?""+i:i+"px":ar((""+i).trim())}e?(e=!1,t.push(' style="',o,":",i)):t.push(";",o,":",i)}}e||t.push('"')}function Fr(t,e,n,r){switch(n){case"style":bR(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Un.hasOwnProperty(n)?Un[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=e.attributeName,e.type){case 3:r&&t.push(" ",n,'=""');break;case 4:r===!0?t.push(" ",n,'=""'):r!==!1&&t.push(" ",n,'="',ar(r),'"');break;case 5:isNaN(r)||t.push(" ",n,'="',ar(r),'"');break;case 6:!isNaN(r)&&1<=r&&t.push(" ",n,'="',ar(r),'"');break;default:e.sanitizeURL&&(r=""+r),t.push(" ",n,'="',ar(r),'"')}}else if(IR(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",n,'="',ar(r),'"')}}}function Oh(t,e,n){if(e!=null){if(n!=null)throw Error(je(60));if(typeof e!="object"||!("__html"in e))throw Error(je(61));e=e.__html,e!=null&&t.push(""+e)}}function x7(t){var e="";return xR.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function Cm(t,e,n,r){t.push(co(n));var i=n=null,o;for(o in e)if(br.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Fr(t,r,o,s)}}return t.push(">"),Oh(t,i,n),typeof n=="string"?(t.push(ar(n)),null):n}var I7=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,XA=new Map;function co(t){var e=XA.get(t);if(e===void 0){if(!I7.test(t))throw Error(je(65,t));e="<"+t,XA.set(t,e)}return e}function b7(t,e,n,r,i){switch(e){case"select":t.push(co("select"));var o=null,s=null;for(u in n)if(br.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Fr(t,r,u,a)}}return t.push(">"),Oh(t,s,o),o;case"option":s=i.selectedValue,t.push(co("option"));var l=a=null,c=null,u=null;for(o in n)if(br.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Fr(t,r,o,d)}}if(s!=null)if(n=l!==null?""+l:x7(a),xC(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(' selected=""');break}}else""+s===n&&t.push(' selected=""');else c&&t.push(' selected=""');return t.push(">"),Oh(t,u,a),a;case"textarea":t.push(co("textarea")),u=s=o=null;for(a in n)if(br.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(je(91));default:Fr(t,r,a,l)}if(o===null&&s!==null&&(o=s),t.push(">"),u!=null){if(o!=null)throw Error(je(92));if(xC(u)&&1<u.length)throw Error(je(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o!==null&&t.push(ar(""+o)),null;case"input":t.push(co("input")),l=u=a=o=null;for(s in n)if(br.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Fr(t,r,s,c)}return u!==null?Fr(t,r,"checked",u):l!==null&&Fr(t,r,"checked",l),o!==null?Fr(t,r,"value",o):a!==null&&Fr(t,r,"value",a),t.push("/>"),null;case"menuitem":t.push(co("menuitem"));for(var f in n)if(br.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(je(400));default:Fr(t,r,f,o)}return t.push(">"),null;case"title":t.push(co("title")),o=null;for(d in n)if(br.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(je(434));default:Fr(t,r,d,s)}return t.push(">"),o;case"listing":case"pre":t.push(co(e)),s=o=null;for(l in n)if(br.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Fr(t,r,l,a)}if(t.push(">"),s!=null){if(o!=null)throw Error(je(60));if(typeof s!="object"||!("__html"in s))throw Error(je(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(`
`,n):t.push(""+n))}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(co(e));for(var h in n)if(br.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,e));default:Fr(t,r,h,o)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Cm(t,n,e,r);case"html":return i.insertionMode===0&&t.push("<!DOCTYPE html>"),Cm(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return Cm(t,n,e,r);t.push(co(e)),s=o=null;for(c in n)if(br.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":bR(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:IR(c)&&typeof a!="function"&&typeof a!="symbol"&&t.push(" ",c,'="',ar(a),'"')}return t.push(">"),Oh(t,s,o),o}}function KA(t,e,n){if(t.push('<!--$?--><template id="'),n===null)throw Error(je(395));return t.push(n),t.push('"></template>')}function A7(t,e,n,r){switch(n.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');default:throw Error(je(397))}}function w7(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(je(397))}}var S7=/[<\u2028\u2029]/g;function ym(t){return JSON.stringify(t).replace(S7,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function k7(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function JA(t,e,n,r){return n.generateStaticMarkup?(t.push(ar(e)),!1):(e===""?t=r:(r&&t.push("<!-- -->"),t.push(ar(e)),t=!0),t)}var Id=Object.assign,E7=Symbol.for("react.element"),AR=Symbol.for("react.portal"),wR=Symbol.for("react.fragment"),SR=Symbol.for("react.strict_mode"),kR=Symbol.for("react.profiler"),ER=Symbol.for("react.provider"),TR=Symbol.for("react.context"),RR=Symbol.for("react.forward_ref"),_R=Symbol.for("react.suspense"),DR=Symbol.for("react.suspense_list"),PR=Symbol.for("react.memo"),Z1=Symbol.for("react.lazy"),T7=Symbol.for("react.scope"),R7=Symbol.for("react.debug_trace_mode"),_7=Symbol.for("react.legacy_hidden"),D7=Symbol.for("react.default_value"),YA=Symbol.iterator;function IC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wR:return"Fragment";case AR:return"Portal";case kR:return"Profiler";case SR:return"StrictMode";case _R:return"Suspense";case DR:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case TR:return(t.displayName||"Context")+".Consumer";case ER:return(t._context.displayName||"Context")+".Provider";case RR:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case PR:return e=t.displayName||null,e!==null?e:IC(t.type)||"Memo";case Z1:e=t._payload,t=t._init;try{return IC(t(e))}catch{}}return null}var NR={};function qA(t,e){if(t=t.contextTypes,!t)return NR;var n={},r;for(r in t)n[r]=e[r];return n}var cl=null;function Up(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(je(401))}else{if(n===null)throw Error(je(401));Up(t,n)}e.context._currentValue2=e.value}}function BR(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&BR(t)}function OR(t){var e=t.parent;e!==null&&OR(e),t.context._currentValue2=t.value}function FR(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(je(402));t.depth===e.depth?Up(t,e):FR(t,e)}function MR(t,e){var n=e.parent;if(n===null)throw Error(je(402));t.depth===n.depth?Up(t,n):MR(t,n),e.context._currentValue2=e.value}function G0(t){var e=cl;e!==t&&(e===null?OR(t):t===null?BR(e):e.depth===t.depth?Up(e,t):e.depth>t.depth?FR(e,t):MR(e,t),cl=t)}var QA={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function ew(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=QA,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue2:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:Id({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&QA.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=Id({},o,a)):Id(o,a))}t.state=o}else o.queue=null}var P7={id:1,overflow:""};function bC(t,e,n){var r=t.id;t=t.overflow;var i=32-Fh(r)-1;r&=~(1<<i),n+=1;var o=32-Fh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-Fh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var Fh=Math.clz32?Math.clz32:O7,N7=Math.log,B7=Math.LN2;function O7(t){return t>>>=0,t===0?32:31-(N7(t)/B7|0)|0}function F7(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var M7=typeof Object.is=="function"?Object.is:F7,Ms=null,$1=null,Mh=null,Et=null,nd=!1,W0=!1,Jd=0,ga=null,Vp=0;function tl(){if(Ms===null)throw Error(je(321));return Ms}function tw(){if(0<Vp)throw Error(je(312));return{memoizedState:null,queue:null,next:null}}function X1(){return Et===null?Mh===null?(nd=!1,Mh=Et=tw()):(nd=!0,Et=Mh):Et.next===null?(nd=!1,Et=Et.next=tw()):(nd=!0,Et=Et.next),Et}function K1(){$1=Ms=null,W0=!1,Mh=null,Vp=0,Et=ga=null}function LR(t,e){return typeof e=="function"?e(t):e}function nw(t,e,n){if(Ms=tl(),Et=X1(),nd){var r=Et.queue;if(e=r.dispatch,ga!==null&&(n=ga.get(r),n!==void 0)){ga.delete(r),r=Et.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return Et.memoizedState=r,[r,e]}return[Et.memoizedState,e]}return t=t===LR?typeof e=="function"?e():e:n!==void 0?n(e):e,Et.memoizedState=t,t=Et.queue={last:null,dispatch:null},t=t.dispatch=L7.bind(null,Ms,t),[Et.memoizedState,t]}function rw(t,e){if(Ms=tl(),Et=X1(),e=e===void 0?null:e,Et!==null){var n=Et.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!M7(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),Et.memoizedState=[t,e],t}function L7(t,e,n){if(25<=Vp)throw Error(je(301));if(t===Ms)if(W0=!0,t={action:n,next:null},ga===null&&(ga=new Map),n=ga.get(e),n===void 0)ga.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function U7(){throw Error(je(394))}function oh(){}var iw={readContext:function(t){return t._currentValue2},useContext:function(t){return tl(),t._currentValue2},useMemo:rw,useReducer:nw,useRef:function(t){Ms=tl(),Et=X1();var e=Et.memoizedState;return e===null?(t={current:t},Et.memoizedState=t):e},useState:function(t){return nw(LR,t)},useInsertionEffect:oh,useLayoutEffect:function(){},useCallback:function(t,e){return rw(function(){return t},e)},useImperativeHandle:oh,useEffect:oh,useDebugValue:oh,useDeferredValue:function(t){return tl(),t},useTransition:function(){return tl(),[!1,U7]},useId:function(){var t=$1.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-Fh(t)-1)).toString(32)+e;var n=Lh;if(n===null)throw Error(je(404));return e=Jd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return tl(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(je(407));return n()}},Lh=null,xm=xR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function V7(t){return console.error(t),null}function rd(){}function G7(t,e,n,r,i,o,s,a,l){var c=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?V7:i,onAllReady:rd,onShellReady:s===void 0?rd:s,onShellError:rd,onFatalError:rd},n=j0(e,0,null,n,!1,!1),n.parentFlushed=!0,t=J1(e,t,null,n,u,NR,null,P7),c.push(t),e}function J1(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var c=t.pingedTasks;c.push(l),c.length===1&&GR(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function j0(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Yd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function z0(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function ow(t,e,n,r,i){for(Ms={},$1=e,Jd=0,t=n(r,i);W0;)W0=!1,Jd=0,Vp+=1,Et=null,t=n(r,i);return K1(),t}function sw(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(je(108,IC(r)||"Unknown",a));r=Id({},s,n)}e.legacyContext=r,jr(t,e,i),e.legacyContext=s}else jr(t,e,i)}function aw(t,e){if(t&&t.defaultProps){e=Id({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function AC(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=qA(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue2:i),ew(o,n,r,i),sw(t,e,o,n)}else{o=qA(n,e.legacyContext),i=ow(t,e,n,r,o);var s=Jd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)ew(i,n,r,o),sw(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=bC(r,1,0);try{jr(t,e,i)}finally{e.treeContext=r}}else jr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=b7(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=y7(s,n,r),wC(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case _7:case R7:case SR:case kR:case wR:jr(t,e,r.children);return;case DR:jr(t,e,r.children);return;case T7:throw Error(je(343));case _R:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=j0(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=j0(t,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=c;try{if(wC(t,e,r),t.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),c.status=1,H0(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=Yd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=J1(t,o,n,l,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case RR:if(r=ow(t,e,n.render,r,i),Jd!==0){n=e.treeContext,e.treeContext=bC(n,1,0);try{jr(t,e,r)}finally{e.treeContext=n}}else jr(t,e,r);return;case PR:n=n.type,r=aw(n,r),AC(t,e,n,r,i);return;case ER:if(i=r.children,n=n._context,r=r.value,o=n._currentValue2,n._currentValue2=r,s=cl,cl=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,jr(t,e,i),t=cl,t===null)throw Error(je(403));r=t.parentValue,t.context._currentValue2=r===D7?t.context._defaultValue:r,t=cl=t.parent,e.context=t;return;case TR:r=r.children,r=r(n._currentValue2),jr(t,e,r);return;case Z1:i=n._init,n=i(n._payload),r=aw(n,r),AC(t,e,n,r,void 0);return}throw Error(je(130,n==null?n:typeof n,""))}}function jr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case E7:AC(t,e,n.type,n.props,n.ref);return;case AR:throw Error(je(257));case Z1:var r=n._init;n=r(n._payload),jr(t,e,n);return}if(xC(n)){lw(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=YA&&n[YA]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);lw(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(je(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=JA(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=JA(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function lw(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=bC(o,r,i);try{wC(t,e,n[i])}finally{e.treeContext=o}}}function wC(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return jr(t,e,n)}catch(l){if(K1(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=e.blockedSegment,a=j0(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=J1(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,G0(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,G0(o),l}}function W7(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,VR(this,e,t)}function UR(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(je(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return UR(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function H0(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&H0(t,n)}else t.completedSegments.push(e)}function VR(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(je(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=rd,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&H0(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(W7,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(H0(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function GR(t){if(t.status!==2){var e=cl,n=xm.current;xm.current=iw;var r=Lh;Lh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,l=s.blockedSegment;if(l.status===0){G0(s.context);try{jr(a,s,s.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),s.abortSet.delete(s),l.status=1,VR(a,s.blockedBoundary,l)}catch(p){if(K1(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=Yd(a,d);if(u===null?z0(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&Y1(t,t.destination)}catch(p){Yd(t,p),z0(t,p)}finally{Lh=r,xm.current=n,n===iw&&G0(e)}}}function sh(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)e.push(r[o]);i=Gp(t,e,i)}for(;o<r.length-1;o++)e.push(r[o]);return o<r.length&&(i=e.push(r[o])),i;default:throw Error(je(390))}}function Gp(t,e,n){var r=n.boundary;if(r===null)return sh(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)return t.responseState.generateStaticMarkup||(r=r.errorDigest,e.push("<!--$!-->"),e.push("<template"),r&&(e.push(' data-dgst="'),r=ar(r),e.push(r),e.push('"')),e.push("></template>")),sh(t,e,n),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;return i=i.boundaryPrefix+o.toString(16),r=r.id=i,KA(e,t.responseState,r),sh(t,e,n),e.push("<!--/$-->")}if(r.byteSize>t.progressiveChunkSize)return r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),KA(e,t.responseState,r.id),sh(t,e,n),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(je(391));return Gp(t,e,n[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function cw(t,e,n){return A7(e,t.responseState,n.formatContext,n.id),Gp(t,e,n),w7(e,n.formatContext)}function uw(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)WR(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(je(395));return n=n.toString(16),e.push(r),e.push('","'),e.push(t.segmentPrefix),e.push(n),e.push('")<\/script>')}function WR(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(je(392));return cw(t,e,r)}return cw(t,e,r),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),i=i.toString(16),e.push(i),e.push('","'),e.push(t.placeholderPrefix),e.push(i),e.push('")<\/script>')}function Y1(t,e){try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){Gp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)e.push(r[n]);n<r.length&&e.push(r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(je(395));if(r.push(l),r.push('"'),c||u||d){r.push(",");var f=ym(c||"");r.push(f)}if(u||d){r.push(",");var h=ym(u||"");r.push(h)}if(d){r.push(",");var p=ym(d);r.push(p)}if(!r.push(")<\/script>")){t.destination=null,o++,i.splice(0,o);return}}i.splice(0,o);var g=t.completedBoundaries;for(o=0;o<g.length;o++)if(!uw(t,e,g[o])){t.destination=null,o++,g.splice(0,o);return}g.splice(0,o);var C=t.partialBoundaries;for(o=0;o<C.length;o++){var v=C[o];e:{i=t,s=e;var m=v.completedSegments;for(a=0;a<m.length;a++)if(!WR(i,s,v,m[a])){a++,m.splice(0,a);var y=!1;break e}m.splice(0,a),y=!0}if(!y){t.destination=null,o++,C.splice(0,o);return}}C.splice(0,o);var x=t.completedBoundaries;for(o=0;o<x.length;o++)if(!uw(t,e,x[o])){t.destination=null,o++,x.splice(0,o);return}x.splice(0,o)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function j7(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return UR(r,t,e)}),n.clear(),t.destination!==null&&Y1(t,t.destination)}catch(r){Yd(t,r),z0(t,r)}}function z7(){}function jR(t,e,n,r){var i=!1,o=null,s="",a={push:function(c){return c!==null&&(s+=c),!0},destroy:function(c){i=!0,o=c}},l=!1;if(t=G7(t,k7(n,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,z7,void 0,function(){l=!0}),GR(t),j7(t,r),t.status===1)t.status=2,a.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=a;try{Y1(t,a)}catch(c){Yd(t,c),z0(t,c)}}if(i)throw o;if(!l)throw Error(je(426));return s}fu.renderToNodeStream=function(){throw Error(je(207))};fu.renderToStaticMarkup=function(t,e){return jR(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};fu.renderToStaticNodeStream=function(){throw Error(je(208))};fu.renderToString=function(t,e){return jR(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};fu.version="18.3.1";var q1={},zR=S;function Xe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zr=null,Hr=0;function _e(t,e){if(e.length!==0)if(512<e.length)0<Hr&&(t.enqueue(new Uint8Array(zr.buffer,0,Hr)),zr=new Uint8Array(512),Hr=0),t.enqueue(e);else{var n=zr.length-Hr;n<e.length&&(n===0?t.enqueue(zr):(zr.set(e.subarray(0,n),Hr),t.enqueue(zr),e=e.subarray(n)),zr=new Uint8Array(512),Hr=0),zr.set(e,Hr),Hr+=e.length}}function Mt(t,e){return _e(t,e),!0}function dw(t){zr&&0<Hr&&(t.enqueue(new Uint8Array(zr.buffer,0,Hr)),zr=null,Hr=0)}var HR=new TextEncoder;function Ke(t){return HR.encode(t)}function ye(t){return HR.encode(t)}function ZR(t,e){typeof t.error=="function"?t.error(e):t.close()}var Ar=Object.prototype.hasOwnProperty,H7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fw={},hw={};function $R(t){return Ar.call(hw,t)?!0:Ar.call(fw,t)?!1:H7.test(t)?hw[t]=!0:(fw[t]=!0,!1)}function Cr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vn[t]=new Cr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vn[e]=new Cr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vn[t]=new Cr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vn[t]=new Cr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vn[t]=new Cr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vn[t]=new Cr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vn[t]=new Cr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vn[t]=new Cr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vn[t]=new Cr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Q1=/[\-:]([a-z])/g;function ex(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Q1,ex);Vn[e]=new Cr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Q1,ex);Vn[e]=new Cr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Q1,ex);Vn[e]=new Cr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vn[t]=new Cr(t,1,!1,t.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new Cr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vn[t]=new Cr(t,1,!1,t.toLowerCase(),null,!0,!0)});var Uh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Z7=["Webkit","ms","Moz","O"];Object.keys(Uh).forEach(function(t){Z7.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Uh[e]=Uh[t]})});var $7=/["'&<>]/;function Bn(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=$7.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var X7=/([A-Z])/g,K7=/^ms-/,SC=Array.isArray,J7=ye("<script>"),Y7=ye("<\/script>"),q7=ye('<script src="'),Q7=ye('<script type="module" src="'),pw=ye('" async=""><\/script>'),eU=/(<\/|<)(s)(cript)/gi;function tU(t,e,n,r){return""+e+(n==="s"?"\\u0073":"\\u0053")+r}function nU(t,e,n,r,i){t=t===void 0?"":t,e=e===void 0?J7:ye('<script nonce="'+Bn(e)+'">');var o=[];if(n!==void 0&&o.push(e,Ke((""+n).replace(eU,tU)),Y7),r!==void 0)for(n=0;n<r.length;n++)o.push(q7,Ke(Bn(r[n])),pw);if(i!==void 0)for(r=0;r<i.length;r++)o.push(Q7,Ke(Bn(i[r])),pw);return{bootstrapChunks:o,startInlineScript:e,placeholderPrefix:ye(t+"P:"),segmentPrefix:ye(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function uo(t,e){return{insertionMode:t,selectedValue:e}}function rU(t){return uo(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function iU(t,e,n){switch(e){case"select":return uo(1,n.value!=null?n.value:n.defaultValue);case"svg":return uo(2,null);case"math":return uo(3,null);case"foreignObject":return uo(1,null);case"table":return uo(4,null);case"thead":case"tbody":case"tfoot":return uo(5,null);case"colgroup":return uo(7,null);case"tr":return uo(6,null)}return 4<=t.insertionMode||t.insertionMode===0?uo(1,null):t}var tx=ye("<!-- -->");function gw(t,e,n,r){return e===""?r:(r&&t.push(tx),t.push(Ke(Bn(e))),!0)}var mw=new Map,oU=ye(' style="'),vw=ye(":"),sU=ye(";");function XR(t,e,n){if(typeof n!="object")throw Error(Xe(62));e=!0;for(var r in n)if(Ar.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Ke(Bn(r));i=Ke(Bn((""+i).trim()))}else{o=r;var s=mw.get(o);s!==void 0||(s=ye(Bn(o.replace(X7,"-$1").toLowerCase().replace(K7,"-ms-"))),mw.set(o,s)),o=s,i=typeof i=="number"?i===0||Ar.call(Uh,r)?Ke(""+i):Ke(i+"px"):Ke(Bn((""+i).trim()))}e?(e=!1,t.push(oU,o,vw,i)):t.push(sU,o,vw,i)}}e||t.push(nl)}var ia=ye(" "),ec=ye('="'),nl=ye('"'),Cw=ye('=""');function Mr(t,e,n,r){switch(n){case"style":XR(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Vn.hasOwnProperty(n)?Vn[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=Ke(e.attributeName),e.type){case 3:r&&t.push(ia,n,Cw);break;case 4:r===!0?t.push(ia,n,Cw):r!==!1&&t.push(ia,n,ec,Ke(Bn(r)),nl);break;case 5:isNaN(r)||t.push(ia,n,ec,Ke(Bn(r)),nl);break;case 6:!isNaN(r)&&1<=r&&t.push(ia,n,ec,Ke(Bn(r)),nl);break;default:e.sanitizeURL&&(r=""+r),t.push(ia,n,ec,Ke(Bn(r)),nl)}}else if($R(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(ia,Ke(n),ec,Ke(Bn(r)),nl)}}}var oa=ye(">"),yw=ye("/>");function Vh(t,e,n){if(e!=null){if(n!=null)throw Error(Xe(60));if(typeof e!="object"||!("__html"in e))throw Error(Xe(61));e=e.__html,e!=null&&t.push(Ke(""+e))}}function aU(t){var e="";return zR.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var Im=ye(' selected=""');function bm(t,e,n,r){t.push(fo(n));var i=n=null,o;for(o in e)if(Ar.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Mr(t,r,o,s)}}return t.push(oa),Vh(t,i,n),typeof n=="string"?(t.push(Ke(Bn(n))),null):n}var Am=ye(`
`),lU=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,xw=new Map;function fo(t){var e=xw.get(t);if(e===void 0){if(!lU.test(t))throw Error(Xe(65,t));e=ye("<"+t),xw.set(t,e)}return e}var cU=ye("<!DOCTYPE html>");function uU(t,e,n,r,i){switch(e){case"select":t.push(fo("select"));var o=null,s=null;for(u in n)if(Ar.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Mr(t,r,u,a)}}return t.push(oa),Vh(t,s,o),o;case"option":s=i.selectedValue,t.push(fo("option"));var l=a=null,c=null,u=null;for(o in n)if(Ar.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Mr(t,r,o,d)}}if(s!=null)if(n=l!==null?""+l:aU(a),SC(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(Im);break}}else""+s===n&&t.push(Im);else c&&t.push(Im);return t.push(oa),Vh(t,u,a),a;case"textarea":t.push(fo("textarea")),u=s=o=null;for(a in n)if(Ar.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(Xe(91));default:Mr(t,r,a,l)}if(o===null&&s!==null&&(o=s),t.push(oa),u!=null){if(o!=null)throw Error(Xe(92));if(SC(u)&&1<u.length)throw Error(Xe(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(Am),o!==null&&t.push(Ke(Bn(""+o))),null;case"input":t.push(fo("input")),l=u=a=o=null;for(s in n)if(Ar.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Mr(t,r,s,c)}return u!==null?Mr(t,r,"checked",u):l!==null&&Mr(t,r,"checked",l),o!==null?Mr(t,r,"value",o):a!==null&&Mr(t,r,"value",a),t.push(yw),null;case"menuitem":t.push(fo("menuitem"));for(var f in n)if(Ar.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(400));default:Mr(t,r,f,o)}return t.push(oa),null;case"title":t.push(fo("title")),o=null;for(d in n)if(Ar.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(Xe(434));default:Mr(t,r,d,s)}return t.push(oa),o;case"listing":case"pre":t.push(fo(e)),s=o=null;for(l in n)if(Ar.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Mr(t,r,l,a)}if(t.push(oa),s!=null){if(o!=null)throw Error(Xe(60));if(typeof s!="object"||!("__html"in s))throw Error(Xe(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(Am,Ke(n)):t.push(Ke(""+n)))}return typeof o=="string"&&o[0]===`
`&&t.push(Am),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(fo(e));for(var h in n)if(Ar.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(399,e));default:Mr(t,r,h,o)}return t.push(yw),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return bm(t,n,e,r);case"html":return i.insertionMode===0&&t.push(cU),bm(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return bm(t,n,e,r);t.push(fo(e)),s=o=null;for(c in n)if(Ar.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":XR(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:$R(c)&&typeof a!="function"&&typeof a!="symbol"&&t.push(ia,Ke(c),ec,Ke(Bn(a)),nl)}return t.push(oa),Vh(t,s,o),o}}var dU=ye("</"),fU=ye(">"),hU=ye('<template id="'),pU=ye('"></template>'),gU=ye("<!--$-->"),mU=ye('<!--$?--><template id="'),vU=ye('"></template>'),CU=ye("<!--$!-->"),yU=ye("<!--/$-->"),xU=ye("<template"),IU=ye('"'),bU=ye(' data-dgst="');ye(' data-msg="');ye(' data-stck="');var AU=ye("></template>");function Iw(t,e,n){if(_e(t,mU),n===null)throw Error(Xe(395));return _e(t,n),Mt(t,vU)}var wU=ye('<div hidden id="'),SU=ye('">'),kU=ye("</div>"),EU=ye('<svg aria-hidden="true" style="display:none" id="'),TU=ye('">'),RU=ye("</svg>"),_U=ye('<math aria-hidden="true" style="display:none" id="'),DU=ye('">'),PU=ye("</math>"),NU=ye('<table hidden id="'),BU=ye('">'),OU=ye("</table>"),FU=ye('<table hidden><tbody id="'),MU=ye('">'),LU=ye("</tbody></table>"),UU=ye('<table hidden><tr id="'),VU=ye('">'),GU=ye("</tr></table>"),WU=ye('<table hidden><colgroup id="'),jU=ye('">'),zU=ye("</colgroup></table>");function HU(t,e,n,r){switch(n.insertionMode){case 0:case 1:return _e(t,wU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,SU);case 2:return _e(t,EU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,TU);case 3:return _e(t,_U),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,DU);case 4:return _e(t,NU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,BU);case 5:return _e(t,FU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,MU);case 6:return _e(t,UU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,VU);case 7:return _e(t,WU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,jU);default:throw Error(Xe(397))}}function ZU(t,e){switch(e.insertionMode){case 0:case 1:return Mt(t,kU);case 2:return Mt(t,RU);case 3:return Mt(t,PU);case 4:return Mt(t,OU);case 5:return Mt(t,LU);case 6:return Mt(t,GU);case 7:return Mt(t,zU);default:throw Error(Xe(397))}}var $U=ye('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),XU=ye('$RS("'),KU=ye('","'),JU=ye('")<\/script>'),YU=ye('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),qU=ye('$RC("'),QU=ye('","'),eV=ye('")<\/script>'),tV=ye('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),nV=ye('$RX("'),rV=ye('"'),iV=ye(")<\/script>"),wm=ye(","),oV=/[<\u2028\u2029]/g;function Sm(t){return JSON.stringify(t).replace(oV,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var bd=Object.assign,sV=Symbol.for("react.element"),KR=Symbol.for("react.portal"),JR=Symbol.for("react.fragment"),YR=Symbol.for("react.strict_mode"),qR=Symbol.for("react.profiler"),QR=Symbol.for("react.provider"),e_=Symbol.for("react.context"),t_=Symbol.for("react.forward_ref"),n_=Symbol.for("react.suspense"),r_=Symbol.for("react.suspense_list"),i_=Symbol.for("react.memo"),nx=Symbol.for("react.lazy"),aV=Symbol.for("react.scope"),lV=Symbol.for("react.debug_trace_mode"),cV=Symbol.for("react.legacy_hidden"),uV=Symbol.for("react.default_value"),bw=Symbol.iterator;function kC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case JR:return"Fragment";case KR:return"Portal";case qR:return"Profiler";case YR:return"StrictMode";case n_:return"Suspense";case r_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case e_:return(t.displayName||"Context")+".Consumer";case QR:return(t._context.displayName||"Context")+".Provider";case t_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case i_:return e=t.displayName||null,e!==null?e:kC(t.type)||"Memo";case nx:e=t._payload,t=t._init;try{return kC(t(e))}catch{}}return null}var o_={};function Aw(t,e){if(t=t.contextTypes,!t)return o_;var n={},r;for(r in t)n[r]=e[r];return n}var ul=null;function Wp(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Xe(401))}else{if(n===null)throw Error(Xe(401));Wp(t,n)}e.context._currentValue=e.value}}function s_(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&s_(t)}function a_(t){var e=t.parent;e!==null&&a_(e),t.context._currentValue=t.value}function l_(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(Xe(402));t.depth===e.depth?Wp(t,e):l_(t,e)}function c_(t,e){var n=e.parent;if(n===null)throw Error(Xe(402));t.depth===n.depth?Wp(t,n):c_(t,n),e.context._currentValue=e.value}function Z0(t){var e=ul;e!==t&&(e===null?a_(t):t===null?s_(e):e.depth===t.depth?Wp(e,t):e.depth>t.depth?l_(e,t):c_(e,t),ul=t)}var ww={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function Sw(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=ww,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:bd({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&ww.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=bd({},o,a)):bd(o,a))}t.state=o}else o.queue=null}var dV={id:1,overflow:""};function EC(t,e,n){var r=t.id;t=t.overflow;var i=32-Gh(r)-1;r&=~(1<<i),n+=1;var o=32-Gh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-Gh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var Gh=Math.clz32?Math.clz32:pV,fV=Math.log,hV=Math.LN2;function pV(t){return t>>>=0,t===0?32:31-(fV(t)/hV|0)|0}function gV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mV=typeof Object.is=="function"?Object.is:gV,Ls=null,rx=null,Wh=null,Tt=null,id=!1,$0=!1,qd=0,ma=null,jp=0;function rl(){if(Ls===null)throw Error(Xe(321));return Ls}function kw(){if(0<jp)throw Error(Xe(312));return{memoizedState:null,queue:null,next:null}}function ix(){return Tt===null?Wh===null?(id=!1,Wh=Tt=kw()):(id=!0,Tt=Wh):Tt.next===null?(id=!1,Tt=Tt.next=kw()):(id=!0,Tt=Tt.next),Tt}function ox(){rx=Ls=null,$0=!1,Wh=null,jp=0,Tt=ma=null}function u_(t,e){return typeof e=="function"?e(t):e}function Ew(t,e,n){if(Ls=rl(),Tt=ix(),id){var r=Tt.queue;if(e=r.dispatch,ma!==null&&(n=ma.get(r),n!==void 0)){ma.delete(r),r=Tt.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return Tt.memoizedState=r,[r,e]}return[Tt.memoizedState,e]}return t=t===u_?typeof e=="function"?e():e:n!==void 0?n(e):e,Tt.memoizedState=t,t=Tt.queue={last:null,dispatch:null},t=t.dispatch=vV.bind(null,Ls,t),[Tt.memoizedState,t]}function Tw(t,e){if(Ls=rl(),Tt=ix(),e=e===void 0?null:e,Tt!==null){var n=Tt.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!mV(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),Tt.memoizedState=[t,e],t}function vV(t,e,n){if(25<=jp)throw Error(Xe(301));if(t===Ls)if($0=!0,t={action:n,next:null},ma===null&&(ma=new Map),n=ma.get(e),n===void 0)ma.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function CV(){throw Error(Xe(394))}function ah(){}var Rw={readContext:function(t){return t._currentValue},useContext:function(t){return rl(),t._currentValue},useMemo:Tw,useReducer:Ew,useRef:function(t){Ls=rl(),Tt=ix();var e=Tt.memoizedState;return e===null?(t={current:t},Tt.memoizedState=t):e},useState:function(t){return Ew(u_,t)},useInsertionEffect:ah,useLayoutEffect:function(){},useCallback:function(t,e){return Tw(function(){return t},e)},useImperativeHandle:ah,useEffect:ah,useDebugValue:ah,useDeferredValue:function(t){return rl(),t},useTransition:function(){return rl(),[!1,CV]},useId:function(){var t=rx.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-Gh(t)-1)).toString(32)+e;var n=jh;if(n===null)throw Error(Xe(404));return e=qd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return rl(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Xe(407));return n()}},jh=null,km=zR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function yV(t){return console.error(t),null}function od(){}function xV(t,e,n,r,i,o,s,a,l){var c=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?yV:i,onAllReady:o===void 0?od:o,onShellReady:s===void 0?od:s,onShellError:a===void 0?od:a,onFatalError:l===void 0?od:l},n=X0(e,0,null,n,!1,!1),n.parentFlushed=!0,t=sx(e,t,null,n,u,o_,null,dV),c.push(t),e}function sx(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var c=t.pingedTasks;c.push(l),c.length===1&&h_(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function X0(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Qd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function K0(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,ZR(t.destination,e)):(t.status=1,t.fatalError=e)}function _w(t,e,n,r,i){for(Ls={},rx=e,qd=0,t=n(r,i);$0;)$0=!1,qd=0,jp+=1,Tt=null,t=n(r,i);return ox(),t}function Dw(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(Xe(108,kC(r)||"Unknown",a));r=bd({},s,n)}e.legacyContext=r,Zr(t,e,i),e.legacyContext=s}else Zr(t,e,i)}function Pw(t,e){if(t&&t.defaultProps){e=bd({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function TC(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=Aw(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue:i),Sw(o,n,r,i),Dw(t,e,o,n)}else{o=Aw(n,e.legacyContext),i=_w(t,e,n,r,o);var s=qd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)Sw(i,n,r,o),Dw(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=EC(r,1,0);try{Zr(t,e,i)}finally{e.treeContext=r}}else Zr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=uU(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=iU(s,n,r),RC(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(dU,Ke(n),fU)}i.lastPushedText=!1}else{switch(n){case cV:case lV:case YR:case qR:case JR:Zr(t,e,r.children);return;case r_:Zr(t,e,r.children);return;case aV:throw Error(Xe(343));case n_:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=X0(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=X0(t,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=c;try{if(RC(t,e,r),c.lastPushedText&&c.textEmbedded&&c.chunks.push(tx),c.status=1,J0(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=Qd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=sx(t,o,n,l,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case t_:if(r=_w(t,e,n.render,r,i),qd!==0){n=e.treeContext,e.treeContext=EC(n,1,0);try{Zr(t,e,r)}finally{e.treeContext=n}}else Zr(t,e,r);return;case i_:n=n.type,r=Pw(n,r),TC(t,e,n,r,i);return;case QR:if(i=r.children,n=n._context,r=r.value,o=n._currentValue,n._currentValue=r,s=ul,ul=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Zr(t,e,i),t=ul,t===null)throw Error(Xe(403));r=t.parentValue,t.context._currentValue=r===uV?t.context._defaultValue:r,t=ul=t.parent,e.context=t;return;case e_:r=r.children,r=r(n._currentValue),Zr(t,e,r);return;case nx:i=n._init,n=i(n._payload),r=Pw(n,r),TC(t,e,n,r,void 0);return}throw Error(Xe(130,n==null?n:typeof n,""))}}function Zr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case sV:TC(t,e,n.type,n.props,n.ref);return;case KR:throw Error(Xe(257));case nx:var r=n._init;n=r(n._payload),Zr(t,e,n);return}if(SC(n)){Nw(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=bw&&n[bw]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);Nw(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(Xe(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=gw(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=gw(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function Nw(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=EC(o,r,i);try{RC(t,e,n[i])}finally{e.treeContext=o}}}function RC(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Zr(t,e,n)}catch(l){if(ox(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=e.blockedSegment,a=X0(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=sx(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,Z0(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,Z0(o),l}}function IV(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,f_(this,e,t)}function d_(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(Xe(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return d_(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function J0(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&J0(t,n)}else t.completedSegments.push(e)}function f_(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(Xe(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=od,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&J0(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(IV,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(J0(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function h_(t){if(t.status!==2){var e=ul,n=km.current;km.current=Rw;var r=jh;jh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,l=s.blockedSegment;if(l.status===0){Z0(s.context);try{Zr(a,s,s.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(tx),s.abortSet.delete(s),l.status=1,f_(a,s.blockedBoundary,l)}catch(p){if(ox(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=Qd(a,d);if(u===null?K0(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&ax(t,t.destination)}catch(p){Qd(t,p),K0(t,p)}finally{jh=r,km.current=n,n===Rw&&Z0(e)}}}function lh(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,_e(e,hU),_e(e,t.placeholderPrefix),t=Ke(r.toString(16)),_e(e,t),Mt(e,pU);case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)_e(e,r[o]);i=zp(t,e,i)}for(;o<r.length-1;o++)_e(e,r[o]);return o<r.length&&(i=Mt(e,r[o])),i;default:throw Error(Xe(390))}}function zp(t,e,n){var r=n.boundary;if(r===null)return lh(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,Mt(e,CU),_e(e,xU),r&&(_e(e,bU),_e(e,Ke(Bn(r))),_e(e,IU)),Mt(e,AU),lh(t,e,n);else if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;i=ye(i.boundaryPrefix+o.toString(16)),r=r.id=i,Iw(e,t.responseState,r),lh(t,e,n)}else if(r.byteSize>t.progressiveChunkSize)r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),Iw(e,t.responseState,r.id),lh(t,e,n);else{if(Mt(e,gU),n=r.completedSegments,n.length!==1)throw Error(Xe(391));zp(t,e,n[0])}return Mt(e,yU)}function Bw(t,e,n){return HU(e,t.responseState,n.formatContext,n.id),zp(t,e,n),ZU(e,n.formatContext)}function Ow(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)p_(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,_e(e,t.startInlineScript),t.sentCompleteBoundaryFunction?_e(e,qU):(t.sentCompleteBoundaryFunction=!0,_e(e,YU)),r===null)throw Error(Xe(395));return n=Ke(n.toString(16)),_e(e,r),_e(e,QU),_e(e,t.segmentPrefix),_e(e,n),Mt(e,eV)}function p_(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Xe(392));return Bw(t,e,r)}return Bw(t,e,r),t=t.responseState,_e(e,t.startInlineScript),t.sentCompleteSegmentFunction?_e(e,XU):(t.sentCompleteSegmentFunction=!0,_e(e,$U)),_e(e,t.segmentPrefix),i=Ke(i.toString(16)),_e(e,i),_e(e,KU),_e(e,t.placeholderPrefix),_e(e,i),Mt(e,JU)}function ax(t,e){zr=new Uint8Array(512),Hr=0;try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){zp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)_e(e,r[n]);n<r.length&&Mt(e,r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(_e(r,a.startInlineScript),a.sentClientRenderFunction?_e(r,nV):(a.sentClientRenderFunction=!0,_e(r,tV)),l===null)throw Error(Xe(395));_e(r,l),_e(r,rV),(c||u||d)&&(_e(r,wm),_e(r,Ke(Sm(c||"")))),(u||d)&&(_e(r,wm),_e(r,Ke(Sm(u||"")))),d&&(_e(r,wm),_e(r,Ke(Sm(d)))),Mt(r,iV)}i.splice(0,o);var f=t.completedBoundaries;for(o=0;o<f.length;o++)Ow(t,e,f[o]);f.splice(0,o),dw(e),zr=new Uint8Array(512),Hr=0;var h=t.partialBoundaries;for(o=0;o<h.length;o++){var p=h[o];e:{i=t,s=e;var g=p.completedSegments;for(a=0;a<g.length;a++)if(!p_(i,s,p,g[a])){a++,g.splice(0,a);var C=!1;break e}g.splice(0,a),C=!0}if(!C){t.destination=null,o++,h.splice(0,o);return}}h.splice(0,o);var v=t.completedBoundaries;for(o=0;o<v.length;o++)Ow(t,e,v[o]);v.splice(0,o)}finally{dw(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function Fw(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return d_(r,t,e)}),n.clear(),t.destination!==null&&ax(t,t.destination)}catch(r){Qd(t,r),K0(t,r)}}q1.renderToReadableStream=function(t,e){return new Promise(function(n,r){var i,o,s=new Promise(function(u,d){o=u,i=d}),a=xV(t,nU(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),rU(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,ZR(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{ax(a,d)}catch(f){Qd(a,f),K0(a,f)}}},cancel:function(){Fw(a)}},{highWaterMark:0});u.allReady=s,n(u)},function(u){s.catch(function(){}),r(u)},i);if(e&&e.signal){var l=e.signal,c=function(){Fw(a,l.reason),l.removeEventListener("abort",c)};l.addEventListener("abort",c)}h_(a)})};q1.version="18.3.1";var hu,g_;hu=fu,g_=q1;Oa.version=hu.version;Oa.renderToString=hu.renderToString;Oa.renderToStaticMarkup=hu.renderToStaticMarkup;Oa.renderToNodeStream=hu.renderToNodeStream;Oa.renderToStaticNodeStream=hu.renderToStaticNodeStream;Oa.renderToReadableStream=g_.renderToReadableStream;/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:m_,setPrototypeOf:Mw,isFrozen:bV,getPrototypeOf:AV,getOwnPropertyDescriptor:wV}=Object;let{freeze:hr,seal:xi,create:v_}=Object,{apply:_C,construct:DC}=typeof Reflect<"u"&&Reflect;hr||(hr=function(e){return e});xi||(xi=function(e){return e});_C||(_C=function(e,n,r){return e.apply(n,r)});DC||(DC=function(e,n){return new e(...n)});const ch=pr(Array.prototype.forEach),SV=pr(Array.prototype.lastIndexOf),Lw=pr(Array.prototype.pop),Fu=pr(Array.prototype.push),kV=pr(Array.prototype.splice),zh=pr(String.prototype.toLowerCase),Em=pr(String.prototype.toString),Uw=pr(String.prototype.match),Mu=pr(String.prototype.replace),EV=pr(String.prototype.indexOf),TV=pr(String.prototype.trim),Si=pr(Object.prototype.hasOwnProperty),tr=pr(RegExp.prototype.test),Lu=RV(TypeError);function pr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return _C(t,e,r)}}function RV(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return DC(t,n)}}function Ye(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zh;Mw&&Mw(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(bV(e)||(e[r]=o),i=o)}t[i]=!0}return t}function _V(t){for(let e=0;e<t.length;e++)Si(t,e)||(t[e]=null);return t}function qa(t){const e=v_(null);for(const[n,r]of m_(t))Si(t,n)&&(Array.isArray(r)?e[n]=_V(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=qa(r):e[n]=r);return e}function Uu(t,e){for(;t!==null;){const r=wV(t,e);if(r){if(r.get)return pr(r.get);if(typeof r.value=="function")return pr(r.value)}t=AV(t)}function n(){return null}return n}const Vw=hr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Tm=hr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Rm=hr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),DV=hr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_m=hr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),PV=hr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Gw=hr(["#text"]),Ww=hr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Dm=hr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),jw=hr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),uh=hr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),NV=xi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),BV=xi(/<%[\w\W]*|[\w\W]*%>/gm),OV=xi(/\$\{[\w\W]*/gm),FV=xi(/^data-[\-\w.\u00B7-\uFFFF]+$/),MV=xi(/^aria-[\-\w]+$/),C_=xi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),LV=xi(/^(?:\w+script|data):/i),UV=xi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),y_=xi(/^html$/i),VV=xi(/^[a-z][.\w]*(-[.\w]+)+$/i);var zw=Object.freeze({__proto__:null,ARIA_ATTR:MV,ATTR_WHITESPACE:UV,CUSTOM_ELEMENT:VV,DATA_ATTR:FV,DOCTYPE_NAME:y_,ERB_EXPR:BV,IS_ALLOWED_URI:C_,IS_SCRIPT_OR_DATA:LV,MUSTACHE_EXPR:NV,TMPLIT_EXPR:OV});const Vu={element:1,text:3,progressingInstruction:7,comment:8,document:9},GV=function(){return typeof window>"u"?null:window},WV=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Hw=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function x_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:GV();const e=pe=>x_(pe);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Vu.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:h}=t,p=l.prototype,g=Uu(p,"cloneNode"),C=Uu(p,"remove"),v=Uu(p,"nextSibling"),m=Uu(p,"childNodes"),y=Uu(p,"parentNode");if(typeof s=="function"){const pe=n.createElement("template");pe.content&&pe.content.ownerDocument&&(n=pe.content.ownerDocument)}let x,b="";const{implementation:E,createNodeIterator:A,createDocumentFragment:k,getElementsByTagName:D}=n,{importNode:T}=r;let R=Hw();e.isSupported=typeof m_=="function"&&typeof y=="function"&&E&&E.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:P,ERB_EXPR:L,TMPLIT_EXPR:G,DATA_ATTR:Z,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:ie,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:Q}=zw;let{IS_ALLOWED_URI:ne}=zw,O=null;const j=Ye({},[...Vw,...Tm,...Rm,..._m,...Gw]);let J=null;const ee=Ye({},[...Ww,...Dm,...jw,...uh]);let se=Object.seal(v_(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),me=null,Be=null,ae=!0,Pt=!0,Gt=!1,fn=!0,ze=!1,at=!0,ot=!1,he=!1,Ce=!1,Ue=!1,Le=!1,Pe=!1,$e=!0,st=!1;const Qe="user-content-";let Wt=!0,jt=!1,wt={},sn=null;const _=Ye({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let I=null;const w=Ye({},["audio","video","img","source","image","track"]);let B=null;const W=Ye({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Y="http://www.w3.org/1998/Math/MathML",te="http://www.w3.org/2000/svg",Ne="http://www.w3.org/1999/xhtml";let tt=Ne,lt=!1,ht=null;const nt=Ye({},[Y,te,Ne],Em);let bi=Ye({},["mi","mo","mn","ms","mtext"]),io=Ye({},["annotation-xml"]);const $a=Ye({},["title","style","font","a","script"]);let ii=null;const Iu=["application/xhtml+xml","text/html"],zl="text/html";let Jt=null,oi=null;const $s=n.createElement("form"),$o=function(U){return U instanceof RegExp||U instanceof Function},Xs=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(oi&&oi===U)){if((!U||typeof U!="object")&&(U={}),U=qa(U),ii=Iu.indexOf(U.PARSER_MEDIA_TYPE)===-1?zl:U.PARSER_MEDIA_TYPE,Jt=ii==="application/xhtml+xml"?Em:zh,O=Si(U,"ALLOWED_TAGS")?Ye({},U.ALLOWED_TAGS,Jt):j,J=Si(U,"ALLOWED_ATTR")?Ye({},U.ALLOWED_ATTR,Jt):ee,ht=Si(U,"ALLOWED_NAMESPACES")?Ye({},U.ALLOWED_NAMESPACES,Em):nt,B=Si(U,"ADD_URI_SAFE_ATTR")?Ye(qa(W),U.ADD_URI_SAFE_ATTR,Jt):W,I=Si(U,"ADD_DATA_URI_TAGS")?Ye(qa(w),U.ADD_DATA_URI_TAGS,Jt):w,sn=Si(U,"FORBID_CONTENTS")?Ye({},U.FORBID_CONTENTS,Jt):_,me=Si(U,"FORBID_TAGS")?Ye({},U.FORBID_TAGS,Jt):{},Be=Si(U,"FORBID_ATTR")?Ye({},U.FORBID_ATTR,Jt):{},wt=Si(U,"USE_PROFILES")?U.USE_PROFILES:!1,ae=U.ALLOW_ARIA_ATTR!==!1,Pt=U.ALLOW_DATA_ATTR!==!1,Gt=U.ALLOW_UNKNOWN_PROTOCOLS||!1,fn=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ze=U.SAFE_FOR_TEMPLATES||!1,at=U.SAFE_FOR_XML!==!1,ot=U.WHOLE_DOCUMENT||!1,Ue=U.RETURN_DOM||!1,Le=U.RETURN_DOM_FRAGMENT||!1,Pe=U.RETURN_TRUSTED_TYPE||!1,Ce=U.FORCE_BODY||!1,$e=U.SANITIZE_DOM!==!1,st=U.SANITIZE_NAMED_PROPS||!1,Wt=U.KEEP_CONTENT!==!1,jt=U.IN_PLACE||!1,ne=U.ALLOWED_URI_REGEXP||C_,tt=U.NAMESPACE||Ne,bi=U.MATHML_TEXT_INTEGRATION_POINTS||bi,io=U.HTML_INTEGRATION_POINTS||io,se=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&$o(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&$o(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ze&&(Pt=!1),Le&&(Ue=!0),wt&&(O=Ye({},Gw),J=[],wt.html===!0&&(Ye(O,Vw),Ye(J,Ww)),wt.svg===!0&&(Ye(O,Tm),Ye(J,Dm),Ye(J,uh)),wt.svgFilters===!0&&(Ye(O,Rm),Ye(J,Dm),Ye(J,uh)),wt.mathMl===!0&&(Ye(O,_m),Ye(J,jw),Ye(J,uh))),U.ADD_TAGS&&(O===j&&(O=qa(O)),Ye(O,U.ADD_TAGS,Jt)),U.ADD_ATTR&&(J===ee&&(J=qa(J)),Ye(J,U.ADD_ATTR,Jt)),U.ADD_URI_SAFE_ATTR&&Ye(B,U.ADD_URI_SAFE_ATTR,Jt),U.FORBID_CONTENTS&&(sn===_&&(sn=qa(sn)),Ye(sn,U.FORBID_CONTENTS,Jt)),Wt&&(O["#text"]=!0),ot&&Ye(O,["html","head","body"]),O.table&&(Ye(O,["tbody"]),delete me.tbody),U.TRUSTED_TYPES_POLICY){if(typeof U.TRUSTED_TYPES_POLICY.createHTML!="function")throw Lu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof U.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Lu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=U.TRUSTED_TYPES_POLICY,b=x.createHTML("")}else x===void 0&&(x=WV(h,i)),x!==null&&typeof b=="string"&&(b=x.createHTML(""));hr&&hr(U),oi=U}},Hl=Ye({},[...Tm,...Rm,...DV]),V=Ye({},[..._m,...PV]),H=function(U){let oe=y(U);(!oe||!oe.tagName)&&(oe={namespaceURI:tt,tagName:"template"});const Ae=zh(U.tagName),pt=zh(oe.tagName);return ht[U.namespaceURI]?U.namespaceURI===te?oe.namespaceURI===Ne?Ae==="svg":oe.namespaceURI===Y?Ae==="svg"&&(pt==="annotation-xml"||bi[pt]):!!Hl[Ae]:U.namespaceURI===Y?oe.namespaceURI===Ne?Ae==="math":oe.namespaceURI===te?Ae==="math"&&io[pt]:!!V[Ae]:U.namespaceURI===Ne?oe.namespaceURI===te&&!io[pt]||oe.namespaceURI===Y&&!bi[pt]?!1:!V[Ae]&&($a[Ae]||!Hl[Ae]):!!(ii==="application/xhtml+xml"&&ht[U.namespaceURI]):!1},K=function(U){Fu(e.removed,{element:U});try{y(U).removeChild(U)}catch{C(U)}},ce=function(U,oe){try{Fu(e.removed,{attribute:oe.getAttributeNode(U),from:oe})}catch{Fu(e.removed,{attribute:null,from:oe})}if(oe.removeAttribute(U),U==="is")if(Ue||Le)try{K(oe)}catch{}else try{oe.setAttribute(U,"")}catch{}},ge=function(U){let oe=null,Ae=null;if(Ce)U="<remove></remove>"+U;else{const xt=Uw(U,/^[\r\n\t ]+/);Ae=xt&&xt[0]}ii==="application/xhtml+xml"&&tt===Ne&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");const pt=x?x.createHTML(U):U;if(tt===Ne)try{oe=new f().parseFromString(pt,ii)}catch{}if(!oe||!oe.documentElement){oe=E.createDocument(tt,"template",null);try{oe.documentElement.innerHTML=lt?b:pt}catch{}}const St=oe.body||oe.documentElement;return U&&Ae&&St.insertBefore(n.createTextNode(Ae),St.childNodes[0]||null),tt===Ne?D.call(oe,ot?"html":"body")[0]:ot?oe.documentElement:St},De=function(U){return A.call(U.ownerDocument||U,U,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Fe=function(U){return U instanceof d&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof u)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},ke=function(U){return typeof a=="function"&&U instanceof a};function Ie(pe,U,oe){ch(pe,Ae=>{Ae.call(e,U,oe,oi)})}const be=function(U){let oe=null;if(Ie(R.beforeSanitizeElements,U,null),Fe(U))return K(U),!0;const Ae=Jt(U.nodeName);if(Ie(R.uponSanitizeElement,U,{tagName:Ae,allowedTags:O}),U.hasChildNodes()&&!ke(U.firstElementChild)&&tr(/<[/\w!]/g,U.innerHTML)&&tr(/<[/\w!]/g,U.textContent)||U.nodeType===Vu.progressingInstruction||at&&U.nodeType===Vu.comment&&tr(/<[/\w]/g,U.data))return K(U),!0;if(!O[Ae]||me[Ae]){if(!me[Ae]&&Ve(Ae)&&(se.tagNameCheck instanceof RegExp&&tr(se.tagNameCheck,Ae)||se.tagNameCheck instanceof Function&&se.tagNameCheck(Ae)))return!1;if(Wt&&!sn[Ae]){const pt=y(U)||U.parentNode,St=m(U)||U.childNodes;if(St&&pt){const xt=St.length;for(let An=xt-1;An>=0;--An){const zn=g(St[An],!0);zn.__removalCount=(U.__removalCount||0)+1,pt.insertBefore(zn,v(U))}}}return K(U),!0}return U instanceof l&&!H(U)||(Ae==="noscript"||Ae==="noembed"||Ae==="noframes")&&tr(/<\/no(script|embed|frames)/i,U.innerHTML)?(K(U),!0):(ze&&U.nodeType===Vu.text&&(oe=U.textContent,ch([P,L,G],pt=>{oe=Mu(oe,pt," ")}),U.textContent!==oe&&(Fu(e.removed,{element:U.cloneNode()}),U.textContent=oe)),Ie(R.afterSanitizeElements,U,null),!1)},Re=function(U,oe,Ae){if($e&&(oe==="id"||oe==="name")&&(Ae in n||Ae in $s))return!1;if(!(Pt&&!Be[oe]&&tr(Z,oe))){if(!(ae&&tr(q,oe))){if(!J[oe]||Be[oe]){if(!(Ve(U)&&(se.tagNameCheck instanceof RegExp&&tr(se.tagNameCheck,U)||se.tagNameCheck instanceof Function&&se.tagNameCheck(U))&&(se.attributeNameCheck instanceof RegExp&&tr(se.attributeNameCheck,oe)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(oe))||oe==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&tr(se.tagNameCheck,Ae)||se.tagNameCheck instanceof Function&&se.tagNameCheck(Ae))))return!1}else if(!B[oe]){if(!tr(ne,Mu(Ae,$,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&U!=="script"&&EV(Ae,"data:")===0&&I[U])){if(!(Gt&&!tr(ie,Mu(Ae,$,"")))){if(Ae)return!1}}}}}}return!0},Ve=function(U){return U!=="annotation-xml"&&Uw(U,Q)},Je=function(U){Ie(R.beforeSanitizeAttributes,U,null);const{attributes:oe}=U;if(!oe||Fe(U))return;const Ae={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:J,forceKeepAttr:void 0};let pt=oe.length;for(;pt--;){const St=oe[pt],{name:xt,namespaceURI:An,value:zn}=St,Or=Jt(xt);let an=xt==="value"?zn:TV(zn);if(Ae.attrName=Or,Ae.attrValue=an,Ae.keepAttr=!0,Ae.forceKeepAttr=void 0,Ie(R.uponSanitizeAttribute,U,Ae),an=Ae.attrValue,st&&(Or==="id"||Or==="name")&&(ce(xt,U),an=Qe+an),at&&tr(/((--!?|])>)|<\/(style|title)/i,an)){ce(xt,U);continue}if(Ae.forceKeepAttr||(ce(xt,U),!Ae.keepAttr))continue;if(!fn&&tr(/\/>/i,an)){ce(xt,U);continue}ze&&ch([P,L,G],rt=>{an=Mu(an,rt," ")});const Xa=Jt(U.nodeName);if(Re(Xa,Or,an)){if(x&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!An)switch(h.getAttributeType(Xa,Or)){case"TrustedHTML":{an=x.createHTML(an);break}case"TrustedScriptURL":{an=x.createScriptURL(an);break}}try{An?U.setAttributeNS(An,xt,an):U.setAttribute(xt,an),Fe(U)?K(U):Lw(e.removed)}catch{}}}Ie(R.afterSanitizeAttributes,U,null)},hn=function pe(U){let oe=null;const Ae=De(U);for(Ie(R.beforeSanitizeShadowDOM,U,null);oe=Ae.nextNode();)Ie(R.uponSanitizeShadowNode,oe,null),be(oe),Je(oe),oe.content instanceof o&&pe(oe.content);Ie(R.afterSanitizeShadowDOM,U,null)};return e.sanitize=function(pe){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe=null,Ae=null,pt=null,St=null;if(lt=!pe,lt&&(pe="<!-->"),typeof pe!="string"&&!ke(pe))if(typeof pe.toString=="function"){if(pe=pe.toString(),typeof pe!="string")throw Lu("dirty is not a string, aborting")}else throw Lu("toString is not a function");if(!e.isSupported)return pe;if(he||Xs(U),e.removed=[],typeof pe=="string"&&(jt=!1),jt){if(pe.nodeName){const zn=Jt(pe.nodeName);if(!O[zn]||me[zn])throw Lu("root node is forbidden and cannot be sanitized in-place")}}else if(pe instanceof a)oe=ge("<!---->"),Ae=oe.ownerDocument.importNode(pe,!0),Ae.nodeType===Vu.element&&Ae.nodeName==="BODY"||Ae.nodeName==="HTML"?oe=Ae:oe.appendChild(Ae);else{if(!Ue&&!ze&&!ot&&pe.indexOf("<")===-1)return x&&Pe?x.createHTML(pe):pe;if(oe=ge(pe),!oe)return Ue?null:Pe?b:""}oe&&Ce&&K(oe.firstChild);const xt=De(jt?pe:oe);for(;pt=xt.nextNode();)be(pt),Je(pt),pt.content instanceof o&&hn(pt.content);if(jt)return pe;if(Ue){if(Le)for(St=k.call(oe.ownerDocument);oe.firstChild;)St.appendChild(oe.firstChild);else St=oe;return(J.shadowroot||J.shadowrootmode)&&(St=T.call(r,St,!0)),St}let An=ot?oe.outerHTML:oe.innerHTML;return ot&&O["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&tr(y_,oe.ownerDocument.doctype.name)&&(An="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+An),ze&&ch([P,L,G],zn=>{An=Mu(An,zn," ")}),x&&Pe?x.createHTML(An):An},e.setConfig=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xs(pe),he=!0},e.clearConfig=function(){oi=null,he=!1},e.isValidAttribute=function(pe,U,oe){oi||Xs({});const Ae=Jt(pe),pt=Jt(U);return Re(Ae,pt,oe)},e.addHook=function(pe,U){typeof U=="function"&&Fu(R[pe],U)},e.removeHook=function(pe,U){if(U!==void 0){const oe=SV(R[pe],U);return oe===-1?void 0:kV(R[pe],oe,1)[0]}return Lw(R[pe])},e.removeHooks=function(pe){R[pe]=[]},e.removeAllHooks=function(){R=Hw()},e}var jV=x_();function zV(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}function PC(t,e){return Array(e+1).join(t)}function HV(t){return t.replace(/^\n*/,"")}function ZV(t){for(var e=t.length;e>0&&t[e-1]===`
`;)e--;return t.substring(0,e)}var $V=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function lx(t){return cx(t,$V)}var I_=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function b_(t){return cx(t,I_)}function XV(t){return w_(t,I_)}var A_=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function KV(t){return cx(t,A_)}function JV(t){return w_(t,A_)}function cx(t,e){return e.indexOf(t.nodeName)>=0}function w_(t,e){return t.getElementsByTagName&&e.some(function(n){return t.getElementsByTagName(n).length})}var er={};er.paragraph={filter:"p",replacement:function(t){return`

`+t+`

`}};er.lineBreak={filter:"br",replacement:function(t,e,n){return n.br+`
`}};er.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(t,e,n){var r=Number(e.nodeName.charAt(1));if(n.headingStyle==="setext"&&r<3){var i=PC(r===1?"=":"-",t.length);return`

`+t+`
`+i+`

`}else return`

`+PC("#",r)+" "+t+`

`}};er.blockquote={filter:"blockquote",replacement:function(t){return t=t.replace(/^\n+|\n+$/g,""),t=t.replace(/^/gm,"> "),`

`+t+`

`}};er.list={filter:["ul","ol"],replacement:function(t,e){var n=e.parentNode;return n.nodeName==="LI"&&n.lastElementChild===e?`
`+t:`

`+t+`

`}};er.listItem={filter:"li",replacement:function(t,e,n){t=t.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=n.bulletListMarker+"   ",i=e.parentNode;if(i.nodeName==="OL"){var o=i.getAttribute("start"),s=Array.prototype.indexOf.call(i.children,e);r=(o?Number(o)+s:s+1)+".  "}return r+t+(e.nextSibling&&!/\n$/.test(t)?`
`:"")}};er.indentedCodeBlock={filter:function(t,e){return e.codeBlockStyle==="indented"&&t.nodeName==="PRE"&&t.firstChild&&t.firstChild.nodeName==="CODE"},replacement:function(t,e,n){return`

    `+e.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};er.fencedCodeBlock={filter:function(t,e){return e.codeBlockStyle==="fenced"&&t.nodeName==="PRE"&&t.firstChild&&t.firstChild.nodeName==="CODE"},replacement:function(t,e,n){for(var r=e.firstChild.getAttribute("class")||"",i=(r.match(/language-(\S+)/)||[null,""])[1],o=e.firstChild.textContent,s=n.fence.charAt(0),a=3,l=new RegExp("^"+s+"{3,}","gm"),c;c=l.exec(o);)c[0].length>=a&&(a=c[0].length+1);var u=PC(s,a);return`

`+u+i+`
`+o.replace(/\n$/,"")+`
`+u+`

`}};er.horizontalRule={filter:"hr",replacement:function(t,e,n){return`

`+n.hr+`

`}};er.inlineLink={filter:function(t,e){return e.linkStyle==="inlined"&&t.nodeName==="A"&&t.getAttribute("href")},replacement:function(t,e){var n=e.getAttribute("href");n&&(n=n.replace(/([()])/g,"\\$1"));var r=Y0(e.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+t+"]("+n+r+")"}};er.referenceLink={filter:function(t,e){return e.linkStyle==="referenced"&&t.nodeName==="A"&&t.getAttribute("href")},replacement:function(t,e,n){var r=e.getAttribute("href"),i=Y0(e.getAttribute("title"));i&&(i=' "'+i+'"');var o,s;switch(n.linkReferenceStyle){case"collapsed":o="["+t+"][]",s="["+t+"]: "+r+i;break;case"shortcut":o="["+t+"]",s="["+t+"]: "+r+i;break;default:var a=this.references.length+1;o="["+t+"]["+a+"]",s="["+a+"]: "+r+i}return this.references.push(s),o},references:[],append:function(t){var e="";return this.references.length&&(e=`

`+this.references.join(`
`)+`

`,this.references=[]),e}};er.emphasis={filter:["em","i"],replacement:function(t,e,n){return t.trim()?n.emDelimiter+t+n.emDelimiter:""}};er.strong={filter:["strong","b"],replacement:function(t,e,n){return t.trim()?n.strongDelimiter+t+n.strongDelimiter:""}};er.code={filter:function(t){var e=t.previousSibling||t.nextSibling,n=t.parentNode.nodeName==="PRE"&&!e;return t.nodeName==="CODE"&&!n},replacement:function(t){if(!t)return"";t=t.replace(/\r?\n|\r/g," ");for(var e=/^`|^ .*?[^ ].* $|`$/.test(t)?" ":"",n="`",r=t.match(/`+/gm)||[];r.indexOf(n)!==-1;)n=n+"`";return n+e+t+e+n}};er.image={filter:"img",replacement:function(t,e){var n=Y0(e.getAttribute("alt")),r=e.getAttribute("src")||"",i=Y0(e.getAttribute("title")),o=i?' "'+i+'"':"";return r?"!["+n+"]("+r+o+")":""}};function Y0(t){return t?t.replace(/(\n+\s*)+/g,`
`):""}function S_(t){this.options=t,this._keep=[],this._remove=[],this.blankRule={replacement:t.blankReplacement},this.keepReplacement=t.keepReplacement,this.defaultRule={replacement:t.defaultReplacement},this.array=[];for(var e in t.rules)this.array.push(t.rules[e])}S_.prototype={add:function(t,e){this.array.unshift(e)},keep:function(t){this._keep.unshift({filter:t,replacement:this.keepReplacement})},remove:function(t){this._remove.unshift({filter:t,replacement:function(){return""}})},forNode:function(t){if(t.isBlank)return this.blankRule;var e;return(e=Pm(this.array,t,this.options))||(e=Pm(this._keep,t,this.options))||(e=Pm(this._remove,t,this.options))?e:this.defaultRule},forEach:function(t){for(var e=0;e<this.array.length;e++)t(this.array[e],e)}};function Pm(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];if(YV(i,e,n))return i}}function YV(t,e,n){var r=t.filter;if(typeof r=="string"){if(r===e.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(e.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(t,e,n))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function qV(t){var e=t.element,n=t.isBlock,r=t.isVoid,i=t.isPre||function(d){return d.nodeName==="PRE"};if(!(!e.firstChild||i(e))){for(var o=null,s=!1,a=null,l=Zw(a,e,i);l!==e;){if(l.nodeType===3||l.nodeType===4){var c=l.data.replace(/[ \r\n\t]+/g," ");if((!o||/ $/.test(o.data))&&!s&&c[0]===" "&&(c=c.substr(1)),!c){l=Nm(l);continue}l.data=c,o=l}else if(l.nodeType===1)n(l)||l.nodeName==="BR"?(o&&(o.data=o.data.replace(/ $/,"")),o=null,s=!1):r(l)||i(l)?(o=null,s=!0):o&&(s=!1);else{l=Nm(l);continue}var u=Zw(a,l,i);a=l,l=u}o&&(o.data=o.data.replace(/ $/,""),o.data||Nm(o))}}function Nm(t){var e=t.nextSibling||t.parentNode;return t.parentNode.removeChild(t),e}function Zw(t,e,n){return t&&t.parentNode===e||n(e)?e.nextSibling||e.parentNode:e.firstChild||e.nextSibling||e.parentNode}var ux=typeof window<"u"?window:{};function QV(){var t=ux.DOMParser,e=!1;try{new t().parseFromString("","text/html")&&(e=!0)}catch{}return e}function eG(){var t=function(){};return tG()?t.prototype.parseFromString=function(e){var n=new window.ActiveXObject("htmlfile");return n.designMode="on",n.open(),n.write(e),n.close(),n}:t.prototype.parseFromString=function(e){var n=document.implementation.createHTMLDocument("");return n.open(),n.write(e),n.close(),n},t}function tG(){var t=!1;try{document.implementation.createHTMLDocument("").open()}catch{ux.ActiveXObject&&(t=!0)}return t}var nG=QV()?ux.DOMParser:eG();function rG(t,e){var n;if(typeof t=="string"){var r=iG().parseFromString('<x-turndown id="turndown-root">'+t+"</x-turndown>","text/html");n=r.getElementById("turndown-root")}else n=t.cloneNode(!0);return qV({element:n,isBlock:lx,isVoid:b_,isPre:e.preformattedCode?oG:null}),n}var Bm;function iG(){return Bm=Bm||new nG,Bm}function oG(t){return t.nodeName==="PRE"||t.nodeName==="CODE"}function sG(t,e){return t.isBlock=lx(t),t.isCode=t.nodeName==="CODE"||t.parentNode.isCode,t.isBlank=aG(t),t.flankingWhitespace=lG(t,e),t}function aG(t){return!b_(t)&&!KV(t)&&/^\s*$/i.test(t.textContent)&&!XV(t)&&!JV(t)}function lG(t,e){if(t.isBlock||e.preformattedCode&&t.isCode)return{leading:"",trailing:""};var n=cG(t.textContent);return n.leadingAscii&&$w("left",t,e)&&(n.leading=n.leadingNonAscii),n.trailingAscii&&$w("right",t,e)&&(n.trailing=n.trailingNonAscii),{leading:n.leading,trailing:n.trailing}}function cG(t){var e=t.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:e[1],leadingAscii:e[2],leadingNonAscii:e[3],trailing:e[4],trailingNonAscii:e[5],trailingAscii:e[6]}}function $w(t,e,n){var r,i,o;return t==="left"?(r=e.previousSibling,i=/ $/):(r=e.nextSibling,i=/^ /),r&&(r.nodeType===3?o=i.test(r.nodeValue):n.preformattedCode&&r.nodeName==="CODE"?o=!1:r.nodeType===1&&!lx(r)&&(o=i.test(r.textContent))),o}var uG=Array.prototype.reduce,dG=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function q0(t){if(!(this instanceof q0))return new q0(t);var e={rules:er,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(n,r){return r.isBlock?`

`:""},keepReplacement:function(n,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(n,r){return r.isBlock?`

`+n+`

`:n}};this.options=zV({},e,t),this.rules=new S_(this.options)}q0.prototype={turndown:function(t){if(!pG(t))throw new TypeError(t+" is not a string, or an element/document/fragment node.");if(t==="")return"";var e=k_.call(this,new rG(t,this.options));return fG.call(this,e)},use:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.use(t[e]);else if(typeof t=="function")t(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(t,e){return this.rules.add(t,e),this},keep:function(t){return this.rules.keep(t),this},remove:function(t){return this.rules.remove(t),this},escape:function(t){return dG.reduce(function(e,n){return e.replace(n[0],n[1])},t)}};function k_(t){var e=this;return uG.call(t.childNodes,function(n,r){r=new sG(r,e.options);var i="";return r.nodeType===3?i=r.isCode?r.nodeValue:e.escape(r.nodeValue):r.nodeType===1&&(i=hG.call(e,r)),E_(n,i)},"")}function fG(t){var e=this;return this.rules.forEach(function(n){typeof n.append=="function"&&(t=E_(t,n.append(e.options)))}),t.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function hG(t){var e=this.rules.forNode(t),n=k_.call(this,t),r=t.flankingWhitespace;return(r.leading||r.trailing)&&(n=n.trim()),r.leading+e.replacement(n,t,this.options)+r.trailing}function E_(t,e){var n=ZV(t),r=HV(e),i=Math.max(t.length-n.length,e.length-r.length),o=`

`.substring(0,i);return n+o+r}function pG(t){return t!=null&&(typeof t=="string"||t.nodeType&&(t.nodeType===1||t.nodeType===9||t.nodeType===11))}const gG=2,Yo=class Yo extends We.Component{constructor(n){super(n);M(this,"outputRef",We.createRef());M(this,"messageKey",0);M(this,"turndownService",new q0({headingStyle:"atx",emDelimiter:"*"}));M(this,"saveOutput",()=>{const n=this.state.output.map(r=>We.isValidElement(r)&&r.props&&r.props.children?Oa.renderToStaticMarkup(r.props.children):"").filter(r=>r!=="");localStorage.setItem(Yo.LOCAL_STORAGE_KEY,JSON.stringify(n))});M(this,"loadOutput",()=>{const n=localStorage.getItem(Yo.LOCAL_STORAGE_KEY);if(n)try{return JSON.parse(n).map((i,o)=>We.createElement("div",{key:`loaded-${o}`,dangerouslySetInnerHTML:{__html:i}}))}catch(r){return console.error("Failed to parse saved output log:",r),localStorage.removeItem(Yo.LOCAL_STORAGE_KEY),[]}return[]});M(this,"addCommand",n=>{this.addToOutput([z.jsx("span",{className:"command","aria-live":"off",children:n})],!1)});M(this,"addError",n=>this.addToOutput([z.jsxs("h2",{children:[" Error: ",n.message]})]));M(this,"handleConnected",()=>this.addToOutput([z.jsx("h2",{children:" Connected"})]));M(this,"handleDisconnected",()=>{this.addToOutput([z.jsx("h2",{children:" Disconnected"})]),this.setState({sidebarVisible:!1})});M(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));M(this,"addCopyButtons",()=>{const n=this.outputRef.current;if(!n)return;n.querySelectorAll("blockquote:not(:has(.blockquote-copy-button))").forEach(i=>{const o=document.createElement("button");o.classList.add("blockquote-copy-button"),o.textContent="Copy",o.setAttribute("type","button"),window.getComputedStyle(i).position==="static"&&(i.style.position="relative"),i.appendChild(o)})});M(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});M(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;if(!n)return!1;const r=Math.ceil(n.scrollHeight-n.scrollTop),i=Math.ceil(n.clientHeight);return r<=i+gG});M(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});M(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&requestAnimationFrame(()=>{n.scrollTop=n.scrollHeight})});M(this,"handleMessage",n=>{if(!n)return;const r=l7(n,this.handleExitClick);this.addToOutput(r)});M(this,"handleHtml",n=>{const r=jV.sanitize(n),i=z.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i])});M(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});M(this,"handleDataTextClick",n=>{var s,a;const r=n.target,i=r.closest(".blockquote-copy-button");if(i instanceof HTMLButtonElement){n.preventDefault(),n.stopPropagation();const l=i.closest("blockquote");if(l){const c=l.cloneNode(!0),u=c.querySelector(".blockquote-copy-button");u&&u.remove();let d;if(l.dataset.contentType==="text/markdown"){const h=c.innerHTML;d=this.turndownService.turndown(h)}else d=c.textContent||"";navigator.clipboard.writeText(d.trim()).then(()=>{i.textContent="Copied!",i.classList.add("copied"),setTimeout(()=>{i.textContent="Copy",i.classList.remove("copied")},1500)}).catch(h=>{console.error("Failed to copy text: ",h),i.textContent="Error",setTimeout(()=>{i.textContent="Copy"},1500)})}return}const o=r.closest("a.command[data-text]");if(o instanceof HTMLAnchorElement){n.preventDefault();const l=o.dataset.text;l!=null&&(xd(l),(a=(s=this.props).focusInput)==null||a.call(s))}});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0}}getSnapshotBeforeUpdate(n,r){return this.outputRef.current?(this.outputRef.current,this.isScrolledToBottom()):null}componentDidUpdate(n,r,i){i&&this.scrollToBottom(),this.state.output.length>r.output.length&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState({newLinesCount:this.state.newLinesCount+(this.state.output.length-r.output.length)})),this.saveOutput(),this.addCopyButtons()}componentDidMount(){const{client:n}=this.props;n.on("message",this.handleMessage),n.on("html",this.handleHtml),n.on("connect",this.handleConnected),n.on("disconnect",this.handleDisconnected),n.on("error",this.addError),n.on("command",this.addCommand),n.on("userlist",this.handleUserList)}componentWillUnmount(){const{client:n}=this.props;n.removeListener("message",this.handleMessage),n.removeListener("html",this.handleHtml),n.removeListener("connect",this.handleConnected),n.removeListener("disconnect",this.handleDisconnected),n.removeListener("error",this.addError),n.removeListener("command",this.addCommand),n.removeListener("userlist",this.handleUserList)}sanitizeHtml(n){return new DOMParser().parseFromString(n,"text/html").body.textContent||""}addToOutput(n,r=!0){r&&n.forEach(i=>{if(We.isValidElement(i)){const o=Oa.renderToString(i),s=this.sanitizeHtml(o);jA(s)}else typeof i=="string"&&jA(i)}),this.setState(i=>{const o=n.map(l=>z.jsx("div",{children:l},this.messageKey++));return{output:[...i.output,...o].slice(-Yo.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a"),a=new Date,l=a.toLocaleDateString(),c=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${l}-${c}.html`;s.download=d,s.href=o,s.click(),URL.revokeObjectURL(o),s.remove()}}clearLog(){this.setState({output:[]}),localStorage.removeItem(Yo.LOCAL_STORAGE_KEY)}copyLog(){const n=this.outputRef.current;if(n){const r=n.innerText;navigator.clipboard.writeText(r).then(()=>{console.log("Log copied to clipboard.")}).catch(i=>{console.error("Failed to copy log: ",i),alert("Failed to copy log to clipboard. See console for details.")})}}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return z.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,onClick:this.handleDataTextClick,children:[this.state.output,this.state.newLinesCount>0&&z.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};M(Yo,"MAX_OUTPUT_LENGTH",7500),M(Yo,"LOCAL_STORAGE_KEY","outputLog");let NC=Yo;const mG="01409a488ae3c5441eb463daf6ed260a4097c5d4",js=()=>{const[,t]=S.useReducer(e=>e+1,0);return S.useEffect(()=>vo.subscribe(t),[]),[vo.getState(),vo.dispatch]},vG=()=>{const[t,e]=S.useState([]);return S.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},T_=({tabs:t})=>{const[e,n]=S.useState(0),r=S.useRef([]),i=S.useRef(!1);return S.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),S.useEffect(()=>{const o=a=>{switch(a.key){case"ArrowLeft":i.current=!0,n(l=>l>0?l-1:t.length-1);break;case"ArrowRight":i.current=!0,n(l=>l<t.length-1?l+1:0);break;case"Home":i.current=!0,n(0);break;case"End":i.current=!0,n(t.length-1);break}},s=r.current[e];return s==null||s.addEventListener("keydown",o),()=>{s==null||s.removeEventListener("keydown",o)}},[t.length,e]),S.useEffect(()=>{var o;i.current&&((o=r.current[e])==null||o.focus())},[e]),z.jsxs("div",{className:"tabs-container",children:[z.jsx("div",{role:"tablist",children:t.map((o,s)=>z.jsx("button",{ref:a=>r.current[s]=a,role:"tab","aria-selected":e===s,id:o.id,"aria-controls":`${o.id}-panel`,onClick:()=>{console.log(`Tab onClick triggered for: ${o.label} (Index: ${s})`),i.current=!0,n(s),console.log(`Tab state updated to index: ${s}`)},tabIndex:e===s?void 0:-1,children:o.label},s))}),t.map((o,s)=>z.jsx("div",{role:"tabpanel",id:`${o.id}-panel`,"aria-labelledby":o.id,hidden:e!==s,children:z.jsx("div",{className:"sidebar-tab-content",children:o.content})},o.id))]})},CG=()=>{const[t,e]=js();return z.jsxs("label",{children:[z.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:Uo.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},yG=()=>{const[t,e]=js();return z.jsxs("label",{children:["Auto Read:",z.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:Uo.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[z.jsx("option",{value:"off",children:"Off"}),z.jsx("option",{value:"unfocused",children:"Unfocused"}),z.jsx("option",{value:"all",children:"Always"})]})]})},xG=()=>{const[t,e]=js(),n=vG();return z.jsxs("label",{children:["Voice:",z.jsx("select",{value:t.speech.voice,onChange:r=>e({type:Uo.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>z.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},IG=()=>{const[t,e]=js();return z.jsxs("label",{children:["Rate (0.1 - 10.0):",z.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:Uo.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},bG=()=>{const[t,e]=js();return z.jsxs("label",{children:["Pitch (0 - 2):",z.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:Uo.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},AG=()=>{const[t,e]=js();return z.jsxs("label",{children:["Volume (0 - 1):",z.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:Uo.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},wG=()=>{const[t]=js(),[e,n]=S.useState(!1),r=We.useRef(!0);We.useEffect(()=>()=>{r.current=!1,speechSynthesis.cancel()},[]);const i=()=>{if(e)return;n(!0),console.log("Preview button clicked");const o=()=>{if(!r.current)return;const s=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),a=speechSynthesis.getVoices();console.log("Available voices:",a.map(c=>c.name));const l=a.find(c=>c.name===t.speech.voice);console.log("Selected voice:",l?l.name:"Not found"),s.voice=l||null,s.rate=t.speech.rate,s.pitch=t.speech.pitch,s.volume=t.speech.volume,console.log("Utterance settings:",{voice:s.voice?s.voice.name:"Default",rate:s.rate,pitch:s.pitch,volume:s.volume}),s.onend=()=>{r.current&&(console.log("Speech ended"),n(!1))},s.onerror=c=>{r.current&&(console.error("Speech synthesis error:",c),n(!1))},speechSynthesis.cancel(),speechSynthesis.speak(s),console.log("Speech started")};if(speechSynthesis.getVoices().length>0)o();else{let s=()=>{s&&(speechSynthesis.onvoiceschanged=null,s=null,r.current&&o())};speechSynthesis.onvoiceschanged=s;const a=()=>{s&&(speechSynthesis.onvoiceschanged=null,s=null)};We.useEffect(()=>a,[])}};return z.jsx("button",{onClick:i,disabled:e,children:e?"Playing...":"Preview Voice"})},SG=()=>z.jsxs("div",{children:[z.jsx(yG,{}),z.jsx("br",{}),z.jsx(xG,{}),z.jsx("br",{}),z.jsx(IG,{}),z.jsx("br",{}),z.jsx(bG,{}),z.jsx("br",{}),z.jsx(AG,{}),z.jsx("br",{}),z.jsx(wG,{})]}),kG=()=>{const[t,e]=js(),n=t.editor,r=o=>{e({type:Uo.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:Uo.SetEditorAccessibilityMode,data:o.target.checked})};return z.jsxs("div",{children:[z.jsxs("label",{children:[z.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),z.jsx("br",{}),z.jsxs("label",{children:[z.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),z.jsx("br",{})]})},EG=()=>{const t=[{label:"General",content:z.jsx(CG,{})},{label:"Speech",content:z.jsx(SG,{})},{label:"Editor",content:z.jsx(kG,{})}];return z.jsx(T_,{tabs:t})};function TG(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function ef(){return ef=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ef.apply(null,arguments)}var BC="data-focus-lock",R_="data-focus-lock-disabled",RG="data-no-focus-lock",_G="data-autofocus-inside",DG="data-no-autofocus";function Om(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function PG(t,e){var n=S.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var NG=typeof window<"u"?S.useLayoutEffect:S.useEffect,Xw=new WeakMap;function BG(t,e){var n=PG(null,function(r){return t.forEach(function(i){return Om(i,r)})});return NG(function(){var r=Xw.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||Om(a,null)}),o.forEach(function(a){i.has(a)||Om(a,s)})}Xw.set(n,t)},[t]),n}var Fm={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},OC=function(t,e){return OC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},OC(t,e)};function pu(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");OC(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var FC=function(){return FC=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},FC.apply(this,arguments)};function OG(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function __(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function $c(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function MC(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function LC(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function wc(t){return this instanceof wc?(this.v=t,this):new wc(t)}function FG(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){r[h]&&(i[h]=function(g){return new Promise(function(C,v){o.push([h,g,C,v])>1||l(h,g)})},p&&(i[h]=p(i[h])))}function l(h,p){try{c(r[h](p))}catch(g){f(o[0][3],g)}}function c(h){h.value instanceof wc?Promise.resolve(h.value.v).then(u,d):f(o[0][2],h)}function u(h){l("next",h)}function d(h){l("throw",h)}function f(h,p){h(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function MG(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof $c=="function"?$c(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}function D_(t){return t}function P_(t,e){e===void 0&&(e=D_);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function dx(t,e){return e===void 0&&(e=D_),P_(t,e)}function LG(t){t===void 0&&(t={});var e=P_(null);return e.options=FC({async:!0,ssr:!1},t),e}var N_=dx({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),B_=dx(),UG=dx(),VG=LG({async:!0,ssr:typeof document<"u"}),GG=S.createContext(void 0),WG=[],fx=S.forwardRef(function(e,n){var r,i=S.useState(),o=i[0],s=i[1],a=S.useRef(),l=S.useRef(!1),c=S.useRef(null),u=S.useState({}),d=u[1],f=e.children,h=e.disabled,p=h===void 0?!1:h,g=e.noFocusGuards,C=g===void 0?!1:g,v=e.persistentFocus,m=v===void 0?!1:v,y=e.crossFrame,x=y===void 0?!0:y,b=e.autoFocus,E=b===void 0?!0:b;e.allowTextSelection;var A=e.group,k=e.className,D=e.whiteList,T=e.hasPositiveIndices,R=e.shards,P=R===void 0?WG:R,L=e.as,G=L===void 0?"div":L,Z=e.lockProps,q=Z===void 0?{}:Z,ie=e.sideCar,$=e.returnFocus,Q=$===void 0?!1:$,ne=e.focusOptions,O=e.onActivation,j=e.onDeactivation,J=S.useState({}),ee=J[0],se=S.useCallback(function(Ce){var Ue=Ce.captureFocusRestore;if(!c.current){var Le,Pe=(Le=document)==null?void 0:Le.activeElement;c.current=Pe,Pe!==document.body&&(c.current=Ue(Pe))}a.current&&O&&O(a.current),l.current=!0,d()},[O]),me=S.useCallback(function(){l.current=!1,j&&j(a.current),d()},[j]),Be=S.useCallback(function(Ce){var Ue=c.current;if(Ue){var Le=(typeof Ue=="function"?Ue():Ue)||document.body,Pe=typeof Q=="function"?Q(Le):Q;if(Pe){var $e=typeof Pe=="object"?Pe:void 0;c.current=null,Ce?Promise.resolve().then(function(){return Le.focus($e)}):Le.focus($e)}}},[Q]),ae=S.useCallback(function(Ce){l.current&&N_.useMedium(Ce)},[]),Pt=B_.useMedium,Gt=S.useCallback(function(Ce){a.current!==Ce&&(a.current=Ce,s(Ce))},[]),fn=ef((r={},r[R_]=p&&"disabled",r[BC]=A,r),q),ze=C!==!0,at=ze&&C!=="tail",ot=BG([n,Gt]),he=S.useMemo(function(){return{observed:a,shards:P,enabled:!p,active:l.current}},[p,l.current,P,o]);return We.createElement(S.Fragment,null,ze&&[We.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:p?-1:0,style:Fm}),T?We.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:p?-1:1,style:Fm}):null],!p&&We.createElement(ie,{id:ee,sideCar:VG,observed:o,disabled:p,persistentFocus:m,crossFrame:x,autoFocus:E,whiteList:D,shards:P,onActivation:se,onDeactivation:me,returnFocus:Be,focusOptions:ne,noFocusGuards:C}),We.createElement(G,ef({ref:ot},fn,{className:k,onBlur:Pt,onFocus:ae}),We.createElement(GG.Provider,{value:he},f)),at&&We.createElement("div",{"data-focus-guard":!0,tabIndex:p?-1:0,style:Fm}))});fx.propTypes={};function UC(t,e){return UC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},UC(t,e)}function jG(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,UC(t,e)}function tf(t){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tf(t)}function zG(t,e){if(tf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(tf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HG(t){var e=zG(t,"string");return tf(e)=="symbol"?e:e+""}function ZG(t,e,n){return(e=HG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $G(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var o=[],s;function a(){s=t(o.map(function(c){return c.props})),e(s)}var l=function(c){jG(u,c);function u(){return c.apply(this,arguments)||this}u.peek=function(){return s};var d=u.prototype;return d.componentDidMount=function(){o.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=o.indexOf(this);o.splice(h,1),a()},d.render=function(){return We.createElement(i,this.props)},u}(S.PureComponent);return ZG(l,"displayName","SideEffect("+n(i)+")"),l}}var Ho=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},El=function(t){return Array.isArray(t)?t:[t]},O_=function(t){return Array.isArray(t)?t[0]:t},XG=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},F_=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},M_=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},KG=function(t){return t.hasAttribute("inert")},JG=function(t,e){return!t||M_(t)||!XG(t)&&!KG(t)&&e(F_(t))},L_=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=JG(e,L_.bind(void 0,t));return t.set(e,r),r},YG=function(t,e){return t&&!M_(t)?eW(t)?e(F_(t)):!1:!0},U_=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=YG(e,U_.bind(void 0,t));return t.set(e,r),r},V_=function(t){return t.dataset},qG=function(t){return t.tagName==="BUTTON"},G_=function(t){return t.tagName==="INPUT"},W_=function(t){return G_(t)&&t.type==="radio"},QG=function(t){return!((G_(t)||qG(t))&&(t.type==="hidden"||t.disabled))},eW=function(t){var e=t.getAttribute(DG);return![!0,"true",""].includes(e)},hx=function(t){var e;return!!(t&&(!((e=V_(t))===null||e===void 0)&&e.focusGuard))},VC=function(t){return!hx(t)},tW=function(t){return!!t},nW=function(t,e){var n=Math.max(0,t.tabIndex),r=Math.max(0,e.tabIndex),i=n-r,o=t.index-e.index;if(i){if(!n)return 1;if(!r)return-1}return i||o},rW=function(t){return t.tabIndex<0&&!t.hasAttribute("tabindex")?0:t.tabIndex},px=function(t,e,n){return Ho(t).map(function(r,i){var o=rW(r);return{node:r,index:i,tabIndex:n&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(nW)},iW=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],gx=iW.join(","),oW="".concat(gx,", [data-focus-guard]"),j_=function(t,e){return Ho((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?oW:gx)?[r]:[],j_(r))},[])},sW=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?Xc([t.contentDocument.body],e):[t]},Xc=function(t,e){return t.reduce(function(n,r){var i,o=j_(r,e),s=(i=[]).concat.apply(i,o.map(function(a){return sW(a,e)}));return n.concat(s,r.parentNode?Ho(r.parentNode.querySelectorAll(gx)).filter(function(a){return a===r}):[])},[])},aW=function(t){var e=t.querySelectorAll("[".concat(_G,"]"));return Ho(e).map(function(n){return Xc([n])}).reduce(function(n,r){return n.concat(r)},[])},mx=function(t,e){return Ho(t).filter(function(n){return L_(e,n)}).filter(function(n){return QG(n)})},Kw=function(t,e){return e===void 0&&(e=new Map),Ho(t).filter(function(n){return U_(e,n)})},vx=function(t,e,n){return px(mx(Xc(t,n),e),!0,n)},nf=function(t,e){return px(mx(Xc(t),e),!1)},lW=function(t,e){return mx(aW(t),e)},ml=function(t,e){return t.shadowRoot?ml(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:Ho(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?ml(i,e):!1}return ml(n,e)})},cW=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=t[r].compareDocumentPosition(t[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(s,a){return!e.has(a)})},z_=function(t){return t.parentNode?z_(t.parentNode):t},Cx=function(t){var e=El(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(BC);return n.push.apply(n,i?cW(Ho(z_(r).querySelectorAll("[".concat(BC,'="').concat(i,'"]:not([').concat(R_,'="disabled"])')))):[r]),n},[])},uW=function(t){try{return t()}catch{return}},rf=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?rf(e.shadowRoot):e instanceof HTMLIFrameElement&&uW(function(){return e.contentWindow.document})?rf(e.contentWindow.document):e}},dW=function(t,e){return t===e},fW=function(t,e){return!!Ho(t.querySelectorAll("iframe")).some(function(n){return dW(n,e)})},H_=function(t,e){return e===void 0&&(e=rf(O_(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:Cx(t).some(function(n){return ml(n,e)||fW(n,e)})},hW=function(t){t===void 0&&(t=document);var e=rf(t);return e?Ho(t.querySelectorAll("[".concat(RG,"]"))).some(function(n){return ml(n,e)}):!1},pW=function(t,e){return e.filter(W_).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},yx=function(t,e){return W_(t)&&t.name?pW(t,e):t},gW=function(t){var e=new Set;return t.forEach(function(n){return e.add(yx(n,t))}),t.filter(function(n){return e.has(n)})},Jw=function(t){return t[0]&&t.length>1?yx(t[0],t):t[0]},Yw=function(t,e){return t.indexOf(yx(e,t))},GC="NEW_FOCUS",mW=function(t,e,n,r,i){var o=t.length,s=t[0],a=t[o-1],l=hx(r);if(!(r&&t.indexOf(r)>=0)){var c=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):c,d=i?t.indexOf(i):-1;if(c===-1)return d!==-1?d:GC;if(d===-1)return GC;var f=c-u,h=n.indexOf(s),p=n.indexOf(a),g=gW(n),C=r!==void 0?g.indexOf(r):-1,v=i?g.indexOf(i):C,m=g.filter(function(k){return k.tabIndex>=0}),y=r!==void 0?m.indexOf(r):-1,x=i?m.indexOf(i):y,b=y>=0&&x>=0?x-y:v-C;if(!f&&d>=0||e.length===0)return d;var E=Yw(t,e[0]),A=Yw(t,e[e.length-1]);if(c<=h&&l&&Math.abs(f)>1)return A;if(c>=p&&l&&Math.abs(f)>1)return E;if(f&&Math.abs(b)>1)return d;if(c<=h)return A;if(c>p)return E;if(f)return Math.abs(f)>1?d:(o+d+f)%o}},vW=function(t){return function(e){var n,r=(n=V_(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},qw=function(t,e,n){var r=t.map(function(o){var s=o.node;return s}),i=Kw(r.filter(vW(n)));return i&&i.length?Jw(i):Jw(Kw(e))},WC=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&WC(t.parentNode.host||t.parentNode,e),e},Mm=function(t,e){for(var n=WC(t),r=WC(e),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},Z_=function(t,e,n){var r=El(t),i=El(e),o=r[0],s=!1;return i.filter(Boolean).forEach(function(a){s=Mm(s||a,a)||s,n.filter(Boolean).forEach(function(l){var c=Mm(o,l);c&&(!s||ml(c,s)?s=c:s=Mm(c,s))})}),s},Qw=function(t,e){return t.reduce(function(n,r){return n.concat(lW(r,e))},[])},CW=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(tW)},yW=function(t,e){var n=rf(El(t).length>0?document:O_(t).ownerDocument),r=Cx(t).filter(VC),i=Z_(n||t,t,r),o=new Map,s=nf(r,o),a=s.filter(function(p){var g=p.node;return VC(g)});if(a[0]){var l=nf([i],o).map(function(p){var g=p.node;return g}),c=CW(l,a),u=c.map(function(p){var g=p.node;return g}),d=c.filter(function(p){var g=p.tabIndex;return g>=0}).map(function(p){var g=p.node;return g}),f=mW(u,d,l,n,e);if(f===GC){var h=qw(s,d,Qw(r,o))||qw(s,u,Qw(r,o));if(h)return{node:h};console.warn("focus-lock: cannot find any node to move focus into");return}return f===void 0?f:c[f]}},xW=function(t){var e=Cx(t).filter(VC),n=Z_(t,t,e),r=px(Xc([n],!0),!0,!0),i=Xc(e,!1);return r.map(function(o){var s=o.node,a=o.index;return{node:s,index:a,lockItem:i.indexOf(s)>=0,guard:hx(s)}})},xx=function(t,e){t&&("focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus())},Lm=0,Um=!1,$_=function(t,e,n){n===void 0&&(n={});var r=yW(t,e);if(!Um&&r){if(Lm>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Um=!0,setTimeout(function(){Um=!1},1);return}Lm++,xx(r.node,n.focusOptions),Lm--}};function Gu(t){if(!t)return null;if(typeof WeakRef>"u")return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(e==null?void 0:e.deref())||null}}var IW=function(t){if(!t)return null;for(var e=[],n=t;n&&n!==document.body;)e.push({current:Gu(n),parent:Gu(n.parentElement),left:Gu(n.previousElementSibling),right:Gu(n.nextElementSibling)}),n=n.parentElement;return{element:Gu(t),stack:e,ownerDocument:t.ownerDocument}},bW=function(t){var e,n,r,i,o;if(t)for(var s=t.stack,a=t.ownerDocument,l=new Map,c=0,u=s;c<u.length;c++){var d=u[c],f=(e=d.parent)===null||e===void 0?void 0:e.call(d);if(f&&a.contains(f)){for(var h=(n=d.left)===null||n===void 0?void 0:n.call(d),p=d.current(),g=f.contains(p)?p:void 0,C=(r=d.right)===null||r===void 0?void 0:r.call(d),v=vx([f],l),m=(o=(i=g??(h==null?void 0:h.nextElementSibling))!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:h;m;){for(var y=0,x=v;y<x.length;y++){var b=x[y];if(m!=null&&m.contains(b.node))return b.node}m=m.nextElementSibling}if(v.length)return v[0].node}}},X_=function(t){var e=IW(t);return function(){return bW(e)}},AW=function(t,e,n){if(!t||!e)return console.error("no element or scope given"),{};var r=El(e);if(r.every(function(s){return!ml(s,t)}))return console.error("Active element is not contained in the scope"),{};var i=n?vx(r,new Map):nf(r,new Map),o=i.findIndex(function(s){var a=s.node;return a===t});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},wW=function(t,e){var n=e?vx(El(t),new Map):nf(El(t),new Map);return{first:n[0],last:n[n.length-1]}},SW=function(t){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},t)},K_=function(t,e,n){e===void 0&&(e={});var r=SW(e),i=AW(t,r.scope,r.onlyTabbable);if(i){var o=n(i,r.cycle);o&&xx(o.node,r.focusOptions)}},kW=function(t,e){e===void 0&&(e={}),K_(t,e,function(n,r){var i=n.next,o=n.first;return i||r&&o})},EW=function(t,e){e===void 0&&(e={}),K_(t,e,function(n,r){var i=n.prev,o=n.last;return i||r&&o})},J_=function(t,e,n){var r,i=wW(t,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[n];o&&xx(o.node,e.focusOptions)},TW=function(t,e){e===void 0&&(e={}),J_(t,e,"first")},RW=function(t,e){e===void 0&&(e={}),J_(t,e,"last")};function Ix(t){setTimeout(t,1)}var _W=function(e){return e&&"current"in e?e.current:e},Y_=function(){return document&&document.activeElement===document.body},DW=function(){return Y_()||hW()},Sc=null,xr=null,eS=function(){return null},kc=null,of=!1,bx=!1,PW=function(){return!0},NW=function(e){return(Sc.whiteList||PW)(e)},BW=function(e,n){kc={observerNode:e,portaledElement:n}},OW=function(e){return kc&&kc.portaledElement===e};function tS(t,e,n,r){var i=null,o=t;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else if(s.lockItem){if(o!==t)return;i=null}else break}while((o+=n)!==e);i&&(i.node.tabIndex=0)}var FW=function(e){return e?!!of:of==="meanwhile"},MW=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},LW=function(e,n){return n.some(function(r){return MW(e,r,r)})},q_=function(e){return nf(e,new Map)},UW=function(e){return!q_([e.parentNode]).some(function(n){return n.node===e})},Q0=function(){var e=!1;if(Sc){var n=Sc,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,l=n.focusOptions,c=n.noFocusGuards,u=r||kc&&kc.portaledElement;if(Y_()&&xr&&xr!==document.body&&(!document.body.contains(xr)||UW(xr))){var d=eS();d&&d.focus()}var f=document&&document.activeElement;if(u){var h=[u].concat(s.map(_W).filter(Boolean)),p=function(){if(!FW(a)||!c||!xr||bx)return!1;var y=q_(h),x=y.findIndex(function(b){var E=b.node;return E===xr});return x===0||x===y.length-1};if((!f||NW(f))&&(i||p()||!DW()||!xr&&o)&&(u&&!(H_(h)||f&&LW(f,h)||OW(f))&&(document&&!xr&&f&&!o?(f.blur&&f.blur(),document.body.focus()):(e=$_(h,xr,{focusOptions:l}),kc={})),xr=document&&document.activeElement,xr!==document.body&&(eS=X_(xr)),of=!1),document&&f!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var g=document&&document.activeElement,C=xW(h),v=C.map(function(m){var y=m.node;return y}).indexOf(g);v>-1&&(C.filter(function(m){var y=m.guard,x=m.node;return y&&x.dataset.focusAutoGuard}).forEach(function(m){var y=m.node;return y.removeAttribute("tabIndex")}),tS(v,C.length,1,C),tS(v,-1,-1,C))}}}return e},Q_=function(e){Q0()&&e&&(e.stopPropagation(),e.preventDefault())},Ax=function(){return Ix(Q0)},VW=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||BW(r,n)},GW=function(){return null},eD=function(){bx=!0},tD=function(){bx=!1,of="just",Ix(function(){of="meanwhile"})},WW=function(){document.addEventListener("focusin",Q_),document.addEventListener("focusout",Ax),window.addEventListener("focus",eD),window.addEventListener("blur",tD)},jW=function(){document.removeEventListener("focusin",Q_),document.removeEventListener("focusout",Ax),window.removeEventListener("focus",eD),window.removeEventListener("blur",tD)};function zW(t){return t.filter(function(e){var n=e.disabled;return!n})}var nD={moveFocusInside:$_,focusInside:H_,focusNextElement:kW,focusPrevElement:EW,focusFirstElement:TW,focusLastElement:RW,captureFocusRestore:X_};function HW(t){var e=t.slice(-1)[0];e&&!Sc&&WW();var n=Sc,r=n&&e&&e.id===n.id;Sc=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var o=i.id;return o===n.id}).length||n.returnFocus(!e)),e?(xr=null,(!r||n.observed!==e.observed)&&e.onActivation(nD),Q0(),Ix(Q0)):(jW(),xr=null)}N_.assignSyncMedium(VW);B_.assignMedium(Ax);UG.assignMedium(function(t){return t(nD)});const ZW=$G(zW,HW)(GW);var rD=S.forwardRef(function(e,n){return We.createElement(fx,ef({sideCar:ZW,ref:n},e))}),iD=fx.propTypes||{};iD.sideCar;TG(iD,["sideCar"]);rD.propTypes={};const $W=We.forwardRef((t,e)=>{const[n,r]=S.useState(!1),i=S.useRef(null);return We.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),S.useEffect(()=>{var o;n&&((o=i.current)==null||o.focus())},[n]),S.useEffect(()=>{const o=s=>{s.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),z.jsx(rD,{disabled:!n,children:z.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[z.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&z.jsx(EG,{}),z.jsx("button",{onClick:()=>r(!1),children:"Close"}),z.jsx("br",{}),z.jsxs("span",{id:"commit-hash",children:["Version: ",mG]})]})})}),XW=({onFileChange:t,onRecipientChange:e,onSendFile:n,selectedFile:r,recipient:i})=>{const o=a=>{a.target.files&&a.target.files.length>0&&t(a.target.files[0])},s=a=>{e(a.target.value)};return z.jsxs("div",{className:"file-transfer-controls",children:[z.jsx("input",{type:"file",onChange:o}),z.jsx("input",{type:"text",placeholder:"Recipient",value:i,onChange:s}),z.jsx("button",{onClick:n,disabled:!r||!i,children:"Send File"})]})},KW=({progress:t})=>z.jsxs("div",{className:"progress-bar",children:[z.jsx("progress",{value:t,max:"100"}),z.jsxs("span",{children:[t.toFixed(2),"%"]})]}),JW=({offer:t,onAccept:e,onReject:n})=>z.jsxs("div",{className:"incoming-transfer",children:[z.jsxs("p",{children:["Incoming file: ",t.filename," from ",t.sender]}),z.jsx("button",{onClick:()=>e(t.sender,t.hash),children:"Accept"}),z.jsx("button",{onClick:()=>n(t.sender,t.hash),children:"Reject"})]}),YW=({history:t})=>z.jsxs("div",{className:"transfer-history","aria-live":"polite",children:[z.jsx("h4",{children:"Transfer History"}),z.jsx("ul",{children:t.map((e,n)=>z.jsx("li",{children:e},n))})]}),qW=({client:t,expanded:e})=>{const[n,r]=S.useState(null),[i,o]=S.useState(""),[s,a]=S.useState(0),[l,c]=S.useState(0),[u,d]=S.useState([]),[f,h]=S.useState([]),p=S.useCallback(R=>{h(P=>[...P,R].slice(-10))},[]),g=S.useCallback(R=>{const P=R.sentBytes/R.totalBytes*100;a(P)},[]),C=S.useCallback(R=>{const P=R.receivedBytes/R.totalBytes*100;c(P)},[]),v=S.useCallback(R=>{p(`File sent successfully: ${R.filename}`),a(0)},[p]),m=S.useCallback(R=>{p(`File received successfully: ${R.filename}`),c(0)},[p]),y=S.useCallback(R=>{p(`Error ${R.direction}ing file ${R.filename}: ${R.error}`),R.direction==="send"?a(0):c(0)},[p]),x=S.useCallback(R=>{p(`File transfer cancelled: ${R.filename} (${R.direction})`),R.direction==="send"?a(0):c(0)},[p]),b=S.useCallback(R=>{p(`File transfer rejected: ${R.filename} from ${R.sender}`)},[p]),E=S.useCallback(R=>{p(`File transfer accepted: ${R.filename} by ${R.sender}`)},[p]),A=S.useCallback(R=>{d(P=>[...P,R]),p(`Incoming file offer: ${R.filename} from ${R.sender}`)},[p]);S.useEffect(()=>(t.on("fileTransferOffer",A),t.on("fileTransferAccepted",E),t.fileTransferManager.on("fileSendProgress",g),t.fileTransferManager.on("fileReceiveProgress",C),t.on("fileTransferError",y),t.on("fileTransferCancelled",x),t.on("fileTransferRejected",b),t.on("fileSendComplete",v),t.fileTransferManager.on("fileReceiveComplete",m),()=>{t.off("fileTransferOffer",A),t.off("fileTransferAccepted",E),t.fileTransferManager.off("fileSendProgress",g),t.fileTransferManager.off("fileReceiveProgress",C),t.off("fileTransferError",y),t.off("fileTransferCancelled",x),t.off("fileTransferRejected",b),t.off("fileSendComplete",v),t.fileTransferManager.off("fileReceiveComplete",m)}),[t,A,E,g,C,y,x,b,v,m]);const k=()=>{n&&i&&t.sendFile(n,i).then(()=>{p(`Sending ${n.name} to ${i}`)}).catch(R=>{p(`Error sending file: ${R.message}`)})},D=(R,P)=>{t.acceptTransfer(R,P);const L=u.find(G=>G.hash===P);L&&p(`Accepting file transfer: ${L.filename} from ${R}`),d(G=>G.filter(Z=>Z.hash!==P))},T=(R,P)=>{t.rejectTransfer(R,P);const L=u.find(G=>G.hash===P);L&&p(`Rejected file transfer: ${L.filename} from ${R}`),d(G=>G.filter(Z=>Z.hash!==P))};return z.jsxs("div",{className:`file-transfer-ui ${e?"expanded":"collapsed"}`,children:[z.jsx("h3",{children:"File Transfer"}),z.jsx(XW,{onFileChange:r,onRecipientChange:o,onSendFile:k,selectedFile:n,recipient:i}),(s>0||l>0)&&z.jsx(KW,{progress:s>0?s:l}),u.map(R=>z.jsx(JW,{offer:R,onAccept:D,onReject:T},`${R.sender}-${R.filename}`)),z.jsx(YW,{history:f})]})};var nS={};function QW(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var ej=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var oD={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(ej,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(g,C){var v=g[C];if(typeof v.bind=="function")return v.bind(g);try{return Function.prototype.bind.call(v,g)}catch{return function(){return Function.prototype.apply.apply(v,[g,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?s:console[g]!==void 0?o(console,g):console.log!==void 0?o(console,"log"):e}function l(g,C){for(var v=0;v<i.length;v++){var m=i[v];this[m]=v<g?e:this.methodFactory(m,g,C)}this.log=this.debug}function c(g,C,v){return function(){typeof console!==n&&(l.call(this,C,v),this[g].apply(this,arguments))}}function u(g,C,v){return a(g)||c.apply(this,arguments)}function d(g,C,v){var m=this,y;C=C??"WARN";var x="loglevel";typeof g=="string"?x+=":"+g:typeof g=="symbol"&&(x=void 0);function b(D){var T=(i[D]||"silent").toUpperCase();if(!(typeof window===n||!x)){try{window.localStorage[x]=T;return}catch{}try{window.document.cookie=encodeURIComponent(x)+"="+T+";"}catch{}}}function E(){var D;if(!(typeof window===n||!x)){try{D=window.localStorage[x]}catch{}if(typeof D===n)try{var T=window.document.cookie,R=T.indexOf(encodeURIComponent(x)+"=");R!==-1&&(D=/^([^;]+)/.exec(T.slice(R))[1])}catch{}return m.levels[D]===void 0&&(D=void 0),D}}function A(){if(!(typeof window===n||!x)){try{window.localStorage.removeItem(x);return}catch{}try{window.document.cookie=encodeURIComponent(x)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}m.name=g,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=v||u,m.getLevel=function(){return y},m.setLevel=function(D,T){if(typeof D=="string"&&m.levels[D.toUpperCase()]!==void 0&&(D=m.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=m.levels.SILENT){if(y=D,T!==!1&&b(D),l.call(m,D,g),typeof console===n&&D<m.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+D},m.setDefaultLevel=function(D){C=D,E()||m.setLevel(D,!1)},m.resetLevel=function(){m.setLevel(C,!1),A()},m.enableAll=function(D){m.setLevel(m.levels.TRACE,D)},m.disableAll=function(D){m.setLevel(m.levels.SILENT,D)};var k=E();k==null&&(k=C),m.setLevel(k,!1)}var f=new d,h={};f.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var v=h[C];return v||(v=h[C]=new d(C,f.getLevel(),f.methodFactory)),v};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(oD);var wx=oD.exports,jC;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(jC||(jC={}));var Vo;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Vo||(Vo={}));let et=wx.getLogger("livekit");et.setDefaultLevel(jC.info);function Us(t){const e=wx.getLogger(t);return e.setDefaultLevel(et.getLevel()),e}wx.getLogger("lk-e2ee");function kr(t,e){if(!t)throw new Error(e)}const nj=34028234663852886e22,rj=-34028234663852886e22,ij=4294967295,oj=2147483647,sj=-2147483648;function Hh(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>oj||t<sj)throw new Error("invalid int 32: "+t)}function zC(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>ij||t<0)throw new Error("invalid uint 32: "+t)}function sD(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>nj||t<rj))throw new Error("invalid float 32: "+t)}const aD=Symbol("@bufbuild/protobuf/enum-type");function aj(t){const e=t[aD];return kr(e,"missing enum type on enum object"),e}function lD(t,e,n,r){t[aD]=cD(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function cD(t,e,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of e){const a=uD(s);o.push(a),r[s.name]=a,i[s.no]=a}return{typeName:t,values:o,findName(s){return r[s]},findNumber(s){return i[s]}}}function lj(t,e,n){const r={};for(const i of e){const o=uD(i);r[o.localName]=o.no,r[o.no]=o.localName}return lD(r,t,e),r}function uD(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class Se{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(n);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(n);return i.readMessage(r,e,o,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function cj(t,e,n,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),s={[o]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new Se),Object.assign(s,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,l){return new s().fromBinary(a,l)},fromJson(a,l){return new s().fromJson(a,l)},fromJsonString(a,l){return new s().fromJsonString(a,l)},equals(a,l){return t.util.equals(s,a,l)}}),s}function uj(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,o,s){return cj(this,i,o,s)},makeEnum:lj,makeEnumType:cD,getEnumType:aj}}var le;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(le||(le={}));var Tl;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Tl||(Tl={}));function dj(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Vm(t,e,n){for(let o=0;o<28;o=o+7){const s=t>>>o,a=!(!(s>>>7)&&e==0),l=(a?s|128:s)&255;if(n.push(l),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const s=e>>>o,a=!!(s>>>7),l=(a?s|128:s)&255;if(n.push(l),!a)return}n.push(e>>>31&1)}}const Zh=4294967296;function rS(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function o(s,a){const l=Number(t.slice(s,a));i*=n,r=r*n+l,r>=Zh&&(i=i+(r/Zh|0),r=r%Zh)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?fD(r,i):Sx(r,i)}function fj(t,e){let n=Sx(t,e);const r=n.hi&2147483648;r&&(n=fD(n.lo,n.hi));const i=dD(n.lo,n.hi);return r?"-"+i:i}function dD(t,e){if({lo:t,hi:e}=hj(t,e),e<=2097151)return String(Zh*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let o=n+r*6777216+i*6710656,s=r+i*8147497,a=i*2;const l=1e7;return o>=l&&(s+=Math.floor(o/l),o%=l),s>=l&&(a+=Math.floor(s/l),s%=l),a.toString()+iS(s)+iS(o)}function hj(t,e){return{lo:t>>>0,hi:e>>>0}}function Sx(t,e){return{lo:t|0,hi:e|0}}function fD(t,e){return e=~e,t?t=~t+1:e+=1,Sx(t,e)}const iS=t=>{const e=String(t);return"0000000".slice(e.length)+e};function oS(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function pj(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function gj(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof nS!="object"||nS.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>o||c<i)throw new Error("int64 invalid: ".concat(l));return c},uParse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>a||c<s)throw new Error("uint64 invalid: ".concat(l));return c},enc(l){return t.setBigInt64(0,this.parse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(l){return t.setBigInt64(0,this.uParse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigInt64(0,!0)},uDec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigUint64(0,!0)}}}const n=i=>kr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>kr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),rS(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),rS(i)},dec(i,o){return fj(i,o)},uDec(i,o){return dD(i,o)}}}const He=gj();var tn;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(tn||(tn={}));class mj{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(zC(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Hh(e),oS(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){sD(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){zC(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Hh(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Hh(e),e=(e<<1^e>>31)>>>0,oS(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=He.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=He.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=He.enc(e);return Vm(n.lo,n.hi,this.buf),this}sint64(e){let n=He.enc(e),r=n.hi>>31,i=n.lo<<1^r,o=(n.hi<<1|n.lo>>>31)^r;return Vm(i,o,this.buf),this}uint64(e){let n=He.uEnc(e);return Vm(n.lo,n.hi,this.buf),this}}class vj{constructor(e,n){this.varint64=dj,this.uint32=pj,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case tn.Varint:for(;this.buf[this.pos++]&128;);break;case tn.Bit64:this.pos+=4;case tn.Bit32:this.pos+=4;break;case tn.LengthDelimited:let r=this.uint32();this.pos+=r;break;case tn.StartGroup:let i;for(;(i=this.tag()[1])!==tn.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return He.dec(...this.varint64())}uint64(){return He.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,He.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return He.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return He.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function HC(t,e){return e instanceof Se||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}le.DOUBLE,le.FLOAT,le.INT64,le.UINT64,le.INT32,le.UINT32,le.BOOL,le.STRING,le.BYTES;function qs(t,e,n){if(e===n)return!0;if(t==le.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case le.UINT64:case le.FIXED64:case le.INT64:case le.SFIXED64:case le.SINT64:return e==n}return!1}function ZC(t,e){switch(t){case le.BOOL:return!1;case le.UINT64:case le.FIXED64:case le.INT64:case le.SFIXED64:case le.SINT64:return e==0?He.zero:"0";case le.DOUBLE:case le.FLOAT:return 0;case le.BYTES:return new Uint8Array(0);case le.STRING:return"";default:return 0}}function hD(t,e){const n=e===void 0;let r=tn.Varint,i=e===0;switch(t){case le.STRING:i=n||!e.length,r=tn.LengthDelimited;break;case le.BOOL:i=e===!1;break;case le.DOUBLE:r=tn.Bit64;break;case le.FLOAT:r=tn.Bit32;break;case le.INT64:i=n||e==0;break;case le.UINT64:i=n||e==0;break;case le.FIXED64:i=n||e==0,r=tn.Bit64;break;case le.BYTES:i=n||!e.byteLength,r=tn.LengthDelimited;break;case le.FIXED32:r=tn.Bit32;break;case le.SFIXED32:r=tn.Bit32;break;case le.SFIXED64:i=n||e==0,r=tn.Bit64;break;case le.SINT64:i=n||e==0;break}const o=le[t].toLowerCase();return[r,o,n||i]}const ql=Symbol("@bufbuild/protobuf/unknown-fields"),sS={readUnknownFields:!0,readerFactory:t=>new vj(t)},aS={writeUnknownFields:!0,writerFactory:()=>new mj};function Cj(t){return t?Object.assign(Object.assign({},sS),t):sS}function yj(t){return t?Object.assign(Object.assign({},aS),t):aS}function xj(){return{makeReadOptions:Cj,makeWriteOptions:yj,listUnknownFields(t){var e;return(e=t[ql])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[ql]},writeUnknownFields(t,e){const r=t[ql];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[ql])||(i[ql]=[]),i[ql].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),o=n===void 0?e.len:e.pos+n;for(;e.pos<o;){const[s,a]=e.tag(),l=i.fields.find(s);if(!l){const f=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,s,a,f);continue}let c=t,u=l.repeated,d=l.localName;switch(l.oneof&&(c=c[l.oneof.localName],c.case!=d&&delete c.value,c.case=d,d="value"),l.kind){case"scalar":case"enum":const f=l.kind=="enum"?le.INT32:l.T;let h=ep;if(l.kind=="scalar"&&l.L>0&&(h=bj),u){let v=c[d];if(a==tn.LengthDelimited&&f!=le.STRING&&f!=le.BYTES){let m=e.uint32()+e.pos;for(;e.pos<m;)v.push(h(e,f))}else v.push(h(e,f))}else c[d]=h(e,f);break;case"message":const p=l.T;u?c[d].push($h(e,new p,r)):c[d]instanceof Se?$h(e,c[d],r):(c[d]=$h(e,new p,r),p.fieldWrapper&&!l.oneof&&!l.repeated&&(c[d]=p.fieldWrapper.unwrapField(c[d])));break;case"map":let[g,C]=Ij(l,e,r);c[d][g]=C;break}}}}}function $h(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function Ij(t,e,n){const r=e.uint32(),i=e.pos+r;let o,s;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:o=ep(e,t.K);break;case 2:switch(t.V.kind){case"scalar":s=ep(e,t.V.T);break;case"enum":s=e.int32();break;case"message":s=$h(e,new t.V.T,n);break}break}}if(o===void 0){let a=ZC(t.K,Tl.BIGINT);o=t.K==le.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(t.V.kind){case"scalar":s=ZC(t.V.T,Tl.BIGINT);break;case"enum":s=0;break;case"message":s=new t.V.T;break}return[o,s]}function bj(t,e){const n=ep(t,e);return typeof n=="bigint"?n.toString():n}function ep(t,e){switch(e){case le.STRING:return t.string();case le.BOOL:return t.bool();case le.DOUBLE:return t.double();case le.FLOAT:return t.float();case le.INT32:return t.int32();case le.INT64:return t.int64();case le.UINT64:return t.uint64();case le.FIXED64:return t.fixed64();case le.BYTES:return t.bytes();case le.FIXED32:return t.fixed32();case le.SFIXED32:return t.sfixed32();case le.SFIXED64:return t.sfixed64();case le.SINT64:return t.sint64();case le.UINT32:return t.uint32();case le.SINT32:return t.sint32()}}function Aj(t,e,n,r,i){t.tag(n.no,tn.LengthDelimited),t.fork();let o=r;switch(n.K){case le.INT32:case le.FIXED32:case le.UINT32:case le.SFIXED32:case le.SINT32:o=Number.parseInt(r);break;case le.BOOL:kr(r=="true"||r=="false"),o=r=="true";break}switch(Ad(t,n.K,1,o,!0),n.V.kind){case"scalar":Ad(t,n.V.T,2,i,!0);break;case"enum":Ad(t,le.INT32,2,i,!0);break;case"message":$C(t,e,n.V.T,2,i);break}t.join()}function $C(t,e,n,r,i){if(i!==void 0){const o=HC(n,i);t.tag(r,tn.LengthDelimited).bytes(o.toBinary(e))}}function Ad(t,e,n,r,i){let[o,s,a]=hD(e,r);(!a||i)&&t.tag(n,o)[s](r)}function wj(t,e,n,r){if(!r.length)return;t.tag(n,tn.LengthDelimited).fork();let[,i]=hD(e);for(let o=0;o<r.length;o++)t[i](r[o]);t.join()}function Sj(){return Object.assign(Object.assign({},xj()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let o,s=i.repeated,a=i.localName;if(i.oneof){const l=t[i.oneof.localName];if(l.case!==a)continue;o=l.value}else o=t[a];switch(i.kind){case"scalar":case"enum":let l=i.kind=="enum"?le.INT32:i.T;if(s)if(i.packed)wj(e,l,i.no,o);else for(const c of o)Ad(e,l,i.no,c,!0);else o!==void 0&&Ad(e,l,i.no,o,!!i.oneof||i.opt);break;case"message":if(s)for(const c of o)$C(e,n,i.T,i.no,c);else $C(e,n,i.T,i.no,o);break;case"map":for(const[c,u]of Object.entries(o))Aj(e,n,i,c,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Hp=[];for(let t=0;t<ns.length;t++)Hp[ns[t].charCodeAt(0)]=t;Hp[45]=ns.indexOf("+");Hp[95]=ns.indexOf("/");const pD={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,o,s=0;for(let a=0;a<t.length;a++){if(o=Hp[t.charCodeAt(a)],o===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:n[r++]=s<<2|(o&48)>>4,s=o,i=2;break;case 2:n[r++]=(s&15)<<4|(o&60)>>2,s=o,i=3;break;case 3:n[r++]=(s&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let o=0;o<t.length;o++)switch(r=t[o],n){case 0:e+=ns[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=ns[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=ns[i|r>>6],e+=ns[r&63],n=0;break}return n&&(e+=ns[i],e+="=",n==1&&(e+="=")),e}},lS={ignoreUnknownFields:!1},cS={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function kj(t){return t?Object.assign(Object.assign({},lS),t):lS}function Ej(t){return t?Object.assign(Object.assign({},cS),t):cS}function Tj(t){const e=t(Rj,uS);return{makeReadOptions:kj,makeWriteOptions:Ej,readMessage(n,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));o=o??new n;const s={};for(const[a,l]of Object.entries(r)){const c=n.fields.findJsonName(a);if(!c){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=c.localName,d=o;if(c.oneof){if(l===null&&c.kind=="scalar")continue;const f=s[c.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));s[c.oneof.localName]=a,d=d[c.oneof.localName]={case:u},u="value"}if(c.repeated){if(l===null)continue;if(!Array.isArray(l))throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const h of l){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h)));let p;switch(c.kind){case"message":p=c.T.fromJson(h,i);break;case"enum":if(p=Gm(c.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=Wu(c.T,h,c.L)}catch(g){let C="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h));throw g instanceof Error&&g.message.length>0&&(C+=": ".concat(g.message)),new Error(C)}break}f.push(p)}}else if(c.kind=="map"){if(l===null)continue;if(Array.isArray(l)||typeof l!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const[h,p]of Object.entries(l)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: map value null"));let g;switch(c.V.kind){case"message":g=c.V.T.fromJson(p,i);break;case"enum":if(g=Gm(c.V.T,p,i.ignoreUnknownFields),g===void 0)continue;break;case"scalar":try{g=Wu(c.V.T,p,Tl.BIGINT)}catch(C){let v="cannot decode map value for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(v+=": ".concat(C.message)),new Error(v)}break}try{f[Wu(c.K,c.K==le.BOOL?h=="true"?!0:h=="false"?!1:h:h,Tl.BIGINT).toString()]=g}catch(C){let v="cannot decode map key for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(v+=": ".concat(C.message)),new Error(v)}}}else switch(c.kind){case"message":const f=c.T;if(l===null&&f.typeName!="google.protobuf.Value"){if(c.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof Se?d[u].fromJson(l,i):(d[u]=f.fromJson(l,i),f.fieldWrapper&&!c.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=Gm(c.T,l,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=Wu(c.T,l,c.L)}catch(p){let g="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw p instanceof Error&&p.message.length>0&&(g+=": ".concat(p.message)),new Error(g)}break}}return o},writeMessage(n,r){const i=n.getType(),o={};let s;try{for(const a of i.fields.byMember()){let l;if(a.kind=="oneof"){const c=n[a.localName];if(c.value===void 0)continue;if(s=a.findField(c.case),!s)throw"oneof case not found: "+c.case;l=e(s,c.value,r)}else s=a,l=e(s,n[s.localName],r);l!==void 0&&(o[r.useProtoFieldName?s.name:s.jsonName]=l)}}catch(a){const l=s?"cannot encode field ".concat(i.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),c=a instanceof Error?a.message:String(a);throw new Error(l+(c.length>0?": ".concat(c):""))}return o},readScalar:Wu,writeScalar:uS,debug:gD}}function gD(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function Wu(t,e,n){switch(t){case le.DOUBLE:case le.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==le.FLOAT&&sD(r),r;case le.INT32:case le.FIXED32:case le.SFIXED32:case le.SINT32:case le.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==le.UINT32?zC(i):Hh(i),i;case le.INT64:case le.SFIXED64:case le.SINT64:if(e===null)return He.zero;if(typeof e!="number"&&typeof e!="string")break;const o=He.parse(e);return n?o.toString():o;case le.FIXED64:case le.UINT64:if(e===null)return He.zero;if(typeof e!="number"&&typeof e!="string")break;const s=He.uParse(e);return n?s.toString():s;case le.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case le.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case le.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return pD.dec(e)}throw new Error}function Gm(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(gD(e)))}function Rj(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const o=t.findNumber(e);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:e}function uS(t,e,n){if(e!==void 0)switch(t){case le.INT32:case le.SFIXED32:case le.SINT32:case le.FIXED32:case le.UINT32:return kr(typeof e=="number"),e!=0||n?e:void 0;case le.FLOAT:case le.DOUBLE:return kr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case le.STRING:return kr(typeof e=="string"),e.length>0||n?e:void 0;case le.BOOL:return kr(typeof e=="boolean"),e||n?e:void 0;case le.UINT64:case le.FIXED64:case le.INT64:case le.SFIXED64:case le.SINT64:return kr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case le.BYTES:return kr(e instanceof Uint8Array),n||e.byteLength>0?pD.enc(e):void 0}}function _j(){return Tj((t,e)=>function(r,i,o){if(r.kind=="map"){const s={};switch(r.V.kind){case"scalar":for(const[l,c]of Object.entries(i)){const u=e(r.V.T,c,!0);kr(u!==void 0),s[l.toString()]=u}break;case"message":for(const[l,c]of Object.entries(i))s[l.toString()]=c.toJson(o);break;case"enum":const a=r.V.T;for(const[l,c]of Object.entries(i)){kr(c===void 0||typeof c=="number");const u=t(a,c,!0,o.enumAsInteger);kr(u!==void 0),s[l.toString()]=u}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(r.repeated){const s=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)s.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)s.push(t(r.T,i[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)s.push(HC(r.T,i[a]).toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?HC(r.T,i).toJson(o):void 0}})}function Dj(){return{setEnumType:lD,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,o=e,s=t;if(s[i]!==void 0)switch(r.kind){case"oneof":const a=s[i].case;if(a===void 0)continue;const l=r.findField(a);let c=s[i].value;l&&l.kind=="message"&&!(c instanceof l.T)?c=new l.T(c):l&&l.kind==="scalar"&&l.T===le.BYTES&&(c=ju(c)),o[i]={case:a,value:c};break;case"scalar":case"enum":let u=s[i];r.T===le.BYTES&&(u=r.repeated?u.map(ju):ju(u)),o[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===le.BYTES)for(const[h,p]of Object.entries(s[i]))o[i][h]=ju(p);else Object.assign(o[i],s[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(s[i])){let p=s[i][h];f.fieldWrapper||(p=new f(p)),o[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)o[i]=s[i].map(f=>f instanceof d?f:new d(f));else if(s[i]!==void 0){const f=s[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?o[i]=ju(f):o[i]=f:o[i]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],o=n[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((s,a)=>r.T.equals(s,o[a]));case"scalar":return i.every((s,a)=>qs(r.T,s,o[a]));case"enum":return i.every((s,a)=>qs(le.INT32,s,o[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return qs(le.INT32,i,o);case"scalar":return qs(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const s=r.findField(i.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(i.value,o.value);case"enum":return qs(le.INT32,i.value,o.value);case"scalar":return qs(s.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const a=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const l=r.V.T;return a.every(u=>l.equals(i[u],o[u]));case"enum":return a.every(u=>qs(le.INT32,i[u],o[u]));case"scalar":const c=r.V.T;return a.every(u=>qs(c,i[u],o[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const o=t[i.localName];let s;if(i.repeated)s=o.map(dh);else if(i.kind=="map"){s=r[i.localName];for(const[a,l]of Object.entries(o))s[a]=dh(l)}else i.kind=="oneof"?s=i.findField(o.case)?{case:o.case,value:dh(o.value)}:{case:void 0}:s=dh(o);r[i.localName]=s}return n}}}function dh(t){if(t===void 0)return t;if(t instanceof Se)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function ju(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class Pj{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function mD(t,e){const n=vD(t);return e?n:Lj(Mj(n))}function Nj(t){return mD(t,!1)}const Bj=vD;function vD(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const Oj=new Set(["constructor","toString","toJSON","valueOf"]),Fj=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),CD=t=>"".concat(t,"$"),Mj=t=>Fj.has(t)?CD(t):t,Lj=t=>Oj.has(t)?CD(t):t;class Uj{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Nj(e)}addField(e){kr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const N=uj("proto3",_j(),Sj(),Object.assign(Object.assign({},Dj()),{newFieldList(t){return new Pj(t,Vj)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=ZC(e.T,e.L);break}}}}));function Vj(t){var e,n,r,i;const o=[];let s;for(const a of typeof t=="function"?t():t){const l=a;if(l.localName=mD(a.name,a.oneof!==void 0),l.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:Bj(a.name),l.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(l.L=(r=a.L)!==null&&r!==void 0?r:Tl.BIGINT),l.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=le.BYTES&&a.T!=le.STRING,a.oneof!==void 0){const c=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=c)&&(s=new Uj(c)),l.oneof=s,s.addField(l)}o.push(l)}return o}class En extends Se{constructor(e){super(),this.seconds=He.zero,this.nanos=0,N.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(N.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=He.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return En.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new En({seconds:He.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new En().fromBinary(e,n)}static fromJson(e,n){return new En().fromJson(e,n)}static fromJsonString(e,n){return new En().fromJsonString(e,n)}static equals(e,n){return N.util.equals(En,e,n)}}En.runtime=N;En.typeName="google.protobuf.Timestamp";En.fields=N.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var XC;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(XC||(XC={}));N.util.setEnumType(XC,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var KC;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(KC||(KC={}));N.util.setEnumType(KC,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var JC;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(JC||(JC={}));N.util.setEnumType(JC,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Kn;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Kn||(Kn={}));N.util.setEnumType(Kn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var nn;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(nn||(nn={}));N.util.setEnumType(nn,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var xn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(xn||(xn={}));N.util.setEnumType(xn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var os;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(os||(os={}));N.util.setEnumType(os,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var qi;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(qi||(qi={}));N.util.setEnumType(qi,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var Ds;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(Ds||(Ds={}));N.util.setEnumType(Ds,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var Qo;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(Qo||(Qo={}));N.util.setEnumType(Qo,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var sf;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(sf||(sf={}));N.util.setEnumType(sf,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let gu=class sd extends Se{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=He.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new sd().fromBinary(e,n)}static fromJson(e,n){return new sd().fromJson(e,n)}static fromJsonString(e,n){return new sd().fromJsonString(e,n)}static equals(e,n){return N.util.equals(sd,e,n)}};gu.runtime=N;gu.typeName="livekit.Room";gu.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Vi,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class Vi extends Se{constructor(e){super(),this.mime="",this.fmtpLine="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Vi().fromBinary(e,n)}static fromJson(e,n){return new Vi().fromJson(e,n)}static fromJsonString(e,n){return new Vi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Vi,e,n)}}Vi.runtime=N;Vi.typeName="livekit.Codec";Vi.fields=N.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class va extends Se{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new va().fromBinary(e,n)}static fromJson(e,n){return new va().fromJson(e,n)}static fromJsonString(e,n){return new va().fromJsonString(e,n)}static equals(e,n){return N.util.equals(va,e,n)}}va.runtime=N;va.typeName="livekit.PlayoutDelay";va.fields=N.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class ss extends Se{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new ss().fromBinary(e,n)}static fromJson(e,n){return new ss().fromJson(e,n)}static fromJsonString(e,n){return new ss().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ss,e,n)}}ss.runtime=N;ss.typeName="livekit.ParticipantPermission";ss.fields=N.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:N.getEnumType(nn),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Yr extends Se{constructor(e){super(),this.sid="",this.identity="",this.state=Rl.JOINING,this.tracks=[],this.metadata="",this.joinedAt=He.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new Yr().fromBinary(e,n)}static fromJson(e,n){return new Yr().fromJson(e,n)}static fromJsonString(e,n){return new Yr().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Yr,e,n)}}Yr.runtime=N;Yr.typeName="livekit.ParticipantInfo";Yr.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:N.getEnumType(Rl)},{no:4,name:"tracks",kind:"message",T:Tr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:ss},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var Rl;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(Rl||(Rl={}));N.util.setEnumType(Rl,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class Ca extends Se{constructor(e){super(),N.util.initPartial(e,this)}static fromBinary(e,n){return new Ca().fromBinary(e,n)}static fromJson(e,n){return new Ca().fromJson(e,n)}static fromJsonString(e,n){return new Ca().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ca,e,n)}}Ca.runtime=N;Ca.typeName="livekit.Encryption";Ca.fields=N.util.newFieldList(()=>[]);var Nn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(Nn||(Nn={}));N.util.setEnumType(Nn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class as extends Se{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new as().fromBinary(e,n)}static fromJson(e,n){return new as().fromJson(e,n)}static fromJsonString(e,n){return new as().fromJsonString(e,n)}static equals(e,n){return N.util.equals(as,e,n)}}as.runtime=N;as.typeName="livekit.SimulcastCodecInfo";as.fields=N.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ur,repeated:!0}]);class Tr extends Se{constructor(e){super(),this.sid="",this.type=Kn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=nn.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Nn.NONE,this.stream="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Tr().fromBinary(e,n)}static fromJson(e,n){return new Tr().fromJson(e,n)}static fromJsonString(e,n){return new Tr().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Tr,e,n)}}Tr.runtime=N;Tr.typeName="livekit.TrackInfo";Tr.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:N.getEnumType(Kn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:N.getEnumType(nn)},{no:10,name:"layers",kind:"message",T:ur,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:as,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:N.getEnumType(Nn)},{no:17,name:"stream",kind:"scalar",T:9}]);class ur extends Se{constructor(e){super(),this.quality=xn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new ur().fromBinary(e,n)}static fromJson(e,n){return new ur().fromJson(e,n)}static fromJsonString(e,n){return new ur().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ur,e,n)}}ur.runtime=N;ur.typeName="livekit.VideoLayer";ur.fields=N.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:N.getEnumType(xn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Co extends Se{constructor(e){super(),this.kind=mn.RELIABLE,this.value={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new Co().fromBinary(e,n)}static fromJson(e,n){return new Co().fromJson(e,n)}static fromJsonString(e,n){return new Co().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Co,e,n)}}Co.runtime=N;Co.typeName="livekit.DataPacket";Co.fields=N.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:N.getEnumType(mn)},{no:2,name:"user",kind:"message",T:xo,oneof:"value"},{no:3,name:"speaker",kind:"message",T:ls,oneof:"value"}]);var mn;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(mn||(mn={}));N.util.setEnumType(mn,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class ls extends Se{constructor(e){super(),this.speakers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ls().fromBinary(e,n)}static fromJson(e,n){return new ls().fromJson(e,n)}static fromJsonString(e,n){return new ls().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ls,e,n)}}ls.runtime=N;ls.typeName="livekit.ActiveSpeakerUpdate";ls.fields=N.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:yo,repeated:!0}]);class yo extends Se{constructor(e){super(),this.sid="",this.level=0,this.active=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new yo().fromBinary(e,n)}static fromJson(e,n){return new yo().fromJson(e,n)}static fromJsonString(e,n){return new yo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(yo,e,n)}}yo.runtime=N;yo.typeName="livekit.SpeakerInfo";yo.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class xo extends Se{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new xo().fromBinary(e,n)}static fromJson(e,n){return new xo().fromJson(e,n)}static fromJsonString(e,n){return new xo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(xo,e,n)}}xo.runtime=N;xo.typeName="livekit.UserPacket";xo.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class Io extends Se{constructor(e){super(),this.participantSid="",this.trackSids=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Io().fromBinary(e,n)}static fromJson(e,n){return new Io().fromJson(e,n)}static fromJsonString(e,n){return new Io().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Io,e,n)}}Io.runtime=N;Io.typeName="livekit.ParticipantTracks";Io.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class cs extends Se{constructor(e){super(),this.edition=Kc.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",N.util.initPartial(e,this)}static fromBinary(e,n){return new cs().fromBinary(e,n)}static fromJson(e,n){return new cs().fromJson(e,n)}static fromJsonString(e,n){return new cs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(cs,e,n)}}cs.runtime=N;cs.typeName="livekit.ServerInfo";cs.fields=N.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:N.getEnumType(Kc)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Kc;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(Kc||(Kc={}));N.util.setEnumType(Kc,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class us extends Se{constructor(e){super(),this.sdk=Jc.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",N.util.initPartial(e,this)}static fromBinary(e,n){return new us().fromBinary(e,n)}static fromJson(e,n){return new us().fromJson(e,n)}static fromJsonString(e,n){return new us().fromJsonString(e,n)}static equals(e,n){return N.util.equals(us,e,n)}}us.runtime=N;us.typeName="livekit.ClientInfo";us.fields=N.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:N.getEnumType(Jc)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Jc;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(Jc||(Jc={}));N.util.setEnumType(Jc,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class bo extends Se{constructor(e){super(),this.resumeConnection=qi.UNSET,this.forceRelay=qi.UNSET,N.util.initPartial(e,this)}static fromBinary(e,n){return new bo().fromBinary(e,n)}static fromJson(e,n){return new bo().fromJson(e,n)}static fromJsonString(e,n){return new bo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(bo,e,n)}}bo.runtime=N;bo.typeName="livekit.ClientConfiguration";bo.fields=N.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:Ao},{no:2,name:"screen",kind:"message",T:Ao},{no:3,name:"resume_connection",kind:"enum",T:N.getEnumType(qi)},{no:4,name:"disabled_codecs",kind:"message",T:ds},{no:5,name:"force_relay",kind:"enum",T:N.getEnumType(qi)}]);class Ao extends Se{constructor(e){super(),this.hardwareEncoder=qi.UNSET,N.util.initPartial(e,this)}static fromBinary(e,n){return new Ao().fromBinary(e,n)}static fromJson(e,n){return new Ao().fromJson(e,n)}static fromJsonString(e,n){return new Ao().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ao,e,n)}}Ao.runtime=N;Ao.typeName="livekit.VideoConfiguration";Ao.fields=N.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:N.getEnumType(qi)}]);class ds extends Se{constructor(e){super(),this.codecs=[],this.publish=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ds().fromBinary(e,n)}static fromJson(e,n){return new ds().fromJson(e,n)}static fromJsonString(e,n){return new ds().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ds,e,n)}}ds.runtime=N;ds.typeName="livekit.DisabledCodecs";ds.fields=N.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Vi,repeated:!0},{no:2,name:"publish",kind:"message",T:Vi,repeated:!0}]);class wo extends Se{constructor(e){super(),this.duration=0,this.startTimestamp=He.zero,this.endTimestamp=He.zero,this.rtpClockTicks=He.zero,this.driftSamples=He.zero,this.driftMs=0,this.clockRate=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new wo().fromBinary(e,n)}static fromJson(e,n){return new wo().fromJson(e,n)}static fromJsonString(e,n){return new wo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(wo,e,n)}}wo.runtime=N;wo.typeName="livekit.RTPDrift";wo.fields=N.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:En},{no:2,name:"end_time",kind:"message",T:En},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class ya extends Se{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=He.zero,this.headerBytes=He.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=He.zero,this.headerBytesDuplicate=He.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=He.zero,this.headerBytesPadding=He.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new ya().fromBinary(e,n)}static fromJson(e,n){return new ya().fromJson(e,n)}static fromJsonString(e,n){return new ya().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ya,e,n)}}ya.runtime=N;ya.typeName="livekit.RTPStats";ya.fields=N.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:En},{no:2,name:"end_time",kind:"message",T:En},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:En},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:En},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:En},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:En},{no:44,name:"packet_drift",kind:"message",T:wo},{no:45,name:"report_drift",kind:"message",T:wo}]);class xa extends Se{constructor(e){super(),this.unixMicro=He.zero,this.ticks=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new xa().fromBinary(e,n)}static fromJson(e,n){return new xa().fromJson(e,n)}static fromJsonString(e,n){return new xa().fromJsonString(e,n)}static equals(e,n){return N.util.equals(xa,e,n)}}xa.runtime=N;xa.typeName="livekit.TimedVersion";xa.fields=N.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const zu=7e3,Gj=[0,300,2*2*300,3*3*300,4*4*300,zu,zu,zu,zu,zu];class Wj{constructor(e){this._retryDelays=e!==void 0?[...e]:Gj}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function X(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})}function dS(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof dS=="function"?dS(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var kx={exports:{}},Ec=typeof Reflect=="object"?Reflect:null,fS=Ec&&typeof Ec.apply=="function"?Ec.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Xh;Ec&&typeof Ec.ownKeys=="function"?Xh=Ec.ownKeys:Object.getOwnPropertySymbols?Xh=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Xh=function(e){return Object.getOwnPropertyNames(e)};function jj(t){console&&console.warn&&console.warn(t)}var yD=Number.isNaN||function(e){return e!==e};function bt(){bt.init.call(this)}kx.exports=bt;kx.exports.once=$j;bt.EventEmitter=bt;bt.prototype._events=void 0;bt.prototype._eventsCount=0;bt.prototype._maxListeners=void 0;var hS=10;function Zp(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(bt,"defaultMaxListeners",{enumerable:!0,get:function(){return hS},set:function(t){if(typeof t!="number"||t<0||yD(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");hS=t}});bt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};bt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||yD(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function xD(t){return t._maxListeners===void 0?bt.defaultMaxListeners:t._maxListeners}bt.prototype.getMaxListeners=function(){return xD(this)};bt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")fS(l,this,n);else for(var c=l.length,u=SD(l,c),r=0;r<c;++r)fS(u[r],this,n);return!0};function ID(t,e,n,r){var i,o,s;if(Zp(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),s===void 0)s=o[e]=n,++t._eventsCount;else if(typeof s=="function"?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=xD(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,jj(a)}return t}bt.prototype.addListener=function(e,n){return ID(this,e,n,!1)};bt.prototype.on=bt.prototype.addListener;bt.prototype.prependListener=function(e,n){return ID(this,e,n,!0)};function zj(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function bD(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=zj.bind(r);return i.listener=n,r.wrapFn=i,i}bt.prototype.once=function(e,n){return Zp(n),this.on(e,bD(this,e,n)),this};bt.prototype.prependOnceListener=function(e,n){return Zp(n),this.prependListener(e,bD(this,e,n)),this};bt.prototype.removeListener=function(e,n){var r,i,o,s,a;if(Zp(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():Hj(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};bt.prototype.off=bt.prototype.removeListener;bt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function AD(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?Zj(i):SD(i,i.length)}bt.prototype.listeners=function(e){return AD(this,e,!0)};bt.prototype.rawListeners=function(e){return AD(this,e,!1)};bt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):wD.call(t,e)};bt.prototype.listenerCount=wD;function wD(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}bt.prototype.eventNames=function(){return this._eventsCount>0?Xh(this._events):[]};function SD(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function Hj(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Zj(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function $j(t,e){return new Promise(function(n,r){function i(s){t.removeListener(e,o),r(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}kD(t,e,o,{once:!0}),e!=="error"&&Xj(t,i,{once:!0})})}function Xj(t,e,n){typeof t.on=="function"&&kD(t,"error",e,n)}function kD(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Zo=kx.exports;let ED=!0,TD=!0;function Kh(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function Wl(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,a){if(s!==e)return i.apply(this,arguments);const l=c=>{const u=n(c);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,l),i.apply(this,[s,l])};const o=r.removeEventListener;r.removeEventListener=function(s,a){if(s!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(a))return o.apply(this,arguments);const l=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(s){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),s&&this.addEventListener(e,this["_on"+e]=s)},enumerable:!0,configurable:!0})}function Kj(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(ED=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function Jj(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(TD=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function RD(){if(typeof window=="object"){if(ED)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Ex(t,e){TD&&console.warn(t+" is deprecated, please use "+e+" instead.")}function Yj(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=Kh(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Kh(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Kh(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function pS(t){return Object.prototype.toString.call(t)==="[object Object]"}function _D(t){return pS(t)?Object.keys(t).reduce(function(e,n){const r=pS(t[n]),i=r?_D(t[n]):t[n],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[n]:i})},{}):t}function YC(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?YC(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{YC(t,t.get(i),n)})}))}function gS(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return t.forEach(s=>{s.type==="track"&&s.trackIdentifier===e.id&&o.push(s)}),o.forEach(s=>{t.forEach(a=>{a.type===r&&a.trackId===s.id&&YC(t,a,i)})}),i}const mS=RD;function DD(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const l={};return Object.keys(a).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const u=typeof a[c]=="object"?a[c]:{ideal:a[c]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){l.optional=l.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",c)]=u.ideal,l.optional.push(f),f={},f[d("max",c)]=u.ideal,l.optional.push(f)):(f[d("",c)]=u.ideal,l.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[d("",c)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[d(f,c)]=u[f])})}),a.advanced&&(l.optional=(l.optional||[]).concat(a.advanced)),l},i=function(a,l){if(e.version>=61)return l(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const c=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),c(a.audio,"autoGainControl","googAutoGainControl"),c(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let c=a.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const u=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(c.exact==="environment"||c.ideal==="environment"?d=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(g=>p.label.toLowerCase().includes(g)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=c.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),mS("chrome: "+JSON.stringify(a)),l(a)})}a.video=r(a.video)}return mS("chrome: "+JSON.stringify(a)),l(a)},o=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(a,l,c){i(a,u=>{n.webkitGetUserMedia(u,l,d=>{c&&c(o(d))})})};if(n.getUserMedia=s.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(l){return i(l,c=>a(c).then(u=>{if(c.audio&&!u.getAudioTracks().length||c.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(o(u))))}}}function qj(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const o=r.video&&r.video.width,s=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(r.video.mandatory.maxWidth=o),s&&(r.video.mandatory.maxHeight=s),t.navigator.mediaDevices.getUserMedia(r)})}}}function PD(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function ND(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):o={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.id):o={track:i};const s=new Event("track");s.track=i,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Wl(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function BD(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,l){let c=i.apply(this,arguments);return c||(c=e(this,a),this._senders.push(c)),c};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){o.apply(this,arguments);const l=this._senders.indexOf(a);l!==-1&&this._senders.splice(l,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const a=this._senders.find(l=>l.track===s);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function OD(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const s=function(l){const c={};return l.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),c[f.id]=f}),c},a=function(l){return new Map(Object.keys(l).map(c=>[c,l[c]]))};if(arguments.length>=2){const l=function(c){i(a(s(c)))};return e.apply(this,[l,r])}return new Promise((l,c)=>{e.apply(this,[function(u){l(a(s(u)))},c])}).then(i,o)}}function FD(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>gS(s,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Wl(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>gS(o,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,o,s;return this.getSenders().forEach(a=>{a.track===r&&(i?s=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(o?s=!0:o=a),a.track===r)),s||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function MD(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(l)===-1&&this._shimmedLocalStreams[a.id].push(l):this._shimmedLocalStreams[a.id]=[a,l],l};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(c=>{if(this.getSenders().find(d=>d.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const l=this.getSenders().filter(c=>a.indexOf(c)===-1);this._shimmedLocalStreams[s.id]=[s].concat(l)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const l=this._shimmedLocalStreams[a].indexOf(s);l!==-1&&this._shimmedLocalStreams[a].splice(l,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function LD(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return MD(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([u]);this._streams[d.id]=g,this._reverseStreams[g.id]=d,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function o(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function s(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(c){const u=t.RTCPeerConnection.prototype[c],d={[c](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=o(this,p);f[0].apply(null,[g])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>o(this,p))}};t.RTCPeerConnection.prototype[c]=d[c]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=s(this,arguments[0]),a.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const c=l.get.apply(this);return c.type===""?c:o(this,c)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(g=>u.track===g)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function qC(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function UD(t,e){Wl(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var vS=Object.freeze({__proto__:null,fixNegotiationNeeded:UD,shimAddTrackRemoveTrack:LD,shimAddTrackRemoveTrackWithNative:MD,shimGetDisplayMedia:qj,shimGetSendersWithDtmf:BD,shimGetStats:OD,shimGetUserMedia:DD,shimMediaStream:PD,shimOnTrack:ND,shimPeerConnection:qC,shimSenderReceiverGetStats:FD});function VD(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,o,s){Ex("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(o,s)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(s,a,l){a in s&&!(l in s)&&(s[l]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function Qj(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function GD(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function QC(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=t.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=s[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,s,a]=arguments;return r.apply(this,[o||null]).then(l=>{if(e.version<53&&!s)try{l.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((u,d)=>{l.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return l}).then(s,a)}}function WD(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function jD(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Wl(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function zD(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){Ex("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function HD(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function ZD(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:s}=o,a=s.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function $D(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function XD(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function KD(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var CS=Object.freeze({__proto__:null,shimAddTransceiver:ZD,shimCreateAnswer:KD,shimCreateOffer:XD,shimGetDisplayMedia:Qj,shimGetParameters:$D,shimGetUserMedia:VD,shimOnTrack:GD,shimPeerConnection:QC,shimRTCDataChannel:HD,shimReceiverGetStats:jD,shimRemoveStream:zD,shimSenderGetStats:WD});function JD(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return o&&o.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function YD(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,r.dispatchEvent(s)})}),e.apply(r,arguments)}}}function qD(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f},e.createAnswer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f};let a=function(l,c,u){const d=i.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(l,c,u){const d=o.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(l,c,u){const d=s.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},e.addIceCandidate=a}function QD(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(eP(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function eP(t){return t&&t.video!==void 0?Object.assign({},t,{video:_D(t.video)}):t}function tP(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let s=0;s<r.iceServers.length;s++){let a=r.iceServers[s];a.urls===void 0&&a.url?(Ex("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(r.iceServers[s])}r.iceServers=o}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function nP(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function rP(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function iP(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var yS=Object.freeze({__proto__:null,shimAudioContext:iP,shimCallbacksAPI:qD,shimConstraints:eP,shimCreateOfferLegacy:rP,shimGetUserMedia:QD,shimLocalStreamsAPI:JD,shimRTCIceServerUrls:tP,shimRemoteStreamsAPI:YD,shimTrackEventTransceiver:nP}),oP={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{n.parameters[s]!==void 0?o.push(s+"="+n.parameters[s]):o.push(s)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(i.attribute=n.substring(r+1,o),i.value=n.substring(o+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],o=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");r.profile=o[2];for(let a=3;a<o.length;a++){const l=o[a],c=e.matchPrefix(n,"a=rtpmap:"+l+" ")[0];if(c){const u=e.parseRtpMap(c),d=e.matchPrefix(n,"a=fmtp:"+l+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const s=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{s.forEach(l=>{a.rtcpFeedback.find(u=>u.type===l.type&&u.parameter===l.parameter)||a.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=e.writeRtpMap(s),i+=e.writeFmtp(s),i+=e.writeRtcpFb(s)});let o=0;return r.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=e.writeExtmap(s)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),l=a.length>0&&a[0].ssrc;let c;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===l&&(c=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:l,codecPayloadType:parseInt(f.parameters.apt,10)};l&&c&&(h.rtx={ssrc:c}),r.push(h),o&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:l,mechanism:s?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&l&&r.push({ssrc:l});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const s=e.matchPrefix(n,"a=rtcp-mux");return r.mux=s.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const s=e.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const l=a[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let o;const s=r!==void 0?r:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(oP);var sP=oP.exports,Tc=tj(sP),ez=QW({__proto__:null,default:Tc},[sP]);function Jh(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=Tc.parseCandidate(r.candidate);for(const s in o)s in i||Object.defineProperty(i,s,{value:o[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,Wl(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function ey(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Wl(t,"icecandidate",e=>{if(e.candidate){const n=Tc.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Yh(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const l=Tc.splitSections(a.sdp);return l.shift(),l.some(c=>{const u=Tc.parseMLine(c);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const l=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const c=parseInt(l[1],10);return c!==c?-1:c},i=function(a){let l=65536;return e.browser==="firefox"&&(e.version<57?a===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},o=function(a,l){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const u=Tc.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?c=parseInt(u[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(c=2147483637),c},s=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const l=r(arguments[0]),c=i(l),u=o(arguments[0],l);let d;c===0&&u===0?d=Number.POSITIVE_INFINITY:c===0||u===0?d=Math.max(c,u):d=Math.min(c,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return s.apply(this,arguments)}}function qh(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const a=arguments[0],l=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},Wl(t,"datachannel",r=>(e(r.channel,r.target),r))}function ty(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function ny(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function Qh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function e0(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>n.apply(this,[s]))})}var tz=Object.freeze({__proto__:null,removeExtmapAllowMixed:ny,shimAddIceCandidateNullOrEmpty:Qh,shimConnectionState:ty,shimMaxMessageSize:Yh,shimParameterlessSetLocalDescription:e0,shimRTCIceCandidate:Jh,shimRTCIceCandidateRelayProtocol:ey,shimSendThrowTypeError:qh});function nz(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=RD,r=Yj(t),i={browserDetails:r,commonShim:tz,extractVersion:Kh,disableLog:Kj,disableWarnings:Jj,sdp:ez};switch(r.browser){case"chrome":if(!vS||!qC||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=vS,Qh(t,r),e0(t),DD(t,r),PD(t),qC(t,r),ND(t),LD(t,r),BD(t),OD(t),FD(t),UD(t,r),Jh(t),ey(t),ty(t),Yh(t,r),qh(t),ny(t,r);break;case"firefox":if(!CS||!QC||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=CS,Qh(t,r),e0(t),VD(t,r),QC(t,r),GD(t),zD(t),WD(t),jD(t),HD(t),ZD(t),$D(t),XD(t),KD(t),Jh(t),ty(t),Yh(t,r),qh(t);break;case"safari":if(!yS||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=yS,Qh(t,r),e0(t),tP(t),rP(t),qD(t),JD(t),YD(t),nP(t),QD(t),iP(t),Jh(t),ey(t),Yh(t,r),qh(t),ny(t,r);break;default:n("Unsupported browser!");break}return i}nz({window:typeof window>"u"?void 0:window});const rz=10,fh="lk_e2ee",iz="LKFrameEncryptionKey",oz={sharedKey:!1,ratchetSalt:iz,ratchetWindowSize:8,failureTolerance:rz};var Da;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(Da||(Da={}));var xS;(function(t){t.KeyRatcheted="keyRatcheted"})(xS||(xS={}));var Ia;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Ia||(Ia={}));var IS;(function(t){t.Error="cryptorError"})(IS||(IS={}));function sz(){return az()||ry()}function ry(){return typeof window.RTCRtpScriptTransform<"u"}function az(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class HY extends Zo.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{et.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},oz),e),this.on(Da.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(Da.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(Da.RatchetRequest,e,n)}}class mu extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class Rt extends mu{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class Tx extends mu{constructor(e){super(21,e??"device is unsupported")}}class po extends mu{constructor(e){super(20,e??"track is invalid")}}class lz extends mu{constructor(e){super(10,e??"unsupported server")}}class gn extends mu{constructor(e){super(12,e??"unexpected connection state")}}class iy extends mu{constructor(e){super(13,e??"unable to negotiate")}}var af;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(af||(af={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(af||(af={}));var ue;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ue||(ue={}));var de;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(de||(de={}));var Te;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(Te||(Te={}));var xe;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(xe||(xe={}));function Rx(t,e,n){var r,i,o;e===void 0&&(e=50),n===void 0&&(n={});var s=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,l=n.maxWait,c=Date.now(),u=[];function d(){if(l!==void 0){var h=Date.now()-c;if(h+e>=l)return l-h}return e}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(g,C){var v=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,c=Date.now(),!s){var y=t.apply(p,h);a&&a(y),u.forEach(function(x){return(0,x.resolve)(y)}),u=[]}},d()),v){var m=t.apply(p,h);return a&&a(m),g(m)}u.push({resolve:g,reject:C})})};return f.cancel=function(h){o!==void 0&&clearTimeout(o),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const cz=/version\/(\d+(\.?_?\d+)+)/i;let Wm;function Vs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Wm===void 0||e){const r=uz.find(i=>{let{test:o}=i;return o.test(n)});Wm=r==null?void 0:r.describe(n)}return Wm}const uz=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:jm(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:jm(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:jm(cz,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function jm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var dz="1.15.13";const fz=dz,hz=11;class On{}On.setTimeout=function(){return setTimeout(...arguments)};On.setInterval=function(){return setInterval(...arguments)};On.clearTimeout=function(){return clearTimeout(...arguments)};On.clearInterval=function(){return clearInterval(...arguments)};class It{constructor(e,n,r,i,o){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const pz=["vp8","h264"],aP=["vp8","h264","vp9","av1"];function gz(t){return!!pz.find(e=>e===t)}var tp;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(tp||(tp={}));const lf={h90:new It(160,90,9e4,20),h180:new It(320,180,16e4,20),h216:new It(384,216,18e4,20),h360:new It(640,360,45e4,20),h540:new It(960,540,8e5,25),h720:new It(1280,720,17e5,30),h1080:new It(1920,1080,3e6,30),h1440:new It(2560,1440,5e6,30),h2160:new It(3840,2160,8e6,30)},oy={h120:new It(160,120,7e4,20),h180:new It(240,180,125e3,20),h240:new It(320,240,14e4,20),h360:new It(480,360,33e4,20),h480:new It(640,480,5e5,20),h540:new It(720,540,6e5,25),h720:new It(960,720,13e5,30),h1080:new It(1440,1080,23e5,30),h1440:new It(1920,1440,38e5,30)},_x={h360fps3:new It(640,360,2e5,3,"medium"),h360fps15:new It(640,360,4e5,15,"medium"),h720fps5:new It(1280,720,8e5,5,"medium"),h720fps15:new It(1280,720,15e5,15,"medium"),h720fps30:new It(1280,720,2e6,30,"medium"),h1080fps15:new It(1920,1080,25e5,15,"medium"),h1080fps30:new It(1920,1080,5e6,30,"medium"),original:new It(0,0,7e6,30,"medium")};var Jn;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(Jn||(Jn={}));N.util.setEnumType(Jn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var _l;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(_l||(_l={}));N.util.setEnumType(_l,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var np;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(np||(np={}));N.util.setEnumType(np,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class fs extends Se{constructor(e){super(),this.message={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new fs().fromBinary(e,n)}static fromJson(e,n){return new fs().fromJson(e,n)}static fromJsonString(e,n){return new fs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(fs,e,n)}}fs.runtime=N;fs.typeName="livekit.SignalRequest";fs.fields=N.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:dr,oneof:"message"},{no:2,name:"answer",kind:"message",T:dr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:ji,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Wi,oneof:"message"},{no:5,name:"mute",kind:"message",T:zi,oneof:"message"},{no:6,name:"subscription",kind:"message",T:gi,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:ko,oneof:"message"},{no:8,name:"leave",kind:"message",T:mi,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Eo,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Do,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Po,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Pn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:To,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Bo,oneof:"message"}]);class So extends Se{constructor(e){super(),this.message={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new So().fromBinary(e,n)}static fromJson(e,n){return new So().fromJson(e,n)}static fromJsonString(e,n){return new So().fromJsonString(e,n)}static equals(e,n){return N.util.equals(So,e,n)}}So.runtime=N;So.typeName="livekit.SignalResponse";So.fields=N.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:hs,oneof:"message"},{no:2,name:"answer",kind:"message",T:dr,oneof:"message"},{no:3,name:"offer",kind:"message",T:dr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:ji,oneof:"message"},{no:5,name:"update",kind:"message",T:ms,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Hi,oneof:"message"},{no:8,name:"leave",kind:"message",T:mi,oneof:"message"},{no:9,name:"mute",kind:"message",T:zi,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:vs,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Cs,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:xs,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:bs,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:ws,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Ss,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:gs,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:ps,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:ks,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Ts,oneof:"message"}]);class Gi extends Se{constructor(e){super(),this.codec="",this.cid="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Gi().fromBinary(e,n)}static fromJson(e,n){return new Gi().fromJson(e,n)}static fromJsonString(e,n){return new Gi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Gi,e,n)}}Gi.runtime=N;Gi.typeName="livekit.SimulcastCodec";Gi.fields=N.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Wi extends Se{constructor(e){super(),this.cid="",this.name="",this.type=Kn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=nn.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Nn.NONE,this.stream="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Wi().fromBinary(e,n)}static fromJson(e,n){return new Wi().fromJson(e,n)}static fromJsonString(e,n){return new Wi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Wi,e,n)}}Wi.runtime=N;Wi.typeName="livekit.AddTrackRequest";Wi.fields=N.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:N.getEnumType(Kn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:N.getEnumType(nn)},{no:9,name:"layers",kind:"message",T:ur,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Gi,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:N.getEnumType(Nn)},{no:15,name:"stream",kind:"scalar",T:9}]);class ji extends Se{constructor(e){super(),this.candidateInit="",this.target=Jn.PUBLISHER,N.util.initPartial(e,this)}static fromBinary(e,n){return new ji().fromBinary(e,n)}static fromJson(e,n){return new ji().fromJson(e,n)}static fromJsonString(e,n){return new ji().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ji,e,n)}}ji.runtime=N;ji.typeName="livekit.TrickleRequest";ji.fields=N.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:N.getEnumType(Jn)}]);class zi extends Se{constructor(e){super(),this.sid="",this.muted=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new zi().fromBinary(e,n)}static fromJson(e,n){return new zi().fromJson(e,n)}static fromJsonString(e,n){return new zi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(zi,e,n)}}zi.runtime=N;zi.typeName="livekit.MuteTrackRequest";zi.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class hs extends Se{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),N.util.initPartial(e,this)}static fromBinary(e,n){return new hs().fromBinary(e,n)}static fromJson(e,n){return new hs().fromJson(e,n)}static fromJsonString(e,n){return new hs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(hs,e,n)}}hs.runtime=N;hs.typeName="livekit.JoinResponse";hs.fields=N.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:gu},{no:2,name:"participant",kind:"message",T:Yr},{no:3,name:"other_participants",kind:"message",T:Yr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Ro,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:bo},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:cs},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class ps extends Se{constructor(e){super(),this.iceServers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ps().fromBinary(e,n)}static fromJson(e,n){return new ps().fromJson(e,n)}static fromJsonString(e,n){return new ps().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ps,e,n)}}ps.runtime=N;ps.typeName="livekit.ReconnectResponse";ps.fields=N.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:Ro,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:bo}]);class Hi extends Se{constructor(e){super(),this.cid="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Hi().fromBinary(e,n)}static fromJson(e,n){return new Hi().fromJson(e,n)}static fromJsonString(e,n){return new Hi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Hi,e,n)}}Hi.runtime=N;Hi.typeName="livekit.TrackPublishedResponse";Hi.fields=N.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Tr}]);class gs extends Se{constructor(e){super(),this.trackSid="",N.util.initPartial(e,this)}static fromBinary(e,n){return new gs().fromBinary(e,n)}static fromJson(e,n){return new gs().fromJson(e,n)}static fromJsonString(e,n){return new gs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(gs,e,n)}}gs.runtime=N;gs.typeName="livekit.TrackUnpublishedResponse";gs.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class dr extends Se{constructor(e){super(),this.type="",this.sdp="",N.util.initPartial(e,this)}static fromBinary(e,n){return new dr().fromBinary(e,n)}static fromJson(e,n){return new dr().fromJson(e,n)}static fromJsonString(e,n){return new dr().fromJsonString(e,n)}static equals(e,n){return N.util.equals(dr,e,n)}}dr.runtime=N;dr.typeName="livekit.SessionDescription";dr.fields=N.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class ms extends Se{constructor(e){super(),this.participants=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ms().fromBinary(e,n)}static fromJson(e,n){return new ms().fromJson(e,n)}static fromJsonString(e,n){return new ms().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ms,e,n)}}ms.runtime=N;ms.typeName="livekit.ParticipantUpdate";ms.fields=N.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Yr,repeated:!0}]);class gi extends Se{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new gi().fromBinary(e,n)}static fromJson(e,n){return new gi().fromJson(e,n)}static fromJsonString(e,n){return new gi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(gi,e,n)}}gi.runtime=N;gi.typeName="livekit.UpdateSubscription";gi.fields=N.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Io,repeated:!0}]);class ko extends Se{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=xn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new ko().fromBinary(e,n)}static fromJson(e,n){return new ko().fromJson(e,n)}static fromJsonString(e,n){return new ko().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ko,e,n)}}ko.runtime=N;ko.typeName="livekit.UpdateTrackSettings";ko.fields=N.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:N.getEnumType(xn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class mi extends Se{constructor(e){super(),this.canReconnect=!1,this.reason=Ds.UNKNOWN_REASON,N.util.initPartial(e,this)}static fromBinary(e,n){return new mi().fromBinary(e,n)}static fromJson(e,n){return new mi().fromJson(e,n)}static fromJsonString(e,n){return new mi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(mi,e,n)}}mi.runtime=N;mi.typeName="livekit.LeaveRequest";mi.fields=N.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:N.getEnumType(Ds)}]);class Eo extends Se{constructor(e){super(),this.trackSid="",this.layers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Eo().fromBinary(e,n)}static fromJson(e,n){return new Eo().fromJson(e,n)}static fromJsonString(e,n){return new Eo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Eo,e,n)}}Eo.runtime=N;Eo.typeName="livekit.UpdateVideoLayers";Eo.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ur,repeated:!0}]);class To extends Se{constructor(e){super(),this.metadata="",this.name="",N.util.initPartial(e,this)}static fromBinary(e,n){return new To().fromBinary(e,n)}static fromJson(e,n){return new To().fromJson(e,n)}static fromJsonString(e,n){return new To().fromJsonString(e,n)}static equals(e,n){return N.util.equals(To,e,n)}}To.runtime=N;To.typeName="livekit.UpdateParticipantMetadata";To.fields=N.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class Ro extends Se{constructor(e){super(),this.urls=[],this.username="",this.credential="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Ro().fromBinary(e,n)}static fromJson(e,n){return new Ro().fromJson(e,n)}static fromJsonString(e,n){return new Ro().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ro,e,n)}}Ro.runtime=N;Ro.typeName="livekit.ICEServer";Ro.fields=N.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class vs extends Se{constructor(e){super(),this.speakers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new vs().fromBinary(e,n)}static fromJson(e,n){return new vs().fromJson(e,n)}static fromJsonString(e,n){return new vs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(vs,e,n)}}vs.runtime=N;vs.typeName="livekit.SpeakersChanged";vs.fields=N.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:yo,repeated:!0}]);class Cs extends Se{constructor(e){super(),N.util.initPartial(e,this)}static fromBinary(e,n){return new Cs().fromBinary(e,n)}static fromJson(e,n){return new Cs().fromJson(e,n)}static fromJsonString(e,n){return new Cs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Cs,e,n)}}Cs.runtime=N;Cs.typeName="livekit.RoomUpdate";Cs.fields=N.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:gu}]);class ys extends Se{constructor(e){super(),this.participantSid="",this.quality=os.POOR,this.score=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new ys().fromBinary(e,n)}static fromJson(e,n){return new ys().fromJson(e,n)}static fromJsonString(e,n){return new ys().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ys,e,n)}}ys.runtime=N;ys.typeName="livekit.ConnectionQualityInfo";ys.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:N.getEnumType(os)},{no:3,name:"score",kind:"scalar",T:2}]);class xs extends Se{constructor(e){super(),this.updates=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new xs().fromBinary(e,n)}static fromJson(e,n){return new xs().fromJson(e,n)}static fromJsonString(e,n){return new xs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(xs,e,n)}}xs.runtime=N;xs.typeName="livekit.ConnectionQualityUpdate";xs.fields=N.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:ys,repeated:!0}]);class Is extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=_l.ACTIVE,N.util.initPartial(e,this)}static fromBinary(e,n){return new Is().fromBinary(e,n)}static fromJson(e,n){return new Is().fromJson(e,n)}static fromJsonString(e,n){return new Is().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Is,e,n)}}Is.runtime=N;Is.typeName="livekit.StreamStateInfo";Is.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:N.getEnumType(_l)}]);class bs extends Se{constructor(e){super(),this.streamStates=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new bs().fromBinary(e,n)}static fromJson(e,n){return new bs().fromJson(e,n)}static fromJsonString(e,n){return new bs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(bs,e,n)}}bs.runtime=N;bs.typeName="livekit.StreamStateUpdate";bs.fields=N.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:Is,repeated:!0}]);class Zi extends Se{constructor(e){super(),this.quality=xn.LOW,this.enabled=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new Zi().fromBinary(e,n)}static fromJson(e,n){return new Zi().fromJson(e,n)}static fromJsonString(e,n){return new Zi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Zi,e,n)}}Zi.runtime=N;Zi.typeName="livekit.SubscribedQuality";Zi.fields=N.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:N.getEnumType(xn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class As extends Se{constructor(e){super(),this.codec="",this.qualities=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new As().fromBinary(e,n)}static fromJson(e,n){return new As().fromJson(e,n)}static fromJsonString(e,n){return new As().fromJsonString(e,n)}static equals(e,n){return N.util.equals(As,e,n)}}As.runtime=N;As.typeName="livekit.SubscribedCodec";As.fields=N.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Zi,repeated:!0}]);class ws extends Se{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ws().fromBinary(e,n)}static fromJson(e,n){return new ws().fromJson(e,n)}static fromJsonString(e,n){return new ws().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ws,e,n)}}ws.runtime=N;ws.typeName="livekit.SubscribedQualityUpdate";ws.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Zi,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:As,repeated:!0}]);class _o extends Se{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",N.util.initPartial(e,this)}static fromBinary(e,n){return new _o().fromBinary(e,n)}static fromJson(e,n){return new _o().fromJson(e,n)}static fromJsonString(e,n){return new _o().fromJsonString(e,n)}static equals(e,n){return N.util.equals(_o,e,n)}}_o.runtime=N;_o.typeName="livekit.TrackPermission";_o.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class Do extends Se{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Do().fromBinary(e,n)}static fromJson(e,n){return new Do().fromJson(e,n)}static fromJsonString(e,n){return new Do().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Do,e,n)}}Do.runtime=N;Do.typeName="livekit.SubscriptionPermission";Do.fields=N.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:_o,repeated:!0}]);class Ss extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new Ss().fromBinary(e,n)}static fromJson(e,n){return new Ss().fromJson(e,n)}static fromJsonString(e,n){return new Ss().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ss,e,n)}}Ss.runtime=N;Ss.typeName="livekit.SubscriptionPermissionUpdate";Ss.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class Po extends Se{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Po().fromBinary(e,n)}static fromJson(e,n){return new Po().fromJson(e,n)}static fromJsonString(e,n){return new Po().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Po,e,n)}}Po.runtime=N;Po.typeName="livekit.SyncState";Po.fields=N.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:dr},{no:2,name:"subscription",kind:"message",T:gi},{no:3,name:"publish_tracks",kind:"message",T:Hi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:No,repeated:!0},{no:5,name:"offer",kind:"message",T:dr}]);class No extends Se{constructor(e){super(),this.label="",this.id=0,this.target=Jn.PUBLISHER,N.util.initPartial(e,this)}static fromBinary(e,n){return new No().fromBinary(e,n)}static fromJson(e,n){return new No().fromJson(e,n)}static fromJsonString(e,n){return new No().fromJsonString(e,n)}static equals(e,n){return N.util.equals(No,e,n)}}No.runtime=N;No.typeName="livekit.DataChannelInfo";No.fields=N.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:N.getEnumType(Jn)}]);class Pn extends Se{constructor(e){super(),this.scenario={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new Pn().fromBinary(e,n)}static fromJson(e,n){return new Pn().fromJson(e,n)}static fromJsonString(e,n){return new Pn().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Pn,e,n)}}Pn.runtime=N;Pn.typeName="livekit.SimulateScenario";Pn.fields=N.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:N.getEnumType(np),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class Bo extends Se{constructor(e){super(),this.timestamp=He.zero,this.rtt=He.zero,N.util.initPartial(e,this)}static fromBinary(e,n){return new Bo().fromBinary(e,n)}static fromJson(e,n){return new Bo().fromJson(e,n)}static fromJsonString(e,n){return new Bo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Bo,e,n)}}Bo.runtime=N;Bo.typeName="livekit.Ping";Bo.fields=N.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class ks extends Se{constructor(e){super(),this.lastPingTimestamp=He.zero,this.timestamp=He.zero,N.util.initPartial(e,this)}static fromBinary(e,n){return new ks().fromBinary(e,n)}static fromJson(e,n){return new ks().fromJson(e,n)}static fromJsonString(e,n){return new ks().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ks,e,n)}}ks.runtime=N;ks.typeName="livekit.Pong";ks.fields=N.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class ba extends Se{constructor(e){super(),this.regions=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ba().fromBinary(e,n)}static fromJson(e,n){return new ba().fromJson(e,n)}static fromJsonString(e,n){return new ba().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ba,e,n)}}ba.runtime=N;ba.typeName="livekit.RegionSettings";ba.fields=N.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Es,repeated:!0}]);class Es extends Se{constructor(e){super(),this.region="",this.url="",this.distance=He.zero,N.util.initPartial(e,this)}static fromBinary(e,n){return new Es().fromBinary(e,n)}static fromJson(e,n){return new Es().fromJson(e,n)}static fromJsonString(e,n){return new Es().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Es,e,n)}}Es.runtime=N;Es.typeName="livekit.RegionInfo";Es.fields=N.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class Ts extends Se{constructor(e){super(),this.trackSid="",this.err=sf.SE_UNKNOWN,N.util.initPartial(e,this)}static fromBinary(e,n){return new Ts().fromBinary(e,n)}static fromJson(e,n){return new Ts().fromJson(e,n)}static fromJsonString(e,n){return new Ts().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ts,e,n)}}Ts.runtime=N;Ts.typeName="livekit.SubscriptionResponse";Ts.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:N.getEnumType(sf)}]);function mz(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const vz=5e3,Hu=[];class re extends Zo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=re.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=et,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),vz):this.handleAppVisibilityChanged()},this.log=Us((i=r.loggerName)!==null&&i!==void 0?i:Vo.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=re.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ft(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===re.Kind.Video&&(n="video"),this.attachedElements.length===0&&re.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(Hu.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&Hu.splice(Hu.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),gc(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?xe.AudioPlaybackStarted:xe.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?xe.AudioPlaybackFailed:xe.VideoPlaybackFailed,o):o.name==="AbortError"?et.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):et.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(s=>s.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(xe.ElementAttached,e),e}detach(e){try{if(e){Rc(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(xe.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{Rc(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(xe.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=Us(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),Hu.forEach(r=>{r.parentElement||(n=!1)}),n&&Hu.push(e)}}handleAppVisibilityChanged(){return X(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){Pr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Pr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function gc(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!Dl()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Dl()||Yc())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function Rc(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(c){c.Audio="audio",c.Video="video",c.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(c){c.Camera="camera",c.Microphone="microphone",c.ScreenShare="screen_share",c.ScreenShareAudio="screen_share_audio",c.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(c){c.Active="active",c.Paused="paused",c.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(c){switch(c){case e.Audio:return Kn.AUDIO;case e.Video:return Kn.VIDEO;default:return Kn.DATA}}t.kindToProto=i;function o(c){switch(c){case Kn.AUDIO:return e.Audio;case Kn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=o;function s(c){switch(c){case n.Camera:return nn.CAMERA;case n.Microphone:return nn.MICROPHONE;case n.ScreenShare:return nn.SCREEN_SHARE;case n.ScreenShareAudio:return nn.SCREEN_SHARE_AUDIO;default:return nn.UNKNOWN}}t.sourceToProto=s;function a(c){switch(c){case nn.CAMERA:return n.Camera;case nn.MICROPHONE:return n.Microphone;case nn.SCREEN_SHARE:return n.ScreenShare;case nn.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function l(c){switch(c){case _l.ACTIVE:return r.Active;case _l.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=l})(re||(re={}));function lP(t,e,n){var r;const i=(r=mz(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&sy(i.audio,e),i.video&&sy(i.video,n),i}function sy(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function $p(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":sy(r,i.resolution);break;default:r[o]=i[o]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function Cz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return X(this,void 0,void 0,function*(){const n=Dx();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield Ps(e),r.getByteTimeDomainData(o);const a=o.some(l=>l!==128&&l!==0);return n.close(),!a}return!1})}function Dx(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function yz(t){return t===re.Source.Microphone?"audioinput":t===re.Source.Camera?"videoinput":void 0}function xz(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Dl()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function cP(t){const e=t.split("/")[1].toLowerCase();if(!aP.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function Iz(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new Hi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Ft(t){return t instanceof re?{trackSid:t.sid,trackSource:t.source,trackMuted:t.isMuted,trackEnabled:t.mediaStreamTrack.enabled,trackKind:t.kind}:{trackSid:t.trackSid,trackName:t.trackName,track:t.track?Ft(t.track):void 0,trackEnabled:t.isEnabled,trackEncrypted:t.isEncrypted,trackMimeType:t.mimeType}}const bz="|",bS="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Az(t){const e=t.split(bz);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function Ps(t){return X(this,void 0,void 0,function*(){return new Promise(e=>On.setTimeout(e,t))})}function AS(){return"addTransceiver"in RTCPeerConnection.prototype}function wS(){return"addTrack"in RTCPeerConnection.prototype}function wz(){if(!("getCapabilities"in RTCRtpSender)||Dl())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function Sz(){if(!("getCapabilities"in RTCRtpSender)||Yc())return!1;if(Dl()){const n=Vs();if(n!=null&&n.version&&Px(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function wd(t){return t==="av1"||t==="vp9"}function ay(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const kz={Chrome:"100",Safari:"15",Firefox:"100"};function Ez(t){if(!Pr()||!("setCodecPreferences"in t))return!1;const e=Vs();if(!(e!=null&&e.name)||!e.version)return!1;const n=kz[e.name];return n?Px(e.version,n)>=0:!1}function Yc(){var t;return((t=Vs())===null||t===void 0?void 0:t.name)==="Firefox"}function Tz(){var t;return((t=Vs())===null||t===void 0?void 0:t.name)==="Chrome"}function Dl(){var t;return((t=Vs())===null||t===void 0?void 0:t.name)==="Safari"}function Rz(){const t=Vs();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function uP(){return Pr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function Pr(){return typeof document<"u"}function Pl(){return navigator.product=="ReactNative"}function ly(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function dP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function fP(){if(!Pl())return;let t=dP();if(t)return t.platform}function SS(){if(Pr())return window.devicePixelRatio;if(Pl()){let t=dP();if(t)return t.devicePixelRatio}return 1}function Px(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const s=parseInt(n[o],10),a=parseInt(r[o],10);if(s>a)return 1;if(s<a)return-1;if(o===i-1&&s===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function _z(t){for(const e of t)e.target.handleResize(e)}function Dz(t){for(const e of t)e.target.handleVisibilityChanged(e)}let zm=null;const kS=()=>(zm||(zm=new ResizeObserver(_z)),zm);let Hm=null;const ES=()=>(Hm||(Hm=new IntersectionObserver(Dz,{root:null,rootMargin:"0px"})),Hm);function Pz(){var t;const e=new us({sdk:Jc.JS,protocol:hz,version:fz});return Pl()&&(e.os=(t=fP())!==null&&t!==void 0?t:""),e}function TS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(t/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Zu;function Zm(){if(!Zu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Zu]=r.stream.getAudioTracks(),!Zu)throw Error("Could not get empty media stream audio track");Zu.enabled=!1}return Zu.clone()}class hP{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>X(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function Nz(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=Dx();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:s,cleanup:()=>X(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class Ki{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function Bz(t){return aP.includes(t)}function vl(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function Oz(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function RS(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const _S="default";class sr{static getInstance(){return this.instance===void 0&&(this.instance=new sr),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return X(this,void 0,void 0,function*(){if(((r=sr.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){et.debug("awaiting getUserMedia promise");try{e?yield sr.userMediaPromiseMap.get(e):yield Promise.all(sr.userMediaPromiseMap.values())}catch{et.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(Dl()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(s=>{const a=s.label==="",l=e?s.kind===e:!0;return a&&l}))){const s={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(s);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(l=>{l.stop()})}return e&&(i=i.filter(o=>o.kind===e)),i})}normalizeDeviceId(e,n,r){return X(this,void 0,void 0,function*(){if(n!==_S)return n;const o=(yield this.getDevices(e)).find(s=>s.groupId===r&&s.deviceId!==_S);return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?sr.userMediaPromiseMap.has(e):sr.userMediaPromiseMap.size>0}}sr.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];sr.userMediaPromiseMap=new Map;const Fz=1e3;class qc extends re{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,n,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Rx(()=>X(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>X(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(xe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Ki,this.pauseUpstreamLock=new Ki,this.processorLock=new Ki,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==re.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return X(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{Rc(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");gc(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{gc(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fz;var n;return X(this,void 0,void 0,function*(){if(this.kind===re.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=Vs())===null||n===void 0?void 0:n.os)==="iOS"&&(yield Ps(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield Ps(50)}throw new po("unable to get track dimensions after timeout")})}getDeviceId(){return X(this,void 0,void 0,function*(){if(this.source===re.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===re.Kind.Audio?"audioinput":"videoinput";return sr.getInstance().normalizeDeviceId(r,e,n)})}mute(){return X(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return X(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return X(this,void 0,void 0,function*(){if(!this.sender)throw new po("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return X(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const n={audio:!1,video:!1};this.kind===re.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(o=>{Rc(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(xe.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xe.Muted:xe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return X(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),uP()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return X(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(xe.UpstreamPaused,this);const n=Vs();if((n==null?void 0:n.name)==="Safari"&&Px(n.version,"12.0")<0)throw new Tx("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return X(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(xe.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return X(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return X(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),gc(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const s={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(s),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(Rc(this._mediaStreamTrack,a),gc(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return X(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class Mz extends Zo.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:o,data:s}=n.data;switch(o){case"error":et.error(s.error.message),this.emit(Ia.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==s.enabled&&s.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Ia.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(s.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(Ia.ParticipantEncryptionStatusChanged,s.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(Da.KeyRatcheted,s.material,s.keyIndex);break}},this.onWorkerError=n=>{et.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ia.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!sz())throw new Tx("tried to setup end-to-end encryption on an unsupported browser");if(et.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(et.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){et.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?et.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Te.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ue.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Nn.NONE,i.identity)),e.on(ue.ConnectionStateChanged,r=>{r===ft.Connected&&e.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Nn.NONE,i.identity)})})}).on(ue.TrackUnsubscribed,(r,i,o)=>{var s;const a={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(s=this.worker)===null||s===void 0||s.postMessage(a)}).on(ue.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ue.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(de.LocalTrackPublished,r=>X(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(Da.SetKey,r=>this.postKey(r)).on(Da.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(s)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?cP(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof qc)||!n){n||et.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return X(this,void 0,void 0,function*(){if(this.worker){if(ry()){const o={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(fh in e&&i){const l={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(l);return}let o=e.writableStream,s=e.readableStream;if(!o||!s){const l=e.createEncodedStreams();e.writableStream=l.writable,o=l.writable,e.readableStream=l.readable,s=l.readable}const a={kind:"decode",data:{readableStream:s,writableStream:o,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[s,o])}e[fh]=!0}})}handleSender(e,n,r){var i;if(!(fh in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(ry()){et.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{et.info("initialize encoded streams");const o=e.createEncodedStreams(),s={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s,[o.readable,o.writable])}e[fh]=!0}}}var Sd;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Sd||(Sd={}));class Lz{constructor(){this.pendingTasks=new Map,this.taskMutex=new Ki,this.nextTaskIndex=0}run(e){return X(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Sd.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Sd.RUNNING,yield e()}finally{n.status=Sd.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return X(this,void 0,void 0,function*(){return this.run(()=>X(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const Uz=["syncState","trickle","offer","answer","simulate","leave"];function Vz(t){const e=Uz.indexOf(t.case)>=0;return et.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var qt;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(qt||(qt={}));class Nx{get currentState(){return this.state}get isDisconnected(){return this.state===qt.DISCONNECTING||this.state===qt.DISCONNECTED}get isEstablishingConnection(){return this.state===qt.CONNECTING||this.state===qt.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=qt.DISCONNECTED,this.log=et,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Us((r=n.loggerName)!==null&&r!==void 0?r:Vo.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new Lz,this.queuedRequests=[],this.closingLock=new Ki,this.connectionLock=new Ki,this.state=qt.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return X(this,void 0,void 0,function*(){return this.state=qt.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return X(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=qt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=Oz(e),e=e.replace(/\/$/,""),e+="/rtc";const o=Pz(),s=Gz(n,o,r);return new Promise((a,l)=>X(this,void 0,void 0,function*(){const c=yield this.connectionLock.lock();try{const u=()=>X(this,void 0,void 0,function*(){this.close(),clearTimeout(d),l(new Rt("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),l(new Rt("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(e+s),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>X(this,void 0,void 0,function*(){if(this.state!==qt.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(e.substring(2),"/validate").concat(s));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();l(new Rt(p,0,h.status))}else l(new Rt("Internal error",2,h.status))}catch{l(new Rt("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>X(this,void 0,void 0,function*(){var h,p,g,C;let v;if(typeof f.data=="string"){const m=JSON.parse(f.data);v=So.fromJson(m)}else if(f.data instanceof ArrayBuffer)v=So.fromBinary(new Uint8Array(f.data));else{this.log.error("could not decode websocket message: ".concat(typeof f.data),this.logContext);return}if(this.state!==qt.CONNECTED){let m=!1;if(((h=v.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=qt.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=v.message.value.pingTimeout,this.pingIntervalDuration=v.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(v.message.value)):this.state===qt.RECONNECTING&&v.message.case!=="leave"?(this.state=qt.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=v.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((g=v.message)===null||g===void 0?void 0:g.value):(a(),m=!0)):this.isEstablishingConnection&&v.message.case==="leave"?l(new Rt("Received leave request while trying to (re)connect",4)):r.reconnect||l(new Rt("did not receive join response, got ".concat((C=v.message)===null||C===void 0?void 0:C.case," instead"))),!m)return}this.signalLatency&&(yield Ps(this.signalLatency)),this.handleSignalResponse(v)}),this.ws.onclose=f=>{this.isEstablishingConnection&&l(new Rt("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:f.reason,state:this.state})),this.handleOnClose(f.reason)}}finally{c()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return X(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(e&&(this.state=qt.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,Ps(250)])),this.ws=void 0}}finally{e&&(this.state=qt.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:rp(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:rp(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new ji({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new zi({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new To({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new Eo({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new Do({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:He.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Bo({timestamp:He.parse(Date.now()),rtt:He.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new mi({canReconnect:!1,reason:Ds.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return X(this,void 0,void 0,function*(){if(!n&&!Vz(e)&&this.state===qt.RECONNECTING){this.queuedRequests.push(()=>X(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield Ps(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new fs({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const s=DS(i.value);this.onAnswer&&this.onAnswer(s)}else if(i.case==="offer"){const s=DS(i.value);this.onOffer&&this.onOffer(s)}else if(i.case==="trickle"){const s=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(s,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return X(this,void 0,void 0,function*(){if(this.state===qt.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=On.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&On.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=On.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&On.clearInterval(this.pingInterval)}}function DS(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function rp(t){return new dr({sdp:t.sdp,type:t.type})}function Gz(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Pl()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var pP={},gP={exports:{}},PS=gP.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(PS).forEach(function(t){var e=PS[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var mP=gP.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,l,c,u){if(u&&!c)l[u]=e(a[1]);else for(var d=0;d<c.length;d+=1)a[d+1]!=null&&(l[c[d]]=e(a[d+1]))},r=function(a,l,c){var u=a.name&&a.names;a.push&&!l[a.push]?l[a.push]=[]:u&&!l[a.name]&&(l[a.name]={});var d=a.push?{}:u?l[a.name]:l;n(c.match(a.reg),d,a.names,a.name),a.push&&l[a.push].push(d)},i=mP,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var l={},c=[],u=l;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(c.push({rtp:[],fmtp:[]}),u=c[c.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var g=i[f][p];if(g.reg.test(h))return r(g,u,h)}}),l.media=c,l};var s=function(a,l){var c=l.split(/=(.+)/,2);return c.length===2?a[c[0]]=e(c[1]):c.length===1&&l.length>1&&(a[c[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var l=[],c=a.split(" ").map(e),u=0;u<c.length;u+=3)l.push({component:c[u],ip:c[u+1],port:c[u+2]});return l},t.parseImageAttributes=function(a){return a.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(s,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(l){return l.split(",").map(function(c){var u,d=!1;return c[0]!=="~"?u=e(c):(u=e(c.substring(1,c.length)),d=!0),{scid:u,paused:d}})})}})(pP);var $m=mP,Wz=/%[sdv%]/g,jz=function(t){var e=1,n=arguments,r=n.length;return t.replace(Wz,function(i){if(e>=r)return i;var o=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},$u=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var o=0;o<e.names.length;o+=1){var s=e.names[o];e.name?i.push(n[e.name][s]):i.push(n[e.names[o]])}else i.push(n[e.name]);return jz.apply(null,i)},zz=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Hz=["i","c","b","a"],Zz=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var n=e.outerOrder||zz,r=e.innerOrder||Hz,i=[];return n.forEach(function(o){$m[o].forEach(function(s){s.name in t&&t[s.name]!=null?i.push($u(o,s,t)):s.push in t&&t[s.push]!=null&&t[s.push].forEach(function(a){i.push($u(o,s,a))})})}),t.media.forEach(function(o){i.push($u("m",$m.m[0],o)),r.forEach(function(s){$m[s].forEach(function(a){a.name in o&&o[a.name]!=null?i.push($u(s,a,o)):a.push in o&&o[a.push]!=null&&o[a.push].forEach(function(l){i.push($u(s,a,l))})})})}),i.join(`\r
`)+`\r
`},$z=pP,Xz=Zz,Xm=Xz,ad=$z.parse;const NS=.7,_c={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class BS extends Zo.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=et,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Rx(o=>X(this,void 0,void 0,function*(){this.emit(_c.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Us((i=r.loggerName)!==null&&i!==void 0?i:Vo.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=Tz()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return X(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return X(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:o}=Jz(e);this.remoteStereoMids=i,this.remoteNackMids=o}else if(e.type==="answer"){const i=ad((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||o.mid!=s.transceiver.mid)return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config=c.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(c.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),l=!0;break}return l||s.maxbr>0&&o.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),r=Xm(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(_c.NegotiationComplete),e.sdp&&ad(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(_c.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){var n;return X(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=ad((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"?OS(o,[],[]):o.type==="video"&&(Kz(o),this.trackBitrates.some(s=>{if(!o.msid||!s.cid||!o.msid.includes(s.cid))return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config.includes("x-google-start-bitrate")||(c.config+=";x-google-start-bitrate=".concat(Math.round(s.maxbr*NS))),c.config.includes("x-google-max-bitrate")||(c.config+=";x-google-max-bitrate=".concat(s.maxbr)),l=!0;break}return l||o.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(s.maxbr*NS),";x-google-max-bitrate=").concat(s.maxbr)}),!0}))}),yield this.setMungedSDP(r,Xm(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return X(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=ad((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&OS(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Xm(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new gn("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new gn("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return X(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const s=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return i.get(s)})}setMungedSDP(e,n,r){return X(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const s={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new iy(o)}})}}function OS(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function Kz(t){var e,n,r,i;const o=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!wd(o))return;let s=0;((r=t.ext)===null||r===void 0?void 0:r.some(l=>l.uri===bS?!0:(l.value>s&&(s=l.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:s+1,uri:bS})}function Jz(t){var e;const n=[],r=[],i=ad((e=t.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(s=>{var a;s.type==="audio"&&(s.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),!((a=s.rtcpFb)===null||a===void 0)&&a.some(l=>l.payload===o&&l.type==="nack")&&r.push(s.mid),s.fmtp.some(l=>l.payload===o?(l.config.includes("sprop-stereo=1")&&n.push(s.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const cy="vp8",Yz={audioBitrate:tp.music.maxBitrate,audioPreset:tp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:_x.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:cy,backupCodec:!0},vP={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},CP={resolution:lf.h720.resolution},qz={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new Wj,disconnectOnPageLeave:!0,expWebAudioMix:!1},Bx={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var vn;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(vn||(vn={}));class Qz{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=Bx.peerConnectionTimeout,this.log=et,this.updateState=()=>{var s;const a=this.state,l=this.requiredTransports.map(c=>c.getConnectionState());l.every(c=>c==="connected")?this.state=vn.CONNECTED:l.some(c=>c==="failed")?this.state=vn.FAILED:l.some(c=>c==="connecting")?this.state=vn.CONNECTING:l.every(c=>c==="closed")?this.state=vn.CLOSED:l.some(c=>c==="closed")?this.state=vn.CLOSING:l.every(c=>c==="new")&&(this.state=vn.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(vn[a]," to ").concat(vn[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Us((i=r.loggerName)!==null&&i!==void 0?i:Vo.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const o={optional:[{googDscp:!0}]};this.publisher=new BS(e,o,r),this.subscriber=new BS(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Jn.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Jn.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,s)},this.subscriber.onTrack=s=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,s)},this.publisher.onOffer=s=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,s)},this.state=vn.NEW,this.connectionLock=new Ki}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return X(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return X(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return X(this,void 0,void 0,function*(){n===Jn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return X(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return X(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,n)))}finally{i()}})}negotiate(e){return X(this,void 0,void 0,function*(){return new Promise((n,r)=>X(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(_c.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(_c.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(s=>{clearTimeout(i),r(s)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Jn.PUBLISHER?this.publisher.getConnectedAddress():e===Jn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return X(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((o,s)=>X(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),On.clearTimeout(l),s(new Rt("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const l=On.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),s(new Rt("could not establish pc connection"))},r);for(;this.state!==vn.CONNECTED;)if(yield Ps(50),n!=null&&n.signal.aborted){s(new Rt("room connection has been cancelled",3));return}On.clearTimeout(l),n==null||n.signal.removeEventListener("abort",a),o()}))})}}const FS="_lossy",MS="_reliable",eH=2*1e3,LS="leave-reconnect";var ki;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(ki||(ki={}));class tH extends Zo.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Bx.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=ki.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=et,this.handleDataChannel=r=>{let{channel:i}=r;return X(this,void 0,void 0,function*(){if(i){if(i.label===MS)this.reliableDCSub=i;else if(i.label===FS)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>X(this,void 0,void 0,function*(){var i,o;const s=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const l=Co.fromBinary(new Uint8Array(a));((i=l.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(Te.ActiveSpeakersUpdate,l.value.value.speakers):((o=l.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(Te.DataPacketReceived,l.value.value,l.kind)}finally{s()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?mn.LOSSY:mn.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(Te.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(a===null){o(s);return}r===LS&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=On.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===ki.Connected&&r();const o=()=>{this.off(Te.Disconnected,s),r()},s=()=>{this.off(Te.Restarted,o),i()};this.once(Te.Restarted,o),this.once(Te.Disconnected,s)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(Te.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===qt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Qo.RR_SIGNAL_DISCONNECTED))},this.log=Us((n=e.loggerName)!==null&&n!==void 0?n:Vo.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Nx(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Ki,this.dataProcessLock=new Ki,this.dcBufferStatus=new Map([[mn.LOSSY,!0],[mn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Te.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Te.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Te.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Te.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Te.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Te.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Te.StreamStateChanged,r)}get logContext(){var e,n,r,i,o,s;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(s=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||s===void 0?void 0:s.identity}}join(e,n,r,i){return X(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof Rt&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw o}})}close(){return X(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(Te.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return X(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return X(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new po("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Rt("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),n(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return X(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return X(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==vn.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new Qz(r,e.subscriberPrimary,this.loggerOptions),this.emit(Te.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,s)=>X(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===vn.CONNECTED){const a=this.pcState===ki.New;this.pcState=ki.Connected,a&&this.emit(Te.Connected,e)}else i===vn.FAILED&&this.pcState===ki.Connected&&(this.pcState=ki.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?Qo.RR_SUBSCRIBER_FAILED:Qo.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(Te.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>X(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>X(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Te.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(Te.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Te.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Qo.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(LS)):(this.emit(Te.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const s={urls:o.urls};o.username&&(s.username=o.username),o.credential&&(s.credential=o.credential),i.push(s)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===qi.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(FS,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(MS,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(n);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],s=[],a=[];i.codecs.forEach(l=>{const c=l.mimeType.toLowerCase();if(c==="audio/opus"){o.push(l);return}if(!(c==="video/".concat(r))){a.push(l);return}if(r==="h264"){l.sdpFmtpLine&&l.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(l):s.push(l);return}o.push(l)}),Ez(e)&&e.setCodecPreferences(o.concat(s,a))}createSender(e,n,r){return X(this,void 0,void 0,function*(){if(AS())return yield this.createTransceiverRTCRtpSender(e,n,r);if(wS())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new gn("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return X(this,void 0,void 0,function*(){if(AS())return this.createSimulcastTransceiverSender(e,n,r,i);if(wS())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new gn("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const s=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o);return e.kind===re.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(s,e.kind,n.videoCodec),e.codec=n.videoCodec),s.sender})}createSimulcastTransceiverSender(e,n,r,i){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(s,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,s.sender),s.sender})}createRTCRtpSender(e){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return X(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){et.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===qi.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:vn.NEW)===vn.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let s=!0;o instanceof gn?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),s=!1):o instanceof Ql||(this.fullReconnectOnNext=!0),s?this.handleDisconnect("reconnect",Qo.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Te.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){var n,r,i;return X(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new gn("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Te.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Ql;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(s){throw s instanceof Rt&&s.reason===0?new gn("could not reconnect, token might be expired"):new Ql}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Te.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==qt.CONNECTED)throw new Ql("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(Te.Restarted)}catch(o){const s=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(s){yield this.restartConnection(s);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){var n;return X(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new gn("could not reconnect, url or token not saved");if(!this.pcManager)throw new gn("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Te.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof Rt&&r.reason===0?new gn("could not reconnect, token might be expired"):r instanceof Rt&&r.reason===4?r:new Ql(i)}if(this.emit(Te.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==qt.CONNECTED)throw new Ql("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Te.Resumed)})}waitForPCInitialConnection(e,n){return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return X(this,void 0,void 0,function*(){this.pcState=ki.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Ps(eH),!this.pcManager)throw new gn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=ki.Connected}catch(e){throw this.pcState=ki.Disconnected,new Rt("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return X(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return X(this,void 0,void 0,function*(){if(!this.pcManager)throw new gn("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!i)throw new Rt("".concat(o," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const s=this.dataChannelForKind(e,n);if((s==null?void 0:s.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield Ps(50)}throw new Rt("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return X(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==vn.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return X(this,void 0,void 0,function*(){return new Promise((e,n)=>X(this,void 0,void 0,function*(){if(!this.pcManager){n(new iy("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(Te.Closing,i),this.pcManager.publisher.once(_c.RTPVideoPayloadTypes,o=>{const s=new Map;o.forEach(a=>{const l=a.codec.toLowerCase();Bz(l)&&s.set(a.payload,l)}),this.emit(Te.RTPVideoMapUpdate,s)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof iy&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Qo.RR_UNKNOWN),n(o)}finally{this.off(Te.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===mn.LOSSY)return this.lossyDCSub;if(e===mn.RELIABLE)return this.reliableDCSub}else{if(e===mn.LOSSY)return this.lossyDC;if(e===mn.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,l=new Array;e.forEach(c=>{c.isDesired!==a&&l.push(c.trackSid)}),this.client.sendSyncState(new Po({answer:o?rp({sdp:o.sdp,type:o.type}):void 0,offer:s?rp({sdp:s.sdp,type:s.type}):void 0,subscription:new gi({trackSids:l,subscribe:!a,participantTracks:[]}),publishTracks:Iz(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new No({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(mn.LOSSY),Jn.PUBLISHER),n(this.dataChannelForKind(mn.RELIABLE),Jn.PUBLISHER),n(this.dataChannelForKind(mn.LOSSY,!0),Jn.SUBSCRIBER),n(this.dataChannelForKind(mn.RELIABLE,!0),Jn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&On.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Pr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Pr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Ql extends Error{}class US{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return ly(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return X(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),et.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return X(this,void 0,void 0,function*(){const n=yield fetch("".concat(nH(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Rt("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function nH(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const Ox=2e3;function Xp(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class wr extends qc{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,re.Kind.Audio,n,r,o),this.stopOnMute=!1,this.monitorSender=()=>X(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}s&&this.prevStats&&(this._currentBitrate=Xp(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return X(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||vl(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==vl(this._constraints.deviceId);return this.source===re.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return X(this,void 0,void 0,function*(){let n;if(e){const r=$p({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return X(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){Pr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Ox)))}setProcessor(e){var n;return X(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return X(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return X(this,void 0,void 0,function*(){const e=yield Cz(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(xe.AudioSilenceDetected)),e})}}function yP(t,e,n){switch(t.kind){case"audio":return new wr(t,e,!1,void 0,n);case"video":return new li(t,e,!1,n);default:throw new po("unsupported track type: ".concat(t.kind))}}const rH=Object.values(lf),iH=Object.values(oy),oH=Object.values(_x),sH=[lf.h180,lf.h360],aH=[oy.h180,oy.h360],lH=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new It(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),uy=["q","h","f"];function dy(t,e,n,r){var i,o;let s=r==null?void 0:r.videoEncoding;t&&(s=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,l=r==null?void 0:r.scalabilityMode,c=r==null?void 0:r.videoCodec;if(!s&&!a&&!l||!e||!n)return[{}];s||(s=uH(t,e,n,c),et.debug("using video encoding",s));const u=new It(e,n,s.maxBitrate,s.maxFramerate,s.priority);if(l&&wd(c)){et.debug("using svc with scalabilityMode ".concat(l));const h=new xP(l),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));for(let g=0;g<h.spatial;g+=1)p.push({rid:uy[2-g],maxBitrate:s.maxBitrate/Math.pow(3,g),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=l,et.debug("encodings",p),p}if(!a)return[s];let d=[];t?d=(i=GS(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:VS(t,u):d=(o=GS(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:VS(t,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(e,n);if(p>=960&&f)return Km(e,n,[h,f,u]);if(p>=480)return Km(e,n,[h,u])}return Km(e,n,[u])}function cH(t,e,n){var r,i,o,s;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&et.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),l=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,c=(o=a.height)!==null&&o!==void 0?o:(s=t.dimensions)===null||s===void 0?void 0:s.height;return dy(t.source===re.Source.ScreenShare,l,c,n)}function uH(t,e,n,r){const i=dH(t,e,n);let{encoding:o}=i[0];const s=Math.max(e,n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o=l.encoding,l.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function dH(t,e,n){if(t)return oH;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?rH:iH}function VS(t,e){if(t)return lH(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?sH:aH}function Km(t,e,n){const r=[];if(n.forEach((i,o)=>{if(o>=uy.length)return;const s=Math.min(t,e),l={rid:uy[o],scaleResolutionDownBy:Math.max(1,s/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(l.maxFramerate=i.encoding.maxFramerate);const c=Yc()||o===0;i.encoding.priority&&c&&(l.priority=i.encoding.priority,l.networkPriority=i.encoding.priority),r.push(l)}),Pl()&&fP()==="ios"){let i;r.forEach(s=>{i?s.maxFramerate&&s.maxFramerate>i&&(i=s.maxFramerate):i=s.maxFramerate});let o=!0;r.forEach(s=>{var a;s.maxFramerate!=i&&(o&&(o=!1,et.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),et.info('Setting framerate of encoding "'.concat((a=s.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),s.maxFramerate=i)})}return r}function GS(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class xP{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const fH=5e3;class li extends qc{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,re.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>X(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const s=new Map(o.map(a=>[a.rid,a]));if(this.prevStats){let a=0;s.forEach((l,c)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(c);a+=Xp(l,d)}),this._currentBitrate=a}this.prevStats=s}),this.senderLock=new Ki}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!Pr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Ox))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,o,s;return X(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,l=tc(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0)o=c.value,a=!1,yield(s=o.sender)===null||s===void 0?void 0:s.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,o,s;return X(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,l=tc(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;yield(s=u.sender)===null||s===void 0?void 0:s.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return X(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return X(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const s={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(s.jitter=a.jitter,s.packetsLost=a.packetsLost,s.roundTripTime=a.roundTripTime),n.push(s)}}),n})}setPublishingQuality(e){const n=[];for(let r=xn.LOW;r<=xn.HIGH;r+=1)n.push(new Zi({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}setDeviceId(e){return X(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===vl(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||vl(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,o;return X(this,void 0,void 0,function*(){let s;if(e){const u=$p({video:e});typeof u.video!="boolean"&&(s=u.video)}yield this.restart(s);try{for(var a=!0,l=tc(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,s,a,l,c;return X(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((l=this.processor)===null||l===void 0)&&l.processedTrack)try{for(var u=!0,d=tc(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(c=a.sender)===null||c===void 0?void 0:c.replaceTrack(this.processor.processedTrack)}catch(h){o={error:h}}finally{try{!u&&!i&&(s=d.return)&&(yield s.call(d))}finally{if(o)throw o.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},fH))}setPublishingCodecs(e){var n,r,i,o,s,a,l;return X(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(n=!0,r=tc(e);i=yield r.next(),o=i.done,!o;n=!0){l=i.value,n=!1;const u=l;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const f of u.qualities)if(f.enabled){c.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield WS(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){s={error:u}}finally{try{!n&&!o&&(a=r.return)&&(yield a.call(r))}finally{if(s)throw s.error}}return c})}setPublishingLayers(e){return X(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield WS(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return X(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),uP()&&this.isInBackground&&this.source===re.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function WS(t,e,n,r,i,o){return X(this,void 0,void 0,function*(){const s=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:l}=a;if(!l)return;if(l.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let c=!1;!1&&l[0].scalabilityMode||l.forEach((d,f)=>{var h;let p=(h=d.rid)!==null&&h!==void 0?h:"";p===""&&(p="q");const g=IP(p),C=n.find(v=>v.quality===g);C&&d.active!==C.enabled&&(c=!0,d.active=C.enabled,i.debug("setting layer ".concat(C.quality," to ").concat(d.active?"enabled":"disabled"),o),Yc()&&(C.enabled?(d.scaleResolutionDownBy=e[f].scaleResolutionDownBy,d.maxBitrate=e[f].maxBitrate,d.maxFrameRate=e[f].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),c&&(a.encodings=l,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:a.encodings})),yield t.setParameters(a))}finally{s()}})}function IP(t){switch(t){case"f":return xn.HIGH;case"h":return xn.MEDIUM;case"q":return xn.LOW;default:return xn.HIGH}}function jS(t,e,n,r){if(!n)return[new ur({quality:xn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,o=new xP(i),s=[];for(let a=0;a<o.spatial;a+=1)s.push(new ur({quality:xn.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return s}return n.map(i=>{var o,s,a;const l=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let c=IP((s=i.rid)!==null&&s!==void 0?s:"");return new ur({quality:c,width:Math.ceil(t/l),height:Math.ceil(e/l),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class bP extends re{constructor(e,n,r,i,o){super(e,r,o),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xe.Muted:xe.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(xe.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return X(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Ox))}}class Cl extends bP{constructor(e,n,r,i,o,s){super(e,n,re.Kind.Audio,r,s),this.monitorReceiver=()=>X(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Xp(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Pl()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Pl())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return X(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(ay(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&ay(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(xe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(xe.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return X(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Jm=100;class kd extends bP{constructor(e,n,r,i,o){super(e,n,re.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>X(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=Xp(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=Rx(()=>{this.updateDimensions()},Jm),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?Rc(this._mediaStreamTrack,n):gc(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new hH(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return X(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,n={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return X(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,l)=>Math.max(a,l.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,o=this.elementInfos.some(a=>a.pictureInPicture),s=this.elementInfos.some(a=>a.visible)&&!i||o;if(this.lastVisible!==s){if(!s&&Date.now()-r<Jm){On.setTimeout(()=>{this.updateVisibility()},Jm);return}this.lastVisible=s,this.emit(xe.VisibilityChanged,s,this)}}updateDimensions(){var e,n;let r=0,i=0;const o=this.getPixelDensity();for(const s of this.elementInfos){const a=s.width()*o,l=s.height()*o;a+l>r+i&&(r=a,i=l)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(xe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?SS():n||(SS()>2?2:1)}}class hH{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:s}=r;o===this.element&&(this.isIntersecting=s,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??zS(e),this.isPiP=Pr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=zS(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,ES().observe(this.element),kS().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=ES())===null||e===void 0||e.unobserve(this.element),(n=kS())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function zS(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:o}=t,{opacity:s,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(s!==""?parseFloat(s)>0:!0)&&a!=="none"}class es extends Zo.EventEmitter{constructor(e,n,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Nn.NONE,this.log=et,this.handleMuted=()=>{this.emit(xe.Muted)},this.handleUnmuted=()=>{this.emit(xe.Unmuted)},this.log=Us((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:Vo.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=re.Source.Unknown}setTrack(e){this.track&&(this.track.off(xe.Muted,this.handleMuted),this.track.off(xe.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(xe.Muted,this.handleMuted),e.on(xe.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ft(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Nn.NONE}get audioTrack(){if(this.track instanceof wr||this.track instanceof Cl)return this.track}get videoTrack(){if(this.track instanceof li||this.track instanceof kd)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=re.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===re.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(es||(es={}));class cf extends es{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(xe.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(xe.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(xe.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return X(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return X(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return X(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return X(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var di;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(di||(di={}));function pH(t){switch(t){case os.EXCELLENT:return di.Excellent;case os.GOOD:return di.Good;case os.POOR:return di.Poor;case os.LOST:return di.Lost;default:return di.Unknown}}class AP extends Zo.EventEmitter{get logContext(){var e,n;return Object.assign(Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i,o){var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=di.Unknown,this.log=et,this.log=Us((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:Vo.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(re.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(re.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(re.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(de.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(de.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,o,s;const a=this.permissions,l=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((s=this.permissions)===null||s===void 0?void 0:s.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((c,u)=>{var d;return c!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,l&&this.emit(de.ParticipantPermissionsChanged,a),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(de.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=pH(e),n!==this._connectionQuality&&this.emit(de.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Cl||n.track instanceof wr)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(xe.Muted,()=>{this.emit(de.TrackMuted,e)}),e.on(xe.Unmuted,()=>{this.emit(de.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case re.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case re.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function gH(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new _o({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class Fx extends es{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=xn.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(xe.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new gi({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Io({participantSid:"",trackSids:[this.trackSid]})]});this.emit(xe.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?es.SubscriptionStatus.Unsubscribed:super.isSubscribed?es.SubscriptionStatus.Subscribed:es.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?es.PermissionStatus.Allowed:es.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof kd&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof kd&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(xe.VisibilityChanged,this.handleVisibilityChange),i.off(xe.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(xe.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(xe.VisibilityChanged,this.handleVisibilityChange),e.on(xe.Ended,this.handleEnded),this.emit(xe.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(xe.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?xe.Muted:xe.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(xe.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(xe.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===re.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof kd&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new ko({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=xn.HIGH,this.emit(xe.UpdateSettings,e)}}class uf extends AP{static fromParticipantInfo(e,n){return new uf(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,o,s){super(n,r||"",i,o,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(xe.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Ft(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(xe.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(xe.SubscriptionPermissionChanged,n=>{this.emit(de.TrackSubscriptionPermissionChanged,e,n)}),e.on(xe.SubscriptionStatusChanged,n=>{this.emit(de.TrackSubscriptionStatusChanged,e,n)}),e.on(xe.Subscribed,n=>{this.emit(de.TrackSubscribed,n,e)}),e.on(xe.Unsubscribed,n=>{this.emit(de.TrackUnsubscribed,n,e)}),e.on(xe.SubscriptionFailed,n=>{this.emit(de.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:re.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,o,s){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(s===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(de.TrackSubscriptionFailed,n);return}s===void 0&&(s=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,o,s-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Ft(a))),this.emit(de.TrackSubscriptionFailed,n);return}const l=e.kind==="video";let c;return l?c=new kd(e,n,i,o):c=new Cl(e,n,i,this.audioContext,this.audioOutput),c.source=a.source,c.isMuted=a.isMuted,c.setMediaStream(r),c.start(),a.setTrack(c),this.volumeMap.has(a.source)&&c instanceof Cl&&c.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var o,s;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const l=re.kindFromProto(i.type);if(!l)return;a=new Fx(l,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(s=this.loggerOptions)===null||s===void 0?void 0:s.loggerName}),a.updateInfo(i),r.set(i.sid,a);const c=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));c&&a.source!==re.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Ft(c),newTrack:Ft(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Ft(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(de.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case re.Kind.Audio:this.audioTracks.delete(e);break;case re.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(de.TrackUnpublished,r)}setAudioOutput(e){return X(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Cl&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class fy extends AP{constructor(e,n,r,i){super(e,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Nn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new hP)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>gH(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Ft(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Ft(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Ft(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>X(this,void 0,void 0,function*(){var s,a,l,c,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(o.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!f.videoTrack)return;const C=yield f.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var h=!0,p=tc(C),g;g=yield p.next(),s=g.done,!s;h=!0){c=g.value,h=!1;const v=c;gz(v)&&(this.log.debug("publish ".concat(v," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Ft(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,v,f.options))}}catch(v){a={error:v}}finally{try{!h&&!s&&(l=p.return)&&(yield l.call(p))}finally{if(a)throw a.error}}}else o.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.tracks.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>X(this,void 0,void 0,function*(){if(o.source===re.Source.ScreenShare||o.source===re.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Ft(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof wr||o instanceof li)try{if(Pr())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===re.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),Ft(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Ft(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Ft(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Nn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(Te.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(Te.Connected,this.handleReconnected).on(Te.SignalRestarted,this.handleReconnected).on(Te.SignalResumed,this.handleReconnected).on(Te.Restarting,this.handleReconnecting).on(Te.Resuming,this.handleReconnecting).on(Te.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Te.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Te.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(re.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(re.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(re.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(de.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return X(this,void 0,void 0,function*(){this.encryptionType=e?Nn.GCM:Nn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var o,s;return X(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n}));let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let l;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case re.Source.Camera:l=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case re.Source.Microphone:l=yield this.createTracks({audio:(s=r)!==null&&s!==void 0?s:!0});break;case re.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},r));break;default:throw new po(e)}const c=[];for(const d of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Ft(d))),c.push(this.publishTrack(d,i));[a]=yield Promise.all(c)}catch(c){throw l==null||l.forEach(u=>{u.stop()}),c instanceof Error&&!(c instanceof po)&&this.emit(de.MediaDevicesError,c),c}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===re.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const l=this.getTrack(re.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return X(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(re.Source.Camera)||this.pendingPublishing.has(re.Source.Microphone))){this.pendingPublishing.add(re.Source.Camera),this.pendingPublishing.add(re.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(re.Source.Camera),this.pendingPublishing.delete(re.Source.Microphone)}}})}createTracks(e){var n,r;return X(this,void 0,void 0,function*(){const i=lP(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=$p(i);let s;try{s=yield navigator.mediaDevices.getUserMedia(o)}catch(a){throw a instanceof Error&&(o.audio&&(this.microphoneError=a),o.video&&(this.cameraError=a)),a}return o.audio&&(this.microphoneError=void 0,this.emit(de.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),s.getTracks().map(a=>{const l=a.kind==="audio";l?e.audio:e.video;let c;const u=l?o.audio:o.video;typeof u!="boolean"&&(c=u);const d=yP(a,c,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===re.Kind.Video?d.source=re.Source.Camera:d.kind===re.Kind.Audio&&(d.source=re.Source.Microphone),d.mediaStream=s,d})})}createScreenTracks(e){return X(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Tx("getDisplayMedia not supported");e.resolution===void 0&&!Rz()&&(e.resolution=_x.h1080fps30.resolution);const n=xz(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new po("no video track found");const o=new li(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=re.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const s=[o];if(r.getAudioTracks().length>0){this.emit(de.AudioStreamAcquired);const a=new wr(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=re.Source.ScreenShareAudio,s.push(a)}return s})}publishTrack(e,n){var r,i,o,s;return X(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof qc&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case re.Source.Microphone:h="audioinput";break;case re.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new wr(e,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new li(e,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new po("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof wr&&e.setAudioContext(this.audioContext);let l;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(l=h)}),l)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),Ft(l))),l;const c="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:c;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),Ft(e))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=n.dtx)!==null&&o!==void 0||(n.dtx=!1),(s=n.red)!==null&&s!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);Dl()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(e.source=d.source);const f=this.publish(e,d,u);this.pendingPublishPromises.set(e,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,o,s,a,l,c,u,d,f,h,p,g,C;return X(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(k=>e instanceof qc&&k.source===e.source)&&e.source!==re.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Ft(e))),n.stopMicTrackOnMute&&e instanceof wr&&(e.stopOnMute=!0),e.source===re.Source.ScreenShare&&Yc()&&(n.simulcast=!1),n.videoCodec==="av1"&&!wz()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!Sz()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=cy);const m=n.videoCodec;e.on(xe.Muted,this.onTrackMuted),e.on(xe.Unmuted,this.onTrackUnmuted),e.on(xe.Ended,this.handleTrackEnded),e.on(xe.UpstreamPaused,this.onTrackUpstreamPaused),e.on(xe.UpstreamResumed,this.onTrackUpstreamResumed);const y=new Wi({cid:e.mediaStreamTrack.id,name:n.name,type:re.kindToProto(e.kind),muted:e.isMuted,source:re.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n==null?void 0:n.stream});let x;if(e.kind===re.Kind.Video){let k={width:0,height:0};try{k=yield e.waitForDimensions()}catch{const T=(a=(s=this.roomOptions.videoCaptureDefaults)===null||s===void 0?void 0:s.resolution)!==null&&a!==void 0?a:lf.h720.resolution;k={width:T.width,height:T.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Ft(e)),{dims:k}))}y.width=k.width,y.height=k.height,e instanceof li&&(wd(m)&&(e.source===re.Source.ScreenShare&&m==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(l=n.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),y.simulcastCodecs=[new Gi({codec:m,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:cy}),n.backupCodec&&m!==n.backupCodec.codec&&y.encryption===Nn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),y.simulcastCodecs.push(new Gi({codec:n.backupCodec.codec,cid:""})))),x=dy(e.source===re.Source.ScreenShare,y.width,y.height,n),y.layers=jS(y.width,y.height,x,wd(n.videoCodec))}else e.kind===re.Kind.Audio&&(x=[{maxBitrate:(u=(c=n.audioPreset)===null||c===void 0?void 0:c.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new gn("cannot publish track when not connected");const b=yield this.engine.addTrack(y);let E;if(b.codecs.forEach(k=>{E===void 0&&(E=k.mimeType)}),E&&e.kind===re.Kind.Video){const k=cP(E);k!==m&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Ft(e)),{codec:k})),n.videoCodec=k,x=dy(e.source===re.Source.ScreenShare,y.width,y.height,n))}const A=new cf(e.kind,b,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(A.options=n,e.sid=b.sid,!this.engine.pcManager)throw new gn("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:x,trackInfo:b})),e.sender=yield this.engine.createSender(e,n,x),x)if(Yc()&&e.kind===re.Kind.Audio){let k;for(const D of this.engine.pcManager.publisher.getTransceivers())if(D.sender===e.sender){k=D;break}k&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:k,codec:"opus",maxbr:!((g=x[0])===null||g===void 0)&&g.maxBitrate?x[0].maxBitrate/1e3:0})}else e.codec&&wd(e.codec)&&(!((C=x[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:y.cid,codec:e.codec,maxbr:x[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof li?e.startMonitor(this.engine.client):e instanceof wr&&e.startMonitor(),this.addTrackPublication(A),this.emit(de.LocalTrackPublished,A),A})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return X(this,void 0,void 0,function*(){if(this.encryptionType!==Nn.NONE)return;let o;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(o=d)}),!o)throw new po("track is not published");if(!(e instanceof li))throw new po("track is not a video track");const s=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=cH(e,n,s);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Ft(e)));return}const l=e.addSimulcastTrack(n,a),c=new Wi({cid:l.mediaStreamTrack.id,type:re.kindToProto(e.kind),muted:e.isMuted,source:re.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:s.videoCodec,cid:l.mediaStreamTrack.id}]});if(c.layers=jS(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new gn("cannot publish track when not connected");const u=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,l,s,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(e,n){var r,i;return X(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(e),s=o?Ft(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),s)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),s));return}e=o.track,e.off(xe.Muted,this.onTrackMuted),e.off(xe.Unmuted,this.onTrackUnmuted),e.off(xe.Ended,this.handleTrackEnded),e.off(xe.UpstreamPaused,this.onTrackUpstreamPaused),e.off(xe.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let a=!1;const l=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<vn.FAILED&&l)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===l&&(c.direction="inactive",a=!0);if(this.engine.removeTrack(l)&&(a=!0),e instanceof li){for(const[,c]of e.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(a=!0),c.sender=void 0);e.simulcastCodecs.clear()}}catch(c){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),s),{error:c}))}switch(this.tracks.delete(o.trackSid),o.kind){case re.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case re.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(de.LocalTrackUnpublished,o),o.setTrack(void 0),a&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return X(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof cf)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return X(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>X(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),n&&!o.isMuted&&o.source!==re.Source.ScreenShare&&o.source!==re.Source.ScreenShareAudio&&(o instanceof wr||o instanceof li)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return X(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],s=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(l=>{l instanceof uf?o.push(l.sid):o.push(l)});const a=new Co({kind:n,value:{case:"user",value:new xo({participantSid:this.sid,payload:e,destinationSids:o,topic:s})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const o=this.tracks.get(n.sid);if(o){const s=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);s!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Ft(o)),{mutedOnServer:s})),this.engine.client.sendMuteTrack(n.sid,s))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof wr||i instanceof li)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var ft;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(ft||(ft={}));const mH=2*1e3;class ip extends Zo.EventEmitter{constructor(e){var n,r,i;super(),n=this,this.state=ft.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=et,this.bufferedEvents=[],this.connect=(o,s,a)=>X(this,void 0,void 0,function*(){var l;const c=yield this.disconnectLock.lock();if(this.state===ft.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(ft.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),ly(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new US(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(f=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:f}))}));const u=(f,h,p)=>X(this,void 0,void 0,function*(){var g;this.abortController&&this.abortController.abort();const C=new AbortController;this.abortController=C,c==null||c();try{yield this.attemptConnection(p??o,s,a,C),this.abortController=void 0,f()}catch(v){if(this.regionUrlProvider&&v instanceof Rt&&v.reason!==3&&v.reason!==0){let m=null;try{m=yield this.regionUrlProvider.getNextBestRegionUrl((g=this.abortController)===null||g===void 0?void 0:g.signal)}catch(y){if(y instanceof Rt&&(y.status===401||y.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(y);return}}m?(this.log.info("Initial connection failed with ConnectionError: ".concat(v.message,". Retrying with another region: ").concat(m),this.logContext),yield u(f,h,m)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(v))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(v)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new hP((f,h)=>{u(f,h,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,a,l,c,u)=>X(this,void 0,void 0,function*(){var d,f,h;const p=yield a.join(o,s,{autoSubscribe:l.autoSubscribe,publishOnly:l.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},u.signal);let g=p.serverInfo;if(g||(g={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(g).map(C=>{let[v,m]=C;return"".concat(v,": ").concat(m)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(f=p.room)===null||f===void 0?void 0:f.sid,identity:(h=p.participant)===null||h===void 0?void 0:h.identity}),!p.serverVersion)throw new lz("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),c.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,s,a,l)=>X(this,void 0,void 0,function*(){var c,u;this.state===ft.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Bx),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(ue.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const f=new Rt("could not establish signal connection");throw d instanceof Error&&(f.message="".concat(f.message,": ").concat(d.message)),d instanceof Rt&&(f.reason=d.reason,f.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),f}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Rt("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}Pr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Pr()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return X(n,void 0,void 0,function*(){var s,a,l,c;const u=yield this.disconnectLock.lock();try{if(this.state===ft.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===ft.Connecting||this.state===ft.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(s=this.abortController)===null||s===void 0||s.abort(),(l=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||l===void 0||l.call(a,new Rt("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,Ds.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>X(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>X(this,void 0,void 0,function*(){const o=[],s=Vs();if(s&&s.os==="iOS"){const a="livekit-dummy-audio-el";let l=document.getElementById(a);if(!l){l=document.createElement("audio"),l.id=a,l.autoplay=!0,l.hidden=!0;const c=Zm();c.enabled=!0;const u=new MediaStream([c]);l.srcObject=u,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(ue.Disconnected,()=>{l==null||l.remove(),l=null})}o.push(l)}this.participants.forEach(a=>{a.audioTracks.forEach(l=>{l.track&&l.track.attachedElements.forEach(c=>{o.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>X(this,void 0,void 0,function*(){const o=[];for(const s of this.participants.values())s.videoTracks.forEach(a=>{var l;(l=a.track)===null||l===void 0||l.attachedElements.forEach(c=>{o.includes(c)||o.push(c)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(ft.Reconnecting)&&this.emit(ue.Reconnecting)},this.handleSignalRestarted=o=>X(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const a=this.identityToSid.get(s.identity);a&&a!==s.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let l=this.participants.get(s.sid);const c=!l;s.state===Rl.DISCONNECTED?this.handleParticipantDisconnected(s.sid,l):(l=this.getOrCreateParticipant(s.sid,s),c||l.updateInfo(s))})},this.handleActiveSpeakersUpdate=o=>{const s=[],a={};o.forEach(l=>{if(a[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const c=this.participants.get(l.sid);c&&(c.audioLevel=l.level,c.setIsSpeaking(!0),s.push(c))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(l=>{a[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ue.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(l=>{s.set(l.sid,l)}),o.forEach(l=>{let c=this.participants.get(l.sid);l.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=l.level,c.setIsSpeaking(l.active),l.active?s.set(l.sid,c):s.delete(l.sid))});const a=Array.from(s.values());a.sort((l,c)=>c.audioLevel-l.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(ue.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const a=this.participants.get(s.participantSid);if(!a)return;const l=a.getTrackPublication(s.trackSid);!l||!l.track||(l.track.streamState=re.streamStateFromProto(s.state),a.emit(de.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(ue.TrackStreamStateChanged,l,l.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.participants.get(o.participantSid);if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.participants.values()).find(l=>l.tracks.has(o.trackSid));if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const a=this.participants.get(o.participantSid);this.emit(ue.DataReceived,o.payload,a,s,o.topic),a==null||a.emit(de.DataReceived,o.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ue.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ue.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ue.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ue.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>X(this,void 0,void 0,function*(){this.emit(ue.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(ue.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(ue.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const a=this.participants.get(s.participantSid);a&&a.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(ue.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(ue.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(ue.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(ue.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>X(this,void 0,void 0,function*(){var s;this.emit(ue.LocalTrackPublished,o,this.localParticipant),o.track instanceof wr&&(yield o.track.checkForSilence())&&this.emit(ue.LocalAudioSilenceDetected,o);const a=yield(s=o.track)===null||s===void 0?void 0:s.getDeviceId(),l=yz(o.source);l&&a&&a!==this.localParticipant.activeDeviceMap.get(l)&&(this.localParticipant.activeDeviceMap.set(l,a),this.emit(ue.ActiveDeviceChanged,l,a))}),this.onLocalTrackUnpublished=o=>{this.emit(ue.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(ue.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(ue.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(ue.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},qz),e),this.log=Us((r=this.options.loggerName)!==null&&r!==void 0?r:Vo.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},vP),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},CP),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Yz),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Ki,this.localParticipant=new fy("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",vl(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",vl(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",vl(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return X(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new Mz(this.options.e2ee),this.e2eeManager.on(Ia.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof fy&&(this.isE2EEEnabled=n),this.emit(ue.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Ia.EncryptionError,n=>this.emit(ue.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new tH(this.options),this.engine.on(Te.ParticipantUpdate,this.handleParticipantUpdates).on(Te.RoomUpdate,this.handleRoomUpdate).on(Te.SpeakersChanged,this.handleSpeakersChanged).on(Te.StreamStateChanged,this.handleStreamStateUpdate).on(Te.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Te.SubscriptionError,this.handleSubscriptionError).on(Te.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Te.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(Te.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Te.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Te.DataPacketReceived,this.handleDataPacket).on(Te.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(ft.Reconnecting)&&this.emit(ue.Reconnecting)}).on(Te.Resumed,()=>{this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(Te.SignalResumed,()=>{this.bufferedEvents=[],this.state===ft.Reconnecting&&this.sendSyncState()}).on(Te.Restarting,this.handleRestarting).on(Te.SignalRestarted,this.handleSignalRestarted).on(Te.DCBufferStatusChanged,(e,n)=>{this.emit(ue.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return sr.getInstance().getDevices(e,n)}prepareConnection(e,n){return X(this,void 0,void 0,function*(){if(this.state===ft.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(ly(new URL(e))&&n){this.regionUrlProvider=new US(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===ft.Disconnected&&(this.regionUrl=r,yield fetch(RS(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(RS(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return X(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Pn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Pn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Pn({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Pn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>X(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Pn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>X(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Pn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Pn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>X(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new mi({reason:Ds.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Pn({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,s;return X(this,void 0,void 0,function*(){let a=!1,l=!0;const c=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===re.Source.Microphone);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===re.Source.Camera);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(e==="audiooutput"){if(!ay()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(s=this.options).audioOutput)!==null&&i!==void 0||(s.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==c;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&l&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ue.ActiveDeviceChanged,e,n)),l})}setupLocalParticipantEvents(){this.localParticipant.on(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(de.TrackMuted,this.onLocalTrackMuted).on(de.TrackUnmuted,this.onLocalTrackUnmuted).on(de.LocalTrackPublished,this.onLocalTrackPublished).on(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(de.MediaDevicesError,this.onMediaDevicesError).on(de.AudioStreamAcquired,this.startAudio).on(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===ft.Connecting||this.state===ft.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ue.Reconnected,u),this.off(ue.Connected,u),this.off(ue.Disconnected,d)};this.once(ue.Reconnected,u),this.once(ue.Connected,u),this.once(ue.Disconnected,d);return}if(this.state===ft.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=Az(n.id),o=i[0];let s=i[1],a=e.id;if(s&&s.startsWith("TR")&&(a=s),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=this.participants.get(o);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let c;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?c=this.options.adaptiveStream:c={}),l.addSubscribedMediaTrack(e,a,n,r,c)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==ft.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((o=i.track)===null||o===void 0||o.detach(),(s=i.track)===null||s===void 0||s.stop())}),this.localParticipant.off(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(de.TrackMuted,this.onLocalTrackMuted).off(de.TrackUnmuted,this.onLocalTrackUnmuted).off(de.LocalTrackPublished,this.onLocalTrackPublished).off(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(de.MediaDevicesError,this.onMediaDevicesError).off(de.AudioStreamAcquired,this.startAudio).off(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Pr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ft.Disconnected),this.emit(ue.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ue.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return X(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Dx())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ue.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=uf.fromParticipantInfo(this.engine.client,n):i=new uf(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ue.ParticipantConnected,r),r.on(de.TrackPublished,i=>{this.emitWhenConnected(ue.TrackPublished,i,r)}).on(de.TrackSubscribed,(i,o)=>{i.kind===re.Kind.Audio?(i.on(xe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(xe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===re.Kind.Video&&(i.on(xe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(xe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ue.TrackSubscribed,i,o,r)}).on(de.TrackUnpublished,i=>{this.emit(ue.TrackUnpublished,i,r)}).on(de.TrackUnsubscribed,(i,o)=>{this.emit(ue.TrackUnsubscribed,i,o,r)}).on(de.TrackSubscriptionFailed,i=>{this.emit(ue.TrackSubscriptionFailed,i,r)}).on(de.TrackMuted,i=>{this.emitWhenConnected(ue.TrackMuted,i,r)}).on(de.TrackUnmuted,i=>{this.emitWhenConnected(ue.TrackUnmuted,i,r)}).on(de.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ue.ParticipantMetadataChanged,i,r)}).on(de.ParticipantNameChanged,i=>{this.emitWhenConnected(ue.ParticipantNameChanged,i,r)}).on(de.ConnectionQualityChanged,i=>{this.emitWhenConnected(ue.ConnectionQualityChanged,i,r)}).on(de.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ue.ParticipantPermissionsChanged,i,r)}).on(de.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ue.TrackSubscriptionStatusChanged,i,o,r)}).on(de.TrackSubscriptionFailed,(i,o)=>{this.emit(ue.TrackSubscriptionFailed,i,r,o)}).on(de.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ue.TrackSubscriptionPermissionChanged,i,o,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof Fx&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=On.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ds.STATE_MISMATCH))):e=0},mH)}clearConnectionReconcile(){this.connectionReconcileInterval&&On.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ue.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===ft.Connected?this.emit(e,...r):(this.state===ft.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var n,r;return X(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new gu({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:He.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Yr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ue.SignalConnected),this.emit(ue.Connected),this.setAndEmitConnectionState(ft.Connected),i.video){const s=new cf(re.Kind.Video,new Tr({source:nn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Kn.AUDIO,name:"video-dummy"}),new li(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:TS(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(de.LocalTrackPublished,s)}if(i.audio){const s=new cf(re.Kind.Audio,new Tr({source:nn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Kn.AUDIO}),new wr(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Zm(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(de.LocalTrackPublished,s)}for(let s=0;s<o.count-1;s+=1){let a=new Yr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(s),state:Rl.ACTIVE,tracks:[],joinedAt:He.parse(Date.now())});const l=this.getOrCreateParticipant(a.identity,a);if(o.video){const c=TS(160*((r=o.aspectRatios[s%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new Tr({source:nn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Kn.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}if(o.audio){const c=Zm(),u=new Tr({source:nn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Kn.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}l.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==ue.ActiveSpeakersChanged){const o=wP(r).filter(s=>s!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}function wP(t){return t.map(e=>{if(e)return Array.isArray(e)?wP(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var Li;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(Li||(Li={}));class vu extends Zo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Li.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new ip(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return X(this,void 0,void 0,function*(){if(this.status!==Li.IDLE)throw Error("check is running already");this.setStatus(Li.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Li.SKIPPED&&this.setStatus(this.isSuccess()?Li.SUCCESS:Li.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return X(this,void 0,void 0,function*(){return this.room.state===ft.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return X(this,void 0,void 0,function*(){this.room&&this.room.state!==ft.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Li.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function SP(t){var e,n;return X(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=lP(t,vP,CP),i=$p(r),o=navigator.mediaDevices.getUserMedia(i);t.audio&&(sr.userMediaPromiseMap.set("audioinput",o),o.catch(()=>sr.userMediaPromiseMap.delete("audioinput"))),t.video&&(sr.userMediaPromiseMap.set("videoinput",o),o.catch(()=>sr.userMediaPromiseMap.delete("videoinput")));const s=yield o;return s.getTracks().map(a=>{const l=a.kind==="audio";l?t.audio:t.video;let c;const u=l?i.audio:i.video;typeof u!="boolean"&&(c=u),c?c.deviceId=a.getSettings().deviceId:c={deviceId:a.getSettings().deviceId};const d=yP(a,c);return d.kind===re.Kind.Video?d.source=re.Source.Camera:d.kind===re.Kind.Audio&&(d.source=re.Source.Microphone),d.mediaStream=s,d})})}function vH(t){return X(this,void 0,void 0,function*(){return(yield SP({audio:!1,video:t}))[0]})}function CH(t){return X(this,void 0,void 0,function*(){return(yield SP({audio:t,video:!1}))[0]})}class yH extends vu{get description(){return"Can publish audio"}perform(){var e;return X(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield CH();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="audio"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class xH extends vu{get description(){return"Can publish video"}perform(){var e;return X(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield vH();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="video"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class IH extends vu{get description(){return"Resuming connection after interruption"}perform(){var e;return X(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,o;const s=new Promise(l=>{setTimeout(l,5e3),o=l});n.on(ue.Reconnecting,()=>{r=!0}).on(ue.Reconnected,()=>{i=!0,o(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield s,r){if(!i||n.state!==ft.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class bH extends vu{get description(){return"Can connect via TURN"}perform(){var e,n;return X(this,void 0,void 0,function*(){const r=new Nx,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,s=!1,a=!1;for(let l of i.iceServers)for(let c of l.urls)c.startsWith("turn:")?(s=!0,a=!0):c.startsWith("turns:")&&(s=!0,a=!0,o=!0),c.startsWith("stun:")&&(a=!0);a?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(l=>setTimeout(l,0)))})}}class AH extends vu{get description(){return"Establishing WebRTC connection"}perform(){return X(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ue.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const s=new RTCIceCandidate(i);let a="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&(wH(s.address)?a+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(e=!0,a+=" (passive)"):s.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),et.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function wH(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class SH extends vu{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return X(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new Nx;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===Kc.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class ZY extends Zo.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Li.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Li.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return X(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=s=>{this.updateCheck(n,s)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(SH)})}checkWebRTC(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(AH)})}checkTURN(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(bH)})}checkReconnect(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(IH)})}checkPublishAudio(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(yH)})}checkPublishVideo(){return X(this,void 0,void 0,function*(){return this.createAndRunCheck(xH)})}}function kH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof qc?t.mediaStreamTrack:t,i=r.getSettings();let o={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const s=i.facingMode;et.debug("rawFacingMode",{rawFacingMode:s}),s&&typeof s=="string"&&RH(s)&&(o={facingMode:s,confidence:"high"})}if(["low","medium"].includes(o.confidence)){et.debug("Try to get facing mode from device label: (".concat(r.label,")"));const s=TH(r.label);s!==void 0&&(o=s)}return o}const HS=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),EH=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function TH(t){var e;const n=t.trim().toLowerCase();if(n!=="")return HS.has(n)?HS.get(n):(e=Array.from(EH.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function RH(t){return t===void 0||["user","environment","left","right"].includes(t)}const hy=Math.min,Dc=Math.max,op=Math.round,Mo=t=>({x:t,y:t}),_H={left:"right",right:"left",bottom:"top",top:"bottom"},DH={start:"end",end:"start"};function ZS(t,e,n){return Dc(t,hy(e,n))}function Kp(t,e){return typeof t=="function"?t(e):t}function Nl(t){return t.split("-")[0]}function Jp(t){return t.split("-")[1]}function kP(t){return t==="x"?"y":"x"}function EP(t){return t==="y"?"height":"width"}function Qc(t){return["top","bottom"].includes(Nl(t))?"y":"x"}function TP(t){return kP(Qc(t))}function PH(t,e,n){n===void 0&&(n=!1);const r=Jp(t),i=TP(t),o=EP(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=sp(s)),[s,sp(s)]}function NH(t){const e=sp(t);return[py(t),e,py(e)]}function py(t){return t.replace(/start|end/g,e=>DH[e])}function BH(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function OH(t,e,n,r){const i=Jp(t);let o=BH(Nl(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(py)))),o}function sp(t){return t.replace(/left|right|bottom|top/g,e=>_H[e])}function FH(t){return{top:0,right:0,bottom:0,left:0,...t}}function MH(t){return typeof t!="number"?FH(t):{top:t,right:t,bottom:t,left:t}}function ap(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function $S(t,e,n){let{reference:r,floating:i}=t;const o=Qc(e),s=TP(e),a=EP(s),l=Nl(e),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Jp(e)){case"start":h[s]-=f*(n&&c?-1:1);break;case"end":h[s]+=f*(n&&c?-1:1);break}return h}const LH=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=$S(c,r,l),f=r,h={},p=0;for(let g=0;g<a.length;g++){const{name:C,fn:v}=a[g],{x:m,y,data:x,reset:b}=await v({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:c,platform:s,elements:{reference:t,floating:e}});u=m??u,d=y??d,h={...h,[C]:{...h[C],...x}},b&&p<=50&&(p++,typeof b=="object"&&(b.placement&&(f=b.placement),b.rects&&(c=b.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):b.rects),{x:u,y:d}=$S(c,f,l)),g=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function RP(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Kp(e,t),p=MH(h),C=a[f?d==="floating"?"reference":"floating":d],v=ap(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),m=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,y=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),x=await(o.isElement==null?void 0:o.isElement(y))?await(o.getScale==null?void 0:o.getScale(y))||{x:1,y:1}:{x:1,y:1},b=ap(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:m,offsetParent:y,strategy:l}):m);return{top:(v.top-b.top+p.top)/x.y,bottom:(b.bottom-v.bottom+p.bottom)/x.y,left:(v.left-b.left+p.left)/x.x,right:(b.right-v.right+p.right)/x.x}}const UH=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...C}=Kp(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const v=Nl(i),m=Qc(a),y=Nl(a)===a,x=await(l.isRTL==null?void 0:l.isRTL(c.floating)),b=f||(y||!g?[sp(a)]:NH(a)),E=p!=="none";!f&&E&&b.push(...OH(a,g,p,x));const A=[a,...b],k=await RP(e,C),D=[];let T=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&D.push(k[v]),d){const G=PH(i,s,x);D.push(k[G[0]],k[G[1]])}if(T=[...T,{placement:i,overflows:D}],!D.every(G=>G<=0)){var R,P;const G=(((R=o.flip)==null?void 0:R.index)||0)+1,Z=A[G];if(Z)return{data:{index:G,overflows:T},reset:{placement:Z}};let q=(P=T.filter(ie=>ie.overflows[0]<=0).sort((ie,$)=>ie.overflows[1]-$.overflows[1])[0])==null?void 0:P.placement;if(!q)switch(h){case"bestFit":{var L;const ie=(L=T.filter($=>{if(E){const Q=Qc($.placement);return Q===m||Q==="y"}return!0}).map($=>[$.placement,$.overflows.filter(Q=>Q>0).reduce((Q,ne)=>Q+ne,0)]).sort(($,Q)=>$[1]-Q[1])[0])==null?void 0:L[0];ie&&(q=ie);break}case"initialPlacement":q=a;break}if(i!==q)return{reset:{placement:q}}}return{}}}};async function VH(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=Nl(n),a=Jp(n),l=Qc(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=Kp(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:f*c}:{x:f*c,y:h*u}}const GH=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await VH(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},WH=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:C=>{let{x:v,y:m}=C;return{x:v,y:m}}},...l}=Kp(t,e),c={x:n,y:r},u=await RP(e,l),d=Qc(Nl(i)),f=kP(d);let h=c[f],p=c[d];if(o){const C=f==="y"?"top":"left",v=f==="y"?"bottom":"right",m=h+u[C],y=h-u[v];h=ZS(m,h,y)}if(s){const C=d==="y"?"top":"left",v=d==="y"?"bottom":"right",m=p+u[C],y=p-u[v];p=ZS(m,p,y)}const g=a.fn({...e,[f]:h,[d]:p});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[f]:o,[d]:s}}}}}};function Yp(){return typeof window<"u"}function Cu(t){return _P(t)?(t.nodeName||"").toLowerCase():"#document"}function Qr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function zs(t){var e;return(e=(_P(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function _P(t){return Yp()?t instanceof Node||t instanceof Qr(t).Node:!1}function Qi(t){return Yp()?t instanceof Element||t instanceof Qr(t).Element:!1}function Go(t){return Yp()?t instanceof HTMLElement||t instanceof Qr(t).HTMLElement:!1}function XS(t){return!Yp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Qr(t).ShadowRoot}function Pf(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=eo(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function jH(t){return["table","td","th"].includes(Cu(t))}function qp(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Mx(t){const e=Lx(),n=Qi(t)?eo(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function zH(t){let e=Fa(t);for(;Go(e)&&!eu(e);){if(Mx(e))return e;if(qp(e))return null;e=Fa(e)}return null}function Lx(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function eu(t){return["html","body","#document"].includes(Cu(t))}function eo(t){return Qr(t).getComputedStyle(t)}function Qp(t){return Qi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Fa(t){if(Cu(t)==="html")return t;const e=t.assignedSlot||t.parentNode||XS(t)&&t.host||zs(t);return XS(e)?e.host:e}function DP(t){const e=Fa(t);return eu(e)?t.ownerDocument?t.ownerDocument.body:t.body:Go(e)&&Pf(e)?e:DP(e)}function PP(t,e,n){var r;e===void 0&&(e=[]);const i=DP(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=Qr(i);return o?(gy(s),e.concat(s,s.visualViewport||[],Pf(i)?i:[],[])):e.concat(i,PP(i,[]))}function gy(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function NP(t){const e=eo(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Go(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=op(n)!==o||op(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function BP(t){return Qi(t)?t:t.contextElement}function Pc(t){const e=BP(t);if(!Go(e))return Mo(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=NP(e);let s=(o?op(n.width):n.width)/r,a=(o?op(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const HH=Mo(0);function OP(t){const e=Qr(t);return!Lx()||!e.visualViewport?HH:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ZH(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Qr(t)?!1:e}function df(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=BP(t);let s=Mo(1);e&&(r?Qi(r)&&(s=Pc(r)):s=Pc(t));const a=ZH(o,n,r)?OP(o):Mo(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const f=Qr(o),h=r&&Qi(r)?Qr(r):r;let p=f,g=gy(p);for(;g&&r&&h!==p;){const C=Pc(g),v=g.getBoundingClientRect(),m=eo(g),y=v.left+(g.clientLeft+parseFloat(m.paddingLeft))*C.x,x=v.top+(g.clientTop+parseFloat(m.paddingTop))*C.y;l*=C.x,c*=C.y,u*=C.x,d*=C.y,l+=y,c+=x,p=Qr(g),g=gy(p)}}return ap({width:u,height:d,x:l,y:c})}function Ux(t,e){const n=Qp(t).scrollLeft;return e?e.left+n:df(zs(t)).left+n}function FP(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:Ux(t,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function $H(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=zs(r),a=e?qp(e.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Mo(1);const u=Mo(0),d=Go(r);if((d||!d&&!o)&&((Cu(r)!=="body"||Pf(s))&&(l=Qp(r)),Go(r))){const h=df(r);c=Pc(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}const f=s&&!d&&!o?FP(s,l,!0):Mo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function XH(t){return Array.from(t.getClientRects())}function KH(t){const e=zs(t),n=Qp(t),r=t.ownerDocument.body,i=Dc(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=Dc(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Ux(t);const a=-n.scrollTop;return eo(r).direction==="rtl"&&(s+=Dc(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function JH(t,e){const n=Qr(t),r=zs(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=Lx();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function YH(t,e){const n=df(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Go(t)?Pc(t):Mo(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function KS(t,e,n){let r;if(e==="viewport")r=JH(t,n);else if(e==="document")r=KH(zs(t));else if(Qi(e))r=YH(e,n);else{const i=OP(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return ap(r)}function MP(t,e){const n=Fa(t);return n===e||!Qi(n)||eu(n)?!1:eo(n).position==="fixed"||MP(n,e)}function qH(t,e){const n=e.get(t);if(n)return n;let r=PP(t,[]).filter(a=>Qi(a)&&Cu(a)!=="body"),i=null;const o=eo(t).position==="fixed";let s=o?Fa(t):t;for(;Qi(s)&&!eu(s);){const a=eo(s),l=Mx(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Pf(s)&&!l&&MP(t,s))?r=r.filter(u=>u!==s):i=a,s=Fa(s)}return e.set(t,r),r}function QH(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?qp(e)?[]:qH(e,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=KS(e,u,i);return c.top=Dc(d.top,c.top),c.right=hy(d.right,c.right),c.bottom=hy(d.bottom,c.bottom),c.left=Dc(d.left,c.left),c},KS(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function eZ(t){const{width:e,height:n}=NP(t);return{width:e,height:n}}function tZ(t,e,n){const r=Go(e),i=zs(e),o=n==="fixed",s=df(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=Mo(0);if(r||!r&&!o)if((Cu(e)!=="body"||Pf(i))&&(a=Qp(e)),r){const f=df(e,!0,o,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&(l.x=Ux(i));const c=i&&!r&&!o?FP(i,a):Mo(0),u=s.left+a.scrollLeft-l.x-c.x,d=s.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:s.width,height:s.height}}function Ym(t){return eo(t).position==="static"}function JS(t,e){if(!Go(t)||eo(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return zs(t)===n&&(n=n.ownerDocument.body),n}function LP(t,e){const n=Qr(t);if(qp(t))return n;if(!Go(t)){let i=Fa(t);for(;i&&!eu(i);){if(Qi(i)&&!Ym(i))return i;i=Fa(i)}return n}let r=JS(t,e);for(;r&&jH(r)&&Ym(r);)r=JS(r,e);return r&&eu(r)&&Ym(r)&&!Mx(r)?n:r||zH(t)||n}const nZ=async function(t){const e=this.getOffsetParent||LP,n=this.getDimensions,r=await n(t.floating);return{reference:tZ(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function rZ(t){return eo(t).direction==="rtl"}const iZ={convertOffsetParentRelativeRectToViewportRelativeRect:$H,getDocumentElement:zs,getClippingRect:QH,getOffsetParent:LP,getElementRects:nZ,getClientRects:XH,getDimensions:eZ,getScale:Pc,isElement:Qi,isRTL:rZ},oZ=GH,sZ=WH,aZ=UH,lZ=(t,e,n)=>{const r=new Map,i={platform:iZ,...n},o={...i.platform,_c:r};return LH(t,e,{...i,platform:o})};var UP={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(Ze,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},s=null;function a(g,C){var v=g[C];if(typeof v.bind=="function")return v.bind(g);try{return Function.prototype.bind.call(v,g)}catch{return function(){return Function.prototype.apply.apply(v,[g,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?l:console[g]!==void 0?a(console,g):console.log!==void 0?a(console,"log"):e}function u(){for(var g=this.getLevel(),C=0;C<i.length;C++){var v=i[C];this[v]=C<g?e:this.methodFactory(v,g,this.name)}if(this.log=this.debug,typeof console===n&&g<this.levels.SILENT)return"No console available for logging"}function d(g){return function(){typeof console!==n&&(u.call(this),this[g].apply(this,arguments))}}function f(g,C,v){return c(g)||d.apply(this,arguments)}function h(g,C){var v=this,m,y,x,b="loglevel";typeof g=="string"?b+=":"+g:typeof g=="symbol"&&(b=void 0);function E(R){var P=(i[R]||"silent").toUpperCase();if(!(typeof window===n||!b)){try{window.localStorage[b]=P;return}catch{}try{window.document.cookie=encodeURIComponent(b)+"="+P+";"}catch{}}}function A(){var R;if(!(typeof window===n||!b)){try{R=window.localStorage[b]}catch{}if(typeof R===n)try{var P=window.document.cookie,L=encodeURIComponent(b),G=P.indexOf(L+"=");G!==-1&&(R=/^([^;]+)/.exec(P.slice(G+L.length+1))[1])}catch{}return v.levels[R]===void 0&&(R=void 0),R}}function k(){if(!(typeof window===n||!b)){try{window.localStorage.removeItem(b)}catch{}try{window.document.cookie=encodeURIComponent(b)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function D(R){var P=R;if(typeof P=="string"&&v.levels[P.toUpperCase()]!==void 0&&(P=v.levels[P.toUpperCase()]),typeof P=="number"&&P>=0&&P<=v.levels.SILENT)return P;throw new TypeError("log.setLevel() called with invalid level: "+R)}v.name=g,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=C||f,v.getLevel=function(){return x??y??m},v.setLevel=function(R,P){return x=D(R),P!==!1&&E(x),u.call(v)},v.setDefaultLevel=function(R){y=D(R),A()||v.setLevel(R,!1)},v.resetLevel=function(){x=null,k(),u.call(v)},v.enableAll=function(R){v.setLevel(v.levels.TRACE,R)},v.disableAll=function(R){v.setLevel(v.levels.SILENT,R)},v.rebuild=function(){if(s!==v&&(m=D(s.getLevel())),u.call(v),s===v)for(var R in o)o[R].rebuild()},m=D(s?s.getLevel():"WARN");var T=A();T!=null&&(x=D(T)),u.call(v)}s=new h,s.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var v=o[C];return v||(v=o[C]=new h(C,s.methodFactory)),v};var p=typeof window!==n?window.log:void 0;return s.noConflict=function(){return typeof window!==n&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return o},s.default=s,s})})(UP);var cZ=UP.exports;const uZ=tu(cZ);function In(t){return typeof t=="function"}function VP(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var qm=VP(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function my(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var eg=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=$c(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(g){e={error:g}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var u=this.initialTeardown;if(In(u))try{u()}catch(g){o=g instanceof qm?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=$c(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{YS(p)}catch(g){o=o??[],g instanceof qm?o=LC(LC([],MC(o)),MC(g.errors)):o.push(g)}}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(o)throw new qm(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)YS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&my(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&my(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),GP=eg.EMPTY;function WP(t){return t instanceof eg||t&&"closed"in t&&In(t.remove)&&In(t.add)&&In(t.unsubscribe)}function YS(t){In(t)?t():t.unsubscribe()}var dZ={Promise:void 0},fZ={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,LC([t,e],MC(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function jP(t){fZ.setTimeout(function(){throw t})}function vy(){}function t0(t){t()}var Vx=function(t){pu(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,WP(n)&&n.add(r)):r.destination=gZ,r}return e.create=function(n,r,i){return new Cy(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(eg),hZ=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){hh(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){hh(r)}else hh(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){hh(n)}},t}(),Cy=function(t){pu(e,t);function e(n,r,i){var o=t.call(this)||this,s;return In(n)||!n?s={next:n??void 0,error:r??void 0,complete:i??void 0}:s=n,o.destination=new hZ(s),o}return e}(Vx);function hh(t){jP(t)}function pZ(t){throw t}var gZ={closed:!0,next:vy,error:pZ,complete:vy},Gx=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function zP(t){return t}function mZ(t){return t.length===0?zP:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Gn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=CZ(e)?e:new Cy(e,n,r);return t0(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=qS(n),new n(function(i,o){var s=new Cy({next:function(a){try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Gx]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return mZ(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=qS(e),new e(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function qS(t){var e;return(e=t??dZ.Promise)!==null&&e!==void 0?e:Promise}function vZ(t){return t&&In(t.next)&&In(t.error)&&In(t.complete)}function CZ(t){return t&&t instanceof Vx||vZ(t)&&WP(t)}function yZ(t){return In(t==null?void 0:t.lift)}function Hs(t){return function(e){if(yZ(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Bl(t,e,n,r,i){return new xZ(t,e,n,r,i)}var xZ=function(t){pu(e,t);function e(n,r,i,o,s,a){var l=t.call(this,n)||this;return l.onFinalize=s,l.shouldUnsubscribe=a,l._next=r?function(c){try{r(c)}catch(u){n.error(u)}}:t.prototype._next,l._error=o?function(c){try{o(c)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=i?function(){try{i()}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(Vx),IZ=VP(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ma=function(t){pu(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new QS(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new IZ},e.prototype.next=function(n){var r=this;t0(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=$c(r.currentObservers),a=s.next();!a.done;a=s.next()){var l=a.value;l.next(n)}}catch(c){i={error:c}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;t0(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;t0(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?GP:(this.currentObservers=null,a.push(n),new eg(function(){r.currentObservers=null,my(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},e.prototype.asObservable=function(){var n=new Gn;return n.source=this,n},e.create=function(n,r){return new QS(n,r)},e}(Gn),QS=function(t){pu(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:GP},e}(Ma),HP=function(t){pu(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(Ma);function bZ(t){return t&&In(t.schedule)}function AZ(t){return t[t.length-1]}function ZP(t){return bZ(AZ(t))?t.pop():void 0}var $P=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function XP(t){return In(t==null?void 0:t.then)}function KP(t){return In(t[Gx])}function JP(t){return Symbol.asyncIterator&&In(t==null?void 0:t[Symbol.asyncIterator])}function YP(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function wZ(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var qP=wZ();function QP(t){return In(t==null?void 0:t[qP])}function e3(t){return FG(this,arguments,function(){var n,r,i,o;return __(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,wc(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,wc(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,wc(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function t3(t){return In(t==null?void 0:t.getReader)}function yu(t){if(t instanceof Gn)return t;if(t!=null){if(KP(t))return SZ(t);if($P(t))return kZ(t);if(XP(t))return EZ(t);if(JP(t))return n3(t);if(QP(t))return TZ(t);if(t3(t))return RZ(t)}throw YP(t)}function SZ(t){return new Gn(function(e){var n=t[Gx]();if(In(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function kZ(t){return new Gn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function EZ(t){return new Gn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,jP)})}function TZ(t){return new Gn(function(e){var n,r;try{for(var i=$c(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function n3(t){return new Gn(function(e){_Z(t,e).catch(function(n){return e.error(n)})})}function RZ(t){return n3(e3(t))}function _Z(t,e){var n,r,i,o;return OG(this,void 0,void 0,function(){var s,a;return __(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=MG(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function yl(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function r3(t,e){return e===void 0&&(e=0),Hs(function(n,r){n.subscribe(Bl(r,function(i){return yl(r,t,function(){return r.next(i)},e)},function(){return yl(r,t,function(){return r.complete()},e)},function(i){return yl(r,t,function(){return r.error(i)},e)}))})}function i3(t,e){return e===void 0&&(e=0),Hs(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function DZ(t,e){return yu(t).pipe(i3(e),r3(e))}function PZ(t,e){return yu(t).pipe(i3(e),r3(e))}function NZ(t,e){return new Gn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function BZ(t,e){return new Gn(function(n){var r;return yl(n,e,function(){r=t[qP](),yl(n,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return In(r==null?void 0:r.return)&&r.return()}})}function o3(t,e){if(!t)throw new Error("Iterable cannot be null");return new Gn(function(n){yl(n,e,function(){var r=t[Symbol.asyncIterator]();yl(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function OZ(t,e){return o3(e3(t),e)}function FZ(t,e){if(t!=null){if(KP(t))return DZ(t,e);if($P(t))return NZ(t,e);if(XP(t))return PZ(t,e);if(JP(t))return o3(t,e);if(QP(t))return BZ(t,e);if(t3(t))return OZ(t,e)}throw YP(t)}function MZ(t,e){return e?FZ(t,e):yu(t)}function yr(t,e){return Hs(function(n,r){var i=0;n.subscribe(Bl(r,function(o){r.next(t.call(e,o,i++))}))})}function LZ(t,e,n,r,i,o,s,a){var l=[],c=0,u=0,d=!1,f=function(){d&&!l.length&&!c&&e.complete()},h=function(g){return c<r?p(g):l.push(g)},p=function(g){c++;var C=!1;yu(n(g,u++)).subscribe(Bl(e,function(v){e.next(v)},function(){C=!0},void 0,function(){if(C)try{c--;for(var v=function(){var m=l.shift();s||p(m)};l.length&&c<r;)v();f()}catch(m){e.error(m)}}))};return t.subscribe(Bl(e,h,function(){d=!0,f()})),function(){}}function s3(t,e,n){return n===void 0&&(n=1/0),In(e)?s3(function(r,i){return yr(function(o,s){return e(r,o,i,s)})(yu(t(r,i)))},n):(typeof e=="number"&&(n=e),Hs(function(r,i){return LZ(r,i,t,n)}))}function UZ(t){return s3(zP,t)}function VZ(){return UZ(1)}function yy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return VZ()(MZ(t,ZP(t)))}function a3(t,e){return Hs(function(n,r){var i=0;n.subscribe(Bl(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function GZ(t,e,n,r,i){return function(o,s){var a=n,l=e,c=0;o.subscribe(Bl(s,function(u){var d=c++;l=a?t(l,u,d):(a=!0,u),s.next(l)},i))}}function WZ(t){return Hs(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function jZ(t,e){return Hs(GZ(t,e,arguments.length>=2,!0))}function no(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ZP(t);return Hs(function(r,i){(n?yy(t,r,n):yy(t,r)).subscribe(i)})}function ek(t){return Hs(function(e,n){yu(t).subscribe(Bl(n,function(){return n.complete()},vy)),!n.closed&&e.subscribe(n)})}var zZ=Object.defineProperty,HZ=Object.defineProperties,ZZ=Object.getOwnPropertyDescriptors,lp=Object.getOwnPropertySymbols,l3=Object.prototype.hasOwnProperty,c3=Object.prototype.propertyIsEnumerable,tk=(t,e,n)=>e in t?zZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xy=(t,e)=>{for(var n in e||(e={}))l3.call(e,n)&&tk(t,n,e[n]);if(lp)for(var n of lp(e))c3.call(e,n)&&tk(t,n,e[n]);return t},$Z=(t,e)=>HZ(t,ZZ(e)),XZ=(t,e)=>{var n={};for(var r in t)l3.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&lp)for(var r of lp(t))e.indexOf(r)<0&&c3.call(t,r)&&(n[r]=t[r]);return n},Zs=(t,e,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(t,e)).next())}),u3="lk";function Wx(t){return typeof t>"u"?!1:KZ(t)||JZ(t)}function KZ(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function JZ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function YZ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function d3(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(YZ(t))return`${t.participant.identity}_${t.source}_placeholder`;if(Wx(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function qZ(t){return t instanceof fy}function QZ(t,e){return Zs(this,null,function*(){const{x:n,y:r}=yield lZ(t,e,{placement:"top",middleware:[oZ(6),aZ(),sZ({padding:5})]});return{x:n,y:r}})}function e$(t,e){return!t.contains(e.target)}var t$=[ue.ConnectionStateChanged,ue.RoomMetadataChanged,ue.ActiveSpeakersChanged,ue.ConnectionQualityChanged,ue.ParticipantConnected,ue.ParticipantDisconnected,ue.ParticipantPermissionsChanged,ue.ParticipantMetadataChanged,ue.TrackMuted,ue.TrackUnmuted,ue.TrackPublished,ue.TrackUnpublished,ue.TrackStreamStateChanged,ue.TrackSubscriptionFailed,ue.TrackSubscriptionPermissionChanged,ue.TrackSubscriptionStatusChanged],n$=[...t$,ue.LocalTrackPublished,ue.LocalTrackUnpublished],r$=[de.ConnectionQualityChanged,de.IsSpeakingChanged,de.ParticipantMetadataChanged,de.ParticipantPermissionsChanged,de.TrackMuted,de.TrackUnmuted,de.TrackPublished,de.TrackUnpublished,de.TrackStreamStateChanged,de.TrackSubscriptionFailed,de.TrackSubscriptionPermissionChanged,de.TrackSubscriptionStatusChanged];[...r$,de.LocalTrackPublished,de.LocalTrackUnpublished];var vt=uZ.getLogger("lk-components-js");vt.setDefaultLevel("WARN");function i$(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var o$=[],s$={showChat:!1,unreadMessages:0};function jx(t,...e){return new Gn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(no(t))}function zx(t,e){return new Gn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function a$(t){return zx(t,ue.ConnectionStateChanged).pipe(yr(([e])=>e),no(t.state))}function l$(t,e,n=!0){var r;const i=()=>Zs(this,null,function*(){try{const a=yield ip.getLocalDevices(t,n);o.next(a)}catch(a){e==null||e(a)}}),o=new Ma,s=o.pipe(WZ(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return yy(ip.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),s)}function c$(t){return zx(t,ue.DataReceived)}function u$(t){return jx(t,ue.AudioPlaybackStatusChanged).pipe(yr(n=>({canPlayAudio:n.canPlaybackAudio})))}function d$(t){return jx(t,ue.VideoPlaybackStatusChanged).pipe(yr(n=>({canPlayVideo:n.canPlaybackVideo})))}function f$(t,e){return zx(t,ue.ActiveDeviceChanged).pipe(a3(([n])=>n===e),yr(([n,r])=>(vt.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),no(t.getActiveDevice(e)))}function Ii(t){return`${u3}-${t}`}function h$(t){const e=Iy(t),n=Zx(t.participant).pipe(yr(()=>Iy(t)),no(e));return{className:Ii(t.source===re.Source.Camera||t.source===re.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function Iy(t){if(Wx(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function Hx(t,...e){return new Gn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(no(t))}function Zx(t){return Hx(t,de.TrackMuted,de.TrackUnmuted,de.ParticipantPermissionsChanged,de.TrackPublished,de.TrackUnpublished,de.LocalTrackPublished,de.LocalTrackUnpublished,de.MediaDevicesError,de.TrackSubscriptionStatusChanged).pipe(yr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=n,s=n.getTrack(re.Source.Microphone),a=n.getTrack(re.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:a,microphoneTrack:s,participant:n}}))}function p$(t){return Hx(t,de.ParticipantMetadataChanged).pipe(yr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),no({name:t.name,identity:t.identity,metadata:t.metadata}))}function g$(t){return $x(t,de.ConnectionQualityChanged).pipe(yr(([n])=>n),no(t.connectionQuality))}function $x(t,e){return new Gn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function f3(t){var e,n,r,i;return Hx(t.participant,de.TrackMuted,de.TrackUnmuted,de.TrackSubscribed,de.TrackUnsubscribed,de.LocalTrackPublished,de.LocalTrackUnpublished).pipe(yr(o=>{var s,a;const l=(s=t.publication)!=null?s:o.getTrack(t.source);return(a=l==null?void 0:l.isMuted)!=null?a:!0}),no((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function m$(t){return $x(t,de.IsSpeakingChanged).pipe(yr(([e])=>e))}function v$(t,e={}){var n;let r;const i=new Gn(l=>(r=l,()=>a.unsubscribe())).pipe(no(Array.from(t.participants.values()))),o=(n=e.additionalRoomEvents)!=null?n:n$,s=Array.from(new Set([ue.ParticipantConnected,ue.ParticipantDisconnected,ue.ConnectionStateChanged,...o])),a=jx(t,...s).subscribe(l=>r==null?void 0:r.next(Array.from(l.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function C$(t){return $x(t,de.ParticipantPermissionsChanged).pipe(yr(()=>t.permissions),no(t.permissions))}function y$(t,e,n){const{localParticipant:r}=e,i=(c,u)=>{let d=!1;switch(c){case re.Source.Camera:d=u.isCameraEnabled;break;case re.Source.Microphone:d=u.isMicrophoneEnabled;break;case re.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},o=Zx(r).pipe(yr(c=>i(t,c.participant)),no(i(t,r))),s=new Ma,a=(c,u)=>Zs(this,null,function*(){try{switch(u??(u=n),s.next(!0),t){case re.Source.Camera:yield r.setCameraEnabled(c??!r.isCameraEnabled,u);break;case re.Source.Microphone:yield r.setMicrophoneEnabled(c??!r.isMicrophoneEnabled,u);break;case re.Source.ScreenShare:yield r.setScreenShareEnabled(c??!r.isScreenShareEnabled,u);break;default:break}}finally{s.next(!1)}});return{className:Ii("button"),toggle:a,enabledObserver:o,pendingObserver:s.asObservable()}}function x$(){let t=!1;const e=new Ma,n=new Ma,r=o=>{n.next(!0),t=o??!t,e.next(t),n.next(!1)};return{className:Ii("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function I$(t,e,n){const r=new HP(void 0),i=e?f$(e,t):r.asObservable(),o=(a,...l)=>Zs(this,[a,...l],function*(c,u={}){var d,f,h;if(e){vt.debug(`Switching active device of kind "${t}" with id ${c}.`),yield e.switchActiveDevice(t,c,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:c;p!==c&&c!=="default"&&vt.info(`We tried to select the device with id (${c}), but the browser decided to select the device with id (${p}) instead.`);let g;t==="audioinput"?g=(f=e.localParticipant.getTrack(re.Source.Microphone))==null?void 0:f.track:t==="videoinput"&&(g=(h=e.localParticipant.getTrack(re.Source.Camera))==null?void 0:h.track);const C=c==="default"&&!g||c==="default"&&(g==null?void 0:g.mediaStreamTrack.label.startsWith("Default"));r.next(C?c:p)}else if(n){yield n.setDeviceId(u.exact?{exact:c}:c);const p=yield n.getDeviceId();r.next(c==="default"&&n.mediaStreamTrack.label.startsWith("Default")?c:p)}else r.value!==c&&(vt.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(c))});return{className:Ii("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function b$(t){const e=r=>{t.disconnect(r)};return{className:Ii("disconnect-button"),disconnect:e}}function A$(t){const e=Ii("connection-quality"),n=g$(t);return{className:e,connectionQualityObserver:n}}function w$(t){let e="track-muted-indicator-camera";switch(t.source){case re.Source.Camera:e="track-muted-indicator-camera";break;case re.Source.Microphone:e="track-muted-indicator-microphone";break}const n=Ii(e),r=f3(t);return{className:n,mediaMutedObserver:r}}function S$(t){return{className:"lk-participant-name",infoObserver:p$(t)}}function k$(){return{className:Ii("participant-tile")}}var E$={CHAT:"lk-chat-topic"};function h3(t,e,n){return Zs(this,arguments,function*(r,i,o,s={}){const{kind:a,destination:l}=s;yield r.publishData(i,a??mn.RELIABLE,{destination:l,topic:o})})}function T$(t,e,n){const r=c$(t).pipe(a3(([,,,a])=>e===void 0||a===e),yr(([a,l,,c])=>({payload:a,topic:c,from:l})));let i;const o=new Gn(a=>{i=a});return{messageObservable:r,isSendingObservable:o,send:(a,...l)=>Zs(this,[a,...l],function*(c,u={}){i.next(!0);try{yield h3(t.localParticipant,c,e,u)}finally{i.next(!1)}})}}var R$=new TextEncoder,_$=new TextDecoder,ph=new Map,D$=t=>R$.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),P$=t=>JSON.parse(_$.decode(t));function N$(t,e){var n,r;const i=new Ma,{messageDecoder:o,messageEncoder:s,channelTopic:a}=e??{},l=a??E$.CHAT;let c=!1;ph.has(t)||(c=!0);const u=(n=ph.get(t))!=null?n:new Map,d=(r=u.get(l))!=null?r:new Ma;if(u.set(l,d),ph.set(t,u),c){const{messageObservable:m}=T$(t,l);m.pipe(ek(i)).subscribe(d)}const f=o??P$,h=d.pipe(yr(m=>{const y=f(m.payload);return $Z(xy({},y),{from:m.from})}),jZ((m,y)=>[...m,y],[]),ek(i)),p=new HP(!1),g=s??D$,C=m=>Zs(this,null,function*(){const y=Date.now(),x=g({message:m,timestamp:y});p.next(!0);try{yield h3(t.localParticipant,x,l,{kind:mn.RELIABLE}),d.next({payload:x,topic:l,from:t.localParticipant})}finally{p.next(!1)}});function v(){i.next(),i.complete(),ph.clear()}return t.once(ue.Disconnected,v),{messageObservable:h,isSendingObservable:p,send:C}}function B$(){const t=n=>Zs(this,null,function*(){vt.info("Start Audio for room: ",n),yield n.startAudio()});return{className:Ii("start-audio-button"),roomAudioPlaybackAllowedObservable:u$,handleStartAudioPlayback:t}}function O$(){const t=n=>Zs(this,null,function*(){vt.info("Start Video for room: ",n),yield n.startVideo()});return{className:Ii("start-audio-button"),roomVideoPlaybackAllowedObservable:d$,handleStartVideoPlayback:t}}function F$(){return{className:[Ii("button"),Ii("chat-toggle")].join(" ")}}function M$(){return{className:"lk-room-container"}}function L$(t,e){if(typeof localStorage>"u"){vt.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){vt.error(`Error setting item to local storage: ${n}`)}}function U$(t){if(typeof localStorage>"u"){vt.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){vt.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){vt.error(`Error getting item from local storage: ${e}`);return}}function V$(t){return{load:()=>U$(t),save:e=>L$(t,e)}}var G$=`${u3}-user-choices`,Ka={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:W$,save:j$}=V$(G$);function z$(t,e=!1){if(e===!0)return;const n=t,{e2ee:r,sharedPassphrase:i}=n,o=XZ(n,["e2ee","sharedPassphrase"]);j$(o)}function H$(t,e=!1){var n,r,i,o,s,a,l;const c={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:Ka.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:Ka.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:Ka.videoDeviceId,audioDeviceId:(o=t==null?void 0:t.audioDeviceId)!=null?o:Ka.audioDeviceId,username:(s=t==null?void 0:t.username)!=null?s:Ka.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:Ka.e2ee,sharedPassphrase:(l=t==null?void 0:t.sharedPassphrase)!=null?l:Ka.sharedPassphrase};if(e)return c;{const u=W$();return xy(xy({},c),u??{})}}function p3(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=p3(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Z$(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=p3(t))&&(r&&(r+=" "),r+=e);return r}var $$=Object.defineProperty,X$=Object.defineProperties,K$=Object.getOwnPropertyDescriptors,cp=Object.getOwnPropertySymbols,g3=Object.prototype.hasOwnProperty,m3=Object.prototype.propertyIsEnumerable,nk=(t,e,n)=>e in t?$$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Me=(t,e)=>{for(var n in e||(e={}))g3.call(e,n)&&nk(t,n,e[n]);if(cp)for(var n of cp(e))m3.call(e,n)&&nk(t,n,e[n]);return t},Yn=(t,e)=>X$(t,K$(e)),Wn=(t,e)=>{var n={};for(var r in t)g3.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&cp)for(var r of cp(t))e.indexOf(r)<0&&m3.call(t,r)&&(n[r]=t[r]);return n},v3=(t,e,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(t,e)).next())});function ti(t,e){const[n,r]=S.useState(e);return S.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function J$(t){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,r]=S.useState(e(t));function i(){r(e(t))}return S.useEffect(()=>{const o=window.matchMedia(t);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[t]),n}function Y$(t,e){if(e.msg==="show_chat")return Yn(Me({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Yn(Me({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Yn(Me({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Yn(Me({},t),{unreadMessages:e.count}):Me({},t)}function q$(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:Me({},t)}var Xx=S.createContext(void 0);function Q$(){const t=S.useContext(Xx);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function eX(t){const[e,n]=S.useReducer(q$,o$),[r,i]=S.useReducer(Y$,s$);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function C3(){return S.useContext(Xx)}var tX=S.createContext(void 0);function Nf(){return S.useContext(tX)}var Kx=S.createContext(void 0);function tg(){return S.useContext(Kx)}function jl(t){var e;const n=tg(),r=Nf(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var Jx=S.createContext(void 0);function ng(){const t=S.useContext(Jx);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function rg(){return S.useContext(Jx)}function Bf(t){const e=rg(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var nX=S.createContext(void 0);function rX(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function Za(...t){const e=Me({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const o=e[i],s=r[i];typeof o=="function"&&typeof s=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=rX(o,s):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?e[i]=Z$(o,s):e[i]=s!==void 0?s:o}}return e}function iX(t={}){const e=jl(t.participant),{className:n,connectionQualityObserver:r}=S.useMemo(()=>A$(e),[e]),i=ti(r,di.Unknown);return{className:n,quality:i}}function oX(t){const e=Bf(t),n=S.useMemo(()=>a$(e),[e]);return ti(n,e.state)}function sX(t){const e=ng(),n=oX(e);return{buttonProps:S.useMemo(()=>{const{className:i,disconnect:o}=b$(e);return Za(t,{className:i,onClick:()=>{var a;return o((a=t.stopTracks)!=null?a:!0)},disabled:n===ft.Disconnected})},[e,t,n])}}function aX(t){if(t.publication instanceof cf){const e=t.publication.track;if(e){const{facingMode:n}=kH(e);return n}}return"undefined"}function rk(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,o=jl(i),s=typeof t=="string"?{participant:o,source:t}:t,[a,l]=S.useState(!!((n=s.publication)!=null&&n.isMuted||(r=o.getTrack(s.source))!=null&&r.isMuted));return S.useEffect(()=>{const c=f3(s).subscribe(l);return()=>c.unsubscribe()},[d3(s)]),a}function lX(t){const e=jl(t),n=S.useMemo(()=>m$(e),[e]);return ti(n,e.isSpeaking)}var cX={connect:!0,audio:!1,video:!1};function uX(t){const e=Me(Me({},cX),t),{token:n,serverUrl:r,options:i,room:o,connectOptions:s,connect:a,audio:l,video:c,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:g,simulateParticipants:C}=e,v=Wn(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&vt.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[m,y]=S.useState();S.useEffect(()=>{y(o??new ip(i))},[o]);const x=S.useMemo(()=>{const{className:b}=M$();return Za(v,{className:b})},[v]);return S.useEffect(()=>{if(!m)return;const b=()=>{const k=m.localParticipant;vt.debug("trying to publish local tracks"),Promise.all([k.setMicrophoneEnabled(!!l,typeof l!="boolean"?l:void 0),k.setCameraEnabled(!!c,typeof c!="boolean"?c:void 0),k.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(D=>{vt.warn(D),h==null||h(D)})},E=k=>{const D=af.getFailure(k);p==null||p(D)},A=k=>{g==null||g(k)};return m.on(ue.SignalConnected,b).on(ue.MediaDevicesError,E).on(ue.EncryptionError,A),()=>{m.off(ue.SignalConnected,b).off(ue.MediaDevicesError,E).off(ue.EncryptionError,A)}},[m,l,c,u,h,g,p]),S.useEffect(()=>{if(m){if(C){m.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(!n){vt.debug("no token yet");return}if(!r){vt.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(vt.debug("connecting"),m.connect(r,n,s).catch(b=>{vt.warn(b),h==null||h(b)})):(vt.debug("disconnecting because connect is false"),m.disconnect())}},[a,n,JSON.stringify(s),m,h,r,C]),S.useEffect(()=>{if(!m)return;const b=E=>{switch(E){case ft.Disconnected:f&&f();break;case ft.Connected:d&&d();break}};return m.on(ue.ConnectionStateChanged,b),()=>{m.off(ue.ConnectionStateChanged,b)}},[n,d,f,m]),S.useEffect(()=>{if(m)return()=>{vt.info("disconnecting on onmount"),m.disconnect()}},[m]),{room:m,htmlProps:x}}function dX(t={}){const e=Bf(t.room),[n,r]=S.useState(e.localParticipant),[i,o]=S.useState(n.isMicrophoneEnabled),[s,a]=S.useState(n.isMicrophoneEnabled),[l,c]=S.useState(n.lastMicrophoneError),[u,d]=S.useState(n.lastCameraError),[f,h]=S.useState(n.isMicrophoneEnabled),[p,g]=S.useState(void 0),[C,v]=S.useState(void 0),m=y=>{a(y.isCameraEnabled),o(y.isMicrophoneEnabled),h(y.isScreenShareEnabled),v(y.cameraTrack),g(y.microphoneTrack),c(y.participant.lastMicrophoneError),d(y.participant.lastCameraError),r(y.participant)};return S.useEffect(()=>{const y=Zx(n).subscribe(m);return()=>y.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:s,microphoneTrack:p,cameraTrack:C,lastMicrophoneError:l,lastCameraError:u,localParticipant:n}}function fX(){const t=ng(),e=S.useMemo(()=>C$(t.localParticipant),[t]);return ti(e,t.localParticipant.permissions)}function hX({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const o=rg(),s=S.useMemo(()=>l$(t,i,r),[t,r,i]),a=ti(s,[]),[l,c]=S.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=S.useMemo(()=>I$(t,e??o,n),[t,e,o,n]);return S.useEffect(()=>{const h=d.subscribe(p=>{vt.info("setCurrentDeviceId",p),p&&c(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:l,setActiveMediaDevice:f}}function pX(t){return t!==void 0}function xu(...t){return Za(...t.filter(pX))}function y3(t,e,n){return S.Children.map(t,r=>S.isValidElement(r)&&S.Children.only(t)?S.cloneElement(r,Yn(Me({},e),{key:n})):r)}function x3(t,e={}){var n;const[r,i]=S.useState(Iy(t)),[o,s]=S.useState(r==null?void 0:r.isMuted),[a,l]=S.useState(r==null?void 0:r.isSubscribed),[c,u]=S.useState(r==null?void 0:r.track),[d,f]=S.useState("landscape"),h=S.useRef(),{className:p,trackObserver:g}=S.useMemo(()=>h$(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,Wx(t)&&t.publication.trackSid]);return S.useEffect(()=>{const C=g.subscribe(v=>{vt.debug("update track",v),i(v),s(v==null?void 0:v.isMuted),l(v==null?void 0:v.isSubscribed),u(v==null?void 0:v.track)});return()=>C==null?void 0:C.unsubscribe()},[g]),S.useEffect(()=>{var C,v;return c&&(h.current&&c.detach(h.current),(C=e.element)!=null&&C.current&&!(qZ(t.participant)&&(c==null?void 0:c.kind)==="audio")&&c.attach(e.element.current)),h.current=(v=e.element)==null?void 0:v.current,()=>{h.current&&(c==null||c.detach(h.current))}},[c,e.element]),S.useEffect(()=>{var C,v;if(typeof((C=r==null?void 0:r.dimensions)==null?void 0:C.width)=="number"&&typeof((v=r==null?void 0:r.dimensions)==null?void 0:v.height)=="number"){const m=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(m)}},[r]),{publication:r,isMuted:o,isSubscribed:a,track:c,elementProps:xu(e.props,Me({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function gX({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:s}){const a=Nf(),l=jl(e),c=S.useMemo(()=>{var g,C,v,m,y,x;const b=(C=(g=t==null?void 0:t.source)!=null?g:a==null?void 0:a.source)!=null?C:n;if(b===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(m=(v=t==null?void 0:t.participant)!=null?v:a==null?void 0:a.participant)!=null?m:l,publication:(x=(y=t==null?void 0:t.publication)!=null?y:a==null?void 0:a.publication)!=null?x:r,source:b}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,l,n,r]),u=S.useMemo(()=>{const{className:g}=k$();return Za(s,{className:g,onClick:C=>{var v,m;if((v=s.onClick)==null||v.call(s,C),typeof i=="function"){const y=(m=c.publication)!=null?m:c.participant.getTrack(c.source);i({participant:c.participant,track:y})}}})},[s,i,c.publication,c.source,c.participant]),d=rk(re.Source.Camera,{participant:c.participant}),f=rk(re.Source.Microphone,{participant:c.participant}),h=lX(c.participant),p=aX(c);return{elementProps:Me({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":o===!0?!1:h,"data-lk-local-participant":c.participant.isLocal,"data-lk-source":c.source,"data-lk-facing-mode":p},u)}}function mX(t={}){const e=Bf(t.room),[n,r]=S.useState([]);return S.useEffect(()=>{const i=v$(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function vX(t={}){const e=mX(t),{localParticipant:n}=dX(t);return[n,...e]}function CX({room:t,props:e}){const n=Bf(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=S.useMemo(()=>B$(),[]),s=S.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=ti(s,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:S.useMemo(()=>Za(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayAudio:a}}function yX({room:t,props:e}){const n=Bf(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=S.useMemo(()=>O$(),[]),s=S.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=ti(s,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:S.useMemo(()=>Za(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayVideo:a}}function xX({props:t}){const{dispatch:e,state:n}=Q$().widget,{className:r}=S.useMemo(()=>F$(),[]);return{mergedProps:S.useMemo(()=>Za(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function IX(t,e={}){var n,r,i,o;let s=Nf();const a=(r=(n=tg())!=null?n:e.participant)!=null?r:s==null?void 0:s.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:a,source:t}}else if(t)s=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:l,mediaMutedObserver:c}=S.useMemo(()=>w$(s),[d3(s)]);return{isMuted:ti(c,!!((i=s.publication)!=null&&i.isMuted||(o=s.participant.getTrack(s.source))!=null&&o.isMuted)),className:l}}function bX(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:o}=e,s=Wn(e,["source","onChange","initialState","captureOptions"]),a;const l=rg(),c=(a=l==null?void 0:l.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=S.useMemo(()=>l?y$(n,l,o):x$(),[l,n,JSON.stringify(o)]),p=ti(f,!1),g=ti(h,i??!!(c!=null&&c.isEnabled));S.useEffect(()=>{r==null||r(g)},[g,r]),S.useEffect(()=>{i!==void 0&&(vt.debug("forcing initial toggle state",n,i),u(i))},[]);const C=S.useMemo(()=>Za(s,{className:d}),[s,d]),v=S.useCallback(m=>{var y;u(),(y=s.onClick)==null||y.call(s,m)},[s,u]);return{toggle:u,enabled:g,pending:p,track:c,buttonProps:Yn(Me({},C),{"aria-pressed":g,"data-lk-source":n,"data-lk-enabled":g,disabled:p,onClick:v})}}function AX(t,e={}){return x3(t,e)}function wX(t){const e=ng(),[n,r]=S.useState(),i=ti(n==null?void 0:n.isSendingObservable,!1),o=ti(n==null?void 0:n.messageObservable,[]);return S.useEffect(()=>{const s=N$(e,t);r(s)},[e,t]),{send:n==null?void 0:n.send,chatMessages:o,isSending:i}}function SX(t={}){var e;const[n,r]=S.useState(H$(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=S.useCallback(c=>{r(u=>Yn(Me({},u),{audioEnabled:c}))},[]),o=S.useCallback(c=>{r(u=>Yn(Me({},u),{videoEnabled:c}))},[]),s=S.useCallback(c=>{r(u=>Yn(Me({},u),{audioDeviceId:c}))},[]),a=S.useCallback(c=>{r(u=>Yn(Me({},u),{videoDeviceId:c}))},[]),l=S.useCallback(c=>{r(u=>Yn(Me({},u),{username:c}))},[]);return S.useEffect(()=>{var c;z$(n,(c=t.preventSave)!=null?c:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:s,saveVideoInputDeviceId:a,saveUsername:l}}function kX(t){const{mergedProps:e}=xX({props:t});return S.createElement("button",Me({},e),t.children)}function EX(t){const{buttonProps:e}=sX(t);return S.createElement("button",Me({},e),t.children)}var TX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),S.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),RX=TX,_X=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),DX=_X,PX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),NX=PX,BX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),OX=BX,FX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),S.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),MX=FX,LX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),S.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),UX=LX,VX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),GX=VX,WX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),jX=WX,zX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),HX=zX,ZX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),$X=ZX,XX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),KX=XX,JX=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),S.createElement("g",{fill:"currentColor"},S.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),S.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),YX=JX;function Qm(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:s,exactMatch:a,track:l,requestPermissions:c,onError:u}=e,d=Wn(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=rg(),h=S.useCallback(b=>{f&&f.emit(ue.MediaDevicesError,b),u==null||u(b)},[f,u]),{devices:p,activeDeviceId:g,setActiveMediaDevice:C,className:v}=hX({kind:n,room:f,track:l,requestPermissions:c,onError:h});S.useEffect(()=>{r!==void 0&&C(r)},[C]),S.useEffect(()=>{typeof o=="function"&&o(p)},[o,p]),S.useEffect(()=>{g&&g!==""&&(i==null||i(g))},[g]);const m=b=>v3(this,null,function*(){try{yield C(b,{exact:a})}catch(E){if(E instanceof Error)s==null||s(E);else throw E}}),y=S.useMemo(()=>xu(d,{className:v},{className:"lk-list"}),[v,d]);function x(b,E,A){return b===E||A===0&&E==="default"}return S.createElement("ul",Me({},y),p.map((b,E)=>S.createElement("li",{key:b.deviceId,id:b.deviceId,"data-lk-active":x(b.deviceId,g,E),"aria-selected":x(b.deviceId,g,E),role:"option"},S.createElement("button",{className:"lk-button",onClick:()=>m(b.deviceId)},b.label))))}function I3(t,e){switch(t){case re.Source.Microphone:return e?S.createElement(UX,null):S.createElement(MX,null);case re.Source.Camera:return e?S.createElement(DX,null):S.createElement(RX,null);case re.Source.ScreenShare:return e?S.createElement(YX,null):S.createElement(KX,null);default:return}}function qX(t){switch(t){case di.Excellent:return S.createElement(GX,null);case di.Good:return S.createElement(jX,null);case di.Poor:return S.createElement(HX,null);default:return S.createElement($X,null)}}function ev(t){var e=t,{showIcon:n}=e,r=Wn(e,["showIcon"]);const{buttonProps:i,enabled:o}=bX(r);return S.createElement("button",Me({},i),(n??!0)&&I3(r.source,o),r.children)}function QX(t){var e;const{className:n,quality:r}=iX(t),i=S.useMemo(()=>Yn(Me({},xu(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return S.createElement("div",Me({},i),(e=t.children)!=null?e:qX(r))}function eK(t){var e=t,{participant:n}=e,r=Wn(e,["participant"]);const i=jl(n),{className:o,infoObserver:s}=S.useMemo(()=>S$(i),[i]),{identity:a,name:l}=ti(s,{name:i.name,identity:i.identity,metadata:i.metadata}),c=S.useMemo(()=>xu(r,{className:o,"data-lk-participant-name":l}),[r,o,l]);return S.createElement("span",Me({},c),l!==""?l:a,r.children)}function tK(t){var e=t,{source:n,participant:r,trackRef:i,show:o="always"}=e,s=Wn(e,["source","participant","trackRef","show"]),a,l;const{className:c,isMuted:u}=IX(i??n,{participant:r}),d=o==="always"||o==="muted"&&u||o==="unmuted"&&!u,f=S.useMemo(()=>xu(s,{className:c}),[c,s]);return d?S.createElement("div",Yn(Me({},f),{"data-lk-muted":u}),(l=s.children)!=null?l:I3((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function nK(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:o,name:s,publication:a,participant:l}=e,c=Wn(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,g,C,v,m,y;const x=Nf(),b=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=x==null?void 0:x.publication)==null?void 0:d.trackName)!=null?h:s,E=(g=(p=n==null?void 0:n.source)!=null?p:x==null?void 0:x.source)!=null?g:o,A=(v=(C=n==null?void 0:n.publication)!=null?C:x==null?void 0:x.publication)!=null?v:a,k=(y=(m=n==null?void 0:n.participant)!=null?m:x==null?void 0:x.participant)!=null?y:l;if(E===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const D=S.useRef(null),T=jl(k),{elementProps:R,isSubscribed:P,track:L,publication:G}=x3({source:E,name:b,participant:T,publication:A},{element:D,props:c});return S.useEffect(()=>{r==null||r(!!P)},[P,r]),S.useEffect(()=>{L===void 0||i===void 0||(L instanceof Cl?L.setVolume(i):vt.warn("Volume can only be set on remote audio tracks."))},[i,L]),S.useEffect(()=>{G===void 0||c.muted===void 0||(G instanceof Fx?G.setEnabled(!c.muted):vt.warn("Can only call setEnabled on remote track publications."))},[c.muted,G,L]),S.createElement("audio",Me({ref:D},R))}function rK(t){const e=!!tg();return t.participant&&!e?S.createElement(Kx.Provider,{value:t.participant},t.children):S.createElement(S.Fragment,null,t.children)}function iK({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=eX(t);return S.useEffect(()=>{vt.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),S.useEffect(()=>{vt.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),S.createElement(Xx.Provider,{value:i},r)}function oK(t){const{room:e,htmlProps:n}=uX(t);return S.createElement("div",Me({},n),e&&S.createElement(Jx.Provider,{value:e},S.createElement(nX.Provider,{value:t.featureFlags},t.children)))}function sK(t){var e=t,{participant:n,trackRef:r}=e,i=Wn(e,["participant","trackRef"]),o,s;const[a,l]=S.useState([]),c=200,u=90,d=6,f=4,h=50,p=7,g=(o=tg())!=null?o:n;let C=(s=Nf())!=null?s:r;if(!C){if(!g)throw Error("Participant missing, provide it directly or within a context");C={participant:g,source:re.Source.Microphone}}const{track:v}=AX(C);return S.useEffect(()=>{if(!v||!(v instanceof wr||v instanceof Cl))return;const{analyser:m,cleanup:y}=Nz(v,{smoothingTimeConstant:.8,fftSize:64}),x=new Uint8Array(m.frequencyBinCount),b=()=>{m.getByteFrequencyData(x);const A=new Array(p).fill(0);x.slice(1);const k=6;for(let D=0;D<p/2;D+=1){const T=Math.floor(p/2-D);for(let R=0;R<k;R+=1)A[T]+=Math.pow(x[D*k+R]/255,2);A[T]/=k}for(let D=0;D<p/2;D+=1){const T=Math.floor(p/2+D);if(A[T]===0){for(let R=0;R<k;R+=1)A[T]+=Math.pow(x[D*k+R]/255,2);A[T]/=k}}return A.map(D=>D*h)},E=setInterval(()=>{const A=b();l(A)},100);return()=>{clearInterval(E),y()}},[v]),S.createElement("svg",Yn(Me({width:"100%",height:"100%",viewBox:`0 0 ${c} ${u}`},i),{className:"lk-audio-visualizer"}),S.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),S.createElement("g",{style:{transform:`translate(${(c-p*(d+f))/2}px, 0)`}},a.map((m,y)=>S.createElement("rect",{key:y,x:y*(d+f),y:u/2-m/2,width:d,height:m}))))}function aK(t){var e=t,{participants:n}=e,r=Wn(e,["participants"]);return S.createElement(S.Fragment,null,n.map(i=>S.createElement(Kx.Provider,{value:i,key:i.identity},y3(r.children))))}function lK(t){var e=t,{participant:n,children:r,source:i,publication:o,disableSpeakingIndicator:s,onParticipantClick:a}=e,l=Wn(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const c=jl(n),{elementProps:u}=gX({participant:c,htmlProps:l,disableSpeakingIndicator:s,source:re.Source.Microphone,publication:o,onParticipantClick:a});return S.createElement("div",Me({style:{position:"relative"}},u),S.createElement(rK,{participant:c},r??S.createElement(S.Fragment,null,S.createElement(nK,{source:i??re.Source.Microphone}),S.createElement(sK,null),S.createElement("div",{className:"lk-participant-metadata"},S.createElement("div",{className:"lk-participant-metadata-item"},S.createElement(tK,{source:re.Source.Microphone}),S.createElement(eK,null)),S.createElement(QX,{className:"lk-participant-metadata-item"})))))}function cK(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=e,s=Wn(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,l,c,u;const d=S.useMemo(()=>o?o(n.message):n.message,[n.message,o]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return S.createElement("li",Me({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},s),(!i||!r)&&S.createElement("span",{className:"lk-meta-data"},!r&&S.createElement("strong",{className:"lk-participant-name"},(u=(l=n.from)==null?void 0:l.name)!=null?u:(c=n.from)==null?void 0:c.identity),!i&&S.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),S.createElement("span",{className:"lk-message-body"},d))}function uK(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:o}=e,s=Wn(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=S.useRef(null),l=S.useRef(null),c=S.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:u,chatMessages:d,isSending:f}=wX(c),h=C3(),p=S.useRef(0);function g(C){return v3(this,null,function*(){C.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return S.useEffect(()=>{var C;l&&((C=l.current)==null||C.scrollTo({top:l.current.scrollHeight}))},[l,d]),S.useEffect(()=>{var C,v,m,y,x;if(!h||d.length===0)return;if((C=h.widget.state)!=null&&C.showChat&&d.length>0&&p.current!==((v=d[d.length-1])==null?void 0:v.timestamp)){p.current=(m=d[d.length-1])==null?void 0:m.timestamp;return}const b=d.filter(A=>!p.current||A.timestamp>p.current).length,{widget:E}=h;b>0&&((y=E.state)==null?void 0:y.unreadMessages)!==b&&((x=E.dispatch)==null||x.call(E,{msg:"unread_msg",count:b}))},[d,h==null?void 0:h.widget]),S.createElement("div",Yn(Me({},s),{className:"lk-chat"}),S.createElement("ul",{className:"lk-list lk-chat-messages",ref:l},s.children?d.map((C,v)=>y3(s.children,{entry:C,key:v,messageFormatter:n})):d.map((C,v,m)=>{const y=v>=1&&m[v-1].from===C.from,x=v>=1&&C.timestamp-m[v-1].timestamp<6e4;return S.createElement(cK,{key:v,hideName:y,hideTimestamp:y===!1?!1:x,entry:C,messageFormatter:n})})),S.createElement("form",{className:"lk-chat-form",onSubmit:g},S.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),S.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function ik(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:s=!1}=e,a=Wn(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[l,c]=S.useState(!1),[u,d]=S.useState([]),[f,h]=S.useState(!0),p=(m,y)=>{vt.debug("handle device change"),c(!1),i==null||i(m,y)},g=S.useRef(null),C=S.useRef(null);S.useLayoutEffect(()=>{g.current&&C.current&&(u||f)&&QZ(g.current,C.current).then(({x:m,y})=>{C.current&&Object.assign(C.current.style,{left:`${m}px`,top:`${y}px`})}),h(!1)},[g,C,u,f]);const v=S.useCallback(m=>{C.current&&m.target!==g.current&&l&&e$(C.current,m)&&c(!1)},[l,C,g]);return S.useEffect(()=>(document.addEventListener("click",v),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",v),window.removeEventListener("resize",()=>h(!0))}),[v,h]),S.createElement(S.Fragment,null,S.createElement("button",Yn(Me({className:"lk-button lk-button-menu","aria-pressed":l},a),{onClick:()=>c(!l),ref:g}),a.children),!a.disabled&&S.createElement("div",{className:"lk-device-menu",ref:C,style:{visibility:l?"visible":"hidden"}},n?S.createElement(Qm,{initialSelection:r,onActiveDeviceChange:m=>p(n,m),onDeviceListChange:d,kind:n,track:o==null?void 0:o[n],requestPermissions:s}):S.createElement(S.Fragment,null,S.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),S.createElement(Qm,{kind:"audioinput",onActiveDeviceChange:m=>p("audioinput",m),onDeviceListChange:d,track:o==null?void 0:o.audioinput,requestPermissions:s}),S.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),S.createElement(Qm,{kind:"videoinput",onActiveDeviceChange:m=>p("videoinput",m),onDeviceListChange:d,track:o==null?void 0:o.videoinput,requestPermissions:s}))))}function dK(t){var e=t,{label:n}=e,r=Wn(e,["label"]);const i=ng(),{mergedProps:o,canPlayAudio:s}=CX({room:i,props:r}),{mergedProps:a,canPlayVideo:l}=yX({room:i,props:o}),c=a,{style:u}=c,d=Wn(c,["style"]);return u.display=s&&l?"none":"block",S.createElement("button",Me({style:u},d),n??`Start ${s?"Video":"Audio"}`)}function fK(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,o=Wn(e,["variation","controls","saveUserChoices"]),s,a,l,c,u;const[d,f]=S.useState(!1),h=C3();S.useEffect(()=>{var L,G;((L=h==null?void 0:h.widget.state)==null?void 0:L.showChat)!==void 0&&f((G=h==null?void 0:h.widget.state)==null?void 0:G.showChat)},[(s=h==null?void 0:h.widget.state)==null?void 0:s.showChat]);const g=J$(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=g);const C=Me({leave:!0},r),v=fX();v?((a=C.camera)!=null||(C.camera=v.canPublish),(l=C.microphone)!=null||(C.microphone=v.canPublish),(c=C.screenShare)!=null||(C.screenShare=v.canPublish),(u=C.chat)!=null||(C.chat=v.canPublishData&&(r==null?void 0:r.chat))):(C.camera=!1,C.chat=!1,C.microphone=!1,C.screenShare=!1);const m=S.useMemo(()=>n==="minimal"||n==="verbose",[n]),y=S.useMemo(()=>n==="textOnly"||n==="verbose",[n]),x=i$(),[b,E]=S.useState(!1),A=L=>{E(L)},k=xu({className:"lk-control-bar"},o),{saveAudioInputEnabled:D,saveVideoInputEnabled:T,saveAudioInputDeviceId:R,saveVideoInputDeviceId:P}=SX({preventSave:!i});return S.createElement("div",Me({},k),C.microphone&&S.createElement("div",{className:"lk-button-group"},S.createElement(ev,{source:re.Source.Microphone,showIcon:m,onChange:D},y&&"Microphone"),S.createElement("div",{className:"lk-button-group-menu"},S.createElement(ik,{kind:"audioinput",onActiveDeviceChange:(L,G)=>R(G??"")}))),C.camera&&S.createElement("div",{className:"lk-button-group"},S.createElement(ev,{source:re.Source.Camera,showIcon:m,onChange:T},y&&"Camera"),S.createElement("div",{className:"lk-button-group-menu"},S.createElement(ik,{kind:"videoinput",onActiveDeviceChange:(L,G)=>P(G??"")}))),C.screenShare&&x&&S.createElement(ev,{source:re.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:m,onChange:A},y&&(b?"Stop screen share":"Share screen")),C.chat&&S.createElement(kX,null,m&&S.createElement(NX,null),y&&"Chat"),C.leave&&S.createElement(EX,null,m&&S.createElement(OX,null),y&&"Leave"),S.createElement(dK,null))}function hK(t){var e=Wn(t,[]);const[n,r]=S.useState({showChat:!1,unreadMessages:0}),i=vX();return S.createElement(iK,{onWidgetChange:r},S.createElement("div",Me({className:"lk-audio-conference"},e),S.createElement("div",{className:"lk-audio-conference-stage"},S.createElement(aK,{participants:i},S.createElement(lK,null))),S.createElement(fK,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&S.createElement(uK,null)))}const pK="wss://mongoose-67t79p35.livekit.cloud",gK=({client:t})=>{const[e,n]=S.useState([]),[r,i]=S.useState(!1);return S.useEffect(()=>{const o=a=>{n(l=>[...l,a]),i(!0)},s=a=>{n(l=>{const c=l.filter(u=>u!==a);return c.length===0&&i(!1),c})};return t.on("livekitToken",o),t.on("livekitLeave",s),()=>{t.off("livekitToken",o),t.off("livekitLeave",s)}},[t]),e.length?z.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,s)=>z.jsx(oK,{video:!1,audio:!0,token:o,serverUrl:pK,connect:!0,onDisconnected:()=>t.emit("livekitLeave",o),children:z.jsx(hK,{})},s)),z.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},b3=({items:t,renderItem:e,listId:n,labelledBy:r,className:i="",itemClassName:o,getItemTextValue:s=a=>(a.name||a.id||"").toString().toLowerCase()})=>{var f;const[a,l]=S.useState(-1),c=S.useRef(null),u=()=>{a===-1&&t.length>0&&l(0)};S.useEffect(()=>{var h;if(a>=t.length&&l(t.length>0?0:-1),a!==-1){const p=`${n}-item-${(h=t[a])==null?void 0:h.id}`,g=document.getElementById(p);g&&g.scrollIntoView({block:"nearest"})}},[a,t,n]);const d=S.useCallback(h=>{if(t.length===0)return;let p=a,g=!0;switch(h.key){case"ArrowDown":p=(a+1)%t.length;break;case"ArrowUp":p=(a-1+t.length)%t.length;break;case"Home":p=0;break;case"End":p=t.length-1;break;case"PageUp":p=Math.max(a-5,0);break;case"PageDown":p=Math.min(a+5,t.length-1);break;default:if(h.key.length===1&&!h.ctrlKey&&!h.metaKey&&!h.altKey){const C=h.key.toLowerCase();let v=a===-1?0:(a+1)%t.length,m=-1;for(let y=0;y<t.length;y++){const x=(v+y)%t.length;if(s(t[x]).startsWith(C)){m=x;break}}m!==-1?p=m:g=!1}else g=!1;break}p!==a&&l(p),g&&h.preventDefault()},[a,t,s]);return z.jsx("div",{id:n,className:`accessible-list-container ${i}`,ref:c,tabIndex:0,role:"listbox","aria-labelledby":r,"aria-activedescendant":a!==-1?`${n}-item-${(f=t[a])==null?void 0:f.id}`:void 0,onFocus:u,onKeyDown:d,children:z.jsx("ul",{role:"none",className:"accessible-list-ul",children:t.map((h,p)=>{const g=p===a,C=o?o(h,p,g):"";return z.jsx("li",{id:`${n}-item-${h.id}`,className:`${C} ${g?"selected":""}`,role:"option","aria-selected":g,children:e(h,p,g)},h.id)})})})},mK=t=>({...t,id:t.Object}),vK=({users:t})=>{const e=t.map(mK),n=(o,s,a)=>{let l="Online";return o.away&&(l="Away"),o.idle&&(l==="Online"?l="Idle":l+=" + Idle"),z.jsxs(z.Fragment,{children:[o.Name,z.jsxs("span",{className:"sr-only",children:[" ",`(${l})`]})]})},r=(o,s,a)=>{let l="userlist-item";return o.away&&(l+=" away"),o.idle&&(l+=" idle"),l},i=o=>o.Name?o.Name.toLowerCase():"";return z.jsxs(z.Fragment,{children:[z.jsx("div",{className:"sidebar-header",id:"userlist-header","aria-hidden":"true",children:"Connected Players"}),z.jsxs("div",{className:"sidebar",children:[" ",z.jsxs("div",{className:"sidebar-content",children:[" ",z.jsx(b3,{items:e,renderItem:n,listId:"userlist",labelledBy:"userlist-header",className:"userlist-accessible-container",itemClassName:r,getItemTextValue:i})]})]})]})},CK=t=>{if(!t)return[];const e=[];return t.includes("w")&&e.push("worn"),t.includes("l")&&e.push("wielded"),t.includes("c")&&e.push("container"),e},yK=({client:t})=>{const[e,n]=S.useState([]),r=S.useCallback((f,h)=>{f==="inv"&&(n(h),t.emit("inventoryDataReceived"))},[t]),i=S.useCallback((f,h)=>{f==="inv"&&n(p=>{if(p.some(C=>C.id===h.id))return p;const g=[...p,h];return t.emit("inventoryDataReceived"),g})},[t]),o=S.useCallback((f,h)=>{f==="inv"&&(n(p=>p.filter(g=>g.id!==h.id)),t.emit("inventoryDataReceived"))},[t]),s=S.useCallback((f,h)=>{f==="inv"&&(n(p=>p.map(g=>g.id===h.id?{...g,...h}:g)),t.emit("inventoryDataReceived"))},[t]);S.useEffect(()=>{const f=v=>r(v.location,v.items),h=v=>i(v.location,v.item),p=v=>o(v.location,v.item),g=v=>s(v.location,v.item);t.on("itemsList",f),t.on("itemAdd",h),t.on("itemRemove",p),t.on("itemUpdate",g);const C=t.gmcpHandlers["Char.Items"];return C!=null&&C.sendInventoryRequest?(console.log("Requesting initial inventory list..."),C.sendInventoryRequest()):console.warn("Char.Items handler or sendInventoryRequest method not found."),()=>{t.off("itemsList",f),t.off("itemAdd",h),t.off("itemRemove",p),t.off("itemUpdate",g)}},[t,r,i,o,s]);const a="inventory-heading",l="inventory-listbox",c=(f,h,p)=>{const g=CK(f.attrib),C=g.length>0?`Attributes: ${g.join(", ")}`:void 0;return z.jsxs("span",{title:C,children:[" ",f.name,g.length>0&&z.jsxs("span",{className:"item-attributes","aria-hidden":"true",children:[" (",g.join(", "),")"]})]})},u=(f,h,p)=>"inventory-item",d=f=>f.name?f.name.toLowerCase():"";return z.jsxs("div",{className:"inventory-list-container",role:"region","aria-labelledby":a,children:[z.jsx("h4",{id:a,tabIndex:-1,children:"Inventory"}),e.length===0?z.jsx("p",{children:"Your inventory is empty."}):z.jsx(b3,{items:e,renderItem:c,listId:l,labelledBy:a,className:"inventory-accessible-list",itemClassName:u,getItemTextValue:d})]})};function ff(t,e,n){const[r,i]=S.useState(n);return S.useEffect(()=>{if(!t)return i(n),()=>{};const o=s=>{i(s)};return t.on(e,o),()=>{t.off(e,o)}},[t,e,n]),r}const xK=({client:t})=>{const[e,n]=S.useState(t.currentRoomInfo),r=S.useCallback(a=>{n(a)},[]);S.useEffect(()=>(t.on("roomInfo",r),()=>{t.off("roomInfo",r)}),[t,r]);const i=a=>{console.log(`Clicked exit: ${a}`),t.sendCommand(a)},o="room-info-heading";if(!e)return z.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":o,children:[z.jsx("h4",{id:o,children:"Room Info"}),z.jsx("p",{children:"Waiting for room data..."})]});const s=e.exits?Object.entries(e.exits):[];return s.sort(([a],[l])=>a.localeCompare(l)),z.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":o,children:[z.jsx("h4",{id:o,children:e.name||"Current Room"}),e.area&&z.jsxs("p",{className:"room-area",children:["Area: ",e.area]}),s.length>0&&z.jsxs("div",{className:"room-exits",children:[z.jsx("h5",{children:"Exits"}),z.jsx("ul",{"aria-label":"Room Exits",children:s.map(([a,l])=>z.jsx("li",{children:z.jsx("button",{onClick:()=>i(a),title:`Go ${a} (to room ${l})`,"aria-label":`Go ${a}`,children:a.toUpperCase()})},a))})]})]})},IK=We.forwardRef(({client:t},e)=>{const n=ff(t,"userlist",[]),[r,i]=S.useState(!0),[o,s]=S.useState(!1),[a,l]=S.useState(!!t.currentRoomInfo);S.useEffect(()=>{const d=()=>s(!0);return t.on("itemsList",d),()=>{t.off("itemsList",d)}},[t]),S.useEffect(()=>{const d=()=>{a||l(!0)};return t.on("roomInfo",d),()=>{t.off("roomInfo",d)}},[t,a]);const c=[{id:"room-tab",label:"Room",content:z.jsx(xK,{client:t}),condition:a},{id:"inventory-tab",label:"Inventory",content:z.jsx(yK,{client:t}),condition:o},{id:"users-tab",label:"Users",content:z.jsx(vK,{users:n}),condition:!0},{id:"files-tab",label:"Files",content:z.jsx(qW,{client:t,expanded:r}),condition:!0},{id:"audio-tab",label:"Audio",content:z.jsx(gK,{client:t}),condition:!0}],u=We.useMemo(()=>c.filter(d=>d.condition??!0),[a,o]);return We.useImperativeHandle(e,()=>({switchToTab:d=>{var f;if(d>=0&&d<u.length){const h=(f=u[d])==null?void 0:f.id;if(h){console.log(`switchToTab: Trying index ${d}, ID: ${h}`);const p=document.getElementById(h);p?(console.log("switchToTab: Found button element, attempting click..."),p.click(),console.log("switchToTab: Click simulation finished.")):console.error(`switchToTab: Could not find button element with ID: ${h}`)}else console.warn(`switchToTab: Could not determine targetTabId for index ${d}. Visible tabs:`,u)}else console.warn(`switchToTab: Invalid targetIndex ${d}. Visible tabs count: ${u.length}`)}}),[u]),S.useEffect(()=>{const d=()=>i(!0);return t.on("fileTransferOffer",d),()=>{t.off("fileTransferOffer",d)}},[t]),z.jsxs("div",{className:"sidebar",children:[" ",z.jsxs("div",{className:"sidebar-content",children:[z.jsx(T_,{tabs:u})," "]})]})}),bK=({client:t})=>{const[e,n]=S.useState("Not connected"),[r,i]=S.useState(null),o=S.useCallback(f=>n(f),[]),s=S.useCallback(()=>n("Connected"),[]),a=S.useCallback(()=>{n("Disconnected"),i(null)},[]),l=S.useCallback(f=>i(f),[]);S.useEffect(()=>(t.on("statustext",o),t.on("connect",s),t.on("disconnect",a),t.on("vitals",l),()=>{t.off("statustext",o),t.off("connect",s),t.off("disconnect",a),t.off("vitals",l)}),[t,o,s,a,l]);const c=(f,h)=>f===void 0||h===void 0?null:`${f}/${h}`,u=c(r==null?void 0:r.hp,r==null?void 0:r.maxhp),d=c(r==null?void 0:r.mp,r==null?void 0:r.maxmp);return z.jsxs("div",{className:"statusbar",children:[z.jsx("span",{className:"status-connection",children:e}),r&&z.jsxs("span",{className:"status-vitals",children:[u&&` HP: ${u}`,d&&` MP: ${d}`]})]})};var A3={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ok=We.createContext&&We.createContext(A3),AK=["attr","size","title"];function wK(t,e){if(t==null)return{};var n=SK(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function SK(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function up(){return up=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},up.apply(this,arguments)}function sk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function dp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sk(Object(n),!0).forEach(function(r){kK(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sk(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kK(t,e,n){return e=EK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EK(t){var e=TK(t,"string");return typeof e=="symbol"?e:e+""}function TK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function w3(t){return t&&t.map((e,n)=>We.createElement(e.tag,dp({key:n},e.attr),w3(e.child)))}function ro(t){return e=>We.createElement(RK,up({attr:dp({},t.attr)},e),w3(t.child))}function RK(t){var e=n=>{var{attr:r,size:i,title:o}=t,s=wK(t,AK),a=i||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),We.createElement("svg",up({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:l,style:dp(dp({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&We.createElement("title",null,o),t.children)};return ok!==void 0?We.createElement(ok.Consumer,null,n=>e(n)):e(A3)}function _K(t){return ro({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(t)}function DK(t){return ro({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(t)}function PK(t){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(t)}function NK(t){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(t)}function BK(t){return ro({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(t)}function OK(t){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function FK(t){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(t)}function S3(t){return ro({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function MK(t){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(t)}function LK(t){return ro({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(t)}function UK(t){return ro({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}const VK=({client:t,onClearLog:e,onSaveLog:n,onCopyLog:r,onToggleSidebar:i,onOpenPrefs:o,showSidebar:s})=>{const a=ff(t,"connectionChange",t.connected),[l,c]=We.useState(t.cacophony.muted),u=ff(t,"autosayChanged",t.autosay)||!1,[d,f]=We.useState(vo.getState().general.volume),h=S.useCallback(()=>{c(!l),t.cacophony.muted=!l},[l,t]),p=S.useCallback(v=>{const m=Number(v.target.value)/100;f(m),t.cacophony.setGlobalVolume(m),vo.dispatch({type:Uo.SetGeneral,data:{...vo.getState().general,volume:m}})},[t]),g=S.useCallback(v=>{t.autosay=v.target.checked},[t]),C=S.useCallback(()=>{a?t.close():t.connect()},[a,t]);return z.jsxs("div",{className:"toolbar",children:[z.jsxs("button",{onClick:n,accessKey:"l",children:[z.jsx(S3,{}),"Save Log (Alt+L)"]}),z.jsxs("button",{onClick:r,accessKey:"C",children:[z.jsx(BK,{}),"Copy Log (Alt+Shift+C)"]}),z.jsxs("button",{onClick:e,accessKey:"E",children:[" ",z.jsx(FK,{}),"Clear Log (Alt+E)"]}),z.jsxs("button",{onClick:o,accessKey:"p",children:[z.jsx(PK,{}),"Preferences (Alt+P)"]}),z.jsxs("button",{onClick:h,accessKey:"M",children:[l?z.jsx(UK,{}):z.jsx(LK,{}),l?"Unmute":"Mute"]}),z.jsxs("label",{children:["Volume",z.jsx("input",{type:"range",min:"0",max:"100",value:d*100,onChange:p,accessKey:"V"})]}),z.jsxs("label",{children:[z.jsx(NK,{}),"Autosay",z.jsx("input",{type:"checkbox",checked:u,onChange:g})]}),z.jsx("button",{onClick:C,children:a?"Disconnect":"Connect"}),z.jsxs("button",{onClick:i,accessKey:"U",title:s?"Hide Sidebar (Alt+U)":"Show Sidebar (Alt+U)","aria-label":s?"Hide Sidebar":"Show Sidebar","aria-expanded":s,children:[s?z.jsx(DK,{}):z.jsx(_K,{}),s?"Hide Sidebar":"Show Sidebar"]})]})};function GK(){const[t,e]=S.useState(null),[n,r]=S.useState(!1),[i,o]=S.useState(!1),[s,a]=S.useState(!1);ff(t,"userlist",[]);const l=We.useRef(null),c=We.useRef(null),u=We.useRef(null),d=We.useRef(null),f=S.useRef(!1),h=()=>{l.current&&l.current.saveLog()},p=()=>{l.current&&l.current.clearLog()},g=()=>{l.current&&l.current.copyLog()},C=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);S.useEffect(()=>{if(f.current)return;const x=new Y9("mongoose.moo.mud.org",8765);x.registerGMCPPackage(e9),x.registerGMCPPackage(J6),x.registerGMCPPackage(Y6),x.registerGMCPPackage(HO),x.registerGMCPPackage(t9),x.registerGMCPPackage(q6),x.registerGMCPPackage(Q6),x.registerGMCPPackage(Q4),x.registerGMCPPackage(WO),x.registerGMCPPackage(KT),x.registerGMCPPackage(i9),x.registerGMCPPackage(nO),x.registerGMCPPackage(XT),x.registerGMCPPackage(eO),x.registerGMCPPackage(tO),x.registerGMCPPackage(rO),x.registerGMCPPackage(iO),x.registerGMCPPackage(oO),x.registerGMCPPackage(n9),x.registerGMCPPackage(r9),x.registerGMCPPackage(o9),x.registerGMCPPackage(s9),x.registerGMCPPackage(a9),x.registerGMCPPackage(l9),x.registerGMCPPackage(c9),x.registerMcpPackage(h9),x.registerMcpPackage(p9),x.registerMcpPackage(m9),x.registerMcpPackage(v9),x.connect(),x.requestNotificationPermission(),e(x),r(!C),window.mudClient=x,f.current=!0;const b=A=>{x&&(A.key==="Control"&&x.cancelSpeech(),A.key==="Escape"&&x.stopAllSounds())};window.addEventListener("keydown",b);const E=()=>{var A;(A=c.current)==null||A.focus()};return document.addEventListener("focus",E),()=>{window.removeEventListener("keydown",b),document.removeEventListener("focus",E)}},[C]),S.useEffect(()=>{const x=b=>{var A;if(!n||!b.ctrlKey)return;const E=parseInt(b.key,10);if(!isNaN(E)&&E>=1&&E<=9){const k=E-1;b.preventDefault(),console.log(`App: Detected CTRL+${E}, calling switchToTab(${k})`),(A=d.current)==null||A.switchToTab(k)}};return document.addEventListener("keydown",x,!0),()=>{document.removeEventListener("keydown",x,!0)}},[n]);const v=ff(t,"fileTransferOffer",null),m=S.useCallback(x=>{t&&t.sendCommand(x)},[t]),y=S.useCallback(()=>{var x;(x=c.current)==null||x.focus()},[]);return S.useEffect(()=>{v!==null&&(a(!0),o(!0),t==null||t.sendNotification("File Transfer Offer",`${v.sender} wants to send you ${v.filename} (${Math.round(v.filesize/1024)} KB)`))},[v,t]),HT(x=>{t&&t.shutdown()}),S.useEffect(()=>{var x;(x=c.current)==null||x.focus()},[]),t?z.jsxs("div",{className:`App ${n?"sidebar-shown":""}`,children:[z.jsx("header",{role:"banner",style:{gridArea:"header"},children:z.jsx(VK,{client:t,onSaveLog:h,onClearLog:p,onCopyLog:g,onToggleSidebar:()=>r(!n),onOpenPrefs:()=>{var x;return(x=u.current)==null?void 0:x.open()},showSidebar:n})}),z.jsx("main",{role:"main",style:{gridArea:"main"},children:z.jsx(NC,{client:t,ref:l,focusInput:y})}),n&&z.jsx("aside",{role:"complementary","aria-roledescription":"Sidebar",style:{gridArea:"sidebar"},children:z.jsx(IK,{ref:d,client:t})}),z.jsx("div",{role:"region","aria-label":"Command input",style:{gridArea:"input"},children:z.jsx(t7,{onSend:m,inputRef:c})}),z.jsx("footer",{role:"contentinfo",style:{gridArea:"status"},children:z.jsx(bK,{client:t})}),z.jsx($W,{ref:u})]}):null}function WK(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ak(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function lk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ak(Object(n),!0).forEach(function(r){WK(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ak(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jK(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function zK(t,e){if(t==null)return{};var n=jK(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function HK(t,e){return ZK(t)||$K(t,e)||XK(t,e)||KK()}function ZK(t){if(Array.isArray(t))return t}function $K(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var s=t[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(l){i=!0,o=l}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw o}}return n}}function XK(t,e){if(t){if(typeof t=="string")return ck(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ck(t,e)}}function ck(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function KK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JK(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function dk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uk(Object(n),!0).forEach(function(r){JK(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uk(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function YK(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function ld(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function fp(t){return{}.toString.call(t).includes("Object")}function qK(t){return!Object.keys(t).length}function hf(t){return typeof t=="function"}function QK(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function eJ(t,e){return fp(e)||Pa("changeType"),Object.keys(e).some(function(n){return!QK(t,n)})&&Pa("changeField"),e}function tJ(t){hf(t)||Pa("selectorType")}function nJ(t){hf(t)||fp(t)||Pa("handlerType"),fp(t)&&Object.values(t).some(function(e){return!hf(e)})&&Pa("handlersType")}function rJ(t){t||Pa("initialIsRequired"),fp(t)||Pa("initialType"),qK(t)&&Pa("initialContent")}function iJ(t,e){throw new Error(t[e]||t.default)}var oJ={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Pa=ld(iJ)(oJ),gh={changes:eJ,selector:tJ,handler:nJ,initial:rJ};function sJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gh.initial(t),gh.handler(e);var n={current:t},r=ld(cJ)(n,e),i=ld(lJ)(n),o=ld(gh.changes)(t),s=ld(aJ)(n);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return gh.selector(c),c(n.current)}function l(c){YK(r,i,o,s)(c)}return[a,l]}function aJ(t,e){return hf(e)?e(t.current):e}function lJ(t,e){return t.current=dk(dk({},t.current),e),e}function cJ(t,e,n){return hf(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var uJ={create:sJ},dJ={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function fJ(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function hJ(t){return{}.toString.call(t).includes("Object")}function pJ(t){return t||fk("configIsRequired"),hJ(t)||fk("configType"),t.urls?(gJ(),{paths:{vs:t.urls.monacoBase}}):t}function gJ(){console.warn(k3.deprecation)}function mJ(t,e){throw new Error(t[e]||t.default)}var k3={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},fk=fJ(mJ)(k3),vJ={config:pJ},CJ=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(o,s){return s(o)},i)}};function E3(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],E3(t[n],e[n]))}),lk(lk({},t),e)}var yJ={type:"cancelation",msg:"operation is manually canceled"};function tv(t){var e=!1,n=new Promise(function(r,i){t.then(function(o){return e?i(yJ):r(o)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var xJ=uJ.create({config:dJ,isInitialized:!1,resolve:null,reject:null,monaco:null}),T3=HK(xJ,2),Of=T3[0],ig=T3[1];function IJ(t){var e=vJ.config(t),n=e.monaco,r=zK(e,["monaco"]);ig(function(i){return{config:E3(i.config,r),monaco:n}})}function bJ(){var t=Of(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(ig({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),tv(nv);if(window.monaco&&window.monaco.editor)return R3(window.monaco),t.resolve(window.monaco),tv(nv);CJ(AJ,SJ)(kJ)}return tv(nv)}function AJ(t){return document.body.appendChild(t)}function wJ(t){var e=document.createElement("script");return t&&(e.src=t),e}function SJ(t){var e=Of(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),n=wJ("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function kJ(){var t=Of(function(n){var r=n.config,i=n.resolve,o=n.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){R3(n),t.resolve(n)},function(n){t.reject(n)})}function R3(t){Of().monaco||ig({monaco:t})}function EJ(){return Of(function(t){var e=t.monaco;return e})}var nv=new Promise(function(t,e){return ig({resolve:t,reject:e})}),_3={config:IJ,init:bJ,__getMonacoInstance:EJ},TJ={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},rv=TJ,RJ={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},_J=RJ;function DJ({children:t}){return We.createElement("div",{style:_J.container},t)}var PJ=DJ,NJ=PJ;function BJ({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:o,wrapperProps:s}){return We.createElement("section",{style:{...rv.wrapper,width:t,height:e},...s},!n&&We.createElement(NJ,null,r),We.createElement("div",{ref:i,style:{...rv.fullWidth,...!n&&rv.hide},className:o}))}var OJ=BJ,D3=S.memo(OJ);function FJ(t){S.useEffect(t,[])}var P3=FJ;function MJ(t,e,n=!0){let r=S.useRef(!0);S.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var Xr=MJ;function Ed(){}function mc(t,e,n,r){return LJ(t,r)||UJ(t,e,n,r)}function LJ(t,e){return t.editor.getModel(N3(t,e))}function UJ(t,e,n,r){return t.editor.createModel(e,n,r?N3(t,r):void 0)}function N3(t,e){return t.Uri.parse(e)}function VJ({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:g={},beforeMount:C=Ed,onMount:v=Ed}){let[m,y]=S.useState(!1),[x,b]=S.useState(!0),E=S.useRef(null),A=S.useRef(null),k=S.useRef(null),D=S.useRef(v),T=S.useRef(C),R=S.useRef(!1);P3(()=>{let Z=_3.init();return Z.then(q=>(A.current=q)&&b(!1)).catch(q=>(q==null?void 0:q.type)!=="cancelation"&&console.error("Monaco initialization: error:",q)),()=>E.current?G():Z.cancel()}),Xr(()=>{if(E.current&&A.current){let Z=E.current.getOriginalEditor(),q=mc(A.current,t||"",r||n||"text",o||"");q!==Z.getModel()&&Z.setModel(q)}},[o],m),Xr(()=>{if(E.current&&A.current){let Z=E.current.getModifiedEditor(),q=mc(A.current,e||"",i||n||"text",s||"");q!==Z.getModel()&&Z.setModel(q)}},[s],m),Xr(()=>{let Z=E.current.getModifiedEditor();Z.getOption(A.current.editor.EditorOption.readOnly)?Z.setValue(e||""):e!==Z.getValue()&&(Z.executeEdits("",[{range:Z.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),Z.pushUndoStop())},[e],m),Xr(()=>{var Z,q;(q=(Z=E.current)==null?void 0:Z.getModel())==null||q.original.setValue(t||"")},[t],m),Xr(()=>{let{original:Z,modified:q}=E.current.getModel();A.current.editor.setModelLanguage(Z,r||n||"text"),A.current.editor.setModelLanguage(q,i||n||"text")},[n,r,i],m),Xr(()=>{var Z;(Z=A.current)==null||Z.editor.setTheme(c)},[c],m),Xr(()=>{var Z;(Z=E.current)==null||Z.updateOptions(d)},[d],m);let P=S.useCallback(()=>{var ie;if(!A.current)return;T.current(A.current);let Z=mc(A.current,t||"",r||n||"text",o||""),q=mc(A.current,e||"",i||n||"text",s||"");(ie=E.current)==null||ie.setModel({original:Z,modified:q})},[n,e,i,t,r,o,s]),L=S.useCallback(()=>{var Z;!R.current&&k.current&&(E.current=A.current.editor.createDiffEditor(k.current,{automaticLayout:!0,...d}),P(),(Z=A.current)==null||Z.editor.setTheme(c),y(!0),R.current=!0)},[d,c,P]);S.useEffect(()=>{m&&D.current(E.current,A.current)},[m]),S.useEffect(()=>{!x&&!m&&L()},[x,m,L]);function G(){var q,ie,$,Q;let Z=(q=E.current)==null?void 0:q.getModel();a||((ie=Z==null?void 0:Z.original)==null||ie.dispose()),l||(($=Z==null?void 0:Z.modified)==null||$.dispose()),(Q=E.current)==null||Q.dispose()}return We.createElement(D3,{width:h,height:f,isEditorReady:m,loading:u,_ref:k,className:p,wrapperProps:g})}var GJ=VJ;S.memo(GJ);function WJ(t){let e=S.useRef();return S.useEffect(()=>{e.current=t},[t]),e.current}var jJ=WJ,mh=new Map;function zJ({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:o,theme:s="light",line:a,loading:l="Loading...",options:c={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:g,wrapperProps:C={},beforeMount:v=Ed,onMount:m=Ed,onChange:y,onValidate:x=Ed}){let[b,E]=S.useState(!1),[A,k]=S.useState(!0),D=S.useRef(null),T=S.useRef(null),R=S.useRef(null),P=S.useRef(m),L=S.useRef(v),G=S.useRef(),Z=S.useRef(r),q=jJ(o),ie=S.useRef(!1),$=S.useRef(!1);P3(()=>{let O=_3.init();return O.then(j=>(D.current=j)&&k(!1)).catch(j=>(j==null?void 0:j.type)!=="cancelation"&&console.error("Monaco initialization: error:",j)),()=>T.current?ne():O.cancel()}),Xr(()=>{var j,J,ee,se;let O=mc(D.current,t||r||"",e||i||"",o||n||"");O!==((j=T.current)==null?void 0:j.getModel())&&(d&&mh.set(q,(J=T.current)==null?void 0:J.saveViewState()),(ee=T.current)==null||ee.setModel(O),d&&((se=T.current)==null||se.restoreViewState(mh.get(o))))},[o],b),Xr(()=>{var O;(O=T.current)==null||O.updateOptions(c)},[c],b),Xr(()=>{!T.current||r===void 0||(T.current.getOption(D.current.editor.EditorOption.readOnly)?T.current.setValue(r):r!==T.current.getValue()&&($.current=!0,T.current.executeEdits("",[{range:T.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),T.current.pushUndoStop(),$.current=!1))},[r],b),Xr(()=>{var j,J;let O=(j=T.current)==null?void 0:j.getModel();O&&i&&((J=D.current)==null||J.editor.setModelLanguage(O,i))},[i],b),Xr(()=>{var O;a!==void 0&&((O=T.current)==null||O.revealLine(a))},[a],b),Xr(()=>{var O;(O=D.current)==null||O.editor.setTheme(s)},[s],b);let Q=S.useCallback(()=>{var O;if(!(!R.current||!D.current)&&!ie.current){L.current(D.current);let j=o||n,J=mc(D.current,r||t||"",e||i||"",j||"");T.current=(O=D.current)==null?void 0:O.editor.create(R.current,{model:J,automaticLayout:!0,...c},u),d&&T.current.restoreViewState(mh.get(j)),D.current.editor.setTheme(s),a!==void 0&&T.current.revealLine(a),E(!0),ie.current=!0}},[t,e,n,r,i,o,c,u,d,s,a]);S.useEffect(()=>{b&&P.current(T.current,D.current)},[b]),S.useEffect(()=>{!A&&!b&&Q()},[A,b,Q]),Z.current=r,S.useEffect(()=>{var O,j;b&&y&&((O=G.current)==null||O.dispose(),G.current=(j=T.current)==null?void 0:j.onDidChangeModelContent(J=>{$.current||y(T.current.getValue(),J)}))},[b,y]),S.useEffect(()=>{if(b){let O=D.current.editor.onDidChangeMarkers(j=>{var ee;let J=(ee=T.current.getModel())==null?void 0:ee.uri;if(J&&j.find(se=>se.path===J.path)){let se=D.current.editor.getModelMarkers({resource:J});x==null||x(se)}});return()=>{O==null||O.dispose()}}return()=>{}},[b,x]);function ne(){var O,j;(O=G.current)==null||O.dispose(),f?d&&mh.set(o,T.current.saveViewState()):(j=T.current.getModel())==null||j.dispose(),T.current.dispose()}return We.createElement(D3,{width:h,height:p,isEditorReady:b,loading:l,_ref:R,className:g,wrapperProps:C})}var HJ=zJ,ZJ=S.memo(HJ),$J=ZJ,XJ={restoreOnUnmount:!1};function KJ(t,e){e===void 0&&(e=XJ);var n=S.useRef(document.title);document.title!==t&&(document.title=t),S.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const JJ=typeof document<"u"?KJ:function(t){};function YJ({onSave:t,onRevert:e,onDownload:n}){return z.jsx("div",{className:"editor-toolbar",children:z.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[z.jsxs("button",{onClick:t,accessKey:"s",title:"Save (Alt+S)",children:[z.jsx(S3,{"aria-hidden":"true"}),"Save"]}),z.jsxs("button",{onClick:e,accessKey:"r",title:"Revert (Alt+R)",children:[z.jsx(MK,{"aria-hidden":"true"}),"Revert"]}),z.jsxs("button",{onClick:n,accessKey:"d",title:"Download (Alt+D)",children:[z.jsx(OK,{"aria-hidden":"true"}),"Download"]})]})})}const qJ=({docstate:t,session:e})=>z.jsxs("div",{"aria-live":"polite",className:"editor-statusbar",children:[z.jsx("span",{children:t}),z.jsx("span",{"aria-hidden":"true",children:"|"}),z.jsx("span",{children:e.reference}),z.jsx("span",{"aria-hidden":"true",children:"|"}),z.jsx("span",{children:e.type})]});function QJ(){const t=jT(),e=We.useRef(null),[n,r]=S.useState(""),[i,o]=S.useState(""),[s,a]=S.useState(""),[l,c]=S.useState(0),[u,d]=S.useState({name:"none",contents:[],reference:"",type:""}),f=(L,G)=>{e.current=L},[h,p]=js();console.log(h);const g=h.editor.accessibilityMode,C=h.editor.autocompleteEnabled;HT(L=>{b.postMessage({type:"close",id:A}),l===1&&L.preventDefault()});const[v,m]=S.useState(!1),y=v?`${u.name} - Mongoose Editor`:"Mongoose Editor";JJ(y);const x=S.useMemo(()=>{switch(l){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[l]),b=S.useMemo(()=>new BroadcastChannel("editor"),[]),E=new URLSearchParams(t.search),A=decodeURIComponent(E.get("reference")||"");S.useEffect(()=>{if(!A)return;console.log("ID: "+A),console.log("Sending ready message"),b.postMessage({type:"ready",id:A});const L=G=>{switch(console.log(G.data),G.data.type){case"load":if(n!=="")return;const Z=G.data.session.contents.join(`
`);o(Z),a(Z),d(G.data.session),c(0),r(G.data.clientId),m(!0),setTimeout(P,100);break;case"shutdown":if(console.log("Received shutdown message"),l===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;b.close(),window.close();break;default:console.warn("Unknown message type received",G.data.type)}};return b.addEventListener("message",L),()=>{b.removeEventListener("message",L),b.postMessage({type:"close",id:A})}},[b,n,A,l]);const k=()=>{o(s),c(0)},D=L=>{const G=i.split(/\r\n|\r|\n/),Z={...u,contents:G};b.postMessage({type:"save",session:Z,id:A}),c(2),P(),L.preventDefault()},T=L=>{L!==void 0&&(console.log("Original: "+s),console.log("New: "+L),o(L),L.split(/\r\n|\r|\n/).join(`
`)!==s?c(1):c(0),v||m(!0))},R=()=>{const L=new Blob([i],{type:"text/plain"}),G=URL.createObjectURL(L),Z=document.createElement("a"),q=new Date,ie=q.toLocaleDateString().replace(/\//g,"-"),$=q.toLocaleTimeString().replace(/:/g,"-"),Q=`${u.name}-${ie}-${$}.txt`;Z.download=Q,Z.href=G,Z.click(),URL.revokeObjectURL(G),Z.remove()};return z.jsxs("div",{id:"editor-window",children:[z.jsx(YJ,{onSave:D,onRevert:k,onDownload:R}),z.jsx($J,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:T,options:{wordWrap:"on",accessibilitySupport:g?"on":"off",quickSuggestions:C},onMount:f,path:u.reference}),z.jsx(qJ,{docstate:x,session:u})]});function P(){e.current!==null&&e.current.focus()}}const eY="modulepreload",tY=function(t){return"/"+t},hk={},B3=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=tY(l),l in hk)return;hk[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":eY,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},nY=t=>{t&&t instanceof Function&&B3(async()=>{const{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-CFnx-5Zt.js");return{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{e(t),n(t),r(t),i(t),o(t)})};function rY(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:s}=t;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await B3(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{s==null||s(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||r==null||r()}),a.register({immediate:e}).then(d=>{o?o("/sw.js",d):i==null||i(d)}).catch(d=>{s==null||s(d)})}}return l=u(),c}const iY=k4([{path:"/",element:z.jsx(GK,{})},{path:"/editor",element:z.jsx(QJ,{})}]),oY=iv.createRoot(document.getElementById("root"));oY.render(z.jsx(We.StrictMode,{children:z.jsx(O4,{router:iY})}));nY(console.log);rY();

/*! For license information please see main.5961f728.js.LICENSE.txt */

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7e6fe8cb-ba29-509a-b640-9d2ab70b09cf")}catch(e){}}();
(()=>{var e={900:(e,t,n)=>{"use strict";function r(){return"undefined"!==typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}function i(){return"npm"}n.d(t,{S:()=>i,n:()=>r})},685:(e,t,n)=>{"use strict";n.d(t,{KV:()=>i,l$:()=>o});var r=n(900);function i(){return!(0,r.n)()&&"[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0)}function o(e,t){return e.require(t)}e=n.hmd(e)},846:(e,t,n)=>{"use strict";n.d(t,{Z1:()=>h,ph:()=>u,yW:()=>l});var r=n(685),i=n(748);e=n.hmd(e);const o=(0,i.Rf)(),s={nowSeconds:()=>Date.now()/1e3};const a=(0,r.KV)()?function(){try{return(0,r.l$)(e,"perf_hooks").performance}catch(t){return}}():function(){const{performance:e}=o;if(!e||!e.now)return;return{now:()=>e.now(),timeOrigin:Date.now()-e.now()}}(),c=void 0===a?s:{nowSeconds:()=>(a.timeOrigin+a.now())/1e3},l=s.nowSeconds.bind(s),u=c.nowSeconds.bind(c);let d;const h=(()=>{const{performance:e}=o;if(!e||!e.now)return void(d="none");const t=36e5,n=e.now(),r=Date.now(),i=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,s=i<t,a=e.timing&&e.timing.navigationStart,c="number"===typeof a?Math.abs(a+n-r):t;return s||c<t?i<=c?(d="timeOrigin",e.timeOrigin):(d="navigationStart",a):(d="dateNow",r)})()},748:(e,t,n)=>{"use strict";function r(e){return e&&e.Math==Math?e:void 0}n.d(t,{Rf:()=>o,YO:()=>s,n2:()=>i});const i="object"==typeof globalThis&&r(globalThis)||"object"==typeof window&&r(window)||"object"==typeof self&&r(self)||"object"==typeof n.g&&r(n.g)||function(){return this}()||{};function o(){return i}function s(e,t,n){const r=n||i,o=r.__SENTRY__=r.__SENTRY__||{};return o[e]||(o[e]=t())}},634:e=>{"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var n=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return t(e,null,[{key:"escapeForHtml",value:function(t){return(new e).escapeForHtml(t)}},{key:"linkify",value:function(t){return(new e).linkify(t)}},{key:"ansiToHtml",value:function(t,n){return(new e).ansiToHtml(t,n)}},{key:"ansiToJson",value:function(t,n){return(new e).ansiToJson(t,n)}},{key:"ansiToText",value:function(t){return(new e).ansiToText(t)}}]),t(e,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var e=0;e<2;++e)for(var t=0;t<8;++t)this.PALETTE_COLORS.push(n[e][t].color);for(var r=[0,95,135,175,215,255],i=function(e,t,n){return r[e]+", "+r[t]+", "+r[n]},o=0;o<6;++o)for(var s=0;s<6;++s)for(var a=0;a<6;++a)this.PALETTE_COLORS.push(i(o,s,a));for(var c=8,l=0;l<24;++l,c+=10)this.PALETTE_COLORS.push(i(c,c,c))}},{key:"escapeForHtml",value:function(e){return e.replace(/[&<>\"]/gm,(function(e){return"&"==e?"&amp;":'"'==e?"&quot;":"<"==e?"&lt;":">"==e?"&gt;":""}))}},{key:"linkify",value:function(e){return e.replace(/(https?:\/\/[^\s]+)/gm,(function(e){return'<a href="'+e+'">'+e+"</a>"}))}},{key:"ansiToHtml",value:function(e,t){return this.process(e,t,!0)}},{key:"ansiToJson",value:function(e,t){return(t=t||{}).json=!0,t.clearLine=!1,this.process(e,t,!0)}},{key:"ansiToText",value:function(e){return this.process(e,{},!1)}},{key:"process",value:function(e,t,n){var r=this,i=e.split(/\033\[/),o=i.shift();void 0!==t&&null!==t||(t={}),t.clearLine=/\r/.test(e);var s=i.map((function(e){return r.processChunk(e,t,n)}));if(t&&t.json){var a=this.processChunkJson("");return a.content=o,a.clearLine=t.clearLine,s.unshift(a),t.remove_empty&&(s=s.filter((function(e){return!e.isEmpty()}))),s}return s.unshift(o),s.join("")}},{key:"processChunkJson",value:function(e,t,r){var i=(t="undefined"==typeof t?{}:t).use_classes="undefined"!=typeof t.use_classes&&t.use_classes,o=t.key=i?"class":"color",s={content:e,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:t.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!s.content}},a=e.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!a)return s;s.content=a[4];var c=a[2].split(";");if(""!==a[1]||"m"!==a[3])return s;if(!r)return s;for(var l=this;c.length>0;){var u=c.shift(),d=parseInt(u);if(isNaN(d)||0===d)l.fg=l.bg=null,l.decorations=[];else if(1===d)l.decorations.push("bold");else if(2===d)l.decorations.push("dim");else if(3===d)l.decorations.push("italic");else if(4===d)l.decorations.push("underline");else if(5===d)l.decorations.push("blink");else if(7===d)l.decorations.push("reverse");else if(8===d)l.decorations.push("hidden");else if(9===d)l.decorations.push("strikethrough");else if(21===d)l.removeDecoration("bold");else if(22===d)l.removeDecoration("bold"),l.removeDecoration("dim");else if(23===d)l.removeDecoration("italic");else if(24===d)l.removeDecoration("underline");else if(25===d)l.removeDecoration("blink");else if(27===d)l.removeDecoration("reverse");else if(28===d)l.removeDecoration("hidden");else if(29===d)l.removeDecoration("strikethrough");else if(39===d)l.fg=null;else if(49===d)l.bg=null;else if(d>=30&&d<38)l.fg=n[0][d%10][o];else if(d>=90&&d<98)l.fg=n[1][d%10][o];else if(d>=40&&d<48)l.bg=n[0][d%10][o];else if(d>=100&&d<108)l.bg=n[1][d%10][o];else if(38===d||48===d){var h=38===d;if(c.length>=1){var p=c.shift();if("5"===p&&c.length>=1){var f=parseInt(c.shift());if(f>=0&&f<=255)if(i){var m=f>=16?"ansi-palette-"+f:n[f>7?1:0][f%8].class;h?l.fg=m:l.bg=m}else this.PALETTE_COLORS||l.setupPalette(),h?l.fg=this.PALETTE_COLORS[f]:l.bg=this.PALETTE_COLORS[f]}else if("2"===p&&c.length>=3){var g=parseInt(c.shift()),v=parseInt(c.shift()),y=parseInt(c.shift());if(g>=0&&g<=255&&v>=0&&v<=255&&y>=0&&y<=255){var b=g+", "+v+", "+y;i?h?(l.fg="ansi-truecolor",l.fg_truecolor=b):(l.bg="ansi-truecolor",l.bg_truecolor=b):h?l.fg=b:l.bg=b}}}}}if(null===l.fg&&null===l.bg&&0===l.decorations.length)return s;return s.fg=l.fg,s.bg=l.bg,s.fg_truecolor=l.fg_truecolor,s.bg_truecolor=l.bg_truecolor,s.decorations=l.decorations,s.decoration=l.decorations.slice(-1).pop()||null,s.was_processed=!0,s}},{key:"processChunk",value:function(e,t,r){var i=this;t=t||{};var o=this.processChunkJson(e,t,r),s=t.use_classes;if(o.decorations=o.decorations.filter((function(e){if("reverse"===e){o.fg||(o.fg=n[0][7][s?"class":"color"]),o.bg||(o.bg=n[0][0][s?"class":"color"]);var t=o.fg;o.fg=o.bg,o.bg=t;var r=o.fg_truecolor;return o.fg_truecolor=o.bg_truecolor,o.bg_truecolor=r,o.isInverted=!0,!1}return!0})),t.json)return o;if(o.isEmpty())return"";if(!o.was_processed)return o.content;var a=[],c=[],l=[],u={},d=function(e){var t=[],n=void 0;for(n in e)e.hasOwnProperty(n)&&t.push("data-"+n+'="'+i.escapeForHtml(e[n])+'"');return t.length>0?" "+t.join(" "):""};return o.isInverted&&(u["ansi-is-inverted"]="true"),o.fg&&(s?(a.push(o.fg+"-fg"),null!==o.fg_truecolor&&(u["ansi-truecolor-fg"]=o.fg_truecolor,o.fg_truecolor=null)):a.push("color:rgb("+o.fg+")")),o.bg&&(s?(a.push(o.bg+"-bg"),null!==o.bg_truecolor&&(u["ansi-truecolor-bg"]=o.bg_truecolor,o.bg_truecolor=null)):a.push("background-color:rgb("+o.bg+")")),o.decorations.forEach((function(e){s?c.push("ansi-"+e):"bold"===e?c.push("font-weight:bold"):"dim"===e?c.push("opacity:0.5"):"italic"===e?c.push("font-style:italic"):"hidden"===e?c.push("visibility:hidden"):"strikethrough"===e?l.push("line-through"):l.push(e)})),l.length&&c.push("text-decoration:"+l.join(" ")),s?'<span class="'+a.concat(c).join(" ")+'"'+d(u)+">"+o.content+"</span>":'<span style="'+a.concat(c).join(";")+'"'+d(u)+">"+o.content+"</span>"}},{key:"removeDecoration",value:function(e){var t=this.decorations.indexOf(e);t>=0&&this.decorations.splice(t,1)}}]),e}();e.exports=r},667:function(e,t,n){!function(e,t,n,r){"use strict";var i=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},o=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},s=function(e,t){return{startTime:t,type:"setValue",value:e}},a=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},c=function(e,t,n){var r=n.startTime,i=n.target,o=n.timeConstant;return i+(t-i)*Math.exp((r-e)/o)},l=function(e){return"exponentialRampToValue"===e.type},u=function(e){return"linearRampToValue"===e.type},d=function(e){return l(e)||u(e)},h=function(e){return"setValue"===e.type},p=function(e){return"setValueCurve"===e.type},f=function e(t,n,r,i){var o=t[n];return void 0===o?i:d(o)||h(o)?o.value:p(o)?o.values[o.values.length-1]:c(r,e(t,n-1,o.startTime,i),o)},m=function(e,t,n,r,i){return void 0===n?[r.insertTime,i]:d(n)?[n.endTime,n.value]:h(n)?[n.startTime,n.value]:p(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,f(e,t-1,n.startTime,i)]},g=function(e){return"cancelAndHold"===e.type},v=function(e){return"cancelScheduledValues"===e.type},y=function(e){return g(e)||v(e)?e.cancelTime:l(e)||u(e)?e.endTime:e.startTime},b=function(e,t,n,r){var i=r.endTime,o=r.value;return n===o?o:0<n&&0<o||n<0&&o<0?n*Math.pow(o/n,(e-t)/(i-t)):0},w=function(e,t,n,r){return n+(e-t)/(r.endTime-t)*(r.value-n)},k=function(e,t){var n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]},S=function(e,t){var n=t.duration,r=t.startTime,i=t.values,o=(e-r)/n*(i.length-1);return k(i,o)},T=function(e){return"setTarget"===e.type},E=function(e){function k(e){n(this,k),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return r(k,[{key:e,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=y(e);if(g(e)||v(e)){var n=this._automationEvents.findIndex((function(n){return v(e)&&p(n)?n.startTime+n.duration>=t:y(n)>=t})),r=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),g(e)){var c=this._automationEvents[this._automationEvents.length-1];if(void 0!==r&&d(r)){if(void 0!==c&&T(c))throw new Error("The internal list is malformed.");var h=void 0===c?r.insertTime:p(c)?c.startTime+c.duration:y(c),f=void 0===c?this._defaultValue:p(c)?c.values[c.values.length-1]:c.value,m=l(r)?b(t,h,f,r):w(t,h,f,r),k=l(r)?i(m,t,this._currenTime):o(m,t,this._currenTime);this._automationEvents.push(k)}if(void 0!==c&&T(c)&&this._automationEvents.push(s(this.getValue(t),t)),void 0!==c&&p(c)&&c.startTime+c.duration>t){var S=t-c.startTime,E=(c.values.length-1)/c.duration,C=Math.max(2,1+Math.ceil(S*E)),_=S/(C-1)*E,x=c.values.slice(0,C);if(_<1)for(var I=1;I<C;I+=1){var R=_*I%1;x[I]=c.values[I-1]*(1-R)+c.values[I]*R}this._automationEvents[this._automationEvents.length-1]=a(x,c.startTime,S)}}}else{var P=this._automationEvents.findIndex((function(e){return y(e)>t})),O=-1===P?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[P-1];if(void 0!==O&&p(O)&&y(O)+O.duration>t)return!1;var M=l(e)?i(e.value,e.endTime,this._currenTime):u(e)?o(e.value,t,this._currenTime):e;if(-1===P)this._automationEvents.push(M);else{if(p(e)&&t+e.duration>y(this._automationEvents[P]))return!1;this._automationEvents.splice(P,0,M)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex((function(t){return y(t)>e}));if(t>1){var n=this._automationEvents.slice(t-1),r=n[0];T(r)&&n.unshift(s(f(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var n=this._automationEvents.findIndex((function(t){return y(t)>e})),r=this._automationEvents[n],i=(-1===n?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(void 0!==o&&T(o)&&(void 0===r||!d(r)||r.insertTime>e))return c(e,f(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(void 0!==o&&h(o)&&(void 0===r||!d(r)))return o.value;if(void 0!==o&&p(o)&&(void 0===r||!d(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?S(e,o):o.values[o.values.length-1];if(void 0!==o&&d(o)&&(void 0===r||!d(r)))return o.value;if(void 0!==r&&l(r)){var s=m(this._automationEvents,i,o,r,this._defaultValue),a=t(s,2),g=a[0],v=a[1];return b(e,g,v,r)}if(void 0!==r&&u(r)){var k=m(this._automationEvents,i,o,r,this._defaultValue),E=t(k,2),C=E[0],_=E[1];return w(e,C,_,r)}return this._defaultValue}}]),k}(Symbol.iterator),C=function(e){return{cancelTime:e,type:"cancelAndHold"}},_=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},x=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},I=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},R=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}};e.AutomationEventList=E,e.createCancelAndHoldAutomationEvent=C,e.createCancelScheduledValuesAutomationEvent=_,e.createExponentialRampToValueAutomationEvent=x,e.createLinearRampToValueAutomationEvent=I,e.createSetTargetAutomationEvent=R,e.createSetValueAutomationEvent=s,e.createSetValueCurveAutomationEvent=a}(t,n(424),n(690),n(728))},9:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=a(e),s=o[0],c=o[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,c)),u=0,d=c>0?s-4:s;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,l=r-i;a<l;a+=s)o.push(c(e,a,a+s>l?l:a+s));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],r=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},778:(e,t,n)=>{"use strict";const r=n(9),i=n(38),o="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=c,t.h2=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return l(e,t,n)}function l(e,t,n){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=a(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const i=function(e){if(c.isBuffer(e)){const t=0|f(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!==typeof e.length||K(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return u(e),a(e<0?0:0|f(e))}function h(e){const t=e.length<0?0:0|f(e.length),n=a(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function f(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(e).length;default:if(i)return r?-1:H(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return _(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){let o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(l(e,o)===l(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(l(e,o+r)!==l(t,r)){n=!1;break}if(n)return o}return-1}function w(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(K(r))return s;e[n+s]=r}return s}function k(e,t,n,r){return G(H(t,e.length-n),e,n,r)}function S(e,t,n,r){return G(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return G(J(t),e,n,r)}function E(e,t,n,r){return G(function(e,t){let n,r,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function _(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128===(192&n)&&(c=(31&t)<<6|63&n,c>127&&(o=c));break;case 3:n=e[i+1],r=e[i+2],128===(192&n)&&128===(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){const t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=x));return n}(r)}c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?a(e):void 0!==t?"string"===typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},c.allocUnsafe=function(e){return d(e)},c.allocUnsafeSlow=function(e){return d(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(Y(t,Uint8Array))i+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.h2;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,i){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),l=this.slice(r,i),u=e.slice(t,n);for(let c=0;c<a;++c)if(l[c]!==u[c]){o=l[c],s=u[c];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return k(this,e,t,n);case"ascii":case"latin1":case"binary":return S(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function I(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function R(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let o=t;o<n;++o)i+=X[e[o]];return i}function O(e,t,n){const r=e.slice(t,n);let i="";for(let o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function M(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function A(e,t,n,r,i){V(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function D(e,t,n,r,i){V(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function L(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,r,o){return t=+t,n>>>=0,o||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,o){return t=+t,n>>>=0,o||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Q((function(e){W(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=Q((function(e){W(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Q((function(e){W(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Q((function(e){W(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){N(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){N(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Q((function(e,t=0){return A(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Q((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);N(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);N(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Q((function(e,t=0){return A(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Q((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},c.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};const B={};function j(e,t,n){B[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function z(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function V(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"===typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new B.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){W(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||q(t,e.length-(n+1))}(r,i,o)}function W(e,t){if("number"!==typeof e)throw new B.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,n){if(Math.floor(e)!==e)throw W(e,n),new B.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new B.ERR_BUFFER_OUT_OF_BOUNDS;throw new B.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=z(String(n)):"bigint"===typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=z(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const $=/[^+/0-9A-Za-z-_]/g;function H(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function J(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace($,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function G(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!==e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Q(e){return"undefined"===typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},143:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[o]=1===l.length?l[0]:l:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},110:(e,t,n)=>{"use strict";var r=n(441),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(f){var i=p(n);i&&i!==f&&e(t,i,r)}var s=u(n);d&&(s=s.concat(d(n)));for(var a=c(t),m=c(n),g=0;g<s.length;++g){var v=s[g];if(!o[v]&&(!r||!r[v])&&(!m||!m[v])&&(!a||!a[v])){var y=h(n,v);try{l(t,v,y)}catch(b){}}}}return t}},38:(e,t)=>{t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,h=n?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=l}return(p?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,l=8*o-i-1,u=(1<<l)-1,d=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+p]=255&s,p+=f,s/=256,l-=8);e[n+p-f]|=128*m}},895:function(e,t,n){var r,i;!function(o,s){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"===typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(r){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}function a(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function l(e,t,n){return s(e)||c.apply(this,arguments)}function u(e,n,i){var o,s=this;n=null==n?"WARN":n;var c="loglevel";function u(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(i){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(i){}}}function d(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(i){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(i){}return void 0===s.levels[e]&&(e=void 0),e}}function h(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"===typeof e?c+=":"+e:"symbol"===typeof e&&(c=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=i||l,s.getLevel=function(){return o},s.setLevel=function(n,r){if("string"===typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"===typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&u(n),a.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){n=e,d()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(n,!1),h()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var p=d();null==p&&(p=n),s.setLevel(p,!1)}var d=new u,h={};d.getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=h[e];return t||(t=h[e]=new u(e,d.getLevel(),d.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return h},d.default=d,d},void 0===(i="function"===typeof r?r.call(t,n,t,e):r)||(e.exports=i)}()},463:(e,t,n)=>{"use strict";var r=n(791),i=n(296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),S=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),x=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var A=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=A&&e[A]||e["@@iterator"])?e:null}var L,U=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var B=!1;function j(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var c="\n"+i[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=a);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case S:return"Portal";case C:return"Profiler";case E:return"StrictMode";case R:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case x:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function $(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=$(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=$(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){X(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function oe(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Te=null,Ee=null;function Ce(e){if(e=bi(e)){if("function"!==typeof Se)throw Error(o(280));var t=e.stateNode;t&&(t=ki(t),Se(e.stateNode,e.type,t))}}function _e(e){Te?Ee?Ee.push(e):Ee=[e]:Te=e}function xe(){if(Te){var e=Te,t=Ee;if(Ee=Te=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ie(e,t){return e(t)}function Re(){}var Pe=!1;function Oe(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Ie(e,t,n)}finally{Pe=!1,(null!==Te||null!==Ee)&&(Re(),xe())}}function Me(e,t){var n=e.stateNode;if(null===n)return null;var r=ki(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Ne=!1;if(u)try{var Ae={};Object.defineProperty(Ae,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",Ae,Ae),window.removeEventListener("test",Ae,Ae)}catch(ue){Ne=!1}function De(e,t,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Le=!1,Ue=null,Fe=!1,Be=null,je={onError:function(e){Le=!0,Ue=e}};function ze(e,t,n,r,i,o,s,a,c){Le=!1,Ue=null,De.apply(je,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Ve(e)!==e)throw Error(o(188))}function $e(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return qe(i),e;if(s===r)return qe(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Je=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Ke=i.unstable_requestPaint,Xe=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/ct|0)|0},at=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=dt(a):0!==(o&=s)&&(r=dt(o))}else 0!==(s=n&~i)?r=dt(s):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,St,Tt,Et,Ct,_t=!1,xt=[],It=null,Rt=null,Pt=null,Ot=new Map,Mt=new Map,Nt=[],At="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mt.delete(t.pointerId)}}function Lt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ut(e){var t=yi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Ct(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Bt(e,t,n){Ft(e)&&n.delete(t)}function jt(){_t=!1,null!==It&&Ft(It)&&(It=null),null!==Rt&&Ft(Rt)&&(Rt=null),null!==Pt&&Ft(Pt)&&(Pt=null),Ot.forEach(Bt),Mt.forEach(Bt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jt)))}function Vt(e){function t(t){return zt(t,e)}if(0<xt.length){zt(xt[0],e);for(var n=1;n<xt.length;n++){var r=xt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&zt(It,e),null!==Rt&&zt(Rt,e),null!==Pt&&zt(Pt,e),Ot.forEach(t),Mt.forEach(t),n=0;n<Nt.length;n++)(r=Nt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Nt.length&&null===(n=Nt[0]).blockedOn;)Ut(n),null===n.blockedOn&&Nt.shift()}var Wt=w.ReactCurrentBatchConfig,qt=!0;function $t(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=1,Jt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function Ht(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=4,Jt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function Jt(e,t,n,r){if(qt){var i=Yt(e,t,n,r);if(null===i)qr(e,t,r,Gt,n),Dt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return It=Lt(It,e,t,n,r,i),!0;case"dragenter":return Rt=Lt(Rt,e,t,n,r,i),!0;case"mouseover":return Pt=Lt(Pt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Ot.set(o,Lt(Ot.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Mt.set(o,Lt(Mt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Dt(e,r),4&t&&-1<At.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&kt(o),null===(o=Yt(e,t,n,r))&&qr(e,t,r,Gt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Gt=null;function Yt(e,t,n,r){if(Gt=null,null!==(e=yi(e=ke(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(ln),dn=U({},ln,{view:0,detail:0}),hn=on(dn),pn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(sn=e.screenX-cn.screenX,an=e.screenY-cn.screenY):an=sn=0,cn=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=on(pn),mn=on(U({},pn,{dataTransfer:0})),gn=on(U({},dn,{relatedTarget:0})),vn=on(U({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=U({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),wn=on(U({},ln,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function Cn(){return En}var _n=U({},dn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=on(_n),In=on(U({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=on(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Pn=on(U({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=U({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mn=on(On),Nn=[9,13,27,32],An=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Dn,Un=u&&(!An||Dn&&8<Dn&&11>=Dn),Fn=String.fromCharCode(32),Bn=!1;function jn(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function $n(e,t,n,r){_e(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Jn=null;function Gn(e){Fr(e,0)}function Yn(e){if(J(wi(e)))return e}function Kn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Qn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Qn=Zn}else Qn=!1;Xn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Jn=Hn=null)}function nr(e){if("value"===e.propertyName&&Yn(Jn)){var t=[];$n(t,Jn,e,ke(e)),Oe(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Jn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Jn)}function or(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=ur(n,o);var s=ur(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=Hr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},Tr={},Er={};function Cr(e){if(Tr[e])return Tr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Tr[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var _r=Cr("animationend"),xr=Cr("animationiteration"),Ir=Cr("animationstart"),Rr=Cr("transitionend"),Pr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mr(e,t){Pr.set(e,t),c(t,[e])}for(var Nr=0;Nr<Or.length;Nr++){var Ar=Or[Nr];Mr(Ar.toLowerCase(),"on"+(Ar[0].toUpperCase()+Ar.slice(1)))}Mr(_r,"onAnimationEnd"),Mr(xr,"onAnimationIteration"),Mr(Ir,"onAnimationStart"),Mr("dblclick","onDoubleClick"),Mr("focusin","onFocus"),Mr("focusout","onBlur"),Mr(Rr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,a,c,l){if(ze.apply(this,arguments),Le){if(!Le)throw Error(o(198));var u=Ue;Le=!1,Ue=null,Fe||(Fe=!0,Be=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;Ur(i,a,l),o=c}else for(s=0;s<r.length;s++){if(c=(a=r[s]).instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;Ur(i,a,l),o=c}}}if(Fe)throw e=Be,Fe=!1,Be=null,e}function Br(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function jr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[zr]){e[zr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||jr(t,!1,e),jr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,jr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Kt(t)){case 1:var i=$t;break;case 4:i=Ht;break;default:i=Jt}n=i.bind(null,t,n,e),i=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=yi(a)))return;if(5===(c=s.tag)||6===c){r=o=s;continue e}a=a.parentNode}}r=r.return}Oe((function(){var r=o,i=ke(n),s=[];e:{var a=Pr.get(e);if(void 0!==a){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=xn;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Rn;break;case _r:case xr:case Ir:c=vn;break;case Rr:c=Pn;break;case"scroll":c=hn;break;case"wheel":c=Mn;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=In}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Me(f,h))&&u.push($r(f,m,p)))),d)break;f=f.return}0<u.length&&(a=new c(a,l,null,n,i),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!yi(l)&&!l[fi])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?yi(l):null)&&(l!==(d=Ve(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==c?a:wi(c),p=null==l?a:wi(l),(a=new u(m,f+"leave",c,n,i)).target=d,a.relatedTarget=p,m=null,yi(i)===r&&((u=new u(h,f+"enter",l,n,i)).target=p,u.relatedTarget=d,m=u),d=m,c&&l)e:{for(h=l,f=0,p=u=c;p;p=Jr(p))f++;for(p=0,m=h;m;m=Jr(m))p++;for(;0<f-p;)u=Jr(u),f--;for(;0<p-f;)h=Jr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Jr(u),h=Jr(h)}u=null}else u=null;null!==c&&Gr(s,a,c,u,!1),null!==l&&null!==d&&Gr(s,d,l,u,!0)}if("select"===(c=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var g=Kn;else if(qn(a))if(Xn)g=sr;else{g=ir;var v=rr}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=or);switch(g&&(g=g(e,r))?$n(s,g,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?wi(r):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,i)}var y;if(An)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?jn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=en()):(Qt="value"in(Xt=i)?Xt.value:Xt.textContent,Vn=!0)),0<(v=Hr(r,b)).length&&(b=new wn(b,e,null,n,i),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=zn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Bn=!0,Fn);case"textInput":return(e=t.data)===Fn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!An&&jn(e,t)?(e=en(),Zt=Qt=Xt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=y))}Fr(s,t)}))}function $r(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Me(e,n))&&r.unshift($r(e,o,i)),null!=(o=Me(e,t))&&r.push($r(e,o,i))),e=e.return}return r}function Jr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===r)break;5===a.tag&&null!==l&&(a=l,i?null!=(c=Me(n,o))&&s.unshift($r(n,c,a)):i||null!=(c=Me(n,o))&&s.push($r(n,c,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Kr,"")}function Qr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(o(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function ci(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,pi="__reactProps$"+di,fi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,vi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function ki(e){return e[pi]||null}var Si=[],Ti=-1;function Ei(e){return{current:e}}function Ci(e){0>Ti||(e.current=Si[Ti],Si[Ti]=null,Ti--)}function _i(e,t){Ti++,Si[Ti]=e.current,e.current=t}var xi={},Ii=Ei(xi),Ri=Ei(!1),Pi=xi;function Oi(e,t){var n=e.type.contextTypes;if(!n)return xi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Mi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ni(){Ci(Ri),Ci(Ii)}function Ai(e,t,n){if(Ii.current!==xi)throw Error(o(168));_i(Ii,t),_i(Ri,n)}function Di(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,W(e)||"Unknown",i));return U({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xi,Pi=Ii.current,_i(Ii,e),_i(Ri,Ri.current),!0}function Ui(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Di(e,t,Pi),r.__reactInternalMemoizedMergedChildContext=e,Ci(Ri),Ci(Ii),_i(Ii,e)):Ci(Ri),_i(Ri,n)}var Fi=null,Bi=!1,ji=!1;function zi(e){null===Fi?Fi=[e]:Fi.push(e)}function Vi(){if(!ji&&null!==Fi){ji=!0;var e=0,t=bt;try{var n=Fi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,Bi=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Je(Ze,Vi),i}finally{bt=t,ji=!1}}return null}var Wi=[],qi=0,$i=null,Hi=0,Ji=[],Gi=0,Yi=null,Ki=1,Xi="";function Qi(e,t){Wi[qi++]=Hi,Wi[qi++]=$i,$i=e,Hi=t}function Zi(e,t,n){Ji[Gi++]=Ki,Ji[Gi++]=Xi,Ji[Gi++]=Yi,Yi=e;var r=Ki;e=Xi;var i=32-st(r)-1;r&=~(1<<i),n+=1;var o=32-st(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Ki=1<<32-st(t)+i|n<<i|r,Xi=o+e}else Ki=1<<o|n<<i|r,Xi=e}function eo(e){null!==e.return&&(Qi(e,1),Zi(e,1,0))}function to(e){for(;e===$i;)$i=Wi[--qi],Wi[qi]=null,Hi=Wi[--qi],Wi[qi]=null;for(;e===Yi;)Yi=Ji[--Gi],Ji[Gi]=null,Xi=Ji[--Gi],Ji[Gi]=null,Ki=Ji[--Gi],Ji[Gi]=null}var no=null,ro=null,io=!1,oo=null;function so(e,t){var n=Ml(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ao(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Ki,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ml(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function co(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(io){var t=ro;if(t){var n=t;if(!ao(e,t)){if(co(e))throw Error(o(418));t=li(n.nextSibling);var r=no;t&&ao(e,t)?so(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(co(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(co(e))throw po(),Error(o(418));for(;t;)so(e,t),t=li(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?li(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=li(e.nextSibling)}function fo(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=w.ReactCurrentBatchConfig;function vo(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yo=Ei(null),bo=null,wo=null,ko=null;function So(){ko=wo=bo=null}function To(e){var t=yo.current;Ci(yo),e._currentValue=t}function Eo(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Co(e,t){bo=e,ko=wo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wa=!0),e.firstContext=null)}function _o(e){var t=e._currentValue;if(ko!==e)if(e={context:e,memoizedValue:t,next:null},null===wo){if(null===bo)throw Error(o(308));wo=e,bo.dependencies={lanes:0,firstContext:e}}else wo=wo.next=e;return t}var xo=null;function Io(e){null===xo?xo=[e]:xo.push(e)}function Ro(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Io(t)):(n.next=i.next,i.next=n),t.interleaved=n,Po(e,r)}function Po(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oo=!1;function Mo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function No(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ao(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Do(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Rc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Po(e,n)}return null===(i=r.interleaved)?(t.next=t,Io(r)):(t.next=i.next,i.next=t),r.interleaved=t,Po(e,n)}function Lo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Uo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fo(e,t,n,r){var i=e.updateQueue;Oo=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var c=a,l=c.next;c.next=null,null===s?o=l:s.next=l,s=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==o){var d=i.baseState;for(s=0,u=l=c=null,a=o;;){var h=a.lane,p=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=U({},d,h);break e;case 2:Oo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=p,c=d):u=u.next=p,s|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Uc|=s,e.lanes=s,e.memoizedState=d}}function Bo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var jo=(new r.Component).refs;function zo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Vo={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),o=Ao(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Do(e,o,i))&&(rl(t,e,i,r),Lo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),o=Ao(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Do(e,o,i))&&(rl(t,e,i,r),Lo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),i=Ao(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Do(e,i,r))&&(rl(t,e,r,n),Lo(t,e,r))}};function Wo(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,o))}function qo(e,t,n){var r=!1,i=xi,o=t.contextType;return"object"===typeof o&&null!==o?o=_o(o):(i=Mi(t)?Pi:Ii.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oi(e,i):xi),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Vo,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function $o(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Vo.enqueueReplaceState(t,t.state,null)}function Ho(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=jo,Mo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=_o(o):(o=Mi(t)?Pi:Ii.current,i.context=Oi(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(zo(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Vo.enqueueReplaceState(i,i.state,null),Fo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Jo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===jo&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Go(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yo(e){return(0,e._init)(e._payload)}function Ko(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Al(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Fl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===T?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===M&&Yo(o)===t.type)?((r=i(t,n.props)).ref=Jo(e,t,n),r.return=e,r):((r=Dl(n.type,n.key,n.props,null,e.mode,r)).ref=Jo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Ll(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Dl(t.type,t.key,t.props,null,e.mode,n)).ref=Jo(e,null,t),n.return=e,n;case S:return(t=Bl(t,e.mode,n)).return=e,t;case M:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Ll(t,e.mode,n,null)).return=e,t;Go(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===i?l(e,t,n,r):null;case S:return n.key===i?u(e,t,n,r):null;case M:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||D(n))return null!==i?null:d(e,t,n,r,null);Go(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case M:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||D(r))return d(t,e=e.get(n)||null,r,i,null);Go(t,r)}return null}function m(i,o,a,c){for(var l=null,u=null,d=o,m=o=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(i,d,a[m],c);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(i,d),o=s(v,o,m),null===u?l=v:u.sibling=v,u=v,d=g}if(m===a.length)return n(i,d),io&&Qi(i,m),l;if(null===d){for(;m<a.length;m++)null!==(d=h(i,a[m],c))&&(o=s(d,o,m),null===u?l=d:u.sibling=d,u=d);return io&&Qi(i,m),l}for(d=r(i,d);m<a.length;m++)null!==(g=f(d,i,m,a[m],c))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?l=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(i,e)})),io&&Qi(i,m),l}function g(i,a,c,l){var u=D(c);if("function"!==typeof u)throw Error(o(150));if(null==(c=u.call(c)))throw Error(o(151));for(var d=u=null,m=a,g=a=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(i,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),a=s(b,a,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(i,m),io&&Qi(i,g),u;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=h(i,y.value,l))&&(a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return io&&Qi(i,g),u}for(m=r(i,m);!y.done;g++,y=c.next())null!==(y=f(m,i,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(i,e)})),io&&Qi(i,g),u}return function e(r,o,s,c){if("object"===typeof s&&null!==s&&s.type===T&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case k:e:{for(var l=s.key,u=o;null!==u;){if(u.key===l){if((l=s.type)===T){if(7===u.tag){n(r,u.sibling),(o=i(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===M&&Yo(l)===u.type){n(r,u.sibling),(o=i(u,s.props)).ref=Jo(r,u,s),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===T?((o=Ll(s.props.children,r.mode,c,s.key)).return=r,r=o):((c=Dl(s.type,s.key,s.props,null,r.mode,c)).ref=Jo(r,o,s),c.return=r,r=c)}return a(r);case S:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=i(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Bl(s,r.mode,c)).return=r,r=o}return a(r);case M:return e(r,o,(u=s._init)(s._payload),c)}if(te(s))return m(r,o,s,c);if(D(s))return g(r,o,s,c);Go(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,s)).return=r,r=o):(n(r,o),(o=Fl(s,r.mode,c)).return=r,r=o),a(r)):n(r,o)}}var Xo=Ko(!0),Qo=Ko(!1),Zo={},es=Ei(Zo),ts=Ei(Zo),ns=Ei(Zo);function rs(e){if(e===Zo)throw Error(o(174));return e}function is(e,t){switch(_i(ns,t),_i(ts,e),_i(es,Zo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ci(es),_i(es,t)}function os(){Ci(es),Ci(ts),Ci(ns)}function ss(e){rs(ns.current);var t=rs(es.current),n=ce(t,e.type);t!==n&&(_i(ts,e),_i(es,n))}function as(e){ts.current===e&&(Ci(es),Ci(ts))}var cs=Ei(0);function ls(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var us=[];function ds(){for(var e=0;e<us.length;e++)us[e]._workInProgressVersionPrimary=null;us.length=0}var hs=w.ReactCurrentDispatcher,ps=w.ReactCurrentBatchConfig,fs=0,ms=null,gs=null,vs=null,ys=!1,bs=!1,ws=0,ks=0;function Ss(){throw Error(o(321))}function Ts(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function Es(e,t,n,r,i,s){if(fs=s,ms=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?aa:ca,e=n(r,i),bs){s=0;do{if(bs=!1,ws=0,25<=s)throw Error(o(301));s+=1,vs=gs=null,t.updateQueue=null,hs.current=la,e=n(r,i)}while(bs)}if(hs.current=sa,t=null!==gs&&null!==gs.next,fs=0,vs=gs=ms=null,ys=!1,t)throw Error(o(300));return e}function Cs(){var e=0!==ws;return ws=0,e}function _s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vs?ms.memoizedState=vs=e:vs=vs.next=e,vs}function xs(){if(null===gs){var e=ms.alternate;e=null!==e?e.memoizedState:null}else e=gs.next;var t=null===vs?ms.memoizedState:vs.next;if(null!==t)vs=t,gs=e;else{if(null===e)throw Error(o(310));e={memoizedState:(gs=e).memoizedState,baseState:gs.baseState,baseQueue:gs.baseQueue,queue:gs.queue,next:null},null===vs?ms.memoizedState=vs=e:vs=vs.next=e}return vs}function Is(e,t){return"function"===typeof t?t(e):t}function Rs(e){var t=xs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=gs,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var c=a=null,l=null,u=s;do{var d=u.lane;if((fs&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,a=r):l=l.next=h,ms.lanes|=d,Uc|=d}u=u.next}while(null!==u&&u!==s);null===l?a=r:l.next=c,ar(r,t.memoizedState)||(wa=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,ms.lanes|=s,Uc|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ps(e){var t=xs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);ar(s,t.memoizedState)||(wa=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Os(){}function Ms(e,t){var n=ms,r=xs(),i=t(),s=!ar(r.memoizedState,i);if(s&&(r.memoizedState=i,wa=!0),r=r.queue,qs(Ds.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==vs&&1&vs.memoizedState.tag){if(n.flags|=2048,Bs(9,As.bind(null,n,r,i,t),void 0,null),null===Pc)throw Error(o(349));0!==(30&fs)||Ns(n,t,i)}return i}function Ns(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function As(e,t,n,r){t.value=n,t.getSnapshot=r,Ls(t)&&Us(e)}function Ds(e,t,n){return n((function(){Ls(t)&&Us(e)}))}function Ls(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Us(e){var t=Po(e,1);null!==t&&rl(t,e,1,-1)}function Fs(e){var t=_s();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,ms,e),[t.memoizedState,e]}function Bs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function js(){return xs().memoizedState}function zs(e,t,n,r){var i=_s();ms.flags|=e,i.memoizedState=Bs(1|t,n,void 0,void 0===r?null:r)}function Vs(e,t,n,r){var i=xs();r=void 0===r?null:r;var o=void 0;if(null!==gs){var s=gs.memoizedState;if(o=s.destroy,null!==r&&Ts(r,s.deps))return void(i.memoizedState=Bs(t,n,o,r))}ms.flags|=e,i.memoizedState=Bs(1|t,n,o,r)}function Ws(e,t){return zs(8390656,8,e,t)}function qs(e,t){return Vs(2048,8,e,t)}function $s(e,t){return Vs(4,2,e,t)}function Hs(e,t){return Vs(4,4,e,t)}function Js(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Gs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vs(4,4,Js.bind(null,t,e),n)}function Ys(){}function Ks(e,t){var n=xs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ts(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xs(e,t){var n=xs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ts(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Qs(e,t,n){return 0===(21&fs)?(e.baseState&&(e.baseState=!1,wa=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),ms.lanes|=n,Uc|=n,e.baseState=!0),t)}function Zs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ps.transition;ps.transition={};try{e(!1),t()}finally{bt=n,ps.transition=r}}function ea(){return xs().memoizedState}function ta(e,t,n){var r=nl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ra(e))ia(t,n);else if(null!==(n=Ro(e,t,n,r))){rl(n,e,r,tl()),oa(n,t,r)}}function na(e,t,n){var r=nl(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ra(e))ia(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,s)){var c=t.interleaved;return null===c?(i.next=i,Io(t)):(i.next=c.next,c.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=Ro(e,t,i,r))&&(rl(n,e,r,i=tl()),oa(n,t,r))}}function ra(e){var t=e.alternate;return e===ms||null!==t&&t===ms}function ia(e,t){bs=ys=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function oa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var sa={readContext:_o,useCallback:Ss,useContext:Ss,useEffect:Ss,useImperativeHandle:Ss,useInsertionEffect:Ss,useLayoutEffect:Ss,useMemo:Ss,useReducer:Ss,useRef:Ss,useState:Ss,useDebugValue:Ss,useDeferredValue:Ss,useTransition:Ss,useMutableSource:Ss,useSyncExternalStore:Ss,useId:Ss,unstable_isNewReconciler:!1},aa={readContext:_o,useCallback:function(e,t){return _s().memoizedState=[e,void 0===t?null:t],e},useContext:_o,useEffect:Ws,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zs(4194308,4,Js.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){return zs(4,2,e,t)},useMemo:function(e,t){var n=_s();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_s();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ta.bind(null,ms,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_s().memoizedState=e},useState:Fs,useDebugValue:Ys,useDeferredValue:function(e){return _s().memoizedState=e},useTransition:function(){var e=Fs(!1),t=e[0];return e=Zs.bind(null,e[1]),_s().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ms,i=_s();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Pc)throw Error(o(349));0!==(30&fs)||Ns(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Ws(Ds.bind(null,r,s,e),[e]),r.flags|=2048,Bs(9,As.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=_s(),t=Pc.identifierPrefix;if(io){var n=Xi;t=":"+t+"R"+(n=(Ki&~(1<<32-st(Ki)-1)).toString(32)+n),0<(n=ws++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ks++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ca={readContext:_o,useCallback:Ks,useContext:_o,useEffect:qs,useImperativeHandle:Gs,useInsertionEffect:$s,useLayoutEffect:Hs,useMemo:Xs,useReducer:Rs,useRef:js,useState:function(){return Rs(Is)},useDebugValue:Ys,useDeferredValue:function(e){return Qs(xs(),gs.memoizedState,e)},useTransition:function(){return[Rs(Is)[0],xs().memoizedState]},useMutableSource:Os,useSyncExternalStore:Ms,useId:ea,unstable_isNewReconciler:!1},la={readContext:_o,useCallback:Ks,useContext:_o,useEffect:qs,useImperativeHandle:Gs,useInsertionEffect:$s,useLayoutEffect:Hs,useMemo:Xs,useReducer:Ps,useRef:js,useState:function(){return Ps(Is)},useDebugValue:Ys,useDeferredValue:function(e){var t=xs();return null===gs?t.memoizedState=e:Qs(t,gs.memoizedState,e)},useTransition:function(){return[Ps(Is)[0],xs().memoizedState]},useMutableSource:Os,useSyncExternalStore:Ms,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var pa="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Ao(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){$c||($c=!0,Hc=r),ha(0,t)},n}function ma(e,t,n){(n=Ao(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ha(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof r&&(null===Jc?Jc=new Set([this]):Jc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new pa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=_l.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ao(-1,1)).tag=2,Do(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ba=w.ReactCurrentOwner,wa=!1;function ka(e,t,n,r){t.child=null===e?Qo(t,null,n,r):Xo(t,e.child,n,r)}function Sa(e,t,n,r,i){n=n.render;var o=t.ref;return Co(t,i),r=Es(e,t,n,r,o,i),n=Cs(),null===e||wa?(io&&n&&eo(t),t.flags|=1,ka(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$a(e,t,i))}function Ta(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Nl(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ea(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(s,r)&&e.ref===t.ref)return $a(e,t,i)}return t.flags|=1,(e=Al(o,r)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(cr(o,r)&&e.ref===t.ref){if(wa=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,$a(e,t,i);0!==(131072&e.flags)&&(wa=!0)}}return xa(e,t,n,r,i)}function Ca(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_i(Ac,Nc),Nc|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_i(Ac,Nc),Nc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,_i(Ac,Nc),Nc|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,_i(Ac,Nc),Nc|=r;return ka(e,t,i,n),t.child}function _a(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xa(e,t,n,r,i){var o=Mi(n)?Pi:Ii.current;return o=Oi(t,o),Co(t,i),n=Es(e,t,n,r,o,i),r=Cs(),null===e||wa?(io&&r&&eo(t),t.flags|=1,ka(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$a(e,t,i))}function Ia(e,t,n,r,i){if(Mi(n)){var o=!0;Li(t)}else o=!1;if(Co(t,i),null===t.stateNode)qa(e,t),qo(t,n,r),Ho(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;"object"===typeof l&&null!==l?l=_o(l):l=Oi(t,l=Mi(n)?Pi:Ii.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||c!==l)&&$o(t,s,r,l),Oo=!1;var h=t.memoizedState;s.state=h,Fo(t,r,s,i),c=t.memoizedState,a!==r||h!==c||Ri.current||Oo?("function"===typeof u&&(zo(t,n,u,r),c=t.memoizedState),(a=Oo||Wo(t,n,a,r,h,c,l))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,No(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:vo(t.type,a),s.props=l,d=t.pendingProps,h=s.context,"object"===typeof(c=n.contextType)&&null!==c?c=_o(c):c=Oi(t,c=Mi(n)?Pi:Ii.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==d||h!==c)&&$o(t,s,r,c),Oo=!1,h=t.memoizedState,s.state=h,Fo(t,r,s,i);var f=t.memoizedState;a!==d||h!==f||Ri.current||Oo?("function"===typeof p&&(zo(t,n,p,r),f=t.memoizedState),(l=Oo||Wo(t,n,l,r,h,f,c)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=c,r=l):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ra(e,t,n,r,o,i)}function Ra(e,t,n,r,i,o){_a(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&Ui(t,n,!1),$a(e,t,o);r=t.stateNode,ba.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Xo(t,e.child,null,o),t.child=Xo(t,null,a,o)):ka(e,t,a,o),t.memoizedState=r.state,i&&Ui(t,n,!0),t.child}function Pa(e){var t=e.stateNode;t.pendingContext?Ai(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ai(0,t.context,!1),is(e,t.containerInfo)}function Oa(e,t,n,r,i){return fo(),mo(i),t.flags|=256,ka(e,t,n,r),t.child}var Ma,Na,Aa,Da,La={dehydrated:null,treeContext:null,retryLane:0};function Ua(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,n){var r,i=t.pendingProps,s=cs.current,a=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),_i(cs,1&s),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=i.children,e=i.fallback,a?(i=t.mode,a=t.child,c={mode:"hidden",children:c},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Ul(c,i,0,null),e=Ll(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ua(n),t.memoizedState=La,e):Ba(t,c));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,a){if(n)return 256&t.flags?(t.flags&=-257,ja(e,t,a,r=da(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Ul({mode:"visible",children:r.children},i,0,null),(s=Ll(s,i,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&Xo(t,e.child,null,a),t.child.memoizedState=Ua(a),t.memoizedState=La,s);if(0===(1&t.mode))return ja(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var c=r.dgst;return r=c,ja(e,t,a,r=da(s=Error(o(419)),r,void 0))}if(c=0!==(a&e.childLanes),wa||c){if(null!==(r=Pc)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Po(e,i),rl(r,e,i,-1))}return gl(),ja(e,t,a,r=da(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ro=li(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Ji[Gi++]=Ki,Ji[Gi++]=Xi,Ji[Gi++]=Yi,Ki=e.id,Xi=e.overflow,Yi=t),t=Ba(t,r.children),t.flags|=4096,t)}(e,t,c,i,r,s,n);if(a){a=i.fallback,c=t.mode,r=(s=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&c)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Al(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==r?a=Al(r,a):(a=Ll(a,c,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,c=null===(c=e.child.memoizedState)?Ua(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=La,i}return e=(a=e.child).sibling,i=Al(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ba(e,t){return(t=Ul({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ja(e,t,n,r){return null!==r&&mo(r),Xo(t,e.child,null,n),(e=Ba(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function za(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Eo(e.return,t,n)}function Va(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Wa(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(ka(e,t,r.children,n),0!==(2&(r=cs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&za(e,n,t);else if(19===e.tag)za(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_i(cs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ls(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Va(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ls(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Va(t,!0,n,null,o);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $a(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Uc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Al(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Al(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ha(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ja(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ga(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ja(t),null;case 1:case 17:return Mi(t.type)&&Ni(),Ja(t),null;case 3:return r=t.stateNode,os(),Ci(Ri),Ci(Ii),ds(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(al(oo),oo=null))),Na(e,t),Ja(t),null;case 5:as(t);var i=rs(ns.current);if(n=t.type,null!==e&&null!=t.stateNode)Aa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Ja(t),null}if(e=rs(es.current),ho(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[hi]=t,r[pi]=s,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<Dr.length;i++)Br(Dr[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":K(r,s),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Br("invalid",r);break;case"textarea":ie(r,s),Br("invalid",r)}for(var c in ye(n,s),i=null,s)if(s.hasOwnProperty(c)){var l=s[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==s.suppressHydrationWarning&&Qr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==s.suppressHydrationWarning&&Qr(r.textContent,l,e),i=["children",""+l]):a.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Br("scroll",r)}switch(n){case"input":H(r),Z(r,s,!0);break;case"textarea":H(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[hi]=t,e[pi]=r,Ma(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),i=r;break;case"iframe":case"object":case"embed":Br("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dr.length;i++)Br(Dr[i],e);i=r;break;case"source":Br("error",e),i=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),i=r;break;case"details":Br("toggle",e),i=r;break;case"input":K(e,r),i=Y(e,r),Br("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=U({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Br("invalid",e)}for(s in ye(n,i),l=i)if(l.hasOwnProperty(s)){var u=l[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Br("scroll",e):null!=u&&b(e,s,u,c))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ja(t),null;case 6:if(e&&null!=t.stateNode)Da(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=rs(ns.current),rs(es.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(s=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ja(t),null;case 13:if(Ci(cs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,s=!1;else if(s=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[hi]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ja(t),s=!1}else null!==oo&&(al(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&cs.current)?0===Dc&&(Dc=3):gl())),null!==t.updateQueue&&(t.flags|=4),Ja(t),null);case 4:return os(),Na(e,t),null===e&&Vr(t.stateNode.containerInfo),Ja(t),null;case 10:return To(t.type._context),Ja(t),null;case 19:if(Ci(cs),null===(s=t.memoizedState))return Ja(t),null;if(r=0!==(128&t.flags),null===(c=s.rendering))if(r)Ha(s,!1);else{if(0!==Dc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=ls(e))){for(t.flags|=128,Ha(s,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _i(cs,1&cs.current|2),t.child}e=e.sibling}null!==s.tail&&Xe()>Wc&&(t.flags|=128,r=!0,Ha(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ls(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ha(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!io)return Ja(t),null}else 2*Xe()-s.renderingStartTime>Wc&&1073741824!==n&&(t.flags|=128,r=!0,Ha(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=s.last)?n.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Xe(),t.sibling=null,n=cs.current,_i(cs,r?1&n|2:1&n),t):(Ja(t),null);case 22:case 23:return hl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Nc)&&(Ja(t),6&t.subtreeFlags&&(t.flags|=8192)):Ja(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ya(e,t){switch(to(t),t.tag){case 1:return Mi(t.type)&&Ni(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return os(),Ci(Ri),Ci(Ii),ds(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return as(t),null;case 13:if(Ci(cs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ci(cs),null;case 4:return os(),null;case 10:return To(t.type._context),null;case 22:case 23:return hl(),null;default:return null}}Ma=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Na=function(){},Aa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,rs(es.current);var o,s=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),s=[];break;case"select":i=U({},i,{value:void 0}),r=U({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var c=i[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Br("scroll",e),s||c===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Da=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ka=!1,Xa=!1,Qa="function"===typeof WeakSet?WeakSet:Set,Za=null;function ec(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cl(e,t,r)}else n.current=null}function tc(e,t,n){try{n()}catch(r){Cl(e,t,r)}}var nc=!1;function rc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&tc(t,n,o)}i=i.next}while(i!==r)}}function ic(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function oc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}function uc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uc(e,t,n),e=e.sibling;null!==e;)uc(e,t,n),e=e.sibling}var dc=null,hc=!1;function pc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Xa||ec(n,t);case 6:var r=dc,i=hc;dc=null,pc(e,t,n),hc=i,null!==(dc=r)&&(hc?(e=dc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dc.removeChild(n.stateNode));break;case 18:null!==dc&&(hc?(e=dc,n=n.stateNode,8===e.nodeType?ci(e.parentNode,n):1===e.nodeType&&ci(e,n),Vt(e)):ci(dc,n.stateNode));break;case 4:r=dc,i=hc,dc=n.stateNode.containerInfo,hc=!0,pc(e,t,n),dc=r,hc=i;break;case 0:case 11:case 14:case 15:if(!Xa&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&tc(n,t,s),i=i.next}while(i!==r)}pc(e,t,n);break;case 1:if(!Xa&&(ec(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Cl(n,t,a)}pc(e,t,n);break;case 21:pc(e,t,n);break;case 22:1&n.mode?(Xa=(r=Xa)||null!==n.memoizedState,pc(e,t,n),Xa=r):pc(e,t,n);break;default:pc(e,t,n)}}function mc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qa),t.forEach((function(t){var r=Rl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:dc=c.stateNode,hc=!1;break e;case 3:case 4:dc=c.stateNode.containerInfo,hc=!0;break e}c=c.return}if(null===dc)throw Error(o(160));fc(s,a,i),dc=null,hc=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(u){Cl(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),yc(e),4&r){try{rc(3,e,e.return),ic(3,e)}catch(g){Cl(e,e.return,g)}try{rc(5,e,e.return)}catch(g){Cl(e,e.return,g)}}break;case 1:gc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return);break;case 5:if(gc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Cl(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===s.type&&null!=s.name&&X(i,s),be(c,a);var u=be(c,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(c){case"input":Q(i,s);break;case"textarea":oe(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ne(i,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[pi]=s}catch(g){Cl(e,e.return,g)}}break;case 6:if(gc(t,e),yc(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Cl(e,e.return,g)}}break;case 3:if(gc(t,e),yc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Cl(e,e.return,g)}break;case 4:default:gc(t,e),yc(e);break;case 13:gc(t,e),yc(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Vc=Xe())),4&r&&mc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xa=(u=Xa)||d,gc(t,e),Xa=u):gc(t,e),yc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Za=e,d=e.child;null!==d;){for(h=Za=d;null!==Za;){switch(f=(p=Za).child,p.tag){case 0:case 11:case 14:case 15:rc(4,p,p.return);break;case 1:ec(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cl(r,n,g)}}break;case 5:ec(p,p.return);break;case 22:if(null!==p.memoizedState){Sc(h);continue}}null!==f?(f.return=p,Za=f):Sc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=h.stateNode,a=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",a))}catch(g){Cl(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Cl(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gc(t,e),yc(e),4&r&&mc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ac(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),uc(e,cc(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;lc(e,cc(e),s);break;default:throw Error(o(161))}}catch(a){Cl(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,n){Za=e,wc(e,t,n)}function wc(e,t,n){for(var r=0!==(1&e.mode);null!==Za;){var i=Za,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Ka;if(!s){var a=i.alternate,c=null!==a&&null!==a.memoizedState||Xa;a=Ka;var l=Xa;if(Ka=s,(Xa=c)&&!l)for(Za=i;null!==Za;)c=(s=Za).child,22===s.tag&&null!==s.memoizedState?Tc(i):null!==c?(c.return=s,Za=c):Tc(i);for(;null!==o;)Za=o,wc(o,t,n),o=o.sibling;Za=i,Ka=a,Xa=l}kc(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Za=o):kc(e)}}function kc(e){for(;null!==Za;){var t=Za;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xa||ic(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xa)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:vo(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Bo(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bo(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(o(163))}Xa||512&t.flags&&oc(t)}catch(p){Cl(t,t.return,p)}}if(t===e){Za=null;break}if(null!==(n=t.sibling)){n.return=t.return,Za=n;break}Za=t.return}}function Sc(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Za=n;break}Za=t.return}}function Tc(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ic(4,t)}catch(c){Cl(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(c){Cl(t,i,c)}}var o=t.return;try{oc(t)}catch(c){Cl(t,o,c)}break;case 5:var s=t.return;try{oc(t)}catch(c){Cl(t,s,c)}}}catch(c){Cl(t,t.return,c)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var Ec,Cc=Math.ceil,_c=w.ReactCurrentDispatcher,xc=w.ReactCurrentOwner,Ic=w.ReactCurrentBatchConfig,Rc=0,Pc=null,Oc=null,Mc=0,Nc=0,Ac=Ei(0),Dc=0,Lc=null,Uc=0,Fc=0,Bc=0,jc=null,zc=null,Vc=0,Wc=1/0,qc=null,$c=!1,Hc=null,Jc=null,Gc=!1,Yc=null,Kc=0,Xc=0,Qc=null,Zc=-1,el=0;function tl(){return 0!==(6&Rc)?Xe():-1!==Zc?Zc:Zc=Xe()}function nl(e){return 0===(1&e.mode)?1:0!==(2&Rc)&&0!==Mc?Mc&-Mc:null!==go.transition?(0===el&&(el=mt()),el):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function rl(e,t,n,r){if(50<Xc)throw Xc=0,Qc=null,Error(o(185));vt(e,n,r),0!==(2&Rc)&&e===Pc||(e===Pc&&(0===(2&Rc)&&(Fc|=n),4===Dc&&cl(e,Mc)),il(e,r),1===n&&0===Rc&&0===(1&t.mode)&&(Wc=Xe()+500,Bi&&Vi()))}function il(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,c=i[s];-1===c?0!==(a&n)&&0===(a&r)||(i[s]=pt(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=ht(e,e===Pc?Mc:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Bi=!0,zi(e)}(ll.bind(null,e)):zi(ll.bind(null,e)),si((function(){0===(6&Rc)&&Vi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pl(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if(Zc=-1,el=0,0!==(6&Rc))throw Error(o(327));var n=e.callbackNode;if(Tl()&&e.callbackNode!==n)return null;var r=ht(e,e===Pc?Mc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vl(e,r);else{t=r;var i=Rc;Rc|=2;var s=ml();for(Pc===e&&Mc===t||(qc=null,Wc=Xe()+500,pl(e,t));;)try{bl();break}catch(c){fl(e,c)}So(),_c.current=s,Rc=i,null!==Oc?t=0:(Pc=null,Mc=0,t=Dc)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(r=i,t=sl(e,i))),1===t)throw n=Lc,pl(e,0),cl(e,r),il(e,Xe()),n;if(6===t)cl(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ar(o(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vl(e,r))&&(0!==(s=ft(e))&&(r=s,t=sl(e,s))),1===t))throw n=Lc,pl(e,0),cl(e,r),il(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:Sl(e,zc,qc);break;case 3:if(cl(e,r),(130023424&r)===r&&10<(t=Vc+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Sl.bind(null,e,zc,qc),t);break}Sl(e,zc,qc);break;case 4:if(cl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-st(r);s=1<<a,(a=t[a])>i&&(i=a),r&=~s}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cc(r/1960))-r)){e.timeoutHandle=ri(Sl.bind(null,e,zc,qc),r);break}Sl(e,zc,qc);break;default:throw Error(o(329))}}}return il(e,Xe()),e.callbackNode===n?ol.bind(null,e):null}function sl(e,t){var n=jc;return e.current.memoizedState.isDehydrated&&(pl(e,t).flags|=256),2!==(e=vl(e,t))&&(t=zc,zc=n,null!==t&&al(t)),e}function al(e){null===zc?zc=e:zc.push.apply(zc,e)}function cl(e,t){for(t&=~Bc,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(0!==(6&Rc))throw Error(o(327));Tl();var t=ht(e,0);if(0===(1&t))return il(e,Xe()),null;var n=vl(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=sl(e,r))}if(1===n)throw n=Lc,pl(e,0),cl(e,t),il(e,Xe()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sl(e,zc,qc),il(e,Xe()),null}function ul(e,t){var n=Rc;Rc|=1;try{return e(t)}finally{0===(Rc=n)&&(Wc=Xe()+500,Bi&&Vi())}}function dl(e){null!==Yc&&0===Yc.tag&&0===(6&Rc)&&Tl();var t=Rc;Rc|=1;var n=Ic.transition,r=bt;try{if(Ic.transition=null,bt=1,e)return e()}finally{bt=r,Ic.transition=n,0===(6&(Rc=t))&&Vi()}}function hl(){Nc=Ac.current,Ci(Ac)}function pl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Oc)for(n=Oc.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ni();break;case 3:os(),Ci(Ri),Ci(Ii),ds();break;case 5:as(r);break;case 4:os();break;case 13:case 19:Ci(cs);break;case 10:To(r.type._context);break;case 22:case 23:hl()}n=n.return}if(Pc=e,Oc=e=Al(e.current,null),Mc=Nc=t,Dc=0,Lc=null,Bc=Fc=Uc=0,zc=jc=null,null!==xo){for(t=0;t<xo.length;t++)if(null!==(r=(n=xo[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}xo=null}return e}function fl(e,t){for(;;){var n=Oc;try{if(So(),hs.current=sa,ys){for(var r=ms.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ys=!1}if(fs=0,vs=gs=ms=null,bs=!1,ws=0,xc.current=null,null===n||null===n.return){Dc=1,Lc=t,Oc=null;break}e:{var s=e,a=n.return,c=n,l=t;if(t=Mc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=va(a);if(null!==f){f.flags&=-257,ya(f,a,c,0,t),1&f.mode&&ga(s,u,t),l=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0===(1&t)){ga(s,u,t),gl();break e}l=Error(o(426))}else if(io&&1&c.mode){var v=va(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ya(v,a,c,0,t),mo(ua(l,c));break e}}s=l=ua(l,c),4!==Dc&&(Dc=2),null===jc?jc=[s]:jc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Uo(s,fa(0,l,t));break e;case 1:c=l;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Jc||!Jc.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Uo(s,ma(s,c,t));break e}}s=s.return}while(null!==s)}kl(n)}catch(w){t=w,Oc===n&&null!==n&&(Oc=n=n.return);continue}break}}function ml(){var e=_c.current;return _c.current=sa,null===e?sa:e}function gl(){0!==Dc&&3!==Dc&&2!==Dc||(Dc=4),null===Pc||0===(268435455&Uc)&&0===(268435455&Fc)||cl(Pc,Mc)}function vl(e,t){var n=Rc;Rc|=2;var r=ml();for(Pc===e&&Mc===t||(qc=null,pl(e,t));;)try{yl();break}catch(i){fl(e,i)}if(So(),Rc=n,_c.current=r,null!==Oc)throw Error(o(261));return Pc=null,Mc=0,Dc}function yl(){for(;null!==Oc;)wl(Oc)}function bl(){for(;null!==Oc&&!Ye();)wl(Oc)}function wl(e){var t=Ec(e.alternate,e,Nc);e.memoizedProps=e.pendingProps,null===t?kl(e):Oc=t,xc.current=null}function kl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ga(n,t,Nc)))return void(Oc=n)}else{if(null!==(n=Ya(n,t)))return n.flags&=32767,void(Oc=n);if(null===e)return Dc=6,void(Oc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Oc=t);Oc=t=e}while(null!==t);0===Dc&&(Dc=5)}function Sl(e,t,n){var r=bt,i=Ic.transition;try{Ic.transition=null,bt=1,function(e,t,n,r){do{Tl()}while(null!==Yc);if(0!==(6&Rc))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,s),e===Pc&&(Oc=Pc=null,Mc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gc||(Gc=!0,Pl(tt,(function(){return Tl(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Ic.transition,Ic.transition=null;var a=bt;bt=1;var c=Rc;Rc|=4,xc.current=null,function(e,t){if(ei=qt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(k){n=null;break e}var a=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==i&&3!==h.nodeType||(c=a+i),h!==s||0!==r&&3!==h.nodeType||(l=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===i&&(c=a),p===s&&++d===r&&(l=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Za=t;null!==Za;)if(e=(t=Za).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:vo(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(k){Cl(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}m=nc,nc=!1}(e,n),vc(n,e),fr(ti),qt=!!ei,ti=ei=null,e.current=n,bc(n,e,i),Ke(),Rc=c,bt=a,Ic.transition=s}else e.current=n;if(Gc&&(Gc=!1,Yc=e,Kc=i),s=e.pendingLanes,0===s&&(Jc=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),il(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if($c)throw $c=!1,e=Hc,Hc=null,e;0!==(1&Kc)&&0!==e.tag&&Tl(),s=e.pendingLanes,0!==(1&s)?e===Qc?Xc++:(Xc=0,Qc=e):Xc=0,Vi()}(e,t,n,r)}finally{Ic.transition=i,bt=r}return null}function Tl(){if(null!==Yc){var e=wt(Kc),t=Ic.transition,n=bt;try{if(Ic.transition=null,bt=16>e?16:e,null===Yc)var r=!1;else{if(e=Yc,Yc=null,Kc=0,0!==(6&Rc))throw Error(o(331));var i=Rc;for(Rc|=4,Za=e.current;null!==Za;){var s=Za,a=s.child;if(0!==(16&Za.flags)){var c=s.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Za=u;null!==Za;){var d=Za;switch(d.tag){case 0:case 11:case 15:rc(8,d,s)}var h=d.child;if(null!==h)h.return=d,Za=h;else for(;null!==Za;){var p=(d=Za).sibling,f=d.return;if(sc(d),d===u){Za=null;break}if(null!==p){p.return=f,Za=p;break}Za=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Za=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Za=a;else e:for(;null!==Za;){if(0!==(2048&(s=Za).flags))switch(s.tag){case 0:case 11:case 15:rc(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Za=y;break e}Za=s.return}}var b=e.current;for(Za=b;null!==Za;){var w=(a=Za).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Za=w;else e:for(a=b;null!==Za;){if(0!==(2048&(c=Za).flags))try{switch(c.tag){case 0:case 11:case 15:ic(9,c)}}catch(S){Cl(c,c.return,S)}if(c===a){Za=null;break e}var k=c.sibling;if(null!==k){k.return=c.return,Za=k;break e}Za=c.return}}if(Rc=i,Vi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(S){}r=!0}return r}finally{bt=n,Ic.transition=t}}return!1}function El(e,t,n){e=Do(e,t=fa(0,t=ua(n,t),1),1),t=tl(),null!==e&&(vt(e,1,t),il(e,t))}function Cl(e,t,n){if(3===e.tag)El(e,e,n);else for(;null!==t;){if(3===t.tag){El(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Jc||!Jc.has(r))){t=Do(t,e=ma(t,e=ua(n,e),1),1),e=tl(),null!==t&&(vt(t,1,e),il(t,e));break}}t=t.return}}function _l(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Pc===e&&(Mc&n)===n&&(4===Dc||3===Dc&&(130023424&Mc)===Mc&&500>Xe()-Vc?pl(e,0):Bc|=n),il(e,t)}function xl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tl();null!==(e=Po(e,t))&&(vt(e,t,n),il(e,n))}function Il(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xl(e,n)}function Rl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),xl(e,n)}function Pl(e,t){return Je(e,t)}function Ol(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ml(e,t,n,r){return new Ol(e,t,n,r)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Al(e,t){var n=e.alternate;return null===n?((n=Ml(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dl(e,t,n,r,i,s){var a=2;if(r=e,"function"===typeof e)Nl(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case T:return Ll(n.children,i,s,t);case E:a=8,i|=8;break;case C:return(e=Ml(12,n,t,2|i)).elementType=C,e.lanes=s,e;case R:return(e=Ml(13,n,t,i)).elementType=R,e.lanes=s,e;case P:return(e=Ml(19,n,t,i)).elementType=P,e.lanes=s,e;case N:return Ul(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:a=10;break e;case x:a=9;break e;case I:a=11;break e;case O:a=14;break e;case M:a=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Ml(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function Ll(e,t,n,r){return(e=Ml(7,e,r,t)).lanes=n,e}function Ul(e,t,n,r){return(e=Ml(22,e,r,t)).elementType=N,e.lanes=n,e.stateNode={isHidden:!1},e}function Fl(e,t,n){return(e=Ml(6,e,null,t)).lanes=n,e}function Bl(e,t,n){return(t=Ml(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jl(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zl(e,t,n,r,i,o,s,a,c){return e=new jl(e,t,n,a,c),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Ml(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mo(o),e}function Vl(e){if(!e)return xi;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Mi(n))return Di(e,n,t)}return t}function Wl(e,t,n,r,i,o,s,a,c){return(e=zl(n,r,!0,e,0,o,0,a,c)).context=Vl(null),n=e.current,(o=Ao(r=tl(),i=nl(n))).callback=void 0!==t&&null!==t?t:null,Do(n,o,i),e.current.lanes=i,vt(e,i,r),il(e,r),e}function ql(e,t,n,r){var i=t.current,o=tl(),s=nl(i);return n=Vl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ao(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Do(i,t,s))&&(rl(e,i,s,o),Lo(e,i,s)),s}function $l(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Jl(e,t){Hl(e,t),(e=e.alternate)&&Hl(e,t)}Ec=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ri.current)wa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wa=!1,function(e,t,n){switch(t.tag){case 3:Pa(t),fo();break;case 5:ss(t);break;case 1:Mi(t.type)&&Li(t);break;case 4:is(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;_i(yo,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_i(cs,1&cs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fa(e,t,n):(_i(cs,1&cs.current),null!==(e=$a(e,t,n))?e.sibling:null);_i(cs,1&cs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Wa(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),_i(cs,cs.current),r)break;return null;case 22:case 23:return t.lanes=0,Ca(e,t,n)}return $a(e,t,n)}(e,t,n);wa=0!==(131072&e.flags)}else wa=!1,io&&0!==(1048576&t.flags)&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;qa(e,t),e=t.pendingProps;var i=Oi(t,Ii.current);Co(t,n),i=Es(null,t,r,e,i,n);var s=Cs();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mi(r)?(s=!0,Li(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Mo(t),i.updater=Vo,t.stateNode=i,i._reactInternals=t,Ho(t,r,e,n),t=Ra(null,t,r,!0,s,n)):(t.tag=0,io&&s&&eo(t),ka(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(qa(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Nl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===O)return 14}return 2}(r),e=vo(r,e),i){case 0:t=xa(null,t,r,e,n);break e;case 1:t=Ia(null,t,r,e,n);break e;case 11:t=Sa(null,t,r,e,n);break e;case 14:t=Ta(null,t,r,vo(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,xa(e,t,r,i=t.elementType===r?i:vo(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:vo(r,i),n);case 3:e:{if(Pa(t),null===e)throw Error(o(387));r=t.pendingProps,i=(s=t.memoizedState).element,No(e,t),Fo(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Oa(e,t,r,n,i=ua(Error(o(423)),t));break e}if(r!==i){t=Oa(e,t,r,n,i=ua(Error(o(424)),t));break e}for(ro=li(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Qo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===i){t=$a(e,t,n);break e}ka(e,t,r,n)}t=t.child}return t;case 5:return ss(t),null===e&&lo(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==s&&ni(r,s)&&(t.flags|=32),_a(e,t),ka(e,t,a,n),t.child;case 6:return null===e&&lo(t),null;case 13:return Fa(e,t,n);case 4:return is(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Xo(t,null,r,n):ka(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Sa(e,t,r,i=t.elementType===r?i:vo(r,i),n);case 7:return ka(e,t,t.pendingProps,n),t.child;case 8:case 12:return ka(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,_i(yo,r._currentValue),r._currentValue=a,null!==s)if(ar(s.value,a)){if(s.children===i.children&&!Ri.current){t=$a(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){a=s.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===s.tag){(l=Ao(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Eo(s.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Eo(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}ka(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Co(t,n),r=r(i=_o(i)),t.flags|=1,ka(e,t,r,n),t.child;case 14:return i=vo(r=t.type,t.pendingProps),Ta(e,t,r,i=vo(r.type,i),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vo(r,i),qa(e,t),t.tag=1,Mi(r)?(e=!0,Li(t)):e=!1,Co(t,n),qo(t,r,i),Ho(t,r,i,n),Ra(null,t,r,!0,e,n);case 19:return Wa(e,t,n);case 22:return Ca(e,t,n)}throw Error(o(156,t.tag))};var Gl="function"===typeof reportError?reportError:function(e){console.error(e)};function Yl(e){this._internalRoot=e}function Kl(e){this._internalRoot=e}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zl(){}function eu(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof i){var a=i;i=function(){var e=$l(s);a.call(e)}}ql(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=$l(s);o.call(e)}}var s=Wl(t,r,e,0,null,!1,0,"",Zl);return e._reactRootContainer=s,e[fi]=s.current,Vr(8===e.nodeType?e.parentNode:e),dl(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=$l(c);a.call(e)}}var c=zl(e,0,!1,null,0,!1,0,"",Zl);return e._reactRootContainer=c,e[fi]=c.current,Vr(8===e.nodeType?e.parentNode:e),dl((function(){ql(t,c,n,r)})),c}(n,t,e,i,r);return $l(s)}Kl.prototype.render=Yl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));ql(e,t,null,null)},Kl.prototype.unmount=Yl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl((function(){ql(null,e,null,null)})),t[fi]=null}},Kl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nt.length&&0!==t&&t<Nt[n].priority;n++);Nt.splice(n,0,e),0===n&&Ut(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),il(t,Xe()),0===(6&Rc)&&(Wc=Xe()+500,Vi()))}break;case 13:dl((function(){var t=Po(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}})),Jl(e,1)}},St=function(e){if(13===e.tag){var t=Po(e,134217728);if(null!==t)rl(t,e,134217728,tl());Jl(e,134217728)}},Tt=function(e){if(13===e.tag){var t=nl(e),n=Po(e,t);if(null!==n)rl(n,e,t,tl());Jl(e,t)}},Et=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ki(r);if(!i)throw Error(o(90));J(r),Q(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=ul,Re=dl;var tu={usingClientEntryPoint:!1,Events:[bi,wi,ki,_e,xe,ul]},nu={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=$e(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(ru),ot=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xl(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xl(e))throw Error(o(299));var n=!1,r="",i=Gl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zl(e,1,!1,null,0,n,0,r,i),e[fi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Yl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=$e(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Ql(t))throw Error(o(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xl(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",a=Gl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Wl(t,null,e,1,null!=n?n:null,i,0,s,a),e[fi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Kl(t)},t.render=function(e,t,n){if(!Ql(t))throw Error(o(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Ql(e))throw Error(o(40));return!!e._reactRootContainer&&(dl((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ql(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},821:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function k(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case o:case a:case s:case p:return e;default:switch(e=e&&e.$$typeof){case l:case h:case g:case m:case c:return e;default:return t}}case i:return t}}}function S(e){return k(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=l,t.ContextProvider=c,t.Element=r,t.ForwardRef=h,t.Fragment=o,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||k(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return k(e)===l},t.isContextProvider=function(e){return k(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return k(e)===h},t.isFragment=function(e){return k(e)===o},t.isLazy=function(e){return k(e)===g},t.isMemo=function(e){return k(e)===m},t.isPortal=function(e){return k(e)===i},t.isProfiler=function(e){return k(e)===a},t.isStrictMode=function(e){return k(e)===s},t.isSuspense=function(e){return k(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===d||e===a||e===s||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===c||e.$$typeof===l||e.$$typeof===h||e.$$typeof===y||e.$$typeof===b||e.$$typeof===w||e.$$typeof===v)},t.typeOf=k},441:(e,t,n)=>{"use strict";e.exports=n(821)},374:(e,t,n)=>{"use strict";var r=n(791),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,o={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:u,props:o,_owner:a.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},117:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var k=Array.isArray,S=Object.prototype.hasOwnProperty,T={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,i)&&!E.hasOwnProperty(i)&&(o[i]=t[i]);var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(i in c=e.defaultProps)void 0===o[i]&&(o[i]=c[i]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:T.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===o?"."+I(c,0):o,k(s)?(i="",null!=e&&(i=e.replace(x,"$&/")+"/"),R(s,t,i,"",(function(e){return e}))):null!=s&&(_(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(x,"$&/")+"/")+e)),t.push(s)),1;if(c=0,o=""===o?".":o+":",k(e))for(var l=0;l<e.length;l++){var u=o+I(a=e[l],l);c+=R(a,t,i,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=R(a=a.value,t,i,u=o+I(a,l++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function P(e,t,n){if(null==e)return e;var r=[],i=0;return R(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},N={transition:null},A={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:N,ReactCurrentOwner:T};t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=T.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)S.call(t,l)&&!E.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}return{$$typeof:n,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,n){return M.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,n){return M.current.useReducer(e,t,n)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return M.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return M.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{"use strict";e.exports=n(117)},184:(e,t,n)=>{"use strict";e.exports=n(374)},813:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,c=e[a],l=a+1,u=e[l];if(0>o(c,n))l<i&&0>o(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[a]=n,r=a);else{if(!(l<i&&0>o(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function k(e){if(g=!1,w(e),!m)if(null!==r(l))m=!0,N(S);else{var t=r(u);null!==t&&A(k,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(_),_=-1),f=!0;var o=p;try{for(w(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!R());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(l)&&i(l),w(n)}else i(l);h=r(l)}if(null!==h)var c=!0;else{var d=r(u);null!==d&&A(k,d.startTime-n),c=!1}return c}finally{h=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,E=!1,C=null,_=-1,x=5,I=-1;function R(){return!(t.unstable_now()-I<x)}function P(){if(null!==C){var e=t.unstable_now();I=e;var n=!0;try{n=C(!0,e)}finally{n?T():(E=!1,C=null)}}else E=!1}if("function"===typeof b)T=function(){b(P)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,M=O.port2;O.port1.onmessage=P,T=function(){M.postMessage(null)}}else T=function(){v(P,0)};function N(e){C=e,E||(E=!0,T())}function A(e,n){_=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,N(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(l)&&e===r(u)&&(g?(y(_),_=-1):g=!0,A(k,o-s))):(e.sortIndex=a,n(l,e),m||f||(m=!0,N(S))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},296:(e,t,n)=>{"use strict";e.exports=n(813)},897:e=>{e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},372:e=>{e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},690:e=>{e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},728:(e,t,n)=>{var r=n(62);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},872:e=>{e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports},218:e=>{e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},424:(e,t,n)=>{var r=n(372),i=n(872),o=n(116),s=n(218);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},36:(e,t,n)=>{var r=n(698).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},62:(e,t,n)=>{var r=n(698).default,i=n(36);e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},698:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},116:(e,t,n)=>{var r=n(897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,n.d(o,s),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".dce775d5.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="mongoose-web-client:";n.l=(r,i,o,s)=>{if(e[r])e[r].push(i);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+o),a.src=r),e[r]=[i];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={179:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=o);var s=n.p+n.u(t),a=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,o,[s,a,c]=r,l=0;if(s.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(c)c(n)}for(t&&t(r);l<s.length;l++)o=s[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=globalThis.webpackChunkmongoose_web_client=globalThis.webpackChunkmongoose_web_client||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e,t=n(791),r=n.t(t,2),i=n(250),o=n(164),s=n.t(o,2);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const c="popstate";function l(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function d(e,t){return{usr:e.state,key:e.key,idx:t}}function h(e,t,n,r){return void 0===n&&(n=null),a({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function f(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function m(t,n,r,i){void 0===i&&(i={});let{window:o=document.defaultView,v5Compat:s=!1}=i,u=o.history,f=e.Pop,m=null,g=v();function v(){return(u.state||{idx:null}).idx}function y(){f=e.Pop;let t=v(),n=null==t?null:t-g;g=t,m&&m({action:f,location:w.location,delta:n})}function b(e){let t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:p(e);return l(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,u.replaceState(a({},u.state,{idx:g}),""));let w={get action(){return f},get location(){return t(o,u)},listen(e){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(c,y),m=e,()=>{o.removeEventListener(c,y),m=null}},createHref:e=>n(o,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){f=e.Push;let i=h(w.location,t,n);r&&r(i,t),g=v()+1;let a=d(i,g),c=w.createHref(i);try{u.pushState(a,"",c)}catch(l){if(l instanceof DOMException&&"DataCloneError"===l.name)throw l;o.location.assign(c)}s&&m&&m({action:f,location:w.location,delta:1})},replace:function(t,n){f=e.Replace;let i=h(w.location,t,n);r&&r(i,t),g=v();let o=d(i,g),a=w.createHref(i);u.replaceState(o,"",a),s&&m&&m({action:f,location:w.location,delta:0})},go:e=>u.go(e)};return w}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));const v=new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,n,r){return void 0===n&&(n=[]),void 0===r&&(r={}),e.map(((e,i)=>{let o=[...n,i],s="string"===typeof e.id?e.id:o.join("-");if(l(!0!==e.index||!e.children,"Cannot specify children on an index route"),l(!r[s],'Found a route id collision on id "'+s+"\".  Route id's must be globally unique within Data Router usages"),function(e){return!0===e.index}(e)){let n=a({},e,t(e),{id:s});return r[s]=n,n}{let n=a({},e,t(e),{id:s,children:void 0});return r[s]=n,e.children&&(n.children=y(e.children,t,o,r)),n}}))}function b(e,t,n){void 0===n&&(n="/");let r=N(("string"===typeof t?f(t):t).pathname||"/",n);if(null==r)return null;let i=w(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let o=null;for(let s=0;null==o&&s<i.length;++s)o=P(i[s],M(r));return o}function w(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,o)=>{let s={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};s.relativePath.startsWith("/")&&(l(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let a=U([r,s.relativePath]),c=n.concat(s);e.children&&e.children.length>0&&(l(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),w(e.children,t,c,a)),(null!=e.path||e.index)&&t.push({path:a,score:R(a,e.index),routesMeta:c})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of k(e.path))i(e,t,r);else i(e,t)})),t}function k(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let s=k(r.join("/")),a=[];return a.push(...s.map((e=>""===e?o:[o,e].join("/")))),i&&a.push(...s),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const S=/^:\w+$/,T=3,E=2,C=1,_=10,x=-2,I=e=>"*"===e;function R(e,t){let n=e.split("/"),r=n.length;return n.some(I)&&(r+=x),t&&(r+=E),n.filter((e=>!I(e))).reduce(((e,t)=>e+(S.test(t)?T:""===t?C:_)),r)}function P(e,t){let{routesMeta:n}=e,r={},i="/",o=[];for(let s=0;s<n.length;++s){let e=n[s],a=s===n.length-1,c="/"===i?t:t.slice(i.length)||"/",l=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:a},c);if(!l)return null;Object.assign(r,l.params);let u=e.route;o.push({params:r,pathname:U([i,l.pathname]),pathnameBase:F(U([i,l.pathnameBase])),route:u}),"/"!==l.pathnameBase&&(i=U([i,l.pathnameBase]))}return o}function O(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let o=new RegExp(i,t?void 0:"i");return[o,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1),c=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=a[n]||"";s=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const c=a[n];return e[r]=i&&!c?void 0:function(e,t){try{return decodeURIComponent(e)}catch(n){return u(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(c||"",r),e}),{});return{params:c,pathname:o,pathnameBase:s,pattern:e}}function M(e){try{return decodeURI(e)}catch(t){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function N(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function A(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function L(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=f(e):(i=a({},e),l(!i.pathname||!i.pathname.includes("?"),A("?","pathname","search",i)),l(!i.pathname||!i.pathname.includes("#"),A("#","pathname","hash",i)),l(!i.search||!i.search.includes("#"),A("#","search","hash",i)));let o,s=""===e||""===i.pathname,c=s?"/":i.pathname;if(null==c)o=n;else if(r){let e=t[t.length-1].replace(/^\//,"").split("/");if(c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e.pop();i.pathname=t.join("/")}o="/"+e.join("/")}else{let e=t.length-1;if(c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}o=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?f(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:B(r),hash:j(i)}}(i,o),d=c&&"/"!==c&&c.endsWith("/"),h=(s||"."===c)&&n.endsWith("/");return u.pathname.endsWith("/")||!d&&!h||(u.pathname+="/"),u}const U=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",j=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;class z{constructor(e,t,n,r){void 0===r&&(r=!1),this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function V(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],q=new Set(W),$=["get",...W],H=new Set($),J=new Set([301,302,303,307,308]),G=new Set([307,308]),Y={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},K={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},X={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Q=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Z=e=>({hasErrorBoundary:Boolean(e.hasErrorBoundary)}),ee="remix-router-transitions";function te(t){const n=t.window?t.window:"undefined"!==typeof window?window:void 0,r="undefined"!==typeof n&&"undefined"!==typeof n.document&&"undefined"!==typeof n.document.createElement,i=!r;let o;if(l(t.routes.length>0,"You must provide a non-empty routes array to createRouter"),t.mapRouteProperties)o=t.mapRouteProperties;else if(t.detectErrorBoundary){let e=t.detectErrorBoundary;o=t=>({hasErrorBoundary:e(t)})}else o=Z;let s,c={},d=y(t.routes,o,void 0,c),p=t.basename||"/",f=a({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},t.future),m=null,v=new Set,w=null,k=null,S=null,T=null!=t.hydrationData,E=b(d,t.history.location,p),C=null;if(null==E){let e=ye(404,{pathname:t.history.location.pathname}),{matches:n,route:r}=ve(d);E=n,C={[r.id]:e}}let _,x,I=!E.some((e=>e.route.lazy))&&(!E.some((e=>e.route.loader))||null!=t.hydrationData),R={historyAction:t.history.action,location:t.history.location,matches:E,initialized:I,navigation:Y,restoreScrollPosition:null==t.hydrationData&&null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||C,fetchers:new Map,blockers:new Map},P=e.Pop,O=!1,M=!1,A=new Map,D=null,L=!1,U=!1,F=[],B=[],j=new Map,z=0,V=-1,W=new Map,q=new Set,$=new Map,H=new Map,J=new Set,te=new Map,ie=new Map,se=!1;function ae(e,t){void 0===t&&(t={}),R=a({},R,e);let n=[],r=[];f.v7_fetcherPersist&&R.fetchers.forEach(((e,t)=>{"idle"===e.state&&(J.has(t)?r.push(t):n.push(t))})),[...v].forEach((e=>e(R,{deletedFetchers:r,unstable_viewTransitionOpts:t.viewTransitionOpts,unstable_flushSync:!0===t.flushSync}))),f.v7_fetcherPersist&&(n.forEach((e=>R.fetchers.delete(e))),r.forEach((e=>De(e))))}function ce(n,r,i){var o,c;let l,{flushSync:u}=void 0===i?{}:i,h=null!=R.actionData&&null!=R.navigation.formMethod&&_e(R.navigation.formMethod)&&"loading"===R.navigation.state&&!0!==(null==(o=n.state)?void 0:o._isRedirect);l=r.actionData?Object.keys(r.actionData).length>0?r.actionData:null:h?R.actionData:null;let p=r.loaderData?me(R.loaderData,r.loaderData,r.matches||[],r.errors):R.loaderData,f=R.blockers;f.size>0&&(f=new Map(f),f.forEach(((e,t)=>f.set(t,X))));let m,g=!0===O||null!=R.navigation.formMethod&&_e(R.navigation.formMethod)&&!0!==(null==(c=n.state)?void 0:c._isRedirect);if(s&&(d=s,s=void 0),L||P===e.Pop||(P===e.Push?t.history.push(n,n.state):P===e.Replace&&t.history.replace(n,n.state)),P===e.Pop){let e=A.get(R.location.pathname);e&&e.has(n.pathname)?m={currentLocation:R.location,nextLocation:n}:A.has(n.pathname)&&(m={currentLocation:n,nextLocation:R.location})}else if(M){let e=A.get(R.location.pathname);e?e.add(n.pathname):(e=new Set([n.pathname]),A.set(R.location.pathname,e)),m={currentLocation:R.location,nextLocation:n}}ae(a({},r,{actionData:l,loaderData:p,historyAction:P,location:n,initialized:!0,navigation:Y,revalidation:"idle",restoreScrollPosition:$e(n,r.matches||R.matches),preventScrollReset:g,blockers:f}),{viewTransitionOpts:m,flushSync:!0===u}),P=e.Pop,O=!1,M=!1,L=!1,U=!1,F=[],B=[]}async function de(n,r,i){x&&x.abort(),x=null,P=n,L=!0===(i&&i.startUninterruptedRevalidation),function(e,t){if(w&&S){let n=qe(e,t);w[n]=S()}}(R.location,R.matches),O=!0===(i&&i.preventScrollReset),M=!0===(i&&i.enableViewTransition);let l=s||d,u=i&&i.overrideNavigation,h=b(l,r,p),f=!0===(i&&i.flushSync);if(!h){let e=ye(404,{pathname:r.pathname}),{matches:t,route:n}=ve(l);return We(),void ce(r,{matches:t,loaderData:{},errors:{[n.id]:e}},{flushSync:f})}if(R.initialized&&!U&&function(e,t){if(e.pathname!==t.pathname||e.search!==t.search)return!1;if(""===e.hash)return""!==t.hash;if(e.hash===t.hash)return!0;if(""!==t.hash)return!0;return!1}(R.location,r)&&!(i&&i.submission&&_e(i.submission.formMethod)))return void ce(r,{matches:h},{flushSync:f});x=new AbortController;let m,v,y=ue(t.history,r,x.signal,i&&i.submission);if(i&&i.pendingError)v={[ge(h).route.id]:i.pendingError};else if(i&&i.submission&&_e(i.submission.formMethod)){let t=await async function(t,n,r,i,s){void 0===s&&(s={});we();let a,l=function(e,t){let n={state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text};return n}(n,r);ae({navigation:l},{flushSync:!0===s.flushSync});let u=Pe(i,n);if(u.route.action||u.route.lazy){if(a=await le("action",t,u,i,c,o,p),t.signal.aborted)return{shortCircuited:!0}}else a={type:g.error,error:ye(405,{method:t.method,pathname:n.pathname,routeId:u.route.id})};if(Te(a)){let e;return e=s&&null!=s.replace?s.replace:a.location===R.location.pathname+R.location.search,await he(R,a,{submission:r,replace:e}),{shortCircuited:!0}}if(Se(a)){let t=ge(i,u.route.id);return!0!==(s&&s.replace)&&(P=e.Push),{pendingActionData:{},pendingActionError:{[t.route.id]:a.error}}}if(ke(a))throw ye(400,{type:"defer-action"});return{pendingActionData:{[u.route.id]:a.data}}}(y,r,i.submission,h,{replace:i.replace,flushSync:f});if(t.shortCircuited)return;m=t.pendingActionData,v=t.pendingActionError,u=Me(r,i.submission),f=!1,y=new Request(y.url,{signal:y.signal})}let{shortCircuited:k,loaderData:T,errors:E}=await async function(e,n,r,i,o,c,l,u,h,f){let m=i||Me(n,o),g=o||c||Oe(m),v=s||d,[y,b]=oe(t.history,R,r,g,n,U,F,B,J,$,q,v,p,h,f);if(We((e=>!(r&&r.some((t=>t.route.id===e)))||y&&y.some((t=>t.route.id===e)))),V=++z,0===y.length&&0===b.length){let e=Fe();return ce(n,a({matches:r,loaderData:{},errors:f||null},h?{actionData:h}:{},e?{fetchers:new Map(R.fetchers)}:{}),{flushSync:u}),{shortCircuited:!0}}if(!L){b.forEach((e=>{let t=R.fetchers.get(e.key),n=Ne(void 0,t?t.data:void 0);R.fetchers.set(e.key,n)}));let e=h||R.actionData;ae(a({navigation:m},e?0===Object.keys(e).length?{actionData:null}:{actionData:e}:{},b.length>0?{fetchers:new Map(R.fetchers)}:{}),{flushSync:u})}b.forEach((e=>{j.has(e.key)&&Le(e.key),e.controller&&j.set(e.key,e.controller)}));let w=()=>b.forEach((e=>Le(e.key)));x&&x.signal.addEventListener("abort",w);let{results:k,loaderResults:S,fetcherResults:T}=await pe(R.matches,r,y,b,e);if(e.signal.aborted)return{shortCircuited:!0};x&&x.signal.removeEventListener("abort",w);b.forEach((e=>j.delete(e.key)));let E=be(k);if(E){if(E.idx>=y.length){let e=b[E.idx-y.length].key;q.add(e)}return await he(R,E.result,{replace:l}),{shortCircuited:!0}}let{loaderData:C,errors:_}=fe(R,r,y,S,f,b,T,te);te.forEach(((e,t)=>{e.subscribe((n=>{(n||e.done)&&te.delete(t)}))}));let I=Fe(),P=Be(V),O=I||P||b.length>0;return a({loaderData:C,errors:_},O?{fetchers:new Map(R.fetchers)}:{})}(y,r,h,u,i&&i.submission,i&&i.fetcherSubmission,i&&i.replace,f,m,v);k||(x=null,ce(r,a({matches:h},m?{actionData:m}:{},{loaderData:T,errors:E})))}async function he(i,o,s){let{submission:c,fetcherSubmission:u,replace:d}=void 0===s?{}:s;o.revalidate&&(U=!0);let f=h(i.location,o.location,{_isRedirect:!0});if(l(f,"Expected a location on the redirect navigation"),r){let e=!1;if(o.reloadDocument)e=!0;else if(Q.test(o.location)){const r=t.history.createURL(o.location);e=r.origin!==n.location.origin||null==N(r.pathname,p)}if(e)return void(d?n.location.replace(o.location):n.location.assign(o.location))}x=null;let m=!0===d?e.Replace:e.Push,{formMethod:g,formAction:v,formEncType:y}=i.navigation;!c&&!u&&g&&v&&y&&(c=Oe(i.navigation));let b=c||u;if(G.has(o.status)&&b&&_e(b.formMethod))await de(m,f,{submission:a({},b,{formAction:o.location}),preventScrollReset:O});else{let e=Me(f,c);await de(m,f,{overrideNavigation:e,fetcherSubmission:u,preventScrollReset:O})}}async function pe(e,n,r,i,s){let a=await Promise.all([...r.map((e=>le("loader",s,e,n,c,o,p))),...i.map((e=>{if(e.matches&&e.match&&e.controller)return le("loader",ue(t.history,e.path,e.controller.signal),e.match,e.matches,c,o,p);return{type:g.error,error:ye(404,{pathname:e.path})}}))]),l=a.slice(0,r.length),u=a.slice(r.length);return await Promise.all([xe(e,r,l,l.map((()=>s.signal)),!1,R.loaderData),xe(e,i.map((e=>e.match)),u,i.map((e=>e.controller?e.controller.signal:null)),!0)]),{results:a,loaderResults:l,fetcherResults:u}}function we(){U=!0,F.push(...We()),$.forEach(((e,t)=>{j.has(t)&&(B.push(t),Le(t))}))}function Ee(e,t,n){void 0===n&&(n={}),R.fetchers.set(e,t),ae({fetchers:new Map(R.fetchers)},{flushSync:!0===(n&&n.flushSync)})}function Ce(e,t,n,r){void 0===r&&(r={});let i=ge(R.matches,t);De(e),ae({errors:{[i.route.id]:n},fetchers:new Map(R.fetchers)},{flushSync:!0===(r&&r.flushSync)})}function Re(e){return f.v7_fetcherPersist&&(H.set(e,(H.get(e)||0)+1),J.has(e)&&J.delete(e)),R.fetchers.get(e)||K}function De(e){let t=R.fetchers.get(e);!j.has(e)||t&&"loading"===t.state&&W.has(e)||Le(e),$.delete(e),W.delete(e),q.delete(e),J.delete(e),R.fetchers.delete(e)}function Le(e){let t=j.get(e);l(t,"Expected fetch controller: "+e),t.abort(),j.delete(e)}function Ue(e){for(let t of e){let e=Ae(Re(t).data);R.fetchers.set(t,e)}}function Fe(){let e=[],t=!1;for(let n of q){let r=R.fetchers.get(n);l(r,"Expected fetcher: "+n),"loading"===r.state&&(q.delete(n),e.push(n),t=!0)}return Ue(e),t}function Be(e){let t=[];for(let[n,r]of W)if(r<e){let e=R.fetchers.get(n);l(e,"Expected fetcher: "+n),"loading"===e.state&&(Le(n),W.delete(n),t.push(n))}return Ue(t),t.length>0}function je(e){R.blockers.delete(e),ie.delete(e)}function ze(e,t){let n=R.blockers.get(e)||X;l("unblocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"proceeding"===t.state||"blocked"===n.state&&"unblocked"===t.state||"proceeding"===n.state&&"unblocked"===t.state,"Invalid blocker state transition: "+n.state+" -> "+t.state);let r=new Map(R.blockers);r.set(e,t),ae({blockers:r})}function Ve(e){let{currentLocation:t,nextLocation:n,historyAction:r}=e;if(0===ie.size)return;ie.size>1&&u(!1,"A router only supports one blocker at a time");let i=Array.from(ie.entries()),[o,s]=i[i.length-1],a=R.blockers.get(o);return a&&"proceeding"===a.state?void 0:s({currentLocation:t,nextLocation:n,historyAction:r})?o:void 0}function We(e){let t=[];return te.forEach(((n,r)=>{e&&!e(r)||(n.cancel(),t.push(r),te.delete(r))})),t}function qe(e,t){if(k){return k(e,t.map((e=>function(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}(e,R.loaderData))))||e.key}return e.key}function $e(e,t){if(w){let n=qe(e,t),r=w[n];if("number"===typeof r)return r}return null}return _={get basename(){return p},get state(){return R},get routes(){return d},get window(){return n},initialize:function(){if(m=t.history.listen((e=>{let{action:n,location:r,delta:i}=e;if(se)return void(se=!1);u(0===ie.size||null!=i,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let o=Ve({currentLocation:R.location,nextLocation:r,historyAction:n});return o&&null!=i?(se=!0,t.history.go(-1*i),void ze(o,{state:"blocked",location:r,proceed(){ze(o,{state:"proceeding",proceed:void 0,reset:void 0,location:r}),t.history.go(i)},reset(){let e=new Map(R.blockers);e.set(o,X),ae({blockers:e})}})):de(n,r)})),r){!function(e,t){try{let n=e.sessionStorage.getItem(ee);if(n){let e=JSON.parse(n);for(let[n,r]of Object.entries(e||{}))r&&Array.isArray(r)&&t.set(n,new Set(r||[]))}}catch(n){}}(n,A);let e=()=>function(e,t){if(t.size>0){let r={};for(let[e,n]of t)r[e]=[...n];try{e.sessionStorage.setItem(ee,JSON.stringify(r))}catch(n){u(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}(n,A);n.addEventListener("pagehide",e),D=()=>n.removeEventListener("pagehide",e)}return R.initialized||de(e.Pop,R.location),_},subscribe:function(e){return v.add(e),()=>v.delete(e)},enableScrollRestoration:function(e,t,n){if(w=e,S=t,k=n||null,!T&&R.navigation===Y){T=!0;let e=$e(R.location,R.matches);null!=e&&ae({restoreScrollPosition:e})}return()=>{w=null,S=null,k=null}},navigate:async function n(r,i){if("number"===typeof r)return void t.history.go(r);let o=ne(R.location,R.matches,p,f.v7_prependBasename,r,null==i?void 0:i.fromRouteId,null==i?void 0:i.relative),{path:s,submission:c,error:l}=re(f.v7_normalizeFormMethod,!1,o,i),u=R.location,d=h(R.location,s,i&&i.state);d=a({},d,t.history.encodeLocation(d));let m=i&&null!=i.replace?i.replace:void 0,g=e.Push;!0===m?g=e.Replace:!1===m||null!=c&&_e(c.formMethod)&&c.formAction===R.location.pathname+R.location.search&&(g=e.Replace);let v=i&&"preventScrollReset"in i?!0===i.preventScrollReset:void 0,y=!0===(i&&i.unstable_flushSync),b=Ve({currentLocation:u,nextLocation:d,historyAction:g});if(!b)return await de(g,d,{submission:c,pendingError:l,preventScrollReset:v,replace:i&&i.replace,enableViewTransition:i&&i.unstable_viewTransition,flushSync:y});ze(b,{state:"blocked",location:d,proceed(){ze(b,{state:"proceeding",proceed:void 0,reset:void 0,location:d}),n(r,i)},reset(){let e=new Map(R.blockers);e.set(b,X),ae({blockers:e})}})},fetch:function(e,n,r,a){if(i)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");j.has(e)&&Le(e);let u=!0===(a&&a.unstable_flushSync),h=s||d,m=ne(R.location,R.matches,p,f.v7_prependBasename,r,n,null==a?void 0:a.relative),g=b(h,m,p);if(!g)return void Ce(e,n,ye(404,{pathname:m}),{flushSync:u});let{path:v,submission:y,error:w}=re(f.v7_normalizeFormMethod,!0,m,a);if(w)return void Ce(e,n,w,{flushSync:u});let k=Pe(g,v);O=!0===(a&&a.preventScrollReset),y&&_e(y.formMethod)?async function(e,n,r,i,a,u,h){if(we(),$.delete(e),!i.route.action&&!i.route.lazy){let t=ye(405,{method:h.formMethod,pathname:r,routeId:n});return void Ce(e,n,t,{flushSync:u})}let f=R.fetchers.get(e);Ee(e,function(e,t){let n={state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0};return n}(h,f),{flushSync:u});let m=new AbortController,g=ue(t.history,r,m.signal,h);j.set(e,m);let v=z,y=await le("action",g,i,a,c,o,p);if(g.signal.aborted)return void(j.get(e)===m&&j.delete(e));if(J.has(e))return void Ee(e,Ae(void 0));if(Te(y))return j.delete(e),V>v?void Ee(e,Ae(void 0)):(q.add(e),Ee(e,Ne(h)),he(R,y,{fetcherSubmission:h}));if(Se(y))return void Ce(e,n,y.error);if(ke(y))throw ye(400,{type:"defer-action"});let w=R.navigation.location||R.location,k=ue(t.history,w,m.signal),S=s||d,T="idle"!==R.navigation.state?b(S,R.navigation.location,p):R.matches;l(T,"Didn't find any matches after fetcher action");let E=++z;W.set(e,E);let C=Ne(h,y.data);R.fetchers.set(e,C);let[_,I]=oe(t.history,R,T,h,w,U,F,B,J,$,q,S,p,{[i.route.id]:y.data},void 0);I.filter((t=>t.key!==e)).forEach((e=>{let t=e.key,n=R.fetchers.get(t),r=Ne(void 0,n?n.data:void 0);R.fetchers.set(t,r),j.has(t)&&Le(t),e.controller&&j.set(t,e.controller)})),ae({fetchers:new Map(R.fetchers)});let O=()=>I.forEach((e=>Le(e.key)));m.signal.addEventListener("abort",O);let{results:M,loaderResults:N,fetcherResults:A}=await pe(R.matches,T,_,I,k);if(m.signal.aborted)return;m.signal.removeEventListener("abort",O),W.delete(e),j.delete(e),I.forEach((e=>j.delete(e.key)));let D=be(M);if(D){if(D.idx>=_.length){let e=I[D.idx-_.length].key;q.add(e)}return he(R,D.result)}let{loaderData:L,errors:H}=fe(R,R.matches,_,N,void 0,I,A,te);if(R.fetchers.has(e)){let t=Ae(y.data);R.fetchers.set(e,t)}Be(E),"loading"===R.navigation.state&&E>V?(l(P,"Expected pending action"),x&&x.abort(),ce(R.navigation.location,{matches:T,loaderData:L,errors:H,fetchers:new Map(R.fetchers)})):(ae({errors:H,loaderData:me(R.loaderData,L,T,H),fetchers:new Map(R.fetchers)}),U=!1)}(e,n,v,k,g,u,y):($.set(e,{routeId:n,path:v}),async function(e,n,r,i,s,a,u){let d=R.fetchers.get(e);Ee(e,Ne(u,d?d.data:void 0),{flushSync:a});let h=new AbortController,f=ue(t.history,r,h.signal);j.set(e,h);let m=z,g=await le("loader",f,i,s,c,o,p);ke(g)&&(g=await Ie(g,f.signal,!0)||g);j.get(e)===h&&j.delete(e);if(f.signal.aborted)return;if(J.has(e))return void Ee(e,Ae(void 0));if(Te(g))return V>m?void Ee(e,Ae(void 0)):(q.add(e),void await he(R,g));if(Se(g))return void Ce(e,n,g.error);l(!ke(g),"Unhandled fetcher deferred data"),Ee(e,Ae(g.data))}(e,n,v,k,g,u,y))},revalidate:function(){we(),ae({revalidation:"loading"}),"submitting"!==R.navigation.state&&("idle"!==R.navigation.state?de(P||R.historyAction,R.navigation.location,{overrideNavigation:R.navigation}):de(R.historyAction,R.location,{startUninterruptedRevalidation:!0}))},createHref:e=>t.history.createHref(e),encodeLocation:e=>t.history.encodeLocation(e),getFetcher:Re,deleteFetcher:function(e){if(f.v7_fetcherPersist){let t=(H.get(e)||0)-1;t<=0?(H.delete(e),J.add(e)):H.set(e,t)}else De(e);ae({fetchers:new Map(R.fetchers)})},dispose:function(){m&&m(),D&&D(),v.clear(),x&&x.abort(),R.fetchers.forEach(((e,t)=>De(t))),R.blockers.forEach(((e,t)=>je(t)))},getBlocker:function(e,t){let n=R.blockers.get(e)||X;return ie.get(e)!==t&&ie.set(e,t),n},deleteBlocker:je,_internalFetchControllers:j,_internalActiveDeferreds:te,_internalSetRoutes:function(e){c={},s=y(e,o,void 0,c)}},_}Symbol("deferred");function ne(e,t,n,r,i,o,s){let a,c;if(o){a=[];for(let e of t)if(a.push(e),e.route.id===o){c=e;break}}else a=t,c=t[t.length-1];let l=L(i||".",D(a).map((e=>e.pathnameBase)),N(e.pathname,n)||e.pathname,"path"===s);return null==i&&(l.search=e.search,l.hash=e.hash),null!=i&&""!==i&&"."!==i||!c||!c.route.index||Re(l.search)||(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r&&"/"!==n&&(l.pathname="/"===l.pathname?n:U([n,l.pathname])),p(l)}function re(e,t,n,r){if(!r||!function(e){return null!=e&&("formData"in e&&null!=e.formData||"body"in e&&void 0!==e.body)}(r))return{path:n};if(r.formMethod&&!Ce(r.formMethod))return{path:n,error:ye(405,{method:r.formMethod})};let i,o,s=()=>({path:n,error:ye(400,{type:"invalid-body"})}),a=r.formMethod||"get",c=e?a.toUpperCase():a.toLowerCase(),u=we(n);if(void 0!==r.body){if("text/plain"===r.formEncType){if(!_e(c))return s();let e="string"===typeof r.body?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce(((e,t)=>{let[n,r]=t;return""+e+n+"="+r+"\n"}),""):String(r.body);return{path:n,submission:{formMethod:c,formAction:u,formEncType:r.formEncType,formData:void 0,json:void 0,text:e}}}if("application/json"===r.formEncType){if(!_e(c))return s();try{let e="string"===typeof r.body?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:c,formAction:u,formEncType:r.formEncType,formData:void 0,json:e,text:void 0}}}catch(m){return s()}}}if(l("function"===typeof FormData,"FormData is not available in this environment"),r.formData)i=de(r.formData),o=r.formData;else if(r.body instanceof FormData)i=de(r.body),o=r.body;else if(r.body instanceof URLSearchParams)i=r.body,o=he(i);else if(null==r.body)i=new URLSearchParams,o=new FormData;else try{i=new URLSearchParams(r.body),o=he(i)}catch(m){return s()}let d={formMethod:c,formAction:u,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:o,json:void 0,text:void 0};if(_e(d.formMethod))return{path:n,submission:d};let h=f(n);return t&&h.search&&Re(h.search)&&i.append("index",""),h.search="?"+i,{path:p(h),submission:d}}function ie(e,t){let n=e;if(t){let r=e.findIndex((e=>e.route.id===t));r>=0&&(n=e.slice(0,r))}return n}function oe(e,t,n,r,i,o,s,c,l,u,d,h,p,f,m){let g=m?Object.values(m)[0]:f?Object.values(f)[0]:void 0,v=e.createURL(t.location),y=e.createURL(i),w=m?Object.keys(m)[0]:void 0,k=ie(n,w).filter(((e,n)=>{if(e.route.lazy)return!0;if(null==e.route.loader)return!1;if(function(e,t,n){let r=!t||n.route.id!==t.route.id,i=void 0===e[n.route.id];return r||i}(t.loaderData,t.matches[n],e)||s.some((t=>t===e.route.id)))return!0;let i=t.matches[n],c=e;return ae(e,a({currentUrl:v,currentParams:i.params,nextUrl:y,nextParams:c.params},r,{actionResult:g,defaultShouldRevalidate:o||v.pathname+v.search===y.pathname+y.search||v.search!==y.search||se(i,c)}))})),S=[];return u.forEach(((e,i)=>{if(!n.some((t=>t.route.id===e.routeId))||l.has(i))return;let s=b(h,e.path,p);if(!s)return void S.push({key:i,routeId:e.routeId,path:e.path,matches:null,match:null,controller:null});let u=t.fetchers.get(i),f=Pe(s,e.path),m=!1;m=!d.has(i)&&(!!c.includes(i)||(u&&"idle"!==u.state&&void 0===u.data?o:ae(f,a({currentUrl:v,currentParams:t.matches[t.matches.length-1].params,nextUrl:y,nextParams:n[n.length-1].params},r,{actionResult:g,defaultShouldRevalidate:o})))),m&&S.push({key:i,routeId:e.routeId,path:e.path,matches:s,match:f,controller:new AbortController})})),[k,S]}function se(e,t){let n=e.route.path;return e.pathname!==t.pathname||null!=n&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function ae(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if("boolean"===typeof n)return n}return t.defaultShouldRevalidate}async function ce(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let i=n[e.id];l(i,"No route found in manifest");let o={};for(let s in r){let e=void 0!==i[s]&&"hasErrorBoundary"!==s;u(!e,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. The lazy route property "'+s+'" will be ignored.'),e||v.has(s)||(o[s]=r[s])}Object.assign(i,o),Object.assign(i,a({},t(i),{lazy:void 0}))}async function le(e,t,n,r,i,o,s,a){let c,u,d;void 0===a&&(a={});let h=e=>{let r,i=new Promise(((e,t)=>r=t));return d=()=>r(),t.signal.addEventListener("abort",d),Promise.race([e({request:t,params:n.params,context:a.requestContext}),i])};try{let r=n.route[e];if(n.route.lazy)if(r){let e,t=await Promise.all([h(r).catch((t=>{e=t})),ce(n.route,o,i)]);if(e)throw e;u=t[0]}else{if(await ce(n.route,o,i),r=n.route[e],!r){if("action"===e){let e=new URL(t.url),r=e.pathname+e.search;throw ye(405,{method:t.method,pathname:r,routeId:n.route.id})}return{type:g.data,data:void 0}}u=await h(r)}else{if(!r){let e=new URL(t.url);throw ye(404,{pathname:e.pathname+e.search})}u=await h(r)}l(void 0!==u,"You defined "+("action"===e?"an action":"a loader")+' for route "'+n.route.id+"\" but didn't return anything from your `"+e+"` function. Please return a value or `null`.")}catch(m){c=g.error,u=m}finally{d&&t.signal.removeEventListener("abort",d)}if(Ee(u)){let e,i=u.status;if(J.has(i)){let e=u.headers.get("Location");if(l(e,"Redirects returned/thrown from loaders/actions must have a Location header"),Q.test(e)){if(!a.isStaticRequest){let n=new URL(t.url),r=e.startsWith("//")?new URL(n.protocol+e):new URL(e),i=null!=N(r.pathname,s);r.origin===n.origin&&i&&(e=r.pathname+r.search+r.hash)}}else e=ne(new URL(t.url),r.slice(0,r.indexOf(n)+1),s,!0,e);if(a.isStaticRequest)throw u.headers.set("Location",e),u;return{type:g.redirect,status:i,location:e,revalidate:null!==u.headers.get("X-Remix-Revalidate"),reloadDocument:null!==u.headers.get("X-Remix-Reload-Document")}}if(a.isRouteRequest){throw{type:c===g.error?g.error:g.data,response:u}}let o=u.headers.get("Content-Type");return e=o&&/\bapplication\/json\b/.test(o)?await u.json():await u.text(),c===g.error?{type:c,error:new z(i,u.statusText,e),headers:u.headers}:{type:g.data,data:e,statusCode:u.status,headers:u.headers}}return c===g.error?{type:c,error:u}:function(e){let t=e;return t&&"object"===typeof t&&"object"===typeof t.data&&"function"===typeof t.subscribe&&"function"===typeof t.cancel&&"function"===typeof t.resolveData}(u)?{type:g.deferred,deferredData:u,statusCode:null==(p=u.init)?void 0:p.status,headers:(null==(f=u.init)?void 0:f.headers)&&new Headers(u.init.headers)}:{type:g.data,data:u};var p,f}function ue(e,t,n,r){let i=e.createURL(we(t)).toString(),o={signal:n};if(r&&_e(r.formMethod)){let{formMethod:e,formEncType:t}=r;o.method=e.toUpperCase(),"application/json"===t?(o.headers=new Headers({"Content-Type":t}),o.body=JSON.stringify(r.json)):"text/plain"===t?o.body=r.text:"application/x-www-form-urlencoded"===t&&r.formData?o.body=de(r.formData):o.body=r.formData}return new Request(i,o)}function de(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,"string"===typeof r?r:r.name);return t}function he(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function pe(e,t,n,r,i){let o,s={},a=null,c=!1,u={};return n.forEach(((n,d)=>{let h=t[d].route.id;if(l(!Te(n),"Cannot handle redirect results in processLoaderData"),Se(n)){let t=ge(e,h),i=n.error;r&&(i=Object.values(r)[0],r=void 0),a=a||{},null==a[t.route.id]&&(a[t.route.id]=i),s[h]=void 0,c||(c=!0,o=V(n.error)?n.error.status:500),n.headers&&(u[h]=n.headers)}else ke(n)?(i.set(h,n.deferredData),s[h]=n.deferredData.data):s[h]=n.data,null==n.statusCode||200===n.statusCode||c||(o=n.statusCode),n.headers&&(u[h]=n.headers)})),r&&(a=r,s[Object.keys(r)[0]]=void 0),{loaderData:s,errors:a,statusCode:o||200,loaderHeaders:u}}function fe(e,t,n,r,i,o,s,c){let{loaderData:u,errors:d}=pe(t,n,r,i,c);for(let h=0;h<o.length;h++){let{key:t,match:n,controller:r}=o[h];l(void 0!==s&&void 0!==s[h],"Did not find corresponding fetcher result");let i=s[h];if(!r||!r.signal.aborted)if(Se(i)){let r=ge(e.matches,null==n?void 0:n.route.id);d&&d[r.route.id]||(d=a({},d,{[r.route.id]:i.error})),e.fetchers.delete(t)}else if(Te(i))l(!1,"Unhandled fetcher revalidation redirect");else if(ke(i))l(!1,"Unhandled fetcher deferred data");else{let n=Ae(i.data);e.fetchers.set(t,n)}}return{loaderData:u,errors:d}}function me(e,t,n,r){let i=a({},t);for(let o of n){let n=o.route.id;if(t.hasOwnProperty(n)?void 0!==t[n]&&(i[n]=t[n]):void 0!==e[n]&&o.route.loader&&(i[n]=e[n]),r&&r.hasOwnProperty(n))break}return i}function ge(e,t){return(t?e.slice(0,e.findIndex((e=>e.route.id===t))+1):[...e]).reverse().find((e=>!0===e.route.hasErrorBoundary))||e[0]}function ve(e){let t=1===e.length?e[0]:e.find((e=>e.index||!e.path||"/"===e.path))||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function ye(e,t){let{pathname:n,routeId:r,method:i,type:o}=void 0===t?{}:t,s="Unknown Server Error",a="Unknown @remix-run/router error";return 400===e?(s="Bad Request",i&&n&&r?a="You made a "+i+' request to "'+n+'" but did not provide a `loader` for route "'+r+'", so there is no way to handle the request.':"defer-action"===o?a="defer() is not supported in actions":"invalid-body"===o&&(a="Unable to encode submission body")):403===e?(s="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):404===e?(s="Not Found",a='No route matches URL "'+n+'"'):405===e&&(s="Method Not Allowed",i&&n&&r?a="You made a "+i.toUpperCase()+' request to "'+n+'" but did not provide an `action` for route "'+r+'", so there is no way to handle the request.':i&&(a='Invalid request method "'+i.toUpperCase()+'"')),new z(e||500,s,new Error(a),!0)}function be(e){for(let t=e.length-1;t>=0;t--){let n=e[t];if(Te(n))return{result:n,idx:t}}}function we(e){return p(a({},"string"===typeof e?f(e):e,{hash:""}))}function ke(e){return e.type===g.deferred}function Se(e){return e.type===g.error}function Te(e){return(e&&e.type)===g.redirect}function Ee(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"object"===typeof e.headers&&"undefined"!==typeof e.body}function Ce(e){return H.has(e.toLowerCase())}function _e(e){return q.has(e.toLowerCase())}async function xe(e,t,n,r,i,o){for(let s=0;s<n.length;s++){let a=n[s],c=t[s];if(!c)continue;let u=e.find((e=>e.route.id===c.route.id)),d=null!=u&&!se(u,c)&&void 0!==(o&&o[c.route.id]);if(ke(a)&&(i||d)){let e=r[s];l(e,"Expected an AbortSignal for revalidating fetcher deferred result"),await Ie(a,e,i).then((e=>{e&&(n[s]=e||n[s])}))}}}async function Ie(e,t,n){if(void 0===n&&(n=!1),!await e.deferredData.resolveData(t)){if(n)try{return{type:g.data,data:e.deferredData.unwrappedData}}catch(r){return{type:g.error,error:r}}return{type:g.data,data:e.deferredData.data}}}function Re(e){return new URLSearchParams(e).getAll("index").some((e=>""===e))}function Pe(e,t){let n="string"===typeof t?f(t).search:t.search;if(e[e.length-1].route.index&&Re(n||""))return e[e.length-1];let r=D(e);return r[r.length-1]}function Oe(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:o,json:s}=e;if(t&&n&&r)return null!=i?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i}:null!=o?{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0}:void 0!==s?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}:void 0}function Me(e,t){if(t){return{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}return{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Ne(e,t){if(e){return{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}}return{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Ae(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},De.apply(this,arguments)}const Le=t.createContext(null);const Ue=t.createContext(null);const Fe=t.createContext(null);const Be=t.createContext(null);const je=t.createContext({outlet:null,matches:[],isDataRoute:!1});const ze=t.createContext(null);function Ve(){return null!=t.useContext(Be)}function We(){return Ve()||l(!1),t.useContext(Be).location}function qe(n,r,i){Ve()||l(!1);let{navigator:o}=t.useContext(Fe),{matches:s}=t.useContext(je),a=s[s.length-1],c=a?a.params:{},u=(a&&a.pathname,a?a.pathnameBase:"/");a&&a.route;let d,h=We();if(r){var p;let e="string"===typeof r?f(r):r;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||l(!1),d=e}else d=h;let m=d.pathname||"/",g=b(n,{pathname:"/"===u?m:m.slice(u.length)||"/"});let v=Ye(g&&g.map((e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([u,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:U([u,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),s,i);return r&&v?t.createElement(Be.Provider,{value:{location:De({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:e.Pop}},v):v}function $e(){let e=function(){var e;let n=t.useContext(ze),r=Xe(Ke.UseRouteError),i=Qe(Ke.UseRouteError);if(n)return n;return null==(e=r.errors)?void 0:e[i]}(),n=V(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:o},r):null,null)}const He=t.createElement($e,null);class Je extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error?t.createElement(je.Provider,{value:this.props.routeContext},t.createElement(ze.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ge(e){let{routeContext:n,match:r,children:i}=e,o=t.useContext(Le);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),t.createElement(je.Provider,{value:n},i)}function Ye(e,n,r){var i;if(void 0===n&&(n=[]),void 0===r&&(r=null),null==e){var o;if(null==(o=r)||!o.errors)return null;e=r.matches}let s=e,a=null==(i=r)?void 0:i.errors;if(null!=a){let e=s.findIndex((e=>e.route.id&&(null==a?void 0:a[e.route.id])));e>=0||l(!1),s=s.slice(0,Math.min(s.length,e+1))}return s.reduceRight(((e,i,o)=>{let c=i.route.id?null==a?void 0:a[i.route.id]:null,l=null;r&&(l=i.route.errorElement||He);let u=n.concat(s.slice(0,o+1)),d=()=>{let n;return n=c?l:i.route.Component?t.createElement(i.route.Component,null):i.route.element?i.route.element:e,t.createElement(Ge,{match:i,routeContext:{outlet:e,matches:u,isDataRoute:null!=r},children:n})};return r&&(i.route.ErrorBoundary||i.route.errorElement||0===o)?t.createElement(Je,{location:r.location,revalidation:r.revalidation,component:l,error:c,children:d(),routeContext:{outlet:null,matches:u,isDataRoute:!0}}):d()}),null)}var Ke=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ke||{});function Xe(e){let n=t.useContext(Ue);return n||l(!1),n}function Qe(e){let n=function(e){let n=t.useContext(je);return n||l(!1),n}(),r=n.matches[n.matches.length-1];return r.route.id||l(!1),r.route.id}r.startTransition;function Ze(n){let{basename:r="/",children:i=null,location:o,navigationType:s=e.Pop,navigator:a,static:c=!1}=n;Ve()&&l(!1);let u=r.replace(/^\/*/,"/"),d=t.useMemo((()=>({basename:u,navigator:a,static:c})),[u,a,c]);"string"===typeof o&&(o=f(o));let{pathname:h="/",search:p="",hash:m="",state:g=null,key:v="default"}=o,y=t.useMemo((()=>{let e=N(h,u);return null==e?null:{location:{pathname:e,search:p,hash:m,state:g,key:v},navigationType:s}}),[u,h,p,m,g,v,s]);return null==y?null:t.createElement(Fe.Provider,{value:d},t.createElement(Be.Provider,{children:i,value:y}))}new Promise((()=>{}));t.Component;function et(e){let n={hasErrorBoundary:null!=e.ErrorBoundary||null!=e.errorElement};return e.Component&&Object.assign(n,{element:t.createElement(e.Component),Component:void 0}),e.ErrorBoundary&&Object.assign(n,{errorElement:t.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),n}function tt(){return tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tt.apply(this,arguments)}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nt(){var e;let t=null==(e=window)?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=tt({},t,{errors:rt(t.errors)})),t}function rt(e){if(!e)return null;let t=Object.entries(e),n={};for(let[i,o]of t)if(o&&"RouteErrorResponse"===o.__type)n[i]=new z(o.status,o.statusText,o.data,!0===o.internal);else if(o&&"Error"===o.__type){if(o.__subType){let e=window[o.__subType];if("function"===typeof e)try{let t=new e(o.message);t.stack="",n[i]=t}catch(r){}}if(null==n[i]){let e=new Error(o.message);e.stack="",n[i]=e}}else n[i]=o;return n}const it=t.createContext({isTransitioning:!1});const ot=t.createContext(new Map);const st=r.startTransition,at=s.flushSync;function ct(e){at?at(e):e()}class lt{constructor(){this.status="pending",this.promise=new Promise(((e,t)=>{this.resolve=t=>{"pending"===this.status&&(this.status="resolved",e(t))},this.reject=e=>{"pending"===this.status&&(this.status="rejected",t(e))}}))}}function ut(e){let{fallbackElement:n,router:r,future:i}=e,[o,s]=t.useState(r.state),[a,c]=t.useState(),[l,u]=t.useState({isTransitioning:!1}),[d,h]=t.useState(),[p,f]=t.useState(),[m,g]=t.useState(),v=t.useRef(new Map),{v7_startTransition:y}=i||{},b=t.useCallback((e=>{y?function(e){st?st(e):e()}(e):e()}),[y]),w=t.useCallback(((e,t)=>{let{deletedFetchers:n,unstable_flushSync:i,unstable_viewTransitionOpts:o}=t;n.forEach((e=>v.current.delete(e))),e.fetchers.forEach(((e,t)=>{void 0!==e.data&&v.current.set(t,e.data)}));let a=null==r.window||"function"!==typeof r.window.document.startViewTransition;if(o&&!a){if(i){ct((()=>{p&&(d&&d.resolve(),p.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:o.currentLocation,nextLocation:o.nextLocation})}));let t=r.window.document.startViewTransition((()=>{ct((()=>s(e)))}));return t.finished.finally((()=>{ct((()=>{h(void 0),f(void 0),c(void 0),u({isTransitioning:!1})}))})),void ct((()=>f(t)))}p?(d&&d.resolve(),p.skipTransition(),g({state:e,currentLocation:o.currentLocation,nextLocation:o.nextLocation})):(c(e),u({isTransitioning:!0,flushSync:!1,currentLocation:o.currentLocation,nextLocation:o.nextLocation}))}else i?ct((()=>s(e))):b((()=>s(e)))}),[r.window,p,d,v,b]);t.useLayoutEffect((()=>r.subscribe(w)),[r,w]),t.useEffect((()=>{l.isTransitioning&&!l.flushSync&&h(new lt)}),[l]),t.useEffect((()=>{if(d&&a&&r.window){let e=a,t=d.promise,n=r.window.document.startViewTransition((async()=>{b((()=>s(e))),await t}));n.finished.finally((()=>{h(void 0),f(void 0),c(void 0),u({isTransitioning:!1})})),f(n)}}),[b,a,d,r.window]),t.useEffect((()=>{d&&a&&o.location.key===a.location.key&&d.resolve()}),[d,p,o.location,a]),t.useEffect((()=>{!l.isTransitioning&&m&&(c(m.state),u({isTransitioning:!0,flushSync:!1,currentLocation:m.currentLocation,nextLocation:m.nextLocation}),g(void 0))}),[l.isTransitioning,m]);let k=t.useMemo((()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:e=>r.navigate(e),push:(e,t,n)=>r.navigate(e,{state:t,preventScrollReset:null==n?void 0:n.preventScrollReset}),replace:(e,t,n)=>r.navigate(e,{replace:!0,state:t,preventScrollReset:null==n?void 0:n.preventScrollReset})})),[r]),S=r.basename||"/",T=t.useMemo((()=>({router:r,navigator:k,static:!1,basename:S})),[r,k,S]);return t.createElement(t.Fragment,null,t.createElement(Le.Provider,{value:T},t.createElement(Ue.Provider,{value:o},t.createElement(ot.Provider,{value:v.current},t.createElement(it.Provider,{value:l},t.createElement(Ze,{basename:S,location:o.location,navigationType:o.historyAction,navigator:k},o.initialized?t.createElement(dt,{routes:r.routes,state:o}):n))))),null)}function dt(e){let{routes:t,state:n}=e;return qe(t,void 0,n)}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var ht,pt;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ht||(ht={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(pt||(pt={}));const ft=e=>{const n="function"==typeof e,r=(0,t.useRef)(e);(0,t.useEffect)((()=>{r.current=e})),(0,t.useEffect)((()=>{if(n){const e=e=>{const t=r.current(e);return"string"==typeof t?(e.preventDefault(),e.returnValue=t):e.defaultPrevented?e.returnValue="":void 0};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}}),[n])};var mt=n(634),gt=n.n(mt),vt=n(184);class yt extends t.Component{constructor(e){super(e),this.outputRef=t.createRef(),this.state={output:[],sidebar_visible:!1},this.scrollToBottom=()=>{const e=this.outputRef.current;e&&(e.scrollTop=e.scrollHeight)},this.handleMessage=e=>{const t=function(e,t){let n=[];for(const r of e.split("\r\n")){const e=gt().ansiToJson(r,{json:!0,remove_empty:!1});let i=[];for(const n of e){const e=Tt(n,t);i=[...i,...e]}n=[...n,(0,vt.jsx)("span",{children:i},n.length)]}return n}(e,this.handleExitClick);this.addToOutput(t)},this.handleExitClick=e=>{this.props.client.sendCommand(e)},this.props.client.on("message",this.handleMessage),this.props.client.on("connect",(()=>this.addToOutput([(0,vt.jsx)("h2",{children:" Connected"})]))),this.props.client.on("disconnect",(()=>{this.addToOutput([(0,vt.jsx)("h2",{children:" Disconnected"})]),this.state.sidebar_visible=!1})),this.props.client.on("error",(e=>this.addToOutput([(0,vt.jsxs)("h2",{children:[" Error: ",e.message]})]))),this.props.client.on("command",(e=>{this.addToOutput([(0,vt.jsx)("span",{className:"command","aria-live":"off",children:e})])})),this.props.client.on("userlist",(e=>this.setState({sidebar_visible:!!e})))}componentDidUpdate(){this.scrollToBottom()}componentWillUnmount(){this.props.client.removeListener("message",this.handleMessage)}addToOutput(e){this.setState((t=>{const n=t.output.length,r=e.map(((e,t)=>(0,vt.jsx)("div",{children:e},n+t)));return{output:[...t.output,...r]}}))}saveLog(){const e=this.outputRef.current;if(e){const t=e.innerHTML,n=new Blob([t],{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("a"),o=new Date,s=o.toLocaleDateString(),a=o.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),c=`${document.title.replace(/\s+/g,"-")}-log-${s}-${a}.html`;i.download=c,i.href=r,i.click(),URL.revokeObjectURL(r),i.remove()}}clearLog(){this.setState({output:[]})}render(){var e="output";return this.state.sidebar_visible&&(e+=" sidebar-visible"),(0,vt.jsx)("div",{ref:this.outputRef,className:e,"aria-live":"polite",role:"log",children:this.state.output})}}const bt=yt;const wt=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,kt=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,St=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function Tt(e,t){const n=function(e){const t={};e.bg&&(t.backgroundColor=`rgb(${e.bg})`);e.fg&&(t.color=`rgb(${e.fg})`);switch(e.decoration){case"bold":t.fontWeight="bold";break;case"dim":t.opacity="0.5";break;case"italic":t.fontStyle="italic";break;case"hidden":t.visibility="hidden";break;case"strikethrough":t.textDecoration="line-through";break;case"underline":t.textDecoration="underline";break;case"blink":t.textDecoration="blink"}return t}(e),r=[];let i=0;function o(t,n){let o;for(;null!==(o=t.exec(e.content));){const s=o.index;s>i&&r.push(e.content.substring(i,s)),r.push(n(o)),i=t.lastIndex}}return o(wt,(function(e){const[,t,n]=e,r=n;return(0,vt.jsx)("a",{href:r,target:"_blank",rel:"noreferrer",children:n})})),o(kt,(function(e){const t=e.groups.name,n=`mailto:${t}`;return(0,vt.jsxs)(vt.Fragment,{children:[e.groups.slorp1,(0,vt.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:t}),e.groups.slorp2]})})),o(St,(function(e){const[,n,r]=e;return(0,vt.jsx)("a",{onClick:()=>t(n),className:"exit",children:r})})),i<e.content.length&&r.push(e.content.substring(i)),r.map((e=>(0,vt.jsx)("span",{style:n,children:e})))}var Et=n(143);var Ct=n(778);let _t=function(e){return e[e.BINARY=0]="BINARY",e[e.ECHO=1]="ECHO",e[e.RCP=2]="RCP",e[e.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",e[e.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",e[e.STATUS=5]="STATUS",e[e.TIMING_MARK=6]="TIMING_MARK",e[e.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",e[e.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",e[e.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",e[e.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",e[e.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",e[e.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",e[e.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",e[e.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",e[e.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",e[e.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",e[e.EXTENDED_ASCII=17]="EXTENDED_ASCII",e[e.LOGOUT=18]="LOGOUT",e[e.BYTE_MACRO=19]="BYTE_MACRO",e[e.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",e[e.SUPDUP=21]="SUPDUP",e[e.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",e[e.SEND_LOCATION=23]="SEND_LOCATION",e[e.TERMINAL_TYPE=24]="TERMINAL_TYPE",e[e.END_OF_RECORD=25]="END_OF_RECORD",e[e.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",e[e.OUTPUT_MARKING=27]="OUTPUT_MARKING",e[e.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",e[e.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",e[e.X_3_PAD=30]="X_3_PAD",e[e.NAWS=31]="NAWS",e[e.TERMINAL_SPEED=32]="TERMINAL_SPEED",e[e.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",e[e.LINEMODE=34]="LINEMODE",e[e.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",e[e.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",e[e.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",e[e.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",e[e.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",e[e.TN3270E=40]="TN3270E",e[e.XAUTH=41]="XAUTH",e[e.CHARSET=42]="CHARSET",e[e.RSP=43]="RSP",e[e.COM_PORT_OPTION=44]="COM_PORT_OPTION",e[e.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",e[e.START_TLS=46]="START_TLS",e[e.KERMIT=47]="KERMIT",e[e.SEND_URL=48]="SEND_URL",e[e.FORWARD_X=49]="FORWARD_X",e[e.PRAGMA_LOGON=138]="PRAGMA_LOGON",e[e.GMCP=201]="GMCP",e}({}),xt=function(e){return e[e.SE=240]="SE",e[e.NOP=241]="NOP",e[e.DM=242]="DM",e[e.BRK=243]="BRK",e[e.IP=244]="IP",e[e.AO=245]="AO",e[e.AYT=246]="AYT",e[e.EC=247]="EC",e[e.EL=248]="EL",e[e.GA=249]="GA",e[e.SB=250]="SB",e[e.WILL=251]="WILL",e[e.WONT=252]="WONT",e[e.DO=253]="DO",e[e.DONT=254]="DONT",e[e.IAC=255]="IAC",e}({});class It{constructor(e){this.ws=void 0,this.ws=e}on(e,t){if("data"===e)return void(this.ws.onmessage=e=>{t(e.data)});this["on"+e]=t}write(e){this.ws.send(e)}}var Rt=function(e){return e[e.DATA=0]="DATA",e[e.COMMAND=1]="COMMAND",e[e.SUBNEGOTIATION=2]="SUBNEGOTIATION",e[e.NEGOTIATION=3]="NEGOTIATION",e}(Rt||{});class Pt extends Et{constructor(e){super(),this.state=void 0,this.buffer=void 0,this.subBuffer=void 0,this.iacSEBuffer=Ct.lW.from([xt.IAC,xt.SE]),this.negotiationByte=0,this.stream=void 0,this.state=Rt.DATA,this.buffer=Ct.lW.alloc(0),this.subBuffer=Ct.lW.alloc(0),e&&e.on("data",(e=>this.parse(e))),this.stream=e}parse(e){for(this.buffer=Ct.lW.concat([this.buffer,Ct.lW.from(e)]);this.buffer.length>0;){let e;switch(this.state){case Rt.DATA:this.handleData();break;case Rt.COMMAND:if(e=this.handleCommand(),e)return;break;case Rt.SUBNEGOTIATION:if(e=this.handleSubnegotiation(),e)return;break;case Rt.NEGOTIATION:if(e=this.handleNegotiation(),e)return}}}handleData(){const e=this.buffer.indexOf(xt.IAC);if(-1===e)return this.emit("data",this.buffer),void(this.buffer=Ct.lW.alloc(0));this.emit("data",this.buffer.slice(0,e)),this.buffer=this.buffer.slice(e),this.state=Rt.COMMAND}handleCommand(){if(this.buffer.length<2)return!0;const e=this.buffer[1];switch(this.buffer=this.buffer.slice(2),e){case xt.NOP:this.emit("command",xt.NOP),this.state=Rt.DATA;break;case xt.SB:this.subBuffer=Ct.lW.alloc(0),this.state=Rt.SUBNEGOTIATION;break;case xt.DO:case xt.DONT:case xt.WILL:case xt.WONT:this.negotiationByte=e,this.state=Rt.NEGOTIATION;break;default:this.state=Rt.DATA}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const e=this.negotiationByte,t=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",e,t),this.state=Rt.DATA,!1}handleSubnegotiation(){let e=this.buffer.indexOf(this.iacSEBuffer);if(-1===e)return!0;this.state=Rt.DATA;let t=this.buffer.slice(0,e);return t[0]===_t.GMCP?this.handleGmcp(t.slice(1)):this.emit("subnegotiation",t),this.buffer=this.buffer.slice(e+2),!1}handleGmcp(e){const t=e.toString(),[n,r]=t.split(/ +(.+?)$/,2);this.emit("gmcp",n,r)}sendNegotiation(e,t){this.stream.write(Ct.lW.from([xt.IAC,e,t]))}sendGmcp(e,t){const n=e+" "+t,r=Ct.lW.from(n),i=Ct.lW.concat([Ct.lW.from([xt.IAC,xt.SB]),Ct.lW.from([_t.GMCP]),r,this.iacSEBuffer]);this.stream.write(i)}sendTerminalType(e){const t=Ct.lW.from(e),n=Ct.lW.concat([Ct.lW.from([xt.IAC,xt.SB]),Ct.lW.from([_t.TERMINAL_TYPE,_t.BINARY]),t,this.iacSEBuffer]);this.stream.write(n)}}class Ot{constructor(e){this.packageName=void 0,this.packageVersion=1,this.client=void 0,this.client=e}sendData(e,t){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(t))}shutdown(){}}class Mt extends Ot{constructor(...e){super(...e),this.packageName="Auth.Autologin"}handleToken(e){localStorage.setItem("LoginRefreshToken",e)}sendLogin(){var e=localStorage.getItem("LoginRefreshToken");e&&this.sendData("Login",e)}}class Nt extends Ot{constructor(...e){super(...e),this.packageName="Char"}handleName(e){this.client.worldData.playerId=e.name,this.client.worldData.playerName=e.fullname,this.client.emit("statustext",`Logged in as ${e.fullname}`)}sendLogin(e,t){this.client.sendGmcp("Char.Login",JSON.stringify({name:e,password:t}))}}class At extends Ot{constructor(e){super(e),this.packageName="Client.Keystrokes",this.bindings=[],document.addEventListener("keyup",this.handleKeyup.bind(this))}handleKeyup(e){const t=this.findBinding(e);if(t){const e=this.client.getInput(),n=this.parseCommand(t.command,e);t.autosend?this.sendCommand(n):this.placeInInputField(n)}}findBinding(e){return this.bindings.find((t=>t.key===e.key&&t.modifiers.every((t=>e[`${t}Key`]))))}parseCommand(e,t){const n=t.trim().split(/\s+/);return e.replace(/%(\d+|\*)/g,((e,r)=>{if("*"===r)return t;const i=parseInt(r,10)-1;return i>=0&&i<n.length?n[i]:e}))}sendCommand(e){this.sendData("ExecuteCommand",{command:e})}placeInInputField(e){this.client.setInput(e)}bindKey(e){const t={key:e.key,modifiers:e.modifiers,command:e.command,autosend:e.autosend};this.bindings.push(t)}unbindKey(e){this.bindings=this.bindings.filter((t=>t.key!==e.key||!t.modifiers.every((t=>e.modifiers.includes(t)))))}unbindAll(){this.bindings=[]}bindAll(e){this.bindings=e.bindings}listBindings(){return this.bindings}}var Dt=n(667);const Lt=new WeakSet,Ut=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,jt=new WeakMap,zt=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,qt=new WeakMap,$t=new WeakMap,Ht={construct:()=>Ht},Jt=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Gt=(e,t)=>{const n=[];let r=e.replace(/^[\s]+/,""),i=r.match(Jt);for(;null!==i;){const e=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());n.push(o),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(Jt)}return[n.join(";"),r]},Yt=e=>{if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Kt=e=>{if(!(e=>{try{new new Proxy(e,Ht)}catch{return!1}return!0})(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!==typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},Xt=(e,t)=>{const n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},Qt=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[r]=n;return e.delete(r),r},Zt=(e,t,n,r)=>{const i=Xt(e,t),o=Qt(i,(e=>e[0]===n&&e[1]===r));return 0===i.size&&e.delete(t),o},en=e=>Xt(Vt,e),tn=e=>{if(Lt.has(e))throw new Error("The AudioNode is already stored.");Lt.add(e),en(e).forEach((e=>e(!0)))},nn=e=>"port"in e,rn=e=>{if(!Lt.has(e))throw new Error("The AudioNode is not stored.");Lt.delete(e),en(e).forEach((e=>e(!1)))},on=(e,t)=>{!nn(e)&&t.every((e=>0===e.size))&&rn(e)},sn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},an=(e,t)=>e.context===t,cn=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},ln=()=>new DOMException("","IndexSizeError"),un=e=>{var t;e.getChannelData=(t=e.getChannelData,n=>{try{return t.call(e,n)}catch(r){if(12===r.code)throw ln();throw r}})},dn={numberOfChannels:1},hn=-34028234663852886e22,pn=-hn,fn=e=>Lt.has(e),mn={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},gn=e=>Xt(Ut,e),vn=e=>Xt(Bt,e),yn=(e,t)=>{const{activeInputs:n}=gn(e);n.forEach((n=>n.forEach((([n])=>{t.includes(e)||yn(n,[...t,e])}))));const r=(e=>"playbackRate"in e)(e)?[e.playbackRate]:nn(e)?Array.from(e.parameters.values()):(e=>"frequency"in e&&"gain"in e)(e)?[e.Q,e.detune,e.frequency,e.gain]:(e=>"offset"in e)(e)?[e.offset]:(e=>!("frequency"in e)&&"gain"in e)(e)?[e.gain]:(e=>"detune"in e&&"frequency"in e)(e)?[e.detune,e.frequency]:(e=>"pan"in e)(e)?[e.pan]:[];for(const i of r){const e=vn(i);void 0!==e&&e.activeInputs.forEach((([e])=>yn(e,t)))}fn(e)&&rn(e)},bn=e=>{yn(e.destination,[])},wn=e=>void 0===e||"number"===typeof e||"string"===typeof e&&("balanced"===e||"interactive"===e||"playback"===e),kn=e=>"context"in e,Sn=e=>kn(e[0]),Tn=(e,t,n,r)=>{for(const i of e)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},En=(e,t,[n,r],i)=>{Tn(e,[t,n,r],(e=>e[0]===t&&e[1]===n),i)},Cn=(e,[t,n,r],i)=>{const o=e.get(t);void 0===o?e.set(t,new Set([[n,r]])):Tn(o,[n,r],(e=>e[0]===n),i)},_n=e=>"inputs"in e,xn=(e,t,n,r)=>{if(_n(t)){const i=t.inputs[r];return e.connect(i,n,0),[i,n,0]}return e.connect(t,n,r),[t,n,r]},In=(e,t,n)=>{for(const r of e)if(r[0]===t&&r[1]===n)return e.delete(r),r;return null},Rn=(e,t)=>{if(!en(e).delete(t))throw new Error("Missing the expected event listener.")},Pn=(e,t,n)=>{const r=Xt(e,t),i=Qt(r,(e=>e[0]===n));return 0===r.size&&e.delete(t),i},On=(e,t,n,r)=>{_n(t)?e.disconnect(t.inputs[r],n,0):e.disconnect(t,n,r)},Mn=e=>Xt(Ft,e),Nn=e=>Xt(jt,e),An=e=>Wt.has(e),Dn=e=>!Lt.has(e),Ln=(e,t)=>new Promise((n=>{if(null!==t)n(!0);else{const t=e.createScriptProcessor(256,1,1),r=e.createGain(),i=e.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const s=e.createBufferSource();s.buffer=i,s.loop=!0,s.connect(t).connect(e.destination),s.connect(r),s.disconnect(r),t.onaudioprocess=r=>{const i=r.inputBuffer.getChannelData(0);Array.prototype.some.call(i,(e=>1===e))?n(!0):n(!1),s.stop(),t.onaudioprocess=null,s.disconnect(t),t.disconnect(e.destination)},s.start()}})),Un=(e,t)=>{const n=new Map;for(const r of e)for(const e of r){const t=n.get(e);n.set(e,void 0===t?1:t+1)}n.forEach(((e,n)=>t(n,e)))},Fn=e=>"context"in e,Bn=e=>{const t=new Map;var n,r;e.connect=(n=e.connect.bind(e),(e,r=0,i=0)=>{const o=Fn(e)?n(e,r,i):n(e,r),s=t.get(e);return void 0===s?t.set(e,[{input:i,output:r}]):s.every((e=>e.input!==i||e.output!==r))&&s.push({input:i,output:r}),o}),e.disconnect=(r=e.disconnect,(n,i,o)=>{if(r.apply(e),void 0===n)t.clear();else if("number"===typeof n)for(const[e,r]of t){const i=r.filter((e=>e.output!==n));0===i.length?t.delete(e):t.set(e,i)}else if(t.has(n))if(void 0===i)t.delete(n);else{const e=t.get(n);if(void 0!==e){const r=e.filter((e=>e.output!==i&&(e.input!==o||void 0===o)));0===r.length?t.delete(n):t.set(n,r)}}for(const[r,s]of t)s.forEach((t=>{Fn(r)?e.connect(r,t.output,t.input):e.connect(r,t.output)}))})},jn=(e,t,n,r)=>{const{activeInputs:i,passiveInputs:o}=vn(t),{outputs:s}=gn(e),a=en(e),c=s=>{const a=Mn(e),c=Nn(t);if(s){const t=Pn(o,e,n);En(i,e,t,!1),r||An(e)||a.connect(c,n)}else{const t=((e,t,n)=>Qt(e,(e=>e[0]===t&&e[1]===n)))(i,e,n);Cn(o,t,!1),r||An(e)||a.disconnect(c,n)}};return!!Tn(s,[t,n],(e=>e[0]===t&&e[1]===n),!0)&&(a.add(c),fn(e)?En(i,e,[n,c],!0):Cn(o,[e,n,c],!0),!0)},zn=(e,t,n,r,i)=>{const[o,s]=((e,t,n,r)=>{const{activeInputs:i,passiveInputs:o}=gn(t),s=In(i[r],e,n);if(null===s)return[Zt(o,e,n,r)[2],!1];return[s[2],!0]})(e,n,r,i);if(null!==o&&(Rn(e,o),!s||t||An(e)||On(Mn(e),Mn(n),r,i)),fn(n)){const{activeInputs:e}=gn(n);on(n,e)}},Vn=(e,t,n,r)=>{const[i,o]=((e,t,n)=>{const{activeInputs:r,passiveInputs:i}=vn(t),o=In(r,e,n);if(null===o)return[Pn(i,e,n)[1],!1];return[o[2],!0]})(e,n,r);null!==i&&(Rn(e,i),!o||t||An(e)||Mn(e).disconnect(Nn(n),r))};class Wn{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach(((n,r)=>e.call(t,n,r,this)))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const qn={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function $n(e,t,n,r,i){if("function"===typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,i);else{const o=e.getChannelData(r);if(0===t[n].byteLength)t[n]=o.slice(i,i+128);else{const e=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(e)}}}const Hn=(e,t,n,r,i)=>{"function"===typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],r,i):0!==t[n].byteLength&&e.getChannelData(r).set(t[n],i)},Jn=(e,t)=>{const n=[];for(let r=0;r<e;r+=1){const e=[],i="number"===typeof t?t:t[r];for(let t=0;t<i;t+=1)e.push(new Float32Array(128));n.push(e)}return n},Gn=async(e,t,n,r,i,o,s)=>{const a=null===t?128*Math.ceil(e.context.length/128):t.length,c=r.channelCount*r.numberOfInputs,l=i.reduce(((e,t)=>e+t),0),u=0===l?null:n.createBuffer(l,a,n.sampleRate);if(void 0===o)throw new Error("Missing the processor constructor.");const d=gn(e),h=await((e,t)=>{const n=Xt($t,e),r=Mn(t);return Xt(n,r)})(n,e),p=Jn(r.numberOfInputs,r.channelCount),f=Jn(r.numberOfOutputs,i),m=Array.from(e.parameters.keys()).reduce(((e,t)=>({...e,[t]:new Float32Array(128)})),{});for(let v=0;v<a;v+=128){if(r.numberOfInputs>0&&null!==t)for(let e=0;e<r.numberOfInputs;e+=1)for(let n=0;n<r.channelCount;n+=1)$n(t,p[e],n,n,v);void 0!==o.parameterDescriptors&&null!==t&&o.parameterDescriptors.forEach((({name:e},n)=>{$n(t,m,e,c+n,v)}));for(let e=0;e<r.numberOfInputs;e+=1)for(let t=0;t<i[e];t+=1)0===f[e][t].byteLength&&(f[e][t]=new Float32Array(128));try{const e=p.map(((e,t)=>0===d.activeInputs[t].size?[]:e)),t=s(v/n.sampleRate,n.sampleRate,(()=>h.process(e,f,m)));if(null!==u)for(let n=0,o=0;n<r.numberOfOutputs;n+=1){for(let e=0;e<i[n];e+=1)Hn(u,f[n],e,o+e,v);o+=i[n]}if(!t)break}catch(g){e.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return u},Yn={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Kn={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Xn={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Qn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Zn={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},er=e=>{const{port1:t,port2:n}=new MessageChannel;return new Promise((r=>{const i=()=>{n.onmessage=null,t.close(),n.close(),r()};n.onmessage=()=>i();try{t.postMessage(e,[e])}catch{}finally{i()}}))},tr={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},nr=(e,t,n)=>{const r=t[n];if(void 0===r)throw e();return r},rr={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},ir={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},or=()=>new DOMException("","InvalidStateError"),sr=()=>new DOMException("","InvalidAccessError"),ar={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},cr=(e,t,n,r,i,o,s,a,c,l,u)=>{const d=l.length;let h=a;for(let p=0;p<d;p+=1){let a=n[0]*l[p];for(let t=1;t<i;t+=1){const r=h-t&c-1;a+=n[t]*o[r],a-=e[t]*s[r]}for(let e=i;e<r;e+=1)a+=n[e]*o[h-e&c-1];for(let n=i;n<t;n+=1)a-=e[n]*s[h-n&c-1];o[h]=l[p],s[h]=a,h=h+1&c-1,u[p]=a}return h},lr={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},ur=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},dr={numberOfChannels:1},hr=(e,t,n)=>{const r=t[n];void 0!==r&&r!==e[n]&&(e[n]=r)},pr=(e,t)=>{hr(e,t,"channelCount"),hr(e,t,"channelCountMode"),hr(e,t,"channelInterpretation")},fr=e=>"function"===typeof e.getFloatTimeDomainData,mr=(e,t,n)=>{const r=t[n];void 0!==r&&r!==e[n].value&&(e[n].value=r)},gr=e=>{var t;e.start=(t=e.start,(n=0,r=0,i)=>{if("number"===typeof i&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,i)})},vr=e=>{var t;e.stop=(t=e.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})},yr=(e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),br=async(e,t)=>{const n=await(e=>new Promise(((t,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:e})=>{r.close(),i.close(),t(e)},r.onmessageerror=({data:e})=>{r.close(),i.close(),n(e)},i.postMessage(e)})))(t);return new e(n)},wr=(e,t)=>{const n=e.createBiquadFilter();return pr(n,t),mr(n,t,"Q"),mr(n,t,"detune"),mr(n,t,"frequency"),mr(n,t,"gain"),hr(n,t,"type"),n},kr=(e,t)=>{const n=e.createChannelSplitter(t.numberOfOutputs);return pr(n,t),(e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw or()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw or()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw or()}})})(n),n},Sr=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),Tr=(e,t)=>{const n=e.createDelay(t.maxDelayTime);return pr(n,t),mr(n,t,"delayTime"),n},Er=(e,t)=>{const n=e.createGain();return pr(n,t),mr(n,t,"gain"),n};function Cr(e,t){const n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function _r(e,t){return[e[0]*t[0]-e[1]*t[1],e[0]*t[1]+e[1]*t[0]]}function xr(e,t){let n=[0,0];for(let r=e.length-1;r>=0;r-=1)n=_r(n,t),n[0]+=e[r];return n}const Ir=(e,t,n,r)=>e.createScriptProcessor(t,n,r),Rr=()=>new DOMException("","NotSupportedError"),Pr={numberOfChannels:1},Or={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Mr={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Nr={disableNormalization:!1},Ar={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Dr=()=>new DOMException("","UnknownError"),Lr={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Ur=(e,t,n)=>void 0===e.copyFromChannel?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0]),Fr=e=>{if(null===e)return!1;const t=e.length;return t%2!==0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},Br=(e,t,n,r)=>{let i=e;for(;!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,{get:n(o),set:r(s)})},jr=(e,t,n)=>{try{e.setValueAtTime(t,n)}catch(r){if(9!==r.code)throw r;jr(e,t,n+1e-7)}},zr=e=>{const t=e.createOscillator();try{t.start(-1)}catch(n){return n instanceof RangeError}return!1},Vr=e=>{const t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},Wr=e=>{const t=e.createOscillator();try{t.stop(-1)}catch(n){return n instanceof RangeError}return!1},qr=(e,t)=>{const n=t.createGain();e.connect(n);const r=(i=e.disconnect,()=>{i.call(e,n),e.removeEventListener("ended",r)});var i;e.addEventListener("ended",r),Sr(e,n),e.stop=(t=>{let r=!1;return(i=0)=>{if(r)try{t.call(e,i)}catch{n.gain.setValueAtTime(0,i)}else t.call(e,i),r=!0}})(e.stop)},$r=(e,t)=>n=>{const r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),"function"===typeof t?t.call(e,n):t.handleEvent.call(e,n)},Hr=(e=>(t,n,[r,i,o],s)=>{e(t[i],[n,r,o],(e=>e[0]===n&&e[1]===r),s)})(Tn),Jr=(e=>(t,n,[r,i,o],s)=>{const a=t.get(r);void 0===a?t.set(r,new Set([[i,n,o]])):e(a,[i,n,o],(e=>e[0]===i&&e[1]===n),s)})(Tn),Gr=(e=>(t,n,r,i)=>e(t[i],(e=>e[0]===n&&e[1]===r)))(Qt),Yr=new WeakMap,Kr=(e=>t=>{var n;return null!==(n=e.get(t))&&void 0!==n?n:0})(Yr),Xr=(Qr=new Map,Zr=new WeakMap,(e,t)=>{const n=Zr.get(e);if(void 0!==n)return n;const r=Qr.get(e);if(void 0!==r)return r;try{const n=t();return n instanceof Promise?(Qr.set(e,n),n.catch((()=>!1)).then((t=>(Qr.delete(e),Zr.set(e,t),t)))):(Zr.set(e,n),n)}catch{return Zr.set(e,!1),!1}});var Qr,Zr;const ei="undefined"===typeof window?null:window,ti=((e,t)=>(n,r)=>{const i=n.createAnalyser();if(pr(i,r),!(r.maxDecibels>r.minDecibels))throw t();return hr(i,r,"fftSize"),hr(i,r,"maxDecibels"),hr(i,r,"minDecibels"),hr(i,r,"smoothingTimeConstant"),e(fr,(()=>fr(i)))||(e=>{e.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);e.getByteTimeDomainData(n);const r=Math.max(n.length,e.fftSize);for(let e=0;e<r;e+=1)t[e]=.0078125*(n[e]-128);return t}})(i),i})(Xr,ln),ni=(e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(gn),ri=((e,t,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(s.activeInputs.map(((e,s)=>Array.from(e).map((async([e,a])=>{const c=t(e),l=await c.render(e,i),u=r.context.destination;n(e)||r===u&&n(r)||l.connect(o,a,s)})))).reduce(((e,t)=>[...e,...t]),[]))})(gn,ni,An),ii=((e,t,n)=>()=>{const r=new WeakMap;return{render(i,o){const s=r.get(o);return void 0!==s?Promise.resolve(s):(async(i,o)=>{let s=t(i);if(!an(s,o)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,fftSize:s.fftSize,maxDecibels:s.maxDecibels,minDecibels:s.minDecibels,smoothingTimeConstant:s.smoothingTimeConstant};s=e(o,t)}return r.set(o,s),await n(i,o,s),s})(i,o)}}})(ti,Mn,ri),oi=(si=zt,e=>{const t=si.get(e);if(void 0===t)throw or();return t});var si;const ai=(e=>null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null)(ei),ci=(e=>t=>null!==e&&t instanceof e)(ai),li=new WeakMap,ui=(e=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(t,n,r){if(null!==n){let i=this._listeners.get(n);void 0===i&&(i=e(this,n),"function"===typeof n&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(t,i,r)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}})($r),di=(e=>null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null)(ei),hi=(e=>t=>null!==e&&t instanceof e)(di),pi=(e=>t=>null!==e&&"function"===typeof e.AudioNode&&t instanceof e.AudioNode)(ei),fi=(e=>t=>null!==e&&"function"===typeof e.AudioParam&&t instanceof e.AudioParam)(ei),mi=(e=>null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null)(ei),gi=((e,t,n,r,i,o,s,a,c,l,u,d,h,p,f,m)=>class extends l{constructor(t,r,i,o){super(i),this._context=t,this._nativeAudioNode=i;const s=u(t);d(s)&&!0!==n(Ln,(()=>Ln(s,m)))&&Bn(i),Ft.set(this,i),Vt.set(this,new Set),"closed"!==t.state&&r&&tn(this),e(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw i();const l=u(this._context),d=f(l);if(h(e)||p(e))throw o();if(kn(e)){const i=Mn(e);try{const t=xn(this._nativeAudioNode,i,n,a),r=Dn(this);(d||r)&&this._nativeAudioNode.disconnect(...t),"closed"!==this.context.state&&!r&&Dn(e)&&tn(e)}catch(g){if(12===g.code)throw o();throw g}if(t(this,e,n,a,d)){const t=c([this],e);Un(t,r(d))}return e}const m=Nn(e);if("playbackRate"===m.name&&1024===m.maxValue)throw s();try{this._nativeAudioNode.connect(m,n),(d||Dn(this))&&this._nativeAudioNode.disconnect(m,n)}catch(g){if(12===g.code)throw o();throw g}if(jn(this,e,n,d)){const t=c([this],e);Un(t,r(d))}}disconnect(e,t,n){let r;const s=u(this._context),l=f(s);if(void 0===e)r=((e,t)=>{const n=gn(e),r=[];for(const i of n.outputs)Sn(i)?zn(e,t,...i):Vn(e,t,...i),r.push(i[0]);return n.outputs.clear(),r})(this,l);else if("number"===typeof e){if(e<0||e>=this.numberOfOutputs)throw i();r=((e,t,n)=>{const r=gn(e),i=[];for(const o of r.outputs)o[1]===n&&(Sn(o)?zn(e,t,...o):Vn(e,t,...o),i.push(o[0]),r.outputs.delete(o));return i})(this,l,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw i();if(kn(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw i();if(r=((e,t,n,r,i)=>{const o=gn(e);return Array.from(o.outputs).filter((e=>e[0]===n&&(void 0===r||e[1]===r)&&(void 0===i||e[2]===i))).map((n=>(Sn(n)?zn(e,t,...n):Vn(e,t,...n),o.outputs.delete(n),n[0])))})(this,l,e,t,n),0===r.length)throw o()}for(const i of r){const e=c([this],i);Un(e,a)}}})((vi=Ut,(e,t,n)=>{const r=[];for(let i=0;i<n.numberOfInputs;i+=1)r.push(new Set);vi.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),((e,t,n,r,i,o,s,a,c,l,u,d,h)=>{const p=new WeakMap;return(f,m,g,v,y)=>{const{activeInputs:b,passiveInputs:w}=o(m),{outputs:k}=o(f),S=a(f),T=o=>{const a=c(m),l=c(f);if(o){const t=Zt(w,f,g,v);e(b,f,t,!1),y||d(f)||n(l,a,g,v),h(m)&&tn(m)}else{const e=r(b,f,g,v);t(w,v,e,!1),y||d(f)||i(l,a,g,v);const n=s(m);if(0===n)u(m)&&on(m,b);else{const e=p.get(m);void 0!==e&&clearTimeout(e),p.set(m,setTimeout((()=>{u(m)&&on(m,b)}),1e3*n))}}};return!!l(k,[m,g,v],(e=>e[0]===m&&e[1]===g&&e[2]===v),!0)&&(S.add(T),u(f)?e(b,f,[g,v,T],!0):t(w,v,[f,g,T],!0),!0)}})(Hr,Jr,xn,Gr,On,gn,Kr,en,Mn,Tn,fn,An,Dn),Xr,((e,t,n,r,i,o)=>s=>(a,c)=>{const l=e.get(a);if(void 0===l){if(!s&&o(a)){const e=r(a),{outputs:o}=n(a);for(const n of o)if(Sn(n)){const i=r(n[0]);t(e,i,n[1],n[2])}else{const t=i(n[0]);e.disconnect(t,n[1])}}e.set(a,c)}else e.set(a,l+c)})(Wt,On,gn,Mn,Nn,fn),ln,sr,Rr,((e,t,n,r,i,o,s,a)=>(c,l)=>{const u=t.get(c);if(void 0===u)throw new Error("Missing the expected cycle count.");const d=o(c.context),h=a(d);if(u===l){if(t.delete(c),!h&&s(c)){const t=r(c),{outputs:o}=n(c);for(const n of o)if(Sn(n)){const i=r(n[0]);e(t,i,n[1],n[2])}else{const e=i(n[0]);t.connect(e,n[1])}}}else t.set(c,u-l)})(xn,Wt,gn,Mn,Nn,oi,fn,ci),((e,t,n)=>function r(i,o){const s=kn(o)?o:n(e,o);if((e=>"delayTime"in e)(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=t(s);return Array.from(a).map((e=>r([...i,s],e[0]))).reduce(((e,t)=>e.concat(t)),[])})(li,gn,Xt),ui,oi,hi,pi,fi,ci,mi);var vi;const yi=((e,t,n,r,i,o)=>class extends e{constructor(e,n){const s=i(e),a={...sn,...n},c=r(s,a);super(e,!1,c,o(s)?t():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){const t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){const t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}})(gi,ii,ln,ti,oi,ci),bi=new WeakSet,wi=(e=>null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null)(ei),ki=(Si=new Uint32Array(1),e=>(Si[0]=e,Si[0]));var Si;const Ti=((e,t)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=e(o),a=e(i);if(a>=n.numberOfChannels)throw t();const c=n.length,l=n.getChannelData(a),u=r.length;for(let e=s<0?-s:0;e+s<c&&e<u;e+=1)r[e]=l[e+s]},n.copyToChannel=(r,i,o=0)=>{const s=e(o),a=e(i);if(a>=n.numberOfChannels)throw t();const c=n.length,l=n.getChannelData(a),u=r.length;for(let e=s<0?-s:0;e+s<c&&e<u;e+=1)l[e+s]=r[e]}})(ki,ln),Ei=(e=>t=>{t.copyFromChannel=(n=>(r,i,o=0)=>{const s=e(o),a=e(i);if(s<t.length)return n.call(t,r,a,s)})(t.copyFromChannel),t.copyToChannel=(n=>(r,i,o=0)=>{const s=e(o),a=e(i);if(s<t.length)return n.call(t,r,a,s)})(t.copyToChannel)})(ki),Ci=((e,t,n,r,i,o,s,a)=>{let c=null;return class l{constructor(l){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:d,sampleRate:h}={...dn,...l};null===c&&(c=new i(1,1,44100));const p=null!==r&&t(o,o)?new r({length:u,numberOfChannels:d,sampleRate:h}):c.createBuffer(d,u,h);if(0===p.numberOfChannels)throw n();return"function"!==typeof p.copyFromChannel?(s(p),un(p)):t(cn,(()=>cn(p)))||a(p),e.add(p),p}static[Symbol.hasInstance](t){return null!==t&&"object"===typeof t&&Object.getPrototypeOf(t)===l.prototype||e.has(t)}}})(bi,Xr,Rr,wi,ai,(e=>()=>{if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0})(wi),Ti,Ei),_i=(e=>(t,n)=>{const r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(t.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)})(Er),xi=((e,t,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(Array.from(s.activeInputs).map((async([t,r])=>{const s=e(t),a=await s.render(t,i);n(t)||a.connect(o,r)})))})(ni,vn,An),Ii=(e=>(t,n,r)=>e(n,t,r))(xi),Ri=((e,t,n,r,i,o,s,a,c,l,u)=>(d,h)=>{const p=d.createBufferSource();return pr(p,h),mr(p,h,"playbackRate"),hr(p,h,"buffer"),hr(p,h,"loop"),hr(p,h,"loopEnd"),hr(p,h,"loopStart"),t(n,(()=>n(d)))||(e=>{e.start=(t=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw or();t.call(e,r,i,o),n=!0}})(e.start)})(p),t(r,(()=>r(d)))||c(p),t(i,(()=>i(d)))||l(p,d),t(o,(()=>o(d)))||gr(p),t(s,(()=>s(d)))||u(p,d),t(a,(()=>a(d)))||vr(p),e(d,p),p})(_i,Xr,(e=>{const t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1}),(e=>{const t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0}),(e=>{const t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0}),zr,Vr,Wr,(e=>{var t;e.start=(t=e.start,(n=0,r=0,i)=>{const o=e.buffer,s=null===o?r:Math.min(o.duration,r);null!==o&&s>o.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,s,i)})}),(e=>(t,n)=>{const r=n.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=r),e(t,"buffer",(e=>()=>{const n=e.call(t);return n===r?null:n}),(e=>n=>e.call(t,null===n?r:n)))})(Br),qr),Pi=((e,t)=>(n,r,i)=>(e(r).replay(i),t(r,n,i)))((e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(vn),xi),Oi=((e,t,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;return{set start(e){s=e},set stop(e){a=e},render(c,l){const u=o.get(l);return void 0!==u?Promise.resolve(u):(async(c,l)=>{let u=n(c);const d=an(u,l);if(!d){const e={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=t(l,e),null!==s&&u.start(...s),null!==a&&u.stop(a)}return o.set(l,u),d?await e(l,c.playbackRate,u.playbackRate):await r(l,c.playbackRate,u.playbackRate),await i(c,l,u),u})(c,l)}}})(Ii,Ri,Mn,Pi,ri),Mi=((e,t,n,r,i,o,s,a,c,l,u,d,h)=>(p,f,m,g=null,v=null)=>{const y=m.value,b=new Dt.AutomationEventList(y),w=f?r(b):null,k={get defaultValue(){return y},get maxValue(){return null===g?m.maxValue:g},get minValue(){return null===v?m.minValue:v},get value(){return m.value},set value(e){m.value=e,k.setValueAtTime(e,p.context.currentTime)},cancelAndHoldAtTime(e){if("function"===typeof m.cancelAndHoldAtTime)null===w&&b.flush(p.context.currentTime),b.add(i(e)),m.cancelAndHoldAtTime(e);else{const t=Array.from(b).pop();null===w&&b.flush(p.context.currentTime),b.add(i(e));const n=Array.from(b).pop();m.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return k},cancelScheduledValues:e=>(null===w&&b.flush(p.context.currentTime),b.add(o(e)),m.cancelScheduledValues(e),k),exponentialRampToValueAtTime(e,t){if(0===e)throw new RangeError;if(!Number.isFinite(t)||t<0)throw new RangeError;const n=p.context.currentTime;return null===w&&b.flush(n),0===Array.from(b).length&&(b.add(l(y,n)),m.setValueAtTime(y,n)),b.add(s(e,t)),m.exponentialRampToValueAtTime(e,t),k},linearRampToValueAtTime(e,t){const n=p.context.currentTime;return null===w&&b.flush(n),0===Array.from(b).length&&(b.add(l(y,n)),m.setValueAtTime(y,n)),b.add(a(e,t)),m.linearRampToValueAtTime(e,t),k},setTargetAtTime:(e,t,n)=>(null===w&&b.flush(p.context.currentTime),b.add(c(e,t,n)),m.setTargetAtTime(e,t,n),k),setValueAtTime:(e,t)=>(null===w&&b.flush(p.context.currentTime),b.add(l(e,t)),m.setValueAtTime(e,t),k),setValueCurveAtTime(e,t,n){const r=e instanceof Float32Array?e:new Float32Array(e);if(null!==d&&"webkitAudioContext"===d.name){const e=t+n,i=p.context.sampleRate,o=Math.ceil(t*i),s=Math.floor(e*i),a=s-o,c=new Float32Array(a);for(let u=0;u<a;u+=1){const e=(r.length-1)/n*((o+u)/i-t),s=Math.floor(e),a=Math.ceil(e);c[u]=s===a?r[s]:(1-(e-s))*r[s]+(1-(a-e))*r[a]}null===w&&b.flush(p.context.currentTime),b.add(u(c,t,n)),m.setValueCurveAtTime(c,t,n);const l=s/i;l<e&&h(k,c[c.length-1],l),h(k,r[r.length-1],e)}else null===w&&b.flush(p.context.currentTime),b.add(u(r,t,n)),m.setValueCurveAtTime(r,t,n);return k}};return n.set(k,m),t.set(k,p),e(k,w),k})((Ni=Bt,(e,t)=>{Ni.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),li,jt,(e=>({replay(t){for(const n of e)if("exponentialRampToValue"===n.type){const{endTime:e,value:r}=n;t.exponentialRampToValueAtTime(r,e)}else if("linearRampToValue"===n.type){const{endTime:e,value:r}=n;t.linearRampToValueAtTime(r,e)}else if("setTarget"===n.type){const{startTime:e,target:r,timeConstant:i}=n;t.setTargetAtTime(r,e,i)}else if("setValue"===n.type){const{startTime:e,value:r}=n;t.setValueAtTime(r,e)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:e,startTime:r,values:i}=n;t.setValueCurveAtTime(i,r,e)}}}})),Dt.createCancelAndHoldAutomationEvent,Dt.createCancelScheduledValuesAutomationEvent,Dt.createExponentialRampToValueAutomationEvent,Dt.createLinearRampToValueAutomationEvent,Dt.createSetTargetAutomationEvent,Dt.createSetValueAutomationEvent,Dt.createSetValueCurveAutomationEvent,di,jr);var Ni;const Ai=((e,t,n,r,i,o,s,a)=>class extends e{constructor(e,r){const a=o(e),c={...mn,...r},l=i(a,c),u=s(a),d=u?t():null;super(e,!1,l,d),this._audioBufferSourceNodeRenderer=d,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=l,this._onended=null,this._playbackRate=n(this,u,l.playbackRate,pn,hn)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){const t="function"===typeof e?a(this,e):null;this._nativeAudioBufferSourceNode.onended=t;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}get playbackRate(){return this._playbackRate}start(e=0,t=0,n){if(this._nativeAudioBufferSourceNode.start(e,t,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[e,t]:[e,t,n]),"closed"!==this.context.state){tn(this);const e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),fn(this)&&rn(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}})(gi,Oi,Mi,or,Ri,oi,ci,$r),Di=((e,t,n,r,i,o,s,a)=>class extends e{constructor(e,n){const r=o(e),c=s(r),l=i(r,n,c);super(e,!1,l,c?t(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=l}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(gi,(e=>{const t=new WeakMap;return{render(n,r){const i=t.get(r);return void 0!==i?Promise.resolve(i):(async(n,r)=>{const i=r.destination;return t.set(r,i),await e(n,r,i),i})(n,r)}}}),ln,or,((e,t)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=e(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return t(s,"channelCount",(e=>()=>e.call(s)),(e=>t=>{e.call(s,t);try{o.channelCount=t}catch(n){if(t>o.maxChannelCount)throw n}})),t(s,"channelCountMode",(e=>()=>e.call(s)),(e=>t=>{e.call(s,t),o.channelCountMode=t})),t(s,"channelInterpretation",(e=>()=>e.call(s)),(e=>t=>{e.call(s,t),o.channelInterpretation=t})),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s})(Er,Br),oi,ci,ri),Li=((e,t,n,r,i)=>()=>{const o=new WeakMap;return{render(s,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(s,a)=>{let c=n(s);const l=an(c,a);if(!l){const e={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=t(a,e)}return o.set(a,c),l?(await e(a,s.Q,c.Q),await e(a,s.detune,c.detune),await e(a,s.frequency,c.frequency),await e(a,s.gain,c.gain)):(await r(a,s.Q,c.Q),await r(a,s.detune,c.detune),await r(a,s.frequency,c.frequency),await r(a,s.gain,c.gain)),await i(s,a,c),c})(s,a)}}})(Ii,wr,Mn,Pi,ri),Ui=(e=>(t,n)=>e.set(t,n))(Yr),Fi=((e,t,n,r,i,o,s,a)=>class extends e{constructor(e,r){const c=o(e),l={...Yn,...r},u=i(c,l),d=s(c);super(e,!1,u,d?n():null),this._Q=t(this,d,u.Q,pn,hn),this._detune=t(this,d,u.detune,1200*Math.log2(pn),-1200*Math.log2(pn)),this._frequency=t(this,d,u.frequency,e.sampleRate/2,0),this._gain=t(this,d,u.gain,40*Math.log10(pn),hn),this._nativeBiquadFilterNode=u,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n)}catch(i){if(11===i.code)throw r();throw i}if(e.length!==t.length||t.length!==n.length)throw r()}})(gi,Mi,Li,sr,wr,oi,ci,Ui),Bi=((e,t)=>(n,r,i)=>{const o=new Set;var s,a;return n.connect=(s=n.connect,(i,a=0,c=0)=>{const l=0===o.size;if(t(i))return s.call(n,i,a,c),e(o,[i,a,c],(e=>e[0]===i&&e[1]===a&&e[2]===c),!0),l&&r(),i;s.call(n,i,a),e(o,[i,a],(e=>e[0]===i&&e[1]===a),!0),l&&r()}),n.disconnect=(a=n.disconnect,(e,r,s)=>{const c=o.size>0;if(void 0===e)a.apply(n),o.clear();else if("number"===typeof e){a.call(n,e);for(const t of o)t[1]===e&&o.delete(t)}else{t(e)?a.call(n,e,r,s):a.call(n,e,r);for(const t of o)t[0]!==e||void 0!==r&&t[1]!==r||void 0!==s&&t[2]!==s||o.delete(t)}const l=0===o.size;c&&l&&i()}),n})(Tn,pi),ji=((e,t)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const i=n.createBufferSource();t(r,(()=>{const e=r.numberOfInputs;for(let t=0;t<e;t+=1)i.connect(r,0,t)}),(()=>i.disconnect(r)))})(or,Bi),zi=((e,t)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return null!==e&&"webkitAudioContext"===e.name&&t(n,i),pr(i,r),i})(di,ji),Vi=((e,t,n)=>()=>{const r=new WeakMap;return{render(i,o){const s=r.get(o);return void 0!==s?Promise.resolve(s):(async(i,o)=>{let s=t(i);if(!an(s,o)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfInputs:s.numberOfInputs};s=e(o,t)}return r.set(o,s),await n(i,o,s),s})(i,o)}}})(zi,Mn,ri),Wi=((e,t,n,r,i)=>class extends e{constructor(e,o){const s=r(e),a={...Kn,...o};super(e,!1,n(s,a),i(s)?t():null)}})(gi,Vi,zi,oi,ci),qi=((e,t,n)=>()=>{const r=new WeakMap;return{render(i,o){const s=r.get(o);return void 0!==s?Promise.resolve(s):(async(i,o)=>{let s=t(i);if(!an(s,o)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfOutputs:s.numberOfOutputs};s=e(o,t)}return r.set(o,s),await n(i,o,s),s})(i,o)}}})(kr,Mn,ri),$i=((e,t,n,r,i,o)=>class extends e{constructor(e,s){const a=r(e),c=o({...Xn,...s});super(e,!1,n(a,c),i(a)?t():null)}})(gi,qi,kr,oi,ci,(e=>({...e,channelCount:e.numberOfOutputs}))),Hi=((e,t,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),c=t(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){l.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){l.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){l.channelInterpretation=e},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(e){c.onended=e},addEventListener:(...e)=>c.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>c.dispatchEvent(e[0]),removeEventListener:(...e)=>c.removeEventListener(e[0],e[1],e[2]),start(e=0){c.start.call(c,e)},stop(e=0){c.stop.call(c,e)}};return e(i,c),r(Sr(d,l),(()=>c.connect(l)),(()=>c.disconnect(l)))})(_i,Ri,Er,Bi),Ji=((e,t,n,r,i)=>(o,s)=>{if(void 0===o.createConstantSource)return n(o,s);const a=o.createConstantSource();return pr(a,s),mr(a,s,"offset"),t(r,(()=>r(o)))||gr(a),t(i,(()=>i(o)))||vr(a),e(o,a),a})(_i,Xr,Hi,zr,Wr),Gi=((e,t,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;return{set start(e){s=e},set stop(e){a=e},render(c,l){const u=o.get(l);return void 0!==u?Promise.resolve(u):(async(c,l)=>{let u=n(c);const d=an(u,l);if(!d){const e={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=t(l,e),null!==s&&u.start(s),null!==a&&u.stop(a)}return o.set(l,u),d?await e(l,c.offset,u.offset):await r(l,c.offset,u.offset),await i(c,l,u),u})(c,l)}}})(Ii,Ji,Mn,Pi,ri),Yi=((e,t,n,r,i,o,s)=>class extends e{constructor(e,s){const a=i(e),c={...Qn,...s},l=r(a,c),u=o(a),d=u?n():null;super(e,!1,l,d),this._constantSourceNodeRenderer=d,this._nativeConstantSourceNode=l,this._offset=t(this,u,l.offset,pn,hn),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){const t="function"===typeof e?s(this,e):null;this._nativeConstantSourceNode.onended=t;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){tn(this);const e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),fn(this)&&rn(this)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}})(gi,Mi,Gi,Ji,oi,ci,$r),Ki=((e,t)=>(n,r)=>{const i=n.createConvolver();if(pr(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),hr(i,r,"buffer"),r.channelCount>2)throw e();if(t(i,"channelCount",(e=>()=>e.call(i)),(t=>n=>{if(n>2)throw e();return t.call(i,n)})),"max"===r.channelCountMode)throw e();return t(i,"channelCountMode",(e=>()=>e.call(i)),(t=>n=>{if("max"===n)throw e();return t.call(i,n)})),i})(Rr,Br),Xi=((e,t,n)=>()=>{const r=new WeakMap;return{render(i,o){const s=r.get(o);return void 0!==s?Promise.resolve(s):(async(i,o)=>{let s=t(i);if(!an(s,o)){const t={buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,disableNormalization:!s.normalize};s=e(o,t)}return r.set(o,s),_n(s)?await n(i,o,s.inputs[0]):await n(i,o,s),s})(i,o)}}})(Ki,Mn,ri),Qi=((e,t,n,r,i,o)=>class extends e{constructor(e,s){const a=r(e),c={...Zn,...s},l=n(a,c);super(e,!1,l,i(a)?t():null),this._isBufferNullified=!1,this._nativeConvolverNode=l,null!==c.buffer&&o(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){const e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,e.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}})(gi,Xi,Ki,oi,ci,Ui),Zi=((e,t,n,r,i)=>o=>{const s=new WeakMap;return{render(a,c){const l=s.get(c);return void 0!==l?Promise.resolve(l):(async(a,c)=>{let l=n(a);const u=an(l,c);if(!u){const e={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:o};l=t(c,e)}return s.set(c,l),u?await e(c,a.delayTime,l.delayTime):await r(c,a.delayTime,l.delayTime),await i(a,c,l),l})(a,c)}}})(Ii,Tr,Mn,Pi,ri),eo=((e,t,n,r,i,o,s)=>class extends e{constructor(e,a){const c=i(e),l={...tr,...a},u=r(c,l),d=o(c);super(e,!1,u,d?n(l.maxDelayTime):null),this._delayTime=t(this,d,u.delayTime),s(this,l.maxDelayTime)}get delayTime(){return this._delayTime}})(gi,Mi,Zi,Tr,oi,ci,Ui),to=(e=>(t,n)=>{const r=t.createDynamicsCompressor();if(pr(r,n),n.channelCount>2)throw e();if("max"===n.channelCountMode)throw e();return mr(r,n,"attack"),mr(r,n,"knee"),mr(r,n,"ratio"),mr(r,n,"release"),mr(r,n,"threshold"),r})(Rr),no=((e,t,n,r,i)=>()=>{const o=new WeakMap;return{render(s,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(s,a)=>{let c=n(s);const l=an(c,a);if(!l){const e={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=t(a,e)}return o.set(a,c),l?(await e(a,s.attack,c.attack),await e(a,s.knee,c.knee),await e(a,s.ratio,c.ratio),await e(a,s.release,c.release),await e(a,s.threshold,c.threshold)):(await r(a,s.attack,c.attack),await r(a,s.knee,c.knee),await r(a,s.ratio,c.ratio),await r(a,s.release,c.release),await r(a,s.threshold,c.threshold)),await i(s,a,c),c})(s,a)}}})(Ii,to,Mn,Pi,ri),ro=((e,t,n,r,i,o,s,a)=>class extends e{constructor(e,i){const c=o(e),l={...rr,...i},u=r(c,l),d=s(c);super(e,!1,u,d?n():null),this._attack=t(this,d,u.attack),this._knee=t(this,d,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=t(this,d,u.ratio),this._release=t(this,d,u.release),this._threshold=t(this,d,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){const t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){const t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"===typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(gi,Mi,no,to,Rr,oi,ci,Ui),io=((e,t,n,r,i)=>()=>{const o=new WeakMap;return{render(s,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(s,a)=>{let c=n(s);const l=an(c,a);if(!l){const e={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=t(a,e)}return o.set(a,c),l?await e(a,s.gain,c.gain):await r(a,s.gain,c.gain),await i(s,a,c),c})(s,a)}}})(Ii,Er,Mn,Pi,ri),oo=((e,t,n,r,i,o)=>class extends e{constructor(e,s){const a=i(e),c={...ir,...s},l=r(a,c),u=o(a);super(e,!1,l,u?n():null),this._gain=t(this,u,l.gain,pn,hn)}get gain(){return this._gain}})(gi,Mi,io,Er,oi,ci),so=((e,t,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=yr(o,i.sampleRate),h=l instanceof Float64Array?l:new Float64Array(l),p=u instanceof Float64Array?u:new Float64Array(u),f=h.length,m=p.length,g=Math.min(f,m);if(0===f||f>20)throw r();if(0===h[0])throw t();if(0===m||m>20)throw r();if(0===p[0])throw t();if(1!==h[0]){for(let e=0;e<m;e+=1)p[e]/=h[0];for(let e=1;e<f;e+=1)h[e]/=h[0]}const v=n(i,d,s,s);v.channelCount=s,v.channelCountMode=a,v.channelInterpretation=c;const y=[],b=[],w=[];for(let e=0;e<s;e+=1){y.push(0);const e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),b.push(e),w.push(t)}v.onaudioprocess=e=>{const t=e.inputBuffer,n=e.outputBuffer,r=t.numberOfChannels;for(let i=0;i<r;i+=1){const e=t.getChannelData(i),r=n.getChannelData(i);y[i]=cr(h,f,p,m,g,b[i],w[i],y[i],32,e,r)}};const k=i.sampleRate/2;return Sr({get bufferSize(){return d},get channelCount(){return v.channelCount},set channelCount(e){v.channelCount=e},get channelCountMode(){return v.channelCountMode},set channelCountMode(e){v.channelCountMode=e},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(e){v.channelInterpretation=e},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener:(...e)=>v.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>v.dispatchEvent(e[0]),getFrequencyResponse(t,n,r){if(t.length!==n.length||n.length!==r.length)throw e();const i=t.length;for(let e=0;e<i;e+=1){const i=-Math.PI*(t[e]/k),o=[Math.cos(i),Math.sin(i)],s=Cr(xr(p,o),xr(h,o));n[e]=Math.sqrt(s[0]*s[0]+s[1]*s[1]),r[e]=Math.atan2(s[1],s[0])}},removeEventListener:(...e)=>v.removeEventListener(e[0],e[1],e[2])},v)})(sr,or,Ir,Rr),ao=((e,t,n,r)=>i=>e(ur,(()=>ur(i)))?Promise.resolve(e(r,r)).then((e=>{if(!e){const e=n(i,512,0,1);i.oncomplete=()=>{e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=()=>i.currentTime,e.connect(i.destination)}return i.startRendering()})):new Promise((e=>{const n=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=t=>{n.disconnect(),e(t.renderedBuffer)},n.connect(i.destination),i.startRendering()})))(Xr,Er,Ir,((e,t)=>()=>{if(null===t)return Promise.resolve(!1);const n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((e=>{n.oncomplete=()=>{r.disconnect(),e(0!==n.currentTime)},n.startRendering()}))})(Er,ai)),co=((e,t,n,r,i)=>(o,s)=>{const a=new WeakMap;let c=null;const l=async(l,u)=>{let d=null,h=t(l);const p=an(h,u);if(void 0===u.createIIRFilter?d=e(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=u.createIIRFilter(s,o)),a.set(u,null===d?h:d),null!==d){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new n(l.context.destination.channelCount,l.context.length,u.sampleRate);c=(async()=>{await r(l,e,e.destination);return((e,t,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,c=Math.min(s,a);if(1!==i[0]){for(let e=0;e<s;e+=1)o[e]/=i[0];for(let e=1;e<a;e+=1)i[e]/=i[0]}const l=new Float32Array(32),u=new Float32Array(32),d=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),h=e.numberOfChannels;for(let p=0;p<h;p+=1){const t=e.getChannelData(p),n=d.getChannelData(p);l.fill(0),u.fill(0),cr(i,s,o,a,c,l,u,0,32,t,n)}return d})(await i(e),u,o,s)})()}const e=await c;return d.buffer=e,d.start(0),d}return await r(l,u,h),h};return{render(e,t){const n=a.get(t);return void 0!==n?Promise.resolve(n):l(e,t)}}})(Ri,Mn,ai,ri,ao),lo=(e=>(t,n,r)=>{if(void 0===t.createIIRFilter)return e(t,n,r);const i=t.createIIRFilter(r.feedforward,r.feedback);return pr(i,r),i})(so),uo=((e,t,n,r,i,o)=>class extends e{constructor(e,s){const a=r(e),c=i(a),l={...ar,...s},u=t(a,c?null:e.baseLatency,l);super(e,!1,u,c?n(l.feedback,l.feedforward):null),(e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw sr();return t.call(e,n,r,i)})})(u),this._nativeIIRFilterNode=u,o(this,1)}getFrequencyResponse(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}})(gi,lo,co,oi,ci,Ui),ho=((e,t,n,r,i,o,s,a)=>(c,l)=>{const u=l.listener,{forwardX:d,forwardY:h,forwardZ:p,positionX:f,positionY:m,positionZ:g,upX:v,upY:y,upZ:b}=void 0===u.forwardX?(()=>{const d=new Float32Array(1),h=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=s(l);let f=!1,m=[0,0,-1,0,1,0],g=[0,0,0];const v=()=>{if(f)return;f=!0;const e=r(l,256,9,0);e.onaudioprocess=({inputBuffer:e})=>{const t=[o(e,d,0),o(e,d,1),o(e,d,2),o(e,d,3),o(e,d,4),o(e,d,5)];t.some(((e,t)=>e!==m[t]))&&(u.setOrientation(...t),m=t);const n=[o(e,d,6),o(e,d,7),o(e,d,8)];n.some(((e,t)=>e!==g[t]))&&(u.setPosition(...n),g=n)},h.connect(e)},y=e=>t=>{t!==m[e]&&(m[e]=t,u.setOrientation(...m))},b=e=>t=>{t!==g[e]&&(g[e]=t,u.setPosition(...g))},w=(t,r,o)=>{const s=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:r});s.connect(h,0,t),s.start(),Object.defineProperty(s.offset,"defaultValue",{get:()=>r});const u=e({context:c},p,s.offset,pn,hn);var d,f,m,g,y,b,w;return a(u,"value",(e=>()=>e.call(u)),(e=>t=>{try{e.call(u,t)}catch(n){if(9!==n.code)throw n}v(),p&&o(t)})),u.cancelAndHoldAtTime=(d=u.cancelAndHoldAtTime,p?()=>{throw i()}:(...e)=>{const t=d.apply(u,e);return v(),t}),u.cancelScheduledValues=(f=u.cancelScheduledValues,p?()=>{throw i()}:(...e)=>{const t=f.apply(u,e);return v(),t}),u.exponentialRampToValueAtTime=(m=u.exponentialRampToValueAtTime,p?()=>{throw i()}:(...e)=>{const t=m.apply(u,e);return v(),t}),u.linearRampToValueAtTime=(g=u.linearRampToValueAtTime,p?()=>{throw i()}:(...e)=>{const t=g.apply(u,e);return v(),t}),u.setTargetAtTime=(y=u.setTargetAtTime,p?()=>{throw i()}:(...e)=>{const t=y.apply(u,e);return v(),t}),u.setValueAtTime=(b=u.setValueAtTime,p?()=>{throw i()}:(...e)=>{const t=b.apply(u,e);return v(),t}),u.setValueCurveAtTime=(w=u.setValueCurveAtTime,p?()=>{throw i()}:(...e)=>{const t=w.apply(u,e);return v(),t}),u};return{forwardX:w(0,0,y(0)),forwardY:w(1,0,y(1)),forwardZ:w(2,-1,y(2)),positionX:w(6,0,b(0)),positionY:w(7,0,b(1)),positionZ:w(8,0,b(2)),upX:w(3,0,y(3)),upY:w(4,1,y(4)),upZ:w(5,0,y(5))}})():u;return{get forwardX(){return d},get forwardY(){return h},get forwardZ(){return p},get positionX(){return f},get positionY(){return m},get positionZ(){return g},get upX(){return v},get upY(){return y},get upZ(){return b}}})(Mi,zi,Ji,Ir,Rr,Ur,ci,Br),po=new WeakMap,fo=((e,t,n,r,i,o)=>class extends n{constructor(n,o){super(n),this._nativeContext=n,zt.set(this,n),r(n)&&i.set(n,new Set),this._destination=new e(this,o),this._listener=t(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){const t="function"===typeof e?o(this,e):null;this._nativeContext.onstatechange=t;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Di,ho,ui,ci,po,$r),mo=((e,t,n,r,i,o)=>(s,a)=>{const c=s.createOscillator();return pr(c,a),mr(c,a,"detune"),mr(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):hr(c,a,"type"),t(n,(()=>n(s)))||gr(c),t(r,(()=>r(s)))||o(c,s),t(i,(()=>i(s)))||vr(c),e(s,c),c})(_i,Xr,zr,Vr,Wr,qr),go=((e,t,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,c=null;return{set periodicWave(e){s=e},set start(e){a=e},set stop(e){c=e},render(l,u){const d=o.get(u);return void 0!==d?Promise.resolve(d):(async(l,u)=>{let d=n(l);const h=an(d,u);if(!h){const e={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===s?void 0:s,type:d.type};d=t(u,e),null!==a&&d.start(a),null!==c&&d.stop(c)}return o.set(u,d),h?(await e(u,l.detune,d.detune),await e(u,l.frequency,d.frequency)):(await r(u,l.detune,d.detune),await r(u,l.frequency,d.frequency)),await i(l,u,d),d})(l,u)}}})(Ii,mo,Mn,Pi,ri),vo=((e,t,n,r,i,o,s)=>class extends e{constructor(e,s){const a=i(e),c={...Or,...s},l=n(a,c),u=o(a),d=u?r():null,h=e.sampleRate/2;super(e,!1,l,d),this._detune=t(this,u,l.detune,153600,-153600),this._frequency=t(this,u,l.frequency,h,-h),this._nativeOscillatorNode=l,this._onended=null,this._oscillatorNodeRenderer=d,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){const t="function"===typeof e?s(this,e):null;this._nativeOscillatorNode.onended=t;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}get type(){return this._nativeOscillatorNode.type}set type(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){tn(this);const e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),fn(this)&&rn(this)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}})(gi,Mi,mo,go,oi,ci,$r),yo=(e=>(t,n)=>{const r=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}})(Ri),bo=((e,t,n,r,i)=>(o,{curve:s,oversample:a,...c})=>{const l=o.createWaveShaper(),u=o.createWaveShaper();pr(l,c),pr(u,c);const d=n(o,{...c,gain:1}),h=n(o,{...c,gain:-1}),p=n(o,{...c,gain:1}),f=n(o,{...c,gain:-1});let m=null,g=!1,v=null;const y={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){d.channelCount=e,h.channelCount=e,l.channelCount=e,p.channelCount=e,u.channelCount=e,f.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){d.channelCountMode=e,h.channelCountMode=e,l.channelCountMode=e,p.channelCountMode=e,u.channelCountMode=e,f.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){d.channelInterpretation=e,h.channelInterpretation=e,l.channelInterpretation=e,p.channelInterpretation=e,u.channelInterpretation=e,f.channelInterpretation=e},get context(){return l.context},get curve(){return v},set curve(n){if(null!==n&&n.length<2)throw t();if(null===n)l.curve=n,u.curve=n;else{const e=n.length,t=new Float32Array(e+2-e%2),r=new Float32Array(e+2-e%2);t[0]=n[0],r[0]=-n[e-1];const i=Math.ceil((e+1)/2),o=(e+1)/2-1;for(let s=1;s<i;s+=1){const a=s/i*o,c=Math.floor(a),l=Math.ceil(a);t[s]=c===l?n[c]:(1-(a-c))*n[c]+(1-(l-a))*n[l],r[s]=c===l?-n[e-1-c]:-(1-(a-c))*n[e-1-c]-(1-(l-a))*n[e-1-l]}t[i]=e%2===1?n[i-1]:(n[i-2]+n[i-1])/2,l.curve=t,u.curve=r}v=n,g&&(r(v)&&null===m?m=e(o,d):null!==m&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(e){l.oversample=e,u.oversample=e},addEventListener:(...e)=>d.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>d.dispatchEvent(e[0]),removeEventListener:(...e)=>d.removeEventListener(e[0],e[1],e[2])};null!==s&&(y.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==y.oversample&&(y.oversample=a);return i(Sr(y,p),(()=>{d.connect(l).connect(p),d.connect(h).connect(u).connect(f).connect(p),g=!0,r(v)&&(m=e(o,d))}),(()=>{d.disconnect(l),l.disconnect(p),d.disconnect(h),h.disconnect(u),u.disconnect(f),f.disconnect(p),g=!1,null!==m&&(m(),m=null)}))})(yo,or,Er,Fr,Bi),wo=((e,t,n,r,i,o,s)=>(a,c)=>{const l=a.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name&&void 0===a.createGain().gain.automationRate)return n(a,c);pr(l,c);const u=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==u&&u.length<2)throw t();hr(l,{curve:u},"curve"),hr(l,c,"oversample");let d=null,h=!1;s(l,"curve",(e=>()=>e.call(l)),(t=>n=>(t.call(l,n),h&&(r(n)&&null===d?d=e(a,l):r(n)||null===d||(d(),d=null)),n)));return i(l,(()=>{h=!0,r(l.curve)&&(d=e(a,l))}),(()=>{h=!1,null!==d&&(d(),d=null)}))})(yo,or,bo,Fr,Bi,di,Br),ko=((e,t,n,r,i,o,s,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:h,coneOuterGain:p,distanceModel:f,maxDistance:m,orientationX:g,orientationY:v,orientationZ:y,panningModel:b,positionX:w,positionY:k,positionZ:S,refDistance:T,rolloffFactor:E,...C})=>{const _=u.createPanner();if(C.channelCount>2)throw s();if("max"===C.channelCountMode)throw s();pr(_,C);const x={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},I=n(u,{...x,channelInterpretation:"speakers",numberOfInputs:6}),R=r(u,{...C,gain:1}),P=r(u,{...x,gain:1}),O=r(u,{...x,gain:0}),M=r(u,{...x,gain:0}),N=r(u,{...x,gain:0}),A=r(u,{...x,gain:0}),D=r(u,{...x,gain:0}),L=i(u,256,6,1),U=o(u,{...x,curve:new Float32Array([1,1]),oversample:"none"});let F=[g,v,y],B=[w,k,S];const j=new Float32Array(1);L.onaudioprocess=({inputBuffer:e})=>{const t=[c(e,j,0),c(e,j,1),c(e,j,2)];t.some(((e,t)=>e!==F[t]))&&(_.setOrientation(...t),F=t);const n=[c(e,j,3),c(e,j,4),c(e,j,5)];n.some(((e,t)=>e!==B[t]))&&(_.setPosition(...n),B=n)},Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0});const z={get bufferSize(){},get channelCount(){return _.channelCount},set channelCount(e){if(e>2)throw s();R.channelCount=e,_.channelCount=e},get channelCountMode(){return _.channelCountMode},set channelCountMode(e){if("max"===e)throw s();R.channelCountMode=e,_.channelCountMode=e},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(e){R.channelInterpretation=e,_.channelInterpretation=e},get coneInnerAngle(){return _.coneInnerAngle},set coneInnerAngle(e){_.coneInnerAngle=e},get coneOuterAngle(){return _.coneOuterAngle},set coneOuterAngle(e){_.coneOuterAngle=e},get coneOuterGain(){return _.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();_.coneOuterGain=e},get context(){return _.context},get distanceModel(){return _.distanceModel},set distanceModel(e){_.distanceModel=e},get inputs(){return[R]},get maxDistance(){return _.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;_.maxDistance=e},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get orientationX(){return P.gain},get orientationY(){return O.gain},get orientationZ(){return M.gain},get panningModel(){return _.panningModel},set panningModel(e){_.panningModel=e},get positionX(){return N.gain},get positionY(){return A.gain},get positionZ(){return D.gain},get refDistance(){return _.refDistance},set refDistance(e){if(e<0)throw new RangeError;_.refDistance=e},get rolloffFactor(){return _.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;_.rolloffFactor=e},addEventListener:(...e)=>R.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>R.dispatchEvent(e[0]),removeEventListener:(...e)=>R.removeEventListener(e[0],e[1],e[2])};d!==z.coneInnerAngle&&(z.coneInnerAngle=d),h!==z.coneOuterAngle&&(z.coneOuterAngle=h),p!==z.coneOuterGain&&(z.coneOuterGain=p),f!==z.distanceModel&&(z.distanceModel=f),m!==z.maxDistance&&(z.maxDistance=m),g!==z.orientationX.value&&(z.orientationX.value=g),v!==z.orientationY.value&&(z.orientationY.value=v),y!==z.orientationZ.value&&(z.orientationZ.value=y),b!==z.panningModel&&(z.panningModel=b),w!==z.positionX.value&&(z.positionX.value=w),k!==z.positionY.value&&(z.positionY.value=k),S!==z.positionZ.value&&(z.positionZ.value=S),T!==z.refDistance&&(z.refDistance=T),E!==z.rolloffFactor&&(z.rolloffFactor=E),1===F[0]&&0===F[1]&&0===F[2]||_.setOrientation(...F),0===B[0]&&0===B[1]&&0===B[2]||_.setPosition(...B);return l(Sr(z,_),(()=>{R.connect(_),e(R,U,0,0),U.connect(P).connect(I,0,0),U.connect(O).connect(I,0,1),U.connect(M).connect(I,0,2),U.connect(N).connect(I,0,3),U.connect(A).connect(I,0,4),U.connect(D).connect(I,0,5),I.connect(L).connect(u.destination)}),(()=>{R.disconnect(_),a(R,U,0,0),U.disconnect(P),P.disconnect(I),U.disconnect(O),O.disconnect(I),U.disconnect(M),M.disconnect(I),U.disconnect(N),N.disconnect(I),U.disconnect(A),A.disconnect(I),U.disconnect(D),D.disconnect(I),I.disconnect(L),L.disconnect(u.destination)}))})(xn,or,zi,Er,Ir,wo,Rr,On,Ur,Bi),So=(e=>(t,n)=>{const r=t.createPanner();return void 0===r.orientationX?e(t,n):(pr(r,n),mr(r,n,"orientationX"),mr(r,n,"orientationY"),mr(r,n,"orientationZ"),mr(r,n,"positionX"),mr(r,n,"positionY"),mr(r,n,"positionZ"),hr(r,n,"coneInnerAngle"),hr(r,n,"coneOuterAngle"),hr(r,n,"coneOuterGain"),hr(r,n,"distanceModel"),hr(r,n,"maxDistance"),hr(r,n,"panningModel"),hr(r,n,"refDistance"),hr(r,n,"rolloffFactor"),r)})(ko),To=((e,t,n,r,i,o,s,a,c,l)=>()=>{const u=new WeakMap;let d=null;return{render(h,p){const f=u.get(p);return void 0!==f?Promise.resolve(f):(async(h,p)=>{let f=null,m=o(h);const g={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},v={...g,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},y=an(m,p);if("bufferSize"in m)f=r(p,{...g,gain:1});else if(!y){const e={...v,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=i(p,e)}if(u.set(p,null===f?m:f),null!==f){if(null===d){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new s(6,h.context.length,p.sampleRate),r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});r.connect(e.destination),d=(async()=>{const t=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map((async(t,r)=>{const i=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0});return await a(e,t,i.offset),i})));for(let e=0;e<6;e+=1)t[e].connect(r,0,e),t[e].start(0);return l(e)})()}const e=await d,o=r(p,{...g,gain:1});await c(h,p,o);const u=[];for(let t=0;t<e.numberOfChannels;t+=1)u.push(e.getChannelData(t));let m=[u[0][0],u[1][0],u[2][0]],y=[u[3][0],u[4][0],u[5][0]],b=r(p,{...g,gain:1}),w=i(p,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]});o.connect(b).connect(w.inputs[0]),w.connect(f);for(let t=128;t<e.length;t+=128){const e=[u[0][t],u[1][t],u[2][t]],n=[u[3][t],u[4][t],u[5][t]];if(e.some(((e,t)=>e!==m[t]))||n.some(((e,t)=>e!==y[t]))){m=e,y=n;const s=t/p.sampleRate;b.gain.setValueAtTime(0,s),b=r(p,{...g,gain:0}),w=i(p,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),b.gain.setValueAtTime(1,s),o.connect(b).connect(w.inputs[0]),w.connect(f)}}return f}return y?(await e(p,h.orientationX,m.orientationX),await e(p,h.orientationY,m.orientationY),await e(p,h.orientationZ,m.orientationZ),await e(p,h.positionX,m.positionX),await e(p,h.positionY,m.positionY),await e(p,h.positionZ,m.positionZ)):(await a(p,h.orientationX,m.orientationX),await a(p,h.orientationY,m.orientationY),await a(p,h.orientationZ,m.orientationZ),await a(p,h.positionX,m.positionX),await a(p,h.positionY,m.positionY),await a(p,h.positionZ,m.positionZ)),_n(m)?await c(h,p,m.inputs[0]):await c(h,p,m),m})(h,p)}}})(Ii,zi,Ji,Er,So,Mn,ai,Pi,ri,ao),Eo=((e,t,n,r,i,o,s)=>class extends e{constructor(e,a){const c=i(e),l={...Mr,...a},u=n(c,l),d=o(c);super(e,!1,u,d?r():null),this._nativePannerNode=u,this._orientationX=t(this,d,u.orientationX,pn,hn),this._orientationY=t(this,d,u.orientationY,pn,hn),this._orientationZ=t(this,d,u.orientationZ,pn,hn),this._positionX=t(this,d,u.positionX,pn,hn),this._positionY=t(this,d,u.positionY,pn,hn),this._positionZ=t(this,d,u.positionZ,pn,hn),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}})(gi,Mi,So,To,oi,ci,Ui),Co=(e=>(t,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=t.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw e();return a})(ln),_o=((e,t,n,r)=>class i{constructor(i,o){const s=t(i),a=r({...Nr,...o}),c=e(s,a);return n.add(c),c}static[Symbol.hasInstance](e){return null!==e&&"object"===typeof e&&Object.getPrototypeOf(e)===i.prototype||n.has(e)}})(Co,oi,new WeakSet,(e=>{const{imag:t,real:n}=e;return void 0===t?void 0===n?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...e,imag:t,real:Array.from(t,(()=>0))}:{...e,imag:t,real:n}})),xo=((e,t,n,r,i,o)=>{const s=16385,a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(e,o,d,h,p)=>{if(1===o)return((e,t,i,o)=>{const d=new Float32Array(s),h=new Float32Array(s);for(let n=0;n<s;n+=1){const e=n/16384*c;d[n]=Math.cos(e),h[n]=Math.sin(e)}const p=n(e,{...l,gain:0}),f=r(e,{...u,curve:d}),m=r(e,{...u,curve:a}),g=n(e,{...l,gain:0}),v=r(e,{...u,curve:h});return{connectGraph(){t.connect(p),t.connect(void 0===m.inputs?m:m.inputs[0]),t.connect(g),m.connect(i),i.connect(void 0===f.inputs?f:f.inputs[0]),i.connect(void 0===v.inputs?v:v.inputs[0]),f.connect(p.gain),v.connect(g.gain),p.connect(o,0,0),g.connect(o,0,1)},disconnectGraph(){t.disconnect(p),t.disconnect(void 0===m.inputs?m:m.inputs[0]),t.disconnect(g),m.disconnect(i),i.disconnect(void 0===f.inputs?f:f.inputs[0]),i.disconnect(void 0===v.inputs?v:v.inputs[0]),f.disconnect(p.gain),v.disconnect(g.gain),p.disconnect(o,0,0),g.disconnect(o,0,1)}}})(e,d,h,p);if(2===o)return((e,i,o,d)=>{const h=new Float32Array(s),p=new Float32Array(s),f=new Float32Array(s),m=new Float32Array(s),g=Math.floor(8192.5);for(let t=0;t<s;t+=1)if(t>g){const e=(t-g)/(16384-g)*c;h[t]=Math.cos(e),p[t]=Math.sin(e),f[t]=0,m[t]=1}else{const e=t/(16384-g)*c;h[t]=1,p[t]=0,f[t]=Math.cos(e),m[t]=Math.sin(e)}const v=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=n(e,{...l,gain:0}),b=r(e,{...u,curve:h}),w=n(e,{...l,gain:0}),k=r(e,{...u,curve:p}),S=r(e,{...u,curve:a}),T=n(e,{...l,gain:0}),E=r(e,{...u,curve:f}),C=n(e,{...l,gain:0}),_=r(e,{...u,curve:m});return{connectGraph(){i.connect(v),i.connect(void 0===S.inputs?S:S.inputs[0]),v.connect(y,0),v.connect(w,0),v.connect(T,1),v.connect(C,1),S.connect(o),o.connect(void 0===b.inputs?b:b.inputs[0]),o.connect(void 0===k.inputs?k:k.inputs[0]),o.connect(void 0===E.inputs?E:E.inputs[0]),o.connect(void 0===_.inputs?_:_.inputs[0]),b.connect(y.gain),k.connect(w.gain),E.connect(T.gain),_.connect(C.gain),y.connect(d,0,0),T.connect(d,0,0),w.connect(d,0,1),C.connect(d,0,1)},disconnectGraph(){i.disconnect(v),i.disconnect(void 0===S.inputs?S:S.inputs[0]),v.disconnect(y,0),v.disconnect(w,0),v.disconnect(T,1),v.disconnect(C,1),S.disconnect(o),o.disconnect(void 0===b.inputs?b:b.inputs[0]),o.disconnect(void 0===k.inputs?k:k.inputs[0]),o.disconnect(void 0===E.inputs?E:E.inputs[0]),o.disconnect(void 0===_.inputs?_:_.inputs[0]),b.disconnect(y.gain),k.disconnect(w.gain),E.disconnect(T.gain),_.disconnect(C.gain),y.disconnect(d,0,0),T.disconnect(d,0,0),w.disconnect(d,0,1),C.disconnect(d,0,1)}}})(e,d,h,p);throw i()};return(t,{channelCount:r,channelCountMode:s,pan:a,...c})=>{if("max"===s)throw i();const l=e(t,{...c,channelCount:1,channelCountMode:s,numberOfInputs:2}),u=n(t,{...c,channelCount:r,channelCountMode:s,gain:1}),h=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:p,disconnectGraph:f}=d(t,r,u,h,l);Object.defineProperty(h.gain,"defaultValue",{get:()=>0}),Object.defineProperty(h.gain,"maxValue",{get:()=>1}),Object.defineProperty(h.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(e){u.channelCount!==e&&(g&&f(),({connectGraph:p,disconnectGraph:f}=d(t,e,u,h,l)),g&&p()),u.channelCount=e},get channelCountMode(){return u.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw i();u.channelCountMode=e},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(e){u.channelInterpretation=e},get context(){return u.context},get inputs(){return[u]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get pan(){return h.gain},addEventListener:(...e)=>u.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>u.dispatchEvent(e[0]),removeEventListener:(...e)=>u.removeEventListener(e[0],e[1],e[2])};let g=!1;return o(Sr(m,l),(()=>{p(),g=!0}),(()=>{f(),g=!1}))}})(zi,kr,Er,wo,Rr,Bi),Io=((e,t)=>(n,r)=>{const i=r.channelCountMode;if("clamped-max"===i)throw t();if(void 0===n.createStereoPanner)return e(n,r);const o=n.createStereoPanner();return pr(o,r),mr(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:e=>{if(e!==i)throw t()}}),o})(xo,Rr),Ro=((e,t,n,r,i)=>()=>{const o=new WeakMap;return{render(s,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(s,a)=>{let c=n(s);const l=an(c,a);if(!l){const e={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=t(a,e)}return o.set(a,c),l?await e(a,s.pan,c.pan):await r(a,s.pan,c.pan),_n(c)?await i(s,a,c.inputs[0]):await i(s,a,c),c})(s,a)}}})(Ii,Io,Mn,Pi,ri),Po=((e,t,n,r,i,o)=>class extends e{constructor(e,s){const a=i(e),c={...Ar,...s},l=n(a,c),u=o(a);super(e,!1,l,u?r():null),this._pan=t(this,u,l.pan)}get pan(){return this._pan}})(gi,Mi,Io,Ro,oi,ci),Oo=((e,t,n)=>()=>{const r=new WeakMap;return{render(i,o){const s=r.get(o);return void 0!==s?Promise.resolve(s):(async(i,o)=>{let s=t(i);if(!an(s,o)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,curve:s.curve,oversample:s.oversample};s=e(o,t)}return r.set(o,s),_n(s)?await n(i,o,s.inputs[0]):await n(i,o,s),s})(i,o)}}})(wo,Mn,ri),Mo=((e,t,n,r,i,o,s)=>class extends e{constructor(e,t){const a=i(e),c={...Lr,...t},l=n(a,c);super(e,!0,l,o(a)?r():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=l,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}})(gi,or,wo,Oo,oi,ci,Ui),No=(e=>null!==e&&e.isSecureContext)(ei),Ao=(e=>(t,n,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get:()=>Math.round(t*n)},currentTime:{configurable:!0,get:()=>t}});try{return r()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}})(ei),Do=new WeakMap,Lo=((e,t)=>n=>{let r=e.get(n);if(void 0!==r)return r;if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,44100),e.set(n,r),r})(Do,ai),Uo=No?((e,t,n,r,i,o,s,a,c,l,u,d,h)=>{let p=0;return(f,m,g={credentials:"omit"})=>{const v=u.get(f);if(void 0!==v&&v.has(m))return Promise.resolve();const y=l.get(f);if(void 0!==y){const e=y.get(m);if(void 0!==e)return e}const b=o(f),w=void 0===b.audioWorklet?i(m).then((([e,t])=>{const[r,i]=Gt(e,t);return n(`${r};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}\n})})(window,'_AWGS')`)})).then((()=>{const e=h._AWGS.pop();if(void 0===e)throw new SyntaxError;r(b.currentTime,b.sampleRate,(()=>e(class{},void 0,((e,n)=>{if(""===e.trim())throw t();const r=qt.get(b);if(void 0!==r){if(r.has(e))throw t();Kt(n),Yt(n.parameterDescriptors),r.set(e,n)}else Kt(n),Yt(n.parameterDescriptors),qt.set(b,new Map([[e,n]]))}),b.sampleRate,void 0,void 0)))})):Promise.all([i(m),Promise.resolve(e(d,d))]).then((([[e,t],n])=>{const r=p+1;p=r;const[i,o]=Gt(e,t),l=new Blob([`${i};((AudioWorkletProcessor,registerProcessor)=>{${o}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${r}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),u=URL.createObjectURL(l);return b.audioWorklet.addModule(u,g).then((()=>{if(a(b))return b;const e=s(b);return e.audioWorklet.addModule(u,g).then((()=>e))})).then((e=>{if(null===c)throw new SyntaxError;try{new c(e,`__sac${r}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(u)))}));return void 0===y?l.set(f,new Map([[m,w]])):y.set(m,w),w.then((()=>{const e=u.get(f);void 0===e?u.set(f,new Set([m])):e.add(m)})).finally((()=>{const e=l.get(f);void 0!==e&&e.delete(m)})),w}})(Xr,Rr,(e=>t=>new Promise(((n,r)=>{if(null===e)return void r(new SyntaxError);const i=e.document.head;if(null===i)r(new SyntaxError);else{const o=e.document.createElement("script"),s=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(s),c=e.onerror,l=()=>{e.onerror=c,URL.revokeObjectURL(a)};e.onerror=(t,n,i,o,s)=>n===a||n===e.location.href&&1===i&&1===o?(l(),r(s),!1):null!==c?c(t,n,i,o,s):void 0,o.onerror=()=>{l(),r(new SyntaxError)},o.onload=()=>{l(),n()},o.src=a,o.type="module",i.appendChild(o)}})))(ei),Ao,(e=>async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw e()})((()=>new DOMException("","AbortError"))),oi,Lo,ci,mi,new WeakMap,new WeakMap,((e,t)=>async()=>{if(null===e)return!0;if(null===t)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const t=new e(r,"a",{numberOfOutputs:0}),n=r.createOscillator();t.port.onmessage=()=>o=!0,t.onprocessorerror=()=>s=!0,n.connect(t),n.start(0),await r.startRendering(),await new Promise((e=>setTimeout(e)))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s})(mi,ai),ei):void 0,Fo=((e,t)=>n=>e(n)||t(n))(hi,ci),Bo=((e,t,n,r,i,o,s,a,c,l,u)=>(d,h)=>{const p=s(d)?d:o(d);if(i.has(h)){const e=n();return Promise.reject(e)}try{i.add(h)}catch{}return t(c,(()=>c(p)))?p.decodeAudioData(h).then((n=>(er(h).catch((()=>{})),t(a,(()=>a(n)))||u(n),e.add(n),n))):new Promise(((t,n)=>{const i=async()=>{try{await er(h)}catch{}},o=e=>{n(e),i()};try{p.decodeAudioData(h,(n=>{"function"!==typeof n.copyFromChannel&&(l(n),un(n)),e.add(n),i().then((()=>t(n)))}),(e=>{o(null===e?r():e)}))}catch(s){o(s)}}))})(bi,Xr,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,oi,Fo,cn,ur,Ti,Ei),jo=((e,t,n,r,i,o,s,a,c,l,u,d,h,p,f,m,g,v,y,b)=>class extends f{constructor(t,n){super(t,n),this._nativeContext=t,this._audioWorklet=void 0===e?void 0:{addModule:(t,n)=>e(this,t,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new i(this)}createBuffer(e,t,r){return new n({length:t,numberOfChannels:e,sampleRate:r})}createBufferSource(){return new r(this)}createChannelMerger(e=6){return new o(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new s(this,{numberOfOutputs:e})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(e=1){return new u(this,{maxDelayTime:e})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(e,t){return new p(this,{feedback:t,feedforward:e})}createOscillator(){return new m(this)}createPanner(){return new g(this)}createPeriodicWave(e,t,n={disableNormalization:!1}){return new v(this,{...n,imag:t,real:e})}createStereoPanner(){return new y(this)}createWaveShaper(){return new b(this)}decodeAudioData(e,t,n){return l(this._nativeContext,e).then((e=>("function"===typeof t&&t(e),e)),(e=>{throw"function"===typeof n&&n(e),e}))}})(Uo,yi,Ci,Ai,Fi,Wi,$i,Yi,Qi,Bo,eo,ro,oo,uo,fo,vo,Eo,_o,Po,Mo),zo=((e,t,n,r)=>class extends e{constructor(e,i){const o=n(e),s=t(o,i);if(r(o))throw TypeError();super(e,!0,s,null),this._nativeMediaElementAudioSourceNode=s}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(gi,((e,t)=>e.createMediaElementSource(t.mediaElement)),oi,ci),Vo=((e,t,n,r)=>class extends e{constructor(e,i){const o=n(e);if(r(o))throw new TypeError;const s={...lr,...i},a=t(o,s);super(e,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(gi,((e,t)=>{const n=e.createMediaStreamDestination();return pr(n,t),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),oi,ci),Wo=((e,t,n,r)=>class extends e{constructor(e,i){const o=n(e),s=t(o,i);if(r(o))throw new TypeError;super(e,!0,s,null),this._nativeMediaStreamAudioSourceNode=s}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(gi,((e,{mediaStream:t})=>{const n=t.getAudioTracks();n.sort(((e,t)=>e.id<t.id?-1:e.id>t.id?1:0));const r=n.slice(0,1),i=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:t}),i}),oi,ci),qo=((e,t)=>(n,{mediaStreamTrack:r})=>{if("function"===typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if("audio"!==r.kind)throw e();if(t(n))throw new TypeError;return o})(or,ci),$o=((e,t,n)=>class extends e{constructor(e,r){const i=n(e);super(e,!0,t(i,r),null)}})(gi,qo,oi),Ho=((e,t,n,r,i,o,s,a,c)=>class extends e{constructor(e={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");let t;try{t=new c(e)}catch(s){if(12===s.code&&"sampleRate is not in range"===s.message)throw n();throw s}if(null===t)throw r();if(!wn(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&t.sampleRate!==e.sampleRate)throw n();super(t,2);const{latencyHint:i}=e,{sampleRate:o}=t;if(this._baseLatency="number"===typeof t.baseLatency?t.baseLatency:"balanced"===i?512/o:"interactive"===i||void 0===i?256/o:"playback"===i?1024/o:128*Math.max(2,Math.min(128,Math.round(i*o/128)))/o,this._nativeAudioContext=t,"webkitAudioContext"===c.name?(this._nativeGainNode=t.createGain(),this._nativeOscillatorNode=t.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(t.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===t.state){this._state="suspended";const e=()=>{"suspended"===this._state&&(this._state=null),t.removeEventListener("statechange",e)};t.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),bn(this)})))}createMediaElementSource(e){return new i(this,{mediaElement:e})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(e){return new s(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new a(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise(((e,t)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((e=>{if(void 0===e||15===e.code)throw t();throw e}))}suspend(){return this._nativeAudioContext.suspend().catch((e=>{if(void 0===e)throw t();throw e}))}})(jo,or,Rr,Dr,zo,Vo,Wo,$o,di),Jo=(e=>t=>{const n=e.get(t);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(po),Go=(e=>(t,n)=>{e(t).add(n)})(Jo),Yo=(e=>(t,n,r=0,i=0)=>{const o=t[r];if(void 0===o)throw e();return Fn(n)?o.connect(n,0,i):o.connect(n,0)})(ln),Ko=(e=>(t,n)=>{e(t).delete(n)})(Jo),Xo=(e=>(t,n=void 0,r=void 0,i=0)=>void 0===n?t.forEach((e=>e.disconnect())):"number"===typeof n?nr(e,t,n).disconnect():Fn(n)?void 0===r?t.forEach((e=>e.disconnect(n))):void 0===i?nr(e,t,r).disconnect(n,0):nr(e,t,r).disconnect(n,0,i):void 0===r?t.forEach((e=>e.disconnect(n))):nr(e,t,r).disconnect(n,0))(ln),Qo=new WeakMap,Zo=((e,t)=>n=>t(e,n))(Qo,Xt),es=((e,t,n,r,i,o,s,a,c,l,u,d,h)=>(p,f,m,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some((e=>e<1)))throw c();if(v.length!==g.numberOfOutputs)throw t();if("explicit"!==g.channelCountMode)throw c();const y=g.channelCount*g.numberOfInputs,b=v.reduce(((e,t)=>e+t),0),w=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(y+w>6||b>6)throw c();const k=new MessageChannel,S=[],T=[];for(let e=0;e<g.numberOfInputs;e+=1)S.push(s(p,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),T.push(i(p,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const E=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:e,maxValue:t,minValue:n,name:r}of m.parameterDescriptors){const i=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[r]?g.parameterData[r]:void 0===e?0:e});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===e?0:e},maxValue:{get:()=>void 0===t?pn:t},minValue:{get:()=>void 0===n?hn:n}}),E.push(i)}const C=r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+w)}),_=yr(f,p.sampleRate),x=a(p,_,y+w,Math.max(1,b)),I=i(p,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),R=[];for(let e=0;e<g.numberOfOutputs;e+=1)R.push(r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[e]}));for(let e=0;e<g.numberOfInputs;e+=1){S[e].connect(T[e]);for(let t=0;t<g.channelCount;t+=1)T[e].connect(C,t,e*g.channelCount+t)}const P=new Wn(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:e},t)=>{const n=E[t];return n.connect(C,0,y+t),n.start(0),[e,n.offset]})));C.connect(x);let O=g.channelInterpretation,M=null;const N=0===g.numberOfOutputs?[x]:R,A={get bufferSize(){return _},get channelCount(){return g.channelCount},set channelCount(e){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(e){throw n()},get channelInterpretation(){return O},set channelInterpretation(e){for(const t of S)t.channelInterpretation=e;O=e},get context(){return x.context},get inputs(){return S},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return M},set onprocessorerror(e){"function"===typeof M&&A.removeEventListener("processorerror",M),M="function"===typeof e?e:null,"function"===typeof M&&A.addEventListener("processorerror",M)},get parameters(){return P},get port(){return k.port2},addEventListener:(...e)=>x.addEventListener(e[0],e[1],e[2]),connect:e.bind(null,N),disconnect:l.bind(null,N),dispatchEvent:(...e)=>x.dispatchEvent(e[0]),removeEventListener:(...e)=>x.removeEventListener(e[0],e[1],e[2])},D=new Map;k.port1.addEventListener=(e=>(...t)=>{if("message"===t[0]){const e="function"===typeof t[1]?t[1]:"object"===typeof t[1]&&null!==t[1]&&"function"===typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=D.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{u(p.currentTime,p.sampleRate,(()=>e(t)))},D.set(e,t[1]))}}return e.call(k.port1,t[0],t[1],t[2])})(k.port1.addEventListener),k.port1.removeEventListener=(e=>(...t)=>{if("message"===t[0]){const e=D.get(t[1]);void 0!==e&&(D.delete(t[1]),t[1]=e)}return e.call(k.port1,t[0],t[1],t[2])})(k.port1.removeEventListener);let L=null;Object.defineProperty(k.port1,"onmessage",{get:()=>L,set:e=>{"function"===typeof L&&k.port1.removeEventListener("message",L),L="function"===typeof e?e:null,"function"===typeof L&&(k.port1.addEventListener("message",L),k.port1.start())}}),m.prototype.port=k.port1;let U=null;const F=((e,t,n,r)=>{let i=$t.get(e);void 0===i&&(i=new WeakMap,$t.set(e,i));const o=br(n,r);return i.set(t,o),o})(p,A,m,g);F.then((e=>U=e));const B=Jn(g.numberOfInputs,g.channelCount),j=Jn(g.numberOfOutputs,v),z=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((e,{name:t})=>({...e,[t]:new Float32Array(128)})),{});let V=!0;const W=()=>{g.numberOfOutputs>0&&x.disconnect(I);for(let e=0,t=0;e<g.numberOfOutputs;e+=1){const n=R[e];for(let r=0;r<v[e];r+=1)I.disconnect(n,t+r,r);t+=v[e]}},q=new Map;x.onaudioprocess=({inputBuffer:e,outputBuffer:t})=>{if(null!==U){const r=d(A);for(let i=0;i<_;i+=128){for(let t=0;t<g.numberOfInputs;t+=1)for(let n=0;n<g.channelCount;n+=1)$n(e,B[t],n,n,i);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:t},n)=>{$n(e,z,t,y+n,i)}));for(let e=0;e<g.numberOfInputs;e+=1)for(let t=0;t<v[e];t+=1)0===j[e][t].byteLength&&(j[e][t]=new Float32Array(128));try{const e=B.map(((e,t)=>{if(r[t].size>0)return q.set(t,_/128),e;const n=q.get(t);return void 0===n?[]:(e.every((e=>e.every((e=>0===e))))&&(1===n?q.delete(t):q.set(t,n-1)),e)})),n=u(p.currentTime+i/p.sampleRate,p.sampleRate,(()=>U.process(e,j,z)));V=n;for(let r=0,o=0;r<g.numberOfOutputs;r+=1){for(let e=0;e<v[r];e+=1)Hn(t,j[r],e,o+e,i);o+=v[r]}}catch(n){V=!1,A.dispatchEvent(new ErrorEvent("processorerror",{colno:n.colno,filename:n.filename,lineno:n.lineno,message:n.message}))}if(!V){for(let e=0;e<g.numberOfInputs;e+=1){S[e].disconnect(T[e]);for(let t=0;t<g.channelCount;t+=1)T[i].disconnect(C,t,e*g.channelCount+t)}if(void 0!==m.parameterDescriptors){const e=m.parameterDescriptors.length;for(let t=0;t<e;t+=1){const e=E[t];e.disconnect(C,0,y+t),e.stop()}}C.disconnect(x),x.onaudioprocess=null,$?W():G();break}}}};let $=!1;const H=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),J=()=>x.connect(H).connect(p.destination),G=()=>{x.disconnect(H),H.disconnect()};return J(),h(A,(()=>{if(V){G(),g.numberOfOutputs>0&&x.connect(I);for(let e=0,t=0;e<g.numberOfOutputs;e+=1){const n=R[e];for(let r=0;r<v[e];r+=1)I.connect(n,t+r,r);t+=v[e]}}$=!0}),(()=>{V&&(J(),W()),$=!1}))})(Yo,ln,or,zi,kr,Ji,Er,Ir,Rr,Xo,Ao,Zo,Bi),ts=((e,t,n,r,i)=>(o,s,a,c,l,u)=>{if(null!==a)try{const t=new a(o,c,u),r=new Map;let s=null;if(Object.defineProperties(t,{channelCount:{get:()=>u.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>s,set:e=>{"function"===typeof s&&t.removeEventListener("processorerror",s),s="function"===typeof e?e:null,"function"===typeof s&&t.addEventListener("processorerror",s)}}}),t.addEventListener=(e=>(...n)=>{if("processorerror"===n[0]){const e="function"===typeof n[1]?n[1]:"object"===typeof n[1]&&null!==n[1]&&"function"===typeof n[1].handleEvent?n[1].handleEvent:null;if(null!==e){const t=r.get(n[1]);void 0!==t?n[1]=t:(n[1]=t=>{"error"===t.type?(Object.defineProperties(t,{type:{value:"processorerror"}}),e(t)):e(new ErrorEvent(n[0],{...t}))},r.set(e,n[1]))}}return e.call(t,"error",n[1],n[2]),e.call(t,...n)})(t.addEventListener),t.removeEventListener=(e=>(...n)=>{if("processorerror"===n[0]){const e=r.get(n[1]);void 0!==e&&(r.delete(n[1]),n[1]=e)}return e.call(t,"error",n[1],n[2]),e.call(t,n[0],n[1],n[2])})(t.removeEventListener),0!==u.numberOfOutputs){const e=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(e).connect(o.destination);return i(t,(()=>e.disconnect()),(()=>e.connect(o.destination)))}return t}catch(d){if(11===d.code)throw r();throw d}if(void 0===l)throw r();return(e=>{const{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}})(u),t(o,s,l,u)})(or,es,Er,Rr,Bi),ns=((e,t,n,r,i,o,s,a,c,l,u,d,h,p,f,m)=>(g,v,y)=>{const b=new WeakMap;let w=null;return{render(k,S){a(S,k);const T=b.get(S);return void 0!==T?Promise.resolve(T):(async(a,k)=>{let S=u(a),T=null;const E=an(S,k),C=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(null===d){const e=C.reduce(((e,t)=>e+t),0),n=i(k,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),o=[];for(let t=0;t<a.numberOfOutputs;t+=1)o.push(r(k,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[t]}));const l=s(k,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});l.connect=t.bind(null,o),l.disconnect=c.bind(null,o),T=[n,o,l]}else E||(S=new d(k,g));if(b.set(k,null===T?S:T[2]),null!==T){if(null===w){if(void 0===y)throw new Error("Missing the processor constructor.");if(null===h)throw new Error("Missing the native OfflineAudioContext constructor.");const e=a.channelCount*a.numberOfInputs,t=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,n=e+t,c=async()=>{const c=new h(n,128*Math.ceil(a.context.length/128),k.sampleRate),l=[],u=[];for(let e=0;e<v.numberOfInputs;e+=1)l.push(s(c,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),u.push(i(c,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const d=await Promise.all(Array.from(a.parameters.values()).map((async e=>{const t=o(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:e.value});return await p(c,e,t.offset),t}))),g=r(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,e+t)});for(let e=0;e<v.numberOfInputs;e+=1){l[e].connect(u[e]);for(let t=0;t<v.channelCount;t+=1)u[e].connect(g,t,e*v.channelCount+t)}for(const[t,n]of d.entries())n.connect(g,0,e+t),n.start(0);return g.connect(c.destination),await Promise.all(l.map((e=>f(a,c,e)))),m(c)};w=Gn(a,0===n?null:await c(),k,v,C,y,l)}const e=await w,t=n(k,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,u,d]=T;null!==e&&(t.buffer=e,t.start(0)),t.connect(c);for(let n=0,r=0;n<a.numberOfOutputs;n+=1){const e=u[n];for(let t=0;t<C[n];t+=1)c.connect(e,r+t,t);r+=C[n]}return d}if(E)for(const[t,n]of a.parameters.entries())await e(k,n,S.parameters.get(t));else for(const[e,t]of a.parameters.entries())await p(k,t,S.parameters.get(e));return await f(a,k,S),S})(k,S)}}})(Ii,Yo,Ri,zi,kr,Ji,Er,Ko,Xo,Ao,Mn,mi,ai,Pi,ri,ao),rs=(e=>t=>e.get(t))(Do),is=(e=>(t,n)=>{e.set(t,n)})(Qo),os=(No&&((e,t,n,r,i,o,s,a,c,l,u,d,h,p)=>{})(Go,gi,Mi,ns,ts,gn,rs,oi,ci,mi,(e=>({...e,outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},(()=>1))})),is,(e=>{const{port1:t,port2:n}=new MessageChannel;try{t.postMessage(e)}finally{t.close(),n.close()}}),$r),((e,t,n,r,i)=>{})(or,Rr,Dr,fo,di),((e,t)=>(n,r,i)=>{if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,r,i)}catch(o){if("SyntaxError"===o.name)throw e();throw o}})(Rr,ai)),ss=((e,t,n,r,i,o,s,a)=>(c,l)=>n(c).render(c,l).then((()=>Promise.all(Array.from(r(l)).map((e=>n(e).render(e,l)))))).then((()=>i(l))).then((n=>("function"!==typeof n.copyFromChannel?(s(n),un(n)):t(o,(()=>o(n)))||a(n),e.add(n),n))))(bi,Xr,ni,Jo,ao,cn,Ti,Ei);class as{static pendingRequests=new Map;static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getAudioBufferFromCache(e,t,n){try{const r=await t.match(e);if(r){const e=await r.arrayBuffer();return n.decodeAudioData(e)}return null}catch(r){throw console.error("Failed to get audio data from cache:",r),r}}static async fetchAndCacheAudioBuffer(e,t,n){try{const r=await fetch(e),i=r.clone();t.put(e,i);const o=await r.arrayBuffer();return n.decodeAudioData(o)}catch(r){throw console.error("Failed to fetch and cache audio data:",r),r}}static async getAudioBuffer(e,t){const n=await this.openCache();let r=this.pendingRequests.get(e);if(r)return r;return await this.getAudioBufferFromCache(e,n,t)||(r=this.fetchAndCacheAudioBuffer(e,n,t),this.pendingRequests.set(e,r),r)}}var cs=(e=>(e.HTML="HTML",e.Streaming="Streaming",e.Buffer="Buffer",e))(cs||{});class ls{context;globalGainNode;listener;prevVolume=1;finalizationRegistry;constructor(e){this.context=e||new Ho,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry((e=>{e.cleanup()}))}async createSound(e,t="Buffer"){if(e instanceof AudioBuffer)return Promise.resolve(new ds("",e,this.context,this.globalGainNode,"Buffer"));const n=e;if("HTML"===t){const e=new Audio;return e.src=n,e.crossOrigin="anonymous",new ds(n,void 0,this.context,this.globalGainNode,"HTML")}return as.getAudioBuffer(n,this.context).then((e=>new ds(n,e,this.context,this.globalGainNode,t)))}async createGroup(e){const t=new ps;return e.forEach((e=>t.addSound(e))),t}async createGroupFromUrls(e){const t=new ps;return(await Promise.all(e.map((e=>this.createSound(e))))).forEach((e=>t.addSound(e))),t}async createStream(e){return await function(e,t){const n=[];let r=0;function i(){for(;n.length;){let e=n.shift();const i=t.createBufferSource();if(!e)return;i.buffer=e,i.connect(t.destination),0==r&&(r=t.currentTime+.02),i.start(r),r+=i.buffer.duration}}fetch(e).then((function(e){if(!e.ok)throw new Error("HTTP error, status = "+e.status);if(!e.body)throw new Error("Missing body");var r=e.body.getReader();let o=new ArrayBuffer(0);function s(){return r.read().then((({value:e,done:r})=>{let a=null;if(e){if(o.byteLength?a=gs(o,e.buffer):(o=e.buffer.slice(0,44),a=e.buffer),t.decodeAudioData(a,(function(e){n.push(e),n.length&&i()}),(function(e){console.log("err(decodeAudioData): "+e)})),r)return void console.log("done");s()}}))}s()}))}(e,this.context),new ds(e,void 0,this.context,this.globalGainNode,"Streaming")}createBiquadFilter(e){const t=this.context.createBiquadFilter();return t.type=e,t}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){this.muted?this.prevVolume=e:this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return 0===this.globalGainNode.gain.value}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise(((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then((t=>{const n=new ms(this.context);n.play(),e(n)})).catch((e=>{t(e)}))}))}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:t,up:n}=e,[r,i,o]=t,[s,a,c]=n;this.listener.forwardX.setValueAtTime(r,this.context.currentTime),this.listener.forwardY.setValueAtTime(i,this.context.currentTime),this.listener.forwardZ.setValueAtTime(o,this.context.currentTime),this.listener.upX.setValueAtTime(s,this.context.currentTime),this.listener.upY.setValueAtTime(a,this.context.currentTime),this.listener.upZ.setValueAtTime(c,this.context.currentTime)}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[t,n,r]=e;this.listener.upX.setValueAtTime(t,this.context.currentTime),this.listener.upY.setValueAtTime(n,this.context.currentTime),this.listener.upZ.setValueAtTime(r,this.context.currentTime)}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[t,n,r]=e;this.listener.forwardX.setValueAtTime(t,this.context.currentTime),this.listener.forwardY.setValueAtTime(n,this.context.currentTime),this.listener.forwardZ.setValueAtTime(r,this.context.currentTime)}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[t,n,r]=e;this.listener.positionX.setValueAtTime(t,this.context.currentTime),this.listener.positionY.setValueAtTime(n,this.context.currentTime),this.listener.positionZ.setValueAtTime(r,this.context.currentTime)}}class us{filters=[];addFilter(e){this.filters.push(e)}removeFilter(e){this.filters=this.filters.filter((t=>t!==e))}applyFilters(e){return this.filters.reduce(((e,t)=>(e.connect(t),t)),e),this.filters.length>0?this.filters[this.filters.length-1]:e}}class ds extends us{constructor(e,t,n,r,i="Buffer"){super(),this.url=e,this.type=i,this.buffer=t,this.context=n,this.globalGainNode=r,this._position=[0,0,0]}buffer;context;playbacks=[];globalGainNode;_position=[0,0,0];_threeDOptions={coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0};loopCount=0;_playbackRate=1;_volume=1;preplay(){let e;if(this.buffer)e=this.context.createBufferSource(),e.buffer=this.buffer;else{const t=new Audio;t.crossOrigin="anonymous",t.src=this.url,t.preload="auto",e=this.context.createMediaElementSource(t)}const t=this.context.createGain();t.connect(this.globalGainNode);const n=new hs(e,t,this.context,this.loopCount);return n.volume=this.volume,n.playbackRate=this.playbackRate,this.filters.forEach((e=>n.addFilter(e))),n.threeDOptions=this.threeDOptions,n.position=this.position,this.playbacks.push(n),[n]}play(){const e=this.preplay();return e.forEach((e=>e.play())),e}stop(){this.playbacks.forEach((e=>e.stop()))}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}seek(e){this.playbacks.forEach((t=>t.seek(e)))}set position(e){this._threeDOptions.positionX=e[0],this._threeDOptions.positionY=e[1],this._threeDOptions.positionZ=e[2],this.playbacks.forEach((t=>t.position=e))}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}get threeDOptions(){return this._threeDOptions}set threeDOptions(e){this._threeDOptions={...this._threeDOptions,...e},this.playbacks.forEach((e=>e.threeDOptions=this._threeDOptions))}loop(e){return void 0===e||(this.loopCount=e,this.playbacks.forEach((e=>e.sourceLoop=!0))),this.loopCount}addFilter(e){super.addFilter(e),this.playbacks.forEach((t=>t.addFilter(e)))}removeFilter(e){super.removeFilter(e),this.playbacks.forEach((t=>t.removeFilter(e)))}get volume(){return this._volume}set volume(e){this._volume=e,this.playbacks.forEach((t=>t.volume=e))}isPlaying(){return this.playbacks.some((e=>e.isPlaying()))}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.playbacks.forEach((t=>t.playbackRate=e))}}class hs extends us{context;source;gainNode;panner;loopCount=0;currentLoop=0;buffer;playing=!1;constructor(e,t,n,r=0){super(),this.loopCount=r,this.source=e,"buffer"in e&&e.buffer&&(this.buffer=e.buffer),"mediaElement"in e&&e.mediaElement?e.mediaElement.onended=this.handleLoop.bind(this):"onended"in e&&(e.onended=this.handleLoop.bind(this)),this.gainNode=t,this.context=n,this.panner=n.createPanner(),e.connect(this.panner),this.panner.connect(this.gainNode),this.refreshFilters()}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(e){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=e),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=e)}handleLoop(){this.buffer?(this.source=this.context.createBufferSource(),this.source.buffer=this.buffer):this.seek(0),"infinite"===this.loopCount||this.currentLoop<this.loopCount?(this.currentLoop++,this.playing&&this.play()):this.playing=!1}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():"start"in this.source&&this.source.start&&this.source.start(),this.playing=!0,[this]}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");return{coneInnerAngle:this.panner.coneInnerAngle,coneOuterAngle:this.panner.coneOuterAngle,coneOuterGain:this.panner.coneOuterGain,distanceModel:this.panner.distanceModel,maxDistance:this.panner.maxDistance,channelCount:this.panner.channelCount,channelCountMode:this.panner.channelCountMode,channelInterpretation:this.panner.channelInterpretation,panningModel:this.panner.panningModel,refDistance:this.panner.refDistance,rolloffFactor:this.panner.rolloffFactor,positionX:this.panner.positionX.value,positionY:this.panner.positionY.value,positionZ:this.panner.positionZ.value,orientationX:this.panner.orientationX.value,orientationY:this.panner.orientationY.value,orientationZ:this.panner.orientationZ.value}}set threeDOptions(e){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");this.panner.coneInnerAngle=e.coneInnerAngle||this.panner.coneInnerAngle,this.panner.coneOuterAngle=e.coneOuterAngle||this.panner.coneOuterAngle,this.panner.coneOuterGain=e.coneOuterGain||this.panner.coneOuterGain,this.panner.distanceModel=e.distanceModel||this.panner.distanceModel,this.panner.maxDistance=e.maxDistance||this.panner.maxDistance,this.panner.channelCount=e.channelCount||this.panner.channelCount,this.panner.channelCountMode=e.channelCountMode||this.panner.channelCountMode,this.panner.channelInterpretation=e.channelInterpretation||this.panner.channelInterpretation,this.panner.panningModel=e.panningModel||this.panner.panningModel,this.panner.refDistance=e.refDistance||this.panner.refDistance,this.panner.rolloffFactor=e.rolloffFactor||this.panner.rolloffFactor,this.panner.positionX.value=e.positionX||this.panner.positionX.value,this.panner.positionY.value=e.positionY||this.panner.positionY.value,this.panner.positionZ.value=e.positionZ||this.panner.positionZ.value,this.panner.orientationX.value=e.orientationX||this.panner.orientationX.value,this.panner.orientationY.value=e.orientationY||this.panner.orientationY.value,this.panner.orientationZ.value=e.orientationZ||this.panner.orientationZ.value}seek(e){if(!this.source||!this.buffer||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const t=this.isPlaying();this.stop(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.refreshFilters(),this.source.connect(this.panner).connect(this.gainNode),t&&this.source.start(0,e)}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(e){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=e}set sourceLoop(e){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=e),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=e)}fadeIn(e,t="linear"){return new Promise((n=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value;switch(this.gainNode.gain.value=0,t){case"exponential":this.gainNode.gain.setValueAtTime(.01,this.context.currentTime),this.gainNode.gain.exponentialRampToValueAtTime(1,this.context.currentTime+e);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(1,this.context.currentTime+e)}setTimeout((()=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value=1,n()}),1e3*e)}))}fadeOut(e,t="linear"){return new Promise((n=>{if(!this.gainNode)throw new Error("Cannot fade out a sound that has been cleaned up");switch(this.gainNode.gain.value,t){case"exponential":this.gainNode.gain.exponentialRampToValueAtTime(.01,this.context.currentTime+e);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+e)}setTimeout((()=>n()),1e3*e)}))}isPlaying(){if(!this.source)throw new Error("Cannot check if a sound is playing that has been cleaned up");return this.playing}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this.filters.forEach((e=>{e&&e.disconnect()})),this.filters=[]}loop(e){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(this.source instanceof AudioBufferSourceNode)return void 0===e||(this.source.loop=!0,this.source.loopEnd=this.source.buffer?.duration||0,this.source.loopStart=0),!0===this.source.loop?"infinite":0;if("mediaElement"in this.source&&this.source.mediaElement){const t=this.source.mediaElement;return void 0===e||(t.loop=!0),!0===t.loop?"infinite":0}throw new Error("Unsupported source type")}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.isPlaying()&&("stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this.playing=!1)}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");"suspend"in this.source.context&&this.source.context.suspend()}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");"resume"in this.source.context&&this.source.context.resume()}addFilter(e){super.addFilter(e),this.refreshFilters()}removeFilter(e){super.removeFilter(e),this.refreshFilters()}set position(e){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[t,n,r]=e;this.panner.positionX.setValueAtTime(t,this.context.currentTime),this.panner.positionY.setValueAtTime(n,this.context.currentTime),this.panner.positionZ.setValueAtTime(r,this.context.currentTime)}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let e=this.panner;e.disconnect(),e=this.applyFilters(e),e.connect(this.gainNode)}}class ps{sounds=[];_position=[0,0,0];loopCount=0;seek(e){this.sounds.forEach((t=>t.seek&&t.seek(e)))}addSound(e){this.sounds.push(e)}preplay(){return this.sounds.reduce(((e,t)=>(t.loop&&t.loop(this.loopCount),e.concat(t.preplay()))),[])}play(){return this.preplay().map((e=>(e.play(),e)))}isPlaying(){return this.sounds.some((e=>e.isPlaying()))}stop(){this.sounds.forEach((e=>e.stop()))}pause(){this.sounds.forEach((e=>e.pause()))}resume(){this.sounds.forEach((e=>e.resume()))}loop(e){return void 0===e||(this.loopCount=e,this.sounds.forEach((t=>t.loop&&t.loop(e)))),this.loopCount}addFilter(e){this.sounds.forEach((t=>t.addFilter(e)))}removeFilter(e){this.sounds.forEach((t=>t.removeFilter(e)))}set position(e){this._position=e,this.sounds.forEach((e=>e.position=this._position))}get position(){return this._position}get volume(){return this.sounds.map((e=>e.volume)).reduce(((e,t)=>e+t),0)/this.sounds.length}set volume(e){this.sounds.forEach((t=>t.volume=e))}get playbackRate(){return 0===this.sounds.length?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach((t=>t.playbackRate=e))}}class fs extends us{context;source;gainNode;panner;constructor(e,t,n,r=0){super(),this.source=e,this.gainNode=t,this.context=n,this.panner=n.createPanner(),e.connect(this.panner).connect(this.gainNode),this.refreshFilters()}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(e){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=e}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach((e=>e.stop()))}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach((e=>e.enabled=!1))}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach((e=>e.enabled=!0))}addFilter(e){super.addFilter(e),this.refreshFilters()}removeFilter(e){super.removeFilter(e),this.refreshFilters()}set position(e){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[t,n,r]=e;this.panner.positionX.value=t,this.panner.positionY.value=n,this.panner.positionZ.value=r}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let e=this.source;this.source.disconnect(),e=this.applyFilters(e),e.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(e){}}class ms extends us{context;_position=[0,0,0];loopCount=0;prevVolume=1;microphoneGainNode;streamPlayback;stream;streamSource;constructor(e){super(),this.context=e,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{this.stream=e,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new fs(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()})).catch((e=>{console.error("Error initializing microphone stream:",e)})),this.streamPlayback?[this.streamPlayback]:[]}seek(e){}isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(e){this.streamPlayback&&this.streamPlayback.addFilter(e)}removeFilter(e){this.streamPlayback&&this.streamPlayback.removeFilter(e)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(e){this.streamPlayback&&(this.streamPlayback.volume=e)}get position(){return[0,0,0]}set position(e){}loop(e){return 0}get playbackRate(){return 1}set playbackRate(e){}}const gs=(e,t)=>{var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer};class vs extends Ot{constructor(...e){super(...e),this.packageName="Client.Media",this.sounds={},this.defaultUrl=""}handleDefault(e){this.defaultUrl=e}async handleLoad(e){const t=(e.url||this.defaultUrl)+e.name,n=e.url+e.name;if(!this.sounds[n]){let e=await this.client.cacophony.createSound(t);e.key=n,this.sounds[n]=e}}async handlePlay(e){let t=(e.url||this.defaultUrl)+e.name;e.key=e.key||t;let n=this.sounds[e.key];if(n&&n.url===t||("music"===e.type?(t="https://mongoose.world:9080/?url="+encodeURIComponent(t),n=await this.client.cacophony.createSound(t,cs.HTML)):n=await this.client.cacophony.createSound(t)),void 0!==e.volume&&(n.volume=e.volume/100),void 0!==e.loops&&n.loop&&n.loop(-1===e.loops?"infinite":e.loops),e.start&&n.seek&&n.seek(e.start),e.end&&setTimeout((()=>{n.stop()}),e.end),e.is3d&&(n.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},n.position=[e.position[0],e.position[1],e.position[2]]),e.priority){for(let t in this.sounds){const n=this.sounds[t];n.priority&&n.priority<e.priority&&n.stop()}n.priority=e.priority}if(!n.isPlaying()){const t=n.play()[0];e.fadein&&t.fadeIn(e.fadein),e.fadeout&&t.fadeOut(e.fadeout)}this.sounds[e.key]=n,n.key=e.key}handleStop(e){e.name&&this.soundsByName(e.name).forEach((e=>e.stop())),e.type&&this.soundsByType(e.type).forEach((e=>e.stop())),e.tag&&this.soundsByTag(e.tag).forEach((e=>e.stop())),e.key&&this.soundsByKey(e.key).forEach((e=>e.stop())),e.name||e.type||e.tag||e.key||this.allSounds.forEach((e=>e.stop()))}handleListenerPosition(e){var t;null!==(t=e.position)&&void 0!==t&&t.length&&(this.client.cacophony.listenerPosition=e.position)}handleListenerOrientation(e){e.up&&e.up.length&&(this.client.cacophony.listenerUpOrientation=e.up),e.forward&&e.forward.length&&(this.client.cacophony.listenerForwardOrientation=e.forward)}soundsByName(e){return Object.values(this.sounds).filter((t=>t.url&&t.url[t.url.length-1].endsWith(e)))}soundsByKey(e){return Object.values(this.sounds).filter((t=>t.key===e))}soundsByTag(e){return Object.values(this.sounds).filter((t=>t.tag===e))}soundsByType(e){return Object.values(this.sounds).filter((t=>t.mediaType===e))}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach((e=>e.stop())),this.sounds={}}}class ys extends Ot{constructor(...e){super(...e),this.packageName="Client.Speech"}handleSpeak(e){const t=new SpeechSynthesisUtterance(e.text);t.rate=e.rate,t.pitch=e.pitch,t.volume=e.volume,speechSynthesis.speak(t)}}class bs extends Ot{constructor(...e){super(...e),this.packageName="Comm.Channel",this.channels=[]}handleList(e){this.channels=e}sendList(){this.sendData("List")}handleText(e){"say_to_you"===e.channel&&(document.hasFocus()||this.client.sendNotification(`Message from ${e.talker}`,`${e.text}`))}}class ws extends Ot{constructor(...e){super(...e),this.packageName="Comm.LiveKit"}handleroom_token(e){this.client.worldData.liveKitTokens.push(e.token),this.client.emit("livekitToken",e.token)}handleroom_leave(e){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter((t=>t!==e.token)),this.client.emit("livekitLeave",e.token)}}class ks extends Ot{constructor(...e){super(...e),this.packageName="Core"}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class Ss extends Ot{constructor(...e){super(...e),this.packageName="Core.Supports"}sendSet(){const e=Object.values(this.client.gmcpHandlers).map((e=>e.packageName+" "+e.packageVersion.toString()));this.sendData("Set",e)}}(class extends Ot{constructor(...e){super(...e),this.name="",this.id="",this.exits=[],this.people=[]}handleInfo(e){this.name=e.name,this.id=e.num,this.client.worldData.roomId=this.id,this.client.emit("room",this)}}).packageName="Room";const Ts="object"===typeof performance&&performance&&"function"===typeof performance.now?performance:Date,Es=new Set,Cs="object"===typeof process&&process?process:{},_s=(e,t,n,r)=>{"function"===typeof Cs.emitWarning?Cs.emitWarning(e,t,n,r):console.error(`[${n}] ${t}: ${e}`)};let xs=globalThis.AbortController,Is=globalThis.AbortSignal;if("undefined"===typeof xs){Is=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(e,t){this._onabort.push(t)}},xs=class{constructor(){t()}signal=new Is;abort(e){if(!this.signal.aborted){this.signal.reason=e,this.signal.aborted=!0;for(const t of this.signal._onabort)t(e);this.signal.onabort?.(e)}}};let e="1"!==Cs.env?.LRU_CACHE_IGNORE_AC_WARNING;const t=()=>{e&&(e=!1,_s("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}Symbol("type");const Rs=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),Ps=e=>Rs(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Os:null:null;class Os extends Array{constructor(e){super(e),this.fill(0)}}class Ms{heap;length;static#e=!1;static create(e){const t=Ps(e);if(!t)return[];Ms.#e=!0;const n=new Ms(e,t);return Ms.#e=!1,n}constructor(e,t){if(!Ms.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class Ns{#t;#n;#r;#i;#o;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#s;#a;#c;#l;#u;#d;#h;#p;#f;#m;#g;#v;#y;#b;#w;#k;#S;static unsafeExposeInternals(e){return{starts:e.#y,ttls:e.#b,sizes:e.#v,keyMap:e.#c,keyList:e.#l,valList:e.#u,next:e.#d,prev:e.#h,get head(){return e.#p},get tail(){return e.#f},free:e.#m,isBackgroundFetch:t=>e.#T(t),backgroundFetch:(t,n,r,i)=>e.#E(t,n,r,i),moveToTail:t=>e.#C(t),indexes:t=>e.#_(t),rindexes:t=>e.#x(t),isStale:t=>e.#I(t)}}get max(){return this.#t}get maxSize(){return this.#n}get calculatedSize(){return this.#a}get size(){return this.#s}get fetchMethod(){return this.#o}get dispose(){return this.#r}get disposeAfter(){return this.#i}constructor(e){const{max:t=0,ttl:n,ttlResolution:r=1,ttlAutopurge:i,updateAgeOnGet:o,updateAgeOnHas:s,allowStale:a,dispose:c,disposeAfter:l,noDisposeOnSet:u,noUpdateTTL:d,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:f,fetchMethod:m,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:v,allowStaleOnFetchRejection:y,allowStaleOnFetchAbort:b,ignoreFetchAbort:w}=e;if(0!==t&&!Rs(t))throw new TypeError("max option must be a nonnegative integer");const k=t?Ps(t):Array;if(!k)throw new Error("invalid max value: "+t);if(this.#t=t,this.#n=h,this.maxEntrySize=p||this.#n,this.sizeCalculation=f,this.sizeCalculation){if(!this.#n&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!==typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==m&&"function"!==typeof m)throw new TypeError("fetchMethod must be a function if specified");if(this.#o=m,this.#k=!!m,this.#c=new Map,this.#l=new Array(t).fill(void 0),this.#u=new Array(t).fill(void 0),this.#d=new k(t),this.#h=new k(t),this.#p=0,this.#f=0,this.#m=Ms.create(t),this.#s=0,this.#a=0,"function"===typeof c&&(this.#r=c),"function"===typeof l?(this.#i=l,this.#g=[]):(this.#i=void 0,this.#g=void 0),this.#w=!!this.#r,this.#S=!!this.#i,this.noDisposeOnSet=!!u,this.noUpdateTTL=!!d,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!y,this.allowStaleOnFetchAbort=!!b,this.ignoreFetchAbort=!!w,0!==this.maxEntrySize){if(0!==this.#n&&!Rs(this.#n))throw new TypeError("maxSize must be a positive integer if specified");if(!Rs(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#R()}if(this.allowStale=!!a,this.noDeleteOnStaleGet=!!v,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!s,this.ttlResolution=Rs(r)||0===r?r:1,this.ttlAutopurge=!!i,this.ttl=n||0,this.ttl){if(!Rs(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#P()}if(0===this.#t&&0===this.ttl&&0===this.#n)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#n){const e="LRU_CACHE_UNBOUNDED";if((e=>!Es.has(e))(e)){Es.add(e);_s("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,Ns)}}}getRemainingTTL(e){return this.#c.has(e)?1/0:0}#P(){const e=new Os(this.#t),t=new Os(this.#t);this.#b=e,this.#y=t,this.#O=(n,r,i=Ts.now())=>{if(t[n]=0!==r?i:0,e[n]=r,0!==r&&this.ttlAutopurge){const e=setTimeout((()=>{this.#I(n)&&this.delete(this.#l[n])}),r+1);e.unref&&e.unref()}},this.#M=n=>{t[n]=0!==e[n]?Ts.now():0},this.#N=(i,o)=>{if(e[o]){const s=e[o],a=t[o];i.ttl=s,i.start=a,i.now=n||r();const c=i.now-a;i.remainingTTL=s-c}};let n=0;const r=()=>{const e=Ts.now();if(this.ttlResolution>0){n=e;const t=setTimeout((()=>n=0),this.ttlResolution);t.unref&&t.unref()}return e};this.getRemainingTTL=i=>{const o=this.#c.get(i);if(void 0===o)return 0;const s=e[o],a=t[o];if(0===s||0===a)return 1/0;return s-((n||r())-a)},this.#I=i=>0!==e[i]&&0!==t[i]&&(n||r())-t[i]>e[i]}#M=()=>{};#N=()=>{};#O=()=>{};#I=()=>!1;#R(){const e=new Os(this.#t);this.#a=0,this.#v=e,this.#A=t=>{this.#a-=e[t],e[t]=0},this.#D=(e,t,n,r)=>{if(this.#T(t))return 0;if(!Rs(n)){if(!r)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!==typeof r)throw new TypeError("sizeCalculation must be a function");if(n=r(t,e),!Rs(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return n},this.#L=(t,n,r)=>{if(e[t]=n,this.#n){const n=this.#n-e[t];for(;this.#a>n;)this.#U(!0)}this.#a+=e[t],r&&(r.entrySize=n,r.totalCalculatedSize=this.#a)}}#A=e=>{};#L=(e,t,n)=>{};#D=(e,t,n,r)=>{if(n||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#_({allowStale:e=this.allowStale}={}){if(this.#s)for(let t=this.#f;this.#F(t)&&(!e&&this.#I(t)||(yield t),t!==this.#p);)t=this.#h[t]}*#x({allowStale:e=this.allowStale}={}){if(this.#s)for(let t=this.#p;this.#F(t)&&(!e&&this.#I(t)||(yield t),t!==this.#f);)t=this.#d[t]}#F(e){return void 0!==e&&this.#c.get(this.#l[e])===e}*entries(){for(const e of this.#_())void 0===this.#u[e]||void 0===this.#l[e]||this.#T(this.#u[e])||(yield[this.#l[e],this.#u[e]])}*rentries(){for(const e of this.#x())void 0===this.#u[e]||void 0===this.#l[e]||this.#T(this.#u[e])||(yield[this.#l[e],this.#u[e]])}*keys(){for(const e of this.#_()){const t=this.#l[e];void 0===t||this.#T(this.#u[e])||(yield t)}}*rkeys(){for(const e of this.#x()){const t=this.#l[e];void 0===t||this.#T(this.#u[e])||(yield t)}}*values(){for(const e of this.#_()){void 0===this.#u[e]||this.#T(this.#u[e])||(yield this.#u[e])}}*rvalues(){for(const e of this.#x()){void 0===this.#u[e]||this.#T(this.#u[e])||(yield this.#u[e])}}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const n of this.#_()){const r=this.#u[n],i=this.#T(r)?r.__staleWhileFetching:r;if(void 0!==i&&e(i,this.#l[n],this))return this.get(this.#l[n],t)}}forEach(e,t=this){for(const n of this.#_()){const r=this.#u[n],i=this.#T(r)?r.__staleWhileFetching:r;void 0!==i&&e.call(t,i,this.#l[n],this)}}rforEach(e,t=this){for(const n of this.#x()){const r=this.#u[n],i=this.#T(r)?r.__staleWhileFetching:r;void 0!==i&&e.call(t,i,this.#l[n],this)}}purgeStale(){let e=!1;for(const t of this.#x({allowStale:!0}))this.#I(t)&&(this.delete(this.#l[t]),e=!0);return e}dump(){const e=[];for(const t of this.#_({allowStale:!0})){const n=this.#l[t],r=this.#u[t],i=this.#T(r)?r.__staleWhileFetching:r;if(void 0===i||void 0===n)continue;const o={value:i};if(this.#b&&this.#y){o.ttl=this.#b[t];const e=Ts.now()-this.#y[t];o.start=Math.floor(Date.now()-e)}this.#v&&(o.size=this.#v[t]),e.unshift([n,o])}return e}load(e){this.clear();for(const[t,n]of e){if(n.start){const e=Date.now()-n.start;n.start=Ts.now()-e}this.set(t,n.value,n)}}set(e,t,n={}){if(void 0===t)return this.delete(e),this;const{ttl:r=this.ttl,start:i,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:s=this.sizeCalculation,status:a}=n;let{noUpdateTTL:c=this.noUpdateTTL}=n;const l=this.#D(e,t,n.size||0,s);if(this.maxEntrySize&&l>this.maxEntrySize)return a&&(a.set="miss",a.maxEntrySizeExceeded=!0),this.delete(e),this;let u=0===this.#s?void 0:this.#c.get(e);if(void 0===u)u=0===this.#s?this.#f:0!==this.#m.length?this.#m.pop():this.#s===this.#t?this.#U(!1):this.#s,this.#l[u]=e,this.#u[u]=t,this.#c.set(e,u),this.#d[this.#f]=u,this.#h[u]=this.#f,this.#f=u,this.#s++,this.#L(u,l,a),a&&(a.set="add"),c=!1;else{this.#C(u);const n=this.#u[u];if(t!==n){if(this.#k&&this.#T(n)?n.__abortController.abort(new Error("replaced")):o||(this.#w&&this.#r?.(n,e,"set"),this.#S&&this.#g?.push([n,e,"set"])),this.#A(u),this.#L(u,l,a),this.#u[u]=t,a){a.set="replace";const e=n&&this.#T(n)?n.__staleWhileFetching:n;void 0!==e&&(a.oldValue=e)}}else a&&(a.set="update")}if(0===r||this.#b||this.#P(),this.#b&&(c||this.#O(u,r,i),a&&this.#N(a,u)),!o&&this.#S&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}return this}pop(){try{for(;this.#s;){const e=this.#u[this.#p];if(this.#U(!0),this.#T(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(void 0!==e)return e}}finally{if(this.#S&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}}}#U(e){const t=this.#p,n=this.#l[t],r=this.#u[t];return this.#k&&this.#T(r)?r.__abortController.abort(new Error("evicted")):(this.#w||this.#S)&&(this.#w&&this.#r?.(r,n,"evict"),this.#S&&this.#g?.push([r,n,"evict"])),this.#A(t),e&&(this.#l[t]=void 0,this.#u[t]=void 0,this.#m.push(t)),1===this.#s?(this.#p=this.#f=0,this.#m.length=0):this.#p=this.#d[t],this.#c.delete(n),this.#s--,t}has(e,t={}){const{updateAgeOnHas:n=this.updateAgeOnHas,status:r}=t,i=this.#c.get(e);if(void 0!==i){const e=this.#u[i];if(this.#T(e)&&void 0===e.__staleWhileFetching)return!1;if(!this.#I(i))return n&&this.#M(i),r&&(r.has="hit",this.#N(r,i)),!0;r&&(r.has="stale",this.#N(r,i))}else r&&(r.has="miss");return!1}peek(e,t={}){const{allowStale:n=this.allowStale}=t,r=this.#c.get(e);if(void 0!==r&&(n||!this.#I(r))){const e=this.#u[r];return this.#T(e)?e.__staleWhileFetching:e}}#E(e,t,n,r){const i=void 0===t?void 0:this.#u[t];if(this.#T(i))return i;const o=new xs,{signal:s}=n;s?.addEventListener("abort",(()=>o.abort(s.reason)),{signal:o.signal});const a={signal:o.signal,options:n,context:r},c=(r,i=!1)=>{const{aborted:s}=o.signal,c=n.ignoreFetchAbort&&void 0!==r;if(n.status&&(s&&!i?(n.status.fetchAborted=!0,n.status.fetchError=o.signal.reason,c&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),s&&!c&&!i)return l(o.signal.reason);const d=u;return this.#u[t]===u&&(void 0===r?d.__staleWhileFetching?this.#u[t]=d.__staleWhileFetching:this.delete(e):(n.status&&(n.status.fetchUpdated=!0),this.set(e,r,a.options))),r},l=r=>{const{aborted:i}=o.signal,s=i&&n.allowStaleOnFetchAbort,a=s||n.allowStaleOnFetchRejection,c=a||n.noDeleteOnFetchRejection,l=u;if(this.#u[t]===u){!c||void 0===l.__staleWhileFetching?this.delete(e):s||(this.#u[t]=l.__staleWhileFetching)}if(a)return n.status&&void 0!==l.__staleWhileFetching&&(n.status.returnedStale=!0),l.__staleWhileFetching;if(l.__returned===l)throw r};n.status&&(n.status.fetchDispatched=!0);const u=new Promise(((t,r)=>{const s=this.#o?.(e,i,a);s&&s instanceof Promise&&s.then((e=>t(e)),r),o.signal.addEventListener("abort",(()=>{n.ignoreFetchAbort&&!n.allowStaleOnFetchAbort||(t(),n.allowStaleOnFetchAbort&&(t=e=>c(e,!0)))}))})).then(c,(e=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=e),l(e)))),d=Object.assign(u,{__abortController:o,__staleWhileFetching:i,__returned:void 0});return void 0===t?(this.set(e,d,{...a.options,status:void 0}),t=this.#c.get(e)):this.#u[t]=d,d}#T(e){if(!this.#k)return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof xs}async fetch(e,t={}){const{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:s=this.noDisposeOnSet,size:a=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:d=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:f,forceRefresh:m=!1,status:g,signal:v}=t;if(!this.#k)return g&&(g.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:i,status:g});const y={allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:i,ttl:o,noDisposeOnSet:s,size:a,sizeCalculation:c,noUpdateTTL:l,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:d,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:g,signal:v};let b=this.#c.get(e);if(void 0===b){g&&(g.fetch="miss");const t=this.#E(e,b,y,f);return t.__returned=t}{const t=this.#u[b];if(this.#T(t)){const e=n&&void 0!==t.__staleWhileFetching;return g&&(g.fetch="inflight",e&&(g.returnedStale=!0)),e?t.__staleWhileFetching:t.__returned=t}const i=this.#I(b);if(!m&&!i)return g&&(g.fetch="hit"),this.#C(b),r&&this.#M(b),g&&this.#N(g,b),t;const o=this.#E(e,b,y,f),s=void 0!==o.__staleWhileFetching&&n;return g&&(g.fetch=i?"stale":"refresh",s&&i&&(g.returnedStale=!0)),s?o.__staleWhileFetching:o.__returned=o}}get(e,t={}){const{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:o}=t,s=this.#c.get(e);if(void 0!==s){const t=this.#u[s],a=this.#T(t);return o&&this.#N(o,s),this.#I(s)?(o&&(o.get="stale"),a?(o&&n&&void 0!==t.__staleWhileFetching&&(o.returnedStale=!0),n?t.__staleWhileFetching:void 0):(i||this.delete(e),o&&n&&(o.returnedStale=!0),n?t:void 0)):(o&&(o.get="hit"),a?t.__staleWhileFetching:(this.#C(s),r&&this.#M(s),t))}o&&(o.get="miss")}#B(e,t){this.#h[t]=e,this.#d[e]=t}#C(e){e!==this.#f&&(e===this.#p?this.#p=this.#d[e]:this.#B(this.#h[e],this.#d[e]),this.#B(this.#f,e),this.#f=e)}delete(e){let t=!1;if(0!==this.#s){const n=this.#c.get(e);if(void 0!==n)if(t=!0,1===this.#s)this.clear();else{this.#A(n);const t=this.#u[n];this.#T(t)?t.__abortController.abort(new Error("deleted")):(this.#w||this.#S)&&(this.#w&&this.#r?.(t,e,"delete"),this.#S&&this.#g?.push([t,e,"delete"])),this.#c.delete(e),this.#l[n]=void 0,this.#u[n]=void 0,n===this.#f?this.#f=this.#h[n]:n===this.#p?this.#p=this.#d[n]:(this.#d[this.#h[n]]=this.#d[n],this.#h[this.#d[n]]=this.#h[n]),this.#s--,this.#m.push(n)}}if(this.#S&&this.#g?.length){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}return t}clear(){for(const e of this.#x({allowStale:!0})){const t=this.#u[e];if(this.#T(t))t.__abortController.abort(new Error("deleted"));else{const n=this.#l[e];this.#w&&this.#r?.(t,n,"delete"),this.#S&&this.#g?.push([t,n,"delete"])}}if(this.#c.clear(),this.#u.fill(void 0),this.#l.fill(void 0),this.#b&&this.#y&&(this.#b.fill(0),this.#y.fill(0)),this.#v&&this.#v.fill(0),this.#p=0,this.#f=0,this.#m.length=0,this.#a=0,this.#s=0,this.#S&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}}}function As(e){const t=e.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!t)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+e+"`"),null;const n=t[1]||t[4],r=t[2],i=t[3],o={};return o[r]=i,{name:n,authKey:undefined,keyvals:o}}function Ds(){return(Math.random()+1).toString(36).substring(3,9)}class Ls{constructor(e){this.packageName=void 0,this.minVersion=1,this.maxVersion=1,this.packageVersion=0,this.client=void 0,this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,t){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,t)}}class Us extends Ls{constructor(...e){super(...e),this.packageName="mcp-negotiate",this.minVersion=2,this.maxVersion=2}handle(e){e.name}sendNegotiate(){for(const n of Object.values(this.client.mcpHandlers)){var e,t;let r=null===(e=n.minVersion)||void 0===e?void 0:e.toFixed(1),i=null===(t=n.maxVersion)||void 0===t?void 0:t.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:n.packageName,"min-version":r,"max-version":i})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class Fs extends Ls{constructor(...e){super(...e),this.packageName="dns-com-awns-status"}handle(e){console.log(e),this.client.emit("statustext",e.keyvals.text)}}class Bs extends Ls{constructor(e){super(e),this.packageName="dns-org-mud-moo-simpleedit",this.sessions={},this.clientId=void 0,this.clientId=Ds()}handle(e){if("dns-org-mud-moo-simpleedit-content"===e.name){const t={name:e.keyvals.name,reference:e.keyvals.reference,type:e.keyvals.type,contents:[]};this.sessions[e.keyvals["_data-tag"]]=t}else console.log(`Unexpected simpleedit message ${e}`)}handleMultiline(e){"content"in e.keyvals?this.sessions[e.name].contents.push(e.keyvals.content):console.log(`Unexpected simpleedit ML ${e}`)}closeMultiline(e){console.log(`Closing multiline ${e.name}`),this.client.openEditorWindow(this.sessions[e.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class js extends Ls{constructor(...e){super(...e),this.packageName="dns-com-awns-getset",this.id=1,this.cache=new Ns({max:10}),this.LocalCache={}}handle(e){switch(e.name){case"dns-com-awns-getset-ack":const t=this.cache.get(e.keyvals.id);if(void 0===t){console.log(`Got ack for unknown id ${e.keyvals.id}`);break}const n=e.keyvals.value;console.log(`Got ${t} = ${n}`),this.LocalCache[t]=n,this.client.emit("getset",t,n)}}sendGet(e){const t=(this.id++).toString();this.cache.set(t,e),this.client.sendMcp("dns-com-awns-getset-get",{id:t,property:e})}sendSet(e,t){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:e,value:t})}sendDrop(e){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:e})}}class zs extends Ls{constructor(...e){super(...e),this.packageName="dns-com-vmoo-userlist",this.maxVersion=1.1,this.player=void 0,this.fields=["Object","Name","Icon"],this.icons=["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"],this.players=[]}handle(e){if("dns-com-vmoo-userlist-you"===e.name)this.player=e.keyvals.nr}handleMultiline(e){if("fields"in e.keyvals&&(this.fields=Vs(e.keyvals.fields.trim())),"icons"in e.keyvals&&(this.icons=Vs(e.keyvals.icons.trim())),"d"in e.keyvals){const r=e.keyvals.d[0];switch(r){case"=":var t=Vs(e.keyvals.d.slice(1));this.players=t.map((e=>this.playerFromArray(e)));break;case"+":this.players.push(this.playerFromArray(Vs(e.keyvals.d.slice(1))));break;case"-":var n=Vs(e.keyvals.d.slice(1));this.players=this.players.filter((e=>!n.includes(e.Object)));break;case"*":const i=this.playerFromArray(Vs(e.keyvals.d.slice(1)));this.updatePlayer(i);break;case"<":n=Vs(e.keyvals.d.slice(1)),this.players.forEach(((e,t)=>{n.includes(e.Object)&&(e.idle=!0,this.players[t]=e)}));break;case">":n=Vs(e.keyvals.d.slice(1)),this.players.forEach(((e,t)=>{n.includes(e.Object)&&(e.idle=!1,this.players[t]=e)}));break;case"[":n=Vs(e.keyvals.d.slice(1)),this.players.forEach(((e,t)=>{n.includes(e.Object)&&(e.away=!0,this.players[t]=e)}));break;case"]":n=Vs(e.keyvals.d.slice(1)),this.players.forEach(((e,t)=>{n.includes(e.Object)&&(e.away=!1,this.players[t]=e)}));break;default:console.log(`Unknown userlist mode ${r} in ${e.keyvals.d}`)}this.update()}}updatePlayer(e){const t=this.players.findIndex((t=>t.Object===e.Object));-1!==t?this.players[t]=e:this.players.push(e)}update(){function e(e){return e.Icon-(e.idle?10:0)-(e.away?20:0)}this.players.sort(((t,n)=>e(n)-e(t))),this.client.emit("userlist",this.players)}playerFromArray(e){const t={};return e.forEach(((e,n)=>{t[this.fields[n]]=e})),t.away=!1,t.idle=!1,t}}function Vs(e){e=e.slice(1,-1);let t=[],n="",r=0;for(let o=0;o<e.length;o++){const t=e[o];if("{"===t)r++;else if("}"===t)r--;else if(","===t&&0===r){i(),n="";continue}n+=t}return n.length>0&&i(),t;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?t.push(Vs(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?t.push(n.slice(1,-1)):t.push(n):t.push(Number(n))}}class Ws extends Ls{constructor(...e){super(...e),this.packageName="dns-com-awns-ping",this.id=1}handle(e){if("dns-com-awns-ping"===e.name)this.send("reply",e.keyvals)}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}const qs=function({onlyFirst:e=!1}={}){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}();let $s=function(e){return e.Off="off",e.Unfocused="unfocused",e.All="all",e}({}),Hs=function(e){return e.SetGeneral="SET_GENERAL",e.SetSpeech="SET_SPEECH",e.SetChannels="SET_CHANNELS",e.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",e.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",e}({});const Js=new class{constructor(){this.state=void 0,this.listeners=new Set,this.dispatch=e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach((e=>e()))};const e=localStorage.getItem("preferences"),t=this.getInitialPreferences();this.state=e?this.mergePreferences(t,JSON.parse(e)):t}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:$s.Off,voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:$s.Off,notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,t){return{...e,general:{...e.general,...t.general},speech:{...e.speech,...t.speech},channels:t.channels?{...e.channels,...t.channels}:e.channels,editor:{...e.editor,...t.editor}}}reducer(e,t){switch(t.type){case Hs.SetGeneral:return{...e,general:t.data};case Hs.SetSpeech:return{...e,speech:t.data};case Hs.SetChannels:return{...e,channels:t.data};case Hs.SetEditorAutocompleteEnabled:return{...e,editor:{...e.editor,autocompleteEnabled:t.data}};case Hs.SetEditorAccessibilityMode:return{...e,editor:{...e.editor,accessibilityMode:t.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}};const Gs=class extends Et{constructor(e,t){super(),this.ws=void 0,this.decoder=new TextDecoder("utf8"),this.telnet=void 0,this.host=void 0,this.port=void 0,this.telnetNegotiation=!1,this.telnetBuffer="",this.gmcpHandlers={},this.mcpHandlers={},this.mcpMultilines={},this.mcpAuthKey=null,this.mcp_negotiate=void 0,this.mcp_getset=void 0,this.gmcp_char=void 0,this.worldData={playerId:"",playerName:"",roomId:"",liveKitTokens:[]},this.cacophony=void 0,this.host=e,this.port=t,this.mcp_negotiate=this.registerMcpPackage(Us),this.mcp_getset=this.registerMcpPackage(js),this.gmcp_char=this.registerGMCPPackage(Nt),this.cacophony=new ls}registerGMCPPackage(e){const t=new e(this);return this.gmcpHandlers[t.packageName]=t,t}registerMcpPackage(e){const t=new e(this);return this.mcpHandlers[t.packageName]=t,t}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new Pt(new It(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",(e=>{this.handleData(e)})),this.telnet.on("negotiation",((e,t)=>{e===xt.WILL&&t===_t.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(xt.DO,_t.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):e===xt.DO&&t===_t.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(xt.WILL,_t.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose React Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))})),this.telnet.on("gmcp",((e,t)=>{console.log("GMCP Package:",e,t),this.handleGmcpData(e,t)})),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout((()=>{this.connect()}),1e4)},this.ws.onerror=e=>{this.emit("error",e)}}send(e){this.ws.send(e)}close(){this.ws.close()}sendCommand(e){Js.getState().general.localEcho&&this.emit("command",e),this.send(e+"\r\n"),console.log("> "+e)}handleData(e){const t=this.decoder.decode(e).trimEnd();for(const n of t.split("\n"))n&&n.startsWith("#$#")?this.handleMcp(n):this.emitMessage(n)}handleMcp(e){if(e.startsWith("#$#*")){const t=As(e.trimEnd());return void(t&&(t.name in this.mcpMultilines?this.mcpMultilines[t.name].handleMultiline(t):console.warn("Received continuation for unknown multiline",t)))}if(e.startsWith("#$#:")){const t=As(e.trimEnd());return void(t&&(this.mcpMultilines[t.name].closeMultiline(t),delete this.mcpMultilines[t.name]))}const t=function(e){const t=e.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!t)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+e+"`"),null;const n=t[1],r=t[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(t[3]);){const e=s[1]||s[3],t=s[2]||s[4];e in i?console.log(`Invalid message format: duplicate key ${e} detected`):i[e]=t}return{name:n,authKey:r,keyvals:i}}(e.trimEnd());if(console.log("MCP Message:",t),"mcp"===(null===t||void 0===t?void 0:t.name.toLowerCase())&&null==t.authKey&&null==this.mcpAuthKey)this.mcpAuthKey=Ds(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if("mcp-negotiate-end"===(null===t||void 0===t?void 0:t.name));else if((null===t||void 0===t?void 0:t.authKey)===this.mcpAuthKey){let e=t.name;do{if(e in this.mcpHandlers)return this.mcpHandlers[e].handle(t),void("_data-tag"in t.keyvals&&(console.log("new multiline "+t.keyvals["_data-tag"]),this.mcpMultilines[t.keyvals["_data-tag"]]=this.mcpHandlers[e]));e=e.substring(0,e.lastIndexOf("-"))}while(e);console.log(`No handler for ${t.name}`)}else console.log(`Unexpected authkey "${null===t||void 0===t?void 0:t.authKey}", probably a spoofed message.`)}handleGmcpData(e,t){const n=e.lastIndexOf("."),r=e.substring(0,n),i=e.substring(n+1);console.log("GMCP Message:",r,i,t);const o=this.gmcpHandlers[r];if(!o)return void console.log("No handler for GMCP package:",r);const s=o["handle"+i];s?(console.log("Calling handler:",s),s.call(o,JSON.parse(t))):console.log("No handler for GMCP package:",r)}emitMessage(e){const t=Js.getState().speech.autoreadMode;t===$s.All&&this.speak(e),t!==$s.Unfocused||document.hasFocus()||this.speak(e),this.emit("message",e)}sendGmcp(e,t){console.log("Sending GMCP:",e,t),this.telnet.sendGmcp(e,t)}sendMcp(e,t){if("object"===typeof t){let e="";for(const[n,r]of Object.entries(t))e+=` ${n}: ${r||'""'}`;t=e}const n=`#$#${e} ${this.mcpAuthKey} ${t}\r\n`;this.send(n)}sendMcpML(e,t,n){this.send(`#$#* ${e} ${t}: ${n}\r\n`)}closeMcpML(e){this.send(`#$#: ${e}\r\n`)}openEditorWindow(e){console.log(e);const t=new BroadcastChannel("editor"),n=e.reference,r=encodeURIComponent(n);window.open(`/editor?reference=${r}`,"_blank");t.onmessage=r=>{console.log("editor window message",r),r.data.id===n&&("ready"===r.data.type?(console.log("sending editor window session",e),t.postMessage({type:"load",session:e})):"save"===r.data.type?(console.log("saving editor window with session",r.data.session),this.saveEditorWindow(r.data.session)):"close"===r.data.type&&(console.log("closing editor window"),t.close(),t.onmessage=null))}}saveEditorWindow(e){const t=Ds(),n={};n.reference=e.reference,n.type=e.type,n["content*"]="",n["_data-tag"]=t,this.sendMcp("dns-org-mud-moo-simpleedit-set",n);for(const r of e.contents)this.sendMcpML(t,"content",r);this.closeMcpML(t)}shutdown(){Object.values(this.mcpHandlers).forEach((e=>{e.shutdown()})),Object.values(this.gmcpHandlers).forEach((e=>{e.shutdown()}))}requestNotificationPermission(){"Notification"in window?"default"===Notification.permission&&Notification.requestPermission():console.log("This browser does not support desktop notification")}sendNotification(e,t){"Notification"in window?"granted"===Notification.permission&&new Notification(e,{body:t}):console.log("This browser does not support desktop notification")}speak(e){if(!("speechSynthesis"in window))return void console.log("This browser does not support speech synthesis");const t=new SpeechSynthesisUtterance(function(e){if("string"!==typeof e)throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);return e.replace(qs,"")}(e));t.lang="en-US";const{rate:n,pitch:r,voice:i,volume:o}=Js.getState().speech;t.rate=n,t.pitch=r,t.volume=o;const s=speechSynthesis.getVoices().find((e=>e.name===i));s&&(t.voice=s),speechSynthesis.speak(t)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var e;return(null===(e=document.getElementById("command-input"))||void 0===e?void 0:e.textContent)||""}setInput(e){const t=document.getElementById("command-input");t&&(t.textContent=e)}};class Ys{constructor(){this.history=[],this.currentIndex=null,this.unsentInput=""}addCommand(e){""===e.trim()||0!==this.history.length&&this.history[this.history.length-1]===e||(this.history.push(e),this.currentIndex=null,this.unsentInput="")}navigateUp(e){return null===this.currentIndex&&(this.unsentInput=e),this.history.length>0&&(null==this.currentIndex||this.currentIndex>0)?(this.currentIndex=null==this.currentIndex?this.history.length-1:this.currentIndex-1,this.history[this.currentIndex]):e}navigateDown(e){return null!==this.currentIndex?this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=null,""):this.unsentInput}getCurrentInput(){return null===this.currentIndex?this.unsentInput:this.history[this.currentIndex]}}const Ks=({onSend:e})=>{const[n,r]=(0,t.useState)(""),i=(0,t.useRef)(new Ys);return(0,vt.jsx)("textarea",{value:n,onChange:e=>r(e.target.value),onKeyDown:t=>{const o=i.current;if("Enter"!==t.key||t.shiftKey){if("ArrowUp"===t.key){t.preventDefault();const e=o.navigateUp(n);r(e)}else if("ArrowDown"===t.key){t.preventDefault();const e=o.navigateDown(n);r(e)}}else t.preventDefault(),e(n),o.addCommand(n),r("")},autoFocus:!0,id:"command-input"})},Xs=()=>{const[,e]=(0,t.useReducer)((e=>e+1),0);return(0,t.useEffect)((()=>Js.subscribe(e)),[]),[Js.getState(),Js.dispatch]},Qs=({tabs:e})=>{const[n,r]=(0,t.useState)(0),i=(0,t.useRef)([]);return(0,t.useEffect)((()=>{i.current=i.current.slice(0,e.length)}),[e]),(0,t.useEffect)((()=>{const t=t=>{switch(t.key){case"ArrowLeft":r((t=>t>0?t-1:e.length-1));break;case"ArrowRight":r((t=>t<e.length-1?t+1:0))}},o=i.current[n];return null===o||void 0===o||o.addEventListener("keydown",t),()=>{null===o||void 0===o||o.removeEventListener("keydown",t)}}),[e.length,n]),(0,t.useEffect)((()=>{var e;null===(e=i.current[n])||void 0===e||e.focus()}),[n]),(0,vt.jsxs)("div",{children:[(0,vt.jsx)("div",{role:"tablist","aria-label":"Tabs",children:e.map(((e,t)=>(0,vt.jsx)("button",{ref:e=>i.current[t]=e,role:"tab","aria-selected":n===t,id:`${e.label}-tab`,"aria-controls":`${e.label}-panel`,onClick:()=>r(t),tabIndex:n===t?void 0:-1,children:e.label},t)))}),e.map(((e,t)=>(0,vt.jsx)("div",{role:"tabpanel",id:`${e.label}-panel`,"aria-labelledby":`${e.label}-tab`,hidden:n!==t,tabIndex:n===t?0:-1,children:e.content},t)))]})},Zs=()=>{const[e,t]=Xs();return(0,vt.jsxs)("label",{children:[(0,vt.jsx)("input",{type:"checkbox",checked:e.general.localEcho,onChange:n=>t({type:Hs.SetGeneral,data:{...e.general,localEcho:n.target.checked}})}),"Local Echo"]})},ea=()=>{const[e,t]=Xs();return(0,vt.jsxs)("label",{children:["Auto Read:",(0,vt.jsxs)("select",{value:e.speech.autoreadMode,onChange:n=>t({type:Hs.SetSpeech,data:{...e.speech,autoreadMode:n.target.value}}),children:[(0,vt.jsx)("option",{value:"off",children:"Off"}),(0,vt.jsx)("option",{value:"unfocused",children:"Unfocused"}),(0,vt.jsx)("option",{value:"all",children:"Always"})]})]})},ta=()=>{const[e,n]=Xs(),r=(()=>{const[e,n]=(0,t.useState)([]);return(0,t.useEffect)((()=>{const e=()=>{n(window.speechSynthesis.getVoices())};e(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=e)}),[]),e})();return(0,vt.jsxs)("label",{children:["Voice:",(0,vt.jsx)("select",{value:e.speech.voice,onChange:t=>n({type:Hs.SetSpeech,data:{...e.speech,voice:t.target.value}}),children:r.map((e=>(0,vt.jsx)("option",{value:e.name,children:e.name},e.voiceURI)))})]})},na=()=>{const[e,t]=Xs();return(0,vt.jsxs)("label",{children:["Rate (0.1 - 10.0):",(0,vt.jsx)("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:e.speech.rate,onChange:n=>t({type:Hs.SetSpeech,data:{...e.speech,rate:parseFloat(n.target.value)}})})]})},ra=()=>{const[e,t]=Xs();return(0,vt.jsxs)("label",{children:["Pitch (0 - 2):",(0,vt.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:e.speech.pitch,onChange:n=>t({type:Hs.SetSpeech,data:{...e.speech,pitch:parseFloat(n.target.value)}})})]})},ia=()=>{const[e,t]=Xs();return(0,vt.jsxs)("label",{children:["Volume (0 - 1):",(0,vt.jsx)("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:e.speech.volume,onChange:n=>t({type:Hs.SetSpeech,data:{...e.speech,volume:parseFloat(n.target.value)}})})]})},oa=()=>(0,vt.jsxs)("div",{children:[(0,vt.jsx)(ea,{}),(0,vt.jsx)("br",{}),(0,vt.jsx)(ta,{}),(0,vt.jsx)("br",{}),(0,vt.jsx)(na,{}),(0,vt.jsx)("br",{}),(0,vt.jsx)(ra,{}),(0,vt.jsx)("br",{}),(0,vt.jsx)(ia,{}),(0,vt.jsx)("br",{})]}),sa=()=>{const[e,t]=Xs(),n=e.editor;return(0,vt.jsxs)("div",{children:[(0,vt.jsxs)("label",{children:[(0,vt.jsx)("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:e=>{t({type:Hs.SetEditorAutocompleteEnabled,data:e.target.checked})}}),"Enable Autocomplete"]}),(0,vt.jsx)("br",{}),(0,vt.jsxs)("label",{children:[(0,vt.jsx)("input",{type:"checkbox",checked:n.accessibilityMode,onChange:e=>{t({type:Hs.SetEditorAccessibilityMode,data:e.target.checked})}}),"Enable Accessibility Mode"]}),(0,vt.jsx)("br",{})]})},aa=()=>{const e=[{label:"General",content:(0,vt.jsx)(Zs,{})},{label:"Speech",content:(0,vt.jsx)(oa,{})},{label:"Editor",content:(0,vt.jsx)(sa,{})}];return(0,vt.jsx)(Qs,{tabs:e})};function ca(){return ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ca.apply(this,arguments)}var la="data-focus-lock",ua="data-focus-lock-disabled";function da(e,n){return function(e,n){var r=(0,t.useState)((function(){return{value:e,callback:n,facade:{get current(){return r.value},set current(e){var t=r.value;t!==e&&(r.value=e,r.callback(e,t))}}}}))[0];return r.callback=n,r.facade}(n||null,(function(t){return e.forEach((function(e){return function(e,t){return"function"===typeof e?e(t):e&&(e.current=t),e}(e,t)}))}))}var ha={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},pa=function(e){var n=e.children;return t.createElement(t.Fragment,null,t.createElement("div",{key:"guard-first","data-focus-guard":!0,"data-focus-auto-guard":!0,style:ha}),n,n&&t.createElement("div",{key:"guard-last","data-focus-guard":!0,"data-focus-auto-guard":!0,style:ha}))};pa.propTypes={},pa.defaultProps={children:null};var fa=function(e,t){return fa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},fa(e,t)};function ma(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}fa(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ga=function(){return ga=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ga.apply(this,arguments)};function va(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function ya(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(c){a=[6,c],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function ba(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function wa(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function ka(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function Sa(e){return this instanceof Sa?(this.v=e,this):new Sa(e)}function Ta(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof Sa?Promise.resolve(e.value.v).then(c,l):u(o[0][2],e)}(i[e](t))}catch(n){u(o[0][3],n)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Ea(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=ba(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create;"function"===typeof SuppressedError&&SuppressedError;function Ca(e){return e}function _a(e,t){void 0===t&&(t=Ca);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var i=t(e,r);return n.push(i),function(){n=n.filter((function(e){return e!==i}))}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var i=n;n=[],i.forEach(e),t=n}var o=function(){var n=t;t=[],n.forEach(e)},s=function(){return Promise.resolve().then(o)};s(),n={push:function(e){t.push(e),s()},filter:function(e){return t=t.filter(e),n}}}};return i}function xa(e,t){return void 0===t&&(t=Ca),_a(e,t)}var Ia=xa({},(function(e){return{target:e.target,currentTarget:e.currentTarget}})),Ra=xa(),Pa=xa(),Oa=function(e){void 0===e&&(e={});var t=_a(null);return t.options=ga({async:!0,ssr:!1},e),t}({async:!0}),Ma=[],Na=t.forwardRef((function(e,n){var r,i=t.useState(),o=i[0],s=i[1],a=t.useRef(),c=t.useRef(!1),l=t.useRef(null),u=e.children,d=e.disabled,h=e.noFocusGuards,p=e.persistentFocus,f=e.crossFrame,m=e.autoFocus,g=(e.allowTextSelection,e.group),v=e.className,y=e.whiteList,b=e.hasPositiveIndices,w=e.shards,k=void 0===w?Ma:w,S=e.as,T=void 0===S?"div":S,E=e.lockProps,C=void 0===E?{}:E,_=e.sideCar,x=e.returnFocus,I=e.focusOptions,R=e.onActivation,P=e.onDeactivation,O=t.useState({})[0],M=t.useCallback((function(){l.current=l.current||document&&document.activeElement,a.current&&R&&R(a.current),c.current=!0}),[R]),N=t.useCallback((function(){c.current=!1,P&&P(a.current)}),[P]);(0,t.useEffect)((function(){d||(l.current=null)}),[]);var A=t.useCallback((function(e){var t=l.current;if(t&&t.focus){var n="function"===typeof x?x(t):x;if(n){var r="object"===typeof n?n:void 0;l.current=null,e?Promise.resolve().then((function(){return t.focus(r)})):t.focus(r)}}}),[x]),D=t.useCallback((function(e){c.current&&Ia.useMedium(e)}),[]),L=Ra.useMedium,U=t.useCallback((function(e){a.current!==e&&(a.current=e,s(e))}),[]);var F=ca(((r={})[ua]=d&&"disabled",r[la]=g,r),C),B=!0!==h,j=B&&"tail"!==h,z=da([n,U]);return t.createElement(t.Fragment,null,B&&[t.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:d?-1:0,style:ha}),b?t.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:d?-1:1,style:ha}):null],!d&&t.createElement(_,{id:O,sideCar:Oa,observed:o,disabled:d,persistentFocus:p,crossFrame:f,autoFocus:m,whiteList:y,shards:k,onActivation:M,onDeactivation:N,returnFocus:A,focusOptions:I}),t.createElement(T,ca({ref:z},F,{className:v,onBlur:L,onFocus:D}),u),j&&t.createElement("div",{"data-focus-guard":!0,tabIndex:d?-1:0,style:ha}))}));Na.propTypes={},Na.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};const Aa=Na;function Da(e,t){return Da=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Da(e,t)}function La(e){return La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},La(e)}function Ua(e){var t=function(e,t){if("object"!=La(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=La(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==La(t)?t:String(t)}const Fa=function(e,n){return function(r){var i,o=[];function s(){i=e(o.map((function(e){return e.props}))),n(i)}var a,c,l,u=function(e){var n,a;function c(){return e.apply(this,arguments)||this}a=e,(n=c).prototype=Object.create(a.prototype),n.prototype.constructor=n,Da(n,a),c.peek=function(){return i};var l=c.prototype;return l.componentDidMount=function(){o.push(this),s()},l.componentDidUpdate=function(){s()},l.componentWillUnmount=function(){var e=o.indexOf(this);o.splice(e,1),s()},l.render=function(){return t.createElement(r,this.props)},c}(t.PureComponent);return a=u,c="displayName",l="SideEffect("+function(e){return e.displayName||e.name||"Component"}(r)+")",(c=Ua(c))in a?Object.defineProperty(a,c,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[c]=l,u}};var Ba=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},ja=function(e){return Array.isArray(e)?e:[e]},za=function(e){return Array.isArray(e)?e[0]:e},Va=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},Wa=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},qa=function(e,t){return!e||Wa(e)||!function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var t=window.getComputedStyle(e,null);return!(!t||!t.getPropertyValue)&&("none"===t.getPropertyValue("display")||"hidden"===t.getPropertyValue("visibility"))}(e)&&t(Va(e))},$a=function(e,t){var n=e.get(t);if(void 0!==n)return n;var r=qa(t,$a.bind(void 0,e));return e.set(t,r),r},Ha=function(e,t){var n=e.get(t);if(void 0!==n)return n;var r=function(e,t){return!(e&&!Wa(e))||!!Ka(e)&&t(Va(e))}(t,Ha.bind(void 0,e));return e.set(t,r),r},Ja=function(e){return e.dataset},Ga=function(e){return"INPUT"===e.tagName},Ya=function(e){return Ga(e)&&"radio"===e.type},Ka=function(e){var t=e.getAttribute("data-no-autofocus");return![!0,"true",""].includes(t)},Xa=function(e){var t;return Boolean(e&&(null===(t=Ja(e))||void 0===t?void 0:t.focusGuard))},Qa=function(e){return!Xa(e)},Za=function(e){return Boolean(e)},ec=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return n||r},tc=function(e,t,n){return Ba(e).map((function(e,t){return{node:e,index:t,tabIndex:n&&-1===e.tabIndex?(e.dataset||{}).focusGuard?0:-1:e.tabIndex}})).filter((function(e){return!t||e.tabIndex>=0})).sort(ec)},nc=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"].join(","),rc="".concat(nc,", [data-focus-guard]"),ic=function(e,t){return Ba((e.shadowRoot||e).children).reduce((function(e,n){return e.concat(n.matches(t?rc:nc)?[n]:[],ic(n))}),[])},oc=function(e,t){return e.reduce((function(e,n){var r,i=ic(n,t),o=(r=[]).concat.apply(r,i.map((function(e){return function(e,t){var n;return e instanceof HTMLIFrameElement&&(null===(n=e.contentDocument)||void 0===n?void 0:n.body)?oc([e.contentDocument.body],t):[e]}(e,t)})));return e.concat(o,n.parentNode?Ba(n.parentNode.querySelectorAll(nc)).filter((function(e){return e===n})):[])}),[])},sc=function(e,t){return Ba(e).filter((function(e){return $a(t,e)})).filter((function(e){return function(e){return!((Ga(e)||function(e){return"BUTTON"===e.tagName}(e))&&("hidden"===e.type||e.disabled))}(e)}))},ac=function(e,t){return void 0===t&&(t=new Map),Ba(e).filter((function(e){return Ha(t,e)}))},cc=function(e,t,n){return tc(sc(oc(e,n),t),!0,n)},lc=function(e,t){return tc(sc(oc(e),t),!1)},uc=function(e,t){return sc(function(e){var t=e.querySelectorAll("[".concat("data-autofocus-inside","]"));return Ba(t).map((function(e){return oc([e])})).reduce((function(e,t){return e.concat(t)}),[])}(e),t)},dc=function(e,t){return e.shadowRoot?dc(e.shadowRoot,t):!(void 0===Object.getPrototypeOf(e).contains||!Object.getPrototypeOf(e).contains.call(e,t))||Ba(e.children).some((function(e){var n;if(e instanceof HTMLIFrameElement){var r=null===(n=e.contentDocument)||void 0===n?void 0:n.body;return!!r&&dc(r,t)}return dc(e,t)}))},hc=function(e){if(void 0===e&&(e=document),e&&e.activeElement){var t=e.activeElement;return t.shadowRoot?hc(t.shadowRoot):t instanceof HTMLIFrameElement&&function(e){try{return e()}catch(t){return}}((function(){return t.contentWindow.document}))?hc(t.contentWindow.document):t}},pc=function(e){return e.parentNode?pc(e.parentNode):e},fc=function(e){return ja(e).filter(Boolean).reduce((function(e,t){var n=t.getAttribute(la);return e.push.apply(e,n?function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=e[r].compareDocumentPosition(e[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter((function(e,n){return!t.has(n)}))}(Ba(pc(t).querySelectorAll("[".concat(la,'="').concat(n,'"]:not([').concat(ua,'="disabled"])')))):[t]),e}),[])},mc=function(e,t){return void 0===t&&(t=hc(za(e).ownerDocument)),!(!t||t.dataset&&t.dataset.focusGuard)&&fc(e).some((function(e){return dc(e,t)||function(e,t){return Boolean(Ba(e.querySelectorAll("iframe")).some((function(e){return function(e,t){return e===t}(e,t)})))}(e,t)}))},gc=function(e,t){return Ya(e)&&e.name?function(e,t){return t.filter(Ya).filter((function(t){return t.name===e.name})).filter((function(e){return e.checked}))[0]||e}(e,t):e},vc=function(e){return e[0]&&e.length>1?gc(e[0],e):e[0]},yc=function(e,t){return e.length>1?e.indexOf(gc(e[t],e)):t},bc="NEW_FOCUS",wc=function(e,t,n,r){var i=e.length,o=e[0],s=e[i-1],a=Xa(n);if(!(n&&e.indexOf(n)>=0)){var c=void 0!==n?t.indexOf(n):-1,l=r?t.indexOf(r):c,u=r?e.indexOf(r):-1,d=c-l,h=t.indexOf(o),p=t.indexOf(s),f=function(e){var t=new Set;return e.forEach((function(n){return t.add(gc(n,e))})),e.filter((function(e){return t.has(e)}))}(t),m=(void 0!==n?f.indexOf(n):-1)-(r?f.indexOf(r):c),g=yc(e,0),v=yc(e,i-1);return-1===c||-1===u?bc:!d&&u>=0?u:c<=h&&a&&Math.abs(d)>1?v:c>=p&&a&&Math.abs(d)>1?g:d&&Math.abs(m)>1?u:c<=h?v:c>p?g:d?Math.abs(d)>1?u:(i+u+d)%i:void 0}},kc=function(e,t,n){var r,i=e.map((function(e){return e.node})),o=ac(i.filter((r=n,function(e){var t,n=null===(t=Ja(e))||void 0===t?void 0:t.autofocus;return e.autofocus||void 0!==n&&"false"!==n||r.indexOf(e)>=0})));return o&&o.length?vc(o):vc(ac(t))},Sc=function(e,t){return void 0===t&&(t=[]),t.push(e),e.parentNode&&Sc(e.parentNode.host||e.parentNode,t),t},Tc=function(e,t){for(var n=Sc(e),r=Sc(t),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},Ec=function(e,t,n){var r=ja(e),i=ja(t),o=r[0],s=!1;return i.filter(Boolean).forEach((function(e){s=Tc(s||e,e)||s,n.filter(Boolean).forEach((function(e){var t=Tc(o,e);t&&(s=!s||dc(t,s)?t:Tc(t,s))}))})),s},Cc=function(e,t){var n=hc(ja(e).length>0?document:za(e).ownerDocument),r=fc(e).filter(Qa),i=Ec(n||e,e,r),o=new Map,s=lc(r,o),a=cc(r,o).filter((function(e){var t=e.node;return Qa(t)}));if(a[0]||(a=s)[0]){var c=lc([i],o).map((function(e){return e.node})),l=function(e,t){var n=new Map;return t.forEach((function(e){return n.set(e.node,e)})),e.map((function(e){return n.get(e)})).filter(Za)}(c,a),u=l.map((function(e){return e.node})),d=wc(u,c,n,t);if(d===bc){var h=kc(s,u,function(e,t){return e.reduce((function(e,n){return e.concat(uc(n,t))}),[])}(r,o));return h?{node:h}:void console.warn("focus-lock: cannot find any node to move focus into")}return void 0===d?d:l[d]}},_c=0,xc=!1,Ic=function(e,t,n){void 0===n&&(n={});var r,i,o=Cc(e,t);if(!xc&&o){if(_c>2)return console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),xc=!0,void setTimeout((function(){xc=!1}),1);_c++,r=o.node,i=n.focusOptions,"focus"in r&&r.focus(i),"contentWindow"in r&&r.contentWindow&&r.contentWindow.focus(),_c--}};function Rc(e){setTimeout(e,1)}var Pc=function(){return document&&document.activeElement===document.body||function(e){void 0===e&&(e=document);var t=hc(e);return!!t&&Ba(e.querySelectorAll("[".concat("data-no-focus-lock","]"))).some((function(e){return dc(e,t)}))}()},Oc=null,Mc=null,Nc=null,Ac=!1,Dc=function(){return!0};function Lc(e,t,n,r){var i=null,o=e;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else{if(!s.lockItem)break;if(o!==e)return;i=null}}while((o+=n)!==t);i&&(i.node.tabIndex=0)}var Uc=function(e){return e&&"current"in e?e.current:e},Fc=function e(t,n,r){return n&&(n.host===t&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&e(t,n.parentNode,r))},Bc=function(){var e,t=!1;if(Oc){var n=Oc,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,c=n.focusOptions,l=r||Nc&&Nc.portaledElement,u=document&&document.activeElement;if(l){var d=[l].concat(s.map(Uc).filter(Boolean));if(u&&!function(e){return(Oc.whiteList||Dc)(e)}(u)||(i||(a?Boolean(Ac):"meanwhile"===Ac)||!Pc()||!Mc&&o)&&(l&&!(mc(d)||u&&function(e,t){return t.some((function(t){return Fc(e,t,t)}))}(u,d)||(e=u,Nc&&Nc.portaledElement===e))&&(document&&!Mc&&u&&!o?(u.blur&&u.blur(),document.body.focus()):(t=Ic(d,Mc,{focusOptions:c}),Nc={})),Ac=!1,Mc=document&&document.activeElement),document){var h=document&&document.activeElement,p=function(e){var t=fc(e).filter(Qa),n=Ec(e,e,t),r=new Map,i=cc([n],r,!0),o=cc(t,r).filter((function(e){var t=e.node;return Qa(t)})).map((function(e){return e.node}));return i.map((function(e){var t=e.node;return{node:t,index:e.index,lockItem:o.indexOf(t)>=0,guard:Xa(t)}}))}(d),f=p.map((function(e){return e.node})).indexOf(h);f>-1&&(p.filter((function(e){var t=e.guard,n=e.node;return t&&n.dataset.focusAutoGuard})).forEach((function(e){return e.node.removeAttribute("tabIndex")})),Lc(f,p.length,1,p),Lc(f,-1,-1,p))}}}return t},jc=function(e){Bc()&&e&&(e.stopPropagation(),e.preventDefault())},zc=function(){return Rc(Bc)},Vc=function(e){var t=e.target,n=e.currentTarget;n.contains(t)||(Nc={observerNode:n,portaledElement:t})},Wc=function(){Ac="just",Rc((function(){Ac="meanwhile"}))};Ia.assignSyncMedium(Vc),Ra.assignMedium(zc),Pa.assignMedium((function(e){return e({moveFocusInside:Ic,focusInside:mc})}));const qc=Fa((function(e){return e.filter((function(e){return!e.disabled}))}),(function(e){var t=e.slice(-1)[0];t&&!Oc&&(document.addEventListener("focusin",jc),document.addEventListener("focusout",zc),window.addEventListener("blur",Wc));var n=Oc,r=n&&t&&t.id===n.id;Oc=t,n&&!r&&(n.onDeactivation(),e.filter((function(e){return e.id===n.id})).length||n.returnFocus(!t)),t?(Mc=null,r&&n.observed===t.observed||t.onActivation(),Bc(),Rc(Bc)):(document.removeEventListener("focusin",jc),document.removeEventListener("focusout",zc),window.removeEventListener("blur",Wc),Mc=null)}))((function(){return null}));var $c=t.forwardRef((function(e,n){return t.createElement(Aa,ca({sideCar:qc,ref:n},e))})),Hc=Aa.propTypes||{};Hc.sideCar,function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n])}(Hc,["sideCar"]);$c.propTypes={};const Jc=$c,Gc=t.forwardRef(((e,n)=>{const[r,i]=(0,t.useState)(!1),o=(0,t.useRef)(null);return t.useImperativeHandle(n,(()=>({open(){i(!0)},close(){i(!1)}}))),(0,t.useEffect)((()=>{var e;r&&(null===(e=o.current)||void 0===e||e.focus())}),[r]),(0,t.useEffect)((()=>{const e=e=>{"Escape"===e.key&&i(!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[]),(0,vt.jsx)(Jc,{disabled:!r,children:(0,vt.jsxs)("dialog",{className:"preferences-dialog",open:r,ref:o,tabIndex:-1,"aria-label":"Preferences",children:[r&&(0,vt.jsx)(aa,{}),(0,vt.jsx)("button",{onClick:()=>i(!1),children:"Close"})]})})}));var Yc={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Kc=t.createContext&&t.createContext(Yc),Xc=function(){return Xc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xc.apply(this,arguments)},Qc=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Zc(e){return e&&e.map((function(e,n){return t.createElement(e.tag,Xc({key:n},e.attr),Zc(e.child))}))}function el(e){return function(n){return t.createElement(tl,Xc({attr:Xc({},e.attr)},n),Zc(e.child))}}function tl(e){var n=function(n){var r,i=e.attr,o=e.size,s=e.title,a=Qc(e,["attr","size","title"]),c=o||n.size||"1em";return n.className&&(r=n.className),e.className&&(r=(r?r+" ":"")+e.className),t.createElement("svg",Xc({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,a,{className:r,style:Xc(Xc({color:e.color||n.color},n.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),s&&t.createElement("title",null,s),e.children)};return void 0!==Kc?t.createElement(Kc.Consumer,null,(function(e){return n(e)})):n(Yc)}function nl(e){return el({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(e)}function rl(e){return el({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(e)}function il(e){return el({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"}}]})(e)}function ol(e){return el({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(e)}function sl(e){return el({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"}}]})(e)}function al(e){return el({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"}}]})(e)}function cl(e){return el({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"}}]})(e)}const ll=({client:e,onClearLog:n,onSaveLog:r,onToggleUsers:i,onOpenPrefs:o})=>{const[s,a]=t.useState(e.cacophony.muted);return(0,vt.jsxs)("div",{className:"toolbar",children:[(0,vt.jsxs)("button",{onClick:r,accessKey:"l",children:[(0,vt.jsx)(ol,{}),"Save Log"]}),(0,vt.jsxs)("button",{onClick:n,accessKey:"c",children:[(0,vt.jsx)(il,{}),"Clear Log"]}),(0,vt.jsxs)("button",{onClick:o,accessKey:"p",children:[(0,vt.jsx)(nl,{}),"Preferences"]}),(0,vt.jsxs)("button",{onClick:()=>{a(!s),e.cacophony.muted=!s},accessKey:"m",children:[s?(0,vt.jsx)(cl,{}):(0,vt.jsx)(al,{}),s?"Unmute":"Mute"]}),(0,vt.jsx)("button",{onClick:i,accessKey:"u",children:"Show/Hide Users"}),(0,vt.jsxs)("label",{children:["Volume",(0,vt.jsx)("input",{type:"range",min:"0",max:"100",onChange:t=>e.cacophony.setGlobalVolume(Number(t.target.value)/100)})]})]})};class ul extends t.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",(e=>this.setState({statusText:e}))),e.client.on("connect",(()=>this.setState({statusText:"Connected"}))),e.client.on("disconnect",(()=>this.setState({statusText:"Disconnected"})))}render(){return(0,vt.jsx)("div",{className:"statusbar",children:this.state.statusText})}}const dl=ul,hl=({users:e})=>(0,vt.jsxs)("div",{className:"sidebar",children:[(0,vt.jsx)("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),(0,vt.jsx)("div",{className:"sidebar-content",children:(0,vt.jsx)("ul",{children:e.map((e=>{let t="";return e.away&&(t+=" away"),e.idle&&(t+=" idle"),(0,vt.jsx)("li",{className:t,children:e.Name},e.Object)}))})})]});function pl(e,t){return t.forEach((function(t){t&&"string"!==typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var fl="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function ml(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gl,vl={exports:{}};gl=vl,function(e,t){gl.exports?gl.exports=t():e.log=t()}(fl,(function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"===typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(r){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function a(e,n,r){return function(){typeof console!==t&&(s.call(this,n,r),this[e].apply(this,arguments))}}function c(r,s,c){return function(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}(r)||a.apply(this,arguments)}function l(e,n,i){var o,a=this;n=null==n?"WARN":n;var l="loglevel";function u(){var e;if(typeof window!==t&&l){try{e=window.localStorage[l]}catch(i){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(l)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(i){}return void 0===a.levels[e]&&(e=void 0),e}}"string"===typeof e?l+=":"+e:"symbol"===typeof e&&(l=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||c,a.getLevel=function(){return o},a.setLevel=function(n,i){if("string"===typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"===typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==i&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&l){try{return void(window.localStorage[l]=n)}catch(i){}try{window.document.cookie=encodeURIComponent(l)+"="+n+";"}catch(i){}}}(n),s.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){n=e,u()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(n,!1),function(){if(typeof window!==t&&l){try{return void window.localStorage.removeItem(l)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var d=u();null==d&&(d=n),a.setLevel(d,!1)}var u=new l,d={};u.getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new l(e,u.getLevel(),u.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return u.noConflict=function(){return typeof window!==t&&window.log===u&&(window.log=h),u},u.getLoggers=function(){return d},u.default=u,u}));var yl,bl=vl.exports;!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(yl||(yl={}));const wl=bl.getLogger("livekit");function kl(e,t){if(!e)throw new Error(t)}wl.setDefaultLevel(yl.info),bl.getLogger("lk-e2ee");const Sl=34028234663852886e22,Tl=-34028234663852886e22,El=4294967295,Cl=2147483647,_l=-2147483648;function xl(e){if("number"!==typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>Cl||e<_l)throw new Error("invalid int 32: "+e)}function Il(e){if("number"!==typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>El||e<0)throw new Error("invalid uint 32: "+e)}function Rl(e){if("number"!==typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>Sl||e<Tl))throw new Error("invalid float 32: "+e)}const Pl=Symbol("@bufbuild/protobuf/enum-type");function Ol(e){const t=e[Pl];return kl(t,"missing enum type on enum object"),t}function Ml(e,t,n,r){e[Pl]=Nl(t,n.map((t=>({no:t.no,name:t.name,localName:e[t.no]}))))}function Nl(e,t,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of t){const e=Dl(s);o.push(e),r[s.name]=e,i[s.no]=e}return{typeName:e,values:o,findName:e=>r[e],findNumber:e=>i[e]}}function Al(e,t,n){const r={};for(const i of t){const e=Dl(i);r[e.localName]=e.no,r[e.no]=e.localName}return Ml(r,e,t),r}function Dl(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class Ll{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,r=n.makeReadOptions(t);return n.readMessage(this,r.readerFactory(e),e.byteLength,r),this}fromJson(e,t){const n=this.getType(),r=n.runtime.json,i=r.makeReadOptions(t);return r.readMessage(n,e,i,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(r){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(r instanceof Error?r.message:String(r)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),r=n.writerFactory();return t.writeMessage(this,r,n),r.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null===e||void 0===e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}var Ul,Fl;function Bl(){let e=0,t=0;for(let r=0;r<28;r+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<r,0==(128&n))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<r,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function jl(e,t,n){for(let o=0;o<28;o+=7){const r=e>>>o,i=!(r>>>7==0&&0==t),s=255&(i?128|r:r);if(n.push(s),!i)return}const r=e>>>28&15|(7&t)<<4,i=!(t>>3==0);if(n.push(255&(i?128|r:r)),i){for(let e=3;e<31;e+=7){const r=t>>>e,i=!(r>>>7==0),o=255&(i?128|r:r);if(n.push(o),!i)return}n.push(t>>>31&1)}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Ul||(Ul={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(Fl||(Fl={}));const zl=4294967296;function Vl(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let r=0,i=0;function o(t,o){const s=Number(e.slice(t,o));i*=n,r=r*n+s,r>=zl&&(i+=r/zl|0,r%=zl)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?$l(r,i):ql(r,i)}function Wl(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(zl*t+e);const n=16777215&(e>>>24|t<<8),r=t>>16&65535;let i=(16777215&e)+6777216*n+6710656*r,o=n+8147497*r,s=2*r;const a=1e7;return i>=a&&(o+=Math.floor(i/a),i%=a),o>=a&&(s+=Math.floor(o/a),o%=a),s.toString()+Hl(o)+Hl(i)}function ql(e,t){return{lo:0|e,hi:0|t}}function $l(e,t){return t=~t,e?e=1+~e:t+=1,ql(e,t)}const Hl=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Jl(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Gl(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let n=5;0!==(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}const Yl=function(){const e=new DataView(new ArrayBuffer(8));if("function"===typeof BigInt&&"function"===typeof e.getBigInt64&&"function"===typeof e.getBigUint64&&"function"===typeof e.setBigInt64&&"function"===typeof e.setBigUint64&&("object"!=typeof process||"1"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),r=BigInt("0"),i=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const r="bigint"==typeof e?e:BigInt(e);if(r>n||r<t)throw new Error("int64 invalid: ".concat(e));return r},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>i||t<r)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>kl(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>kl(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),Vl(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),Vl(e)),dec:(e,t)=>function(e,t){let n=ql(e,t);const r=2147483648&n.hi;r&&(n=$l(n.lo,n.hi));const i=Wl(n.lo,n.hi);return r?"-"+i:i}(e,t),uDec:(e,t)=>Wl(e,t)}}();var Kl;!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Kl||(Kl={}));class Xl{constructor(e){this.stack=[],this.textEncoder=null!==e&&void 0!==e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let r=0;r<this.chunks.length;r++)e+=this.chunks[r].length;let t=new Uint8Array(e),n=0;for(let r=0;r<this.chunks.length;r++)t.set(this.chunks[r],n),n+=this.chunks[r].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Il(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return xl(e),Jl(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Rl(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Il(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){xl(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return xl(e),Jl(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=Yl.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=Yl.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=Yl.enc(e);return jl(t.lo,t.hi,this.buf),this}sint64(e){let t=Yl.enc(e),n=t.hi>>31;return jl(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=Yl.uEnc(e);return jl(t.lo,t.hi,this.buf),this}}class Ql{constructor(e,t){this.varint64=Bl,this.uint32=Gl,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!==t&&void 0!==t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case Kl.Varint:for(;128&this.buf[this.pos++];);break;case Kl.Bit64:this.pos+=4;case Kl.Bit32:this.pos+=4;break;case Kl.LengthDelimited:let t=this.uint32();this.pos+=t;break;case Kl.StartGroup:let n;for(;(n=this.tag()[1])!==Kl.EndGroup;)this.skip(n);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return Yl.dec(...this.varint64())}uint64(){return Yl.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,Yl.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Yl.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Yl.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function Zl(e,t){return t instanceof Ll||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}function eu(e,t,n){if(t===n)return!0;if(e==Ul.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case Ul.UINT64:case Ul.FIXED64:case Ul.INT64:case Ul.SFIXED64:case Ul.SINT64:return t==n}return!1}function tu(e,t){switch(e){case Ul.BOOL:return!1;case Ul.UINT64:case Ul.FIXED64:case Ul.INT64:case Ul.SFIXED64:case Ul.SINT64:return 0==t?Yl.zero:"0";case Ul.DOUBLE:case Ul.FLOAT:return 0;case Ul.BYTES:return new Uint8Array(0);case Ul.STRING:return"";default:return 0}}function nu(e,t){const n=void 0===t;let r=Kl.Varint,i=0===t;switch(e){case Ul.STRING:i=n||!t.length,r=Kl.LengthDelimited;break;case Ul.BOOL:i=!1===t;break;case Ul.DOUBLE:r=Kl.Bit64;break;case Ul.FLOAT:r=Kl.Bit32;break;case Ul.INT64:case Ul.UINT64:i=n||0==t;break;case Ul.FIXED64:i=n||0==t,r=Kl.Bit64;break;case Ul.BYTES:i=n||!t.byteLength,r=Kl.LengthDelimited;break;case Ul.FIXED32:case Ul.SFIXED32:r=Kl.Bit32;break;case Ul.SFIXED64:i=n||0==t,r=Kl.Bit64;break;case Ul.SINT64:i=n||0==t}return[r,Ul[e].toLowerCase(),n||i]}Ul.DOUBLE,Ul.FLOAT,Ul.INT64,Ul.UINT64,Ul.INT32,Ul.UINT32,Ul.BOOL,Ul.STRING,Ul.BYTES;const ru=Symbol("@bufbuild/protobuf/unknown-fields"),iu={readUnknownFields:!0,readerFactory:e=>new Ql(e)},ou={writeUnknownFields:!0,writerFactory:()=>new Xl};function su(e){return e?Object.assign(Object.assign({},iu),e):iu}function au(e){return e?Object.assign(Object.assign({},ou),e):ou}function cu(e,t,n){return t.getType().runtime.bin.readMessage(t,e,e.uint32(),n),t}function lu(e,t,n){const r=t.uint32(),i=t.pos+r;let o,s;for(;t.pos<i;){let[r]=t.tag();switch(r){case 1:o=du(t,e.K);break;case 2:switch(e.V.kind){case"scalar":s=du(t,e.V.T);break;case"enum":s=t.int32();break;case"message":s=cu(t,new e.V.T,n)}}}if(void 0===o){let t=tu(e.K,Fl.BIGINT);o=e.K==Ul.BOOL?t.toString():t}if("string"!=typeof o&&"number"!=typeof o&&(o=o.toString()),void 0===s)switch(e.V.kind){case"scalar":s=tu(e.V.T,Fl.BIGINT);break;case"enum":s=0;break;case"message":s=new e.V.T}return[o,s]}function uu(e,t){const n=du(e,t);return"bigint"==typeof n?n.toString():n}function du(e,t){switch(t){case Ul.STRING:return e.string();case Ul.BOOL:return e.bool();case Ul.DOUBLE:return e.double();case Ul.FLOAT:return e.float();case Ul.INT32:return e.int32();case Ul.INT64:return e.int64();case Ul.UINT64:return e.uint64();case Ul.FIXED64:return e.fixed64();case Ul.BYTES:return e.bytes();case Ul.FIXED32:return e.fixed32();case Ul.SFIXED32:return e.sfixed32();case Ul.SFIXED64:return e.sfixed64();case Ul.SINT64:return e.sint64();case Ul.UINT32:return e.uint32();case Ul.SINT32:return e.sint32()}}function hu(e,t,n,r,i){e.tag(n.no,Kl.LengthDelimited),e.fork();let o=r;switch(n.K){case Ul.INT32:case Ul.FIXED32:case Ul.UINT32:case Ul.SFIXED32:case Ul.SINT32:o=Number.parseInt(r);break;case Ul.BOOL:kl("true"==r||"false"==r),o="true"==r}switch(fu(e,n.K,1,o,!0),n.V.kind){case"scalar":fu(e,n.V.T,2,i,!0);break;case"enum":fu(e,Ul.INT32,2,i,!0);break;case"message":pu(e,t,n.V.T,2,i)}e.join()}function pu(e,t,n,r,i){if(void 0!==i){const o=Zl(n,i);e.tag(r,Kl.LengthDelimited).bytes(o.toBinary(t))}}function fu(e,t,n,r,i){let[o,s,a]=nu(t,r);a&&!i||e.tag(n,o)[s](r)}function mu(e,t,n,r){if(!r.length)return;e.tag(n,Kl.LengthDelimited).fork();let[,i]=nu(t);for(let o=0;o<r.length;o++)e[i](r[o]);e.join()}let gu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),vu=[];for(let n=0;n<gu.length;n++)vu[gu[n].charCodeAt(0)]=n;vu["-".charCodeAt(0)]=gu.indexOf("+"),vu["_".charCodeAt(0)]=gu.indexOf("/");const yu={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,r=new Uint8Array(t),i=0,o=0,s=0;for(let a=0;a<e.length;a++){if(n=vu[e.charCodeAt(a)],void 0===n)switch(e[a]){case"=":o=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:s=n,o=1;break;case 1:r[i++]=s<<2|(48&n)>>4,s=n,o=2;break;case 2:r[i++]=(15&s)<<4|(60&n)>>2,s=n,o=3;break;case 3:r[i++]=(3&s)<<6|n,o=0}}if(1==o)throw Error("invalid base64 string.");return r.subarray(0,i)},enc(e){let t,n="",r=0,i=0;for(let o=0;o<e.length;o++)switch(t=e[o],r){case 0:n+=gu[t>>2],i=(3&t)<<4,r=1;break;case 1:n+=gu[i|t>>4],i=(15&t)<<2,r=2;break;case 2:n+=gu[i|t>>6],n+=gu[63&t],r=0}return r&&(n+=gu[i],n+="=",1==r&&(n+="=")),n}},bu={ignoreUnknownFields:!1},wu={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function ku(e){return e?Object.assign(Object.assign({},bu),e):bu}function Su(e){return e?Object.assign(Object.assign({},wu),e):wu}function Tu(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function Eu(e,t,n){switch(e){case Ul.DOUBLE:case Ul.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const i=Number(t);if(Number.isNaN(i))break;if(!Number.isFinite(i))break;return e==Ul.FLOAT&&Rl(i),i;case Ul.INT32:case Ul.FIXED32:case Ul.SFIXED32:case Ul.SINT32:case Ul.UINT32:if(null===t)return 0;let o;if("number"==typeof t?o=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(o=Number(t)),void 0===o)break;return e==Ul.UINT32?Il(o):xl(o),o;case Ul.INT64:case Ul.SFIXED64:case Ul.SINT64:if(null===t)return Yl.zero;if("number"!=typeof t&&"string"!=typeof t)break;const s=Yl.parse(t);return n?s.toString():s;case Ul.FIXED64:case Ul.UINT64:if(null===t)return Yl.zero;if("number"!=typeof t&&"string"!=typeof t)break;const a=Yl.uParse(t);return n?a.toString():a;case Ul.BOOL:if(null===t)return!1;if("boolean"!==typeof t)break;return t;case Ul.STRING:if(null===t)return"";if("string"!==typeof t)break;try{encodeURIComponent(t)}catch(r){throw new Error("invalid UTF8")}return t;case Ul.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!==typeof t)break;return yu.dec(t)}throw new Error}function Cu(e,t,n){if(null===t)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const r=e.findName(t);if(r||n)return null===r||void 0===r?void 0:r.no}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(Tu(t)))}function _u(e,t,n,r){var i;if(void 0===t)return t;if(0===t&&!n)return;if(r)return t;if("google.protobuf.NullValue"==e.typeName)return null;const o=e.findNumber(t);return null!==(i=null===o||void 0===o?void 0:o.name)&&void 0!==i?i:t}function xu(e,t,n){if(void 0!==t)switch(e){case Ul.INT32:case Ul.SFIXED32:case Ul.SINT32:case Ul.FIXED32:case Ul.UINT32:return kl("number"==typeof t),0!=t||n?t:void 0;case Ul.FLOAT:case Ul.DOUBLE:return kl("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":0!==t||n?t:void 0;case Ul.STRING:return kl("string"==typeof t),t.length>0||n?t:void 0;case Ul.BOOL:return kl("boolean"==typeof t),t||n?t:void 0;case Ul.UINT64:case Ul.FIXED64:case Ul.INT64:case Ul.SFIXED64:case Ul.SINT64:return kl("bigint"==typeof t||"string"==typeof t||"number"==typeof t),n||0!=t?t.toString(10):void 0;case Ul.BYTES:return kl(t instanceof Uint8Array),n||t.byteLength>0?yu.enc(t):void 0}}function Iu(e){if(void 0===e)return e;if(e instanceof Ll)return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function Ru(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class Pu{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort(((e,t)=>e.no-t.no))),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Ou(e,t){const n=Nu(e);return t?n:Fu(Uu(n))}const Mu=Nu;function Nu(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let i=e.charAt(r);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),n.push(i)}}return n.join("")}const Au=new Set(["constructor","toString","toJSON","valueOf"]),Du=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Lu=e=>"".concat(e,"$"),Uu=e=>Du.has(e)?Lu(e):e,Fu=e=>Au.has(e)?Lu(e):e;class Bu{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Ou(e,!1)}addField(e){kl(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const ju=function(e,t,n,r){return{syntax:e,json:t,bin:n,util:r,makeMessageType(e,t,n){return function(e,t,n,r){var i;const o=null!==(i=null===r||void 0===r?void 0:r.localName)&&void 0!==i?i:t.substring(t.lastIndexOf(".")+1),s={[o]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[o];return Object.setPrototypeOf(s.prototype,new Ll),Object.assign(s,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new s).fromBinary(e,t),fromJson:(e,t)=>(new s).fromJson(e,t),fromJsonString:(e,t)=>(new s).fromJsonString(e,t),equals:(t,n)=>e.util.equals(s,t,n)}),s}(this,e,t,n)},makeEnum:Al,makeEnumType:Nl,getEnumType:Ol}}("proto3",function(e){const t=e(_u,xu);return{makeReadOptions:ku,makeWriteOptions:Su,readMessage(e,t,n,r){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(this.debug(t)));r=null!==r&&void 0!==r?r:new e;const i={};for(const[s,a]of Object.entries(t)){const t=e.fields.findJsonName(s);if(!t){if(!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(s,'" is unknown'));continue}let c=t.localName,l=r;if(t.oneof){if(null===a&&"scalar"==t.kind)continue;const n=i[t.oneof.localName];if(n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(s,'"'));i[t.oneof.localName]=s,l=l[t.oneof.localName]={case:c},c="value"}if(t.repeated){if(null===a)continue;if(!Array.isArray(a))throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a)));const r=l[c];for(const i of a){if(null===i)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(i)));let s;switch(t.kind){case"message":s=t.T.fromJson(i,n);break;case"enum":if(s=Cu(t.T,i,n.ignoreUnknownFields),void 0===s)continue;break;case"scalar":try{s=Eu(t.T,i,t.L)}catch(o){let n="cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(i));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}r.push(s)}}else if("map"==t.kind){if(null===a)continue;if(Array.isArray(a)||"object"!=typeof a)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a)));const r=l[c];for(const[i,s]of Object.entries(a)){if(null===s)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: map value null"));let c;switch(t.V.kind){case"message":c=t.V.T.fromJson(s,n);break;case"enum":if(c=Cu(t.V.T,s,n.ignoreUnknownFields),void 0===c)continue;break;case"scalar":try{c=Eu(t.V.T,s,Fl.BIGINT)}catch(o){let n="cannot decode map value for field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}try{r[Eu(t.K,t.K==Ul.BOOL?"true"==i||"false"!=i&&i:i,Fl.BIGINT).toString()]=c}catch(o){let n="cannot decode map key for field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}}else switch(t.kind){case"message":const r=t.T;if(null===a&&"google.protobuf.Value"!=r.typeName){if(t.oneof)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name,' from JSON: null is invalid for oneof field "').concat(s,'"'));continue}l[c]instanceof Ll?l[c].fromJson(a,n):(l[c]=r.fromJson(a,n),r.fieldWrapper&&!t.oneof&&(l[c]=r.fieldWrapper.unwrapField(l[c])));break;case"enum":const i=Cu(t.T,a,n.ignoreUnknownFields);void 0!==i&&(l[c]=i);break;case"scalar":try{l[c]=Eu(t.T,a,t.L)}catch(o){let n="cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}}return r},writeMessage(e,n){const r=e.getType(),i={};let o;try{for(const s of r.fields.byMember()){let r;if("oneof"==s.kind){const i=e[s.localName];if(void 0===i.value)continue;if(o=s.findField(i.case),!o)throw"oneof case not found: "+i.case;r=t(o,i.value,n)}else o=s,r=t(o,e[o.localName],n);void 0!==r&&(i[n.useProtoFieldName?o.name:o.jsonName]=r)}}catch(s){const e=o?"cannot encode field ".concat(r.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(r.typeName," to JSON"),t=s instanceof Error?s.message:String(s);throw new Error(e+(t.length>0?": ".concat(t):""))}return i},readScalar:Eu,writeScalar:xu,debug:Tu}}(((e,t)=>function(n,r,i){if("map"==n.kind){const o={};switch(n.V.kind){case"scalar":for(const[e,i]of Object.entries(r)){const r=t(n.V.T,i,!0);kl(void 0!==r),o[e.toString()]=r}break;case"message":for(const[e,t]of Object.entries(r))o[e.toString()]=t.toJson(i);break;case"enum":const s=n.V.T;for(const[t,n]of Object.entries(r)){kl(void 0===n||"number"==typeof n);const r=e(s,n,!0,i.enumAsInteger);kl(void 0!==r),o[t.toString()]=r}}return i.emitDefaultValues||Object.keys(o).length>0?o:void 0}if(n.repeated){const o=[];switch(n.kind){case"scalar":for(let e=0;e<r.length;e++)o.push(t(n.T,r[e],!0));break;case"enum":for(let t=0;t<r.length;t++)o.push(e(n.T,r[t],!0,i.enumAsInteger));break;case"message":for(let e=0;e<r.length;e++)o.push(Zl(n.T,r[e]).toJson(i))}return i.emitDefaultValues||o.length>0?o:void 0}switch(n.kind){case"scalar":return t(n.T,r,!!n.oneof||n.opt||i.emitDefaultValues);case"enum":return e(n.T,r,!!n.oneof||n.opt||i.emitDefaultValues,i.enumAsInteger);case"message":return void 0!==r?Zl(n.T,r).toJson(i):void 0}})),Object.assign(Object.assign({},{makeReadOptions:su,makeWriteOptions:au,listUnknownFields(e){var t;return null!==(t=e[ru])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[ru]},writeUnknownFields(e,t){const n=e[ru];if(n)for(const r of n)t.tag(r.no,r.wireType).raw(r.data)},onUnknownField(e,t,n,r){const i=e;Array.isArray(i[ru])||(i[ru]=[]),i[ru].push({no:t,wireType:n,data:r})},readMessage(e,t,n,r){const i=e.getType(),o=void 0===n?t.len:t.pos+n;for(;t.pos<o;){const[n,o]=t.tag(),s=i.fields.find(n);if(!s){const i=t.skip(o);r.readUnknownFields&&this.onUnknownField(e,n,o,i);continue}let a=e,c=s.repeated,l=s.localName;switch(s.oneof&&(a=a[s.oneof.localName],a.case!=l&&delete a.value,a.case=l,l="value"),s.kind){case"scalar":case"enum":const e="enum"==s.kind?Ul.INT32:s.T;let n=du;if("scalar"==s.kind&&s.L>0&&(n=uu),c){let r=a[l];if(o==Kl.LengthDelimited&&e!=Ul.STRING&&e!=Ul.BYTES){let i=t.uint32()+t.pos;for(;t.pos<i;)r.push(n(t,e))}else r.push(n(t,e))}else a[l]=n(t,e);break;case"message":const i=s.T;c?a[l].push(cu(t,new i,r)):a[l]instanceof Ll?cu(t,a[l],r):(a[l]=cu(t,new i,r),!i.fieldWrapper||s.oneof||s.repeated||(a[l]=i.fieldWrapper.unwrapField(a[l])));break;case"map":let[u,d]=lu(s,t,r);a[l][u]=d}}}}),{writeMessage(e,t,n){const r=e.getType();for(const i of r.fields.byNumber()){let r,o=i.repeated,s=i.localName;if(i.oneof){const t=e[i.oneof.localName];if(t.case!==s)continue;r=t.value}else r=e[s];switch(i.kind){case"scalar":case"enum":let e="enum"==i.kind?Ul.INT32:i.T;if(o)if(i.packed)mu(t,e,i.no,r);else for(const n of r)fu(t,e,i.no,n,!0);else void 0!==r&&fu(t,e,i.no,r,!!i.oneof||i.opt);break;case"message":if(o)for(const o of r)pu(t,n,i.T,i.no,o);else pu(t,n,i.T,i.no,r);break;case"map":for(const[o,s]of Object.entries(r))hu(t,n,i,o,s)}}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),Object.assign(Object.assign({},{setEnumType:Ml,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const r of n.fields.byMember()){const n=r.localName,i=t,o=e;if(void 0!==o[n])switch(r.kind){case"oneof":const e=o[n].case;if(void 0===e)continue;const t=r.findField(e);let s=o[n].value;!t||"message"!=t.kind||s instanceof t.T?t&&"scalar"===t.kind&&t.T===Ul.BYTES&&(s=Ru(s)):s=new t.T(s),i[n]={case:e,value:s};break;case"scalar":case"enum":let a=o[n];r.T===Ul.BYTES&&(a=r.repeated?a.map(Ru):Ru(a)),i[n]=a;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Ul.BYTES)for(const[t,r]of Object.entries(o[n]))i[n][t]=Ru(r);else Object.assign(i[n],o[n]);break;case"message":const e=r.V.T;for(const t of Object.keys(o[n])){let r=o[n][t];e.fieldWrapper||(r=new e(r)),i[n][t]=r}}break;case"message":const c=r.T;if(r.repeated)i[n]=o[n].map((e=>e instanceof c?e:new c(e)));else if(void 0!==o[n]){const e=o[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?i[n]=Ru(e):i[n]=e:i[n]=e instanceof c?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every((e=>{const r=t[e.localName],i=n[e.localName];if(e.repeated){if(r.length!==i.length)return!1;switch(e.kind){case"message":return r.every(((t,n)=>e.T.equals(t,i[n])));case"scalar":return r.every(((t,n)=>eu(e.T,t,i[n])));case"enum":return r.every(((e,t)=>eu(Ul.INT32,e,i[t])))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":return e.T.equals(r,i);case"enum":return eu(Ul.INT32,r,i);case"scalar":return eu(e.T,r,i);case"oneof":if(r.case!==i.case)return!1;const t=e.findField(r.case);if(void 0===t)return!0;switch(t.kind){case"message":return t.T.equals(r.value,i.value);case"enum":return eu(Ul.INT32,r.value,i.value);case"scalar":return eu(t.T,r.value,i.value)}throw new Error("oneof cannot contain ".concat(t.kind));case"map":const n=Object.keys(r).concat(Object.keys(i));switch(e.V.kind){case"message":const t=e.V.T;return n.every((e=>t.equals(r[e],i[e])));case"enum":return n.every((e=>eu(Ul.INT32,r[e],i[e])));case"scalar":const o=e.V.T;return n.every((e=>eu(o,r[e],i[e])))}}})),clone(e){const t=e.getType(),n=new t,r=n;for(const i of t.fields.byMember()){const t=e[i.localName];let n;if(i.repeated)n=t.map(Iu);else if("map"==i.kind){n=r[i.localName];for(const[e,r]of Object.entries(t))n[e]=Iu(r)}else n="oneof"==i.kind?i.findField(t.case)?{case:t.case,value:Iu(t.value)}:{case:void 0}:Iu(t);r[i.localName]=n}return n}}),{newFieldList:e=>new Pu(e,zu),initFields(e){for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,r=e;if(t.repeated)r[n]=[];else switch(t.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=tu(t.T,t.L)}}}}));function zu(e){var t,n,r,i;const o=[];let s;for(const a of"function"==typeof e?e():e){const e=a;if(e.localName=Ou(a.name,void 0!==a.oneof),e.jsonName=null!==(t=a.jsonName)&&void 0!==t?t:Mu(a.name),e.repeated=null!==(n=a.repeated)&&void 0!==n&&n,"scalar"==a.kind&&(e.L=null!==(r=a.L)&&void 0!==r?r:Fl.BIGINT),e.packed=null!==(i=a.packed)&&void 0!==i?i:"enum"==a.kind||"scalar"==a.kind&&a.T!=Ul.BYTES&&a.T!=Ul.STRING,void 0!==a.oneof){const t="string"==typeof a.oneof?a.oneof:a.oneof.name;s&&s.name==t||(s=new Bu(t)),e.oneof=s,s.addField(e)}o.push(e)}return o}class Vu extends Ll{constructor(e){super(),this.seconds=Yl.zero,this.nanos=0,ju.util.initPartial(e,this)}fromJson(e,t){if("string"!==typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(ju.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Yl.parse(r/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return Vu.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Vu({seconds:Yl.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new Vu).fromBinary(e,t)}static fromJson(e,t){return(new Vu).fromJson(e,t)}static fromJsonString(e,t){return(new Vu).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Vu,e,t)}}var Wu,qu,$u,Hu,Ju,Gu,Yu,Ku,Xu,Qu,Zu;Vu.runtime=ju,Vu.typeName="google.protobuf.Timestamp",Vu.fields=ju.util.newFieldList((()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}])),function(e){e[e.DEFAULT_AC=0]="DEFAULT_AC",e[e.OPUS=1]="OPUS",e[e.AAC=2]="AAC"}(Wu||(Wu={})),ju.util.setEnumType(Wu,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]),function(e){e[e.DEFAULT_VC=0]="DEFAULT_VC",e[e.H264_BASELINE=1]="H264_BASELINE",e[e.H264_MAIN=2]="H264_MAIN",e[e.H264_HIGH=3]="H264_HIGH",e[e.VP8=4]="VP8"}(qu||(qu={})),ju.util.setEnumType(qu,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]),function(e){e[e.IC_DEFAULT=0]="IC_DEFAULT",e[e.IC_JPEG=1]="IC_JPEG"}($u||($u={})),ju.util.setEnumType($u,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]),function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA"}(Hu||(Hu={})),ju.util.setEnumType(Hu,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"}(Ju||(Ju={})),ju.util.setEnumType(Ju,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF"}(Gu||(Gu={})),ju.util.setEnumType(Gu,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.LOST=3]="LOST"}(Yu||(Yu={})),ju.util.setEnumType(Yu,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),function(e){e[e.UNSET=0]="UNSET",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"}(Ku||(Ku={})),ju.util.setEnumType(Ku,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),function(e){e[e.UNKNOWN_REASON=0]="UNKNOWN_REASON",e[e.CLIENT_INITIATED=1]="CLIENT_INITIATED",e[e.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",e[e.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",e[e.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",e[e.ROOM_DELETED=5]="ROOM_DELETED",e[e.STATE_MISMATCH=6]="STATE_MISMATCH",e[e.JOIN_FAILURE=7]="JOIN_FAILURE"}(Xu||(Xu={})),ju.util.setEnumType(Xu,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]),function(e){e[e.RR_UNKNOWN=0]="RR_UNKNOWN",e[e.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",e[e.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",e[e.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",e[e.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"}(Qu||(Qu={})),ju.util.setEnumType(Qu,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),function(e){e[e.SE_UNKNOWN=0]="SE_UNKNOWN",e[e.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",e[e.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"}(Zu||(Zu={})),ju.util.setEnumType(Zu,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let ed=class e extends Ll{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Yl.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,ju.util.initPartial(e,this)}static fromBinary(t,n){return(new e).fromBinary(t,n)}static fromJson(t,n){return(new e).fromJson(t,n)}static fromJsonString(t,n){return(new e).fromJsonString(t,n)}static equals(t,n){return ju.util.equals(e,t,n)}};ed.runtime=ju,ed.typeName="livekit.Room",ed.fields=ju.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:td,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]));class td extends Ll{constructor(e){super(),this.mime="",this.fmtpLine="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new td).fromBinary(e,t)}static fromJson(e,t){return(new td).fromJson(e,t)}static fromJsonString(e,t){return(new td).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(td,e,t)}}td.runtime=ju,td.typeName="livekit.Codec",td.fields=ju.util.newFieldList((()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]));class nd extends Ll{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new nd).fromBinary(e,t)}static fromJson(e,t){return(new nd).fromJson(e,t)}static fromJsonString(e,t){return(new nd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(nd,e,t)}}nd.runtime=ju,nd.typeName="livekit.PlayoutDelay",nd.fields=ju.util.newFieldList((()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]));class rd extends Ll{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new rd).fromBinary(e,t)}static fromJson(e,t){return(new rd).fromJson(e,t)}static fromJsonString(e,t){return(new rd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(rd,e,t)}}rd.runtime=ju,rd.typeName="livekit.ParticipantPermission",rd.fields=ju.util.newFieldList((()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:ju.getEnumType(Ju),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]));class id extends Ll{constructor(e){super(),this.sid="",this.identity="",this.state=od.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Yl.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new id).fromBinary(e,t)}static fromJson(e,t){return(new id).fromJson(e,t)}static fromJsonString(e,t){return(new id).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(id,e,t)}}var od,sd,ad,cd,ld;id.runtime=ju,id.typeName="livekit.ParticipantInfo",id.fields=ju.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ju.getEnumType(od)},{no:4,name:"tracks",kind:"message",T:hd,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:rd},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}])),function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED"}(od||(od={})),ju.util.setEnumType(od,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class ud extends Ll{constructor(e){super(),ju.util.initPartial(e,this)}static fromBinary(e,t){return(new ud).fromBinary(e,t)}static fromJson(e,t){return(new ud).fromJson(e,t)}static fromJsonString(e,t){return(new ud).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(ud,e,t)}}ud.runtime=ju,ud.typeName="livekit.Encryption",ud.fields=ju.util.newFieldList((()=>[])),function(e){e[e.NONE=0]="NONE",e[e.GCM=1]="GCM",e[e.CUSTOM=2]="CUSTOM"}(sd||(sd={})),ju.util.setEnumType(sd,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class dd extends Ll{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new dd).fromBinary(e,t)}static fromJson(e,t){return(new dd).fromJson(e,t)}static fromJsonString(e,t){return(new dd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(dd,e,t)}}dd.runtime=ju,dd.typeName="livekit.SimulcastCodecInfo",dd.fields=ju.util.newFieldList((()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:pd,repeated:!0}]));class hd extends Ll{constructor(e){super(),this.sid="",this.type=Hu.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Ju.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=sd.NONE,this.stream="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new hd).fromBinary(e,t)}static fromJson(e,t){return(new hd).fromJson(e,t)}static fromJsonString(e,t){return(new hd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(hd,e,t)}}hd.runtime=ju,hd.typeName="livekit.TrackInfo",hd.fields=ju.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:ju.getEnumType(Hu)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:ju.getEnumType(Ju)},{no:10,name:"layers",kind:"message",T:pd,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:dd,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:ju.getEnumType(sd)},{no:17,name:"stream",kind:"scalar",T:9}]));class pd extends Ll{constructor(e){super(),this.quality=Gu.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new pd).fromBinary(e,t)}static fromJson(e,t){return(new pd).fromJson(e,t)}static fromJsonString(e,t){return(new pd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(pd,e,t)}}pd.runtime=ju,pd.typeName="livekit.VideoLayer",pd.fields=ju.util.newFieldList((()=>[{no:1,name:"quality",kind:"enum",T:ju.getEnumType(Gu)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]));class fd extends Ll{constructor(e){super(),this.kind=ad.RELIABLE,this.value={case:void 0},ju.util.initPartial(e,this)}static fromBinary(e,t){return(new fd).fromBinary(e,t)}static fromJson(e,t){return(new fd).fromJson(e,t)}static fromJsonString(e,t){return(new fd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(fd,e,t)}}fd.runtime=ju,fd.typeName="livekit.DataPacket",fd.fields=ju.util.newFieldList((()=>[{no:1,name:"kind",kind:"enum",T:ju.getEnumType(ad)},{no:2,name:"user",kind:"message",T:vd,oneof:"value"},{no:3,name:"speaker",kind:"message",T:md,oneof:"value"}])),function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY"}(ad||(ad={})),ju.util.setEnumType(ad,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class md extends Ll{constructor(e){super(),this.speakers=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new md).fromBinary(e,t)}static fromJson(e,t){return(new md).fromJson(e,t)}static fromJsonString(e,t){return(new md).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(md,e,t)}}md.runtime=ju,md.typeName="livekit.ActiveSpeakerUpdate",md.fields=ju.util.newFieldList((()=>[{no:1,name:"speakers",kind:"message",T:gd,repeated:!0}]));class gd extends Ll{constructor(e){super(),this.sid="",this.level=0,this.active=!1,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new gd).fromBinary(e,t)}static fromJson(e,t){return(new gd).fromJson(e,t)}static fromJsonString(e,t){return(new gd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(gd,e,t)}}gd.runtime=ju,gd.typeName="livekit.SpeakerInfo",gd.fields=ju.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]));class vd extends Ll{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new vd).fromBinary(e,t)}static fromJson(e,t){return(new vd).fromJson(e,t)}static fromJsonString(e,t){return(new vd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(vd,e,t)}}vd.runtime=ju,vd.typeName="livekit.UserPacket",vd.fields=ju.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]));class yd extends Ll{constructor(e){super(),this.participantSid="",this.trackSids=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new yd).fromBinary(e,t)}static fromJson(e,t){return(new yd).fromJson(e,t)}static fromJsonString(e,t){return(new yd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(yd,e,t)}}yd.runtime=ju,yd.typeName="livekit.ParticipantTracks",yd.fields=ju.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]));class bd extends Ll{constructor(e){super(),this.edition=cd.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new bd).fromBinary(e,t)}static fromJson(e,t){return(new bd).fromJson(e,t)}static fromJsonString(e,t){return(new bd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(bd,e,t)}}bd.runtime=ju,bd.typeName="livekit.ServerInfo",bd.fields=ju.util.newFieldList((()=>[{no:1,name:"edition",kind:"enum",T:ju.getEnumType(cd)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}])),function(e){e[e.Standard=0]="Standard",e[e.Cloud=1]="Cloud"}(cd||(cd={})),ju.util.setEnumType(cd,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class wd extends Ll{constructor(e){super(),this.sdk=ld.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new wd).fromBinary(e,t)}static fromJson(e,t){return(new wd).fromJson(e,t)}static fromJsonString(e,t){return(new wd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(wd,e,t)}}wd.runtime=ju,wd.typeName="livekit.ClientInfo",wd.fields=ju.util.newFieldList((()=>[{no:1,name:"sdk",kind:"enum",T:ju.getEnumType(ld)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}])),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.REACT_NATIVE=7]="REACT_NATIVE",e[e.RUST=8]="RUST",e[e.PYTHON=9]="PYTHON",e[e.CPP=10]="CPP"}(ld||(ld={})),ju.util.setEnumType(ld,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class kd extends Ll{constructor(e){super(),this.resumeConnection=Ku.UNSET,this.forceRelay=Ku.UNSET,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new kd).fromBinary(e,t)}static fromJson(e,t){return(new kd).fromJson(e,t)}static fromJsonString(e,t){return(new kd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(kd,e,t)}}kd.runtime=ju,kd.typeName="livekit.ClientConfiguration",kd.fields=ju.util.newFieldList((()=>[{no:1,name:"video",kind:"message",T:Sd},{no:2,name:"screen",kind:"message",T:Sd},{no:3,name:"resume_connection",kind:"enum",T:ju.getEnumType(Ku)},{no:4,name:"disabled_codecs",kind:"message",T:Td},{no:5,name:"force_relay",kind:"enum",T:ju.getEnumType(Ku)}]));class Sd extends Ll{constructor(e){super(),this.hardwareEncoder=Ku.UNSET,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Sd).fromBinary(e,t)}static fromJson(e,t){return(new Sd).fromJson(e,t)}static fromJsonString(e,t){return(new Sd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Sd,e,t)}}Sd.runtime=ju,Sd.typeName="livekit.VideoConfiguration",Sd.fields=ju.util.newFieldList((()=>[{no:1,name:"hardware_encoder",kind:"enum",T:ju.getEnumType(Ku)}]));class Td extends Ll{constructor(e){super(),this.codecs=[],this.publish=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Td).fromBinary(e,t)}static fromJson(e,t){return(new Td).fromJson(e,t)}static fromJsonString(e,t){return(new Td).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Td,e,t)}}Td.runtime=ju,Td.typeName="livekit.DisabledCodecs",Td.fields=ju.util.newFieldList((()=>[{no:1,name:"codecs",kind:"message",T:td,repeated:!0},{no:2,name:"publish",kind:"message",T:td,repeated:!0}]));class Ed extends Ll{constructor(e){super(),this.duration=0,this.startTimestamp=Yl.zero,this.endTimestamp=Yl.zero,this.rtpClockTicks=Yl.zero,this.driftSamples=Yl.zero,this.driftMs=0,this.clockRate=0,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Ed).fromBinary(e,t)}static fromJson(e,t){return(new Ed).fromJson(e,t)}static fromJsonString(e,t){return(new Ed).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Ed,e,t)}}Ed.runtime=ju,Ed.typeName="livekit.RTPDrift",Ed.fields=ju.util.newFieldList((()=>[{no:1,name:"start_time",kind:"message",T:Vu},{no:2,name:"end_time",kind:"message",T:Vu},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]));class Cd extends Ll{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Yl.zero,this.headerBytes=Yl.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Yl.zero,this.headerBytesDuplicate=Yl.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Yl.zero,this.headerBytesPadding=Yl.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Cd).fromBinary(e,t)}static fromJson(e,t){return(new Cd).fromJson(e,t)}static fromJsonString(e,t){return(new Cd).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Cd,e,t)}}Cd.runtime=ju,Cd.typeName="livekit.RTPStats",Cd.fields=ju.util.newFieldList((()=>[{no:1,name:"start_time",kind:"message",T:Vu},{no:2,name:"end_time",kind:"message",T:Vu},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:Vu},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:Vu},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:Vu},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:Vu},{no:44,name:"packet_drift",kind:"message",T:Ed},{no:45,name:"report_drift",kind:"message",T:Ed}]));class _d extends Ll{constructor(e){super(),this.unixMicro=Yl.zero,this.ticks=0,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new _d).fromBinary(e,t)}static fromJson(e,t){return(new _d).fromJson(e,t)}static fromJsonString(e,t){return(new _d).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(_d,e,t)}}_d.runtime=ju,_d.typeName="livekit.TimedVersion",_d.fields=ju.util.newFieldList((()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]));const xd=7e3,Id=[0,300,1200,2700,4800,xd,xd,xd,xd,xd];function Rd(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function Pd(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Od(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Pd(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}"function"===typeof SuppressedError&&SuppressedError;var Md,Nd={exports:{}},Ad="object"===typeof Reflect?Reflect:null,Dd=Ad&&"function"===typeof Ad.apply?Ad.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};Md=Ad&&"function"===typeof Ad.ownKeys?Ad.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var Ld=Number.isNaN||function(e){return e!==e};function Ud(){Ud.init.call(this)}Nd.exports=Ud,Nd.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}Jd(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&Jd(e,"error",t,n)}(e,i,{once:!0})}))},Ud.EventEmitter=Ud,Ud.prototype._events=void 0,Ud.prototype._eventsCount=0,Ud.prototype._maxListeners=void 0;var Fd=10;function Bd(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function jd(e){return void 0===e._maxListeners?Ud.defaultMaxListeners:e._maxListeners}function zd(e,t,n,r){var i,o,s;if(Bd(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"===typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=jd(e))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,function(e){console&&console.warn&&console.warn(e)}(a)}return e}function Vd(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Wd(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=Vd.bind(r);return i.listener=n,r.wrapFn=i,i}function qd(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):Hd(i,i.length)}function $d(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function Hd(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Jd(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(Ud,"defaultMaxListeners",{enumerable:!0,get:function(){return Fd},set:function(e){if("number"!==typeof e||e<0||Ld(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Fd=e}}),Ud.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ud.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||Ld(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Ud.prototype.getMaxListeners=function(){return jd(this)},Ud.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"===typeof a)Dd(a,this,t);else{var c=a.length,l=Hd(a,c);for(n=0;n<c;++n)Dd(l[n],this,t)}return!0},Ud.prototype.addListener=function(e,t){return zd(this,e,t,!1)},Ud.prototype.on=Ud.prototype.addListener,Ud.prototype.prependListener=function(e,t){return zd(this,e,t,!0)},Ud.prototype.once=function(e,t){return Bd(t),this.on(e,Wd(this,e,t)),this},Ud.prototype.prependOnceListener=function(e,t){return Bd(t),this.prependListener(e,Wd(this,e,t)),this},Ud.prototype.removeListener=function(e,t){var n,r,i,o,s;if(Bd(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},Ud.prototype.off=Ud.prototype.removeListener,Ud.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},Ud.prototype.listeners=function(e){return qd(this,e,!0)},Ud.prototype.rawListeners=function(e){return qd(this,e,!1)},Ud.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):$d.call(e,t)},Ud.prototype.listenerCount=$d,Ud.prototype.eventNames=function(){return this._eventsCount>0?Md(this._events):[]};var Gd=Nd.exports;let Yd=!0,Kd=!0;function Xd(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function Qd(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Zd(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Yd=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function eh(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Kd=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function th(){if("object"===typeof window){if(Yd)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function nh(e,t){Kd&&console.warn(e+" is deprecated, please use "+t+" instead.")}function rh(e){return"[object Object]"===Object.prototype.toString.call(e)}function ih(e){return rh(e)?Object.keys(e).reduce((function(t,n){const r=rh(e[n]),i=r?ih(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function oh(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((r=>{r.endsWith("Id")?oh(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((t=>{oh(e,e.get(t),n)}))})))}function sh(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===r&&n.trackId===t.id&&oh(e,n,i)}))})),i}const ah=th;function ch(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"===typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"===typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!==typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"===typeof e.video){let o=e.video.facingMode;o=o&&("object"===typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let s=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=r(e.video),ah("chrome: "+JSON.stringify(e)),i(e)}))}e.video=r(e.video)}return ah("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{r&&r(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function lh(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function uh(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Qd(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function dh(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function hh(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"===typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])})).then(n,r)}}function ph(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>sh(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Qd(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>sh(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach((n=>{n.track===e&&(t?r=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?r=!0:n=t),t.track===e))),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function fh(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function mh(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return fh(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const i=this._streams[n.id];if(i)i.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=r[t]}));const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function gh(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function vh(e,t){Qd(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var yh=Object.freeze({__proto__:null,fixNegotiationNeeded:vh,shimAddTrackRemoveTrack:mh,shimAddTrackRemoveTrackWithNative:fh,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:dh,shimGetStats:hh,shimGetUserMedia:ch,shimMediaStream:lh,shimOnTrack:uh,shimPeerConnection:gh,shimSenderReceiverGetStats:ph});function bh(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){nh("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function wh(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function kh(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(r){if("TypeError"!==r.name)throw r;e.forEach(((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(i,o)}}function Sh(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Th(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Qd(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Eh(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){nh("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function Ch(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function _h(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return r})}function xh(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Ih(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Rh(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var Ph=Object.freeze({__proto__:null,shimAddTransceiver:_h,shimCreateAnswer:Rh,shimCreateOffer:Ih,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:xh,shimGetUserMedia:bh,shimOnTrack:wh,shimPeerConnection:kh,shimRTCDataChannel:Ch,shimReceiverGetStats:Th,shimRemoveStream:Eh,shimSenderGetStats:Sh});function Oh(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r&&r.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function Mh(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function Nh(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let a=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=a,a=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=a,a=function(e,t,n){const r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=a}function Ah(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(Dh(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function Dh(e){return e&&void 0!==e.video?Object.assign({},e,{video:ih(e.video)}):e}function Lh(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];void 0===r.urls&&r.url?(nh("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Uh(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Fh(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Bh(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var jh=Object.freeze({__proto__:null,shimAudioContext:Bh,shimCallbacksAPI:Nh,shimConstraints:Dh,shimCreateOfferLegacy:Fh,shimGetUserMedia:Ah,shimLocalStreamsAPI:Oh,shimRTCIceServerUrls:Lh,shimRemoteStreamsAPI:Mh,shimTrackEventTransceiver:Uh}),zh={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const r=e.substring(e.indexOf(" ")+1).split(";");for(let i=0;i<r.length;i++)n=r[i].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const r=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substring(12),password:i.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" ");n.profile=r[2];for(let o=3;o<r.length;o++){const i=r[o],s=t.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(s){const r=t.parseRtpMap(s),o=t.matchPrefix(e,"a=fmtp:"+i+" ");switch(r.parameters=o.length?t.parseFmtp(o[0]):{},r.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(t.parseRtcpFb),n.codecs.push(r),r.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(r.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const i=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{i.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));let i=0;return n.codecs.forEach((e=>{e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){const n=[],r=t.parseRtpParameters(e),i=-1!==r.fecMechanisms.indexOf("RED"),o=-1!==r.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=s.length>0&&s[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===a&&(c=l[0][1]),r.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),n.push(t),i&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&a&&n.push({ssrc:a});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);const i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const r=t.matchPrefix(e,"a=msid:");if(1===r.length)return n=r[0].substring(7).split(" "),{stream:n[0],track:n[1]};const i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return i.length>0?(n=i[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),r=t.matchPrefix(e,"a=max-message-size:");let i;r.length>0&&(i=parseInt(r[0].substring(19),10)),isNaN(i)&&(i=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:i};const s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){const e=s[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:i}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,r){let i;const o=void 0!==n?n:2;i=e||t.generateSessionId();return"v=0\r\no="+(r||"thisisadapterortc")+" "+i+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const r=t.splitLines(e);for(let t=0;t<r.length;t++)switch(r[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(zh);var Vh=zh.exports,Wh=ml(Vh),qh=pl({__proto__:null,default:Wh},[Vh]);function $h(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),r=Wh.parseCandidate(e.candidate);for(const e in r)e in n||Object.defineProperty(n,e,{value:r[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Qd(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Hh(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Qd(e,"icecandidate",(e=>{if(e.candidate){const t=Wh.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function Jh(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=Wh.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Wh.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),r=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=Wh.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r}(arguments[0],e);let i;i=0===n&&0===r?Number.POSITIVE_INFINITY:0===n||0===r?Math.max(n,r):Math.min(n,r);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>i}),this._sctp=o}return n.apply(this,arguments)}}function Gh(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Qd(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function Yh(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Kh(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Xh(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Qh(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}var Zh=Object.freeze({__proto__:null,removeExtmapAllowMixed:Kh,shimAddIceCandidateNullOrEmpty:Xh,shimConnectionState:Yh,shimMaxMessageSize:Jh,shimParameterlessSetLocalDescription:Qh,shimRTCIceCandidate:$h,shimRTCIceCandidateRelayProtocol:Hh,shimSendThrowTypeError:Gh});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=th,r=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Xd(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Xd(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Xd(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:r,commonShim:Zh,extractVersion:Xd,disableLog:Zd,disableWarnings:eh,sdp:qh};switch(r.browser){case"chrome":if(!yh||!gh||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=yh,Xh(e,r),Qh(e),ch(e,r),lh(e),gh(e,r),uh(e),mh(e,r),dh(e),hh(e),ph(e),vh(e,r),$h(e),Hh(e),Yh(e),Jh(e,r),Gh(e),Kh(e,r);break;case"firefox":if(!Ph||!kh||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Ph,Xh(e,r),Qh(e),bh(e,r),kh(e,r),wh(e),Eh(e),Sh(e),Th(e),Ch(e),_h(e),xh(e),Ih(e),Rh(e),$h(e),Yh(e),Jh(e,r),Gh(e);break;case"safari":if(!jh||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=jh,Xh(e,r),Qh(e),Lh(e),Fh(e),Nh(e),Oh(e),Mh(e),Uh(e),Ah(e),Bh(e),$h(e),Hh(e),Jh(e,r),Gh(e),Kh(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"===typeof window?void 0:window});const ep="lk_e2ee";var tp,np,rp,ip;function op(){return"undefined"!==typeof window.RTCRtpSender&&"undefined"!==typeof window.RTCRtpSender.prototype.createEncodedStreams||sp()}function sp(){return"undefined"!==typeof window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}(tp||(tp={})),function(e){e.KeyRatcheted="keyRatcheted"}(np||(np={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(rp||(rp={})),function(e){e.Error="cryptorError"}(ip||(ip={}));Gd.EventEmitter;class ap extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}class cp extends ap{constructor(e,t,n){super(1,e),this.status=n,this.reason=t}}class lp extends ap{constructor(e){super(21,null!==e&&void 0!==e?e:"device is unsupported")}}class up extends ap{constructor(e){super(20,null!==e&&void 0!==e?e:"track is invalid")}}class dp extends ap{constructor(e){super(10,null!==e&&void 0!==e?e:"unsupported server")}}class hp extends ap{constructor(e){super(12,null!==e&&void 0!==e?e:"unexpected connection state")}}class pp extends ap{constructor(e){super(13,null!==e&&void 0!==e?e:"unable to negotiate")}}var fp,mp,gp,vp,yp;function bp(e,t,n){var r,i,o;void 0===t&&(t=50),void 0===n&&(n={});var s=null!=(r=n.isImmediate)&&r,a=null!=(i=n.callback)&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var h=function(){var t=[].slice.call(arguments),n=this;return new Promise((function(r,i){var c=s&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,l=Date.now(),!s){var r=e.apply(n,t);a&&a(r),u.forEach((function(e){return(0,e.resolve)(r)})),u=[]}}),d()),c){var h=e.apply(n,t);return a&&a(h),r(h)}u.push({resolve:r,reject:i})}))};return h.cancel=function(e){void 0!==o&&clearTimeout(o),u.forEach((function(t){return(0,t.reject)(e)})),u=[]},h}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(fp||(fp={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(fp||(fp={})),function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.StateChanged="connectionStateChanged",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged"}(mp||(mp={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded"}(gp||(gp={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate"}(vp||(vp={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed"}(yp||(yp={}));const wp=/version\/(\d+(\.?_?\d+)+)/i;let kp;function Sp(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("undefined"===typeof e&&"undefined"===typeof navigator)return;const n=(null!==e&&void 0!==e?e:navigator.userAgent).toLowerCase();if(void 0===kp||t){const e=Tp.find((e=>{let{test:t}=e;return t.test(n)}));kp=null===e||void 0===e?void 0:e.describe(n)}return kp}const Tp=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:Ep(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:Ep(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:Ep(wp,e),os:e.includes("mobile/")?"iOS":"macOS"})}];function Ep(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=t.match(e);return r&&r.length>=n&&r[n]||""}class Cp{}Cp.setTimeout=function(){return setTimeout(...arguments)},Cp.setInterval=function(){return setInterval(...arguments)},Cp.clearTimeout=function(){return clearTimeout(...arguments)},Cp.clearInterval=function(){return clearInterval(...arguments)};class _p{constructor(e,t,n,r,i){this.width=e,this.height=t,this.encoding={maxBitrate:n,maxFramerate:r,priority:i}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const xp=["vp8","h264"],Ip=["vp8","h264","vp9","av1"];function Rp(e){return!!xp.find((t=>t===e))}var Pp;!function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3},e.musicStereo={maxBitrate:48e3},e.musicHighQuality={maxBitrate:64e3},e.musicHighQualityStereo={maxBitrate:96e3}}(Pp||(Pp={}));const Op={h90:new _p(160,90,9e4,20),h180:new _p(320,180,16e4,20),h216:new _p(384,216,18e4,20),h360:new _p(640,360,45e4,20),h540:new _p(960,540,8e5,25),h720:new _p(1280,720,17e5,30),h1080:new _p(1920,1080,3e6,30),h1440:new _p(2560,1440,5e6,30),h2160:new _p(3840,2160,8e6,30)},Mp={h120:new _p(160,120,7e4,20),h180:new _p(240,180,125e3,20),h240:new _p(320,240,14e4,20),h360:new _p(480,360,33e4,20),h480:new _p(640,480,5e5,20),h540:new _p(720,540,6e5,25),h720:new _p(960,720,13e5,30),h1080:new _p(1440,1080,23e5,30),h1440:new _p(1920,1440,38e5,30)},Np={h360fps3:new _p(640,360,2e5,3,"medium"),h720fps5:new _p(1280,720,4e5,5,"medium"),h720fps15:new _p(1280,720,15e5,15,"medium"),h720fps30:new _p(1280,720,2e6,30,"medium"),h1080fps15:new _p(1920,1080,25e5,15,"medium"),h1080fps30:new _p(1920,1080,4e6,30,"medium")};var Ap,Dp,Lp;!function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER"}(Ap||(Ap={})),ju.util.setEnumType(Ap,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED"}(Dp||(Dp={})),ju.util.setEnumType(Dp,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),function(e){e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.TLS=2]="TLS"}(Lp||(Lp={})),ju.util.setEnumType(Lp,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Up extends Ll{constructor(e){super(),this.message={case:void 0},ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Up).fromBinary(e,t)}static fromJson(e,t){return(new Up).fromJson(e,t)}static fromJsonString(e,t){return(new Up).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Up,e,t)}}Up.runtime=ju,Up.typeName="livekit.SignalRequest",Up.fields=ju.util.newFieldList((()=>[{no:1,name:"offer",kind:"message",T:Jp,oneof:"message"},{no:2,name:"answer",kind:"message",T:Jp,oneof:"message"},{no:3,name:"trickle",kind:"message",T:zp,oneof:"message"},{no:4,name:"add_track",kind:"message",T:jp,oneof:"message"},{no:5,name:"mute",kind:"message",T:Vp,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Yp,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Kp,oneof:"message"},{no:8,name:"leave",kind:"message",T:Xp,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Qp,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:hf,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:ff,oneof:"message"},{no:13,name:"simulate",kind:"message",T:gf,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Zp,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:vf,oneof:"message"}]));class Fp extends Ll{constructor(e){super(),this.message={case:void 0},ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Fp).fromBinary(e,t)}static fromJson(e,t){return(new Fp).fromJson(e,t)}static fromJsonString(e,t){return(new Fp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Fp,e,t)}}Fp.runtime=ju,Fp.typeName="livekit.SignalResponse",Fp.fields=ju.util.newFieldList((()=>[{no:1,name:"join",kind:"message",T:Wp,oneof:"message"},{no:2,name:"answer",kind:"message",T:Jp,oneof:"message"},{no:3,name:"offer",kind:"message",T:Jp,oneof:"message"},{no:4,name:"trickle",kind:"message",T:zp,oneof:"message"},{no:5,name:"update",kind:"message",T:Gp,oneof:"message"},{no:6,name:"track_published",kind:"message",T:$p,oneof:"message"},{no:8,name:"leave",kind:"message",T:Xp,oneof:"message"},{no:9,name:"mute",kind:"message",T:Vp,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:tf,oneof:"message"},{no:11,name:"room_update",kind:"message",T:nf,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:of,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:af,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:uf,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:pf,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Hp,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:qp,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:yf,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:kf,oneof:"message"}]));class Bp extends Ll{constructor(e){super(),this.codec="",this.cid="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Bp).fromBinary(e,t)}static fromJson(e,t){return(new Bp).fromJson(e,t)}static fromJsonString(e,t){return(new Bp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Bp,e,t)}}Bp.runtime=ju,Bp.typeName="livekit.SimulcastCodec",Bp.fields=ju.util.newFieldList((()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]));class jp extends Ll{constructor(e){super(),this.cid="",this.name="",this.type=Hu.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Ju.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=sd.NONE,this.stream="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new jp).fromBinary(e,t)}static fromJson(e,t){return(new jp).fromJson(e,t)}static fromJsonString(e,t){return(new jp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(jp,e,t)}}jp.runtime=ju,jp.typeName="livekit.AddTrackRequest",jp.fields=ju.util.newFieldList((()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:ju.getEnumType(Hu)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:ju.getEnumType(Ju)},{no:9,name:"layers",kind:"message",T:pd,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Bp,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:ju.getEnumType(sd)},{no:15,name:"stream",kind:"scalar",T:9}]));class zp extends Ll{constructor(e){super(),this.candidateInit="",this.target=Ap.PUBLISHER,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new zp).fromBinary(e,t)}static fromJson(e,t){return(new zp).fromJson(e,t)}static fromJsonString(e,t){return(new zp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(zp,e,t)}}zp.runtime=ju,zp.typeName="livekit.TrickleRequest",zp.fields=ju.util.newFieldList((()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:ju.getEnumType(Ap)}]));class Vp extends Ll{constructor(e){super(),this.sid="",this.muted=!1,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Vp).fromBinary(e,t)}static fromJson(e,t){return(new Vp).fromJson(e,t)}static fromJsonString(e,t){return(new Vp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Vp,e,t)}}Vp.runtime=ju,Vp.typeName="livekit.MuteTrackRequest",Vp.fields=ju.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]));class Wp extends Ll{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Wp).fromBinary(e,t)}static fromJson(e,t){return(new Wp).fromJson(e,t)}static fromJsonString(e,t){return(new Wp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Wp,e,t)}}Wp.runtime=ju,Wp.typeName="livekit.JoinResponse",Wp.fields=ju.util.newFieldList((()=>[{no:1,name:"room",kind:"message",T:ed},{no:2,name:"participant",kind:"message",T:id},{no:3,name:"other_participants",kind:"message",T:id,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:ef,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:kd},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:bd},{no:13,name:"sif_trailer",kind:"scalar",T:12}]));class qp extends Ll{constructor(e){super(),this.iceServers=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new qp).fromBinary(e,t)}static fromJson(e,t){return(new qp).fromJson(e,t)}static fromJsonString(e,t){return(new qp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(qp,e,t)}}qp.runtime=ju,qp.typeName="livekit.ReconnectResponse",qp.fields=ju.util.newFieldList((()=>[{no:1,name:"ice_servers",kind:"message",T:ef,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:kd}]));class $p extends Ll{constructor(e){super(),this.cid="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new $p).fromBinary(e,t)}static fromJson(e,t){return(new $p).fromJson(e,t)}static fromJsonString(e,t){return(new $p).fromJsonString(e,t)}static equals(e,t){return ju.util.equals($p,e,t)}}$p.runtime=ju,$p.typeName="livekit.TrackPublishedResponse",$p.fields=ju.util.newFieldList((()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:hd}]));class Hp extends Ll{constructor(e){super(),this.trackSid="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Hp).fromBinary(e,t)}static fromJson(e,t){return(new Hp).fromJson(e,t)}static fromJsonString(e,t){return(new Hp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Hp,e,t)}}Hp.runtime=ju,Hp.typeName="livekit.TrackUnpublishedResponse",Hp.fields=ju.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]));class Jp extends Ll{constructor(e){super(),this.type="",this.sdp="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Jp).fromBinary(e,t)}static fromJson(e,t){return(new Jp).fromJson(e,t)}static fromJsonString(e,t){return(new Jp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Jp,e,t)}}Jp.runtime=ju,Jp.typeName="livekit.SessionDescription",Jp.fields=ju.util.newFieldList((()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]));class Gp extends Ll{constructor(e){super(),this.participants=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Gp).fromBinary(e,t)}static fromJson(e,t){return(new Gp).fromJson(e,t)}static fromJsonString(e,t){return(new Gp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Gp,e,t)}}Gp.runtime=ju,Gp.typeName="livekit.ParticipantUpdate",Gp.fields=ju.util.newFieldList((()=>[{no:1,name:"participants",kind:"message",T:id,repeated:!0}]));class Yp extends Ll{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Yp).fromBinary(e,t)}static fromJson(e,t){return(new Yp).fromJson(e,t)}static fromJsonString(e,t){return(new Yp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Yp,e,t)}}Yp.runtime=ju,Yp.typeName="livekit.UpdateSubscription",Yp.fields=ju.util.newFieldList((()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:yd,repeated:!0}]));class Kp extends Ll{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=Gu.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Kp).fromBinary(e,t)}static fromJson(e,t){return(new Kp).fromJson(e,t)}static fromJsonString(e,t){return(new Kp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Kp,e,t)}}Kp.runtime=ju,Kp.typeName="livekit.UpdateTrackSettings",Kp.fields=ju.util.newFieldList((()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:ju.getEnumType(Gu)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]));class Xp extends Ll{constructor(e){super(),this.canReconnect=!1,this.reason=Xu.UNKNOWN_REASON,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Xp).fromBinary(e,t)}static fromJson(e,t){return(new Xp).fromJson(e,t)}static fromJsonString(e,t){return(new Xp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Xp,e,t)}}Xp.runtime=ju,Xp.typeName="livekit.LeaveRequest",Xp.fields=ju.util.newFieldList((()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:ju.getEnumType(Xu)}]));class Qp extends Ll{constructor(e){super(),this.trackSid="",this.layers=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Qp).fromBinary(e,t)}static fromJson(e,t){return(new Qp).fromJson(e,t)}static fromJsonString(e,t){return(new Qp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Qp,e,t)}}Qp.runtime=ju,Qp.typeName="livekit.UpdateVideoLayers",Qp.fields=ju.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:pd,repeated:!0}]));class Zp extends Ll{constructor(e){super(),this.metadata="",this.name="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new Zp).fromBinary(e,t)}static fromJson(e,t){return(new Zp).fromJson(e,t)}static fromJsonString(e,t){return(new Zp).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(Zp,e,t)}}Zp.runtime=ju,Zp.typeName="livekit.UpdateParticipantMetadata",Zp.fields=ju.util.newFieldList((()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]));class ef extends Ll{constructor(e){super(),this.urls=[],this.username="",this.credential="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new ef).fromBinary(e,t)}static fromJson(e,t){return(new ef).fromJson(e,t)}static fromJsonString(e,t){return(new ef).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(ef,e,t)}}ef.runtime=ju,ef.typeName="livekit.ICEServer",ef.fields=ju.util.newFieldList((()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]));class tf extends Ll{constructor(e){super(),this.speakers=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new tf).fromBinary(e,t)}static fromJson(e,t){return(new tf).fromJson(e,t)}static fromJsonString(e,t){return(new tf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(tf,e,t)}}tf.runtime=ju,tf.typeName="livekit.SpeakersChanged",tf.fields=ju.util.newFieldList((()=>[{no:1,name:"speakers",kind:"message",T:gd,repeated:!0}]));class nf extends Ll{constructor(e){super(),ju.util.initPartial(e,this)}static fromBinary(e,t){return(new nf).fromBinary(e,t)}static fromJson(e,t){return(new nf).fromJson(e,t)}static fromJsonString(e,t){return(new nf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(nf,e,t)}}nf.runtime=ju,nf.typeName="livekit.RoomUpdate",nf.fields=ju.util.newFieldList((()=>[{no:1,name:"room",kind:"message",T:ed}]));class rf extends Ll{constructor(e){super(),this.participantSid="",this.quality=Yu.POOR,this.score=0,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new rf).fromBinary(e,t)}static fromJson(e,t){return(new rf).fromJson(e,t)}static fromJsonString(e,t){return(new rf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(rf,e,t)}}rf.runtime=ju,rf.typeName="livekit.ConnectionQualityInfo",rf.fields=ju.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:ju.getEnumType(Yu)},{no:3,name:"score",kind:"scalar",T:2}]));class of extends Ll{constructor(e){super(),this.updates=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new of).fromBinary(e,t)}static fromJson(e,t){return(new of).fromJson(e,t)}static fromJsonString(e,t){return(new of).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(of,e,t)}}of.runtime=ju,of.typeName="livekit.ConnectionQualityUpdate",of.fields=ju.util.newFieldList((()=>[{no:1,name:"updates",kind:"message",T:rf,repeated:!0}]));class sf extends Ll{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=Dp.ACTIVE,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new sf).fromBinary(e,t)}static fromJson(e,t){return(new sf).fromJson(e,t)}static fromJsonString(e,t){return(new sf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(sf,e,t)}}sf.runtime=ju,sf.typeName="livekit.StreamStateInfo",sf.fields=ju.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ju.getEnumType(Dp)}]));class af extends Ll{constructor(e){super(),this.streamStates=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new af).fromBinary(e,t)}static fromJson(e,t){return(new af).fromJson(e,t)}static fromJsonString(e,t){return(new af).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(af,e,t)}}af.runtime=ju,af.typeName="livekit.StreamStateUpdate",af.fields=ju.util.newFieldList((()=>[{no:1,name:"stream_states",kind:"message",T:sf,repeated:!0}]));class cf extends Ll{constructor(e){super(),this.quality=Gu.LOW,this.enabled=!1,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new cf).fromBinary(e,t)}static fromJson(e,t){return(new cf).fromJson(e,t)}static fromJsonString(e,t){return(new cf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(cf,e,t)}}cf.runtime=ju,cf.typeName="livekit.SubscribedQuality",cf.fields=ju.util.newFieldList((()=>[{no:1,name:"quality",kind:"enum",T:ju.getEnumType(Gu)},{no:2,name:"enabled",kind:"scalar",T:8}]));class lf extends Ll{constructor(e){super(),this.codec="",this.qualities=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new lf).fromBinary(e,t)}static fromJson(e,t){return(new lf).fromJson(e,t)}static fromJsonString(e,t){return(new lf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(lf,e,t)}}lf.runtime=ju,lf.typeName="livekit.SubscribedCodec",lf.fields=ju.util.newFieldList((()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:cf,repeated:!0}]));class uf extends Ll{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new uf).fromBinary(e,t)}static fromJson(e,t){return(new uf).fromJson(e,t)}static fromJsonString(e,t){return(new uf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(uf,e,t)}}uf.runtime=ju,uf.typeName="livekit.SubscribedQualityUpdate",uf.fields=ju.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:cf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:lf,repeated:!0}]));class df extends Ll{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",ju.util.initPartial(e,this)}static fromBinary(e,t){return(new df).fromBinary(e,t)}static fromJson(e,t){return(new df).fromJson(e,t)}static fromJsonString(e,t){return(new df).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(df,e,t)}}df.runtime=ju,df.typeName="livekit.TrackPermission",df.fields=ju.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]));class hf extends Ll{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new hf).fromBinary(e,t)}static fromJson(e,t){return(new hf).fromJson(e,t)}static fromJsonString(e,t){return(new hf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(hf,e,t)}}hf.runtime=ju,hf.typeName="livekit.SubscriptionPermission",hf.fields=ju.util.newFieldList((()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:df,repeated:!0}]));class pf extends Ll{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new pf).fromBinary(e,t)}static fromJson(e,t){return(new pf).fromJson(e,t)}static fromJsonString(e,t){return(new pf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(pf,e,t)}}pf.runtime=ju,pf.typeName="livekit.SubscriptionPermissionUpdate",pf.fields=ju.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]));class ff extends Ll{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new ff).fromBinary(e,t)}static fromJson(e,t){return(new ff).fromJson(e,t)}static fromJsonString(e,t){return(new ff).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(ff,e,t)}}ff.runtime=ju,ff.typeName="livekit.SyncState",ff.fields=ju.util.newFieldList((()=>[{no:1,name:"answer",kind:"message",T:Jp},{no:2,name:"subscription",kind:"message",T:Yp},{no:3,name:"publish_tracks",kind:"message",T:$p,repeated:!0},{no:4,name:"data_channels",kind:"message",T:mf,repeated:!0},{no:5,name:"offer",kind:"message",T:Jp}]));class mf extends Ll{constructor(e){super(),this.label="",this.id=0,this.target=Ap.PUBLISHER,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new mf).fromBinary(e,t)}static fromJson(e,t){return(new mf).fromJson(e,t)}static fromJsonString(e,t){return(new mf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(mf,e,t)}}mf.runtime=ju,mf.typeName="livekit.DataChannelInfo",mf.fields=ju.util.newFieldList((()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:ju.getEnumType(Ap)}]));class gf extends Ll{constructor(e){super(),this.scenario={case:void 0},ju.util.initPartial(e,this)}static fromBinary(e,t){return(new gf).fromBinary(e,t)}static fromJson(e,t){return(new gf).fromJson(e,t)}static fromJsonString(e,t){return(new gf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(gf,e,t)}}gf.runtime=ju,gf.typeName="livekit.SimulateScenario",gf.fields=ju.util.newFieldList((()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:ju.getEnumType(Lp),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"}]));class vf extends Ll{constructor(e){super(),this.timestamp=Yl.zero,this.rtt=Yl.zero,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new vf).fromBinary(e,t)}static fromJson(e,t){return(new vf).fromJson(e,t)}static fromJsonString(e,t){return(new vf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(vf,e,t)}}vf.runtime=ju,vf.typeName="livekit.Ping",vf.fields=ju.util.newFieldList((()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]));class yf extends Ll{constructor(e){super(),this.lastPingTimestamp=Yl.zero,this.timestamp=Yl.zero,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new yf).fromBinary(e,t)}static fromJson(e,t){return(new yf).fromJson(e,t)}static fromJsonString(e,t){return(new yf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(yf,e,t)}}yf.runtime=ju,yf.typeName="livekit.Pong",yf.fields=ju.util.newFieldList((()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]));class bf extends Ll{constructor(e){super(),this.regions=[],ju.util.initPartial(e,this)}static fromBinary(e,t){return(new bf).fromBinary(e,t)}static fromJson(e,t){return(new bf).fromJson(e,t)}static fromJsonString(e,t){return(new bf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(bf,e,t)}}bf.runtime=ju,bf.typeName="livekit.RegionSettings",bf.fields=ju.util.newFieldList((()=>[{no:1,name:"regions",kind:"message",T:wf,repeated:!0}]));class wf extends Ll{constructor(e){super(),this.region="",this.url="",this.distance=Yl.zero,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new wf).fromBinary(e,t)}static fromJson(e,t){return(new wf).fromJson(e,t)}static fromJsonString(e,t){return(new wf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(wf,e,t)}}wf.runtime=ju,wf.typeName="livekit.RegionInfo",wf.fields=ju.util.newFieldList((()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]));class kf extends Ll{constructor(e){super(),this.trackSid="",this.err=Zu.SE_UNKNOWN,ju.util.initPartial(e,this)}static fromBinary(e,t){return(new kf).fromBinary(e,t)}static fromJson(e,t){return(new kf).fromJson(e,t)}static fromJsonString(e,t){return(new kf).fromJsonString(e,t)}static equals(e,t){return ju.util.equals(kf,e,t)}}kf.runtime=ju,kf.typeName="livekit.SubscriptionResponse",kf.fields=ju.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:ju.getEnumType(Zu)}]));const Sf=[];class Tf extends Gd.EventEmitter{constructor(e,t){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Tf.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout((()=>this.handleAppVisibilityChanged()),5e3):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Tf.Source.Unknown}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===Tf.Kind.Video&&(t="video"),0===this.attachedElements.length&&Tf.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(Sf.forEach((t=>{null!==t.parentElement||e||(e=t)})),e&&Sf.splice(Sf.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),Ef(this.mediaStreamTrack,e);const n=e.srcObject.getTracks(),r=n.some((e=>"audio"===e.kind));return e.play().then((()=>{this.emit(r?yp.AudioPlaybackStarted:yp.VideoPlaybackStarted)})).catch((t=>{"NotAllowedError"===t.name?this.emit(r?yp.AudioPlaybackFailed:yp.VideoPlaybackFailed,t):"AbortError"===t.name?wl.debug("".concat(r?"audio":"video"," playback aborted, likely due to new play request")):wl.warn("could not playback ".concat(r?"audio":"video"),t),r&&e&&n.some((e=>"video"===e.kind))&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch((()=>{})))})),this.emit(yp.ElementAttached,e),e}detach(e){try{if(e){Cf(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(yp.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach((e=>{Cf(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(yp.ElementDetached,e)})),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),Sf.forEach((e=>{e.parentElement||(t=!1)})),t&&Sf.push(e)}}handleAppVisibilityChanged(){return Rd(this,void 0,void 0,(function*(){this.isInBackground="hidden"===document.visibilityState}))}addAppVisibilityListener(){Wf()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Wf()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Ef(e,t){let n,r;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,r="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),r.includes(e)||(r.forEach((e=>{n.removeTrack(e)})),n.addTrack(e)),zf()&&t instanceof HTMLVideoElement||(t.autoplay=!0),t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(zf()||jf())&&t instanceof HTMLVideoElement&&setTimeout((()=>{t.srcObject=n,t.play().catch((()=>{}))}),0))}function Cf(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}function _f(e,t,n){var r;const i=null!==(r=function(e){if("undefined"!==typeof e)return"function"===typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}(e))&&void 0!==r?r:{};return!0===i.audio&&(i.audio={}),!0===i.video&&(i.video={}),i.audio&&xf(i.audio,t),i.video&&xf(i.video,n),i}function xf(e,t){return Object.keys(t).forEach((n=>{void 0===e[n]&&(e[n]=t[n])})),e}function If(e){const t={};if(e.video)if("object"===typeof e.video){const n={},r=n,i=e.video;Object.keys(i).forEach((e=>{if("resolution"===e)xf(r,i.resolution);else r[e]=i[e]})),t.video=n}else t.video=e.video;else t.video=!1;return e.audio?"object"===typeof e.audio?t.audio=e.audio:t.audio=!0:t.audio=!1,t}function Rf(){const e="undefined"!==typeof window&&(window.AudioContext||window.webkitAudioContext);if(e)return new e({latencyHint:"interactive"})}function Pf(e){var t,n;let r=null===(t=e.video)||void 0===t||t;return e.resolution&&(r="boolean"===typeof r?{}:r,r=zf()?Object.assign(Object.assign({},r),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},r),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:r,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio}}function Of(e){const t=e.split("/")[1].toLowerCase();if(!Ip.includes(t))throw Error("Video codec not supported: ".concat(t));return t}function Mf(e){const t=[];return e.forEach((e=>{void 0!==e.track&&t.push(new $p({cid:e.track.mediaStreamID,track:e.trackInfo}))})),t}!function(e){let t,n,r;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(r=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return Hu.AUDIO;case t.Video:return Hu.VIDEO;default:return Hu.DATA}},e.kindFromProto=function(e){switch(e){case Hu.AUDIO:return t.Audio;case Hu.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return Ju.CAMERA;case n.Microphone:return Ju.MICROPHONE;case n.ScreenShare:return Ju.SCREEN_SHARE;case n.ScreenShareAudio:return Ju.SCREEN_SHARE_AUDIO;default:return Ju.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case Ju.CAMERA:return n.Camera;case Ju.MICROPHONE:return n.Microphone;case Ju.SCREEN_SHARE:return n.ScreenShare;case Ju.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case Dp.ACTIVE:return r.Active;case Dp.PAUSED:return r.Paused;default:return r.Unknown}}}(Tf||(Tf={}));const Nf="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Af(e){return Rd(this,void 0,void 0,(function*(){return new Promise((t=>Cp.setTimeout(t,e)))}))}function Df(){return"addTransceiver"in RTCPeerConnection.prototype}function Lf(){return"addTrack"in RTCPeerConnection.prototype}function Uf(e){return"av1"===e||"vp9"===e}function Ff(e){return!!document&&(e||(e=document.createElement("audio")),"setSinkId"in e)}const Bf={Chrome:"100",Safari:"15",Firefox:"100"};function jf(){var e;return"Firefox"===(null===(e=Sp())||void 0===e?void 0:e.name)}function zf(){var e;return"Safari"===(null===(e=Sp())||void 0===e?void 0:e.name)}function Vf(){return!!Wf()&&/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent)}function Wf(){return"undefined"!==typeof document}function qf(){return"ReactNative"==navigator.product}function $f(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function Hf(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Jf(){if(!qf())return;let e=Hf();return e?e.platform:void 0}function Gf(){if(Wf())return window.devicePixelRatio;if(qf()){let e=Hf();if(e)return e.devicePixelRatio}return 1}function Yf(e,t){const n=e.split("."),r=t.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const e=parseInt(n[o],10),t=parseInt(r[o],10);if(e>t)return 1;if(e<t)return-1;if(o===i-1&&e===t)return 0}return""===e&&""!==t?-1:""===t?1:n.length==r.length?0:n.length<r.length?-1:1}function Kf(e){for(const t of e)t.target.handleResize(t)}function Xf(e){for(const t of e)t.target.handleVisibilityChanged(t)}let Qf=null;const Zf=()=>(Qf||(Qf=new ResizeObserver(Kf)),Qf);let em=null;const tm=()=>(em||(em=new IntersectionObserver(Xf,{root:null,rootMargin:"0px"})),em);let nm;function rm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=document.createElement("canvas");i.width=e,i.height=t;const o=i.getContext("2d");null===o||void 0===o||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(e/2,t/2,50,0,2*Math.PI,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}function im(){if(!nm){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const r=e.createMediaStreamDestination();if(t.connect(n),n.connect(r),t.start(),[nm]=r.stream.getAudioTracks(),!nm)throw Error("Could not get empty media stream audio track");nm.enabled=!1}return nm.clone()}class om{constructor(e,t){this.onFinally=t,this.promise=new Promise(((t,n)=>Rd(this,void 0,void 0,(function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})))).finally((()=>{var e;return null===(e=this.onFinally)||void 0===e?void 0:e.call(this)}))}}class sm{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise((t=>e=()=>{this._locks-=1,t()})),n=this._locking.then((()=>e));return this._locking=this._locking.then((()=>t)),n}}function am(e){if("string"===typeof e)return e;if(Array.isArray(e))return e[0];if(e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function cm(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}const lm="default";class um{static getInstance(){return void 0===this.instance&&(this.instance=new um),this.instance}getDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n;return Rd(this,void 0,void 0,(function*(){if((null===(n=um.userMediaPromiseMap)||void 0===n?void 0:n.size)>0){wl.debug("awaiting getUserMedia promise");try{e?yield um.userMediaPromiseMap.get(e):yield Promise.all(um.userMediaPromiseMap.values())}catch(i){wl.warn("error waiting for media permissons")}}let r=yield navigator.mediaDevices.enumerateDevices();if(t&&(!zf()||!this.hasDeviceInUse(e))){if(0===r.length||r.some((t=>{const n=""===t.label,r=!e||t.kind===e;return n&&r}))){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e},n=yield navigator.mediaDevices.getUserMedia(t);r=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach((e=>{e.stop()}))}}return e&&(r=r.filter((t=>t.kind===e))),r}))}normalizeDeviceId(e,t,n){return Rd(this,void 0,void 0,(function*(){if(t!==lm)return t;const r=(yield this.getDevices(e)).find((e=>e.groupId===n&&e.deviceId!==lm));return null===r||void 0===r?void 0:r.deviceId}))}hasDeviceInUse(e){return e?um.userMediaPromiseMap.has(e):um.userMediaPromiseMap.size>0}}um.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],um.userMediaPromiseMap=new Map;class dm extends Tf{get constraints(){return this._constraints}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch((()=>wl.debug("track mute bounce got cancelled by an unmute event"))),this.debouncedTrackMuteHandler=bp((()=>Rd(this,void 0,void 0,(function*(){yield this.pauseUpstream()}))),5e3),this.handleTrackUnmuteEvent=()=>Rd(this,void 0,void 0,(function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()})),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(yp.Ended,this)},this.reacquireTrack=!1,this.providedByUser=r,this.muteLock=new sm,this.pauseUpstreamLock=new sm,this.processorLock=new sm,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Tf.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}setMediaStreamTrack(e,t){return Rd(this,void 0,void 0,(function*(){if(e===this._mediaStreamTrack&&!t)return;let n;if(this._mediaStreamTrack&&(this.attachedElements.forEach((e=>{Cf(this._mediaStreamTrack,e)})),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop()),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e&&this.processorElement){if(wl.debug("restarting processor"),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");Ef(e,this.processorElement),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),n=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(null!==n&&void 0!==n?n:e)),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach((t=>{Ef(null!==n&&void 0!==n?n:e,t)})))}))}waitForDimensions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;var t;return Rd(this,void 0,void 0,(function*(){if(this.kind===Tf.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");"iOS"===(null===(t=Sp())||void 0===t?void 0:t.os)&&(yield Af(10));const n=Date.now();for(;Date.now()-n<e;){const e=this.dimensions;if(e)return e;yield Af(50)}throw new up("unable to get track dimensions after timeout")}))}getDeviceId(){return Rd(this,void 0,void 0,(function*(){if(this.source===Tf.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this._mediaStreamTrack.getSettings(),n=this.kind===Tf.Kind.Audio?"audioinput":"videoinput";return um.getInstance().normalizeDeviceId(n,e,t)}))}mute(){return Rd(this,void 0,void 0,(function*(){return this.setTrackMuted(!0),this}))}unmute(){return Rd(this,void 0,void 0,(function*(){return this.setTrackMuted(!1),this}))}replaceTrack(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Rd(this,void 0,void 0,(function*(){if(!this.sender)throw new up("unable to replace an unpublished track");return wl.debug("replace MediaStreamTrack"),yield this.setMediaStreamTrack(e),this.providedByUser=t,this.processor&&(yield this.stopProcessor()),this}))}restart(e){return Rd(this,void 0,void 0,(function*(){e||(e=this._constraints),wl.debug("restarting track with constraints",e);const t={audio:!1,video:!1};this.kind===Tf.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach((e=>{Cf(this.mediaStreamTrack,e)})),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const n=(yield navigator.mediaDevices.getUserMedia(t)).getTracks()[0];return n.addEventListener("ended",this.handleEnded),wl.debug("re-acquired MediaStreamTrack"),yield this.setMediaStreamTrack(n),this._constraints=e,this.emit(yp.Restarted,this),this}))}setTrackMuted(e){wl.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?yp.Muted:yp.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Rd(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),Vf()&&(wl.debug("visibility changed, is in Background: ".concat(this.isInBackground)),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(wl.debug("track needs to be reacquired, restarting ".concat(this.source)),yield this.restart(),this.reacquireTrack=!1))}))}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return Rd(this,void 0,void 0,(function*(){const e=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void wl.warn("unable to pause upstream for an unpublished track");this._isUpstreamPaused=!0,this.emit(yp.UpstreamPaused,this);const e=Sp();if("Safari"===(null===e||void 0===e?void 0:e.name)&&Yf(e.version,"12.0")<0)throw new lp("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}}))}resumeUpstream(){return Rd(this,void 0,void 0,(function*(){const e=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void wl.warn("unable to resume upstream for an unpublished track");this._isUpstreamPaused=!1,this.emit(yp.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}}))}getRTCStatsReport(){var e;return Rd(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;return yield this.sender.getStats()}))}setProcessor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n,r;return Rd(this,void 0,void 0,(function*(){const i=yield this.processorLock.lock();try{if(wl.debug("setting up processor"),this.processor&&(yield this.stopProcessor()),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement=null!==(n=this.processorElement)&&void 0!==n?n:document.createElement(this.kind),this.processorElement.muted=!0,Ef(this._mediaStreamTrack,this.processorElement),this.processorElement.play().catch((e=>wl.error("failed to play processor element",{error:e})));const i={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(i),this.processor=e,this.processor.processedTrack){for(const e of this.attachedElements)e!==this.processorElement&&t&&(Cf(this._mediaStreamTrack,e),Ef(this.processor.processedTrack,e));yield null===(r=this.sender)||void 0===r?void 0:r.replaceTrack(this.processor.processedTrack)}}finally{i()}}))}getProcessor(){return this.processor}stopProcessor(){var e,t;return Rd(this,void 0,void 0,(function*(){this.processor&&(wl.debug("stopping processor"),null===(e=this.processor.processedTrack)||void 0===e||e.stop(),yield this.processor.destroy(),this.processor=void 0,null===(t=this.processorElement)||void 0===t||t.remove(),this.processorElement=void 0,yield this.restart())}))}}class hm extends Gd.EventEmitter{constructor(e){super(),this.onWorkerMessage=e=>{var t,n;const{kind:r,data:i}=e.data;switch(r){case"error":wl.error(i.error.message),this.emit(rp.EncryptionError,i.error);break;case"initAck":i.enabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)}));break;case"enable":if(this.encryptionEnabled!==i.enabled&&i.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(rp.ParticipantEncryptionStatusChanged,i.enabled,this.room.localParticipant),this.encryptionEnabled=i.enabled;else if(i.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(i.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(i.participantIdentity));this.emit(rp.ParticipantEncryptionStatusChanged,i.enabled,e)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)}));break;case"ratchetKey":this.keyProvider.emit(tp.KeyRatcheted,i.material,i.keyIndex)}},this.onWorkerError=e=>{wl.error("e2ee worker encountered an error:",{error:e.error}),this.emit(rp.EncryptionError,e.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!op())throw new lp("tried to setup end-to-end encryption on an unsupported browser");if(wl.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(wl.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){wl.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):wl.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(vp.RTPVideoMapUpdate,(e=>{this.postRTPMap(e)}))}setupEventListeners(e,t){e.on(mp.TrackPublished,((e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==sd.NONE,t.identity))),e.on(mp.ConnectionStateChanged,(t=>{t===Ig.Connected&&e.participants.forEach((e=>{e.tracks.forEach((t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==sd.NONE,e.identity)}))}))})).on(mp.TrackUnsubscribed,((e,t,n)=>{var r;const i={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(r=this.worker)||void 0===r||r.postMessage(i)})).on(mp.TrackSubscribed,((e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)})).on(mp.SignalConnected,(()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),t.getKeys().forEach((e=>{this.postKey(e)}))})),e.localParticipant.on(gp.LocalTrackPublished,(e=>Rd(this,void 0,void 0,(function*(){this.setupE2EESender(e.track,e.track.sender)})))),t.on(tp.SetKey,(e=>this.postKey(e))).on(tp.RatchetRequest,((e,t)=>this.postRatchetRequest(e,t)))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:r}=e;var i;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(i=this.room)||void 0===i?void 0:i.localParticipant.identity),key:t,keyIndex:r}};this.worker.postMessage(o)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null===n||void 0===n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?Of(n.mimeType):void 0)}}setupE2EESender(e,t){e instanceof dm&&t?this.handleSender(t,e.mediaStreamID,void 0):t||wl.warn("early return because sender is not ready")}handleReceiver(e,t,n,r){return Rd(this,void 0,void 0,(function*(){if(this.worker){if(sp()){const i={kind:"decode",participantIdentity:n,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,i)}else{if(ep in e&&r){const e={kind:"updateCodec",data:{trackId:t,codec:r,participantIdentity:n}};return void this.worker.postMessage(e)}let i=e.writableStream,o=e.readableStream;if(!i||!o){const t=e.createEncodedStreams();e.writableStream=t.writable,i=t.writable,e.readableStream=t.readable,o=t.readable}const s={kind:"decode",data:{readableStream:o,writableStream:i,trackId:t,codec:r,participantIdentity:n}};this.worker.postMessage(s,[o,i])}e[ep]=!0}}))}handleSender(e,t,n){var r;if(!(ep in e)&&this.worker){if(!(null===(r=this.room)||void 0===r?void 0:r.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(sp()){wl.info("initialize script transform");const r={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{wl.info("initialize encoded streams");const r=e.createEncodedStreams(),i={kind:"encode",data:{readableStream:r.readable,writableStream:r.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i,[r.readable,r.writable])}e[ep]=!0}}}var pm;!function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(pm||(pm={}));class fm{constructor(){this.pendingTasks=new Map,this.taskMutex=new sm,this.nextTaskIndex=0}run(e){return Rd(this,void 0,void 0,(function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:pm.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=pm.RUNNING,yield e()}finally{t.status=pm.COMPLETED,this.pendingTasks.delete(t.id),n()}}))}flush(){return Rd(this,void 0,void 0,(function*(){return this.run((()=>Rd(this,void 0,void 0,(function*(){}))))}))}snapshot(){return Array.from(this.pendingTasks.values())}}const mm=["syncState","trickle","offer","answer","simulate","leave"];var gm;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"}(gm||(gm={}));class vm{get currentState(){return this.state}get isDisconnected(){return this.state===gm.DISCONNECTING||this.state===gm.DISCONNECTED}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rtt=0,this.state=gm.DISCONNECTED,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.useJSON=e,this.requestQueue=new fm,this.queuedRequests=[],this.closingLock=new sm,this.connectionLock=new sm,this.state=gm.DISCONNECTED}join(e,t,n,r){return Rd(this,void 0,void 0,(function*(){this.state=gm.CONNECTING,this.options=n;return yield this.connect(e,t,n,r)}))}reconnect(e,t,n,r){return Rd(this,void 0,void 0,(function*(){if(!this.options)return void wl.warn("attempted to reconnect without signal options being set, ignoring");this.state=gm.RECONNECTING,this.clearPingInterval();return yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:r}))}))}connect(e,t,n,r){this.connectOptions=n,e=(e=function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e)).replace(/\/$/,""),e+="/rtc";const i=function(e,t,n){var r;const i=new URLSearchParams;i.set("access_token",e),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid));i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",qf()?"reactnative":"js"),i.set("version",t.version),i.set("protocol",t.protocol.toString()),t.deviceModel&&i.set("device_model",t.deviceModel);t.os&&i.set("os",t.os);t.osVersion&&i.set("os_version",t.osVersion);t.browser&&i.set("browser",t.browser);t.browserVersion&&i.set("browser_version",t.browserVersion);void 0!==n.publishOnly&&i.set("publish",n.publishOnly);n.adaptiveStream&&i.set("adaptive_stream","1");n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString());(null===(r=navigator.connection)||void 0===r?void 0:r.type)&&i.set("network",navigator.connection.type);return"?".concat(i.toString())}(t,function(){var e;const t=new wd({sdk:ld.JS,protocol:11,version:"1.15.4"});return qf()&&(t.os=null!==(e=Jf())&&void 0!==e?e:""),t}(),n);return new Promise(((t,o)=>Rd(this,void 0,void 0,(function*(){const s=yield this.connectionLock.lock();try{const s=()=>Rd(this,void 0,void 0,(function*(){this.close(),clearTimeout(a),o(new cp("room connection has been cancelled (signal)"))})),a=setTimeout((()=>{this.close(),o(new cp("room connection has timed out (signal)"))}),n.websocketTimeout);(null===r||void 0===r?void 0:r.aborted)&&s(),null===r||void 0===r||r.addEventListener("abort",s),wl.debug("connecting to ".concat(e+i)),this.ws&&(yield this.close()),this.ws=new WebSocket(e+i),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(a)},this.ws.onerror=t=>Rd(this,void 0,void 0,(function*(){if(this.state===gm.CONNECTED)this.handleWSError(t);else{clearTimeout(a);try{const t=yield fetch("http".concat(e.substring(2),"/validate").concat(i));if(t.status.toFixed(0).startsWith("4")){const e=yield t.text();o(new cp(e,0,t.status))}else o(new cp("Internal error",2,t.status))}catch(n){o(new cp("server was not reachable",1))}}})),this.ws.onmessage=e=>Rd(this,void 0,void 0,(function*(){var i,a,c,l;let u;if("string"===typeof e.data){const t=JSON.parse(e.data);u=Fp.fromJson(t)}else{if(!(e.data instanceof ArrayBuffer))return void wl.error("could not decode websocket message: ".concat(typeof e.data));u=Fp.fromBinary(new Uint8Array(e.data))}if(this.state!==gm.CONNECTED){let e=!1;if("join"===(null===(i=u.message)||void 0===i?void 0:i.case)?(this.state=gm.CONNECTED,null===r||void 0===r||r.removeEventListener("abort",s),this.pingTimeoutDuration=u.message.value.pingTimeout,this.pingIntervalDuration=u.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(wl.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),t(u.message.value)):this.state===gm.RECONNECTING?(this.state=gm.CONNECTED,null===r||void 0===r||r.removeEventListener("abort",s),this.startPingInterval(),"reconnect"===(null===(a=u.message)||void 0===a?void 0:a.case)?t(null===(c=u.message)||void 0===c?void 0:c.value):(t(),e=!0)):n.reconnect||o(new cp("did not receive join response, got ".concat(null===(l=u.message)||void 0===l?void 0:l.case," instead"))),!e)return}this.signalLatency&&(yield Af(this.signalLatency)),this.handleSignalResponse(u)})),this.ws.onclose=e=>{wl.warn("websocket closed",{ev:e}),this.handleOnClose(e.reason)}}finally{s()}}))))}close(){return Rd(this,void 0,void 0,(function*(){const e=yield this.closingLock.lock();try{if(this.state=gm.DISCONNECTING,this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const e=new Promise((e=>{this.ws?this.ws.onclose=()=>{e()}:e()}));this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([e,Af(250)])),this.ws=void 0}}finally{this.state=gm.DISCONNECTED,this.clearPingInterval(),e()}}))}sendOffer(e){wl.debug("sending offer",e),this.sendRequest({case:"offer",value:bm(e)})}sendAnswer(e){return wl.debug("sending answer"),this.sendRequest({case:"answer",value:bm(e)})}sendIceCandidate(e,t){return wl.trace("sending ice candidate",e),this.sendRequest({case:"trickle",value:new zp({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Vp({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return this.sendRequest({case:"updateMetadata",value:new Zp({metadata:e,name:t})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new Qp({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new hf({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Yl.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new vf({timestamp:Yl.parse(Date.now()),rtt:Yl.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new Xp({canReconnect:!1,reason:Xu.CLIENT_INITIATED})})}sendRequest(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Rd(this,void 0,void 0,(function*(){const n=!t&&!function(e){const t=mm.indexOf(e.case)>=0;return wl.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(n&&this.state===gm.RECONNECTING)return void this.queuedRequests.push((()=>Rd(this,void 0,void 0,(function*(){yield this.sendRequest(e,!0)}))));if(t||(yield this.requestQueue.flush()),this.signalLatency&&(yield Af(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN)return void wl.error("cannot send signal request before connected, type: ".concat(null===e||void 0===e?void 0:e.case));const r=new Up({message:e});try{this.useJSON?this.ws.send(r.toJsonString()):this.ws.send(r.toBinary())}catch(i){wl.error("error sending signal message",{error:i})}}))}handleSignalResponse(e){var t,n;const r=e.message;if(void 0==r)return void wl.debug("received unsupported message");let i=!1;if("answer"===r.case){const e=ym(r.value);this.onAnswer&&this.onAnswer(e)}else if("offer"===r.case){const e=ym(r.value);this.onOffer&&this.onOffer(e)}else if("trickle"===r.case){const e=JSON.parse(r.value.candidateInit);this.onTrickle&&this.onTrickle(e,r.value.target)}else"update"===r.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=r.value.participants)&&void 0!==t?t:[]):"trackPublished"===r.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(r.value):"speakersChanged"===r.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=r.value.speakers)&&void 0!==n?n:[]):"leave"===r.case?this.onLeave&&this.onLeave(r.value):"mute"===r.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(r.value.sid,r.value.muted):"roomUpdate"===r.case?this.onRoomUpdate&&r.value.room&&this.onRoomUpdate(r.value.room):"connectionQuality"===r.case?this.onConnectionQuality&&this.onConnectionQuality(r.value):"streamStateUpdate"===r.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(r.value):"subscribedQualityUpdate"===r.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(r.value):"subscriptionPermissionUpdate"===r.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(r.value):"refreshToken"===r.case?this.onTokenRefresh&&this.onTokenRefresh(r.value):"trackUnpublished"===r.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(r.value):"subscriptionResponse"===r.case?this.onSubscriptionError&&this.onSubscriptionError(r.value):"pong"===r.case||("pongResp"===r.case?(this.rtt=Date.now()-Number.parseInt(r.value.lastPingTimestamp.toString()),this.resetPingTimeout(),i=!0):wl.debug("unsupported message",r));i||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return Rd(this,void 0,void 0,(function*(){if(this.state===gm.DISCONNECTED)return;const t=this.onClose;yield this.close(),wl.debug("websocket connection closed: ".concat(e)),t&&t(e)}))}handleWSError(e){wl.error("websocket error",e)}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=Cp.setTimeout((()=>{wl.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString())),this.handleOnClose("ping timeout")}),1e3*this.pingTimeoutDuration):wl.warn("ping timeout duration not set")}clearPingTimeout(){this.pingTimeout&&Cp.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(wl.debug("start ping interval"),this.pingInterval=Cp.setInterval((()=>{this.sendPing()}),1e3*this.pingIntervalDuration)):wl.warn("ping interval duration not set")}clearPingInterval(){wl.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&Cp.clearInterval(this.pingInterval)}}function ym(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function bm(e){return new Jp({sdp:e.sdp,type:e.type})}var wm={},km={exports:{}},Sm=km.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Sm).forEach((function(e){Sm[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}));var Tm=km.exports;!function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,r){var i=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:i&&!n[e.name]&&(n[e.name]={});var o=e.push?{}:i?n[e.name]:n;!function(e,n,r,i){if(i&&!r)n[i]=t(e[1]);else for(var o=0;o<r.length;o+=1)null!=e[o+1]&&(n[r[o]]=t(e[o+1]))}(r.match(e.reg),o,e.names,e.name),e.push&&n[e.push].push(o)},r=Tm,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},o=[],s=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach((function(e){var t=e[0],i=e.slice(2);"m"===t&&(o.push({rtp:[],fmtp:[]}),s=o[o.length-1]);for(var a=0;a<(r[t]||[]).length;a+=1){var c=r[t][a];if(c.reg.test(i))return n(c,s,i)}})),t.media=o,t};var o=function(e,n){var r=n.split(/=(.+)/,2);return 2===r.length?e[r[0]]=t(r[1]):1===r.length&&n.length>1&&(e[r[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],r=e.split(" ").map(t),i=0;i<r.length;i+=3)n.push({component:r[i],ip:r[i+1],port:r[i+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var n,r=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),r=!0),{scid:n,paused:r}}))}))}}(wm);var Em=Tm,Cm=/%[sdv%]/g,_m=function(e){var t=1,n=arguments,r=n.length;return e.replace(Cm,(function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},xm=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?r.push(n[t.name][o]):r.push(n[t.names[i]])}else r.push(n[t.name]);return _m.apply(null,r)},Im=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Rm=["i","c","b","a"],Pm=wm,Om=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||Im,r=t.innerOrder||Rm,i=[];return n.forEach((function(t){Em[t].forEach((function(n){n.name in e&&null!=e[n.name]?i.push(xm(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){i.push(xm(t,n,e))}))}))})),e.media.forEach((function(e){i.push(xm("m",Em.m[0],e)),r.forEach((function(t){Em[t].forEach((function(n){n.name in e&&null!=e[n.name]?i.push(xm(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){i.push(xm(t,n,e))}))}))}))})),i.join("\r\n")+"\r\n"},Mm=Om,Nm=Pm.parse;const Am="negotiationStarted",Dm="negotiationComplete",Lm="rtpVideoPayloadTypes";class Um extends Gd.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=bp((e=>Rd(this,void 0,void 0,(function*(){this.emit(Am);try{yield this.createAndSendOffer()}catch(t){if(!e)throw t;e(t)}}))),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.config=e,this.mediaConstraints=t,this._pc=this.createPC()}createPC(){const e=function(){var e;return"Chrome"===(null===(e=Sp())||void 0===e?void 0:e.name)}()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=e=>{var t;e.candidate&&(null===(t=this.onIceCandidate)||void 0===t||t.call(this,e.candidate))},e.onicecandidateerror=e=>{var t;null===(t=this.onIceCandidateError)||void 0===t||t.call(this,e)},e.oniceconnectionstatechange=()=>{var t;null===(t=this.onIceConnectionStateChange)||void 0===t||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;null===(t=this.onSignalingStatechange)||void 0===t||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,e.connectionState)},e.ondatachannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},e.ontrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},e}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return Rd(this,void 0,void 0,(function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)}))}setRemoteDescription(e){var t;return Rd(this,void 0,void 0,(function*(){let n;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],r=[],i=Nm(null!==(t=e.sdp)&&void 0!==t?t:"");let o=0;return i.media.forEach((e=>{var t;"audio"===e.type&&(e.rtp.some((e=>"opus"===e.codec&&(o=e.payload,!0))),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some((e=>e.payload===o&&"nack"===e.type)))&&r.push(e.mid),e.fmtp.some((t=>t.payload===o&&(t.config.includes("sprop-stereo=1")&&n.push(e.mid),!0))))})),{stereoMids:n,nackMids:r}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const r=Nm(null!==(t=e.sdp)&&void 0!==t?t:"");r.media.forEach((e=>{"audio"===e.type&&this.trackBitrates.some((t=>{if(!t.transceiver||e.mid!=t.transceiver.mid)return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;let r=!1;for(const i of e.fmtp)if(i.payload===n){i.config=i.config.split(";").filter((e=>!e.includes("maxaveragebitrate"))).join(";"),t.maxbr>0&&(i.config+=";maxaveragebitrate=".concat(1e3*t.maxbr)),r=!0;break}return r||t.maxbr>0&&e.fmtp.push({payload:n,config:"maxaveragebitrate=".concat(1e3*t.maxbr)}),!0}))})),n=Mm(r)}if(yield this.setMungedSDP(e,n,!0),this.pendingCandidates.forEach((e=>{this.pc.addIceCandidate(e)})),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate)this.renegotiate=!1,yield this.createAndSendOffer();else if("answer"===e.type&&(this.emit(Dm),e.sdp)){Nm(e.sdp).media.forEach((e=>{"video"===e.type&&this.emit(Lm,e.rtp)}))}}))}createAndSendOffer(e){var t;return Rd(this,void 0,void 0,(function*(){if(void 0===this.onOffer)return;if((null===e||void 0===e?void 0:e.iceRestart)&&(wl.debug("restarting ICE"),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this._pc.remoteDescription;if(!(null===e||void 0===e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this._pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void wl.warn("could not createOffer with closed peer connection");wl.debug("starting to negotiate");const n=yield this.pc.createOffer(e),r=Nm(null!==(t=n.sdp)&&void 0!==t?t:"");r.media.forEach((e=>{"audio"===e.type?Fm(e,[],[]):"video"===e.type&&(!function(e){var t,n,r,i;const o=null===(n=null===(t=e.rtp[0])||void 0===t?void 0:t.codec)||void 0===n?void 0:n.toLowerCase();if(!Uf(o))return;let s=0;const a=null===(r=e.ext)||void 0===r?void 0:r.some((e=>e.uri===Nf||(e.value>s&&(s=e.value),!1)));a||null===(i=e.ext)||void 0===i||i.push({value:s+1,uri:Nf})}(e),this.trackBitrates.some((t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;let r=!1;for(const i of e.fmtp)if(i.payload===n){i.config.includes("x-google-start-bitrate")||(i.config+=";x-google-start-bitrate=".concat(Math.round(.7*t.maxbr))),i.config.includes("x-google-max-bitrate")||(i.config+=";x-google-max-bitrate=".concat(t.maxbr)),r=!0;break}return r||e.fmtp.push({payload:n,config:"x-google-start-bitrate=".concat(Math.round(.7*t.maxbr),";x-google-max-bitrate=").concat(t.maxbr)}),!0})))})),yield this.setMungedSDP(n,Mm(r)),this.onOffer(n)}))}createAndSetAnswer(){var e;return Rd(this,void 0,void 0,(function*(){const t=yield this.pc.createAnswer(),n=Nm(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach((e=>{"audio"===e.type&&Fm(e,this.remoteStereoMids,this.remoteNackMids)})),yield this.setMungedSDP(t,Mm(n)),t}))}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new hp("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new hp("PC closed, cannot configure");return null===(t=this._pc)||void 0===t?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(null===(e=this._pc)||void 0===e?void 0:e.removeTrack)}removeTrack(e){var t;return null===(t=this._pc)||void 0===t?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&void 0!==t?t:"closed"}getICEConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.iceConnectionState)&&void 0!==t?t:"closed"}getSignallingState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.signalingState)&&void 0!==t?t:"closed"}getTransceivers(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getTransceivers())&&void 0!==t?t:[]}getSenders(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getSenders())&&void 0!==t?t:[]}getLocalDescription(){var e;return null===(e=this._pc)||void 0===e?void 0:e.localDescription}getRemoteDescription(){var e;return null===(e=this.pc)||void 0===e?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return Rd(this,void 0,void 0,(function*(){if(!this._pc)return;let t="";const n=new Map,r=new Map;if((yield this._pc.getStats()).forEach((e=>{switch(e.type){case"transport":t=e.selectedCandidatePairId;break;case"candidate-pair":""===t&&e.selected&&(t=e.id),n.set(e.id,e);break;case"remote-candidate":r.set(e.id,"".concat(e.address,":").concat(e.port))}})),""===t)return;const i=null===(e=n.get(t))||void 0===e?void 0:e.remoteCandidateId;return void 0!==i?r.get(i):void 0}))}setMungedSDP(e,t,n){return Rd(this,void 0,void 0,(function*(){if(t){const i=e.sdp;e.sdp=t;try{return wl.debug("setting munged ".concat(n?"remote":"local"," description")),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(r){wl.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),{error:r,sdp:t}),e.sdp=i}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(r){let t="unknown error";r instanceof Error?t=r.message:"string"===typeof r&&(t=r);const i={error:t,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(i.remoteSdp=this.pc.remoteDescription),wl.error("unable to set ".concat(e.type),i),new pp(t)}}))}}function Fm(e,t,n){let r=0;e.rtp.some((e=>"opus"===e.codec&&(r=e.payload,!0))),r>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(e.mid)&&!e.rtcpFb.some((e=>e.payload===r&&"nack"===e.type))&&e.rtcpFb.push({payload:r,type:"nack"}),t.includes(e.mid)&&e.fmtp.some((e=>e.payload===r&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0))))}const Bm="vp8",jm={audioBitrate:Pp.music.maxBitrate,audioPreset:Pp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Np.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Bm,backupCodec:!0},zm={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},Vm={resolution:Op.h720.resolution},Wm={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:Id}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,expWebAudioMix:!1},qm={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var $m;!function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}($m||($m={}));class Hm{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t){this.peerConnectionTimeout=qm.peerConnectionTimeout,this.updateState=()=>{var e;const t=this.state,n=this.requiredTransports.map((e=>e.getConnectionState()));n.every((e=>"connected"===e))?this.state=$m.CONNECTED:n.some((e=>"failed"===e))?this.state=$m.FAILED:n.some((e=>"connecting"===e))?this.state=$m.CONNECTING:n.every((e=>"closed"===e))?this.state=$m.CLOSED:n.some((e=>"closed"===e))?this.state=$m.CLOSING:n.every((e=>"new"===e))&&(this.state=$m.NEW),t!==this.state&&(wl.debug("pc state change: from ".concat($m[t]," to ").concat($m[this.state])),null===(e=this.onStateChange)||void 0===e||e.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t;this.publisher=new Um(e,{optional:[{googDscp:!0}]}),this.subscriber=new Um(e),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Ap.PUBLISHER)},this.subscriber.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Ap.SUBSCRIBER)},this.subscriber.onDataChannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},this.subscriber.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},this.publisher.onOffer=e=>{var t;null===(t=this.onPublisherOffer)||void 0===t||t.call(this,e)},this.state=$m.NEW,this.connectionLock=new sm}requirePublisher(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return Rd(this,void 0,void 0,(function*(){if(this.publisher&&"closed"!==this.publisher.getSignallingState()){const t=this.publisher;for(const n of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(n)}catch(e){wl.warn("could not removeTrack",{error:e})}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()}))}triggerIceRestart(){return Rd(this,void 0,void 0,(function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))}))}addIceCandidate(e,t){return Rd(this,void 0,void 0,(function*(){t===Ap.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)}))}createSubscriberAnswerFromOffer(e){return Rd(this,void 0,void 0,(function*(){wl.debug("received server offer",{RTCSdpType:e.type,signalingState:this.subscriber.getSignallingState().toString()}),yield this.subscriber.setRemoteDescription(e);return yield this.subscriber.createAndSetAnswer()}))}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){var n;return Rd(this,void 0,void 0,(function*(){const r=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(wl.debug("negotiation required, start negotiating"),this.publisher.negotiate()),yield Promise.all(null===(n=this.requiredTransports)||void 0===n?void 0:n.map((n=>this.ensureTransportConnected(n,e,t))))}finally{r()}}))}negotiate(e){return Rd(this,void 0,void 0,(function*(){return new Promise(((t,n)=>Rd(this,void 0,void 0,(function*(){const r=setTimeout((()=>{n("negotiation timed out")}),this.peerConnectionTimeout);e.signal.addEventListener("abort",(()=>{clearTimeout(r),n("negotiation aborted")})),this.publisher.once(Am,(()=>{e.signal.aborted||this.publisher.once(Dm,(()=>{clearTimeout(r),t()}))})),yield this.publisher.negotiate((e=>{clearTimeout(r),n(e)}))}))))}))}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Ap.PUBLISHER||e===Ap.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return Rd(this,void 0,void 0,(function*(){if("connected"!==e.getConnectionState())return new Promise(((e,r)=>Rd(this,void 0,void 0,(function*(){const i=()=>{wl.warn("abort transport connection"),Cp.clearTimeout(o),r(new cp("room connection has been cancelled",3))};(null===t||void 0===t?void 0:t.signal.aborted)&&i(),null===t||void 0===t||t.signal.addEventListener("abort",i);const o=Cp.setTimeout((()=>{null===t||void 0===t||t.signal.removeEventListener("abort",i),r(new cp("could not establish pc connection"))}),n);for(;this.state!==$m.CONNECTED;)if(yield Af(50),null===t||void 0===t?void 0:t.signal.aborted)return void r(new cp("room connection has been cancelled",3));Cp.clearTimeout(o),null===t||void 0===t||t.signal.removeEventListener("abort",i),e()}))))}))}}const Jm="_lossy",Gm="_reliable",Ym="leave-reconnect";var Km;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(Km||(Km={}));class Xm extends Gd.EventEmitter{get isClosed(){return this._isClosed}constructor(e){super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=qm.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Km.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=e=>{let{channel:t}=e;return Rd(this,void 0,void 0,(function*(){if(t){if(t.label===Gm)this.reliableDCSub=t;else{if(t.label!==Jm)return;this.lossyDCSub=t}wl.debug("on data channel ".concat(t.id,", ").concat(t.label)),t.onmessage=this.handleDataMessage}}))},this.handleDataMessage=e=>Rd(this,void 0,void 0,(function*(){var t,n;const r=yield this.dataProcessLock.lock();try{let r;if(e.data instanceof ArrayBuffer)r=e.data;else{if(!(e.data instanceof Blob))return void wl.error("unsupported data type",e.data);r=yield e.data.arrayBuffer()}const i=fd.fromBinary(new Uint8Array(r));"speaker"===(null===(t=i.value)||void 0===t?void 0:t.case)?this.emit(vp.ActiveSpeakersUpdate,i.value.value.speakers):"user"===(null===(n=i.value)||void 0===n?void 0:n.case)&&this.emit(vp.DataPacketReceived,i.value.value,i.kind)}finally{r()}})),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;wl.error("DataChannel error on ".concat(t,": ").concat(e.message),n)}else wl.error("Unknown DataChannel error on ".concat(t),e)},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?ad.LOSSY:ad.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;wl.warn("".concat(e," disconnected")),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=e=>{wl.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up")),this.emit(vp.Disconnected),this.close()},r=Date.now()-this.reconnectStart;let i=this.getNextRetryDelay({elapsedMs:r,retryCount:this.reconnectAttempts});null!==i?(e===Ym&&(i=0),wl.debug("reconnecting in ".concat(i,"ms")),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Cp.setTimeout((()=>this.attemptReconnect(t)),i)):n(r)},this.waitForRestarted=()=>new Promise(((e,t)=>{this.pcState===Km.Connected&&e();const n=()=>{this.off(vp.Disconnected,r),e()},r=()=>{this.off(vp.Restarted,n),t()};this.once(vp.Restarted,n),this.once(vp.Disconnected,r)})),this.updateAndEmitDCBufferStatus=e=>{const t=this.isBufferStatusLow(e);"undefined"!==typeof t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(vp.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===gm.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Qu.RR_SIGNAL_DISCONNECTED))},this.client=new vm,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new sm,this.dataProcessLock=new sm,this.dcBufferStatus=new Map([[ad.LOSSY,!0],[ad.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(vp.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(vp.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(vp.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(vp.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(vp.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(vp.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(vp.StreamStateChanged,e)}join(e,t,n,r){return Rd(this,void 0,void 0,(function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const i=yield this.client.join(e,t,n,r);return this._isClosed=!1,this.latestJoinResponse=i,this.subscriberPrimary=i.subscriberPrimary,this.pcManager||(yield this.configure(i)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=i.clientConfiguration,i}catch(i){if(i instanceof cp&&1===i.reason&&(wl.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,r);throw i}}))}close(){return Rd(this,void 0,void 0,(function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.emit(vp.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}}))}cleanupPeerConnections(){var e;return Rd(this,void 0,void 0,(function*(){yield null===(e=this.pcManager)||void 0===e?void 0:e.close(),this.pcManager=void 0;const t=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0}))}cleanupClient(){return Rd(this,void 0,void 0,(function*(){yield this.client.close(),this.client.resetCallbacks()}))}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new up("a track with the same ID has already been published");return new Promise(((t,n)=>{const r=setTimeout((()=>{delete this.pendingTrackResolvers[e.cid],n(new cp("publication of local track timed out, no response from server"))}),1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(r),t(e)},reject:()=>{clearTimeout(r),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)}))}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){wl.warn("failed to remove track",{error:t,method:"removeTrack"})}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){var e;return Rd(this,void 0,void 0,(function*(){return null===(e=this.pcManager)||void 0===e?void 0:e.getConnectedAddress()}))}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var t;return Rd(this,void 0,void 0,(function*(){if(this.pcManager&&this.pcManager.currentState!==$m.NEW)return;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;const n=this.makeRTCConfiguration(e);this.pcManager=new Hm(n,e.subscriberPrimary),this.emit(vp.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(e,t)=>{this.client.sendIceCandidate(e,t)},this.pcManager.onPublisherOffer=e=>{this.client.sendOffer(e)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(t,n,r)=>Rd(this,void 0,void 0,(function*(){if(wl.debug("primary PC state changed ".concat(t)),t===$m.CONNECTED){const t=this.pcState===Km.New;this.pcState=Km.Connected,t&&this.emit(vp.Connected,e)}else t===$m.FAILED&&this.pcState===Km.Connected&&(this.pcState=Km.Disconnected,this.handleDisconnect("peerconnection failed","failed"===r?Qu.RR_SUBSCRIBER_FAILED:Qu.RR_PUBLISHER_FAILED))})),this.pcManager.onTrack=e=>{this.emit(vp.MediaTrackAdded,e.track,e.streams[0],e.receiver)},this.createDataChannels()}))}setupSignalClientCallbacks(){this.client.onAnswer=e=>Rd(this,void 0,void 0,(function*(){this.pcManager&&(wl.debug("received server answer",{RTCSdpType:e.type}),yield this.pcManager.setPublisherAnswer(e))})),this.client.onTrickle=(e,t)=>{this.pcManager&&(wl.trace("got ICE candidate from peer",{candidate:e,target:t}),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=e=>Rd(this,void 0,void 0,(function*(){if(!this.pcManager)return;const t=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(t)})),this.client.onLocalTrackPublished=e=>{if(wl.debug("received trackPublishedResponse",e),!this.pendingTrackResolvers[e.cid])return void wl.error("missing track resolver for ".concat(e.cid));const{resolve:t}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],t(e.track)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onClose=()=>{this.handleDisconnect("signal",Qu.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{(null===e||void 0===e?void 0:e.canReconnect)?(this.fullReconnectOnNext=!0,this.handleDisconnect(Ym)):(this.emit(vp.Disconnected,null===e||void 0===e?void 0:e.reason),this.close()),wl.trace("leave request",{leave:e})}}makeRTCConfiguration(e){var t;const n=Object.assign({},this.rtcConfig);if((null===(t=this.signalOpts)||void 0===t?void 0:t.e2eeEnabled)&&(wl.debug("E2EE - setting up transports with insertable streams"),n.encodedInsertableStreams=!0),e.iceServers&&!n.iceServers){const t=[];e.iceServers.forEach((e=>{const n={urls:e.urls};e.username&&(n.username=e.username),e.credential&&(n.credential=e.credential),t.push(n)})),n.iceServers=t}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Ku.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(Jm,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Gm,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,t,n){if(!("getCapabilities"in RTCRtpSender))return;const r=RTCRtpSender.getCapabilities(t);if(!r)return;wl.debug("get capabilities",r);const i=[],o=[],s=[];r.codecs.forEach((e=>{const t=e.mimeType.toLowerCase();if("audio/opus"===t)return void i.push(e);t==="video/".concat(n)?"h264"!==n||e.sdpFmtpLine&&e.sdpFmtpLine.includes("profile-level-id=42e01f")?i.push(e):o.push(e):s.push(e)})),function(e){if(!Wf())return!1;if(!("setCodecPreferences"in e))return!1;const t=Sp();if(!(null===t||void 0===t?void 0:t.name)||!t.version)return!1;const n=Bf[t.name];return!!n&&Yf(t.version,n)>=0}(e)&&e.setCodecPreferences(i.concat(o,s))}createSender(e,t,n){return Rd(this,void 0,void 0,(function*(){if(Df()){return yield this.createTransceiverRTCRtpSender(e,t,n)}if(Lf()){wl.warn("using add-track fallback");return yield this.createRTCRtpSender(e.mediaStreamTrack)}throw new hp("Required webRTC APIs not supported on this device")}))}createSimulcastSender(e,t,n,r){return Rd(this,void 0,void 0,(function*(){if(Df())return this.createSimulcastTransceiverSender(e,t,n,r);if(Lf())return wl.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new hp("Cannot stream on this device")}))}createTransceiverRTCRtpSender(e,t,n){return Rd(this,void 0,void 0,(function*(){if(!this.pcManager)throw new hp("publisher is closed");const r=[];e.mediaStream&&r.push(e.mediaStream);const i={direction:"sendonly",streams:r};n&&(i.sendEncodings=n);const o=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,i);return e.kind===Tf.Kind.Video&&t.videoCodec&&(this.setPreferredCodec(o,e.kind,t.videoCodec),e.codec=t.videoCodec),o.sender}))}createSimulcastTransceiverSender(e,t,n,r){return Rd(this,void 0,void 0,(function*(){if(!this.pcManager)throw new hp("publisher is closed");const i={direction:"sendonly"};r&&(i.sendEncodings=r);const o=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,i);if(n.videoCodec)return this.setPreferredCodec(o,e.kind,n.videoCodec),e.setSimulcastTrackSender(n.videoCodec,o.sender),o.sender}))}createRTCRtpSender(e){return Rd(this,void 0,void 0,(function*(){if(!this.pcManager)throw new hp("publisher is closed");return this.pcManager.addPublisherTrack(e)}))}attemptReconnect(e){var t,n,r;return Rd(this,void 0,void 0,(function*(){if(!this._isClosed&&!this.attemptingReconnect){(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==Ku.DISABLED&&(null!==(r=null===(n=this.pcManager)||void 0===n?void 0:n.currentState)&&void 0!==r?r:$m.NEW)!==$m.NEW||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(i){this.reconnectAttempts+=1;let e=!0;i instanceof hp?(wl.debug("received unrecoverable error",{error:i}),e=!1):i instanceof Qm||(this.fullReconnectOnNext=!0),e?this.handleDisconnect("reconnect",Qu.RR_UNKNOWN):(wl.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(vp.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}}))}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){wl.warn("encountered error in reconnect policy",{error:t})}return null}restartConnection(e){var t,n,r;return Rd(this,void 0,void 0,(function*(){try{if(!this.url||!this.token)throw new hp("could not reconnect, url or token not saved");let n;wl.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(vp.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw wl.warn("attempted connection restart, without signal options present"),new Qm;n=yield this.join(null!==e&&void 0!==e?e:this.url,this.token,this.signalOpts)}catch(i){if(i instanceof cp&&0===i.reason)throw new hp("could not reconnect, token might be expired");throw new Qm}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.client.setReconnected(),this.emit(vp.SignalRestarted,n),yield this.waitForPCReconnected(),null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(vp.Restarted)}catch(o){const e=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(e)return void(yield this.restartConnection(e));throw null===(r=this.regionUrlProvider)||void 0===r||r.resetAttempts(),o}}))}resumeConnection(e){var t;return Rd(this,void 0,void 0,(function*(){if(!this.url||!this.token)throw new hp("could not reconnect, url or token not saved");if(!this.pcManager)throw new hp("publisher and subscriber connections unset");wl.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(vp.Resuming);try{this.setupSignalClientCallbacks();const t=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(t){const e=this.makeRTCConfiguration(t);this.pcManager.updateConfiguration(e)}}catch(n){let e="";if(n instanceof Error&&(e=n.message,wl.error(n.message)),n instanceof cp&&0===n.reason)throw new hp("could not reconnect, token might be expired");throw new Qm(e)}if(this.emit(vp.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),this.emit(vp.Resumed)}))}waitForPCInitialConnection(e,t){return Rd(this,void 0,void 0,(function*(){if(!this.pcManager)throw new hp("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)}))}waitForPCReconnected(){return Rd(this,void 0,void 0,(function*(){this.pcState=Km.Reconnecting,wl.debug("waiting for peer connection to reconnect");try{if(yield Af(2e3),!this.pcManager)throw new hp("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Km.Connected}catch(e){throw this.pcState=Km.Disconnected,new cp("could not establish PC connection, ".concat(e.message))}}))}sendDataPacket(e,t){return Rd(this,void 0,void 0,(function*(){const n=e.toBinary();yield this.ensurePublisherConnected(t);const r=this.dataChannelForKind(t);r&&r.send(n),this.updateAndEmitDCBufferStatus(t)}))}ensureDataTransportConnected(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;var n;return Rd(this,void 0,void 0,(function*(){if(!this.pcManager)throw new hp("PC manager is closed");const r=t?this.pcManager.subscriber:this.pcManager.publisher,i=t?"Subscriber":"Publisher";if(!r)throw new cp("".concat(i," connection not set"));t||this.pcManager.publisher.isICEConnected||"checking"===this.pcManager.publisher.getICEConnectionState()||this.negotiate();const o=this.dataChannelForKind(e,t);if("open"===(null===o||void 0===o?void 0:o.readyState))return;const s=(new Date).getTime()+this.peerConnectionTimeout;for(;(new Date).getTime()<s;){if(r.isICEConnected&&"open"===(null===(n=this.dataChannelForKind(e,t))||void 0===n?void 0:n.readyState))return;yield Af(50)}throw new cp("could not establish ".concat(i," connection, state: ").concat(r.getICEConnectionState()))}))}ensurePublisherConnected(e){return Rd(this,void 0,void 0,(function*(){yield this.ensureDataTransportConnected(e,!1)}))}verifyTransport(){return!!this.pcManager&&(this.pcManager.currentState===$m.CONNECTED&&!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED))}negotiate(){return Rd(this,void 0,void 0,(function*(){return new Promise(((e,t)=>Rd(this,void 0,void 0,(function*(){if(!this.pcManager)return void t(new pp("PC manager is closed"));this.pcManager.requirePublisher();const n=new AbortController,r=()=>{n.abort(),wl.debug("engine disconnected while negotiation was ongoing"),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(vp.Closing,r),this.pcManager.publisher.once(Lm,(e=>{const t=new Map;e.forEach((e=>{const n=e.codec.toLowerCase();var r;r=n,Ip.includes(r)&&t.set(e.payload,n)})),this.emit(vp.RTPVideoMapUpdate,t)}));try{yield this.pcManager.negotiate(n),e()}catch(i){i instanceof pp&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Qu.RR_UNKNOWN),t(i)}finally{this.off(vp.Closing,r)}}))))}))}dataChannelForKind(e,t){if(t){if(e===ad.LOSSY)return this.lossyDCSub;if(e===ad.RELIABLE)return this.reliableDCSub}else{if(e===ad.LOSSY)return this.lossyDC;if(e===ad.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var n,r;if(!this.pcManager)return void wl.warn("sync state cannot be sent without peer connection setup");const i=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),s=null===(r=null===(n=this.signalOpts)||void 0===n?void 0:n.autoSubscribe)||void 0===r||r,a=new Array;e.forEach((e=>{e.isDesired!==s&&a.push(e.trackSid)})),this.client.sendSyncState(new ff({answer:i?bm({sdp:i.sdp,type:i.type}):void 0,offer:o?bm({sdp:o.sdp,type:o.type}):void 0,subscription:new Yp({trackSids:a,subscribe:!s,participantTracks:[]}),publishTracks:Mf(t),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null===t||void 0===t?void 0:t.id)&&null!==t.id&&e.push(new mf({label:t.label,id:t.id,target:n}))};return t(this.dataChannelForKind(ad.LOSSY),Ap.PUBLISHER),t(this.dataChannelForKind(ad.RELIABLE),Ap.PUBLISHER),t(this.dataChannelForKind(ad.LOSSY,!0),Ap.SUBSCRIBER),t(this.dataChannelForKind(ad.RELIABLE,!0),Ap.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Cp.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Wf()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Wf()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Qm extends Error{}class Zm{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return $f(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return Rd(this,void 0,void 0,(function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter((e=>!this.attemptedRegions.find((t=>t.url===e.url))));if(t.length>0){const e=t[0];return this.attemptedRegions.push(e),wl.debug("next region: ".concat(e.region)),e.url}return null}))}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return Rd(this,void 0,void 0,(function*(){const t=yield fetch("".concat(function(e){return"".concat(e.protocol.replace("ws","http"),"//").concat(e.host,"/settings")}(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(t.ok){const e=yield t.json();return this.lastUpdateAt=Date.now(),e}throw new cp("Could not fetch region settings: ".concat(t.statusText),401===t.status?0:void 0,t.status)}))}}const eg=2e3;function tg(e,t){if(!t)return 0;let n,r;return"bytesReceived"in e?(n=e.bytesReceived,r=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,r=t.bytesSent),void 0===n||void 0===r||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-r)*1e3/(e.timestamp-t.timestamp)}class ng extends dm{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;super(e,Tf.Kind.Audio,t,n),this.stopOnMute=!1,this.monitorSender=()=>Rd(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(t){return void wl.error("could not get audio sender stats",{error:t})}e&&this.prevStats&&(this._currentBitrate=tg(e,this.prevStats)),this.prevStats=e})),this.audioContext=r,this.checkForSilence()}setDeviceId(e){return Rd(this,void 0,void 0,(function*(){return this._constraints.deviceId===e||(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||am(e)===this.mediaStreamTrack.getSettings().deviceId)}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Rd(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source===Tf.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(wl.debug("stopping mic track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Rd(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{const t=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==am(this._constraints.deviceId);return this.source!==Tf.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!t||this.isUserProvided||(wl.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}}))}restartTrack(e){return Rd(this,void 0,void 0,(function*(){let t;if(e){const n=If({audio:e});"boolean"!==typeof n.audio&&(t=n.audio)}yield this.restart(t)}))}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return Rd(this,void 0,void 0,(function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n}))}startMonitor(){Wf()&&(this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),eg)))}setProcessor(e){var t;return Rd(this,void 0,void 0,(function*(){const n=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");const n={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};wl.debug("setting up audio processor ".concat(e.name)),yield e.init(n),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack))}finally{n()}}))}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return Rd(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach((e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})})),t}))}checkForSilence(){return Rd(this,void 0,void 0,(function*(){const e=yield function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return Rd(this,void 0,void 0,(function*(){const n=Rf();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(r),yield Af(t),r.getByteTimeDomainData(o);const s=o.some((e=>128!==e&&0!==e));return n.close(),!s}return!1}))}(this);return e&&(this.isMuted||wl.warn("silence detected on local audio track"),this.emit(yp.AudioSilenceDetected)),e}))}}function rg(e,t){switch(e.kind){case"audio":return new ng(e,t,!1);case"video":return new gg(e,t,!1);default:throw new up("unsupported track type: ".concat(e.kind))}}const ig=Object.values(Op),og=Object.values(Mp),sg=Object.values(Np),ag=[Op.h180,Op.h360],cg=[Mp.h180,Mp.h360],lg=e=>[{scaleResolutionDownBy:2,fps:3}].map((t=>{var n;return new _p(Math.floor(e.width/t.scaleResolutionDownBy),Math.floor(e.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(e.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*((null!==(n=e.encoding.maxFramerate)&&void 0!==n?n:30)/t.fps)))),t.fps,e.encoding.priority)})),ug=["q","h","f"];function dg(e,t,n,r){var i,o;let s=null===r||void 0===r?void 0:r.videoEncoding;e&&(s=null===r||void 0===r?void 0:r.screenShareEncoding);const a=null===r||void 0===r?void 0:r.simulcast,c=null===r||void 0===r?void 0:r.scalabilityMode,l=null===r||void 0===r?void 0:r.videoCodec;if(!s&&!a&&!c||!t||!n)return[{}];s||(s=function(e,t,n,r){const i=function(e,t,n){if(e)return sg;const r=t>n?t/n:n/t;if(Math.abs(r-16/9)<Math.abs(r-4/3))return ig;return og}(e,t,n);let{encoding:o}=i[0];const s=Math.max(t,n);for(let a=0;a<i.length;a+=1){const e=i[a];if(o=e.encoding,e.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=.7*o.maxBitrate;break;case"vp9":o=Object.assign({},o),o.maxBitrate=.85*o.maxBitrate}return o}(e,t,n,l),wl.debug("using video encoding",s));const u=new _p(t,n,s.maxBitrate,s.maxFramerate,s.priority);if(c&&Uf(l)){wl.debug("using svc with scalabilityMode ".concat(c));const e=new mg(c),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let n=0;n<e.spatial;n+=1)t.push({rid:ug[2-n],maxBitrate:s.maxBitrate/Math.pow(3,n),maxFramerate:u.encoding.maxFramerate});return t[0].scalabilityMode=c,wl.debug("encodings",t),t}if(!a)return[s];let d,h=[];if(h=e?null!==(i=fg(null===r||void 0===r?void 0:r.screenShareSimulcastLayers))&&void 0!==i?i:hg(e,u):null!==(o=fg(null===r||void 0===r?void 0:r.videoSimulcastLayers))&&void 0!==o?o:hg(e,u),h.length>0){const e=h[0];h.length>1&&([,d]=h);const r=Math.max(t,n);if(r>=960&&d)return pg(t,n,[e,d,u]);if(r>=480)return pg(t,n,[e,u])}return pg(t,n,[u])}function hg(e,t){if(e)return lg(t);const{width:n,height:r}=t,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?ag:cg}function pg(e,t,n){const r=[];if(n.forEach(((n,i)=>{if(i>=ug.length)return;const o=Math.min(e,t),s={rid:ug[i],scaleResolutionDownBy:Math.max(1,o/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate};n.encoding.maxFramerate&&(s.maxFramerate=n.encoding.maxFramerate);const a=jf()||0===i;n.encoding.priority&&a&&(s.priority=n.encoding.priority,s.networkPriority=n.encoding.priority),r.push(s)})),qf()&&"ios"===Jf()){let e;r.forEach((t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate}));let t=!0;r.forEach((n=>{var r;n.maxFramerate!=e&&(t&&(t=!1,wl.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),wl.info('Setting framerate of encoding "'.concat(null!==(r=n.rid)&&void 0!==r?r:"",'" to ').concat(e)),n.maxFramerate=e)}))}return r}function fg(e){if(e)return e.sort(((e,t)=>{const{encoding:n}=e,{encoding:r}=t;return n.maxBitrate>r.maxBitrate?1:n.maxBitrate<r.maxBitrate?-1:n.maxBitrate===r.maxBitrate&&n.maxFramerate&&r.maxFramerate?n.maxFramerate>r.maxFramerate?1:-1:0}))}class mg{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class gg extends dm{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,Tf.Kind.Video,t,n),this.simulcastCodecs=new Map,this.monitorSender=()=>Rd(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(n){return void wl.error("could not get audio sender stats",{error:n})}const t=new Map(e.map((e=>[e.rid,e])));if(this.prevStats){let e=0;t.forEach(((t,n)=>{var r;const i=null===(r=this.prevStats)||void 0===r?void 0:r.get(n);e+=tg(t,i)})),this._currentBitrate=e}this.prevStats=t})),this.senderLock=new sm}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!Wf())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),eg))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach((e=>{e.mediaStreamTrack.stop()})),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var t,n,r,i,o;return Rd(this,void 0,void 0,(function*(){yield e.pauseUpstream.call(this);try{for(var s,a=!0,c=Od(this.simulcastCodecs.values());s=yield c.next(),!(t=s.done);a=!0){i=s.value,a=!1;const e=i;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(null)}}catch(l){n={error:l}}finally{try{a||t||!(r=c.return)||(yield r.call(c))}finally{if(n)throw n.error}}}))}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var t,n,r,i,o;return Rd(this,void 0,void 0,(function*(){yield e.resumeUpstream.call(this);try{for(var s,a=!0,c=Od(this.simulcastCodecs.values());s=yield c.next(),!(t=s.done);a=!0){i=s.value,a=!1;const e=i;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(e.mediaStreamTrack)}}catch(l){n={error:l}}finally{try{a||t||!(r=c.return)||(yield r.call(c))}finally{if(n)throw n.error}}}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Rd(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source!==Tf.Source.Camera||this.isUserProvided||(wl.debug("stopping camera track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Rd(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source!==Tf.Source.Camera||this.isUserProvided||(wl.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}}))}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return Rd(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach((e=>{var r;if("outbound-rtp"===e.type){const i={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,framesSent:e.framesSent,timestamp:e.timestamp,rid:null!==(r=e.rid)&&void 0!==r?r:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges},o=n.get(e.remoteId);o&&(i.jitter=o.jitter,i.packetsLost=o.packetsLost,i.roundTripTime=o.roundTripTime),t.push(i)}})),t}))}setPublishingQuality(e){const t=[];for(let n=Gu.LOW;n<=Gu.HIGH;n+=1)t.push(new cf({quality:n,enabled:n<=e}));wl.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(t)}setDeviceId(e){return Rd(this,void 0,void 0,(function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===am(e)||(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||am(e)===this._mediaStreamTrack.getSettings().deviceId)}))}restartTrack(e){var t,n,r,i;return Rd(this,void 0,void 0,(function*(){let o;if(e){const t=If({video:e});"boolean"!==typeof t.video&&(o=t.video)}yield this.restart(o);try{for(var s,a=!0,c=Od(this.simulcastCodecs.values());s=yield c.next(),!(t=s.done);a=!0){i=s.value,a=!1;const e=i;e.sender&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(l){n={error:l}}finally{try{a||t||!(r=c.return)||(yield r.call(c))}finally{if(n)throw n.error}}}))}setProcessor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var r,i,o,s,a,c;return Rd(this,void 0,void 0,(function*(){if(yield n.setProcessor.call(this,e,t),null===(a=this.processor)||void 0===a?void 0:a.processedTrack)try{for(var l,u=!0,d=Od(this.simulcastCodecs.values());l=yield d.next(),!(r=l.done);u=!0){s=l.value,u=!1;const e=s;yield null===(c=e.sender)||void 0===c?void 0:c.replaceTrack(this.processor.processedTrack)}}catch(h){i={error:h}}finally{try{u||r||!(o=d.return)||(yield o.call(d))}finally{if(i)throw i.error}}}))}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout((()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)}),5e3))}setPublishingCodecs(e){var t,n,r,i,o,s,a;return Rd(this,void 0,void 0,(function*(){if(wl.debug("setting publishing codecs",{codecs:e,currentCodec:this.codec}),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=Od(e);r=yield n.next(),!(i=r.done);t=!0){a=r.value,t=!1;const e=a;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(wl.debug("try setPublishingCodec for ".concat(e.codec),t),t&&t.sender)t.encodings&&(wl.debug("try setPublishingLayersForSender ".concat(e.codec)),yield vg(t.sender,t.encodings,e.qualities,this.senderLock));else for(const n of e.qualities)if(n.enabled){c.push(e.codec);break}}else yield this.setPublishingLayers(e.qualities)}}catch(l){o={error:l}}finally{try{t||i||!(s=n.return)||(yield s.call(n))}finally{if(o)throw o.error}}return c}))}setPublishingLayers(e){return Rd(this,void 0,void 0,(function*(){wl.debug("setting publishing layers",e),this.sender&&this.encodings&&(yield vg(this.sender,this.encodings,e,this.senderLock))}))}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Rd(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),Vf()&&this.isInBackground&&this.source===Tf.Source.Camera&&(this._mediaStreamTrack.enabled=!1)}))}}function vg(e,t,n,r){return Rd(this,void 0,void 0,(function*(){const i=yield r.lock();wl.debug("setPublishingLayersForSender",{sender:e,qualities:n,senderEncodings:t});try{const r=e.getParameters(),{encodings:i}=r;if(!i)return;if(i.length!==t.length)return void wl.warn("cannot set publishing layers, encodings mismatch");let o=!1;!1&&i[0].scalabilityMode||i.forEach(((e,r)=>{var i;let s=null!==(i=e.rid)&&void 0!==i?i:"";""===s&&(s="q");const a=yg(s),c=n.find((e=>e.quality===a));c&&e.active!==c.enabled&&(o=!0,e.active=c.enabled,wl.debug("setting layer ".concat(c.quality," to ").concat(e.active?"enabled":"disabled")),jf()&&(c.enabled?(e.scaleResolutionDownBy=t[r].scaleResolutionDownBy,e.maxBitrate=t[r].maxBitrate,e.maxFrameRate=t[r].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))})),o&&(r.encodings=i,wl.debug("setting encodings",r.encodings),yield e.setParameters(r))}finally{i()}}))}function yg(e){switch(e){case"f":default:return Gu.HIGH;case"h":return Gu.MEDIUM;case"q":return Gu.LOW}}function bg(e,t,n,r){if(!n)return[new pd({quality:Gu.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(r){const r=n[0].scalabilityMode,i=new mg(r),o=[];for(let s=0;s<i.spatial;s+=1)o.push(new pd({quality:Gu.HIGH-s,width:Math.ceil(e/Math.pow(2,s)),height:Math.ceil(t/Math.pow(2,s)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,s)):0,ssrc:0}));return o}return n.map((n=>{var r,i,o;const s=null!==(r=n.scaleResolutionDownBy)&&void 0!==r?r:1;let a=yg(null!==(i=n.rid)&&void 0!==i?i:"");return new pd({quality:a,width:Math.ceil(e/s),height:Math.ceil(t/s),bitrate:null!==(o=n.maxBitrate)&&void 0!==o?o:0,ssrc:0})}))}class wg extends Tf{constructor(e,t,n,r){super(e,n),this.sid=t,this.receiver=r}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?yp.Muted:yp.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=n=>{n.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver=void 0,this._currentBitrate=0,this.emit(yp.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return Rd(this,void 0,void 0,(function*(){if(!(null===(e=this.receiver)||void 0===e?void 0:e.getStats))return;return yield this.receiver.getStats()}))}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval((()=>this.monitorReceiver()),eg))}}class kg extends wg{constructor(e,t,n,r,i){super(e,t,Tf.Kind.Audio,n),this.monitorReceiver=()=>Rd(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=tg(e,this.prevStats)),this.prevStats=e})),this.audioContext=r,this.webAudioPluginNodes=[],i&&(this.sinkId=i.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;qf()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(qf())return 1;let e=0;return this.attachedElements.forEach((t=>{t.volume>e&&(e=t.volume)})),e}setSinkId(e){return Rd(this,void 0,void 0,(function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map((t=>{if(Ff(t))return t.setSinkId(e)})))}))}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.sinkId&&Ff(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&(wl.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach((e=>{n.connect(e),n=e})),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then((()=>{"running"!==e.state&&this.emit(yp.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))})).catch((e=>{this.emit(yp.AudioPlaybackFailed,e)}))}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return Rd(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"audio",timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})})),e}))}}class Sg extends wg{constructor(e,t,n,r){super(e,t,Tf.Kind.Video,n),this.elementInfos=[],this.monitorReceiver=()=>Rd(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=tg(e,this.prevStats)),this.prevStats=e})),this.debouncedHandleResize=bp((()=>{this.updateDimensions()}),100),this.adaptiveStreamSettings=r}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach((t=>{e?Cf(this._mediaStreamTrack,t):Ef(this._mediaStreamTrack,t)}))}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t.element===e))){const t=new Tg(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t===e))?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):wl.warn("visibility resize observer not triggered")}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void wl.warn("stopObservingElementInfo ignored");const t=this.elementInfos.filter((t=>t===e));for(const n of t)n.stopObserving();this.elementInfos=this.elementInfos.filter((t=>t!==e)),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const n of t)this.stopObservingElement(n);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return Rd(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"video",framesDecoded:t.framesDecoded,framesDropped:t.framesDropped,framesReceived:t.framesReceived,packetsReceived:t.packetsReceived,packetsLost:t.packetsLost,frameWidth:t.frameWidth,frameHeight:t.frameHeight,pliCount:t.pliCount,firCount:t.firCount,nackCount:t.nackCount,jitter:t.jitter,timestamp:t.timestamp,bytesReceived:t.bytesReceived,decoderImplementation:t.decoderImplementation})})),e}))}stopObservingElement(e){const t=this.elementInfos.filter((t=>t.element===e));for(const n of t)this.stopObservingElementInfo(n)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Rd(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()}))}updateVisibility(){var e,t;const n=this.elementInfos.reduce(((e,t)=>Math.max(e,t.visibilityChangedAt||0)),0),r=!(null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pauseVideoInBackground)&&void 0!==t&&!t)&&this.isInBackground,i=this.elementInfos.some((e=>e.pictureInPicture)),o=this.elementInfos.some((e=>e.visible))&&!r||i;this.lastVisible!==o&&(!o&&Date.now()-n<100?Cp.setTimeout((()=>{this.updateVisibility()}),100):(this.lastVisible=o,this.emit(yp.VisibilityChanged,o,this)))}updateDimensions(){var e,t;let n=0,r=0;const i=this.getPixelDensity();for(const o of this.elementInfos){const e=o.width()*i,t=o.height()*i;e+t>n+r&&(n=e,r=t)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===r||(this.lastDimensions={width:n,height:r},this.emit(yp.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;if("screen"===t)return Gf();if(!t){return Gf()>2?2:1}return t}}class Tg{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:r}=e;n===this.element&&(this.isIntersecting=r,this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e;this.isPiP=!0,null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=!1,null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!==t&&void 0!==t?t:Eg(e),this.isPiP=Wf()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=Eg(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,tm().observe(this.element),Zf().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,t;null===(e=tm())||void 0===e||e.unobserve(this.element),null===(t=Zf())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function Eg(e){let t=e.offsetTop,n=e.offsetLeft;const r=e.offsetWidth,i=e.offsetHeight,{hidden:o}=e,{opacity:s,display:a}=getComputedStyle(e);for(;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(""===s||parseFloat(s)>0)&&"none"!==a}class Cg extends Gd.EventEmitter{constructor(e,t,n){super(),this.metadataMuted=!1,this.encryption=sd.NONE,this.handleMuted=()=>{this.emit(yp.Muted)},this.handleUnmuted=()=>{this.emit(yp.Unmuted)},this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=Tf.Source.Unknown}setTrack(e){this.track&&(this.track.off(yp.Muted,this.handleMuted),this.track.off(yp.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(yp.Muted,this.handleMuted),e.on(yp.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==sd.NONE}get audioTrack(){if(this.track instanceof ng||this.track instanceof kg)return this.track}get videoTrack(){if(this.track instanceof gg||this.track instanceof Sg)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Tf.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Tf.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,wl.debug("update publication info",{info:e})}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(Cg||(Cg={}));class _g extends Cg{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n){super(e,t.sid,t.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(yp.Ended)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&this.track.off(yp.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(yp.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return Rd(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.mute()}))}unmute(){var e;return Rd(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.unmute()}))}pauseUpstream(){var e;return Rd(this,void 0,void 0,(function*(){yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()}))}resumeUpstream(){var e;return Rd(this,void 0,void 0,(function*(){yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()}))}}var xg,Ig;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"}(xg||(xg={}));class Rg extends Gd.EventEmitter{get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every((e=>e.isEncrypted))}get isAgent(){var e,t;return null!==(t=null===(e=this.permissions)||void 0===e?void 0:e.agent)&&void 0!==t&&t}constructor(e,t,n,r){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=xg.Unknown,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=r,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,t]of this.tracks)if(t.source===e)return t}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(Tf.Source.Camera);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(Tf.Source.Microphone);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrack(Tf.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version)&&(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,wl.trace("update participant info",{info:e}),!0)}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(gp.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(gp.ParticipantNameChanged,e)}setPermissions(e){var t,n,r,i,o;const s=this.permissions,a=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(r=this.permissions)||void 0===r?void 0:r.canPublishData)||e.hidden!==(null===(i=this.permissions)||void 0===i?void 0:i.hidden)||e.recorder!==(null===(o=this.permissions)||void 0===o?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some(((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])}));return this.permissions=e,a&&this.emit(gp.ParticipantPermissionsChanged,s),a}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(gp.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case Yu.EXCELLENT:return xg.Excellent;case Yu.GOOD:return xg.Good;case Yu.POOR:return xg.Poor;case Yu.LOST:return xg.Lost;default:return xg.Unknown}}(e),t!==this._connectionQuality&&this.emit(gp.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach((t=>(t.track instanceof kg||t.track instanceof ng)&&t.track.setAudioContext(e)))}addTrackPublication(e){e.on(yp.Muted,(()=>{this.emit(gp.TrackMuted,e)})),e.on(yp.Unmuted,(()=>{this.emit(gp.TrackUnmuted,e)}));const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Tf.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Tf.Kind.Video:this.videoTracks.set(e.trackSid,e)}}}class Pg extends Cg{constructor(e,t,n){super(e,t.sid,t.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Gu.HIGH,this.handleEnded=e=>{this.setTrack(void 0),this.emit(yp.Ended,e)},this.handleVisibilityChange=e=>{wl.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),{trackSid:this.trackSid}),this.disabled=!e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{wl.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),{trackSid:this.trackSid}),this.videoDimensions=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const r=new Yp({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new yd({participantSid:"",trackSids:[this.trackSid]})]});this.emit(yp.UpdateSubscription,r),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?Cg.SubscriptionStatus.Unsubscribed:super.isSubscribed?Cg.SubscriptionStatus.Subscribed:Cg.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Cg.PermissionStatus.Allowed:Cg.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return!this.disabled}setEnabled(e){this.isManualOperationAllowed()&&this.disabled!==!e&&(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.currentVideoQuality!==e&&(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.videoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.videoDimensions)||void 0===n?void 0:n.height)===e.height||(this.track instanceof Sg&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Sg&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,r=this.track;r!==e&&(r&&(r.off(yp.VideoDimensionsChanged,this.handleVideoDimensionsChange),r.off(yp.VisibilityChanged,this.handleVisibilityChange),r.off(yp.Ended,this.handleEnded),r.detach(),r.stopMonitor(),this.emit(yp.Unsubscribed,r)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(yp.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(yp.VisibilityChanged,this.handleVisibilityChange),e.on(yp.Ended,this.handleEnded),this.emit(yp.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(yp.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?yp.Muted:yp.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(yp.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(yp.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Tf.Kind.Video&&this.isAdaptiveStream?(wl.warn("adaptive stream is enabled, cannot change video track settings",{trackSid:this.trackSid}),!1):!!this.isDesired||(wl.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof Sg&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Kp({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):void 0!==this.currentVideoQuality?e.quality=this.currentVideoQuality:e.quality=Gu.HIGH,this.emit(yp.UpdateSettings,e)}}class Og extends Rg{static fromParticipantInfo(e,t){return new Og(e,t.sid,t.identity,t.name,t.metadata)}constructor(e,t,n,r,i){super(t,n||"",r,i),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(yp.UpdateSettings,(e=>{wl.debug("send update settings",e),this.signalClient.sendUpdateTrackSettings(e)})),e.on(yp.UpdateSubscription,(e=>{e.participantTracks.forEach((e=>{e.participantSid=this.sid})),this.signalClient.sendUpdateSubscription(e)})),e.on(yp.SubscriptionPermissionChanged,(t=>{this.emit(gp.TrackSubscriptionPermissionChanged,e,t)})),e.on(yp.SubscriptionStatusChanged,(t=>{this.emit(gp.TrackSubscriptionStatusChanged,e,t)})),e.on(yp.Subscribed,(t=>{this.emit(gp.TrackSubscribed,t,e)})),e.on(yp.Unsubscribed,(t=>{this.emit(gp.TrackUnsubscribed,t,e)})),e.on(yp.SubscriptionFailed,(t=>{this.emit(gp.TrackSubscriptionFailed,e.trackSid,t)}))}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tf.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrack(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tf.Source.Microphone;const t=this.getTrack(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,r,i,o){let s=this.getTrackPublication(t);if(s||t.startsWith("TR")||this.tracks.forEach((t=>{s||e.kind!==t.kind.toString()||(s=t)})),!s)return 0===o?(wl.error("could not find published track",{participant:this.sid,trackSid:t}),void this.emit(gp.TrackSubscriptionFailed,t)):(void 0===o&&(o=20),void setTimeout((()=>{this.addSubscribedMediaTrack(e,t,n,r,i,o-1)}),150));if("ended"===e.readyState)return wl.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:t}),void this.emit(gp.TrackSubscriptionFailed,t);let a;return a="video"===e.kind?new Sg(e,t,r,i):new kg(e,t,r,this.audioContext,this.audioOutput),a.source=s.source,a.isMuted=s.isMuted,a.setMediaStream(n),a.start(),s.setTrack(a),this.volumeMap.has(s.source)&&a instanceof kg&&a.setVolume(this.volumeMap.get(s.source)),s}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach((r=>{var i;let o=this.getTrackPublication(r.sid);if(o)o.updateInfo(r);else{const t=Tf.kindFromProto(r.type);if(!t)return;o=new Pg(t,r,null===(i=this.signalClient.connectOptions)||void 0===i?void 0:i.autoSubscribe),o.updateInfo(r),n.set(r.sid,o);const s=Array.from(this.tracks.values()).find((e=>e.source===(null===o||void 0===o?void 0:o.source)));s&&o.source!==Tf.Source.Unknown&&wl.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),{oldTrack:s,newTrack:o,participant:this,participantInfo:e}),this.addTrackPublication(o)}t.set(r.sid,o)})),this.tracks.forEach((e=>{t.has(e.trackSid)||(wl.trace("detected removed track on remote participant, unpublishing",{publication:e,participantSid:this.sid}),this.unpublishTrack(e.trackSid,!0))})),n.forEach((e=>{this.emit(gp.TrackPublished,e)})),!0}unpublishTrack(e,t){const n=this.tracks.get(e);if(!n)return;const{track:r}=n;switch(r&&(r.stop(),n.setTrack(void 0)),this.tracks.delete(e),n.kind){case Tf.Kind.Audio:this.audioTracks.delete(e);break;case Tf.Kind.Video:this.videoTracks.delete(e)}t&&this.emit(gp.TrackUnpublished,n)}setAudioOutput(e){return Rd(this,void 0,void 0,(function*(){this.audioOutput=e;const t=[];this.audioTracks.forEach((n=>{var r;n.track instanceof kg&&t.push(n.track.setSinkId(null!==(r=e.deviceId)&&void 0!==r?r:"default"))})),yield Promise.all(t)}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wl.trace("participant event",{participant:this.sid,event:e,args:n}),super.emit(e,...n)}}class Mg extends Rg{constructor(e,t,n,r){super(e,t),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=sd.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new om)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var e,t;this.reconnectFuture&&(this.reconnectFuture.promise.catch((e=>wl.warn(e))),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{wl.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map((e=>function(e){var t,n,r;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new df({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(r=e.allowAll)&&void 0!==r&&r,trackSids:e.allowedTrackSids||[]})}(e))))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):wl.error("could not update mute status for unpublished track",e)},this.onTrackUpstreamPaused=e=>{wl.debug("upstream paused"),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{wl.debug("upstream resumed"),this.onTrackMuted(e,e.isMuted)},this.handleSubscribedQualityUpdate=e=>Rd(this,void 0,void 0,(function*(){var t,n,r,i,o,s;if(!(null===(o=this.roomOptions)||void 0===o?void 0:o.dynacast))return;const a=this.videoTracks.get(e.trackSid);if(a)if(e.subscribedCodecs.length>0){if(!a.videoTrack)return;const o=yield a.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var c,l=!0,u=Od(o);!(t=(c=yield u.next()).done);l=!0){i=c.value,l=!1;const e=i;Rp(e)&&(wl.debug("publish ".concat(e," for ").concat(a.videoTrack.sid)),yield this.publishAdditionalCodecForTrack(a.videoTrack,e,a.options))}}catch(d){n={error:d}}finally{try{l||t||!(r=u.return)||(yield r.call(u))}finally{if(n)throw n.error}}}else e.subscribedQualities.length>0&&(yield null===(s=a.videoTrack)||void 0===s?void 0:s.setPublishingLayers(e.subscribedQualities));else wl.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:e.trackSid})})),this.handleLocalTrackUnpublished=e=>{const t=this.tracks.get(e.trackSid);t?this.unpublishTrack(t.track):wl.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:e.trackSid})},this.handleTrackEnded=e=>Rd(this,void 0,void 0,(function*(){if(e.source===Tf.Source.ScreenShare||e.source===Tf.Source.ScreenShareAudio)wl.debug("unpublishing local track due to TrackEnded",{track:e.sid}),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(e instanceof ng||e instanceof gg)try{if(Wf())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===Tf.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw wl.warn("user has revoked access to ".concat(e.source)),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(t){}e.isMuted||(wl.debug("track ended, attempting to use a different device"),yield e.restartTrack())}catch(t){wl.warn("could not restart track, muting instead"),yield e.mute()}})),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=n,this.roomOptions=r,this.setupEngine(n),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==sd.NONE}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.client.onRemoteMuteChanged=(e,t)=>{const n=this.tracks.get(e);n&&n.track&&(t?n.mute():n.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate,this.engine.client.onLocalTrackUnpublished=this.handleLocalTrackUnpublished,this.engine.on(vp.Connected,this.handleReconnected).on(vp.SignalRestarted,this.handleReconnected).on(vp.SignalResumed,this.handleReconnected).on(vp.Restarting,this.handleReconnecting).on(vp.Resuming,this.handleReconnecting).on(vp.Disconnected,this.handleDisconnected)}setMetadata(e){var t;this.engine.client.sendUpdateLocalMetadata(e,null!==(t=this.name)&&void 0!==t?t:"")}setName(e){var t;this.engine.client.sendUpdateLocalMetadata(null!==(t=this.metadata)&&void 0!==t?t:"",e)}setCameraEnabled(e,t,n){return this.setTrackEnabled(Tf.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(Tf.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(Tf.Source.ScreenShare,e,t,n)}setPermissions(e){const t=this.permissions,n=super.setPermissions(e);return n&&t&&this.emit(gp.ParticipantPermissionsChanged,t),n}setE2EEEnabled(e){return Rd(this,void 0,void 0,(function*(){this.encryptionType=e?sd.GCM:sd.NONE,yield this.republishAllTracks(void 0,!1)}))}setTrackEnabled(e,t,n,r){var i,o;return Rd(this,void 0,void 0,(function*(){wl.debug("setTrackEnabled",{source:e,enabled:t});let s=this.getTrack(e);if(t)if(s)yield s.unmute();else{let t;if(this.pendingPublishing.has(e))return void wl.info("skipping duplicate published source",{source:e});this.pendingPublishing.add(e);try{switch(e){case Tf.Source.Camera:t=yield this.createTracks({video:null===(i=n)||void 0===i||i});break;case Tf.Source.Microphone:t=yield this.createTracks({audio:null===(o=n)||void 0===o||o});break;case Tf.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new up(e)}const a=[];for(const e of t)wl.info("publishing track",{localTrack:e}),a.push(this.publishTrack(e,r));const c=yield Promise.all(a);[s]=c}catch(a){throw null===t||void 0===t||t.forEach((e=>{e.stop()})),a instanceof Error&&!(a instanceof up)&&this.emit(gp.MediaDevicesError,a),a}finally{this.pendingPublishing.delete(e)}}else if(s&&s.track)if(e===Tf.Source.ScreenShare){s=yield this.unpublishTrack(s.track);const e=this.getTrack(Tf.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield s.mute();return s}))}enableCameraAndMicrophone(){return Rd(this,void 0,void 0,(function*(){if(!this.pendingPublishing.has(Tf.Source.Camera)&&!this.pendingPublishing.has(Tf.Source.Microphone)){this.pendingPublishing.add(Tf.Source.Camera),this.pendingPublishing.add(Tf.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map((e=>this.publishTrack(e))))}finally{this.pendingPublishing.delete(Tf.Source.Camera),this.pendingPublishing.delete(Tf.Source.Microphone)}}}))}createTracks(e){var t,n;return Rd(this,void 0,void 0,(function*(){const r=If(_f(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults));let i;try{i=yield navigator.mediaDevices.getUserMedia(r)}catch(o){throw o instanceof Error&&(r.audio&&(this.microphoneError=o),r.video&&(this.cameraError=o)),o}return r.audio&&(this.microphoneError=void 0,this.emit(gp.AudioStreamAcquired)),r.video&&(this.cameraError=void 0),i.getTracks().map((t=>{const n="audio"===t.kind;let o;n?e.audio:e.video;const s=n?r.audio:r.video;"boolean"!==typeof s&&(o=s);const a=rg(t,o);return a.kind===Tf.Kind.Video?a.source=Tf.Source.Camera:a.kind===Tf.Kind.Audio&&(a.source=Tf.Source.Microphone),a.mediaStream=i,a}))}))}createScreenTracks(e){return Rd(this,void 0,void 0,(function*(){if(void 0===e&&(e={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new lp("getDisplayMedia not supported");const t=Pf(e),n=yield navigator.mediaDevices.getDisplayMedia(t),r=n.getVideoTracks();if(0===r.length)throw new up("no video track found");const i=new gg(r[0],void 0,!1);i.source=Tf.Source.ScreenShare;const o=[i];if(n.getAudioTracks().length>0){this.emit(gp.AudioStreamAcquired);const e=new ng(n.getAudioTracks()[0],void 0,!1,this.audioContext);e.source=Tf.Source.ScreenShareAudio,o.push(e)}return o}))}publishTrack(e,t){var n,r,i,o;return Rd(this,void 0,void 0,(function*(){let s,a;if(yield null===(n=this.reconnectFuture)||void 0===n?void 0:n.promise,e instanceof dm&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)s=e.getConstraints();else{let t;switch(s=e.constraints,e.source){case Tf.Source.Microphone:t="audioinput";break;case Tf.Source.Camera:t="videoinput"}t&&this.activeDeviceMap.has(t)&&(s=Object.assign(Object.assign({},s),{deviceId:this.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new ng(e,s,!0,this.audioContext);break;case"video":e=new gg(e,s,!0);break;default:throw new up("unsupported MediaStreamTrack kind ".concat(e.kind))}if(e instanceof ng&&e.setAudioContext(this.audioContext),this.tracks.forEach((t=>{t.track&&t.track===e&&(a=t)})),a)return wl.warn("track has already been published, skipping"),a;const c="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,l=null!==(r=null===t||void 0===t?void 0:t.forceStereo)&&void 0!==r?r:c;l&&(t||(t={}),void 0===t.dtx&&wl.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),void 0===t.red&&wl.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(i=t.dtx)&&void 0!==i||(t.dtx=!1),null!==(o=t.red)&&void 0!==o||(t.red=!1));const u=Object.assign(Object.assign({},this.roomOptions.publishDefaults),t);zf()&&this.roomOptions.e2ee&&(wl.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari"),u.simulcast=!1),u.source&&(e.source=u.source);const d=this.publish(e,u,l);this.pendingPublishPromises.set(e,d);try{return yield d}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}}))}publish(e,t,n){var r,i,o,s,a,c,l,u,d,h,p,f,m;return Rd(this,void 0,void 0,(function*(){Array.from(this.tracks.values()).find((t=>e instanceof dm&&t.source===e.source))&&e.source!==Tf.Source.Unknown&&wl.info("publishing a second track with the same source: ".concat(e.source)),t.stopMicTrackOnMute&&e instanceof ng&&(e.stopOnMute=!0),e.source===Tf.Source.ScreenShare&&jf()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(zf())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/AV1"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(jf())return!1;if(zf()){const e=Sp();if((null===e||void 0===e?void 0:e.version)&&Yf(e.version,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/VP9"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),void 0===t.videoCodec&&(t.videoCodec=Bm);const g=t.videoCodec;e.on(yp.Muted,this.onTrackMuted),e.on(yp.Unmuted,this.onTrackUnmuted),e.on(yp.Ended,this.handleTrackEnded),e.on(yp.UpstreamPaused,this.onTrackUpstreamPaused),e.on(yp.UpstreamResumed,this.onTrackUpstreamResumed);const v=new jp({cid:e.mediaStreamTrack.id,name:t.name,type:Tf.kindToProto(e.kind),muted:e.isMuted,source:Tf.sourceToProto(e.source),disableDtx:!(null===(r=t.dtx)||void 0===r||r),encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(i=t.red)||void 0===i||i),stream:null===t||void 0===t?void 0:t.stream});let y;if(e.kind===Tf.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(S){const e=null!==(s=null===(o=this.roomOptions.videoCaptureDefaults)||void 0===o?void 0:o.resolution)&&void 0!==s?s:Op.h720.resolution;n={width:e.width,height:e.height},wl.error("could not determine track dimensions, using defaults",n)}v.width=n.width,v.height=n.height,e instanceof gg&&(Uf(g)&&(e.source===Tf.Source.ScreenShare&&"vp9"===g&&(t.scalabilityMode="L1T3"),t.scalabilityMode=null!==(a=t.scalabilityMode)&&void 0!==a?a:"L3T3_KEY"),v.simulcastCodecs=[new Bp({codec:g,cid:e.mediaStreamTrack.id})],!0===t.backupCodec&&(t.backupCodec={codec:Bm}),t.backupCodec&&g!==t.backupCodec.codec&&v.encryption===sd.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),v.simulcastCodecs.push(new Bp({codec:t.backupCodec.codec,cid:""})))),y=dg(e.source===Tf.Source.ScreenShare,v.width,v.height,t),v.layers=bg(v.width,v.height,y,Uf(t.videoCodec))}else e.kind===Tf.Kind.Audio&&(y=[{maxBitrate:null!==(l=null===(c=t.audioPreset)||void 0===c?void 0:c.maxBitrate)&&void 0!==l?l:t.audioBitrate,priority:null!==(d=null===(u=t.audioPreset)||void 0===u?void 0:u.priority)&&void 0!==d?d:"high",networkPriority:null!==(p=null===(h=t.audioPreset)||void 0===h?void 0:h.priority)&&void 0!==p?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new hp("cannot publish track when not connected");const b=yield this.engine.addTrack(v);let w;if(b.codecs.forEach((e=>{void 0===w&&(w=e.mimeType)})),w&&e.kind===Tf.Kind.Video){const n=Of(w);n!==g&&(wl.debug("falling back to server selected codec",{codec:n}),t.videoCodec=n,y=dg(e.source===Tf.Source.ScreenShare,v.width,v.height,t))}const k=new _g(e.kind,b,e);if(k.options=t,e.sid=b.sid,!this.engine.pcManager)throw new hp("pcManager is not ready");if(wl.debug("publishing ".concat(e.kind," with encodings"),{encodings:y,trackInfo:b}),e.sender=yield this.engine.createSender(e,t,y),y)if(jf()&&e.kind===Tf.Kind.Audio){let t;for(const n of this.engine.pcManager.publisher.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(f=y[0])||void 0===f?void 0:f.maxBitrate)?y[0].maxBitrate/1e3:0})}else e.codec&&Uf(e.codec)&&(null===(m=y[0])||void 0===m?void 0:m.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:v.cid,codec:e.codec,maxbr:y[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof gg?e.startMonitor(this.engine.client):e instanceof ng&&e.startMonitor(),this.addTrackPublication(k),this.emit(gp.LocalTrackPublished,k),k}))}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){var r;return Rd(this,void 0,void 0,(function*(){if(this.encryptionType!==sd.NONE)return;let i;if(this.tracks.forEach((t=>{t.track&&t.track===e&&(i=t)})),!i)throw new up("track is not published");if(!(e instanceof gg))throw new up("track is not a video track");const o=Object.assign(Object.assign({},null===(r=this.roomOptions)||void 0===r?void 0:r.publishDefaults),n),s=function(e,t,n){var r,i,o,s;if(!n.backupCodec||!0===n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&wl.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const a=e.mediaStreamTrack.getSettings(),c=null!==(r=a.width)&&void 0!==r?r:null===(i=e.dimensions)||void 0===i?void 0:i.width,l=null!==(o=a.height)&&void 0!==o?o:null===(s=e.dimensions)||void 0===s?void 0:s.height;return dg(e.source===Tf.Source.ScreenShare,c,l,n)}(e,t,o);if(!s)return void wl.info("backup codec has been disabled, ignoring request to add additional codec for track");const a=e.addSimulcastTrack(t,s),c=new jp({cid:a.mediaStreamTrack.id,type:Tf.kindToProto(e.kind),muted:e.isMuted,source:Tf.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:a.mediaStreamTrack.id}]});if(c.layers=bg(c.width,c.height,s),!this.engine||this.engine.isClosed)throw new hp("cannot publish track when not connected");const l=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,a,o,s),yield this.engine.negotiate(),wl.debug("published ".concat(t," for track ").concat(e.sid),{encodings:s,trackInfo:l})}))}unpublishTrack(e,t){var n,r;return Rd(this,void 0,void 0,(function*(){const i=this.getPublicationForTrack(e);if(wl.debug("unpublishing track",{track:e,method:"unpublishTrack"}),!i||!i.track)return void wl.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"});(e=i.track).off(yp.Muted,this.onTrackMuted),e.off(yp.Unmuted,this.onTrackUnmuted),e.off(yp.Ended,this.handleTrackEnded),e.off(yp.UpstreamPaused,this.onTrackUpstreamPaused),e.off(yp.UpstreamResumed,this.onTrackUpstreamResumed),void 0===t&&(t=null===(r=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===r||r),t&&e.stop();let o=!1;const s=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<$m.FAILED&&s)try{for(const e of this.engine.pcManager.publisher.getTransceivers())e.sender===s&&(e.direction="inactive",o=!0);if(this.engine.removeTrack(s)&&(o=!0),e instanceof gg){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(o=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(a){wl.warn("failed to unpublish track",{error:a,method:"unpublishTrack"})}switch(this.tracks.delete(i.trackSid),i.kind){case Tf.Kind.Audio:this.audioTracks.delete(i.trackSid);break;case Tf.Kind.Video:this.videoTracks.delete(i.trackSid)}return this.emit(gp.LocalTrackUnpublished,i),i.setTrack(void 0),o&&(yield this.engine.negotiate()),i}))}unpublishTracks(e){return Rd(this,void 0,void 0,(function*(){return(yield Promise.all(e.map((e=>this.unpublishTrack(e))))).filter((e=>e instanceof _g))}))}republishAllTracks(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Rd(this,void 0,void 0,(function*(){const n=[];this.tracks.forEach((t=>{t.track&&(e&&(t.options=Object.assign(Object.assign({},t.options),e)),n.push(t))})),yield Promise.all(n.map((e=>Rd(this,void 0,void 0,(function*(){const n=e.track;yield this.unpublishTrack(n,!1),t&&!n.isMuted&&(n instanceof ng||n instanceof gg)&&!n.isUserProvided&&(wl.debug("restarting existing track",{track:e.trackSid}),yield n.restartTrack()),yield this.publishTrack(n,e.options)})))))}))}publishData(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Rd(this,void 0,void 0,(function*(){const r=Array.isArray(n)?n:null===n||void 0===n?void 0:n.destination,i=[],o=Array.isArray(n)?void 0:n.topic;void 0!==r&&r.forEach((e=>{e instanceof Og?i.push(e.sid):i.push(e)}));const s=new fd({kind:t,value:{case:"user",value:new vd({participantSid:this.sid,payload:e,destinationSids:i,topic:o})}});yield this.engine.sendDataPacket(s,t)}))}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid===this.sid&&(!!super.updateInfo(e)&&(e.tracks.forEach((e=>{var t,n;const r=this.tracks.get(e.sid);if(r){const i=r.isMuted||null!==(n=null===(t=r.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;i!==e.muted&&(wl.debug("updating server mute state after reconcile",{sid:e.sid,muted:i}),this.engine.client.sendMuteTrack(e.sid,i))}})),!0))}getPublicationForTrack(e){let t;return this.tracks.forEach((n=>{const r=n.track;r&&(e instanceof MediaStreamTrack?(r instanceof ng||r instanceof gg)&&r.mediaStreamTrack===e&&(t=n):e===r&&(t=n))})),t}}!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting"}(Ig||(Ig={}));class Ng extends Gd.EventEmitter{constructor(e){var t,n;super(),t=this,this.state=Ig.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.connect=(e,t,n)=>Rd(this,void 0,void 0,(function*(){var r;const i=yield this.disconnectLock.lock();if(this.state===Ig.Connected)return wl.info("already connected to room ".concat(this.name)),i(),Promise.resolve();if(this.connectFuture)return i(),this.connectFuture.promise;this.setAndEmitConnectionState(Ig.Connecting),(null===(r=this.regionUrlProvider)||void 0===r?void 0:r.getServerUrl().toString())!==e&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),$f(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new Zm(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().catch((e=>{wl.warn("could not fetch region settings",{error:e})})));const o=(r,s,a)=>Rd(this,void 0,void 0,(function*(){var c;this.abortController&&this.abortController.abort();const l=new AbortController;this.abortController=l,null===i||void 0===i||i();try{yield this.attemptConnection(null!==a&&void 0!==a?a:e,t,n,l),this.abortController=void 0,r()}catch(u){if(this.regionUrlProvider&&u instanceof cp&&3!==u.reason&&0!==u.reason){let e=null;try{e=yield this.regionUrlProvider.getNextBestRegionUrl(null===(c=this.abortController)||void 0===c?void 0:c.signal)}catch(d){if(d instanceof cp&&(401===d.status||3===d.reason))return this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),void s(d)}e?(wl.info("Initial connection failed with ConnectionError: ".concat(u.message,". Retrying with another region: ").concat(e)),yield o(r,s,e)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),s(u))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),s(u)}})),s=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new om(((e,t)=>{o(e,t,s)}),(()=>{this.clearConnectionFutures()})),this.connectFuture.promise})),this.connectSignal=(e,t,n,r,i,o)=>Rd(this,void 0,void 0,(function*(){const s=yield n.join(e,t,{autoSubscribe:r.autoSubscribe,publishOnly:r.publishOnly,adaptiveStream:"object"===typeof i.adaptiveStream||i.adaptiveStream,maxRetries:r.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:r.websocketTimeout},o.signal);let a=s.serverInfo;if(a||(a={version:s.serverVersion,region:s.serverRegion}),wl.debug("connected to Livekit Server ".concat(Object.entries(a).map((e=>{let[t,n]=e;return"".concat(t,": ").concat(n)})).join(", "))),!s.serverVersion)throw new dp("unknown server version");return"0.15.1"===s.serverVersion&&this.options.dynacast&&(wl.debug("disabling dynacast due to server version"),i.dynacast=!1),s})),this.applyJoinResponse=e=>{const t=e.participant;this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(e.sifTrailer)},this.attemptConnection=(e,t,n,r)=>Rd(this,void 0,void 0,(function*(){var i,o;this.state===Ig.Reconnecting?(wl.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),(null===(i=this.regionUrlProvider)||void 0===i?void 0:i.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},qm),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,r);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit(mp.SignalConnected)}catch(s){yield this.engine.close(),this.recreateEngine();const e=new cp("could not establish signal connection");throw s instanceof Error&&(e.message="".concat(e.message,": ").concat(s.message)),s instanceof cp&&(e.reason=s.reason,e.status=s.status),wl.debug("error trying to establish signal connection",{error:s}),e}if(r.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new cp("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,r)}catch(a){throw yield this.engine.close(),this.recreateEngine(),a}Wf()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Wf()&&(document.addEventListener("freeze",this.onPageLeave),null===(o=navigator.mediaDevices)||void 0===o||o.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Ig.Connected),this.emit(mp.Connected),this.registerConnectionReconcile()})),this.disconnect=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Rd(t,void 0,void 0,(function*(){var t,n,r,i;const o=yield this.disconnectLock.lock();try{if(this.state===Ig.Disconnected)return void wl.debug("already disconnected");wl.info("disconnect from room",{identity:this.localParticipant.identity}),this.state!==Ig.Connecting&&this.state!==Ig.Reconnecting||(wl.warn("abort connection attempt"),null===(t=this.abortController)||void 0===t||t.abort(),null===(r=null===(n=this.connectFuture)||void 0===n?void 0:n.reject)||void 0===r||r.call(n,new cp("Client initiated disconnect")),this.connectFuture=void 0),(null===(i=this.engine)||void 0===i?void 0:i.client.isDisconnected)||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(e,Xu.CLIENT_INITIATED),this.engine=void 0}finally{o()}}))},this.onPageLeave=()=>Rd(this,void 0,void 0,(function*(){yield this.disconnect()})),this.startAudio=()=>Rd(this,void 0,void 0,(function*(){const e=[],t=Sp();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=im();e.enabled=!0;const r=new MediaStream([e]);n.srcObject=r,document.addEventListener("visibilitychange",(()=>{n&&(n.srcObject=document.hidden?null:r)})),document.body.append(n),this.once(mp.Disconnected,(()=>{null===n||void 0===n||n.remove()}))}e.push(n)}this.participants.forEach((t=>{t.audioTracks.forEach((t=>{t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))}));try{yield Promise.all([this.acquireAudioContext(),...e.map((e=>(e.muted=!1,e.play())))]),this.handleAudioPlaybackStarted()}catch(n){throw this.handleAudioPlaybackFailed(n),n}})),this.startVideo=()=>Rd(this,void 0,void 0,(function*(){const e=[];for(const t of this.participants.values())t.videoTracks.forEach((t=>{var n;null===(n=t.track)||void 0===n||n.attachedElements.forEach((t=>{e.includes(t)||e.push(t)}))}));yield Promise.all(e.map((e=>e.play()))).then((()=>{this.handleVideoPlaybackStarted()})).catch((e=>{"NotAllowedError"===e.name?this.handleVideoPlaybackFailed():wl.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler")}))})),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const e of this.participants.values())this.handleParticipantDisconnected(e.sid,e);this.setAndEmitConnectionState(Ig.Reconnecting)&&this.emit(mp.Reconnecting)},this.handleSignalRestarted=e=>Rd(this,void 0,void 0,(function*(){wl.debug("signal reconnected to server",{region:e.serverRegion}),this.cachedParticipantSids=[],this.applyJoinResponse(e);try{const e=[];this.localParticipant.tracks.forEach((t=>{t.track&&e.push(t)})),yield Promise.all(e.map((e=>Rd(this,void 0,void 0,(function*(){const t=e.track;this.localParticipant.unpublishTrack(t,!1),t.isMuted||((t instanceof ng||t instanceof gg)&&t.source!==Tf.Source.ScreenShare&&t.source!==Tf.Source.ScreenShareAudio&&!t.isUserProvided&&(wl.debug("restarting existing track",{track:e.trackSid}),yield t.restartTrack()),wl.debug("publishing new track",{track:e.trackSid}),yield this.localParticipant.publishTrack(t,e.options))})))))}catch(t){wl.error("error trying to re-publish tracks after reconnection",{error:t})}try{yield this.engine.waitForRestarted(),wl.debug("fully reconnected to server",{region:e.serverRegion})}catch(n){return}this.setAndEmitConnectionState(Ig.Connected),this.emit(mp.Reconnected),this.registerConnectionReconcile(),this.participants.forEach((e=>{this.emit(mp.ParticipantConnected,e)}))})),this.handleParticipantUpdates=e=>{e.forEach((e=>{if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);const t=this.identityToSid.get(e.identity);t&&t!==e.sid&&this.handleParticipantDisconnected(t,this.participants.get(t));let n=this.participants.get(e.sid);const r=!n;e.state===od.DISCONNECTED?this.handleParticipantDisconnected(e.sid,n):(n=this.getOrCreateParticipant(e.sid,e),r||n.updateInfo(e))}))},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach((e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.participants.get(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}})),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach((e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))})),this.activeSpeakers=t,this.emitWhenConnected(mp.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach((e=>{t.set(e.sid,e)})),e.forEach((e=>{let n=this.participants.get(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))}));const n=Array.from(t.values());n.sort(((e,t)=>t.audioLevel-e.audioLevel)),this.activeSpeakers=n,this.emitWhenConnected(mp.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach((e=>{const t=this.participants.get(e.participantSid);if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.track&&(n.track.streamState=Tf.streamStateFromProto(e.state),t.emit(gp.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected(mp.TrackStreamStateChanged,n,n.track.streamState,t))}))},this.handleSubscriptionPermissionUpdate=e=>{const t=this.participants.get(e.participantSid);if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.participants.values()).find((t=>t.tracks.has(e.trackSid)));if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=(e,t)=>{const n=this.participants.get(e.participantSid);this.emit(mp.DataReceived,e.payload,n,t,e.topic),null===n||void 0===n||n.emit(gp.DataReceived,e.payload,t)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(mp.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{wl.warn("could not playback audio",e),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(mp.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(mp.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(mp.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>Rd(this,void 0,void 0,(function*(){this.emit(mp.MediaDevicesChanged)})),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected(mp.RoomMetadataChanged,e.metadata),(null===t||void 0===t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected(mp.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach((e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.participants.get(e.participantSid);t&&t.setConnectionQuality(e.quality)}))},this.onLocalParticipantMetadataChanged=e=>{this.emit(mp.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit(mp.ParticipantNameChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit(mp.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit(mp.TrackUnmuted,e,this.localParticipant)},this.onLocalTrackPublished=e=>Rd(this,void 0,void 0,(function*(){var t;if(this.emit(mp.LocalTrackPublished,e,this.localParticipant),e.track instanceof ng){(yield e.track.checkForSilence())&&this.emit(mp.LocalAudioSilenceDetected,e)}const n=yield null===(t=e.track)||void 0===t?void 0:t.getDeviceId(),r=(i=e.source)===Tf.Source.Microphone?"audioinput":i===Tf.Source.Camera?"videoinput":void 0;var i;r&&n&&n!==this.localParticipant.activeDeviceMap.get(r)&&(this.localParticipant.activeDeviceMap.set(r,n),this.emit(mp.ActiveDeviceChanged,r,n))})),this.onLocalTrackUnpublished=e=>{this.emit(mp.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalConnectionQualityChanged=e=>{this.emit(mp.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=e=>{this.emit(mp.MediaDevicesError,e)},this.onLocalParticipantPermissionsChanged=e=>{this.emit(mp.ParticipantPermissionsChanged,e,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.cachedParticipantSids=[],this.identityToSid=new Map,this.options=Object.assign(Object.assign({},Wm),e),this.options.audioCaptureDefaults=Object.assign(Object.assign({},zm),null===e||void 0===e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},Vm),null===e||void 0===e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},jm),null===e||void 0===e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new sm,this.localParticipant=new Mg("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",am(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",am(this.options.audioCaptureDefaults.deviceId)),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&this.switchActiveDevice("audiooutput",am(this.options.audioOutput.deviceId)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return Rd(this,void 0,void 0,(function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)}))}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new hm(this.options.e2ee),this.e2eeManager.on(rp.ParticipantEncryptionStatusChanged,((e,t)=>{t instanceof Mg&&(this.isE2EEEnabled=e),this.emit(mp.ParticipantEncryptionStatusChanged,e,t)})),this.e2eeManager.on(rp.EncryptionError,(e=>this.emit(mp.EncryptionError,e))),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}get sid(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.sid)&&void 0!==t?t:""}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Xm(this.options),this.engine.on(vp.ParticipantUpdate,this.handleParticipantUpdates).on(vp.RoomUpdate,this.handleRoomUpdate).on(vp.SpeakersChanged,this.handleSpeakersChanged).on(vp.StreamStateChanged,this.handleStreamStateUpdate).on(vp.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(vp.SubscriptionError,this.handleSubscriptionError).on(vp.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(vp.MediaTrackAdded,((e,t,n)=>{this.onTrackAdded(e,t,n)})).on(vp.Disconnected,(e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)})).on(vp.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(vp.DataPacketReceived,this.handleDataPacket).on(vp.Resuming,(()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(Ig.Reconnecting)&&this.emit(mp.Reconnecting),this.cachedParticipantSids=Array.from(this.participants.keys())})).on(vp.Resumed,(()=>{this.setAndEmitConnectionState(Ig.Connected),this.emit(mp.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions();Array.from(this.participants.values()).filter((e=>!this.cachedParticipantSids.includes(e.sid))).forEach((e=>this.emit(mp.ParticipantConnected,e))),this.cachedParticipantSids=[]})).on(vp.SignalResumed,(()=>{this.state===Ig.Reconnecting&&this.sendSyncState()})).on(vp.Restarting,this.handleRestarting).on(vp.SignalRestarted,this.handleSignalRestarted).on(vp.DCBufferStatusChanged,((e,t)=>{this.emit(mp.DCBufferStatusChanged,e,t)})),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return um.getInstance().getDevices(e,t)}prepareConnection(e,t){return Rd(this,void 0,void 0,(function*(){if(this.state===Ig.Disconnected){wl.debug("prepareConnection to ".concat(e));try{if($f(new URL(e))&&t){this.regionUrlProvider=new Zm(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===Ig.Disconnected&&(this.regionUrl=n,yield fetch(cm(n),{method:"HEAD"}),wl.debug("prepared connection to ".concat(n)))}else yield fetch(cm(e),{method:"HEAD"})}catch(n){wl.warn("could not prepare connection",{error:n})}}}))}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const t=this.identityToSid.get(e);return t?this.participants.get(t):void 0}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return Rd(this,void 0,void 0,(function*(){let n,r=()=>{};switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new gf({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new gf({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new gf({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new gf({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new gf({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),r=()=>Rd(this,void 0,void 0,(function*(){const e=this.engine.client.onLeave;e&&e(new Xp({reason:Xu.CLIENT_INITIATED,canReconnect:!0}))}));break;case"subscriber-bandwidth":if(void 0===t||"number"!==typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new gf({scenario:{case:"subscriberBandwidth",value:BigInt(t)}})}n&&(this.engine.client.sendSimulateScenario(n),r())}))}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,t;return null!==(t=null===(e=this.options.audioOutput)||void 0===e?void 0:e.deviceId)&&void 0!==t?t:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var r,i,o;return Rd(this,void 0,void 0,(function*(){let s=!1,a=!0;const c=n?{exact:t}:t;if("audioinput"===e){const e=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,s=e!==c;const t=Array.from(this.localParticipant.audioTracks.values()).filter((e=>e.source===Tf.Source.Microphone));try{a=(yield Promise.all(t.map((e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(c)})))).every((e=>!0===e))}catch(l){throw this.options.audioCaptureDefaults.deviceId=e,l}}else if("videoinput"===e){const e=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,s=e!==c;const t=Array.from(this.localParticipant.videoTracks.values()).filter((e=>e.source===Tf.Source.Camera));try{a=(yield Promise.all(t.map((e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(c)})))).every((e=>!0===e))}catch(l){throw this.options.videoCaptureDefaults.deviceId=e,l}}else if("audiooutput"===e){if(!Ff()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");null!==(r=(o=this.options).audioOutput)&&void 0!==r||(o.audioOutput={});const e=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=t,s=e!==c;try{this.options.expWebAudioMix?null===(i=this.audioContext)||void 0===i||i.setSinkId(t):yield Promise.all(Array.from(this.participants.values()).map((e=>e.setAudioOutput({deviceId:t}))))}catch(l){throw this.options.audioOutput.deviceId=e,l}}return s&&a&&(this.localParticipant.activeDeviceMap.set(e,t),this.emit(mp.ActiveDeviceChanged,e,t)),a}))}setupLocalParticipantEvents(){this.localParticipant.on(gp.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(gp.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(gp.TrackMuted,this.onLocalTrackMuted).on(gp.TrackUnmuted,this.onLocalTrackUnmuted).on(gp.LocalTrackPublished,this.onLocalTrackPublished).on(gp.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(gp.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(gp.MediaDevicesError,this.onMediaDevicesError).on(gp.AudioStreamAcquired,this.startAudio).on(gp.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===Ig.Connecting||this.state===Ig.Reconnecting){const r=()=>{this.onTrackAdded(e,t,n),i()},i=()=>{this.off(mp.Reconnected,r),this.off(mp.Connected,r),this.off(mp.Disconnected,i)};return this.once(mp.Reconnected,r),this.once(mp.Connected,r),void this.once(mp.Disconnected,i)}if(this.state===Ig.Disconnected)return void wl.warn("skipping incoming track after Room disconnected");const r=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),i=r[0];let o=r[1],s=e.id;if(o&&o.startsWith("TR")&&(s=o),i===this.localParticipant.sid)return void wl.warn("tried to create RemoteParticipant for local participant");const a=this.participants.get(i);if(!a)return void wl.error("Tried to add a track for a participant, that's not present. Sid: ".concat(i));let c;this.options.adaptiveStream&&(c="object"===typeof this.options.adaptiveStream?this.options.adaptiveStream:{}),a.addSubscribedMediaTrack(e,s,t,n,c)}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.state!==Ig.Disconnected){this.regionUrl=void 0;try{this.participants.forEach((e=>{e.tracks.forEach((t=>{e.unpublishTrack(t.trackSid)}))})),this.localParticipant.tracks.forEach((t=>{var n,r;t.track&&this.localParticipant.unpublishTrack(t.track,e),e&&(null===(n=t.track)||void 0===n||n.detach(),null===(r=t.track)||void 0===r||r.stop())})),this.localParticipant.off(gp.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(gp.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(gp.TrackMuted,this.onLocalTrackMuted).off(gp.TrackUnmuted,this.onLocalTrackUnmuted).off(gp.LocalTrackPublished,this.onLocalTrackPublished).off(gp.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(gp.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(gp.MediaDevicesError,this.onMediaDevicesError).off(gp.AudioStreamAcquired,this.startAudio).off(gp.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"===typeof this.options.expWebAudioMix&&(this.audioContext.close(),this.audioContext=void 0),Wf()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(n=navigator.mediaDevices)||void 0===n||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ig.Disconnected),this.emit(mp.Disconnected,t)}}}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(this.identityToSid.delete(t.identity),t.tracks.forEach((e=>{t.unpublishTrack(e.trackSid,!0)})),this.emit(mp.ParticipantDisconnected,t))}acquireAudioContext(){var e,t;return Rd(this,void 0,void 0,(function*(){if("boolean"!==typeof this.options.expWebAudioMix&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=Rf())&&void 0!==e?e:void 0),this.audioContext&&"suspended"===this.audioContext.state)try{yield this.audioContext.resume()}catch(r){wl.warn(r)}this.options.expWebAudioMix&&this.participants.forEach((e=>e.setAudioContext(this.audioContext))),this.localParticipant.setAudioContext(this.audioContext);const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(mp.AudioPlaybackStatusChanged,n))}))}createParticipant(e,t){let n;return n=t?Og.fromParticipantInfo(this.engine.client,t):new Og(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&n.setAudioContext(this.audioContext),n}getOrCreateParticipant(e,t){if(this.participants.has(e))return this.participants.get(e);const n=this.createParticipant(e,t);return this.participants.set(e,n),this.identityToSid.set(t.identity,t.sid),this.emitWhenConnected(mp.ParticipantConnected,n),n.on(gp.TrackPublished,(e=>{this.emitWhenConnected(mp.TrackPublished,e,n)})).on(gp.TrackSubscribed,((e,t)=>{e.kind===Tf.Kind.Audio?(e.on(yp.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(yp.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):e.kind===Tf.Kind.Video&&(e.on(yp.VideoPlaybackFailed,this.handleVideoPlaybackFailed),e.on(yp.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(mp.TrackSubscribed,e,t,n)})).on(gp.TrackUnpublished,(e=>{this.emit(mp.TrackUnpublished,e,n)})).on(gp.TrackUnsubscribed,((e,t)=>{this.emit(mp.TrackUnsubscribed,e,t,n)})).on(gp.TrackSubscriptionFailed,(e=>{this.emit(mp.TrackSubscriptionFailed,e,n)})).on(gp.TrackMuted,(e=>{this.emitWhenConnected(mp.TrackMuted,e,n)})).on(gp.TrackUnmuted,(e=>{this.emitWhenConnected(mp.TrackUnmuted,e,n)})).on(gp.ParticipantMetadataChanged,(e=>{this.emitWhenConnected(mp.ParticipantMetadataChanged,e,n)})).on(gp.ParticipantNameChanged,(e=>{this.emitWhenConnected(mp.ParticipantNameChanged,e,n)})).on(gp.ConnectionQualityChanged,(e=>{this.emitWhenConnected(mp.ConnectionQualityChanged,e,n)})).on(gp.ParticipantPermissionsChanged,(e=>{this.emitWhenConnected(mp.ParticipantPermissionsChanged,e,n)})).on(gp.TrackSubscriptionStatusChanged,((e,t)=>{this.emitWhenConnected(mp.TrackSubscriptionStatusChanged,e,t,n)})).on(gp.TrackSubscriptionFailed,((e,t)=>{this.emit(mp.TrackSubscriptionFailed,e,n,t)})).on(gp.TrackSubscriptionPermissionChanged,((e,t)=>{this.emitWhenConnected(mp.TrackSubscriptionPermissionChanged,e,t,n)})),t&&n.updateInfo(t),n}sendSyncState(){const e=Array.from(this.participants.values()).reduce(((e,t)=>(e.push(...t.getTracks()),e)),[]),t=this.localParticipant.getTracks();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.participants.values())for(const t of e.videoTracks.values())t.isSubscribed&&t instanceof Pg&&t.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Cp.setInterval((()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,wl.warn("detected connection state mismatch",{numFailures:e}),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Xu.STATE_MISMATCH)))}),2e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&Cp.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit(mp.ConnectionStateChanged,this.state),!0)}emitWhenConnected(e){if(this.state===Ig.Connected){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.emit(e,...n)}return!1}simulateParticipants(e){var t,n;return Rd(this,void 0,void 0,(function*(){const r=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),i=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new ed({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Yl.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new id({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(mp.SignalConnected),this.emit(mp.Connected),this.setAndEmitConnectionState(Ig.Connected),r.video){const e=new _g(Tf.Kind.Video,new hd({source:Ju.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:Hu.AUDIO,name:"video-dummy"}),new gg(r.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:rm(null!==(t=160*i.aspectRatios[0])&&void 0!==t?t:1,160,!0,!0)));this.localParticipant.addTrackPublication(e),this.localParticipant.emit(gp.LocalTrackPublished,e)}if(r.audio){const e=new _g(Tf.Kind.Audio,new hd({source:Ju.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:Hu.AUDIO}),new ng(r.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:im()));this.localParticipant.addTrackPublication(e),this.localParticipant.emit(gp.LocalTrackPublished,e)}for(let e=0;e<i.count-1;e+=1){let t=new id({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:od.ACTIVE,tracks:[],joinedAt:Yl.parse(Date.now())});const r=this.getOrCreateParticipant(t.identity,t);if(i.video){const o=rm(null!==(n=160*i.aspectRatios[e%i.aspectRatios.length])&&void 0!==n?n:1,160,!1,!0),s=new hd({source:Ju.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:Hu.AUDIO});r.addSubscribedMediaTrack(o,s.sid,new MediaStream([o])),t.tracks=[...t.tracks,s]}if(i.audio){const e=im(),n=new hd({source:Ju.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:Hu.AUDIO});r.addSubscribedMediaTrack(e,n.sid,new MediaStream([e])),t.tracks=[...t.tracks,n]}r.updateInfo(t)}}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e!==mp.ActiveSpeakersChanged&&wl.debug("room event ".concat(e),{event:e,args:n}),super.emit(e,...n)}}var Ag;!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(Ag||(Ag={}));Gd.EventEmitter;Gd.EventEmitter;function Dg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const r=e instanceof dm?e.mediaStreamTrack:e,i=r.getSettings();let o={facingMode:null!==(n=t.defaultFacingMode)&&void 0!==n?n:"user",confidence:"low"};if("facingMode"in i){const e=i.facingMode;wl.debug("rawFacingMode",{rawFacingMode:e}),e&&"string"===typeof e&&function(e){const t=["user","environment","left","right"];return void 0===e||t.includes(e)}(e)&&(o={facingMode:e,confidence:"high"})}if(["low","medium"].includes(o.confidence)){wl.debug("Try to get facing mode from device label: (".concat(r.label,")"));const e=function(e){var t;const n=e.trim().toLowerCase();if(""===n)return;if(Lg.has(n))return Lg.get(n);return null===(t=Array.from(Ug.entries()).find((e=>{let[t]=e;return n.includes(t)})))||void 0===t?void 0:t[1]}(r.label);void 0!==e&&(o=e)}return o}const Lg=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),Ug=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);const Fg=Math.min,Bg=Math.max,jg=Math.round,zg=(Math.floor,e=>({x:e,y:e})),Vg={left:"right",right:"left",bottom:"top",top:"bottom"},Wg={start:"end",end:"start"};function qg(e,t,n){return Bg(e,Fg(t,n))}function $g(e,t){return"function"===typeof e?e(t):e}function Hg(e){return e.split("-")[0]}function Jg(e){return e.split("-")[1]}function Gg(e){return"x"===e?"y":"x"}function Yg(e){return"y"===e?"height":"width"}function Kg(e){return["top","bottom"].includes(Hg(e))?"y":"x"}function Xg(e){return Gg(Kg(e))}function Qg(e){return e.replace(/start|end/g,(e=>Wg[e]))}function Zg(e){return e.replace(/left|right|bottom|top/g,(e=>Vg[e]))}function ev(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function tv(e,t,n){let{reference:r,floating:i}=e;const o=Kg(t),s=Xg(t),a=Yg(s),c=Hg(t),l="y"===o,u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let p;switch(c){case"top":p={x:u,y:r.y-i.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-i.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Jg(t)){case"start":p[s]-=h*(n&&l?-1:1);break;case"end":p[s]+=h*(n&&l?-1:1)}return p}async function nv(e,t){var n;void 0===t&&(t={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=$g(t,e),f=function(e){return"number"!==typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(p),m=a[h?"floating"===d?"reference":"floating":d],g=ev(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(m)))||n?m:m.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v="floating"===d?{...s.floating,x:r,y:i}:s.reference,y=await(null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),b=await(null==o.isElement?void 0:o.isElement(y))&&await(null==o.getScale?void 0:o.getScale(y))||{x:1,y:1},w=ev(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:v,offsetParent:y,strategy:c}):v);return{top:(g.top-w.top+f.top)/b.y,bottom:(w.bottom-g.bottom+f.bottom)/b.y,left:(g.left-w.left+f.left)/b.x,right:(w.right-g.right+f.right)/b.x}}const rv=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:m=!0,...g}=$g(e,t);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const v=Hg(i),y=Hg(a)===a,b=await(null==c.isRTL?void 0:c.isRTL(l.floating)),w=h||(y||!m?[Zg(a)]:function(e){const t=Zg(e);return[Qg(e),t,Qg(t)]}(a));h||"none"===f||w.push(...function(e,t,n,r){const i=Jg(e);let o=function(e,t,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?o:s;default:return[]}}(Hg(e),"start"===n,r);return i&&(o=o.map((e=>e+"-"+i)),t&&(o=o.concat(o.map(Qg)))),o}(a,m,f,b));const k=[a,...w],S=await nv(t,g),T=[];let E=(null==(r=o.flip)?void 0:r.overflows)||[];if(u&&T.push(S[v]),d){const e=function(e,t,n){void 0===n&&(n=!1);const r=Jg(e),i=Xg(e),o=Yg(i);let s="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=Zg(s)),[s,Zg(s)]}(i,s,b);T.push(S[e[0]],S[e[1]])}if(E=[...E,{placement:i,overflows:T}],!T.every((e=>e<=0))){var C,_;const e=((null==(C=o.flip)?void 0:C.index)||0)+1,t=k[e];if(t)return{data:{index:e,overflows:E},reset:{placement:t}};let n=null==(_=E.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:_.placement;if(!n)switch(p){case"bestFit":{var x;const e=null==(x=E.map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:x[0];e&&(n=e);break}case"initialPlacement":n=a}if(i!==n)return{reset:{placement:n}}}return{}}}};const iv=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=t,c=await async function(e,t){const{placement:n,platform:r,elements:i}=e,o=await(null==r.isRTL?void 0:r.isRTL(i.floating)),s=Hg(n),a=Jg(n),c="y"===Kg(n),l=["left","top"].includes(s)?-1:1,u=o&&c?-1:1,d=$g(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"===typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&"number"===typeof f&&(p="end"===a?-1*f:f),c?{x:p*u,y:h*l}:{x:h*l,y:p*u}}(t,e);return s===(null==(n=a.offset)?void 0:n.placement)&&null!=(r=a.arrow)&&r.alignmentOffset?{}:{x:i+c.x,y:o+c.y,data:{...c,placement:s}}}}},ov=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...c}=$g(e,t),l={x:n,y:r},u=await nv(t,c),d=Kg(Hg(i)),h=Gg(d);let p=l[h],f=l[d];if(o){const e="y"===h?"bottom":"right";p=qg(p+u["y"===h?"top":"left"],p,p-u[e])}if(s){const e="y"===d?"bottom":"right";f=qg(f+u["y"===d?"top":"left"],f,f-u[e])}const m=a.fn({...t,[h]:p,[d]:f});return{...m,data:{x:m.x-n,y:m.y-r}}}}};function sv(e){return lv(e)?(e.nodeName||"").toLowerCase():"#document"}function av(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function cv(e){var t;return null==(t=(lv(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function lv(e){return e instanceof Node||e instanceof av(e).Node}function uv(e){return e instanceof Element||e instanceof av(e).Element}function dv(e){return e instanceof HTMLElement||e instanceof av(e).HTMLElement}function hv(e){return"undefined"!==typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof av(e).ShadowRoot)}function pv(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=yv(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function fv(e){return["table","td","th"].includes(sv(e))}function mv(e){const t=gv(),n=yv(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function gv(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function vv(e){return["html","body","#document"].includes(sv(e))}function yv(e){return av(e).getComputedStyle(e)}function bv(e){return uv(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function wv(e){if("html"===sv(e))return e;const t=e.assignedSlot||e.parentNode||hv(e)&&e.host||cv(e);return hv(t)?t.host:t}function kv(e){const t=wv(e);return vv(t)?e.ownerDocument?e.ownerDocument.body:e.body:dv(t)&&pv(t)?t:kv(t)}function Sv(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const i=kv(e),o=i===(null==(r=e.ownerDocument)?void 0:r.body),s=av(i);return o?t.concat(s,s.visualViewport||[],pv(i)?i:[],s.frameElement&&n?Sv(s.frameElement):[]):t.concat(i,Sv(i,[],n))}function Tv(e){const t=yv(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=dv(e),o=i?e.offsetWidth:n,s=i?e.offsetHeight:r,a=jg(n)!==o||jg(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function Ev(e){return uv(e)?e:e.contextElement}function Cv(e){const t=Ev(e);if(!dv(t))return zg(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:o}=Tv(t);let s=(o?jg(n.width):n.width)/r,a=(o?jg(n.height):n.height)/i;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}const _v=zg(0);function xv(e){const t=av(e);return gv()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:_v}function Iv(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const i=e.getBoundingClientRect(),o=Ev(e);let s=zg(1);t&&(r?uv(r)&&(s=Cv(r)):s=Cv(e));const a=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==av(e))&&t}(o,n,r)?xv(o):zg(0);let c=(i.left+a.x)/s.x,l=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const e=av(o),t=r&&uv(r)?av(r):r;let n=e.frameElement;for(;n&&r&&t!==e;){const e=Cv(n),t=n.getBoundingClientRect(),r=yv(n),i=t.left+(n.clientLeft+parseFloat(r.paddingLeft))*e.x,o=t.top+(n.clientTop+parseFloat(r.paddingTop))*e.y;c*=e.x,l*=e.y,u*=e.x,d*=e.y,c+=i,l+=o,n=av(n).frameElement}}return ev({width:u,height:d,x:c,y:l})}function Rv(e){return Iv(cv(e)).left+bv(e).scrollLeft}function Pv(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=av(e),r=cv(e),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,c=0;if(i){o=i.width,s=i.height;const e=gv();(!e||e&&"fixed"===t)&&(a=i.offsetLeft,c=i.offsetTop)}return{width:o,height:s,x:a,y:c}}(e,n);else if("document"===t)r=function(e){const t=cv(e),n=bv(e),r=e.ownerDocument.body,i=Bg(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Bg(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Rv(e);const a=-n.scrollTop;return"rtl"===yv(r).direction&&(s+=Bg(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}(cv(e));else if(uv(t))r=function(e,t){const n=Iv(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=dv(e)?Cv(e):zg(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:i*o.x,y:r*o.y}}(t,n);else{const n=xv(e);r={...t,x:t.x-n.x,y:t.y-n.y}}return ev(r)}function Ov(e,t){const n=wv(e);return!(n===t||!uv(n)||vv(n))&&("fixed"===yv(n).position||Ov(n,t))}function Mv(e,t,n){const r=dv(t),i=cv(t),o="fixed"===n,s=Iv(e,!0,o,t);let a={scrollLeft:0,scrollTop:0};const c=zg(0);if(r||!r&&!o)if(("body"!==sv(t)||pv(i))&&(a=bv(t)),r){const e=Iv(t,!0,o,t);c.x=e.x+t.clientLeft,c.y=e.y+t.clientTop}else i&&(c.x=Rv(i));return{x:s.left+a.scrollLeft-c.x,y:s.top+a.scrollTop-c.y,width:s.width,height:s.height}}function Nv(e,t){return dv(e)&&"fixed"!==yv(e).position?t?t(e):e.offsetParent:null}function Av(e,t){const n=av(e);if(!dv(e))return n;let r=Nv(e,t);for(;r&&fv(r)&&"static"===yv(r).position;)r=Nv(r,t);return r&&("html"===sv(r)||"body"===sv(r)&&"static"===yv(r).position&&!mv(r))?n:r||function(e){let t=wv(e);for(;dv(t)&&!vv(t);){if(mv(t))return t;t=wv(t)}return null}(e)||n}const Dv={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:r}=e;const i=dv(n),o=cv(n);if(n===o)return t;let s={scrollLeft:0,scrollTop:0},a=zg(1);const c=zg(0);if((i||!i&&"fixed"!==r)&&(("body"!==sv(n)||pv(o))&&(s=bv(n)),dv(n))){const e=Iv(n);a=Cv(n),c.x=e.x+n.clientLeft,c.y=e.y+n.clientTop}return{width:t.width*a.x,height:t.height*a.y,x:t.x*a.x-s.scrollLeft*a.x+c.x,y:t.y*a.y-s.scrollTop*a.y+c.y}},getDocumentElement:cv,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const o=[..."clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let r=Sv(e,[],!1).filter((e=>uv(e)&&"body"!==sv(e))),i=null;const o="fixed"===yv(e).position;let s=o?wv(e):e;for(;uv(s)&&!vv(s);){const t=yv(s),n=mv(s);n||"fixed"!==t.position||(i=null),(o?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||pv(s)&&!n&&Ov(e,s))?r=r.filter((e=>e!==s)):i=t,s=wv(s)}return t.set(e,r),r}(t,this._c):[].concat(n),r],s=o[0],a=o.reduce(((e,n)=>{const r=Pv(t,n,i);return e.top=Bg(r.top,e.top),e.right=Fg(r.right,e.right),e.bottom=Fg(r.bottom,e.bottom),e.left=Bg(r.left,e.left),e}),Pv(t,s,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:Av,getElementRects:async function(e){let{reference:t,floating:n,strategy:r}=e;const i=this.getOffsetParent||Av,o=this.getDimensions;return{reference:Mv(t,await i(n),r),floating:{x:0,y:0,...await o(n)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){return Tv(e)},getScale:Cv,isElement:uv,isRTL:function(e){return"rtl"===yv(e).direction}};const Lv=(e,t,n)=>{const r=new Map,i={platform:Dv,...n},o={...i.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),c=await(null==s.isRTL?void 0:s.isRTL(t));let l=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=tv(l,r,c),h=r,p={},f=0;for(let m=0;m<a.length;m++){const{name:n,fn:o}=a[m],{x:g,y:v,data:y,reset:b}=await o({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:p,rects:l,platform:s,elements:{reference:e,floating:t}});u=null!=g?g:u,d=null!=v?v:d,p={...p,[n]:{...p[n],...y}},b&&f<=50&&(f++,"object"===typeof b&&(b.placement&&(h=b.placement),b.rects&&(l=!0===b.rects?await s.getElementRects({reference:e,floating:t,strategy:i}):b.rects),({x:u,y:d}=tv(l,h,c))),m=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:p}})(e,t,{...i,platform:o})};var Uv=n(895);function Fv(e){return"function"===typeof e}function Bv(e){return function(t){if(function(e){return Fv(null===e||void 0===e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(n){this.error(n)}}));throw new TypeError("Unable to lift unknown Observable type")}}function jv(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var zv=jv((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function Vv(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Wv=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=ba(o),a=s.next();!a.done;a=s.next()){a.value.remove(this)}}catch(p){e={error:p}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var c=this.initialTeardown;if(Fv(c))try{c()}catch(f){i=f instanceof zv?f.errors:[f]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var u=ba(l),d=u.next();!d.done;d=u.next()){var h=d.value;try{Hv(h)}catch(m){i=null!==i&&void 0!==i?i:[],m instanceof zv?i=ka(ka([],wa(i)),wa(m.errors)):i.push(m)}}}catch(g){n={error:g}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(i)throw new zv(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Hv(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Vv(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Vv(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),qv=Wv.EMPTY;function $v(e){return e instanceof Wv||e&&"closed"in e&&Fv(e.remove)&&Fv(e.add)&&Fv(e.unsubscribe)}function Hv(e){Fv(e)?e():e.unsubscribe()}var Jv={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Gv={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Gv.delegate;return(null===i||void 0===i?void 0:i.setTimeout)?i.setTimeout.apply(i,ka([e,t],wa(n))):setTimeout.apply(void 0,ka([e,t],wa(n)))},clearTimeout:function(e){var t=Gv.delegate;return((null===t||void 0===t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Yv(e){Gv.setTimeout((function(){var t=Jv.onUnhandledError;if(!t)throw e;t(e)}))}function Kv(){}var Xv=Qv("C",void 0,void 0);function Qv(e,t,n){return{kind:e,value:t,error:n}}var Zv=null;function ey(e){if(Jv.useDeprecatedSynchronousErrorHandling){var t=!Zv;if(t&&(Zv={errorThrown:!1,error:null}),e(),t){var n=Zv,r=n.errorThrown,i=n.error;if(Zv=null,r)throw i}}else e()}var ty=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,$v(t)&&t.add(n)):n.destination=cy,n}return ma(t,e),t.create=function(e,t,n){return new oy(e,t,n)},t.prototype.next=function(e){this.isStopped?ay(function(e){return Qv("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?ay(Qv("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?ay(Xv,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Wv),ny=Function.prototype.bind;function ry(e,t){return ny.call(e,t)}var iy=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){sy(n)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){sy(n)}else sy(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){sy(t)}},e}(),oy=function(e){function t(t,n,r){var i,o,s=e.call(this)||this;Fv(t)||!t?i={next:null!==t&&void 0!==t?t:void 0,error:null!==n&&void 0!==n?n:void 0,complete:null!==r&&void 0!==r?r:void 0}:s&&Jv.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},i={next:t.next&&ry(t.next,o),error:t.error&&ry(t.error,o),complete:t.complete&&ry(t.complete,o)}):i=t;return s.destination=new iy(i),s}return ma(t,e),t}(ty);function sy(e){var t;Jv.useDeprecatedSynchronousErrorHandling?(t=e,Jv.useDeprecatedSynchronousErrorHandling&&Zv&&(Zv.errorThrown=!0,Zv.error=t)):Yv(e)}function ay(e,t){var n=Jv.onStoppedNotification;n&&Gv.setTimeout((function(){return n(e,t)}))}var cy={closed:!0,next:Kv,error:function(e){throw e},complete:Kv};function ly(e,t,n,r,i){return new uy(e,t,n,r,i)}var uy=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(r){t.error(r)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return ma(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(ty);function dy(e,t){return Bv((function(n,r){var i=0;n.subscribe(ly(r,(function(n){r.next(e.call(t,n,i++))})))}))}var hy=function(e){return e&&"number"===typeof e.length&&"function"!==typeof e};function py(e){return Fv(null===e||void 0===e?void 0:e.then)}var fy="function"===typeof Symbol&&Symbol.observable||"@@observable";function my(e){return e}function gy(e){return 0===e.length?my:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var vy=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof ty||function(e){return e&&Fv(e.next)&&Fv(e.error)&&Fv(e.complete)}(r)&&$v(r)?e:new oy(e,t,n);return ey((function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=yy(t))((function(t,r){var i=new oy({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[fy]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return gy(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=yy(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function yy(e){var t;return null!==(t=null!==e&&void 0!==e?e:Jv.Promise)&&void 0!==t?t:Promise}function by(e){return Fv(e[fy])}function wy(e){return Symbol.asyncIterator&&Fv(null===e||void 0===e?void 0:e[Symbol.asyncIterator])}function ky(e){return new TypeError("You provided "+(null!==e&&"object"===typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Sy="function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ty(e){return Fv(null===e||void 0===e?void 0:e[Sy])}function Ey(e){return Ta(this,arguments,(function(){var t,n,r;return ya(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Sa(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,Sa(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,Sa(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Cy(e){return Fv(null===e||void 0===e?void 0:e.getReader)}function _y(e){if(e instanceof vy)return e;if(null!=e){if(by(e))return i=e,new vy((function(e){var t=i[fy]();if(Fv(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(hy(e))return r=e,new vy((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(py(e))return n=e,new vy((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,Yv)}));if(wy(e))return xy(e);if(Ty(e))return t=e,new vy((function(e){var n,r;try{for(var i=ba(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(Cy(e))return xy(Ey(e))}var t,n,r,i;throw ky(e)}function xy(e){return new vy((function(t){(function(e,t){var n,r,i,o;return va(this,void 0,void 0,(function(){var s,a;return ya(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=Ea(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Iy(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function Ry(e,t,n){return void 0===n&&(n=1/0),Fv(t)?Ry((function(n,r){return dy((function(e,i){return t(n,e,r,i)}))(_y(e(n,r)))}),n):("number"===typeof t&&(n=t),Bv((function(t,r){return function(e,t,n,r,i,o,s,a){var c=[],l=0,u=0,d=!1,h=function(){!d||c.length||l||t.complete()},p=function(e){return l<r?f(e):c.push(e)},f=function(e){o&&t.next(e),l++;var a=!1;_y(n(e,u++)).subscribe(ly(t,(function(e){null===i||void 0===i||i(e),o?p(e):t.next(e)}),(function(){a=!0}),void 0,(function(){if(a)try{l--;for(var e=function(){var e=c.shift();s?Iy(t,s,(function(){return f(e)})):f(e)};c.length&&l<r;)e();h()}catch(n){t.error(n)}})))};return e.subscribe(ly(t,p,(function(){d=!0,h()}))),function(){null===a||void 0===a||a()}}(t,r,e,n)})))}function Py(){return void 0===(e=1)&&(e=1/0),Ry(my,e);var e}function Oy(e){return e[e.length-1]}function My(e){return(t=Oy(e))&&Fv(t.schedule)?e.pop():void 0;var t}function Ny(e,t){return void 0===t&&(t=0),Bv((function(n,r){n.subscribe(ly(r,(function(n){return Iy(r,e,(function(){return r.next(n)}),t)}),(function(){return Iy(r,e,(function(){return r.complete()}),t)}),(function(n){return Iy(r,e,(function(){return r.error(n)}),t)})))}))}function Ay(e,t){return void 0===t&&(t=0),Bv((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function Dy(e,t){if(!e)throw new Error("Iterable cannot be null");return new vy((function(n){Iy(n,t,(function(){var r=e[Symbol.asyncIterator]();Iy(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function Ly(e,t){if(null!=e){if(by(e))return function(e,t){return _y(e).pipe(Ay(t),Ny(t))}(e,t);if(hy(e))return function(e,t){return new vy((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(py(e))return function(e,t){return _y(e).pipe(Ay(t),Ny(t))}(e,t);if(wy(e))return Dy(e,t);if(Ty(e))return function(e,t){return new vy((function(n){var r;return Iy(n,t,(function(){r=e[Sy](),Iy(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(o){return void n.error(o)}i?n.complete():n.next(t)}),0,!0)})),function(){return Fv(null===r||void 0===r?void 0:r.return)&&r.return()}}))}(e,t);if(Cy(e))return function(e,t){return Dy(Ey(e),t)}(e,t)}throw ky(e)}function Uy(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Py()(function(e,t){return t?Ly(e,t):_y(e)}(e,My(e)))}function Fy(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=My(e);return Bv((function(t,r){(n?Uy(e,t,n):Uy(e,t)).subscribe(r)}))}var By=jv((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),jy=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return ma(t,e),t.prototype.lift=function(e){var t=new zy(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new By},t.prototype.next=function(e){var t=this;ey((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=ba(t.currentObservers),o=i.next();!o.done;o=i.next()){o.value.next(e)}}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;ey((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;ey((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?qv:(this.currentObservers=null,o.push(e),new Wv((function(){t.currentObservers=null,Vv(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new vy;return e.source=this,e},t.create=function(e,t){return new zy(e,t)},t}(vy),zy=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return ma(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:qv},t}(jy);function Vy(e,t){return Bv((function(n,r){var i=0;n.subscribe(ly(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}var Wy=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return ma(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(jy);function qy(e){return Bv((function(t,n){_y(e).subscribe(ly(n,(function(){return n.complete()}),Kv)),!n.closed&&t.subscribe(n)}))}function $y(e,t){return Bv(function(e,t,n,r,i){return function(o,s){var a=n,c=t,l=0;o.subscribe(ly(s,(function(t){var n=l++;c=a?e(c,t,n):(a=!0,t),r&&s.next(c)}),i&&function(){a&&s.next(c),s.complete()}))}}(e,t,arguments.length>=2,!0))}var Hy=Object.defineProperty,Jy=Object.defineProperties,Gy=Object.getOwnPropertyDescriptors,Yy=Object.getOwnPropertySymbols,Ky=Object.prototype.hasOwnProperty,Xy=Object.prototype.propertyIsEnumerable,Qy=(e,t,n)=>t in e?Hy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Zy=(e,t)=>{for(var n in t||(t={}))Ky.call(t,n)&&Qy(e,n,t[n]);if(Yy)for(var n of Yy(t))Xy.call(t,n)&&Qy(e,n,t[n]);return e},eb=(e,t)=>Jy(e,Gy(t)),tb=(e,t)=>{var n={};for(var r in e)Ky.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Yy)for(var r of Yy(e))t.indexOf(r)<0&&Xy.call(e,r)&&(n[r]=e[r]);return n},nb=(e,t,n)=>new Promise(((r,i)=>{var o=e=>{try{a(n.next(e))}catch(t){i(t)}},s=e=>{try{a(n.throw(e))}catch(t){i(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);a((n=n.apply(e,t)).next())})),rb="lk";function ib(e){return"undefined"!==typeof e&&(function(e){var t;if(!e)return!1;return e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&"undefined"!==typeof(null==(t=e.publication)?void 0:t.track)}(e)||function(e){if(!e)return!1;return e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&"undefined"!==typeof e.publication}(e))}function ob(e){return!!e&&(e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&"undefined"===typeof e.publication)}function sb(e){if("string"===typeof e||"number"===typeof e)return`${e}`;if(ob(e))return`${e.participant.identity}_${e.source}_placeholder`;if(ib(e))return`${e.participant.identity}_${e.publication.source}_${e.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${e}`)}var ab=[...[mp.ConnectionStateChanged,mp.RoomMetadataChanged,mp.ActiveSpeakersChanged,mp.ConnectionQualityChanged,mp.ParticipantConnected,mp.ParticipantDisconnected,mp.ParticipantPermissionsChanged,mp.ParticipantMetadataChanged,mp.TrackMuted,mp.TrackUnmuted,mp.TrackPublished,mp.TrackUnpublished,mp.TrackStreamStateChanged,mp.TrackSubscriptionFailed,mp.TrackSubscriptionPermissionChanged,mp.TrackSubscriptionStatusChanged],mp.LocalTrackPublished,mp.LocalTrackUnpublished],cb=(gp.ConnectionQualityChanged,gp.IsSpeakingChanged,gp.ParticipantMetadataChanged,gp.ParticipantPermissionsChanged,gp.TrackMuted,gp.TrackUnmuted,gp.TrackPublished,gp.TrackUnpublished,gp.TrackStreamStateChanged,gp.TrackSubscriptionFailed,gp.TrackSubscriptionPermissionChanged,gp.TrackSubscriptionStatusChanged,gp.LocalTrackPublished,gp.LocalTrackUnpublished,Uv.getLogger("lk-components-js"));cb.setDefaultLevel("WARN");var lb=[],ub={showChat:!1,unreadMessages:0};function db(e,...t){return new vy((n=>{const r=()=>{n.next(e)};t.forEach((t=>{e.on(t,r)}));return()=>{t.forEach((t=>{e.off(t,r)}))}})).pipe(Fy(e))}function hb(e,t){return new vy((n=>{const r=(...e)=>{n.next(e)};e.on(t,r);return()=>{e.off(t,r)}}))}function pb(e,t,n=!0){var r;const i=()=>nb(this,null,(function*(){try{const t=yield Ng.getLocalDevices(e,n);o.next(t)}catch(r){null==t||t(r)}})),o=new jy,s=o.pipe((a=()=>{var e;null==(e=null==navigator?void 0:navigator.mediaDevices)||e.removeEventListener("devicechange",i)},Bv((function(e,t){try{e.subscribe(t)}finally{t.add(a)}}))));var a;if("undefined"!==typeof window){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");null==(r=null==navigator?void 0:navigator.mediaDevices)||r.addEventListener("devicechange",i)}return Uy(Ng.getLocalDevices(e,n).catch((e=>null==t?void 0:t(e))),s)}function fb(e){return db(e,mp.AudioPlaybackStatusChanged).pipe(dy((e=>({canPlayAudio:e.canPlaybackAudio}))))}function mb(e){return db(e,mp.VideoPlaybackStatusChanged).pipe(dy((e=>({canPlayVideo:e.canPlaybackVideo}))))}function gb(e){return`${rb}-${e}`}function vb(e){if(ib(e))return e.publication;{const{source:t,name:n,participant:r}=e;if(t&&n)return r.getTracks().find((e=>e.source===t&&e.trackName===n));if(n)return r.getTrackByName(n);if(t)return r.getTrack(t);throw new Error("At least one of source and name needs to be defined")}}function yb(e,...t){return new vy((n=>{const r=()=>{n.next(e)};t.forEach((t=>{e.on(t,r)}));return()=>{t.forEach((t=>{e.off(t,r)}))}})).pipe(Fy(e))}function bb(e){return yb(e,gp.TrackMuted,gp.TrackUnmuted,gp.ParticipantPermissionsChanged,gp.TrackPublished,gp.TrackUnpublished,gp.LocalTrackPublished,gp.LocalTrackUnpublished,gp.MediaDevicesError,gp.TrackSubscriptionStatusChanged).pipe(dy((e=>{const{isMicrophoneEnabled:t,isCameraEnabled:n,isScreenShareEnabled:r}=e,i=e.getTrack(Tf.Source.Microphone);return{isCameraEnabled:n,isMicrophoneEnabled:t,isScreenShareEnabled:r,cameraTrack:e.getTrack(Tf.Source.Camera),microphoneTrack:i,participant:e}})))}function wb(e,t){return new vy((n=>{const r=(...e)=>{n.next(e)};e.on(t,r);return()=>{e.off(t,r)}}))}function kb(e){var t,n,r,i;return yb(e.participant,gp.TrackMuted,gp.TrackUnmuted,gp.TrackSubscribed,gp.TrackUnsubscribed,gp.LocalTrackPublished,gp.LocalTrackUnpublished).pipe(dy((t=>{var n,r;const i=null!=(n=e.publication)?n:t.getTrack(e.source);return null==(r=null==i?void 0:i.isMuted)||r})),Fy(null==(i=null!=(r=null==(t=e.publication)?void 0:t.isMuted)?r:null==(n=e.participant.getTrack(e.source))?void 0:n.isMuted)||i))}function Sb(e,t,n){const r=new Wy(void 0),i=t?function(e,t){return hb(e,mp.ActiveDeviceChanged).pipe(Vy((([e])=>e===t)),dy((([e,t])=>(cb.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:e,deviceId:t}),t))),Fy(e.getActiveDevice(t)))}(t,e):r.asObservable();return{className:gb("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:(i,...o)=>nb(this,[i,...o],(function*(i,o={}){var s,a,c;if(t){cb.debug(`Switching active device of kind "${e}" with id ${i}.`),yield t.switchActiveDevice(e,i,o.exact);const n=null!=(s=t.getActiveDevice(e))?s:i;let l;n!==i&&"default"!==i&&cb.info(`We tried to select the device with id (${i}), but the browser decided to select the device with id (${n}) instead.`),"audioinput"===e?l=null==(a=t.localParticipant.getTrack(Tf.Source.Microphone))?void 0:a.track:"videoinput"===e&&(l=null==(c=t.localParticipant.getTrack(Tf.Source.Camera))?void 0:c.track);const u="default"===i&&!l||"default"===i&&(null==l?void 0:l.mediaStreamTrack.label.startsWith("Default"));r.next(u?i:n)}else if(n){yield n.setDeviceId(o.exact?{exact:i}:i);const e=yield n.getDeviceId();r.next("default"===i&&n.mediaStreamTrack.label.startsWith("Default")?i:e)}else r.value!==i&&(cb.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(i))}))}}function Tb(e){const t=gb("connection-quality"),n=function(e){return wb(e,gp.ConnectionQualityChanged).pipe(dy((([e])=>e)),Fy(e.connectionQuality))}(e);return{className:t,connectionQualityObserver:n}}function Eb(e){const t=function(e){const t=yb(e,gp.ParticipantMetadataChanged).pipe(dy((({name:e,identity:t,metadata:n})=>({name:e,identity:t,metadata:n}))),Fy({name:e.name,identity:e.identity,metadata:e.metadata}));return t}(e);return{className:"lk-participant-name",infoObserver:t}}var Cb={CHAT:"lk-chat-topic"};function _b(e,t,n){return nb(this,arguments,(function*(e,t,n,r={}){const{kind:i,destination:o}=r;yield e.publishData(t,null!=i?i:ad.RELIABLE,{destination:o,topic:n})}))}function xb(e,t,n){const r=function(e){return hb(e,mp.DataReceived)}(e).pipe(Vy((([,,,e])=>void 0===t||e===t)),dy((([e,t,,r])=>{const i={payload:e,topic:r,from:t};return null==n||n(i),i})));let i;return{messageObservable:r,isSendingObservable:new vy((e=>{i=e})),send:(n,...r)=>nb(this,[n,...r],(function*(n,r={}){i.next(!0);try{yield _b(e.localParticipant,n,t,r)}finally{i.next(!1)}}))}}var Ib=new TextEncoder,Rb=new TextDecoder,Pb=new Map,Ob=e=>Ib.encode(JSON.stringify({message:e.message,timestamp:e.timestamp})),Mb=e=>JSON.parse(Rb.decode(e));function Nb(){return{className:gb("start-audio-button"),roomVideoPlaybackAllowedObservable:mb,handleStartVideoPlayback:e=>nb(this,null,(function*(){cb.info("Start Video for room: ",e),yield e.startVideo()}))}}var Ab,Db=`${rb}-user-choices`,Lb={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:Ub,save:Fb}=(Ab=Db,{load:()=>function(e){if("undefined"!==typeof localStorage)try{const t=localStorage.getItem(e);return t?JSON.parse(t):void cb.warn(`Item with key ${e} does not exist in local storage.`)}catch(t){return void cb.error(`Error getting item from local storage: ${t}`)}else cb.error("Local storage is not available.")}(Ab),save:e=>function(e,t){if("undefined"!==typeof localStorage)try{localStorage.setItem(e,JSON.stringify(t))}catch(n){cb.error(`Error setting item to local storage: ${n}`)}else cb.error("Local storage is not available.")}(Ab,e)});function Bb(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=Bb(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}const jb=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=Bb(e))&&(r&&(r+=" "),r+=t);return r};"undefined"!==typeof window?t.useLayoutEffect:t.useEffect;var zb=Object.defineProperty,Vb=Object.defineProperties,Wb=Object.getOwnPropertyDescriptors,qb=Object.getOwnPropertySymbols,$b=Object.prototype.hasOwnProperty,Hb=Object.prototype.propertyIsEnumerable,Jb=(e,t,n)=>t in e?zb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Gb=(e,t)=>{for(var n in t||(t={}))$b.call(t,n)&&Jb(e,n,t[n]);if(qb)for(var n of qb(t))Hb.call(t,n)&&Jb(e,n,t[n]);return e},Yb=(e,t)=>Vb(e,Wb(t)),Kb=(e,t)=>{var n={};for(var r in e)$b.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&qb)for(var r of qb(e))t.indexOf(r)<0&&Hb.call(e,r)&&(n[r]=e[r]);return n},Xb=(e,t,n)=>new Promise(((r,i)=>{var o=e=>{try{a(n.next(e))}catch(t){i(t)}},s=e=>{try{a(n.throw(e))}catch(t){i(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);a((n=n.apply(e,t)).next())}));function Qb(e,n){const[r,i]=t.useState(n);return t.useEffect((()=>{if("undefined"===typeof window||!e)return;const t=e.subscribe(i);return()=>t.unsubscribe()}),[e]),r}function Zb(e,t){if("show_chat"===t.msg)return Yb(Gb({},e),{showChat:!0,unreadMessages:0});if("hide_chat"===t.msg)return Yb(Gb({},e),{showChat:!1});if("toggle_chat"===t.msg){const t=Yb(Gb({},e),{showChat:!e.showChat});return!0===t.showChat&&(t.unreadMessages=0),t}return"unread_msg"===t.msg?Yb(Gb({},e),{unreadMessages:t.count}):Gb({},e)}function ew(e,t){return"set_pin"===t.msg?[t.trackReference]:"clear_pin"===t.msg?[]:Gb({},e)}var tw=t.createContext(void 0);function nw(){const e=t.useContext(tw);if(!e)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return e}function rw(){return t.useContext(tw)}var iw=t.createContext(void 0);function ow(){return t.useContext(iw)}var sw=t.createContext(void 0);function aw(){return t.useContext(sw)}function cw(e){var t;const n=aw(),r=ow(),i=null!=(t=null!=e?e:n)?t:null==r?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var lw=t.createContext(void 0);function uw(){const e=t.useContext(lw);if(!e)throw Error("tried to access room context outside of livekit room component");return e}function dw(){return t.useContext(lw)}function hw(e){const t=dw(),n=null!=e?e:t;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var pw=t.createContext(void 0);function fw(...e){return(...t)=>{for(const n of e)"function"===typeof n&&n(...t)}}function mw(...e){const t=Gb({},e[0]);for(let n=1;n<e.length;n++){const r=e[n];for(const e in r){const n=t[e],i=r[e];"function"===typeof n&&"function"===typeof i&&"o"===e[0]&&"n"===e[1]&&e.charCodeAt(2)>=65&&e.charCodeAt(2)<=90?t[e]=fw(n,i):t[e]="className"!==e&&"UNSAFE_className"!==e||"string"!==typeof n||"string"!==typeof i?void 0!==i?i:n:jb(n,i)}}return t}function gw(e){const n=hw(e),r=t.useMemo((()=>function(e){return hb(e,mp.ConnectionStateChanged).pipe(dy((([e])=>e)),Fy(e.state))}(n)),[n]);return Qb(r,n.state)}function vw(e){const n=uw(),r=gw(n),i=t.useMemo((()=>{const{className:t,disconnect:i}=function(e){return{className:gb("disconnect-button"),disconnect:t=>{e.disconnect(t)}}}(n);return mw(e,{className:t,onClick:()=>{var t;return i(null==(t=e.stopTracks)||t)},disabled:r===Ig.Disconnected})}),[n,e,r]);return{buttonProps:i}}function yw(e,n={}){var r,i;const o=cw("string"===typeof e?n.participant:e.participant),s="string"===typeof e?{participant:o,source:e}:e,[a,c]=t.useState(!(!(null==(r=s.publication)?void 0:r.isMuted)&&!(null==(i=o.getTrack(s.source))?void 0:i.isMuted)));return t.useEffect((()=>{const e=kb(s).subscribe(c);return()=>e.unsubscribe()}),[sb(s)]),a}function bw(e){const n=cw(e),r=t.useMemo((()=>function(e){return wb(e,gp.IsSpeakingChanged).pipe(dy((([e])=>e)))}(n)),[n]);return Qb(r,n.isSpeaking)}var ww={connect:!0,audio:!1,video:!1};function kw(){const e=uw();return Qb(t.useMemo((()=>{return wb(t=e.localParticipant,gp.ParticipantPermissionsChanged).pipe(dy((()=>t.permissions)),Fy(t.permissions));var t}),[e]),e.localParticipant.permissions)}function Sw(e){return void 0!==e}function Tw(...e){return mw(...e.filter(Sw))}function Ew(e,n,r){return t.Children.map(e,(i=>t.isValidElement(i)&&t.Children.only(e)?t.cloneElement(i,Yb(Gb({},n),{key:r})):i))}function Cw(e,n={}){var r;const[i,o]=t.useState(vb(e)),[s,a]=t.useState(null==i?void 0:i.isMuted),[c,l]=t.useState(null==i?void 0:i.isSubscribed),[u,d]=t.useState(null==i?void 0:i.track),[h,p]=t.useState("landscape"),f=t.useRef(),{className:m,trackObserver:g}=t.useMemo((()=>function(e){const t=vb(e),n=bb(e.participant).pipe(dy((()=>vb(e))),Fy(t));return{className:gb(e.source===Tf.Source.Camera||e.source===Tf.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}(e)),[null!=(r=e.participant.sid)?r:e.participant.identity,e.source,ib(e)&&e.publication.trackSid]);return t.useEffect((()=>{const e=g.subscribe((e=>{cb.debug("update track",e),o(e),a(null==e?void 0:e.isMuted),l(null==e?void 0:e.isSubscribed),d(null==e?void 0:e.track)}));return()=>null==e?void 0:e.unsubscribe()}),[g]),t.useEffect((()=>{var t,r;return u&&(f.current&&u.detach(f.current),!(null==(t=n.element)?void 0:t.current)||e.participant instanceof Mg&&"audio"===(null==u?void 0:u.kind)||u.attach(n.element.current)),f.current=null==(r=n.element)?void 0:r.current,()=>{f.current&&(null==u||u.detach(f.current))}}),[u,n.element]),t.useEffect((()=>{var e,t;if("number"===typeof(null==(e=null==i?void 0:i.dimensions)?void 0:e.width)&&"number"===typeof(null==(t=null==i?void 0:i.dimensions)?void 0:t.height)){const e=i.dimensions.width>i.dimensions.height?"landscape":"portrait";p(e)}}),[i]),{publication:i,isMuted:s,isSubscribed:c,track:u,elementProps:Tw(n.props,Gb({className:m,"data-lk-local-participant":e.participant.isLocal,"data-lk-source":null==i?void 0:i.source},"video"===(null==i?void 0:i.kind)&&{"data-lk-orientation":h}))}}function _w({trackRef:e,participant:n,source:r,publication:i,onParticipantClick:o,disableSpeakingIndicator:s,htmlProps:a}){const c=ow(),l=cw(n),u=t.useMemo((()=>{var t,n,o,s,a,u;const d=null!=(n=null!=(t=null==e?void 0:e.source)?t:null==c?void 0:c.source)?n:r;if(void 0===d)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:null!=(s=null!=(o=null==e?void 0:e.participant)?o:null==c?void 0:c.participant)?s:l,publication:null!=(u=null!=(a=null==e?void 0:e.publication)?a:null==c?void 0:c.publication)?u:i,source:d}}),[null==e?void 0:e.participant,null==e?void 0:e.source,null==e?void 0:e.publication,null==c?void 0:c.participant,null==c?void 0:c.source,null==c?void 0:c.publication,l,r,i]),d=t.useMemo((()=>{const{className:e}={className:gb("participant-tile")};return mw(a,{className:e,onClick:e=>{var t,n;if(null==(t=a.onClick)||t.call(a,e),"function"===typeof o){const e=null!=(n=u.publication)?n:u.participant.getTrack(u.source);o({participant:u.participant,track:e})}}})}),[a,o,u.publication,u.source,u.participant]),h=yw(Tf.Source.Camera,{participant:u.participant}),p=yw(Tf.Source.Microphone,{participant:u.participant}),f=bw(u.participant),m=function(e){if(e.publication instanceof _g){const t=e.publication.track;if(t){const{facingMode:e}=Dg(t);return e}}return"undefined"}(u);return{elementProps:Gb({"data-lk-audio-muted":p,"data-lk-video-muted":h,"data-lk-speaking":!0!==s&&f,"data-lk-local-participant":u.participant.isLocal,"data-lk-source":u.source,"data-lk-facing-mode":m},d)}}function xw(e={}){const n=hw(e.room),[r,i]=t.useState([]);return t.useEffect((()=>{const t=function(e,t={}){var n;let r;const i=new vy((e=>(r=e,()=>s.unsubscribe()))).pipe(Fy(Array.from(e.participants.values()))),o=null!=(n=t.additionalRoomEvents)?n:ab,s=db(e,...Array.from(new Set([mp.ParticipantConnected,mp.ParticipantDisconnected,mp.ConnectionStateChanged,...o]))).subscribe((e=>null==r?void 0:r.next(Array.from(e.participants.values()))));return e.participants.size>0&&(null==r||r.next(Array.from(e.participants.values()))),i}(n,{additionalRoomEvents:e.updateOnlyOn}).subscribe(i);return()=>t.unsubscribe()}),[n,JSON.stringify(e.updateOnlyOn)]),r}function Iw(e={}){const n=xw(e),{localParticipant:r}=function(e={}){const n=hw(e.room),[r,i]=t.useState(n.localParticipant),[o,s]=t.useState(r.isMicrophoneEnabled),[a,c]=t.useState(r.isMicrophoneEnabled),[l,u]=t.useState(r.lastMicrophoneError),[d,h]=t.useState(r.lastCameraError),[p,f]=t.useState(r.isMicrophoneEnabled),[m,g]=t.useState(void 0),[v,y]=t.useState(void 0),b=e=>{c(e.isCameraEnabled),s(e.isMicrophoneEnabled),f(e.isScreenShareEnabled),y(e.cameraTrack),g(e.microphoneTrack),u(e.participant.lastMicrophoneError),h(e.participant.lastCameraError),i(e.participant)};return t.useEffect((()=>{const e=bb(r).subscribe(b);return()=>e.unsubscribe()}),[r]),{isMicrophoneEnabled:o,isScreenShareEnabled:p,isCameraEnabled:a,microphoneTrack:m,cameraTrack:v,lastMicrophoneError:l,lastCameraError:d,localParticipant:r}}(e);return[r,...n]}function Rw({room:e,props:n}){const r=hw(e),{className:i,roomAudioPlaybackAllowedObservable:o,handleStartAudioPlayback:s}=t.useMemo((()=>function(){return{className:gb("start-audio-button"),roomAudioPlaybackAllowedObservable:fb,handleStartAudioPlayback:e=>nb(this,null,(function*(){cb.info("Start Audio for room: ",e),yield e.startAudio()}))}}()),[]),a=t.useMemo((()=>o(r)),[r,o]),{canPlayAudio:c}=Qb(a,{canPlayAudio:r.canPlaybackAudio});return{mergedProps:t.useMemo((()=>mw(n,{className:i,onClick:()=>{s(r)},style:{display:c?"none":"block"}})),[n,i,c,s,r]),canPlayAudio:c}}function Pw({props:e}){const{dispatch:n,state:r}=nw().widget,{className:i}=t.useMemo((()=>({className:[gb("button"),gb("chat-toggle")].join(" ")})),[]);return{mergedProps:t.useMemo((()=>mw(e,{className:i,onClick:()=>{n&&n({msg:"toggle_chat"})},"aria-pressed":(null==r?void 0:r.showChat)?"true":"false","data-lk-unread-msgs":r?r.unreadMessages<10?r.unreadMessages.toFixed(0):"9+":"0"})),[e,i,n,r])}}function Ow(e,n={}){var r,i,o,s;let a=ow();const c=null!=(i=null!=(r=aw())?r:n.participant)?i:null==a?void 0:a.participant;if("string"===typeof e){if(!c)throw Error("Participant missing, either provide it via context or pass it in directly");a={participant:c,source:e}}else{if(!e)throw Error("No track reference found, either provide it via context or pass it in directly");a=e}const{className:l,mediaMutedObserver:u}=t.useMemo((()=>function(e){let t="track-muted-indicator-camera";switch(e.source){case Tf.Source.Camera:t="track-muted-indicator-camera";break;case Tf.Source.Microphone:t="track-muted-indicator-microphone"}return{className:gb(t),mediaMutedObserver:kb(e)}}(a)),[sb(a)]);return{isMuted:Qb(u,!(!(null==(o=a.publication)?void 0:o.isMuted)&&!(null==(s=a.participant.getTrack(a.source))?void 0:s.isMuted))),className:l}}function Mw(e){var n,r=e,{source:i,onChange:o,initialState:s,captureOptions:a}=r,c=Kb(r,["source","onChange","initialState","captureOptions"]);const l=dw(),u=null==(n=null==l?void 0:l.localParticipant)?void 0:n.getTrack(i),{toggle:d,className:h,pendingObserver:p,enabledObserver:f}=t.useMemo((()=>l?function(e,t,n){const{localParticipant:r}=t,i=(e,t)=>{let n=!1;switch(e){case Tf.Source.Camera:n=t.isCameraEnabled;break;case Tf.Source.Microphone:n=t.isMicrophoneEnabled;break;case Tf.Source.ScreenShare:n=t.isScreenShareEnabled}return n},o=bb(r).pipe(dy((t=>i(e,t.participant))),Fy(i(e,r))),s=new jy;return{className:gb("button"),toggle:(t,i)=>nb(this,null,(function*(){try{switch(null!=i||(i=n),s.next(!0),e){case Tf.Source.Camera:yield r.setCameraEnabled(null!=t?t:!r.isCameraEnabled,i);break;case Tf.Source.Microphone:yield r.setMicrophoneEnabled(null!=t?t:!r.isMicrophoneEnabled,i);break;case Tf.Source.ScreenShare:yield r.setScreenShareEnabled(null!=t?t:!r.isScreenShareEnabled,i)}}finally{s.next(!1)}})),enabledObserver:o,pendingObserver:s.asObservable()}}(i,l,a):function(){let e=!1;const t=new jy,n=new jy;return{className:gb("button"),toggle:r=>{n.next(!0),e=null!=r?r:!e,t.next(e),n.next(!1)},enabledObserver:t.asObservable(),pendingObserver:n.asObservable()}}()),[l,i,JSON.stringify(a)]),m=Qb(p,!1),g=Qb(f,null!=s?s:!!(null==u?void 0:u.isEnabled));t.useEffect((()=>{null==o||o(g)}),[g,o]),t.useEffect((()=>{void 0!==s&&(cb.debug("forcing initial toggle state",i,s),d(s))}),[]);const v=t.useMemo((()=>mw(c,{className:h})),[c,h]),y=t.useCallback((e=>{var t;d(),null==(t=c.onClick)||t.call(c,e)}),[c,d]);return{toggle:d,enabled:g,pending:m,track:u,buttonProps:Yb(Gb({},v),{"aria-pressed":g,"data-lk-source":i,"data-lk-enabled":g,disabled:m,onClick:y})}}function Nw(e){const n=uw(),[r,i]=t.useState(),o=Qb(null==r?void 0:r.isSendingObservable,!1),s=Qb(null==r?void 0:r.messageObservable,[]);return t.useEffect((()=>{const t=function(e,t){var n,r;const i=new jy,{messageDecoder:o,messageEncoder:s,channelTopic:a}=null!=t?t:{},c=null!=a?a:Cb.CHAT;let l=!1;Pb.has(e)||(l=!0);const u=null!=(n=Pb.get(e))?n:new Map,d=null!=(r=u.get(c))?r:new jy;if(u.set(c,d),Pb.set(e,u),l){const{messageObservable:t}=xb(e,c);t.pipe(qy(i)).subscribe(d)}const h=null!=o?o:Mb,p=d.pipe(dy((e=>{const t=h(e.payload);return eb(Zy({},t),{from:e.from})})),$y(((e,t)=>[...e,t]),[]),qy(i)),f=new Wy(!1),m=null!=s?s:Ob;return e.once(mp.Disconnected,(function(){i.next(),i.complete(),Pb.clear()})),{messageObservable:p,isSendingObservable:f,send:t=>nb(this,null,(function*(){const n=Date.now(),r=m({message:t,timestamp:n});f.next(!0);try{yield _b(e.localParticipant,r,c,{kind:ad.RELIABLE}),d.next({payload:r,topic:c,from:e.localParticipant})}finally{f.next(!1)}}))}}(n,e);i(t)}),[n,e]),{send:null==r?void 0:r.send,chatMessages:s,isSending:o}}function Aw(e={}){var n;const[r,i]=t.useState(function(e,t=!1){var n,r,i,o,s,a,c;const l={videoEnabled:null!=(n=null==e?void 0:e.videoEnabled)?n:Lb.videoEnabled,audioEnabled:null!=(r=null==e?void 0:e.audioEnabled)?r:Lb.audioEnabled,videoDeviceId:null!=(i=null==e?void 0:e.videoDeviceId)?i:Lb.videoDeviceId,audioDeviceId:null!=(o=null==e?void 0:e.audioDeviceId)?o:Lb.audioDeviceId,username:null!=(s=null==e?void 0:e.username)?s:Lb.username,e2ee:null!=(a=null==e?void 0:e.e2ee)?a:Lb.e2ee,sharedPassphrase:null!=(c=null==e?void 0:e.sharedPassphrase)?c:Lb.sharedPassphrase};if(t)return l;{const e=Ub();return Zy(Zy({},l),null!=e?e:{})}}(e.defaults,null!=(n=e.preventLoad)&&n)),o=t.useCallback((e=>{i((t=>Yb(Gb({},t),{audioEnabled:e})))}),[]),s=t.useCallback((e=>{i((t=>Yb(Gb({},t),{videoEnabled:e})))}),[]),a=t.useCallback((e=>{i((t=>Yb(Gb({},t),{audioDeviceId:e})))}),[]),c=t.useCallback((e=>{i((t=>Yb(Gb({},t),{videoDeviceId:e})))}),[]),l=t.useCallback((e=>{i((t=>Yb(Gb({},t),{username:e})))}),[]);return t.useEffect((()=>{var t;!function(e,t=!1){if(!0===t)return;const n=e,{e2ee:r,sharedPassphrase:i}=n,o=tb(n,["e2ee","sharedPassphrase"]);Fb(o)}(r,null!=(t=e.preventSave)&&t)}),[r,e.preventSave]),{userChoices:r,saveAudioInputEnabled:o,saveVideoInputEnabled:s,saveAudioInputDeviceId:a,saveVideoInputDeviceId:c,saveUsername:l}}function Dw(e){const{mergedProps:n}=Pw({props:e});return t.createElement("button",Gb({},n),e.children)}function Lw(e){const{buttonProps:n}=vw(e);return t.createElement("button",Gb({},n),e.children)}var Uw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),t.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),t.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Fw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),t.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Bw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},e),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),jw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),zw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),t.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),t.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),Vw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),t.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),t.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),Ww=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),qw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("g",{opacity:.25},t.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),$w=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("g",{opacity:.25},t.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),Hw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),t.createElement("g",{opacity:.25},t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),Jw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},e),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),Gw=e=>t.createElement("svg",Gb({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},e),t.createElement("g",{fill:"currentColor"},t.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),t.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"})));function Yw(e){var n=e,{kind:r,initialSelection:i,onActiveDeviceChange:o,onDeviceListChange:s,onDeviceSelectError:a,exactMatch:c,track:l,requestPermissions:u,onError:d}=n,h=Kb(n,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const p=dw(),f=t.useCallback((e=>{p&&p.emit(mp.MediaDevicesError,e),null==d||d(e)}),[p,d]),{devices:m,activeDeviceId:g,setActiveMediaDevice:v,className:y}=function({kind:e,room:n,track:r,requestPermissions:i,onError:o}){const s=dw(),a=Qb(t.useMemo((()=>pb(e,o,i)),[e,i,o]),[]),[c,l]=t.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:h}=t.useMemo((()=>Sb(e,null!=n?n:s,r)),[e,n,s,r]);return t.useEffect((()=>{const e=d.subscribe((e=>{cb.info("setCurrentDeviceId",e),e&&l(e)}));return()=>{null==e||e.unsubscribe()}}),[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:h}}({kind:r,room:p,track:l,requestPermissions:u,onError:f});t.useEffect((()=>{void 0!==i&&v(i)}),[v]),t.useEffect((()=>{"function"===typeof s&&s(m)}),[s,m]),t.useEffect((()=>{g&&""!==g&&(null==o||o(g))}),[g]);const b=e=>Xb(this,null,(function*(){try{yield v(e,{exact:c})}catch(t){if(!(t instanceof Error))throw t;null==a||a(t)}})),w=t.useMemo((()=>Tw(h,{className:y},{className:"lk-list"})),[y,h]);function k(e,t,n){return e===t||0===n&&"default"===t}return t.createElement("ul",Gb({},w),m.map(((e,n)=>t.createElement("li",{key:e.deviceId,id:e.deviceId,"data-lk-active":k(e.deviceId,g,n),"aria-selected":k(e.deviceId,g,n),role:"option"},t.createElement("button",{className:"lk-button",onClick:()=>b(e.deviceId)},e.label)))))}function Kw(e,n){switch(e){case Tf.Source.Microphone:return n?t.createElement(Vw,null):t.createElement(zw,null);case Tf.Source.Camera:return n?t.createElement(Fw,null):t.createElement(Uw,null);case Tf.Source.ScreenShare:return n?t.createElement(Gw,null):t.createElement(Jw,null);default:return}}function Xw(e){var n=e,{showIcon:r}=n,i=Kb(n,["showIcon"]);const{buttonProps:o,enabled:s}=Mw(i);return t.createElement("button",Gb({},o),(null==r||r)&&Kw(i.source,s),i.children)}function Qw(e){var n;const{className:r,quality:i}=function(e={}){const n=cw(e.participant),{className:r,connectionQualityObserver:i}=t.useMemo((()=>Tb(n)),[n]);return{className:r,quality:Qb(i,xg.Unknown)}}(e),o=t.useMemo((()=>Yb(Gb({},Tw(e,{className:r})),{"data-lk-quality":i})),[i,e,r]);return t.createElement("div",Gb({},o),null!=(n=e.children)?n:function(e){switch(e){case xg.Excellent:return t.createElement(Ww,null);case xg.Good:return t.createElement(qw,null);case xg.Poor:return t.createElement($w,null);default:return t.createElement(Hw,null)}}(i))}function Zw(e){var n=e,{participant:r}=n,i=Kb(n,["participant"]);const o=cw(r),{className:s,infoObserver:a}=t.useMemo((()=>Eb(o)),[o]),{identity:c,name:l}=Qb(a,{name:o.name,identity:o.identity,metadata:o.metadata}),u=t.useMemo((()=>Tw(i,{className:s,"data-lk-participant-name":l})),[i,s,l]);return t.createElement("span",Gb({},u),""!==l?l:c,i.children)}function ek(e){var n,r,i=e,{source:o,participant:s,trackRef:a,show:c="always"}=i,l=Kb(i,["source","participant","trackRef","show"]);const{className:u,isMuted:d}=Ow(null!=a?a:o,{participant:s}),h="always"===c||"muted"===c&&d||"unmuted"===c&&!d,p=t.useMemo((()=>Tw(l,{className:u})),[u,l]);return h?t.createElement("div",Yb(Gb({},p),{"data-lk-muted":d}),null!=(r=l.children)?r:Kw(null!=(n=null==a?void 0:a.source)?n:o,!d)):null}function tk(e){var n,r,i,o,s,a,c,l,u,d,h=e,{trackRef:p,onSubscriptionStatusChanged:f,volume:m,source:g,name:v,publication:y,participant:b}=h,w=Kb(h,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]);const k=ow(),S=null!=(o=null!=(i=null==(n=null==p?void 0:p.publication)?void 0:n.trackName)?i:null==(r=null==k?void 0:k.publication)?void 0:r.trackName)?o:v,T=null!=(a=null!=(s=null==p?void 0:p.source)?s:null==k?void 0:k.source)?a:g,E=null!=(l=null!=(c=null==p?void 0:p.publication)?c:null==k?void 0:k.publication)?l:y,C=null!=(d=null!=(u=null==p?void 0:p.participant)?u:null==k?void 0:k.participant)?d:b;if(void 0===T)throw new Error("The AudioTrack component expects a trackRef or source property.");const _=t.useRef(null),x=cw(C),{elementProps:I,isSubscribed:R,track:P,publication:O}=Cw({source:T,name:S,participant:x,publication:E},{element:_,props:w});return t.useEffect((()=>{null==f||f(!!R)}),[R,f]),t.useEffect((()=>{void 0!==P&&void 0!==m&&(P instanceof kg?P.setVolume(m):cb.warn("Volume can only be set on remote audio tracks."))}),[m,P]),t.useEffect((()=>{void 0!==O&&void 0!==w.muted&&(O instanceof Pg?O.setEnabled(!w.muted):cb.warn("Can only call setEnabled on remote track publications."))}),[w.muted,O,P]),t.createElement("audio",Gb({ref:_},I))}function nk(e){const n=!!aw();return e.participant&&!n?t.createElement(sw.Provider,{value:e.participant},e.children):t.createElement(t.Fragment,null,e.children)}function rk({value:e,onPinChange:n,onWidgetChange:r,children:i}){const o=function(e){const[n,r]=t.useReducer(ew,lb),[i,o]=t.useReducer(Zb,ub);return null!=e?e:{pin:{dispatch:r,state:n},widget:{dispatch:o,state:i}}}(e);return t.useEffect((()=>{cb.debug("PinState Updated",{state:o.pin.state}),n&&o.pin.state&&n(o.pin.state)}),[o.pin.state,n]),t.useEffect((()=>{cb.debug("Widget Updated",{widgetState:o.widget.state}),r&&o.widget.state&&r(o.widget.state)}),[r,o.widget.state]),t.createElement(tw.Provider,{value:o},i)}function ik(e){const{room:n,htmlProps:r}=function(e){const n=Gb(Gb({},ww),e),{token:r,serverUrl:i,options:o,room:s,connectOptions:a,connect:c,audio:l,video:u,screen:d,onConnected:h,onDisconnected:p,onError:f,onMediaDeviceFailure:m,onEncryptionError:g,simulateParticipants:v}=n,y=Kb(n,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);o&&s&&cb.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[b,w]=t.useState();t.useEffect((()=>{w(null!=s?s:new Ng(o))}),[s]);const k=t.useMemo((()=>{const{className:e}={className:"lk-room-container"};return mw(y,{className:e})}),[y]);return t.useEffect((()=>{if(!b)return;const e=()=>{const e=b.localParticipant;cb.debug("trying to publish local tracks"),Promise.all([e.setMicrophoneEnabled(!!l,"boolean"!==typeof l?l:void 0),e.setCameraEnabled(!!u,"boolean"!==typeof u?u:void 0),e.setScreenShareEnabled(!!d,"boolean"!==typeof d?d:void 0)]).catch((e=>{cb.warn(e),null==f||f(e)}))},t=e=>{const t=fp.getFailure(e);null==m||m(t)},n=e=>{null==g||g(e)};return b.on(mp.SignalConnected,e).on(mp.MediaDevicesError,t).on(mp.EncryptionError,n),()=>{b.off(mp.SignalConnected,e).off(mp.MediaDevicesError,t).off(mp.EncryptionError,n)}}),[b,l,u,d,f,g,m]),t.useEffect((()=>{if(b)if(v)b.simulateParticipants({participants:{count:v},publish:{audio:!0,useRealTracks:!0}});else{if(r)return i?void(c?(cb.debug("connecting"),b.connect(i,r,a).catch((e=>{cb.warn(e),null==f||f(e)}))):(cb.debug("disconnecting because connect is false"),b.disconnect())):(cb.warn("no livekit url provided"),void(null==f||f(Error("no livekit url provided"))));cb.debug("no token yet")}}),[c,r,JSON.stringify(a),b,f,i,v]),t.useEffect((()=>{if(!b)return;const e=e=>{switch(e){case Ig.Disconnected:p&&p();break;case Ig.Connected:h&&h()}};return b.on(mp.ConnectionStateChanged,e),()=>{b.off(mp.ConnectionStateChanged,e)}}),[r,h,p,b]),t.useEffect((()=>{if(b)return()=>{cb.info("disconnecting on onmount"),b.disconnect()}}),[b]),{room:b,htmlProps:k}}(e);return t.createElement("div",Gb({},r),n&&t.createElement(lw.Provider,{value:n},t.createElement(pw.Provider,{value:e.featureFlags},e.children)))}function ok(e){var n,r,i=e,{participant:o,trackRef:s}=i,a=Kb(i,["participant","trackRef"]);const[c,l]=t.useState([]),u=null!=(n=aw())?n:o;let d=null!=(r=ow())?r:s;if(!d){if(!u)throw Error("Participant missing, provide it directly or within a context");d={participant:u,source:Tf.Source.Microphone}}const{track:h}=function(e,t={}){return Cw(e,t)}(d);return t.useEffect((()=>{if(!h||!(h instanceof ng||h instanceof kg))return;const{analyser:e,cleanup:t}=function(e,t){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},t),r=Rf();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?e.mediaStreamTrack.clone():e.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let e=0;for(const t of a)e+=Math.pow(t/255,2);return Math.sqrt(e/a.length)},analyser:s,cleanup:()=>Rd(this,void 0,void 0,(function*(){yield r.close(),n.cloneTrack&&i.stop()}))}}(h,{smoothingTimeConstant:.8,fftSize:64}),n=new Uint8Array(e.frequencyBinCount),r=setInterval((()=>{const t=(()=>{e.getByteFrequencyData(n);const t=new Array(7).fill(0);n.slice(1);for(let e=0;e<3.5;e+=1){const r=Math.floor(3.5-e);for(let i=0;i<6;i+=1)t[r]+=Math.pow(n[6*e+i]/255,2);t[r]/=6}for(let e=0;e<3.5;e+=1){const r=Math.floor(3.5+e);if(0===t[r]){for(let i=0;i<6;i+=1)t[r]+=Math.pow(n[6*e+i]/255,2);t[r]/=6}}return t.map((e=>50*e))})();l(t)}),100);return()=>{clearInterval(r),t()}}),[h]),t.createElement("svg",Yb(Gb({width:"100%",height:"100%",viewBox:"0 0 200 90"},a),{className:"lk-audio-visualizer"}),t.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),t.createElement("g",{style:{transform:"translate(65px, 0)"}},c.map(((e,n)=>t.createElement("rect",{key:n,x:10*n,y:45-e/2,width:6,height:e})))))}function sk(e){var n=e,{participants:r}=n,i=Kb(n,["participants"]);return t.createElement(t.Fragment,null,r.map((e=>t.createElement(sw.Provider,{value:e,key:e.identity},Ew(i.children)))))}function ak(e){var n=e,{participant:r,children:i,source:o,publication:s,disableSpeakingIndicator:a,onParticipantClick:c}=n,l=Kb(n,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const u=cw(r),{elementProps:d}=_w({participant:u,htmlProps:l,disableSpeakingIndicator:a,source:Tf.Source.Microphone,publication:s,onParticipantClick:c});return t.createElement("div",Gb({style:{position:"relative"}},d),t.createElement(nk,{participant:u},null!=i?i:t.createElement(t.Fragment,null,t.createElement(tk,{source:null!=o?o:Tf.Source.Microphone}),t.createElement(ok,null),t.createElement("div",{className:"lk-participant-metadata"},t.createElement("div",{className:"lk-participant-metadata-item"},t.createElement(ek,{source:Tf.Source.Microphone}),t.createElement(Zw,null)),t.createElement(Qw,{className:"lk-participant-metadata-item"})))))}function ck(e){var n,r,i,o,s=e,{entry:a,hideName:c=!1,hideTimestamp:l=!1,messageFormatter:u}=s,d=Kb(s,["entry","hideName","hideTimestamp","messageFormatter"]);const h=t.useMemo((()=>u?u(a.message):a.message),[a.message,u]),p=new Date(a.timestamp),f=navigator?navigator.language:"en-US";return t.createElement("li",Gb({className:"lk-chat-entry",title:p.toLocaleTimeString(f,{timeStyle:"full"}),"data-lk-message-origin":(null==(n=a.from)?void 0:n.isLocal)?"local":"remote"},d),(!l||!c)&&t.createElement("span",{className:"lk-meta-data"},!c&&t.createElement("strong",{className:"lk-participant-name"},null!=(o=null==(r=a.from)?void 0:r.name)?o:null==(i=a.from)?void 0:i.identity),!l&&t.createElement("span",{className:"lk-timestamp"},p.toLocaleTimeString(f,{timeStyle:"short"}))),t.createElement("span",{className:"lk-message-body"},h))}function lk(e){var n=e,{messageFormatter:r,messageDecoder:i,messageEncoder:o,channelTopic:s}=n,a=Kb(n,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const c=t.useRef(null),l=t.useRef(null),u=t.useMemo((()=>({messageDecoder:i,messageEncoder:o,channelTopic:s})),[i,o,s]),{send:d,chatMessages:h,isSending:p}=Nw(u),f=rw(),m=t.useRef(0);return t.useEffect((()=>{var e;l&&(null==(e=l.current)||e.scrollTo({top:l.current.scrollHeight}))}),[l,h]),t.useEffect((()=>{var e,t,n,r,i;if(!f||0===h.length)return;if((null==(e=f.widget.state)?void 0:e.showChat)&&h.length>0&&m.current!==(null==(t=h[h.length-1])?void 0:t.timestamp))return void(m.current=null==(n=h[h.length-1])?void 0:n.timestamp);const o=h.filter((e=>!m.current||e.timestamp>m.current)).length,{widget:s}=f;o>0&&(null==(r=s.state)?void 0:r.unreadMessages)!==o&&(null==(i=s.dispatch)||i.call(s,{msg:"unread_msg",count:o}))}),[h,null==f?void 0:f.widget]),t.createElement("div",Yb(Gb({},a),{className:"lk-chat"}),t.createElement("ul",{className:"lk-list lk-chat-messages",ref:l},a.children?h.map(((e,t)=>Ew(a.children,{entry:e,key:t,messageFormatter:r}))):h.map(((e,n,i)=>{const o=n>=1&&i[n-1].from===e.from,s=n>=1&&e.timestamp-i[n-1].timestamp<6e4;return t.createElement(ck,{key:n,hideName:o,hideTimestamp:!1!==o&&s,entry:e,messageFormatter:r})}))),t.createElement("form",{className:"lk-chat-form",onSubmit:function(e){return Xb(this,null,(function*(){e.preventDefault(),c.current&&""!==c.current.value.trim()&&d&&(yield d(c.current.value),c.current.value="",c.current.focus())}))}},t.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:p,ref:c,type:"text",placeholder:"Enter a message..."}),t.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:p},"Send")))}function uk(e){var n=e,{kind:r,initialSelection:i,onActiveDeviceChange:o,tracks:s,requestPermissions:a=!1}=n,c=Kb(n,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[l,u]=t.useState(!1),[d,h]=t.useState([]),[p,f]=t.useState(!0),m=(e,t)=>{cb.debug("handle device change"),u(!1),null==o||o(e,t)},g=t.useRef(null),v=t.useRef(null);t.useLayoutEffect((()=>{g.current&&v.current&&(d||p)&&function(e,t){return nb(this,null,(function*(){const{x:n,y:r}=yield Lv(e,t,{placement:"top",middleware:[iv(6),rv(),ov({padding:5})]});return{x:n,y:r}}))}(g.current,v.current).then((({x:e,y:t})=>{v.current&&Object.assign(v.current.style,{left:`${e}px`,top:`${t}px`})})),f(!1)}),[g,v,d,p]);const y=t.useCallback((e=>{v.current&&e.target!==g.current&&l&&function(e,t){return!e.contains(t.target)}(v.current,e)&&u(!1)}),[l,v,g]);return t.useEffect((()=>(document.addEventListener("click",y),window.addEventListener("resize",(()=>f(!0))),()=>{document.removeEventListener("click",y),window.removeEventListener("resize",(()=>f(!0)))})),[y,f]),t.createElement(t.Fragment,null,t.createElement("button",Yb(Gb({className:"lk-button lk-button-menu","aria-pressed":l},c),{onClick:()=>u(!l),ref:g}),c.children),!c.disabled&&t.createElement("div",{className:"lk-device-menu",ref:v,style:{visibility:l?"visible":"hidden"}},r?t.createElement(Yw,{initialSelection:i,onActiveDeviceChange:e=>m(r,e),onDeviceListChange:h,kind:r,track:null==s?void 0:s[r],requestPermissions:a}):t.createElement(t.Fragment,null,t.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),t.createElement(Yw,{kind:"audioinput",onActiveDeviceChange:e=>m("audioinput",e),onDeviceListChange:h,track:null==s?void 0:s.audioinput,requestPermissions:a}),t.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),t.createElement(Yw,{kind:"videoinput",onActiveDeviceChange:e=>m("videoinput",e),onDeviceListChange:h,track:null==s?void 0:s.videoinput,requestPermissions:a}))))}function dk(e){var n=e,{label:r}=n,i=Kb(n,["label"]);const o=uw(),{mergedProps:s,canPlayAudio:a}=Rw({room:o,props:i}),{mergedProps:c,canPlayVideo:l}=function({room:e,props:n}){const r=hw(e),{className:i,roomVideoPlaybackAllowedObservable:o,handleStartVideoPlayback:s}=t.useMemo((()=>Nb()),[]),a=t.useMemo((()=>o(r)),[r,o]),{canPlayVideo:c}=Qb(a,{canPlayVideo:r.canPlaybackVideo});return{mergedProps:t.useMemo((()=>mw(n,{className:i,onClick:()=>{s(r)},style:{display:c?"none":"block"}})),[n,i,c,s,r]),canPlayVideo:c}}({room:o,props:s}),u=c,{style:d}=u,h=Kb(u,["style"]);return d.display=a&&l?"none":"block",t.createElement("button",Gb({style:d},h),null!=r?r:"Start "+(a?"Video":"Audio"))}function hk(e){var n,r=e,{variation:i,controls:o,saveUserChoices:s=!0}=r,a=Kb(r,["variation","controls","saveUserChoices"]);const[c,l]=t.useState(!1),u=rw();t.useEffect((()=>{var e,t;void 0!==(null==(e=null==u?void 0:u.widget.state)?void 0:e.showChat)&&l(null==(t=null==u?void 0:u.widget.state)?void 0:t.showChat)}),[null==(n=null==u?void 0:u.widget.state)?void 0:n.showChat]);const d=function(e){const n=e=>"undefined"!==typeof window&&window.matchMedia(e).matches,[r,i]=t.useState(n(e));function o(){i(n(e))}return t.useEffect((()=>{const t=window.matchMedia(e);return o(),t.addListener?t.addListener(o):t.addEventListener("change",o),()=>{t.removeListener?t.removeListener(o):t.removeEventListener("change",o)}}),[e]),r}(`(max-width: ${c?1e3:760}px)`);null!=i||(i=d?"minimal":"verbose");const h=Gb({leave:!0},o),p=kw();p?(null!=h.camera||(h.camera=p.canPublish),null!=h.microphone||(h.microphone=p.canPublish),null!=h.screenShare||(h.screenShare=p.canPublish),null!=h.chat||(h.chat=p.canPublishData&&(null==o?void 0:o.chat))):(h.camera=!1,h.chat=!1,h.microphone=!1,h.screenShare=!1);const f=t.useMemo((()=>"minimal"===i||"verbose"===i),[i]),m=t.useMemo((()=>"textOnly"===i||"verbose"===i),[i]),g="undefined"!==typeof navigator&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia,[v,y]=t.useState(!1),b=Tw({className:"lk-control-bar"},a),{saveAudioInputEnabled:w,saveVideoInputEnabled:k,saveAudioInputDeviceId:S,saveVideoInputDeviceId:T}=Aw({preventSave:!s});return t.createElement("div",Gb({},b),h.microphone&&t.createElement("div",{className:"lk-button-group"},t.createElement(Xw,{source:Tf.Source.Microphone,showIcon:f,onChange:w},m&&"Microphone"),t.createElement("div",{className:"lk-button-group-menu"},t.createElement(uk,{kind:"audioinput",onActiveDeviceChange:(e,t)=>S(null!=t?t:"")}))),h.camera&&t.createElement("div",{className:"lk-button-group"},t.createElement(Xw,{source:Tf.Source.Camera,showIcon:f,onChange:k},m&&"Camera"),t.createElement("div",{className:"lk-button-group-menu"},t.createElement(uk,{kind:"videoinput",onActiveDeviceChange:(e,t)=>T(null!=t?t:"")}))),h.screenShare&&g&&t.createElement(Xw,{source:Tf.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:f,onChange:e=>{y(e)}},m&&(v?"Stop screen share":"Share screen")),h.chat&&t.createElement(Dw,null,f&&t.createElement(Bw,null),m&&"Chat"),h.leave&&t.createElement(Lw,null,f&&t.createElement(jw,null),m&&"Leave"),t.createElement(dk,null))}function pk(e){var n=Kb(e,[]);const[r,i]=t.useState({showChat:!1,unreadMessages:0}),o=Iw();return t.createElement(rk,{onWidgetChange:i},t.createElement("div",Gb({className:"lk-audio-conference"},n),t.createElement("div",{className:"lk-audio-conference-stage"},t.createElement(sk,{participants:o},t.createElement(ak,null))),t.createElement(hk,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),r.showChat&&t.createElement(lk,null)))}const fk=({client:e})=>{const[n,r]=(0,t.useState)([]),[i,o]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{const t=e=>{r((t=>[...t,e])),o(!0)},n=e=>{r((t=>{const n=t.filter((t=>t!==e));return 0===n.length&&o(!1),n}))};return e.on("livekitToken",t),e.on("livekitLeave",n),()=>{e.off("livekitToken",t),e.off("livekitLeave",n)}}),[e]),n.length?(0,vt.jsxs)("div",{"data-lk-theme":"default",children:[n.map(((t,n)=>(0,vt.jsx)(ik,{video:!1,audio:!0,token:t,serverUrl:"wss://mongoose-67t79p35.livekit.cloud",connect:!0,onDisconnected:()=>e.emit("livekitLeave",t),children:(0,vt.jsx)(pk,{})},n))),(0,vt.jsx)("div",{className:"audio-status","aria-live":"polite"})]}):null},mk=Object.prototype.toString;function gk(e){switch(mk.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return _k(e,Error)}}function vk(e,t){return mk.call(e)===`[object ${t}]`}function yk(e){return vk(e,"ErrorEvent")}function bk(e){return vk(e,"DOMError")}function wk(e){return vk(e,"String")}function kk(e){return null===e||"object"!==typeof e&&"function"!==typeof e}function Sk(e){return vk(e,"Object")}function Tk(e){return"undefined"!==typeof Event&&_k(e,Event)}function Ek(e){return Boolean(e&&e.then&&"function"===typeof e.then)}function Ck(e){return"number"===typeof e&&e!==e}function _k(e,t){try{return e instanceof t}catch(n){return!1}}function xk(e){return!("object"!==typeof e||null===e||!e.__isVue&&!e._isVue)}var Ik=n(748);const Rk=(0,Ik.Rf)(),Pk=80;function Ok(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,i=[];let o=0,s=0;const a=" > ",c=a.length;let l;const u=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||Pk;for(;n&&o++<r&&(l=Mk(n,u),!("html"===l||o>1&&s+i.length*c+l.length>=d));)i.push(l),s+=l.length,n=n.parentNode;return i.reverse().join(a)}catch(n){return"<unknown>"}}function Mk(e,t){const n=e,r=[];let i,o,s,a,c;if(!n||!n.tagName)return"";r.push(n.tagName.toLowerCase());const l=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(l&&l.length)l.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else if(n.id&&r.push(`#${n.id}`),i=n.className,i&&wk(i))for(o=i.split(/\s+/),c=0;c<o.length;c++)r.push(`.${o[c]}`);const u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)s=u[c],a=n.getAttribute(s),a&&r.push(`[${s}="${a}"]`);return r.join("")}const Nk="undefined"===typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Ak=["debug","info","warn","error","log","assert","trace"],Dk={};function Lk(e){if(!("console"in Ik.n2))return e();const t=Ik.n2.console,n={},r=Object.keys(Dk);r.forEach((e=>{const r=Dk[e];n[e]=t[e],t[e]=r}));try{return e()}finally{r.forEach((e=>{t[e]=n[e]}))}}const Uk=function(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return Nk?Ak.forEach((n=>{t[n]=(...t)=>{e&&Lk((()=>{Ik.n2.console[n](`Sentry Logger [${n}]:`,...t)}))}})):Ak.forEach((e=>{t[e]=()=>{}})),t}();function Fk(e,t=0){return"string"!==typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function Bk(e,t){if(!Array.isArray(e))return"";const n=[];for(let i=0;i<e.length;i++){const t=e[i];try{xk(t)?n.push("[VueViewModel]"):n.push(String(t))}catch(r){n.push("[value cannot be serialized]")}}return n.join(t)}function jk(e,t,n=!1){return!!wk(e)&&(vk(t,"RegExp")?t.test(e):!!wk(t)&&(n?e===t:e.includes(t)))}function zk(e,t=[],n=!1){return t.some((t=>jk(e,t,n)))}function Vk(e,t,n){if(!(t in e))return;const r=e[t],i=n(r);"function"===typeof i&&qk(i,r),e[t]=i}function Wk(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(r){Nk&&Uk.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function qk(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Wk(e,"__sentry_original__",t)}catch(n){}}function $k(e){return e.__sentry_original__}function Hk(e){if(gk(e))return{message:e.message,name:e.name,stack:e.stack,...Gk(e)};if(Tk(e)){const t={type:e.type,target:Jk(e.target),currentTarget:Jk(e.currentTarget),...Gk(e)};return"undefined"!==typeof CustomEvent&&_k(e,CustomEvent)&&(t.detail=e.detail),t}return e}function Jk(e){try{return t=e,"undefined"!==typeof Element&&_k(t,Element)?Ok(e):Object.prototype.toString.call(e)}catch(n){return"<unknown>"}var t}function Gk(e){if("object"===typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function Yk(e){return Kk(e,new Map)}function Kk(e,t){if(Sk(e)){const n=t.get(e);if(void 0!==n)return n;const r={};t.set(e,r);for(const i of Object.keys(e))"undefined"!==typeof e[i]&&(r[i]=Kk(e[i],t));return r}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const r=[];return t.set(e,r),e.forEach((e=>{r.push(Kk(e,t))})),r}return e}function Xk(){const e=Ik.n2,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>t.getRandomValues(new Uint8Array(1))[0])}catch(x_){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function Qk(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function Zk(e){const{message:t,event_id:n}=e;if(t)return t;const r=Qk(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function eS(e,t,n){const r=e.exception=e.exception||{},i=r.values=r.values||[],o=i[0]=i[0]||{};o.value||(o.value=t||""),o.type||(o.type=n||"Error")}function tS(e,t){const n=Qk(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r&&r.data,...t.data};n.mechanism.data=e}}function nS(e){if(e&&e.__sentry_captured__)return!0;try{Wk(e,"__sentry_captured__",!0)}catch(t){}return!1}function rS(e){return Array.isArray(e)?e:[e]}var iS=n(846);const oS="production",sS="undefined"===typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;var aS;function cS(e){return new uS((t=>{t(e)}))}function lS(e){return new uS(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"}(aS||(aS={}));class uS{constructor(e){uS.prototype.__init.call(this),uS.prototype.__init2.call(this),uS.prototype.__init3.call(this),uS.prototype.__init4.call(this),this._state=aS.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(t){this._reject(t)}}then(e,t){return new uS(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(i){r(i)}else n(t)},e=>{if(t)try{n(t(e))}catch(i){r(i)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new uS(((t,n)=>{let r,i;return this.then((t=>{i=!1,r=t,e&&e()}),(t=>{i=!0,r=t,e&&e()})).then((()=>{i?n(r):t(r)}))}))}__init(){this._resolve=e=>{this._setResult(aS.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(aS.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===aS.PENDING&&(Ek(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===aS.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===aS.RESOLVED&&e[1](this._value),this._state===aS.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function dS(){return(0,Ik.YO)("globalEventProcessors",(()=>[]))}function hS(e){dS().push(e)}function pS(e,t,n,r=0){return new uS(((i,o)=>{const s=e[r];if(null===t||"function"!==typeof s)i(t);else{const a=s({...t},n);sS&&s.id&&null===a&&Uk.log(`Event processor "${s.id}" dropped event`),Ek(a)?a.then((t=>pS(e,t,n,r+1).then(i))).then(null,o):pS(e,a,n,r+1).then(i).then(null,o)}}))}function fS(e){const t=(0,iS.ph)(),n={sid:Xk(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return Yk({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"===typeof e.did||"string"===typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(n)};return e&&mS(n,e),n}function mS(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||(0,iS.ph)(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:Xk()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"===typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"===typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"===typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}class gS{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=vS()}static clone(e){const t=new gS;return e&&(t._breadcrumbs=[...e._breadcrumbs],t._tags={...e._tags},t._extra={...e._extra},t._contexts={...e._contexts},t._user=e._user,t._level=e._level,t._span=e._span,t._session=e._session,t._transactionName=e._transactionName,t._fingerprint=e._fingerprint,t._eventProcessors=[...e._eventProcessors],t._requestSession=e._requestSession,t._attachments=[...e._attachments],t._sdkProcessingMetadata={...e._sdkProcessingMetadata},t._propagationContext={...e._propagationContext}),t}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&mS(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if("function"===typeof e){const t=e(this);return t instanceof gS?t:this}return e instanceof gS?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Sk(e)&&(this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=vS(),this}addBreadcrumb(e,t){const n="number"===typeof t?t:100;if(n<=0)return this;const r={timestamp:(0,iS.yW)(),...e},i=this._breadcrumbs;return i.push(r),this._breadcrumbs=i.length>n?i.slice(-n):i,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(e,t={},n){if(this._extra&&Object.keys(this._extra).length&&(e.extra={...this._extra,...e.extra}),this._tags&&Object.keys(this._tags).length&&(e.tags={...this._tags,...e.tags}),this._user&&Object.keys(this._user).length&&(e.user={...this._user,...e.user}),this._contexts&&Object.keys(this._contexts).length&&(e.contexts={...this._contexts,...e.contexts}),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts={trace:this._span.getTraceContext(),...e.contexts};const t=this._span.transaction;if(t){e.sdkProcessingMetadata={dynamicSamplingContext:t.getDynamicSamplingContext(),...e.sdkProcessingMetadata};const n=t.name;n&&(e.tags={transaction:n,...e.tags})}}this._applyFingerprint(e);const r=this._getBreadcrumbs(),i=[...e.breadcrumbs||[],...r];return e.breadcrumbs=i.length>0?i:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...this._sdkProcessingMetadata,propagationContext:this._propagationContext},pS([...n||[],...dS(),...this._eventProcessors],e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_getBreadcrumbs(){return this._breadcrumbs}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}_applyFingerprint(e){e.fingerprint=e.fingerprint?rS(e.fingerprint):[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}}function vS(){return{traceId:Xk(),spanId:Xk().substring(16)}}const yS="7.86.0",bS=parseFloat(yS),wS=100;class kS{constructor(e,t=new gS,n=bS){this._version=n,this._stack=[{scope:t}],e&&this.bindClient(e)}isOlderThan(e){return this._version<e}bindClient(e){this.getStackTop().client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=gS.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}withScope(e){const t=this.pushScope();try{e(t)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){const n=this._lastEventId=t&&t.event_id?t.event_id:Xk(),r=new Error("Sentry syntheticException");return this._withClient(((i,o)=>{i.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},o)})),n}captureMessage(e,t,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Xk(),i=new Error(e);return this._withClient(((o,s)=>{o.captureMessage(e,t,{originalException:e,syntheticException:i,...n,event_id:r},s)})),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:Xk();return e.type||(this._lastEventId=n),this._withClient(((r,i)=>{r.captureEvent(e,{...t,event_id:n},i)})),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){const{scope:n,client:r}=this.getStackTop();if(!r)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:o=wS}=r.getOptions&&r.getOptions()||{};if(o<=0)return;const s={timestamp:(0,iS.yW)(),...e},a=i?Lk((()=>i(s,t))):s;null!==a&&(r.emit&&r.emit("beforeAddBreadcrumb",a,t),n.addBreadcrumb(a,o))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t)}configureScope(e){const{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){const t=TS(this);try{e(this)}finally{TS(t)}}getIntegration(e){const t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(n){return sS&&Uk.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){const n=this._callExtensionMethod("startTransaction",e,t);if(sS&&!n){this.getClient()?Uk.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"):Uk.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")}return n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,t=e.getSession();t&&function(e,t){let n={};t?n={status:t}:"ok"===e.status&&(n={status:"exited"}),mS(e,n)}(t),this._sendSessionUpdate(),e.setSession()}startSession(e){const{scope:t,client:n}=this.getStackTop(),{release:r,environment:i=oS}=n&&n.getOptions()||{},{userAgent:o}=Ik.n2.navigator||{},s=fS({release:r,environment:i,user:t.getUser(),...o&&{userAgent:o},...e}),a=t.getSession&&t.getSession();return a&&"ok"===a.status&&mS(a,{status:"exited"}),this.endSession(),t.setSession(s),s}shouldSendDefaultPii(){const e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_withClient(e){const{scope:t,client:n}=this.getStackTop();n&&e(n,t)}_callExtensionMethod(e,...t){const n=SS().__SENTRY__;if(n&&n.extensions&&"function"===typeof n.extensions[e])return n.extensions[e].apply(this,t);sS&&Uk.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function SS(){return Ik.n2.__SENTRY__=Ik.n2.__SENTRY__||{extensions:{},hub:void 0},Ik.n2}function TS(e){const t=SS(),n=xS(t);return IS(t,e),n}function ES(){const e=SS();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return CS(e)}function CS(e=SS()){return _S(e)&&!xS(e).isOlderThan(bS)||IS(e,new kS),xS(e)}function _S(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function xS(e){return(0,Ik.YO)("hub",(()=>new kS),e)}function IS(e,t){if(!e)return!1;return(e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0}const RS=50,PS=/\(error: (.*)\)/,OS=/captureMessage|captureException/;function MS(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0)=>{const r=[],i=e.split("\n");for(let o=n;o<i.length;o++){const e=i[o];if(e.length>1024)continue;const n=PS.test(e)?e.replace(PS,"$1"):e;if(!n.match(/\S*Error: /)){for(const e of t){const t=e(n);if(t){r.push(t);break}}if(r.length>=RS)break}}return function(e){if(!e.length)return[];const t=Array.from(e);/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop();t.reverse(),OS.test(t[t.length-1].function||"")&&(t.pop(),OS.test(t[t.length-1].function||"")&&t.pop());return t.slice(0,RS).map((e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"})))}(r)}}const NS="<anonymous>";function AS(e){try{return e&&"function"===typeof e&&e.name||NS}catch(t){return NS}}function DS(e,t=100,n=1/0){try{return US("",e,t,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function LS(e,t=3,n=102400){const r=DS(e,t);return i=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(i))>n?LS(e,t-1,n):r;var i}function US(e,t,r=1/0,i=1/0,o=function(){const e="function"===typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[s,a]=o;if(null==t||["number","boolean","string"].includes(typeof t)&&!Ck(t))return t;const c=function(e,t){try{if("domain"===e&&t&&"object"===typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!==typeof n.g&&t===n.g)return"[Global]";if("undefined"!==typeof window&&t===window)return"[Window]";if("undefined"!==typeof document&&t===document)return"[Document]";if(xk(t))return"[VueViewModel]";if(Sk(r=t)&&"nativeEvent"in r&&"preventDefault"in r&&"stopPropagation"in r)return"[SyntheticEvent]";if("number"===typeof t&&t!==t)return"[NaN]";if("function"===typeof t)return`[Function: ${AS(t)}]`;if("symbol"===typeof t)return`[${String(t)}]`;if("bigint"===typeof t)return`[BigInt: ${String(t)}]`;const i=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(i)?`[HTMLElement: ${i}]`:`[object ${i}]`}catch(i){return`**non-serializable** (${i})`}var r}(e,t);if(!c.startsWith("[object "))return c;if(t.__sentry_skip_normalization__)return t;const l="number"===typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:r;if(0===l)return c.replace("object ","");if(s(t))return"[Circular ~]";const u=t;if(u&&"function"===typeof u.toJSON)try{return US("",u.toJSON(),l-1,i,o)}catch(f){}const d=Array.isArray(t)?[]:{};let h=0;const p=Hk(t);for(const n in p){if(!Object.prototype.hasOwnProperty.call(p,n))continue;if(h>=i){d[n]="[MaxProperties ~]";break}const e=p[n];d[n]=US(n,e,l-1,i,o),h++}return a(t),d}function FS(e,t,n,r,i){const{normalizeDepth:o=3,normalizeMaxBreadth:s=1e3}=e,a={...t,event_id:t.event_id||n.event_id||Xk(),timestamp:t.timestamp||(0,iS.yW)()},c=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:i,maxValueLength:o=250}=t;"environment"in e||(e.environment="environment"in t?n:oS);void 0===e.release&&void 0!==r&&(e.release=r);void 0===e.dist&&void 0!==i&&(e.dist=i);e.message&&(e.message=Fk(e.message,o));const s=e.exception&&e.exception.values&&e.exception.values[0];s&&s.value&&(s.value=Fk(s.value,o));const a=e.request;a&&a.url&&(a.url=Fk(a.url,o))}(a,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(a,c),void 0===t.type&&function(e,t){const n=Ik.n2._sentryDebugIds;if(!n)return;let r;const i=BS.get(t);i?r=i:(r=new Map,BS.set(t,r));const o=Object.keys(n).reduce(((e,i)=>{let o;const s=r.get(i);s?o=s:(o=t(i),r.set(i,o));for(let t=o.length-1;t>=0;t--){const r=o[t];if(r.filename){e[r.filename]=n[i];break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=o[e.filename])}))}))}catch(s){}}(a,e.stackParser);let l=r;n.captureContext&&(l=gS.clone(l).update(n.captureContext)),n.mechanism&&tS(a,n.mechanism);let u=cS(a);const d=i&&i.getEventProcessors?i.getEventProcessors():[];if(l){if(l.getAttachments){const e=[...n.attachments||[],...l.getAttachments()];e.length&&(n.attachments=e)}u=l.applyToEvent(a,n,d)}else u=pS([...d,...dS()],a,n);return u.then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(r){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach((e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})}))}(e),"number"===typeof o&&o>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:DS(e.data,t,n)}})))},...e.user&&{user:DS(e.user,t,n)},...e.contexts&&{contexts:DS(e.contexts,t,n)},...e.extra&&{extra:DS(e.extra,t,n)}};e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=DS(e.contexts.trace.data,t,n)));e.spans&&(r.spans=e.spans.map((e=>(e.data&&(e.data=DS(e.data,t,n)),e))));return r}(e,o,s):e)))}const BS=new WeakMap;function jS(e){if(e)return function(e){return e instanceof gS||"function"===typeof e}(e)||function(e){return Object.keys(e).some((e=>zS.includes(e)))}(e)?{captureContext:e}:e}const zS=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function VS(e,t){return ES().captureException(e,jS(t))}function WS(e){ES().withScope(e)}function qS(){return ES().getClient()}const $S=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],HS=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/];class JS{static __initStatic(){this.id="InboundFilters"}constructor(e={}){this.name=JS.id,this._options=e}setupOnce(e,t){}processEvent(e,t,n){const r=n.getOptions(),i=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:$S],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:HS],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(this._options,r);return function(e,t){if(t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(t){}return!1}(e))return sS&&Uk.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${Zk(e)}`),!0;if(function(e,t){if(e.type||!t||!t.length)return!1;return function(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch(r){}n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`));sS&&0===t.length&&Uk.error(`Could not extract message for event ${Zk(e)}`);return t}(e).some((e=>zk(e,t)))}(e,t.ignoreErrors))return sS&&Uk.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${Zk(e)}`),!0;if(function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&zk(n,t)}(e,t.ignoreTransactions))return sS&&Uk.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${Zk(e)}`),!0;if(function(e,t){if(!t||!t.length)return!1;const n=GS(e);return!!n&&zk(n,t)}(e,t.denyUrls))return sS&&Uk.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${Zk(e)}.\nUrl: ${GS(e)}`),!0;if(!function(e,t){if(!t||!t.length)return!0;const n=GS(e);return!n||zk(n,t)}(e,t.allowUrls))return sS&&Uk.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${Zk(e)}.\nUrl: ${GS(e)}`),!0;return!1}(e,i)?null:e}}function GS(e){try{let n;try{n=e.exception.values[0].stacktrace.frames}catch(t){}return n?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(n):null}catch(n){return sS&&Uk.error(`Cannot extract url for event ${Zk(e)}`),null}}let YS;JS.__initStatic();class KS{static __initStatic(){this.id="FunctionToString"}constructor(){this.name=KS.id}setupOnce(){YS=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=$k(this)||this;return YS.apply(t,e)}}catch(e){}}}KS.__initStatic();const XS=[];function QS(e){const t=e.defaultIntegrations||[],n=e.integrations;let r;t.forEach((e=>{e.isDefaultInstance=!0})),r=Array.isArray(n)?[...t,...n]:"function"===typeof n?rS(n(t)):t;const i=function(e){const t={};return e.forEach((e=>{const{name:n}=e,r=t[n];r&&!r.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)})),Object.keys(t).map((e=>t[e]))}(r),o=function(e,t){for(let n=0;n<e.length;n++)if(!0===t(e[n]))return n;return-1}(i,(e=>"Debug"===e.name));if(-1!==o){const[e]=i.splice(o,1);i.push(e)}return i}function ZS(e,t,n){if(n[t.name]=t,-1===XS.indexOf(t.name)&&(t.setupOnce(hS,ES),XS.push(t.name)),t.setup&&"function"===typeof t.setup&&t.setup(e),e.on&&"function"===typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if(e.addEventProcessor&&"function"===typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}sS&&Uk.log(`Integration installed: ${t.name}`)}const eT=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function tT(e,t=!1){const{host:n,path:r,pass:i,port:o,projectId:s,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&i?`:${i}`:""}@${n}${o?`:${o}`:""}/${r?`${r}/`:r}${s}`}function nT(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function rT(e){const t="string"===typeof e?function(e){const t=eT.exec(e);if(!t)return void Lk((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,i="",o,s="",a]=t.slice(1);let c="",l=a;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const e=l.match(/^\d+/);e&&(l=e[0])}return nT({host:o,pass:i,path:c,projectId:l,port:s,protocol:n,publicKey:r})}(e):nT(e);if(t&&function(e){if(!Nk)return!0;const{port:t,projectId:n,protocol:r}=e;return!["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(Uk.error(`Invalid Sentry Dsn: ${t} missing`),!0)))&&(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?!t||!isNaN(parseInt(t,10))||(Uk.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):(Uk.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(Uk.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1))}(t))return t}const iT="7";function oT(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function sT(e,t){return n={sentry_key:e.publicKey,sentry_version:iT,...t&&{sentry_client:`${t.name}/${t.version}`}},Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&");var n}function aT(e,t={}){const n="string"===typeof t?t:t.tunnel,r="string"!==typeof t&&t._metadata?t._metadata.sdk:void 0;return n||`${function(e){return`${oT(e)}${e.projectId}/envelope/`}(e)}?${sT(e,r)}`}const cT=(0,Ik.Rf)();function lT(){if(!("fetch"in cT))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function uT(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}const dT=(0,Ik.Rf)();const hT={},pT={};function fT(e,t){hT[e]=hT[e]||[],hT[e].push(t)}function mT(e,t){pT[e]||(t(),pT[e]=!0)}function gT(e,t){const n=e&&hT[e];if(n)for(const i of n)try{i(t)}catch(r){Nk&&Uk.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${AS(i)}\nError:`,r)}}const vT=Ik.n2;let yT;function bT(e){const t="history";fT(t,e),mT(t,wT)}function wT(){if(!function(){const e=dT.chrome,t=e&&e.app&&e.app.runtime,n="history"in dT&&!!dT.history.pushState&&!!dT.history.replaceState;return!t&&n}())return;const e=vT.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=yT,t=String(n);yT=t;gT("history",{from:e,to:t})}return e.apply(this,t)}}vT.onpopstate=function(...t){const n=vT.location.href,r=yT;yT=n;if(gT("history",{from:r,to:n}),e)try{return e.apply(this,t)}catch(i){}},Vk(vT.history,"pushState",t),Vk(vT.history,"replaceState",t)}function kT(e,t=[]){return[e,t]}function ST(e,t){const[n,r]=e;return[n,[...r,t]]}function TT(e,t){const n=e[1];for(const r of n){if(t(r,r[0].type))return!0}return!1}function ET(e,t){return(t||new TextEncoder).encode(e)}function CT(e,t){const[n,r]=e;let i=JSON.stringify(n);function o(e){"string"===typeof i?i="string"===typeof e?i+e:[ET(i,t),e]:i.push("string"===typeof e?ET(e,t):e)}for(const a of r){const[e,t]=a;if(o(`\n${JSON.stringify(e)}\n`),"string"===typeof t||t instanceof Uint8Array)o(t);else{let e;try{e=JSON.stringify(t)}catch(s){e=JSON.stringify(DS(t))}o(e)}}return"string"===typeof i?i:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return n}(i)}function _T(e,t){const n="string"===typeof e.data?ET(e.data,t):e.data;return[Yk({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}const xT={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function IT(e){return xT[e]}function RT(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function PT(e,t,n,r){const i=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:tT(r)},...i&&{trace:Yk({...i})}}}class OT extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}function MT(e,t,n){const r=t.getOptions(),{publicKey:i}=t.getDsn()||{},{segment:o}=n&&n.getUser()||{},s=Yk({environment:r.environment||oS,release:r.release,user_segment:o,public_key:i,trace_id:e});return t.emit&&t.emit("createDsc",s),s}const NT="Not capturing exception because it's already been captured.";class AT{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=rT(e.dsn):sS&&Uk.warn("No DSN provided, client will not send events."),this._dsn){const t=aT(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){if(nS(e))return void(sS&&Uk.log(NT));let r=t&&t.event_id;return this._process(this.eventFromException(e,t).then((e=>this._captureEvent(e,t,n))).then((e=>{r=e}))),r}captureMessage(e,t,n,r){let i=n&&n.event_id;const o=kk(e)?this.eventFromMessage(String(e),t,n):this.eventFromException(e,n);return this._process(o.then((e=>this._captureEvent(e,n,r))).then((e=>{i=e}))),i}captureEvent(e,t,n){if(t&&t.originalException&&nS(t.originalException))return void(sS&&Uk.log(NT));let r=t&&t.event_id;return this._process(this._captureEvent(e,t,n).then((e=>{r=e}))),r}captureSession(e){"string"!==typeof e.release?sS&&Uk.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),mS(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e)))):cS(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&(this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&ZS(e,t,n)})),n}(this,this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return sS&&Uk.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){ZS(this,e,this._integrations)}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=function(e,t,n,r){const i=RT(n),o=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const s=PT(e,i,r,t);return delete e.sdkProcessingMetadata,kT(s,[[{type:o},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of t.attachments||[])n=ST(n,_T(i,this._options.transportOptions&&this._options.transportOptions.textEncoder));const r=this._sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=function(e,t,n,r){const i=RT(n);return kT({sent_at:(new Date).toISOString(),...i&&{sdk:i},...!!r&&t&&{dsn:tT(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const n=`${e}:${t}`;sS&&Uk.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach((e=>e(...t)))}_updateSessionFromEvent(e,t){let n=!1,r=!1;const i=t.exception&&t.exception.values;if(i){r=!0;for(const e of i){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const o="ok"===e.status;(o&&0===e.errors||o&&n)&&(mS(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new uS((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n){const r=this.getOptions(),i=Object.keys(this._integrations);return!t.integrations&&i.length>0&&(t.integrations=i),this.emit("preprocessEvent",e,t),FS(r,e,t,n,this).then((e=>{if(null===e)return e;const{propagationContext:t}=e.sdkProcessingMetadata||{};if(!(e.contexts&&e.contexts.trace)&&t){const{traceId:r,spanId:i,parentSpanId:o,dsc:s}=t;e.contexts={trace:{trace_id:r,span_id:i,parent_span_id:o},...e.contexts};const a=s||MT(r,this,n);e.sdkProcessingMetadata={dynamicSamplingContext:a,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if(sS){const t=e;"log"===t.logLevel?Uk.log(t.message):Uk.warn(t)}}))}_processEvent(e,t,n){const r=this.getOptions(),{sampleRate:i}=r,o=LT(e),s=DT(e),a=e.type||"error",c=`before send for type \`${a}\``;if(s&&"number"===typeof i&&Math.random()>i)return this.recordDroppedEvent("sample_rate","error",e),lS(new OT(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));const l="replay_event"===a?"replay":a;return this._prepareEvent(e,t,n).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new OT("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const i=function(e,t,n){const{beforeSend:r,beforeSendTransaction:i}=e;if(DT(t)&&r)return r(t,n);if(LT(t)&&i)return i(t,n);return t}(r,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(Ek(e))return e.then((e=>{if(!Sk(e)&&null!==e)throw new OT(n);return e}),(e=>{throw new OT(`${t} rejected with ${e}`)}));if(!Sk(e)&&null!==e)throw new OT(n);return e}(i,c)})).then((r=>{if(null===r)throw this.recordDroppedEvent("before_send",l,e),new OT(`${c} returned \`null\`, will not send event.`,"log");const i=n&&n.getSession();!o&&i&&this._updateSessionFromEvent(i,r);const s=r.transaction_info;if(o&&s&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...s,source:e}}return this.sendEvent(r,t),r})).then(null,(e=>{if(e instanceof OT)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new OT(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,(e=>{sS&&Uk.error("Error while sending event:",e)}));sS&&Uk.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map((t=>{const[n,r]=t.split(":");return{reason:n,category:r,quantity:e[t]}}))}}function DT(e){return void 0===e.type}function LT(e){return"transaction"===e.type}var UT=n(900);const FT="undefined"===typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function BT(e,t){const n=zT(e,t),r={type:t&&t.name,value:WT(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function jT(e,t){return{exception:{values:[BT(e,t)]}}}function zT(e,t){const n=t.stacktrace||t.stack||"",r=function(e){if(e){if("number"===typeof e.framesToPop)return e.framesToPop;if(VT.test(e.message))return 1}return 0}(t);try{return e(n,r)}catch(i){}return[]}const VT=/Minified React error #\d+;/i;function WT(e){const t=e&&e.message;return t?t.error&&"string"===typeof t.error.message?t.error.message:t:"No error message"}function qT(e,t,n,r,i){let o;if(yk(t)&&t.error){return jT(e,t.error)}if(bk(t)||vk(t,"DOMException")){const i=t;if("stack"in t)o=jT(e,t);else{const t=i.name||(bk(i)?"DOMError":"DOMException"),s=i.message?`${t}: ${i.message}`:t;o=$T(e,s,n,r),eS(o,s)}return"code"in i&&(o.tags={...o.tags,"DOMException.code":`${i.code}`}),o}if(gk(t))return jT(e,t);if(Sk(t)||Tk(t)){return o=function(e,t,n,r){const i=ES().getClient(),o=i&&i.getOptions().normalizeDepth,s={exception:{values:[{type:Tk(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:HT(t,{isUnhandledRejection:r})}]},extra:{__serialized__:LS(t,o)}};if(n){const t=zT(e,n);t.length&&(s.exception.values[0].stacktrace={frames:t})}return s}(e,t,n,i),tS(o,{synthetic:!0}),o}return o=$T(e,t,n,r),eS(o,`${t}`,void 0),tS(o,{synthetic:!0}),o}function $T(e,t,n,r){const i={message:t};if(r&&n){const r=zT(e,n);r.length&&(i.exception={values:[{value:t,stacktrace:{frames:r}}]})}return i}function HT(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(Hk(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return Fk(n[0],t);for(let r=n.length;r>0;r--){const e=n.slice(0,r).join(", ");if(!(e.length>t))return r===n.length?e:Fk(e,t)}return""}(e),r=t?"promise rejection":"exception";if(yk(e))return`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``;if(Tk(e)){return`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(t){}}(e)}\` (type=${e.type}) captured as ${r}`}return`Object captured as ${r} with keys: ${n}`}const JT=Ik.n2;let GT=0;function YT(){return GT>0}function KT(e,t={},n){if("function"!==typeof e)return e;try{const t=e.__sentry_wrapped__;if(t)return t;if($k(e))return e}catch(i){return e}const r=function(){const r=Array.prototype.slice.call(arguments);try{n&&"function"===typeof n&&n.apply(this,arguments);const i=r.map((e=>KT(e,t)));return e.apply(this,i)}catch(i){throw GT++,setTimeout((()=>{GT--})),WS((e=>{e.addEventProcessor((e=>(t.mechanism&&(eS(e,void 0,void 0),tS(e,t.mechanism)),e.extra={...e.extra,arguments:r},e))),VS(i)})),i}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}catch(o){}qk(r,e),Wk(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:()=>e.name})}catch(o){}return r}class XT extends AT{constructor(e){const t=JT.SENTRY_SDK_SOURCE||(0,UT.S)();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${t}:@sentry/browser`,version:yS}],version:yS},super(e),e.sendClientReports&&JT.document&&JT.document.addEventListener("visibilitychange",(()=>{"hidden"===JT.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return function(e,t,n,r){const i=qT(e,t,n&&n.syntheticException||void 0,r);return tS(i),i.level="error",n&&n.event_id&&(i.event_id=n.event_id),cS(i)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,i){const o=$T(e,t,r&&r.syntheticException||void 0,i);return o.level=n,r&&r.event_id&&(o.event_id=r.event_id),cS(o)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(FT&&Uk.warn("SDK not enabled, will not capture user feedback."));const t=function(e,{metadata:t,tunnel:n,dsn:r}){const i={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:tT(r)}},o=function(e){return[{type:"user_report"},e]}(e);return kT(i,[o])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}_flushOutcomes(){const e=this._clearOutcomes();if(0===e.length)return void(FT&&Uk.log("No outcomes to send"));if(!this._dsn)return void(FT&&Uk.log("No dsn provided, will not send outcomes"));FT&&Uk.log("Sending outcomes:",e);const t=(n=e,kT((r=this._options.tunnel&&tT(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:i||(0,iS.yW)(),discarded_events:n}]]));var n,r,i;this._sendEnvelope(t)}}let QT=null;function ZT(e){const t="error";fT(t,e),mT(t,eE)}function eE(){QT=Ik.n2.onerror,Ik.n2.onerror=function(e,t,n,r,i){return gT("error",{column:r,error:i,line:n,msg:e,url:t}),!(!QT||QT.__SENTRY_LOADER__)&&QT.apply(this,arguments)},Ik.n2.onerror.__SENTRY_INSTRUMENTED__=!0}let tE=null;function nE(e){const t="unhandledrejection";fT(t,e),mT(t,rE)}function rE(){tE=Ik.n2.onunhandledrejection,Ik.n2.onunhandledrejection=function(e){return gT("unhandledrejection",e),!(tE&&!tE.__SENTRY_LOADER__)||tE.apply(this,arguments)},Ik.n2.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}class iE{static __initStatic(){this.id="GlobalHandlers"}constructor(e){this.name=iE.id,this._options={onerror:!0,onunhandledrejection:!0,...e},this._installFunc={onerror:oE,onunhandledrejection:sE}}setupOnce(){Error.stackTraceLimit=50;const e=this._options;for(const n in e){const r=this._installFunc[n];r&&e[n]&&(t=n,FT&&Uk.log(`Global Handler attached: ${t}`),r(),this._installFunc[n]=void 0)}var t}}function oE(){ZT((e=>{const[t,n,r]=cE();if(!t.getIntegration(iE))return;const{msg:i,url:o,line:s,column:a,error:c}=e;if(YT())return;const l=void 0===c&&wk(i)?function(e,t,n,r){const i=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let o=yk(e)?e.message:e,s="Error";const a=o.match(i);a&&(s=a[1],o=a[2]);const c={exception:{values:[{type:s,value:o}]}};return aE(c,t,n,r)}(i,o,s,a):aE(qT(n,c||i,void 0,r,!1),o,s,a);l.level="error",t.captureEvent(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})}))}function sE(){nE((e=>{const[t,n,r]=cE();if(!t.getIntegration(iE))return;if(YT())return!0;const i=function(e){if(kk(e))return e;const t=e;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch(n){}return e}(e),o=kk(i)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(i)}`}]}}:qT(n,i,void 0,r,!0);o.level="error",t.captureEvent(o,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})}))}function aE(e,t,n,r){const i=e.exception=e.exception||{},o=i.values=i.values||[],s=o[0]=o[0]||{},a=s.stacktrace=s.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,u=isNaN(parseInt(n,10))?void 0:n,d=wk(t)&&t.length>0?t:function(){try{return Rk.document.location.href}catch(e){return""}}();return 0===c.length&&c.push({colno:l,filename:d,function:"?",in_app:!0,lineno:u}),e}function cE(){const e=ES(),t=e.getClient(),n=t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[e,n.stackParser,n.attachStacktrace]}iE.__initStatic();const lE=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class uE{static __initStatic(){this.id="TryCatch"}constructor(e){this.name=uE.id,this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e}}setupOnce(){this._options.setTimeout&&Vk(JT,"setTimeout",dE),this._options.setInterval&&Vk(JT,"setInterval",dE),this._options.requestAnimationFrame&&Vk(JT,"requestAnimationFrame",hE),this._options.XMLHttpRequest&&"XMLHttpRequest"in JT&&Vk(XMLHttpRequest.prototype,"send",pE);const e=this._options.eventTarget;if(e){(Array.isArray(e)?e:lE).forEach(fE)}}}function dE(e){return function(...t){const n=t[0];return t[0]=KT(n,{mechanism:{data:{function:AS(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function hE(e){return function(t){return e.apply(this,[KT(t,{mechanism:{data:{function:"requestAnimationFrame",handler:AS(e)},handled:!1,type:"instrument"}})])}}function pE(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"===typeof n[e]&&Vk(n,e,(function(t){const n={mechanism:{data:{function:e,handler:AS(t)},handled:!1,type:"instrument"}},r=$k(t);return r&&(n.mechanism.data.handler=AS(r)),KT(t,n)}))})),e.apply(this,t)}}function fE(e){const t=JT,n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(Vk(n,"addEventListener",(function(t){return function(n,r,i){try{"function"===typeof r.handleEvent&&(r.handleEvent=KT(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:AS(r),target:e},handled:!1,type:"instrument"}}))}catch(o){}return t.apply(this,[n,KT(r,{mechanism:{data:{function:"addEventListener",handler:AS(r),target:e},handled:!1,type:"instrument"}}),i])}})),Vk(n,"removeEventListener",(function(e){return function(t,n,r){const i=n;try{const n=i&&i.__sentry_wrapped__;n&&e.call(this,t,n,r)}catch(o){}return e.call(this,t,i,r)}})))}function mE(){"console"in Ik.n2&&Ak.forEach((function(e){e in Ik.n2.console&&Vk(Ik.n2.console,e,(function(t){return Dk[e]=t,function(...t){gT("console",{args:t,level:e});const n=Dk[e];n&&n.apply(Ik.n2.console,t)}}))}))}uE.__initStatic();const gE=Ik.n2,vE=1e3;let yE,bE,wE;function kE(e){fT("dom",e),mT("dom",SE)}function SE(){if(!gE.document)return;const e=gT.bind(null,"dom"),t=TE(e,!0);gE.document.addEventListener("click",t,!1),gE.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=gE[t]&&gE[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(Vk(n,"addEventListener",(function(t){return function(n,r,i){if("click"===n||"keypress"==n)try{const r=this,o=r.__sentry_instrumentation_handlers__=r.__sentry_instrumentation_handlers__||{},s=o[n]=o[n]||{refCount:0};if(!s.handler){const r=TE(e);s.handler=r,t.call(this,n,r,i)}s.refCount++}catch(o){}return t.call(this,n,r,i)}})),Vk(n,"removeEventListener",(function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this,i=n.__sentry_instrumentation_handlers__||{},o=i[t];o&&(o.refCount--,o.refCount<=0&&(e.call(this,t,o.handler,r),o.handler=void 0,delete i[t]),0===Object.keys(i).length&&delete n.__sentry_instrumentation_handlers__)}catch(i){}return e.call(this,t,n,r)}})))}))}function TE(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch(t){return null}}(n);if(function(e,t){return"keypress"===e&&(!t||!t.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;Wk(n,"_sentryCaptured",!0),r&&!r._sentryId&&Wk(r,"_sentryId",Xk());const i="keypress"===n.type?"input":n.type;if(!function(e){if(e.type!==bE)return!1;try{if(!e.target||e.target._sentryId!==wE)return!1}catch(t){}return!0}(n)){e({event:n,name:i,global:t}),bE=n.type,wE=r?r._sentryId:void 0}clearTimeout(yE),yE=gE.setTimeout((()=>{wE=void 0,bE=void 0}),vE)}}const EE=Ik.n2,CE="__sentry_xhr_v3__";function _E(e){fT("xhr",e),mT("xhr",xE)}function xE(){if(!EE.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;Vk(e,"open",(function(e){return function(...t){const n=Date.now(),r=wk(t[0])?t[0].toUpperCase():void 0,i=function(e){if(wk(e))return e;try{return e.toString()}catch(t){}return}(t[1]);if(!r||!i)return e.apply(this,t);this[CE]={method:r,url:i,request_headers:{}},"POST"===r&&i.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const o=()=>{const e=this[CE];if(e&&4===this.readyState){try{e.status_code=this.status}catch(t){}gT("xhr",{args:[r,i],endTimestamp:Date.now(),startTimestamp:n,xhr:this})}};return"onreadystatechange"in this&&"function"===typeof this.onreadystatechange?Vk(this,"onreadystatechange",(function(e){return function(...t){return o(),e.apply(this,t)}})):this.addEventListener("readystatechange",o),Vk(this,"setRequestHeader",(function(e){return function(...t){const[n,r]=t,i=this[CE];return i&&wk(n)&&wk(r)&&(i.request_headers[n.toLowerCase()]=r),e.apply(this,t)}})),e.apply(this,t)}})),Vk(e,"send",(function(e){return function(...t){const n=this[CE];if(!n)return e.apply(this,t);void 0!==t[0]&&(n.body=t[0]);return gT("xhr",{args:[n.method,n.url],startTimestamp:Date.now(),xhr:this}),e.apply(this,t)}}))}function IE(e){const t="fetch";fT(t,e),mT(t,RE)}function RE(){(function(){if("string"===typeof EdgeRuntime)return!0;if(!lT())return!1;if(uT(cT.fetch))return!0;let e=!1;const t=cT.document;if(t&&"function"===typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=uT(n.contentWindow.fetch)),t.head.removeChild(n)}catch(n){Nk&&Uk.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return e})()&&Vk(Ik.n2,"fetch",(function(e){return function(...t){const{method:n,url:r}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:OE(t),method:PE(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:OE(t),method:PE(t,"method")?String(t.method).toUpperCase():"GET"}}(t),i={args:t,fetchData:{method:n,url:r},startTimestamp:Date.now()};return gT("fetch",{...i}),e.apply(Ik.n2,t).then((e=>(gT("fetch",{...i,endTimestamp:Date.now(),response:e}),e)),(e=>{throw gT("fetch",{...i,endTimestamp:Date.now(),error:e}),e}))}}))}function PE(e,t){return!!e&&"object"===typeof e&&!!e[t]}function OE(e){return"string"===typeof e?e:e?PE(e,"url")?e.url:e.toString?e.toString():"":""}const ME=["fatal","error","warning","log","info","debug"];function NE(e){return"warn"===e?"warning":ME.includes(e)?e:"log"}function AE(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}const DE=1024;class LE{static __initStatic(){this.id="Breadcrumbs"}constructor(e){this.name=LE.id,this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e}}setupOnce(){if(this.options.console&&function(e){const t="console";fT(t,e),mT(t,mE)}(FE),this.options.dom&&kE(function(e){function t(t){let n,r="object"===typeof e?e.serializeAttribute:void 0,i="object"===typeof e&&"number"===typeof e.maxStringLength?e.maxStringLength:void 0;i&&i>DE&&(FT&&Uk.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${i} was configured. Sentry will use 1024 instead.`),i=DE),"string"===typeof r&&(r=[r]);try{const e=t.event;n=function(e){return!!e&&!!e.target}(e)?Ok(e.target,{keyAttrs:r,maxStringLength:i}):Ok(e,{keyAttrs:r,maxStringLength:i})}catch(o){n="<unknown>"}0!==n.length&&ES().addBreadcrumb({category:`ui.${t.name}`,message:n},{event:t.event,name:t.name,global:t.global})}return t}(this.options.dom)),this.options.xhr&&_E(BE),this.options.fetch&&IE(jE),this.options.history&&bT(zE),this.options.sentry){const e=qS();e&&e.on&&e.on("beforeSendEvent",UE)}}}function UE(e){ES().addBreadcrumb({category:"sentry."+("transaction"===e.type?"transaction":"event"),event_id:e.event_id,level:e.level,message:Zk(e)},{event:e})}function FE(e){const t={category:"console",data:{arguments:e.args,logger:"console"},level:NE(e.level),message:Bk(e.args," ")};if("assert"===e.level){if(!1!==e.args[0])return;t.message=`Assertion failed: ${Bk(e.args.slice(1)," ")||"console.assert"}`,t.data.arguments=e.args.slice(1)}ES().addBreadcrumb(t,{input:e.args,level:e.level})}function BE(e){const{startTimestamp:t,endTimestamp:n}=e,r=e.xhr[CE];if(!t||!n||!r)return;const{method:i,url:o,status_code:s,body:a}=r,c={method:i,url:o,status_code:s},l={xhr:e.xhr,input:a,startTimestamp:t,endTimestamp:n};ES().addBreadcrumb({category:"xhr",data:c,type:"http"},l)}function jE(e){const{startTimestamp:t,endTimestamp:n}=e;if(n&&(!e.fetchData.url.match(/sentry_key/)||"POST"!==e.fetchData.method))if(e.error){const r=e.fetchData,i={data:e.error,input:e.args,startTimestamp:t,endTimestamp:n};ES().addBreadcrumb({category:"fetch",data:r,level:"error",type:"http"},i)}else{const r=e.response,i={...e.fetchData,status_code:r&&r.status},o={input:e.args,response:r,startTimestamp:t,endTimestamp:n};ES().addBreadcrumb({category:"fetch",data:i,type:"http"},o)}}function zE(e){let t=e.from,n=e.to;const r=AE(JT.location.href);let i=t?AE(t):void 0;const o=AE(n);i&&i.path||(i=r),r.protocol===o.protocol&&r.host===o.host&&(n=o.relative),r.protocol===i.protocol&&r.host===i.host&&(t=i.relative),ES().addBreadcrumb({category:"navigation",data:{from:t,to:n}})}function VE(e,t,n=250,r,i,o,s){if(!o.exception||!o.exception.values||!s||!_k(s.originalException,Error))return;const a=o.exception.values.length>0?o.exception.values[o.exception.values.length-1]:void 0;var c,l;a&&(o.exception.values=(c=WE(e,t,i,s.originalException,r,o.exception.values,a,0),l=n,c.map((e=>(e.value&&(e.value=Fk(e.value,l)),e)))))}function WE(e,t,n,r,i,o,s,a){if(o.length>=n+1)return o;let c=[...o];if(_k(r[i],Error)){qE(s,a);const o=e(t,r[i]),l=c.length;$E(o,i,l,a),c=WE(e,t,n,r[i],i,[o,...c],o,l)}return Array.isArray(r.errors)&&r.errors.forEach(((r,o)=>{if(_k(r,Error)){qE(s,a);const l=e(t,r),u=c.length;$E(l,`errors[${o}]`,u,a),c=WE(e,t,n,r,i,[l,...c],l,u)}})),c}function qE(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,is_exception_group:!0,exception_id:t}}function $E(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}LE.__initStatic();class HE{static __initStatic(){this.id="LinkedErrors"}constructor(e={}){this.name=HE.id,this._key=e.key||"cause",this._limit=e.limit||5}setupOnce(){}preprocessEvent(e,t,n){const r=n.getOptions();VE(BT,r.stackParser,r.maxValueLength,this._key,this._limit,e,t)}}HE.__initStatic();class JE{static __initStatic(){this.id="HttpContext"}constructor(){this.name=JE.id}setupOnce(){}preprocessEvent(e){if(!JT.navigator&&!JT.location&&!JT.document)return;const t=e.request&&e.request.url||JT.location&&JT.location.href,{referrer:n}=JT.document||{},{userAgent:r}=JT.navigator||{},i={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},o={...e.request,...t&&{url:t},headers:i};e.request=o}}JE.__initStatic();class GE{static __initStatic(){this.id="Dedupe"}constructor(){this.name=GE.id}setupOnce(e,t){}processEvent(e){if(e.type)return e;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!KE(e,t))return!1;if(!YE(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=XE(t),r=XE(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!KE(e,t))return!1;if(!YE(e,t))return!1;return!0}(e,t))return!0;return!1}(e,this._previousEvent))return FT&&Uk.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(t){}return this._previousEvent=e}}function YE(e,t){let n=QE(e),r=QE(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++){const e=r[i],t=n[i];if(e.filename!==t.filename||e.lineno!==t.lineno||e.colno!==t.colno||e.function!==t.function)return!1}return!0}function KE(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(i){return!1}}function XE(e){return e.exception&&e.exception.values&&e.exception.values[0]}function QE(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(n){return}}GE.__initStatic();const ZE="?";function eC(e,t,n,r){const i={filename:e,function:t,in_app:!0};return void 0!==n&&(i.lineno=n),void 0!==r&&(i.colno=r),i}const tC=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,nC=/\((\S*)(?::(\d+))(?::(\d+))\)/,rC=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,iC=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,oC=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,sC=MS(...[[30,e=>{const t=tC.exec(e);if(t){if(t[2]&&0===t[2].indexOf("eval")){const e=nC.exec(t[2]);e&&(t[2]=e[1],t[3]=e[2],t[4]=e[3])}const[e,n]=aC(t[1]||ZE,t[2]);return eC(n,e,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,e=>{const t=rC.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=iC.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||ZE;return[n,e]=aC(n,e),eC(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}],[40,e=>{const t=oC.exec(e);return t?eC(t[2],t[1]||ZE,+t[3],t[4]?+t[4]:void 0):void 0}]]),aC=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:ZE,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};function cC(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return lS(new OT("Not adding Promise because buffer limit was reached."));const i=r();return-1===t.indexOf(i)&&t.push(i),i.then((()=>n(i))).then(null,(()=>n(i).then(null,(()=>{})))),i},drain:function(e){return new uS(((n,r)=>{let i=t.length;if(!i)return n(!0);const o=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{cS(e).then((()=>{--i||(clearTimeout(o),n(!0))}),r)}))}))}}}const lC=6e4;function uC(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}function dC(e,{statusCode:t,headers:n},r=Date.now()){const i={...e},o=n&&n["x-sentry-rate-limits"],s=n&&n["retry-after"];if(o)for(const a of o.trim().split(",")){const[e,t]=a.split(":",2),n=parseInt(e,10),o=1e3*(isNaN(n)?60:n);if(t)for(const s of t.split(";"))i[s]=r+o;else i.all=r+o}else s?i.all=r+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?lC:r-t}(s,r):429===t&&(i.all=r+6e4);return i}const hC=30;function pC(e,t,n=cC(e.bufferSize||hC)){let r={};function i(i){const o=[];if(TT(i,((t,n)=>{const i=IT(n);if(uC(r,i)){const r=fC(t,n);e.recordDroppedEvent("ratelimit_backoff",i,r)}else o.push(t)})),0===o.length)return cS();const s=kT(i[0],o),a=t=>{TT(s,((n,r)=>{const i=fC(n,r);e.recordDroppedEvent(t,IT(r),i)}))};return n.add((()=>t({body:CT(s,e.textEncoder)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&sS&&Uk.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=dC(r,e),e)),(e=>{throw a("network_error"),e})))).then((e=>e),(e=>{if(e instanceof OT)return sS&&Uk.error("Skipped sending event because buffer is full."),a("queue_overflow"),cS();throw e}))}return i.__sentry__baseTransport__=!0,{send:i,flush:e=>n.drain(e)}}function fC(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}let mC;function gC(e,t=function(){if(mC)return mC;if(uT(JT.fetch))return mC=JT.fetch.bind(JT);const e=JT.document;let t=JT.fetch;if(e&&"function"===typeof e.createElement)try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(t=r.fetch),e.head.removeChild(n)}catch(n){FT&&Uk.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return mC=t.bind(JT)}()){let n=0,r=0;return pC(e,(function(i){const o=i.body.length;n+=o,r++;const s={body:i.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};try{return t(e.url,s).then((e=>(n-=o,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(a){return mC=void 0,n-=o,r--,lS(a)}}))}const vC=4;function yC(e){return pC(e,(function(t){return new uS(((n,r)=>{const i=new XMLHttpRequest;i.onerror=r,i.onreadystatechange=()=>{i.readyState===vC&&n({statusCode:i.status,headers:{"x-sentry-rate-limits":i.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":i.getResponseHeader("Retry-After")}})},i.open("POST",e.url);for(const t in e.headers)Object.prototype.hasOwnProperty.call(e.headers,t)&&i.setRequestHeader(t,e.headers[t]);i.send(t.body)}))}))}const bC=[new JS,new KS,new uE,new LE,new iE,new HE,new GE,new JE];function wC(e={}){void 0===e.defaultIntegrations&&(e.defaultIntegrations=bC),void 0===e.release&&("string"===typeof __SENTRY_RELEASE__&&(e.release=__SENTRY_RELEASE__),JT.SENTRY_RELEASE&&JT.SENTRY_RELEASE.id&&(e.release=JT.SENTRY_RELEASE.id)),void 0===e.autoSessionTracking&&(e.autoSessionTracking=!0),void 0===e.sendClientReports&&(e.sendClientReports=!0);const t={...e,stackParser:(n=e.stackParser||sC,Array.isArray(n)?MS(...n):n),integrations:QS(e),transport:e.transport||(lT()?gC:yC)};var n;!function(e,t){!0===t.debug&&(sS?Uk.enable():Lk((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})));const n=ES();n.getScope().update(t.initialScope);const r=new e(t);n.bindClient(r)}(XT,t),e.autoSessionTracking&&function(){if("undefined"===typeof JT.document)return void(FT&&Uk.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));const e=ES();if(!e.captureSession)return;SC(e),bT((({from:e,to:t})=>{void 0!==e&&e!==t&&SC(ES())}))}()}function kC(e={},t=ES()){if(!JT.document)return void(FT&&Uk.error("Global document not defined in showReportDialog call"));const{client:n,scope:r}=t.getStackTop(),i=e.dsn||n&&n.getDsn();if(!i)return void(FT&&Uk.error("DSN not configured for showReportDialog call"));r&&(e.user={...r.getUser(),...e.user}),e.eventId||(e.eventId=t.lastEventId());const o=JT.document.createElement("script");o.async=!0,o.crossOrigin="anonymous",o.src=function(e,t){const n=rT(e);if(!n)return"";const r=`${oT(n)}embed/error-page/`;let i=`dsn=${tT(n)}`;for(const o in t)if("dsn"!==o&&"onClose"!==o)if("user"===o){const e=t.user;if(!e)continue;e.name&&(i+=`&name=${encodeURIComponent(e.name)}`),e.email&&(i+=`&email=${encodeURIComponent(e.email)}`)}else i+=`&${encodeURIComponent(o)}=${encodeURIComponent(t[o])}`;return`${r}?${i}`}(i,e),e.onLoad&&(o.onload=e.onLoad);const{onClose:s}=e;if(s){const e=t=>{if("__sentry_reportdialog_closed__"===t.data)try{s()}finally{JT.removeEventListener("message",e)}};JT.addEventListener("message",e)}const a=JT.document.head||JT.document.body;a?a.appendChild(o):FT&&Uk.error("Not injecting report dialog. No injection point found in HTML")}function SC(e){e.startSession({ignoreDuration:!0}),e.captureSession()}n(110);const TC="undefined"===typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;const EC={componentStack:null,error:null,eventId:null};class CC extends t.Component{constructor(e){super(e),CC.prototype.__init.call(this),this.state=EC,this._openFallbackReportDialog=!0;const t=qS();t&&t.on&&e.showDialog&&(this._openFallbackReportDialog=!1,t.on("afterSendEvent",(t=>{t.type||t.event_id!==this._lastEventId||kC({...e.dialogOptions,eventId:this._lastEventId})})))}componentDidCatch(e,{componentStack:n}){const{beforeCapture:r,onError:i,showDialog:o,dialogOptions:s}=this.props;WS((a=>{if(function(e){const t=e.match(/^([^.]+)/);return null!==t&&parseInt(t[0])>=17}(t.version)&&gk(e)){const t=new Error(e.message);t.name=`React ErrorBoundary ${e.name}`,t.stack=n,function(e,t){const n=new WeakMap;!function e(t,r){if(!n.has(t))return t.cause?(n.set(t,!0),e(t.cause,r)):void(t.cause=r)}(e,t)}(e,t)}r&&r(a,e,n);const c=VS(e,{captureContext:{contexts:{react:{componentStack:n}}},mechanism:{handled:!1}});i&&i(e,n,c),o&&(this._lastEventId=c,this._openFallbackReportDialog&&kC({...s,eventId:c})),this.setState({error:e,componentStack:n,eventId:c})}))}componentDidMount(){const{onMount:e}=this.props;e&&e()}componentWillUnmount(){const{error:e,componentStack:t,eventId:n}=this.state,{onUnmount:r}=this.props;r&&r(e,t,n)}__init(){this.resetErrorBoundary=()=>{const{onReset:e}=this.props,{error:t,componentStack:n,eventId:r}=this.state;e&&e(t,n,r),this.setState(EC)}}render(){const{fallback:e,children:n}=this.props,r=this.state;if(r.error){let n;return n="function"===typeof e?e({error:r.error,componentStack:r.componentStack,resetError:this.resetErrorBoundary,eventId:r.eventId}):e,t.isValidElement(n)?n:(e&&TC&&Uk.warn("fallback did not produce a valid ReactElement"),null)}return"function"===typeof n?n():n}}const _C=function(){const[e,n]=(0,t.useState)(null),[r,i]=(0,t.useState)(!1),[o,s]=(0,t.useState)([]),a=t.useRef(null),c=t.useRef(null),l=(0,t.useRef)(!1),u=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return(0,t.useEffect)((()=>{if(l.current)return;const e=new Gs("mongoose.moo.mud.org",8765);e.registerGMCPPackage(ks),e.registerGMCPPackage(vs),e.registerGMCPPackage(ys),e.registerGMCPPackage(Ss),e.registerGMCPPackage(bs),e.registerGMCPPackage(ws),e.registerGMCPPackage(Mt),e.registerGMCPPackage(At),e.registerMcpPackage(Fs),e.registerMcpPackage(Bs),e.registerMcpPackage(zs),e.registerMcpPackage(Ws),e.connect(),e.requestNotificationPermission(),n(e),i(!u),window.mudClient=e,l.current=!0;const t=t=>{e&&("Control"===t.key&&e.cancelSpeech(),"Escape"===t.key&&e.stopAllSounds())};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}}),[u]),(0,t.useEffect)((()=>{if(e){const t=e=>{s(e)},n=()=>{s([])};return e.on("userlist",t),e.on("disconnect",n),()=>{e.off("userlist",t),e.off("disconnect",n)}}}),[e]),ft((t=>{e&&e.shutdown()})),e?(0,vt.jsx)(CC,{fallback:(0,vt.jsx)("p",{children:"An error has occurred"}),children:(0,vt.jsxs)("div",{className:"App",children:[(0,vt.jsx)("header",{className:"App-header"}),(0,vt.jsx)(ll,{client:e,onSaveLog:()=>{a.current&&a.current.saveLog()},onClearLog:()=>{a.current&&a.current.clearLog()},onToggleUsers:()=>i(!r),onOpenPrefs:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.open()}}),(0,vt.jsxs)("div",{children:[(0,vt.jsx)(bt,{client:e,ref:a}),r&&(0,vt.jsx)(hl,{users:o}),(0,vt.jsx)(fk,{client:e})]}),(0,vt.jsx)(Ks,{onSend:t=>e.sendCommand(t)}),(0,vt.jsx)(dl,{client:e}),(0,vt.jsx)(Gc,{ref:c})]})}):null};function xC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function RC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?IC(Object(n),!0).forEach((function(t){xC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function PC(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function OC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function MC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function AC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NC(Object(n),!0).forEach((function(t){MC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function DC(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(n,[].concat(i,r))}}}function LC(e){return{}.toString.call(e).includes("Object")}function UC(e){return"function"===typeof e}var FC=DC((function(e,t){throw new Error(e[t]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),BC={changes:function(e,t){return LC(t)||FC("changeType"),Object.keys(t).some((function(t){return n=e,r=t,!Object.prototype.hasOwnProperty.call(n,r);var n,r}))&&FC("changeField"),t},selector:function(e){UC(e)||FC("selectorType")},handler:function(e){UC(e)||LC(e)||FC("handlerType"),LC(e)&&Object.values(e).some((function(e){return!UC(e)}))&&FC("handlersType")},initial:function(e){var t;e||FC("initialIsRequired"),LC(e)||FC("initialType"),t=e,Object.keys(t).length||FC("initialContent")}};function jC(e,t){return UC(t)?t(e.current):t}function zC(e,t){return e.current=AC(AC({},e.current),t),t}function VC(e,t,n){return UC(t)?t(e.current):Object.keys(n).forEach((function(n){var r;return null===(r=t[n])||void 0===r?void 0:r.call(t,e.current[n])})),n}var WC={create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};BC.initial(e),BC.handler(t);var n={current:e},r=DC(VC)(n,t),i=DC(zC)(n),o=DC(BC.changes)(e),s=DC(jC)(n);return[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return BC.selector(e),e(n.current)},function(e){!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}(r,i,o,s)(e)}]}};const qC=WC;const $C={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};const HC=function(e){return{}.toString.call(e).includes("Object")};var JC={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},GC=function(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(n,[].concat(i,r))}}}((function(e,t){throw new Error(e[t]||e.default)}))(JC),YC={config:function(e){return e||GC("configIsRequired"),HC(e)||GC("configType"),e.urls?(console.warn(JC.deprecation),{paths:{vs:e.urls.monacoBase}}):e}};const KC=YC;const XC=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}};const QC=function e(t,n){return Object.keys(n).forEach((function(r){n[r]instanceof Object&&t[r]&&Object.assign(n[r],e(t[r],n[r]))})),RC(RC({},t),n)};var ZC={type:"cancelation",msg:"operation is manually canceled"};const e_=function(e){var t=!1,n=new Promise((function(n,r){e.then((function(e){return t?r(ZC):n(e)})),e.catch(r)}));return n.cancel=function(){return t=!0},n};var t_,n_,r_=qC.create({config:$C,isInitialized:!1,resolve:null,reject:null,monaco:null}),i_=(n_=2,function(e){if(Array.isArray(e))return e}(t_=r_)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(c){i=!0,o=c}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t_,n_)||function(e,t){if(e){if("string"===typeof e)return OC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OC(e,t):void 0}}(t_,n_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o_=i_[0],s_=i_[1];function a_(e){return document.body.appendChild(e)}function c_(e){var t=o_((function(e){return{config:e.config,reject:e.reject}})),n=function(e){var t=document.createElement("script");return e&&(t.src=e),t}("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function l_(){var e=o_((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],(function(t){u_(t),e.resolve(t)}),(function(t){e.reject(t)}))}function u_(e){o_().monaco||s_({monaco:e})}var d_=new Promise((function(e,t){return s_({resolve:e,reject:t})})),h_={config:function(e){var t=KC.config(e),n=t.monaco,r=PC(t,["monaco"]);s_((function(e){return{config:QC(e.config,r),monaco:n}}))},init:function(){var e=o_((function(e){return{monaco:e.monaco,isInitialized:e.isInitialized,resolve:e.resolve}}));if(!e.isInitialized){if(s_({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),e_(d_);if(window.monaco&&window.monaco.editor)return u_(window.monaco),e.resolve(window.monaco),e_(d_);XC(a_,c_)(l_)}return e_(d_)},__getMonacoInstance:function(){return o_((function(e){return e.monaco}))}};const p_=h_;var f_={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},m_={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}};var g_=function({children:e}){return t.createElement("div",{style:m_.container},e)},v_=g_;var y_=function({width:e,height:n,isEditorReady:r,loading:i,_ref:o,className:s,wrapperProps:a}){return t.createElement("section",{style:{...f_.wrapper,width:e,height:n},...a},!r&&t.createElement(v_,null,i),t.createElement("div",{ref:o,style:{...f_.fullWidth,...!r&&f_.hide},className:s}))},b_=(0,t.memo)(y_);var w_=function(e){(0,t.useEffect)(e,[])};var k_=function(e,n,r=!0){let i=(0,t.useRef)(!0);(0,t.useEffect)(i.current||!r?()=>{i.current=!1}:e,n)};function S_(){}function T_(e,t,n,r){return function(e,t){return e.editor.getModel(E_(e,t))}(e,r)||function(e,t,n,r){return e.editor.createModel(t,n,r?E_(e,r):void 0)}(e,t,n,r)}function E_(e,t){return e.Uri.parse(t)}var C_=function({original:e,modified:n,language:r,originalLanguage:i,modifiedLanguage:o,originalModelPath:s,modifiedModelPath:a,keepCurrentOriginalModel:c=!1,keepCurrentModifiedModel:l=!1,theme:u="light",loading:d="Loading...",options:h={},height:p="100%",width:f="100%",className:m,wrapperProps:g={},beforeMount:v=S_,onMount:y=S_}){let[b,w]=(0,t.useState)(!1),[k,S]=(0,t.useState)(!0),T=(0,t.useRef)(null),E=(0,t.useRef)(null),C=(0,t.useRef)(null),_=(0,t.useRef)(y),x=(0,t.useRef)(v),I=(0,t.useRef)(!1);w_((()=>{let e=p_.init();return e.then((e=>(E.current=e)&&S(!1))).catch((e=>"cancelation"!==e?.type&&console.error("Monaco initialization: error:",e))),()=>T.current?function(){let e=T.current?.getModel();c||e?.original?.dispose(),l||e?.modified?.dispose(),T.current?.dispose()}():e.cancel()})),k_((()=>{if(T.current&&E.current){let t=T.current.getOriginalEditor(),n=T_(E.current,e||"",i||r||"text",s||"");n!==t.getModel()&&t.setModel(n)}}),[s],b),k_((()=>{if(T.current&&E.current){let e=T.current.getModifiedEditor(),t=T_(E.current,n||"",o||r||"text",a||"");t!==e.getModel()&&e.setModel(t)}}),[a],b),k_((()=>{let e=T.current.getModifiedEditor();e.getOption(E.current.editor.EditorOption.readOnly)?e.setValue(n||""):n!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:n||"",forceMoveMarkers:!0}]),e.pushUndoStop())}),[n],b),k_((()=>{T.current?.getModel()?.original.setValue(e||"")}),[e],b),k_((()=>{let{original:e,modified:t}=T.current.getModel();E.current.editor.setModelLanguage(e,i||r||"text"),E.current.editor.setModelLanguage(t,o||r||"text")}),[r,i,o],b),k_((()=>{E.current?.editor.setTheme(u)}),[u],b),k_((()=>{T.current?.updateOptions(h)}),[h],b);let R=(0,t.useCallback)((()=>{if(!E.current)return;x.current(E.current);let t=T_(E.current,e||"",i||r||"text",s||""),c=T_(E.current,n||"",o||r||"text",a||"");T.current?.setModel({original:t,modified:c})}),[r,n,o,e,i,s,a]),P=(0,t.useCallback)((()=>{!I.current&&C.current&&(T.current=E.current.editor.createDiffEditor(C.current,{automaticLayout:!0,...h}),R(),E.current?.editor.setTheme(u),w(!0),I.current=!0)}),[h,u,R]);return(0,t.useEffect)((()=>{b&&_.current(T.current,E.current)}),[b]),(0,t.useEffect)((()=>{!k&&!b&&P()}),[k,b,P]),t.createElement(b_,{width:f,height:p,isEditorReady:b,loading:d,_ref:C,className:m,wrapperProps:g})};(0,t.memo)(C_);var __=function(e){let n=(0,t.useRef)();return(0,t.useEffect)((()=>{n.current=e}),[e]),n.current},x_=new Map;var I_=function({defaultValue:e,defaultLanguage:n,defaultPath:r,value:i,language:o,path:s,theme:a="light",line:c,loading:l="Loading...",options:u={},overrideServices:d={},saveViewState:h=!0,keepCurrentModel:p=!1,width:f="100%",height:m="100%",className:g,wrapperProps:v={},beforeMount:y=S_,onMount:b=S_,onChange:w,onValidate:k=S_}){let[S,T]=(0,t.useState)(!1),[E,C]=(0,t.useState)(!0),_=(0,t.useRef)(null),x=(0,t.useRef)(null),I=(0,t.useRef)(null),R=(0,t.useRef)(b),P=(0,t.useRef)(y),O=(0,t.useRef)(),M=(0,t.useRef)(i),N=__(s),A=(0,t.useRef)(!1),D=(0,t.useRef)(!1);w_((()=>{let e=p_.init();return e.then((e=>(_.current=e)&&C(!1))).catch((e=>"cancelation"!==e?.type&&console.error("Monaco initialization: error:",e))),()=>x.current?(O.current?.dispose(),p?h&&x_.set(s,x.current.saveViewState()):x.current.getModel()?.dispose(),void x.current.dispose()):e.cancel()})),k_((()=>{let t=T_(_.current,e||i||"",n||o||"",s||r||"");t!==x.current?.getModel()&&(h&&x_.set(N,x.current?.saveViewState()),x.current?.setModel(t),h&&x.current?.restoreViewState(x_.get(s)))}),[s],S),k_((()=>{x.current?.updateOptions(u)}),[u],S),k_((()=>{!x.current||void 0===i||(x.current.getOption(_.current.editor.EditorOption.readOnly)?x.current.setValue(i):i!==x.current.getValue()&&(D.current=!0,x.current.executeEdits("",[{range:x.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),x.current.pushUndoStop(),D.current=!1))}),[i],S),k_((()=>{let e=x.current?.getModel();e&&o&&_.current?.editor.setModelLanguage(e,o)}),[o],S),k_((()=>{void 0!==c&&x.current?.revealLine(c)}),[c],S),k_((()=>{_.current?.editor.setTheme(a)}),[a],S);let L=(0,t.useCallback)((()=>{if(I.current&&_.current&&!A.current){P.current(_.current);let t=s||r,l=T_(_.current,i||e||"",n||o||"",t||"");x.current=_.current?.editor.create(I.current,{model:l,automaticLayout:!0,...u},d),h&&x.current.restoreViewState(x_.get(t)),_.current.editor.setTheme(a),void 0!==c&&x.current.revealLine(c),T(!0),A.current=!0}}),[e,n,r,i,o,s,u,d,h,a,c]);return(0,t.useEffect)((()=>{S&&R.current(x.current,_.current)}),[S]),(0,t.useEffect)((()=>{!E&&!S&&L()}),[E,S,L]),M.current=i,(0,t.useEffect)((()=>{S&&w&&(O.current?.dispose(),O.current=x.current?.onDidChangeModelContent((e=>{D.current||w(x.current.getValue(),e)})))}),[S,w]),(0,t.useEffect)((()=>{if(S){let e=_.current.editor.onDidChangeMarkers((e=>{let t=x.current.getModel()?.uri;if(t&&e.find((e=>e.path===t.path))){let e=_.current.editor.getModelMarkers({resource:t});k?.(e)}}));return()=>{e?.dispose()}}return()=>{}}),[S,k]),t.createElement(b_,{width:f,height:m,isEditorReady:S,loading:l,_ref:I,className:g,wrapperProps:v})},R_=(0,t.memo)(I_),P_={restoreOnUnmount:!1};const O_="undefined"!==typeof document?function(e,n){void 0===n&&(n=P_);var r=(0,t.useRef)(document.title);document.title!==e&&(document.title=e),(0,t.useEffect)((function(){return n&&n.restoreOnUnmount?function(){document.title=r.current}:void 0}),[])}:function(e){};var M_=function(e){return e[e.Unchanged=0]="Unchanged",e[e.Changed=1]="Changed",e[e.Saved=2]="Saved",e}(M_||{});const N_=function(){const e=We(),n=t.useRef(null),[r,i]=(0,t.useState)(""),[o,s]=(0,t.useState)(""),[a,c]=(0,t.useState)(""),[l,u]=(0,t.useState)(M_.Unchanged),[d,h]=(0,t.useState)({name:"none",contents:[],reference:"",type:""}),[p,f]=Xs();console.log(p);const m=p.editor.accessibilityMode,g=p.editor.autocompleteEnabled;ft((e=>{k.postMessage({type:"close",id:T}),l===M_.Changed&&e.preventDefault()}));const[v,y]=(0,t.useState)(!1),b=v?`${d.name} - Mongoose Editor`:"Mongoose Editor";O_(b);const w=(0,t.useMemo)((()=>{switch(l){case M_.Unchanged:return"Unchanged";case M_.Changed:return"Changed";case M_.Saved:return"Saved"}}),[l]),k=(0,t.useMemo)((()=>new BroadcastChannel("editor")),[]),S=new URLSearchParams(e.search),T=decodeURIComponent(S.get("reference")||"");return(0,t.useEffect)((()=>{if(!T)return;console.log("ID: "+T),console.log("Sending ready message"),k.postMessage({type:"ready",id:T});const e=e=>{if(console.log(e.data),"load"===e.data.type){if(""!==r)return;const t=e.data.session.contents.join("\n");s(t),c(t),h(e.data.session),u(M_.Unchanged),i(e.data.clientId)}else if("shutdown"===e.data.type){if(e.data.clientId!==r)return;k.close(),window.close()}};return k.addEventListener("message",e),()=>k.removeEventListener("message",e)}),[k,r,T]),(0,vt.jsxs)(vt.Fragment,{children:[(0,vt.jsx)("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:(0,vt.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,vt.jsxs)("button",{onClick:e=>{const t=o.split(/\r\n|\r|\n/),r={...d,contents:t};k.postMessage({type:"save",session:r,id:T}),u(M_.Saved),null!==n.current&&n.current.focus(),e.preventDefault()},accessKey:"s",children:[(0,vt.jsx)(ol,{}),"Save"]}),(0,vt.jsxs)("button",{onClick:()=>{s(a),u(M_.Unchanged)},accessKey:"r",children:[(0,vt.jsx)(sl,{}),"Revert"]}),(0,vt.jsxs)("button",{onClick:()=>{const e=new Blob([o],{type:"text/plain"}),t=URL.createObjectURL(e),n=document.createElement("a"),r=new Date,i=r.toLocaleDateString().replace(/\//g,"-"),s=r.toLocaleTimeString().replace(/:/g,"-"),a=`${d.name}-${i}-${s}.txt`;n.download=a,n.href=t,n.click(),URL.revokeObjectURL(t),n.remove()},accessKey:"d",children:[(0,vt.jsx)(rl,{}),"Download"]})]})}),(0,vt.jsx)(R_,{height:"80vh",defaultLanguage:"lambdamoo",value:o,onChange:e=>{void 0!==e&&(console.log("Original: "+a),console.log("New: "+e),s(e),e.split(/\r\n|\r|\n/).join("\n")!==a?u(M_.Changed):u(M_.Unchanged),v||y(!0))},options:{wordWrap:"on",accessibilitySupport:m?"on":"off",quickSuggestions:g},onMount:(e,t)=>{n.current=e,n.current=e}}),(0,vt.jsxs)("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[(0,vt.jsx)("span",{children:w}),(0,vt.jsx)("span",{children:"|"}),(0,vt.jsx)("span",{children:d.reference}),(0,vt.jsx)("span",{children:"|"}),(0,vt.jsx)("span",{children:d.type})]})]})},A_=e=>{e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((({getCLS:t,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{t(e),n(e),r(e),i(e),o(e)}))},D_=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function L_(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}const U_="baggage",F_="sentry-",B_=/^sentry-/,j_=8192;function z_(e){if(!e)return;return function(e){if(0===Object.keys(e).length)return;return Object.entries(e).reduce(((e,[t,n],r)=>{const i=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,o=0===r?i:`${e},${i}`;return o.length>j_?(Nk&&Uk.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):o}),"")}(Object.entries(e).reduce(((e,[t,n])=>(n&&(e[`${F_}${t}`]=n),e)),{}))}function V_(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(e[t]=n,e)),{})}const W_=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function q_(e,t){const n=function(e){if(!e)return;const t=e.match(W_);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}(e),r=function(e){if(!wk(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce(((e,t)=>({...e,...V_(t)})),{});else{if(!e)return;t=V_(e)}const n=Object.entries(t).reduce(((e,[t,n])=>(t.match(B_)&&(e[t.slice(F_.length)]=n),e)),{});return Object.keys(n).length>0?n:void 0}(t),{traceId:i,parentSpanId:o,parentSampled:s}=n||{},a={traceId:i||Xk(),spanId:Xk().substring(16),sampled:s};return o&&(a.parentSpanId=o),r&&(a.dsc=r),{traceparentData:n,dynamicSamplingContext:r,propagationContext:a}}function $_(e=Xk(),t=Xk().substring(16),n){let r="";return void 0!==n&&(r=n?"-1":"-0"),`${e}-${t}${r}`}class H_{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class J_{constructor(e={}){this.traceId=e.traceId||Xk(),this.spanId=e.spanId||Xk().substring(16),this.startTimestamp=e.startTimestamp||(0,iS.ph)(),this.tags=e.tags||{},this.data=e.data||{},this.instrumenter=e.instrumenter||"sentry",this.origin=e.origin||"manual",e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.name&&(this.description=e.name),e.status&&(this.status=e.status),e.endTimestamp&&(this.endTimestamp=e.endTimestamp)}get name(){return this.description||""}set name(e){this.setName(e)}startChild(e){const t=new J_({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t),t.transaction=this.transaction,sS&&t.transaction){const n=`[Tracing] Starting '${e&&e.op||"< unknown op >"}' span on transaction '${t.transaction.name||"< unknown name >"}' (${t.transaction.spanId}).`;t.transaction.metadata.spanMetadata[t.spanId]={logMessage:n},Uk.log(n)}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e)),this.setData("http.response.status_code",e);const t=function(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(e);return"unknown_error"!==t&&this.setStatus(t),this}setName(e){this.description=e}isSuccess(){return"ok"===this.status}finish(e){if(sS&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:e}=this.transaction.metadata.spanMetadata[this.spanId];e&&Uk.log(e.replace("Starting","Finishing"))}this.endTimestamp="number"===typeof e?e:(0,iS.ph)()}toTraceparent(){return $_(this.traceId,this.spanId,this.sampled)}toContext(){return Yk({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return Yk({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId,origin:this.origin})}toJSON(){return Yk({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId,origin:this.origin})}}class G_ extends J_{constructor(e,t){super(e),delete this.description,this._measurements={},this._contexts={},this._hub=t||ES(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;const n=this.metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}setName(e,t="custom"){this._name=e,this.metadata.source=t}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new H_(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this.metadata={...this.metadata,...e}}finish(e){const t=this._finishTransaction(e);if(t)return this._hub.captureEvent(t)}toContext(){return Yk({...super.toContext(),name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const e=this._hub||ES(),t=e.getClient();if(!t)return{};const n=e.getScope(),r=MT(this.traceId,t,n),i=this.metadata.sampleRate;void 0!==i&&(r.sample_rate=`${i}`);const o=this.metadata.source;return o&&"url"!==o&&(r.transaction=this.name),void 0!==this.sampled&&(r.sampled=String(this.sampled)),r}setHub(e){this._hub=e}_finishTransaction(e){if(void 0!==this.endTimestamp)return;this.name||(sS&&Uk.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(e);const t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this.sampled)return sS&&Uk.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(t&&t.recordDroppedEvent("sample_rate","transaction"));const n=this.spanRecorder?this.spanRecorder.spans.filter((e=>e!==this&&e.endTimestamp)):[];this._trimEnd&&n.length>0&&(this.endTimestamp=n.reduce(((e,t)=>e.endTimestamp&&t.endTimestamp?e.endTimestamp>t.endTimestamp?e:t:e)).endTimestamp);const r=this.metadata,i={contexts:{...this._contexts,trace:this.getTraceContext()},spans:n,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...r,dynamicSamplingContext:this.getDynamicSamplingContext()},...r.source&&{transaction_info:{source:r.source}}};return Object.keys(this._measurements).length>0&&(sS&&Uk.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),i.measurements=this._measurements),sS&&Uk.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),i}}const Y_={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},K_=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class X_ extends H_{constructor(e,t,n,r){super(r),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=n}add(e){e.spanId!==this.transactionSpanId&&(e.finish=t=>{e.endTimestamp="number"===typeof t?t:(0,iS.ph)(),this._popActivity(e.spanId)},void 0===e.endTimestamp&&this._pushActivity(e.spanId)),super.add(e)}}class Q_ extends G_{constructor(e,t,n=Y_.idleTimeout,r=Y_.finalTimeout,i=Y_.heartbeatInterval,o=!1){super(e,t),this._idleHub=t,this._idleTimeout=n,this._finalTimeout=r,this._heartbeatInterval=i,this._onScope=o,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=K_[4],o&&(sS&&Uk.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),t.configureScope((e=>e.setSpan(this)))),this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=K_[3],this.finish())}),this._finalTimeout)}finish(e=(0,iS.ph)()){if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setTag("finishReason",this._finishReason),this.spanRecorder){sS&&Uk.log("[Tracing] finishing IdleTransaction",new Date(1e3*e).toISOString(),this.op);for(const t of this._beforeFinishCallbacks)t(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter((t=>{if(t.spanId===this.spanId)return!0;t.endTimestamp||(t.endTimestamp=e,t.setStatus("cancelled"),sS&&Uk.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));const n=t.startTimestamp<e,r=(this._finalTimeout+this._idleTimeout)/1e3,i=t.endTimestamp-this.startTimestamp<r;if(sS){const e=JSON.stringify(t,void 0,2);n?i||Uk.log("[Tracing] discarding Span since it finished after Transaction final timeout",e):Uk.log("[Tracing] discarding Span since it happened after Transaction was finished",e)}return n&&i})),sS&&Uk.log("[Tracing] flushing IdleTransaction")}else sS&&Uk.log("[Tracing] No active IdleTransaction");if(this._onScope){const e=this._idleHub.getScope();e.getTransaction()===this&&e.setSpan(void 0)}return super.finish(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const t=e=>{this._finished||this._pushActivity(e)},n=e=>{this._finished||this._popActivity(e)};this.spanRecorder=new X_(t,n,this.spanId,e),sS&&Uk.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===t,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=K_[5],this.finish(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=K_[1],this.finish(e))}),this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),sS&&Uk.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,sS&&Uk.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(sS&&Uk.log(`[Tracing] popActivity ${e}`),delete this.activities[e],sS&&Uk.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const e=(0,iS.ph)();this._idleTimeoutCanceledPermanently?(this._finishReason=K_[5],this.finish(e)):this._restartIdleTimeout(e+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(sS&&Uk.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=K_[0],this.finish()):this._pingHeartbeat()}_pingHeartbeat(){sS&&Uk.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}function Z_(e){return(e||ES()).getScope().getTransaction()}let ex=!1;function tx(){const e=Z_();if(e){const t="internal_error";sS&&Uk.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}function nx(e){if("boolean"===typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=qS(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function rx(e,t,n){if(!nx(t))return e.sampled=!1,e;if(void 0!==e.sampled)return e.setMetadata({sampleRate:Number(e.sampled)}),e;let r;return"function"===typeof t.tracesSampler?(r=t.tracesSampler(n),e.setMetadata({sampleRate:Number(r)})):void 0!==n.parentSampled?r=n.parentSampled:"undefined"!==typeof t.tracesSampleRate?(r=t.tracesSampleRate,e.setMetadata({sampleRate:Number(r)})):(r=1,e.setMetadata({sampleRate:r})),function(e){if(Ck(e)||"number"!==typeof e&&"boolean"!==typeof e)return sS&&Uk.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1;if(e<0||e>1)return sS&&Uk.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1;return!0}(r)?r?(e.sampled=Math.random()<r,e.sampled?(sS&&Uk.log(`[Tracing] starting ${e.op} transaction - ${e.name}`),e):(sS&&Uk.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),e)):(sS&&Uk.log("[Tracing] Discarding transaction because "+("function"===typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),e.sampled=!1,e):(sS&&Uk.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function ix(){const e=this.getScope().getSpan();return e?{"sentry-trace":e.toTraceparent()}:{}}function ox(e,t){const n=this.getClient(),r=n&&n.getOptions()||{},i=r.instrumenter||"sentry",o=e.instrumenter||"sentry";i!==o&&(sS&&Uk.error(`A transaction was started with instrumenter=\`${o}\`, but the SDK is configured with the \`${i}\` instrumenter.\nThe transaction will not be sampled. Please use the ${i} instrumentation to start transactions.`),e.sampled=!1);let s=new G_(e,this);return s=rx(s,r,{parentSampled:e.parentSampled,transactionContext:e,...t}),s.sampled&&s.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",s),s}function sx(e,t,n,r,i,o,s){const a=e.getClient(),c=a&&a.getOptions()||{};let l=new Q_(t,e,n,r,s,i);return l=rx(l,c,{parentSampled:t.parentSampled,transactionContext:t,...o}),l.sampled&&l.initSpanRecorder(c._experiments&&c._experiments.maxSpans),a&&a.emit&&a.emit("startTransaction",l),l}function ax(){const e=SS();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=ox),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=ix),ex||(ex=!0,ZT(tx),nE(tx)))}tx.tag="sentry_tracingErrorCallback";const cx="undefined"===typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,lx=Ik.n2;const ux=(e,t,n)=>{let r,i;return o=>{t.value>=0&&(o||n)&&(i=t.value-(r||0),(i||void 0===r)&&(r=t.value,t.delta=i,e(t)))}},dx=()=>lx.__WEB_VITALS_POLYFILL__?lx.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const e=lx.performance.timing,t=lx.performance.navigation.type,n={entryType:"navigation",startTime:0,type:2==t?"back_forward":1===t?"reload":"navigate"};for(const r in e)"navigationStart"!==r&&"toJSON"!==r&&(n[r]=Math.max(e[r]-e.navigationStart,0));return n})()):lx.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],hx=()=>{const e=dx();return e&&e.activationStart||0},px=(e,t)=>{const n=dx();let r="navigate";return n&&(r=lx.document.prerendering||hx()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:"undefined"===typeof t?-1:t,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},fx=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver((e=>{t(e.getEntries())}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(r){}},mx=(e,t)=>{const n=r=>{"pagehide"!==r.type&&"hidden"!==lx.document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},gx=e=>{const t=px("CLS",0);let n,r=0,i=[];const o=e=>{e.forEach((e=>{if(!e.hadRecentInput){const o=i[0],s=i[i.length-1];r&&0!==i.length&&e.startTime-s.startTime<1e3&&e.startTime-o.startTime<5e3?(r+=e.value,i.push(e)):(r=e.value,i=[e]),r>t.value&&(t.value=r,t.entries=i,n&&n())}}))},s=fx("layout-shift",o);if(s){n=ux(e,t);const r=()=>{o(s.takeRecords()),n(!0)};return mx(r),r}};let vx=-1;const yx=()=>(vx<0&&(vx="hidden"!==lx.document.visibilityState||lx.document.prerendering?1/0:0,mx((({timeStamp:e})=>{vx=e}),!0)),{get firstHiddenTime(){return vx}}),bx=e=>{const t=yx(),n=px("FID");let r;const i=e=>{e.startTime<t.firstHiddenTime&&(n.value=e.processingStart-e.startTime,n.entries.push(e),r(!0))},o=e=>{e.forEach(i)},s=fx("first-input",o);r=ux(e,n),s&&mx((()=>{o(s.takeRecords()),s.disconnect()}),!0)},wx={},kx=e=>{const t=yx(),n=px("LCP");let r;const i=e=>{const i=e[e.length-1];if(i){const e=Math.max(i.startTime-hx(),0);e<t.firstHiddenTime&&(n.value=e,n.entries=[i],r())}},o=fx("largest-contentful-paint",i);if(o){r=ux(e,n);const t=()=>{wx[n.id]||(i(o.takeRecords()),o.disconnect(),wx[n.id]=!0,r(!0))};return["keydown","click"].forEach((e=>{addEventListener(e,t,{once:!0,capture:!0})})),mx(t,!0),t}},Sx={},Tx={};let Ex,Cx,_x;function xx(e){return Nx("lcp",e,Mx,_x)}function Ix(e,t){return Ax(e,t),Tx[e]||(!function(e){const t={};"event"===e&&(t.durationThreshold=0);fx(e,(t=>{Rx(e,{entries:t})}),t)}(e),Tx[e]=!0),Dx(e,t)}function Rx(e,t){const n=Sx[e];if(n&&n.length)for(const i of n)try{i(t)}catch(r){cx&&Uk.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${AS(i)}\nError:`,r)}}function Px(){gx((e=>{Rx("cls",{metric:e}),Ex=e}))}function Ox(){bx((e=>{Rx("fid",{metric:e}),Cx=e}))}function Mx(){kx((e=>{Rx("lcp",{metric:e}),_x=e}))}function Nx(e,t,n,r){return Ax(e,t),Tx[e]||(n(),Tx[e]=!0),r&&t({metric:r}),Dx(e,t)}function Ax(e,t){Sx[e]=Sx[e]||[],Sx[e].push(t)}function Dx(e,t){return()=>{const n=Sx[e];if(!n)return;const r=n.indexOf(t);-1!==r&&n.splice(r,1)}}function Lx(e){return"number"===typeof e&&isFinite(e)}function Ux(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}const Fx=2147483647;function Bx(e){return e/1e3}function jx(){return lx&&lx.addEventListener&&lx.performance}let zx,Vx,Wx=0,qx={};function $x(){const e=jx();if(e&&iS.Z1){e.mark&&lx.performance.mark("sentry-tracing-init");const t=function(){return e=({metric:e})=>{const t=e.entries.pop();if(!t)return;const n=Bx(iS.Z1),r=Bx(t.startTime);cx&&Uk.log("[Measurements] Adding FID"),qx.fid={value:e.value,unit:"millisecond"},qx["mark.fid"]={value:n+r,unit:"second"}},Nx("fid",e,Ox,Cx);var e}(),n=function(){return e=({metric:e})=>{const t=e.entries.pop();t&&(cx&&Uk.log("[Measurements] Adding CLS"),qx.cls={value:e.value,unit:""},Vx=t)},Nx("cls",e,Px,Ex);var e}(),r=xx((({metric:e})=>{const t=e.entries.pop();t&&(cx&&Uk.log("[Measurements] Adding LCP"),qx.lcp={value:e.value,unit:"millisecond"},zx=t)}));return()=>{t(),n(),r()}}return()=>{}}function Hx(e){const t=jx();if(!t||!lx.performance.getEntries||!iS.Z1)return;cx&&Uk.log("[Tracing] Adding & adjusting spans using Performance API");const n=Bx(iS.Z1),r=t.getEntries();let i,o;if(r.slice(Wx).forEach((t=>{const r=Bx(t.startTime),s=Bx(t.duration);if(!("navigation"===e.op&&n+r<e.startTimestamp))switch(t.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((r=>{Jx(e,t,r,n)})),Jx(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),Jx(e,t,"fetch",n,"cache","domainLookupStart"),Jx(e,t,"domainLookup",n,"DNS"),function(e,t,n){Ux(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+Bx(t.requestStart),endTimestamp:n+Bx(t.responseEnd)}),Ux(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+Bx(t.responseStart),endTimestamp:n+Bx(t.responseEnd)})}(e,t,n)}(e,t,n),i=n+Bx(t.responseStart),o=n+Bx(t.requestStart);break;case"mark":case"paint":case"measure":{!function(e,t,n,r,i){const o=i+n,s=o+r;Ux(e,{description:t.name,endTimestamp:s,op:t.entryType,origin:"auto.resource.browser.metrics",startTimestamp:o})}(e,t,r,s,n);const i=yx(),o=t.startTime<i.firstHiddenTime;"first-paint"===t.name&&o&&(cx&&Uk.log("[Measurements] Adding FP"),qx.fp={value:t.startTime,unit:"millisecond"}),"first-contentful-paint"===t.name&&o&&(cx&&Uk.log("[Measurements] Adding FCP"),qx.fcp={value:t.startTime,unit:"millisecond"});break}case"resource":{const i=t.name.replace(lx.location.origin,"");!function(e,t,n,r,i,o){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const s={};Gx(s,t,"transferSize","http.response_transfer_size"),Gx(s,t,"encodedBodySize","http.response_content_length"),Gx(s,t,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in t&&(s["resource.render_blocking_status"]=t.renderBlockingStatus);const a=o+r,c=a+i;Ux(e,{description:n,endTimestamp:c,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:a,data:s})}(e,t,i,r,s,n);break}}})),Wx=Math.max(r.length-1,0),function(e){const t=lx.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),Lx(n.rtt)&&(qx["connection.rtt"]={value:n.rtt,unit:"millisecond"}));Lx(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`);Lx(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===e.op){"number"===typeof i&&(cx&&Uk.log("[Measurements] Adding TTFB"),qx.ttfb={value:1e3*(i-e.startTimestamp),unit:"millisecond"},"number"===typeof o&&o<=i&&(qx["ttfb.requestTime"]={value:1e3*(i-o),unit:"millisecond"})),["fcp","fp","lcp"].forEach((t=>{if(!qx[t]||n>=e.startTimestamp)return;const r=qx[t].value,i=n+Bx(r),o=Math.abs(1e3*(i-e.startTimestamp)),s=o-r;cx&&Uk.log(`[Measurements] Normalized ${t} from ${r} to ${o} (${s})`),qx[t].value=o}));const t=qx["mark.fid"];t&&qx.fid&&(Ux(e,{description:"first input delay",endTimestamp:t.value+Bx(qx.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:t.value}),delete qx["mark.fid"]),"fcp"in qx||delete qx.cls,Object.keys(qx).forEach((t=>{e.setMeasurement(t,qx[t].value,qx[t].unit)})),function(e){zx&&(cx&&Uk.log("[Measurements] Adding LCP Data"),zx.element&&e.setTag("lcp.element",Ok(zx.element)),zx.id&&e.setTag("lcp.id",zx.id),zx.url&&e.setTag("lcp.url",zx.url.trim().slice(0,200)),e.setTag("lcp.size",zx.size));Vx&&Vx.sources&&(cx&&Uk.log("[Measurements] Adding CLS Data"),Vx.sources.forEach(((t,n)=>e.setTag(`cls.source.${n+1}`,Ok(t.node)))))}(e)}zx=void 0,Vx=void 0,qx={}}function Jx(e,t,n,r,i,o){const s=o?t[o]:t[`${n}End`],a=t[`${n}Start`];a&&s&&Ux(e,{op:"browser",origin:"auto.browser.browser.metrics",description:i||n,startTimestamp:r+Bx(a),endTimestamp:r+Bx(s)})}function Gx(e,t,n,r){const i=t[n];null!=i&&i<Fx&&(e[r]=i)}function Yx(e,t,n,r,i="auto.http.browser"){if(!nx()||!e.fetchData)return;const o=t(e.fetchData.url);if(e.endTimestamp&&o){const t=e.fetchData.__span;if(!t)return;const n=r[t];if(n){if(e.response){n.setHttpStatus(e.response.status);const t=e.response&&e.response.headers&&e.response.headers.get("content-length");if(t){const e=parseInt(t);e>0&&n.setData("http.response_content_length",e)}}else e.error&&n.setStatus("internal_error");n.finish(),delete r[t]}return}const s=ES(),a=s.getScope(),c=s.getClient(),l=a.getSpan(),{method:u,url:d}=e.fetchData,h=o&&l?l.startChild({data:{url:d,type:"fetch","http.method":u},description:`${u} ${d}`,op:"http.client",origin:i}):void 0;if(h&&(e.fetchData.__span=h.spanId,r[h.spanId]=h),n(e.fetchData.url)&&c){const t=e.args[0];e.args[1]=e.args[1]||{};const n=e.args[1];n.headers=function(e,t,n,r,i){const o=i||n.getSpan(),s=o&&o.transaction,{traceId:a,sampled:c,dsc:l}=n.getPropagationContext(),u=o?o.toTraceparent():$_(a,void 0,c),d=s?s.getDynamicSamplingContext():l||MT(a,t,n),h=z_(d),p="undefined"!==typeof Request&&_k(e,Request)?e.headers:r.headers;if(p){if("undefined"!==typeof Headers&&_k(p,Headers)){const e=new Headers(p);return e.append("sentry-trace",u),h&&e.append(U_,h),e}if(Array.isArray(p)){const e=[...p,["sentry-trace",u]];return h&&e.push([U_,h]),e}{const e="baggage"in p?p.baggage:void 0,t=[];return Array.isArray(e)?t.push(...e):e&&t.push(e),h&&t.push(h),{...p,"sentry-trace":u,baggage:t.length>0?t.join(","):void 0}}}return{"sentry-trace":u,baggage:h}}(t,c,a,n,h)}return h}const Kx=["localhost",/^\/(?!\/)/],Xx={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:Kx,tracePropagationTargets:Kx};function Qx(e){const{traceFetch:t,traceXHR:n,tracePropagationTargets:r,tracingOrigins:i,shouldCreateSpanForRequest:o,enableHTTPTimings:s}={traceFetch:Xx.traceFetch,traceXHR:Xx.traceXHR,...e},a="function"===typeof o?o:e=>!0,c=e=>function(e,t){return zk(e,t||Kx)}(e,r||i),l={};t&&IE((e=>{const t=Yx(e,a,c,l);s&&t&&Zx(t)})),n&&_E((e=>{const t=function(e,t,n,r){const i=e.xhr,o=i&&i[CE];if(!nx()||!i||i.__sentry_own_request__||!o)return;const s=t(o.url);if(e.endTimestamp&&s){const e=i.__sentry_xhr_span_id__;if(!e)return;const t=r[e];return void(t&&void 0!==o.status_code&&(t.setHttpStatus(o.status_code),t.finish(),delete r[e]))}const a=ES(),c=a.getScope(),l=c.getSpan(),u=s&&l?l.startChild({data:{type:"xhr","http.method":o.method,url:o.url},description:`${o.method} ${o.url}`,op:"http.client",origin:"auto.http.browser"}):void 0;u&&(i.__sentry_xhr_span_id__=u.spanId,r[i.__sentry_xhr_span_id__]=u);if(i.setRequestHeader&&n(o.url))if(u){const e=u&&u.transaction,t=z_(e&&e.getDynamicSamplingContext());tI(i,u.toTraceparent(),t)}else{const e=a.getClient(),{traceId:t,sampled:n,dsc:r}=c.getPropagationContext();tI(i,$_(t,void 0,n),z_(r||(e?MT(t,e,c):void 0)))}return u}(e,a,c,l);s&&t&&Zx(t)}))}function Zx(e){const t=e.data.url;if(!t)return;const n=Ix("resource",(({entries:r})=>{r.forEach((r=>{if(function(e){return"resource"===e.entryType&&"initiatorType"in e&&"string"===typeof e.nextHopProtocol&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)}(r)&&r.name.endsWith(t)){const t=function(e){const{name:t,version:n}=function(e){let t="unknown",n="unknown",r="";for(const i of e){if("/"===i){[t,n]=e.split("/");break}if(!isNaN(Number(i))){t="h"===r?"http":r,n=e.split(r)[1];break}r+=i}r===e&&(t=r);return{name:t,version:n}}(e.nextHopProtocol),r=[];if(r.push(["network.protocol.version",n],["network.protocol.name",t]),!iS.Z1)return r;return[...r,["http.request.redirect_start",eI(e.redirectStart)],["http.request.fetch_start",eI(e.fetchStart)],["http.request.domain_lookup_start",eI(e.domainLookupStart)],["http.request.domain_lookup_end",eI(e.domainLookupEnd)],["http.request.connect_start",eI(e.connectStart)],["http.request.secure_connection_start",eI(e.secureConnectionStart)],["http.request.connection_end",eI(e.connectEnd)],["http.request.request_start",eI(e.requestStart)],["http.request.response_start",eI(e.responseStart)],["http.request.response_end",eI(e.responseEnd)]]}(r);t.forEach((t=>e.setData(...t))),setTimeout(n)}}))}))}function eI(e=0){return((iS.Z1||performance.timeOrigin)+e)/1e3}function tI(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader(U_,n)}catch(x_){}}const nI={...Y_,markBackgroundTransactions:!0,routingInstrumentation:function(e,t=!0,n=!0){if(!lx||!lx.location)return void(cx&&Uk.warn("Could not initialize routing instrumentation due to invalid location"));let r,i=lx.location.href;t&&(r=e({name:lx.location.pathname,startTimestamp:iS.Z1?iS.Z1/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&bT((({to:t,from:n})=>{void 0===n&&i&&-1!==i.indexOf(t)?i=void 0:n!==t&&(i=void 0,r&&(cx&&Uk.log(`[Tracing] Finishing current transaction with op: ${r.op}`),r.finish()),r=e({name:lx.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))}))},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...Xx};function rI(e){const t=(n=`meta[name=${e}]`,Rk.document&&Rk.document.querySelector?Rk.document.querySelector(n):null);var n;return t?t.getAttribute("content"):void 0}function iI(e,t){const n=t.getClient(),r=n&&n.getDsn(),i=n&&n.getOptions().tunnel;return function(e,t){return!!t&&e.includes(t.host)}(e,r)||function(e,t){if(!t)return!1;return oI(e)===oI(t)}(e,i)}function oI(e){return"/"===e[e.length-1]?e.slice(0,-1):e}var sI=n(685);function aI(){return"undefined"!==typeof window&&(!(0,sI.KV)()||void 0!==Ik.n2.process&&"renderer"===Ik.n2.process.type)}const cI=Ik.n2,lI="sentryReplaySession",uI="replay_event",dI="Unable to send Replay",hI=15e4,pI=5e3,fI=2e7,mI=36e5;var gI;function vI(e){const t=null===e||void 0===e?void 0:e.host;return Boolean((null===t||void 0===t?void 0:t.shadowRoot)===e)}function yI(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function bI(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,wI).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t):null}catch(n){return null}var t}function wI(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=bI(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(n){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e.cssText);return t||e.cssText}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(gI||(gI={}));class kI{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;const n=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!==n&&void 0!==n?n:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function SI({maskInputOptions:e,tagName:t,type:n}){return"OPTION"===t&&(t="SELECT"),Boolean(e[t.toLowerCase()]||n&&e[n]||"password"===n||"INPUT"===t&&!n&&e.text)}function TI({isMasked:e,element:t,value:n,maskInputFn:r}){let i=n||"";return e?(r&&(i=r(i,t)),"*".repeat(i.length)):i}function EI(e){return e.toLowerCase()}function CI(e){return e.toUpperCase()}const _I="__rrweb_original__";function xI(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?EI(t):null}function II(e,t,n){return"INPUT"!==t||"radio"!==n&&"checkbox"!==n?e.value:e.getAttribute("value")||""}let RI=1;const PI=new RegExp("[^a-z0-9-_:]"),OI=-2;function MI(){return RI++}let NI,AI;const DI=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,LI=/^(?:[a-z+]+:)?\/\//i,UI=/^www\..*/i,FI=/^(data:)([^,]*),(.*)/i;function BI(e,t){return(e||"").replace(DI,((e,n,r,i,o,s)=>{const a=r||o||s,c=n||i||"";if(!a)return e;if(LI.test(a)||UI.test(a))return`url(${c}${a}${c})`;if(FI.test(a))return`url(${c}${a}${c})`;if("/"===a[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${c})`;const l=t.split("/"),u=a.split("/");l.pop();for(const t of u)"."!==t&&(".."===t?l.pop():l.push(t));return`url(${c}${l.join("/")}${c})`}))}const jI=/^[^ \t\n\r\u000c]+/,zI=/^[, \t\n\r\u000c]+/;function VI(e,t){if(!t||""===t.trim())return t;const n=e.createElement("a");return n.href=t,n.href}function WI(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function qI(){const e=document.createElement("a");return e.href="",e.href}function $I(e,t,n,r,i,o){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?VI(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;const i=e.exec(t.substring(n));return i?(r=i[0],n+=r.length,r):""}const i=[];for(;r(zI),!(n>=t.length);){let o=r(jI);if(","===o.slice(-1))o=VI(e,o.substring(0,o.length-1)),i.push(o);else{let r="";o=VI(e,o);let s=!1;for(;;){const e=t.charAt(n);if(""===e){i.push((o+r).trim());break}if(s)")"===e&&(s=!1);else{if(","===e){n+=1,i.push((o+r).trim());break}"("===e&&(s=!0)}r+=e,n+=1}}}return i.join(", ")}(e,r):"style"===n?BI(r,qI()):"object"===t&&"data"===n?VI(e,r):"function"===typeof o?o(n,r,i):r:VI(e,r):r}function HI(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function JI(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:JI(e.parentNode,t,n,r+1):-1}function GI(e,t){return n=>{const r=n;if(null===r)return!1;if(e)if("string"===typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}}function YI(e,t,n,r,i,o){try{const s=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===s)return!1;let a=-1,c=-1;if(o){if(c=JI(s,GI(r,i)),c<0)return!0;a=JI(s,GI(t,n),c>=0?c:1/0)}else{if(a=JI(s,GI(t,n)),a<0)return!1;c=JI(s,GI(r,i),a>=0?a:1/0)}return a>=0?!(c>=0)||a<=c:!(c>=0)&&!!o}catch(s){}return!!o}function KI(e,t){const{doc:n,mirror:r,blockClass:i,blockSelector:o,unblockSelector:s,maskAllText:a,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:h,inlineStylesheet:p,maskInputOptions:f={},maskTextFn:m,maskInputFn:g,dataURLOptions:v={},inlineImages:y,recordCanvas:b,keepIframeSrcFn:w,newlyAddedElement:k=!1}=t,S=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:gI.Document,childNodes:[],compatMode:e.compatMode}:{type:gI.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:gI.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:S};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:r,blockSelector:i,unblockSelector:o,inlineStylesheet:s,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:h,keepIframeSrcFn:p,newlyAddedElement:f=!1,rootId:m,maskAllText:g,maskTextClass:v,unmaskTextClass:y,maskTextSelector:b,unmaskTextSelector:w}=t,k=function(e,t,n,r){try{if(r&&e.matches(r))return!1;if("string"===typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(i){}return!1}(e,r,i,o),S=function(e){if(e instanceof HTMLFormElement)return"form";const t=EI(e.tagName);return PI.test(t)?"div":t}(e);let T={};const E=e.attributes.length;for(let x=0;x<E;x++){const t=e.attributes[x];HI(S,t.name,t.value)||(T[t.name]=$I(n,S,EI(t.name),t.value,e,c))}if("link"===S&&s){const t=Array.from(n.styleSheets).find((t=>t.href===e.href));let r=null;t&&(r=bI(t)),r&&(delete T.rel,delete T.href,T._cssText=BI(r,t.href))}if("style"===S&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=bI(e.sheet);t&&(T._cssText=BI(t,qI()))}if("input"===S||"textarea"===S||"select"===S||"option"===S){const t=e,n=xI(t),r=II(t,CI(S),n),i=t.checked;if("submit"!==n&&"button"!==n&&r){const e=YI(t,v,b,y,w,SI({type:n,tagName:CI(S),maskInputOptions:a}));T.value=TI({isMasked:e,element:t,value:r,maskInputFn:l})}i&&(T.checked=i)}"option"===S&&(e.selected&&!a.select?T.selected=!0:delete T.selected);if("canvas"===S&&h)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){const i=t.getImageData,o=_I in i?i[_I]:i;if(new Uint32Array(o.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((e=>0!==e)))return!1}return!0})(e)||(T.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){const t=e.toDataURL(u.type,u.quality),n=document.createElement("canvas");n.width=e.width,n.height=e.height;t!==n.toDataURL(u.type,u.quality)&&(T.rr_dataURL=t)}if("img"===S&&d){NI||(NI=n.createElement("canvas"),AI=NI.getContext("2d"));const t=e,r=t.crossOrigin;t.crossOrigin="anonymous";const i=()=>{t.removeEventListener("load",i);try{NI.width=t.naturalWidth,NI.height=t.naturalHeight,AI.drawImage(t,0,0),T.rr_dataURL=NI.toDataURL(u.type,u.quality)}catch(e){console.warn(`Cannot inline img src=${t.currentSrc}! Error: ${e}`)}r?T.crossOrigin=r:t.removeAttribute("crossorigin")};t.complete&&0!==t.naturalWidth?i():t.addEventListener("load",i)}"audio"!==S&&"video"!==S||(T.rr_mediaState=e.paused?"paused":"played",T.rr_mediaCurrentTime=e.currentTime);f||(e.scrollLeft&&(T.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(T.rr_scrollTop=e.scrollTop));if(k){const{width:t,height:n}=e.getBoundingClientRect();T={class:T.class,rr_width:`${t}px`,rr_height:`${n}px`}}"iframe"!==S||p(T.src)||(e.contentDocument||(T.rr_src=T.src),delete T.src);let C;try{customElements.get(S)&&(C=!0)}catch(_){}return{type:gI.Element,tagName:S,attributes:T,childNodes:[],isSVG:WI(e)||void 0,needBlock:k,rootId:m,isCustom:C}}(e,{doc:n,blockClass:i,blockSelector:o,unblockSelector:s,inlineStylesheet:p,maskAttributeFn:c,maskInputOptions:f,maskInputFn:g,dataURLOptions:v,inlineImages:y,recordCanvas:b,keepIframeSrcFn:w,newlyAddedElement:k,rootId:S,maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:h});case e.TEXT_NODE:return function(e,t){var n;const{maskAllText:r,maskTextClass:i,unmaskTextClass:o,maskTextSelector:s,unmaskTextSelector:a,maskTextFn:c,maskInputOptions:l,maskInputFn:u,rootId:d}=t,h=e.parentNode&&e.parentNode.tagName;let p=e.textContent;const f="STYLE"===h||void 0,m="SCRIPT"===h||void 0,g="TEXTAREA"===h||void 0;if(f&&p){try{e.nextSibling||e.previousSibling||(null===(n=e.parentNode.sheet)||void 0===n?void 0:n.cssRules)&&(p=bI(e.parentNode.sheet))}catch(y){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${y}`,e)}p=BI(p,qI())}m&&(p="SCRIPT_PLACEHOLDER");const v=YI(e,i,s,o,a,r);f||m||g||!p||!v||(p=c?c(p):p.replace(/[\S]/g,"*"));g&&p&&(l.textarea||v)&&(p=u?u(p,e.parentNode):p.replace(/[\S]/g,"*"));if("OPTION"===h&&p){p=TI({isMasked:YI(e,i,s,o,a,SI({type:null,tagName:h,maskInputOptions:l})),element:e,value:p,maskInputFn:u})}return{type:gI.Text,textContent:p||"",isStyle:f,rootId:d}}(e,{maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:h,maskTextFn:m,maskInputOptions:f,maskInputFn:g,rootId:S});case e.CDATA_SECTION_NODE:return{type:gI.CDATA,textContent:"",rootId:S};case e.COMMENT_NODE:return{type:gI.Comment,textContent:e.textContent||"",rootId:S};default:return!1}}function XI(e){return void 0===e||null===e?"":e.toLowerCase()}function QI(e,t){const{doc:n,mirror:r,blockClass:i,blockSelector:o,unblockSelector:s,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:h=!1,inlineStylesheet:p=!0,maskInputOptions:f={},maskAttributeFn:m,maskTextFn:g,maskInputFn:v,slimDOMOptions:y,dataURLOptions:b={},inlineImages:w=!1,recordCanvas:k=!1,onSerialize:S,onIframeLoad:T,iframeLoadTimeout:E=5e3,onStylesheetLoad:C,stylesheetLoadTimeout:_=5e3,keepIframeSrcFn:x=(()=>!1),newlyAddedElement:I=!1}=t;let{preserveWhiteSpace:R=!0}=t;const P=KI(e,{doc:n,mirror:r,blockClass:i,blockSelector:o,maskAllText:a,unblockSelector:s,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:p,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:v,dataURLOptions:b,inlineImages:w,recordCanvas:k,keepIframeSrcFn:x,newlyAddedElement:I});if(!P)return console.warn(e,"not serialized"),null;let O;O=r.hasNode(e)?r.getId(e):!function(e,t){if(t.comment&&e.type===gI.Comment)return!0;if(e.type===gI.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"===typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(XI(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===XI(e.attributes.name)||"icon"===XI(e.attributes.rel)||"apple-touch-icon"===XI(e.attributes.rel)||"shortcut icon"===XI(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&XI(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(XI(e.attributes.property).match(/^(og|twitter|fb):/)||XI(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===XI(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===XI(e.attributes.name)||"googlebot"===XI(e.attributes.name)||"bingbot"===XI(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===XI(e.attributes.name)||"generator"===XI(e.attributes.name)||"framework"===XI(e.attributes.name)||"publisher"===XI(e.attributes.name)||"progid"===XI(e.attributes.name)||XI(e.attributes.property).match(/^article:/)||XI(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===XI(e.attributes.name)||"yandex-verification"===XI(e.attributes.name)||"csrf-token"===XI(e.attributes.name)||"p:domain_verify"===XI(e.attributes.name)||"verify-v1"===XI(e.attributes.name)||"verification"===XI(e.attributes.name)||"shopify-checkout-api-token"===XI(e.attributes.name)))return!0}}return!1}(P,y)&&(R||P.type!==gI.Text||P.isStyle||P.textContent.replace(/^\s+|\s+$/gm,"").length)?MI():OI;const M=Object.assign(P,{id:O});if(r.add(e,M),O===OI)return null;S&&S(e);let N=!h;if(M.type===gI.Element){N=N&&!M.needBlock,delete M.needBlock;const t=e.shadowRoot;t&&yI(t)&&(M.isShadowHost=!0)}if((M.type===gI.Document||M.type===gI.Element)&&N){y.headWhitespace&&M.type===gI.Element&&"head"===M.tagName&&(R=!1);const t={doc:n,mirror:r,blockClass:i,blockSelector:o,maskAllText:a,unblockSelector:s,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:h,inlineStylesheet:p,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:v,slimDOMOptions:y,dataURLOptions:b,inlineImages:w,recordCanvas:k,preserveWhiteSpace:R,onSerialize:S,onIframeLoad:T,iframeLoadTimeout:E,onStylesheetLoad:C,stylesheetLoadTimeout:_,keepIframeSrcFn:x};for(const n of Array.from(e.childNodes)){const e=QI(n,t);e&&M.childNodes.push(e)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const r=QI(n,t);r&&(yI(e.shadowRoot)&&(r.isShadow=!0),M.childNodes.push(r))}}return e.parentNode&&vI(e.parentNode)&&yI(e.parentNode)&&(M.isShadow=!0),M.type===gI.Element&&"iframe"===M.tagName&&function(e,t,n){const r=e.contentWindow;if(!r)return;let i,o=!1;try{i=r.document.readyState}catch(a){return}if("complete"!==i){const r=setTimeout((()=>{o||(t(),o=!0)}),n);return void e.addEventListener("load",(()=>{clearTimeout(r),o=!0,t()}))}const s="about:blank";if(r.location.href!==s||e.src===s||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,(()=>{const t=e.contentDocument;if(t&&T){const n=QI(t,{doc:t,mirror:r,blockClass:i,blockSelector:o,unblockSelector:s,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:p,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:v,slimDOMOptions:y,dataURLOptions:b,inlineImages:w,recordCanvas:k,preserveWhiteSpace:R,onSerialize:S,onIframeLoad:T,iframeLoadTimeout:E,onStylesheetLoad:C,stylesheetLoadTimeout:_,keepIframeSrcFn:x});n&&T(e,n)}}),E),M.type===gI.Element&&"link"===M.tagName&&"stylesheet"===M.attributes.rel&&function(e,t,n){let r,i=!1;try{r=e.sheet}catch(s){return}if(r)return;const o=setTimeout((()=>{i||(t(),i=!0)}),n);e.addEventListener("load",(()=>{clearTimeout(o),i=!0,t()}))}(e,(()=>{if(C){const t=QI(e,{doc:n,mirror:r,blockClass:i,blockSelector:o,unblockSelector:s,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:p,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:v,slimDOMOptions:y,dataURLOptions:b,inlineImages:w,recordCanvas:k,preserveWhiteSpace:R,onSerialize:S,onIframeLoad:T,iframeLoadTimeout:E,onStylesheetLoad:C,stylesheetLoadTimeout:_,keepIframeSrcFn:x});t&&C(e,t)}}),_),M}function ZI(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const eR="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let tR={map:{},getId:()=>(console.error(eR),-1),getNode:()=>(console.error(eR),null),removeNodeFromMap(){console.error(eR)},has:()=>(console.error(eR),!1),reset(){console.error(eR)}};function nR(e,t,n={}){let r=null,i=0;return function(...o){const s=Date.now();i||!1!==n.leading||(i=s);const a=t-(s-i),c=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),i=s,e.apply(c,o)):r||!1===n.trailing||(r=setTimeout((()=>{i=!1===n.leading?0:Date.now(),r=null,e.apply(c,o)}),a))}}function rR(e,t,n,r,i=window){const o=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,r?n:{set(e){setTimeout((()=>{n.set.call(this,e)}),0),o&&o.set&&o.set.call(this,e)}}),()=>rR(e,t,o||{},!0)}function iR(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],i=n(r);return"function"===typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=i,()=>{e[t]=r}}catch(r){return()=>{}}}"undefined"!==typeof window&&window.Proxy&&window.Reflect&&(tR=new Proxy(tR,{get:(e,t,n)=>("map"===t&&console.error(eR),Reflect.get(e,t,n))}));let oR=Date.now;function sR(e){var t,n,r,i,o,s;const a=e.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:(null===a||void 0===a?void 0:a.documentElement.scrollLeft)||(null===(n=null===(t=null===a||void 0===a?void 0:a.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===(r=null===a||void 0===a?void 0:a.body)||void 0===r?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null===a||void 0===a?void 0:a.documentElement.scrollTop)||(null===(o=null===(i=null===a||void 0===a?void 0:a.body)||void 0===i?void 0:i.parentElement)||void 0===o?void 0:o.scrollTop)||(null===(s=null===a||void 0===a?void 0:a.body)||void 0===s?void 0:s.scrollTop)||0}}function aR(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function cR(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function lR(e,t,n,r,i){if(!e)return!1;const o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!o)return!1;const s=GI(t,n);if(!i){const e=r&&o.matches(r);return s(o)&&!e}const a=JI(o,s);let c=-1;return!(a<0)&&(r&&(c=JI(o,GI(null,r))),a>-1&&c<0||a<c)}function uR(e,t){return t.getId(e)===OI}function dR(e,t){if(vI(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||dR(e.parentNode,t))}function hR(e){return Boolean(e.changedTouches)}function pR(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function fR(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function mR(e){return Boolean(null===e||void 0===e?void 0:e.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(oR=()=>(new Date).getTime());class gR{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return null!==(t=this.styleIDMap.get(e))&&void 0!==t?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function vR(e){var t,n;let r=null;return(null===(n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(r=e.getRootNode().host),r}function yR(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=vR(n);)n=t;return n}(e);return t.contains(n)}function bR(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||yR(e))}var wR=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(wR||{}),kR=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(kR||{}),SR=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(SR||{}),TR=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(TR||{});function ER(e){return"__ln"in e}class CR{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=(null===t||void 0===t?void 0:t.next)||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&ER(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&ER(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const _R=(e,t)=>`${e}@${t}`;class xR{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new CR,r=e=>{let t=e,n=OI;for(;n===OI;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},i=i=>{if(!i.parentNode||!bR(i))return;const o=vI(i.parentNode)?this.mirror.getId(vR(i)):this.mirror.getId(i.parentNode),s=r(i);if(-1===o||-1===s)return n.addNode(i);const a=QI(i,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{pR(e,this.mirror)&&this.iframeManager.addIframe(e),fR(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),mR(i)&&this.shadowDomManager.addShadowRoot(i.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});a&&(e.push({parentId:o,nextId:s,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const a of this.movedSet)RR(this.removes,a,this.mirror)&&!this.movedSet.has(a.parentNode)||i(a);for(const a of this.addedSet)OR(this.droppedSet,a)||RR(this.removes,a,this.mirror)?OR(this.movedSet,a)?i(a):this.droppedSet.add(a):i(a);let o=null;for(;n.length;){let e=null;if(o){const t=this.mirror.getId(o.value.parentNode),n=r(o.value);-1!==t&&-1!==n&&(e=o)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}o=e.previous,n.removeNode(e.value),i(e.value)}const s={texts:this.texts.map((e=>({id:this.mirror.getId(e.node),value:e.value}))).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>{const{attributes:t}=e;if("string"===typeof t.style){const n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(s.texts.length||s.attributes.length||s.removes.length||s.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(s))},this.processMutation=e=>{if(uR(e.target,this.mirror))return;let t;try{t=document.implementation.createHTMLDocument()}catch(n){t=this.doc}switch(e.type){case"characterData":{const t=e.target.textContent;lR(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||t===e.oldValue||this.texts.push({value:YI(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&t?this.maskTextFn?this.maskTextFn(t):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const n=e.target;let r=e.attributeName,i=e.target.getAttribute(r);if("value"===r){const t=xI(n),r=n.tagName;i=II(n,r,t);const o=SI({maskInputOptions:this.maskInputOptions,tagName:r,type:t});i=TI({isMasked:YI(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,o),element:n,value:i,maskInputFn:this.maskInputFn})}if(lR(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||i===e.oldValue)return;let o=this.attributes.find((t=>t.node===e.target));if("IFRAME"===n.tagName&&"src"===r&&!this.keepIframeSrcFn(i)){if(n.contentDocument)return;r="rr_src"}if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o)),"type"===r&&"INPUT"===n.tagName&&"password"===(e.oldValue||"").toLowerCase()&&n.setAttribute("data-rr-is-password","true"),!HI(n.tagName,r)&&(o.attributes[r]=$I(this.doc,EI(n.tagName),EI(r),i,n,this.maskAttributeFn),"style"===r)){const r=t.createElement("span");e.oldValue&&r.setAttribute("style",e.oldValue);for(const e of Array.from(n.style)){const t=n.style.getPropertyValue(e),i=n.style.getPropertyPriority(e);t!==r.style.getPropertyValue(e)||i!==r.style.getPropertyPriority(e)?o.styleDiff[e]=""===i?t:[t,i]:o._unchangedStyles[e]=[t,i]}for(const e of Array.from(r.style))""===n.style.getPropertyValue(e)&&(o.styleDiff[e]=!1)}break}case"childList":if(lR(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const n=this.mirror.getId(t),r=vI(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);lR(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||uR(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(IR(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||dR(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[_R(n,r)]?IR(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!vI(e.target)||!yI(e.target))||void 0})),this.mapRemoves.push(t))}))}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(uR(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[_R(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);lR(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach((e=>this.genAdds(e))),mR(e)&&e.shadowRoot.childNodes.forEach((t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)})))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function IR(e,t){e.delete(t),t.childNodes.forEach((t=>IR(e,t)))}function RR(e,t,n){return 0!==e.length&&PR(e,t,n)}function PR(e,t,n){const{parentNode:r}=t;if(!r)return!1;const i=n.getId(r);return!!e.some((e=>e.id===i))||PR(e,r,n)}function OR(e,t){return 0!==e.size&&MR(e,t)}function MR(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||MR(e,n))}let NR;const AR=e=>{if(!NR)return e;return(...t)=>{try{return e(...t)}catch(n){if(NR&&!0===NR(n))return()=>{};throw n}}},DR=[];function LR(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(t){}return e&&e.target}function UR(e,t){var n,r;const i=new xR;DR.push(i),i.init(e);let o=window.MutationObserver||window.__rrMutationObserver;const s=null===(r=null===(n=null===window||void 0===window?void 0:window.Zone)||void 0===n?void 0:n.__symbol__)||void 0===r?void 0:r.call(n,"MutationObserver");s&&window[s]&&(o=window[s]);const a=new o(AR((t=>{e.onMutation&&!1===e.onMutation(t)||i.processMutations.bind(i)(t)})));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function FR({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:o,sampling:s}){if(!1===s.mouseInteraction)return()=>{};const a=!0===s.mouseInteraction||void 0===s.mouseInteraction?{}:s.mouseInteraction,c=[];let l=null;return Object.keys(SR).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==a[e])).forEach((s=>{let a=EI(s);const u=(t=>s=>{const a=LR(s);if(lR(a,r,i,o,!0))return;let c=null,u=t;if("pointerType"in s){switch(s.pointerType){case"mouse":c=TR.Mouse;break;case"touch":c=TR.Touch;break;case"pen":c=TR.Pen}c===TR.Touch?SR[t]===SR.MouseDown?u="TouchStart":SR[t]===SR.MouseUp&&(u="TouchEnd"):TR.Pen}else hR(s)&&(c=TR.Touch);null!==c?(l=c,(u.startsWith("Touch")&&c===TR.Touch||u.startsWith("Mouse")&&c===TR.Mouse)&&(c=null)):SR[t]===SR.Click&&(c=l,l=null);const d=hR(s)?s.changedTouches[0]:s;if(!d)return;const h=n.getId(a),{clientX:p,clientY:f}=d;AR(e)(Object.assign({type:SR[u],id:h,x:p,y:f},null!==c&&{pointerType:c}))})(s);if(window.PointerEvent)switch(SR[s]){case SR.MouseDown:case SR.MouseUp:a=a.replace("mouse","pointer");break;case SR.TouchStart:case SR.TouchEnd:return}c.push(ZI(a,u,t))})),AR((()=>{c.forEach((e=>e()))}))}function BR({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:o,sampling:s}){return ZI("scroll",AR(nR(AR((s=>{const a=LR(s);if(!a||lR(a,r,i,o,!0))return;const c=n.getId(a);if(a===t&&t.defaultView){const n=sR(t.defaultView);e({id:c,x:n.left,y:n.top})}else e({id:c,x:a.scrollLeft,y:a.scrollTop})})),s.scroll||100)),t)}const jR=["INPUT","TEXTAREA","SELECT"],zR=new WeakMap;function VR({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:o,ignoreClass:s,ignoreSelector:a,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:h,unmaskTextClass:p,maskTextSelector:f,unmaskTextSelector:m}){function g(e){let n=LR(e);const u=e.isTrusted,g=n&&CI(n.tagName);if("OPTION"===g&&(n=n.parentElement),!n||!g||jR.indexOf(g)<0||lR(n,r,i,o,!0))return;const y=n;if(y.classList.contains(s)||a&&y.matches(a))return;const b=xI(n);let w=II(y,g,b),k=!1;const S=SI({maskInputOptions:c,tagName:g,type:b}),T=YI(n,h,f,p,m,S);"radio"!==b&&"checkbox"!==b||(k=n.checked),w=TI({isMasked:T,element:n,value:w,maskInputFn:l}),v(n,d?{text:w,isChecked:k,userTriggered:u}:{text:w,isChecked:k});const E=n.name;"radio"===b&&E&&k&&t.querySelectorAll(`input[type="radio"][name="${E}"]`).forEach((e=>{if(e!==n){const t=TI({isMasked:T,element:e,value:II(e,g,b),maskInputFn:l});v(e,d?{text:t,isChecked:!k,userTriggered:!1}:{text:t,isChecked:!k})}}))}function v(t,r){const i=zR.get(t);if(!i||i.text!==r.text||i.isChecked!==r.isChecked){zR.set(t,r);const i=n.getId(t);AR(e)(Object.assign(Object.assign({},r),{id:i}))}}const y=("last"===u.input?["change"]:["input","change"]).map((e=>ZI(e,AR(g),t))),b=t.defaultView;if(!b)return()=>{y.forEach((e=>e()))};const w=b.Object.getOwnPropertyDescriptor(b.HTMLInputElement.prototype,"value"),k=[[b.HTMLInputElement.prototype,"value"],[b.HTMLInputElement.prototype,"checked"],[b.HTMLSelectElement.prototype,"value"],[b.HTMLTextAreaElement.prototype,"value"],[b.HTMLSelectElement.prototype,"selectedIndex"],[b.HTMLOptionElement.prototype,"selected"]];return w&&w.set&&y.push(...k.map((e=>rR(e[0],e[1],{set(){AR(g)({target:this,isTrusted:!1})}},!1,b)))),AR((()=>{y.forEach((e=>e()))}))}function WR(e){return function(e,t){if(JR("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||JR("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||JR("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||JR("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function qR(e,t,n){let r,i;return e?(e.ownerNode?r=t.getId(e.ownerNode):i=n.getId(e),{styleId:i,id:r}):{}}function $R({mirror:e,stylesheetManager:t},n){var r,i,o;let s=null;s="#document"===n.nodeName?e.getId(n):e.getId(n.host);const a="#document"===n.nodeName?null===(r=n.defaultView)||void 0===r?void 0:r.Document:null===(o=null===(i=n.ownerDocument)||void 0===i?void 0:i.defaultView)||void 0===o?void 0:o.ShadowRoot,c=(null===a||void 0===a?void 0:a.prototype)?Object.getOwnPropertyDescriptor(null===a||void 0===a?void 0:a.prototype,"adoptedStyleSheets"):void 0;return null!==s&&-1!==s&&a&&c?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get(){var e;return null===(e=c.get)||void 0===e?void 0:e.call(this)},set(e){var n;const r=null===(n=c.set)||void 0===n?void 0:n.call(this,e);if(null!==s&&-1!==s)try{t.adoptStyleSheets(e,s)}catch(i){}return r}}),AR((()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}))):()=>{}}function HR(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};const r=UR(e,e.doc),i=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const i="number"===typeof t.mousemove?t.mousemove:50,o="number"===typeof t.mousemoveCallback?t.mousemoveCallback:500;let s,a=[];const c=nR(AR((t=>{const n=Date.now()-s;e(a.map((e=>(e.timeOffset-=n,e))),t),a=[],s=null})),o),l=AR(nR(AR((e=>{const t=LR(e),{clientX:n,clientY:i}=hR(e)?e.changedTouches[0]:e;s||(s=oR()),a.push({x:n,y:i,id:r.getId(t),timeOffset:oR()-s}),c("undefined"!==typeof DragEvent&&e instanceof DragEvent?kR.Drag:e instanceof MouseEvent?kR.MouseMove:kR.TouchMove)})),i,{trailing:!1})),u=[ZI("mousemove",l,n),ZI("touchmove",l,n),ZI("drag",l,n)];return AR((()=>{u.forEach((e=>e()))}))}(e),o=FR(e),s=BR(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return ZI("resize",AR(nR(AR((()=>{const t=aR(),i=cR();n===t&&r===i||(e({width:Number(i),height:Number(t)}),n=t,r=i)})),200)),t)}(e,{win:n}),c=VR(e),l=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,unblockSelector:r,mirror:i,sampling:o,doc:s}){const a=AR((s=>nR(AR((o=>{const a=LR(o);if(!a||lR(a,t,n,r,!0))return;const{currentTime:c,volume:l,muted:u,playbackRate:d}=a;e({type:s,id:i.getId(a),currentTime:c,volume:l,muted:u,playbackRate:d})})),o.media||500))),c=[ZI("play",a(0),s),ZI("pause",a(1),s),ZI("seeked",a(2),s),ZI("volumechange",a(3),s),ZI("ratechange",a(4),s)];return AR((()=>{c.forEach((e=>e()))}))}(e),u=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const i=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:AR(((r,i,o)=>{const[s,a]=o,{id:c,styleId:l}=qR(i,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:s,index:a}]}),r.apply(i,o)}))});const o=r.CSSStyleSheet.prototype.deleteRule;let s,a;r.CSSStyleSheet.prototype.deleteRule=new Proxy(o,{apply:AR(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=qR(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:s}]}),r.apply(i,o)}))}),r.CSSStyleSheet.prototype.replace&&(s=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(s,{apply:AR(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=qR(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replace:s}),r.apply(i,o)}))})),r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:AR(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=qR(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replaceSync:s}),r.apply(i,o)}))}));const c={};GR("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(GR("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),GR("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),GR("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach((([r,i])=>{l[r]={insertRule:i.prototype.insertRule,deleteRule:i.prototype.deleteRule},i.prototype.insertRule=new Proxy(l[r].insertRule,{apply:AR(((r,i,o)=>{const[s,a]=o,{id:c,styleId:l}=qR(i.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:s,index:[...WR(i),a||0]}]}),r.apply(i,o)}))}),i.prototype.deleteRule=new Proxy(l[r].deleteRule,{apply:AR(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=qR(i.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:[...WR(i),s]}]}),r.apply(i,o)}))})})),AR((()=>{r.CSSStyleSheet.prototype.insertRule=i,r.CSSStyleSheet.prototype.deleteRule=o,s&&(r.CSSStyleSheet.prototype.replace=s),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach((([e,t])=>{t.prototype.insertRule=l[e].insertRule,t.prototype.deleteRule=l[e].deleteRule}))}))}(e,{win:n}),d=$R(e,e.doc),h=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){const o=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(o,{apply:AR(((i,s,a)=>{var c;const[l,u,d]=a;if(n.has(l))return o.apply(s,[l,u,d]);const{id:h,styleId:p}=qR(null===(c=s.parentRule)||void 0===c?void 0:c.parentStyleSheet,t,r.styleMirror);return(h&&-1!==h||p&&-1!==p)&&e({id:h,styleId:p,set:{property:l,value:u,priority:d},index:WR(s.parentRule)}),i.apply(s,a)}))});const s=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(s,{apply:AR(((i,o,a)=>{var c;const[l]=a;if(n.has(l))return s.apply(o,[l]);const{id:u,styleId:d}=qR(null===(c=o.parentRule)||void 0===c?void 0:c.parentStyleSheet,t,r.styleMirror);return(u&&-1!==u||d&&-1!==d)&&e({id:u,styleId:d,remove:{property:l},index:WR(o.parentRule)}),i.apply(o,a)}))}),AR((()=>{i.CSSStyleDeclaration.prototype.setProperty=o,i.CSSStyleDeclaration.prototype.removeProperty=s}))}(e,{win:n}),p=e.collectFonts?function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],i=new WeakMap,o=n.FontFace;n.FontFace=function(e,t,n){const r=new o(e,t,n);return i.set(r,{family:e,buffer:"string"!==typeof t,descriptors:n,fontSource:"string"===typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const s=iR(t.fonts,"add",(function(t){return function(n){return setTimeout(AR((()=>{const t=i.get(n);t&&(e(t),i.delete(n))})),0),t.apply(this,[n])}}));return r.push((()=>{n.FontFace=o})),r.push(s),AR((()=>{r.forEach((e=>e()))}))}(e):()=>{},f=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:o,selectionCb:s}=e;let a=!0;const c=AR((()=>{const e=t.getSelection();if(!e||a&&(null===e||void 0===e?void 0:e.isCollapsed))return;a=e.isCollapsed||!1;const c=[],l=e.rangeCount||0;for(let t=0;t<l;t++){const s=e.getRangeAt(t),{startContainer:a,startOffset:l,endContainer:u,endOffset:d}=s;lR(a,r,i,o,!0)||lR(u,r,i,o,!0)||c.push({start:n.getId(a),startOffset:l,end:n.getId(u),endOffset:d})}s({ranges:c})}));return c(),ZI("selectionchange",c)}(e),m=function({doc:e,customElementCb:t}){const n=e.defaultView;return n&&n.customElements?iR(n.customElements,"define",(function(e){return function(n,r,i){try{t({define:{name:n}})}catch(o){}return e.apply(this,[n,r,i])}})):()=>{}}(e);return AR((()=>{DR.forEach((e=>e.reset())),r.disconnect(),i(),o(),s(),a(),c(),l(),u(),d(),h(),p(),f(),m()}))}function JR(e){return"undefined"!==typeof window[e]}function GR(e){return Boolean("undefined"!==typeof window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class YR{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){const i=n||this.getIdToRemoteIdMap(e),o=r||this.getRemoteIdToIdMap(e);let s=i.get(t);return s||(s=this.generateIdFn(),i.set(t,s),o.set(s,t)),s}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,n,r)))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);if("number"!==typeof t)return t;const i=r.get(t);return i||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,n)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class KR{constructor(){this.crossOriginIframeMirror=new YR(MI),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class XR{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new YR(MI),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new YR(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}transformCrossOriginEvent(e,t){var n;switch(t.type){case wR.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:wR.IncrementalSnapshot,data:{source:kR.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case wR.Meta:case wR.Load:case wR.DomContentLoaded:return!1;case wR.Plugin:return t;case wR.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case wR.IncrementalSnapshot:switch(t.data.source){case kR.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case kR.Drag:case kR.TouchMove:case kR.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case kR.ViewportResize:return!1;case kR.MediaInteraction:case kR.MouseInteraction:case kR.Scroll:case kR.CanvasMutation:case kR.Input:return this.replaceIds(t.data,e,["id"]),t;case kR.StyleSheetRule:case kR.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case kR.Font:return t;case kR.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case kR.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(n=t.data.styles)||void 0===n||n.forEach((t=>{this.replaceStyleIds(t,e,["styleId"])})),t}}return!1}replace(e,t,n,r){for(const i of r)(Array.isArray(t[i])||"number"===typeof t[i])&&(Array.isArray(t[i])?t[i]=e.getIds(n,t[i]):t[i]=e.getId(n,t[i]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===gI.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}}class QR{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class ZR{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!yI(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e);const n=UR(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push((()=>n.disconnect())),this.restoreHandlers.push(BR(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout((()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push($R({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))}),0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(iR(e.prototype,"attachShadow",(function(e){return function(r){const i=e.call(this,r);return this.shadowRoot&&bR(this)&&n.addShadowRoot(this.shadowRoot,t),i}})))}reset(){this.restoreHandlers.forEach((e=>{try{e()}catch(t){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class eP{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}}class tP{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new gR,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const i of e){let e;this.styleMirror.has(i)?e=this.styleMirror.getId(i):(e=this.styleMirror.add(i),r.push({styleId:e,rules:Array.from(i.rules||CSSRule,((e,t)=>({rule:wI(e),index:t})))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class nP{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some((e=>e!==t))}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function rP(e){const t=e;return t.timestamp=oR(),t}let iP;const oP=new kI;function sP(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:i="rr-block",blockSelector:o=null,unblockSelector:s=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:h=null,unmaskTextSelector:p=null,inlineStylesheet:f=!0,maskAllInputs:m,maskInputOptions:g,slimDOMOptions:v,maskAttributeFn:y,maskInputFn:b,maskTextFn:w,packFn:k,sampling:S={},dataURLOptions:T={},mousemoveWait:E,recordCanvas:C=!1,recordCrossOriginIframes:_=!1,recordAfter:x=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:I=!1,collectFonts:R=!1,inlineImages:P=!1,keepIframeSrcFn:O=(()=>!1),ignoreCSSAttributes:M=new Set([]),errorHandler:N,onMutation:A,getCanvasManager:D}=e;!function(e){NR=e}(N);const L=!_||window.parent===window;let U=!1;if(!L)try{window.parent.document&&(U=!1)}catch(Z){U=!0}if(L&&!t)throw new Error("emit function is required");void 0!==E&&void 0===S.mousemove&&(S.mousemove=E),oP.reset();const F=!0===m?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==g?g:{},B=!0===v||"all"===v?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===v,headMetaDescKeywords:"all"===v}:v||{};let j;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let z=0;const V=e=>(k&&!U&&(e=k(e)),e),W=(e,i)=>{var o;if(!(null===(o=DR[0])||void 0===o?void 0:o.isFrozen())||e.type===wR.FullSnapshot||e.type===wR.IncrementalSnapshot&&e.data.source===kR.Mutation||DR.forEach((e=>e.unfreeze())),L)null===t||void 0===t||t(V(e),i);else if(U){const t={type:"rrweb",event:V(e),origin:window.location.origin,isCheckout:i};window.parent.postMessage(t,"*")}if(e.type===wR.FullSnapshot)j=e,z=0;else if(e.type===wR.IncrementalSnapshot){if(e.data.source===kR.Mutation&&e.data.isAttachIframe)return;z++;const t=r&&z>=r,i=n&&e.timestamp-j.timestamp>n;(t||i)&&Q(!0)}},q=e=>{W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.Mutation},e)}))},$=e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.Scroll},e)})),H=e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.CanvasMutation},e)})),J=new tP({mutationCb:q,adoptedStyleSheetCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.AdoptedStyleSheet},e)}))}),G="boolean"===typeof __RRWEB_EXCLUDE_IFRAME__&&__RRWEB_EXCLUDE_IFRAME__?new KR:new XR({mirror:oP,mutationCb:q,stylesheetManager:J,recordCrossOriginIframes:_,wrappedEmit:W}),Y=new nP,K=D?D({recordCanvas:C,blockClass:i,blockSelector:o,unblockSelector:s,sampling:S.canvas,dataURLOptions:T}):new eP,X="boolean"===typeof __RRWEB_EXCLUDE_SHADOW_DOM__&&__RRWEB_EXCLUDE_SHADOW_DOM__?new QR:new ZR({mutationCb:q,scrollCb:$,bypassOptions:{onMutation:A,blockClass:i,blockSelector:o,unblockSelector:s,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:h,unmaskTextSelector:p,inlineStylesheet:f,maskInputOptions:F,dataURLOptions:T,maskAttributeFn:y,maskTextFn:w,maskInputFn:b,recordCanvas:C,inlineImages:P,sampling:S,slimDOMOptions:B,iframeManager:G,stylesheetManager:J,canvasManager:K,keepIframeSrcFn:O,processedNodeManager:Y},mirror:oP}),Q=(e=!1)=>{W(rP({type:wR.Meta,data:{href:window.location.href,width:cR(),height:aR()}}),e),J.reset(),X.init(),DR.forEach((e=>e.lock()));const t=function(e,t){const{mirror:n=new kI,blockClass:r="rr-block",blockSelector:i=null,unblockSelector:o=null,maskAllText:s=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:h=!1,recordCanvas:p=!1,maskAllInputs:f=!1,maskAttributeFn:m,maskTextFn:g,maskInputFn:v,slimDOM:y=!1,dataURLOptions:b,preserveWhiteSpace:w,onSerialize:k,onIframeLoad:S,iframeLoadTimeout:T,onStylesheetLoad:E,stylesheetLoadTimeout:C,keepIframeSrcFn:_=(()=>!1)}=t||{};return QI(e,{doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:o,maskAllText:s,maskTextClass:a,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:!0===f?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===f?{}:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:v,slimDOMOptions:!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===y,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===y?{}:y,dataURLOptions:b,inlineImages:h,recordCanvas:p,preserveWhiteSpace:w,onSerialize:k,onIframeLoad:S,iframeLoadTimeout:T,onStylesheetLoad:E,stylesheetLoadTimeout:C,keepIframeSrcFn:_,newlyAddedElement:!1})}(document,{mirror:oP,blockClass:i,blockSelector:o,unblockSelector:s,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:h,unmaskTextSelector:p,inlineStylesheet:f,maskAllInputs:F,maskAttributeFn:y,maskInputFn:b,maskTextFn:w,slimDOM:B,dataURLOptions:T,recordCanvas:C,inlineImages:P,onSerialize:e=>{pR(e,oP)&&G.addIframe(e),fR(e,oP)&&J.trackLinkElement(e),mR(e)&&X.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{G.attachIframe(e,t),X.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{J.attachLinkElement(e,t)},keepIframeSrcFn:O});if(!t)return console.warn("Failed to snapshot the document");W(rP({type:wR.FullSnapshot,data:{node:t,initialOffset:sR(window)}}),e),DR.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&J.adoptStyleSheets(document.adoptedStyleSheets,oP.getId(document))};iP=Q;try{const e=[],t=e=>AR(HR)({onMutation:A,mutationCb:q,mousemoveCb:(e,t)=>W(rP({type:wR.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.MouseInteraction},e)})),scrollCb:$,viewportResizeCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.ViewportResize},e)})),inputCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.Input},e)})),mediaInteractionCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.MediaInteraction},e)})),styleSheetRuleCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.StyleSheetRule},e)})),styleDeclarationCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.StyleDeclaration},e)})),canvasMutationCb:H,fontCb:e=>W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.Font},e)})),selectionCb:e=>{W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.Selection},e)}))},customElementCb:e=>{W(rP({type:wR.IncrementalSnapshot,data:Object.assign({source:kR.CustomElement},e)}))},blockClass:i,ignoreClass:a,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:h,unmaskTextSelector:p,maskInputOptions:F,inlineStylesheet:f,sampling:S,recordCanvas:C,inlineImages:P,userTriggeredOnInput:I,collectFonts:R,doc:e,maskAttributeFn:y,maskInputFn:b,maskTextFn:w,keepIframeSrcFn:O,blockSelector:o,unblockSelector:s,slimDOMOptions:B,dataURLOptions:T,mirror:oP,iframeManager:G,stylesheetManager:J,shadowDomManager:X,processedNodeManager:Y,canvasManager:K,ignoreCSSAttributes:M,plugins:[]},{});G.addLoadListener((n=>{try{e.push(t(n.contentDocument))}catch(r){console.warn(r)}}));const n=()=>{Q(),e.push(t(document))};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(ZI("DOMContentLoaded",(()=>{W(rP({type:wR.DomContentLoaded,data:{}})),"DOMContentLoaded"===x&&n()}))),e.push(ZI("load",(()=>{W(rP({type:wR.Load,data:{}})),"load"===x&&n()}),window))),()=>{e.forEach((e=>e())),Y.destroy(),iP=void 0,NR=void 0}}catch(ee){console.warn(ee)}}sP.mirror=oP,sP.takeFullSnapshot=function(e){if(!iP)throw new Error("please take full snapshot after start recording");iP(e)};const aP=3;function cP(e){return e>9999999999?e:1e3*e}function lP(e){return e>9999999999?e/1e3:e}function uP(e,t){"sentry.transaction"!==t.category&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate((()=>(e.throttledAddEvent({type:wR.Custom,timestamp:1e3*(t.timestamp||0),data:{tag:"breadcrumb",payload:DS(t,10,1e3)}}),"console"===t.category))))}const dP="button,a";function hP(e){return e.closest(dP)||e}function pP(e){const t=fP(e);return t&&t instanceof Element?hP(t):t}function fP(e){return function(e){return"object"===typeof e&&!!e&&"target"in e}(e)?e.target:e}let mP;function gP(e){return mP||(mP=[],Vk(cI,"open",(function(e){return function(...t){if(mP)try{mP.forEach((e=>e()))}catch(n){}return e.apply(cI,t)}}))),mP.push(e),()=>{const t=mP?mP.indexOf(e):-1;t>-1&&mP.splice(t,1)}}class vP{constructor(e,t,n=uP){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=t.timeout/1e3,this._threshold=t.threshold/1e3,this._scollTimeout=t.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=t.ignoreSelector,this._addBreadcrumbEvent=n}addListeners(){const e=gP((()=>{this._lastMutation=bP()}));this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,t){if(function(e,t){if(!yP.includes(e.tagName))return!0;if("INPUT"===e.tagName&&!["submit","button"].includes(e.getAttribute("type")||""))return!0;if("A"===e.tagName&&(e.hasAttribute("download")||e.hasAttribute("target")&&"_self"!==e.getAttribute("target")))return!0;if(t&&e.matches(t))return!0;return!1}(t,this._ignoreSelector)||!function(e){return!(!e.data||"number"!==typeof e.data.nodeId||!e.timestamp)}(e))return;const n={timestamp:lP(e.timestamp),clickBreadcrumb:e,clickCount:0,node:t};this._clicks.some((e=>e.node===n.node&&Math.abs(e.timestamp-n.timestamp)<1))||(this._clicks.push(n),1===this._clicks.length&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=lP(e)}registerScroll(e=Date.now()){this._lastScroll=lP(e)}registerClick(e){const t=hP(e);this._handleMultiClick(t)}_handleMultiClick(e){this._getClicks(e).forEach((e=>{e.clickCount++}))}_getClicks(e){return this._clicks.filter((t=>t.node===e))}_checkClicks(){const e=[],t=bP();this._clicks.forEach((n=>{!n.mutationAfter&&this._lastMutation&&(n.mutationAfter=n.timestamp<=this._lastMutation?this._lastMutation-n.timestamp:void 0),!n.scrollAfter&&this._lastScroll&&(n.scrollAfter=n.timestamp<=this._lastScroll?this._lastScroll-n.timestamp:void 0),n.timestamp+this._timeout<=t&&e.push(n)}));for(const n of e){const e=this._clicks.indexOf(n);e>-1&&(this._generateBreadcrumbs(n),this._clicks.splice(e,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const t=this._replay,n=e.scrollAfter&&e.scrollAfter<=this._scollTimeout,r=e.mutationAfter&&e.mutationAfter<=this._threshold,i=!n&&!r,{clickCount:o,clickBreadcrumb:s}=e;if(i){const n=1e3*Math.min(e.mutationAfter||this._timeout,this._timeout),r=n<1e3*this._timeout?"mutation":"timeout",i={type:"default",message:s.message,timestamp:s.timestamp,category:"ui.slowClickDetected",data:{...s.data,url:cI.location.href,route:t.getCurrentRoute(),timeAfterClickMs:n,endReason:r,clickCount:o||1}};this._addBreadcrumbEvent(t,i)}else if(o>1){const e={type:"default",message:s.message,timestamp:s.timestamp,category:"ui.multiClick",data:{...s.data,url:cI.location.href,route:t.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(t,e)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout((()=>this._checkClicks()),1e3)}}const yP=["A","BUTTON","INPUT"];function bP(){return Date.now()/1e3}function wP(e,t){try{if(!function(e){return e.type===aP}(t))return;const{source:n}=t.data;if(n===kR.Mutation&&e.registerMutation(t.timestamp),n===kR.Scroll&&e.registerScroll(t.timestamp),function(e){return e.data.source===kR.MouseInteraction}(t)){const{type:n,id:r}=t.data,i=sP.mirror.getNode(r);i instanceof HTMLElement&&n===SR.Click&&e.registerClick(i)}}catch(n){}}function kP(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var SP;!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(SP||(SP={}));const TP=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled"]);function EP(e){const t={};for(const n in e)if(TP.has(n)){let r=n;"data-testid"!==n&&"data-test-id"!==n||(r="testId"),t[r]=e[n]}return t}const CP=e=>t=>{if(!e.isEnabled())return;const n=function(e){const{target:t,message:n}=function(e){const t="click"===e.name;let n,r=null;try{r=t?pP(e.event):fP(e.event),n=Ok(r,{maxStringLength:200})||"<unknown>"}catch(i){n="<unknown>"}return{target:r,message:n}}(e);return kP({category:`ui.${e.name}`,..._P(t,n)})}(t);if(!n)return;const r="click"===t.name,i=r?t.event:void 0;!(r&&e.clickDetector&&i&&i.target)||i.altKey||i.metaKey||i.ctrlKey||i.shiftKey||function(e,t,n){e.handleClick(t,n)}(e.clickDetector,n,pP(t.event)),uP(e,n)};function _P(e,t){const n=sP.mirror.getId(e),r=n&&sP.mirror.getNode(n),i=r&&sP.mirror.getMeta(r),o=i&&function(e){return e.type===SP.Element}(i)?i:null;return{message:t,data:o?{nodeId:n,node:{id:n,tagName:o.tagName,textContent:Array.from(o.childNodes).map((e=>e.type===SP.Text&&e.textContent)).filter(Boolean).map((e=>e.trim())).join(""),attributes:EP(o.attributes)}}:{}}}function xP(e,t){if(!e.isEnabled())return;e.updateUserActivity();const n=function(e){const{metaKey:t,shiftKey:n,ctrlKey:r,altKey:i,key:o,target:s}=e;if(!s||function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable}(s)||!o)return null;const a=t||r||i,c=1===o.length;if(!a&&c)return null;const l=Ok(s,{maxStringLength:200})||"<unknown>",u=_P(s,l);return kP({category:"ui.keyDown",message:l,data:{...u.data,metaKey:t,shiftKey:n,ctrlKey:r,altKey:i,key:o}})}(t);n&&uP(e,n)}const IP={resource:function(e){const{entryType:t,initiatorType:n,name:r,responseEnd:i,startTime:o,decodedBodySize:s,encodedBodySize:a,responseStatus:c,transferSize:l}=e;if(["fetch","xmlhttprequest"].includes(n))return null;return{type:`${t}.${n}`,start:PP(o),end:PP(i),name:r,data:{size:l,statusCode:c,decodedBodySize:s,encodedBodySize:a}}},paint:function(e){const{duration:t,entryType:n,name:r,startTime:i}=e,o=PP(i);return{type:n,name:r,start:o,end:o+t,data:void 0}},navigation:function(e){const{entryType:t,name:n,decodedBodySize:r,duration:i,domComplete:o,encodedBodySize:s,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:h,startTime:p,transferSize:f,type:m}=e;if(0===i)return null;return{type:`${t}.${m}`,start:PP(p),end:PP(o),name:n,data:{size:f,decodedBodySize:r,encodedBodySize:s,duration:i,domInteractive:l,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:o,redirectCount:h}}}};function RP(e){return IP[e.entryType]?IP[e.entryType](e):null}function PP(e){return((iS.Z1||cI.performance.timeOrigin)+e)/1e3}function OP(e){function t(t){e.performanceEntries.includes(t)||e.performanceEntries.push(t)}function n({entries:e}){e.forEach(t)}const r=[];return["navigation","paint","resource"].forEach((e=>{r.push(Ix(e,n))})),r.push(xx((({metric:t})=>{e.replayPerformanceEntries.push(function(e){const t=e.entries,n=t[t.length-1],r=n?n.element:void 0,i=e.value,o=PP(i);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:o,end:o,data:{value:i,size:i,nodeId:r?sP.mirror.getId(r):void 0}}}(t))}))),()=>{r.forEach((e=>e()))}}const MP="undefined"===typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,NP='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function AP(e,t){MP&&(Uk.info(e),t&&LP(e))}function DP(e,t){MP&&(Uk.info(e),t&&setTimeout((()=>{LP(e)}),0))}function LP(e){ES().addBreadcrumb({category:"console",data:{logger:"replay"},level:"info",message:e},{level:"info"})}class UP extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}class FP{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const t=JSON.stringify(e).length;if(this._totalSize+=t,this._totalSize>fI)throw new UP;this.events.push(e)}finish(){return new Promise((e=>{const t=this.events;this.clear(),e(JSON.stringify(t))}))}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map((e=>e.timestamp)).sort()[0];return e?cP(e):null}}class BP{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise(((e,t)=>{this._worker.addEventListener("message",(({data:n})=>{n.success?e():t()}),{once:!0}),this._worker.addEventListener("error",(e=>{t(e)}),{once:!0})}))),this._ensureReadyPromise}destroy(){AP("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(e,t){const n=this._getAndIncrementId();return new Promise(((r,i)=>{const o=({data:t})=>{const s=t;if(s.method===e&&s.id===n){if(this._worker.removeEventListener("message",o),!s.success)return MP&&Uk.error("[Replay]",s.response),void i(new Error("Error in compression worker"));r(s.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:n,method:e,arg:t})}))}_getAndIncrementId(){return this._id++}}class jP{constructor(e){this._worker=new BP(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const t=cP(e.timestamp);(!this._earliestTimestamp||t<this._earliestTimestamp)&&(this._earliestTimestamp=t);const n=JSON.stringify(e);return this._totalSize+=n.length,this._totalSize>fI?Promise.reject(new UP):this._sendEventToWorker(n)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear")}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class zP{constructor(e){this._fallback=new FP,this._compression=new jP(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(e){return void AP("[Replay] Failed to load the compression worker, falling back to simple buffer")}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:t}=this._fallback,n=[];for(const i of e)n.push(this._compression.addEvent(i));this._compression.hasCheckout=t,this._used=this._compression;try{await Promise.all(n)}catch(r){MP&&Uk.warn("[Replay] Failed to add events when switching buffers.",r)}}}function VP({useCompression:e,workerUrl:t}){if(e&&window.Worker){const e=function(e){try{const t=e||function(){if("undefined"===typeof __SENTRY_EXCLUDE_REPLAY_WORKER__||!__SENTRY_EXCLUDE_REPLAY_WORKER__)return function(){const e=new Blob([NP]);return URL.createObjectURL(e)}();return""}();if(!t)return;AP("[Replay] Using compression worker"+(e?` from ${e}`:""));const n=new Worker(t);return new zP(n)}catch(t){AP("[Replay] Failed to create compression worker")}}(t);if(e)return e}return AP("[Replay] Using simple buffer"),new FP}function WP(){try{return"sessionStorage"in cI&&!!cI.sessionStorage}catch(e){return!1}}function qP(e){!function(){if(!WP())return;try{cI.sessionStorage.removeItem(lI)}catch(e){}}(),e.session=void 0}function $P(e){return void 0!==e&&Math.random()<e}function HP(e){const t=Date.now();return{id:e.id||Xk(),started:e.started||t,lastActivity:e.lastActivity||t,segmentId:e.segmentId||0,sampled:e.sampled,previousSessionId:e.previousSessionId}}function JP(e){if(WP())try{cI.sessionStorage.setItem(lI,JSON.stringify(e))}catch(t){}}function GP({sessionSampleRate:e,allowBuffering:t,stickySession:n=!1},{previousSessionId:r}={}){const i=function(e,t){return $P(e)?"session":!!t&&"buffer"}(e,t),o=HP({sampled:i,previousSessionId:r});return n&&JP(o),o}function YP(e,t,n=+new Date){return null===e||void 0===t||t<0||0!==t&&e+t<=n}function KP(e,{maxReplayDuration:t,sessionIdleExpire:n,targetTime:r=Date.now()}){return YP(e.started,t,r)||YP(e.lastActivity,n,r)}function XP(e,{sessionIdleExpire:t,maxReplayDuration:n}){return!!KP(e,{sessionIdleExpire:t,maxReplayDuration:n})&&("buffer"!==e.sampled||0!==e.segmentId)}function QP({traceInternals:e,sessionIdleExpire:t,maxReplayDuration:n,previousSessionId:r},i){const o=i.stickySession&&function(e){if(!WP())return null;try{const t=cI.sessionStorage.getItem(lI);if(!t)return null;const n=JSON.parse(t);return DP("[Replay] Loading existing session",e),HP(n)}catch(t){return null}}(e);return o?XP(o,{sessionIdleExpire:t,maxReplayDuration:n})?(DP("[Replay] Session in sessionStorage is expired, creating new one..."),GP(i,{previousSessionId:o.id})):o:(DP("[Replay] Creating new session",e),GP(i,{previousSessionId:r}))}function ZP(e,t,n){return!!tO(e,t)&&(eO(e,t,n),!0)}async function eO(e,t,n){if(!e.eventBuffer)return null;try{n&&"buffer"===e.recordingMode&&e.eventBuffer.clear(),n&&(e.eventBuffer.hasCheckout=!0);const r=function(e,t){try{if("function"===typeof t&&function(e){return e.type===wR.Custom}(e))return t(e)}catch(n){return MP&&Uk.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",n),null}return e}(t,e.getOptions().beforeAddRecordingEvent);if(!r)return;return await e.eventBuffer.addEvent(r)}catch(r){const t=r&&r instanceof UP?"addEventSizeExceeded":"addEvent";MP&&Uk.error(r),await e.stop({reason:t});const n=qS();n&&n.recordDroppedEvent("internal_sdk_error","replay")}}function tO(e,t){if(!e.eventBuffer||e.isPaused()||!e.isEnabled())return!1;const n=cP(t.timestamp);return!(n+e.timeouts.sessionIdlePause<Date.now())&&(!(n>e.getContext().initialTimestamp+e.getOptions().maxReplayDuration)||(AP(`[Replay] Skipping event with timestamp ${n} because it is after maxReplayDuration`,e.getOptions()._experiments.traceInternals),!1))}function nO(e){return!e.type}function rO(e){return"transaction"===e.type}function iO(e){return"feedback"===e.type}function oO(e){const t=function(){const e=qS();if(!e)return!1;const t=e.getTransport();if(!t)return!1;return t.send.__sentry__baseTransport__||!1}();return(n,r)=>{if(!e.isEnabled()||!nO(n)&&!rO(n))return;const i=r&&r.statusCode;t&&(!i||i<200||i>=300)||(rO(n)?function(e,t){const n=e.getContext();t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(t.contexts.trace.trace_id)}(e,n):function(e,t){const n=e.getContext();t.event_id&&n.errorIds.size<100&&n.errorIds.add(t.event_id);if("buffer"!==e.recordingMode||!t.tags||!t.tags.replayId)return;const{beforeErrorSampling:r}=e.getOptions();if("function"===typeof r&&!r(t))return;setTimeout((()=>{e.sendBufferedReplayOrFlush()}))}(e,n))}}function sO(e,t=!1){const n=t?oO(e):void 0;return Object.assign(((t,r)=>{if(!e.isEnabled())return t;if(function(e){return"replay_event"===e.type}(t))return delete t.breadcrumbs,t;if(!nO(t)&&!rO(t)&&!iO(t))return t;if(!e.checkAndHandleExpiredSession())return t;if(iO(t))return e.flush(),t.contexts.feedback.replay_id=e.getSessionId(),function(e,t){e.triggerUserActivity(),e.addUpdate((()=>!t.timestamp||(e.throttledAddEvent({type:wR.Custom,timestamp:1e3*t.timestamp,data:{timestamp:t.timestamp,tag:"breadcrumb",payload:{category:"sentry.feedback",data:{feedbackId:t.event_id}}}}),!1)))}(e,t),t;if(function(e,t){return!(e.type||!e.exception||!e.exception.values||!e.exception.values.length)&&!(!t.originalException||!t.originalException.__rrweb__)}(t,r)&&!e.getOptions()._experiments.captureExceptions)return MP&&Uk.log("[Replay] Ignoring error from rrweb internals",t),null;const i=function(e,t){return"buffer"===e.recordingMode&&t.message!==dI&&!(!t.exception||t.type)&&$P(e.getOptions().errorSampleRate)}(e,t);return(i||"session"===e.recordingMode)&&(t.tags={...t.tags,replayId:e.getSessionId()}),n&&n(t,{statusCode:200}),t}),{id:"Replay"})}function aO(e,t){return t.map((({type:t,start:n,end:r,name:i,data:o})=>{const s=e.throttledAddEvent({type:wR.Custom,timestamp:n,data:{tag:"performanceSpan",payload:{op:t,description:i,startTimestamp:n,endTimestamp:r,data:o}}});return"string"===typeof s?Promise.resolve(null):s}))}function cO(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{from:t,to:n}=e,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:t}}}(t);null!==n&&(e.getContext().urls.push(n.name),e.triggerUserActivity(),e.addUpdate((()=>(aO(e,[n]),!1))))}}function lO(e,t){e.isEnabled()&&null!==t&&(function(e,t){return(!MP||!e.getOptions()._experiments.traceInternals)&&iI(t,ES())}(e,t.name)||e.addUpdate((()=>(aO(e,[t]),!0))))}function uO(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{startTimestamp:t,endTimestamp:n,xhr:r}=e,i=r[CE];if(!t||!n||!i)return null;const{method:o,url:s,status_code:a}=i;return void 0===s?null:{type:"resource.xhr",name:s,start:t/1e3,end:n/1e3,data:{method:o,statusCode:a}}}(t);lO(e,n)}}function dO(e,t){if(e)try{if("string"===typeof e)return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const n=bO(e);return t.encode(n).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch(n){}}function hO(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function pO(e){try{if("string"===typeof e)return[e];if(e instanceof URLSearchParams)return[e.toString()];if(e instanceof FormData)return[bO(e)];if(!e)return[void 0]}catch(t){return MP&&Uk.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return MP&&Uk.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function fO(e,t){if(!e)return{headers:{},size:void 0,_meta:{warnings:[t]}};const n={...e._meta},r=n.warnings||[];return n.warnings=[...r,t],e._meta=n,e}function mO(e,t){if(!t)return null;const{startTimestamp:n,endTimestamp:r,url:i,method:o,statusCode:s,request:a,response:c}=t;return{type:e,start:n/1e3,end:r/1e3,name:i,data:Yk({method:o,statusCode:s,request:a,response:c})}}function gO(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function vO(e,t,n){if(!t&&0===Object.keys(e).length)return;if(!t)return{headers:e};if(!n)return{headers:e,size:t};const r={headers:e,size:t},{body:i,warnings:o}=function(e){if(!e||"string"!==typeof e)return{body:e};const t=e.length>hI,n=function(e){const t=e[0],n=e[e.length-1];return"["===t&&"]"===n||"{"===t&&"}"===n}(e);if(t){const t=e.slice(0,hI);return n?{body:t,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${t}\u2026`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(e)}}catch(r){}return{body:e}}(n);return r.body=i,o&&o.length>0&&(r._meta={warnings:o}),r}function yO(e,t){return Object.keys(e).reduce(((n,r)=>{const i=r.toLowerCase();return t.includes(i)&&e[r]&&(n[i]=e[r]),n}),{})}function bO(e){return new URLSearchParams(e).toString()}function wO(e,t){const n=function(e,t=cI.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(cI.location.origin))return e;const n=new URL(e,t);if(n.origin!==new URL(t).origin)return e;const r=n.href;if(!e.endsWith("/")&&r.endsWith("/"))return r.slice(0,-1);return r}(e);return zk(n,t)}async function kO(e,t,n){try{const r=await async function(e,t,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:o=r}=t,{url:s,method:a,status_code:c=0,request_body_size:l,response_body_size:u}=e.data,d=wO(s,n.networkDetailAllowUrls)&&!wO(s,n.networkDetailDenyUrls),h=d?function({networkCaptureBodies:e,networkRequestHeaders:t},n,r){const i=n?function(e,t){if(1===e.length&&"string"!==typeof e[0])return EO(e[0],t);if(2===e.length)return EO(e[1],t);return{}}(n,t):{};if(!e)return vO(i,r,void 0);const o=SO(n),[s,a]=pO(o),c=vO(i,r,s);if(a)return fO(c,a);return c}(n,t.input,l):gO(l),p=await async function(e,{networkCaptureBodies:t,textEncoder:n,networkResponseHeaders:r},i,o){if(!e&&void 0!==o)return gO(o);const s=i?TO(i.headers,r):{};if(!i||!t&&void 0!==o)return vO(s,o,void 0);const[a,c]=await async function(e){const t=function(e){try{return e.clone()}catch(t){MP&&Uk.warn("[Replay] Failed to clone response body",t)}}(e);if(!t)return[void 0,"BODY_PARSE_ERROR"];try{const e=await function(e){return new Promise(((t,n)=>{const r=setTimeout((()=>n(new Error("Timeout while trying to read response body"))),500);(async function(e){return await e.text()})(e).then((e=>t(e)),(e=>n(e))).finally((()=>clearTimeout(r)))}))}(t);return[e]}catch(n){return MP&&Uk.warn("[Replay] Failed to get text body from response",n),[void 0,"BODY_PARSE_ERROR"]}}(i),l=function(e,{networkCaptureBodies:t,textEncoder:n,responseBodySize:r,captureDetails:i,headers:o}){try{const s=e&&e.length&&void 0===r?dO(e,n):r;return i?vO(o,s,t?e:void 0):gO(s)}catch(s){return MP&&Uk.warn("[Replay] Failed to serialize response body",s),vO(o,r,void 0)}}(a,{networkCaptureBodies:t,textEncoder:n,responseBodySize:o,captureDetails:e,headers:s});if(c)return fO(l,c);return l}(d,n,t.response,u);return{startTimestamp:i,endTimestamp:o,url:s,method:a,statusCode:c,request:h,response:p}}(e,t,n),i=mO("resource.fetch",r);lO(n.replay,i)}catch(r){MP&&Uk.error("[Replay] Failed to capture fetch breadcrumb",r)}}function SO(e=[]){if(2===e.length&&"object"===typeof e[1])return e[1].body}function TO(e,t){const n={};return t.forEach((t=>{e.get(t)&&(n[t]=e.get(t))})),n}function EO(e,t){if(!e)return{};const n=e.headers;return n?n instanceof Headers?TO(n,t):Array.isArray(n)?{}:yO(n,t):{}}async function CO(e,t,n){try{const r=function(e,t,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:o=r,input:s,xhr:a}=t,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:h}=e.data;if(!c)return null;if(!a||!wO(c,n.networkDetailAllowUrls)||wO(c,n.networkDetailDenyUrls)){return{startTimestamp:i,endTimestamp:o,url:c,method:l,statusCode:u,request:gO(d),response:gO(h)}}const p=a[CE],f=p?yO(p.request_headers,n.networkRequestHeaders):{},m=yO(function(e){const t=e.getAllResponseHeaders();if(!t)return{};return t.split("\r\n").reduce(((e,t)=>{const[n,r]=t.split(": ");return e[n.toLowerCase()]=r,e}),{})}(a),n.networkResponseHeaders),[g,v]=n.networkCaptureBodies?pO(s):[void 0],[y,b]=n.networkCaptureBodies?function(e){const t=[];try{return[e.responseText]}catch(n){t.push(n)}try{return function(e,t){try{if("string"===typeof e)return[e];if(e instanceof Document)return[e.body.outerHTML];if("json"===t&&e&&"object"===typeof e)return[JSON.stringify(e)];if(!e)return[void 0]}catch(n){return MP&&Uk.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return MP&&Uk.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}(e.response,e.responseType)}catch(n){t.push(n)}return MP&&Uk.warn("[Replay] Failed to get xhr response body",...t),[void 0]}(a):[void 0],w=vO(f,d,g),k=vO(m,h,y);return{startTimestamp:i,endTimestamp:o,url:c,method:l,statusCode:u,request:v?fO(w,v):w,response:b?fO(k,b):k}}(e,t,n),i=mO("resource.xhr",r);lO(n.replay,i)}catch(r){MP&&Uk.error("[Replay] Failed to capture xhr breadcrumb",r)}}function _O(e,t,n){const{xhr:r,input:i}=t;if(!r)return;const o=dO(i,n.textEncoder),s=r.getResponseHeader("content-length")?hO(r.getResponseHeader("content-length")):function(e,t,n){try{return dO("json"===t&&e&&"object"===typeof e?JSON.stringify(e):e,n)}catch(r){return}}(r.response,r.responseType,n.textEncoder);void 0!==o&&(e.data.request_body_size=o),void 0!==s&&(e.data.response_body_size=s)}function xO(e){const t=qS();try{const n=new TextEncoder,{networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:o,networkRequestHeaders:s,networkResponseHeaders:a}=e.getOptions(),c={replay:e,textEncoder:n,networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:o,networkRequestHeaders:s,networkResponseHeaders:a};t&&t.on?t.on("beforeAddBreadcrumb",((e,t)=>function(e,t,n){if(!t.data)return;try{(function(e){return"xhr"===e.category})(t)&&function(e){return e&&e.xhr}(n)&&(_O(t,n,e),CO(t,n,e)),function(e){return"fetch"===e.category}(t)&&function(e){return e&&e.response}(n)&&(!function(e,t,n){const{input:r,response:i}=t,o=dO(r?SO(r):void 0,n.textEncoder),s=i?hO(i.headers.get("content-length")):void 0;void 0!==o&&(e.data.request_body_size=o),void 0!==s&&(e.data.response_body_size=s)}(t,n,e),kO(t,n,e))}catch(r){MP&&Uk.warn("Error when enriching network breadcrumb")}}(c,e,t))):(IE(function(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{startTimestamp:t,endTimestamp:n,fetchData:r,response:i}=e;if(!n)return null;const{method:o,url:s}=r;return{type:"resource.fetch",start:t/1e3,end:n/1e3,name:s,data:{method:o,statusCode:i?i.status:void 0}}}(t);lO(e,n)}}(e)),_E(uO(e)))}catch(n){}}let IO=null;const RO=e=>t=>{if(!e.isEnabled())return;const n=function(e){const t=e.getLastBreadcrumb&&e.getLastBreadcrumb();if(IO===t||!t)return null;if(IO=t,!function(e){return!!e.category}(t)||["fetch","xhr","sentry.event","sentry.transaction"].includes(t.category)||t.category.startsWith("ui."))return null;if("console"===t.category)return function(e){const t=e.data&&e.data.arguments;if(!Array.isArray(t)||0===t.length)return kP(e);let n=!1;const r=t.map((e=>{if(!e)return e;if("string"===typeof e)return e.length>pI?(n=!0,`${e.slice(0,pI)}\u2026`):e;if("object"===typeof e)try{const t=DS(e,7);return JSON.stringify(t).length>pI?(n=!0,`${JSON.stringify(t,null,2).slice(0,pI)}\u2026`):t}catch(t){}return e}));return kP({...e,data:{...e.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(t);return kP(t)}(t);n&&uP(e,n)};function PO(e){const t=ES().getScope(),n=qS();t.addScopeListener(RO(e)),kE(CP(e)),bT(cO(e)),xO(e);const r=sO(e,!OO(n));n&&n.addEventProcessor?n.addEventProcessor(r):function(e){const t=ES().getClient();t&&t.addEventProcessor&&t.addEventProcessor(e)}(r),OO(n)&&(n.on("afterSendEvent",oO(e)),n.on("createDsc",(t=>{const n=e.getSessionId();if(n&&e.isEnabled()&&"session"===e.recordingMode){e.checkAndHandleExpiredSession()&&(t.replay_id=n)}})),n.on("startTransaction",(t=>{e.lastTransaction=t})),n.on("finishTransaction",(t=>{e.lastTransaction=t})),n.on("beforeSendFeedback",((t,n)=>{const r=e.getSessionId();n&&n.includeReplay&&e.isEnabled()&&r&&(e.flush(),t.contexts&&t.contexts.feedback&&(t.contexts.feedback.replay_id=r))})))}function OO(e){return!(!e||!e.on)}function MO(e){const{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}=e,i=Date.now()/1e3;return{type:"memory",name:"memory",start:i,end:i,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}}}}function NO(e){let t=!1;return(n,r)=>{if(!e.checkAndHandleExpiredSession())return void(MP&&Uk.warn("[Replay] Received replay event after session expired."));const i=r||!t;t=!0,e.clickDetector&&wP(e.clickDetector,n),e.addUpdate((()=>{if("buffer"===e.recordingMode&&i&&e.setInitialState(),!ZP(e,n,i))return!0;if(!i)return!1;if(function(e,t){if(!t||!e.session||0!==e.session.segmentId)return;ZP(e,function(e){const t=e.getOptions();return{type:wR.Custom,timestamp:Date.now(),data:{tag:"options",payload:{sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:!!e.eventBuffer&&"worker"===e.eventBuffer.type,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}(e),!1)}(e,i),e.session&&e.session.previousSessionId)return!0;if("buffer"===e.recordingMode&&e.session&&e.eventBuffer){const t=e.eventBuffer.getEarliestTimestamp();t&&(AP(`[Replay] Updating session start time to earliest event in buffer to ${new Date(t)}`,e.getOptions()._experiments.traceInternals),e.session.started=t,e.getOptions().stickySession&&JP(e.session))}return"session"===e.recordingMode&&e.flush(),!0}))}}async function AO({recordingData:e,replayId:t,segmentId:n,eventContext:r,timestamp:i,session:o}){const s=function({recordingData:e,headers:t}){let n;const r=`${JSON.stringify(t)}\n`;if("string"===typeof e)n=`${r}${e}`;else{const t=(new TextEncoder).encode(r);n=new Uint8Array(t.length+e.length),n.set(t),n.set(e,t.length)}return n}({recordingData:e,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=ES(),h=d.getClient(),p=d.getScope(),f=h&&h.getTransport(),m=h&&h.getDsn();if(!h||!f||!m||!o.sampled)return;const g={type:uI,replay_start_timestamp:u/1e3,timestamp:i/1e3,error_ids:c,trace_ids:l,urls:a,replay_id:t,segment_id:n,replay_type:o.sampled},v=await async function({client:e,scope:t,replayId:n,event:r}){const i={event_id:n,integrations:"object"!==typeof e._integrations||null===e._integrations||Array.isArray(e._integrations)?void 0:Object.keys(e._integrations)};e.emit&&e.emit("preprocessEvent",r,i);const o=await FS(e.getOptions(),r,i,t,e);if(!o)return null;o.platform=o.platform||"javascript";const s=e.getSdkMetadata&&e.getSdkMetadata(),{name:a,version:c}=s&&s.sdk||{};return o.sdk={...o.sdk,name:a||"sentry.javascript.unknown",version:c||"0.0.0"},o}({scope:p,client:h,replayId:t,event:g});if(!v)return h.recordDroppedEvent("event_processor","replay",g),void AP("An event processor returned `null`, will not send event.");delete v.sdkProcessingMetadata;const y=function(e,t,n,r){return kT(PT(e,RT(e),r,n),[[{type:"replay_event"},e],[{type:"replay_recording",length:"string"===typeof t?(new TextEncoder).encode(t).length:t.length},t]])}(v,s,m,h.getOptions().tunnel);let b;try{b=await f.send(y)}catch(k){const e=new Error(dI);try{e.cause=k}catch(S){}throw e}if(!b)return b;if("number"===typeof b.statusCode&&(b.statusCode<200||b.statusCode>=300))throw new DO(b.statusCode);const w=dC({},b);if(uC(w,"replay"))throw new LO(w);return b}class DO extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class LO extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function UO(e,t={count:0,interval:5e3}){const{recordingData:n,options:r}=e;if(n.length)try{return await AO(e),!0}catch(i){if(i instanceof DO||i instanceof LO)throw i;if(function(e,t){ES().setContext(e,t)}("Replays",{_retryCount:t.count}),MP&&r._experiments&&r._experiments.captureExceptions&&VS(i),t.count>=3){const e=new Error(`${dI} - max retries exceeded`);try{e.cause=i}catch(o){}throw e}return t.interval*=++t.count,new Promise(((n,r)=>{setTimeout((async()=>{try{await UO(e,t),n(!0)}catch(i){r(i)}}),t.interval)}))}}const FO="__THROTTLED";function BO(e,t,n){const r=new Map;let i=!1;return(...o)=>{const s=Math.floor(Date.now()/1e3);if((e=>{const t=e-n;r.forEach(((e,n)=>{n<t&&r.delete(n)}))})(s),[...r.values()].reduce(((e,t)=>e+t),0)>=t){const e=i;return i=!0,e?"__SKIPPED":FO}i=!1;const a=r.get(s)||0;return r.set(s,a+1),e(...o)}}class jO{constructor({options:e,recordingOptions:t}){jO.prototype.__init.call(this),jO.prototype.__init2.call(this),jO.prototype.__init3.call(this),jO.prototype.__init4.call(this),jO.prototype.__init5.call(this),jO.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=t,this._options=e,this._debouncedFlush=function(e,t,n){let r,i,o;const s=n&&n.maxWait?Math.max(n.maxWait,t):0;function a(){return c(),r=e(),r}function c(){void 0!==i&&clearTimeout(i),void 0!==o&&clearTimeout(o),i=o=void 0}function l(){return i&&clearTimeout(i),i=setTimeout(a,t),s&&void 0===o&&(o=setTimeout(a,s)),r}return l.cancel=c,l.flush=function(){return void 0!==i||void 0!==o?a():r},l}((()=>this._flush()),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=BO(((e,t)=>function(e,t,n){return tO(e,t)?eO(e,t,n):Promise.resolve(null)}(this,e,t)),300,5);const{slowClickTimeout:n,slowClickIgnoreSelectors:r}=this.getOptions(),i=n?{threshold:Math.min(3e3,n),timeout:n,scrollTimeout:300,ignoreSelector:r?r.join(","):""}:void 0;i&&(this.clickDetector=new vP(this,i))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}getOptions(){return this._options}initializeSampling(e){const{errorSampleRate:t,sessionSampleRate:n}=this._options;t<=0&&n<=0||(this._initializeSessionForSampling(e),this.session?!1!==this.session.sampled&&(this.recordingMode="buffer"===this.session.sampled&&0===this.session.segmentId?"buffer":"session",DP(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording()):this._handleException(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)throw new Error("Replay recording is already in progress");if(this._isEnabled&&"buffer"===this.recordingMode)throw new Error("Replay buffering is in progress, call `flush()` to save the replay");DP("[Replay] Starting replay in session mode",this._options._experiments.traceInternals);const e=QP({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");DP("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const e=QP({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{this._stopRecording=sP({...this._recordingOptions,..."buffer"===this.recordingMode&&{checkoutEveryNms:6e4},emit:NO(this),onMutation:this._onMutationHandler})}catch(e){this._handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this._handleException(e),!1}}async stop({forceFlush:e=!1,reason:t}={}){if(this._isEnabled){this._isEnabled=!1;try{AP("[Replay] Stopping Replay"+(t?` triggered by ${t}`:""),this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,qP(this)}catch(n){this._handleException(n)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),AP("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){this._isPaused&&this._checkSession()&&(this._isPaused=!1,this.startRecording(),AP("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const t=Date.now();AP("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const n=this.stopRecording();e&&n&&"session"!==this.recordingMode&&(this.recordingMode="session",this.session&&(this._updateUserActivity(t),this._updateSessionActivity(t),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const t=e();"buffer"!==this.recordingMode&&!0!==t&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._checkSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(!(this._lastActivity&&YP(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled))return!!this._checkSession();this.pause()}setInitialState(){const e=`${cI.location.pathname}${cI.location.hash}${cI.location.search}`,t=`${cI.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=t,this._context.initialTimestamp=Date.now(),this._context.urls.push(t)}throttledAddEvent(e,t){const n=this._throttledAddEvent(e,t);if(n===FO){const e=kP({category:"replay.throttled"});this.addUpdate((()=>!ZP(this,{type:5,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e,metric:!0}})))}return n}getCurrentRoute(){const e=this.lastTransaction||ES().getScope().getTransaction();if(e&&["route","custom"].includes(e.metadata.source))return e.name}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=VP({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(e){MP&&Uk.error("[Replay]",e),MP&&this._options._experiments&&this._options._experiments.captureExceptions&&VS(e)}_initializeSessionForSampling(e){const t=this._options.errorSampleRate>0,n=QP({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:t});this.session=n}_checkSession(){if(!this.session)return!1;const e=this.session;return!XP(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})||(this._refreshSession(e),!1)}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{cI.document.addEventListener("visibilitychange",this._handleVisibilityChange),cI.addEventListener("blur",this._handleWindowBlur),cI.addEventListener("focus",this._handleWindowFocus),cI.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(PO(this),this._hasInitializedCoreListeners=!0)}catch(e){this._handleException(e)}this._performanceCleanupCallback=OP(this)}_removeListeners(){try{cI.document.removeEventListener("visibilitychange",this._handleVisibilityChange),cI.removeEventListener("blur",this._handleWindowBlur),cI.removeEventListener("focus",this._handleWindowFocus),cI.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this._handleException(e)}}__init(){this._handleVisibilityChange=()=>{"visible"===cI.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=kP({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=kP({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{xP(this,e)}}_doChangeToBackgroundTasks(e){if(!this.session)return;KP(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;this.checkAndHandleExpiredSession()?e&&this._createCustomBreadcrumb(e):AP("[Replay] Document has become active, but session has expired")}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate((()=>{this.throttledAddEvent({type:wR.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})}))}_addPerformanceEntries(){const e=(t=this.performanceEntries,t.map(RP).filter(Boolean)).concat(this.replayPerformanceEntries);var t;return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(aO(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:t}=this;if(!e||!t)return;if(e.segmentId)return;const n=t.getEarliestTimestamp();n&&n<this._context.initialTimestamp&&(this._context.initialTimestamp=n)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(this.session&&this.eventBuffer&&e){if(await this._addPerformanceEntries(),this.eventBuffer&&this.eventBuffer.hasEvents&&(await async function(e){try{return Promise.all(aO(e,[MO(cI.performance.memory)]))}catch(t){return[]}}(this),this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const t=Date.now();if(t-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const n=this._popEventContext(),r=this.session.segmentId++;this._maybeSaveSession();const i=await this.eventBuffer.finish();await UO({replayId:e,recordingData:i,segmentId:r,eventContext:n,session:this.session,options:this.getOptions(),timestamp:t})}catch(t){this._handleException(t),this.stop({reason:"sendReplay"});const e=qS();e&&e.recordDroppedEvent("send_error","replay")}}else MP&&Uk.error("[Replay] No session or eventBuffer found to flush.")}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession())return void(MP&&Uk.error("[Replay] Attempting to finish replay event after session expired."));if(!this.session)return;const t=this.session.started,n=Date.now()-t;this._debouncedFlush.cancel();const r=n<this._options.minReplayDuration,i=n>this._options.maxReplayDuration+5e3;if(r||i)return AP(`[Replay] Session duration (${Math.floor(n/1e3)}s) is too ${r?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),void(r&&this._debouncedFlush());const o=this.eventBuffer;if(o&&0===this.session.segmentId&&!o.hasCheckout&&AP("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock)return this._flushLock=this._runFlush(),await this._flushLock,void(this._flushLock=void 0);try{await this._flushLock}catch(s){MP&&Uk.error(s)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&JP(this.session)}__init6(){this._onMutationHandler=e=>{const t=e.length,n=this._options.mutationLimit,r=n&&t>n;if(t>this._options.mutationBreadcrumbLimit||r){const e=kP({category:"replay.mutations",data:{count:t,limit:r}});this._createCustomBreadcrumb(e)}return!r||(this.stop({reason:"mutationLimit",forceFlush:"session"===this.recordingMode}),!1)}}}function zO(e,t,n,r){const i=[...e,..."string"===typeof r?r.split(","):[],...t];return"undefined"!==typeof n&&("string"===typeof n&&i.push(`.${n}`),Lk((()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")}))),i.join(",")}const VO='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',WO=["content-length","content-type","accept"];let qO=!1;class $O{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=5e3,flushMaxDelay:t=5500,minReplayDuration:n=4999,maxReplayDuration:r=36e5,stickySession:i=!0,useCompression:o=!0,workerUrl:s,_experiments:a={},sessionSampleRate:c,errorSampleRate:l,maskAllText:u=!0,maskAllInputs:d=!0,blockAllMedia:h=!0,mutationBreadcrumbLimit:p=750,mutationLimit:f=1e4,slowClickTimeout:m=7e3,slowClickIgnoreSelectors:g=[],networkDetailAllowUrls:v=[],networkDetailDenyUrls:y=[],networkCaptureBodies:b=!0,networkRequestHeaders:w=[],networkResponseHeaders:k=[],mask:S=[],maskAttributes:T=["title","placeholder"],unmask:E=[],block:C=[],unblock:_=[],ignore:x=[],maskFn:I,beforeAddRecordingEvent:R,beforeErrorSampling:P,blockClass:O,blockSelector:M,maskInputOptions:N,maskTextClass:A,maskTextSelector:D,ignoreClass:L}={}){this.name=$O.id;const U=function({mask:e,unmask:t,block:n,unblock:r,ignore:i,blockClass:o,blockSelector:s,maskTextClass:a,maskTextSelector:c,ignoreClass:l}){const u={maskTextSelector:zO(e,[".sentry-mask","[data-sentry-mask]"],a,c),unmaskTextSelector:zO(t,[".sentry-unmask","[data-sentry-unmask]"]),blockSelector:zO(n,[".sentry-block","[data-sentry-block]",'base[href="/"]'],o,s),unblockSelector:zO(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:zO(i,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],l)};return o instanceof RegExp&&(u.blockClass=o),a instanceof RegExp&&(u.maskTextClass=a),u}({mask:S,unmask:E,block:C,unblock:_,ignore:x,blockClass:O,blockSelector:M,maskTextClass:A,maskTextSelector:D,ignoreClass:L});if(this._recordingOptions={maskAllInputs:d,maskAllText:u,maskInputOptions:{...N||{},password:!0},maskTextFn:I,maskInputFn:I,maskAttributeFn:(e,t,n)=>function({el:e,key:t,maskAttributes:n,maskAllText:r,privacyOptions:i,value:o}){return r?i.unmaskTextSelector&&e.matches(i.unmaskTextSelector)?o:n.includes(t)||"value"===t&&"INPUT"===e.tagName&&["submit","button"].includes(e.getAttribute("type")||"")?o.replace(/[\S]/g,"*"):o:o}({maskAttributes:T,maskAllText:u,privacyOptions:U,key:e,value:t,el:n}),...U,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:e=>{try{e.__rrweb__=!0}catch(t){}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:t,minReplayDuration:Math.min(n,15e3),maxReplayDuration:Math.min(r,mI),stickySession:i,sessionSampleRate:c,errorSampleRate:l,useCompression:o,workerUrl:s,blockAllMedia:h,maskAllInputs:d,maskAllText:u,mutationBreadcrumbLimit:p,mutationLimit:f,slowClickTimeout:m,slowClickIgnoreSelectors:g,networkDetailAllowUrls:v,networkDetailDenyUrls:y,networkCaptureBodies:b,networkRequestHeaders:HO(w),networkResponseHeaders:HO(k),beforeAddRecordingEvent:R,beforeErrorSampling:P,_experiments:a},"number"===typeof c&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysSessionSampleRate: ${c} })`),this._initialOptions.sessionSampleRate=c),"number"===typeof l&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysOnErrorSampleRate: ${l} })`),this._initialOptions.errorSampleRate=l),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${VO}`:VO),this._isInitialized&&aI())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return qO}set _isInitialized(e){qO=e}setupOnce(){aI()&&(this._setup(),setTimeout((()=>this._initialize())))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:"session"===this._replay.recordingMode}):Promise.resolve()}flush(e){return this._replay&&this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(e):Promise.resolve()}getReplayId(){if(this._replay&&this._replay.isEnabled())return this._replay.getSessionId()}_initialize(){this._replay&&this._replay.initializeSampling()}_setup(){const e=function(e){const t=qS(),n=t&&t.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...Yk(e)};if(!n)return Lk((()=>{console.warn("SDK client is not available.")})),r;null==e.sessionSampleRate&&null==e.errorSampleRate&&null==n.replaysSessionSampleRate&&null==n.replaysOnErrorSampleRate&&Lk((()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}));"number"===typeof n.replaysSessionSampleRate&&(r.sessionSampleRate=n.replaysSessionSampleRate);"number"===typeof n.replaysOnErrorSampleRate&&(r.errorSampleRate=n.replaysOnErrorSampleRate);return r}(this._initialOptions);this._replay=new jO({options:e,recordingOptions:this._recordingOptions})}}function HO(e){return[...WO,...e.map((e=>e.toLowerCase()))]}$O.__initStatic(),function(e){const t={_metadata:{},...e};t._metadata.sdk=t._metadata.sdk||{name:"sentry.javascript.react",packages:[{name:"npm:@sentry/react",version:yS}],version:yS},wC(t)}({dsn:"https://2356c3ef12dad1afcb30defd749d96f1@new.q-continuum.net/2",integrations:[new class{constructor(e){this.name="BrowserTracing",this._hasSetTracePropagationTargets=!1,ax(),cx&&(this._hasSetTracePropagationTargets=!(!e||!e.tracePropagationTargets&&!e.tracingOrigins)),this.options={...nI,...e},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=$x(),this.options.enableLongTask&&Ix("longtask",(({entries:e})=>{for(const t of e){const e=Z_();if(!e)return;const n=Bx(iS.Z1+t.startTime),r=Bx(t.duration);e.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+r})}})),this.options._experiments.enableInteractions&&Ix("event",(({entries:e})=>{for(const t of e){const e=Z_();if(!e)return;if("click"===t.name){const n=Bx(iS.Z1+t.startTime),r=Bx(t.duration);e.startChild({description:Ok(t.target),op:`ui.interaction.${t.name}`,origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+r})}}}))}setupOnce(e,t){this._getCurrentHub=t;const n=t().getClient(),r=n&&n.getOptions(),{routingInstrumentation:i,startTransactionOnLocationChange:o,startTransactionOnPageLoad:s,markBackgroundTransactions:a,traceFetch:c,traceXHR:l,shouldCreateSpanForRequest:u,enableHTTPTimings:d,_experiments:h}=this.options,p=r&&r.tracePropagationTargets,f=p||this.options.tracePropagationTargets;cx&&this._hasSetTracePropagationTargets&&p&&Uk.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),i((e=>{const n=this._createRouteTransaction(e);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(n,e,t),n}),s,o),a&&(lx&&lx.document?lx.document.addEventListener("visibilitychange",(()=>{const e=Z_();if(lx.document.hidden&&e){const t="cancelled";cx&&Uk.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${e.op}`),e.status||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.finish()}})):cx&&Uk.warn("[Tracing] Could not set up background tab detection due to lack of global document")),h.enableInteractions&&this._registerInteractionListener(),Qx({traceFetch:c,traceXHR:l,tracePropagationTargets:f,shouldCreateSpanForRequest:u,enableHTTPTimings:d})}_createRouteTransaction(e){if(!this._getCurrentHub)return void(cx&&Uk.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`));const t=this._getCurrentHub(),{beforeNavigate:n,idleTimeout:r,finalTimeout:i,heartbeatInterval:o}=this.options,s="pageload"===e.op,a=s?rI("sentry-trace"):"",c=s?rI("baggage"):"",{traceparentData:l,dynamicSamplingContext:u,propagationContext:d}=q_(a,c),h={...e,...l,metadata:{...e.metadata,dynamicSamplingContext:l&&!u?{}:u},trimEnd:!0},p="function"===typeof n?n(h):h,f=void 0===p?{...h,sampled:!1}:p;f.metadata=f.name!==h.name?{...f.metadata,source:"custom"}:f.metadata,this._latestRouteName=f.name,this._latestRouteSource=f.metadata&&f.metadata.source,!1===f.sampled&&cx&&Uk.log(`[Tracing] Will not send ${f.op} transaction because of beforeNavigate.`),cx&&Uk.log(`[Tracing] Starting ${f.op} transaction on scope`);const{location:m}=lx,g=sx(t,f,r,i,!0,{location:m},o),v=t.getScope();return s&&l?v.setPropagationContext(d):v.setPropagationContext({traceId:g.traceId,spanId:g.spanId,parentSpanId:g.parentSpanId,sampled:g.sampled}),g.registerBeforeFinishCallback((e=>{this._collectWebVitals(),Hx(e)})),g}_registerInteractionListener(){let e;const t=()=>{const{idleTimeout:t,finalTimeout:n,heartbeatInterval:r}=this.options,i="ui.action.click",o=Z_();if(o&&o.op&&["navigation","pageload"].includes(o.op))return void(cx&&Uk.warn(`[Tracing] Did not create ${i} transaction because a pageload or navigation transaction is in progress.`));if(e&&(e.setFinishReason("interactionInterrupted"),e.finish(),e=void 0),!this._getCurrentHub)return void(cx&&Uk.warn(`[Tracing] Did not create ${i} transaction because _getCurrentHub is invalid.`));if(!this._latestRouteName)return void(cx&&Uk.warn(`[Tracing] Did not create ${i} transaction because _latestRouteName is missing.`));const s=this._getCurrentHub(),{location:a}=lx,c={name:this._latestRouteName,op:i,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=sx(s,c,t,n,!0,{location:a},r)};["click"].forEach((e=>{addEventListener(e,t,{once:!1,capture:!0})}))}}({tracePropagationTargets:["localhost",/^https:\/\/client\.rustytelephone\.net\//]}),new $O],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});const JO=function(e,t){return te({basename:null==t?void 0:t.basename,future:tt({},null==t?void 0:t.future,{v7_prependBasename:!0}),history:(n={window:null==t?void 0:t.window},void 0===n&&(n={}),m((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return h("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:p(t)}),null,n)),hydrationData:(null==t?void 0:t.hydrationData)||nt(),routes:e,mapRouteProperties:et,window:null==t?void 0:t.window}).initialize();var n}([{path:"/",element:(0,vt.jsx)(_C,{})},{path:"/editor",element:(0,vt.jsx)(N_,{})}]);i.createRoot(document.getElementById("root")).render((0,vt.jsx)(t.StrictMode,{children:(0,vt.jsx)(ut,{router:JO})})),A_(console.log),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="/service-worker.js";D_?(!function(e,t){fetch(e).then((n=>{const r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):L_(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):L_(t,e)}))}}()})()})();
//# sourceMappingURL=main.5961f728.js.map
//# debugId=7e6fe8cb-ba29-509a-b640-9d2ab70b09cf
